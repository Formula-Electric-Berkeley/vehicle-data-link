"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7197],{15663:(ns,S,e)=>{e.r(S),e.d(S,{default:()=>os});var a=e(74848),E=e(32264),o=e(32196),f=e(96540),v=e(64388),x=e(13544),F=e(80943),u=e(40845),T=e(67061),R=e(14578),P=e(69444),B=e(39419),N=e(31771);const k=x.Tp.pages.PublicDashboard,C=function(){const s=(0,u.of)(M),t=(0,N.P)();return t.footerHide?null:(0,a.jsx)("div",{className:s.footer,"data-testid":k.footer,children:(0,a.jsxs)("a",{className:s.link,href:t.footerLink,target:"_blank",rel:"noreferrer noopener",children:[t.footerText," ",(0,a.jsx)("img",{className:s.logoImg,alt:"",src:t.footerLogo})]})})},M=s=>({footer:(0,o.css)({display:"flex",justifyContent:"end",height:"30px",backgroundColor:s.colors.background.canvas,position:"sticky",bottom:0,zIndex:s.zIndex.navbarFixed,padding:s.spacing(.5,0)}),link:(0,o.css)({display:"flex",alignItems:"center"}),logoImg:(0,o.css)({height:"16px",marginLeft:s.spacing(.5)})});var y=e(19361),U=e(20851);const j=x.Tp.pages.PublicDashboard.NotAvailable,m=({paused:s})=>{const t=(0,u.of)(Y),i=(0,u.of)(U.YO),c=y.M.LoginBoxBackground();return(0,a.jsx)(y.M.LoginBackground,{className:t.container,"data-testid":j.container,children:(0,a.jsxs)("div",{className:(0,o.cx)(t.box,c),children:[(0,a.jsx)(y.M.LoginLogo,{className:i.loginLogo}),(0,a.jsx)("p",{className:t.title,"data-testid":j.title,children:s?"This dashboard has been paused by the administrator":"The dashboard your are trying to access does not exist"}),s&&(0,a.jsx)("p",{className:t.description,"data-testid":j.pausedDescription,children:"Try again later"})]})})},Y=s=>({container:(0,o.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%",":before":{opacity:1}}),box:(0,o.css)({width:"608px",display:"flex",alignItems:"center",flexDirection:"column",gap:s.spacing(4),zIndex:1,borderRadius:s.shape.borderRadius(4),padding:s.spacing(6,8),opacity:1}),title:(0,o.css)({fontSize:s.typography.h3.fontSize,textAlign:"center",margin:0}),description:(0,o.css)({fontSize:s.typography.h5.fontSize,margin:0})});var G=e(95425),O=e(72255);const I=x.Tp.pages.PublicDashboardScene;function $({match:s,route:t}){const i=(0,O.sP)(),c=(0,u.of)(z),{dashboard:n,isLoading:d,loadError:l}=i.useState();return(0,f.useEffect)(()=>(i.loadDashboard({uid:s.params.accessToken,route:G.Z4.Public}),()=>{i.clearState()}),[i,s.params.accessToken,t.routeName]),n?n.state.meta.publicDashboardEnabled===!1?(0,a.jsx)(m,{paused:!0}):n.state.meta.dashboardNotFound?(0,a.jsx)(m,{}):n.state.controls?.state.hideTimeControls?(0,a.jsx)(L,{model:n}):(0,a.jsx)(F.$L,{scene:n,children:(0,a.jsx)(L,{model:n})}):(0,a.jsxs)(P.Y,{layout:v.k.Custom,className:c.loadingPage,"data-testid":I.loadingPage,children:[d&&(0,a.jsx)(B.A,{}),l&&(0,a.jsx)("h2",{children:l})]})}function L({model:s}){const[t,i]=(0,f.useState)(!1),{controls:c,title:n}=s.useState(),{timePicker:d,refreshPicker:l,hideTimeControls:b}=c.useState(),g=s.getBodyToRender(),r=(0,u.of)(z);return(0,f.useEffect)(()=>(i(!0),s.activate()),[s]),t?(0,a.jsxs)(P.Y,{layout:v.k.Custom,className:r.page,"data-testid":I.page,children:[(0,a.jsxs)("div",{className:r.controls,children:[(0,a.jsxs)(T.B,{alignItems:"center",children:[(0,a.jsx)("div",{className:r.iconTitle,children:(0,a.jsx)(R.I,{name:"grafana",size:"lg","aria-hidden":!0})}),(0,a.jsx)("span",{className:r.title,children:n})]}),!b&&(0,a.jsxs)(T.B,{children:[(0,a.jsx)(d.Component,{model:d}),(0,a.jsx)(l.Component,{model:l})]})]}),(0,a.jsx)("div",{className:r.body,children:(0,a.jsx)(g.Component,{model:g})}),(0,a.jsx)(C,{})]}):null}function z(s){return{loadingPage:(0,o.css)({justifyContent:"center"}),page:(0,o.css)({padding:s.spacing(0,2)}),controls:(0,o.css)({display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,zIndex:s.zIndex.navbarFixed,background:s.colors.background.canvas,padding:s.spacing(2,0),[s.breakpoints.down("sm")]:{flexDirection:"column",gap:s.spacing(1),alignItems:"stretch"}}),iconTitle:(0,o.css)({display:"none",[s.breakpoints.up("sm")]:{display:"flex",alignItems:"center"}}),title:(0,o.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",fontSize:s.typography.h4.fontSize,margin:0}),body:(0,o.css)({label:"body",flex:1,overflowY:"auto"})}}var H=e(84596),Z=e(95247),J=e(76888),K=e(81862),D=e(31678),Q=e(62367),V=e(82138),W=e(9980),X=e(2118),A=e(74856),w=e(20470);const q=x.Tp.pages.PublicDashboard,_=({dashboard:s})=>{const t=(0,D.useDispatch)(),i=(0,N.P)(),c=n=>{t((0,K.Cj)(n))};return(0,a.jsx)(Z.d,{title:s.title,pageIcon:i.headerLogoHide?void 0:"grafana",buttonOverflowAlignment:"right",children:!s.timepicker.hidden&&(0,a.jsx)(Q.$,{dashboard:s,onChangeTimeZone:c})})},ss=s=>{const{match:t,route:i,location:c}=s,n=(0,D.useDispatch)(),d=(0,J.Il)(),l=(0,H.A)(s),b=(0,u.of)(as),g=(0,D.useSelector)(h=>h.dashboard),r=g.getModel();return(0,f.useEffect)(()=>{n((0,w.vR)({routeName:i.routeName,fixUrl:!1,accessToken:t.params.accessToken,keybindingSrv:d.keybindings}))},[i.routeName,t.params.accessToken,d.keybindings,n]),(0,f.useEffect)(()=>{if(l?.location.search!==c.search){const h=l?.queryParams,p=s.queryParams;(p?.from!==h?.from||p?.to!==h?.to)&&!r?.timepicker.hidden&&(0,A.jG)().updateTimeRangeFromUrl(),!h?.refresh&&p?.refresh&&(0,A.jG)().setAutoRefresh(p.refresh)}},[l,c.search,s.queryParams,r?.timepicker.hidden,t.params.accessToken]),r?r.meta.publicDashboardEnabled===!1?(0,a.jsx)(m,{paused:!0}):r.meta.dashboardNotFound?(0,a.jsx)(m,{}):(0,a.jsxs)(P.Y,{pageNav:{text:r.title},layout:v.k.Custom,"data-testid":q.page,children:[(0,a.jsx)(_,{dashboard:r}),g.initError&&(0,a.jsx)(V.y,{initError:g.initError}),(0,a.jsx)("div",{className:b.gridContainer,children:(0,a.jsx)(X.N,{dashboard:r,isEditable:!1,viewPanel:null,editPanel:null,hidePanelMenus:!0})}),(0,a.jsx)("div",{className:b.footer,children:(0,a.jsx)(C,{})})]}):(0,a.jsx)(W.P,{initPhase:g.initPhase})},as=s=>({gridContainer:(0,o.css)({flex:1,padding:s.spacing(2,2,2,2),overflow:"auto"}),footer:(0,o.css)({padding:s.spacing(0,2)})}),es=ss;function ts(s){return E.$.featureToggles.publicDashboardsScene?(0,a.jsx)($,{...s}):(0,a.jsx)(es,{...s})}const os=ts}}]);

//# sourceMappingURL=PublicDashboardPage.1069ee179b6ba9134168.js.map