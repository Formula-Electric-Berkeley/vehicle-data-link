(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7774],{29020:(xe,ve,y)=>{"use strict";y.d(ve,{I:()=>Q});var N=y(96540),A=y(47433),x=Object.defineProperty,$=Object.defineProperties,z=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,j=(Z,ge,X)=>ge in Z?x(Z,ge,{enumerable:!0,configurable:!0,writable:!0,value:X}):Z[ge]=X,W=(Z,ge)=>{for(var X in ge||(ge={}))E.call(ge,X)&&j(Z,X,ge[X]);if(T)for(var X of T(ge))I.call(ge,X)&&j(Z,X,ge[X]);return Z},Y=(Z,ge)=>$(Z,z(ge)),ee=(Z,ge)=>{var X={};for(var Ee in Z)E.call(Z,Ee)&&ge.indexOf(Ee)<0&&(X[Ee]=Z[Ee]);if(Z!=null&&T)for(var Ee of T(Z))ge.indexOf(Ee)<0&&I.call(Z,Ee)&&(X[Ee]=Z[Ee]);return X};const Q=Z=>{var ge=Z,{children:X}=ge,Ee=ee(ge,["children"]);return N.createElement(A.x,Y(W({},Ee),{kind:"sub-section"}),X)}},6191:(xe,ve,y)=>{"use strict";y.d(ve,{X:()=>$});var N=y(32196),A=y(96540),x=y(40845);const $=({children:T})=>{const E=(0,x.of)(z);return A.createElement("div",{className:E.root},T)},z=T=>({root:(0,N.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:T.spacing(3),minHeight:T.spacing(4)})})},31347:(xe,ve,y)=>{"use strict";y.d(ve,{Z:()=>A});var N=y(96540);const A=({grow:x,shrink:$})=>N.createElement("div",{style:{display:"block",flexGrow:x,flexShrink:$}})},22354:(xe,ve,y)=>{"use strict";y.d(ve,{W:()=>X});var N=y(32196),A=y(96540),x=y(40845),$=y(90182),z=y(4603),T=Object.defineProperty,E=Object.defineProperties,I=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,ee=(_e,Pe,ye)=>Pe in _e?T(_e,Pe,{enumerable:!0,configurable:!0,writable:!0,value:ye}):_e[Pe]=ye,Q=(_e,Pe)=>{for(var ye in Pe||(Pe={}))W.call(Pe,ye)&&ee(_e,ye,Pe[ye]);if(j)for(var ye of j(Pe))Y.call(Pe,ye)&&ee(_e,ye,Pe[ye]);return _e},Z=(_e,Pe)=>E(_e,I(Pe)),ge=(_e,Pe)=>{var ye={};for(var Ze in _e)W.call(_e,Ze)&&Pe.indexOf(Ze)<0&&(ye[Ze]=_e[Ze]);if(_e!=null&&j)for(var Ze of j(_e))Pe.indexOf(Ze)<0&&Y.call(_e,Ze)&&(ye[Ze]=_e[Ze]);return ye};function X(_e){var Pe=_e,{label:ye}=Pe,Ze=ge(Pe,["label"]);const Be=(0,x.of)(Ye),[tr]=(0,A.useState)(()=>Math.random().toString(16).slice(2)),vr={SelectContainer:Ee,ValueContainer:ze,SingleValue:ze};return A.createElement("div",{className:Be.root},ye&&A.createElement("label",{className:Be.label,htmlFor:tr},ye,":","\xA0"),A.createElement($.l6,Z(Q({openMenuOnFocus:!0,inputId:tr},Ze),{components:vr})))}const Ee=_e=>{const{children:Pe}=_e,ye=(0,x.of)(Ye);return A.createElement(z.K,Z(Q({},_e),{className:(0,N.cx)(_e.className,ye.container)}),Pe)},ze=_e=>{const{className:Pe,children:ye}=_e,Ze=(0,x.of)(Ye);return A.createElement("div",{className:(0,N.cx)(Pe,Ze.valueContainer)},ye)},Ye=_e=>({root:(0,N.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,N.css)({color:_e.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,N.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,N.css)({display:"flex",alignItems:"center",flex:"initial",color:_e.colors.text.secondary,fontSize:12})})},1779:(xe,ve,y)=>{var N=y(48287).Buffer,A=function(){"use strict";function x(Q,Z){return Z!=null&&Q instanceof Z}var $;try{$=Map}catch{$=function(){}}var z;try{z=Set}catch{z=function(){}}var T;try{T=Promise}catch{T=function(){}}function E(Q,Z,ge,X,Ee){typeof Z=="object"&&(ge=Z.depth,X=Z.prototype,Ee=Z.includeNonEnumerable,Z=Z.circular);var ze=[],Ye=[],_e=typeof N<"u";typeof Z>"u"&&(Z=!0),typeof ge>"u"&&(ge=1/0);function Pe(ye,Ze){if(ye===null)return null;if(Ze===0)return ye;var Be,tr;if(typeof ye!="object")return ye;if(x(ye,$))Be=new $;else if(x(ye,z))Be=new z;else if(x(ye,T))Be=new T(function(ut,Oe){ye.then(function(ue){ut(Pe(ue,Ze-1))},function(ue){Oe(Pe(ue,Ze-1))})});else if(E.__isArray(ye))Be=[];else if(E.__isRegExp(ye))Be=new RegExp(ye.source,ee(ye)),ye.lastIndex&&(Be.lastIndex=ye.lastIndex);else if(E.__isDate(ye))Be=new Date(ye.getTime());else{if(_e&&N.isBuffer(ye))return N.allocUnsafe?Be=N.allocUnsafe(ye.length):Be=new N(ye.length),ye.copy(Be),Be;x(ye,Error)?Be=Object.create(ye):typeof X>"u"?(tr=Object.getPrototypeOf(ye),Be=Object.create(tr)):(Be=Object.create(X),tr=X)}if(Z){var vr=ze.indexOf(ye);if(vr!=-1)return Ye[vr];ze.push(ye),Ye.push(Be)}x(ye,$)&&ye.forEach(function(ut,Oe){var ue=Pe(Oe,Ze-1),de=Pe(ut,Ze-1);Be.set(ue,de)}),x(ye,z)&&ye.forEach(function(ut){var Oe=Pe(ut,Ze-1);Be.add(Oe)});for(var $e in ye){var Xe;tr&&(Xe=Object.getOwnPropertyDescriptor(tr,$e)),!(Xe&&Xe.set==null)&&(Be[$e]=Pe(ye[$e],Ze-1))}if(Object.getOwnPropertySymbols)for(var gr=Object.getOwnPropertySymbols(ye),$e=0;$e<gr.length;$e++){var et=gr[$e],rt=Object.getOwnPropertyDescriptor(ye,et);rt&&!rt.enumerable&&!Ee||(Be[et]=Pe(ye[et],Ze-1),rt.enumerable||Object.defineProperty(Be,et,{enumerable:!1}))}if(Ee)for(var jt=Object.getOwnPropertyNames(ye),$e=0;$e<jt.length;$e++){var fr=jt[$e],rt=Object.getOwnPropertyDescriptor(ye,fr);rt&&rt.enumerable||(Be[fr]=Pe(ye[fr],Ze-1),Object.defineProperty(Be,fr,{enumerable:!1}))}return Be}return Pe(Q,ge)}E.clonePrototype=function(Z){if(Z===null)return null;var ge=function(){};return ge.prototype=Z,new ge};function I(Q){return Object.prototype.toString.call(Q)}E.__objToStr=I;function j(Q){return typeof Q=="object"&&I(Q)==="[object Date]"}E.__isDate=j;function W(Q){return typeof Q=="object"&&I(Q)==="[object Array]"}E.__isArray=W;function Y(Q){return typeof Q=="object"&&I(Q)==="[object RegExp]"}E.__isRegExp=Y;function ee(Q){var Z="";return Q.global&&(Z+="g"),Q.ignoreCase&&(Z+="i"),Q.multiline&&(Z+="m"),Z}return E.__getRegExpFlags=ee,E}();xe.exports&&(xe.exports=A)},87774:(xe,ve,y)=>{"use strict";y.d(ve,{jN:()=>_b,gv:()=>ye,oK:()=>Db,e_:()=>xp,To:()=>ln,oF:()=>ca,se:()=>Nb.s,YW:()=>Wt,nj:()=>Bb});var N={};y.r(N),y.d(N,{applyToJS:()=>Wi,cleanJSX:()=>Ki,deepEqual:()=>Ja,deepFreeze:()=>Fu,escapeRegExp:()=>Ou,getFirstDefined:()=>Eu,getLogger:()=>Tu,getOpCardinality:()=>Ur,isDirtyJSX:()=>Oa,isImmutable:()=>zn,isImmutableList:()=>Qa,isJSX:()=>zi,isJsonCompatible:()=>Cu,isJsonLogic:()=>st,isObject:()=>qa,logger:()=>Cn,mergeArraysSmart:()=>Ya,mergeCustomizerNoArrays:()=>bu,omit:()=>Pt,opDefKeysToOmit:()=>Kn,shallowCopy:()=>yu,shallowEqual:()=>ya,sleep:()=>Su,toImmutableList:()=>Br,uuid:()=>cr,widgetDefKeysToOmit:()=>In});var A={};y.r(A),y.d(A,{getItemInListValues:()=>ba,getListValue:()=>ri,getTitleInListValues:()=>ju,getValueInListValues:()=>Qp,listValuesToArray:()=>wu,makeCustomListValue:()=>qi,mapListValues:()=>Ji,searchListValue:()=>Yp,toListValue:()=>vn});var x={};y.r(x),y.d(x,{_fixImmutableValue:()=>ro,expandTreePath:()=>Ce,expandTreeSubpath:()=>Qi,fixEmptyGroupsInTree:()=>ti,fixPathsInTree:()=>Ht,getFlatTree:()=>Yi,getItemByPath:()=>Hn,getLightTree:()=>Pu,getSwitchValues:()=>xu,getTotalReordableNodesCountInTree:()=>Xp,getTotalRulesCountInTree:()=>Xi,getTreeBadFields:()=>yo,hasChildren:()=>eo,immutableToJs:()=>Wi,isEmptyTree:()=>Zi,isImmutable:()=>zn,jsToImmutable:()=>Sa,removeIsLockedInTree:()=>Ru,toImmutableList:()=>Br});var $={};y.r($),y.d($,{SqlString:()=>Tn,mongoEmptyValue:()=>Ku,spelEscape:()=>Qn,spelFixList:()=>zu,spelFormatConcat:()=>Sv,spelImportConcat:()=>Fv,sqlEmptyValue:()=>Wu,stringifyForDisplay:()=>Hu,wrapWithBrackets:()=>qu});var z={};y.r(z),y.d(z,{_loadFromJsonLogic:()=>_u,_loadFromSpel:()=>fl,checkTree:()=>Oo,getTree:()=>Zp,isImmutableTree:()=>Iu,isJsonLogic:()=>st,isTree:()=>Vu,isValidTree:()=>ho,jsToImmutable:()=>Sa,loadFromJsonLogic:()=>nv,loadFromSpel:()=>Iv,loadTree:()=>to});var T={};y.r(T),y.d(T,{createListFromArray:()=>Fl,createListWithOneElement:()=>qv,defaultConjunction:()=>tn,defaultGroupConjunction:()=>La,defaultGroupProperties:()=>En,defaultItemProperties:()=>bl,defaultOperatorOptions:()=>Aa,defaultRoot:()=>Hv,defaultRule:()=>Sl,defaultRuleProperties:()=>rn,emptyProperties:()=>Jv,getDefaultField:()=>yl,getDefaultFieldSrc:()=>lo,getDefaultOperator:()=>so,getDefaultSubField:()=>Ol});var E={};y.r(E),y.d(E,{_validateTree:()=>wa,checkTree:()=>Oo,getNewValueForFieldOp:()=>Vn,getTreeBadFields:()=>yo,isValidTree:()=>ho,sanitizeTree:()=>ds,translateValidation:()=>qt,validateAndFixTree:()=>fs,validateRange:()=>bo,validateTree:()=>cs,validateValue:()=>Xn});var I={};y.r(I),y.d(I,{completeFuncValue:()=>ms,getCompatibleArgsOnFuncChange:()=>bs,setArgValue:()=>Fo,setArgValueSrc:()=>Os,setFunc:()=>hs,setFuncDefaultArg:()=>ai});var j={};y.r(j),y.d(j,{calculateValueType:()=>Fs,completeValue:()=>Nn,filterValueSourcesForField:()=>Dn,formatFieldName:()=>mn,getFieldPartsConfigs:()=>Cs,getFieldPathLabels:()=>ja,getFirstOperator:()=>Co,getFuncPathLabels:()=>fg,getOneChildOrDescendant:()=>jo,getOperatorsForField:()=>oi,getOperatorsForType:()=>Ss,getValueLabel:()=>pg,getValueSourcesForFieldOp:()=>Ts,getWidgetForFieldOp:()=>wr,getWidgetsForFieldOp:()=>vg,isEmptyGroupChildren:()=>Ao,isEmptyItem:()=>Eo,isEmptyRuleGroupExtPropertiesAndChildren:()=>Es,isEmptyRuleProperties:()=>Lo,selectTypes:()=>ii,whatRulePropertiesAreCompleted:()=>wo});var W={};y.r(W),y.d(W,{_getFromConfigCache:()=>pi,_saveToConfigCache:()=>vi,_widgetDefKeysToOmit:()=>Kg,applyJsonLogic:()=>Fg,cleanJSX:()=>Ki,compileConfig:()=>_s,compressConfig:()=>ks,configKeys:()=>nn,createConfigMemo:()=>Ks,decompressConfig:()=>Ms,extendConfig:()=>xt,findExtendedConfigInAllMemos:()=>Ws,getCommonMemo:()=>$s,getFieldConfig:()=>je,getFieldId:()=>fi,getFieldParts:()=>Dr,getFieldPath:()=>an,getFieldPathParts:()=>zg,getFieldRawConfig:()=>Jt,getFieldSrc:()=>Zs,getFieldWidgetConfig:()=>dt,getFirstField:()=>ec,getFuncArgConfig:()=>No,getFuncConfig:()=>$r,getFuncSignature:()=>Do,getOperatorConfig:()=>lr,isDirtyJSX:()=>Oa,isFieldDescendantOfField:()=>Xs,isJSX:()=>zi,iterateFields:()=>Ys,iterateFuncs:()=>ta,normalizeField:()=>di});var Y={};y.r(Y),y.d(Y,{_mongodbFormat:()=>hc,_spelFormat:()=>el,_sqlFormat:()=>Fc,elasticSearchFormat:()=>jc,jsonLogicFormat:()=>Yg,mongodbFormat:()=>nm,queryBuilderFormat:()=>Hg,queryString:()=>Ll,spelFormat:()=>Ev,sqlFormat:()=>sm});var ee={};y.r(ee),y.d(ee,{fixListValuesGroupOrder:()=>Im,getListValue:()=>ri,listValueToOption:()=>xm,mergeListValues:()=>jm,optionToListValue:()=>Rm,optionsToListValues:()=>Pm,simulateAsyncFetch:()=>wm});var Q={};y.r(Q),y.d(Q,{Autocomplete:()=>ee,ConfigUtils:()=>W,DefaultUtils:()=>T,ExportUtils:()=>$,FuncUtils:()=>I,ListUtils:()=>A,OtherUtils:()=>N,RuleUtils:()=>j,TreeUtils:()=>x,Validation:()=>E,checkTree:()=>Oo,clone:()=>kt(),compressConfig:()=>ks,decompressConfig:()=>Ms,getSwitchValues:()=>xu,i18n:()=>ag,isValidTree:()=>ho,moment:()=>qn(),sanitizeTree:()=>ds,uuid:()=>cr,validateAndFixTree:()=>fs,validateTree:()=>cs});var Z={};y.r(Z),y.d(Z,{LINEAR_REGRESSION:()=>Mm,LOWER:()=>Nm,NOW:()=>Vm,RELATIVE_DATETIME:()=>Dm,UPPER:()=>km});var ge={};y.r(ge),y.d(ge,{addCaseGroup:()=>Th,addDefaultCaseGroup:()=>Ch,addGroup:()=>Eh,addRule:()=>Sh,moveItem:()=>Lh,removeGroup:()=>Ah,removeRule:()=>Fh,setTree:()=>bh});var X={};y.r(X),y.d(X,{setConjunction:()=>wh,setLock:()=>Rh,setNot:()=>jh});var Ee={};y.r(Ee),y.d(Ee,{setField:()=>Ph,setFieldSrc:()=>xh,setFuncValue:()=>Nh,setOperator:()=>Ih,setOperatorOption:()=>kh,setValue:()=>Vh,setValueSrc:()=>Dh});var ze={};y.r(ze),y.d(ze,{bindActionCreators:()=>Ld,isUsingLegacyReactDomRender:()=>Ad,liteShouldComponentUpdate:()=>Si,pureShouldComponentUpdate:()=>aa,useOnPropsChanged:()=>ht});var Ye={};y.r(Ye),y.d(Ye,{FuncWidget:()=>uu,ValueFieldWidget:()=>gp,VanillaBooleanWidget:()=>kO,VanillaButton:()=>XO,VanillaButtonGroup:()=>eb,VanillaConjs:()=>QO,VanillaDateTimeWidget:()=>BO,VanillaDateWidget:()=>GO,VanillaFieldSelect:()=>JO,VanillaIcon:()=>ZO,VanillaMultiSelectWidget:()=>WO,VanillaNumberWidget:()=>HO,VanillaProvider:()=>ab,VanillaSelectWidget:()=>zO,VanillaSliderWidget:()=>qO,VanillaSwitch:()=>tb,VanillaTextAreaWidget:()=>_O,VanillaTextWidget:()=>MO,VanillaTimeWidget:()=>UO,VanillaValueSources:()=>rb,vanillaConfirm:()=>nb});var _e={};y.r(_e),y.d(_e,{ProximityOperator:()=>fu});var Pe=y(50877),ye=(n=>(n.Timeseries="time_series",n.Table="table",n))(ye||{});const Ze=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],Be=n=>({label:n,value:n}),tr=Pe.z??Be;var vr=y(13288),$e=y(75505),Xe=y(81160),gr=y(41987),et=y(92053),rt=y(43127),jt=y(78368),fr=y(98765),ut=y(26657),Oe=y(72574),ue=y(14110),de=y(17172),ke=y(47773),Me=y(2543);class ie{transformMetricFindResponse(e){const t=[],r=e.fields.find(i=>i.name==="__text"),a=e.fields.find(i=>i.name==="__value");if(r&&a)for(let i=0;i<r.values.length;i++)t.push({text:""+r.values[i],value:""+a.values[i]});else for(const i of e.fields)for(const u of i.values)t.push({text:u});return(0,Me.uniqBy)(t,"text")}}var k=y(74848),F=y(96540),er=y(16817),gt=y(68402),Hr=(n=>(n.String="string",n))(Hr||{}),br=(n=>(n.Property="property",n.Operator="operator",n.Or="or",n.And="and",n.GroupBy="groupBy",n.Function="function",n.FunctionParameter="functionParameter",n))(br||{});function ca(n){return`SELECT ${n.map(t=>{let r="";return t.name&&t.alias?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)}) AS ${t.alias}`:t.name?r+=`${t.name}(${t.parameters?.map(a=>`${a.name}`)})`:t.alias?r+=`${t.parameters?.map(a=>`${a.name}`)} AS ${t.alias}`:r+=`${t.parameters?.map(a=>`${a.name}`)}`,r}).join(", ")} `}const Wt=n=>{if(!n)return!1;const e=n.some(r=>r.parameters?.length||r.parameters?.some(a=>a.name)),t=n.some(r=>r.name);return e||t};function da(n){return{type:br.GroupBy,property:{type:Hr.String,name:n}}}function fa(n){return{type:br.Property,property:{type:Hr.String,name:n}}}function On(n){return{type:br.Function,name:n,parameters:[]}}function ln(n){let e=n?.editorMode||fr.lX.Builder;return n?.editorMode===void 0&&n?.rawSql!==void 0&&(e=fr.lX.Code),{...n,refId:n?.refId||"A",format:n?.format!==void 0?n.format:ye.Table,rawSql:n?.rawSql||"",editorMode:e,sql:n?.sql??{columns:[On()],groupBy:[da()],limit:50}}}var pa=y(73287),qr=y(13544),Vi=y(6191),Di=y(22354),tt=y(31347),sn=y(9e4),Rt=y(81580),bn=y(15292),Kt=y(55852),cn=y(56034),va=y(94354),Qr=y(32196),Sn=y(40845),ga=y(37390),dn=y(14578);function Ni({isOpen:n,onCancel:e,onDiscard:t,onCopy:r}){const a=(0,F.useRef)(null),i=(0,Sn.of)(Ma);return(0,F.useEffect)(()=>{n&&a.current?.focus()},[n]),(0,k.jsxs)(ga.a,{title:(0,k.jsxs)("div",{className:"modal-header-title",children:[(0,k.jsx)(dn.I,{name:"exclamation-triangle",size:"lg"}),(0,k.jsx)("span",{className:i.titleText,children:"Warning"})]}),onDismiss:e,isOpen:n,children:[(0,k.jsx)("p",{children:"Builder mode does not display changes made in code. The query builder will display the last changes you made in builder mode."}),(0,k.jsx)("p",{children:"Do you want to copy your code to the clipboard?"}),(0,k.jsxs)(ga.a.ButtonRow,{children:[(0,k.jsx)(Kt.$n,{type:"button",variant:"secondary",onClick:e,fill:"outline",children:"Cancel"}),(0,k.jsx)(Kt.$n,{variant:"destructive",type:"button",onClick:t,ref:a,children:"Discard code and switch"}),(0,k.jsx)(Kt.$n,{variant:"primary",onClick:r,children:"Copy code and switch"})]})]})}const Ma=n=>({titleText:(0,Qr.css)({paddingLeft:n.spacing(2)})});var Tt=y(90182),fn=y(32264);const Rn=()=>!!fn.$.featureToggles.sqlDatasourceDatabaseSelection,mu=({dataset:n,db:e,dialect:t,onChange:r,inputId:a,preconfiguredDataset:i})=>{const u=!!i||t==="postgres",o=(0,er.A)(async()=>Rn()&&u?(r(tr(i)),[tr(i)]):(n&&r(tr(n)),(await e.datasets()).map(tr)),[]);return(0,F.useEffect)(()=>{Rn()||(n?o.value&&o.value.find(l=>l.value===n)===void 0&&o.value.length>0&&r(o.value[0]):o.value&&o.value[0]&&r(o.value[0]))},[o.value,r,n]),(0,k.jsx)(Tt.l6,{"aria-label":"Dataset selector",inputId:a,value:n,options:o.value,onChange:r,disabled:o.loading,isLoading:o.loading,menuShouldPortal:!0})},ki=({db:n,dataset:e,table:t,className:r,onChange:a,inputId:i})=>{const u=(0,er.A)(async()=>e?(await n.tables(e)).map(Pe.z):[],[e]);return(0,k.jsx)(Tt.l6,{className:r,disabled:u.loading,"aria-label":"Table selector",inputId:i,"data-testid":qr.Tp.components.SQLQueryEditor.headerTableSelector,value:t,options:u.value,onChange:a,isLoading:u.loading,menuShouldPortal:!0,placeholder:u.loading?"Loading tables":"Select table"})},Mi=[{label:"Builder",value:fr.lX.Builder},{label:"Code",value:fr.lX.Code}];function _i({db:n,dialect:e,isQueryRunnable:t,onChange:r,onQueryRowChange:a,onRunQuery:i,preconfiguredDataset:u,query:o,queryRowFilter:l}){const{editorMode:s}=o,[c,d]=(0,pa.A)(),[f,p]=(0,F.useState)(!1),g=n.toRawSql,v=(0,F.useId)(),m=(0,F.useCallback)(C=>{if(C===fr.lX.Code&&(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:fr.lX.Code}),s===fr.lX.Code){p(!0);return}r({...o,editorMode:C})},[s,r,o]),h=C=>{const L={...o,format:C.value!==void 0?C.value:ye.Table};(0,ue.rR)("grafana_sql_format_changed",{datasource:o.datasource?.type,selectedFormat:L.format}),r(L)},O=C=>{if(C.value===o.dataset)return;const L={...o,dataset:C.value,table:void 0,sql:void 0,rawSql:""};r(L)},b=C=>{if(C.value===o.table)return;const L={...o,table:C.value,sql:void 0,rawSql:""};r(L)},S=()=>!(e==="influx"||!Rn()&&e==="postgres");return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Vi.X,{children:[(0,k.jsx)(Di.W,{label:"Format",value:o.format,placeholder:"Select format",menuShouldPortal:!0,onChange:h,options:Ze}),s===fr.lX.Builder&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(bn.K,{id:`sql-filter-${v}`,label:"Filter","data-testid":qr.Tp.components.SQLQueryEditor.headerFilterSwitch,transparent:!0,showLabel:!0,value:l.filter,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_filter_toggled",{datasource:o.datasource?.type,displayed:C.target.checked}),a({...l,filter:C.target.checked}))}}),(0,k.jsx)(bn.K,{id:`sql-group-${v}`,label:"Group","data-testid":qr.Tp.components.SQLQueryEditor.headerGroupSwitch,transparent:!0,showLabel:!0,value:l.group,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_group_toggled",{datasource:o.datasource?.type,displayed:C.target.checked}),a({...l,group:C.target.checked}))}}),(0,k.jsx)(bn.K,{id:`sql-order-${v}`,label:"Order","data-testid":qr.Tp.components.SQLQueryEditor.headerOrderSwitch,transparent:!0,showLabel:!0,value:l.order,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_order_toggled",{datasource:o.datasource?.type,displayed:C.target.checked}),a({...l,order:C.target.checked}))}}),(0,k.jsx)(bn.K,{id:`sql-preview-${v}`,label:"Preview","data-testid":qr.Tp.components.SQLQueryEditor.headerPreviewSwitch,transparent:!0,showLabel:!0,value:l.preview,onChange:C=>{C.target instanceof HTMLInputElement&&((0,ue.rR)("grafana_sql_preview_toggled",{datasource:o.datasource?.type,displayed:C.target.checked}),a({...l,preview:C.target.checked}))}})]}),(0,k.jsx)(tt.Z,{grow:1}),t?(0,k.jsx)(Kt.$n,{icon:"play",variant:"primary",size:"sm",onClick:()=>i(),children:"Run query"}):(0,k.jsx)(cn.m,{theme:"error",content:(0,k.jsxs)(k.Fragment,{children:["Your query is invalid. Check below for details. ",(0,k.jsx)("br",{}),"However, you can still run this query."]}),placement:"top",children:(0,k.jsx)(Kt.$n,{icon:"exclamation-triangle",variant:"secondary",size:"sm",onClick:()=>i(),children:"Run query"})}),(0,k.jsx)(va.z,{options:Mi,size:"sm",value:s,onChange:m}),(0,k.jsx)(Ni,{isOpen:f,onCopy:()=>{(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:fr.lX.Builder,type:"copy"}),p(!1),d(o.rawSql),r({...o,rawSql:g(o),editorMode:fr.lX.Builder})},onDiscard:()=>{(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:fr.lX.Builder,type:"discard"}),p(!1),r({...o,rawSql:g(o),editorMode:fr.lX.Builder})},onCancel:()=>{(0,ue.rR)("grafana_sql_editor_mode_changed",{datasource:o.datasource?.type,selectedEditorMode:fr.lX.Builder,type:"cancel"}),p(!1)}})]}),s===fr.lX.Builder&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(gt.$,{v:.5}),(0,k.jsxs)(sn.U,{children:[S()&&(0,k.jsx)(Rt.c,{label:"Dataset",width:25,children:(0,k.jsx)(mu,{db:n,inputId:`sql-dataset-${v}`,dataset:o.dataset,dialect:e,preconfiguredDataset:u,onChange:O})}),(0,k.jsx)(Rt.c,{label:"Table",width:25,children:(0,k.jsx)(ki,{db:n,inputId:`sql-tableselect-${v}`,dataset:o.dataset||u,table:o.table,onChange:b})})]})]})]})}var _a=y(49185),Ga=y(70713),Ua=y(6867);function Ba({children:n,onChange:e,query:t,width:r,height:a,editorLanguageDefinition:i}){const u=(0,F.useRef)(t);(0,F.useEffect)(()=>{u.current=t},[t]);const o=(0,F.useCallback)((l,s)=>{const c={...u.current,rawQuery:!0,rawSql:l};e(c,s)},[e]);return(0,k.jsx)(Ua.Y,{width:r,height:a,query:t.rawSql,onChange:o,language:i,children:n})}var $a=y(66864),ma=y(29158),Gi=y(41053),Wa=y(75198),Ka=y(83195),Er=y(62930);function Nt({db:n,query:e,onValidate:t,range:r}){const[a,i]=(0,F.useState)(),u=(0,Sn.$j)(),o=(0,F.useMemo)(()=>(0,Ka.j_)("bytes"),[]),l=(0,F.useMemo)(()=>({error:(0,Qr.css)({color:u.colors.error.text,fontSize:u.typography.bodySmall.fontSize,fontFamily:u.typography.fontFamilyMonospace}),valid:(0,Qr.css)({color:u.colors.success.text}),info:(0,Qr.css)({color:u.colors.text.secondary})}),[u]),[s,c]=(0,Gi.A)(async f=>f.rawSql?.trim()===""?null:await n.validateQuery(f,r),[n]),[,]=(0,Wa.A)(async()=>{const f=await c(e);return f&&i(f),null},1e3,[e,c]);if((0,F.useEffect)(()=>{a?.isError&&t(!1),a?.isValid&&t(!0)},[a,t]),!s.value&&!s.loading)return null;const d=s.value?.error?Ui(s.value.error):"";return(0,k.jsxs)(k.Fragment,{children:[s.loading&&(0,k.jsxs)("div",{className:l.info,children:[(0,k.jsx)(Er.y,{inline:!0,size:"xs"})," Validating query..."]}),!s.loading&&s.value&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(k.Fragment,{children:s.value.isValid&&s.value.statistics&&(0,k.jsxs)("div",{className:l.valid,children:[(0,k.jsx)(dn.I,{name:"check"})," This query will process"," ",(0,k.jsx)("strong",{children:(0,Ka.cN)(o(s.value.statistics.TotalBytesProcessed))})," ","when run."]})}),(0,k.jsx)(k.Fragment,{children:s.value.isError&&(0,k.jsx)("div",{className:l.error,children:d})})]})]})}function Ui(n){const e=n.split(":");return e.length>2?e.slice(2).join(":"):n}function za({showTools:n,onFormatCode:e,onExpand:t,isExpanded:r,...a}){const i=(0,Sn.$j)(),[u,o]=(0,F.useState)(),l=(0,F.useMemo)(()=>({container:(0,Qr.css)({border:`1px solid ${i.colors.border.medium}`,borderTop:"none",padding:i.spacing(.5,.5,.5,.5),display:"flex",flexGrow:1,justifyContent:"space-between",fontSize:i.typography.bodySmall.fontSize}),error:(0,Qr.css)({color:i.colors.error.text,fontSize:i.typography.bodySmall.fontSize,fontFamily:i.typography.fontFamilyMonospace}),valid:(0,Qr.css)({color:i.colors.success.text}),info:(0,Qr.css)({color:i.colors.text.secondary}),hint:(0,Qr.css)({color:i.colors.text.disabled,whiteSpace:"nowrap",cursor:"help"})}),[i]);let s={};return!n&&u===void 0&&(s={height:0,padding:0,visibility:"hidden"}),(0,k.jsxs)("div",{className:l.container,style:s,children:[(0,k.jsx)("div",{children:a.onValidate&&(0,k.jsx)(Nt,{...a,onValidate:c=>{o(c),a.onValidate(c)}})}),n&&(0,k.jsx)("div",{children:(0,k.jsxs)($a.Gy,{spacing:"sm",children:[e&&(0,k.jsx)(ma.K,{onClick:()=>{(0,ue.rR)("grafana_sql_query_formatted",{datasource:a.query.datasource?.type}),e()},name:"brackets-curly",size:"xs",tooltip:"Format query"}),t&&(0,k.jsx)(ma.K,{onClick:()=>{(0,ue.rR)("grafana_sql_editor_expand",{datasource:a.query.datasource?.type,expanded:!r}),t(!r)},name:r?"angle-up":"angle-down",size:"xs",tooltip:r?"Collapse editor":"Expand editor"}),(0,k.jsx)(cn.m,{content:"Hit CTRL/CMD+Return to run query",children:(0,k.jsx)(dn.I,{className:l.hint,name:"keyboard"})})]})})]})}function Bi({db:n,query:e,onChange:t,onRunQuery:r,onValidate:a,queryToValidate:i,range:u}){const o=(0,Sn.$j)(),l=(0,Sn.of)(kr),[s,c]=(0,F.useState)(!1),[d,f]=(0,_a.A)(),[p,g]=(0,_a.A)(),v=(0,F.useMemo)(()=>n.getEditorLanguageDefinition(),[n]),m=(b,S)=>(0,k.jsx)(Ba,{editorLanguageDefinition:v,query:e,width:b,height:S?S-f.height:void 0,onChange:t,children:({formatQuery:C})=>(0,k.jsx)("div",{ref:d,children:(0,k.jsx)(za,{db:n,query:i,onValidate:a,onFormatCode:C,showTools:!0,range:u,onExpand:c,isExpanded:s})})}),h=(b=!1)=>b?(0,k.jsx)(Ga.Ay,{children:({width:S,height:C})=>m(S,C)}):(0,k.jsx)("div",{ref:p,children:m()}),O=()=>(0,k.jsx)("div",{style:{width:g.width,height:g.height,background:o.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center"},children:"Editing in expanded code editor"});return(0,k.jsxs)(k.Fragment,{children:[s?O():h(),s&&(0,k.jsx)(ga.a,{title:`Query ${e.refId}`,closeOnBackdropClick:!1,closeOnEscape:!1,className:l.modal,contentClassName:l.modalContent,isOpen:s,onDismiss:()=>{(0,ue.rR)("grafana_sql_editor_expand",{datasource:e.datasource?.type,expanded:!1}),c(!1)},children:h(!0)})]})}function kr(n){return{modal:(0,Qr.css)({width:"95vw",height:"95vh"}),modalContent:(0,Qr.css)({height:"100%",paddingTop:0})}}var Mr=y(71087),Et=y(11807);function zt({query:n,onQueryChange:e,db:t}){return{onSqlChange:(0,F.useCallback)(a=>{const i=t.toRawSql,u=i({sql:a,dataset:n.dataset,table:n.table,refId:n.refId}),o={...n,sql:a,rawSql:u};e(o)},[t,e,n])}}var Pn=y(85269),Ha=y(81392),Fn=y(3721);function Sr({sql:n,columns:e,onSqlChange:t}){const r=(0,F.useCallback)(a=>{const i=a.map(o=>da(o.property?.name)),u={...n,groupBy:i};t(u)},[t,n]);return(0,k.jsx)(Pn.o,{items:n.groupBy,onChange:r,renderItem:Ar({options:e})})}function Ar({options:n}){return function(t,r,a){return(0,k.jsxs)(Ha.M,{children:[(0,k.jsx)(Tt.l6,{value:t.property?.name?(0,Pe.z)(t.property.name):null,"aria-label":"Group by",options:n,menuShouldPortal:!0,onChange:({value:i})=>i&&r(da(i))}),(0,k.jsx)(Fn.Z,{title:"Remove group by column",icon:"times",variant:"secondary",onClick:a})]})}}function nt({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=zt({query:e,onQueryChange:t,db:r});return(0,k.jsx)(Sr,{columns:n,sql:e.sql,onSqlChange:a})}var xn=y(10354);const Wn=[{description:"Sort by ascending",value:"ASC",icon:"sort-amount-up"},{description:"Sort by descending",value:"DESC",icon:"sort-amount-down"}];function $i({sql:n,onSqlChange:e,columns:t,showOffset:r}){const a=(0,F.useCallback)(l=>{const s={...n,orderByDirection:l};e(s)},[e,n]),i=(0,F.useCallback)(l=>{const s={...n,limit:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),u=(0,F.useCallback)(l=>{const s={...n,offset:Number.parseInt(l.currentTarget.value,10)};e(s)},[e,n]),o=(0,F.useCallback)(l=>{const s={...n,orderBy:fa(l?.value)};l===null&&(s.orderByDirection=void 0),e(s)},[e,n]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Rt.c,{label:"Order by",width:25,children:(0,k.jsxs)(Ha.M,{children:[(0,k.jsx)(Tt.l6,{"aria-label":"Order by",options:t,value:n.orderBy?.property.name?(0,Pe.z)(n.orderBy.property.name):null,isClearable:!0,menuShouldPortal:!0,onChange:o}),(0,k.jsx)(gt.$,{h:1.5}),(0,k.jsx)(va.z,{options:Wn,disabled:!n?.orderBy?.property.name,value:n.orderByDirection,onChange:a})]})}),(0,k.jsx)(Rt.c,{label:"Limit",optional:!0,width:25,children:(0,k.jsx)(xn.p,{type:"number",min:0,id:(0,Me.uniqueId)("limit-"),value:n.limit||"",onChange:i})}),r&&(0,k.jsx)(Rt.c,{label:"Offset",optional:!0,width:25,children:(0,k.jsx)(xn.p,{type:"number",id:(0,Me.uniqueId)("offset-"),value:n.offset||"",onChange:u})})]})}function ha({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=zt({query:e,onQueryChange:t,db:r});let i=[];return n&&(i=[{value:"",label:"Selected columns",options:e.sql?.columns?.map((o,l)=>{const s=o.name?`${o.name}(${o.parameters?.map(c=>c.name)})`:o.parameters?.map(c=>c.name);return{value:s,label:`${l+1} - ${s}`}}),expanded:!0},...n]),(0,k.jsx)($i,{sql:e.sql,onSqlChange:a,columns:i})}const We=["AVG","COUNT","MAX","MIN","SUM"],At=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var G=y(46819);const re={label:"*",value:"*"};function be({sql:n,format:e,columns:t,onSqlChange:r,functions:a}){const i=(0,Sn.of)(He),u=[re,...t||[]],o=[];e===ye.Timeseries&&(o.push({label:"time",value:"time"}),o.push({label:"value",value:"value"}));const l=(0,F.useCallback)((p,g)=>v=>{let m={...p};p.parameters?.length?m.parameters=p.parameters.map(O=>O.type===br.FunctionParameter?{...O,name:v.value}:O):m.parameters=[{type:br.FunctionParameter,name:v.value}];const h={...n,columns:n.columns?.map((O,b)=>b===g?m:O)};r(h)},[r,n]),s=(0,F.useCallback)((p,g)=>v=>{const m={...p,name:v?.value},h={...n,columns:n.columns?.map((O,b)=>b===g?m:O)};r(h)},[r,n]),c=(0,F.useCallback)((p,g)=>v=>{let m={...p};v!==null?m={...p,alias:`"${v?.value?.trim()}"`}:delete m.alias;const h={...n,columns:n.columns?.map((O,b)=>b===g?m:O)};r(h)},[r,n]),d=(0,F.useCallback)(p=>()=>{const g=[...n.columns];g.splice(p,1);const v={...n,columns:g};r(v)},[r,n]),f=(0,F.useCallback)(()=>{const p={...n,columns:[...n.columns,On()]};r(p)},[r,n]);return(0,k.jsxs)(G.B,{gap:2,wrap:!0,direction:"column",children:[n.columns?.map((p,g)=>(0,k.jsx)("div",{children:(0,k.jsxs)(G.B,{gap:2,alignItems:"end",children:[(0,k.jsx)(Rt.c,{label:"Column",width:25,children:(0,k.jsx)(Tt.l6,{value:mt(p),"data-testid":qr.Tp.components.SQLQueryEditor.selectColumn,options:u,inputId:`select-column-${g}-${(0,Me.uniqueId)()}`,menuShouldPortal:!0,allowCustomValue:!0,onChange:l(p,g)})}),(0,k.jsx)(Rt.c,{label:"Aggregation",optional:!0,width:25,children:(0,k.jsx)(Tt.l6,{value:p.name?(0,Pe.z)(p.name):null,inputId:`select-aggregation-${g}-${(0,Me.uniqueId)()}`,"data-testid":qr.Tp.components.SQLQueryEditor.selectAggregation,isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0,options:a,onChange:s(p,g)})}),(0,k.jsx)(Rt.c,{label:"Alias",optional:!0,width:15,children:(0,k.jsx)(Tt.l6,{value:p.alias?(0,Pe.z)(p.alias):null,inputId:`select-alias-${g}-${(0,Me.uniqueId)()}`,"data-testid":qr.Tp.components.SQLQueryEditor.selectAlias,options:o,onChange:c(p,g),isClearable:!0,menuShouldPortal:!0,allowCustomValue:!0})}),(0,k.jsx)(Kt.$n,{title:"Remove column",type:"button",icon:"trash-alt",variant:"secondary",size:"md",onClick:d(g)})]})},g)),(0,k.jsx)(Kt.$n,{type:"button",onClick:f,variant:"secondary",title:"Add column",size:"md",icon:"plus",className:i.addButton})]})}const He=()=>({addButton:(0,Qr.css)({alignSelf:"flex-start"})});function mt({parameters:n}){const e=n?.find(t=>t.type===br.FunctionParameter);return e?.name?(0,Pe.z)(e.name):null}function lt({fields:n,query:e,onQueryChange:t,db:r}){const{onSqlChange:a}=zt({query:e,onQueryChange:t,db:r}),i=[...We,...r.functions?.()||[]].map(Pe.z);return(0,k.jsx)(be,{columns:n,sql:e.sql,format:e.format,functions:i,onSqlChange:a})}var Mp=y(24705),mr=y(23029),hr=y(92901),Fr=y(56822),we=y(53954),yr=y(85501),ne=y(64467),Le=y(5544),Se=y(60436),Cr=y(82284),he=y(49568),_p=0;const cr=function(){var n=(new Date().getTime().toString(16)+"FF").substr(0,11),e="ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,function(t){var r=t==="s"?Math.floor(Math.random()*16):_p++&15,a=t==="x"?r:r&3|8;return a.toString(16)});return e+n};function hu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Gp(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var In=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],Kn=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],qa=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&Object.prototype.toString.call(e)==="[object Object]"},yu=function(e){if((0,Cr.A)(e)==="object"&&e!==null){if(Array.isArray(e))return(0,Se.A)(e);if(qa(e))return Gp({},e)}return e},Pt=function(e,t){return Object.fromEntries(Object.entries(e).filter(function(r){var a=(0,Le.A)(r,1),i=a[0];return!t.includes(i)}))},Ur=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},Ja=function(e,t){return e===t?!0:he.Map.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t)},ya=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?Up(e,t,r):he.Map.isMap(e)?e.equals(t):(0,Cr.A)(e)=="object"?Bp(e,t,r):e===t};function Up(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var i=t?ya(n[a],e[a],t):n[a]===e[a];if(!i)return!1}return!0}function Bp(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),i=r.length;if(a.length!==i)return!1;for(var u=0;u<i;u++){var o=r[u],l=t?ya(n[o],e[o],t):n[o]===e[o];if(!l)return!1}return!0}var zn=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&typeof e.toJS=="function"},Qa=function(e){return zn(e)&&he.default.isList(e)};function Br(n){return Qa(n)?n:new he.default.List(n)}function Wi(n){return zn(n)?n.toJS():n}var Ou=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},bu=function(e,t,r,a,i,u){if(Array.isArray(e))return t},Ki=function n(e){var t=["$$typeof","_owner","_store","ref","key"],r=function(o){return typeof o=="string"?o:typeof o=="function"?o.name:o};if(e instanceof Array)return e.map(function(u,o){return n(u)});if((0,Cr.A)(e)==="object"&&e!==null&&Oa(e)){var a,i=Pt(e,t);return i.type&&(i.type=r(i.type)),i!=null&&(a=i.props)!==null&&a!==void 0&&a.children&&(i.props.children=n(i.props.children)),i}return e},Oa=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},zi=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&typeof e.type=="string"&&Object.keys(e).includes("props")},st=function(e){var t=(0,Cr.A)(e)==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1;return t};function Su(n){return new Promise(function(e){setTimeout(e,n)})}function Ya(n,e){return n||(n=[]),e||(e=[]),e.map(function(t){return[t,n.indexOf(t)]}).map(function(t,r,a){var i=(0,Le.A)(t,2),u=i[0],o=i[1];if(o==-1){var l=a.slice(r+1),s=a.slice(0,r),c=s.reverse().find(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return v!=-1}),d=l.find(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return v!=-1});return d?[u,"before",d[0]]:c?[u,"after",c[0]]:[u,"append",null]}else return null}).filter(function(t){return t!==null}).reduce(function(t,r){var a=(0,Le.A)(r,3),i=a[0],u=a[1],o=a[2],l=t.indexOf(o);return t.indexOf(i)==-1&&(l>-1?t.splice(l+(u=="after"?1:0),0,i):t.splice(u=="append"?1/0:0,0,i)),t},n.slice())}var Fu=function n(e){(0,Cr.A)(e)==="object"&&e!==null&&!Oa(e)&&(Object.keys(e).forEach(function(t){t!=="__cache"&&n(e[t])}),Object.freeze(e))},Cu=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(qa(e)){if(e.var)return r[e.var]=t,!0;if(!qa(t))return!1;for(var i in e){var u=e[i],o=t[i];if(!n(u,o,r,[].concat((0,Se.A)(a),[i])))return!1}return!0}else if(Array.isArray(e)){if(!Array.isArray(t))return!1;for(var l=0;l<e.length;l++){var s=e[l],c=t[l];if(!n(s,c,r,[].concat((0,Se.A)(a),[l])))return!1}return!0}else return e===t},$p=function(){return typeof process<"u"&&process.env&&!1},Tu=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??$p();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Eu=function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t,r=0;r<e.length;r++){var a=e[r];if(a!==void 0){t=a;break}}return t},Cn=Tu(),Wp=y(54756),pn=y.n(Wp),Kp=y(44383),Xt=y.n(Kp),zp=y(68090),Xa=y.n(zp),Hp=y(90179),Za=y.n(Hp);function qp(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Jp(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Jp(n,e){if(n){if(typeof n=="string")return Au(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Au(n,e)}}function Au(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Lu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ei(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Lu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Lu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Hi=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},vn=function(e,t){if(!(e==null||e==""))return Hi(e)?ei(ei({},e),{},{title:e.title||e.value}):{value:e,title:t!==void 0?t:""+e}},qi=function(e){var t=vn(e);return Hi(t)?ei(ei({},vn(e)),{},{isCustom:!0}):t},wu=function(e){if(Array.isArray(e))return e.map(function(i){return vn(i)});if(!Hi(e))return e;var t=[];for(var r in e){var a=e[r];t.push(vn(r,a))}return t},ba=function(e,t){if(Array.isArray(e)){var r=e.map(function(a){return vn(a)});return r.find(function(a){return""+a.value==""+t})}else return e[t]!==void 0?vn(t,e[t]):void 0},ju=function(e,t){if(e==null)return t;var r=ba(e,t);return r!==void 0?r.title:t},Qp=function(e,t){if(e==null)return t;var r=ba(e,t);return r!==void 0?r.value:t},Ji=function(e,t){var r=[];if(Array.isArray(e)){var a=qp(e),i;try{for(a.s();!(i=a.n()).done;){var u=i.value,o=t(vn(u));o!=null&&r.push(o)}}catch(c){a.e(c)}finally{a.f()}}else for(var l in e){var s=t(vn(l,e[l]));s!=null&&r.push(s)}return r},Yp=function(e,t){return Ji(t,function(r){return"".concat(r.value).indexOf(e)!=-1||r.title.indexOf(e)!=-1?r:null}).filter(function(r){return r!==null}).shift()},ri=function(e,t){return Ji(t,function(r){return""+r.value==""+e?r:null}).filter(function(r){return r!==null}).shift()},Ce=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(i){return i.skip(1),i.push.apply(i,r),i})},Qi=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return e.interpose("children1").withMutations(function(i){return i.push.apply(i,r),i})},Hn=function(e,t){var r=new he.default.OrderedMap((0,ne.A)({},e.get("id"),e)),a=e;return t.forEach(function(i){var u;a=r.get(i),r=(u=a)===null||u===void 0?void 0:u.get("children1")}),a},Ru=function(e){var t=e;function r(a,i){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=i.push(a.get("id")),l=a.getIn(["properties","isLocked"]);u&&l&&(t=t.deleteIn(Ce(o,"properties","isLocked")));var s=a.get("children1");s&&s.map(function(c,d){r(c,o,l||u)})}return r(e,new he.default.List),t},Ht=function(e){var t=e;function r(a,i,u,o){if(a){var l=a.get("path"),s=a.get("id"),c=s||o||cr(),d=i.push(c);(!l||!l.equals(d))&&(t=t.setIn(Ce(d,"path"),d)),s||(t=t.setIn(Ce(d,"id"),c));var f=a.get("children1");f&&(f.constructor.name==="Map"&&(t=t.setIn(Ce(d,"children1"),new he.default.OrderedMap(f))),f.map(function(p,g){r(p,d,u+1,g)}))}}return r(e,new he.default.List,0),t},ti=function(e){var t=e;function r(a,i,u,o){if(!a)return!1;var l=a.get("id")||o,s=i.push(l),c=a.get("children1");if(c){var d=c.map(function(f,p){return r(f,s,u+1,p)}).reduce(function(f,p){return f&&p},!0);if((c.size==0||d)&&u>0)return t=t.deleteIn(Ce(s)),!0}return!1}return r(e,new he.default.List,0),t},Yi=function(e){var t=[],r={},a=[],i=0,u=0,o=0,l=0,s={};function c(v,m,h,O,b,S,C,L){var w=v===e,D=v.get("type"),V=v.get("collapsed"),P=v.get("id"),_=v.get("children1"),B=v.getIn(["properties","isLocked"]),M=_?_.map(function(Te,Ne){return Ne}).valueSeq().toArray():null,q=D==="rule_group",K=D==="rule",H=D==="group",U=D==="case_group",te=!b&&(!_||q),J=M?.length>0,ae=m.length?m[m.length-1]:null,ce=U?P:C;U&&(a.push(P),u=0,o=0,l=0,s={});var oe=ce?a.indexOf(ce):null,le=t.length,fe=i,se;w||(se={},se.caseNo=oe,se.globalNoByType=U?oe:s[D]||0,se.indexPath=[].concat((0,Se.A)(m.slice(1).map(function(Te){return r[Te].childNo})),[L]),K?se.globalLeafNo=u:H&&(se.globalGroupNo=l)),t.push(P),r[P]={node:v,index:le,id:P,type:D,parent:ae,parentType:ae?r[ae].type:null,children:M,childNo:L,caseId:ce,caseNo:oe,path:m.concat(P),lev:S,isLeaf:!_,isAtomicRule:te,isLocked:B||O,top:h?null:fe,isDefaultCase:U?!_:void 0,atomicRulesCountInCase:U?0:void 0,position:se,collapsed:V,_top:le,leaf:!_};var me=0,Fe=0;h||(i+=1,me+=1,J&&!V&&!q&&(Fe+=1),!w&&!U&&(H&&l++,te&&o++,K&&u++,s[D]=(s[D]||0)+1)),C&&te&&r[C].atomicRulesCountInCase++;var pe=0,Ae=0;if(J){var Re=0;_.map(function(Te,Ne){if(Te){c(Te,m.concat(P),h||V,O||B,b||q,S+1,ce,Re);var Je=r[Ne];pe=Math.max(pe,Je.depth||0),Ae+=Je.height,Re++}})}me+=Ae,Fe+=pe;var Ve=t.length,Ie=Ve-le,De=h?null:fe+me;Object.assign(r[P],{depth:_?Fe:void 0,_height:Ie,height:me,bottom:De})}c(e,[],!1,!1,!1,0,null,null);for(var d=0;d<t.length;d++){var f=d>0?t[d-1]:null,p=d<t.length-1?t[d+1]:null,g=r[t[d]];g.prev=f,g.next=p}return{flat:t,items:r,cases:a}},Xp=function(e){if(!e)return-1;var t=0;function r(a,i,u){var o,l,s;typeof a.get=="function"?(o=a.get("id"),l=a.get("children1"),s=a.get("type")):(o=a.id,l=a.children1,s=a.type);var c=s=="rule_group";t++,l&&!c&&l.map(function(d,f){d&&r(d,i.concat(o),u+1)})}return r(e,[],0),t-1},Xi=function(e){if(!e)return-1;var t=0;function r(a,i,u){var o,l,s;typeof a.get=="function"?(o=a.get("id"),l=a.get("children1"),s=a.get("type")):(o=a.id,l=a.children1,s=a.type),s=="rule"||s=="rule_group"?t++:l&&l.map(function(c,d){c&&r(c,i.concat(o),u+1)})}return r(e,[],0),t},Pu=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=e;function i(u,o){t&&u.path&&delete u.path,t&&!r&&o&&delete u.id;var l=u.properties;l&&l.operatorOptions==null&&delete l.operatorOptions;var s=u.children1;if(s){for(var c in s)s[c]&&i(s[c],c);r&&(u.children1=Object.values(s))}}return i(e,null),a},xu=function(e){var t=[],r=e.get("children1");return r&&r.map(function(a){var i=a.getIn(["properties","value"]),u;i&&i.size==1?(u=i.get(0),Array.isArray(u)&&u.length==0&&(u=null)):u=null,t=[].concat((0,Se.A)(t),[u])}),t},Zi=function(e){return!e.get("children1")||e.get("children1").size==0},eo=function(e,t){return e.getIn(Ce(t,"children1")).size>0},ro=function(e){if(e!=null&&e.toJS){var t,r=e==null||(t=e.toJS)===null||t===void 0?void 0:t.call(e);return r!=null&&r.func?e.toOrderedMap():r}else return e},Zp=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e){var a=e;return a=a.toJS(),a=Pu(a,t,r),a}},to=function(e){if(Iu(e))return e;if(Vu(e))return Ht(Sa(e));if(typeof e=="string"&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if(typeof e=="string")return Ht(Sa(JSON.parse(e)));throw new Error("Can't load tree!")},Iu=function(e){return he.Map.isMap(e)},Vu=function(e){return(0,Cr.A)(e)=="object"&&(e.type=="group"||e.type=="switch_group")};function Sa(n){var e=(0,he.fromJS)(n,function(t,r,a){var i=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-3]==="args",u=a&&a.length>3&&a[a.length-1]==="value"&&a[a.length-2]==="properties",o;if(t=="properties"){o=r.toOrderedMap();for(var l=0;l<2;l++){var s,c,d;((s=o.get("value"))===null||s===void 0||(c=(d=s).get)===null||c===void 0?void 0:c.call(d,l))===null&&(o=o.setIn(["value",l],void 0))}}else i?o=ro(r):(a?u:t=="value")&&he.default.Iterable.isIndexed(r)?o=r.map(ro).toList():t=="asyncListValues"?o=r.toJS():t=="children1"&&he.default.Iterable.isIndexed(r)?o=new he.default.OrderedMap(r.map(function(f){return[f?.get("id")||cr(),f]})):o=he.default.Iterable.isIndexed(r)?r.toList():r.toOrderedMap();return o});return e}var Du=y(87695),ev=y(95093),qn=y.n(ev);function Nu(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=rv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function rv(n,e){if(n){if(typeof n=="string")return ku(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ku(n,e)}}function ku(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Mu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Zt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Mu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Mu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var tv=function(e){return Array.from(new Set(e))},qb=function(e){return e.reduce(function(t,r){var a=_slicedToArray(r,2),i=a[0],u=a[1];return Zt(Zt({},t),{},_defineProperty({},i,u))},{})},no=function(e){return{errors:[],settings:e?.settings}},nv=function(e,t){return _u(e,t,!1)},_u=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=no();a.settings={allowUnknownFields:!1,returnErrors:r};var i=xt(t,void 0,!1),u=av(i),o=e?Jn(e,u,i,["rule","group","switch"],a):void 0,l=o?to(o):void 0;return r?[l,a.errors]:(a.errors.length&&console.warn("Errors while importing from JsonLogic:",a.errors),l)},av=function(e){var t={};for(var r in e.operators){var a=e.operators[r];if(typeof a.jsonLogic=="string"){var i=(a._jsonLogicIsRevArgs?"#":"")+a.jsonLogic+"/"+Ur(a);t[i]||(t[i]=[]),t[i].push(r)}else if(typeof a.jsonLogic2=="string"){var u=a.jsonLogic2+"/"+Ur(a);t[u]||(t[u]=[]),t[u].push(r)}}var o={};for(var l in e.conjunctions){var s=e.conjunctions[l],c=s.jsonLogicConj||l.toLowerCase();o[c]=l}var d={},f=Nu(ta(e)),p;try{for(f.s();!(p=f.n()).done;){var g=(0,Le.A)(p.value,2),v=g[0],m=g[1],h=void 0;m.jsonLogicIsMethod?h="#"+m.jsonLogic:typeof m.jsonLogic=="string"&&(h=m.jsonLogic),h&&(d[h]||(d[h]=[]),d[h].push(v))}}catch(C){f.e(C)}finally{f.f()}var O=e.settings.jsonLogic,b=O.groupVarKey,S=O.altVarKey;return{operators:t,conjunctions:o,funcs:d,varKeys:["var",b,S]}},Jn=function n(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d,f;st(e)&&(d=Object.keys(e)[0],f=e[d],Array.isArray(f)||(f=[f]));var p,g=i.errors.length,v=r.settings.jsonLogic.lockedOp,m=d=="!"&&f.length==1&&f[0]&&st(f[0])&&t.varKeys.includes(Object.keys(f[0])[0]),h=d=="!"&&!m,O=v&&d==v,b=a.includes("switch"),S=b;O?p=n(f[0],t,r,a,i,u,o,l,s,!0):h?p=n(f[0],t,r,a,i,!u,o,l,s):a.includes("val")?p=Gu(d,f,t,r,u,i,s)||Uu(d,f,t,r,u,o,i,s)||iv(e,o,l,r,i):(a.includes("switch")&&(p=fv(d,f,t,r,u,i,s)),p==null&&a.includes("group")&&(p=Bu(d,f,t,r,u,i,s,!1)),p==null&&a.includes("rule")&&(p=dv(d,f,t,r,u,i,s)),p&&S&&!["group","switch_group"].includes(p.type)&&(p=Fa(p,r)));var C=i.errors.length;return d!="!"&&p===void 0&&C==g&&i.errors.push("Can't parse logic ".concat(JSON.stringify(e))),O&&(p.properties.isLocked=!0),p},iv=function(e,t,r,a,i){var u;if(e===void 0&&(e=t?.defaultValue),e!==void 0){r=r||t?.mainWidget;var o=a.widgets[r],l=t?.type;if(l&&!o){i.errors.push("No widget for type ".concat(l));return}if(st(e)){i.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)));return}if(l==="time"&&typeof e=="number"){var s=Math.floor(e/60/60)%24,c=Math.floor(e/60)%60,d=e%60,f=o.valueFormat;if(f){var p=new Date(e);p.setMilliseconds(0),p.setHours(s),p.setMinutes(c),p.setSeconds(d),e=qn()(p).format(f)}else e="".concat(s,":").concat(c,":").concat(d)}if(["date","datetime"].includes(l)&&e&&!(e instanceof Date))try{var g=new Date(e);g instanceof Date&&g.toISOString()===e&&(e=g)}catch{i.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var v=o.valueFormat;v&&(e=qn()(e).format(v))}var m;if(e&&t!==null&&t!==void 0&&(u=t.fieldSettings)!==null&&u!==void 0&&u.asyncFetch){var h=Array.isArray(e)?e:[e];m=h}if(o!=null&&o.jsonLogicImport)try{e=o.jsonLogicImport.call(a.ctx,e)}catch(b){var O;i.errors.push("Can't import value ".concat(e," using import func of widget ").concat(r,": ").concat((O=b?.message)!==null&&O!==void 0?O:b)),e=void 0}return{valueSrc:"value",value:e,valueType:o?.type,asyncListValues:m}}},Gu=function(e,t,r,a,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(r.varKeys.includes(e)&&typeof t[0]=="string"){var l,s=di(a,t[0],o),c=je(a,s);if(!c&&!((l=u.settings)!==null&&l!==void 0&&l.allowUnknownFields)){u.errors.push("No config for field ".concat(s));return}return{valueSrc:"field",value:s,valueType:c?.type}}},ov=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:null,c=Object.keys(t)[0],d=Object.values(t)[0],f=function(H,U){return uv(H,U,a,i,u,l,s)||lv(H,U,a,i,u,o,l,s)},p=l.errors.length,g,v,m,h,O=f(c,d);if(O&&(g=O.field,v=O.fieldSrc),e&&(h=!0,m=r[0],r=[]),c=="reduce"&&Array.isArray(d)&&d.length==3){var b=d,S=(0,Le.A)(b,3),C=S[0],L=S[1],w=S[2];if(st(C)&&w==0&&st(L)&&Array.isArray(L["+"])&&L["+"][0]==1&&st(L["+"][1])&&L["+"][1].var=="accumulator")if(c=Object.keys(C)[0],d=Object.values(C)[0],c=="filter"){var D=d,V=(0,Le.A)(D,2),P=V[0],_=V[1];if(st(P)){c=Object.keys(P)[0],d=Object.values(P)[0];var B=f(c,d);B&&(g=B.field,v=B.fieldSrc,m=_,h=!0)}}else{var M=f(c,d);M&&(g=M.field,v=M.fieldSrc,h=!0)}}var q=l.errors.length;if(!g&&q==p&&l.errors.push("Unknown LHS ".concat(JSON.stringify(t))),!!g)return{field:g,fieldSrc:v,having:m,isGroup:h,args:r}},uv=function(e,t,r,a,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Array.isArray(t)||(t=[t]);var l=Gu(e,t,r,a,i,u,o);if(l)return{fieldSrc:"field",field:l.value}},lv=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=Uu(e,t,r,a,i,u,o,l);if(s)return{fieldSrc:"func",field:s.value}},Uu=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null;if(e){var s,c,d,f=e=="method";if(f){var p,g,v=(0,Du.A)(t);p=v[0],s=v[1],g=v.slice(2),c=[p].concat((0,Se.A)(g))}else s=e,c=t;var m=(f?"#":"")+s,h=u?.type||u?.returnType,O=(r.funcs[m]||[]).filter(function(U){return u?$r(a,U).returnType==h:!0});if(O.length)d=O[0];else{var b=(0,ne.A)({},e,t),S=Nu(ta(a)),C;try{for(S.s();!(C=S.n()).done;){var L=(0,Le.A)(C.value,2),w=L[0],D=L[1];if(D.jsonLogicImport&&(!h||D.returnType==h)){var V=void 0;try{V=D.jsonLogicImport(b)}catch{}V&&(d=w,c=V)}}}catch(U){S.e(U)}finally{S.f()}}if(d&&d){var P=$r(a,d),_=Object.keys(P.args||{}),B=c.reduce(function(U,te,J){var ae=_[J],ce=P.args[ae],oe;return ce&&(oe=Jn(te,r,a,["val"],o,!1,ce,null,l)),oe!==void 0?Zt(Zt({},U),{},(0,ne.A)({},ae,oe)):U},{});for(var M in P.args){var q=P.args[M],K=B[M];if(K===void 0){if(K=q?.defaultValue,K!==void 0){var H;K={value:K,valueSrc:(H=K)!==null&&H!==void 0&&H.func?"func":"value",valueType:q.type}}if(K===void 0){if(!(q!=null&&q.isOptional)){o.errors.push("No value for arg ".concat(M," of func ").concat(d));return}}else B[M]=K}}return{valueSrc:"func",value:{func:d,args:B},valueType:P.returnType}}}},Bu=function(e,t,r,a,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=r.conjunctions[e],c=a.settings.fieldSeparator;if(s){var d="group",f=t.map(function(b){return Jn(b,r,a,["rule","group"],u,!1,null,null,o)}).filter(function(b){return b!==void 0}).reduce(function(b,S){return Zt(Zt({},b),{},(0,ne.A)({},S.id,S))},{}),p=Object.values(f).map(function(b){var S,C;return(b==null||(S=b.properties)===null||S===void 0?void 0:S.fieldSrc)=="field"&&(b==null||(C=b.properties)===null||C===void 0?void 0:C.field)}).filter(function(b){var S;return b==null||(S=b.includes)===null||S===void 0?void 0:S.call(b,c)}),g=Object.fromEntries(tv(p).map(function(b){var S=b.split(c),C=Object.fromEntries(S.slice(0,-1).map(function(L,w,D){return[].concat((0,Se.A)(D.slice(0,w)),[L])}).map(function(L){return[L.join(c),je(a,L)]}).filter(function(L){var w=(0,Le.A)(L,2),D=w[0],V=w[1];return V?.type=="!group"}));return[b,Object.keys(C)]})),v={conjunction:s,not:i},m=cr(),h={},O={};return Object.entries(f).map(function(b){var S=(0,Le.A)(b,2),C=S[0],L=S[1];if(L?.type=="group"||L?.type=="rule_group")h[C]=L;else{var w,D=L==null||(w=L.properties)===null||w===void 0?void 0:w.field,V=g[D]||[],P=V[V.length-1];if(!P)L&&(h[C]=L);else{var _=h,B=Dr(o,a),M=Dr(P,a),q=ya(B,M.slice(0,B.length));q||(B=[]);var K=P.split(c).slice(B.length).map(function(H,U,te){return[].concat((0,Se.A)(B),(0,Se.A)(te.slice(0,U)),[H]).join(c)}).map(function(H){return{f:H,fc:je(a,H)||{}}}).filter(function(H){var U=H.fc;return U.type!="!struct"});K.map(function(H,U){var te=H.f,J=H.fc,ae=O[te];ae||(ae=cr(),O[te]=ae,_[ae]={type:"rule_group",id:ae,children1:{},properties:{conjunction:s,not:!1,field:te,fieldSrc:"field",mode:J.mode}}),_=_[ae].children1}),_[C]=L}}}),{type:d,id:m,children1:h,properties:v}}},sv=function(e,t,r,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(e)return{type:"rule_group",id:cr(),children1:(0,ne.A)({},e.id,e),properties:{conjunction:i||La(a,r),not:u,field:t}}},Fa=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:cr(),children1:(0,ne.A)({},e.id,e),properties:{conjunction:tn(t),not:r}}},cv=function(e,t,r,a,i,u,o){var l=no(o),s=$u(e,t,r,a,i,u,!1,l);if(s||(s=$u(e,t,r,a,i,u,!0,no(o))),!s){o.errors.push(l.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t));return}return s},$u=function(e,t,r,a,i,u,o,l){var s,c,d=(e==="all"||e==="some")&&st(r[1])&&Object.keys(r[1])[0]=="in"&&((s=r[1].in[0])===null||s===void 0?void 0:s.var)==="",f=!d&&u.settings.groupOperators.includes(e),p=["==","!="],g=f?0:t-1;f?g=0:p.includes(e)&&g==1&&r[1]===null&&(t=1,g=0,r=[r[0]]);var v=e+"/"+g,m=i.operators[(o?"#":"")+v];if(m){var h,O=[],b=["<","<=",">",">="];if(b.includes(e)&&t==3)h=r[1],O=[r[0],r[2]];else if(o)h=r[1],O=[r[0]];else{var S=r,C=(0,Du.A)(S);h=C[0],O=C.slice(1)}if(!st(h)){l.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)));return}var L=ov(f,h,O,i,u,null,null,l,a);if(L){var w=L.field,D=L.fieldSrc,V=L.having,P=L.isGroup,_=L.args,B=je(u,w);if(!B&&!((c=l.settings)!==null&&c!==void 0&&c.allowUnknownFields)){l.errors.push("No config for LHS ".concat(w));return}var M=m[0];if(m.length>1&&B&&B.operators){if(m=m.filter(function(q){return B.operators.includes(q)}),m.length==0){l.errors.push("No corresponding ops for LHS ".concat(w));return}M=m[0]}return{field:w,fieldSrc:D,fieldConfig:B,opKey:M,args:_,having:V}}}},dv=function n(e,t,r,a,i,u){var o,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;if(e){var c=t.length;if((e==="all"||e==="some")&&st(t[1])){var d,f=Object.keys(t[1])[0],p=((d=t[1][f][0])===null||d===void 0?void 0:d.var)==="";f==="in"&&p&&(t=[t[0],t[1][f][1]],e=e+"-"+f)}var g=cv(e,c,t,l,r,a,u);if(g){var v=g.field,m=g.fieldSrc,h=g.fieldConfig,O=g.opKey,b=g.args,S=g.having,C=je(a,l),L=a.operators[O],w=a.operators[(o=L)===null||o===void 0?void 0:o.reversedOp],D=!1,V=!!w,P=h.type=="!group",_=C?.type=="!group",B=V&&(!!a.settings.reverseOperatorsForNot||D||P&&!S||!P&&_&&!s),M=i&&B||D,q,K,H=!1;if(h?.type=="!group"&&S){for(q=Object.keys(S)[0],K=S[q],Array.isArray(K)||(K=[K]);q=="!";){var U=q=="!"&&K.length==1&&K[0]&&st(K[0])&&r.varKeys.includes(Object.keys(K[0])[0]);if(U)break;H=!H,S=S["!"],q=Object.keys(S)[0],K=S[q]}Array.isArray(K)||(K=[K])}M&&(i=!i,O=L.reversedOp,L=a.operators[O]);var te=wr(a,v,O,null),J=b.map(function(se){return Jn(se,r,a,["val"],u,!1,h,te,l)});if(!J.filter(function(se){return se===void 0}).length){var ae,ce=h?.type;if((ce==="!group"||ce==="!struct")&&(ce=null),h?.type=="!group"&&S){if(r.conjunctions[q]!==void 0)ae=Bu(q,K,r,a,H,u,v,!0);else if(ae=n(q,K,r,a,H,u,v,!0),ae){var oe;ae.type==="rule_group"&&((oe=ae.properties)===null||oe===void 0?void 0:oe.field)!==v&&(ae=sv(ae,v,h,a)),Object.assign(ae.properties,{conjunction:La(a,h)})}if(!ae)return;ae.type="rule_group",Object.assign(ae.properties,{field:v,mode:h.mode,operator:O}),h.mode=="array"&&Object.assign(ae.properties,{value:J.map(function(se){return se.value}),valueSrc:J.map(function(se){return se.valueSrc}),valueType:J.map(function(se){return se.valueType})}),i&&(ae=Fa(ae,a,i))}else if(h?.type=="!group"&&!S)ae={type:"rule_group",id:cr(),children1:{},properties:{conjunction:La(a,h),not:!1,mode:h.mode,field:v,operator:O}},h.mode==="array"&&Object.assign(ae.properties,{value:J.map(function(se){return se.value}),valueSrc:J.map(function(se){return se.valueSrc}),valueType:J.map(function(se){return se.valueType})}),i&&(ae=Fa(ae,a,i));else{var le=J.map(function(se){return se.asyncListValues}).filter(function(se){return se!=null}),fe=le.length?le[0]:void 0;ae={type:"rule",id:cr(),properties:Zt({field:v,fieldSrc:m,operator:O,value:J.map(function(se){return se.value}),valueSrc:J.map(function(se){return se.valueSrc}),valueType:J.map(function(se){return se.valueType})},fe?{asyncListValues:fe}:{})},(i||s)&&(ae=Fa(ae,a,i))}return ae}}}},fv=function(e,t,r,a,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(e?.toLowerCase()==="if"){var l=pv(t),s=l.map(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return[g?Jn(g,r,a,["rule","group"],u,!1,null,null,o):null,gv(a,u,r,v)]}),c=s.map(function(f){var p=(0,Le.A)(f,2),g=p[0],v=p[1];return vv(g,v,a,u)}),d={type:"switch_group",id:cr(),children1:c,properties:{}};return d}},pv=function(e){var t=[];function r(a){var i=(0,Le.A)(a,3),u=i[0],o=i[1],l=i[2];t.push([u,o]);var s=st(l)?Object.keys(l)[0]:null;s?.toLowerCase()==="if"?r(l[s]):t.push([void 0,l])}return r(e),t},vv=function(e,t,r,a){var i;return e?(i=Zt({},e),i.type?(i.type!="group"&&(i=Fa(i,r)),i.type="case_group"):(a.errors.push("Unexpected case: ".concat(JSON.stringify(i))),i=void 0)):i={id:cr(),type:"case_group",properties:{}},i&&(i.properties=Zt(Zt({},i.properties),t)),i},gv=function(e,t,r,a){var i=je(e,"!case_value");if(!i){t.errors.push("Missing caseValueField in settings");return}var u=i.mainWidget,o=e.widgets[u];if(!o){t.errors.push("No widget ".concat(u," for case value"));return}var l=Jn(a,r,e,["val","case_val"],t,!1,i,u);if(l!=null){var s=l.value,c=l.valueSrc,d=l.valueType,f={value:[s],valueSrc:[c??"value"],valueType:[d??o?.type],field:"!case_value"};return f}},mv=y(21450),hv=y(61526),yv=y.n(hv),Tn=yv();Tn.trim=function(n){return n.charAt(0)=="'"?n.substring(1,n.length-1):n},Tn.escapeLike=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=Tn.escape(n);return r=Tn.trim(r),r=r.replace(/[%_]/g,"\\$&"),r=(e?"%":"")+r+(t?"%":""),r="'"+r+"'",r};var Wu=function(e){var t="''",r=e?.type;return r=="date"?t="'0000-00-00'":r=="datetime"?t="'0000-00-00 00:00'":r=="time"?t="'00:00'":r=="number"&&(t="0"),t},Ku=function(e){var t="",r=e?.type;return r=="number"&&(t=0),t},Ov=function(e){return"'"+e.replace(/'/g,"''")+"'"},bv=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r,a,i=["int","float"];e.map(function(l){if(l!=null){if(typeof l=="string")a="String";else if(typeof l=="number")a=Number.isInteger(l)?"int":"float";else throw new Error("spelEscape: Can't use value ".concat(l," in array"));if(!r)r=a;else if(r!=a)if(i.includes(r)&&i.includes(a))r="float";else throw new Error("spelEscape: Can't use different types in array: found ".concat(r," and ").concat(a))}}),r||(r="String");var u;r=="float"?u=e.map(function(l){return Qn(l,!0)}):u=e.map(function(l){return Qn(l)});var o;return t?o="new ".concat(r,"[]{").concat(u.join(", "),"}"):o="{".concat(u.join(", "),"}"),o},zu=function(e){return"".concat(e,".?[true]")},Qn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(e==null)return"null";switch((0,Cr.A)(e)){case"boolean":return e?"true":"false";case"number":return!Number.isFinite(e)||isNaN(e)?void 0:e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return bv(e,r);throw new Error("spelEscape: Object is not supported");default:return Ov(e)}},Sv=function(e){return e&&Array.isArray(e)&&e.length?e.map(function(t){if(t.type=="const")return Qn(t.value);if(t.type=="property")return""+t.value;if(t.type=="variable")return"#"+t.value}).filter(function(t){return t!=null}).join(" + "):"null"},Fv=function(e){if(e==null)return[void 0,[]];var t=[],r=e.valueType=="case_value"?e.value:e,a=Array.isArray(r)?r:[r],i=a.map(function(u){if(u.valueSrc==="value")return u.value===null?void 0:{type:"const",value:u.value};if(u.valueSrc==="field")return{type:u.isVariable?"variable":"property",value:u.value};t.push("Unsupported valueSrc ".concat(u.valueSrc," in concatenation"))}).filter(function(u){return u!=null});return[i,t]},Hu=function(e){return e==null?"NULL":e.toString()},qu=function(e){return e==null||e?.[0]==="("&&e?.[e?.length-1]===")"?e:"("+e+")"};function Ju(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Cv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Cv(n,e){if(n){if(typeof n=="string")return Qu(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qu(n,e)}}function Qu(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Yu(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Xu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yu(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Yu(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Zu="${0}.compareTo(${1})",Tv={datetime:!0,time:!0,date:!0},Ev=function(e,t){return el(e,t,!1)},el=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},i=xt(t,void 0,!1),u=rl(e,i,a,null);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SpEL:",a.errors),u)},rl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var i=e.get("type");if(i==="group"||i==="rule_group")return nl(e,t,r,a);if(i==="rule")return wv(e,t,r,a);if(i=="switch_group")return Av(e,t,r,a);if(i=="case_group")return tl(e,t,r,a)}},tl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("type");if(i!="case_group"){r.errors.push("Unexpected child of type ".concat(i," inside switch"));return}var u=e.get("properties")||new he.Map,o=ao(t,u,r,null,a,"!case_value"),l=(0,Le.A)(o,3),s=l[0],c=l[1],d=l[2],f=nl(e,t,r,a);return[f,s]},Av=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("properties")||new he.Map,u=e.get("children1");if(u){var o=u.map(function(m){return tl(m,t,r,null)}).filter(function(m){return typeof m<"u"}).valueSeq().toArray();if(o.length){if(o.length==1&&!o[0][0])return o[0][1];for(var l=[],s=0;s<o.length;s++)s!=o.length-1&&!o[s][0]?r.errors.push("No condition for case ".concat(s)):(l.push(o[s]),s==o.length-1&&o[s][0]&&l.push([void 0,null]));for(var c="",d="",f=0;f<l.length;f++){var p=(0,Le.A)(l[f],2),g=p[0],v=p[1];v==null&&(v="null"),g==null&&(g="true"),f!=l.length-1?(c+="(".concat(g," ? ").concat(v," : "),d+=")"):c+="".concat(v)}return c+d}}},nl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("type"),u=e.get("properties")||new he.Map,o=u.get("mode"),l=e.get("children1")||new he.List,s=u.get("field"),c=u.get("conjunction");c||(c=tn(t));var d=t.conjunctions[c],f=u.get("not"),p=i==="rule_group",g=p&&o!="struct",v=g?s:a,m=je(t,v)||{},h=m.isSpelArray,O=t.settings.fieldSeparator,b=u.get("operator");!b&&(!o||o=="some")&&(b="some");var S=il(t,b,s),C=S!=b,L=b&&lr(t,S,s)||null,w=p&&(!S||L.cardinality==0),D=ao(t,u,r,S,a,null),V=(0,Le.A)(D,3),P=V[0],_=V[1],B=V[2],M=l.map(function(le){return rl(le,t,r,v)}).filter(function(le){return typeof le<"u"});if(g&&!w){if(P==null)return}else if(!M.size)return;var q=p,K=M.size?d.spelFormatConj.call(t.ctx,M,c,f,q):null,H;if(g){var U=oo(r,t,s,a),te=O||".",J=te+(h?"length":"size()"),ae="".concat(U).concat(J),ce=K?"".concat(U,".?[").concat(K,"]").concat(J):ae,oe=w?ae:P;H=al(r,t,u,ce,oe,S,_,B,C)}else H=K;return H},Lv=function(e,t,r){var a=t.spelOp;if(a){var i=a.includes("${0}"),u=Tv[r],o=a,l,s=Ur(t);return u?l=function(d,f,p,g,v,m,h,O){var b=Zu.replace(/\${(\w+)}/g,function(S,C){return C==0?d:s>1?p[C-1]:p});return"".concat(b," ").concat(o," 0")}:i?l=function(d,f,p,g,v,m,h,O){return a.replace(/\${(\w+)}/g,function(b,S){return S==0?d:s>1?p[S-1]:p})}:s==0?l=function(d,f,p,g,v,m,h,O){return"".concat(d," ").concat(o)}:s==1&&(l=function(d,f,p,g,v,m,h,O){return"".concat(d," ").concat(o," ").concat(p)}),l}},al=function(e,t,r,a,i,u,o,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=r.get("field"),d=lr(t,u,c)||{},f=je(t,c)||{},p=r.get("operatorOptions"),g=d.spelFormatOp||Lv(u,d,l);if(!g){e.errors.push("Operator ".concat(u," is not supported"));return}var v=[a,u,i,o,l,Pt(d,Kn),p,f],m;return m=g.call.apply(g,[t.ctx].concat(v)),s&&(m=t.settings.spelFormatReverse.call(t.ctx,m)),m===void 0&&e.errors.push("Operator ".concat(u," is not supported for value source ").concat(o)),m},il=function(e,t,r){if(t){var a=lr(e,t,r)||{},i=a.reversedOp,u=lr(e,i,r)||{},o=!1,l=a.spelOp||a.spelFormatOp,s=u.spelOp||u.spelFormatOp;if(!(!l&&!s)){if(!l&&s){o=!0;var c=[i,t];t=c[0],i=c[1];var d=[u,a];a=d[0],u=d[1]}return t}}},wv=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=e.get("properties")||new he.Map,u=i.get("field"),o=i.get("fieldSrc"),l=i.get("operator");if(!(u==null||l==null)){var s=il(t,l,u);if(!s){r.errors.push("Operator ".concat(l," is not supported"));return}var c=s!=l,d=ao(t,i,r,s,a,null),f=(0,Le.A)(d,3),p=f[0],g=f[1],v=f[2];if(p!==void 0){var m=jv(r,t,u,o,a);if(m!==void 0){var h=al(r,t,i,m,p,s,g,v,c);return h}}}},jv=function(e,t,r,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;return a==="func"?ol(e,t,r,i):oo(e,t,r,i)},ao=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");(u=="!case_value"||s&&s.get(0)=="case_value")&&(o="!case_value");var c=je(e,o)||{},d=lr(e,a,o)||{},f=Ur(d),p=t.get("value"),g=t.get("asyncListValues"),v=[],m=[],h;if(p!=null){var O=p.map(function(S,C){var L=l?l.get(C):null,w=s?s.get(C):null,D=Nn(S,L,e),V=wr(e,o,a,L),P=dt(e,o,a,V,L,{forExport:!0}),_=io(r,e,D,L,w,P,c,a,d,i,g);return _!==void 0&&(v.push(L),m.push(w)),_}),b=O.filter(function(S){return S===void 0}).size>0;O.size<f||b||(h=f>1?O.toArray():f==1?O.first():null)}return[h,v.length>1?v:v[0],m.length>1?m:m[0]]},io=function(e,t,r,a,i,u,o,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a==="field")f=oo(e,t,r,c);else if(a==="func")f=ol(e,t,r,c);else if(typeof u?.spelFormatValue=="function"){var p=u.spelFormatValue,g=[r,Xu(Xu({},Xt()(o,["fieldSettings","listValues"])),{},{asyncListValues:d}),Pt(u,In)];if(l&&(g.push(l),g.push(s)),a=="field"){var v=je(t,r)||{};g.push(v)}f=p.call.apply(p,[t.ctx].concat(g))}else f=Qn(r);return f}},oo=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(r){var i=t.settings.fieldSeparator,u=je(t,r)||{},o=Dr(r,t),l=Cs(r,t,a),s=t.settings.formatSpelField,c=mn(r,t,e,a),d=l.map(function(p){var g=(0,Le.A)(p,3),v=g[0],m=g[1],h=g[2],O;h&&(h.type=="!struct"||h.type=="!group"&&h.mode=="struct"?O=m.isSpelMap?"map":"class":h.type=="!group"?O=m.isSpelItemMap?"[map]":"[class]":O="class");var b=m?.isSpelVariable;return{key:v,parent:O,isSpelVariable:b,fieldSeparator:i}}),f=s.call(t.ctx,c,a,o,d,u,t);return f}},ol=function(e,t,r){var a,i,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(i=r.get)===null||i===void 0?void 0:i.call(r,"args"),s=$r(t,o);if(!s){e.errors.push("Func ".concat(o," is not defined in config"));return}var c={},d=[],f=[];for(var p in s.args){var g,v,m=s.args[p],h=je(t,m),O=m.defaultValue,b=m.isOptional,S=O!=null&&O.func?"func":"value",C=l?l.get(p):void 0,L=C?C.get("value"):void 0,w=C?C.get("valueSrc"):void 0;w!=="func"&&(g=L)!==null&&g!==void 0&&g.toJS&&(L=L.toJS());var D=C?C.get("asyncListValues"):void 0,V=(v=m.spelEscapeForFormat)!==null&&v!==void 0?v:!0,P=null,_=wr(t,m,P,w),B=dt(t,m,P,_,w,{forExport:!0}),M=io(e,t,L,w,m.type,B,h,null,null,u,D);if(L!=null&&M===void 0){w!="func"&&e.errors.push("Can't format value of arg ".concat(p," for func ").concat(o));return}var q=void 0;if(M===void 0&&!b&&O!=null){var K=wr(t,m,P,S),H=dt(t,m,P,K,S,{forExport:!0});if(q=io(e,t,O,S,m.type,H,h,null,null,u,D),q===void 0){S!="func"&&e.errors.push("Can't format default value of arg ".concat(p," for func ").concat(o));return}}var U=M??q;if(U!==void 0){var te;if(d.length){var J=Ju(d),ae;try{for(J.s();!(ae=J.n()).done;){var ce=ae.value;c[ce]=void 0}}catch(Ae){J.e(Ae)}finally{J.f()}d=[]}c[p]=V?U:(te=L)!==null&&te!==void 0?te:O}else b||f.push(p),d.push(p)}if(!f.length){var oe;if(typeof s.spelFormatFunc=="function"){var le=s.spelFormatFunc,fe=[c];oe=le.call.apply(le,[t.ctx].concat(fe))}else if(s.spelFunc){oe=s.spelFunc.replace(/\${(\w+)}/g,function(Ae,Re){var Ve;return(Ve=c[Re])!==null&&Ve!==void 0?Ve:Ae});var se=Object.keys(s.args||{}).reverse().filter(function(Ae){return!!s.args[Ae].isOptional}),me=Ju(se),Fe;try{for(me.s();!(Fe=me.n()).done;){var pe=Fe.value;if(c[pe]!=null)break;oe=oe.replace(new RegExp("(, )?\\${"+pe+"}","g"),"")}}catch(Ae){me.e(Ae)}finally{me.f()}oe=oe.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(o," is not supported"));return oe}};function en(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Rv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Rv(n,e){if(n){if(typeof n=="string")return ul(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ul(n,e)}}function ul(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function ll(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Rr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ll(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ll(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sl={number:"number",string:"text",boolean:"boolean",null:"null"},cl={String:"text"},Pv="multiselect",xv=function(e){return["length"].includes(e)},dl=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},Iv=function(e,t){return fl(e,t,!0)},fl=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},i=xt(t,void 0,!1),u=Nv(i),o,l,s=void 0;try{var c=mv.SpelExpressionEvaluator.compile(e);o=c._compiledExpression}catch(f){a.errors.push(f)}o&&(l=Vv(o,a),Cn.debug("convertedObj:",l,a),s=Ca(l,u,i,a),s&&s.type!="group"&&s.type!="switch_group"&&(s=Ea(s,i,l.not)),Cn.debug("jsTree:",s));var d=s?to(s):void 0;return r?[d,a.errors]:(a.errors.length&&console.warn("Errors while importing from SpEL:",a.errors),d)},Vv=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.getType(),i=e.getChildren().map(function(M){return n(M,t,e)});if((a=="op-or"||a=="op-and")&&(i=i.reduce(function(M,q){var K=q.type==a&&!q.not,H=K?q.children:[q];return[].concat((0,Se.A)(M),(0,Se.A)(H))},[])),a=="op-not")return i.length!=1&&t.errors.push("Operator NOT should have 1 child, but got ".concat(i.length,"}")),Rr(Rr({},i[0]),{},{not:!i[0].not});if(a=="compound"){i=i.filter(function(M){var q=M.type=="selection"&&M.children.length==1&&M.children[0].type=="boolean"&&M.children[0].val==!0;return!q});var u=i.find(function(M){return M.type=="selection"});u&&u.children.length!=1&&t.errors.push("Selection should have 1 child, but got ".concat(u.children.length));var o=u?u.children[0]:null,l=i[i.length-1],s=l.type=="method"&&l.val.methodName=="size"||l.type=="!func"&&l.methodName=="size",c=l.type=="property"&&l.val=="length",d=i.filter(function(M){return M!==u&&M!==l}),f={type:"compound",children:d},p=(s||c)&&pl(d)!=null;if(p)return{type:"!aggr",filter:o,source:f};if(i=i.filter(function(M){var q=M.type=="variable"&&M.val=="this",K=M.type=="variable"&&M.val=="root";return!(q||K)}),i=i.map(function(M){return M.type=="indexer"&&M.children.length==1?{type:"indexer",val:M.children[0].val,itype:M.children[0].type}:M}),l.type=="!func"){var g={},v=g;do{var m,h;Object.assign(v,l),i=i.filter(function(M){return M!==l}),l=i[i.length-1],((h=l)===null||h===void 0?void 0:h.type)=="!func"?(v.obj={},v=v.obj):i.length>1?v.obj={type:"compound",children:i}:v.obj=l}while(((m=l)===null||m===void 0?void 0:m.type)=="!func");return g}}var O;try{e.getRaw?O=e.getRaw():e.getValue.length==0&&(O=e.getValue())}catch(M){Cn.error("[spel2js] Error in getValue()",M)}if(a=="ternary"&&(O=Dv(i)),(0,Cr.A)(O)==="object"&&O!==null&&(O.methodName||O.functionName)&&(O.args=O.args.map(function(M){return n(M,t,e)})),a=="list"&&(O=O.map(function(M){return n(M,t,e)}),!r&&O.length==1))return O[0];if(a=="constructorref"){var b=i.find(function(M){return M.type=="qualifiedidentifier"}),S=b?.val;if(!S){t.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(i)));return}var C=i.filter(function(M){return M.type!="qualifiedidentifier"});return{type:"!new",cls:S,args:C}}if(a=="typeref"){var L=i.find(function(M){return M.type=="qualifiedidentifier"}),w=L?.val;if(!w){t.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(i)));return}var D=i.filter(function(M){return M.type!="qualifiedidentifier"});return{type:"!type",cls:w}}if(a=="function"||a=="method"){var V=O,P=V.functionName,_=V.methodName,B=V.args;return{type:"!func",methodName:P||_,isVar:a=="function",args:B}}return{type:a,children:i,val:O}},Dv=function(e){var t=[];function r(a){var i=(0,Le.A)(a,3),u=i[0],o=i[1],l=i[2];t.push([u,o]),l?.type=="ternary"?r(l.children):t.push([void 0,l])}return r(e),t},Nv=function(e){var t={},r=function(K){var H=e.operators[K];if(H.spelOps)H.spelOps.forEach(function(te){var J=te;t[J]||(t[J]=[]),t[J].push(K)});else if(H.spelOp){var U=H.spelOp;t[U]||(t[U]=[]),t[U].push(K)}else Cn.log("[spel] No spelOp for operator ".concat(K))};for(var a in e.operators)r(a);var i={};for(var u in e.conjunctions){var o=e.conjunctions[u],l=o.spelConj||u.toLowerCase();i[l]=u}var s={},c=en(ta(e)),d;try{var f=function(){var K=(0,Le.A)(d.value,2),H=K[0],U=K[1],te=[],J=U.spelFunc;if(typeof J=="string"){var ae=Object.keys(U.args||{}).reverse().filter(function(me){return!!U.args[me].isOptional||U.args[me].defaultValue!=null}),ce=J.replace(/\${(\w+)}/g,function(me,Fe){return"?"}),oe=ae.reduce(function(me,Fe){return[].concat((0,Se.A)(me),[[Fe].concat((0,Se.A)(me[me.length-1]||[]))])},[]).map(function(me){return J.replace(/(?:, )?\${(\w+)}/g,function(Fe,pe){return me.includes(pe)?"":Fe}).replace(/\${(\w+)}/g,function(Fe,pe){return"?"})});te=[ce].concat((0,Se.A)(oe))}var le=en(te),fe;try{for(le.s();!(fe=le.n()).done;){var se=fe.value;s[se]||(s[se]=[]),s[se].push(H)}}catch(me){le.e(me)}finally{le.f()}};for(c.s();!(d=c.n()).done;)f()}catch(q){c.e(q)}finally{c.f()}var p={};for(var g in e.widgets){var v=e.widgets[g],m=v.spelImportFuncs,h=v.type;if(m){var O=en(m),b;try{for(O.s();!(b=O.n()).done;){var S=b.value;if(typeof S=="string"){var C=S.replace(/\${(\w+)}/g,function(q,K){return"?"}),L=(0,Se.A)(S.matchAll(/\${(\w+)}/g)).map(function(q){var K=(0,Le.A)(q,2),H=K[0],U=K[1];return U});p[C]||(p[C]=[]),p[C].push({w:g,argsOrder:L})}}}catch(q){O.e(q)}finally{O.f()}}}var w={};for(var D in e.operators){var V=e.operators[D],P=V.spelOp;if(P!=null&&P.includes("${0}")){var _=P.replace(/\${(\w+)}/g,function(q,K){return"?"}),B=(0,Se.A)(P.matchAll(/\${(\w+)}/g)).map(function(q){var K=(0,Le.A)(q,2),H=K[0],U=K[1];return U});w[_]||(w[_]=[]),w[_].push({op:D,argsOrder:B})}}var M=Zu.replace(/\${(\w+)}/g,function(q,K){return"?"});return w[M]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:i,funcs:s,valueFuncs:p,opFuncs:w}},Ca=function n(e,t,r,a){var i,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e){e._groupField=(i=e._groupField)!==null&&i!==void 0?i:u?._groupField;var o,l=!0;if(e.type.indexOf("op-")===0||e.type==="matches")o=kv(e,t,r,a,u);else if(e.type=="!aggr"){var s,c=n(e.source,t,r,a,e);e._groupField=c?.value;var d=n(e.filter,t,r,a,e);((s=d)===null||s===void 0?void 0:s.type)=="rule"&&(d=Ea(d,r,e.filter.not)),o={groupFilter:d,groupFieldValue:c},u||(o=void 0,a.errors.push("Unexpected !aggr in root"),l=!1)}else if(e.type=="ternary"){var f={};e.val.forEach(function(g){var v=(0,Le.A)(g,2),m=v[0],h=v[1],O=gl(m,h,t,r,a,e);O&&(f[O.id]=O)}),o={type:"switch_group",id:cr(),children1:f,properties:{}}}if(!o&&l&&(o=Ta(e,t,r,a,u)),o&&!o.type&&!u){var p=vl(e,t,r,a);p?o=p:(o=void 0,a.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return o}},kv=function n(e,t,r,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u,o=e.type.startsWith("op-")?e.type.slice(3):e.type,l=(o=="minus"||o=="plus")&&e.children.length==1;if(l){var s=e.negative;return o=="minus"&&(s=!s),e.children[0].negative=s,Ca(e.children[0],t,r,a,i)}var c=o=="and"&&e.children.length==2&&e.children[0].type=="op-ge"&&e.children[1].type=="op-le",d=o=="or"&&e.children.length==2&&e.children[0].type=="op-lt"&&e.children[1].type=="op-gt",f=c||d;if(f){var p=(0,Le.A)(e.children[0].children,2),g=p[0],v=p[1],m=(0,Le.A)(e.children[1].children,2),h=m[0],O=m[1],b=Wv(g,h,e,t,r,a,i);if(b){var S=v.val,C=O.val,L={type:"op-between",children:[g,v,O],not:d};return L._groupField=i?._groupField,n(L,t,r,a,i)}}var w=t.operators[o];o=="eq"&&e.children[1].type=="null"?w=["is_null"]:o=="ne"&&e.children[1].type=="null"?w=["is_not_null"]:o=="le"&&e.children[1].type=="string"&&e.children[1].val==""?w=["is_empty"]:o=="gt"&&e.children[1].type=="string"&&e.children[1].val==""?w=["is_not_empty"]:o=="between"&&(w=["between"]);var D=function(){var Ne,Je=e.children.map(function(ar){return Ca(ar,t,r,a,e)});return Je.length>=2&&((Ne=Je)===null||Ne===void 0||(Ne=Ne[0])===null||Ne===void 0?void 0:Ne.type)=="!compare"&&(Je=Je[0].children),Je};if(o=="and"||o=="or"){var V={},P=D();P.forEach(function(Te){if(Te){var Ne=cr();Te.id=Ne,Te.type!=null?V[Ne]=Te:a.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(Te)))}}),u={type:"group",id:cr(),children1:V,properties:{conjunction:t.conjunctions[o],not:e.not}}}else if(w){var _,B,M,q=D(),K=q[0],H=q.slice(1),U=K==null||(_=K.groupFieldValue)===null||_===void 0?void 0:_.value,te=(B=H)===null||B===void 0?void 0:B[0],J=w[0];if(w.length>1){var ae,ce,oe=((ae=q[0])===null||ae===void 0?void 0:ae.valueType)||((ce=q[1])===null||ce===void 0?void 0:ce.valueType),le=K?.value,fe=w.map(function(Te){return{op:Te,widget:wr(r,le,Te)}});if(Cn.warn("[spel] Spel operator ".concat(o," can be mapped to ").concat(w,"."),"widgets:",fe,"vals:",q,"valueType=",oe),o=="eq"||o=="ne"){var se=fe.find(function(Te){var Ne=Te.op,Je=Te.widget;return Je&&Je!="field"});se&&(J=se.op)}}K!=null&&K.groupFieldValue&&(te&&te.groupFieldValue&&te.groupFieldValue.valueSrc=="field"&&te.groupFieldValue.value==U?(J="all",H=[]):J=="equal"&&te.valueSrc=="value"&&te.valueType=="number"&&te.value==0?(J="none",H=[]):J=="greater"&&te.valueSrc=="value"&&te.valueType=="number"&&te.value==0&&(J="some",H=[]));var me=r.operators[J],Fe=r.operators[(M=me)===null||M===void 0?void 0:M.reversedOp],pe=e.not&&["between"].includes(J),Ae=!!Fe,Re=Ae&&(!!r.settings.reverseOperatorsForNot||pe),Ve=e.not&&Re||pe;Ve&&(J=me.reversedOp,me=r.operators[J],e.not=!e.not);var Ie=!!e.not;if(e.not=!1,K)if(K.groupFieldValue)K.groupFieldValue.valueSrc!="field"&&a.errors.push("Expected group field ".concat(JSON.stringify(K))),u=$v(K,J,H,r,a);else{K.valueSrc!="field"&&K.valueSrc!="func"&&a.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(K)));var De=K.value;u=uo(r,a,De,J,H,e)}Ie&&(u.type!=="group"?u=Ea(u,r,!0):u.properties.not=!u.properties.not)}else i||(u=vl(e,t,r,a));return u},pl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,i=e.map(function(u){if(u.type=="variable"||u.type=="property"||u.type=="indexer"&&u.itype=="string")return u.val;var o,l;a=!0,r&&(t==null||(o=t.errors)===null||o===void 0||(l=o.push)===null||l===void 0||l.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(u))))});return a?void 0:i},Ta=function n(e,t,r,a){var i,u,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(e!=null){var l=r.settings.fieldSeparator;if(e._groupField=(i=e._groupField)!==null&&i!==void 0?i:o?._groupField,e.type=="variable"||e.type=="property"){var s=di(r,e.val,e._groupField),c=je(r,s),d=e.type=="variable";return{valueSrc:"field",valueType:c?.type,isVariable:d,value:s}}else if(e.type=="compound"){var f=pl(e.children,a);if(f){var p,g=di(r,f.join(l),e._groupField),v=je(r,g),m=((p=e.children)===null||p===void 0||(p=p[0])===null||p===void 0?void 0:p.type)=="variable";return{valueSrc:"field",valueType:v?.type,isVariable:m,value:g}}}else if(sl[e.type]){var h=e.val,O=sl[e.type];return e.negative&&(h=-h),{valueSrc:"value",valueType:O,value:h}}else if(e.type=="!new"&&cl[e.cls.at(-1)]){var b=e.args.map(function(B){return n(B,t,r,a,e)}),S=b?.[0],C=cl[e.cls.at(-1)];return Rr(Rr({},S),{},{valueType:C})}else if(e.type=="list"){var L,w=e.val.map(function(B){return n(B,t,r,a,e)}),D=w.length?(L=w[0])===null||L===void 0?void 0:L.valueType:null,V=w.map(function(B){return B?.value}),P=Pv;return{valueSrc:"value",valueType:P,value:V}}else if(e.type==="op-plus"&&o?.type==="ternary"&&((u=r.settings.caseValueField)===null||u===void 0?void 0:u.type)==="case_value")return ml(e,t,r,a);var _=Gv(e,t,r,a,o);if(_!==void 0)return _;a.errors.push("Can't convert arg of type ".concat(e.type))}},Mv=function(e){var t=[{s:"",params:[],objs:[]}];return _v(e,t),t.map(function(r){var a=r.s,i=r.params;return{s:a,params:i}}).reverse().filter(function(r){var a=r.s;return a!==""&&a!=="?"})},_v=function n(e,t){var r=[],a="",i=e.type,u=e.methodName,o=e.val,l=e.obj,s=e.args,c=e.isVar,d=e.cls,f=e.children,p=f?.[f.length-1],g=t[t.length-1];if(i==="!func"){for(var v=l;v;){var m,h=n(Rr(Rr({},v),{},{obj:null}),[{}]),O=(0,Le.A)(h,2),b=O[0],S=O[1];if(b!=="?"){var C={s:g.s,params:(0,Se.A)(g.params),objs:(0,Se.A)(g.objs)};g.objs.unshift("?"),g.params.unshift(v),t.push(C),g=t[t.length-1]}g.objs.unshift(b),(m=g.params).unshift.apply(m,(0,Se.A)(S)),v=v.type==="!func"?v.obj:null}var L=en(t),w;try{for(L.s();!(w=L.n()).done;){var D,V=w.value;r=[].concat((0,Se.A)(V?.params||[]),(0,Se.A)(s||[])),a="",V!=null&&(D=V.objs)!==null&&D!==void 0&&D.length&&(a+=V.objs.join(".")+"."),a+=(c?"#":"")+u,a+="("+(s||[]).map(function(P){return"?"}).join(", ")+")",V.s=a,V.params=r}}catch(P){L.e(P)}finally{L.f()}}else i==="!new"?(r=s||[],a="new ".concat(d.join("."),"(").concat(r.map(function(P){return"?"}).join(", "),")")):i==="!type"?a="T(".concat(d.join("."),")"):i==="compound"&&p.type==="property"&&xv(p.val)?a=f.map(function(P){var _;if(P===p)return P.val;var B=n(Rr(Rr({},P),{},{obj:null}),[{}]),M=(0,Le.A)(B,2),q=M[0],K=M[1];return(_=r).push.apply(_,(0,Se.A)(K)),q}).join("."):(r=[e],a="?");return g&&(g.s=a,g.params=r),[a,r]},Gv=function(e,t,r,a){var i,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,o=function(H){return Ca(H,t,r,a,e)},l=Mv(e),s=l==null||(i=l[0])===null||i===void 0?void 0:i.s;l.length&&Cn.debug("Signatures for ",e,":",s,l);var c=Uv(e,t,r,a,u,l,o);if(c!==void 0)return c;var d=Bv(e,t,r,a,u,l,o);if(d!==void 0)return d;var f,p,g,v=en(l),m;try{var h=function(){var H=m.value,U=H.s,te=H.params,J=t.funcs[U];if(J){f=J[0],p=$r(r,f);var ae=p,ce=ae.spelFunc,oe=te.map(o),le=(0,Se.A)(ce.matchAll(/\${(\w+)}/g)).map(function(fe){var se=(0,Le.A)(fe,2),me=se[0],Fe=se[1];return Fe});return g=Object.fromEntries(le.map(function(fe,se){return[fe,oe[se]]})),1}};for(v.s();!(m=v.n()).done&&!h(););}catch(K){v.e(K)}finally{v.f()}if(!f){var O=en(ta(r)),b;try{for(O.s();!(b=O.n()).done;){var S=(0,Le.A)(b.value,2),C=S[0],L=S[1];if(L.spelImport){var w=void 0;try{w=L.spelImport(e)}catch{}if(w){f=C,p=$r(r,f),g={};for(var D in w)g[D]=o(w[D])}}}}catch(K){O.e(K)}finally{O.f()}}if(f){var V={};for(var P in p.args){var _=p.args[P],B=g[P];if(B===void 0)if(B=_?.defaultValue,B===void 0){if(!(_!=null&&_.isOptional)){a.errors.push("No value for arg ".concat(P," of func ").concat(f));return}}else{var M;B={value:B,valueSrc:(M=B)!==null&&M!==void 0&&M.func?"func":"value",valueType:_.type}}B&&(V[P]=B)}return{valueSrc:"func",value:{func:f,args:V},valueType:p.returnType}}var q=e.methodName;q&&a.errors.push("Signature ".concat(s," - failed to convert"))},Uv=function(e,t,r,a,i,u,o){var l,s,c,d=[];for(var f in r.widgets){var p=r.widgets[f],g=p.spelImportFuncs;if(g)for(var v=0;v<g.length;v++){var m=g[v];if(dl(m)){var h={};if(Cu(m,e,h)){for(var O in h)h[O]=o(h[O]);d.push({s:"widgets.".concat(f,".spelImportFuncs[").concat(v,"]"),w:f,argsObj:h})}}}}var b=en(u),S;try{for(b.s();!(S=b.n()).done;){var C=S.value,L=C.s,w=C.params,D=t.valueFuncs[L]||[],V=en(D),P;try{var _=function(){var me=P.value,Fe=me.w,pe=me.argsOrder,Ae=w.map(o),Re=Object.fromEntries(pe.map(function(Ve,Ie){return[Ve,Ae[Ie]]}));d.push({s:L,w:Fe,argsObj:Re})};for(V.s();!(P=V.n()).done;)_()}catch(se){V.e(se)}finally{V.f()}}}catch(se){b.e(se)}finally{b.f()}for(var B=0,M=d;B<M.length;B++){var q=M[B],K=q.s,H=q.w,U=q.argsObj,te=r.widgets[H],J=te.spelImportValue,ae=te.type;c=H,s=K,l=[];for(var ce in U)["value"].includes(U[ce].valueSrc)||l.push("".concat(ce," has unsupported value src ").concat(U[ce].valueSrc));var oe=U.v.value;if(J&&!l.length){var le=J.call(r.ctx,U.v,te,U),fe=(0,Le.A)(le,2);oe=fe[0],l=fe[1],l&&!Array.isArray(l)&&(l=[l])}if(!l.length)return{valueSrc:"value",valueType:ae,value:oe}}c&&l.length&&a.errors.push("Signature ".concat(s," - looks like convertable to ").concat(c,", but: ").concat(l.join("; ")))},Bv=function(e,t,r,a,i,u,o){var l,s,c,d=en(u),f;try{for(d.s();!(f=d.n()).done;){var p=f.value,g=p.s,v=p.params,m=t.opFuncs[g]||[],h=en(m),O;try{var b=function(){var L,w=O.value,D=w.op,V=w.argsOrder,P=v.map(o);if(s=D,D==="!compare"){if(i.type.startsWith("op-")&&i.children.length==2&&i.children[1].type=="number"&&i.children[1].val===0)return{v:{type:"!compare",children:P}};l.push("Result of compareTo() should be compared to 0")}c=g,l=[];var _=r.operators[s],B=_.spelOp,M=_.valueTypes,q=Object.fromEntries(V.map(function(te,J){return[te,P[J]]})),K=q[0],H=Object.keys(q).filter(function(te){return parseInt(te)>0}).map(function(te){return q[te]}),U=(L=P.filter(function(te){return!!te}).find(function(te){var J=te.valueSrc;return J==="value"}))===null||L===void 0?void 0:L.valueType;if(M&&U&&!M.includes(U)&&l.push("Op supports types ".concat(M,", but got ").concat(U)),!l.length)return{v:uo(r,a,K,s,H,e)}},S;for(h.s();!(O=h.n()).done;)if(S=b(),S)return S.v}catch(C){h.e(C)}finally{h.f()}}}catch(C){d.e(C)}finally{d.f()}s&&l.length&&a.errors.push("Signature ".concat(c," - looks like convertable to ").concat(s,", but: ").concat(l.join("; ")))},uo=function(e,t,r,a,i,u){var o,l;if(!i.filter(function(_){return _===void 0}).length){var s=(o=r)!==null&&o!==void 0&&o.func?"func":"field";dl(r)&&r.valueSrc&&(s=r.valueSrc,r=r.value);var c=je(e,r);if(!c){t.errors.push("No config for field ".concat(r));return}var d=je(e,u?._groupField),f=c.type=="!group",p=f&&c.mode=="array",g=d?.type=="!group",v=e.operators[a],m=e.operators[(l=v)===null||l===void 0?void 0:l.reversedOp],h=u?.not&&["between"].includes(a),O=!!m,b=O&&(!!e.settings.reverseOperatorsForNot||h||!f&&g),S=u?.not&&b||h;S&&(a=v.reversedOp,v=e.operators[a],u.not=!u.not);var C=!!(u!=null&&u.not),L=wr(e,r,a),w=e.widgets[L||c.mainWidget],D=i.map(function(_){return _.asyncListValues}).filter(function(_){return _!=null}),V=D.length?D[0]:void 0,P={type:"rule",id:cr(),properties:Rr({field:r,fieldSrc:s,operator:a,value:i.map(function(_){return _.value}),valueSrc:i.map(function(_){return _.valueSrc}),valueType:i.map(function(_){return _.valueSrc=="value"&&(w?.type||c?.type)||_.valueType})},V?{asyncListValues:V}:{})};return C&&(P=Ea(P,e,u.not)),P}},$v=function(e,t,r,a,i){var u=e.groupFilter,o=e.groupFieldValue;if(o.valueSrc!="field")throw"Bad groupFieldValue: ".concat(JSON.stringify(o));var l=o.value,s=uo(a,i,l,t,r);if(s){var c=je(a,l),d=c?.mode,f;return u?.type==="group"?f=Rr(Rr({},u||{}),{},{type:"rule_group",properties:Rr(Rr(Rr({},s.properties),u?.properties||{}),{},{mode:d})}):u?f=Rr(Rr({},s||{}),{},{type:"rule_group",children1:[u],properties:Rr(Rr({},s.properties),{},{mode:d})}):f=Rr(Rr({},s||{}),{},{type:"rule_group",properties:Rr(Rr({},s.properties),{},{mode:d})}),f.id||(f.id=cr()),f}},Wv=function(e,t,r,a,i,u){if(e.type==t.type)if(e.type=="!aggr"){var o=[e.source,t.source].map(function(v){return Ta(v,a,i,u,r)}),l=(0,Le.A)(o,2),s=l[0],c=l[1];return s.value==c.value}else{var d=[e,t].map(function(v){return Ta(v,a,i,u,r)}),f=(0,Le.A)(d,2),p=f[0],g=f[1];return p.value==g.value}return!1},vl=function(e,t,r,a){var i={},u=null,o=gl(u,e,t,r,a);o&&(i[o.id]=o);var l={type:"switch_group",id:cr(),children1:i,properties:{}};return l},gl=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=Kv(a,i,r,t,u),l;return e?(l=Ca(e,r,a,i,u),l&&l.type?(l.type!="group"&&(l=Ea(l,a)),l.type="case_group"):(i.errors.push("Unexpected case: ".concat(JSON.stringify(l))),l=void 0)):l={id:cr(),type:"case_group",properties:{}},l&&(l.properties=Rr(Rr({},l.properties),o)),l},ml=function(e,t,r,a){var i=[];function u(o){o.map(function(l){if(l.type==="op-plus")u(l.children);else{var s=Ta(l,t,r,a,e);s?i.push(s):a.errors.push("Can't convert ".concat(l.type," in concatenation"))}})}return u(e.children),{valueSrc:"value",valueType:"case_value",value:i}},Kv=function(e,t,r,a){var i,u,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,l={},s,c,d,f=je(e,"!case_value");if(a?.type==="op-plus"&&((i=e.settings.caseValueField)===null||i===void 0?void 0:i.type)==="case_value")c="case_value",s=ml(a,r,e,t);else if(c=f?.mainWidget,d=e.widgets[c],s=Ta(a,r,e,t,o),s&&s.valueSrc==="value"){var p;s.valueType=((p=d)===null||p===void 0?void 0:p.type)||f?.type||s.valueType}var g=e.widgets[c];if(c==="case_value"){var v=g?.spelImportValue;if(v){var m=v.call(e.ctx,s),h=(0,Le.A)(m,2),O=h[0],b=h[1];if(b.map(function(C){return t.errors.push(C)}),O!=null){var S;l={value:[O],valueSrc:["value"],valueType:[(S=g?.type)!==null&&S!==void 0?S:"case_value"],field:"!case_value"}}}}else s!=null&&((u=s)===null||u===void 0?void 0:u.value)!=null&&(l={value:[s.value],valueSrc:[s.valueSrc],valueType:[s.valueType],field:"!case_value"});return l},Ea=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return{type:"group",id:cr(),children1:(0,ne.A)({},e.id,e),properties:{conjunction:tn(t),not:r||!1}}};function hl(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function zv(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hl(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):hl(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var yl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=e.settings.defaultField,i=(r?Ol(e,r):a)||t&&ec(e,r)||null;return i!=null&&typeof i!="string"&&!zn(i)&&(i=Sa(i)),i},Ol=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!r)return null;var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".",i=je(e,r),u=i?.defaultField;return u&&(u=[].concat((0,Se.A)(Dr(r)),[u]).join(a)),u},lo=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r&&((t=e.settings.fieldSources)===null||t===void 0?void 0:t[0])||"field"},so=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=je(e,t),i=a?.operators||[],u=e.settings.defaultOperator;u&&!i.includes(u)&&(u=null);var o=a?.defaultOperator,l=a?.ownDefaultOperator,s=r?Co(e,t):null,c=l||u||o||s;return c},Aa=function(e,t,r){var a=t?lr(e,t,r):null;return a&&a.options?new he.default.Map(a.options&&a.options.defaults||{}):null},rn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=null,o=null,l=null,s=e.settings.showErrorMessage;if(r){var c,d,f;l=r==null||(c=r.properties)===null||c===void 0?void 0:c.fieldSrc,u=r==null||(d=r.properties)===null||d===void 0?void 0:d.field,o=r==null||(f=r.properties)===null||f===void 0?void 0:f.operator}else a?(u=yl(e,i,t),u?l=zn(u)?"func":"field":l=lo(e),o=so(e,u,!0)):l=lo(e);var p=new he.default.Map({fieldSrc:l,field:u,operator:o,value:new he.default.List,valueSrc:new he.default.List,operatorOptions:Aa(e,o,u)});if(s&&(p=p.set("valueError",new he.default.List)),u&&o){var g=!1,v=Vn(e,e,p,u,o,"operator",g),m=v.newValue,h=v.newValueSrc,O=v.newValueType,b=v.newValueError,S=v.newFieldError;p=p.set("value",m).set("valueSrc",h).set("valueType",O),s&&(p=p.set("valueError",b).set("fieldError",S))}return p},La=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;t=je(e,t);var r=t&&t.conjunctions||Object.keys(e.conjunctions);return r.length==1?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},tn=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},En=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new he.default.Map({conjunction:La(e,t),not:!1})},bl=function(e,t){var r;return t&&t.type=="group"?En(e,t==null||(r=t.properties)===null||r===void 0?void 0:r.field):rn(e,null,t)},Sl=function(e,t){return(0,ne.A)({},e,new he.default.Map({type:"rule",id:e,properties:rn(t)}))},Hv=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new he.default.Map({type:"group",id:cr(),children1:new he.default.OrderedMap(t?zv({},Sl(cr(),e)):{}),properties:En(e)})},qv=function(e){return Qa(e)?e:Fl([e])},Fl=function(e){return Qa(e)?e:new he.default.List(e)},Jv=function(){return new he.default.Map};function Cl(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Qv(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Qv(n,e){if(n){if(typeof n=="string")return Tl(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Tl(n,e)}}function Tl(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function El(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Al(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?El(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):El(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Ll=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i={errors:[],settings:{isForDisplay:r,isDebugMode:a}},u=xt(t,void 0,!1),o=wl(e,u,i,null);return i.errors.length&&console.warn("Errors while exporting to string:",i.errors),o},wl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(e){var i=e.get("type"),u=e.get("children1");if(i==="group"||i==="rule_group")return Yv(e,t,r,a);if(i==="rule")return jl(e,t,r,a)}},Yv=function(e,t,r){var a,i,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=r.settings,l=o.isForDisplay,s=o.isDebugMode,c=e.get("type"),d=e.get("properties")||new he.Map,f=d.get("mode"),p=e.get("children1")||new he.List,g=c==="rule_group",v=g&&f=="array"?d.get("field"):null,m=c==="rule_group"?d.get("operator"):null,h=m?(a=(i=t.operators[m])===null||i===void 0?void 0:i.cardinality)!==null&&a!==void 0?a:1:void 0,O=g&&f==="array"&&h>=1,b=d.get("not"),S=p.map(function(M){return wl(M,t,r,v)}).filter(function(M){return typeof M<"u"});if(!(!O&&!S.size&&!s)){var C=d.get("conjunction");C||(C=tn(t));var L=t.conjunctions[C],w=S.size?L.formatConj.call(t.ctx,S,C,b,l):null,D;if(v){var V=jl(e,t,r,u,!0);if(V){var P,_=V.pop(),B=[w].concat((0,Se.A)(V));D=(P=t.settings.formatAggr).call.apply(P,[t.ctx].concat((0,Se.A)(B))),_&&(D=t.settings.formatReverse.call(t.ctx,D,null,null,null,null,l))}}else D=w;return s&&D==null&&(D="?"),D}},Xv=function(e,t,r,a,i){var u=r.settings,o=u.isForDisplay,l=u.isDebugMode,s=t.get("field"),c=t.get("valueSrc"),d=t.get("valueType"),f=je(e,s)||{},p=a||t.get("operator"),g=lr(e,p,s)||{},v=Ur(g),m=t.get("value"),h=t.get("asyncListValues"),O=[],b=[],S,C;if(m!=null){C=m.map(function(D,V){var P=c?c.get(V):null,_=d?d.get(V):null,B=l?D:Nn(D,P,e),M=wr(e,s,p,P),q=dt(e,s,p,M,P,{forExport:!0}),K=co(e,r,B,P,_,q,f,p,g,i,h);return K!==void 0&&(O.push(P),b.push(_)),K});var L=C.filter(function(D){return D===void 0}).size>0,w=!L&&C.size===v;w&&(S=v==1?C.first():C)}return l&&!S&&(S=v>1?new he.List(Array.from({length:v}).map(function(D,V){var P,_;return(P=(_=C)===null||_===void 0?void 0:_.get(V))!==null&&P!==void 0?P:"?"})):"?"),[S,O.length>1?O:O[0],b.length>1?b:b[0]]},Zv=function(e,t,r){var a=r.settings.isDebugMode,i=t?.labelForFormat||e,u=Ur(t),o;return u==0?o=function(s,c,d,f,p,g,v,m){return"".concat(s," ").concat(i)}:u==1?o=function(s,c,d,f,p,g,v,m){return a&&c==="?"&&d==="?"?s&&s!=="?"?"".concat(s," ?"):"?":"".concat(s," ").concat(i," ").concat(d)}:u==2&&(o=function(s,c,d,f,p,g,v,m){var h,O,b=d==null||(h=d.first)===null||h===void 0?void 0:h.call(d),S=d==null||(O=d.get)===null||O===void 0?void 0:O.call(d,1);return"".concat(s," ").concat(i," ").concat(b," AND ").concat(S)}),o},jl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=r.settings,o=u.isForDisplay,l=u.isDebugMode,s=e.get("properties")||new he.Map,c=s.get("field"),d=s.get("fieldSrc"),f=s.get("operator"),p=s.get("operatorOptions");if(!((c==null||f==null)&&!l)){var g=je(t,c)||{},v=lr(t,f,c)||{},m=v.reversedOp,h=lr(t,m,c)||{},O=!1,b=v.formatOp;if(!b&&m&&(b=h.formatOp,b)){O=!0;var S=[m,f];f=S[0],m=S[1];var C=[h,v];v=C[0],h=C[1]}if(l&&!f&&(f="?"),b||(b=Zv(f,v,r)),!!b){var L=d==="func"?Pl(t,r,c,a):Rl(t,r,c,a);if(L!=null){var w=Xv(t,s,r,f,a),D=(0,Le.A)(w,3),V=D[0],P=D[1],_=D[2];if(V!==void 0){var B=[L,f,V,P,_,Pt(v,Kn),p,o,g,O];if(i)return B;var M,q=(M=b).call.apply(M,[t.ctx].concat(B));return O&&(q=t.settings.formatReverse.call(t.ctx,q,f,m,v,h,o)),q}}}}},co=function(e,t,r,a,i,u,o,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0,f=t.settings,p=f.isForDisplay,g=f.isDebugMode;if(r===void 0)return g?u?.jsType==="array"?[]:"?":void 0;var v;if(a=="field")v=Rl(e,t,r,c);else if(a=="func")v=Pl(e,t,r,c);else if(typeof u?.formatValue=="function"){var m=u.formatValue,h=[r,Al(Al({},Xt()(o,["fieldSettings","listValues"])),{},{asyncListValues:d}),Pt(u,In),p];if(l&&(h.push(l),h.push(s)),a=="field"){var O=je(e,r)||{};h.push(O)}v=m.call.apply(m,[e.ctx].concat(h))}else v=r;return v},Rl=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=t.settings,o=u.isForDisplay,l=u.isDebugMode,s=e.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=null;if(r){var p=je(e,r)||{},g=Dr(r,e),v=ja(r,e,i?a:null),m=v?v.join(d):null,h=p.label2||m,O=e.settings.formatField,b=mn(r,e,t,i?a:null,{useTableName:!0});f=O(b,g,h,p,e,o)}else l&&(f="?");return f},Pl=function(e,t,r){var a,i,u,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=t.settings,s=l.isForDisplay,c=l.isDebugMode,d=r==null||(a=r.get)===null||a===void 0?void 0:a.call(r,"func");if(!d)return c?"?()":void 0;var f=(i=r.get)===null||i===void 0?void 0:i.call(r,"args"),p=$r(e,d);if(!p&&!c){t.errors.push("Func ".concat(d," is not defined in config"));return}var g=Dr(d,e),v=g[g.length-1],m=s&&p?.label||v,h={},O=[],b=[],S={},C=p?Object.keys(p.args||{}):(f==null||(u=f.keySeq)===null||u===void 0?void 0:u.call(f).toArray())||[],L=Cl(C),w;try{for(L.s();!(w=L.n()).done;){var D,V=w.value,P=p?.args[V],_=je(e,P),B=P||{},M=B.defaultValue,q=B.isOptional,K=M!=null&&M.func?"func":"value",H=s&&P?.label||V,U=f?f.get(V):void 0,te=U?U.get("value"):void 0,J=U?U.get("valueSrc"):void 0;J!=="func"&&(D=te)!==null&&D!==void 0&&D.toJS&&(te=te.toJS());var ae=U?U.get("asyncListValues"):void 0,ce=co(e,t,te,J,P?.type,_,P,null,null,o,ae);te!=null&&ce===void 0&&J!="func"&&t.errors.push("Can't format value of arg ".concat(V," for func ").concat(d));var oe=void 0;if(ce===void 0&&!q&&M!=null&&(oe=co(e,t,M,K,P?.type,_,P,null,null,o,ae),oe===void 0)){K!="func"&&t.errors.push("Can't format default value of arg ".concat(V," for func ").concat(d));return}var le=ce??oe;if(le!==void 0){if(O.length){var fe=Cl(V),se;try{for(fe.s();!(se=fe.n()).done;){var me=(0,Le.A)(se.value,2),Fe=me[0],pe=me[1];h[Fe]=void 0}}catch(De){fe.e(De)}finally{fe.f()}O=[]}h[V]=le,S[H]=le}else q||b.push(V),O.push([V,H])}}catch(De){L.e(De)}finally{L.f()}if(!(b.length&&!c)){var Ae=null;if(typeof p?.formatFunc=="function"){var Re=p.formatFunc,Ve=[h,s];Ae=Re.call.apply(Re,[e.ctx].concat(Ve))}else{var Ie=Object.entries(s?S:h).map(function(De){var Te=(0,Le.A)(De,2),Ne=Te[0],Je=Te[1];return s?"".concat(Ne,": ").concat(Je):"".concat(Je)}).join(", ");Ae="".concat(m,"(").concat(Ie,")")}return Ae}},xl="EMPTY_GROUP",Il="EMPTY_RULE_GROUP",Vl="EMPTY_QUERY",Dl="EMPTY_CASE",Nl="NO_CONFIG_FOR_FIELD",kl="NO_CONFIG_FOR_OPERATOR",eg="FIXED_OPERATOR",Ml="NO_CONFIG_FOR_FUNCTION",_l="INVALID_VALUE",Gl="INVALID_FUNC_ARG_VALUE",Ul="UNSUPPORTED_FIELD_TYPE",Bl="UNSUPPORTED_OPERATOR_FOR_FIELD",$l="INVALID_VALUE_SRC",fo="INCOMPLETE_RULE",Wl="INCOMPLETE_LHS",Kl="INCOMPLETE_RHS",po="BAD_MULTISELECT_VALUES",zl="BAD_SELECT_VALUE",Hl="INCORRECT_VALUE_TYPE",ql="INCORRECT_VALUE_JS_TYPE",Jl="VALUE_LENGTH_CONSTRAINT_FAIL",vo="VALUE_MIN_CONSTRAINT_FAIL",go="VALUE_MAX_CONSTRAINT_FAIL",Ql="NO_CONFIG_FOR_FIELD_VALUE",Yl="CANT_COMPARE_FIELD_WITH_ITSELF",Xl="CANT_COMPARE_FIELD_WITH_FIELD",Zl="INCORRECT_FIELD_TYPE",es="UNSUPPORTED_FUNCTION_FOR_FIELD",rs="REQUIRED_FUNCTION_ARG",ts="INCORRECT_FUNCTION_RETURN_TYPE",ns="INVALID_RANGE",gn="ITEM_POSITION",as="ITEM_POSITION_ROOT",is="ITEM_POSITION_WITH_INDEX_PATH",os="ITEM_POSITION_IN_CASE",mo="range",rg=y(72635),Yn,tg=(Yn={},(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,xl,"Empty group"),Il,"No conditions for group field {{field}}"),Vl,"Empty query"),Dl,"Empty case"),Nl,"No config for field {{field}}"),eg,"Fixed operator {{from}} to {{to}} for field {{field}}"),kl,"No config for operator {{operator}}"),Ml,"No config for function {{funcKey}}"),_l,"Invalid value"),Gl,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,Ul,"Type of field {{field}} is not supported"),Bl,"Operator {{operator}} is not supported for field {{field}}"),fo,"Incomplete rule"),Wl,"Incomplete LHS"),Kl,"Incomplete RHS"),$l,"Invalid value src {{valueSrcs, list}}"),po+"_one","Value {{badValues, list}} is not in the list of allowed values"),po+"_other","Values {{badValues, list}} are not in the list of allowed values"),zl,"Value {{value}} is not in the list of allowed values"),Hl,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,ql,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),Jl,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),vo,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),vo+"_"+mo,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),go,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),go+"_"+mo,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Ql,"No config for field {{field}}"),Yl,"Can't compare field {{field}} with itself"),Xl,"Can't compare field {{leftField}} with {{rightField}}"),Zl,"Field {{field}} is of type {{type}}, but expected {{expected}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,es,"Unsupported function {{funcKey}} for field {{field}}"),rs,"Value of arg {{argName}} for func {{funcName}} is required"),ts,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),ns,"Invalid range"),as,"Root"),gn+"__rule","Leaf #{{globalLeafNo}}"),gn+"__group","Group #{{globalGroupNo}}"),gn+"__rule_group","Rule-group #{{globalNoByType}}"),gn+"__case_group","Case #{{globalNoByType}}"),gn+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),(0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)((0,ne.A)(Yn,gn+"__group__deleted","Deleted group #{{globalGroupNo}}"),gn+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),gn+"__case_group__deleted","Deleted case #{{globalNoByType}}"),os,"{{str}} in case #{{caseNo}}"),is,"{{str}} (index path: {{indexPath, list}})")),us="raqbvalidation",ng="".concat(us,":"),ni=rg.default.createInstance();ni.init({fallbackLng:"en"}),ni.addResources("en",us,tg);var qt=function n(e,t){return e!=null&&e.str?e.str:e!=null&&e.key?n(e.key,e.args):t===null?e:ni.t(e.includes(":")?e:ng+e,t)};const ag=ni;function ls(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Lr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ls(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ls(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var ss=function(e){return(0,Cr.A)(e)==="object"&&e!==null&&Array.isArray(e)?"array":(0,Cr.A)(e)},ig=function(e,t){return ss(e)===t||t==="number"&&!isNaN(e)},ho=function(e,t){return yo(e,t).length===0},yo=function(e,t){var r=t.settings.showErrorMessage,a=[];function i(u,o,l){var s,c,d=u.get("id"),f=u.get("children1"),p=u.getIn(["properties","valueError"]),g=u.getIn(["properties","fieldError"]),v=u.getIn(["properties","field"]),m=(s=v==null||(c=v.get)===null||c===void 0?void 0:c.call(v,"func"))!==null&&s!==void 0?s:v,h=p?.size>0&&p.filter(function(b){return b!=null}).size>0,O=h||!!g;O&&r&&a.push(m),f&&f.map(function(b,S){b&&i(b,o.concat(d),l+1)})}return e&&i(e,[],0),Array.from(new Set(a))},Oo=function(e,t){var r=xt(t,void 0,!0),a={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},i=wa(e,null,r,r,a),u=i.fixedTree,o=i.allErrors,l=i.isSanitized;return l&&o.length&&console.warn("Tree check errors: ",o),u},cs=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=xt(t,void 0,!0),i=Lr(Lr({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1}),u=wa(e,null,a,a,i),o=u.allErrors;return o},ds=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=xt(t,void 0,!0),i=Lr({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),u=wa(e,null,a,a,i),o=u.fixedTree,l=u.fixedErrors,s=u.nonFixedErrors,c=u.allErrors;return{fixedTree:o,fixedErrors:l,nonFixedErrors:s,allErrors:c}},fs=function(e,t,r,a,i,u,o){i===void 0&&(i=r.settings.removeEmptyGroupsOnLoad),u===void 0&&(u=r.settings.removeEmptyRulesOnLoad),o===void 0&&(o=r.settings.removeIncompleteRulesOnLoad);var l={removeEmptyGroups:i,removeEmptyRules:u,removeIncompleteRules:o,forceFix:!1},s=wa(e,t,r,a,l),c=s.fixedTree,d=s.allErrors,f=s.fixedErrors,p=s.nonFixedErrors,g=s.isSanitized;return g&&f.length&&console.warn("Fixed tree errors: ",f),c=Ht(c),c},wa=function(e,t,r,a,i){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var u=i||{},o=u.removeEmptyGroups,l=u.removeEmptyRules,s=u.removeIncompleteRules,c=u.forceFix,d=u.translateErrors,f=d===void 0?!0:d,p=u.includeStringifiedItems,g=p===void 0?!0:p,v=u.stringifyFixedItems,m=v===void 0?!1:v,h=u.stringifyItemsUserFriendly,O=h===void 0?!0:h,b=u.includeItemsPositions,S=b===void 0?!0:b,C={config:r,oldConfig:a,removeEmptyGroups:o,removeEmptyRules:l,removeIncompleteRules:s,forceFix:c},L={errors:{}},w=vs(e,[],null,L,C),D=L.sanitized,V=[],P,_;S&&(P=Yi(w).items);for(var B in L.errors){var M=L.errors[B],q=M.path,K=M.errors;f&&(K=K.map(function(Qe){return Lr(Lr({},Qe),{},{str:qt(Qe)})}));var H={path:q,errors:K};if(g){var U=Hn(m?w:e,q),te=q.length===1;if(!te&&U.get("type")!=="group"){var J=!0,ae=O,ce=Ll(U,r,ae,J);H.itemStr=ce}}if(S){var oe=P[B],le=!oe;if(le&&(_||(_=Yi(e).items),oe=_[B]),oe){var fe=Lr(Lr({},oe.position),{},{index:oe.index,type:oe.type,isDeleted:le});H.itemPosition=fe;var se=oe.index?gn+"__"+oe.type+(le?"__deleted":""):as,me=Lr({},fe);if(O){for(var Fe,pe=0,Ae=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];pe<Ae.length;pe++){var Re=Ae[pe];me[Re]!=null&&(me[Re]=me[Re]+1)}me.indexPath=(Fe=fe.indexPath)===null||Fe===void 0?void 0:Fe.map(function(Qe){return Qe+1})}H.itemPositionStr=qt(se,me),oe.index&&(oe.caseId&&oe.type!=="case_group"&&(H.itemPositionStr=qt(os,Lr(Lr({},me),{},{str:H.itemPositionStr}))),oe.type!=="case_group"&&(H.itemPositionStr=qt(is,Lr(Lr({},me),{},{str:H.itemPositionStr}))))}}V.push(H)}for(var Ve=[],Ie=[],De=0,Te=V;De<Te.length;De++){var Ne=Te[De],Je=Ne.errors.filter(function(Qe){return!!Qe.fixed}),ar=Ne.errors.filter(function(Qe){return!Qe.fixed&&Qe.key!=="EMPTY_QUERY"});Je.length&&Ve.push(Lr(Lr({},Ne),{},{errors:Je})),ar.length&&Ie.push(Lr(Lr({},Ne),{},{errors:ar}))}return{fixedTree:w,allErrors:V,fixedErrors:Ve,nonFixedErrors:Ie,isSanitized:D}};function An(n,e,t,r){var a=e.get("id");n.errors[a]||(n.errors[a]={path:[].concat((0,Se.A)(t),[a]),errors:[]}),n.errors[a].errors.push(r)}function ps(n,e){var t=e.get("id");n.errors[t]&&n.errors[t].errors.map(function(r){r.fixed=!0})}function vs(n,e,t,r,a){var i=n?.get("type");return i==="group"||i==="rule_group"||i=="case_group"||i=="switch_group"?og(n,e,t,r,a):i==="rule"?gs(n,e,t,r,a):n}function og(n,e,t,r,a){var i,u,o,l,s,c,d=a.removeEmptyGroups,f=a.removeIncompleteRules,p=a.forceFix,g=a.config,v=g.settings.showErrorMessage,m=!v||p,h=n.get("id"),O=n.get("children1"),b=!e.length,S=O,C=n.get("type"),L=n.get("properties"),w=L?.get("field"),D=L?.get("mode"),V=L==null||(i=L.get)===null||i===void 0?void 0:i.call(L,"operator"),P=C==="rule_group"&&D==="array",_=C==="case_group",B=_&&O==null,M=V?(u=(o=g.operators[V])===null||o===void 0?void 0:o.cardinality)!==null&&u!==void 0?u:1:void 0,q=_?!B:P?M==0:d,K=P||_;!h&&t&&(h=t,n=n.set("id",h),r.sanitized=!0),K&&(n=gs(n,e,t,r,a));var H={errors:{}};O=(l=O)===null||l===void 0?void 0:l.map(function(ce,oe){return vs(ce,e.concat(h),oe,H,a)});var U=(s=O)===null||s===void 0?void 0:s.filter(function(ce){return ce!=null});d&&(O=U);var te=H.sanitized||S?.size!=((c=O)===null||c===void 0?void 0:c.size),J=!(U!=null&&U.size),ae=d&&!b;return P&&w&&(ae=f),J&&q&&(An(r,n,e,{key:b?Vl:_?Dl:P?Il:xl,args:{field:w},fixed:ae}),ae&&(ps(r,n),n=void 0)),te&&(r.sanitized=!0),te&&n&&(n=n.set("children1",O)),r.errors=Lr(Lr({},r.errors),H?.errors||{}),n}function gs(n,e,t,r,a){var i=a.removeIncompleteRules,u=a.removeEmptyRules,o=a.forceFix,l=a.config,s=a.oldConfig,c=l.settings.showErrorMessage,d=!c||o,f=n,p=n.get("id"),g=n.get("type"),v=g==="case_group",m=n.get("properties");if(!m)if(v)m=new he.default.Map;else{var h={key:fo,args:{},fixed:i||u};An(r,n,e,h);return}var O=m.get("field")||null;v&&(O="!case_value");var b=m.get("fieldSrc")||null,S=m.get("operator")||null,C=m.get("operatorOptions"),L=m.get("valueSrc"),w=m.get("value"),D=m.get("valueError"),V=m.get("fieldError"),P=function(){var Te,Ne;return{field:((Te=O)===null||Te===void 0||(Ne=Te.toJS)===null||Ne===void 0?void 0:Ne.call(Te))||O,fieldSrc:b,operator:S,operatorOptions:C?C.toJS():{},valueSrc:L?L.toJS():null,value:w?w.toJS():null,valueError:D?D.toJS():null,fieldError:V||null}},_=P();!p&&t&&(p=t,n=n.set("id",p),r.sanitized=!0);var B=O?je(l,O):null;O&&!B&&(An(r,n,e,{key:Nl,args:{field:O},side:"lhs",fixed:i||u}),O=null),O==null&&!v&&(m=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce(function(De,Te){return De.delete(Te)},m),S=null),!b&&O&&!v&&(b=Zs(O),m=m.set("fieldSrc",b)),(S==="range_between"||S==="range_not_between")&&(S=S==="range_between"?"between":"not_between",m=m.set("operator",S));var M=S?lr(l,S,O):null;S&&!M&&(An(r,n,e,{key:kl,args:{operator:S},side:"op",fixed:i||u}),S=null);var q=O?oi(l,O):[];O&&!v&&(q!=null&&q.length?S&&q.indexOf(S)==-1&&(S==="is_empty"||S==="is_not_empty"?(S=S==="is_empty"?"is_null":"is_not_null",m=m.set("operator",S)):(An(r,n,e,{key:Bl,args:{operator:S,field:O},side:"lhs",fixed:i||u}),S=null)):(An(r,n,e,{key:Ul,args:{field:O},side:"lhs",fixed:i||u}),S=null)),S==null&&!v&&(m=["operatorOptions","valueSrc","value","valueError"].reduce(function(De,Te){return De.delete(Te)},m)),C=m.get("operatorOptions"),!S||C&&!M.options?(C=null,m=m.delete("operatorOptions")):S&&!C&&M.options&&(C=Aa(l,S,O),m=m.set("operatorOptions",C)),L=m.get("valueSrc"),w=m.get("value");var K=!0,H=Vn(l,s,m,O,S,null,d,K),U=H.newValue,te=H.newValueSrc,J=H.newValueError,ae=H.validationErrors,ce=H.newFieldError,oe=H.fixedField;w=U,L=te,D=J,V=ce,O=oe,m=m.set("field",O),m=m.set("value",w),m=m.set("valueSrc",L),c?m=m.set("valueError",D).set("fieldError",V):m=m.delete("valueError").delete("fieldError");var le=P(),fe=!Ja(_,le),se=wo(m.toObject(),l),me=v?se.parts.value:se.score>=3;if(fe&&(r.sanitized=!0,n=n.set("properties",m)),ae?.map(function(De){return An(r,n,e,De)}),!me&&!v){var Fe=se.score?i:u,pe={key:fo,args:{}};if(!se.parts.field)pe.key=Wl,pe.side="lhs";else if(!se.parts.value){var Ae,Re,Ve,Ie;pe.key=Kl,pe.side="rhs",(Ae=le.valueSrc)!==null&&Ae!==void 0&&Ae[0]&&((Re=le.valueSrc)===null||Re===void 0?void 0:Re[0])!=((Ve=_.valueSrc)===null||Ve===void 0?void 0:Ve[0])&&((Ie=le.value)===null||Ie===void 0?void 0:Ie[0])!=null&&(pe.key=$l,pe.args={valueSrcs:le.valueSrc})}pe.fixed=Fe,An(r,n,e,pe),Fe&&(ps(r,n),n=void 0)}return n}var Xn=function(e,t,r,a,i,u,o,l){var s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,f=[],p=i;if(i!=null){var g,v,m,h;if(o==="field"){var O=sg(t,r,i,o,u,l,e,a,s,c),b=(0,Le.A)(O,2);p=b[0],f=b[1]}else if(o==="func"){var S=cg(t,r,i,o,u,l,e,a,s,c,d),C=(0,Le.A)(S,2);p=C[0],f=C[1]}else if(o==="value"||!o){var L=lg(r,i,o,u,l,e,a,s,c),w=(0,Le.A)(L,2);p=w[0],f=w[1]}var D=!((g=f)!==null&&g!==void 0&&g.find(function(fe){return!fe.fixed})),V=!!r&&!["field","func"].includes(o)&&(!((v=f)!==null&&v!==void 0&&v.length)||D);if(V){var P=wr(e,r,a,o),_=a?lr(e,a,r):null,B=dt(e,r,a,P,o,{forExport:!0}),M=o==="field"?je(e,i):null,q=B,K=B.validateValue;if(typeof K=="function"){var H=[p,q,a,_];o==="field"&&H.push(M);var U=K.call.apply(K,[e.ctx].concat(H));if((0,Cr.A)(U)==="object"&&U!==null&&!Array.isArray(U)){var te,J;(te=U.error)!==null&&te!==void 0&&te.key?J=Lr({},U.error):J={key:U.error,args:null},U.fixedValue!==void 0&&s&&(J.fixed=!0,J.fixedFrom=p,J.fixedTo=U.fixedValue,p=U.fixedValue),f.push(J)}else typeof U=="boolean"?U==!1&&f.push({key:_l,args:{}}):typeof U=="string"&&f.push({key:U,args:null})}}if(D=!((m=f)!==null&&m!==void 0&&m.find(function(fe){return!fe.fixed})),(h=f)!==null&&h!==void 0&&h.length&&!D&&s){var ae=je(e,r),ce=ae?.fieldSettings,oe=ce?.defaultValue;if(oe!==void 0){var le=f[f.length-1];le.fixed=!0,le.fixedFrom=p,le.fixedTo=oe,p=oe,f.map(function(fe){fe.fixed=!0})}}}return[p,f]},ug=function(e,t,r,a,i){var u=he.default.List.isList(e)?e.toJS():e instanceof Array?(0,Se.A)(e):void 0,o=e,l=[];if(u){var s=u.reduce(function(m,h){var O=(0,Le.A)(m,2),b=O[0],S=O[1],C=ba(t,h);return C==null?[b,[].concat((0,Se.A)(S),[h])]:[[].concat((0,Se.A)(b),[C.value]),S]},[[],[]]),c=(0,Le.A)(s,2),d=c[0],f=c[1],p=f.length>0;if(r=r||i===!0,o=r&&p?d:e,f.length){var g=r&&p;l.push({key:po,args:{badValues:f,count:f.length},fixed:g,fixedFrom:g?u:void 0,fixedTo:g?o:void 0})}return[o,l]}else{var v=ba(t,e);return v==null?(o=r?null:e,l.push({key:zl,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?o:void 0})):o=v.value,[o,l]}},lg=function(e,t,r,a,i,u){var o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=[],d=t;if(e){var f=je(u,e),p=wr(u,e,o,r),g=u.widgets[p],v=g?.type,m=g?.jsType,h=f?.fieldSettings,O=h?.treeValues||h?.listValues,b=!!(h!=null&&h.asyncFetch),S=O||b;if(a&&v&&a!=v)return c.push({key:Hl,args:{wType:v,valueType:a}}),[t,c];if(m&&!ig(t,m)&&!S)return c.push({key:ql,args:{jsType:m,valueTypeof:ss(t)}}),[t,c];if(h){var C=i||O;if(C&&!h.allowCustomValues&&p!=="case_value"){var L=ug(t,C,l,s,u.settings.removeInvalidMultiSelectValuesOnLoad),w=(0,Le.A)(L,2);d=w[0],c=w[1]}h.maxLength>0&&t!=null&&String(t).length>h.maxLength&&(d=l?String(t).substring(0,h.maxLength):t,c.push({key:Jl,args:{value:t,length:String(t).length,fieldSettings:h},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0}));var D=h.min!=null&&h.max!=null?mo:void 0;h.min!=null&&t<h.min&&(d=l?h.min:t,c.push({key:vo,args:{value:t,fieldSettings:h,context:D},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0})),h.max!=null&&t>h.max&&(d=l?h.max:t,c.push({key:go,args:{value:t,fieldSettings:h,context:D},fixed:l,fixedFrom:l?t:void 0,fixedTo:l?d:void 0}))}}return[d,c]},sg=function(e,t,r,a,i,u,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,s=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,d=[],f=o.settings,p=f.fieldSeparator,g=f.canCompareFieldWithField,v=(0,Cr.A)(t)=="object"&&t?._isFuncArg,m=Array.isArray(e)?e.join(p):e,h=je(o,e),O=Array.isArray(r)?r.join(p):r,b=je(o,r);if(!b)return d.push({key:Ql,args:{field:O}}),[r,d];if(e&&O===m&&!v)return d.push({key:Yl,args:{field:m}}),[r,d];if(i&&i!=b.type)return d.push({key:Zl,args:{field:O,type:b.type,expected:i}}),[r,d];if(e&&!v&&g){var S=g(m,h,O,b,l);if(!S)return d.push({key:Xl,args:{leftField:m,rightField:O}}),[r,d]}return[r]},cg=function(e,t,r,a,i,u,o){var l,s,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,d=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1,f=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,p=arguments.length>10&&arguments[10]!==void 0?arguments[10]:!1,g=r,v=[];if(!r)return[r];var m=(l=r.get)===null||l===void 0?void 0:l.call(r,"func");if(!m)return[r];var h=je(o,t);if(h!=null&&h.funcs&&!h.funcs.includes(m))return v.push({key:es,args:{funcKey:m,field:t}}),[r,v];var O=$r(o,m);if(!O)return v.push({key:Ml,args:{funcKey:m}}),[r,v];var b=(s=O.label)!==null&&s!==void 0?s:m;if(i&&O.returnType!=i)return v.push({key:ts,args:{funcKey:m,funcName:b,returnType:O.returnType,valueType:i}}),[r,v];d=d||p;for(var S in O.args){var C,L=O.args[S],w=g.get("args"),D=w?w.get(S):void 0,V=je(o,L),P=(C=V?.label)!==null&&C!==void 0?C:S,_=D?D.get("value"):void 0,B=D?D.get("valueSrc"):void 0;if(_!==void 0){var M=Xn(o,e,V,c,_,L.type,B,u,d,f,p),q=(0,Le.A)(M,2),K=q[0],H=q[1],U=!(H!=null&&H.length),te=d&&K!==_,J=d&&!U&&!te&&(f||p);if(te&&(g=g.setIn(["args",S,"value"],K)),J&&(g=g.deleteIn(["args",S]),g=ai(o,g,O,S)),!U){var ae,ce,oe=(ae=(ce=H.find(function(pe){return!pe.fixed&&!pe.ignore}))!==null&&ce!==void 0?ce:H.find(function(pe){return!pe.fixed}))!==null&&ae!==void 0?ae:H[0],le=te||J,fe=H.filter(function(pe){return!pe.ignore}).length===0;if(oe){var se=qt(oe);v.push({key:Gl,args:{funcKey:m,funcName:b,argKey:S,argName:P,argValidationError:se,argErrors:H},ignore:fe,fixed:le,fixedFrom:le?_:void 0,fixedTo:le?te?K:L.defaultValue:void 0})}}}else if(!L.isOptional&&(f||p)){var me=d&&L.defaultValue!==void 0&&(f||p),Fe=f;Fe&&v.push({key:rs,args:{funcKey:m,funcName:b,argKey:S,argName:P},fixed:me,fixedTo:me?L.defaultValue:void 0,ignore:!me}),me&&(g=g.deleteIn(["args",S]),g=ai(o,g,O,S))}}return[g,v]},bo=function(e,t,r,a,i){var u=lr(e,r,t),o=r?Ur(u):null,l=i.toJS?i.toJS():i,s=a.toJS?a.toJS():a,c=l.filter(function(h){return h=="value"||h==null}).length==o,d;if(u!=null&&u.validateValues&&c){var f=l[0],p=wr(e,t,r,f),g=dt(e,t,r,p,f),v=g!=null&&g.toJS?s.map(function(h){var O=g.toJS.call(e.ctx,h,g);return O instanceof Date&&(O=O.getTime()),O}):s,m=u.validateValues(v);typeof m=="boolean"&&m==!1&&(d={key:ns,args:{jsValues:v,values:s}})}return d},Vn=function(e){var t,r,a,i,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,p=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;u||(u=e);var g=e.settings,v=g.keepInputOnChangeFieldSrc,m=g.convertableWidgets,h=g.clearValueOnChangeField,O=g.clearValueOnChangeOp,b=l=="!case_value",S=o.get("field");!S&&b&&(S=l);var C=o.get("fieldType"),L=o.get("fieldSrc"),w=o.get("operator"),D=o.get("value"),V=o.get("valueSrc",new he.default.List),P=o.get("valueType",new he.default.List),_=o.get("valueError",new he.default.List),B=o.get("asyncListValues"),M=b,q=lr(u,w),K=lr(e,s,l),H=b?1:w?Ur(q):null,U=b?1:s?Ur(K):null,te=je(u,S),J=je(e,l),ae=!S&&C&&v,ce=te?.type||C,oe=J?.type||!l&&ae&&ce,le=te?.listValuesType,fe=J?.listValuesType,se=((t=S)===null||t===void 0||(r=t.get)===null||r===void 0?void 0:r.call(t,"func"))||S,me=((a=l)===null||a===void 0||(i=a.get)===null||i===void 0?void 0:i.call(a,"func"))||l,Fe=me!=se,pe=[],Ae=(S||ae)&&(w&&s||M)&&D!=null;(!(ce&&oe&&ce==oe)||c==="field"&&Fe&&h||c==="operator"&&O)&&(Ae=!1),Fe&&ii.includes(oe)&&(fe&&fe===le||(Ae=!1)),!M&&(!(D!=null&&D.size)&&U||D!=null&&D.size&&!U)&&(Ae=!1);var Re;if(L==="func"&&l){var Ve=Xn(e,null,null,s,l,oe,L,B,d,f,p),Ie=(0,Le.A)(Ve,2),De=Ie[0],Te=Ie[1],Ne=!(Te!=null&&Te.length),Je=De!==l,ar=!Ne&&Je&&!Te.find(function(vt){return!vt.fixed}),Qe=d&&!Ne&&!ar&&!!c&&l!==S,Yr=!1;if(Yr?l=null:Qe?l=S:Je&&(l=De),!Ne){var Tr=!Ne&&!ar&&!Yr&&!Qe,Pr=Te.find(function(vt){return!vt.fixed&&!vt.ignore});Tr&&Pr&&(Re=qt(Pr)),Te.map(function(vt){return pe.push(Lr(Lr({side:"lhs"},vt),{},{fixed:vt.fixed||Qe||Yr}))})}}for(var ir=0;ir<U;ir++){var at=V.get(ir)||null,bt=wr(u,S,w,at),it=wr(e,l,s,at),St=at==="value"?bt:wr(u,S,w,"value"),or=at==="value"?it:wr(e,l,s,"value"),Lt=or==St||(m[St]||[]).includes(or)||!St&&ae;Lt||(Ae=!1)}w!=s&&[w,s].includes("proximity")&&(Ae=!1);var Vt=V.first(),zr=dt(e,l,s,null,Vt),ot=Ts(e,l,s,null);!l&&ae&&(ot=Object.keys(e.settings.valueSourcesInfo));var ur=ot[0],Xr;U===1&&zr&&zr.type!==void 0?Xr=zr.type:U===1&&J&&J.type!==void 0&&(Xr=J.type==="!group"?"number":J.type);var Jr=Ae&&c==="operator"&&H===1&&U===2,_r=[],ft=[],wn=[],pt=Array.from({length:U},function(){return null});if(Ae)for(var Gr=function(jr){var pr=D.get(jr),Dt=P.get(jr)||null,yn=V.get(jr)||null;Jr&&jr===1&&(pr=_r[0]!==void 0?_r[0]:D.get(0),_r[jr]=pr,Dt=P.get(0)||null,yn=V.get(0)||null);var $b=yn?ot.find(function($t){return $t==yn})!==void 0:!0,Wb=Xn(e,l,l,s,pr,Dt,yn,B,d,f,p),Vp=(0,Le.A)(Wb,2),Dp=Vp[0],Ct=Vp[1],ka=!(Ct!=null&&Ct.length),Ii=Dp!==pr,Kb=!ka&&Ii&&!(Ct!=null&&Ct.find(function($t){return!$t.fixed})),zb=!(Ct!=null&&Ct.find(function($t){return!$t.fixed&&!$t.ignore})),Np=!$b||d&&!ka&&!Kb&&(!zb||Fe);ka||Ct?.map(function($t){return pe.push(Lr(Lr({side:"rhs",delta:jr},$t),{},{fixed:$t.fixed||Np}))}),Np&&(_r[jr]=null,jr===0&&delete _r[1]);var Hb=!ka&&!Ii,kp=Ct?.find(function($t){return!$t.fixed&&!$t.ignore});Hb&&kp&&(pt[jr]=qt(kp)),Ii&&(_r[jr]=Dp),Jr&&jr===0&&!ka&&!Ii&&(Jr=!1),Jr&&jr===0&&["func","field"].includes(yn)&&(Jr=!1)},Ge=0;Ge<U;Ge++)Gr(Ge);if(!Ae){for(var Ue=0;Ue<U;Ue++)if(U===1){var rr,sr=Eu([J?.defaultValue,J==null||(rr=J.fieldSettings)===null||rr===void 0?void 0:rr.defaultValue,zr?.defaultValue]);_r[Ue]=sr,sr!=null&&sr.func&&(ft[Ue]="func")}}for(var Or=0;Or<U;Or++){var Vr=Ae&&V.get(Or)||null,xr=Ae&&P.get(Or)||null;if(Ae&&Jr&&Or===1){var wt,Nr;Vr=(wt=ft[Or])!==null&&wt!==void 0?wt:V.get(0),xr=(Nr=wn[Or])!==null&&Nr!==void 0?Nr:P.get(0),ft[Or]=Vr,wn[Or]=xr}var jn=ot.includes(Vr);jn||(ft[Or]=ur),xr||(wn[Or]=Xr)}var Zr=D;(_r.length>0||!Ae)&&(Zr=new he.default.List(Array.from({length:U},function(vt,jr){return _r[jr]!==void 0?_r[jr]:Ae?D.get(jr):void 0})));var Qt=V;(ft.length>0||!Ae)&&(Qt=new he.default.List(Array.from({length:U},function(vt,jr){var pr;return(pr=ft[jr])!==null&&pr!==void 0?pr:Ae&&V.get(jr)||null})));var hn=P;(wn.length>0||!Ae)&&(hn=new he.default.List(Array.from({length:U},function(vt,jr){var pr;return(pr=wn[jr])!==null&&pr!==void 0?pr:Ae&&P.get(jr)||null})));var Gt=bo(e,l,s,Zr,Qt);if(Gt){var Yt=qt(Gt),Ut=d&&U>=2,Bt=Zr;Ut&&(_r[1]=Zr.get(0),Zr=Zr.set(1,_r[1]),pt[1]=pt[0]);var Na=!Ut;Na&&pt.push(Yt),pe.push(Lr(Lr({side:"rhs",delta:-1},Gt),{},{fixed:Ut,fixedFrom:Ut?[Bt.get(0),Bt.get(1)]:void 0,fixedTo:Ut?[Zr.get(0),Zr.get(1)]:void 0}))}var Ft=_,xi=_?.size!==pt.length||pt.filter(function(vt,jr){return vt!=_.get(jr)}).length>0;return xi&&(Ft=new he.default.List(pt)),{canReuseValue:Ae,newValue:Zr,newValueSrc:Qt,newValueType:hn,operatorCardinality:U,fixedField:l,newValueError:Ft,newFieldError:Re,validationErrors:pe}},So=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ms=function(e,t){if(e){var r=e.get("func"),a=r&&$r(t,r);if(a){var i=e,u=!1;for(var o in a.args){var l=a.args[o],s=l.valueSources,c=l.isOptional,d=l.defaultValue,f=Dn(t,s,l),p=i.get("args"),g=f.length==1?f[0]:void 0,v=p?p.get(o):void 0,m=v?v.get("value"):void 0,h=(v?v.get("valueSrc"):void 0)||g;if(m!==void 0){var O=Nn(m,h,t);if(O===void 0||(O!==m&&(i=i.setIn(["args",o,"value"],O)),u))return}else if(d!==void 0&&!So(d))i=i.setIn(["args",o,"value"],ys(l)),i=i.setIn(["args",o,"valueSrc"],"value");else if(c)u=!0;else return}return i}}},hs=function(e,t,r,a){var i=r.settings.fieldSeparator;e=e||new he.default.Map,Array.isArray(t)&&(t=t.join(i));var u=e.get("func"),o=e.get("args");e=e.set("func",t);var l=t&&$r(r,t),s=t&&Do(r,t),c=u&&Do(r,u),d=bs(c,s,o,r,a);if(d.length){var f=Object.keys(s.args),p=f.filter(function(g){return!d.includes(g)});e=p.reduce(function(g,v){return g.deleteIn(["args",v])},e)}else e=e.set("args",new he.default.Map);return e=dg(r,e,l),e},dg=function(e,t,r){if(r)for(var a in r.args)t=ai(e,t,r,a);return t},ai=function(e,t,r,a){var i=r.args[a],u=i.valueSources,o=i.defaultValue,l=Dn(e,u,i),s=l.length?l[0]:void 0,c=o?So(o)&&o.func?"func":"value":void 0,d=c||s,f=t.getIn(["args",a]);return f||(o!==void 0&&(t=t.setIn(["args",a,"value"],ys(i))),d&&(t=t.setIn(["args",a,"valueSrc"],d))),t},ys=function(e){var t=e.defaultValue;return So(t)&&!he.default.Map.isMap(t)&&t.func?he.default.fromJS(t,function(r,a){return he.default.Iterable.isIndexed(a)?a.toList():a.toOrderedMap()}):t},Fo=function(e,t,r,a,i){if(e&&e.get("func")){e=e.setIn(["args",t,"value"],r);var u=e.getIn(["args",t,"valueSrc"]),o=a.valueSources,l=Dn(i,o,a),s=l.length==1?l[0]:void 0;!s&&l.includes("value")&&(s="value"),!u&&s&&(e=e.setIn(["args",t,"valueSrc"],s))}return e},Os=function(e,t,r,a,i){return e&&e.get("func")&&(e=e.setIn(["args",t],new he.default.Map({valueSrc:r}))),e},bs=function(e,t,r,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(e?.returnType!=t?.returnType)return[];var u=!1,o=Object.keys(t.args),l=o.filter(function(s,c){var d=t.args[s],f=e.args[s],p=Object.keys(e.args).indexOf(s);if(!f&&(d.defaultValue!==void 0||d.isOptional))return!0;if(u&&c!==p||f?.type!=d.type||ii.includes(d.type)&&(!f.listValuesType||f.listValuesType!==d.listValuesType))return!1;if(r){var g,v=r.get(s),m=v?.get("value"),h=v?.get("valueSrc");if(h&&d.valueSources&&!d.valueSources.includes(h))return!1;var O=null,b=null,S=d,C=null,L=!0,w=Xn(a,O,S,b,m,S.type,h,C,i,L),D=(0,Le.A)(w,2),V=D[0],P=D[1];if(P!=null&&(g=P.filter(function(_){return!_.fixed}))!==null&&g!==void 0&&g.length)return!1}return!0});return l},ii=["select","multiselect","treeselect","treemultiselect"],Ss=function(e,t){var r;return((r=e.types[t])===null||r===void 0?void 0:r.operators)||null},oi=function(e,t){var r=je(e,t),a=r?r.operators:[];return a},Co=function(e,t){var r,a=oi(e,t);return(r=a?.[0])!==null&&r!==void 0?r:null},Fs=function(e,t,r){var a=null;if(e){if(t==="field"){var i=je(r,e);i&&(a=i.type)}else if(t==="func"){var u=e.get("func");if(u){var o=$r(r,u);o&&(a=o.returnType||o.type)}}}return a},fg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return ja(e,t,r,"funcs","subfields")},ja=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"fields",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"subfields";if(!e)return null;var u=t.settings.fieldSeparator,o=Dr(e,t),l=Dr(r,t),s=o.slice(l.length).map(function(c,d,f){return f.slice(0,d+1)}).map(function(c){return[].concat((0,Se.A)(l),(0,Se.A)(c)).join(u)}).map(function(c){var d=Jt(t,c,a,i);return d&&d.label||Xa()(c.split(u))}).filter(function(c){return c!=null});return s},Cs=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e)return null;var a=r&&Jt(t,r)||null,i=t.settings.fieldSeparator,u=Dr(e,t),o=Xs(e,r,t),l=o?Dr(r,t):[];return u.slice(l.length).map(function(s,c,d){return d.slice(0,c+1)}).map(function(s){return{part:[].concat((0,Se.A)(l),(0,Se.A)(s)).join(i),key:s[s.length-1]}}).map(function(s){var c=s.part,d=s.key,f=Jt(t,c);return{key:d,cnf:f}}).map(function(s,c,d){var f=s.key,p=s.cnf,g=c>0?d[c-1].cnf:a;return[f,p,g]})},pg=function(e,t,r,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=dt(e,t,r,null,i)||{},l=lr(e,r,t)||{},s=u?1:l.cardinality,c=null;if(s>1){var d=o.valueLabels||l.valueLabels;d&&(c=d[a]),c&&(0,Cr.A)(c)!=="object"&&(c={label:c,placeholder:c}),c||(c={label:e.settings.valueLabel+" "+(a+1),placeholder:e.settings.valuePlaceholder+" "+(a+1)})}else{var f=o.valueLabel,p=o.valuePlaceholder;c={label:f||e.settings.valueLabel,placeholder:p||e.settings.valuePlaceholder}}return c};function To(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=[],i=[];if(!e)return{widgets:a,valueSrcs:i};var u=fi(e),o=u?"".concat(u,"__").concat(t,"__").concat(r):null,l=pi(n,"_getWidgetsAndSrcsForFieldOp",o);if(l)return l;var s=(0,Cr.A)(e)==="object"&&(!!e.func&&!!e.arg||e._isFuncArg),c=je(n,e),d=t?n.operators[t]:null;if(c!=null&&c.widgets){var f=function(){var h=c.widgets[p];if(!n.widgets[p])return 1;var O=n.widgets[p].valueSrc||"value",b=!0;if(p==="field"&&(b=b&&Dn(n,["field"],c).length>0),p==="func"&&(b=b&&Dn(n,["func"],c).length>0),r==="value"&&!h.operators&&!s&&e!=="!case_value"&&(b=!1),h.operators&&t&&(b=b&&h.operators.indexOf(t)!=-1),r&&r!=O&&r!=="const"&&(b=!1),d&&d.cardinality==0&&O!=="value"&&(b=!1),b){var S,C;a.push(p);var L=((S=c.valueSources)===null||S===void 0?void 0:S.indexOf(O))!=-1;(d==null||(C=d.valueSources)===null||C===void 0?void 0:C.indexOf(O))==-1&&(L=!1),L&&!i.find(function(w){return w==O})&&i.push(O)}};for(var p in c.widgets)f()}var g=function(h){var O=0;return c.preferWidgets?c.preferWidgets.includes(h)&&(O+=10-c.preferWidgets.indexOf(h)):h==c.mainWidget&&(O+=100),h==="field"&&(O-=1),h==="func"&&(O-=2),O};a.sort(function(m,h){return g(h)-g(m)});var v={widgets:a,valueSrcs:i};return vi(n,"_getWidgetsAndSrcsForFieldOp",o,v),v}var vg=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=To(e,t,r,a),u=i.widgets;return u},Dn=function(e,t,r){var a;if(!r)return t;var i=(a=r.type)!==null&&a!==void 0?a:r.returnType;return i==="!group"&&(i="number"),t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter(function(u){var o=!0;if(u==="field"&&e.__fieldsCntByType){var l=r._isFuncArg?0:1;o=o&&e.__fieldsCntByType[i]>l}return u==="func"&&(r.funcs&&(o=o&&r.funcs.length>0),e.__funcsCntByType&&(o=o&&e.__funcsCntByType[i]>0)),o})},Ts=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=To(e,t,r,null),u=i.valueSrcs,o=Dn(e,u,a);return o},wr=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=To(e,t,r,a),u=i.widgets,o=null;return u.length&&(o=u[0]),o},mn=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(e){var u=je(t,e)||{},o=t.settings.fieldSeparator,l=Dr(e,t),s=Array.isArray(e)?e.join(o):e;if(i!=null&&i.useTableName&&u.tableName){var c=(0,Se.A)(l);c[0]=u.tableName,s=c.join(o)}if(u.fieldName&&(s=u.fieldName),a){var d=je(t,a)||{},f=a;s.indexOf(f+o)==0?s=s.slice((f+o).length):u.fieldName||r.errors.push("Can't cut group ".concat(f," from field ").concat(s))}return s}},Eo=function(e,t){var r=e.get("type"),a=e.getIn(["properties","mode"]);return r=="rule_group"&&a=="array"?gg(e,t):r=="group"||r=="rule_group"?mg(e,t):hg(e,t)},gg=function(e,t){var r=e.get("children1"),a=e.get("properties");return Es(a.toObject(),r,t)},Es=function(e,t,r){var a,i,u=e.operator,o=(a=(i=r.operators[u])===null||i===void 0?void 0:i.cardinality)!==null&&a!==void 0?a:1,l=o==0,s={group:!Lo(e,r),children:!Ao(t,r)},c=s.group&&(l?s.children:!0);return!c},mg=function(e,t){var r=e.get("children1");return Ao(r,t)},Ao=function(e,t){var r=e?.size>0&&e.filter(function(a){return!Eo(a,t)}).size>0;return!r},hg=function(e,t){var r=e.get("properties");return Lo(r?.toObject()||{},t)},Lo=function(e,t){var r=!0,a=3,i=wo(e,t,r),u=i.score>=a;return!u},wo=function(e,t){var r,a,i,u=e.field,o=e.fieldSrc,l=e.fieldType,s=e.operator,c=e.value,d=e.valueSrc,f=e.valueType,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,g=(r=(a=t.operators[s])===null||a===void 0?void 0:a.cardinality)!==null&&r!==void 0?r:1,v=d!=null&&d.get?d.toJS():d,m={parts:{},score:0};if(m.parts.field=p?u!=null:ui(u,o,t),m.parts.operator=!!s,m.parts.value=(c==null||(i=c.filter(function(O,b){return ui(O,v?.[b],t,p)}))===null||i===void 0?void 0:i.size)>=(p?Math.min(g,1):g),m.score=Object.keys(m.parts).filter(function(O){return!!m.parts[O]}).length,p&&m.score<3){var h=!0;!m.parts.value&&o==="func"&&ui(u,o,t,!1,h)&&m.score++,m.parts.field||c?.map(function(O,b){v?.[b]==="func"&&ui(O,v?.[b],t,!1,h)&&m.score++})}return m},ui=function n(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;if(!a&&t=="func"&&e){var u,o=(u=e.get)===null||u===void 0?void 0:u.call(e,"func"),l=$r(r,o);if(l){var s=e.get("args");for(var c in l.args){var d=l.args[c],f=s?s.get(c):void 0,p=f?f.get("value"):void 0,g=f?f.get("valueSrc"):void 0;if(p==null&&d?.defaultValue===void 0&&!(d!=null&&d.isOptional)||p!=null&&!n(p,g,r,i?a:!0))return!1}return!0}}return e!=null},Nn=function(e,t,r){return t=="func"?ms(e,r):e},jo=function n(e){var t=e.get("children1");if(t?.size==1){var r=t.first(),a=r.get("type");return a==="group"?n(r):r}return null},yg=y(55364),Og=y.n(yg),bg=y(1779),kt=y.n(bg),Sg=y(18678),Ro=y.n(Sg);function As(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ls(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?As(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):As(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Fg(n,e){return Ro().apply(n,e)}function Cg(n,e){return Ro().add_operation(n,e)}var ws={CALL:function(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];return e.call.apply(e,[t].concat(a))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return Ls(Ls({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return e?.length||0},regexTest:function(e,t,r){return e?.match(new RegExp(t,r))!=null},now:function(){return new Date},date_add:function(e,t,r){return qn()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function Tg(){for(var n in ws)Cg(n,ws[n])}function Eg(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ag(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Ag(n,e){if(n){if(typeof n=="string")return js(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return js(n,e)}}function js(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Rs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ct(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rs(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}Tg();function Ps(n,e,t){var r;try{r=Ro().apply(n,e)}catch(a){throw a.message="".concat(t.join(".")," :: ").concat(a.message),a}return r}function xs(n,e,t,r){var a;try{a=e.call.apply(e,[n].concat((0,Se.A)(t)))}catch(i){throw i.message="".concat(r.join(".")," :: ").concat(i.message),i}return a}var nn=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],Ra={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},Po=ct(ct({},Ra),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Is={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},Lg={formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}},Vs={widgetProps:Po,opProps:Is},wg={renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}},Ds=ct(ct({},Ra),{},{fieldSettings:Ra}),Ns=ct(ct({},Ra),{},{fieldSettings:Ra,widgets:{x:Vs},mainWidgetProps:Po}),jg={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},caseValueField:Ns,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},Rg={fields:{x:Ns},widgets:{x:Po},conjunctions:{x:Lg},operators:{x:Is},types:{x:{widgets:{x:Vs}}},funcs:{x:ct(ct(ct({},Ds),wg),{},{args:{x:ct({},Ds)}})},settings:jg},Zn=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},ks=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=Xt()(e,nn);delete r.ctx;for(var a=function s(c,d,f,p){if(Zn(c)){if(Oa(c)&&(c=Ki(c)),f[0]==="funcs"&&!d){var g=f[f.length-1];d=Jt({funcs:p.BasicFuncs},g,"funcs","subfields")||void 0,d&&(c.$$key=g)}if(d!==void 0&&Zn(d))for(var v in d)Object.prototype.hasOwnProperty.call(d,v)&&(!Object.keys(c).includes(v)||c[v]===void 0&&d[v]!==void 0?c[v]="$$deleted":(c[v]=s(c[v],d[v],[].concat((0,Se.A)(f),[v]),p),c[v]===void 0&&delete c[v]));for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)){if(!d||!Object.keys(d).includes(m)){var h;c[m]=s(c[m],(h=d)===null||h===void 0?void 0:h[m],[].concat((0,Se.A)(f),[m]),p)}c[m]===void 0&&delete c[m]}Object.keys(c).length===0&&(c=void 0)}else Array.isArray(c)&&c.forEach(function(O,b){c[b]=s(c[b],void 0,[].concat((0,Se.A)(f),[b]),p)});if(!(d!==void 0&&ya(c,d,!0))){if(typeof c=="function")throw new Error("compressConfig: function at ".concat(f.join(".")," should be converted to JsonLogic"));return c}},i=0,u=nn;i<u.length;i++){var o=u[i];if(o!=="ctx")if(o==="fields")r[o]=kt()(r[o]),a(r[o],{},[o]);else if(o==="funcs"){r[o]=kt()(r[o]||{});for(var l in r[o])a(r[o][l],null,[o,l],{BasicFuncs:Z})}else r[o]=kt()(r[o]),a(r[o],t[o],[o])}return r},Ms=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var a={},i=function c(d,f,p){if(Zn(f)){Zn(d)||(d={});for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&(f[g]==="$$deleted"?delete d[g]:d[g]=c(d[g],f[g],[].concat((0,Se.A)(p),[g])))}else Array.isArray(f)?d=kt()(f):d=f;return d},u=function c(d,f,p){var g=!1;if(Zn(d)&&Object.prototype.hasOwnProperty.call(d,"$$key")&&d.$$key){var v=Jt({funcs:p.BasicFuncs},d.$$key,"funcs","subfields");if(v)delete d.$$key,d=i(kt()(v),d,f),g=!0;else throw new Error("decompressConfig: basic function not found by key ".concat(d.$$key," at ").concat(f.join(".")))}if(!g){if(Zn(d))for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(d[m]=c(d[m],[].concat((0,Se.A)(f),[m]),p));else if(Array.isArray(d)){var h=Eg(d),O;try{for(h.s();!(O=h.n()).done;){var b=O.value;d[b]=c(d[b],[].concat((0,Se.A)(f),[b]),p)}}catch(S){h.e(S)}finally{h.f()}}}return d},o=0,l=nn;o<l.length;o++){var s=l[o];s==="ctx"?a[s]=Og()({},t.ctx||{},r||{}):s==="funcs"?(a[s]=kt()(e[s]||{}),u(a[s],[s],{BasicFuncs:Z})):s==="fields"?a[s]=kt()(e[s]||{}):(a[s]=kt()(t[s]||{}),i(a[s],e[s]||{},[s]))}return a},_s=function(e){if(e.__compliled)return e;e=kt()(e);var t={ctx:e.ctx},r=[];return li(e,e,t,Rg,r),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function li(n,e,t,r,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];if(e){var u=!i.length;for(var o in r){var l=r[o],s=o==="x"?i:[].concat((0,Se.A)(i),[o]);if(l.type==="r"){var c=e,d=c[o];if(l.isArr)for(var f in d){var p=ea(d[f],t,[].concat((0,Se.A)(s),[f]));p!==d[f]&&(a.push("Compiled ".concat(s.join("."),"[").concat(f,"]")),d[f]=p)}else{var g=ea(d,t,s,void 0);g!==d&&(a.push("Compiled R ".concat(s.join("."))),c[o]=g)}}else if(l.type==="rf"){var v=e,m=v[o],h=Pg(m,t,s,l.ignore);h!==m&&(a.push("Compiled JL-RF ".concat(s.join("."))),v[o]=h)}else if(l.type==="f"){var O=e,b=O[o],S=xg(b,t,s,l.args,l.ignore);if(l.invokeWith&&S&&typeof S=="function"){var C;S=(C=S).call.apply(C,[null].concat((0,Se.A)(l.invokeWith)))}S!==b&&(a.push("Compiled JL-F ".concat(s.join("."))),O[o]=S)}else if(o==="x")for(var L in e){s=[].concat((0,Se.A)(i),[L]);var w=e[L];li(n,w,t,l,a,s),w.subfields&&li(n,w.subfields,t,r,a,s)}else{var D=e[o];li(n,D,t,l,a,s)}}}}function Pg(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;return st(n)?function(a,i){i=i||e?.ctx;var u={props:a,ctx:i},o=Ps(n,u,t);typeof o=="string"&&(o={type:o,props:a});var l=ea(o,{ctx:i},t);return l}:typeof n=="string"?function(a,i){i=i||e?.ctx;var u=n.split(".").reduce(function(s,c){return s?.[c]},i);if(u)return xs(this,u,[a,i],t);var o={type:n,props:a},l=ea(o,{ctx:i},t);return l}:n}function xg(n,e,t,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;return st(n)&&a!=="jl"?function(){for(var i=arguments.length,u=new Array(i),o=0;o<i;o++)u[o]=arguments[o];var l=this||e?.ctx,s=(r||[]).reduce(function(d,f,p){return ct(ct({},d),{},(0,ne.A)({},f,u[p]))},{args:u,ctx:l}),c=Ps(n,s,t);return c}.bind(e?.ctx):typeof n=="string"&&a!=="string"?function(){var i=this||e?.ctx,u=n.split(".").reduce(function(c,d){return c?.[d]},i);if(u){for(var o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];return xs(this,u,l,t)}else throw new Error("".concat(t.join(".")," :: Function ").concat(n," is not found in ctx"))}.bind(e?.ctx):n}function Ig(n,e){var t;return(e==null||(t=e.components)===null||t===void 0?void 0:t[n])||e.W[n]||e.O[n]}function ea(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0;if(zi(n)){var a,i=n.type,u=n.props;if(typeof i!="string")throw new Error("renderReactElement for ".concat(t.join("."),": type should be string"));var o=Ig(i,e.ctx)||i.toLowerCase(),l;r!==void 0&&(u=ct(ct({},u),{},{key:r})),(a=u)!==null&&a!==void 0&&a.children&&(l=ea(u.children,e,t),u=ct(ct({},u),{},{children:l}));var s=e.ctx.RCE(o,u);return s}else if(n instanceof Array)return n.map(function(c,d){return ea(c,e,t,""+d)});return n}var Vg=y(6924),Dg=y.n(Vg),Gs={reverseOperatorsForNot:!1,canShortMongoQuery:!0,formatField:function(e,t,r,a,i,u){return u?r:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function xo(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Ng(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Ng(n,e){if(n){if(typeof n=="string")return Us(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Us(n,e)}}function Us(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var kg=0,Bs=0,ra,si={},$s=function(){return ra||(ra=Ks({reactIndex:void 0,maxSize:3,canCompile:void 0})),ra},Ws=function(e,t){var r;for(var a in si){var i=si[a].findExtendedConfig(e,t);if(i){r=i;break}}return r},Ks=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0},t=new Map,r=e.maxSize||2,a=++kg,i,u=!0,o=function(m){return Xt()(m,nn)},l=function(m){var h=xt(m,++Bs,e.canCompile);return c(m,h),h},s=function(){return t.size},c=function(m,h){t.size+1>r&&t.delete(t.keys().next().value),t.set(m,h)},d=function(m){var h=xo(t.keys()),O;try{var b=function(){var L=O.value,w=t.get(L),D=nn.map(function(V){return w[V]===m[V]}).filter(function(V){return!V}).length===0;if(D)return{v:L}},S;for(h.s();!(O=h.n()).done;)if(S=b(),S)return S.v}catch(C){h.e(C)}finally{h.f()}return m},f=function(m,h){var O=xo(t.keys()),b;try{var S=function(){var _=b.value,B=nn.filter(function(q){return _[q]===m[q]}),M=B.length===nn.length&&(h?_.__compliled:!0);if(M)return{v:t.get(_)}},C;for(O.s();!(b=O.n()).done;)if(C=S(),C)return C.v}catch(P){O.e(P)}finally{O.f()}var L=xo(t.values()),w;try{var D=function(){var _=w.value,B=nn.filter(function(q){return _[q]===m[q]}),M=B.length===nn.length&&(h?_.__compliled:!0);if(M)return{v:_}},V;for(L.s();!(w=L.n()).done;)if(V=D(),V)return V.v}catch(P){L.e(P)}finally{L.f()}return null},p=function(m){return f(m)||l(m)},g=function(){u=!1,t.clear(),delete si[a],ra===i&&(ra=void 0)};return i={getExtendedConfig:function(m){return p(o(m))},findExtendedConfig:f,getBasicConfig:d,clearConfigMemo:g,configId:Bs,storeConfigPair:c,getSize:s,configStore:t,memoId:a,meta:e},e.reactIndex===void 0&&(ra=i),si[a]=i,i};function Io(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Mg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Mg(n,e){if(n){if(typeof n=="string")return zs(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zs(n,e)}}function zs(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Hs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Mt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hs(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var xt=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(r=r&&e.settings.useConfigCompress,e.__configId)return e;var a=Ws(e,r);if(a)return a;var i=e;r?e.__compliled?e=kt()(e):e=_s(e):e=kt()(e),e.settings=Dg()({},Gs,e.settings,bu),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},_g(e.types,e),qs(e.fields,e),Js(e.funcs,e);var u=e.settings.caseValueField;u&&ci(u,e,[],!1,!0);var o=e.settings.locale.moment;o&&qn().locale(o),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||cr()}),e.__cache={},Fu(e);var l=$s();return l.storeConfigPair(i,e),e};function _g(n,e){for(var t in n){var r=n[t];Gg(t,r,e)}}function Gg(n,e,t){var r=null,a=null;e.mainWidget=e.mainWidget||Object.keys(e.widgets).filter(function(p){return p!="field"&&p!="func"})[0];var i=e.excludeOperators||[];for(var u in e.widgets){var o=e.widgets[u],l=o.defaultOperator;if(o.operators){var s=o.operators.filter(function(p){return!i.includes(p)});r=Ya(r,s)}l&&!i.includes(l)&&(!a||u===e.mainWidget)&&(a=l),u==e.mainWidget&&(o.widgetProps=Mt(Mt({},e.mainWidgetProps||{}),o.widgetProps||{})),e.widgets[u]=o}e.valueSources||(e.valueSources=Object.keys(t.settings.valueSourcesInfo));var c=Io(e.valueSources),d;try{for(c.s();!(d=c.n()).done;){var f=d.value;f!="value"&&!e.widgets[f]&&(e.widgets[f]={})}}catch(p){c.e(p)}finally{c.f()}!e.operators&&r&&(e.operators=Array.from(new Set(r))),!e.defaultOperator&&a&&(e.defaultOperator=a)}function qs(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var r in n){var a=[].concat((0,Se.A)(t),[r]);ci(n[r],e,a),n[r].subfields&&qs(n[r].subfields,e,a)}}function Js(n,e){var t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(n){var a=(e==null||(t=e.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";for(var i in n){var u=[].concat((0,Se.A)(r),[i]),o=u.join(a),l=n[i];if(l.returnType&&(l.type=l.returnType,e.__funcsCntByType[l.returnType]||(e.__funcsCntByType[l.returnType]=0),e.__funcsCntByType[l.returnType]++),ci(l,e,u,!1),l.args){for(var s in l.args)ci(l.args[s],e,[].concat((0,Se.A)(u),[s]),!0);var c=Object.keys(l.args),d=!0,f=Io(c.reverse()),p;try{for(f.s();!(p=f.n()).done;){var g=p.value,v=l.args[g];!d&&v.isOptional&&(Cn.info("Arg ".concat(g," for func ").concat(o," can't be optional")),delete v.isOptional),v.isOptional||(d=!1)}}catch(m){f.e(m)}finally{f.f()}}l.subfields&&Js(l.subfields,e,[].concat((0,Se.A)(r),[i]))}}}function Ug(n,e,t){for(var r,a,i=["listValues","treeValues","allowCustomValues","validateValue"],u=0,o=i;u<o.length;u++){var l=o[u];n[l]&&(n.fieldSettings||(n.fieldSettings={}),n.fieldSettings[l]=n[l],delete n[l])}(r=n.fieldSettings)!==null&&r!==void 0&&r.listValues&&e.settings.normalizeListValues&&(n.fieldSettings.listValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.listValues,t,n.fieldSettings)),(a=n.fieldSettings)!==null&&a!==void 0&&a.treeValues&&e.settings.normalizeListValues&&(n.fieldSettings.treeValues=e.settings.normalizeListValues.call(e.ctx,n.fieldSettings.treeValues,t,n.fieldSettings))}function ci(n,e){var t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=e.settings,o=u.showLabels,l=u.fieldSeparator;l=(t=l)!==null&&t!==void 0?t:".";var s=r[r.length-1],c=a?r.slice(0,r.length-1).join(l):r.join(l),d=!!n.returnType,f=n.type||n.returnType,p=e.types[f],g=n.excludeOperators||[],v=(n.operators||p?.operators||[]).filter(function(V){return!g.includes(V)}),m=n.defaultOperator||p?.defaultOperator;g.includes(m)&&(m=void 0);var h=!!m&&m==n.defaultOperator;if(h&&(n.ownDefaultOperator=n.defaultOperator),!p){n.disabled=!0;return}!a&&!d&&!i&&(e.__fieldsCntByType[f]||(e.__fieldsCntByType[f]=0),e.__fieldsCntByType[f]++),a&&(n._isFuncArg=!0,n._argKey=s,n._funcKey=c),d&&(n._isFunc=!0,n._funcKey=c),i&&(n._isCaseValue=!0),Ug(n,e,f);var O=["widgets","operators","defaultOperator"];Object.keys(p).filter(function(V){return!O.includes(V)}).map(function(V){n[V]||(n[V]=yu(p[V]))});var b=p.excludeOperators||[];n.operators&&(b=b.filter(function(V){return!n.operators.includes(V)})),n.widgets||(n.widgets={});var S=function(){var P=Mt({},n.widgets[C]||{}),_=p.widgets[C]||{};if(!a){var B=P.defaultOperator,M=[].concat((0,Se.A)(g),(0,Se.A)(b)),q=n.preferWidgets&&(C==="field"||n.preferWidgets.includes(C))||M.length>0;if(P.operators){var K=P.operators.filter(function(Fe){return!M.includes(Fe)});P.operators=K,v=Ya(v,K)}else if(q&&_.operators){var H=_.operators.filter(function(Fe){return!M.includes(Fe)});P.operators=H,v=Ya(v,H)}B&&!M.includes(B)&&(!m||!h&&C===n.mainWidget)&&(m=B)}C===n.mainWidget?P.widgetProps=Mt(Mt(Mt({},_.widgetProps||{}),n.mainWidgetProps||{}),P.widgetProps||{}):P.widgetProps=Mt(Mt({},_.widgetProps||{}),P.widgetProps||{});var U=Array.from(new Set([].concat((0,Se.A)(Object.keys(_.opProps||{})),(0,Se.A)(Object.keys(P.opProps||{})))));if(U.length){var te={},J=Io(U),ae;try{for(J.s();!(ae=J.n()).done;){var ce,oe,le=ae.value;te[le]=Mt(Mt({},((ce=_.opProps)===null||ce===void 0?void 0:ce[le])||{}),((oe=P.opProps)===null||oe===void 0?void 0:oe[le])||{})}}catch(Fe){J.e(Fe)}finally{J.f()}P.opProps=te}var fe=P,se=fe.valueLabel,me=fe.valuePlaceholder;a&&(se||(P.valueLabel=n.label||s),!me&&!o&&(P.valuePlaceholder=n.label||s)),P=Mt(Mt({},_),P),n.widgets[C]=P};for(var C in p.widgets)S();if(a||(n.operators||(n.operators=Array.from(new Set(v))),n.defaultOperator||(n.defaultOperator=m)),!a&&!d&&!i){var L=Bg(e,r),w=L.fieldName,D=L.inGroup;w&&(n.fieldName=w,e.__fieldNames[w]||(e.__fieldNames[w]=[]),e.__fieldNames[w].push({fullPath:r,inGroup:D}))}}function Bg(n,e){if(!e)return{};var t=n.settings.fieldSeparator,r=(0,Se.A)(e).reduce(function(o,l,s,c){var d=o.computedPath,f=o.computed,p=o.inGroup,g=[].concat((0,Se.A)(c.slice(0,s)),[l]),v=Jt(n,g);return v?.type==="!group"&&s<c.length-1?(p=g.join(t),d=[]):v!=null&&v.fieldName?(f=!0,d=[v.fieldName]):d=[].concat((0,Se.A)(d),[l]),{computedPath:d,computed:f,inGroup:p}},{computedPath:[],computed:!1,inGroup:void 0}),a=r.computedPath,i=r.computed,u=r.inGroup;return i?{fieldName:a.join(t),inGroup:u}:{}}function Qs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function kn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qs(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Qs(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var $g=pn().mark(ta),Wg=pn().mark(Ys),Kg=In;function ta(n){return pn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Vo(n,n.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}},$g)}function Ys(n){return pn().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Vo(n,n.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}},Wg)}function Vo(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";return pn().mark(function a(i){var u,o,l;return pn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:u=(n==null||(i=n.settings)===null||i===void 0?void 0:i.fieldSeparator)||".",c.t0=pn().keys(e);case 2:if((c.t1=c.t0()).done){c.next=13;break}if(o=c.t1.value,l=e[o],!l[r]){c.next=9;break}return c.delegateYield(Vo(n,l[r],[].concat((0,Se.A)(t),[o]),r),"t2",7);case 7:c.next=11;break;case 9:return c.next=11,[[].concat((0,Se.A)(t),[o]).join(u),l];case 11:c.next=2;break;case 13:case"end":return c.stop()}},a)})()}var Jt=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"fields",i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"subfields";if(!t)return null;if(t==="!case_value"){var u;return e==null||(u=e.settings)===null||u===void 0?void 0:u.caseValueField}var o=(e==null||(r=e.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",l=Dr(t,e),s=e[a];if(!s)return null;for(var c=s,d=null,f=[],p=0;p<l.length;p++){var g=l[p];f.push(g);var v=f.join(o);d=c[v],p<l.length-1&&(d&&d[i]?(c=d[i],f=[]):d=null)}return d},di=function(e,t){var r,a,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,u=e.settings.fieldSeparator,o=[i].concat((0,Se.A)(t.split(u))).filter(function(c){return c!=null}),l=t,s=(r=e.__fieldNames[l])===null||r===void 0||(a=r.find)===null||a===void 0||(a=a.call(r,function(c){var d=c.inGroup;return d?i?.startsWith(d):!0}))===null||a===void 0?void 0:a.fullPath;return(s||o).join(u)},Do=function(e,t){if(!t)return null;var r=Jt(e,t,"funcs","subfields");if(!r)return null;var a=r.returnType,i=r.args,u=Object.fromEntries(Object.entries(i||{}).map(function(l){var s=(0,Le.A)(l,2),c=s[0],d=s[1],f=Xt()(d,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"]);return[c,f]})),o={returnType:a,args:u};return o},$r=function(e,t){if(!t)return null;var r=Jt(e,t,"funcs","subfields");return r||null},No=function(e,t,r){var a=$r(e,t);if(!a)return null;var i=a.args&&a.args[r]||null;return i||null},Xs=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return!1;var i=(a==null||(r=a.settings)===null||r===void 0?void 0:r.fieldSeparator)||".",u=an(e,a),o=an(t,a);return u.startsWith(o+i)},an=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string")return e;var a=(r==null||(t=r.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";return Dr(e,r).join(a)},Dr=function(e){var t,r,a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var u=(i==null||(t=i.settings)===null||t===void 0?void 0:t.fieldSeparator)||".";if(e!=null&&e.func)return Array.isArray(e.func)?e.func:e.func.split(u);if(e!=null&&(r=e.get)!==null&&r!==void 0&&r.call(e,"func")){var o;return e==null||(o=e.get)===null||o===void 0?void 0:o.call(e,"func").split(u)}return(e==null||(a=e.split)===null||a===void 0?void 0:a.call(e,u))||[]},zg=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!e)return null;var a=t.settings.fieldSeparator,i=Dr(e,t);return r?i:i.map(function(u,o,l){return l.slice(0,o+1)}).map(function(u){return u.join(a)})},fi=function(e){var t;if(typeof e=="string"||Array.isArray(e))return"field:".concat(an(e));if((0,Cr.A)(e)==="object"&&e){if(e._funcKey&&e._argKey)return"arg:".concat(an(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(an(e._funcKey));if(e.func&&e.arg)return"arg:".concat(an(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(an(e.func));if(e.type)return null}return e!=null&&(t=e.get)!==null&&t!==void 0&&t.call(e,"func")?e!=null&&e.get("arg")?"arg:".concat(an(e.get("func")),"__").concat(e.get("arg")):"func:".concat(an(e.get("func"))):null},pi=function(e,t,r){var a;return(a=e.__cache)===null||a===void 0||(a=a[t])===null||a===void 0?void 0:a[r]},vi=function(e,t,r,a){!e.__cache||!r||(e.__cache[t]||(e.__cache[t]={}),e.__cache[t][r]=a)},Zs=function(e){var t;if(!e)return null;if((0,Cr.A)(e)==="object"){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return e!=null&&(t=e.get)!==null&&t!==void 0&&t.call(e,"func")?e!=null&&e.get("arg")?null:"func":"field"},je=function(e,t){var r;if(!t)return null;if((0,Cr.A)(t)=="object"){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?No(e,t.func,t.arg):$r(e,t.func)}if(t!=null&&(r=t.get)!==null&&r!==void 0&&r.call(t,"func"))return t!=null&&t.get("arg")?No(e,t.get("func"),t.get("arg")):$r(e,t.get("func"));var a=Jt(e,t);return a||null},lr=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!t)return null;var a=e.operators[t];if(r){var i,u,o=fi(r),l=o?"".concat(o,"__").concat(t):null,s=pi(e,"getOperatorConfig",l);if(s)return s;var c=je(e,r),d=wr(e,r,t,null),f=e.widgets[d]||{},p=(c&&c.widgets?c.widgets[d]:{})||{},g=((i=f.opProps)===null||i===void 0?void 0:i[t])||{},v=((u=p.opProps)===null||u===void 0?void 0:u[t])||{},m=kn(kn(kn({},a),g),v);return vi(e,"getOperatorConfig",l,m),m}else return a},dt=function(e,t){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(!t)return null;var l=je(e,t),s=fi(t);i||(i=wr(e,t,a,u));var c=s?"".concat(s,"__").concat(a,"__").concat(i,"__").concat(u):null,d=pi(e,"getFieldWidgetConfig",c);if(d)return d;var f=e.widgets[i]||{},p=(l==null||(r=l.widgets)===null||r===void 0?void 0:r[i])||{},g=p.widgetProps||{},v=u==="value"||!u?l?.fieldSettings:{},m=kn(kn(kn(kn({},f),p),g),v);return vi(e,"getFieldWidgetConfig",c,m),o.forExport&&(m=Pt(m,"factory")),m},ec=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=e.settings.fieldSeparator,a=Dr(t,e),i=t?Jt(e,t):e,u=i,o=null,l=[];do{var s,c=u===e?e.fields:(s=u)===null||s===void 0?void 0:s.subfields;if(!c||!Object.keys(c).length){u=o=null;break}o=Object.keys(c)[0],l.push(o),u=c[o]}while(u.type=="!struct"||u.type=="!group");return(a||[]).concat(l).join(r)};function rc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function tc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Hg=function(e,t){var r={usedFields:[]},a=nc(e,t,r);if(a)return tc(tc({},a),r)},nc=function(e,t,r){if(e){var a=e.get("type"),i=e.get("children1");if((a==="group"||a==="rule_group")&&i&&i.size)return qg(e,t,r);if(a==="rule")return Jg(e,t,r)}},qg=function(e,t,r){var a=e.get("properties")||new he.Map,i=e.get("children1"),u=e.get("id"),o=i.map(function(d){return nc(d,t,r)}).filter(function(d){return typeof d<"u"});if(o.size){var l=a.get("conjunction");l||(l=tn(t));var s=a.get("not"),c={id:u,rules:o.toList(),condition:l.toUpperCase(),not:s};return c}},Jg=function(e,t,r){var a,i=e.get("properties")||new he.Map,u=e.get("id"),o=i.get("operator"),l=i.get("operatorOptions"),s=i.get("field"),c=i.get("value"),d=i.get("valueSrc"),f=i.get("valueType"),p=c.filter(function(P){return P===void 0}).size>0;if(!(s==null||o==null||p)){var g=je(t,s)||{},v=lr(t,o,s)||{},m=g.type||"undefined",h=Ur(v),O=t.types[g.type]||{},b=mn(s,t,r);if(!(c.size<h)){r.usedFields.indexOf(s)==-1&&r.usedFields.push(s),c=c.toArray(),d=d.toArray(),f=((a=f)===null||a===void 0?void 0:a.toArray())||[];for(var S=[],C=0;C<c.length;C++){var L={type:f[C],value:c[C]};if(S.push(L),d[C]=="field"){var w=c[C];r.usedFields.indexOf(w)==-1&&r.usedFields.push(w)}}var D=l?l.toJS():null;D&&!Object.keys(D).length&&(D=null);var V={id:u,fieldName:b,type:m,input:O.mainWidget,operator:o};return D&&(V.operatorOptions=D),V.values=S,V}}};function ac(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function ic(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ac(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ac(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function oc(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Qg(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Qg(n,e){if(n){if(typeof n=="string")return uc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return uc(n,e)}}function uc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var Yg=function(e,t){var r={usedFields:[],errors:[]},a=xt(t,void 0,!1),i=lc(e,a,r,!1,!0),u=r.errors,o=r.usedFields,l=a.settings.fieldSeparator,s={},c=oc(o),d;try{for(c.s();!(d=c.n()).done;)for(var f=d.value,p=Dr(f,t),g=je(a,f)||{},v=s,m=0;m<p.length;m++){var h=p[m],O=je(a,p.slice(0,m+1))||{};m!=p.length-1?O.type=="!group"&&O.mode!="struct"?(v[h]||(v[h]=[{}]),v=v[h][0]):(v[h]||(v[h]={}),v=v[h]):v[h]||(v[h]=null)}}catch(b){c.e(b)}finally{c.f()}return{errors:u,logic:i,data:s}},lc=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(e){var o=e.get("type"),l=e.get("properties")||new he.Map,s=l.get("isLocked"),c=t.settings.jsonLogic.lockedOp,d;return o==="group"||o==="rule_group"?d=sc(e,t,r,a,i,u):o==="rule"?d=Xg(e,t,r,a,u):o=="switch_group"?d=Zg(e,t,r,a):o=="case_group"&&(d=cc(e,t,r,a,u)),s&&d&&c&&(d=(0,ne.A)({},c,d)),d}},sc=function(e,t,r){var a,i,u,o,l,s,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,p=e.get("type"),g=e.get("properties")||new he.Map,v=g.get("mode"),m=e.get("children1")||new he.List,h=g.get("field"),O=je(t,h),b=g.get("conjunction");b||(b=tn(t));var S=t.conjunctions[b],C=S.jsonLogicConj||b.toLowerCase(),L=!!g.get("not"),w=p==="rule_group"&&!d,D=w&&v!="struct",V=D?h:f,P=g.get("operator"),_=P&&lr(t,P,h)||null,B=ko(t,g,r,P,f),M=w&&(!P||((a=_)===null||a===void 0?void 0:a.cardinality)==0),q=w&&m?.size>0,K=w&&!(m!=null&&m.size),H=L,U=!1;q?(U=L,H=c):c&&(H=!H);var te=!1,J=(i=_)===null||i===void 0?void 0:i.reversedOp,ae=lr(t,J,h),ce=!((u=_)!==null&&u!==void 0&&u.jsonLogic)&&!!((o=ae)!==null&&o!==void 0&&o.jsonLogic),oe=!!((l=ae)!==null&&l!==void 0&&l.jsonLogic),le=(s=jo(e))===null||s===void 0?void 0:s.get("type"),fe=!!t.settings.reverseOperatorsForNot&&(!w&&H&&le==="rule"||U&&m?.size===1);fe&&(q?U=!U:H=!H,te=!0);var se=H&&w&&oe&&(!!t.settings.reverseOperatorsForNot||ce);if(se){H=!H;var me=[J,P];P=me[0],J=me[1];var Fe=[ae,_];_=Fe[0],ae=Fe[1]}var pe=m.map(function(Ne){return lc(Ne,t,r,te,!1,V)}).filter(function(Ne){return typeof Ne<"u"}),Ae=!!t.settings.exportPreserveGroups;if(D&&!M){if(B==null)return}else if(!pe.size&&!Ae)return;var Re={};if(pe.size==1&&!d&&!Ae?Re=pe.first():Re[C]=pe.toList().toJS(),U&&(Re={"!":Re}),D){var Ve=_o(r,t,h,f);if(M){var Ie=P||"some";Re=(0,ne.A)({},Ie,[Ve,Re])}else{var De=pe.size?{filter:[Ve,Re]}:Ve,Te={reduce:[De,{"+":[1,{var:"accumulator"}]},0]};Re=fc(t,g,Te,B,P,null,O)}}return H&&(Re={"!":Re}),Re},Xg=function(e,t,r){var a,i,u,o,l,s,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,f=e.get("properties")||new he.Map,p=f.get("field"),g=f.get("fieldSrc"),v=f.get("operator"),m=f.get("operatorOptions");if(m=m?m.toJS():null,m&&!Object.keys(m).length&&(m=null),!(p==null||v==null)){var h=je(t,p),O=lr(t,v,p),b=(a=O)===null||a===void 0?void 0:a.reversedOp,S=lr(t,b,p);if(!((i=O)!==null&&i!==void 0&&i.jsonLogic)&&!((u=S)!==null&&u!==void 0&&u.jsonLogic)){r.errors.push("Operator ".concat(v," is not supported"));return}var C=c,L=!((o=O)!==null&&o!==void 0&&o.jsonLogic)&&!!((l=S)!==null&&l!==void 0&&l.jsonLogic),w=!!((s=S)!==null&&s!==void 0&&s.jsonLogic),D=w&&(!!t.settings.reverseOperatorsForNot||L),V=C&&D||L;if(V){C=!C;var P=[b,v];v=P[0],b=P[1];var _=[S,O];O=_[0],S=_[1]}var B=ko(t,f,r,v,d);if(B!==void 0){var M=g==="func"?dc(r,t,p,d):_o(r,t,p,d);if(M!==void 0)return fc(t,f,M,B,v,m,h,C)}}},Zg=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=e.get("children1");if(i){for(var u=i.map(function(L){return cc(L,t,r,a,null)}).filter(function(L){return typeof L<"u"}).valueSeq().toArray(),o=[],l=0;l<u.length;l++)l!==u.length-1&&!u[l][0]?r.errors.push("No condition for case ".concat(l)):(o.push(u[l]),l===u.length-1&&u[l][0]&&o.push([void 0,null]));if(o.length){if(o.length===1){var s=(0,Le.A)(o[0],2),c=s[0],d=s[1];return d==null&&(d=null),d}for(var f={if:[]},p=f.if,g=(0,Le.A)(o[o.length-1],2),v=g[0],m=g[1],h=0;h<o.length-1;h++){var O=h===o.length-2,b=(0,Le.A)(o[h],2),S=b[0],C=b[1];C==null&&(C=null),S==null&&(S=!0),p.push(S),p.push(C),O?p.push(m):(p.push({if:[]}),p=p[p.length-1].if)}return f}}},cc=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=e.get("type");if(u!="case_group"){r.errors.push("Unexpected child of type ".concat(u," inside switch"));return}var o=e.get("properties")||new he.Map,l=sc(e,t,r,a,i),s=ko(t,o,r,null,i,"!case_value");return[l,s]},ko=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=t.get("field"),l=t.get("valueSrc"),s=t.get("valueType");(u=="!case_value"||s&&s.get(0)=="case_value")&&(o="!case_value");var c=je(e,o),d=lr(e,a,o),f=Ur(d),p=t.get("value"),g=t.get("asyncListValues");if(p!=null){var v=[],m=[],h=r.usedFields,O=p.map(function(S,C){var L=l?l.get(C):null,w=s?s.get(C):null,D=Nn(S,L,e),V=wr(e,o,a,L),P=dt(e,o,a,V,L,{forExport:!0}),_=Mo(r,e,D,L,w,P,c,a,d,i,g);return _!==void 0&&(v.push(L),m.push(w)),_}),b=O.filter(function(S){return S===void 0}).size>0;if(O.size<f||b){r.usedFields=h;return}return f>1?O.toArray():f==1?O.first():null}},Mo=function(e,t,r,a,i,u,o,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0;if(r!==void 0){var f;if(a=="field")f=_o(e,t,r,c);else if(a=="func")f=dc(e,t,r,c);else if(typeof u?.jsonLogic=="function"){var p=u.jsonLogic,g=[r,ic(ic({},o?Xt()(o,["fieldSettings","listValues"]):{}),{},{asyncListValues:d}),Pt(u,In)];l&&(g.push(l),g.push(s)),f=p.call.apply(p,[t.ctx].concat(g))}else f=r;return f}},dc=function(e,t,r){var a,i,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),l=(i=r.get)===null||i===void 0?void 0:i.call(r,"args"),s=$r(t,o),c=Dr(o,t),d=c[c.length-1];if(!s){e.errors.push("Func ".concat(o," is not defined in config"));return}if(!(s!=null&&s.jsonLogic)){e.errors.push("Func ".concat(o," is not supported"));return}var f={},p=[],g=[];for(var v in s.args){var m,h=s.args[v],O=je(t,h),b=h.defaultValue,S=h.isOptional,C=b!=null&&b.func?"func":"value",L=l?l.get(v):void 0,w=L?L.get("value"):void 0,D=L?L.get("valueSrc"):void 0;D!=="func"&&(m=w)!==null&&m!==void 0&&m.toJS&&(w=w.toJS());var V=null,P=wr(t,h,V,D),_=dt(t,h,V,P,D,{forExport:!0}),B=Mo(e,t,w,D,h.type,_,O,null,null,u);if(w!=null&&B===void 0){D!="func"&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(o));return}var M=void 0;if(B===void 0&&!S&&b!=null){var q=wr(t,h,V,C),K=dt(t,h,V,q,C,{forExport:!0});if(M=Mo(e,t,b,C,h.type,K,O,null,null,u),M===void 0){C!="func"&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(o));return}}var H=B??M;if(H!==void 0){if(p.length){var U=oc(p),te;try{for(U.s();!(te=U.n()).done;){var J=te.value;f[J]=void 0}}catch(pe){U.e(pe)}finally{U.f()}p=[]}f[v]=H}else S||g.push(v),p.push(v)}if(!g.length){var ae=Object.values(f),ce;if(typeof s.jsonLogic=="function"){var oe=s.jsonLogic,le=[f];ce=oe.call.apply(oe,[t.ctx].concat(le))}else{var fe=s.jsonLogic||d,se=!!s.jsonLogicIsMethod;if(se){var me=ae[0],Fe=ae.slice(1);Fe.length?ce={method:[me,fe,Fe]}:ce={method:[me,fe]}}else ce=(0,ne.A)({},fe,ae)}return ce}},_o=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=t.settings,u=i.fieldSeparator,o=i.jsonLogic,l;if(r){Array.isArray(r)&&(r=r.join(u));var s=je(t,r)||{},c=mn(r,t,e,a),d=s.jsonLogicVar||(s.type=="!group"?o.groupVarKey:"var");l=(0,ne.A)({},d,c),e.usedFields.indexOf(r)==-1&&e.usedFields.push(r)}return l},em=function(e,t,r,a){var i,u=e,o=Ur(t),l=(i=t._jsonLogicIsRevArgs)!==null&&i!==void 0?i:!1;typeof t.jsonLogic=="string"&&(u=t.jsonLogic);var s=["<","<=",">",">="],c=["==","!="],d=function(p,g,v,m,h){return o==0&&c.includes(u)?(0,ne.A)({},u,[r,null]):o==0?(0,ne.A)({},u,r):o==1&&l?(0,ne.A)({},u,[a,r]):o==1?(0,ne.A)({},u,[r,a]):o==2&&s.includes(u)?(0,ne.A)({},u,[a[0],r,a[1]]):(0,ne.A)({},u,[r].concat((0,Se.A)(a)))};return d},fc=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,s=t.get("field"),c=lr(e,i,s)||{},d=typeof c.jsonLogic=="function"?c.jsonLogic:em(i,c,r,a),f=[r,i,a,Pt(c,Kn),u,o],p=d.call.apply(d,[e.ctx].concat(f));return l&&(p={"!":p}),p};function rm(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=tm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function tm(n,e){if(n){if(typeof n=="string")return pc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return pc(n,e)}}function pc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function vc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function gc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):vc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var mc=function(e){return(0,Cr.A)(e)=="object"&&e!==null&&!Array.isArray(e)},nm=function(e,t){return hc(e,t,!1)},hc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},i=xt(t,void 0,!1),u=Go([],e,i,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to MongoDb:",a.errors),u)},Go=function(e,t,r,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0;if(t){var s=t.get("type");if(s==="group"||s==="rule_group")return am(e,t,r,a,i,u,o,l);if(s==="rule")return im(e,t,r,a,i,u,o,l)}},am=function(e,t,r,a){var i,u,o,l,s,c,d,f,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,v=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,m=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,h=t.get("type"),O=t.get("properties")||new he.Map,b=!!O.get("not"),S=t.get("children1")||new he.List,C=r.settings,L=C.canShortMongoQuery,w=C.fieldSeparator,D=w,V=e.filter(function(or){return or.get("type")=="rule_group"}).length>0,P=e.filter(function(or){return or.get("type")=="rule_group"}).map(function(or){return or.get("properties").get("field")}).slice(-1).pop(),_=V&&P,B=h==="rule_group",M=B?O.get("field"):null,q=B?O.get("operator"):null,K=q&&lr(r,q,M)||null,H=q?(i=(u=K)===null||u===void 0?void 0:u.cardinality)!==null&&i!==void 0?i:1:void 0,U=mn(M,r,a,_),te=je(r,M)||{},J=te.mode,ae=M&&J==="array"&&H>=1,ce=B&&J!="struct",oe=B&&S?.size>0,le=B&&!(S!=null&&S.size),fe=!1,se=b,me=!1;oe?(me=b,se=p):p&&(se=!se);var Fe=(o=K)===null||o===void 0?void 0:o.reversedOp,pe=lr(r,Fe,M),Ae=!((l=K)!==null&&l!==void 0&&l.mongoFormatOp)&&!!((s=pe)!==null&&s!==void 0&&s.mongoFormatOp),Re=!!((c=pe)!==null&&c!==void 0&&c.mongoFormatOp),Ve=(d=jo(t))===null||d===void 0?void 0:d.get("type"),Ie=!!r.settings.reverseOperatorsForNot&&(!B&&se&&Ve==="rule"||me&&S?.size===1);Ie&&(oe?me=!me:se=!se,fe=!0);var De=se&&B&&Re&&(!!r.settings.reverseOperatorsForNot||Ae);if(De){se=!se;var Te=[Fe,q];q=Te[0],Fe=Te[1];var Ne=[pe,K];K=Ne[0],pe=Ne[1]}var Je=O.get("conjunction");Je||(Je=tn(r));var ar=r.conjunctions[Je];if(ar){var Qe=ar.reversedConj,Yr=se&&((f=Je)===null||f===void 0?void 0:f.toLowerCase())==="or"&&Qe&&!B&&!!r.settings.canShortMongoQuery&&!!r.settings.reverseOperatorsForNot;Yr&&(Je=Qe,ar=r.conjunctions[Je],se=!se,fe=!0);var Tr=ar.mongoConj,Pr=S.map(function(or){return Go([].concat((0,Se.A)(e),[t]),or,r,a,fe,J!="array",J=="array"?function(Lt){return"$$el".concat(D).concat(Lt)}:void 0)}).filter(function(or){return typeof or<"u"});if(!(!ae&&!Pr.size)){var ir;if(Pr.size==1)ir=Pr.first();else if(Pr.size>1){var at=Pr.toList().toJS(),bt=L&&Tr=="$and";bt&&(ir=at.reduce(function(or,Lt){if(or){for(var Vt in Lt){if(Vt[0]=="$"){or=void 0;break}if(or[Vt]==null)or[Vt]=Lt[Vt];else{var zr=or[Vt],ot=Lt[Vt];mc(zr)||(zr={$eq:zr}),mc(ot)||(ot={$eq:ot});var ur=Object.keys(zr)[0],Xr=Object.keys(ot)[0];if(ur==Xr){or=void 0;break}or[Vt]=Object.assign({},zr,ot)}}return or}},{})),ir||(ir=(0,ne.A)({},Tr,at))}if(M)if(J=="array"){var it={$size:{$ifNull:["$"+U,[]]}},St=ir?{$size:{$ifNull:[{$filter:{input:"$"+U,as:"el",cond:ir}},[]]}}:it;ir=Go(e,t.set("type","rule"),r,a,me,!1,function(or){return St},it),ir={$expr:ir}}else ir=(0,ne.A)({},U,{$elemMatch:ir});return se&&(ir={$not:ir}),ir}}},im=function(e,t,r,a){var i,u,o,l,s,c,d,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,p=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,g=arguments.length>6&&arguments[6]!==void 0?arguments[6]:void 0,v=arguments.length>7&&arguments[7]!==void 0?arguments[7]:void 0,m=t.get("properties")||new he.Map,h=e.filter(function(Qe){return Qe.get("type")=="rule_group"}).length>0,O=e.filter(function(Qe){return Qe.get("type")=="rule_group"}).map(function(Qe){return Qe.get("properties").get("field")}).slice(-1).pop(),b=h&&O,S=m.get("operator"),C=m.get("operatorOptions"),L=m.get("field"),w=m.get("fieldSrc"),D=m.get("value"),V=m.get("valueSrc"),P=m.get("valueType"),_=m.get("asyncListValues");if(!(L==null||S==null||D===void 0)){var B=je(r,L),M=lr(r,S,L),q=(i=M)===null||i===void 0?void 0:i.reversedOp,K=lr(r,q,L),H=Ur(M);if(!((u=M)!==null&&u!==void 0&&u.mongoFormatOp)&&!((o=K)!==null&&o!==void 0&&o.mongoFormatOp)){a.errors.push("Operator ".concat(S," is not supported"));return}var U=f,te=!((l=M)!==null&&l!==void 0&&l.mongoFormatOp)&&!!((s=K)!==null&&s!==void 0&&s.mongoFormatOp),J=!!((c=K)!==null&&c!==void 0&&c.mongoFormatOp),ae=J&&(!!r.settings.reverseOperatorsForNot||te),ce=ae&&U||te,oe=!1;if(ce){var le=[q,S];S=le[0],q=le[1];var fe=[K,M];M=fe[0],K=fe[1],U=!U,oe=!0}var se,me=!1;if(w=="func"){var Fe=yc(a,r,L,b),pe=(0,Le.A)(Fe,2);se=pe[0],me=pe[1]}else se=mn(L,r,a,b),g&&(me=!0,se=g(se));if(se!=null){var Ae=[],Re=[],Ve;if(D!=null){var Ie=D.map(function(Qe,Yr){var Tr=V?V.get(Yr):null,Pr=P?P.get(Yr):null,ir=Nn(Qe,Tr,r),at=wr(r,L,S,Tr),bt=dt(r,L,S,at,Tr,{forExport:!0}),it=Uo(a,r,ir,Tr,Pr,bt,B,b,S,M,_),St=(0,Le.A)(it,2),or=St[0],Lt=St[1];return or!==void 0&&(me=me||Lt,Ae.push(Tr),Re.push(Pr)),or}),De=Ie.filter(function(Qe){return Qe===void 0}).size>0;if(Ie.size<H||De)return;Ve=H>1?Ie.toArray():H==1?Ie.first():null}var Te=me&&p,Ne=(d=M)===null||d===void 0?void 0:d.mongoFormatOp,Je=[se,S,v!==void 0&&Ve==null?v:Ve,me,Ae.length>1?Ae:Ae[0],Re.length>1?Re:Re[0],Pt(M,Kn),C,B],ar=Ne.call.apply(Ne,[r.ctx].concat(Je));return Te&&(ar={$expr:ar}),U&&(ar={$not:ar}),ar}}},Uo=function(e,t,r,a,i,u,o,l,s,c,d){if(r===void 0)return[void 0,!1];var f,p=!1;if(a=="field"){var g=om(e,t,r,l),v=(0,Le.A)(g,2);f=v[0],p=v[1]}else if(a=="func"){var m=yc(e,t,r,l),h=(0,Le.A)(m,2);f=h[0],p=h[1]}else if(typeof u?.mongoFormatValue=="function"){var O=u.mongoFormatValue,b=[r,gc(gc({},o?Xt()(o,["fieldSettings","listValues"]):{}),{},{asyncListValues:d}),Pt(u,In)];s&&(b.push(s),b.push(c)),f=O.call.apply(O,[t.ctx].concat(b))}else f=r;return[f,p]},om=function(e,t,r,a){var i=t.settings.fieldSeparator,u,o=!0;if(r){var l=je(t,r)||{},s=Dr(r,t),c=ja(r,t),d=c?c.join(i):null,f=t.settings.formatField,p=mn(r,t,e,a),g=f(p,s,d,l,t,!1);u="$"+g}return[u,o]},yc=function(e,t,r,a){var i,u,o=!0,l,s=(i=r.get)===null||i===void 0?void 0:i.call(r,"func"),c=(u=r.get)===null||u===void 0?void 0:u.call(r,"args"),d=$r(t,s);if(!d)return e.errors.push("Func ".concat(s," is not defined in config")),[void 0,!1];var f=Dr(s,t),p=f[f.length-1],g=d.mongoFunc||p,v=d.mongoArgsAsObject,m={},h=0,O=void 0,b=[],S=[];for(var C in d.args){var L;h++;var w=d.args[C],D=je(t,w),V=w.defaultValue,P=w.isOptional,_=V!=null&&V.func?"func":"value",B=c?c.get(C):void 0,M=B?B.get("value"):void 0,q=B?B.get("valueSrc"):void 0;q!=="func"&&(L=M)!==null&&L!==void 0&&L.toJS&&(M=M.toJS());var K=B?B.get("asyncListValues"):void 0,H=null,U=wr(t,w,H,q),te=dt(t,w,H,U,q,{forExport:!0}),J=Uo(e,t,M,q,w.type,te,D,a,null,null,K),ae=(0,Le.A)(J,2),ce=ae[0],oe=ae[1];if(M!=null&&ce===void 0)return q!="func"&&e.errors.push("Can't format value of arg ".concat(C," for func ").concat(s)),[void 0,!1];var le=void 0;if(ce===void 0&&!P&&V!=null){var fe=wr(t,w,H,_),se=dt(t,w,H,fe,_,{forExport:!0}),me=void 0,Fe=Uo(e,t,V,_,w.type,se,D,a,null,null,K),pe=(0,Le.A)(Fe,2);if(le=pe[0],me=pe[1],le===void 0)return _!="func"&&e.errors.push("Can't format default value of arg ".concat(C," for func ").concat(s)),[void 0,!1]}var Ae=ce??le;if(Ae!==void 0){if(b.length){var Re=rm(b),Ve;try{for(Re.s();!(Ve=Re.n()).done;){var Ie=Ve.value;m[Ie]=void 0}}catch(Ne){Re.e(Ne)}finally{Re.f()}b=[]}m[C]=Ae,O=Ae}else P||S.push(C),b.push(C)}if(S.length)return[void 0,!1];if(typeof d.mongoFormatFunc=="function"){var De=d.mongoFormatFunc,Te=[m];l=De.call.apply(De,[t.ctx].concat(Te))}else{if(d.mongoFormatFunc===null)return e.errors.push("Functon ".concat(g," is not supported")),[void 0,!1];v?l=(0,ne.A)({},g,m):h==1&&O!==void 0?l=(0,ne.A)({},g,O):l=(0,ne.A)({},g,Object.values(m))}return[l,o]};function um(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=lm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function lm(n,e){if(n){if(typeof n=="string")return Oc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Oc(n,e)}}function Oc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function bc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Sc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sm=function(e,t){return Fc(e,t,!1)},Fc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={errors:[]},i=xt(t,void 0,!1),u=Cc(e,i,a);return r?[u,a.errors]:(a.errors.length&&console.warn("Errors while exporting to SQL:",a.errors),u)},Cc=function(e,t,r){if(e){var a=e.get("type"),i=e.get("children1");if(a==="group"||a==="rule_group")return cm(e,t,r);if(a==="rule")return fm(e,t,r)}},cm=function(e,t,r){var a=e.get("type"),i=e.get("properties")||new he.Map,u=e.get("children1")||new he.List,o=a==="rule_group",l=o?i.get("field"):null,s=je(t,l)||{},c=s.mode;c=="array"&&r.errors.push("Aggregation is not supported for ".concat(l));var d=i.get("not"),f=!1,p=u.map(function(m){return Cc(m,t,r)}).filter(function(m){return typeof m<"u"});if(!(!f&&!p.size)){var g=i.get("conjunction");g||(g=tn(t));var v=t.conjunctions[g];return v.sqlFormatConj.call(t.ctx,p,g,d)}},dm=function(e,t){var r=t.sqlOp||e,a=Ur(t),i;return a==0?i=function(o,l,s,c,d,f,p,g){return"".concat(o," ").concat(r)}:a==1?i=function(o,l,s,c,d,f,p,g){return"".concat(o," ").concat(r," ").concat(s)}:a==2&&(i=function(o,l,s,c,d,f,p,g){var v,m,h=s==null||(v=s.first)===null||v===void 0?void 0:v.call(s),O=s==null||(m=s.get)===null||m===void 0?void 0:m.call(s,1);return"".concat(o," ").concat(r," ").concat(h," AND ").concat(O)}),i},fm=function(e,t,r){var a=e.get("properties")||new he.Map,i=a.get("field"),u=a.get("fieldSrc"),o=a.get("operator"),l=a.get("operatorOptions"),s=a.get("valueSrc"),c=a.get("valueType"),d=a.get("value"),f=a.get("asyncListValues");if(!(i==null||o==null)){var p=je(t,i)||{},g=lr(t,o,i)||{},v=g.reversedOp,m=lr(t,v,i)||{},h=Ur(g),O=!1,b=g.sqlOp||g.sqlFormatOp,S=m.sqlOp||m.sqlFormatOp;if(!b&&!S){r.errors.push("Operator ".concat(o," is not supported"));return}if(!b&&S){O=!0;var C=[v,o];o=C[0],v=C[1];var L=[m,g];g=L[0],m=L[1]}var w=[],D=[],V;if(d!=null){var P=d.map(function(H,U){var te=s?s.get(U):null,J=c?c.get(U):null,ae=Nn(H,te,t),ce=wr(t,i,o,te),oe=dt(t,i,o,ce,te,{forExport:!0}),le=Bo(r,t,ae,te,J,oe,p,o,g,f);return le!==void 0&&(w.push(te),D.push(J)),le}),_=P.filter(function(H){return H===void 0}).size>0;if(_||P.size<h)return;V=h==1?P.first():P}var B=g.sqlFormatOp||dm(o,g);if(!B){r.errors.push("Operator ".concat(o," is not supported"));return}var M=u=="func"?Ec(r,t,i):Tc(r,t,i);if(M!=null){var q=[M,o,V,w.length>1?w:w[0],D.length>1?D:D[0],Pt(g,Kn),l,p],K;if(K=B.call.apply(B,[t.ctx].concat(q)),O&&(K=t.settings.sqlFormatReverse.call(t.ctx,K)),K===void 0){r.errors.push("Operator ".concat(o," is not supported for value source ").concat(w.join(", ")));return}return K}}},Bo=function(e,t,r,a,i,u,o,l,s,c){if(r!==void 0){var d;if(a=="field")d=Tc(e,t,r);else if(a=="func")d=Ec(e,t,r);else if(typeof u?.sqlFormatValue=="function"){var f=u.sqlFormatValue,p=[r,Sc(Sc({},Xt()(o,["fieldSettings","listValues"])),{},{asyncListValues:c}),Pt(u,In)];if(l&&(p.push(l),p.push(s)),a=="field"){var g=je(t,r)||{};p.push(g)}d=f.call.apply(f,[t.ctx].concat(p))}else Array.isArray(r)?d=r.map(function(v){return Tn.escape(v)}):d=Tn.escape(r);return d}},Tc=function(e,t,r){if(r){var a=t.settings.fieldSeparator,i=je(t,r)||{},u=Dr(r,t),o=ja(r,t),l=o?o.join(a):null,s=t.settings.formatField,c=mn(r,t,e,null,{useTableName:!0}),d=s(c,u,l,i,t);return d}},Ec=function(e,t,r){var a,i,u=(a=r.get)===null||a===void 0?void 0:a.call(r,"func"),o=(i=r.get)===null||i===void 0?void 0:i.call(r,"args"),l=$r(t,u);if(!l){e.errors.push("Func ".concat(u," is not defined in config"));return}var s=Dr(u,t),c=s[s.length-1],d=l.sqlFunc||c,f={},p=[],g=[];for(var v in l.args){var m,h=l.args[v],O=je(t,h),b=h.defaultValue,S=h.isOptional,C=b!=null&&b.func?"func":"value",L=o?o.get(v):void 0,w=L?L.get("value"):void 0,D=L?L.get("valueSrc"):void 0;D!=="func"&&(m=w)!==null&&m!==void 0&&m.toJS&&(w=w.toJS());var V=L?L.get("asyncListValues"):void 0,P=Bo(e,t,w,D,h.type,O,h,null,null,V);if(w!=null&&P===void 0){D!="func"&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(u));return}var _=void 0;if(P===void 0&&!S&&b!=null&&(_=Bo(e,t,b,C,h.type,O,h,null,null,V),_===void 0)){C!="func"&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(u));return}var B=P??_;if(B!==void 0){if(p.length){var M=um(v),q;try{for(M.s();!(q=M.n()).done;){var K=q.value;f[K]=void 0}}catch(ae){M.e(ae)}finally{M.f()}p=[]}f[v]=B}else S||g.push(v),p.push(v)}if(!g.length){var H;if(typeof l.sqlFormatFunc=="function"){var U=l.sqlFormatFunc,te=[f];H=U.call.apply(U,[t.ctx].concat(te))}else{var J=Object.entries(f).map(function(ae){var ce=(0,Le.A)(ae,2),oe=ce[0],le=ce[1];return le}).join(", ");H="".concat(d,"(").concat(J,")")}return H}};function Ac(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Lc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ac(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ac(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function pm(n){if(n==null)return null;var e=n.split(",").map(Number);return{top_left:{lat:e[0],lon:e[1]},bottom_right:{lat:e[2],lon:e[3]}}}function vm(n,e){if(n.length>1)return{gte:"".concat(n[0]),lte:"".concat(n[1])};var t=n[0];switch(e){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(t,"||/d"),lte:"".concat(t,"||+1d")};case"less_or_equal":return{lte:"".concat(t)};case"greater_or_equal":return{gte:"".concat(t)};case"less":return{lt:"".concat(t)};case"greater":return{gt:"".concat(t)};default:return}}function gm(n){return{value:"*"+n+"*"}}function mm(n,e){switch(n){case"AND":return e?"must_not":"must";case"OR":return e?"should_not":"should";case"NOT":return e?"must":"must_not";default:return}}function hm(n){return{value:n}}function ym(n,e){return n}function Om(n,e,t,r,a,i){var u=ym(r,a);switch(n){case"filter":return{script:a.operators[t].elasticSearchScript(r,e)};case"exists":return{field:r};case"match":return(0,ne.A)({},u,e[0]);case"term":return i===Sm?(0,ne.A)({},r,{value:e[0]}):(0,ne.A)({},r,e[0]);case"geo_bounding_box":return(0,ne.A)({},r,pm(e[0]));case"range":return(0,ne.A)({},r,vm(e,t));case"wildcard":return(0,ne.A)({},r,gm(e[0]));case"regexp":return(0,ne.A)({},r,hm(e[0]));default:return}}function wc(n,e,t,r,a,i){if(!(!n||!t||e==null)){var u=t,o=r.operators[u];if(o){var l=o,s=l.elasticSearchQueryType,c=!1;if(!s&&o.reversedOp){c=!0,u=o.reversedOp,o=r.operators[u];var d=o;s=d.elasticSearchQueryType}var f=wr(r,n,u,a),p=r.widgets[f];if(p){var g=p.elasticSearchFormatValue,v;if(typeof s=="function"?v=s(f):v=s,!!v){var m;return typeof g=="function"?m=g(v,e,u,n,r):m=Om(v,e,u,n,r,i),c?{bool:{must_not:(0,ne.A)({},v,Lc({},m))}}:(0,ne.A)({},v,Lc({},m))}}}}}function bm(n,e,t,r,a,i){if(!(!n||!n.size)){var u=n.valueSeq().toArray(),o=mm(e,t),l=u.map(function(c){return r(c,a,i)}).filter(function(c){return c!==void 0});if(l.length){var s=l.flat(1/0);return{bool:(0,ne.A)({},o,s)}}}}var Sm="ES_7_SYNTAX",Fm="ES_6_SYNTAX";function jc(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fm,r=xt(e,void 0,!1);if(n){var a=n.get("type"),i=n.get("properties")||new Map;if(a==="rule"&&i.get("field")){var u,o,l,s=i.get("operator"),c=i.get("field"),d=i.get("fieldSrc"),f=(u=i.get("value"))===null||u===void 0?void 0:u.toJS(),p=(o=i.get("valueType"))===null||o===void 0?void 0:o.get(0),g=(l=i.get("valueSrc"))===null||l===void 0?void 0:l.get(0);return g==="func"||d=="func"?void 0:f&&Array.isArray(f[0])?f[0].map(function(O){return wc(c,[O],s,r,g,t)}):wc(c,f,s,r,g,t)}if(a==="group"||a==="rule_group"){var v=i.get("not"),m=i.get("conjunction");m||(m=tn(r));var h=n.get("children1");return bm(h,m,v,jc,r,t)}}}var Mn=y(80045);function Rc(n,e,t,r,a,i,u){try{var o=n[i](u),l=o.value}catch(s){return void t(s)}o.done?e(l):Promise.resolve(l).then(r,a)}function Cm(n){return function(){var e=this,t=arguments;return new Promise(function(r,a){var i=n.apply(e,t);function u(l){Rc(i,r,a,u,o,"next",l)}function o(l){Rc(i,r,a,u,o,"throw",l)}u(void 0)})}}var Tm=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function Em(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Am(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Am(n,e){if(n){if(typeof n=="string")return Pc(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Pc(n,e)}}function Pc(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function xc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ln(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Lm=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,Se.A)(e).reverse().findIndex(t);return r==-1?-1:e.length-1-r},wm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;return function(){var a=Cm(pn().mark(function i(u,o,l){var s,c,d,f,p,g,v,m;return pn().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(s=l?.pageSize!=null?l.pageSize:t,c=wu(e).filter(function(b){var S=b.title,C=b.value;return u==null?!0:S.toUpperCase().indexOf(u.toUpperCase())!=-1||"".concat(C).toUpperCase().indexOf(u.toUpperCase())!=-1}),d=s?Math.ceil(c.length/s):0,f=o||0,p=s?Math.ceil(f/s):null,g=s?c.slice(f,f+s):c,v=s?f+g.length:null,m=s?v<c.length:!1,!r){O.next=11;break}return O.next=11,Su(r);case 11:return O.abrupt("return",{values:g,hasMore:m});case 12:case"end":return O.stop()}},i)}));return function(i,u,o){return a.apply(this,arguments)}}()},jm=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!t)return e;var i=e||[],u=t.filter(function(l){return i.find(function(s){return""+s.value==""+l.value})==null}).map(function(l){return a?Ln(Ln({},l),{},{isHidden:!0}):l}),o=r?[].concat((0,Se.A)(u),(0,Se.A)(i)):[].concat((0,Se.A)(i),(0,Se.A)(u));return o},Rm=function(e,t,r){var a,i=e==null||e==""?void 0:(a=e?.value)!==null&&a!==void 0?a:e,u=ri(i,t),o=r&&!u?qi(i):void 0,l=u||o,s=l?[l]:void 0;return[i,s]},Pm=function(e,t,r){var a=e.map(function(u,o){var l,s=u==null||u==""?void 0:(l=u?.value)!==null&&l!==void 0?l:u,c=ri(s,t),d=r&&!c?qi(s):void 0,f=c||d;return f}).filter(function(u){return u!=null}),i=a.map(function(u){var o;return(o=u?.value)!==null&&o!==void 0?o:u});return i.length||(i=void 0),[i,a]},xm=function(e){if(e==null)return null;var t=e.title,r=e.value,a=e.disabled,i=e.groupTitle,u=e.grouplabel,o=e.renderTitle,l=e.children,s=e.label,c=e.isCustom,d=e.isHidden,f=(0,Mn.A)(e,Tm),p={value:r,title:t||s||l};return a&&(p.disabled=a),c&&(p.isCustom=c),d&&(p.isHidden=d),(i||u)&&(p.groupTitle=i||u),o&&(p.renderTitle=o),p=Ln(Ln({},p),f),p},Im=function(e){var t=[],r=[],a=Em(e),i;try{var u=function(){var l=i.value,s=Lm(t,function(c){var d,f;return((d=c.groupTitle)!==null&&d!==void 0?d:"")==((f=l.groupTitle)!==null&&f!==void 0?f:"")});l.groupTitle!=null&&!r.includes(l.groupTitle)&&(r.push(l.groupTitle),r.length===1&&(t=t.map(function(c){return Ln(Ln({},c),{},{groupTitle:""})}))),l.groupTitle==null&&r.length&&(l=Ln(Ln({},l),{},{groupTitle:""})),s!=-1?t.splice(s+1,0,l):t.push(l)};for(a.s();!(i=a.n()).done;)u()}catch(o){a.e(o)}finally{a.f()}return t},Vm={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},Dm={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,i=e.dim,u=i.charAt(0).toUpperCase()+i.slice(1)+"s",o=r+u;return"".concat(t,".").concat(o,"(").concat(a,")")},spelImport:function(e){var t,r,a,i,u,o=(t=e.methodName)===null||t===void 0?void 0:t.match(/^(minus|plus)(\w+)s$/);if(o&&(u=o[2].toLowerCase(),a=o[1],["minus","plus"].includes(a)&&["day","week","month","year"].includes(u)))return a={type:"string",val:a},u={type:"string",val:u},i=e.args[0],r=e.obj,{date:r,op:a,val:i,dim:u}},jsonLogic:function(e){var t=e.date,r=e.op,a=e.val,i=e.dim;return{date_add:[t,a*(r=="minus"?-1:1),i]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]),a=e.date_add[1]>=0?"plus":"minus",i=e.date_add[2];return[t,a,r,i]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,a=e.val,i=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(a)*(r=="minus"?-1:1)," ").concat(i.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,a=e.val,i=e.dim;return a?"".concat(t," ").concat(r=="minus"?"-":"+"," ").concat(a," ").concat(i):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},Nm={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},km={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Mm={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,a=e.bias,i=e.val;return"(".concat(r," * ").concat(i," + ").concat(a,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return"(".concat(t," * ").concat(a," + ").concat(r,")")},spelImport:function(e){var t,r,a,i;if(e.type==="op-plus"){var u=(0,Le.A)(e.children,2);if(i=u[0],a=u[1],i.type==="op-multiply"){var o=(0,Le.A)(i.children,2);return t=o[0],r=o[1],{coef:t,val:r,bias:a}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias,a=e.val;return{$sum:[{$multiply:[t,a]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias,a=e.val;return{"+":[{"*":[t,a]},r]}},jsonLogicImport:function(e){var t=e["+"][0]["*"][0],r=e["+"][0]["*"][1],a=e["+"][1];return[t,r,a]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}},_m=function(e,t,r,a,i,u,o,l,s,c,d,f){var p=typeof a=="string"&&!a.startsWith("$")?"$"+a:a,g=t(u,f);if(g!==void 0)return r?!o&&(!e||e=="$eq")?(0,ne.A)({},a,{$ne:g}):o?{$not:(0,ne.A)({},e,[p,g])}:(0,ne.A)({},a,{$not:(0,ne.A)({},e,g)}):!o&&(!e||e=="$eq")?(0,ne.A)({},a,g):o?(0,ne.A)({},e,[p,g]):(0,ne.A)({},a,(0,ne.A)({},e,g))},Gm=function(e,t,r,a,i,u,o,l,s,c,d){var f=typeof r=="string"&&!r.startsWith("$")?"$"+r:r;return t?u?{$not:{$and:[(0,ne.A)({},e[0],[f,i[0]]),(0,ne.A)({},e[1],[f,i[1]])]}}:(0,ne.A)({},r,{$not:(0,ne.A)((0,ne.A)({},e[0],i[0]),e[1],i[1])}):u?{$and:[(0,ne.A)({},e[0],[f,i[0]]),(0,ne.A)({},e[1],[f,i[1]])]}:(0,ne.A)({},r,(0,ne.A)((0,ne.A)({},e[0],i[0]),e[1],i[1]))},Um={utils:{SqlString:Tn,moment:qn(),mongoFormatOp1:_m,mongoFormatOp2:Gm,mongoEmptyValue:Ku,escapeRegExp:Ou,sqlEmptyValue:Wu,stringifyForDisplay:Hu,getTitleInListValues:ju,spelEscape:Qn,spelFixList:zu,wrapWithBrackets:qu}};const Bm=Um;function $m(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=Wm(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function Wm(n,e){if(n){if(typeof n=="string")return Ic(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ic(n,e)}}function Ic(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Vc(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function dr(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vc(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Vc(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Km={AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,a){var i=e.size>1?e.join(" "+(a?"AND":"&&")+" "):e.first();return(e.size>1||r)&&(i=this.utils.wrapWithBrackets(i)),r&&(i="NOT "+i),i},sqlFormatConj:function(e,t,r){var a=e.size>1?e.join(" AND "):e.first();return(e.size>1||r)&&(a=this.utils.wrapWithBrackets(a)),r&&(a="NOT "+a),a},spelFormatConj:function(e,t,r,a){r&&(a=!1);var i=e.size>1?e.join(" && "):e.first();return(e.size>1||r)&&!a&&(i=this.utils.wrapWithBrackets(i)),r&&(i="!"+i),i}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,a){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(a?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,a){return r&&(a=!1),e.size>1?(r?"!":"")+(a?"":"(")+e.join(" || ")+(a?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},zm={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,a,i,u,o,l,s){var c=l?"=":u.label;return i=="boolean"&&l?r=="No"?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(c," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,a,i,u,o,l,s){return i=="boolean"&&l?r=="No"?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(u.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return i},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(i){return i},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(i){return i},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(i){return i},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(i){return i},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u):void 0},!0].concat(a))},valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?"^"+t.utils.escapeRegExp(u):void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(u){return typeof u=="string"?t.utils.escapeRegExp(u)+"$":void 0},!1].concat(a))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,a,i,u,o,l){var s=r.first(),c=r.get(1);return l?"".concat(e," BETWEEN ").concat(s," AND ").concat(c):"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},spelFormatOp:function(e,t,r,a,i,u,o,l){var s=r[0],c=r[1];return"".concat(e," >= ").concat(s," && ").concat(e," <= ").concat(c)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return e==="time"?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,a,i,u,o,l){var s=r.first(),c=r.get(1);return l?"".concat(e," NOT BETWEEN ").concat(s," AND ").concat(c):"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},spelFormatOp:function(e,t,r,a,i,u,o,l){var s=r[0],c=r[1];return"(".concat(e," < ").concat(s," || ").concat(e," > ").concat(c,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return e[0]!=null&&e[1]!=null?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,a,i,u,o,l){return l?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,a,i,u,o,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") = ").concat(s)},spelFormatOp:function(e,t,r,a,i,u,o,l){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(u,o){return[t.utils.mongoEmptyValue(o),null]},!1].concat(a))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,a,i,u,o,l){return l?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,a,i,u,o,l){var s=this.utils.sqlEmptyValue(l);return"COALESCE(".concat(e,", ").concat(s,") <> ").concat(s)},spelFormatOp:function(e,t,r,a,i,u,o,l){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(u,o){return[t.utils.mongoEmptyValue(o),null]},!1].concat(a))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,a,i,u,o,l){return l?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,a,i,u,o,l){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,a,i,u,o,l){return l?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,a,i,u,o,l){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,i,u,o,l){var s=l?"=":"==";return"".concat(e," ").concat(s," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,i,u,o,l){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return i},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,a,i,u,o,l){return a=="value"?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,i,u,o,l){if(a=="value")return"".concat(e," IN (").concat(r.join(", "),")")},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(i){return i},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,a,i,u,o,l){return a=="value"?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,a,i,u,o,l){if(a=="value")return"".concat(e," NOT IN (").concat(r.join(", "),")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(i){return i},!1].concat(r))},reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,a,i,u,o,l){return a=="value"?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(i){return i},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,a,i,u,o,l){return a=="value"?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,a,i,u,o,l){var s=l?"=":"==";return a=="value"?"".concat(e," ").concat(s," [").concat(r.join(", "),"]"):"".concat(e," ").concat(s," ").concat(r)},sqlFormatOp:function(e,t,r,a,i,u,o,l){var s=this;if(a=="value")return"".concat(e," = '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,a,i,u,o,l){return a=="value"?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,a,i,u,o,l){var s=this;if(a=="value")return"".concat(e," != '").concat(r.map(function(c){return s.utils.SqlString.trim(c)}).join(","),"'")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(i){return i},!1].concat(r))},reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,a,i,u,o,l){var s=r.first(),c=r.get(1),d=o?.get("proximity");return"".concat(e," ").concat(s," NEAR/").concat(d," ").concat(c)},sqlFormatOp:function(e,t,r,a,i,u,o,l){var s=r.first(),c=r.get(1),d=this.utils.SqlString.trim(s),f=this.utils.SqlString.trim(c),p=o?.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(d,", ").concat(f,"), ").concat(p,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(i){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return i},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(i){return 0},!1].concat(r))}}},Hm={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,a,i){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,a,i){return i.sqlOp=="LIKE"||i.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){return i.sqlOp=="LIKE"||i.sqlOp=="NOT LIKE"?this.utils.SqlString.escapeLike(e,a!="starts_with",a!="ends_with"):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var a=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,a)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,a){return a?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,a){var i=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return a?this.utils.stringifyForDisplay(i):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,a){var i=this,u=e.map(function(o){return i.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,o)});return a?u.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,a,i){var u=this;return e.map(function(o){return u.utils.SqlString.escape(o)})},spelFormatValue:function(e,t,r,a,i){var u=i&&i.spelOp&&i.spelOp.startsWith("${1}"),o=this.utils.spelEscape(e);return u&&(o=this.utils.spelFixList(o)),o},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,a){var i=this.utils.moment(e,r.valueFormat);return a?i.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,a,i){var u=this.utils.moment(e,r.valueFormat),o=u.format("YYYY-MM-DD"),l="yyyy-MM-dd";return"T(java.time.LocalDate).parse('".concat(o,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,i,u,o;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(i=a.includes)!==null&&i!==void 0&&i.call(a," ")||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&(o=u.toLowerCase)!==null&&o!==void 0&&o.call(u).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,a){var i=this.utils.moment(e,r.valueFormat);return a?i.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,a,i){var u=this.utils.moment(e,r.valueFormat),o="HH:mm:ss",l=u.format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(l,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var a,i,u;if(!t)return[void 0,"No widget def to get value format"];if(r!=null&&r.fmt&&(!((a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(i=a.toLowerCase)!==null&&i!==void 0&&i.call(a).includes("hh:mm"))||(u=r.fmt)!==null&&u!==void 0&&(u=u.value)!==null&&u!==void 0&&u.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var o=this.utils.moment(e.value,"HH:mm:ss");return o.isValid()?[o.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.get("hour")*60*60+r.get("minute")*60+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.get("hour")*60*60+a.get("minute")*60+a.get("second")},elasticSearchFormatValue:function(e,t,r,a){return{script:{script:{source:"doc[".concat(a,"][0].getHour() >== params.min && doc[").concat(a,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,a){var i=this.utils.moment(e,r.valueFormat);return a?i.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,a,i){var u=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(u.toDate())},spelFormatValue:function(e,t,r,a,i){var u=this.utils.moment(e,r.valueFormat),o=u.format("YYYY-MM-DD HH:mm:ss"),l="yyyy-MM-dd HH:mm:ss";return"T(java.time.LocalDateTime).parse('".concat(o,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat(l,"'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var a,i;if(!t)return[void 0,"No widget def to get value format"];if(!(r!=null&&(a=r.fmt)!==null&&a!==void 0&&(a=a.value)!==null&&a!==void 0&&(i=a.includes)!==null&&i!==void 0&&i.call(a," ")))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var u=this.utils.moment(e.value,this.utils.moment.ISO_8601);return u.isValid()?[u.format(t?.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var a=this.utils.moment(e,r.valueFormat);return a.isValid()?a.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,a){return a?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,a,i){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,a,i){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,a,i,u,o){return a&&o.label||e},sqlFormatValue:function(e,t,r,a,i,u){return e},spelFormatValue:function(e,t,r,a,i){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(e===""?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return e===""?null:e}}},qm={text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},Jm=dr(dr({},Gs),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,a,i,u){var o=this,l=a.map(function(s,c){var d=s.key,f=s.parent,p=s.fieldSeparator;return c==0?f=="[map]"?"#this[".concat(o.utils.spelEscape(d),"]"):(f=="[class]",d):f=="map"||f=="[map]"?"[".concat(o.utils.spelEscape(d),"]"):(f=="class"||f=="[class]","".concat(p).concat(d))}).join("");return i.fieldName&&(l=e),i.isSpelVariable&&(l="#"+l),l},sqlFormatReverse:function(e){if(e!=null)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(e!=null)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,t,r,a,i,u){if(e!=null)return u?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,t,r,a,i,u,o,l,s,c){var d=o.labelForFormat,f=o.cardinality;if(f==0){var p=e?" HAVE ".concat(e):"";return"".concat(d," OF ").concat(t).concat(p)}else if(f==null||f==1){var g=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(g," ").concat(d," ").concat(a)}else if(f==2){var v=e?" WHERE ".concat(e):"",m=a.first(),h=a.get(1);return"COUNT OF ".concat(t).concat(v," ").concat(d," ").concat(m," AND ").concat(h)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,a){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),Dc=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a={rangeslider:Xm,treeselect:Zm,treemultiselect:eh,rangeable__date:Ym("date","date")},i=$m(t),u;try{for(i.s();!(u=i.n()).done;){var o=u.value,l=a[o];if(l)e=l(e,r);else throw new Error("Can't ".concat(r?"add":"remove"," mixin ").concat(o))}}catch(s){i.e(s)}finally{i.f()}return e},Nc=function(e,t){return Dc(e,t,!0)},Qm=function(e,t){return Dc(e,t,!1)},Ym=function(e,t){return function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.types;return i=dr(dr({},i),{},(0,ne.A)({},e,dr(dr({},i[e]),{},{widgets:dr({},i[e].widgets)}))),a?i[e].widgets[t]=dr({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},i[e].widgets[t]):delete i[e].widgets[t],dr(dr({},r),{},{types:i})}},Xm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=dr({},r),t?r.rangeslider=dr({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(u,o,l,s){return s?this.utils.stringifyForDisplay(u):JSON.stringify(u)},sqlFormatValue:function(u,o,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},singleWidget:"slider",toJS:function(u,o){return u}},r.rangeslider):delete r.rangeslider,a=dr(dr({},a),{},{number:dr(dr({},a.number),{},{widgets:dr({},a.number.widgets)})}),t?a.number.widgets.rangeslider=dr({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},a.number.widgets.rangeslider):delete a.number.widgets.rangeslider,dr(dr({},e),{},{widgets:r,types:a})},Zm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=dr({},r),t?r.treeselect=dr({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(u,o,l,s){var c=o.fieldSettings.treeValues||o.fieldSettings.listValues||o.asyncListValues,d=this.utils.getTitleInListValues(c,u);return s?this.utils.stringifyForDisplay(d):JSON.stringify(u)},sqlFormatValue:function(u,o,l,s,c){return this.utils.SqlString.escape(u)},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,o){return u}},r.treeselect):delete r.treeselect,a=dr({},a),t?a.treeselect=dr({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},a.treeselect):delete a.treeselect,dr(dr({},e),{},{widgets:r,types:a})},eh=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.widgets,a=e.types;return r=dr({},r),t?r.treemultiselect=dr({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(u,o,l,s){var c=this,d=o.fieldSettings.treeValues||o.fieldSettings.listValues||o.asyncListValues,f=u.map(function(p){return c.utils.getTitleInListValues(d,p)});return s?f.map(this.utils.stringifyForDisplay):u.map(JSON.stringify)},sqlFormatValue:function(u,o,l,s,c){var d=this;return u.map(function(f){return d.utils.SqlString.escape(f)})},spelFormatValue:function(u){return this.utils.spelEscape(u)},toJS:function(u,o){return u}},r.treemultiselect):delete r.treemultiselect,a=dr({},a),t?a.treemultiselect=dr({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},a.treemultiselect):delete a.treemultiselect,dr(dr({},e),{},{widgets:r,types:a})},rh={addMixins:Nc,removeMixins:Qm},$o={conjunctions:Km,operators:zm,widgets:Hm,types:qm,settings:Jm,ctx:Bm};$o=Nc($o,["rangeslider","treeselect","treemultiselect"]);const Ir=$o;var kc="ADD_GROUP",Wo="ADD_CASE_GROUP",Mc="REMOVE_GROUP",_c="SET_CONJUNCTION",Gc="SET_NOT",Uc="ADD_RULE",Bc="REMOVE_RULE",$c="SET_FIELD",Wc="SET_FIELD_SRC",Kc="SET_OPERATOR",zc="SET_VALUE",Hc="SET_VALUE_SRC",qc="SET_FUNC_VALUE",Jc="SET_OPERATOR_OPTION",Qc="SET_LOCK",Ko="SET_TREE",Yc="MOVE_ITEM",Xc="after",Zc="before",zo="append",Ho="prepend",ed="SET_DRAG_PROGRESS",rd="SET_DRAG_START",td="SET_DRAG_END",th=y(73916),gi=y.n(th);function nd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function on(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?nd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):nd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function qo(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=nh(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function nh(n,e){if(n){if(typeof n=="string")return ad(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ad(n,e)}}function ad(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var id=function(e,t,r,a,i,u){var o,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null,s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},c=e.getIn(Ce(t));if(!c)return e;var d=(i==null||(o=i.get)===null||o===void 0?void 0:o.call(i,"id"))||a,f=u.settings.shouldCreateEmptyGroup,p=t.push(d),g=!f,v=!!(s!=null&&s.isDefaultCase),m=e;return e=_n(e,t,r,d,En(u).merge((0,he.fromJS)(i)||{}),u,l),e!==m&&(!l&&!v&&(e=e.setIn(Ce(p,"children1"),new he.default.OrderedMap),g&&(e=_n(e,p,"rule",cr(),rn(u),u))),e=Ht(e)),e},ah=function(e,t,r){var a=e.getIn(Ce(t));if(!a)return e;e=Jo(e,t);var i=r.settings.canLeaveEmptyGroup,u=t.slice(0,-1),o=!eo(e,u);if(o&&!i&&(e=ti(e),Zi(e)&&!i)){var l=!1,s=!1;e=_n(e,new he.default.List,"rule",cr(),rn(r,void 0,void 0,l,s),r)}return e=Ht(e),e},ih=function(e,t,r){var a=e.getIn(Ce(t));if(!a)return e;e=Jo(e,t);var i=r.settings.canLeaveEmptyGroup,u=t.pop(),o=e.getIn(Ce(u)),l=o.getIn(["properties","field"]),s=o.getIn(["properties","operator"]),c=l?je(r,l):null,d=s?lr(r,s,l):null,f=l&&s&&d.cardinality!=0,p=o.get("type")=="rule_group",g=!eo(e,u),v=p?f&&c.initialEmptyWhere:i;if(g&&!v&&(p&&(e=e.deleteIn(Ce(u))),e=ti(e),Zi(e)&&!i)){var m=!1,h=!1;e=_n(e,new he.default.List,"rule",cr(),rn(r,void 0,void 0,m,h),r)}return e=Ht(e),e},oh=function(e,t,r){var a=e.getIn(Ce(t));return a&&(e=e.setIn(Ce(t,"properties","not"),r)),e},uh=function(e,t,r){var a=e.getIn(Ce(t));return a&&(e=Ru(e.setIn(Ce(t,"properties","isLocked"),r))),e},lh=function(e,t,r){var a=e.getIn(Ce(t));return a&&(e=e.setIn(Ce(t,"properties","conjunction"),r)),e},_n=function(e,t,r,a,i,u){var o,l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;if(r==="switch_group")throw new Error("Can't add switch_group programmatically");var s=e.getIn(Ce(t));if(!s)return e;var c=(i==null||(o=i.get)===null||o===void 0?void 0:o.call(i,"id"))||a,d=u.settings,f=d.maxNumberOfCases,p=d.maxNumberOfRules,g=d.maxNesting,v=e.get("type"),m=v==="switch_group",h=m?e.getIn(Ce(t.take(2))):null,O=Ce(t,"children1"),b=e.getIn(O),S=!!b&&b.size,C=S?b.size:null,L,w;r==="case_group"?(L=C,w=f):r==="group"?(L=t.size,w=g):s?.get("type")==="rule_group"||(L=Xi(m?h:e),w=p);var D=w&&L?L<w:!0,V={type:r,id:c,properties:i};mh(u,V,l);var P=r==="case_group"&&S&&b.last().get("children1")==null;if(D){var _=new he.default.OrderedMap((0,ne.A)({},c,new he.default.Map(V)));if(!S)e=e.setIn(O,_);else if(P){var B=b.last(),M=new he.default.OrderedMap((0,ne.A)((0,ne.A)({},c,new he.default.Map(V)),B.get("id"),B));e=e.deleteIn(Ce(O,"children1",B.get("id"))),e=e.mergeIn(O,M)}else e=e.mergeIn(O,_);e=Ht(e)}return e},Jo=function(e,t){return e=e.deleteIn(Ce(t)),e=Ht(e),e},sh=function(e,t,r,a,i){var u=Hn(e,t),o=t.pop(),l=t.size>1?Hn(e,o):null,s=l?l.get("children1"):null,c=Hn(e,r),d=a==zo||a==Ho?r:r.pop(),f=a==zo||a==Ho?c:r.size>1?Hn(e,d):null,p=f?f.get("children1"):null;if(!l||!f||!u)return e;var g=l.get("id")==f.get("id"),v=d.size<o.size&&Ja(d.toArray(),o.toArray().slice(0,d.size)),m=d.size>o.size&&Ja(o.toArray(),d.toArray().slice(0,o.size)),h=null,O=null;v?h=he.default.List(o.toArray().slice(d.size)):m&&(O=he.default.List(d.toArray().slice(o.size)));var b=p,S=s;return m||(S=S.delete(u.get("id"))),g?b=S:v&&(b=b.updateIn(Qi(h,"children1"),function(C){return S})),a==Zc||a==Xc?b=he.default.OrderedMap().withMutations(function(C){var L=qo(b.entries()),w;try{for(L.s();!(w=L.n()).done;){var D=(0,Le.A)(w.value,2),V=D[0],P=D[1];V==c?.get("id")&&a==Zc&&C.set(u.get("id"),u),C.set(V,P),V==c?.get("id")&&a==Xc&&C.set(u.get("id"),u)}}catch(_){L.e(_)}finally{L.f()}}):a==zo?b=b.merge(he.default.OrderedMap((0,ne.A)({},u.get("id"),u))):a==Ho&&(b=he.default.OrderedMap((0,ne.A)({},u.get("id"),u)).merge(b)),m&&(S=S.updateIn(Qi(O,"children1"),function(C){return b}),S=S.delete(u.get("id"))),!g&&!v&&(e=e.updateIn(Ce(o,"children1"),function(C){return S})),m||(e=e.updateIn(Ce(d,"children1"),function(C){return b})),e=Ht(e),e},ch=function(e,t,r,a){var i=e.getIn(Ce(t));if(!i)return e;var u=a.settings.keepInputOnChangeFieldSrc,o=i.get("properties"),l=o?.get("field"),s=o?.get("fieldType"),c=je(a,l),d=c?.type||s;(!d||d==="!group"||d==="!struct")&&(d=null);var f=!ii.includes(d),p=u&&!Eo(i,a)&&f;return p?(e=e.setIn(Ce(t,"properties","field"),null),e=e.deleteIn(Ce(t,"properties","fieldError")),e=e.setIn(Ce(t,"properties","fieldType"),d)):e=e.setIn(Ce(t,"properties"),rn(a,null,null,!1)),e=e.setIn(Ce(t,"properties","fieldSrc"),r),e},dh=function(e,t,r,a,i,u,o,l,s){var c=arguments.length>9&&arguments[9]!==void 0?arguments[9]:{},d=t.getIn(Ce(r));if(!d)return t;var f=a===-1,p=d.get("properties"),g=p.get("field"),v=p.get("value"),m=f?g:v.getIn([a]),h=[],O=m,b=qo(i||[]),S;try{for(b.s();!(S=b.n()).done;){var C=(0,Le.A)(S.value,2),L=C[0],w=C[1];if(h.push([L,w,O]),L!==O.get("func")){var D=h.map(function(fe){var se=(0,Le.A)(fe,2),me=se[0],Fe=se[1];return"".concat(me,"(").concat(Fe,")")}).join("/")||"root";throw new Error("In ".concat(f?"LHS":"RHS"," for path ").concat(D," expected func key ").concat(L," but got ").concat(parent.get("func")))}O=O.getIn(["args",w,"value"])}}catch(fe){b.e(fe)}finally{b.f()}if(u){var _=O.get("func"),B=$r(e,_),M=B.args,q=M[u];l==="!valueSrc"?O=Os(O,u,o,q,e):O=Fo(O,u,o,q,e)}else{var V=o,P=!0;O=hs(O,V,e,P),c.canDropArgs=!0}for(var K=O;h.length;){var H=h.pop(),U=(0,Le.A)(H,3),te=U[0],J=U[1],ae=U[2],ce=$r(e,te),oe=ce.args,le=oe[J];K=Fo(ae,J,K,le,e)}return f?od(t,r,K,e,s,c):ud(t,r,a,K,void 0,e,s,c)},od=function(e,t,r,a,i){var u,o,l,s,c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},d=e.getIn(Ce(t));if(!d)return{state:e};var f=c.isEndValue,p=c.canDropArgs;if(!r)return e=Jo(e,t),{state:e};var g=a.settings,v=g.fieldSeparator,m=g.setOpOnChangeField,h=g.showErrorMessage;Array.isArray(r)&&(r=r.join(v));var O=d.get("type"),b=d.get("properties"),S=O=="rule_group",C=b?.get("fieldSrc"),L=je(a,r);if(!L)return console.warn("No config for LHS ".concat(r)),{state:e};var w=L.type;(w==="!group"||w==="!struct")&&(w=null);var D=b?.get("operator"),V=b?.get("operatorOptions"),P=b?.get("field"),_=L.type=="!group",B=_&&L.mode=="array",M=S!=_,q=L&&((u=L.operators)===null||u===void 0?void 0:u.indexOf(D))!==-1?D:null,K=C==="func"&&(P==null||(o=P.get)===null||o===void 0?void 0:o.call(P,"func"))===((l=r)===null||l===void 0||(s=l.get)===null||s===void 0?void 0:s.call(l,"func")),H=K&&!!q,U=null,te=C==="func"?Ss(a,w):oi(a,r);if(te&&te.length==1)U=te[0];else if(H)U=q;else if(te&&te.length>1){var J=qo(m),ae;try{for(J.s();!(ae=J.n()).done;){var ce=ae.value;if(ce=="keep"&&!M?U=q:ce=="default"?U=so(a,r,!1):ce=="first"&&(U=Co(a,r)),U)break}}catch(Re){J.e(Re)}finally{J.f()}}if(!_&&!L.operators)return console.warn("Type ".concat(L.type," is not supported")),{state:e};S&&!_&&(e=e.setIn(Ce(t,"type"),"rule"),e=e.deleteIn(Ce(t,"children1")),e=e.setIn(Ce(t,"properties"),new he.default.OrderedMap)),b||(e=e.setIn(Ce(t,"properties"),new he.default.OrderedMap));var oe=!h;if(_){e=e.setIn(Ce(t,"type"),"rule_group");var le=Vn(a,a,b,r,U,"field",oe,f,p),fe=le.canReuseValue,se=le.newValue,me=le.newValueSrc,Fe=le.newValueType,pe=le.operatorCardinality,Ae=En(a,L).merge({field:r,fieldSrc:"field",mode:L.mode});B&&(Ae=Ae.merge({operator:U,value:se,valueSrc:me,valueType:Fe})),e=e.setIn(Ce(t,"children1"),new he.default.OrderedMap),e=e.setIn(Ce(t,"properties"),Ae),L.initialEmptyWhere&&pe==1||(e=_n(e,t,"rule",cr(),rn(a,r),a)),e=Ht(e)}else e=e.updateIn(Ce(t,"properties"),function(Re){return Re.withMutations(function(Ve){var Ie=Vn(a,a,Ve,r,U,"field",oe,f,p),De=Ie.canReuseValue,Te=Ie.newValue,Ne=Ie.newValueSrc,Je=Ie.newValueType,ar=Ie.newValueError,Qe=Ie.newFieldError,Yr=Ie.fixedField,Tr=r,Pr=Yr!==r;Pr&&(Tr=Yr),h&&(Ve=Ve.set("fieldError",Qe),Ve=Ve.set("valueError",ar));var ir=De?V:Aa(a,U,Tr);return Ve=Ve.set("field",Tr).delete("fieldType").set("fieldSrc",C).set("operator",U).set("operatorOptions",ir).set("value",Te).set("valueSrc",Ne).set("valueType",Je),De||(Ve=Ve.delete("asyncListValues")),Ve})});return{state:e}},fh=function(e,t,r,a){var i=e.getIn(Ce(t));if(!i)return e;var u=a.settings.showErrorMessage,o=i.get("properties"),l=i.get("children1"),s=o.get("field"),c=o.get("fieldSrc"),d=je(a,s),f=d?.type=="!group",p=lr(a,r,s),g=p?Ur(p):null,v=!0;return e=e.updateIn(Ce(t,"properties"),function(m){return m.withMutations(function(h){var O=h.get("field"),b=h.get("operatorOptions"),S=h.get("value",new he.default.List),C=h.get("valueSrc",new he.default.List),L=h.get("operator"),w=Vn(a,a,h,O,r,"operator",v),D=w.canReuseValue,V=w.newValue,P=w.newValueSrc,_=w.newValueType,B=w.newValueError;u&&(h=h.set("valueError",B));var M=D?b:Aa(a,r,O);return D||(h=h.delete("asyncListValues")),h.set("operator",r).set("operatorOptions",M).set("value",V).set("valueSrc",P).set("valueType",_)})}),f&&g==0&&l.size==0&&(e=_n(e,t,"rule",cr(),rn(a,s),a)),e},ud=function(e,t,r,a,i,u,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},s=e.getIn(Ce(t));if(!s)return{state:e};var c=l.canDropArgs,d=l.isEndValue,f=u.settings,p=f.fieldSeparator,g=f.showErrorMessage,v=e.getIn(Ce(t,"properties","valueSrc",r+""))||null;v==="field"&&Array.isArray(a)&&(a=a.join(p));var m=e.getIn(Ce(t,"properties","field"))||null,h=e.getIn(Ce(t,"properties","operator"))||null,O=lr(u,h,m),b=h?Ur(O):null,S=i||Fs(a,v,u),C=!g,L=Xn(u,m,m,h,a,S,v,o,C,d,c),w=(0,Le.A)(L,2),D=w[0],V=w[1],P=V?.find(function(ae){return!ae.fixed&&!ae.ignore}),_=P?qt(P):null,B=D!==a;B&&(a=D),e=ld(e,t,u,b);var M=Array.from({length:b},function(ae,ce){return ce==r?a:e.getIn(Ce(t,"properties","value",ce+""))||null}),q=Array.from({length:b},function(ae,ce){return e.getIn(Ce(t,"properties","valueSrc",ce+""))||null}),K=bo(u,m,h,M,q),H=K?qt(K):null,U=!_&&!H,te=g?!0:U||B;if(te&&(e=e.deleteIn(Ce(t,"properties","asyncListValues")),typeof a>"u"?(e=e.setIn(Ce(t,"properties","value",r),void 0),e=e.setIn(Ce(t,"properties","valueType",r),null)):(o&&(e=e.setIn(Ce(t,"properties","asyncListValues"),o)),e=e.setIn(Ce(t,"properties","value",r),a),e=e.setIn(Ce(t,"properties","valueType",r),S))),g){var J=e.getIn(Ce(t,"properties","valueError"));J||(e=e.setIn(Ce(t,"properties","valueError"),new he.default.List(new Array(b)))),e=e.setIn(Ce(t,"properties","valueError",r),_),b>=2&&(e=e.setIn(Ce(t,"properties","valueError",b),H))}return{state:e}},ph=function(e,t,r,a,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=e.getIn(Ce(t));if(!o)return e;var l=i.settings.showErrorMessage,s=e.getIn(Ce(t,"properties","field"))||null,c=e.getIn(Ce(t,"properties","operator"))||null,d=lr(i,c,s),f=c?Ur(d):null;if(e=ld(e,t,i,f),e=e.setIn(Ce(t,"properties","value",r+""),void 0),e=e.setIn(Ce(t,"properties","valueType",r+""),null),e=e.deleteIn(Ce(t,"properties","asyncListValues")),l&&(e=e.setIn(Ce(t,"properties","valueError",r),null),d.validateValues&&(e=e.setIn(Ce(t,"properties","valueError",f),null))),typeof a>"u"?e=e.setIn(Ce(t,"properties","valueSrc",r+""),null):e=e.setIn(Ce(t,"properties","valueSrc",r+""),a),a){var p=e.getIn(Ce(t,"properties")),g=!0,v=Vn(i,i,p,s,c,"valueSrc",g),m=v.canReuseValue,h=v.newValue,O=v.newValueSrc,b=v.newValueType,S=v.newValueError;!m&&O.get(r)==a&&(e=e.setIn(Ce(t,"properties","value",r+""),h.get(r)),e=e.setIn(Ce(t,"properties","valueType",r+""),b.get(r)))}return e},vh=function(e,t,r,a){var i=e.getIn(Ce(t));return i?e.setIn(Ce(t,"properties","operatorOptions",r),a):e},gh=function(e,t){var r=t.settings.canLeaveEmptyGroup;return r||(e=ti(e)),e},ld=function(e,t,r,a){if(!a){var i=e.getIn(Ce(t,"properties","field"))||null,u=e.getIn(Ce(t,"properties","operator"))||null,o=lr(r,u,i);a=u?Ur(o):null}for(var l=0,s=["value","valueType","valueError","valueSrc"];l<s.length;l++){var c=s[l];e.getIn(Ce(t,"properties",c))||(e=e.setIn(Ce(t,"properties",c),new he.default.List(a?Array.from({length:a}):[])))}return e},mh=function n(e,t,r){r&&Array.isArray(r)&&(t.children1=new he.default.OrderedMap(r.reduce(function(a,i){var u,o=(u=i.id)!==null&&u!==void 0?u:cr(),l=on(on({},i),{},{properties:bl(e,i).merge((0,he.fromJS)(i.properties)||{}),id:o});return n(e,l,l.children1),on(on({},a),{},(0,ne.A)({},o,new he.default.Map(l)))},{})))},hh=function(e,t){var r=e.getIn(Ce(t,"properties","field"))||null;return r},sd={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},yh=function(e,t){if(!e||!e.type)return null;var r=["config","asyncListValues"],a=[Ko,rd,ed,td],i=gi()(Za()(e,r),Wi),u=e.path&&hh(t.tree,e.path)||e.field;if(u){var o;(o=u)!==null&&o!==void 0&&o.toJS&&(u=u.toJS()),i.affectedField=u}return(a.includes(e.type)||e.type.indexOf("@@redux")==0)&&(i=null),i};const Oh=function(n,e,t,r,a){var i=e,u=on({tree:i},sd);return function(){var o,l,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u,c=arguments.length>1?arguments[1]:void 0,d=(o=(l=a?.())!==null&&l!==void 0?l:c?.config)!==null&&o!==void 0?o:n,f={__lastAction:void 0},p={},g=yh(c,s);switch(c?.type){case Ko:{var v=t(d,c.tree);p.tree=v;break}case Wo:{p.tree=id(s.tree,c.path,"case_group",c.id,c.properties,d,c.children,c.meta);break}case kc:{p.tree=id(s.tree,c.path,"group",c.id,c.properties,d,c.children,c.meta);break}case Mc:{p.tree=ah(s.tree,c.path,d);break}case Uc:{p.tree=_n(s.tree,c.path,c.ruleType,c.id,c.properties,d,c.children);break}case Bc:{p.tree=ih(s.tree,c.path,d);break}case _c:{p.tree=lh(s.tree,c.path,c.conjunction);break}case Gc:{p.tree=oh(s.tree,c.path,c.not);break}case $c:{var m=od(s.tree,c.path,c.field,d,c.asyncListValues,c._meta),h=m.state;p.tree=h;break}case Wc:{p.tree=ch(s.tree,c.path,c.srcKey,d);break}case Qc:{p.tree=uh(s.tree,c.path,c.lock);break}case Kc:{p.tree=fh(s.tree,c.path,c.operator,d);break}case zc:{var O=ud(s.tree,c.path,c.delta,c.value,c.valueType,d,c.asyncListValues,c._meta),b=O.state;p.tree=b;break}case qc:{var S=dh(d,s.tree,c.path,c.delta,c.parentFuncs,c.argKey,c.value,c.valueType,c.asyncListValues,c._meta),C=S.state;p.tree=C;break}case Hc:{p.tree=ph(s.tree,c.path,c.delta,c.srcKey,d,c._meta);break}case Jc:{p.tree=vh(s.tree,c.path,c.name,c.value);break}case Yc:{p.tree=sh(s.tree,c.fromPath,c.toPath,c.placement,d);break}case rd:{p.dragStart=c.dragStart,p.dragging=c.dragging,p.mousePos=c.mousePos;break}case ed:{p.mousePos=c.mousePos,p.dragging=c.dragging;break}case td:{p.tree=gh(s.tree,d),p=on(on({},p),sd);break}default:break}return g&&(p.__lastAction=g),r&&p.tree&&s.tree&&r(s.tree),on(on(on({},s),f),p)}};var bh=function(e,t){return{type:Ko,tree:t,config:e}},Sh=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rule",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;return{type:Uc,ruleType:a,children:i,path:Br(t),id:cr(),properties:rn(e,u).merge((0,he.fromJS)(r)||{}),config:e}},Fh=function(e,t){return{type:Bc,path:Br(t),config:e}},Ch=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Wo,path:Br(t),children:a,id:cr(),properties:En(e).merge((0,he.fromJS)(r)||{}),config:e,meta:{isDefaultCase:!0}}},Th=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:Wo,path:Br(t),children:a,id:cr(),properties:En(e).merge((0,he.fromJS)(r)||{}),config:e}},Eh=function(e,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{type:kc,path:Br(t),children:a,id:cr(),properties:En(e).merge((0,he.fromJS)(r)||{}),config:e}},Ah=function(e,t){return{type:Mc,path:Br(t),config:e}},Lh=function(e,t,r,a){return{type:Yc,fromPath:Br(t),toPath:Br(r),placement:a,config:e}},wh=function(e,t,r){return{type:_c,path:Br(t),conjunction:r}},jh=function(e,t,r){return{type:Gc,path:Br(t),not:r}},Rh=function(e,t,r){return{type:Qc,path:Br(t),lock:r}},Ph=function(e,t,r,a,i){return{type:$c,path:Br(t),field:r,config:e,asyncListValues:a,_meta:i}},xh=function(e,t,r){return{type:Wc,path:Br(t),srcKey:r,config:e}},Ih=function(e,t,r){return{type:Kc,path:Br(t),operator:r,config:e}},Vh=function(e,t,r,a,i,u,o){return{type:zc,path:Br(t),delta:r,value:a,valueType:i,asyncListValues:u,config:e,_meta:o}},Dh=function(e,t,r,a,i){return{type:Hc,path:Br(t),delta:r,srcKey:a,config:e,_meta:i}},Nh=function(e,t,r,a,i,u,o,l,s){return{type:qc,path:Br(t),delta:r,parentFuncs:a,argKey:i,value:u,valueType:o,asyncListValues:l,config:e,_meta:s}},kh=function(e,t,r,a){return{type:Jc,path:Br(t),name:r,value:a,config:e}};function cd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Qo(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):cd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var qe=Qo(Qo(Qo({},Q),{},{Export:Y,Import:z,ConfigMixins:rh},Y),z),Mh=y(5556),R=y.n(Mh);const _h=Oh,Pa=F.createContext();var Gh=y(14644),Uh=y(19888),Bh=y(69242),$h=y(40961);function Wh(n){n()}let dd=Wh;const Kh=n=>dd=n,zh=()=>dd,fd=Symbol.for("react-redux-context"),pd=typeof globalThis<"u"?globalThis:{};function Hh(){var n;if(!F.createContext)return{};const e=(n=pd[fd])!=null?n:pd[fd]=new Map;let t=e.get(F.createContext);return t||(t=F.createContext(null),e.set(F.createContext,t)),t}const vd=Hh(),Jb=null;function Qb(n=ReactReduxContext){return function(){return useContext(n)}}const Yb=null;let gd=null;const qh=n=>{gd=n},Jh=(n,e)=>n===e;function Xb(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(r,a={}){const{equalityFn:i=Jh,stabilityCheck:u=void 0,noopCheck:o=void 0}=typeof a=="function"?{equalityFn:a}:a,{store:l,subscription:s,getServerState:c,stabilityCheck:d,noopCheck:f}=e(),p=useRef(!0),g=useCallback({[r.name](m){return r(m)}}[r.name],[r,d,u]),v=gd(s.addNestedSub,l.getState,c||l.getState,g,i);return useDebugValue(v),v}}const Zb=null;var nr=y(58168),md=y(98587),Qh=y(4146),hd=y.n(Qh),Yh=y(44363);const Xh=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function Zh(n,e,t,r,{areStatesEqual:a,areOwnPropsEqual:i,areStatePropsEqual:u}){let o=!1,l,s,c,d,f;function p(O,b){return l=O,s=b,c=n(l,s),d=e(r,s),f=t(c,d,s),o=!0,f}function g(){return c=n(l,s),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function v(){return n.dependsOnOwnProps&&(c=n(l,s)),e.dependsOnOwnProps&&(d=e(r,s)),f=t(c,d,s),f}function m(){const O=n(l,s),b=!u(O,c);return c=O,b&&(f=t(c,d,s)),f}function h(O,b){const S=!i(b,s),C=!a(O,l,b,s);return l=O,s=b,S&&C?g():S?v():C?m():f}return function(b,S){return o?h(b,S):p(b,S)}}function ey(n,e){let{initMapStateToProps:t,initMapDispatchToProps:r,initMergeProps:a}=e,i=(0,md.A)(e,Xh);const u=t(n,i),o=r(n,i),l=a(n,i);return Zh(u,o,l,n,i)}function ry(n,e){const t={};for(const r in n){const a=n[r];typeof a=="function"&&(t[r]=(...i)=>e(a(...i)))}return t}function Yo(n){return function(t){const r=n(t);function a(){return r}return a.dependsOnOwnProps=!1,a}}function yd(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function Od(n,e){return function(r,{displayName:a}){const i=function(o,l){return i.dependsOnOwnProps?i.mapToProps(o,l):i.mapToProps(o,void 0)};return i.dependsOnOwnProps=!0,i.mapToProps=function(o,l){i.mapToProps=n,i.dependsOnOwnProps=yd(n);let s=i(o,l);return typeof s=="function"&&(i.mapToProps=s,i.dependsOnOwnProps=yd(s),s=i(o,l)),s},i}}function Xo(n,e){return(t,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${e} argument when connecting component ${r.wrappedComponentName}.`)}}function ty(n){return n&&typeof n=="object"?Yo(e=>ry(n,e)):n?typeof n=="function"?Od(n,"mapDispatchToProps"):Xo(n,"mapDispatchToProps"):Yo(e=>({dispatch:e}))}function ny(n){return n?typeof n=="function"?Od(n,"mapStateToProps"):Xo(n,"mapStateToProps"):Yo(()=>({}))}function ay(n,e,t){return(0,nr.A)({},t,n,e)}function iy(n){return function(t,{displayName:r,areMergedPropsEqual:a}){let i=!1,u;return function(l,s,c){const d=n(l,s,c);return i?a(d,u)||(u=d):(i=!0,u=d),u}}}function oy(n){return n?typeof n=="function"?iy(n):Xo(n,"mergeProps"):()=>ay}function uy(){const n=zh();let e=null,t=null;return{clear(){e=null,t=null},notify(){n(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0,i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!a||e===null||(a=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}const bd={notify(){},get:()=>[]};function Sd(n,e){let t,r=bd,a=0,i=!1;function u(v){c();const m=r.subscribe(v);let h=!1;return()=>{h||(h=!0,m(),d())}}function o(){r.notify()}function l(){g.onStateChange&&g.onStateChange()}function s(){return i}function c(){a++,t||(t=e?e.addNestedSub(l):n.subscribe(l),r=uy())}function d(){a--,t&&a===0&&(t(),t=void 0,r.clear(),r=bd)}function f(){i||(i=!0,c())}function p(){i&&(i=!1,d())}const g={addNestedSub:u,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:s,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>r};return g}const mi=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?F.useLayoutEffect:F.useEffect;function Fd(n,e){return n===e?n!==0||e!==0||1/n===1/e:n!==n&&e!==e}function Zo(n,e){if(Fd(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(!Object.prototype.hasOwnProperty.call(e,t[a])||!Fd(n[t[a]],e[t[a]]))return!1;return!0}const ly=()=>{throw new Error("uSES not initialized!")},sy=["reactReduxForwardedRef"];let Cd=ly;const cy=n=>{Cd=n},dy=null,fy=[null,null],rS=n=>{try{return JSON.stringify(n)}catch{return String(n)}};function py(n,e,t){mi(()=>n(...e),t)}function vy(n,e,t,r,a,i){n.current=r,t.current=!1,a.current&&(a.current=null,i())}function gy(n,e,t,r,a,i,u,o,l,s,c){if(!n)return()=>{};let d=!1,f=null;const p=()=>{if(d||!o.current)return;const v=e.getState();let m,h;try{m=r(v,a.current)}catch(O){h=O,f=O}h||(f=null),m===i.current?u.current||s():(i.current=m,l.current=m,u.current=!0,c())};return t.onStateChange=p,t.trySubscribe(),p(),()=>{if(d=!0,t.tryUnsubscribe(),t.onStateChange=null,f)throw f}}const tS=()=>dy;function my(n,e){return n===e}let nS=!1;function hy(n,e,t,{pure:r,areStatesEqual:a=my,areOwnPropsEqual:i=Zo,areStatePropsEqual:u=Zo,areMergedPropsEqual:o=Zo,forwardRef:l=!1,context:s=vd}={}){const c=s,d=ny(n),f=ty(e),p=oy(t),g=!!n;return m=>{const h=m.displayName||m.name||"Component",O=`Connect(${h})`,b={shouldHandleStateChanges:g,displayName:O,wrappedComponentName:h,WrappedComponent:m,initMapStateToProps:d,initMapDispatchToProps:f,initMergeProps:p,areStatesEqual:a,areStatePropsEqual:u,areOwnPropsEqual:i,areMergedPropsEqual:o};function S(w){const[D,V,P]=F.useMemo(()=>{const{reactReduxForwardedRef:De}=w,Te=(0,md.A)(w,sy);return[w.context,De,Te]},[w]),_=F.useMemo(()=>D&&D.Consumer&&(0,Yh.isContextConsumer)(F.createElement(D.Consumer,null))?D:c,[D,c]),B=F.useContext(_),M=!!w.store&&!!w.store.getState&&!!w.store.dispatch,q=!!B&&!!B.store,K=M?w.store:B.store,H=q?B.getServerState:K.getState,U=F.useMemo(()=>ey(K.dispatch,b),[K]),[te,J]=F.useMemo(()=>{if(!g)return fy;const De=Sd(K,M?void 0:B.subscription),Te=De.notifyNestedSubs.bind(De);return[De,Te]},[K,M,B]),ae=F.useMemo(()=>M?B:(0,nr.A)({},B,{subscription:te}),[M,B,te]),ce=F.useRef(),oe=F.useRef(P),le=F.useRef(),fe=F.useRef(!1),se=F.useRef(!1),me=F.useRef(!1),Fe=F.useRef();mi(()=>(me.current=!0,()=>{me.current=!1}),[]);const pe=F.useMemo(()=>()=>le.current&&P===oe.current?le.current:U(K.getState(),P),[K,P]),Ae=F.useMemo(()=>Te=>te?gy(g,K,te,U,oe,ce,fe,me,le,J,Te):()=>{},[te]);py(vy,[oe,ce,fe,P,le,J]);let Re;try{Re=Cd(Ae,pe,H?()=>U(H(),P):pe)}catch(De){throw Fe.current&&(De.message+=`
The error may be correlated with this previous error:
${Fe.current.stack}

`),De}mi(()=>{Fe.current=void 0,le.current=void 0,ce.current=Re});const Ve=F.useMemo(()=>F.createElement(m,(0,nr.A)({},Re,{ref:V})),[V,m,Re]);return F.useMemo(()=>g?F.createElement(_.Provider,{value:ae},Ve):Ve,[_,Ve,ae])}const L=F.memo(S);if(L.WrappedComponent=m,L.displayName=S.displayName=O,l){const D=F.forwardRef(function(P,_){return F.createElement(L,(0,nr.A)({},P,{reactReduxForwardedRef:_}))});return D.displayName=O,D.WrappedComponent=m,hd()(D,m)}return hd()(L,m)}}const hi=hy;function yy({store:n,context:e,children:t,serverState:r,stabilityCheck:a="once",noopCheck:i="once"}){const u=F.useMemo(()=>{const s=Sd(n);return{store:n,subscription:s,getServerState:r?()=>r:void 0,stabilityCheck:a,noopCheck:i}},[n,r,a,i]),o=F.useMemo(()=>n.getState(),[n]);mi(()=>{const{subscription:s}=u;return s.onStateChange=s.notifyNestedSubs,s.trySubscribe(),o!==n.getState()&&s.notifyNestedSubs(),()=>{s.tryUnsubscribe(),s.onStateChange=void 0}},[u,o]);const l=e||vd;return F.createElement(l.Provider,{value:u},t)}const Oy=yy;function aS(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultReduxContext:createReduxContextHook(n);return function(){const{store:r}=e();return r}}const iS=null;function oS(n=ReactReduxContext){const e=n===ReactReduxContext?useDefaultStore:createStoreHook(n);return function(){return e().dispatch}}const uS=null;qh(Bh.useSyncExternalStoreWithSelector),cy(Uh.useSyncExternalStore),Kh($h.unstable_batchedUpdates);var lS="ADD_GROUP",sS="ADD_CASE_GROUP",cS="REMOVE_GROUP",dS="SET_CONJUNCTION",fS="SET_NOT",pS="ADD_RULE",vS="REMOVE_RULE",gS="SET_FIELD",mS="SET_FIELD_SRC",hS="SET_OPERATOR",yS="SET_VALUE",OS="SET_VALUE_SRC",bS="SET_OPERATOR_OPTION",SS="SET_LOCK",FS="SET_TREE",CS="MOVE_ITEM",yi="after",Oi="before",Gn="append",na="prepend",by="SET_DRAG_PROGRESS",Sy="SET_DRAG_START",Fy="SET_DRAG_END",Cy=function(e,t){return{type:by,mousePos:e,dragging:t}},Ty=function(e,t,r){return{type:Sy,dragStart:e,dragging:t,mousePos:r}},Ey=function(){return{type:Fy}},Td=ge,Ay=X,Ly=Ee,wy=function(e){var t;return(t=e?.cardinality)!==null&&t!==void 0?t:1},bi=function(e,t,r){if(!t||!e||e.length<=t)return e;var a=e.substr(0,t-1);return(r?a.substr(0,a.lastIndexOf(" ")):a)+"..."},Un=function(e,t){return e===t?!0:e?.equals(t)},Bn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e===t?!0:Array.isArray(e)?jy(e,t,r):e&&typeof e.equals=="function"?e.equals(t):(0,Cr.A)(e)==="object"?Ry(e,t,r):e===t};function jy(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=n.length;if(e.length!==r)return!1;for(var a=0;a<r;a++){var i=t?Bn(n[a],e[a],t):n[a]===e[a];if(!i)return!1}return!0}function Ry(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n===e)return!0;if(!n||!e)return!1;var r=Object.keys(n),a=Object.keys(e),i=r.length;if(a.length!==i)return!1;for(var u=0;u<i;u++){var o=r[u],l=t?Bn(n[o],e[o],t):n[o]===e[o];if(!l)return!1}return!0}var Py=function(){return typeof process<"u"&&process.env&&!1},xy=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=e??Py();return t?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},Iy=xy(),Ed=qe.Validation.validateAndFixTree,Vy=function(){var e,t,r;return function(a,i){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return i?(a.__configId===r&&(Un(i,e)||Un(i,t))||(r=a.__configId,e=i,o===!1?t=Ed(i,null,a,u||a,!1,!1,!1):t=Ed(i,null,a,u||a)),t):null}},Dy=function(e){if(e._reactRootContainer)return"root";if(Object.getOwnPropertyNames(e).filter(function(t){return t.startsWith("__reactContainer")}).length>0)return"container"},Ny=function n(e){if(e){var t=Dy(e);return t!==void 0?t:n(e.parentNode)}},Ad=function(e){return Ny(e)==="root"},Si=function(e,t){return function(r,a){var i=e.props,u=e.state,o=r!=i||a!=u;if(o&&u==a&&i!=r){var l=[];for(var s in r){var c=r[s]!=i[s];c&&(t[s]=="ignore"?c=!1:t[s]=="shallow_deep"?c=!Bn(r[s],i[s],!0):t[s]=="shallow"?c=!Bn(r[s],i[s]):typeof t[s]=="function"&&(c=t[s](r[s],i[s],r,i))),c&&l.push(s)}l.length||(o=!1)}return o}},aa=function(e){return function(t,r){return!Bn(e.props,t)||!Bn(e.state,r)}},ky=function(){var e=F.version.split(".").map(parseInt.bind(null,10));return e[0]==16&&e[1]<3||e[0]<16},ht=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=aa(e)),ky())e.componentWillReceiveProps=function(a){e.onPropsChanged(a)};else{var t=e.shouldComponentUpdate,r=function(i,u){var o=!Bn(e.props,i);o&&e.onPropsChanged(i);var l=t.call(e,i,u);return l};e.shouldComponentUpdate=r.bind(e)}},Ld=function(e,t,r){return gi()(e,function(a){return function(){for(var i=arguments.length,u=new Array(i),o=0;o<i;o++)u[o]=arguments[o];return r(a.apply(void 0,[t].concat(u)))}})};function wd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function eu(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function My(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,jd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function jd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jd=function(){return!!n})()}var Rd=function(n){function e(t){var r;(0,mr.A)(this,e),r=My(this,e,[t]),r.shouldComponentUpdate=Si(r,{tree:function(u){return!(u===r.oldValidatedTree&&r.oldValidatedTree===r.validatedTree)}}),ht(r),r._updateActions(t),r.validatedTree=t.getMemoizedTree(t.config,t.tree,void 0,t.sanitizeTree),r.oldValidatedTree=r.validatedTree;var a=t.getBasicConfig(t.config);return t.onInit&&t.onInit(r.validatedTree,a,void 0,r.actions),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"_updateActions",value:function(r){var a=r.config,i=r.dispatch;this.actions=Ld(eu(eu(eu({},Td),Ay),Ly),a,i)}},{key:"onPropsChanged",value:function(r){var a=r.onChange,i=this.props.config,u=r.tree,o=this.props.tree,l=r.config;this.oldValidatedTree=this.validatedTree,this.validatedTree=u,i!==l&&(this._updateActions(r),this.validatedTree=r.getMemoizedTree(l,u,i));var s=!Un(this.validatedTree,this.oldValidatedTree);if(s){var c=r.getBasicConfig(l);a&&a(this.validatedTree,c,r.__lastAction,this.actions)}}},{key:"render",value:function(){var r=this.props,a=r.config,i=r.renderBuilder,u=r.dispatch,o={tree:this.validatedTree,actions:this.actions,config:a,dispatch:u};return i(o)}}])}(F.Component);Rd.propTypes={config:R().object.isRequired,onChange:R().func,onInit:R().func,renderBuilder:R().func,tree:R().any};var Pd=hi(function(n){return{tree:n.tree,__lastAction:n.__lastAction}},null,null,{context:Pa})(Rd);Pd.displayName="ConnectedQuery";const _y=Pd;function Gy(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,xd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function xd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xd=function(){return!!n})()}var Id=qe.DefaultUtils.defaultRoot,Uy=qe.ConfigUtils.createConfigMemo,Vd=function(n){function e(t,r){var a,i,u;(0,mr.A)(this,e),u=Gy(this,e,[t,r]),u.setLastTree=function(S){u.prevTree&&(u.prevprevTree=u.prevTree),u.prevTree=S},u.getConfig=function(){return u.config},u.shouldComponentUpdate=Si(u,{value:function(C,L){return!1}}),ht(u);var o=Uy({reactIndex:(a=(i=u._reactInternals)===null||i===void 0?void 0:i.index)!==null&&a!==void 0?a:-1,maxSize:2,canCompile:!0}),l=o.getExtendedConfig,s=o.getBasicConfig,c=o.clearConfigMemo;u.getMemoizedConfig=l,u.getBasicConfig=s,u.clearConfigMemo=c,u.getMemoizedTree=Vy();var d=u.getMemoizedConfig(t),f=d.settings.shouldCreateEmptyGroup,p=!f,g=Id(d,p),v=!!t.value,m=t.value||g,h=u.getMemoizedTree(d,m,void 0,v),O=_h(d,h,u.getMemoizedTree,u.setLastTree,u.getConfig),b=(0,Gh.createStore)(O);return u.config=d,u.state={store:b},u.QueryWrapper=function(S){return d.settings.renderProvider(S,d.ctx)},u}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(r){var a=this.props,i=this.config,u=this.getMemoizedConfig(r),o=i!==u,l=this.state.store.getState().tree,s=!Un(r.value,this.props.value)&&!Un(r.value,l),c=s?r.value||Id(r):l,d=s&&!Un(r.value,this.prevTree)&&!Un(r.value,this.prevprevTree);if(this.sanitizeTree=d||o,o&&(a.settings.renderProvider!==r.settings.renderProvider&&(this.QueryWrapper=function(p){return u.settings.renderProvider(p,u.ctx)}),this.config=u),s||o){var f=this.getMemoizedTree(u,c,i,this.sanitizeTree);this.state.store.dispatch(Td.setTree(u,f))}}},{key:"render",value:function(){var r=this.props,a=r.renderBuilder,i=r.get_children,u=r.onChange,o=r.onInit,l=this.state.store,s=this.config,c=this.QueryWrapper;return F.createElement(c,{config:s},F.createElement(Oy,{store:l,context:Pa},F.createElement(_y,{config:s,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:u,onInit:o,renderBuilder:a||i})))}}])}(F.Component);Vd.propTypes={conjunctions:R().object.isRequired,fields:R().object.isRequired,types:R().object.isRequired,operators:R().object.isRequired,widgets:R().object.isRequired,settings:R().object.isRequired,ctx:R().object.isRequired,onChange:R().func,onInit:R().func,renderBuilder:R().func,value:R().any};var By=y(46942),_t=y.n(By);function $y(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Dd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Dd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dd=function(){return!!n})()}var Wy=qe.ConfigUtils.getFieldConfig,Ky=function(e){var t;return t=function(r){function a(i){var u;return(0,mr.A)(this,a),u=$y(this,a,[i]),u.dummyFn=function(){},u.removeSelf=function(){u.props.actions.removeRule(u.props.path)},u.setLock=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;u.props.actions.setLock(u.props.path,o)},u.setField=function(o,l,s){u.props.actions.setField(u.props.path,o,l,s)},u.setFieldSrc=function(o){u.props.actions.setFieldSrc(u.props.path,o)},u.setOperator=function(o){u.props.actions.setOperator(u.props.path,o)},u.setOperatorOption=function(o,l){u.props.actions.setOperatorOption(u.props.path,o,l)},u.setValue=function(o,l,s,c,d){u.props.actions.setValue(u.props.path,o,l,s,c,d)},u.setValueSrc=function(o,l,s){u.props.actions.setValueSrc(u.props.path,o,l,s)},u.setFuncValue=function(o,l,s,c,d,f,p){u.props.actions.setFuncValue(u.props.path,o,l,s,c,d,f,p)},u.pureShouldComponentUpdate=aa(u),u.dummyFn.isDummyFn=!0,u}return(0,yr.A)(a,r),(0,hr.A)(a,[{key:"shouldComponentUpdate",value:function(u,o){var l=this.props,s=this.state,c=this.pureShouldComponentUpdate(u,o);if(c&&s==o&&l!=u){var d=u.dragging.id||l.dragging.id,f=d==u.id,p=[];for(var g in u){var v=u[g]!=l[g];g=="dragging"&&!f&&(v=!1),v&&p.push(g)}p.length||(c=!1)}return c}},{key:"render",value:function(){var u=this.props.dragging.id==this.props.id,o=Wy(this.props.config,this.props.field),l=this.props.fieldType||o?.type||null,s=this.props.config.settings.showErrorMessage,c=o&&o.type=="!struct",d=!u&&this.props.isDraggingTempo,f=this.props,p=f.valueError,g=f.fieldError,v=[g].concat((0,Se.A)(p?.toArray()||[])).filter(function(h){return!!h}).shift()||null,m=v!=null&&s;return F.createElement("div",{className:_t()("group-or-rule-container","rule-container",m?"rule-with-error":null),"data-id":this.props.id},[u?F.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,F.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:u,isDraggingTempo:d,onDragStart:this.props.onDragStart,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,setField:d?this.dummyFn:this.setField,setFieldSrc:d?this.dummyFn:this.setFieldSrc,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setOperatorOption:d?this.dummyFn:this.setOperatorOption,setValue:d?this.dummyFn:this.setValue,setValueSrc:d?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(F.Component),t.propTypes={id:R().string.isRequired,groupId:R().string,config:R().object.isRequired,path:R().any.isRequired,operator:R().string,field:R().any,fieldSrc:R().string,fieldType:R().string,actions:R().object.isRequired,onDragStart:R().func,value:R().any,valueSrc:R().any,asyncListValues:R().array,valueError:R().any,fieldError:R().string,operatorOptions:R().object,reordableNodesCnt:R().number,parentField:R().string,isLocked:R().bool,isTrueLocked:R().bool,dragging:R().object,isDraggingTempo:R().bool},t};const zy=function(n){var e=hi(function(t){return{dragging:t.dragging}},null,null,{context:Pa})(Ky(n));return e.displayName="ConnectedRuleContainer",e};function Hy(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Nd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Nd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nd=function(){return!!n})()}var kd=qe.clone,qy=qe.TreeUtils.getFlatTree,ru=!1,Jy=function(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return t=function(a){function i(u){var o;return(0,mr.A)(this,i),o=Hy(this,i,[u]),o._getEventTarget=function(l,s){return l&&l.__mocked_window||document.body||window},o.onDragStart=function(l,s,c){var d=s.closest(".query-builder");o._isUsingLegacyReactDomRender===void 0&&(o._isUsingLegacyReactDomRender=Ad(d)),document.body.classList.add("qb-dragging"),d.classList.add("qb-dragging");var f=d.closest(".query-builder-container")||d;f=o._getScrollParent(f)||document.body;var p=f.scrollTop,g=o._getDraggableNodeEl(d),v=o._getPlaceholderNodeEl(d),m=d.querySelectorAll(".group--children"),h=m.length?m[0]:null,O;h&&(O=window.getComputedStyle(h,null).getPropertyValue("padding-left"),O=parseInt(O));var b={id:l,x:s.offsetLeft,y:s.offsetTop,w:s.offsetWidth,h:s.offsetHeight,itemInfo:o.tree.items[l],paddingLeft:O},S={id:l,x:s.offsetLeft,y:s.offsetTop,scrollTop:p,clientX:c.clientX,clientY:c.clientY,itemInfo:kd(o.tree.items[l]),treeEl:d,treeElContainer:f},C={clientX:c.clientX,clientY:c.clientY},L=o._getEventTarget(c,S);o.eventTarget=L,L.addEventListener("mousemove",o.onDrag),L.addEventListener("mouseup",o.onDragEnd),o.props.setDragStart(S,b,C)},o.onDrag=function(l){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=Object.assign({},o.props.dragging),d=o.props.dragStart,f=c.paddingLeft,p=d.treeElContainer,g=p.scrollTop;if(c.itemInfo=o.tree.items[c.id],!!c.itemInfo){var v={clientX:l.clientX,clientY:l.clientY},m={clientX:d.clientX,clientY:d.clientY};if(l.__mock_dom){var h=d.treeEl,O=o._getDraggableNodeEl(h),b=o._getPlaceholderNodeEl(h);l.__mock_dom({treeEl:h,dragEl:O,plhEl:b})}if(!d.plX){var S=d.treeEl,C=o._getPlaceholderNodeEl(S);C&&(d.plX=C.getBoundingClientRect().left+window.scrollX,d.plY=C.getBoundingClientRect().top+window.scrollY)}var L=d.x,w=d.y,D=d.clientX,V=d.clientY,P=d.scrollTop,_={x:L+(l.clientX-D),y:w+(l.clientY-V)+(g-P)};c.x=_.x,c.y=_.y,c.paddingLeft=f,c.mousePos=v,c.startMousePos=m,o.props.setDragProgress(v,c);var B=s?o.handleDrag(c,l,r):!1;B||l.preventDefault&&l.preventDefault()}},o.onDragEnd=function(){var l=o.props.dragStart.treeEl;o.props.setDragEnd(),l.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),o._cacheEls={};var s=o.eventTarget||o._getEventTarget();s.removeEventListener("mousemove",o.onDrag),s.removeEventListener("mouseup",o.onDragEnd)},o.pureShouldComponentUpdate=aa(o),ht(o),o.onPropsChanged(u),o}return(0,yr.A)(i,a),(0,hr.A)(i,[{key:"onPropsChanged",value:function(o){this.tree=qy(o.tree)}},{key:"shouldComponentUpdate",value:function(o,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(o,l);if(d&&c==l&&s!=o){var f=[];for(var p in o){var g=o[p]!=s[p];g&&p!="dragging"&&p!="mousePos"&&f.push(p)}f.length||(d=!1)}return d}},{key:"componentDidUpdate",value:function(o,l){var s=this.props.dragging,c=this.props.dragStart;if(ru=!1,c&&c.id&&(s.itemInfo=this.tree.items[s.id],s.itemInfo&&(s.itemInfo.index!=c.itemInfo.index||s.itemInfo.parent!=c.itemInfo.parent))){var d=c.treeEl,f=c.treeElContainer,p=this._getPlaceholderNodeEl(d,!0);if(p){var g=p.getBoundingClientRect().left+window.scrollX,v=p.getBoundingClientRect().top+window.scrollY,m=c.plX,h=c.plY,O=f.scrollTop;c.plX=g,c.plY=v,c.itemInfo=kd(s.itemInfo),c.y=p.offsetTop,c.x=p.offsetLeft,c.clientY+=v-h,c.clientX+=g-m,f!=document.body&&(c.scrollTop=O),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(o,l){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(l==null)return null;this._cacheEls||(this._cacheEls={});var c=this._cacheEls[l];return c&&document.contains(c)&&!s||(c=o.querySelector('.group-or-rule-container[data-id="'+l+'"]'),this._cacheEls[l]=c),c}},{key:"_getDraggableNodeEl",value:function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.draggable;if(s&&document.contains(s)&&!l)return s;var c=o.getElementsByClassName("qb-draggable");return s=c.length?c[0]:null,this._cacheEls.draggable=s,s}},{key:"_getPlaceholderNodeEl",value:function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._cacheEls||(this._cacheEls={});var s=this._cacheEls.placeholder;if(s&&document.contains(s)&&!l)return s;var c=o.getElementsByClassName("qb-placeholder");return s=c.length?c[0]:null,this._cacheEls.placeholder=s,s}},{key:"_isScrollable",value:function(o){var l=window.getComputedStyle(o)["overflow-y"];return(l==="scroll"||l==="auto")&&o.scrollHeight>o.offsetHeight}},{key:"_getScrollParent",value:function(o){return o==null?null:o===document.body||this._isScrollable(o)?o:this._getScrollParent(o.parentNode)}},{key:"handleDrag",value:function(o,l,s){var c=this,d=!0,f=o.itemInfo,p=o.paddingLeft,g=null,v=this.props.dragStart.treeEl,m=o.id,h=this._getDraggableNodeEl(v),O=this._getPlaceholderNodeEl(v),b,S,C,L;if(h&&O){if(b=h.getBoundingClientRect(),S=O.getBoundingClientRect(),!S.width)return;var w={hrz:0,vrt:0};b.top<S.top?w.vrt=-1:b.bottom>S.bottom&&(w.vrt=1),b.left>S.left?w.hrz=1:b.left<S.left&&(w.hrz=-1),L=v.getBoundingClientRect();var D={x:L.left+(L.right-L.left)/2,y:w.vrt>=0?b.bottom:b.top},V;if(l.__mocked_hov_container)V=l.__mocked_hov_container;else{var P=document.elementFromPoint(D.x,D.y-1);if(V=P?P.closest(".group-or-rule-container"):null,!V&&P&&P.classList.contains("query-builder-container")){var _,B=P==null||(_=P.firstChild)===null||_===void 0?void 0:_.firstChild;B&&B.classList.contains("group-or-rule-container")&&(V=B)}}if(!V)Iy.log("out of tree bounds!");else{var M=V.classList.contains("group-container"),q=V.getAttribute("data-id"),K=V,H=!1,U=!1;if(K){C=K.getBoundingClientRect();var te=C.bottom-C.top,J=this.tree.items[q];if(!J)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var ae=null,ce=null,oe=null,le=null;if(w.vrt==0)oe=f,ce=O,ce&&(ae=ce.getBoundingClientRect());else if(M){if(w.vrt>0){var fe=V.getElementsByClassName("group--header"),se=fe.length?fe[0]:null;if(se){var me=se.getBoundingClientRect(),Fe=me.bottom-me.top,pe=b.bottom-me.top>Fe*3/4;pe&&J.top>o.itemInfo.top&&(oe=J,ae=me,ce=se,U=!0)}}else if(w.vrt<0&&J.lev>=f.lev){var Ae=C.bottom-b.top>=2;Ae&&J.top<o.itemInfo.top&&(oe=J,ae=C,ce=K,H=!0)}if(!U&&!H||d){var Re=w.vrt<0?C.bottom-b.top>te-5:b.bottom-C.top>te-5;Re&&(!U&&!H&&(oe=J,ae=C,ce=K),d&&(le=J))}}else{var Ve=w.vrt<0?C.bottom-b.top>te/2:b.bottom-C.top>te/2;Ve&&(oe=J,ae=C,ce=K)}var Ie=oe&&oe.id==m;if(ae){var De=b.left-L.left,Te=ae.left-L.left,Ne=Te/p,Je=Math.max(0,Math.round(De/p)),ar=[],Qe=[];if(!Ie){if(M&&(H?ar.push([Gn,oe,oe.lev+1]):U&&ar.push([na,oe,oe.lev+1]),d&&le)){var Yr=le.lev==0,Tr=le.type=="case_group"&&f.type!="case_group",Pr=le.prev&&this.tree.items[le.prev].caseId,ir=le.next&&this.tree.items[le.next].caseId;f.caseId==Pr&&(Pr=null),f.caseId==ir&&(ir=null);var at=Pr&&this.tree.items[Pr],bt=ir&&this.tree.items[ir];w.vrt>0?Yr?Qe.push([Gn,le,le.lev+1]):Tr&&bt?Qe.push([na,bt,bt.lev+1]):Qe.push([yi,le,le.lev]):w.vrt<0&&(Yr?Qe.push([na,le,le.lev+1]):Tr&&at?Qe.push([Gn,at,at.lev+1]):Qe.push([Oi,le,le.lev]))}!H&&!U&&(w.vrt<0?ar.push([Oi,oe,oe.lev]):w.vrt>0&&ar.push([yi,oe,oe.lev]))}var it=function(Xr){var Jr=Xr[1],_r=f.caseId?c.tree.items[f.caseId]:null,ft=Jr.caseId?c.tree.items[Jr.caseId]:null;return[].concat((0,Se.A)(Xr),[_r,ft])};ar=ar.map(it),Qe=Qe.map(it),ar=ar.filter(function(ur){var Xr=ur[0],Jr=ur[1];if((Xr==Oi||Xr==yi)&&Jr.parent==null||Jr.collapsed&&(Xr==Gn||Xr==na))return!1;var _r=Jr.id==f.id;if(!_r){for(var ft=Jr;ft.parent;)if(ft=c.tree.items[ft.parent],ft.id==f.id){_r=!0;break}}return!_r}).map(function(ur){var Xr=ur[0],Jr=ur[1],_r=ur[2],ft=ur[3],wn=ur[4],pt=null;return Xr==Gn||Xr==na?pt=Jr:pt=c.tree.items[Jr.parent],pt&&pt.parent==null&&(pt=null),ur[5]=pt,ur});var St=null,or=ar.filter(function(ur){return c.canMove(f,ur[1],ur[0],ur[3],ur[4],ur[5],s)});d&&or.length==0&&Qe.length>0&&(or=Qe.filter(function(ur){return c.canMove(f,ur[1],ur[0],ur[3],ur[4],ur[5],s)}));var Lt=or.map(function(ur){return ur[2]}),Vt=f.lev,zr=Lt.concat(Vt),ot=null;zr.indexOf(Je)!=-1?ot=Je:Je>Math.max.apply(Math,(0,Se.A)(zr))?ot=Math.max.apply(Math,(0,Se.A)(zr)):Je<Math.min.apply(Math,(0,Se.A)(zr))&&(ot=Math.min.apply(Math,(0,Se.A)(zr))),St=or.find(function(ur){return ur[2]==ot}),!Ie&&!St&&or.length&&(St=or[0]),g=St}}}}return g?(this.move(f,g[1],g[0],g[3]),!0):!1}},{key:"canMove",value:function(o,l,s,c,d,f,p){if(!o||!l||o.id===l.id)return!1;var g=this.props.config.settings,v=g.canRegroup,m=g.canRegroupCases,h=g.maxNesting,O=g.maxNumberOfRules,b=g.canLeaveEmptyCase,S=f?f.lev+1:l.lev,C=S+(o.depth||0),L=s==Oi||s==yi,w=s==na||s==Gn,D=L&&l.lev==1||w&&l.lev==0,V=o.parent!=l.parent,P=w||V,_=o.type=="case_group"&&!D||o.parentType=="rule_group"||l.type=="rule_group"||l.parentType=="rule_group"||o.type!="case_group"&&l.type=="case_group"&&L||o.type!="case_group"&&l.type=="switch_group"||!m&&o.caseId!=l.caseId,B=l.isLocked||o.isLocked||f&&f.isLocked;if(h&&C>h||P&&(!v||_||B))return!1;if(o.type!="case_group"&&o.caseId!=l.caseId){var M=c?c._height==2:!1,q=d?d.atomicRulesCountInCase+1:0;if(O&&q>O||M&&!b)return!1}if(o.type=="case_group"&&(o.isDefaultCase||l.isDefaultCase||l.type=="switch_group"&&s==Gn))return!1;var K=!0;return p&&(K=p(o.node.toJS(),l.node.toJS(),s,f?f.node.toJS():null)),K}},{key:"move",value:function(o,l,s,c){this._isUsingLegacyReactDomRender||(ru=!0),this.props.actions.moveItem(o.path,l.path,s)}},{key:"render",value:function(){return F.createElement(e,(0,nr.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(F.Component),t.propTypes={tree:R().any.isRequired,actions:R().object.isRequired},t};const Qy=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,t=hi(function(r){return{dragging:r.dragging,dragStart:r.dragStart,mousePos:r.mousePos}},{setDragStart:Ty,setDragProgress:Cy,setDragEnd:Ey},null,{context:Pa})(Jy(n,e));return t.displayName="ConnectedSortableContainer",t};var Yy=["isDraggingTempo","isDraggingMe","dragging"];function Xy(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Md()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Md(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Md=function(){return!!n})()}const ia=function(n){return function(e){var t;return t=function(r){function a(i){var u;return(0,mr.A)(this,a),u=Xy(this,a,[i]),u.handleDraggerMouseDown=function(o){var l=u.props.id,s=u.wrapper.current;u.props.onDragStart&&u.props.onDragStart(l,s,o)},u.wrapper=F.createRef(),u}return(0,yr.A)(a,r),(0,hr.A)(a,[{key:"render",value:function(){var u=this.props,o=u.isDraggingTempo,l=u.isDraggingMe,s=u.dragging,c=(0,Mn.A)(u,Yy),d=c.isTrueLocked,f={};l&&o&&(ru||(f={top:s.y,left:s.x,width:s.w}));var p=_t()(n,"group-or-rule",l&&o?"qb-draggable":null,l&&!o?"qb-placeholder":null,d?"locked":null);return F.createElement("div",{className:p,style:f,ref:this.wrapper,"data-id":this.props.id},F.createElement(e,(0,nr.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:l,isDraggingTempo:o},c)))}}])}(F.PureComponent),t.propTypes={isDraggingTempo:R().bool,isDraggingMe:R().bool,onDragStart:R().func,dragging:R().object,isLocked:R().bool,isTrueLocked:R().bool},t}};var Zy=y(95950),oa=y.n(Zy),e0=y(71086),r0=y.n(e0);function _d(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function t0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?_d(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):_d(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function n0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Gd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Gd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gd=function(){return!!n})()}var Ud=qe.ConfigUtils,a0=Ud.getFieldConfig,i0=Ud.getOperatorConfig,Bd=function(n){function e(t){var r;return(0,mr.A)(this,e),r=n0(this,e,[t]),r.shouldComponentUpdate=Si(r,{selectedField:function(i,u){return!1}}),ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"],u=!this.meta||i.map(function(o){return r[o]!==a[o]}).filter(function(o){return o}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,i=r.config,u=r.selectedField,o=r.selectedFieldType,l=r.selectedOperator,s=a0(i,u),c=(0,Se.A)(s?.operators||((a=i.types[o])===null||a===void 0?void 0:a.operators)||[]);!u&&!c.includes(l)&&c.push(l);var d=gi()(r0()(i.operators,function(S,C){return c?.indexOf(C)!==-1}),function(S,C){return i0(i,C,u)}),f=this.buildOptions(i,d,c),p=d[l]||{},g=this.props.config.settings.operatorPlaceholder,v=l,m=v?[v]:null,h=m,O=p.label,b=p.label2||p.tooltip;return{placeholder:g,items:f,selectedKey:v,selectedKeys:m,selectedPath:h,selectedLabel:O,selectedAltLabel:b,selectedOpts:p,fieldConfig:s}}},{key:"buildOptions",value:function(r,a,i){return!a||!i?null:oa()(a).sort(function(u,o){return i.indexOf(u)-i.indexOf(o)}).map(function(u){var o=a[u],l=o.label,s=o.label2,c=o.tooltip;return{key:u,path:u,label:l,altLabel:s,tooltip:c}})}},{key:"render",value:function(){var r=this.props,a=r.config,i=r.customProps,u=r.setOperator,o=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderOperator,d=t0({id:l,groupId:s,config:a,customProps:i,readonly:o,setField:u},this.meta);return d.items?c(d,a.ctx):null}}])}(F.Component);Bd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,selectedField:R().any,selectedFieldId:R().string,selectedFieldType:R().string,selectedFieldSrc:R().string,selectedOperator:R().string,readonly:R().bool,setOperator:R().func.isRequired};var o0=["children"],Wr=function(e){var t=e.children,r=(0,Mn.A)(e,o0);return F.createElement("div",r,t)},yt=function(){},$d=function(){return F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},F.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),F.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},ua=function(e){return function(t){var r=t.config.settings.useConfirm,a=r?r.call(t.config.ctx,t.config.ctx):null;return F.createElement(e,(0,nr.A)({},t,{confirmFn:a}))}},Wd=function(e){var t=e.id,r=e.isLHS,a=e.delta,i=e.parentFuncs;return[t,r?"L":"R",r?-1:a||0,(i||[]).map(function(u){var o=(0,Le.A)(u,2),l=o[0],s=o[1];return"".concat(l,"(").concat(s,")")}).join("/")].join(":")},Ot=function(e,t){var r;return typeof t=="function"?(r=function(i){return t?.(i,e.ctx)},r.displayName=t.name):r=t,r};function u0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Kd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Kd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kd=function(){return!!n})()}var zd=function(n){function e(){return(0,mr.A)(this,e),u0(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedFieldSrc,o=r.selectedFieldType,l=r.selectedOperator,s=r.setOperator,c=r.selectedFieldId,d=r.showOperator,f=r.showOperatorLabel,p=r.selectedFieldWidgetConfig,g=r.readonly,v=r.id,m=r.groupId,h=d&&F.createElement(Wr,{key:"operators-for-"+c,className:"rule--operator"},a.settings.showLabels&&F.createElement("label",{className:"rule--label"},a.settings.operatorLabel),F.createElement(Bd,{key:"operator",config:a,selectedField:i,selectedFieldSrc:u,selectedFieldType:o,selectedFieldId:c,selectedOperator:l,setOperator:s,readonly:g,id:v,groupId:m})),O=f&&F.createElement(Wr,{key:"operators-for-"+c,className:"rule--operator"},F.createElement("div",{className:"rule--operator-wrapper"},a.settings.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null,F.createElement("div",{className:"rule--operator-text-wrapper"},F.createElement("span",{className:"rule--operator-text"},p.operatorInlineLabel))));return[h,O]}}])}(F.PureComponent);function Hd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function l0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hd(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Hd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function s0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,qd()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function qd(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qd=function(){return!!n})()}var Jd=qe.RuleUtils.getFieldPathLabels,tu=qe.ConfigUtils,Qd=tu.getFieldConfig,Yd=tu.getFieldParts,Xd=tu.getFieldPathParts,Zd=function(n){function e(t){var r;return(0,mr.A)(this,e),r=s0(this,e,[t]),r.setField=function(a,i){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=r.props.id;if(!u.widgetId){var l=[o,"L",-1].join(":");u.widgetId=l}r.props.setField(a,i,u)},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"],u=!this.meta||i.map(function(o){return r[o]!==a[o]}).filter(function(o){return o}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.selectedField,i=r.selectedFieldType,u=r.config,o=r.parentField,l=a,s=u.settings,c=s.maxLabelsLength,d=s.fieldSeparatorDisplay,f=s.fieldPlaceholder,p=s.fieldSeparator,g=!!a,v=g?null:bi(f,c),m=g?Qd(u,l):null,h=m||{},O=Xd(l,u),b=Xd(l,u,!0),S=this.getFieldLabel(m,l,u),C=Jd(l,u),L=C?C.join(d):null;(L==S||o)&&(L=null);var w=h.label2||h.tooltip,D=Yd(o,u),V=o?Qd(u,o):null,P=o?V&&V.subfields:u.fields,_=!g&&i,B=this.buildOptions(D,u,P,_,D),M=_?"Please select field":null;return l&&(0,Cr.A)(l)==="object"&&(l=void 0),{placeholder:v,items:B,parentField:o,selectedKey:l,selectedKeys:O,selectedPath:b,selectedLabel:S,selectedOpts:h,selectedAltLabel:w,selectedFullLabel:L,errorText:M}}},{key:"getFieldLabel",value:function(r,a,i){if(!a)return null;var u=i.settings.maxLabelsLength,o=Yd(a,i),l=r?.label||Xa()(o);return l=bi(l,u),l}},{key:"buildOptions",value:function(r,a,i){var u=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null;if(!i)return null;var c=a.settings,d=c.fieldSeparator,f=c.fieldSeparatorDisplay,p=l!=null&&l.length?l.join(d)+d:"",g=function v(m){return Object.keys(m||{}).reduce(function(h,O){var b=m[O];return b.type==="!struct"?h+v(b.subfields):h+(b.type===o?1:0)},0)};return oa()(i).map(function(v){var m=[].concat((0,Se.A)(l??[]),[v]),h=i[v],O=u.getFieldLabel(h,m,a),b=Jd(m,a),S=b.join(f);(S==O||r!=null&&r.length)&&(S=null);var C=h.label2,L=h.tooltip,w=h.disabled;if(!h.hideForSelect)if(h.type=="!struct"){var D=u.buildOptions(r,a,h.subfields,o,m,{label:O,tooltip:L}),V=g(h.subfields)>0;return{disabled:w,key:v,path:p+v,label:O,fullLabel:S,altLabel:C,tooltip:L,items:D,matchesType:V}}else{var P=o!==void 0?h.type===o:void 0;return{disabled:w,key:v,path:p+v,label:O,fullLabel:S,altLabel:C,tooltip:L,grouplabel:s?.label,group:s,matchesType:P}}}).filter(function(v){return!!v})}},{key:"render",value:function(){var r=this.props,a=r.config,i=r.customProps,u=r.setFieldSrc,o=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=l0({id:l,groupId:s,config:a,customProps:i,readonly:o,setField:this.setField,setFieldSrc:u},this.meta);return c(d,a.ctx)}}])}(F.Component);Zd.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,selectedField:R().any,selectedFieldSrc:R().string,selectedFieldType:R().string,parentField:R().string,customProps:R().object,readonly:R().bool,setField:R().func.isRequired,setFieldSrc:R().func};function ef(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function c0(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ef(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ef(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function d0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,rf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function rf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rf=function(){return!!n})()}var f0=qe.clone,Fi=qe.ConfigUtils,p0=Fi.getFieldConfig,tf=Fi.getFuncConfig,v0=Fi.getFieldParts,nf=Fi.getFieldPathParts,af=qe.RuleUtils,of=af.getFuncPathLabels,g0=af.getWidgetForFieldOp,m0=qe.OtherUtils.shallowEqual,uf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=d0(this,e,[t]),ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"],u=["config","field","fieldType","fieldSrc","value","isLHS"],o=!this.items||i.map(function(s){return s==="parentFuncs"?!m0(r[s],a[s],!0):r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;l&&(this.meta=this.getMeta(r)),o&&(this.items=this.getItems(r,this.meta))}},{key:"getItems",value:function(r,a){var i=r.config,u=r.field,o=r.fieldType,l=r.isLHS,s=r.operator,c=r.parentFuncs,d=r.fieldDefinition,f=r.isFuncArg,p=a.lookingForFieldType,g=i.settings.canUseFuncForField,v=this.filterFuncs(i,i.funcs,u,o,l,s,g,c,f,d),m=this.buildOptions(i,v,p);return m}},{key:"getMeta",value:function(r){var a=r.config,i=r._field,u=r.fieldType,o=r.value,l=r.isLHS,s=r.isFuncArg,c=a.settings,d=c.funcPlaceholder,f=c.fieldSeparatorDisplay,p=o,g=!!o,v=g?null:d,m=g?tf(a,p):null,h=m||{},O=nf(p,a),b=nf(p,a,!0),S=this.getFuncLabel(m,p,a),C=of(p,a),L=C?C.join(f):null;L==S&&(L=null);var w=l&&!s,D=w&&!g&&u,V=D?"Please select function":null;return{placeholder:v,selectedKey:p,selectedKeys:O,selectedPath:b,selectedLabel:S,selectedOpts:h,selectedFullLabel:L,errorText:V,lookingForFieldType:D}}},{key:"filterFuncs",value:function(r,a,i,u,o,l,s,c,d,f){a=f0(a);var p=r.settings.fieldSeparator,g=p0(r,i),v=!1,m,h=g,O=g0(r,i,l,"value"),b=O&&r.widgets[O];d?(h=f,m=f?.type):v&&b?m=b.type:g?m=g.type:o||(m=u);function S(C,L){for(var w in C){var D=C[w].subfields,V=(L||[]).concat(w),P=V.join(p),_=tf(r,P);if(_.type=="!struct")S(D,V)==0&&delete C[w];else{var B,M=!m||_.returnType==m;(B=h)!==null&&B!==void 0&&B.funcs&&(M=M&&h.funcs.includes(P)),s&&(M=M&&s(i,g,P,_,l)),!_.allowSelfNesting&&c&&c.map(function(q){var K=(0,Le.A)(q,2),H=K[0],U=K[1];return H}).includes(P)&&(M=!1),M||delete C[w]}}return oa()(C).length}return S(a,[]),a}},{key:"buildOptions",value:function(r,a){var i=this,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!a)return null;var s=r.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=o!=null&&o.length?o.join(c)+c:"",p=function g(v){return Object.keys(v||{}).reduce(function(m,h){var O=v[h];return O.type==="!struct"?m+g(O.subfields):m+(O.type===u?1:0)},0)};return oa()(a).map(function(g){var v=[].concat((0,Se.A)(o??[]),[g]),m=a[g],h=i.getFuncLabel(m,v,r),O=of(v,r),b=O.join(d);b==h&&(b=null);var S=m.tooltip;if(m.type=="!struct"){var C=i.buildOptions(r,m.subfields,u,v,{label:h,tooltip:S}),L=p(m.subfields)>0;return{key:g,path:f+g,label:h,fullLabel:b,tooltip:S,items:C,matchesType:L}}else{var w=u!==void 0?m.returnType===u:void 0;return{key:g,path:f+g,label:h,fullLabel:b,tooltip:S,grouplabel:l?.label,group:l,matchesType:w}}})}},{key:"getFuncLabel",value:function(r,a,i){if(!a)return null;var u=i.settings.maxLabelsLength,o=v0(a,i),l=r?.label||Xa()(o);return l=bi(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,i=r.customProps,u=r.setValue,o=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderFunc,d=c0({config:a,customProps:i,readonly:o,setField:u,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(F.Component);uf.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,field:R().any,fieldType:R().string,fieldSrc:R().string,operator:R().string,customProps:R().object,value:R().string,setValue:R().func.isRequired,readonly:R().bool,parentFuncs:R().array,fieldDefinition:R().object,isFuncArg:R().bool,isLHS:R().bool};var h0=y(23181),nu=y.n(h0),y0=["widgetFactory"],O0=["factory"];function lf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function au(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sf=qe.ListUtils.getTitleInListValues,b0=qe.ConfigUtils._widgetDefKeysToOmit,cf=qe.TreeUtils,S0=cf._fixImmutableValue,F0=cf.isImmutable,df=(0,F.memo)(function(n){var e=n.widgetFactory,t=(0,Mn.A)(n,y0),r=t.config,a=t.isFuncArg,i=t.fieldDefinition,u=i||{},o=u.fieldSettings,l=u.defaultValue,s=u.valueSources,c=a&&s?.length==1&&s?.[0]==="const",d=o?.treeValues||o?.listValues;return c&&l?typeof l=="boolean"?l?t.labelYes||"YES":t.labelNo||"NO":d?Array.isArray(l)?l.map(function(f){return sf(d,f)||f}).join(", "):sf(d,l)||l:""+l:e?e(t,r.ctx):"?"});df.displayName="WidgetFactoryMemo";var ff=function(e){var t=e.delta,r=e.isFuncArg,a=e.valueSrc,i=e.value,u=e.valueError,o=e.fieldError,l=e.asyncListValues,s=e.isSpecialRange,c=e.fieldDefinition,d=e.widget,f=e.widgetDefinition,p=e.widgetValueLabel,g=e.valueLabels,v=e.textSeparators,m=e.setValue,h=e.setFuncValue,O=e.config,b=e.field,S=e.fieldSrc,C=e.fieldPath,L=e.fieldType,w=e.isLHS,D=e.operator,V=e.readonly,P=e.parentField,_=e.parentFuncs,B=e.id,M=e.groupId,q=e.widgetId,K=f.factory,H=(0,Mn.A)(f,O0),U=i?i.map(function(pe){return S0(pe)}):void 0,te=(0,F.useMemo)(function(){if(s){var pe=[U?.get(0),U?.get(1)];return pe[0]===void 0&&pe[1]===void 0&&(pe=void 0),pe}return U?.get(t)},[s,i]),J=(0,F.useMemo)(function(){return u?s?[u.get(0),u.get(1),u.get(2)]:u?.get(t):null},[s,i]),ae=w?o:J,ce=c||{},oe=ce.fieldSettings,le=p.label,fe=p.placeholder,se=g?g.placeholder:null,me=F0(b)?null:b,Fe=Za()(au(au(au({},H),oe),{},{config:O,field:me,fieldPath:C,fieldSrc:S,fieldType:L,isLHS:w,parentField:P,parentFuncs:_,fieldDefinition:c,operator:D,delta:t,isSpecialRange:s,isFuncArg:r,value:te,valueSrc:a,valueError:J,fieldError:o,errorMessage:ae,label:le,placeholder:fe,placeholders:se,textSeparators:v,setValue:m,setFuncValue:h,readonly:V,asyncListValues:l,id:B,groupId:M,widgetId:q,widgetFactory:K,widget:d}),[].concat((0,Se.A)(b0),["toJS"]));return F.createElement(df,(0,nr.A)({widgetFactory:K},Fe))};ff.displayName="WidgetFactory";const C0=ff;function T0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,pf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function pf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pf=function(){return!!n})()}var iu=qe.ConfigUtils,E0=iu.getFieldConfig,A0=iu.getOperatorConfig,vf=iu.getFieldWidgetConfig,ou=qe.RuleUtils,L0=ou.getValueSourcesForFieldOp,gf=ou.getWidgetForFieldOp,Ci=ou.getValueLabel,mf=qe.DefaultUtils.createListWithOneElement,w0=qe.OtherUtils.shallowEqual,TS=qe.TreeUtils.isImmutable,j0={cardinality:1},xa=function(n){function e(t){var r;return(0,mr.A)(this,e),r=T0(this,e,[t]),r._setValue=function(a,i,u,o,l,s){var c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{};if(c.widgetId||(c.widgetId=o),a&&Array.isArray(l)){var d=[r.props.value.get(0),r.props.value.get(1)];d[0]!=l[0]&&r.props.setValue(0,l[0],u,s,c),d[1]!=l[1]&&r.props.setValue(1,l[1],u,s,c)}else r.props.setValue(i,l,u,s,c)},r._setValueSrc=function(a,i,u){var o={widgetId:i};r.props.setValueSrc(a,u,o)},r.renderWidget=function(a,i,u){var o=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.value,f=u.valueError,p=u.fieldError,g=u.readonly,v=u.parentField,m=u.parentFuncs,h=u.id,O=u.groupId,b=u.fieldSrc,S=u.fieldType,C=u.isLHS,L=u.setFuncValue,w=o.settings,D=i.widgets,V=i.iValues,P=i.aField,_=i.valueSources,B=l?V:d,M=l?s:P,q=D[a],K=q.valueSrc,H=q.valueLabel,U=q.widgetId,te=_.length>1&&!g,J=w.showLabels?F.createElement("label",{key:"label-"+U,className:"rule--label"},H.label):null;return F.createElement("div",{key:"wrapper-"+U,className:_t()(K==="func"?"widget--func":"widget--widget",te?"widget--has-valuerscs":"widget--has-no-valuerscs")},K==="func"?null:J,F.createElement(C0,(0,nr.A)({key:U,id:h,groupId:O,widgetId:U,valueSrc:K,delta:a,value:B,valueError:f,fieldError:p,isFuncArg:l,isLHS:C},Xt()(i,["isSpecialRange","fieldDefinition","asyncListValues"]),Xt()(D[a],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:L,config:o,field:M,fieldSrc:b,fieldType:S,parentField:v,parentFuncs:m,operator:c,readonly:g})))},r.renderValueSources=function(a,i,u){var o=u.config,l=u.isFuncArg,s=u.leftField,c=u.operator,d=u.readonly,f=o.settings,p=i.valueSources,g=i.widgets,v=i.aField,m=i.valueSourcesOptions,h=l?s:v,O=g[a],b=O.valueSrc,S=O.setValueSrc,C=r.ValueSources,L=f.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return p.length>1&&!d&&F.createElement("div",{key:"wrapper-valuesrc-"+a,className:"widget--valuesrc"},L,F.createElement(C,{key:"valuesrc-"+a,delta:a,valueSources:m,valueSrc:b,config:o,field:h,operator:c,setValueSrc:S,readonly:d,title:f.valueSourcesPopupTitle}))},r.renderSep=function(a,i,u){var o=u.config,l=i.widgets,s=o.settings,c=l[a].sepText,d=s.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return c&&F.createElement("div",{key:"widget-separators-"+a,className:_t()("widget--sep",a==0&&"widget--sep-first")},d,F.createElement("span",null,c))},r.renderWidgetDelta=function(a){var i=r.renderSep(a,r.meta,r.props),u=r.renderValueSources(a,r.meta,r.props),o=r.renderWidget(a,r.meta,r.props);return[i,u,o]},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=!this.ValueSources||a?.config!==r?.config,u=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value"],o=u.filter(function(d){return d==="parentFuncs"?!w0(r[d],a[d],!0):d==="field"?r.fieldId!==a.fieldId:r[d]!==a[d]}),l=!this.meta||o.length>0;if(l&&(this.meta=this.getMeta(r,o)),i){var s=r.config,c=s.settings.renderValueSources;this.ValueSources=Ot(s,c)}}},{key:"getMeta",value:function(r){var a,i,u,o,l=this,s=r.config,c=r.field,d=r.fieldSrc,f=r.fieldType,p=r.fieldFunc,g=r.fieldArg,v=r.operator,m=r.valueSrc,h=r.value,O=r.isForRuleGroup,b=r.isCaseValue,S=r.isFuncArg,C=r.leftField,L=r.asyncListValues,w=r.parentFuncs,D=r.isLHS,V=r.id,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],_=s.settings.valueSourcesInfo,B=S?{func:p,arg:g}:c,M=!c&&f,q=m,K=h;(S||O||b)&&(q=mf(m),K=mf(h));var H=E0(s,B);!H&&M&&(H=s.types[f]);var U=gf(s,B,v);if(!U&&M){var te;U=(te=s.types[f])===null||te===void 0?void 0:te.mainWidget}var J=S?j0:A0(s,v,B);if((H==null||J==null)&&!b)return null;var ae=J?.isSpecialRange,ce=ae&&(((a=q)===null||a===void 0?void 0:a.get(0))==="field"||((i=q)===null||i===void 0?void 0:i.get(1))==="field"),oe=ae&&!ce,le=oe?1:wy(J);if(le===0)return null;var fe=(u=this.meta)===null||u===void 0?void 0:u.valueSources,se=(o=this.meta)===null||o===void 0?void 0:o.valueSourcesOptions;(!fe||["field","operator","config","fieldDefinition","isForRuleGroup"].filter(function(Fe){return P.includes(Fe)}).length)&&(fe=L0(s,B,v,H),O&&(fe=["value"]),B||(fe=Object.keys(_)),se=fe.map(function(Fe){return[Fe,{label:_[Fe].label}]}));var me=nu()(0,le).map(function(Fe){var pe,Ae,Re,Ve,Ie=(pe=l.meta)===null||pe===void 0||(pe=pe.widgets)===null||pe===void 0?void 0:pe[Fe],De=((Ae=q)===null||Ae===void 0?void 0:Ae.get(Fe))||null,Te=gf(s,B,v,De),Ne=vf(s,B,v,Te,De);ce&&(Te=Ne.singleWidget,Ne=vf(s,B,v,Te,De)),!Ne&&M&&(Te=["func","field"].includes(De)?De:U,Ne=s.widgets[Te]);var Je=(Re=Ne)===null||Re===void 0?void 0:Re.type,ar=Ci(s,B,v,Fe,De,oe),Qe=Ci(s,B,v,Fe,null,oe),Yr=J!=null&&J.textSeparators?J?.textSeparators[Fe]:null,Tr=null,Pr=null;ae&&(Tr=[Ci(s,B,v,0),Ci(s,B,v,1)],Tr={placeholder:[Tr[0].placeholder,Tr[1].placeholder],label:[Tr[0].label,Tr[1].label]},Pr=J?.textSeparators);var ir=Wd({id:V,isLHS:D,delta:Fe,parentFuncs:w}),at=ir+":VS",bt=Ie?.setValueSrc;(!bt||Ie?.widgetId!==ir)&&(bt=l._setValueSrc.bind(l,Fe,at));var it=Ie?.setValue;return(!it||Ie?.widgetId!==ir||Ie?.widgetType!==Je||((Ve=l.meta)===null||Ve===void 0?void 0:Ve.isSpecialRange)!==ae)&&(it=l._setValue.bind(l,ae,Fe,Je,ir)),{valueSrc:De,valueLabel:ar,widget:Te,sepText:Yr,widgetDefinition:Ne,widgetValueLabel:Qe,valueLabels:Tr,textSeparators:Pr,setValueSrc:bt,setValue:it,widgetId:ir,widgetType:Je}});return{defaultWidget:U,fieldDefinition:H,operatorDefinition:J,isSpecialRange:oe,cardinality:le,valueSources:fe,valueSourcesOptions:se,widgets:me,iValues:K,aField:B,asyncListValues:L}}},{key:"render",value:function(){if(!this.meta)return null;var r=this.meta,a=r.defaultWidget,i=r.cardinality;if(!a)return null;var u=a;return F.createElement(Wr,{className:"rule--widget rule--widget--".concat(u.toUpperCase()),key:"widget-col-"+u},nu()(0,i).map(this.renderWidgetDelta))}}])}(F.Component);xa.propTypes={config:R().object.isRequired,value:R().any,valueSrc:R().any,valueError:R().any,fieldError:R().string,field:R().any,fieldSrc:R().string,fieldType:R().string,fieldId:R().string,operator:R().string,readonly:R().bool,asyncListValues:R().array,id:R().string,groupId:R().string,setValue:R().func,setValueSrc:R().func,setFuncValue:R().func,isFuncArg:R().bool,fieldFunc:R().string,fieldArg:R().string,leftField:R().any,isForRuleGroup:R().bool,parentField:R().string,parentFuncs:R().array,isLHS:R().bool,isCaseValue:R().bool};function hf(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,yf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function yf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yf=function(){return!!n})()}var R0=qe.ConfigUtils.getFuncConfig,Of=qe.OtherUtils.shallowEqual,uu=function(n){function e(t){var r;return(0,mr.A)(this,e),r=hf(this,e,[t]),r.setFunc=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=r.props,o=u.isLHS,l=u.delta,s=u.parentFuncs,c=u.id;if(!i.widgetId){var d=Wd({id:c,isLHS:o,delta:l,parentFuncs:s});i.widgetId=d}r.props.setFuncValue(o?-1:l||0,s,null,a,"!func",void 0,i)},r.setArgValue=function(a,i,u,o,l){var s=r.props,c=s.config,d=s.delta,f=s.isLHS,p=s.parentFuncs;r.props.setFuncValue(f?-1:d||0,p,a,i,u,o,l)},r.setArgValueSrc=function(a,i,u){var o=r.props,l=o.config,s=o.delta,c=o.isLHS,d=o.parentFuncs;r.props.setFuncValue(c?-1:s||0,d,a,i,"!valueSrc",void 0,u)},r.renderFuncSelect=function(){var a,i,u=r.props,o=u.config,l=u.field,s=u.fieldType,c=u.fieldSrc,d=u.isLHS,f=u.operator,p=u.customProps,g=u.value,v=u.readonly,m=u.parentFuncs,h=u.id,O=u.groupId,b=u.isFuncArg,S=u.fieldDefinition,C=(a=g==null||(i=g.get)===null||i===void 0?void 0:i.call(g,"func"))!==null&&a!==void 0?a:null,L={value:C,setValue:r.setFunc,config:o,field:l,fieldType:s,fieldSrc:c,isLHS:d,operator:f,customProps:p,readonly:v,parentFuncs:m,isFuncArg:b,fieldDefinition:S,id:h,groupId:O},w=o.settings,D=w.showLabels,V=w.funcLabel,P=D?F.createElement("label",{className:"rule--label"},V):null;return F.createElement(Wr,{key:"func",className:"rule--func"},P,F.createElement(uf,L))},r.renderArgLabel=function(a,i){var u=i.valueSources,o=i.type,l=i.showPrefix,s=i.label,c=r.props.config,d=u&&u.length==1&&u[0]=="const",f=!c.settings.showLabels&&(o=="boolean"||d)&&l;return f?F.createElement(Wr,{className:"rule--func--arg-label"},s||a):null},r.renderArgLabelSep=function(a,i){var u=i.valueSources,o=i.type,l=i.showPrefix,s=r.props.config,c=u&&u.length==1&&u[0]=="const",d=!s.settings.showLabels&&(o=="boolean"||c)&&l;return d?F.createElement(Wr,{className:"rule--func--arg-label-sep"},":"):null},r.renderArgVal=function(a,i,u){var o=r.props,l=o.config,s=o.field,c=o.fieldType,d=o.fieldSrc,f=o.isLHS,p=o.operator,g=o.value,v=o.readonly,m=o.parentFuncs,h=o.id,O=o.groupId,b=o.fieldError,S=o.valueError,C=o.setFuncValue,L=g?g.getIn(["args",i]):null,w=L?L.get("value"):void 0,D=u.valueSources.length==1?u.valueSources[0]:void 0,V=L?L.get("valueSrc")||D||"value":D,P={config:l,fieldFunc:a,fieldArg:i,leftField:s,fieldType:c,fieldSrc:d,fieldError:b,valueError:S,isLHS:f,operator:null,value:w,valueSrc:V,setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:C,funcKey:a,argKey:i,argDefinition:u,readonly:v,parentFuncs:m,id:h,groupId:O};return F.createElement(Wr,{className:"rule--func--arg-value"},F.createElement(bf,P))},r.renderArgSep=function(a,i,u,o){var l=o.renderSeps;return u?F.createElement(Wr,{className:"rule--func--arg-sep"},l?l[u-1]:", "):null},r.renderBracketBefore=function(a){var i=a.renderBrackets;return F.createElement(Wr,{key:"before_args",className:"rule--func--bracket-before"},i?i[0]:"(")},r.renderBracketAfter=function(a){var i=a.renderBrackets;return F.createElement(Wr,{key:"after_args",className:"rule--func--bracket-after"},i?i[1]:")")},r.renderFuncArgs=function(){var a=r.meta,i=a.funcDefinition,u=a.funcKey;if(!u)return null;var o=i||{},l=o.args;return l?F.createElement(F.Fragment,null,r.renderBracketBefore(i),F.createElement(Wr,{key:"args-".concat(u),className:"rule--func--args rule--func--".concat(u,"--args")},Object.keys(l).map(function(s,c){return F.createElement(Wr,{key:"arg-".concat(s,"-").concat(c),className:"rule--func--arg rule--func--".concat(u,"--arg--").concat(s)},r.renderArgSep(s,l[s],c,i),r.renderArgLabel(s,l[s]),r.renderArgLabelSep(s,l[s]),r.renderArgVal(u,s,l[s]))})),r.renderBracketAfter(i)):null},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=["config","field","operator","value","fieldSrc","fieldType","isLHS"],u=!this.meta||i.map(function(o){return o==="parentFuncs"?!Of(r[o],a[o],!0):r[o]!==a[o]}).filter(function(o){return o}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a,i,u=r.config,o=r.field,l=r.operator,s=r.value,c=(a=s==null||(i=s.get)===null||i===void 0?void 0:i.call(s,"func"))!==null&&a!==void 0?a:null,d=c?R0(u,c):null;return{funcDefinition:d,funcKey:c}}},{key:"render",value:function(){var r=this.props.parentFuncs,a=r?r.map(function(u){var o=(0,Le.A)(u,2),l=o[0],s=o[1];return"".concat(l,"_").concat(s)}).join("-"):"root",i=r?.length||0;return F.createElement(Wr,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(a," rule--func--wrapper--lev-").concat(i)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(F.Component);uu.propTypes={id:R().string,groupId:R().string,config:R().object.isRequired,field:R().any,fieldSrc:R().string,fieldType:R().string,fieldError:R().string,operator:R().string,customProps:R().object,value:R().object,setValue:R().func.isRequired,setFuncValue:R().func,readonly:R().bool,parentFuncs:R().array,fieldDefinition:R().object,isFuncArg:R().bool,isLHS:R().bool,valueError:R().string};var bf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=hf(this,e,[t]),r.setValue=function(a,i,u,o,l){var s=r.props,c=s.setValue,d=s.argKey;c(d,i,u,o,l)},r.setValueSrc=function(a,i,u){var o=r.props,l=o.setValueSrc,s=o.argKey;l(s,i,u)},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=["parentFuncs","funcKey","argKey"],u=!this.meta||i.map(function(o){return o==="parentFuncs"?!Of(r[o],a[o],!0):r[o]!==a[o]}).filter(function(o){return o}).length>0;u&&(this.meta=this.getMeta(r))}},{key:"getMeta",value:function(r){var a=r.parentFuncs,i=r.funcKey,u=r.argKey,o=[].concat((0,Se.A)(a||[]),[[i,u]]);return{parentFuncs:o}}},{key:"render",value:function(){var r=this.meta.parentFuncs;return F.createElement(xa,(0,nr.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:r}))}}])}(F.Component);bf.propTypes={funcKey:R().string.isRequired,argKey:R().string.isRequired,setValue:R().func.isRequired,setValueSrc:R().func.isRequired,readonly:R().bool,isLHS:R().bool,parentFuncs:R().array,id:R().string,groupId:R().string};function P0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Sf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Sf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sf=function(){return!!n})()}var lu=function(n){function e(t){var r;return(0,mr.A)(this,e),r=P0(this,e,[t]),r.renderField=function(){var a=r.props,i=a.config,u=a.classname,o=a.selectedField,l=a.selectedFieldSrc,s=a.selectedFieldType,c=a.setField,d=a.setFuncValue,f=a.parentField,p=a.readonly,g=a.id,v=a.groupId,m=a.fieldError,h=a.valueError,O=["func","field"];if(!O.includes(l))return"?";var b=l==="func"?F.createElement(uu,{isLHS:!0,config:i,value:o,fieldSrc:l,fieldType:s,fieldError:m,valueError:h,parentField:f,setValue:c,setFuncValue:d,readonly:p,id:g,groupId:v,key:"field-func-"+g}):F.createElement(Zd,{config:i,selectedField:o,selectedFieldSrc:l,selectedFieldType:s,parentField:f,setField:c,customProps:i.settings.customFieldSelectProps,readonly:p,id:g,groupId:v,key:"field-"+g}),S=l==="func"?i.settings.funcLabel:i.settings.fieldLabel,C=i.settings.showLabels&&l!=="func"&&F.createElement("label",{className:"rule--label"},S);return F.createElement("div",{key:l,className:u},C,b)},r.renderFieldSources=function(){if(!r.meta)return null;var a=r.props,i=a.config,u=a.readonly,o=a.selectedFieldSrc,l=a.setFieldSrc,s=a.id,c=r.meta.fieldSourcesOptions,d=i.settings,f=r.ValueSources,p=d.showLabels?F.createElement("label",{className:"rule--label"},"\xA0"):null;return c.length>1&&!u&&F.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},p,F.createElement(f,{key:"fieldsrc-"+s,valueSources:c,valueSrc:o,config:i,setValueSrc:l,readonly:u,title:d.fieldSourcesPopupTitle}))},ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=!this.ValueSources||a?.config!==r?.config,u=["config"],o=!this.meta||u.map(function(c){return r[c]!==a[c]}).filter(function(c){return c}).length>0;if(o&&(this.meta=this.getMeta(r)),i){var l=r.config,s=l.settings.renderValueSources;this.ValueSources=function(c){return s(c,l.ctx)}}}},{key:"getMeta",value:function(r){var a=r.config,i=a.settings,u=i.valueSourcesInfo,o=i.fieldSources,l=o.map(function(s){return[s,{label:u[s].label}]});return{fieldSourcesOptions:l}}},{key:"render",value:function(){var r=this.props,a=r.classname,i=r.canSelectFieldSource,u=i&&this.renderFieldSources(),o=this.renderField();return i?F.createElement(Wr,{className:"rule--field-wrapper"},u,o):o}}])}(F.Component),x0=["factory"];function I0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Ff()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Ff(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ff=function(){return!!n})()}var V0=qe.ConfigUtils.getOperatorConfig,Cf=function(n){function e(){return(0,mr.A)(this,e),I0(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var r=V0(this.props.config,this.props.selectedOperator,this.props.selectedField);if(typeof r.options>"u")return null;var a=r.options,i=a.factory,u=(0,Mn.A)(a,x0),o=Object.assign({},u,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),l=i(o,this.props.config.ctx),s=this.props.selectedOperator;return F.createElement("div",{className:"rule--operator rule--operator--".concat(s.toUpperCase())},l)}}])}(F.PureComponent);Cf.propTypes={config:R().object.isRequired,operatorOptions:R().any.isRequired,selectedField:R().any,selectedFieldSrc:R().string,selectedOperator:R().string.isRequired,readonly:R().bool,setOperatorOption:R().func.isRequired};function Tf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ef(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Tf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Tf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function D0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Af()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Af(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Af=function(){return!!n})()}var Ti=qe.ConfigUtils,N0=Ti.getFieldConfig,k0=Ti.getOperatorConfig,M0=Ti.getFieldWidgetConfig,_0=Ti.getFieldId,G0=qe.RuleUtils.isEmptyRuleProperties,Lf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=D0(this,e,[t]),ht(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this,i=this.props,u=!this.Icon||i?.config!==r?.config,o=["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"],l=!this.meta||o.map(function(O){return r[O]!==i[O]}).filter(function(O){return O}).length>0;if(l&&(this.meta=this.getMeta(r)),u){var s=r.config,c=s.settings,d=c.renderIcon,f=c.renderButton,p=c.renderButtonGroup,g=c.renderSwitch,v=c.renderBeforeWidget,m=c.renderAfterWidget,h=c.renderRuleError;this.Icon=Ot(s,d),this.Btn=Ot(s,f),this.BtnGrp=Ot(s,p),this.Switch=Ot(s,g),this.BeforeWidget=Ot(s,v),this.AfterWidget=Ot(s,m),this.RuleError=Ot(s,h)}this.doRemove=function(){a.props.removeSelf()}}},{key:"getMeta",value:function(r){var a=r.selectedField,i=r.selectedFieldType,u=r.selectedOperator,o=r.config,l=r.reordableNodesCnt,s=r.isLocked,c=o.settings.keepInputOnChangeFieldSrc,d=_0(a,o),f=N0(o,a),p=f&&f.type==="!struct",g=c&&i,v=!!a||g,m=v&&u,h=k0(o,u,a),O=h&&h.options!=null,b=M0(o,a,u,null,null)||{},S=b.hideOperator,C=o.settings.canReorder&&l>1&&!s,L=v&&!S,w=v&&S&&b.operatorInlineLabel,D=m&&!p,V=m&&O;return{selectedFieldId:d,selectedFieldWidgetConfig:b,showDragIcon:C,showOperator:L,showOperatorLabel:w,showWidget:D,showOperatorOptions:V}}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this.props,a=r.confirmFn,i=r.config,u=i.settings,o=u.renderConfirm,l=u.removeRuleConfirmOptions;l&&!this.isEmptyCurrentRule()?o.call(i.ctx,Ef(Ef({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:a}),i.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(r,a){var i=r.selectedField,u=r.selectedFieldSrc,o=r.selectedFieldType,l=r.selectedOperator,s=r.operatorOptions,c=r.value,d=r.valueType,f=r.valueSrc,p=r.asyncListValues,g=r.valueError,v=r.fieldError,m=r.parentField,h=a.selectedFieldId;return{field:i,fieldSrc:u,fieldType:o,fieldId:h,operator:l,operatorOptions:s,value:c,valueType:d,valueSrc:f,asyncListValues:p,valueError:g,fieldError:v,parentField:m}}},{key:"isEmptyCurrentRule",value:function(){var r=this.props.config,a=this._buildWidgetProps(this.props,this.meta);return G0(a,r)}},{key:"renderField",value:function(){var r=this.props,a=r.config,i=r.isLocked,u=r.parentField,o=r.groupId,l=r.id,s=r.selectedFieldSrc,c=r.selectedField,d=r.selectedFieldType,f=r.setField,p=r.setFuncValue,g=r.setFieldSrc,v=r.fieldError,m=a.settings.immutableFieldsMode,h=this.meta.selectedFieldId;return F.createElement(lu,{key:"field",classname:_t()(s=="func"?"rule--field--func":"rule--field"),config:a,canSelectFieldSource:!u,selectedField:c,selectedFieldSrc:s,selectedFieldType:d,selectedFieldId:h,fieldError:v,setField:m?yt:f,setFuncValue:m?yt:p,setFieldSrc:m?yt:g,parentField:u,readonly:m||i,id:l,groupId:o})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,i=r.isLocked,u=this.meta,o=u.selectedFieldId,l=u.selectedFieldWidgetConfig,s=u.showOperator,c=u.showOperatorLabel,d=a.settings.immutableOpsMode;return F.createElement(zd,{key:"operator",config:a,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:o,selectedOperator:this.props.selectedOperator,setOperator:d?yt:this.props.setOperator,showOperator:s,showOperatorLabel:c,selectedFieldWidgetConfig:l,readonly:d||i,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,i=r.isLocked,u=this.meta.showWidget,o=a.settings.immutableValuesMode;if(!u)return null;var l=F.createElement(xa,(0,nr.A)({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:a,setValue:o?yt:this.props.setValue,setValueSrc:o?yt:this.props.setValueSrc,setFuncValue:o?yt:this.props.setFuncValue,readonly:o||i,id:this.props.id,groupId:this.props.groupId}));return F.createElement(Wr,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderOperatorOptions",value:function(){var r=this.props.config,a=this.meta.showOperatorOptions,i=r.settings,u=i.immutableOpsMode,o=i.immutableValuesMode;if(!a)return null;var l=F.createElement(Cf,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:u?yt:this.props.setOperatorOption,config:r,readonly:o});return F.createElement(Wr,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},l)}},{key:"renderBeforeWidget",value:function(){var r=this.BeforeWidget;return r?F.createElement(Wr,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},F.createElement(r,this.props)):null}},{key:"renderAfterWidget",value:function(){var r=this.AfterWidget;return r?F.createElement(Wr,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},F.createElement(r,this.props)):null}},{key:"renderError",value:function(){var r=this.props,a=r.config,i=r.valueError,u=r.fieldError,o=a.settings.showErrorMessage,l=this.RuleError,s=[u].concat((0,Se.A)(i?.toArray()||[])).filter(function(c){return!!c}).shift()||null;return o&&s&&F.createElement("div",{className:"rule--error"},l?F.createElement(l,{error:s}):s)}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.meta.showDragIcon,i=this.Icon,u=F.createElement(i,{type:"drag"});return a&&F.createElement("div",{key:"rule-drag-icon",onMouseDown:r,className:"qb-drag-handler rule--drag-handler"},u)}},{key:"renderDel",value:function(){var r=this.props,a=r.config,i=r.isLocked,u=a.settings,o=u.deleteLabel,l=u.immutableGroupsMode,s=u.canDeleteLocked,c=this.Icon,d=this.Btn;return!l&&(!i||i&&s)&&F.createElement(d,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:o,config:a,renderIcon:c})}},{key:"renderLock",value:function(){var r=this.props,a=r.config,i=r.isLocked,u=r.isTrueLocked,o=r.id,l=a.settings,s=l.lockLabel,c=l.lockedLabel,d=l.showLock,f=this.Switch;return d&&!(i&&!u)&&F.createElement(f,{key:"rule-lock",type:"lock",id:o,value:i,setValue:this.setLock,label:s,checkedLabel:c,hideLabel:!0,config:a})}},{key:"render",value:function(){var r=this.meta,a=r.showOperatorOptions,i=r.selectedFieldWidgetConfig,u=this.props,o=u.valueSrc,l=u.value,s=u.config,c=o?.first()=="value"&&!a&&l.size==1&&i.fullWidth,d=this.BtnGrp,f=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],p=F.createElement("div",{key:"rule-body",className:_t()("rule--body",c&&"can--shrink--value")},f),g=this.renderError(),v=this.renderDrag(),m=this.renderLock(),h=this.renderDel();return F.createElement(F.Fragment,null,v,F.createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},p,g),F.createElement("div",{key:"rule-header-wrapper",className:"rule--header"},F.createElement(d,{key:"rule-header-group",config:s},m,h)))}}])}(F.Component);Lf.propTypes={id:R().string.isRequired,groupId:R().string,selectedField:R().any,selectedFieldSrc:R().string,selectedFieldType:R().string,selectedOperator:R().string,operatorOptions:R().object,config:R().object.isRequired,value:R().any,valueSrc:R().any,valueType:R().any,asyncListValues:R().array,isDraggingMe:R().bool,isDraggingTempo:R().bool,parentField:R().string,valueError:R().any,fieldError:R().string,isLocked:R().bool,isTrueLocked:R().bool,handleDraggerMouseDown:R().func,setField:R().func,setFieldSrc:R().func,setOperator:R().func,setOperatorOption:R().func,setLock:R().func,removeSelf:R().func,setValue:R().func,setValueSrc:R().func,setFuncValue:R().func,reordableNodesCnt:R().number,totalRulesCnt:R().number,parentReordableNodesCnt:R().number};const U0=zy(ia("rule")(ua(Lf)));var B0=y(22331),$0=y.n(B0);function W0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,wf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function wf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wf=function(){return!!n})()}var K0=qe.DefaultUtils.defaultGroupConjunction,z0=function(e,t){var r;return r=function(a){function i(u){var o;return(0,mr.A)(this,i),o=W0(this,i,[u]),o._selectedConjunction=function(l){return l=l||o.props,l.conjunction||K0(l.config,l.field)},o.setConjunction=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;o.props.actions.setConjunction(o.props.path,l)},o.setNot=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;o.props.actions.setNot(o.props.path,l)},o.setLock=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;o.props.actions.setLock(o.props.path,l)},o.dummyFn=function(){},o.removeSelf=function(){o.props.actions.removeGroup(o.props.path)},o.addGroup=function(){o.props.actions.addGroup(o.props.path)},o.addCaseGroup=function(){o.props.actions.addCaseGroup(o.props.path)},o.addDefaultCaseGroup=function(){o.props.actions.addDefaultCaseGroup(o.props.path)},o.addRule=function(){var l=t=="rule_group"?o.props.field:null;o.props.actions.addRule(o.props.path,void 0,void 0,void 0,l)},o.setField=function(l,s,c){o.props.actions.setField(o.props.path,l,s,c)},o.setOperator=function(l){o.props.actions.setOperator(o.props.path,l)},o.setValue=function(l,s,c,d,f){o.props.actions.setValue(o.props.path,l,s,c,d,f)},o.setValueSrc=function(l,s,c){o.props.actions.setValueSrc(o.props.path,l,s,c)},o.setFuncValue=function(l,s,c,d,f,p,g){o.props.actions.setFuncValue(o.props.path,l,s,c,d,f,p,g)},o.pureShouldComponentUpdate=aa(o),ht(o),o.selectedConjunction=o._selectedConjunction(u),o.conjunctionOptions=o._getConjunctionOptions(u),o.dummyFn.isDummyFn=!0,o}return(0,yr.A)(i,a),(0,hr.A)(i,[{key:"shouldComponentUpdate",value:function(o,l){var s=this.props,c=this.state,d=this.pureShouldComponentUpdate(o,l);if(d&&c==l&&s!=o){var f=o.dragging.id||s.dragging.id,p=f==o.id,g=[];for(var v in o){var m=o[v]!=s[v];v=="dragging"&&!p&&(m=!1),m&&g.push(v)}g.length||(d=!1)}return d}},{key:"onPropsChanged",value:function(o){var l=o.config,s=o.id,c=o.conjunction,d=this.props.config,f=this.props.conjunction;(d!=l||f!=c)&&(this.selectedConjunction=this._selectedConjunction(o),this.conjunctionOptions=this._getConjunctionOptions(o))}},{key:"_getConjunctionOptions",value:function(o){var l=this;return gi()(o.config.conjunctions,function(s,c){return{id:"conjunction-".concat(o.id,"-").concat(c),name:"conjunction[".concat(o.id,"]"),key:c,label:s.label,checked:c===l._selectedConjunction(o)}})}},{key:"render",value:function(){var o=this.props.config.settings.showErrorMessage,l=this.props.dragging.id==this.props.id,s=this.props.path.size,c=this.props.config.settings.maxNesting,d=!l&&this.props.isDraggingTempo,f=this.props.fieldType||null,p=this.props.valueError,g=(0,Se.A)(p?.toArray()||[]).filter(function(O){return!!O}).shift()||null,v=g!=null&&o,m=typeof c>"u"||s<c,h=s==1;return F.createElement("div",{className:_t()("group-or-rule-container","group-container",v?"group-with-error":null),"data-id":this.props.id},[l?F.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:h,allowFurtherNesting:m,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,F.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:l,isDraggingTempo:d,onDragStart:this.props.onDragStart,isRoot:h,allowFurtherNesting:m,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:d?this.dummyFn:this.setConjunction,setNot:d?this.dummyFn:this.setNot,setLock:d?this.dummyFn:this.setLock,removeSelf:d?this.dummyFn:this.removeSelf,addGroup:d?this.dummyFn:this.addGroup,addCaseGroup:d?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:d?this.dummyFn:this.addDefaultCaseGroup,addRule:d?this.dummyFn:this.addRule,setField:d?this.dummyFn:this.setField,setFuncValue:d?this.dummyFn:this.setFuncValue,setOperator:d?this.dummyFn:this.setOperator,setValue:d?this.dummyFn:this.setValue,setValueSrc:d?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:f,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(F.Component),r.propTypes={config:R().object.isRequired,actions:R().object.isRequired,path:R().any.isRequired,id:R().string.isRequired,groupId:R().string,not:R().bool,conjunction:R().string,children1:R().any,onDragStart:R().func,reordableNodesCnt:R().number,field:R().any,fieldSrc:R().string,fieldType:R().string,parentField:R().string,value:R().any,valueSrc:R().any,valueError:R().any,isLocked:R().bool,isTrueLocked:R().bool,dragging:R().object,isDraggingTempo:R().bool},r};const Ia=function(n,e){var t=hi(function(r){return{dragging:r.dragging}},null,null,{context:Pa})(z0(n,e));return t.displayName="ConnectedGroupContainer",t};function H0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,jf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function jf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jf=function(){return!!n})()}var q0={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},J0="topRight",Rf=function(n){function e(){return(0,mr.A)(this,e),H0(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,i=r.addRule,u=r.addGroup,o=r.removeSelf,l=r.setLock,s=r.isLocked,c=r.isTrueLocked,d=r.id,f=r.canAddGroup,p=r.canAddRule,g=r.canDeleteGroup,v=a.settings,m=v.immutableGroupsMode,h=v.addRuleLabel,O=v.addGroupLabel,b=v.delGroupLabel,S=v.groupActionsPosition,C=v.renderButton,L=v.renderIcon,w=v.renderSwitch,D=v.renderButtonGroup,V=v.lockLabel,P=v.lockedLabel,_=v.showLock,B=v.canDeleteLocked,M=function(le){return L(le,a.ctx)},q=function(le){return C(le,a.ctx)},K=function(le){return w(le,a.ctx)},H=function(le){return D(le,a.ctx)},U=q0[S||J0],te=_&&!(s&&!c)&&F.createElement(K,{type:"lock",id:d,value:s,setValue:l,label:V,checkedLabel:P,config:a}),J=!m&&p&&!s&&F.createElement(q,{type:"addRule",onClick:i,label:h,readonly:s,config:a,renderIcon:M}),ae=!m&&f&&!s&&F.createElement(q,{type:"addGroup",onClick:u,label:O,readonly:s,config:a,renderIcon:M}),ce=!m&&g&&(!s||s&&B)&&F.createElement(q,{type:"delGroup",onClick:o,label:b,config:a,renderIcon:M});return F.createElement("div",{className:"group--actions ".concat(U)},F.createElement(H,{config:a},te,J,ae,ce))}}])}(F.PureComponent);function Pf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function xf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Pf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Pf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Q0(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,If()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function If(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(If=function(){return!!n})()}var Y0=qe.RuleUtils.isEmptyGroupChildren,X0="topRight",un=function(n){function e(t){var r;return(0,mr.A)(this,e),r=Q0(this,e,[t]),r.childrenClassName=function(){return""},r.renderBeforeActions=function(){var a=r.BeforeActions;return a==null?null:F.createElement(a,(0,nr.A)({key:"group-actions-before"},r.props))},r.renderAfterActions=function(){var a=r.AfterActions;return a==null?null:F.createElement(a,(0,nr.A)({key:"group-actions-after"},r.props))},ht(r),r.onPropsChanged(t),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this,i=this.props,u=!this.Icon||i?.config!==r?.config;if(u){var o=r.config,l=o.settings,s=l.renderIcon,c=l.renderConjs,d=l.renderBeforeActions,f=l.renderAfterActions;this.Icon=Ot(o,s),this.Conjs=Ot(o,c),this.BeforeActions=Ot(o,d),this.AfterActions=Ot(o,f)}this.doRemove=function(){a.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return $0()(this.props.config.settings.groupActionsPosition||X0,"top")}},{key:"setLock",value:function(r){this.props.setLock(r)}},{key:"removeSelf",value:function(){var r=this.props,a=r.confirmFn,i=r.config,u=i.settings,o=u.renderConfirm,l=u.removeGroupConfirmOptions;l&&!this.isEmptyCurrentGroup()?o.call(i.ctx,xf(xf({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:a}),i.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,i=r.config;return Y0(a,i)}},{key:"showNot",value:function(){var r=this.props.config;return r.settings.showNot}},{key:"showConjs",value:function(){var r=this.props,a=r.conjunctionOptions,i=r.children1,u=r.config,o=Object.keys(a).length;return o>1||this.showNot()}},{key:"isNoChildren",value:function(){var r=this.props.children1;return r?r.size==0:!0}},{key:"isOneChild",value:function(){var r=this.props.children1;return r?r.size<2:!0}},{key:"renderChildrenWrapper",value:function(){var r=this.props.children1;return r&&F.createElement("div",{key:"group-children",className:_t()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var r=this.isGroupTopPosition();return F.createElement("div",{key:"group-header",className:_t()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),r&&this.renderBeforeActions(),r&&this.renderActions(),r&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){var r=this.isGroupTopPosition();return!r&&F.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var r=this.props,a=r.config,i=r.addRule,u=r.addGroup,o=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(Rf,{key:"group-actions",config:a,addRule:i,addGroup:u,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:l,id:s})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var r=this.props.config.settings.maxNumberOfRules,a=this.props.totalRulesCnt;return r?a<r:!0}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var r=this.props.children1;return r?r.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(r){if(r){var a=this.props,i=a.config,u=a.actions,o=a.onDragStart,l=a.isLocked,s=r.get("type")=="group"&&r.getIn(["properties","field"])!=null,c=s?"rule_group":r.get("type");return F.createElement(cu,(0,nr.A)({},this.extraPropsForItem(r),{key:r.get("id"),id:r.get("id"),groupId:a.id,path:r.get("path"),type:c,properties:r.get("properties"),config:i,actions:u,children1:r.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(r),totalRulesCnt:this.totalRulesCntForItem(r),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:l}))}}},{key:"extraPropsForItem",value:function(r){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var r=this.props,a=r.config,i=r.isRoot,u=r.isLocked,o=this.reordableNodesCnt();return a.settings.canReorder&&!i&&o>1&&!u}},{key:"renderDrag",value:function(){var r=this.props.handleDraggerMouseDown,a=this.Icon,i=F.createElement(a,{type:"drag"});return this.showDragIcon()&&F.createElement("div",{key:"group-drag-icon",onMouseDown:r,className:"qb-drag-handler group--drag-handler"},i)}},{key:"conjunctionOptions",value:function(){var r=this.props.conjunctionOptions;return r}},{key:"renderConjs",value:function(){var r=this.props,a=r.config,i=r.children1,u=r.id,o=r.selectedConjunction,l=r.setConjunction,s=r.not,c=r.setNot,d=r.isLocked,f=a.settings,p=f.immutableGroupsMode,g=f.renderConjs,v=f.showNot,m=f.notLabel,h=this.conjunctionOptions();if(!this.showConjs()||!i||!i.size)return null;var O={disabled:this.isOneChild(),readonly:p||d,selectedConjunction:o,setConjunction:p?yt:l,conjunctionOptions:h,config:a,not:s||!1,id:u,setNot:p?yt:c,notLabel:m,showNot:this.showNot(),isLocked:d},b=this.Conjs;return F.createElement(b,(0,nr.A)({key:"group-conjs"},O))}},{key:"renderHeader",value:function(){return F.createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return F.createElement(F.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(F.Component);un.propTypes={reordableNodesCnt:R().number,conjunctionOptions:R().object.isRequired,allowFurtherNesting:R().bool.isRequired,isRoot:R().bool.isRequired,not:R().bool,selectedConjunction:R().string,config:R().object.isRequired,id:R().string.isRequired,groupId:R().string,path:R().any,children1:R().any,isDraggingMe:R().bool,isDraggingTempo:R().bool,isLocked:R().bool,isTrueLocked:R().bool,handleDraggerMouseDown:R().func,onDragStart:R().func,addRule:R().func.isRequired,addGroup:R().func.isRequired,removeSelf:R().func.isRequired,setConjunction:R().func.isRequired,setNot:R().func.isRequired,setLock:R().func.isRequired,actions:R().object.isRequired};const Z0=Ia(ia("group")(ua(un)),"group");function eO(n,e){for(;!{}.hasOwnProperty.call(n,e)&&(n=(0,we.A)(n))!==null;);return n}function It(){return It=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,e,t){var r=eO(n,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?n:t):a.value}},It.apply(null,arguments)}function rO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Vf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Vf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vf=function(){return!!n})()}var tO=function(n){function e(){return(0,mr.A)(this,e),rO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,i=r.addRule,u=r.canAddRule,o=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,g=p.immutableGroupsMode,v=p.addRuleLabel,m=p.delGroupLabel,h=p.renderButton,O=p.renderIcon,b=p.renderSwitch,S=p.renderButtonGroup,C=p.lockLabel,L=p.lockedLabel,w=p.showLock,D=p.canDeleteLocked,V=function(U){return O(U,a.ctx)},P=function(U){return h(U,a.ctx)},_=function(U){return b(U,a.ctx)},B=function(U){return S(U,a.ctx)},M=w&&!(c&&!d)&&F.createElement(_,{type:"lock",id:f,value:c,setValue:s,label:C,checkedLabel:L,hideLabel:!0,config:a}),q=!g&&u&&!c&&F.createElement(P,{type:"addRuleGroup",onClick:i,label:v,readonly:c,config:a,renderIcon:V}),K=!g&&o&&(!c||c&&D)&&F.createElement(P,{type:"delRuleGroup",onClick:l,label:m,config:a,renderIcon:V});return F.createElement("div",{className:"group--actions"},F.createElement(B,{config:a},M,q,K))}}])}(F.PureComponent);function Df(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Nf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Df(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Df(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function nO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,kf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function kf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kf=function(){return!!n})()}var Mf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=nO(this,e,[t]),r.childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r)}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"renderChildrenWrapper",value:function(){return F.createElement(F.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),It((0,we.A)(e.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedFieldSrc,o=r.selectedFieldType,l=r.setField,s=r.setFuncValue,c=r.setFieldSrc,d=r.parentField,f=r.id,p=r.groupId,g=r.isLocked,v=a.settings.immutableFieldsMode;return F.createElement(lu,{key:"field",classname:"group--field",config:a,canSelectFieldSource:!1,selectedField:i,selectedFieldSrc:u,selectedFieldType:o,setField:l,setFuncValue:s,setFieldSrc:c,parentField:d,readonly:v||g,id:f,groupId:p})}},{key:"renderActions",value:function(){var r=this.props,a=r.config,i=r.addRule,u=r.isLocked,o=r.isTrueLocked,l=r.id;return F.createElement(tO,{config:a,addRule:i,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:o,id:l})}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(un);Mf.propTypes=Nf(Nf({},un.propTypes),{},{selectedField:R().any,selectedFieldSrc:R().string,parentField:R().string,setField:R().func,setFieldSrc:R().func});const aO=Ia(ia("group rule_group")(ua(Mf)),"rule_group");function iO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,_f()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function _f(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_f=function(){return!!n})()}var oO=function(n){function e(){return(0,mr.A)(this,e),iO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,i=r.addRule,u=r.canAddRule,o=r.canDeleteGroup,l=r.removeSelf,s=r.setLock,c=r.isLocked,d=r.isTrueLocked,f=r.id,p=a.settings,g=p.immutableGroupsMode,v=p.addSubRuleLabel,m=p.delGroupLabel,h=p.renderButton,O=p.renderIcon,b=p.renderSwitch,S=p.renderButtonGroup,C=p.lockLabel,L=p.lockedLabel,w=p.showLock,D=p.canDeleteLocked,V=function(U){return O(U,a.ctx)},P=function(U){return h(U,a.ctx)},_=function(U){return b(U,a.ctx)},B=function(U){return S(U,a.ctx)},M=w&&!(c&&!d)&&F.createElement(_,{type:"lock",id:f,value:c,setValue:s,label:C,checkedLabel:L,config:a}),q=!g&&u&&!c&&F.createElement(P,{type:"addRuleGroupExt",onClick:i,label:v,readonly:c,config:a,renderIcon:V}),K=!g&&o&&(!c||c&&D)&&F.createElement(P,{type:"delRuleGroup",onClick:l,label:m,config:a,renderIcon:V});return F.createElement("div",{className:"group--actions group--actions--tr"},F.createElement(B,{config:a},M,q,K))}}])}(F.PureComponent);function Gf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Uf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Gf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function uO(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=lO(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(s){throw s},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,u=!1,o;return{s:function(){t=t.call(n)},n:function(){var s=t.next();return i=s.done,s},e:function(s){u=!0,o=s},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(u)throw o}}}}function lO(n,e){if(n){if(typeof n=="string")return Bf(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Bf(n,e)}}function Bf(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function sO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,$f()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function $f(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($f=function(){return!!n})()}var Wf=qe.ConfigUtils,Kf=Wf.getFieldConfig,cO=Wf.getFieldWidgetConfig,dO=qe.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,zf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=sO(this,e,[t]),r.childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!0},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r)}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:_t()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return F.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var r=this.props,a=r.config,i=r.valueError,u=a.settings,o=u.renderRuleError,l=u.showErrorMessage,s=(0,Se.A)(i?.toArray()||[]).filter(function(c){return!!c}).shift()||null;return l&&s&&F.createElement("div",{className:"rule_group--error"},o?o({error:s},a.ctx):s)}},{key:"showNot",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedOperator,o=Kf(a,i)||{};return o.showNot!=null?o.showNot:a.settings.showNot}},{key:"conjunctionOptions",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedOperator,o=Kf(a,i)||{},l=It((0,we.A)(e.prototype),"conjunctionOptions",this).call(this);if(o.conjunctions){var s={},c=uO(o.conjunctions),d;try{for(c.s();!(d=c.n()).done;){var f=d.value,p=l[f];p&&(s[f]=p)}}catch(g){c.e(g)}finally{c.f()}l=s}return l}},{key:"renderField",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedFieldSrc,o=r.selectedFieldType,l=r.setField,s=r.setFieldSrc,c=r.setFuncValue,d=r.parentField,f=r.id,p=r.groupId,g=r.isLocked,v=a.settings.immutableFieldsMode;return F.createElement(lu,{key:"field",classname:"rule--field",config:a,canSelectFieldSource:!1,selectedField:i,selectedFieldSrc:u,selectedFieldType:o,setField:l,setFuncValue:c,setFieldSrc:s,parentField:d,readonly:v||g,id:f,groupId:p})}},{key:"renderOperator",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedFieldSrc,o=r.selectedOperator,l=r.setField,s=r.setOperator,c=r.isLocked,d=a.settings.immutableFieldsMode,f=cO(a,i,o)||{},p=f.hideOperator,g=i&&p&&f.operatorInlineLabel,v=i&&!p;return F.createElement(zd,{key:"operator",classname:"group--operator",config:a,selectedField:i,selectedFieldSrc:u,selectedOperator:o,setOperator:s,showOperator:v,showOperatorLabel:g,selectedFieldWidgetConfig:f,readonly:d||c,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props,a=r.children1,i=r.config,u=this._buildWidgetProps(this.props);return dO(u,a,i)}},{key:"_buildWidgetProps",value:function(r){var a=r.selectedField,i=r.selectedFieldSrc,u=r.selectedFieldType,o=r.selectedOperator,l=r.operatorOptions,s=r.value,c=r.valueType,d=r.valueSrc,f=r.asyncListValues,p=r.valueError,g=r.fieldError,v=r.parentField;return{field:a,fieldSrc:i,fieldType:u,operator:o,operatorOptions:l,value:s,valueType:c,valueSrc:["value"],valueError:p,fieldError:null,parentField:v}}},{key:"renderWidget",value:function(){var r=this.props,a=r.config,i=r.selectedField,u=r.selectedOperator,o=r.isLocked,l=a.settings.immutableValuesMode,s=i&&u,c=s;if(!c)return null;var d=F.createElement(xa,(0,nr.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:a,setValue:l?yt:this.props.setValue,setValueSrc:yt,readonly:l||o,id:this.props.id,groupId:this.props.groupId}));return F.createElement(Wr,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},d)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,i=r.addRule,u=r.isLocked,o=r.isTrueLocked,l=r.id;return F.createElement(oO,{config:a,addRule:i,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:u,isTrueLocked:o,id:l})}},{key:"reordableNodesCntForItem",value:function(r){if(this.props.isLocked)return 0;var a=this.props.children1;return a?.size||0}},{key:"extraPropsForItem",value:function(r){return{parentField:this.props.selectedField}}}])}(un);zf.propTypes=Uf(Uf({},un.propTypes),{},{selectedField:R().any,selectedFieldSrc:R().string,selectedOperator:R().string,value:R().any,parentField:R().string,setField:R().func,setFieldSrc:R().func,setOperator:R().func,setValue:R().func,valueError:R().any});const fO=Ia(ia("group rule_group_ext")(ua(zf)),"rule_group");function pO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Hf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Hf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hf=function(){return!!n})()}var vO={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},gO="topRight",mO=function(n){function e(){return(0,mr.A)(this,e),pO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.config,i=r.addCaseGroup,u=r.addDefaultCaseGroup,o=r.setLock,l=r.isLocked,s=r.isTrueLocked,c=r.id,d=r.canAddGroup,f=r.canAddDefault,p=a.settings,g=p.immutableGroupsMode,v=p.addCaseLabel,m=p.addDefaultCaseLabel,h=p.groupActionsPosition,O=p.renderButton,b=p.renderIcon,S=p.renderSwitch,C=p.renderButtonGroup,L=p.lockLabel,w=p.lockedLabel,D=p.showLock,V=function(te){return b(te,a.ctx)},P=function(te){return O(te,a.ctx)},_=function(te){return S(te,a.ctx)},B=function(te){return C(te,a.ctx)},M=vO[h||gO],q=D&&!(l&&!s)&&F.createElement(_,{type:"lock",id:c,value:l,setValue:o,label:L,checkedLabel:w,config:a}),K=!g&&d&&!l&&F.createElement(P,{type:"addCaseGroup",onClick:i,label:v,readonly:l,config:a,renderIcon:V}),H=!g&&f&&!l&&F.createElement(P,{type:"addDefaultCaseGroup",onClick:u,label:m,readonly:l,config:a,renderIcon:V});return F.createElement("div",{className:"group--actions ".concat(M)},F.createElement(B,{config:a},q,K,H))}}])}(F.PureComponent);function qf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function hO(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function yO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,Jf()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function Jf(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jf=function(){return!!n})()}var Qf=qe.TreeUtils,OO=Qf.getTotalReordableNodesCountInTree,bO=Qf.getTotalRulesCountInTree,Yf=function(n){function e(t){var r;return(0,mr.A)(this,e),r=yO(this,e,[t]),r.childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var a;return((a=r.props.children1)===null||a===void 0?void 0:a.size)&&r.props.children1.filter(function(i){return i.get("children1")==null}).size>0},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r)}},{key:"canAddGroup",value:function(){var r,a=this.props.config.settings.maxNumberOfCases,i=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0;return a?i<a:!0}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var r,a=((r=this.props.children1)===null||r===void 0?void 0:r.size)||0,i=a;return this.hasDefaultCase()&&i--,i}},{key:"totalRulesCntForItem",value:function(r){return bO(r)}},{key:"reordableNodesCntForItem",value:function(r){var a;if(this.props.isLocked)return 0;var i=this.props.config.settings,u=i.canLeaveEmptyCase,o=i.canRegroupCases,l=((a=this.props.children1)===null||a===void 0?void 0:a.size)||0,s=l;this.hasDefaultCase()&&s--;var c=OO(r),d=c;return d==1&&o&&u&&s>1&&(d=111),d}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:_t()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){var r=this.props.config,a=r.settings.renderSwitchPrefix;return a||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var r=this.props,a=r.config,i=r.addCaseGroup,u=r.addDefaultCaseGroup,o=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(mO,{config:a,addCaseGroup:i,addDefaultCaseGroup:u,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:l,id:s})}}])}(un);Yf.propTypes=hO({},un.propTypes);const SO=Ia(ia("group switch_group")(ua(Yf)),"switch_group");function Xf(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Zf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Xf(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Xf(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function FO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,ep()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function ep(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ep=function(){return!!n})()}var rp=function(n){function e(t){var r;return(0,mr.A)(this,e),r=FO(this,e,[t]),r.childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=!this.renderBeforeCaseValue||a?.config!==r?.config;if(It((0,we.A)(e.prototype),"onPropsChanged",this).call(this,r),i){var u=r.config,o=u.settings,l=o.renderBeforeCaseValue,s=o.renderAfterCaseValue,c=o.renderRuleError;this.BeforeCaseValue=Ot(u,l),this.AfterCaseValue=Ot(u,s),this.RuleError=Ot(u,c)}}},{key:"isDefaultCase",value:function(){return this.props.children1==null}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(r){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(r){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return this.isDefaultCase()?!1:It((0,we.A)(e.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return F.createElement("div",{key:"group-header",className:_t()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()&&(!this.isOneChild()||this.showNot())?"with--conjs":"hide--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:F.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){if(this.isDefaultCase()){var r=this.props.config.settings.defaultCaseLabel;return r||""}return F.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:It((0,we.A)(e.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?F.createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return this.isDefaultCase()?!1:It((0,we.A)(e.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return this.isDefaultCase()?!1:It((0,we.A)(e.prototype),"canAddRule",this).call(this)}},{key:"renderBeforeValue",value:function(){var r=this.BeforeCaseValue;return r==null?null:F.createElement(r,(0,nr.A)({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var r=this.AfterCaseValue;return r==null?null:F.createElement(r,(0,nr.A)({key:"values-after"},this.props))}},{key:"renderError",value:function(){var r=this.props,a=r.config,i=r.valueError,u=a.settings.showErrorMessage,o=this.RuleError,l=(0,Se.A)(i?.toArray()||[]).filter(function(s){return!!s}).shift()||null;return u&&l&&F.createElement("div",{className:"rule--error"},o?F.createElement(o,{error:l}):l)}},{key:"renderValue",value:function(){var r=this.props,a=r.config,i=r.isLocked,u=r.value,o=r.valueSrc,l=r.valueError,s=r.setValue,c=r.setValueSrc,d=r.setFuncValue,f=r.id,p=a.settings.immutableValuesMode,g=F.createElement(xa,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:u,valueSrc:o??"value",valueError:l,fieldError:null,config:a,setValue:p?yt:s,setValueSrc:p?yt:c,setFuncValue:p?yt:d,readonly:p||i,id:f,groupId:null});return F.createElement(Wr,{className:"case_group--value"},g)}},{key:"renderActions",value:function(){var r=this.props,a=r.config,i=r.addGroup,u=r.addRule,o=r.isLocked,l=r.isTrueLocked,s=r.id;return F.createElement(Rf,{config:a,addGroup:i,addRule:u,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:l,id:s})}},{key:"isEmptyCurrentGroup",value:function(){var r=this.props.value,a=r&&r.size?r.get(0):null,i=a!=null&&(Array.isArray(a)?a.length>0:!0);return It((0,we.A)(e.prototype),"isEmptyCurrentGroup",this).call(this)&&!i}}])}(un);rp.propTypes=Zf(Zf({},un.propTypes),{},{parentReordableNodesCnt:R().number,value:R().any,setValue:R().func});const CO=Ia(ia("group case_group")(ua(rp)),"case_group");var TO=["type"];function EO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,tp()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function tp(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tp=function(){return!!n})()}function np(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function su(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?np(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):np(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var AO=["rule","group","rule_group","switch_group","case_group"],la=function(e){var t,r=((t=e.properties)===null||t===void 0?void 0:t.toObject())||{},a=su({},r);return e.isParentLocked&&(a.isLocked=!0),r.isLocked&&(a.isTrueLocked=!0),a},LO={rule:function(e){return F.createElement(U0,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return F.createElement(Z0,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return F.createElement(aO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return F.createElement(fO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return F.createElement(SO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return F.createElement(CO,(0,nr.A)({},la(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},cu=function(n){function e(){return(0,mr.A)(this,e),EO(this,e,arguments)}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r,a=this.props,i=a.type,u=(0,Mn.A)(a,TO),o=(r=u.properties)===null||r===void 0?void 0:r.get("mode"),l=o=="array"?"_ext":"",s=u.config.settings.renderItem,c=LO[i+l];return s?s(su(su({},u),{},{type:i,itemComponent:c}),u.config.ctx):c?c(u):null}}])}(F.PureComponent);cu.propTypes={config:R().object.isRequired,id:R().string.isRequired,groupId:R().string,type:R().oneOf(AO).isRequired,path:R().any.isRequired,properties:R().any,children1:R().any,actions:R().object.isRequired,reordableNodesCnt:R().number,onDragStart:R().func,parentField:R().string,isDraggingTempo:R().bool,isParentLocked:R().bool};function wO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,ap()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function ap(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ap=function(){return!!n})()}var ip=qe.TreeUtils,jO=ip.getTotalReordableNodesCountInTree,RO=ip.getTotalRulesCountInTree,op=qe.DefaultUtils,PO=op.createListWithOneElement,up=op.emptyProperties,lp=function(n){function e(t){var r;return(0,mr.A)(this,e),r=wO(this,e,[t]),r.pureShouldComponentUpdate=aa(r),r._updPath(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"shouldComponentUpdate",value:function(r,a){var i=this.pureShouldComponentUpdate(r,a);return i}},{key:"_updPath",value:function(r){var a=r.tree.get("id");this.path=PO(a)}},{key:"render",value:function(){var r=this.props,a=r.tree,i=r.config,u=r.actions,o=r.onDragStart,l=a.get("type"),s=l=="switch_group",c=s?null:jO(a),d=s?null:RO(a),f=a.get("id");return F.createElement(cu,{key:f,id:f,path:this.path,type:l,properties:a.get("properties")||up(),config:i,actions:u,children1:a.get("children1")||up(),reordableNodesCnt:c,totalRulesCnt:d,parentReordableNodesCnt:0,onDragStart:o})}}])}(F.Component);lp.propTypes={tree:R().any.isRequired,config:R().object.isRequired,actions:R().object.isRequired,onDragStart:R().func};const xO=Qy(lp);function sp(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function IO(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sp(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):sp(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function VO(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,cp()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function cp(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cp=function(){return!!n})()}var DO=qe.clone,du=qe.ConfigUtils,Va=du.getFieldConfig,dp=du.getFieldParts,fp=du.getFieldPathParts,pp=qe.RuleUtils,vp=pp.getFieldPathLabels,NO=pp.getWidgetForFieldOp,gp=function(n){function e(t){var r;return(0,mr.A)(this,e),r=VO(this,e,[t]),ht(r),r.onPropsChanged(t),r}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"onPropsChanged",value:function(r){var a=this.props,i=["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"],u=["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"],o=!this.items||i.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0,l=!this.meta||u.map(function(s){return r[s]!==a[s]}).filter(function(s){return s}).length>0;o&&(this.items=this.getItems(r)),l&&(this.meta=this.getMeta(r))}},{key:"getItems",value:function(r){var a=r.config,i=r.field,u=r.fieldType,o=r.operator,l=r.parentField,s=r.isFuncArg,c=r.fieldDefinition,d=a.settings.canCompareFieldWithField,f=dp(l,a),p=l?Va(a,l):null,g=l?p?.subfields:a.fields,v=this.filterFields(a,g,i,l,f,o,d,s,c,u),m=this.buildOptions(f,a,v,f);return m}},{key:"getMeta",value:function(r){var a,i=r.config,u=r.field,o=r.fieldType,l=r.operator,s=r.value,c=r.placeholder,d=r.isFuncArg,f=r.parentField,p=i.settings,g=p.fieldPlaceholder,v=p.fieldSeparatorDisplay,m=s,h=!!s,O=u?Va(i,u):{},b=O==null||(a=O.widgets)===null||a===void 0?void 0:a.field,S=b?.widgetProps||{},C=h?null:d&&c||S.valuePlaceholder||g,L=h?Va(i,m):null,w=L||{},D=fp(m,i),V=fp(m,i,!0),P=this.getFieldLabel(L,m,i),_=vp(m,i),B=_?_.join(v):null;(B==P||f)&&(B=null);var M=w.label2||w.tooltip;return{placeholder:C,selectedKey:m,selectedKeys:D,selectedPath:V,selectedLabel:P,selectedOpts:w,selectedAltLabel:M,selectedFullLabel:B}}},{key:"filterFields",value:function(r,a,i,u,o,l,s,c,d,f){a=DO(a);var p=r.settings.fieldSeparator,g=Va(r,i),v=!1,m=NO(r,i,l,"value"),h=r.widgets[m],O;c?O=d?.type:v&&h?O=h.type:g?O=g.type:O=f;function b(S,C){for(var L in S){var w=S[L].subfields,D=(C||[]).concat(L),V=D.join(p),P=Va(r,V);if(!P)delete S[L];else if(P.type=="!struct"||P.type=="!group")b(w,D)==0&&delete S[L];else{var _=(!O||P.type==O)&&(c?!0:V!=i),B=s||r.settings.canCompareFieldWithField;B&&(_=_&&B(i,g,V,P,l)),_||delete S[L]}}return oa()(S).length}return b(a,o||[]),a}},{key:"buildOptions",value:function(r,a,i){var u=this,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!i)return null;var s=a.settings,c=s.fieldSeparator,d=s.fieldSeparatorDisplay,f=o!=null&&o.length?o.join(c)+c:"";return oa()(i).map(function(p){var g=[].concat((0,Se.A)(o??[]),[p]),v=i[p],m=u.getFieldLabel(v,g,a),h=vp(g,a),O=h.join(d);(O==m||r)&&(O=null);var b=v.label2,S=v.tooltip;if(!v.hideForCompare)return v.type=="!struct"||v.type=="!group"?{key:p,path:f+p,label:m,fullLabel:O,altLabel:b,tooltip:S,items:u.buildOptions(r,a,v.subfields,g,{label:m,tooltip:S})}:{key:p,path:f+p,label:m,fullLabel:O,altLabel:b,tooltip:S,grouplabel:l?.label,group:l}}).filter(function(p){return!!p})}},{key:"getFieldLabel",value:function(r,a,i){if(!a)return null;var u=i.settings.maxLabelsLength,o=dp(a,i),l=r?.label||Xa()(o);return l=bi(l,u),l}},{key:"render",value:function(){var r=this.props,a=r.config,i=r.customProps,u=r.setValue,o=r.readonly,l=r.id,s=r.groupId,c=a.settings.renderField,d=IO({isValueField:!0,config:a,customProps:i,setField:u,readonly:o,items:this.items,id:l,groupId:s},this.meta);return c(d,a.ctx)}}])}(F.Component);gp.propTypes={id:R().string,groupId:R().string,setValue:R().func.isRequired,config:R().object.isRequired,field:R().any,fieldSrc:R().string,fieldType:R().string,value:R().string,operator:R().string,customProps:R().object,readonly:R().bool,parentField:R().string,fieldDefinition:R().object,isFuncArg:R().bool};const kO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.labelYes,i=n.labelNo,u=n.readonly,o=n.widgetId,l=n.customProps,s=l===void 0?{}:l,c=s.radioYes||{},d=s.radioNo||{},f=function(v){return t(v.target.checked)},p=function(v){return t(v.target.value=="true")};return F.createElement(F.Fragment,null,F.createElement("input",(0,nr.A)({type:"radio",value:!0,checked:!!e,disabled:u,onChange:p},c))," ",a,F.createElement("input",(0,nr.A)({type:"radio",value:!1,checked:!e,disabled:u,onChange:p},d))," ",i)},MO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,i=n.placeholder,u=n.maxLength,o=n.customProps,l=function(d){var f=d.target.value;f===""&&(f=void 0),t(f)},s=e||"";return F.createElement("input",(0,nr.A)({type:"text",value:s,placeholder:i,disabled:a,onChange:l,maxLength:u},o))},_O=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,i=n.placeholder,u=n.maxLength,o=n.maxRows,l=n.fullWidth,s=n.customProps,c=function(p){var g=p.target.value;g===""&&(g=void 0),t(g)},d=e||"";return F.createElement("textarea",(0,nr.A)({value:d,placeholder:i,disabled:a,onChange:c,maxLength:u,style:{width:l?"100%":void 0}},s))};var ES=qe.moment;const GO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,i=n.readonly,u=n.customProps,o=function(s){var c=s.target.value;c==""&&(c=void 0),t(c)};return F.createElement("input",(0,nr.A)({type:"date",value:e||"",disabled:i,onChange:o},u))},UO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,i=n.use12Hours,u=n.readonly,o=n.customProps,l=function(c){var d=c.target.value;d==""&&(d=void 0),t(d)};return F.createElement("input",(0,nr.A)({type:"time",value:e||"",disabled:u,onChange:l},o))};var mp=qe.moment;const BO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.valueFormat,i=n.use12Hours,u=n.readonly,o=n.customProps,l=function(d){var f=d.target.value;f==""?f=void 0:f=mp(new Date(f)).format(a),t(f)},s=e;return e?s=mp(e).format("YYYY-MM-DDTHH:mm"):s="",F.createElement("input",(0,nr.A)({type:"datetime-local",value:s,disabled:u,onChange:l},o))};var $O=qe.ListUtils.mapListValues;const WO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,i=n.readonly,u=n.customProps,o=function(){return $O(e,function(d){var f=d.title,p=d.value;return F.createElement("option",{key:p,value:p},f)})},l=function(d){for(var f=[],p=d.options,g=0;g<p.length;g++){var v=p[g];v.selected&&f.push(v.value)}return f.length||(f=void 0),f},s=function(d){return r(l(d.target))};return F.createElement("select",(0,nr.A)({multiple:!0,onChange:s,value:t,disabled:i},Za()(u,["showSearch","input","showCheckboxes"])),o())};var KO=qe.ListUtils.mapListValues;const zO=function(n){var e=n.listValues,t=n.value,r=n.setValue,a=n.allowCustomValues,i=n.readonly,u=n.customProps,o=function(){return KO(e,function(d){var f=d.title,p=d.value;return F.createElement("option",{key:p,value:p},f)})},l=function(d){return r(d.target.value)},s=t!=null;return F.createElement("select",(0,nr.A)({onChange:l,value:s?t:"",disabled:i},Za()(u,["showSearch","input"])),!s&&F.createElement("option",{disabled:!0,value:""}),o())},HO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,i=n.min,u=n.max,o=n.step,l=n.placeholder,s=n.customProps,c=function(p){var g=p.target.value;g===""||g===null?g=void 0:g=Number(g),t(g)},d=e??"";return F.createElement("input",(0,nr.A)({type:"number",value:d,placeholder:l,disabled:a,min:i,max:u,step:o,onChange:c},s))},qO=function(n){var e=n.value,t=n.setValue,r=n.config,a=n.readonly,i=n.min,u=n.max,o=n.step,l=n.placeholder,s=n.customProps,c=s===void 0?{}:s,d=c.input||{},f=c.slider||c,p=function(m){var h=m.target.value;h===""||h===null?h=void 0:h=Number(h),t(h)},g=e??"";return F.createElement("div",{style:{display:"inline-flex"}},F.createElement("input",(0,nr.A)({key:"number",type:"number",value:g,placeholder:l,disabled:a,min:i,max:u,step:o,onChange:p},d)),F.createElement("input",(0,nr.A)({key:"range",type:"range",value:g,disabled:a,min:i,max:u,step:o,onChange:p},f)))},JO=function(n){var e=n.items,t=n.setField,r=n.selectedKey,a=n.readonly,i=n.errorText,u=function s(c){return c.map(function(d){var f=d.items,p=d.path,g=d.label,v=d.disabled,m=d.matchesType;if(f)return F.createElement("optgroup",{disabled:v,key:p,label:g},s(f));var h=m?{fontWeight:"bold"}:{};return F.createElement("option",{disabled:v,key:p,value:p,style:h},g)})},o=function(c){return t(c.target.value)},l=r!=null;return F.createElement("select",{onChange:o,value:l?r:"",disabled:a,style:{color:i?"red":null}},!l&&F.createElement("option",{disabled:!0,value:""}),u(e))},QO=function(n){var e=n.id,t=n.not,r=n.setNot,a=n.conjunctionOptions,i=n.setConjunction,u=n.disabled,o=n.readonly,l=n.config,s=n.showNot,c=n.notLabel,d=Object.keys(a).length,f=u,p=l.settings.forceShowConj,g=p||d>1&&!f,v=function(){return Object.keys(a).map(function(S){var C=a[S],L=C.id,w=C.name,D=C.label,V=C.checked,P=i.isDummyFn?"__dummy":"";return(o||u)&&!V?null:[F.createElement("input",{key:L+P,type:"radio",id:L+P,name:w+P,checked:V,disabled:o||u,value:S,onChange:h}),F.createElement("label",{key:L+P+"label",htmlFor:L+P},D)]})},m=function(){var S="not";return[F.createElement("input",{key:e+S,type:"checkbox",id:e+S,checked:t,disabled:o,onChange:O}),F.createElement("label",{key:e+S+"label",htmlFor:e+S},c||"NOT")]},h=function(S){return i(S.target.value)},O=function(S){return r(S.target.checked)};return[s&&m(),g&&v()]};var YO={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const XO=function(n){var e=n.type,t=n.label,r=n.onClick,a=n.readonly,i=t||YO[e];return F.createElement("button",{onClick:r,type:"button",disabled:a},i)},ZO=function(n){var e=n.type,t={},r=t[e]||null;return!r&&e==="drag"&&(r=F.createElement($d,null)),r},eb=function(n){var e=n.children,t=n.config;return F.createElement(F.Fragment,null,e)},rb=function(n){var e=n.config,t=n.valueSources,r=n.valueSrc,a=n.title,i=n.setValueSrc,u=n.readonly,o=function(c){return c.map(function(d){var f=(0,Le.A)(d,2),p=f[0],g=f[1];return F.createElement("option",{key:p,value:p},g.label)})},l=function(c){return i(c.target.value)};return F.createElement("select",{onChange:l,value:r||"",disabled:u},o(t))},tb=function(n){var e=n.value,t=n.setValue,r=n.label,a=n.id,i=n.config,u=n.type,o=function(c){return t(c.target.checked)},l=u;return[F.createElement("input",{key:a+l,type:"checkbox",id:a+l,checked:!!e,onChange:o}),F.createElement("label",{key:a+l+"label",htmlFor:a+l},r)]},nb=function(n){var e=n.onOk,t=n.okText,r=n.cancelText,a=n.title;confirm(a)&&e()};var ab=function(e){var t=e.config,r=e.children;return r};function ib(n,e,t){return e=(0,we.A)(e),(0,Fr.A)(n,hp()?Reflect.construct(e,t||[],(0,we.A)(n).constructor):e.apply(n,t))}function hp(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hp=function(){return!!n})()}var fu=function(n){function e(){var t;(0,mr.A)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=ib(this,e,[].concat(a)),t.handleChange=function(u){t.props.setOption("proximity",parseInt(u))},t}return(0,yr.A)(e,n),(0,hr.A)(e,[{key:"render",value:function(){var r=this.props,a=r.defaults,i=r.options,u=r.config,o=r.optionLabel,l=r.optionPlaceholder,s=r.customProps,c=r.minProximity,d=r.maxProximity,f=r.optionTextBefore,p=r.readonly,g=u.settings,v=u.widgets,m=u.ctx,h=a?a.proximity:void 0,O=g.showLabels,b=i.get("proximity",h),S=nu()(c,d+1).map(function(w){return{title:w,value:w}}),C=v.select.factory,L=function(D){return C(D,m)};return F.createElement("div",{className:"operator--PROXIMITY"},F.createElement("div",{className:"operator--options"},O&&F.createElement("label",{className:"rule--label"},o),!O&&f&&F.createElement("div",{className:"operator--options--sep"},F.createElement("span",null,f)),F.createElement(L,(0,nr.A)({config:u,value:b,listValues:S,setValue:this.handleChange,readonly:p,placeholder:l},s))),F.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(F.PureComponent);fu.propTypes={config:R().object.isRequired,setOption:R().func.isRequired,options:R().any.isRequired,minProximity:R().number,maxProximity:R().number,optionPlaceholder:R().string,optionTextBefore:R().string,optionLabel:R().string,customProps:R().object,readonly:R().bool},fu.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};function yp(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ke(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?yp(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):yp(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var ob=Ke({},Ir.conjunctions),ub=Ke(Ke({},Ir.operators),{},{proximity:Ke(Ke({},Ir.operators.proximity),{},{options:Ke(Ke({},Ir.operators.proximity.options),{},{factory:function(e,t){var r=t.RCE,a=t.O.ProximityOperator;return r(a,e)}})})}),lb={text:Ke(Ke({},Ir.widgets.text),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}}),textarea:Ke(Ke({},Ir.widgets.textarea),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextAreaWidget;return r(a,e)}}),number:Ke(Ke({},Ir.widgets.number),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaNumberWidget;return r(a,e)}}),slider:Ke(Ke({},Ir.widgets.slider),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSliderWidget;return r(a,e)}}),select:Ke(Ke({},Ir.widgets.select),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaSelectWidget;return r(a,e)}}),multiselect:Ke(Ke({},Ir.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaMultiSelectWidget;return r(a,e)}}),date:Ke(Ke({},Ir.widgets.date),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateWidget;return r(a,e)}}),time:Ke(Ke({},Ir.widgets.time),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTimeWidget;return r(a,e)}}),datetime:Ke(Ke({},Ir.widgets.datetime),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaDateTimeWidget;return r(a,e)}}),boolean:Ke(Ke({},Ir.widgets.boolean),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaBooleanWidget;return r(a,e)}}),field:Ke(Ke({},Ir.widgets.field),{},{factory:function(e,t){var r=t.RCE,a=t.W.ValueFieldWidget;return r(a,e)},customProps:{showSearch:!0}}),func:Ke(Ke({},Ir.widgets.func),{},{factory:function(e,t){var r=t.RCE,a=t.W.FuncWidget;return r(a,e)},customProps:{}}),case_value:Ke(Ke({},Ir.widgets.case_value),{},{factory:function(e,t){var r=t.RCE,a=t.W.VanillaTextWidget;return r(a,e)}})},sb=Ke(Ke({},Ir.types),{},{select:Ke(Ke({},Ir.types.select),{},{widgets:Ke(Ke({},Ir.types.select.widgets),{},{select:Ke(Ke({},Ir.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),cb=Ke(Ke({},Ir.settings),{},{renderField:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderOperator:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderFunc:function(e,t){var r=t.RCE,a=t.W.VanillaFieldSelect;return r(a,e)},renderConjs:function(e,t){var r=t.RCE,a=t.W.VanillaConjs;return r(a,e)},renderSwitch:function(e,t){var r=t.RCE,a=t.W.VanillaSwitch;return r(a,e)},renderButton:function(e,t){var r=t.RCE,a=t.W.VanillaButton;return r(a,e)},renderIcon:function(e,t){var r=t.RCE,a=t.W.VanillaIcon;return r(a,e)},renderButtonGroup:function(e,t){var r=t.RCE,a=t.W.VanillaButtonGroup;return r(a,e)},renderProvider:function(e,t){var r=t.RCE,a=t.W.VanillaProvider;return r(a,e)},renderValueSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderFieldSources:function(e,t){var r=t.RCE,a=t.W.VanillaValueSources;return r(a,e)},renderConfirm:function(e,t){var r=t.W.vanillaConfirm;return r(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,t){var r=t.RCE;return r("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),db=Ke(Ke({},Ir.ctx),{},{W:Ke({},Ye),O:Ke({},_e),RCE:function(e,t){return F.createElement(e,t)}}),pu={conjunctions:ob,operators:ub,widgets:lb,types:sb,settings:cb,ctx:db};pu=qe.ConfigMixins.removeMixins(pu,["rangeslider","treeselect","treemultiselect"]);const Kr=pu;var AS=y(38221);function Op(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Ei(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Op(Object(t),!0).forEach(function(r){_defineProperty(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Op(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Da=qe.Autocomplete,Ai=Da.mergeListValues,bp=Da.listValueToOption,fb=Da.optionToListValue,pb=Da.optionsToListValues,vb=Da.fixListValuesGroupOrder,sa=qe.ListUtils,gb=sa.mapListValues,Li=sa.listValuesToArray,wi=sa.getListValue,mb=sa.makeCustomListValue,hb=sa.searchListValue,LS=sa.getItemInListValues;function Sp(n){return new Promise(function(e){setTimeout(e,n)})}var wS=function(e,t){var r=e.asyncFetch,a=e.useLoadMore,i=e.useAsyncSearch,u=e.forceAsyncSearch,o=e.asyncListValues,l=e.listValues,s=e.allowCustomValues,c=e.value,d=e.setValue,f=e.placeholder,p=e.config,g=t.debounceTimeout,v=t.multiple,m=t.uif,h=t.isFieldAutocomplete,O=["LOAD_MORE","LOADING_MORE"],b="Load more...",S="Loading more...",C=u?"Type to search":f,L=React.useState(!1),w=_slicedToArray(L,2),D=w[0],V=w[1],P=React.useState(void 0),_=_slicedToArray(P,2),B=_[0],M=_[1],q=React.useState(0),K=_slicedToArray(q,2),H=K[0],U=K[1],te=React.useState(!1),J=_slicedToArray(te,2),ae=J[0],ce=J[1],oe=React.useState(""),le=_slicedToArray(oe,2),fe=le[0],se=le[1],me=React.useState(void 0),Fe=_slicedToArray(me,2),pe=Fe[0],Ae=Fe[1],Re=React.useRef(0),Ve=React.useRef(0),Ie=React.useRef(!1),De=React.useMemo(function(){return Li(o)},[o]),Te=React.useMemo(function(){return r?o?Ai(pe,De,!0):pe:Li(l)},[r,o,pe,l]),Ne=r?pe:Li(l);s&&fe&&!hb(fe,pe)&&(Ne=Ai(Ne,[mb(fe)],!0)),r&&!pe&&o&&!fe&&!D&&m==="antd"&&(Ne=Te),r&&!s&&o&&m==="mui"&&(Ne=Ai(Ne,De,!0,!0));var Je=H>0,ar=D&&r&&pe===void 0&&(u?fe:!0),Qe=ar&&Je,Yr=!Qe&&Te&&Te.length>0&&B&&B.hasMore&&(B.filter||"")===fe,Tr=!Je&&Yr,Pr=gb(Ne,bp),ir=c!=null,at=!v&&ir?wi(c,Te):null,bt=function(){var Gr=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(){var Ue,rr,sr,Or,Vr,xr,wt,Nr,jn,Zr,Qt,hn,Gt,Yt,Ut,Bt=arguments;return _regeneratorRuntime.wrap(function(Ft){for(;;)switch(Ft.prev=Ft.next){case 0:return Ue=Bt.length>0&&Bt[0]!==void 0?Bt[0]:null,rr=Bt.length>1&&Bt[1]!==void 0?Bt[1]:!1,!rr&&B&&M(void 0),sr=rr&&pe?pe.length:0,Or=rr&&B||!a&&{pageSize:0},Vr=++Re.current,Ft.next=8,r.call(p?.ctx,Ue,sr,Or);case 8:if(xr=Ft.sent,wt=Re.current!=Vr,!(wt||!Ve.current)){Ft.next=12;break}return Ft.abrupt("return",null);case 12:return Nr=xr!=null&&xr.values?xr:{values:xr},jn=Nr.values,Zr=Nr.hasMore,Qt=Nr.meta,hn=Li(jn),rr?(Yt=Ai(pe,hn,!1),Gt=Yt.length>pe.length):(Yt=hn,a&&(Gt=Yt.length>0)),Ut=Zr!=null||Qt!=null||Gt!=null?Ei(Ei(Ei(Ei({},Gt!=null?{hasMore:Gt}:{}),Zr!=null?{hasMore:Zr}:{}),Qt??{}),{},{filter:Ue}):void 0,Ut&&M(Ut),Ft.abrupt("return",Yt);case 18:case"end":return Ft.stop()}},Ge)}));return function(){return Gr.apply(this,arguments)}}(),it=function(){var Gr=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(){var Ue,rr,sr,Or=arguments;return _regeneratorRuntime.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return Ue=Or.length>0&&Or[0]!==void 0?Or[0]:null,rr=Or.length>1&&Or[1]!==void 0?Or[1]:!1,U(function(wt){return wt+1}),ce(rr),xr.next=6,bt(Ue,rr);case 6:if(sr=xr.sent,Ve.current){xr.next=9;break}return xr.abrupt("return");case 9:sr!=null&&Ae(sr),U(function(wt){return wt-1}),ce(!1);case 12:case"end":return xr.stop()}},Ge)}));return function(){return Gr.apply(this,arguments)}}(),St=React.useCallback(debounce(it,g),[]);React.useEffect(function(){return Ve.current++,ar&&H==0&&Re.current==0&&_asyncToGenerator(_regeneratorRuntime.mark(function Gr(){return _regeneratorRuntime.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.next=2,it();case 2:case"end":return Ue.stop()}},Gr)}))(),function(){Ve.current--}},[ar]);var or=function(){V(!0)},Lt=function(){var Gr=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(Ue){var rr,sr;return _regeneratorRuntime.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:if(rr=Ie.current,rr?(Ie.current=!1,v&&V(!1)):V(!1),!(m==="mui"&&!rr)){Vr.next=6;break}return sr="",Vr.next=6,ur(null,sr,"my-reset");case 6:case"end":return Vr.stop()}},Ge)}));return function(Ue){return Gr.apply(this,arguments)}}(),Vt=function(Ge){Ge?or():Lt()},zr=function(Ge){var Ue=Ge?.specialValue||Ge?.value;return O.includes(Ue)},ot=function(){var Gr=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(Ue,rr,sr){var Or,Vr,xr,wt,Nr,jn,Zr,Qt,hn,Gt,Yt,Ut,Bt,Na,Ft,xi,vt;return _regeneratorRuntime.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(Vr=v&&m==="mui"&&sr==="clear",xr=!v&&m==="mui"&&sr==="clear"&&Ue?.type==="change",wt=!v&&m==="mui"&&sr==="clear"&&Ue?.type!=="change",m==="mui"&&(sr=rr,v?rr=sr.map(function(Dt){var yn;return(yn=Dt?.value)!==null&&yn!==void 0?yn:Dt}):rr=(Nr=(jn=sr)===null||jn===void 0?void 0:jn.value)!==null&&Nr!==void 0?Nr:sr),Zr=v&&Array.isArray(sr)&&sr.map(function(Dt){return Dt?.specialValue}).find(function(Dt){return!!Dt})||((Or=sr)===null||Or===void 0?void 0:Or.specialValue),v&&rr&&!Array.isArray(rr)&&(rr=[].concat(_toConsumableArray(c||[]),[rr]),sr=null),Qt=Vr&&rr.length===0&&fe&&D||xr,!Qt){pr.next=9;break}return pr.abrupt("return");case 9:if(hn=v&&rr.length&&rr.length>(c||[]).length&&rr[rr.length-1]==fe&&!wi(fe,pe),Zr!="LOAD_MORE"){pr.next=17;break}return se(fe),Ie.current=!0,pr.next=15,it(fe,!0);case 15:pr.next=37;break;case 17:if(Zr!="LOADING_MORE"){pr.next=21;break}Ie.current=!0,pr.next=37;break;case 21:if(!v){pr.next=31;break}if(Gt=pb(rr,Te,s),Yt=_slicedToArray(Gt,2),Ut=Yt[0],Bt=Yt[1],d(Ut,r?Bt:void 0),!hn){pr.next=29;break}return pr.next=27,Sp(0);case 27:return pr.next=29,ur(null,"","my-reset");case 29:pr.next=37;break;case 31:if(Na=fb(rr,Te,s),Ft=_slicedToArray(Na,2),xi=Ft[0],vt=Ft[1],d(xi,r?vt:void 0),!(wt&&h)){pr.next=37;break}return pr.next=36,Sp(0);case 36:V(!1);case 37:case"end":return pr.stop()}},Ge)}));return function(Ue,rr,sr){return Gr.apply(this,arguments)}}(),ur=function(){var Gr=_asyncToGenerator(_regeneratorRuntime.mark(function Ge(Ue,rr,sr){var Or,Vr,xr;return _regeneratorRuntime.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:if(Or=m==="mui"&&sr==="reset",Vr=rr,!(Vr===b||Vr===S||Or)){Nr.next=4;break}return Nr.abrupt("return");case 4:if(rr==fe){Nr.next=13;break}if(se(Vr),xr=i&&(u?!!Vr:!0),!xr){Nr.next=12;break}return Nr.next=10,St(Vr);case 10:Nr.next=13;break;case 12:i&&u&&Ae([]);case 13:case"end":return Nr.stop()}},Ge)}));return function(Ue,rr,sr){return Gr.apply(this,arguments)}}(),Xr=function(Ge){var Ue=_toConsumableArray(Ge);return a&&(Tr?Ue.push({specialValue:"LOAD_MORE",title:b}):ae&&Ue.push({specialValue:"LOADING_MORE",title:S,disabled:!0})),Ue},Jr=function(Ge,Ue){if(Ue==null)return null;var rr=Ue.value!=null?Ue.value:Ue;return Ge.value===rr},_r=function(Ge){return Ge&&Ge.disabled},ft=function(Ge){var Ue;if(Ge!=null&&Ge.isCustom)return!0;var rr=(Ue=Ge?.value)!==null&&Ue!==void 0?Ue:Ge,sr=wi(rr,Te);return sr?.isCustom||!1},wn=function(Ge){if(Ge==null)return null;var Ue=Ge.value!=null?Ge:bp(wi(Ge,Te));return!Ue&&Ge.specialValue?Ge.title:!Ue&&s||!Ue?Ge.toString():Ue.title||Ue.label||Ue.value.toString()},pt=m==="mui"?vb(Pr):Pr;return{options:pt,listValues:Te,hasValue:ir,selectedListValue:at,open:D,onOpen:or,onClose:Lt,onDropdownVisibleChange:Vt,onChange:ot,inputValue:fe,onInputChange:ur,canShowLoadMore:Tr,isInitialLoading:Qe,isLoading:Je,isLoadingMore:ae,isSpecialValue:zr,extendOptions:Xr,getOptionSelected:Jr,getOptionDisabled:_r,getOptionIsCustom:ft,getOptionLabel:wn,aPlaceholder:C}};const jS=null;function Fp(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function Cp(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fp(Object(t),!0).forEach(function(r){(0,ne.A)(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Fp(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}const $n=Cp(Cp({},qe),{},{ReactUtils:ze,DragIcon:$d});var Tp=y(47232),yb=y(63383);const vu={add:"Add",remove:"Remove"},Ep={id:$n.uuid(),type:"group"},Ap="timeFilter",Lp=[Ap],Ob={...Kr.widgets,text:{...Kr.widgets.text,factory:function(e){return(0,k.jsx)(xn.p,{value:e?.value||"",placeholder:e?.placeholder,onChange:t=>e?.setValue(t.currentTarget.value)})}},number:{...Kr.widgets.number,factory:function(e){return(0,k.jsx)(xn.p,{value:e?.value,placeholder:e?.placeholder,type:"number",onChange:t=>e?.setValue(Number.parseInt(t.currentTarget.value,10))})}},datetime:{...Kr.widgets.datetime,factory:function(e){if(e?.operator==="macros")return(0,k.jsx)(Tt.l6,{id:e.id,"aria-label":"Macros value selector",menuShouldPortal:!0,options:Lp.map(Pe.z),value:e?.value,onChange:r=>e.setValue(r.value)});const t=(0,Tp.KQ)(e?.value).isValid()?(0,Tp.KQ)(e?.value).utc():void 0;return(0,k.jsx)(yb.K,{onChange:r=>{e?.setValue(r?.format(Kr.widgets.datetime.valueFormat))},date:t})},sqlFormatValue:(n,e,t,r,a,i)=>r==="macros"?Lp.includes(n)?n:void 0:typeof Kr.widgets.datetime.sqlFormatValue=="string"||typeof Kr.widgets.datetime.sqlFormatValue=="object"?void 0:Kr.widgets.datetime.sqlFormatValue?.call(Kr.ctx,n,e,t,r,a,i)||""}},bb={...Kr.settings,canRegroup:!1,maxNesting:1,canReorder:!1,showNot:!1,addRuleLabel:vu.add,deleteLabel:vu.remove,renderConjs:function(e){return(0,k.jsx)(Tt.l6,{id:e?.id,"aria-label":"Conjunction","data-testid":qr.Tp.components.SQLQueryEditor.filterConjunction,menuShouldPortal:!0,options:e?.conjunctionOptions?Object.keys(e?.conjunctionOptions).map(Pe.z):void 0,value:e?.selectedConjunction,onChange:t=>e?.setConjunction(t.value)})},renderField:function(e){const t=e?.config?.fields||{};return(0,k.jsx)(Tt.l6,{id:e?.id,width:25,"aria-label":"Field","data-testid":qr.Tp.components.SQLQueryEditor.filterField,menuShouldPortal:!0,options:e?.items.map(r=>{const a=t[r.key].mainWidgetProps?.customProps?.icon;return{label:r.label,value:r.key,icon:a}}),value:e?.selectedKey,onChange:r=>{e?.setField(r.label)}})},renderButton:function(e){return(0,k.jsx)(Kt.$n,{type:"button",title:`${e?.label} filter`,onClick:e?.onClick,variant:"secondary",size:"md",icon:e?.label===vu.add?"plus":"times"})},renderOperator:function(e){return(0,k.jsx)(Tt.l6,{options:e?.items.map(t=>({label:t.label,value:t.key})),"aria-label":"Operator","data-testid":qr.Tp.components.SQLQueryEditor.filterOperator,menuShouldPortal:!0,value:e?.selectedKey,onChange:t=>{e?.setField(t.value||"")}})}};var Sb=(n=>(n.IN="select_any_in",n.NOT_IN="select_not_any_in",n.MACROS="macros",n))(Sb||{});const Fb=Lb(Kr),wp=Kr.types.text.widgets.text,Cb=[...wp.operators||[],"select_any_in","select_not_any_in"],Tb={...wp,operators:Cb},Eb={...Kr.types,text:{...Kr.types.text,widgets:{...Kr.types.text.widgets,text:Tb}},datetime:{...Kr.types.datetime,widgets:{...Kr.types.datetime.widgets,datetime:{...Kr.types.datetime.widgets.datetime,operators:["macros",...Kr.types.datetime.widgets.datetime.operators||[]]}}}},Ab={...Kr,widgets:Ob,settings:bb,operators:Fb,types:Eb},jp=()=>"",Rp=n=>typeof n=="function";function Lb(n){const{...e}=n.operators,t=()=>{const o=e.select_any_in.sqlFormatOp;return Rp(o)?o:jp},r=(o,l,s,c,d,f,p,g)=>t()(o,l,Pp(s),c,d,f,p,g),a=()=>{const o=e.select_not_any_in.sqlFormatOp;return Rp(o)?o:jp},i=(o,l,s,c,d,f,p,g)=>a()(o,l,Pp(s),c,d,f,p,g);return{...e,select_any_in:{...e.select_any_in,sqlFormatOp:r},select_not_any_in:{...e.select_not_any_in,sqlFormatOp:i},macros:{label:"Macros",sqlFormatOp:(o,l,s)=>s===Ap?`$__timeFilter(${o})`:s}}}function Pp(n){return(0,Me.isString)(n)?n.split(","):n}function wb({sql:n,config:e,onSqlChange:t}){const[r,a]=(0,F.useState)(),i=(0,F.useMemo)(()=>({...Ab,...e}),[e]);(0,F.useEffect)(()=>{if(!r){const o=$n.checkTree($n.loadTree(n.whereJsonTree??Ep),i);a(o)}},[i,n.whereJsonTree,r]),(0,F.useEffect)(()=>{n.whereJsonTree||a($n.checkTree($n.loadTree(Ep),i))},[i,n.whereJsonTree]);const u=(0,F.useCallback)((o,l)=>{a(o);const s={...n,whereJsonTree:$n.getTree(o),whereString:$n.sqlFormat(o,l)};t(s)},[t,n]);return r?(0,k.jsx)(Vd,{...i,value:r,onChange:u,renderBuilder:o=>(0,k.jsx)(xO,{...o})}):null}function ji(n){return`
    display: flex;
    gap: 8px;
    flex-direction: ${n};`}(0,Qr.injectGlobal)`
  .group--header {
    ${ji("row")}
  }

  .group-or-rule {
    ${ji("column")}
    .rule {
      flex-direction: row;
    }
  }

  .rule--body {
    ${ji("row")}
  }

  .group--children {
    ${ji("column")}
  }

  .group--conjunctions:empty {
    display: none;
  }
`;function jb({query:n,fields:e,onQueryChange:t,db:r}){const a=(0,Mp.A)(async()=>Rb(e),[e]),{onSqlChange:i}=zt({query:n,onQueryChange:t,db:r});return(0,k.jsx)(wb,{config:{fields:a.value||{}},sql:n.sql,onSqlChange:u=>{const o=(0,Oe.w)().getVariables();Pb(u,o),i(u)}},JSON.stringify(a.value))}function Rb(n){const e={};for(const t of n)e[t.value]={type:t.raqbFieldType||"text",valueSources:["value"],mainWidgetProps:{customProps:{icon:t.icon}}};return e}function Pb(n,e){const t=r=>"multi"in r&&r.multi&&(n.whereString?.includes(`\${${r.name}}`)||n.whereString?.includes(`$${r.name}`));e.some(r=>t(r))&&(n.whereString=n.whereString?.replaceAll("')",")"),n.whereString=n.whereString?.replaceAll("('","("))}const xb=({query:n,db:e,queryRowFilter:t,onChange:r,onValidate:a,range:i})=>{const u=(0,er.A)(async()=>await e.fields(n),[e,n.dataset,n.table]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Mr.D,{children:[(0,k.jsx)(sn.U,{children:(0,k.jsx)(lt,{fields:u.value||[],query:n,onQueryChange:r,db:e})}),t.filter&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(Rt.c,{label:"Filter by column value",optional:!0,children:(0,k.jsx)(jb,{fields:u.value||[],query:n,onQueryChange:r,db:e})})}),t.group&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(Rt.c,{label:"Group by column",children:(0,k.jsx)(nt,{fields:u.value||[],query:n,onQueryChange:r,db:e})})}),t.order&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(ha,{fields:u.value||[],query:n,onQueryChange:r,db:e})}),t.preview&&n.rawSql&&(0,k.jsx)(sn.U,{children:(0,k.jsx)(Et.l,{rawSql:n.rawSql,datasourceType:n.datasource?.type})})]}),(0,k.jsx)(za,{db:e,query:n,onValidate:a,range:i})]})};function xp({datasource:n,query:e,onChange:t,onRunQuery:r,range:a,queryHeaderProps:i}){const[u,o]=(0,F.useState)(!0),l=n.getDB(),{preconfiguredDatabase:s}=n,c=i?.dialect??"other",{loading:d,error:f}=(0,er.A)(async()=>()=>{n.getDB(n.id).init!==void 0&&n.getDB(n.id).init()},[n]),p=ln(e),[g,v]=(0,F.useState)({filter:!!p.sql?.whereString,group:!!p.sql?.groupBy?.[0]?.property.name,order:!!p.sql?.orderBy?.property.name,preview:!0}),[m,h]=(0,F.useState)(p);(0,F.useEffect)(()=>()=>{n.getDB(n.id).dispose!==void 0&&n.getDB(n.id).dispose()},[n]);const O=(0,F.useCallback)(C=>{Ib(C)&&r&&r()},[r]),b=(C,L=!0)=>{h(C),t(C),Wt(C.sql?.columns)&&C.sql?.columns.some(w=>w.name)&&!g.group&&v({...g,group:!0}),L&&O(C)},S=C=>{h(C),t(C)};return d||f?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(_i,{db:l,preconfiguredDataset:s,onChange:S,onRunQuery:r,onQueryRowChange:v,queryRowFilter:g,query:p,isQueryRunnable:u,dialect:c}),(0,k.jsx)(gt.$,{v:.5}),p.editorMode!==fr.lX.Code&&(0,k.jsx)(xb,{db:l,query:p,onChange:C=>b(C,!1),queryRowFilter:g,onValidate:o,range:a}),p.editorMode===fr.lX.Code&&(0,k.jsx)(Bi,{db:l,query:p,queryToValidate:m,onChange:b,onRunQuery:r,onValidate:o,range:a})]})}const Ib=n=>!!n.rawSql;function Vb(n){const e=typeof n.rawQuery=="string"?n.rawQuery:null;if(!e)return n;const t=ln({refId:"Annotation",...n.target??{},rawSql:e});return{...n,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:t}}class Db extends ut.iy{constructor(e,t=(0,Oe.w)()){super(e),this.templateSrv=t,this.interpolateVariable=(a,i)=>typeof a=="string"?i.multi||i.includeAll?this.getQueryModel().quoteLiteral(a):String(a).replace(/'/g,"''"):typeof a=="number"?a:Array.isArray(a)?a.map(o=>this.getQueryModel().quoteLiteral(o)).join(","):a,this.name=e.name,this.responseParser=new ie,this.id=e.id;const r=e.jsonData||{};this.interval=r.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=r.database??"",this.annotations={prepareAnnotation:Vb,QueryEditor:xp}}getResponseParser(){return this.responseParser}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length>0&&(r=e.map(a=>({...a,datasource:this.getRef(),rawSql:this.templateSrv.replace(a.rawSql,t,this.interpolateVariable),rawQuery:!0}))),r}filterQuery(e){return!e.hide}applyTemplateVariables(e,t){return{refId:e.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,t,this.interpolateVariable),format:e.format}}query(e){if(Rn()){const t=this.checkForDatabaseIssue(e);if(t){const r=new Error(t);return(0,vr.$)(()=>r)}}return e.targets.forEach(t=>{e.app===gr.Jk.Dashboard||e.app===gr.Jk.PanelViewer||(0,ue.rR)("grafana_sql_query_executed",{datasource:t.datasource?.type,editorMode:t.editorMode,format:t.format,app:e.app})}),super.query(e)}checkForDatabaseIssue(e){if(this.type==="postgres"&&!this.preconfiguredDatabase)return`You do not currently have a default database configured for this data source. Postgres requires a default
             database with which to connect. Please configure one through the Data Sources Configuration page, or if you
             are using a provisioning file, update that configuration file with a default database.`;if(e.app!==gr.Jk.Explore&&this.preconfiguredDatabase){for(const t of e.targets)if(t.editorMode===fr.lX.Builder&&t.dataset!==this.preconfiguredDatabase)return`The configuration for this panel's data source has been modified. The previous database used in this panel's
                   saved query is no longer available. Please update the query to use the new database option.
                   Previous query parameters will be preserved until the query is updated.`}}async metricFindQuery(e,t){const r=t?.range;if(r==null)return[];let a="tempvar";t&&t.variable&&t.variable.name&&(a=t.variable.name);const i={...t?.scopedVars,...(0,et.c)({query:e,wildcardChar:"%",options:t})},u=this.templateSrv.replace(e,i,this.interpolateVariable),o={refId:a,datasource:this.getRef(),rawSql:u,format:ye.Table};let l;try{l=await this.runMetaQuery(o,r)}catch(s){throw console.error(s),new Error("error when executing the sql query")}return this.getResponseParser().transformMetricFindResponse(l)}async runSql(e,t){const r=(0,rt.E2)(),a=await this.runMetaQuery({rawSql:e,format:ye.Table,refId:t?.refId},r);return new jt.R(a)}runMetaQuery(e,t){const r=e.refId||"meta",a=[{...e,datasource:e.datasource||this.getRef(),refId:r}];return(0,$e.s)((0,de.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:t.from.valueOf().toString(),to:t.to.valueOf().toString(),queries:a},requestId:r}).pipe((0,Xe.T)(i=>(0,ke.bE)(i,a).data[0]??{fields:[]})))}targetContainsTemplate(e){let t=e.rawSql;return At.forEach(r=>{t=t?.replace(r,"")||""}),this.templateSrv.containsTemplate(t)}}var Nb=y(94471),kb=y(29020),Ri=y(88575),Pi=y(60029),Mb=y(76892);function gu({value:n,defaultValue:e,onChange:t,width:r}){const[a,i]=(0,F.useState)(!1);return(0,k.jsx)(xn.p,{type:"number",placeholder:String(e),value:a?"":n,onChange:u=>{if(u.currentTarget.value?.trim()==="")i(!0),t(e);else{i(!1);const o=Number(u.currentTarget.value);Number.isNaN(o)||t(o)}},width:r})}const _b=n=>{const{onOptionsChange:e,options:t}=n,r=t.jsonData,a=r.maxIdleConnsAuto!==void 0?r.maxIdleConnsAuto:!1,i=c=>{const d={...t,jsonData:{...r,...c}};return e(d)},u=c=>d=>{i({[c]:d})},o=c=>{i(a&&c?{maxOpenConns:c,maxIdleConns:c}:{maxOpenConns:c})},l=()=>{let c,d;a?(d=r.maxOpenConns,c=r.maxIdleConns):r.maxOpenConns!==void 0&&(d=r.maxOpenConns,c=r.maxOpenConns),i({maxIdleConnsAuto:!a,maxIdleConns:c,maxOpenConns:d})},s=40;return(0,k.jsxs)(kb.I,{title:"Connection limits",children:[(0,k.jsx)(Ri.D,{label:(0,k.jsx)(Pi.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Max open"}),(0,k.jsx)(cn.m,{content:(0,k.jsxs)("span",{children:["The maximum number of open connections to the database. If ",(0,k.jsx)("i",{children:"Max idle connections"})," is greater than 0 and the ",(0,k.jsx)("i",{children:"Max open connections"})," is less than ",(0,k.jsx)("i",{children:"Max idle connections"}),", then",(0,k.jsx)("i",{children:"Max idle connections"})," will be reduced to match the ",(0,k.jsx)("i",{children:"Max open connections"})," limit. If set to 0, there is no limit on the number of open connections."]}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,k.jsx)(gu,{value:r.maxOpenConns,defaultValue:fn.$.sqlConnectionLimits.maxOpenConns,onChange:c=>{o(c)},width:s})}),(0,k.jsx)(Ri.D,{label:(0,k.jsx)(Pi.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Auto max idle"}),(0,k.jsx)(cn.m,{content:(0,k.jsxs)("span",{children:["If enabled, automatically set the number of ",(0,k.jsx)("i",{children:"Maximum idle connections"})," to the same value as",(0,k.jsx)("i",{children:" Max open connections"}),". If the number of maximum open connections is not set it will be set to the default (",fn.$.sqlConnectionLimits.maxIdleConns,")."]}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,k.jsx)(bn.d,{value:a,onChange:l})}),(0,k.jsx)(Ri.D,{label:(0,k.jsx)(Pi.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Max idle"}),(0,k.jsx)(cn.m,{content:(0,k.jsxs)("span",{children:["The maximum number of connections in the idle connection pool.If ",(0,k.jsx)("i",{children:"Max open connections"})," is greater than 0 but less than the ",(0,k.jsx)("i",{children:"Max idle connections"}),", then the ",(0,k.jsx)("i",{children:"Max idle connections"})," ","will be reduced to match the ",(0,k.jsx)("i",{children:"Max open connections"})," limit. If set to 0, no idle connections are retained."]}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:a?(0,k.jsx)(Mb.c,{width:s,children:t.jsonData.maxIdleConns}):(0,k.jsx)(gu,{value:r.maxIdleConns,defaultValue:fn.$.sqlConnectionLimits.maxIdleConns,onChange:c=>{u("maxIdleConns")(c)},width:s})}),(0,k.jsx)(Ri.D,{label:(0,k.jsx)(Pi.J,{children:(0,k.jsxs)(G.B,{gap:.5,children:[(0,k.jsx)("span",{children:"Max lifetime"}),(0,k.jsx)(cn.m,{content:(0,k.jsx)("span",{children:"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever."}),children:(0,k.jsx)(dn.I,{name:"info-circle",size:"sm"})})]})}),children:(0,k.jsx)(gu,{value:r.connMaxLifetime,defaultValue:fn.$.sqlConnectionLimits.connMaxLifetime,onChange:c=>{u("connMaxLifetime")(c)},width:s})})]})},RS=()=>{const n=useStyles2(Gb);return jsx("hr",{className:n.horizontalDivider})},Gb=n=>({horizontalDivider:css({borderTop:`1px solid ${n.colors.border.weak}`,margin:n.spacing(2,0),width:"100%"})}),PS=n=>{const{editorProps:e,showCACert:t,showKeyPair:r=!0}=n,{secureJsonFields:a}=e.options;return jsxs(Fragment,{children:[r?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Client Certificate"}),jsx(Tooltip,{content:jsx("span",{children:"To authenticate with an TLS/SSL client certificate, provide the client certificate here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsClientCert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientCert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientCert")}})}):null,t?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Root Certificate"}),jsx(Tooltip,{content:jsx("span",{children:"If the selected TLS/SSL mode requires a server root certificate, provide it here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:a&&a.tlsCACert,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsCACert"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsCACert")}})}):null,r?jsx(Field,{label:jsx(Label,{children:jsxs(Stack,{gap:.5,children:[jsx("span",{children:"TLS/SSL Client Key"}),jsx(Tooltip,{content:jsx("span",{children:"To authenticate with a client TLS/SSL certificate, provide the key here."}),children:jsx(Icon,{name:"info-circle",size:"sm"})})]})}),children:jsx(SecretTextArea,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:a&&a.tlsClientKey,onChange:onUpdateDatasourceSecureJsonDataOption(e,"tlsClientKey"),onReset:()=>{updateDatasourcePluginResetOption(e,"tlsClientKey")}})}):null]})};var Ub=y(34867);const Ip=(0,Ub.DW)("features.plugins.sql");function Bb({onOptionsChange:n,options:e}){(0,F.useEffect)(()=>{const t=e.jsonData;let r={...e},a=!1;if(e.database&&(Ip.logDebug(`Migrating from options.database with value ${e.database} for ${e.name}`),r.database="",r.jsonData={...t,database:e.database},a=!0),t.maxOpenConns===void 0&&t.maxIdleConns===void 0&&t.maxIdleConnsAuto===void 0){const{maxOpenConns:i,maxIdleConns:u}=fn.$.sqlConnectionLimits;Ip.logDebug(`Setting default max open connections to ${i} and setting max idle connection to ${u}`),r.jsonData={...r.jsonData,maxOpenConns:i,maxIdleConns:u,maxIdleConnsAuto:!0},a=!0}if(t.connMaxLifetime===void 0){const{connMaxLifetime:i}=fn.$.sqlConnectionLimits;r.jsonData={...r.jsonData,connMaxLifetime:i},a=!0}a&&n(r)},[n,e])}},18678:function(xe,ve,y){var N,A;(function(x,$){N=$,A=typeof N=="function"?N.call(ve,y,ve,xe):N,A!==void 0&&(xe.exports=A)})(this,function(){"use strict";Array.isArray||(Array.isArray=function(T){return Object.prototype.toString.call(T)==="[object Array]"});function x(T){for(var E=[],I=0,j=T.length;I<j;I++)E.indexOf(T[I])===-1&&E.push(T[I]);return E}var $={},z={"==":function(T,E){return T==E},"===":function(T,E){return T===E},"!=":function(T,E){return T!=E},"!==":function(T,E){return T!==E},">":function(T,E){return T>E},">=":function(T,E){return T>=E},"<":function(T,E,I){return I===void 0?T<E:T<E&&E<I},"<=":function(T,E,I){return I===void 0?T<=E:T<=E&&E<=I},"!!":function(T){return $.truthy(T)},"!":function(T){return!$.truthy(T)},"%":function(T,E){return T%E},log:function(T){return console.log(T),T},in:function(T,E){return!E||typeof E.indexOf>"u"?!1:E.indexOf(T)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(T,E,I){if(I<0){var j=String(T).substr(E);return j.substr(0,j.length+I)}return String(T).substr(E,I)},"+":function(){return Array.prototype.reduce.call(arguments,function(T,E){return parseFloat(T,10)+parseFloat(E,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(T,E){return parseFloat(T,10)*parseFloat(E,10)})},"-":function(T,E){return E===void 0?-T:T-E},"/":function(T,E){return T/E},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(T,E){return T.concat(E)},[])},var:function(T,E){var I=E===void 0?null:E,j=this;if(typeof T>"u"||T===""||T===null)return j;for(var W=String(T).split("."),Y=0;Y<W.length;Y++)if(j==null||(j=j[W[Y]],j===void 0))return I;return j},missing:function(){for(var T=[],E=Array.isArray(arguments[0])?arguments[0]:arguments,I=0;I<E.length;I++){var j=E[I],W=$.apply({var:j},this);(W===null||W==="")&&T.push(j)}return T},missing_some:function(T,E){var I=$.apply({missing:E},this);return E.length-I.length>=T?[]:I}};return $.is_logic=function(T){return typeof T=="object"&&T!==null&&!Array.isArray(T)&&Object.keys(T).length===1},$.truthy=function(T){return Array.isArray(T)&&T.length===0?!1:!!T},$.get_operator=function(T){return Object.keys(T)[0]},$.get_values=function(T){return T[$.get_operator(T)]},$.apply=function(T,E){if(Array.isArray(T))return T.map(function(Ee){return $.apply(Ee,E)});if(!$.is_logic(T))return T;var I=$.get_operator(T),j=T[I],W,Y,ee,Q,Z;if(Array.isArray(j)||(j=[j]),I==="if"||I=="?:"){for(W=0;W<j.length-1;W+=2)if($.truthy($.apply(j[W],E)))return $.apply(j[W+1],E);return j.length===W+1?$.apply(j[W],E):null}else if(I==="and"){for(W=0;W<j.length;W+=1)if(Y=$.apply(j[W],E),!$.truthy(Y))return Y;return Y}else if(I==="or"){for(W=0;W<j.length;W+=1)if(Y=$.apply(j[W],E),$.truthy(Y))return Y;return Y}else{if(I==="filter")return Q=$.apply(j[0],E),ee=j[1],Array.isArray(Q)?Q.filter(function(Ee){return $.truthy($.apply(ee,Ee))}):[];if(I==="map")return Q=$.apply(j[0],E),ee=j[1],Array.isArray(Q)?Q.map(function(Ee){return $.apply(ee,Ee)}):[];if(I==="reduce")return Q=$.apply(j[0],E),ee=j[1],Z=typeof j[2]<"u"?j[2]:null,Array.isArray(Q)?Q.reduce(function(Ee,ze){return $.apply(ee,{current:ze,accumulator:Ee})},Z):Z;if(I==="all"){if(Q=$.apply(j[0],E),ee=j[1],!Array.isArray(Q)||!Q.length)return!1;for(W=0;W<Q.length;W+=1)if(!$.truthy($.apply(ee,Q[W])))return!1;return!0}else if(I==="none"){if(Q=$.apply(j[0],E),ee=j[1],!Array.isArray(Q)||!Q.length)return!0;for(W=0;W<Q.length;W+=1)if($.truthy($.apply(ee,Q[W])))return!1;return!0}else if(I==="some"){if(Q=$.apply(j[0],E),ee=j[1],!Array.isArray(Q)||!Q.length)return!1;for(W=0;W<Q.length;W+=1)if($.truthy($.apply(ee,Q[W])))return!0;return!1}}if(j=j.map(function(Ee){return $.apply(Ee,E)}),z.hasOwnProperty(I)&&typeof z[I]=="function")return z[I].apply(E,j);if(I.indexOf(".")>0){var ge=String(I).split("."),X=z;for(W=0;W<ge.length;W++){if(!X.hasOwnProperty(ge[W]))throw new Error("Unrecognized operation "+I+" (failed at "+ge.slice(0,W+1).join(".")+")");X=X[ge[W]]}return X.apply(E,j)}throw new Error("Unrecognized operation "+I)},$.uses_data=function(T){var E=[];if($.is_logic(T)){var I=$.get_operator(T),j=T[I];Array.isArray(j)||(j=[j]),I==="var"?E.push(j[0]):j.forEach(function(W){E.push.apply(E,$.uses_data(W))})}return x(E)},$.add_operation=function(T,E){z[T]=E},$.rm_operation=function(T){delete z[T]},$.rule_like=function(T,E){if(E===T||E==="@")return!0;if(E==="number")return typeof T=="number";if(E==="string")return typeof T=="string";if(E==="array")return Array.isArray(T)&&!$.is_logic(T);if($.is_logic(E)){if($.is_logic(T)){var I=$.get_operator(E),j=$.get_operator(T);if(I==="@"||I===j)return $.rule_like($.get_values(T,!1),$.get_values(E,!1))}return!1}if(Array.isArray(E))if(Array.isArray(T)){if(E.length!==T.length)return!1;for(var W=0;W<E.length;W+=1)if(!$.rule_like(T[W],E[W]))return!1;return!0}else return!1;return!1},$})},87805:(xe,ve,y)=>{var N=y(43360),A=y(75288);function x($,z,T){(T!==void 0&&!A($[z],T)||T===void 0&&!(z in $))&&N($,z,T)}xe.exports=x},85250:(xe,ve,y)=>{var N=y(37217),A=y(87805),x=y(86649),$=y(42824),z=y(23805),T=y(37241),E=y(14974);function I(j,W,Y,ee,Q){j!==W&&x(W,function(Z,ge){if(Q||(Q=new N),z(Z))$(j,W,ge,Y,I,ee,Q);else{var X=ee?ee(E(j,ge),Z,ge+"",j,W,Q):void 0;X===void 0&&(X=Z),A(j,ge,X)}},T)}xe.exports=I},42824:(xe,ve,y)=>{var N=y(87805),A=y(93290),x=y(71961),$=y(23007),z=y(35529),T=y(72428),E=y(56449),I=y(83693),j=y(3656),W=y(1882),Y=y(23805),ee=y(11331),Q=y(37167),Z=y(14974),ge=y(69884);function X(Ee,ze,Ye,_e,Pe,ye,Ze){var Be=Z(Ee,Ye),tr=Z(ze,Ye),vr=Ze.get(tr);if(vr){N(Ee,Ye,vr);return}var $e=ye?ye(Be,tr,Ye+"",Ee,ze,Ze):void 0,Xe=$e===void 0;if(Xe){var gr=E(tr),et=!gr&&j(tr),rt=!gr&&!et&&Q(tr);$e=tr,gr||et||rt?E(Be)?$e=Be:I(Be)?$e=$(Be):et?(Xe=!1,$e=A(tr,!0)):rt?(Xe=!1,$e=x(tr,!0)):$e=[]:ee(tr)||T(tr)?($e=Be,T(Be)?$e=ge(Be):(!Y(Be)||W(Be))&&($e=z(tr))):Xe=!1}Xe&&(Ze.set(tr,$e),Pe($e,tr,_e,ye,Ze),Ze.delete(tr)),N(Ee,Ye,$e)}xe.exports=X},69302:(xe,ve,y)=>{var N=y(83488),A=y(56757),x=y(32865);function $(z,T){return x(A(z,T,N),z+"")}xe.exports=$},20999:(xe,ve,y)=>{var N=y(69302),A=y(36800);function x($){return N(function(z,T){var E=-1,I=T.length,j=I>1?T[I-1]:void 0,W=I>2?T[2]:void 0;for(j=$.length>3&&typeof j=="function"?(I--,j):void 0,W&&A(T[0],T[1],W)&&(j=I<3?void 0:j,I=1),z=Object(z);++E<I;){var Y=T[E];Y&&$(z,Y,E,j)}return z})}xe.exports=x},14974:xe=>{function ve(y,N){if(!(N==="constructor"&&typeof y[N]=="function")&&N!="__proto__")return y[N]}xe.exports=ve},83693:(xe,ve,y)=>{var N=y(64894),A=y(40346);function x($){return A($)&&N($)}xe.exports=x},73916:(xe,ve,y)=>{var N=y(43360),A=y(30641),x=y(15389);function $(z,T){var E={};return T=x(T,3),A(z,function(I,j,W){N(E,j,T(I,j,W))}),E}xe.exports=$},55364:(xe,ve,y)=>{var N=y(85250),A=y(20999),x=A(function($,z,T){N($,z,T)});xe.exports=x},6924:(xe,ve,y)=>{var N=y(85250),A=y(20999),x=A(function($,z,T,E){N($,z,T,E)});xe.exports=x},71086:(xe,ve,y)=>{var N=y(34932),A=y(15389),x=y(97420),$=y(83349);function z(T,E){if(T==null)return{};var I=N($(T),function(j){return[j]});return E=A(E),x(T,I,function(j,W){return E(j,W[0])})}xe.exports=z},22331:(xe,ve,y)=>{var N=y(87133),A=y(77556),x=y(61489),$=y(13222);function z(T,E,I){return T=$(T),I=I==null?0:N(x(I),0,T.length),E=A(E),T.slice(I,I+E.length)==E}xe.exports=z},69884:(xe,ve,y)=>{var N=y(21791),A=y(37241);function x($){return N($,A($))}xe.exports=x},21450:function(xe){(function(y,N){xe.exports=N()})(this,function(){return function(ve){var y={};function N(A){if(y[A])return y[A].exports;var x=y[A]={i:A,l:!1,exports:{}};return ve[A].call(x.exports,x,x.exports,N),x.l=!0,x.exports}return N.m=ve,N.c=y,N.d=function(A,x,$){N.o(A,x)||Object.defineProperty(A,x,{configurable:!1,enumerable:!0,get:$})},N.n=function(A){var x=A&&A.__esModule?function(){return A.default}:function(){return A};return N.d(x,"a",x),x},N.o=function(A,x){return Object.prototype.hasOwnProperty.call(A,x)},N.p="",N(N.s=3)}([function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function A($,z){var T={},E=$||"Abstract",I=[],j=null,W;if(T._type=E,T.getType=function(){return E},T.setType=function(Z){E=Z},T.getChildren=function(){return I},T.addChild=function(Z){if(Z){if(!Z.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(Z)};Z.setParent(T),I.push(Z)}},T.getParent=function(){return j},T.setParent=function(Z){j=Z},T.getContext=function(Z){return W||Z.activeContext.peek()},T.setContext=function(Z){W=Z},T.getStartPosition=function(){return z>>16},T.getEndPosition=function(){return z&65535},T.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},T.toString=function(){var Z="Kind: "+T.getType();Z+=", Children: [";for(var ge=0,X=T.getChildren().length;ge<X;ge+=1)Z+="{"+T.getChildren()[ge]+"}, ";return Z+="]",Z},z===0)throw{name:"Error",message:"Position cannot be 0"};for(var Y=arguments.length,ee=Array(Y>2?Y-2:0),Q=2;Q<Y;Q++)ee[Q-2]=arguments[Q];return ee&&ee.forEach(function(Z){T.addChild(Z)}),T}var x=y.SpelNode={create:A}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Stack=A;function A(x){this.elements=x||[]}A.prototype.push=function(x){return this.elements.push(x),x},A.prototype.pop=function(){return this.elements.pop()},A.prototype.peek=function(){return this.elements[this.elements.length-1]},A.prototype.empty=function(){return this.elements.length>0},A.prototype.search=function(x){return this.elements.length-this.elements.indexOf(x)}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var A={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function x(z){this.type=z,this.tokenChars=A[z],this._hasPayload=typeof A[z]!="string",typeof A[z]=="number"&&(this._ordinal=A[z])}for(var $ in A)A.hasOwnProperty($)&&(x[$]=new x($));x.prototype.toString=function(){return this.type+(this.tokenChars.length!==0?"("+this.tokenChars+")":"")},x.prototype.getLength=function(){return this.tokenChars.length},x.prototype.hasPayload=function(){return this._hasPayload},x.prototype.valueOf=function(z){for(var T in A)if(A.hasOwnProperty(T)&&A[T]===z)return x[T]},x.prototype.ordinal=function(){return this._ordinal},y.TokenKind=x},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StandardContext=y.SpelExpressionEvaluator=void 0;var A=N(4),x=N(50);y.SpelExpressionEvaluator=A.SpelExpressionEvaluator,y.StandardContext=x.StandardContext},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionEvaluator=void 0;var A=N(5),x=N(1),$={};function z(T,E,I){var j=new x.Stack,W;return E||(E={}),j.push(E),W={rootContext:E,activeContext:j,locals:I},T.getValue(W)}$.compile=function(T){var E=(0,A.SpelExpressionParser)().parse(T);return{eval:function(j,W){return z(E,j,W)},_compiledExpression:E}},$.eval=function(T,E,I){return $.compile(T).eval(E,I)},y.SpelExpressionEvaluator=$},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.SpelExpressionParser=void 0;var A=N(2),x=N(6),$=N(8),z=N(9),T=N(10),E=N(11),I=N(12),j=N(13),W=N(14),Y=N(15),ee=N(16),Q=N(17),Z=N(18),ge=N(19),X=N(20),Ee=N(21),ze=N(22),Ye=N(23),_e=N(24),Pe=N(25),ye=N(26),Ze=N(27),Be=N(28),tr=N(29),vr=N(30),$e=N(31),Xe=N(32),gr=N(33),et=N(34),rt=N(35),jt=N(36),fr=N(37),ut=N(38),Oe=N(39),ue=N(40),de=N(41),ke=N(42),Me=N(43),ie=N(44),k=N(45),F=N(46),er=N(47),gt=N(48),Hr=N(49),br=y.SpelExpressionParser=function(){var Wt=new RegExp("[\\p{L}\\p{N}_$]+"),da,fa=[],On,ln,pa,qr;function Vi(G){da=G}function Di(G,re){try{On=G,ln=x.Tokenizer.tokenize(G),pa=ln.length,qr=0,fa=[];var be=tt();return Fn()&&nt(Ar().startPos,"MORE_INPUT",Sr().toString()),be}catch(He){throw He.message}}function tt(){var G=sn();if(Fn()){var re=Ar();if(re.getKind()===A.TokenKind.ASSIGN){G===null&&(G=E.NullLiteral.create(At(re.startPos-1,re.endPos-1))),Sr();var be=sn();return Z.Assign.create(We(re),G,be)}if(re.getKind()===A.TokenKind.ELVIS){G===null&&(G=E.NullLiteral.create(At(re.startPos-1,re.endPos-2))),Sr();var He=tt();return He===null&&(He=E.NullLiteral.create(At(re.startPos+1,re.endPos+1))),ut.Elvis.create(We(re),G,He)}if(re.getKind()===A.TokenKind.QMARK){G===null&&(G=E.NullLiteral.create(At(re.startPos-1,re.endPos-1))),Sr();var mt=tt();kr(A.TokenKind.COLON);var lt=tt();return fr.Ternary.create(We(re),G,mt,lt)}}return G}function sn(){for(var G=Rt();Pn("or")||Mr(A.TokenKind.SYMBOLIC_OR);){var re=Sr(),be=Rt();Wn(re,G,be),G=rt.OpOr.create(We(re),G,be)}return G}function Rt(){for(var G=bn();Pn("and")||Mr(A.TokenKind.SYMBOLIC_AND);){var re=Sr(),be=bn();Wn(re,G,be),G=et.OpAnd.create(We(re),G,be)}return G}function bn(){var G=Kt(),re=Bi();if(re!==null){var be=Sr(),He=Kt();Wn(be,G,He);var mt=re.kind;if(re.isNumericRelationalOperator()){var lt=We(be);return mt===A.TokenKind.GT?ze.OpGT.create(lt,G,He):mt===A.TokenKind.LT?_e.OpLT.create(lt,G,He):mt===A.TokenKind.LE?Ye.OpLE.create(lt,G,He):mt===A.TokenKind.GE?Ee.OpGE.create(lt,G,He):mt===A.TokenKind.EQ?ge.OpEQ.create(lt,G,He):X.OpNE.create(lt,G,He)}return mt===A.TokenKind.INSTANCEOF?Me.OpInstanceof.create(We(be),G,He):mt===A.TokenKind.MATCHES?jt.OpMatches.create(We(be),G,He):ie.OpBetween.create(We(be),G,He)}return G}function Kt(){for(var G=cn();zt(A.TokenKind.PLUS,A.TokenKind.MINUS,A.TokenKind.INC);){var re=Sr(),be=cn();ha(re,be),re.getKind()===A.TokenKind.PLUS?G=Pe.OpPlus.create(We(re),G,be):re.getKind()===A.TokenKind.MINUS&&(G=ye.OpMinus.create(We(re),G,be))}return G}function cn(){for(var G=va();zt(A.TokenKind.STAR,A.TokenKind.DIV,A.TokenKind.MOD);){var re=Sr(),be=va();Wn(re,G,be),re.getKind()===A.TokenKind.STAR?G=Ze.OpMultiply.create(We(re),G,be):re.getKind()===A.TokenKind.DIV?G=Be.OpDivide.create(We(re),G,be):G=tr.OpModulus.create(We(re),G,be)}return G}function va(){var G=Qr(),re;if(Mr(A.TokenKind.POWER)){re=Sr();var be=Qr();return ha(re,be),vr.OpPower.create(We(re),G,be)}return G!==null&&zt(A.TokenKind.INC,A.TokenKind.DEC)?(re=Sr(),re.getKind()===A.TokenKind.INC?$e.OpInc.create(We(re),!0,G):Xe.OpDec.create(We(re),!0,G)):G}function Qr(){var G,re;return zt(A.TokenKind.PLUS,A.TokenKind.MINUS,A.TokenKind.NOT)?(G=Sr(),re=Qr(),G.getKind()===A.TokenKind.NOT?gr.OpNot.create(We(G),re):G.getKind()===A.TokenKind.PLUS?Pe.OpPlus.create(We(G),re):ye.OpMinus.create(We(G),re)):zt(A.TokenKind.INC,A.TokenKind.DEC)?(G=Sr(),re=Qr(),G.getKind()===A.TokenKind.INC?$e.OpInc.create(We(G),!1,re):Xe.OpDec.create(We(G),!1,re)):Sn()}function Sn(){var G=[],re=ki();for(G.push(re);ga();)G.push(Nt());return G.length===1?G[0]:ee.CompoundExpression.create(At(re.getStartPosition(),G[G.length-1].getEndPosition()),G)}function ga(){var G=null;return zt(A.TokenKind.DOT,A.TokenKind.SAFE_NAVI)?G=Ni():G=dn(),G===null?!1:(Er(G),!0)}function dn(){return Mr(A.TokenKind.LSQUARE)&&Ba()?Nt():null}function Ni(){var G=Sr(),re=G.getKind()===A.TokenKind.SAFE_NAVI;return Wa(re)||Ma()||Ga(re)||$a(re)?Nt():(Ar()===null?nt(G.startPos,"OOD"):nt(G.startPos,"UNEXPECTED_DATA_AFTER_DOT",xn(Ar())),null)}function Ma(){if(!Mr(A.TokenKind.HASH))return!1;var G=Sr(),re=kr(A.TokenKind.IDENTIFIER),be=Tt();return be===null?(Er(Y.VariableReference.create(re.data,At(G.startPos,re.endPos))),!0):(Er(I.FunctionReference.create(re.data,At(G.startPos,re.endPos),be)),!0)}function Tt(){if(!Mr(A.TokenKind.LPAREN))return null;var G=[];return Rn(G),kr(A.TokenKind.RPAREN),G}function fn(G){Mr(A.TokenKind.LPAREN)||nt(We(Ar()),"MISSING_CONSTRUCTOR_ARGS"),Rn(G),kr(A.TokenKind.RPAREN)}function Rn(G){var re=Ar().startPos,be;do{Sr();var He=Ar();He===null&&nt(re,"RUN_OUT_OF_ARGUMENTS"),He.getKind()!==A.TokenKind.RPAREN&&G.push(tt()),be=Ar()}while(be!==null&&be.kind===A.TokenKind.COMMA);be===null&&nt(re,"RUN_OUT_OF_ARGUMENTS")}function mu(G){return G===null?On.length:G.startPos}function ki(){return Ui()||za()||_i()||_a()||Ka()||Wa(!1)||Ma()||Mi()||Ga(!1)||$a(!1)||Ba()||Ua()?Nt():null}function Mi(){if(Mr(A.TokenKind.BEAN_REF)){var G=Sr(),re=null,be=null;Mr(A.TokenKind.IDENTIFIER)?(re=kr(A.TokenKind.IDENTIFIER),be=re.data):Mr(A.TokenKind.LITERAL_STRING)?(re=kr(A.TokenKind.LITERAL_STRING),be=re.stringValue(),be=be.substring(1,be.length()-1)):nt(G.startPos,"INVALID_BEAN_REFERENCE");var He=F.BeanReference.create(We(re),be);return Er(He),!0}return!1}function _i(){if(Mr(A.TokenKind.IDENTIFIER)){var G=Ar();if(G.stringValue()!=="T")return!1;var re=Sr();if(Mr(A.TokenKind.RSQUARE))return Er(W.PropertyReference.create(re.stringValue(),We(re))),!0;kr(A.TokenKind.LPAREN);for(var be=ma(),He=0;Et(A.TokenKind.LSQUARE,!0);)kr(A.TokenKind.RSQUARE),He++;return kr(A.TokenKind.RPAREN),Er(k.TypeReference.create(We(G),be,He)),!0}return!1}function _a(){if(Mr(A.TokenKind.IDENTIFIER)){var G=Ar();return G.stringValue().toLowerCase()!=="null"?!1:(Sr(),Er(E.NullLiteral.create(We(G))),!0)}return!1}function Ga(G){var re=Ar();if(!Et(A.TokenKind.PROJECT,!0))return!1;var be=tt();return kr(A.TokenKind.RSQUARE),Er(ke.Projection.create(G,We(re),be)),!0}function Ua(){var G=Ar(),re=[];if(!Et(A.TokenKind.LCURLY,!0))return!1;var be=null,He=Ar();if(Et(A.TokenKind.RCURLY,!0))be=Oe.InlineList.create(At(G.startPos,He.endPos));else if(Et(A.TokenKind.COLON,!0))He=kr(A.TokenKind.RCURLY),be=ue.InlineMap.create(At(G.startPos,He.endPos));else{var mt=tt();if(Mr(A.TokenKind.RCURLY))re.push(mt),He=kr(A.TokenKind.RCURLY),be=Oe.InlineList.create(At(G.startPos,He.endPos),re);else if(Et(A.TokenKind.COMMA,!0)){re.push(mt);do re.push(tt());while(Et(A.TokenKind.COMMA,!0));He=kr(A.TokenKind.RCURLY),be=Oe.InlineList.create(We(G.startPos,He.endPos),re)}else if(Et(A.TokenKind.COLON,!0)){var lt=[];for(lt.push(mt),lt.push(tt());Et(A.TokenKind.COMMA,!0);)lt.push(tt()),kr(A.TokenKind.COLON),lt.push(tt());He=kr(A.TokenKind.RCURLY),be=ue.InlineMap.create(At(G.startPos,He.endPos),lt)}else nt(G.startPos,"OOD")}return Er(be),!0}function Ba(){var G=Ar();if(!Et(A.TokenKind.LSQUARE,!0))return!1;var re=tt();return kr(A.TokenKind.RSQUARE),Er(Q.Indexer.create(We(G),re)),!0}function $a(G){var re=Ar();if(!Ha())return!1;Sr();var be=tt();return be===null&&nt(We(re),"MISSING_SELECTION_EXPRESSION"),kr(A.TokenKind.RSQUARE),re.getKind()===A.TokenKind.SELECT_FIRST?Er(de.Selection.create(G,de.Selection.FIRST,We(re),be)):re.getKind()===A.TokenKind.SELECT_LAST?Er(de.Selection.create(G,de.Selection.LAST,We(re),be)):Er(de.Selection.create(G,de.Selection.ALL,We(re),be)),!0}function ma(){for(var G=[],re=Ar();Gi(re);)Sr(),re.kind!==A.TokenKind.DOT&&G.push(er.Identifier.create(re.stringValue(),We(re))),re=Ar();G.length||(re===null&&nt(On.length(),"OOD"),nt(re.startPos,"NOT_EXPECTED_TOKEN","qualified ID",re.getKind().toString().toLowerCase()));var be=At(G[0].getStartPosition(),G[G.length-1].getEndPosition());return gt.QualifiedIdentifier.create(be,G)}function Gi(G){if(G===null||G.kind===A.TokenKind.LITERAL_STRING)return!1;if(G.kind===A.TokenKind.DOT||G.kind===A.TokenKind.IDENTIFIER)return!0;var re=G.stringValue();return re&&re.length&&Wt.test(re)}function Wa(G){if(Mr(A.TokenKind.IDENTIFIER)){var re=Sr(),be=Tt();return be===null?(Er(W.PropertyReference.create(G,re.stringValue(),We(re))),!0):(Er(j.MethodReference.create(G,re.stringValue(),We(re),be)),!0)}return!1}function Ka(){if(Pn("new")){var G=Sr();if(Mr(A.TokenKind.RSQUARE))return Er(W.PropertyReference.create(G.stringValue(),We(G))),!0;var re=ma(),be=[];if(be.push(re),Mr(A.TokenKind.LSQUARE)){for(var He=[];Et(A.TokenKind.LSQUARE,!0);)Mr(A.TokenKind.RSQUARE)?He.push(null):He.push(tt()),kr(A.TokenKind.RSQUARE);Ua()&&be.push(Nt()),Er(Hr.ConstructorReference.create(We(G),He,be))}else fn(be),Er(Hr.ConstructorReference.create(We(G),be));return!0}return!1}function Er(G){fa.push(G)}function Nt(){return fa.pop()}function Ui(){var G=Ar();if(G===null)return!1;if(G.getKind()===A.TokenKind.LITERAL_INT||G.getKind()===A.TokenKind.LITERAL_LONG)Er(z.NumberLiteral.create(parseInt(G.stringValue(),10),We(G)));else if(G.getKind()===A.TokenKind.LITERAL_REAL||G.getKind()===A.TokenKind.LITERAL_REAL_FLOAT)Er(z.NumberLiteral.create(parseFloat(G.stringValue()),We(G)));else if(G.getKind()===A.TokenKind.LITERAL_HEXINT||G.getKind()===A.TokenKind.LITERAL_HEXLONG)Er(z.NumberLiteral.create(parseInt(G.stringValue(),16),We(G)));else if(Pn("true"))Er($.BooleanLiteral.create(!0,We(G)));else if(Pn("false"))Er($.BooleanLiteral.create(!1,We(G)));else if(G.getKind()===A.TokenKind.LITERAL_STRING)Er(T.StringLiteral.create(G.stringValue(),We(G)));else return!1;return Sr(),!0}function za(){if(Mr(A.TokenKind.LPAREN)){Sr();var G=tt();return kr(A.TokenKind.RPAREN),Er(G),!0}else return!1}function Bi(){var G=Ar();if(G===null)return null;if(G.isNumericRelationalOperator())return G;if(G.isIdentifier()){var re=G.stringValue();if(re.toLowerCase()==="instanceof")return G.asInstanceOfToken();if(re.toLowerCase()==="matches")return G.asMatchesToken();if(re.toLowerCase()==="between")return G.asBetweenToken()}return null}function kr(G){var re=Sr();return re===null&&nt(On.length,"OOD"),re.getKind()!==G&&nt(re.startPos,"NOT_EXPECTED_TOKEN",G.toString().toLowerCase(),re.getKind().toString().toLowerCase()),re}function Mr(G){return Et(G,!1)}function Et(G,re){if(!Fn())return!1;var be=Ar();return be.getKind()===G?(re&&qr++,!0):G===A.TokenKind.IDENTIFIER&&be.getKind().ordinal()>=A.TokenKind.DIV.ordinal()&&be.getKind().ordinal()<=A.TokenKind.NOT.ordinal()&&be.data!==null}function zt(){if(!Fn())return!1;for(var G=Ar(),re=Array.prototype.slice.call(arguments),be=0,He=re.length;be<He;be+=1)if(G.getKind()===re[be])return!0;return!1}function Pn(G){if(!Fn())return!1;var re=Ar();return re.getKind()===A.TokenKind.IDENTIFIER&&re.stringValue().toLowerCase()===G.toLowerCase()}function Ha(){if(!Fn())return!1;var G=Ar();return G.getKind()===A.TokenKind.SELECT||G.getKind()===A.TokenKind.SELECT_FIRST||G.getKind()===A.TokenKind.SELECT_LAST}function Fn(){return qr<ln.length}function Sr(){return qr>=pa?null:ln[qr++]}function Ar(){return qr>=pa?null:ln[qr]}function nt(G,re,be,He){throw be&&(re+=`
Expected: `+be),He&&(re+=`
Actual: `+He),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+On+"' at position "+G+". Message: "+re}}function xn(G){return G.getKind().hasPayload()?G.stringValue():G.getKind().toString().toLowerCase()}function Wn(G,re,be){$i(G,re),ha(G,be)}function $i(G,re){re===null&&nt(G.startPos,"LEFT_OPERAND_PROBLEM")}function ha(G,re){re===null&&nt(G.startPos,"RIGHT_OPERAND_PROBLEM")}function We(G){return(G.startPos<<16)+G.endPos}function At(G,re){return(G<<16)+re}return{setConfiguration:Vi,parse:Di}}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Tokenizer=void 0;var A=N(7),x=N(2),$=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],z=[],T=1,E=2,I=4;function j(){var ee;for(ee=48;ee<=57;ee+=1)z[ee]|=T|E;for(ee=65;ee<=70;ee+=1)z[ee]|=E;for(ee=97;ee<=102;ee+=1)z[ee]|=E;for(ee=65;ee<=90;ee+=1)z[ee]|=I;for(ee=97;ee<=122;ee+=1)z[ee]|=I}j();function W(ee){var Q=ee,Z=ee+"\0",ge=Z.length,X=0,Ee=[];function ze(){for(var ie;X<ge;)if(ie=Z[X],ke(ie))ye();else switch(ie){case"+":$e(x.TokenKind.INC)?gr(x.TokenKind.INC):Xe(x.TokenKind.PLUS);break;case"_":ye();break;case"-":$e(x.TokenKind.DEC)?gr(x.TokenKind.DEC):Xe(x.TokenKind.MINUS);break;case":":Xe(x.TokenKind.COLON);break;case".":Xe(x.TokenKind.DOT);break;case",":Xe(x.TokenKind.COMMA);break;case"*":Xe(x.TokenKind.STAR);break;case"/":Xe(x.TokenKind.DIV);break;case"%":Xe(x.TokenKind.MOD);break;case"(":Xe(x.TokenKind.LPAREN);break;case")":Xe(x.TokenKind.RPAREN);break;case"[":Xe(x.TokenKind.LSQUARE);break;case"#":Xe(x.TokenKind.HASH);break;case"]":Xe(x.TokenKind.RSQUARE);break;case"{":Xe(x.TokenKind.LCURLY);break;case"}":Xe(x.TokenKind.RCURLY);break;case"@":Xe(x.TokenKind.BEAN_REF);break;case"^":$e(x.TokenKind.SELECT_FIRST)?gr(x.TokenKind.SELECT_FIRST):Xe(x.TokenKind.POWER);break;case"!":$e(x.TokenKind.NE)?gr(x.TokenKind.NE):$e(x.TokenKind.PROJECT)?gr(x.TokenKind.PROJECT):Xe(x.TokenKind.NOT);break;case"=":$e(x.TokenKind.EQ)?gr(x.TokenKind.EQ):Xe(x.TokenKind.ASSIGN);break;case"&":if(!$e(x.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+Q+") at position "+X};gr(x.TokenKind.SYMBOLIC_AND);break;case"|":if(!$e(x.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+Q+") at position "+X};gr(x.TokenKind.SYMBOLIC_OR);break;case"?":$e(x.TokenKind.SELECT)?gr(x.TokenKind.SELECT):$e(x.TokenKind.ELVIS)?gr(x.TokenKind.ELVIS):$e(x.TokenKind.SAFE_NAVI)?gr(x.TokenKind.SAFE_NAVI):Xe(x.TokenKind.QMARK);break;case"$":$e(x.TokenKind.SELECT_LAST)?gr(x.TokenKind.SELECT_LAST):ye();break;case">":$e(x.TokenKind.GE)?gr(x.TokenKind.GE):Xe(x.TokenKind.GT);break;case"<":$e(x.TokenKind.LE)?gr(x.TokenKind.LE):Xe(x.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Pe(ie==="0");break;case" ":case"	":case"\r":case`
`:X+=1;break;case"'":Ye();break;case'"':_e();break;case"\0":X+=1;break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+Q+") at position "+X};default:throw{name:"SpelParseException",message:"Cannot handle character '"+ie+"' in expression ("+Q+") at position "+X}}}function Ye(){for(var ie=X,k=!1,F;!k;)if(X+=1,F=Z[X],F==="'"&&(Z[X+1]==="'"?X+=1:k=!0),F.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+Q+") at position "+X};X+=1,Ee.push(new A.Token(x.TokenKind.LITERAL_STRING,vr(ie,X),ie,X))}function _e(){for(var ie=X,k=!1,F;!k;)if(X+=1,F=Z[X],F==='"'&&(Z[X+1]==='"'?X+=1:k=!0),F.charCodeAt(0)===0)throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+Q+") at position "+X};X+=1,Ee.push(new A.Token(x.TokenKind.LITERAL_STRING,vr(ie,X),ie,X))}function Pe(ie){var k=!1,F=X,er=Z[X+1],gt=er==="x"||er==="X",Hr,br,ca,Wt;if(ie&&gt){X=X+1;do X+=1;while(Me(Z[X]));jt("L","l")?(Be(vr(F+2,X),!0,F,X),X+=1):Be(vr(F+2,X),!1,F,X);return}do X+=1;while(de(Z[X]));if(er=Z[X],er==="."){k=!0,Hr=X;do X+=1;while(de(Z[X]));if(X===Hr+1){X=Hr,Ze(vr(F,X),!1,F,X);return}}if(br=X,jt("L","l")){if(k)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+Q+") at position "+X};Ze(vr(F,br),!0,F,br),X+=1}else if(fr(Z[X])){k=!0,X+=1,ca=Z[X],ue(ca)&&(X+=1);do X+=1;while(de(Z[X]));Wt=!1,ut(Z[X])?(Wt=!0,X+=1,br=X):Oe(Z[X])&&(X+=1,br=X),tr(vr(F,X),Wt,F,X)}else er=Z[X],Wt=!1,ut(er)?(k=!0,Wt=!0,X+=1,br=X):Oe(er)&&(k=!0,X+=1,br=X),k?tr(vr(F,br),Wt,F,br):Ze(vr(F,br),!1,F,br)}function ye(){var ie=X,k,F,er;do X+=1;while(rt(Z[X]));if(k=vr(ie,X),(X-ie===2||X-ie===3)&&(F=k.toUpperCase(),er=$.indexOf(F),er>=0)){et(x.TokenKind.valueOf(F),ie,k);return}Ee.push(new A.Token(x.TokenKind.IDENTIFIER,k.replace("\0",""),ie,X))}function Ze(ie,k,F,er){k?Ee.push(new A.Token(x.TokenKind.LITERAL_LONG,ie,F,er)):Ee.push(new A.Token(x.TokenKind.LITERAL_INT,ie,F,er))}function Be(ie,k,F,er){if(ie.length===0)throw k?{name:"SpelParseException",message:"Not a long in expression ("+Q+") at position "+X}:{name:"SpelParseException",message:"Not an int in expression ("+Q+") at position "+X};k?Ee.push(new A.Token(x.TokenKind.LITERAL_HEXLONG,ie,F,er)):Ee.push(new A.Token(x.TokenKind.LITERAL_HEXINT,ie,F,er))}function tr(ie,k,F,er){k?Ee.push(new A.Token(x.TokenKind.LITERAL_REAL_FLOAT,ie,F,er)):Ee.push(new A.Token(x.TokenKind.LITERAL_REAL,ie,F,er))}function vr(ie,k){return Z.substring(ie,k)}function $e(ie){return ie.tokenChars.length===2&&Z[X]===ie.tokenChars[0]?Z[X+1]===ie.tokenChars[1]:!1}function Xe(ie){Ee.push(new A.Token(ie,null,X,X+1)),X+=1}function gr(ie){Ee.push(new A.Token(ie,null,X,X+2)),X+=2}function et(ie,k,F){Ee.push(new A.Token(ie,F,k,k+ie.getLength()))}function rt(ie){return ke(ie)||de(ie)||ie==="_"||ie==="$"}function jt(ie,k){var F=Z[X];return F===ie||F===k}function fr(ie){return ie==="e"||ie==="E"}function ut(ie){return ie==="f"||ie==="F"}function Oe(ie){return ie==="d"||ie==="D"}function ue(ie){return ie==="+"||ie==="-"}function de(ie){return ie.charCodeAt(0)>255?!1:(z[ie.charCodeAt(0)]&T)!==0}function ke(ie){return ie.charCodeAt(0)>255?!1:(z[ie.charCodeAt(0)]&I)!==0}function Me(ie){return ie.charCodeAt(0)>255?!1:(z[ie.charCodeAt(0)]&E)!==0}return ze(),Ee}var Y=y.Tokenizer={tokenize:W}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Token=void 0;var A=N(2);function x($,z,T,E){this.kind=$,this.startPos=T,this.endPos=E,z&&(this.data=z)}x.prototype.getKind=function(){return this.kind},x.prototype.toString=function(){var $="[";return $+=this.kind.toString(),this.kind.hasPayload()&&($+=":"+this.data),$+="]",$+="("+this.startPos+","+this.endPos+")",$},x.prototype.isIdentifier=function(){return this.kind===A.TokenKind.IDENTIFIER},x.prototype.isNumericRelationalOperator=function(){return this.kind===A.TokenKind.GT||this.kind===A.TokenKind.GE||this.kind===A.TokenKind.LT||this.kind===A.TokenKind.LE||this.kind===A.TokenKind.EQ||this.kind===A.TokenKind.NE},x.prototype.stringValue=function(){return this.data},x.prototype.asInstanceOfToken=function(){return new x(A.TokenKind.INSTANCEOF,this.startPos,this.endPos)},x.prototype.asMatchesToken=function(){return new x(A.TokenKind.MATCHES,this.startPos,this.endPos)},x.prototype.asBetweenToken=function(){return new x(A.TokenKind.BETWEEN,this.startPos,this.endPos)},x.prototype.getStartPosition=function(){return this.startPos},x.prototype.getEndPosition=function(){return this.endPos},y.Token=x},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BooleanLiteral=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("boolean",T);return E.getValue=function(){return z},E.setValue=function(I){return z=I},E}var $=y.BooleanLiteral={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NumberLiteral=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("number",T);return E.getValue=function(){return z},E.setValue=function(I){return z=I},E}var $=y.NumberLiteral={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.StringLiteral=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("string",T);function I(j){return(j[0]==="'"&&j[j.length-1]==="'"||j[0]==='"'&&j[j.length-1]==='"')&&(j=j.substring(1,j.length-1)),j.replace(/''/g,"'").replace(/""/g,'"')}return z=I(z),E.getValue=function(){return z},E.setValue=function(j){return z=j},E}var $=y.StringLiteral={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.NullLiteral=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("null",T);return E.getValue=function(){return null},E}var $=y.NullLiteral={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.FunctionReference=void 0;var A=N(0),x=N(1);function $(T,E,I){var j=A.SpelNode.create("function",E);return j.getRaw=function(){return{functionName:T,args:I}},j.getValue=function(W){var Y=W.locals||{},ee=W.rootContext,Q=[];if(I.forEach(function(Z){var ge=W.activeContext;W.activeContext=new x.Stack,W.activeContext.push(W.rootContext),Q.push(Z.getValue(W)),W.activeContext=ge}),Y[T])return Y[T].apply(ee,Q);throw{name:"FunctionDoesNotExistException",message:"Function '"+T+"' does not exist."}},j}var z=y.FunctionReference={create:$}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MethodReference=void 0;var A=N(0),x=N(1);function $(T,E,I,j){var W=A.SpelNode.create("method",I);return W.getRaw=function(){return{methodName:E,args:j}},W.getValue=function(Y){var ee=Y.activeContext.peek(),Q=[],Z;if(!ee)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+E+"' for an undefined context."};function ge(X){if(X==null){if(T)return null;throw{name:"NullPointerException",message:"Method "+E+" does not exist."}}return X}if(j.forEach(function(X){var Ee=Y.activeContext;Y.activeContext=new x.Stack,Y.activeContext.push(Y.rootContext),Q.push(X.getValue(Y)),Y.activeContext=Ee}),E.substr(0,3)==="get"&&!ee[E])return ge(ee[E.charAt(3).toLowerCase()+E.substring(4)]);if(E.substr(0,3)==="set"&&!ee[E])return ee[E.charAt(3).toLowerCase()+E.substring(4)]=Q[0];if(Array.isArray(ee)){if(E==="size")return ee.length;if(E==="contains")return ee.includes(Q[0])}return Z=ge(ee[E]),Z?Z.apply(ee,Q):null},W}var z=y.MethodReference={create:$}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.PropertyReference=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("property",E);return I.getRaw=function(){return T},I.getValue=function(j){var W=j.activeContext.peek();if(!W){if(z)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+T+"' for an undefined context."}}if(W[T]===void 0||W[T]===null){if(z)return null;if(T==="size"&&Array.isArray(W))return W.length;throw{name:"NullPointerException",message:"Property '"+T+"' does not exist."}}return W[T]},I.setValue=function(j,W){var Y=W.activeContext.peek();if(!Y)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+T+"' for an undefined context."};return Y[T]=j},I.getName=function(){return T},I}var $=y.PropertyReference={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.VariableReference=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("variable",T);return E.getRaw=function(){return z},E.getValue=function(I){var j=I.activeContext.peek(),W=I.locals;if(!j)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+z+"' for an undefined context."};return z==="this"?j:z==="root"?I.rootContext:W[z]},E.setValue=function(I,j){var W=j.locals;return W[z]=I},E}var $=y.VariableReference={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.CompoundExpression=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create.apply(null,["compound",z].concat(T));function I(j){var W=E.getChildren().length,Y;for(Y=0;Y<W;Y+=1)E.getChildren()[Y].getType()==="indexer"?j.activeContext.push(j.activeContext.peek()[E.getChildren()[Y].getValue(j)]):j.activeContext.push(E.getChildren()[Y].getValue(j));return function(){for(Y=0;Y<W;Y+=1)j.activeContext.pop()}}return E.getValue=function(j){var W=j.activeContext.peek(),Y;if(!W)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var ee=I(j);return Y=j.activeContext.peek(),ee(),Y},E.setValue=function(j,W){var Y=I(W),ee=E.getChildren().length;return W.activeContext.pop(),j=E.getChildren()[ee-1].setValue(j,W),W.activeContext.push(null),Y(),j},E}var $=y.CompoundExpression={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Indexer=void 0;var A=N(0),x=N(1);function $(T,E){var I=A.SpelNode.create.apply(null,["indexer",T].concat(E));return I.getValue=function(j){var W=j.activeContext,Y,ee=I.getChildren().length,Q,Z;if(j.activeContext=new x.Stack,j.activeContext.push(j.rootContext),Y=j.activeContext.peek(),!Y)throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(Q=0;Q<ee;Q+=1)j.activeContext.push(I.getChildren()[Q].getValue(j));for(Z=j.activeContext.peek(),Q=0;Q<ee;Q+=1)j.activeContext.pop();return j.activeContext=W,Z},I}var z=y.Indexer={create:$}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Assign=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("assign",z,T,E);return I.getValue=function(j){var W=j.activeContext.peek();if(!W)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+T.getValue(j)+"' for an undefined context."};return T.setValue(E.getValue(j),j)},I}var $=y.Assign={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpEQ=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-eq",z,T,E);return I.getValue=function(j){return T.getValue(j)===E.getValue(j)},I}var $=y.OpEQ={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNE=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-ne",z,T,E);return I.getValue=function(j){return T.getValue(j)!==E.getValue(j)},I}var $=y.OpNE={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGE=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-ge",z,T,E);return I.getValue=function(j){return T.getValue(j)>=E.getValue(j)},I}var $=y.OpGE={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpGT=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-gt",z,T,E);return I.getValue=function(j){return T.getValue(j)>E.getValue(j)},I}var $=y.OpGT={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLE=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-le",z,T,E);return I.getValue=function(j){return T.getValue(j)<=E.getValue(j)},I}var $=y.OpLE={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpLT=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-lt",z,T,E);return I.getValue=function(j){return T.getValue(j)<E.getValue(j)},I}var $=y.OpLT={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPlus=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-plus",z,T,E);return I.getValue=function(j){return E?T.getValue(j)+E.getValue(j):+T.getValue(j)},I}var $=y.OpPlus={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMinus=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-minus",z,T,E);return I.getValue=function(j){return E?T.getValue(j)-E.getValue(j):-T.getValue(j)},I}var $=y.OpMinus={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMultiply=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-multiply",z,T,E);return I.getValue=function(j){var W=T.getValue(j),Y=E.getValue(j);if(typeof W=="number"&&typeof Y=="number")return W*Y;if(typeof W=="string"&&typeof Y=="number"){for(var ee="",Q=0;Q<Y;Q+=1)ee+=W;return ee}return null},I}var $=y.OpMultiply={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDivide=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-divide",z,T,E);return I.getValue=function(j){return T.getValue(j)/E.getValue(j)},I}var $=y.OpDivide={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpModulus=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-modulus",z,T,E);return I.getValue=function(j){return T.getValue(j)%E.getValue(j)},I}var $=y.OpModulus={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpPower=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-power",z,T,E);return I.getValue=function(j){return Math.pow(T.getValue(j),E.getValue(j))},I}var $=y.OpPower={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInc=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-inc",z,E);return I.getValue=function(j){var W=E.getValue(j);return E.setValue(W+1,j),T?W:W+1},I}var $=y.OpInc={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpDec=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-dec",z,E);return I.getValue=function(j){var W=E.getValue(j);return E.setValue(W-1,j),T?W:W-1},I}var $=y.OpDec={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpNot=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("op-not",z,T);return E.getValue=function(I){return!T.getValue(I)},E}var $=y.OpNot={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpAnd=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-and",z,T,E);return I.getValue=function(j){return!!T.getValue(j)&&!!E.getValue(j)},I}var $=y.OpAnd={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpOr=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("op-or",z,T,E);return I.getValue=function(j){return!!T.getValue(j)||!!E.getValue(j)},I}var $=y.OpOr={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpMatches=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("matches",z,T,E);return I.getValue=function(j){var W=T.getValue(j),Y=E.getValue(j);try{var ee=new RegExp(Y);return!!ee.exec(W)}catch(Q){throw{name:"EvaluationException",message:Q.toString()}}},I}var $=y.OpMatches={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Ternary=void 0;var A=N(0);function x(z,T,E,I){var j=A.SpelNode.create("ternary",z,T,E,I);return j.getValue=function(W){return T.getValue(W)?E.getValue(W):I.getValue(W)},j}var $=y.Ternary={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Elvis=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("elvis",z,T,E);return I.getValue=function(j){return T.getValue(j)!==null?T.getValue(j):E.getValue(j)},I}var $=y.Elvis={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineList=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("list",z),I=[].concat(T||[]);return E.getRaw=function(){return I},E.getValue=function(j){return I.map(function(W){return W.getValue(j)})},E}var $=y.InlineList={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.InlineMap=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("map",z),I=[].concat(T||[]);return E.getValue=function(j){var W=!0,Y=null,ee={};return I.forEach(function(Q){W?Q.getType()==="property"?Y=Q.getName():Y=Q.getValue(j):ee[Y]=Q.getValue(j),W=!W}),ee},E}var $=y.InlineMap={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Selection=void 0;var A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},x=N(0);function $(j,W,Y){var ee=!1;return Y.activeContext.push(j),ee=W.getValue(Y),Y.activeContext.pop(),ee}function z(j,W,Y,ee){var Q=j.filter(function(Z){return $(Z,Y,ee)});switch(W){case"ALL":return Q;case"FIRST":return Q[0]||null;case"LAST":return Q.length?Q[Q.length-1]:null}}function T(j,W,Y,ee){var Q={},Z,ge,X=[],Ee={};for(ge in j)j.hasOwnProperty(ge)&&(Z={key:ge,value:j[ge]},$(Z,Y,ee)&&X.push(Z));switch(W){case"ALL":return X.forEach(function(ze){Q[ze.key]=ze.value}),Q;case"FIRST":return X.length?(Ee[X[0].key]=X[0].value,Ee):null;case"LAST":return X.length?(Ee[X[X.length-1].key]=X[X.length-1].value,Ee):null}X.forEach(function(ze){Q[ze.key]=ze.value})}function E(j,W,Y,ee){var Q=x.SpelNode.create("selection",Y,ee);return Q.getValue=function(Z){var ge=Z.activeContext.peek();if(ge){if(Array.isArray(ge))return z(ge,W,ee,Z);if((typeof ge>"u"?"undefined":A(ge))==="object")return T(ge,W,ee,Z)}return null},Q}var I=y.Selection={create:E,FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Projection=void 0;var A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},x=N(0);function $(E,I,j){return E.map(function(W){var Y;return j.activeContext.push(W),Y=I.getValue(j),j.activeContext.pop(),Y})}function z(E,I,j){var W=x.SpelNode.create("projection",I,j);return W.getValue=function(Y){var ee=Y.activeContext.peek(),Q=[],Z;if(Array.isArray(ee))return $(ee,j,Y);if((typeof ee>"u"?"undefined":A(ee))==="object"){for(Z in ee)ee.hasOwnProperty(Z)&&Q.push(ee[Z]);return $(Q,j,Y)}return null},W}var T=y.Projection={create:z}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpInstanceof=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("instanceof",z,T,E);return I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},I}var $=y.OpInstanceof={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.OpBetween=void 0;var A=N(0);function x(z,T,E){var I=A.SpelNode.create("between",z,T,E);return I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},I}var $=y.OpBetween={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.TypeReference=void 0;var A=N(0);function x(z,I,E){var I=A.SpelNode.create("typeref",z,I);return I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},I}var $=y.TypeReference={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BeanReference=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("beanref",z);return E.getValue=function(I){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},E}var $=y.BeanReference={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Identifier=void 0;var A=N(0);function x(z,T){var E=A.SpelNode.create("identifier",T);return E.getRaw=function(){return z},E.getValue=function(I){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},E}var $=y.Identifier={create:x}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.QualifiedIdentifier=void 0;var A=N(0);function x(T){if(Array.isArray(T)){for(var E=0,I=Array(T.length);E<T.length;E++)I[E]=T[E];return I}else return Array.from(T)}function $(T,E){var I=A.SpelNode.create.apply(A.SpelNode,["qualifiedidentifier",T].concat(x(E)));return I.getRaw=function(){return E.map(function(j){return j.getRaw()})},I.getValue=function(j){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},I}var z=y.QualifiedIdentifier={create:$}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ConstructorReference=void 0;var A=N(0),x=N(1);function $(I){if(Array.isArray(I)){for(var j=0,W=Array(I.length);j<I.length;j++)W[j]=I[j];return W}else return Array.from(I)}function z(I){return Array.isArray(I)?I:Array.from(I)}function T(I,j,W){var Y=W!==void 0,ee;Y?ee=j.length&&j[0]&&j[0].getType()==="number"?j[0].getValue():null:(W=j,j=void 0);var Q=W,Z=z(Q),ge=Z[0],X=Z.slice(1),Ee=A.SpelNode.create.apply(A.SpelNode,["constructorref",I].concat($(W)));return Ee.getRaw=function(){return ee},Ee.getValue=function(ze){if(Y&&X.length<=1){var Ye=[];return X.forEach(function(_e){var Pe=ze.activeContext;ze.activeContext=new x.Stack,ze.activeContext.push(ze.rootContext),Ye.push(_e.getValue(ze)),ze.activeContext=Pe}),X.length===1?Ye[0]:ee?new Array(ee):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},Ee}var E=y.ConstructorReference={create:T}},function(ve,y,N){"use strict";Object.defineProperty(y,"__esModule",{value:!0});function A($,z){var T={};return T.authentication=$||{},T.principal=z||{},T.hasRole=function(E){var I=!1;return!E||!T.authentication&&!Array.isArray(T.authentication.authorities)?!1:(T.authentication.authorities.forEach(function(j){j.authority.toLowerCase()===E.toLowerCase()&&(I=!0)}),I)},T.hasPermission=function(){var E=Array.prototype.slice.call(arguments);if(E.length===1)return T.hasRole(E[0])},T}var x=y.StandardContext={create:A}}])})},61526:(xe,ve,y)=>{xe.exports=y(88319)},88319:(xe,ve,y)=>{var N=y(48287).Buffer,A=ve,x=/`/g,$=/\./g,z=/[\0\b\t\n\r\x1a\"\'\\]/g,T={"\0":"\\0","\b":"\\b","	":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};A.escapeId=function(Y,ee){if(Array.isArray(Y)){for(var Q="",Z=0;Z<Y.length;Z++)Q+=(Z===0?"":", ")+A.escapeId(Y[Z],ee);return Q}else return ee?"`"+String(Y).replace(x,"``")+"`":"`"+String(Y).replace(x,"``").replace($,"`.`")+"`"},A.escape=function(Y,ee,Q){if(Y==null)return"NULL";switch(typeof Y){case"boolean":return Y?"true":"false";case"number":return Y+"";case"object":return Object.prototype.toString.call(Y)==="[object Date]"?A.dateToString(Y,Q||"local"):Array.isArray(Y)?A.arrayToList(Y,Q):N.isBuffer(Y)?A.bufferToString(Y):typeof Y.toSqlString=="function"?String(Y.toSqlString()):ee?E(Y.toString()):A.objectToValues(Y,Q);default:return E(Y)}},A.arrayToList=function(Y,ee){for(var Q="",Z=0;Z<Y.length;Z++){var ge=Y[Z];Array.isArray(ge)?Q+=(Z===0?"":", ")+"("+A.arrayToList(ge,ee)+")":Q+=(Z===0?"":", ")+A.escape(ge,!0,ee)}return Q},A.format=function(Y,ee,Q,Z){if(ee==null)return Y;Array.isArray(ee)||(ee=[ee]);for(var ge=0,X=/\?+/g,Ee="",ze=0,Ye;ze<ee.length&&(Ye=X.exec(Y));){var _e=Ye[0].length;if(!(_e>2)){var Pe=_e===2?A.escapeId(ee[ze]):A.escape(ee[ze],Q,Z);Ee+=Y.slice(ge,Ye.index)+Pe,ge=X.lastIndex,ze++}}return ge===0?Y:ge<Y.length?Ee+Y.slice(ge):Ee},A.dateToString=function(Y,ee){var Q=new Date(Y);if(isNaN(Q.getTime()))return"NULL";var Z,ge,X,Ee,ze,Ye,_e;if(ee==="local")Z=Q.getFullYear(),ge=Q.getMonth()+1,X=Q.getDate(),Ee=Q.getHours(),ze=Q.getMinutes(),Ye=Q.getSeconds(),_e=Q.getMilliseconds();else{var Pe=j(ee);Pe!==!1&&Pe!==0&&Q.setTime(Q.getTime()+Pe*6e4),Z=Q.getUTCFullYear(),ge=Q.getUTCMonth()+1,X=Q.getUTCDate(),Ee=Q.getUTCHours(),ze=Q.getUTCMinutes(),Ye=Q.getUTCSeconds(),_e=Q.getUTCMilliseconds()}var ye=I(Z,4)+"-"+I(ge,2)+"-"+I(X,2)+" "+I(Ee,2)+":"+I(ze,2)+":"+I(Ye,2)+"."+I(_e,3);return E(ye)},A.bufferToString=function(Y){return"X"+E(Y.toString("hex"))},A.objectToValues=function(Y,ee){var Q="";for(var Z in Y){var ge=Y[Z];typeof ge!="function"&&(Q+=(Q.length===0?"":", ")+A.escapeId(Z)+" = "+A.escape(ge,!0,ee))}return Q},A.raw=function(Y){if(typeof Y!="string")throw new TypeError("argument sql must be a string");return{toSqlString:function(){return Y}}};function E(W){for(var Y=z.lastIndex=0,ee="",Q;Q=z.exec(W);)ee+=W.slice(Y,Q.index)+T[Q[0]],Y=z.lastIndex;return Y===0?"'"+W+"'":Y<W.length?"'"+ee+W.slice(Y)+"'":"'"+ee+"'"}function I(W,Y){for(W=W.toString();W.length<Y;)W="0"+W;return W}function j(W){if(W==="Z")return 0;var Y=W.match(/([\+\-\s])(\d\d):?(\d\d)?/);return Y?(Y[1]==="-"?-1:1)*(parseInt(Y[2],10)+(Y[3]?parseInt(Y[3],10):0)/60)*60:!1}},4633:(xe,ve,y)=>{var N=y(73738).default;function A(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */xe.exports=A=function(){return $},xe.exports.__esModule=!0,xe.exports.default=xe.exports;var x,$={},z=Object.prototype,T=z.hasOwnProperty,E=Object.defineProperty||function(Oe,ue,de){Oe[ue]=de.value},I=typeof Symbol=="function"?Symbol:{},j=I.iterator||"@@iterator",W=I.asyncIterator||"@@asyncIterator",Y=I.toStringTag||"@@toStringTag";function ee(Oe,ue,de){return Object.defineProperty(Oe,ue,{value:de,enumerable:!0,configurable:!0,writable:!0}),Oe[ue]}try{ee({},"")}catch{ee=function(de,ke,Me){return de[ke]=Me}}function Q(Oe,ue,de,ke){var Me=ue&&ue.prototype instanceof _e?ue:_e,ie=Object.create(Me.prototype),k=new fr(ke||[]);return E(ie,"_invoke",{value:gr(Oe,de,k)}),ie}function Z(Oe,ue,de){try{return{type:"normal",arg:Oe.call(ue,de)}}catch(ke){return{type:"throw",arg:ke}}}$.wrap=Q;var ge="suspendedStart",X="suspendedYield",Ee="executing",ze="completed",Ye={};function _e(){}function Pe(){}function ye(){}var Ze={};ee(Ze,j,function(){return this});var Be=Object.getPrototypeOf,tr=Be&&Be(Be(ut([])));tr&&tr!==z&&T.call(tr,j)&&(Ze=tr);var vr=ye.prototype=_e.prototype=Object.create(Ze);function $e(Oe){["next","throw","return"].forEach(function(ue){ee(Oe,ue,function(de){return this._invoke(ue,de)})})}function Xe(Oe,ue){function de(Me,ie,k,F){var er=Z(Oe[Me],Oe,ie);if(er.type!=="throw"){var gt=er.arg,Hr=gt.value;return Hr&&N(Hr)=="object"&&T.call(Hr,"__await")?ue.resolve(Hr.__await).then(function(br){de("next",br,k,F)},function(br){de("throw",br,k,F)}):ue.resolve(Hr).then(function(br){gt.value=br,k(gt)},function(br){return de("throw",br,k,F)})}F(er.arg)}var ke;E(this,"_invoke",{value:function(ie,k){function F(){return new ue(function(er,gt){de(ie,k,er,gt)})}return ke=ke?ke.then(F,F):F()}})}function gr(Oe,ue,de){var ke=ge;return function(Me,ie){if(ke===Ee)throw Error("Generator is already running");if(ke===ze){if(Me==="throw")throw ie;return{value:x,done:!0}}for(de.method=Me,de.arg=ie;;){var k=de.delegate;if(k){var F=et(k,de);if(F){if(F===Ye)continue;return F}}if(de.method==="next")de.sent=de._sent=de.arg;else if(de.method==="throw"){if(ke===ge)throw ke=ze,de.arg;de.dispatchException(de.arg)}else de.method==="return"&&de.abrupt("return",de.arg);ke=Ee;var er=Z(Oe,ue,de);if(er.type==="normal"){if(ke=de.done?ze:X,er.arg===Ye)continue;return{value:er.arg,done:de.done}}er.type==="throw"&&(ke=ze,de.method="throw",de.arg=er.arg)}}}function et(Oe,ue){var de=ue.method,ke=Oe.iterator[de];if(ke===x)return ue.delegate=null,de==="throw"&&Oe.iterator.return&&(ue.method="return",ue.arg=x,et(Oe,ue),ue.method==="throw")||de!=="return"&&(ue.method="throw",ue.arg=new TypeError("The iterator does not provide a '"+de+"' method")),Ye;var Me=Z(ke,Oe.iterator,ue.arg);if(Me.type==="throw")return ue.method="throw",ue.arg=Me.arg,ue.delegate=null,Ye;var ie=Me.arg;return ie?ie.done?(ue[Oe.resultName]=ie.value,ue.next=Oe.nextLoc,ue.method!=="return"&&(ue.method="next",ue.arg=x),ue.delegate=null,Ye):ie:(ue.method="throw",ue.arg=new TypeError("iterator result is not an object"),ue.delegate=null,Ye)}function rt(Oe){var ue={tryLoc:Oe[0]};1 in Oe&&(ue.catchLoc=Oe[1]),2 in Oe&&(ue.finallyLoc=Oe[2],ue.afterLoc=Oe[3]),this.tryEntries.push(ue)}function jt(Oe){var ue=Oe.completion||{};ue.type="normal",delete ue.arg,Oe.completion=ue}function fr(Oe){this.tryEntries=[{tryLoc:"root"}],Oe.forEach(rt,this),this.reset(!0)}function ut(Oe){if(Oe||Oe===""){var ue=Oe[j];if(ue)return ue.call(Oe);if(typeof Oe.next=="function")return Oe;if(!isNaN(Oe.length)){var de=-1,ke=function Me(){for(;++de<Oe.length;)if(T.call(Oe,de))return Me.value=Oe[de],Me.done=!1,Me;return Me.value=x,Me.done=!0,Me};return ke.next=ke}}throw new TypeError(N(Oe)+" is not iterable")}return Pe.prototype=ye,E(vr,"constructor",{value:ye,configurable:!0}),E(ye,"constructor",{value:Pe,configurable:!0}),Pe.displayName=ee(ye,Y,"GeneratorFunction"),$.isGeneratorFunction=function(Oe){var ue=typeof Oe=="function"&&Oe.constructor;return!!ue&&(ue===Pe||(ue.displayName||ue.name)==="GeneratorFunction")},$.mark=function(Oe){return Object.setPrototypeOf?Object.setPrototypeOf(Oe,ye):(Oe.__proto__=ye,ee(Oe,Y,"GeneratorFunction")),Oe.prototype=Object.create(vr),Oe},$.awrap=function(Oe){return{__await:Oe}},$e(Xe.prototype),ee(Xe.prototype,W,function(){return this}),$.AsyncIterator=Xe,$.async=function(Oe,ue,de,ke,Me){Me===void 0&&(Me=Promise);var ie=new Xe(Q(Oe,ue,de,ke),Me);return $.isGeneratorFunction(ue)?ie:ie.next().then(function(k){return k.done?k.value:ie.next()})},$e(vr),ee(vr,Y,"Generator"),ee(vr,j,function(){return this}),ee(vr,"toString",function(){return"[object Generator]"}),$.keys=function(Oe){var ue=Object(Oe),de=[];for(var ke in ue)de.push(ke);return de.reverse(),function Me(){for(;de.length;){var ie=de.pop();if(ie in ue)return Me.value=ie,Me.done=!1,Me}return Me.done=!0,Me}},$.values=ut,fr.prototype={constructor:fr,reset:function(ue){if(this.prev=0,this.next=0,this.sent=this._sent=x,this.done=!1,this.delegate=null,this.method="next",this.arg=x,this.tryEntries.forEach(jt),!ue)for(var de in this)de.charAt(0)==="t"&&T.call(this,de)&&!isNaN(+de.slice(1))&&(this[de]=x)},stop:function(){this.done=!0;var ue=this.tryEntries[0].completion;if(ue.type==="throw")throw ue.arg;return this.rval},dispatchException:function(ue){if(this.done)throw ue;var de=this;function ke(gt,Hr){return k.type="throw",k.arg=ue,de.next=gt,Hr&&(de.method="next",de.arg=x),!!Hr}for(var Me=this.tryEntries.length-1;Me>=0;--Me){var ie=this.tryEntries[Me],k=ie.completion;if(ie.tryLoc==="root")return ke("end");if(ie.tryLoc<=this.prev){var F=T.call(ie,"catchLoc"),er=T.call(ie,"finallyLoc");if(F&&er){if(this.prev<ie.catchLoc)return ke(ie.catchLoc,!0);if(this.prev<ie.finallyLoc)return ke(ie.finallyLoc)}else if(F){if(this.prev<ie.catchLoc)return ke(ie.catchLoc,!0)}else{if(!er)throw Error("try statement without catch or finally");if(this.prev<ie.finallyLoc)return ke(ie.finallyLoc)}}}},abrupt:function(ue,de){for(var ke=this.tryEntries.length-1;ke>=0;--ke){var Me=this.tryEntries[ke];if(Me.tryLoc<=this.prev&&T.call(Me,"finallyLoc")&&this.prev<Me.finallyLoc){var ie=Me;break}}ie&&(ue==="break"||ue==="continue")&&ie.tryLoc<=de&&de<=ie.finallyLoc&&(ie=null);var k=ie?ie.completion:{};return k.type=ue,k.arg=de,ie?(this.method="next",this.next=ie.finallyLoc,Ye):this.complete(k)},complete:function(ue,de){if(ue.type==="throw")throw ue.arg;return ue.type==="break"||ue.type==="continue"?this.next=ue.arg:ue.type==="return"?(this.rval=this.arg=ue.arg,this.method="return",this.next="end"):ue.type==="normal"&&de&&(this.next=de),Ye},finish:function(ue){for(var de=this.tryEntries.length-1;de>=0;--de){var ke=this.tryEntries[de];if(ke.finallyLoc===ue)return this.complete(ke.completion,ke.afterLoc),jt(ke),Ye}},catch:function(ue){for(var de=this.tryEntries.length-1;de>=0;--de){var ke=this.tryEntries[de];if(ke.tryLoc===ue){var Me=ke.completion;if(Me.type==="throw"){var ie=Me.arg;jt(ke)}return ie}}throw Error("illegal catch attempt")},delegateYield:function(ue,de,ke){return this.delegate={iterator:ut(ue),resultName:de,nextLoc:ke},this.method==="next"&&(this.arg=x),Ye}},$}xe.exports=A,xe.exports.__esModule=!0,xe.exports.default=xe.exports},73738:xe=>{function ve(y){"@babel/helpers - typeof";return xe.exports=ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},xe.exports.__esModule=!0,xe.exports.default=xe.exports,ve(y)}xe.exports=ve,xe.exports.__esModule=!0,xe.exports.default=xe.exports},54756:(xe,ve,y)=>{var N=y(4633)();xe.exports=N;try{regeneratorRuntime=N}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=N:Function("r","regeneratorRuntime = r")(N)}}}]);

//# sourceMappingURL=7774.427e42f25cd582437729.js.map