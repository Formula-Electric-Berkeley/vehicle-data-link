(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1359],{76287:(k,A,e)=>{"use strict";e.d(A,{p:()=>r});var n=e(74848),s=e(96540),l=e(94841);function r(i){const{children:g,instanceSettings:o}=i,d=(0,s.useMemo)(()=>({instanceSettings:o,meta:o.meta}),[o]);return(0,n.jsx)(l.o.Provider,{value:d,children:g})}},94841:(k,A,e)=>{"use strict";e.d(A,{o:()=>s});var n=e(96540);const s=(0,n.createContext)(void 0)},13834:(k,A,e)=>{"use strict";e.d(A,{a:()=>l});var n=e(74848),s=e(94841);function l(r){const{children:i,...g}=r;return(0,n.jsx)(s.o.Provider,{value:g,children:i})}},95187:(k,A,e)=>{"use strict";e.d(A,{S:()=>n});function n(s){return"instanceSettings"in s&&"meta"in s}},92470:(k,A,e)=>{"use strict";e.d(A,{Q:()=>l});var n=e(96540),s=e(94841);function l(){const r=(0,n.useContext)(s.o);if(!r)throw new Error("usePluginContext must be used within a PluginContextProvider");return r}},33948:(k,A,e)=>{"use strict";e.d(A,{I:()=>r,f:()=>l});var n=e(11261),s=e(14236);class l{constructor(d,c){return this.fields=[],this.length=0,r(d,c)}}function r(o,d){const c={fields:[],length:o.length};if(!o?.length)return c;if(d){if(!g(o))throw new Error("source is not an array of objects");for(const p of d)c.fields.push(i(p,o.map(u=>u&&u[p])));return c}if(o.find(p=>p)===null)return c;if(g(o)){const p=o.find(u=>u);c.fields=Object.keys(p||{}).map(u=>i(u,o.map(m=>m&&m[u])))}else c.fields.push(i(n.Bc,o));return c}function i(o,d){const c={name:o,config:{},values:d,type:n.PU.other};return c.type=(0,s.dF)(c)??n.PU.other,c}function g(o){const d=o.find(c=>c);return o.length>0&&typeof d=="object"}},33526:(k,A,e)=>{"use strict";e.d(A,{x:()=>l});var n=e(36120),s=e(37471);class l extends s.k{constructor(i){super(void 0,g=>new n.$({...i,buffer:g}))}}},89667:(k,A,e)=>{"use strict";e.d(A,{EL:()=>i,Nw:()=>d,or:()=>o,t:()=>r});var n=e(11261),s=e(14236);const l={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function r(c,a){let p;for(p in c){const u=l[p];for(const m of c[p])m<a.length&&(a[m]=u)}}function i(c,a){for(let p=0;p<a.length;p++)a[p]=c[Number(a[p])]}function g(c,a){for(const p of a)if(p!=null)return(0,s.by)(c,p);return n.PU.other}function o(c){const{schema:a,data:p}=c;if(!a||!a.fields)throw new Error("JSON needs a fields definition");const u=p?p.values.reduce((v,x)=>Math.max(v,x.length),0):0,m=a.fields.map((v,x)=>{let f=p?p.values[x]:[],E=f.length,h=v.type;E!==u&&(f.length=u,f.fill(void 0,E));let y=p?.entities?.[x];y&&r(y,f);let b=p?.enums?.[x];b&&(i(b,f),h=n.PU.string);const D=p?.nanos?.[x],P={...v,type:h??g(v.name,f),config:v.config??{},values:f,entities:y??{}};return D!=null&&(P.nanos=D),P});return{...a,fields:m,length:u}}function d(c){const a={values:[]},p=[];let u=!1;const m={refId:c.refId,meta:c.meta,name:c.name,fields:c.fields.map(v=>{const{values:x,nanos:f,state:E,display:h,...y}=v;return"entities"in y&&delete y.entities,a.values.push(x),f!=null?(p.push(f),u=!0):p.push(null),y})};return u&&(a.nanos=p),{schema:m,data:a}}},78368:(k,A,e)=>{"use strict";e.d(A,{R:()=>s});var n=e(18008);class s extends n.F{constructor(r){super(),this.data=r,this.index=0;const i={},g={};for(let o=0;o<r.fields.length;o++){const d=r.fields[o];if(!d.name)continue;g[d.name]=d;const c=()=>d.values.get(this.index);i.hasOwnProperty(d.name)||Object.defineProperty(i,d.name,{enumerable:!0,get:c}),i.hasOwnProperty(o.toString())||Object.defineProperty(i,o,{enumerable:!1,get:c})}this.obj=i,this.fields=g}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(r){if(!this.dataFrame||!this.dataFrame.fields)return;const i=this.dataFrame.fields[r];if(!(!i||!i.display))return i.display}get(r){return this.index=r,this.obj}toArray(){return new Array(this.data.length).fill(0).map((r,i)=>({...this.get(i)}))}}},85404:(k,A,e)=>{"use strict";e.d(A,{L:()=>l});var n=e(11261),s=e(14236);class l{constructor(i){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=i.fields.map((g,o)=>({...g,index:o}));for(let g=0;g<i.fields.length;g++){const o=i.fields[g];if(o.type===n.PU.other){const d=(0,s.dF)(o);d&&(o.type=d)}this.fieldByType[o.type]||(this.fieldByType[o.type]=[]),this.fieldByType[o.type].push({...o,index:g}),this.fieldByName[o.name]?console.warn("Duplicate field names in DataFrame: ",o.name):this.fieldByName[o.name]={...o,index:g}}}getFields(i){if(!i)return[...this.fields];const g=this.fieldByType[i];return g?[...g]:[]}hasFieldOfType(i){const g=this.fieldByType[i];return g&&g.length>0}getFirstFieldOfType(i,g=!1){return this.fieldByType[i]?.find(c=>g||!c.config.custom?.hidden)}hasFieldNamed(i){return!!this.fieldByName[i]}hasFieldWithNameAndType(i,g){return!!this.fieldByName[i]&&this.fieldByType[g].filter(o=>o.name===i).length>0}getFieldByName(i){return this.fieldByName[i]}getFieldsByLabel(i,g){return Object.values(this.fieldByName).filter(o=>o.labels&&o.labels[i]===g)}}},37471:(k,A,e)=>{"use strict";e.d(A,{p:()=>g,k:()=>o});var n=e(2543),s=e(11261),l=e(14236);function r(d,c){return c.type||(c.name==="time"||c.name==="Time"?c.type=s.PU.time:c.type=(0,l.HW)(d)),c.type===s.PU.number?a=>parseFloat(a):c.type===s.PU.boolean?a=>!(a[0]==="F"||a[0]==="f"||a[0]==="0"):a=>a}var i=e(18008);const g=void 0;class o extends i.F{constructor(c,a){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=a||(p=>p??[]),c){const{name:p,refId:u,meta:m,fields:v}=c;if(p&&(this.name=p),u&&(this.refId=u),m&&(this.meta=m),v)for(const x of v)this.addField(x)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(c,a){return this.addField({name:a||"",type:(0,l.HW)(c)})}addField(c,a){let p;c.values&&(p=c.values);let u=c.type;!u&&(c.name==="time"||c.name==="Time")?u=s.PU.time:(!u&&p&&p.length&&(u=(0,l.HW)(p[0])),u||(u=s.PU.other));let m=c.name;m||(m=`Field ${this.fields.length+1}`);const v={...c,name:m,type:u,config:c.config||{},values:this.creator(p)};if(u===s.PU.other&&(u=(0,l.dF)(v),u&&(v.type=u)),this.fields.push(v),this.first=this.fields[0].values,a)for(;v.values.length<a;)v.values.push(g);else this.validate();return v}validate(){const c=this.fields.reduce((a,p)=>Math.max(a,p.values.length),0);for(const a of this.fields)for(;a.values.length!==c;)a.values.push(g)}setParser(c,a){return this.parsers||(this.parsers=new Map),this.parsers.set(c,a),a}parseValue(c,a){let p=this.parsers?.get(c);return p||(p=this.setParser(c,r(a,c))),p(a)}appendRow(c){for(let a=this.fields.length;a<c.length;a++)this.addField({name:`Field ${a+1}`,type:(0,l.HW)(c[a])});if(this.length<1)for(let a=0;a<this.fields.length;a++){const p=this.fields[a];(!p.type||p.type===s.PU.other)&&(p.type=(0,l.HW)(c[a]))}for(let a=0;a<this.fields.length;a++){const p=this.fields[a];let u=c[a];p.type!==s.PU.string&&(0,n.isString)(u)&&(u=this.parseValue(p,u)),p.values.push(u)}}push(...c){for(const a of c)this.add(a);return this.length}reverse(){for(const c of this.fields)c.values.reverse();return this}add(c){const a=c;for(const p of this.fields){let u=a[p.name];p.type!==s.PU.string&&(0,n.isString)(u)&&(u=this.parseValue(p,u)),u===void 0&&(u=g),p.values.push(u)}}set(c,a){if(c>this.length)throw new Error("Unable to set value beyond current length");const p=a||{};for(const u of this.fields)u.values[c]=p[u.name]}get(c){const a={};for(const p of this.fields)a[p.name]=p.values[c];return a}toJSON(){return(0,l.Kl)(this)}}},9631:(k,A,e)=>{"use strict";e.d(A,{Kh:()=>o,Ls:()=>m,k9:()=>a,m8:()=>p});var n=e(73060),s=e(11261),l=e(8249),r=e(43659),i=e(89667),g=e(14236),o=(b=>(b.Append="append",b.Replace="replace",b))(o||{});const d="__name__";var c=(b=>(b[b.wide=0]="wide",b[b.labels=1]="labels",b))(c||{});class a{constructor(D){this.options=D,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(P,C,M)=>{const I=C?Object.assign({},{...this.options,...C}):this.options,R=(0,g.By)(this,P),T=h(R.fields.map(L=>L.values??[]),typeof M?.maxLength=="number"?Math.min(M.maxLength,I.maxLength):I.maxLength,this.timeFieldIndex,I.maxDelta);R.fields=R.fields.map(L=>({...L,values:L.values?.slice(T)}));const S=R.fields[0]?.values?.length??0;return{...R,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:S,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:I}},this.initFromSerialized=P=>{this.name=P.name,this.refId=P.refId,this.meta=P.meta,this.length=P.length,this.labels=P.labels,this.schemaFields=P.schemaFields,this.timeFieldIndex=P.timeFieldIndex,this.pushMode=P.pushMode,this.packetInfo.length=P.packetInfo.length,this.packetInfo.number=P.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=P.fields.map(C=>({...C,type:C.type??s.PU.other,config:C.config??{},values:C.values??[]})),E(this.fields.map(C=>C.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:P,maxDelta:C})=>{const M=P&&this.options.maxLength<P,I=C&&this.options.maxDelta<C,R=C&&this.options.maxDelta===1/0;return!!(M||I||R)},this.resize=({maxLength:P,maxDelta:C})=>{C&&(this.options.maxDelta===1/0?this.options.maxDelta=C:this.options.maxDelta=Math.max(C,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,P??0)},this.pushNewValues=P=>{if(!P?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=P[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?f(this.fields.map(M=>M.values),P,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(P.forEach((M,I)=>{this.fields[I]&&(this.fields[I].values=M)}),E(this.fields.map(M=>M.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const C=this.fields?.[0]?.values.length;C!==void 0&&(this.length=C)},this.resetStateCalculations=()=>{this.fields.forEach(P=>{P.state={...P.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=P=>this.fields.map((C,M)=>P(C)?M:void 0).filter(C=>C!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(P=>{const C=P.values;return C.slice(Math.max(C.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=D=>{const P=new a(D.options);return P.initFromSerialized(D),P}}static{this.empty=D=>new a(p(D))}static{this.fromDataFrameJSON=(D,P)=>{const C=new a(p(P));return C.push(D),C}}get alwaysReplace(){return this.options.action==="replace"}push(D){const{schema:P,data:C}=D;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,P){this.pushMode=0,this.timeFieldIndex=P.fields.findIndex(T=>T.type===s.PU.time);const M=P.fields[0];this.timeFieldIndex===1&&M.type===s.PU.string&&(M.name==="labels"||M.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const I=this.pushMode===1?P.fields.slice(1):P.fields;this.refId=P.refId,P.meta&&(this.meta={...P.meta});const{displayNameFormat:R}=this.options;if(y(this.schemaFields,I)){const T=I.length;this.fields.forEach((S,L)=>{const O=I[L%T];S.config=O.config??{},S.labels=O.labels}),R&&this.fields.forEach(S=>{const L={[d]:S.name,...S.labels};S.config.displayNameFromDS=(0,r.j)(R,L)})}else{this.packetInfo.schemaChanged=!0;const T=this.pushMode===0;this.fields=I.map(S=>{const L=S.config??{};if(R){const O={[d]:S.name,...S.labels};L.displayNameFromDS=(0,r.j)(R,O)}return{config:L,name:S.name,labels:S.labels,type:S.type??s.PU.other,values:T?this.fields.find(O=>O.name===S.name&&S.type===O.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=I}if(C&&C.values.length&&C.values[0].length){let{values:M,entities:I}=C;if(I&&I.forEach((T,S)=>{T&&(0,i.t)(T,M[S])}),this.pushMode===1){const T=u(M);for(const O of T.keys())this.labels.has(O)||(this.packetInfo.schemaChanged=!0,this.addLabel(O));let S=Array(this.schemaFields.length).fill([]),L=[];this.labels.forEach(O=>{L.push(T.get(O)??S)}),M=(0,n.fj)(L)}if(M.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${M.length} (labels=${this.pushMode===1})`);this.fields=M.map((T,S)=>{let L=`Field ${S}`,O=(0,g.HW)(T[0]);return S===0&&O===s.PU.number&&T[0]>1600016688632&&(O=s.PU.time,L="Time"),{name:L,type:O,config:{},values:[]}})}let R=M;this.packetInfo.length=M[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",R=this.fields.map(T=>T.values),f(R,M,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),R.forEach((T,S)=>{const L=this.fields[S],{state:O}=L;L.values=T,O&&(O.calcs=void 0)}),this.length=R[0].length}return{...this.packetInfo}}addLabel(D){const{displayNameFormat:P}=this.options,C=this.labels.size,M=v(D);if(C===0)this.fields.forEach((I,R)=>{if(R>0&&(I.labels=M,P)){const T={[d]:I.name,...M};I.config.displayNameFromDS=(0,r.j)(P,T)}});else for(let I=1;I<this.schemaFields.length;I++){let R=this.schemaFields[I];const T=R.config??{};if(P){const S={[d]:R.name,...M};T.displayNameFromDS=(0,r.j)(P,S)}this.fields.push({...R,config:T,labels:M,values:Array(this.length).fill(void 0)})}this.labels.add(D)}}function p(b){return{maxLength:b?.maxLength??1e3,maxDelta:b?.maxDelta??1/0,action:b?.action??"append",displayNameFormat:b?.displayNameFormat}}function u(b){let D=new Set(b[0]),P=new Map;D.forEach(C=>{let M=Array(b.length-1).fill(null).map(()=>[]);P.set(C,M)});for(let C=0;C<b[0].length;C++){let M=P.get(b[0][C]);for(let I=1;I<b.length;I++)M[I-1].push(b[I][C])}return P}function m(b,D,P,C){let M;P=P||0,C=C||D.length-1;let I=C<=2147483647;for(;C-P>1;)M=I?P+C>>1:Math.floor((P+C)/2),D[M]<b?P=M:C=M;return b-D[P]<=D[C]-b?P:C}function v(b){if(!b.length)return{};if(b.charAt(0)==="{")return(0,l.Xy)(b);const D={};return b.split(",").forEach(P=>{const[C,M]=P.trim().split("=");D[C]=M}),D}function x(b){const D=b.packetInfo;return D?.action?D:void 0}function f(b,D,P=1/0,C=0,M=1/0){for(let I=0;I<b.length;I++)for(let R=0;R<D[I].length;R++)b[I].push(D[I][R]);return E(b,P,C,M)}function E(b,D=1/0,P=0,C=1/0){const M=h(b,D,P,C);if(M)for(let I=0;I<b.length;I++)b[I].splice(0,M);return M}function h(b,D=1/0,P=0,C=1/0){if(!b[0]?.length)return 0;const M=b[0].length;let I=0;if(M>D&&(I=M-D),C!==1/0&&P>=0){const R=b[P],T=R[I],S=R[M-1];S-T>C&&(I=m(S-C,R,I))}return I}function y(b,D){if(b?.length!==D.length)return!1;for(let P=0;P<b.length;P++){const C=b[P],M=D[P];if(C.name!==M.name||C.type!==M.type)return!1}return!0}},61443:(k,A,e)=>{"use strict";e.d(A,{Km:()=>i,P4:()=>l,WK:()=>r,g6:()=>s,r4:()=>n,xB:()=>g});const n=(o,d)=>({name:o,columns:d}),s=o=>o.columns,l=(o,d)=>o.columns[d],r=(o,d,c)=>o.columns[d].values[c],i=(o,d,c)=>o.columns.map(a=>a.values[c]),g=(o,d)=>o[d]},21423:(k,A,e)=>{"use strict";e.d(A,{J3:()=>r,ab:()=>g,bW:()=>l});var n=e(2543),s=e.n(n);function l(o,d,c){if(o===d)return!0;if(o?.fields?.length!==d?.fields?.length||o.name!==d.name)return!1;for(let a=0;a<o.fields.length;a++){const p=o.fields[a],u=d.fields[a];if(p.type!==u.type||p.name!==u.name)return!1;if(c)continue;if(p.labels&&u.labels&&!g(p.labels,u.labels))return!1;const m=p.config,v=u.config;if(Object.keys(m).length!==Object.keys(v).length)return!1;let x;for(x in m){if(!(x in v))return!1;if(x!=="interval"&&!(0,n.isEqual)(m[x],v[x]))return!1}}return!0}function r(o,d,c){if(o===d)return!0;if(o?.length!==d?.length)return!1;for(let a=0;a<o.length;a++)if(!c(o[a],d[a]))return!1;return!0}const i=(o,d)=>o===d;function g(o,d,c=i){if(o===d)return!0;if(Object.keys(o).length!==Object.keys(d).length)return!1;let a;for(a in o)if(!c(o[a],d[a]))return!1;return!0}},14236:(k,A,e)=>{"use strict";e.d(A,{Bt:()=>N,By:()=>L,EI:()=>U,ES:()=>I,HW:()=>E,KR:()=>O,Kl:()=>S,LI:()=>P,N$:()=>F,Vc:()=>C,XQ:()=>y,Yn:()=>T,by:()=>x,ci:()=>D,dF:()=>h,oE:()=>f,pH:()=>b,q7:()=>R,w3:()=>M});var n=e(2543),s=e.n(n),l=e(47232),r=e(48241),i=e(28240),g=e(39070),o=e(11261),d=e(33948),c=e(89667);function a(w){const B=w.columns.map(K=>{const{text:W,type:z,...Y}=K,X=[];return{name:W?.length?W:K,config:Y||{},values:X,type:z&&Object.values(o.PU).includes(z)?z:o.PU.other}});if(!(0,n.isArray)(w.rows))throw new Error(`Expected table rows to be array, got ${typeof w.rows}.`);for(const K of w.rows)for(let W=0;W<B.length;W++)B[W].values.push(K[W]);for(const K of B)if(K.type===o.PU.other){const W=h(K);W&&(K.type=W)}return{fields:B,refId:w.refId,meta:w.meta,name:w.name,length:w.rows.length}}function p(w){const B=[],K=[],W=w.datapoints||w.points;for(const Y of W)K.push(Y[0]),B.push(Y[1]);const z=[{name:o.LE,type:o.PU.time,config:{},values:B},{name:o.Bc,type:o.PU.number,config:{unit:w.unit},values:K,labels:w.tags}];return w.title&&(z[1].config.displayNameFromDS=w.title),{name:w.target||w.name,refId:w.refId,meta:w.meta,fields:z,length:K.length}}function u(w){const B=[],K=[];for(let W=0;W<w.data.length;W++){const z=w.data[W];B.push(z[1]),K.push(z[0])}return{name:w.label,fields:[{name:w.label||o.Bc,type:o.PU.number,config:{},values:B},{name:o.LE,type:o.PU.time,config:{unit:"dateTimeAsIso"},values:K}],length:B.length}}function m(w){const B=[{name:w.target,type:o.PU.other,labels:w.tags,config:{unit:w.unit,filterable:w.filterable},values:[]}];for(const K of w.datapoints)B[0].values.push(K);return{name:w.target,refId:w.target,meta:{json:!0},fields:B,length:w.datapoints.length}}const v=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function x(w,B){return w&&(w=w.toLowerCase(),w==="date"||w==="time")?o.PU.time:E(B)}function f(w){return w instanceof Date||(0,l.Ar)(w)?o.PU.time:(0,n.isNumber)(w)?o.PU.number:(0,n.isString)(w)?o.PU.string:(0,n.isBoolean)(w)?o.PU.boolean:o.PU.other}function E(w){return w instanceof Date||(0,l.Ar)(w)?o.PU.time:(0,n.isNumber)(w)?o.PU.number:(0,n.isString)(w)?v.test(w)?o.PU.number:w==="true"||w==="TRUE"||w==="True"||w==="false"||w==="FALSE"||w==="False"?o.PU.boolean:o.PU.string:(0,n.isBoolean)(w)?o.PU.boolean:o.PU.other}function h(w){if(w.name){const B=w.name.toLowerCase();if(B==="date"||B==="time")return o.PU.time}for(let B=0;B<w.values.length;B++){const K=w.values[B];if(K!=null)return E(K)}}const y=(w,B=!1)=>{for(const K of w.fields)if(!K.type||K.type===o.PU.other||B)return{...w,fields:w.fields.map(W=>W.type&&W.type!==o.PU.other&&!B?W:{...W,type:h(W)||o.PU.other})};return w},b=w=>!!(w&&w.hasOwnProperty("columns")),D=w=>!!(w&&w.hasOwnProperty("fields")),P=w=>!!(D(w)&&w.hasOwnProperty("value"));function C(w){if("fields"in w)return"length"in w&&w.fields[0]?.values?.get?w:U(w);if(w.hasOwnProperty("type")&&w.type==="docs")return m(w);if(w.hasOwnProperty("datapoints")||w.hasOwnProperty("points"))return p(w);if(w.hasOwnProperty("data"))return w.hasOwnProperty("schema")?(0,c.or)(w):u(w);if(w.hasOwnProperty("columns"))return a(w);if(Array.isArray(w))return(0,d.I)(w);throw console.warn("Can not convert",w),new Error("Unsupported data format")}const M=w=>{const{fields:B}=w,K=w.length,W=[];if(B.length===2){const{timeField:z,timeIndex:Y}=O(w);if(z){const q=B[Y===0?1:0],G=B[Y];for(let te=0;te<K;te++)W.push([q.values[te],G.values[te]]);return{alias:w.name,target:(0,i.Ct)(q,w),datapoints:W,unit:B[0].config?B[0].config.unit:void 0,refId:w.refId,meta:w.meta}}}for(let z=0;z<K;z++){const Y=[];for(let X=0;X<B.length;X++)Y.push(B[X].values[z]);W.push(Y)}return w.meta&&w.meta.json?{alias:B[0].name||w.name,target:B[0].name||w.name,datapoints:B[0].values,filterable:B[0].config?B[0].config.filterable:void 0,type:"docs"}:{columns:B.map(z=>{const{name:Y,config:X}=z;if(X){const{...q}=X;return q.text=Y,q}return{text:Y}}),type:"table",refId:w.refId,meta:w.meta,rows:W}};function I(w,B,K=!1){const W=w.fields[B];if(!W)return w;const z=[];for(let X=0;X<w.length;X++)z.push(X);const Y=(0,r.i)(W,K);return z.sort(Y),{...w,fields:w.fields.map(X=>{const q={...X,values:X.values.map((te,H)=>X.values[z[H]])},{nanos:G}=X;return G!==void 0&&(q.nanos=G.map((te,H)=>G[z[H]])),q})}}function R(w){return{...w,fields:w.fields.map(B=>{const K=[...B.values];K.reverse();const W={...B,values:K},{nanos:z}=B;if(z!==void 0){const Y=[...z];Y.reverse(),W.nanos=Y}return W})}}function T(w,B){const K=[];for(const W of w.fields)K.push(W.values[B]);return K}function S(w){return L(w)}function L(w,B){return{fields:(B?w.fields.filter(B):w.fields).map(z=>{let Y=z.values;return{name:z.name,type:z.type,config:z.config,values:Y,labels:z.labels}}),refId:w.refId,meta:w.meta,name:w.name}}const O=w=>{for(let B=0;B<w.fields.length;B++)if(w.fields[B].type===o.PU.time)return{timeField:w.fields[B],timeIndex:B};return{}};function j(w){const B=y(C(w));if(B.fields&&B.fields.length)for(const K of B.fields)K.state=null;return B}function N(w){return!w||!(0,n.isArray)(w)?[]:w.map(B=>j(B))}function F(w,B){const{series:K,annotations:W}=w;if(w.state===g.Gu.Loading&&K.length===0)return B||(B=w),{...B,state:g.Gu.Loading,request:w.request};const z=performance.now(),Y=K.map(G=>j(G)),X=N(W),q=performance.now();return{...w,series:Y,annotations:X,timings:{dataProcessingTime:q-z}}}function U(w){let B=0;const K=w.fields.map((W,z)=>{const{state:Y,...X}=W;return X.name||(X.name=`Field ${z+1}`),X.config||(X.config={}),X.values?X.values.length>B&&(B=X.values.length):X.values=new Array(B),X.type||(X.type=h(X)??o.PU.other),X});return{...w,fields:K,length:B}}},19845:(k,A,e)=>{"use strict";e.d(A,{S1:()=>d,aH:()=>r,hF:()=>g,jq:()=>i,t9:()=>c,tP:()=>o,uY:()=>a});var n=e(11261),s=e(14236);const l=100;function r(p){if(p.fields.length<2)return!1;const u=p.fields.find(v=>v.type===n.PU.number);let m=!1;for(const v of p.fields)if(g(v)){m=!0;break}return m&&u!==void 0}function i(p){return!p.find(u=>!r(u))}function g(p){if(p.type!==n.PU.time)return!1;let u=null,m=p.values.length>l?l:p.values.length;for(let v=0;v<m;v++){const x=p.values[v];if(u===null||x!==null&&x>u)u=x;else return!1}return!0}function o(p){for(let u=0;u<p.length;u++){const m=(0,s.KR)(p[u]);if(m.timeField!==void 0&&m.timeIndex!==void 0)return!0}return!1}function d(p){return p.fields.some(u=>u.type===n.PU.time)}function c(p,u){if(p.meta?.uniqueRowIdFields!==void 0)return p.meta.uniqueRowIdFields.map(m=>p.fields[m].values[u]).join("-")}function a(p,u){if(u instanceof Array)for(let m=0;m<u.length;m++)p.fields[m].values.push(u[m]);else for(const m of p.fields)m.values.push(u[m.name]);try{p.length++}catch{}}},1933:(k,A,e)=>{"use strict";e.d(A,{G:()=>i,O:()=>g});var n=e(2543),s=e.n(n),l=e(43127);let r=()=>l.lE;const i=o=>{r=o??r},g=o=>o?.timeZone&&!(0,n.isEmpty)(o.timeZone)?o.timeZone:r()??l.lE},85858:(k,A,e)=>{"use strict";e.r(A),e.d(A,{isMathString:()=>i,isValid:()=>o,parse:()=>g,parseDateMath:()=>d,roundToFiscal:()=>c});var n=e(2543),s=e.n(n),l=e(47232);const r=["y","M","w","d","h","m","s","Q"];function i(a){return a?!!(typeof a=="string"&&(a.substring(0,3)==="now"||a.includes("||"))):!1}function g(a,p,u,m){if(a){if(typeof a!="string")return(0,l.Ar)(a)?a:(0,n.isDate)(a)?(0,l.KQ)(a):void 0;{let v,x="",f,E;return a.substring(0,3)==="now"?(v=(0,l.oZ)(u),x=a.substring(3)):(f=a.indexOf("||"),f===-1?(E=a,x=""):(E=a.substring(0,f),x=a.substring(f+2)),v=(0,l.KQ)(E,l.mt)),x.length?d(x,v,p,m):v}}}function o(a){const p=g(a);return p&&(0,l.Ar)(p)?p.isValid():!1}function d(a,p,u,m=0){const v=a.replace(/\s/g,""),x=(0,l.KQ)(p);let f=0;const E=v.length;for(;f<E;){const h=v.charAt(f++);let y,b,D,P=!1;if(h==="/")y=0;else if(h==="+")y=1;else if(h==="-")y=2;else return;if(isNaN(parseInt(v.charAt(f),10)))b=1;else if(v.length===2)b=parseInt(v.charAt(f),10);else{const M=f;for(;!isNaN(parseInt(v.charAt(f),10));)if(f++,f>10)return;b=parseInt(v.substring(M,f),10)}if(y===0&&b!==1)return;D=v.charAt(f++),D==="f"&&(D=v.charAt(f++),P=!0);const C=D;if((0,n.includes)(r,C))y===0?P?c(m,x,C,u):u?x.endOf(C):x.startOf(C):y===1?x.add(b,C):y===2&&x.subtract(b,C);else return}return x}function c(a,p,u,m){switch(u){case"y":return m?c(a,p,u,!1).add(11,"M").endOf("M"):p.subtract((p.month()-a+12)%12,"M").startOf("M"),p;case"Q":return m?c(a,p,u,!1).add(2,"M").endOf("M"):p.subtract((p.month()-a+12)%3,"M").startOf("M"),p;default:return}}},70416:(k,A,e)=>{"use strict";e.d(A,{E9:()=>g,Ri:()=>o,V3:()=>u,WT:()=>d,dU:()=>i,di:()=>a,pp:()=>p,vd:()=>c});var n=e(89369),s=e(68284),l=e(25579);const r={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function i(v,x=!0){if((0,n.d)(v.start,v.end))return"";const f=(0,s.F)(v);return Object.entries(f).reduce((E,[h,y])=>y&&y!==0&&!(h==="seconds"&&!x&&E)?E+`${E!==""?" ":""}${y}${r[h][0]}`:E,"")}function g(v){return v.split(" ").reduce((x,f)=>{const E=f.match(/(\d+)(.+)/),h=E?.[1],y=E?.[2];if(!(h&&y))return x;const b=Object.entries(r).find(([P,C])=>C?.includes(E[2])),D=parseInt(h,10);return b?{...x,[b[0]]:D}:x},{})}function o(v,x){return(0,l.W)(v,x)}function d(v){const x=new Date;return o(x,v).getTime()-x.getTime()}function c(v){return!isNaN(Date.parse(v))}function a(v){for(const x of v.trim().split(" ")){const f=x.match(/(\d+)(.+)/);if(f===null||f.length!==3||!Object.entries(r).find(([h,y])=>y?.includes(f[2]))?.[0])return!1}return!0}function p(v){return m(v,["h","m","s","ms","us","\xB5s","ns"])}function u(v){return m(v,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function m(v,x){for(const f of v.trim().split(" ")){const E=f.match(/([0-9]*[.]?[0-9]+)(.+)/);if(E===null||E.length!==3||!x.includes(E[2]))return!1}return!0}},42994:(k,A,e)=>{"use strict";e.d(A,{JE:()=>l,Od:()=>r,WC:()=>i});const n="YYYY-MM-DD HH:mm:ss",s="YYYY-MM-DD HH:mm:ss.SSS";class l{constructor(){this.fullDate=n,this.fullDateMS=s,this.interval={millisecond:"HH:mm:ss.SSS",second:"HH:mm:ss",minute:"HH:mm",hour:"MM/DD HH:mm",day:"MM/DD",month:"YYYY-MM",year:"YYYY"}}update(d){this.fullDate=d.fullDate,this.interval=d.interval,d.useBrowserLocale&&this.useBrowserLocale()}useBrowserLocale(){this.fullDate=r({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.fullDateMS=this.fullDate.replace("ss","ss.SSS"),this.interval.millisecond=r({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second).replace("ss","ss.SSS"),this.interval.second=r({hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},null,this.interval.second),this.interval.minute=r({hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.minute),this.interval.hour=r({month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},null,this.interval.hour),this.interval.day=r({month:"2-digit",day:"2-digit",hour12:!1},null,this.interval.day),this.interval.month=r({year:"numeric",month:"2-digit",hour12:!1},null,this.interval.month)}getTimeFieldUnit(d){return`time:${d?this.fullDateMS:this.fullDate}`}}function r(o,d,c){if(g())return c??n;!d&&navigator&&(d=[...navigator.languages]);const a=new Intl.DateTimeFormat(d||void 0,o),p=a.formatToParts(new Date),m={year:"YYYY",month:"MM",day:"DD",hour:a.resolvedOptions().hour12?"hh":"HH",minute:"mm",second:"ss",weekday:"ddd",era:"N",dayPeriod:"A",timeZoneName:"Z"};return p.map(v=>m[v.type]||v.value).join("")}const i=new l,g=()=>!("DateTimeFormat"in Intl)||!("formatToParts"in Intl.DateTimeFormat.prototype)},72724:(k,A,e)=>{"use strict";e.d(A,{LE:()=>g,M7:()=>o,_Q:()=>c,fq:()=>d,jw:()=>a});var n=e(84743),s=e.n(n),l=e(1933),r=e(42994),i=e(47232);const g=(m,v)=>u(m,(0,l.O)(v)).format(p(v)),o=(m,v)=>u(m,(0,l.O)(v)).format(),d=(m,v)=>u(m,(0,l.O)(v)).fromNow(),c=(m,v)=>u(m,(0,l.O)(v)).format(`${r.WC.fullDate} z`),a=(m,v)=>u(m,(0,l.O)(v)).format("z"),p=m=>m?.defaultWithMS?m?.format??r.WC.fullDateMS:m?.format??r.WC.fullDate,u=(m,v)=>{const x=m,f=s().tz.zone(v);if(f&&f.name)return(0,i.AN)((0,i.yT)(x)).tz(f.name);switch(v){case"utc":return(0,i.AN)((0,i.yT)(x));default:return(0,i.AN)((0,i.yT)(x)).local()}}},47232:(k,A,e)=>{"use strict";e.d(A,{$D:()=>f,AN:()=>u,Ah:()=>a,Ar:()=>d,JK:()=>i,KQ:()=>p,XN:()=>g,mt:()=>l,oZ:()=>m,pp:()=>x,u8:()=>o,xQ:()=>v,xS:()=>r,yT:()=>c});var n=e(95093),s=e.n(n);const l=s().ISO_8601,r=E=>{s().locale(E)},i=()=>s().locale(),g=()=>s().localeData(),o=E=>E===null||typeof E=="string"||typeof E=="number"||E instanceof Date||Array.isArray(E)&&E.every(h=>typeof h=="string"||typeof h=="number")||d(E),d=E=>s().isMoment(E),c=(E,h)=>s().utc(E,h),a=(E,h)=>s().duration(E,h),p=(E,h)=>s()(E,h),u=E=>p(E),m=(E,h,y)=>{if(E&&E!=="browser"){let b;if(typeof h=="string"&&y?b=s().tz(h,y,E):b=s().tz(h,E),d(b))return b}return p(h,y)},v=E=>s().weekdays().findIndex(h=>h.toLowerCase()===E.toLowerCase()),x=E=>["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].findIndex(h=>h.toLowerCase()===E.toLowerCase()),f=E=>{const h="-weekStart",y=i().replace(h,""),b=E?x(E):-1;b!==-1?s().locale(y+h,{parentLocale:y,week:{dow:b}}):r(y)}},53531:(k,A,e)=>{"use strict";e.d(A,{b:()=>c});var n=e(2543),s=e.n(n),l=e(84743),r=e.n(l),i=e(1933),g=e(85858),o=e(42994),d=e(47232);const c=(u,m)=>(0,d.Ar)(u)?u:typeof u=="string"?a(u,m):p(u,m),a=(u,m)=>{if(u.indexOf("now")!==-1)return(0,g.isValid)(u)&&(0,g.parse)(u,m?.roundUp,m?.timeZone,m?.fiscalYearStartMonth)||(0,d.KQ)();const v=(0,i.O)(m),x=r().tz.zone(v),f=m?.format??o.WC.fullDate;if(x&&x.name)return(0,d.oZ)(x.name,u,f);switch((0,n.lowerCase)(v)){case"utc":return(0,d.yT)(u,f);default:return(0,d.KQ)(u,f)}},p=(u,m)=>{const v=u,x=(0,i.O)(m),f=r().tz.zone(x);if(f&&f.name)return(0,d.oZ)(f.name,v);switch((0,n.lowerCase)(x)){case"utc":return(0,d.yT)(v);default:return(0,d.KQ)(v)}}},65879:(k,A,e)=>{"use strict";e.r(A),e.d(A,{calculateInterval:()=>D,convertRawToRange:()=>x,describeInterval:()=>M,describeTextRange:()=>p,describeTimeRange:()=>u,describeTimeRangeAbbreviation:()=>v,intervalToMs:()=>R,intervalToSeconds:()=>I,isFiscal:()=>E,isRelativeTime:()=>f,isRelativeTimeRange:()=>h,isValidTimeSpan:()=>m,msRangeToTimeString:()=>b,relativeToTimeRange:()=>L,roundInterval:()=>T,secondsToHms:()=>y,timeRangeToRelative:()=>S});var n=e(2543),s=e.n(n),l=e(85858),r=e(72724),i=e(47232),g=e(53531);const o={s:{display:"second"},m:{display:"minute"},h:{display:"hour"},d:{display:"day"},w:{display:"week"},M:{display:"month"},y:{display:"year"}},d=[{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],c=[{from:"now",to:"now+1m",display:"Next minute"},{from:"now",to:"now+5m",display:"Next 5 minutes"},{from:"now",to:"now+15m",display:"Next 15 minutes"},{from:"now",to:"now+30m",display:"Next 30 minutes"},{from:"now",to:"now+1h",display:"Next hour"},{from:"now",to:"now+3h",display:"Next 3 hours"},{from:"now",to:"now+6h",display:"Next 6 hours"},{from:"now",to:"now+12h",display:"Next 12 hours"},{from:"now",to:"now+24h",display:"Next 24 hours"},{from:"now",to:"now+2d",display:"Next 2 days"},{from:"now",to:"now+7d",display:"Next 7 days"},{from:"now",to:"now+30d",display:"Next 30 days"},{from:"now",to:"now+90d",display:"Next 90 days"},{from:"now",to:"now+6M",display:"Next 6 months"},{from:"now",to:"now+1y",display:"Next year"},{from:"now",to:"now+2y",display:"Next 2 years"},{from:"now",to:"now+5y",display:"Next 5 years"}],a={};(0,n.each)(d,O=>{a[O.from+" to "+O.to]=O}),(0,n.each)(c,O=>{a[O.from+" to "+O.to]=O});function p(O){const j=O.indexOf("+")!==0;O.indexOf("now")===-1&&(O=(j?"now-":"now")+O);let N=a[O+" to now"];if(N)return N;j?N={from:O,to:"now",display:""}:N={from:"now",to:O,display:""};const F=/^now([-+])(\d+)(\w)/.exec(O);if(F){const U=F[3],w=parseInt(F[2],10),B=o[U];B&&(N.display=j?"Last ":"Next ",N.display+=w+" "+B.display,N.section=B.section,w>1&&(N.display+="s"))}else N.display=N.from+" to "+N.to,N.invalid=!0;return N}function u(O,j){const N=a[O.from.toString()+" to "+O.to.toString()];if(N)return N.display;const F={timeZone:j};if((0,i.Ar)(O.from)&&(0,i.Ar)(O.to))return(0,r.LE)(O.from,F)+" to "+(0,r.LE)(O.to,F);if((0,i.Ar)(O.from)){const U=l.parse(O.to,!0,"utc");return U?(0,r.LE)(O.from,F)+" to "+(0,r.fq)(U,F):""}if((0,i.Ar)(O.to)){const U=l.parse(O.from,!1,"utc");return U?(0,r.fq)(U,F)+" to "+(0,r.LE)(O.to,F):""}return O.to.toString()==="now"?p(O.from).display:O.from.toString()+" to "+O.to.toString()}const m=O=>O.indexOf("$")===0||O.indexOf("+$")===0?!0:p(O).invalid!==!0,v=(O,j)=>{if((0,i.Ar)(O.from))return(0,r.jw)(O.from,{timeZone:j});const N=l.parse(O.from,!0);return N?(0,r.jw)(N,{timeZone:j}):""},x=(O,j,N,F)=>{const U=(0,g.b)(O.from,{roundUp:!1,timeZone:j,fiscalYearStartMonth:N,format:F}),w=(0,g.b)(O.to,{roundUp:!0,timeZone:j,fiscalYearStartMonth:N,format:F});return l.isMathString(O.from)||l.isMathString(O.to)?{from:U,to:w,raw:O}:{from:U,to:w,raw:{from:U,to:w}}};function f(O){return typeof O=="string"?O.indexOf("now")>=0:!1}function E(O){return typeof O.raw.from=="string"&&O.raw.from.indexOf("f")>0?!0:typeof O.raw.to=="string"&&O.raw.to.indexOf("f")>0}function h(O){return f(O.from)||f(O.to)}function y(O){const j=Math.floor(O/31536e3);if(j)return j+"y";const N=Math.floor(O%31536e3/86400);if(N)return N+"d";const F=Math.floor(O%31536e3%86400/3600);if(F)return F+"h";const U=Math.floor(O%31536e3%86400%3600/60);if(U)return U+"m";const w=Math.floor(O%31536e3%86400%3600%60);if(w)return w+"s";const B=Math.floor(O*1e3);return B?B+"ms":"less than a millisecond"}function b(O){const j=Number((O/1e3).toFixed()),N=Math.floor(j/60/60),F=Math.floor(j/60)-N*60,U=Number((j%60).toFixed());let w=N?N+"h":"",B=F?F+"min":"",K=U?U+"sec":"";return w&&B?w=w+" ":w=w,(B||w)&&K?B=B+" ":B=B,w+B+K||"less than 1sec"}function D(O,j,N){let F=1;N&&(F=R(N));let U=T((O.to.valueOf()-O.from.valueOf())/j);return F>U&&(U=F),{intervalMs:U,interval:y(U/1e3)}}const P=/(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,C={y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001};function M(O){if(Number(O))return{sec:C.s,type:"s",count:parseInt(O,10)};const j=O.match(P);if(!j)throw new Error(`Invalid interval string, has to be either unit-less or end with one of the following units: "${Object.keys(C).join(", ")}"`);const N=C[j[2]];if(N===void 0)throw new Error("describeInterval failed: invalid interval string");return{sec:N,type:j[2],count:parseInt(j[1],10)}}function I(O){const j=M(O);return j.sec*j.count}function R(O){const j=M(O);return j.sec*1e3*j.count}function T(O){switch(!0){case O<10:return 1;case O<15:return 10;case O<35:return 20;case O<75:return 50;case O<150:return 100;case O<350:return 200;case O<750:return 500;case O<1500:return 1e3;case O<3500:return 2e3;case O<7500:return 5e3;case O<12500:return 1e4;case O<17500:return 15e3;case O<25e3:return 2e4;case O<45e3:return 3e4;case O<9e4:return 6e4;case O<21e4:return 12e4;case O<45e4:return 3e5;case O<75e4:return 6e5;case O<105e4:return 9e5;case O<15e5:return 12e5;case O<27e5:return 18e5;case O<54e5:return 36e5;case O<9e6:return 72e5;case O<162e5:return 108e5;case O<324e5:return 216e5;case O<864e5:return 432e5;case O<6048e5:return 864e5;case O<18144e5:return 6048e5;case O<36288e5:return 2592e6;default:return 31536e6}}function S(O,j=(0,i.KQ)()){const N=j.unix()-O.from.unix(),F=j.unix()-O.to.unix();return{from:N,to:F}}function L(O,j=(0,i.KQ)()){const N=(0,i.KQ)(j).subtract(O.from,"s"),F=O.to===0?(0,i.KQ)(j):(0,i.KQ)(j).subtract(O.to,"s");return{from:N,to:F,raw:{from:N,to:F}}}},91410:(k,A,e)=>{"use strict";e.d(A,{HD:()=>d,P3:()=>a,QZ:()=>c,U3:()=>p,g$:()=>g,le:()=>o});var n=e(2543),s=e.n(n),l=e(84743),r=e.n(l),i=e(1933),g=(E=>(E.default="",E.localBrowserTime="browser",E.utc="utc",E))(g||{});const o=E=>{switch((0,i.O)({timeZone:E})){case"browser":return"Local browser time";case"utc":return"UTC";default:return E}},d=E=>r().tz.zone(E),c=(E,h)=>{const y=u(E,h);return y||v(E,h)},a=(0,n.memoize)((E=!1)=>{const h=[];return E===!0?h.push("","browser","utc"):E&&h.push(...E),r().tz.names().reduce((y,b)=>{const D=f[b];return!Array.isArray(D)||D.length===0||y.push(b),y},h)}),p=(0,n.memoize)((E=!1)=>{const y=a(E).reduce((b,D)=>{const P=D.indexOf("/");if(P===-1){const M="";return b[M]=b[M]??[],b[M].push(D),b}const C=D.slice(0,P);return b[C]=b[C]??[],b[C].push(D),b},{});return Object.keys(y).map(b=>({name:b,zones:y[b]}))}),u=(E,h)=>{switch(E){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:E,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const y=(0,i.O)(),D=y==="browser"||y==="utc"?u(y,h):v(y,h);return{countries:f[y]??[],abbreviation:"",offsetInMins:0,...D,ianaName:D?.ianaName??"",name:"Default",zone:E}}case"browser":{const y=r().tz.guess(!0),b=v(y,h);return{countries:f[y]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...b,name:"Browser Time",ianaName:b?.ianaName??"",zone:E}}default:return}},m=E=>/^(\+|\-).+/.test(E)?"":E,v=(E,h)=>{const y=r().tz.zone(E);if(y)return{name:E,ianaName:y.name,zone:E,countries:f[E]??[],abbreviation:m(y.abbr(h)),offsetInMins:y.utcOffset(h)}},x={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},f=r().tz.countries().reduce((E,h)=>r().tz.zonesForCountry(h).reduce((b,D)=>{b[D]||(b[D]=[]);const P=x[h];return P&&b[D].push({code:h,name:P}),b},E),{})},18226:(k,A,e)=>{"use strict";e.d(A,{o:()=>r});var n=e(74486),s=e(88483),l=e(16126);class r{constructor(){this.subscribers=new Map,this.emitter=new n.A}publish(o){this.emitter.emit(o.type,o)}subscribe(o,d){return this.getStream(o).subscribe({next:d})}getStream(o){return new s.c(d=>{const c=a=>{d.next(a)};return this.emitter.on(o.type,c),this.subscribers.set(c,d),()=>{this.emitter.off(o.type,c),this.subscribers.delete(c)}})}newScopedBus(o,d){return new i([o],this,d)}emit(o,d){typeof o=="string"?this.emitter.emit(o,{type:o,payload:d}):this.emitter.emit(o.name,{type:o.name,payload:d})}on(o,d,c){if(d.wrapper=a=>{d(a.payload)},typeof o=="string"?this.emitter.on(o,d.wrapper):this.emitter.on(o.name,d.wrapper),c){const a=c.$on("$destroy",()=>{this.off(o,d),a()})}}off(o,d){if(typeof o=="string"){this.emitter.off(o,d.wrapper);return}this.emitter.off(o.name,d.wrapper)}removeAllListeners(){this.emitter.removeAllListeners();for(const[o,d]of this.subscribers)d.complete(),this.subscribers.delete(o)}}class i{constructor(o,d,c){this.path=o,this.eventBus=d,this.filterConfig=c??{onlyLocal:!1}}publish(o){o.origin||(o.origin=this),this.eventBus.publish(o)}filter(o){return this.filterConfig.onlyLocal?o.origin===this:!0}getStream(o){return this.eventBus.getStream(o).pipe((0,l.p)(this.filter.bind(this)))}subscribe(o,d){return this.getStream(o).subscribe({next:d})}removeAllListeners(){this.eventBus.removeAllListeners()}newScopedBus(o,d){return new i([...this.path,o],this,d)}}},69129:(k,A,e)=>{"use strict";e.d(A,{LL:()=>c,LO:()=>r,NI:()=>d,Tp:()=>a,We:()=>i,b_:()=>s,gc:()=>g,ql:()=>l,wE:()=>o});var n=e(65463);class s extends n.x{static{this.type="data-hover"}}class l extends n.a{static{this.type="data-hover-clear"}}class r extends n.x{static{this.type="data-select"}}class i extends n.x{static{this.type="annotation-event"}}class g extends n.x{static{this.type="dashboard-loaded"}}class o extends n.a{static{this.type="datasource-updated-successfully"}}class d extends n.a{static{this.type="datasource-test-succeeded"}}class c extends n.a{static{this.type="datasource-test-failed"}}class a extends n.x{static{this.type="set-panel-attention"}}},89550:(k,A,e)=>{"use strict";e.d(A,{R:()=>s});const n=new Set;function s(l){if(n.has(l))throw new Error(`There is already an event defined with type '${l}'`);return n.add(l),{name:l}}},65463:(k,A,e)=>{"use strict";e.d(A,{a:()=>n,x:()=>s});class n{constructor(){this.type=this.__proto__.constructor.type}setTags(r){return this.tags=new Set(r),this}}class s extends n{constructor(r){super(),this.payload=r}}},66670:(k,A,e)=>{"use strict";e.d(A,{K:()=>s});var n=e(83077);class s extends n.O{}},57875:(k,A,e)=>{"use strict";e.d(A,{H:()=>v,J:()=>u});var n=e(2543),s=e.n(n),l=e(14236),r=e(47232),i=e(53531),g=e(11261),o=e(28802),d=e(62398),c=e(83195),a=e(58563);const p={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function u(f){if(!f||(0,n.isEmpty)(f)||!f.field)return m;const E=f.field,h=E.config??{},{palette:y}=f.theme.visualization;let b=h.unit,D=b&&(p[b]||b.startsWith("time:")),P=!1;if(E.type===g.PU.time&&!D){if(b="dateTimeAsSystem",D=!0,E.values&&E.values.length>1){let O=E.values[0],j=E.values[E.values.length-1];typeof O=="string"?(O=(0,i.b)(O).unix(),j=(0,i.b)(j).unix()):(O/=1e3,j/=1e3),P=Math.abs(j-O)<60}}else E.type===g.PU.boolean?(0,c.j9)(b)||(b="bool"):!b&&E.type===g.PU.string&&(b="string");const C=b?.startsWith("currency"),M=(0,c.j9)(b),I=E.type===g.PU.number,T=!D&&!C&&!M&&!(b==="locale")&&I&&h.decimals==null,S=(0,c.j_)(b||"none"),L=(0,a.jc)(E,f.theme);return(O,j)=>{const{mappings:N}=h,F=b==="string";D&&typeof O=="string"&&(O=(0,r.yT)(O).valueOf());let U=F?NaN:(0,o.t)(O),w,B,K,W,z,Y;if(N&&N.length>0){const q=(0,d.Zz)(N,O);q&&(q.text!=null&&(w=q.text),q.color!=null&&(W=f.theme.visualization.getColorByName(q.color)),q.icon!=null&&(z=q.icon))}else if(E.type===g.PU.enum){if(O==null)return{text:"",numeric:NaN};const q=+O;if(h&&h.type&&h.type.enum){const{text:G,color:te}=h.type.enum;if(w=G?G[q]:`${O}`,W=te?te[q]:void 0,W==null){const H=y[q%y.length];W=f.theme.visualization.getColorByName(H)}}}if(!Number.isNaN(U)){if(w==null&&!(0,n.isBoolean)(O)){let q;T&&j!=null?(q=S(U,j,null,f.timeZone,P),q.text=+q.text+""):q=S(U,h.decimals,null,f.timeZone,P),w=q.text,K=q.suffix,B=q.prefix}if(W==null){const q=L(U);W=q.color,Y=q.percent}}if(w==null&&(0,n.isArray)(O)&&(w=(0,n.join)(O,", ")),w==null&&(w=(0,n.toString)(O),w||(h.noValue?w=h.noValue:w="")),!W){const q=L(-1/0);W=q.color,Y=q.percent}const X={text:w,numeric:U,prefix:B,suffix:K,color:W};return z!=null&&(X.icon=z),Y!=null&&(X.percent=Y),X}}function m(f){return{text:(0,n.toString)(f),numeric:(0,o.t)(f)}}function v(){return f=>({text:(0,l.oE)(f)==="other"?`${JSON.stringify(f,x())}`:`${f}`,numeric:null})}const x=()=>{const f=new WeakSet;return(E,h)=>{if(typeof h=="object"&&h!==null){if(f.has(h))return;f.add(h)}return h}}},8066:(k,A,e)=>{"use strict";e.d(A,{Hs:()=>v,Qi:()=>m,lz:()=>x,uf:()=>p});var n=e(21197),s=e(55459),l=e.n(s),r=e(84140),i=e(23596),g=e(75059),o=e(24293),d=e(83077),c=e(58563),a=e(47737);const p=new d.O(()=>[{id:o.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:f},{id:o.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:E},{id:o.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(h,y)=>(b,D,P)=>{const C=P??a.QS;return y.visualization.getColorByName(C.color)}},new u({id:o.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:h=>h.visualization.palette}),new u({id:o.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:h=>h.visualization.palette.filter(y=>(0,i.eM)(h.visualization.getColorByName(y),h.colors.background.primary)>=h.colors.contrastThreshold)}),new u({id:o.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:h=>["green","yellow","red"]}),new u({id:o.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:h=>["red","yellow","green"]}),new u({id:o.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:h=>["dark-blue","super-light-yellow","dark-red"]}),new u({id:o.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:h=>["super-light-yellow","dark-red"]}),new u({id:o.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:h=>["blue","purple"]}),new u({id:o.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:h=>["super-light-yellow","dark-blue"]}),new u({id:o.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:h=>["panel-bg","dark-blue"]}),new u({id:o.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:h=>["panel-bg","dark-red"]}),new u({id:o.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:h=>["panel-bg","dark-green"]}),new u({id:o.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:h=>["panel-bg","dark-purple"]})]);class u{constructor(y){this.id=y.id,this.name=y.name,this.description=y.description,this.getNamedColors=y.getColors,this.isContinuous=y.isContinuous,this.isByValue=y.isByValue,this.useSeriesName=y.useSeriesName}getColors(y){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===y?this.colorCache:(this.colorCache=this.getNamedColors(y).map(y.visualization.getColorByName),this.colorCacheTheme=y,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,n.Ik)(this.colorCache)),this.interpolator}getCalculator(y,b){const D=this.getColors(b);return this.isByValue?this.isContinuous?(P,C,M)=>this.getInterpolator()(C):(P,C,M)=>D[C*(D.length-1)]:this.useSeriesName?(P,C,M)=>D[Math.abs(l()(y.name))%D.length]:(P,C,M)=>{const I=y.state?.seriesIndex??0;return D[I%D.length]}}}function m(h){return p.get(h.config.color?.mode??o.Y.Thresholds)}function v(h){return p.get(h??o.Y.Thresholds)}function x(h,y){const b=m(h);if(!b.isByValue)return{color:b.getCalculator(h,y)(0,0),threshold:a.QS,percent:1};const D=(0,c.jc)(h,y),P=h.config.color?.seriesBy??"last",M=(0,g.Nw)({field:h,reducers:[P]})[P]??0;return D(M)}function f(h,y){return()=>y.visualization.getColorByName(h.config.color?.fixedColor??o.F)}function E(h,y){return()=>{const b=y.visualization.getColorByName(h.config.color?.fixedColor??o.F),D=[b],P=6,C=10,M=35,I=35;for(let T=1;T<P;T++)D.push((0,r.A)(b).spin(T/P*C).brighten(T/P*M).toHexString()),D.push((0,r.A)(b).spin(-(T/P)*C).darken(T/P*I).toHexString());const R=h.state?.seriesIndex??0;return D[R%D.length]}}},56323:(k,A,e)=>{"use strict";e.d(A,{PI:()=>E,Pm:()=>f,XS:()=>P,Zo:()=>I,a_:()=>x,eG:()=>D,k3:()=>p,k_:()=>v,nF:()=>m,py:()=>u});var n=e(2543),s=e.n(n),l=e(78368),r=e(14236),i=e(75059),g=e(85200),o=e(1173),d=e(11261),c=e(57875),a=e(28240);const p="__series.name",u="__field.displayName",m="__field.labels",v="__calc",x="__cell_",f=25,E=T=>{const{replaceVariables:S,reduceOptions:L,timeZone:O,theme:j}=T,N=L.calcs.length?L.calcs:[i.gy.last],F=[],U=(0,g.NS)(L.fields?{id:o.Ct.byRegexp,options:L.fields}:{id:o.Ct.numeric}),w=T.data??[],B=L.limit?L.limit:f;let K=!1;for(let W=0;W<w.length&&!K;W++){const z=w[W],{timeField:Y}=(0,r.KR)(z),X=new l.R(z);for(let q=0;q<z.fields.length&&!K;q++){const G=z.fields[q],te=G.getLinks;if(!U(G,z,w))continue;let H=G.config;G.state?.range&&(H={...H,...G.state?.range});let se=G.config.displayName??"";const ne=G.display??(0,c.J)({field:G,theme:T.theme,timeZone:O});if(L.values)for(let le=0;le<G.values.length;le++){G.state=y(G,F.length);const _=R(G,le),Q=ne(G.values[le]),ae=h(z,G,le,S,_),oe=b(ae,T.fieldConfig,j);if(F.push({name:"",field:H,display:{...Q,title:ae,color:oe??Q.color},view:X,colIndex:q,rowIndex:le,getLinks:te?()=>te({valueRowIndex:le}):()=>[],hasLinks:D(G)}),F.length>=B){K=!0;break}}else{const le=(0,i.Nw)({field:G,reducers:N});for(const _ of N){const Q=G.state?.scopedVars??{};Q[v]={value:_,text:_};const ae=ne(le[_]);se!==""?ae.title=S(se,Q):ae.title=(0,a.Ct)(G,z,w),ae.percentChange=T.percentChange?(0,i.Nw)({field:G,reducers:[i.gy.diffperc]}).diffperc:void 0;let oe;T.sparkline&&(oe={y:z.fields[q],x:Y},_===i.gy.last?oe.highlightIndex=oe.y.values.length-1:_===i.gy.first&&(oe.highlightIndex=0));const J=z.length===1?0:void 0;F.push({name:_,field:H,display:ae,sparkline:oe,view:X,colIndex:q,getLinks:te?()=>te({calculatedValue:ae,valueRowIndex:J}):()=>[],hasLinks:D(G)})}}}}return F.length===0&&F.push(C(T)),F};function h(T,S,L,O,j){const N=S.config.displayName;if(N)return N.indexOf(x)?O(I(N),j):O(N,j);let F=[],U=0;for(const w of T.fields)if(w!==S)if(w.type===d.PU.string){const B=w.values[L]??"",K=w.display?w.display(B).text:B;K.length>0&&F.push(K)}else w.type===d.PU.number&&U++;return(U||F.length===0)&&F.push((0,a.Ct)(S,T)),F.join(" ")}function y(T,S){return{...T.state,seriesIndex:S}}function b(T,S,L){for(const O of S.overrides)if(O.matcher.id==="byName"&&O.matcher.options===T){for(const j of O.properties)if(j.id==="color"&&j.value)return L.visualization.getColorByName(j.value.fixedColor)}return null}function D(T){return T.config?.links?.length?T.config.links.length>0:!1}function P(T){let S="",L="",O="",j="";for(let N=0;N<T.length;N++){const F=T[N].display;F.text&&F.text.length>L.length&&(L=F.text),F.title&&F.title.length>S.length&&(S=F.title),F.prefix&&F.prefix.length>O.length&&(O=F.prefix),F.suffix&&F.suffix.length>j.length&&(j=F.suffix)}return{text:L,title:S,suffix:j,prefix:O}}function C(T){const S="No data",{fieldConfig:L,timeZone:O}=T,{defaults:j}=L,F=(0,c.J)({field:{type:d.PU.other,config:j},theme:T.theme,timeZone:O})(null),U=M(F,S);return{name:S,field:{...j,max:j.max??0,min:j.min??0},display:{text:U,numeric:0,color:F.color},hasLinks:!1}}function M(T,S){return!T||(0,n.isEmpty)(T.text)?S:T.text}function I(T){return T.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(S,L,O,j,N,F,U)=>`\${__data.fields[${L??j??F}]${O??N??U}}`)}function R(T,S){return T.state?.scopedVars?.__dataContext?{...T.state?.scopedVars,__dataContext:{value:{...T.state?.scopedVars?.__dataContext.value,rowIndex:S}}}:T.state?.scopedVars}},90708:(k,A,e)=>{"use strict";e.d(A,{BF:()=>I,K3:()=>S,_M:()=>T,nJ:()=>h,rJ:()=>L,we:()=>y});var n=e(2543),s=e.n(n),l=e(96540),r=e(80292),i=e(52622),g=e(21423),o=e(14236),d=e(23596),c=e(75059),a=e(85200),p=e(11261),u=e(24293),m=e(6709),v=e(71733),x=e(57875),f=e(58563),E=e(69550);function h(j){let N=null,F=null;const U=[c.gy.min,c.gy.max];for(const w of j)for(const B of w.fields)if(B.type===p.PU.number){const K=(0,c.Nw)({field:B,reducers:U}),W=K[c.gy.min],z=K[c.gy.max];(N===null||W<N)&&(N=W),(F===null||z>F)&&(F=z)}return{min:N,max:F,delta:(F??0)-(N??0)}}function y(j){if(!j.data)return[];const N=j.fieldConfig;if(!N)return j.data;const F=j.fieldConfigRegistry??E.G;let U=0,w;const B=[];if(N.overrides)for(const K of N.overrides){const W=a.sJ.get(K.matcher.id);W&&B.push({match:W.get(K.matcher.options),properties:K.properties})}return j.data.map((K,W)=>{const z={...K};z.fields=z.fields.map(Y=>({...Y,config:(0,n.cloneDeep)(Y.config),state:{...Y.state}}));for(const Y of z.fields){const X=Y.config;Y.state.scopedVars={__dataContext:{value:{data:j.data,frame:z,frameIndex:W,field:Y}}};const q={field:Y,data:j.data,dataFrameIndex:W,replaceVariables:j.replaceVariables,fieldConfigRegistry:F};C(X,N.defaults,q);for(const se of B)if(se.match(Y,z,j.data))for(const ne of se.properties)P(X,ne,q);let G=Y.type;if(!G||G===p.PU.other){const se=(0,o.dF)(Y);se&&(G=se)}const{range:te,newGlobalRange:H}=b(X,Y,w,j.data);if(w=H,Y.state.seriesIndex=U,Y.state.range=te,Y.type=G,Y.type!==p.PU.time&&U++,Y.display=(0,x.J)({field:Y,theme:j.theme,timeZone:j.timeZone}),Y.config.unit!=="dateTimeFromNow"&&(Y.display=D(Y.display,2500)),Y.getLinks=T(z,Y,Y.state.scopedVars,q.replaceVariables,j.timeZone,j.dataLinkPostProcessor),Y.type===p.PU.nestedFrames)for(const se of Y.values)for(let ne=0;ne<se.length;ne++)for(const le of se[ne].fields)le.display=(0,x.J)({field:le,theme:j.theme,timeZone:j.timeZone}),le.state={scopedVars:{__dataContext:{value:{data:se,frame:se[ne],frameIndex:ne,field:le}}}},le.getLinks=T(se[ne],le,le.state.scopedVars,q.replaceVariables,j.timeZone,j.dataLinkPostProcessor)}return z})}function b(j,N,F,U){if(N.type!==p.PU.number||(0,n.isNumber)(j.min)&&(0,n.isNumber)(j.max))return{newGlobalRange:F};if(j.fieldMinMax){const W=(0,f.AP)(N),z=j.min??W.min,Y=j.max??W.max;return{range:{min:z,max:Y,delta:Y-z},newGlobalRange:F}}const w=F??h(U),B=j.min??w.min,K=j.max??w.max;return{range:{min:B,max:K,delta:K-B},newGlobalRange:w}}function D(j,N=2500){const F=new Map;for(let U=-1;U<=15;U++)F.set(U,new Map);return(U,w)=>{let B=F.get(w??-1),K=B.get(U);return K||(B.size===N&&B.clear(),K=j(U,w),K.color&&(K.color=(0,d.ze)(K.color)),B.set(U,K)),K}}function P(j,N,F){const w=F.fieldConfigRegistry.getIfExists(N.id);if(!w)return;const B=w.process(N.value,F,w.settings);B==null?w.isCustom&&j.custom?(0,n.unset)(j.custom,w.path):(0,n.unset)(j,w.path):w.isCustom?(j.custom||(j.custom={}),(0,n.set)(j.custom,w.path,B)):(0,n.set)(j,w.path,B)}function C(j,N,F){j.links&&N.links&&(j.links=[...j.links,...N.links]);for(const U of F.fieldConfigRegistry.list())U.isCustom&&!j.custom&&(j.custom={}),M(U.isCustom?j.custom:j,U.isCustom?N.custom:N,U,F);I(j)}function M(j,N,F,U){const w=(0,n.get)(j,F.path);if(w==null){const B=U.fieldConfigRegistry.getIfExists(F.id);if(!B)return;if(B&&B.shouldApply(U.field)){const K=B.process((0,n.get)(N,B.path),U,B.settings);K!=null&&(0,n.set)(j,B.path,K)}}}function I(j){const{thresholds:N}=j;if(j.color?j.color.mode||delete j.color:N&&(j.color={mode:u.Y.Thresholds}),j.hasOwnProperty("min")&&j.hasOwnProperty("max")&&j.min>j.max){const F=j.max;j.max=j.min,j.min=F}}const R=j=>{const{link:N,linkModel:F,dataLinkScopedVars:U,field:w,replaceVariables:B}=j;return N.internal?(0,m.u)({link:N,internalLink:N.internal,scopedVars:U,field:w,range:N.internal.range,replaceVariables:B}):F},T=(j,N,F,U,w,B)=>K=>!N.config.links||N.config.links.length===0?[]:N.config.links.map(z=>{const Y=O(j,N,F),X={...F,__dataContext:Y},q=(H,se,ne)=>U(H,{...X,...se},ne);K.valueRowIndex!==void 0&&!isNaN(K.valueRowIndex)?Y.value.rowIndex=K.valueRowIndex:Y.value.calculatedValue=K.calculatedValue;let G,te=z.onClick||!z.onBuildUrl?z.url:z.onBuildUrl({origin:N,replaceVariables:q});return te&&(te=v.I.assureBaseUrl(te.replace(/\n/g,"")),te=U(te,X,i.$m.UriEncode),te=v.I.processUrl(te)),z.onClick?G={href:te,title:U(z.title||"",X),target:z.targetBlank?"_blank":void 0,onClick:(H,se)=>{z.onClick({origin:se??N,e:H,replaceVariables:q})},origin:N}:G={href:te,title:U(z.title||"",X),target:z.targetBlank?"_blank":void 0,origin:N},(B||R)({frame:j,field:N,dataLinkScopedVars:X,replaceVariables:U,config:K,link:z,linkModel:G})}).filter(z=>!!z);function S(j){if(!j||j.length===0)return[];const N=[...j],F=(0,x.H)();for(let U=0;U<N.length;U++){const w={...N[U]},B=[...w.fields];for(let K=0;K<B.length;K++)B[K]={...B[K],display:F};N[U]={...w,fields:B}}return N}function L(j,N,F,U,w,B,K){const W=j?.fieldConfigRegistry,z=(0,l.useRef)(0),Y=(0,r.A)(F?.series);return(0,l.useMemo)(()=>{if(!W||!N||!F)return;const X=F?.series;F.structureRev==null&&X&&Y&&!(0,g.J3)(X,Y,g.bW)&&z.current++;const q={structureRev:z.current,...F,series:y({data:X,fieldConfig:N,fieldConfigRegistry:W,replaceVariables:B,theme:w,timeZone:U,dataLinkPostProcessor:K})};return F.annotations&&F.annotations.length>0&&(q.annotations=y({data:F.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:B,theme:w,timeZone:U,dataLinkPostProcessor:K})),q},[W,N,F,Y,U,w,B,K])}function O(j,N,F){return F?.__dataContext?{value:{...F.__dataContext.value}}:{value:{frame:j,field:N,data:[j]}}}},28240:(k,A,e)=>{"use strict";e.d(A,{Ct:()=>o,Fm:()=>i,Ri:()=>r,fk:()=>c,j2:()=>g});var n=e(85200),s=e(11261),l=e(8249);function r(p,u){if(p.name)return p.name;const m=[];for(const v of p.fields)if(v.type!==s.PU.time){if(m.length>1)break;m.push(o(v,p))}return m.length===1?m[0]:u===void 0&&p.fields.length>0?p.fields.filter(v=>v.type!==s.PU.time).map(v=>o(v,p)).join(", "):p.refId?`Series (${p.refId})`:`Series (${u})`}function i(p){p.forEach(u=>{u.fields.forEach(m=>{o(m,u,p)})})}function g(p,u){p.forEach(m=>{m.fields.forEach(v=>{const x={legend:!1,tooltip:!1,viz:!1,...u.defaults.custom?.hideFrom},f=v.config.custom?.hideFrom;u.overrides.forEach(E=>{if("__systemRef"in E)return;if((0,n.NS)(E.matcher)(v,m,p))for(const y of E.properties)y.id==="custom.hideFrom"&&Object.assign(x,y.value)}),v.state={...v.state,hideFrom:{...f}},v.config.custom.hideFrom=x})})}function o(p,u,m){const v=p.state?.displayName,x=!!(m&&m.length>1);if(v&&x===p.state?.multipleFrames)return v;const f=d(p,u,m);return p.state=p.state||{},p.state.displayName=f,p.state.multipleFrames=x,f}function d(p,u,m){const v=p.config?.displayName&&p.config?.displayName.length,x=!!u?.meta?.timeCompare?.isTimeShiftQuery;let f=v?p.config.displayName:p.name;if(v)return x?`${f} (comparison)`:f;if(u&&p.config?.displayNameFromDS)return x?`${p.config.displayNameFromDS} (comparison)`:p.config.displayNameFromDS;if(p.type===s.PU.time&&!p.labels)return f??s.LE;let E=[],h=!1;if(m&&m.length>1){for(let D=1;D<m.length;D++)if(m[D].name!==m[D-1].name){h=!0;break}}let y=!1,b=!1;if(h&&u?.name&&(E.push(u.name),y=!0),p.name&&p.name!==s.Bc&&E.push(p.name),p.labels&&u){let D=a(m??[u]);if(D)p.labels[D]&&(E.push(p.labels[D]),b=!0);else{let P=(0,l.h6)(p.labels);P&&(E.push(P),b=!0)}}return u&&!y&&!b&&p.name===s.Bc&&u.name&&u.name.length>0&&(E.push(u.name),y=!0),E.length?f=E.join(" "):p.name?f=p.name:f=s.Bc,f===p.name&&(f=c(p,u)),x&&(f=`${f} (comparison)`),f}function c(p,u){let m=0,v=!1;if(u)for(let x=0;x<u.fields.length;x++){const f=u.fields[x];if(p===f){if(v=!0,m>0){m++;break}}else if(p.name===f.name&&(m++,v))break}return m?`${p.name} ${m}`:p.name}function a(p){let u=null;for(let m=0;m<p.length;m++){const v=p[m];for(const x of v.fields)if(x.labels){for(const f in x.labels)if(u===null)u=f;else if(f!==u)return null}}return u}},92461:(k,A,e)=>{"use strict";e.d(A,{F:()=>i});var n=e(2543),s=e.n(n),l=e(83195),r=e(57875);function i(g){return new Proxy({},{get:(o,d)=>{let c=g.frame.fields.find(m=>d===m.name);if(!c){const m=(0,n.toNumber)(d);c=g.frame.fields[m]}if(c||(c=g.frame.fields.find(m=>d===m.config.displayName)),c||(c=g.frame.fields.find(m=>m.labels?d===m.labels.name:!1)),!c)return;const a=c.display??(0,r.J)(),p=c.values[g.rowIndex],u=a(p);return u.toString=()=>(0,l.cN)(u),u}})}},27310:(k,A,e)=>{"use strict";e.d(A,{AM:()=>l,Ch:()=>r,FM:()=>a,N7:()=>d,OU:()=>o,X4:()=>p,hL:()=>g,hS:()=>n,lG:()=>c,m0:()=>s,xT:()=>i});const n=u=>u,s=(u,m,v)=>{if(u!=null)return parseFloat(u)},l=(u,m,v)=>(delete m.field?.state?.displayName,o(u,m,v)),r=(u,m,v)=>u,i=(u,m,v)=>u,g=(u,m,v)=>u,o=(u,m,v)=>u==null?u:v&&v.expandTemplateVars&&m.replaceVariables&&typeof u=="string"?m.replaceVariables(u,m.field.state.scopedVars):`${u}`,d=(u,m,v)=>u,c=(u,m,v)=>u,a=(u,m,v)=>u;var p=(u=>(u.IncludeAll="all",u.ExcludeBaseNames="exclude",u.OnlyBaseNames="only",u))(p||{})},58563:(k,A,e)=>{"use strict";e.d(A,{AP:()=>c,jc:()=>o,xg:()=>a});var n=e(2543),s=e.n(n),l=e(75059),r=e(11261),i=e(8066),g=e(47737);function o(p,u){if(p.type===r.PU.boolean)return d(p,u);const v=(0,i.Qi)(p).getCalculator(p,u),x=p.state?.range??c(p);return f=>{let E=0;f!==-1/0&&(E=(f-x.min)/x.delta,Number.isNaN(E)&&(E=0));const h=(0,g.k5)(p,f,E);return{percent:E,threshold:h,color:v(f,E,h)}}}function d(p,u){const m={color:u.visualization.getColorByName("green"),percent:1,threshold:void 0},v={color:u.visualization.getColorByName("red"),percent:0,threshold:void 0},x=(0,i.Qi)(p);if(x.isContinuous&&x.getColors){const f=x.getColors(u);m.color=f[f.length-1],v.color=f[0]}return f=>f?m:v}function c(p){if(p.type!==r.PU.number)return{min:0,max:100,delta:100};let u=p.config.min,m=p.config.max;if(!(0,n.isNumber)(u)||!(0,n.isNumber)(m))if(p.values&&p.values.length){const v=(0,l.Nw)({field:p,reducers:[l.gy.min,l.gy.max]});(0,n.isNumber)(u)||(u=v[l.gy.min]),(0,n.isNumber)(m)||(m=v[l.gy.max])}else u=0,m=100;return{min:u,max:m,delta:m-u}}function a(p,u){const{config:m}=p;let{min:v,max:x}=m;return(0,n.isNumber)(v)&&(0,n.isNumber)(x)?m:u||!p.state?.range?{...m,...c(p)}:{...m,...p.state.range}}},69550:(k,A,e)=>{"use strict";e.d(A,{D:()=>r,G:()=>l});var n=e(83077),s=e(66670);const l=new s.K,r=new n.O},47737:(k,A,e)=>{"use strict";e.d(A,{QS:()=>l,RU:()=>g,k5:()=>i,yQ:()=>r});var n=e(24293),s=e(50082);const l={value:0,color:n.F};function r(o,d){if(!d||d.length===0)return l;let c=d[0];for(const a of d)if(o>=a.value)c=a;else break;return c}function i(o,d,c){const{thresholds:a}=o.config;return a?.mode===s.O.Percentage?r(c*100,a?.steps):r(d,a?.steps)}function g(o){return o.sort((d,c)=>d.value-c.value)}},33459:(k,A,e)=>{"use strict";e.r(A),e.d(A,{AbstractLabelOperator:()=>Un.D_,AlertState:()=>Gt.O,AnnotationChangeEvent:()=>D.We,AnnotationEventFieldSource:()=>wn.V,AppEvents:()=>At.r1,AppPlugin:()=>It.hX,ArrayDataFrame:()=>c.f,ArrayVector:()=>ls,BinaryOperationID:()=>xe.k,BusEventBase:()=>y.a,BusEventWithPayload:()=>y.x,ByNamesMatcherMode:()=>_e.PP,CSVHeaderStyle:()=>_.F7,CSVReader:()=>_.i8,CircularDataFrame:()=>vs.x,CircularVector:()=>pn.$,CoreApp:()=>It.Jk,CustomVariableSupport:()=>Lt.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>L.Pm,DEFAULT_SAML_NAME:()=>ut.En,DashboardCursorSync:()=>cs.y,DashboardLoadedEvent:()=>D.gc,DataFrameType:()=>wt.m,DataFrameView:()=>s.R,DataHoverClearEvent:()=>D.ql,DataHoverEvent:()=>D.b_,DataLinkBuiltInVars:()=>K.c,DataLinkConfigOrigin:()=>Zn.x0,DataQueryErrorType:()=>lt.v2,DataSelectEvent:()=>D.LO,DataSourceApi:()=>lt.mA,DataSourcePlugin:()=>lt.tD,DataSourcePluginContextProvider:()=>qt.p,DataSourceTestFailed:()=>D.LL,DataSourceTestSucceeded:()=>D.NI,DataSourceUpdatedSuccessfully:()=>D.wE,DataSourceVariableSupport:()=>Lt.ZV,DataTopic:()=>m.QR,DataTransformerID:()=>qe.F,DefaultTimeZone:()=>vn.lE,DocsId:()=>W.f,EventBusSrv:()=>b.o,ExploreMode:()=>lt.ZF,FALLBACK_COLOR:()=>An.F,FeatureState:()=>It.Ay,FieldCache:()=>l.L,FieldColorModeId:()=>An.Y,FieldConfigEditorBuilder:()=>F.bk,FieldConfigOptionsRegistry:()=>C.K,FieldConfigProperty:()=>vt.uo,FieldMatcherID:()=>We.Ct,FieldNamePickerBaseNameMode:()=>N.X4,FieldType:()=>Ft.PU,FrameGeometrySourceMode:()=>m.aG,FrameMatcherID:()=>We.jR,GAUGE_DEFAULT_MAXIMUM:()=>ut.d1,GAUGE_DEFAULT_MINIMUM:()=>ut.tw,GrafanaPlugin:()=>Ge.Ud,GrafanaThemeType:()=>Dn.I,ISO_8601:()=>De.mt,InternalTimeZones:()=>Ie.g$,LanguageProvider:()=>lt.Is,LayoutModes:()=>Tt.R,LegacyGraphHoverClearEvent:()=>At.Tq,LegacyGraphHoverEvent:()=>At.kb,LegacyMappingType:()=>q.An,LiveChannelConnectionState:()=>Tn.ZF,LiveChannelEventType:()=>Tn.o4,LiveChannelScope:()=>Tn.qD,LiveChannelType:()=>Tn.os,LoadingState:()=>Ht.Gu,LocalStorageValueProvider:()=>Ue.b,LogLevel:()=>On.$b,LogRowContextQueryDirection:()=>On.ZF,LogsDedupDescription:()=>On._C,LogsDedupStrategy:()=>m.fY,LogsMetaKind:()=>On.tG,LogsSortOrder:()=>m.uH,LogsVolumeType:()=>On.Aj,MISSING_VALUE:()=>r.p,MappingType:()=>zt.d,MatcherID:()=>We.cV,MutableDataFrame:()=>r.k,NodeGraphDataFrameFieldNames:()=>ue.u,NullValueMode:()=>Ht.UW,NumericLogLevel:()=>On.s5,OneClickMode:()=>Zn.yd,OrgRole:()=>Nt.X,PageLayoutType:()=>ln.k,PanelEvents:()=>At.ee,PanelOptionsEditorBuilder:()=>F.pv,PanelPlugin:()=>jt.m,PluginContextProvider:()=>Yt.a,PluginErrorCode:()=>Ge.ZK,PluginExtensionPoints:()=>ht.S,PluginExtensionTypes:()=>ht.u,PluginIncludeType:()=>Ge.ib,PluginSignatureStatus:()=>Ge.Ac,PluginSignatureType:()=>Ge.kv,PluginState:()=>Ge.pn,PluginType:()=>Ge.QE,ReducerID:()=>Ce.gy,Registry:()=>se.O,SetPanelAttentionEvent:()=>D.Tp,SpecialValue:()=>Ot.N,SpecialValueMatch:()=>zt.W,StandardVariableSupport:()=>Lt.J$,StreamingDataFrame:()=>d.k9,StreamingFrameAction:()=>d.Kh,SupplementaryQueryType:()=>On.cF,SupportedTransformationType:()=>Zn.CC,SystemDateFormatsState:()=>ke.JE,TIME_FORMAT:()=>vn.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>Ft.aI,TIME_SERIES_TIME_FIELD_NAME:()=>Ft.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>Ft.Bc,ThemeContext:()=>Ee.D,ThresholdsMode:()=>Xn.O,TransformationApplicabilityLevels:()=>Ot.M,TransformerCategory:()=>Ke.m,UnaryOperationID:()=>re._,VAR_CALC:()=>L.k_,VAR_CELL_PREFIX:()=>L.a_,VAR_FIELD_LABELS:()=>L.nF,VAR_FIELD_NAME:()=>L.py,VAR_SERIES_NAME:()=>L.k3,ValueMatcherID:()=>We.Js,VariableHide:()=>Pn.zL,VariableOrigin:()=>Zn.$0,VariableRefresh:()=>Pn.CO,VariableSort:()=>Pn.ZG,VariableSuggestionsScope:()=>Zn.uP,VariableSupportBase:()=>Lt.xi,VariableSupportType:()=>Lt.Qz,VisualizationSuggestionScore:()=>Ve.nQ,VisualizationSuggestionsBuilder:()=>Ve.v2,VisualizationSuggestionsListAppender:()=>Ve.NV,VizOrientation:()=>Ve.wV,addDurationToDate:()=>pt.Ri,addRow:()=>o.uY,amendTable:()=>n.c,anySeriesWithTimeField:()=>o.tP,anyToNumber:()=>Y.t,applyFieldOverrides:()=>I.we,applyNullInsertThreshold:()=>Dt.M,applyRawFieldOverrides:()=>I.K3,arrayToDataFrame:()=>c.I,arrayUtils:()=>ge,availableIconsIndex:()=>Ut.az,binaryOperators:()=>xe.b,booleanOverrideProcessor:()=>N.FM,booleanValueFormatter:()=>Pe.Qc,buildHistogram:()=>at.p3,cacheFieldDisplayNames:()=>T.Fm,classicColors:()=>J,closestIdx:()=>d.Ls,colorManipulator:()=>fe.MV,compareArrayValues:()=>p.J3,compareDataFrameStructures:()=>p.bW,containsSearchFilter:()=>G.E,convertOldAngularValueMappings:()=>q.bh,createDataFrame:()=>i.EI,createDimension:()=>g.r4,createFieldConfigRegistry:()=>sn.O,createTheme:()=>pe.a,dataFrameFromJSON:()=>a.or,dataFrameToJSON:()=>a.Nw,dataLinksOverrideProcessor:()=>N.Ch,dateMath:()=>he,dateTime:()=>De.KQ,dateTimeAsMoment:()=>De.AN,dateTimeForTimeZone:()=>De.oZ,dateTimeFormat:()=>dt.LE,dateTimeFormatISO:()=>dt.M7,dateTimeFormatTimeAgo:()=>dt.fq,dateTimeFormatWithAbbrevation:()=>dt._Q,dateTimeParse:()=>Pt.b,decodeFieldValueEntities:()=>a.t,decodeFieldValueEnums:()=>a.EL,defaultCalcs:()=>Ce.C6,deprecationWarning:()=>le.l,displayNameOverrideProcessor:()=>N.AM,doStandardCalcs:()=>Ce.H3,durationToMilliseconds:()=>pt.WT,ensureTimeField:()=>Ct.ks,escapeRegex:()=>v.$f,escapeStringForRegex:()=>v.jD,eventFactory:()=>h.R,fieldColorModeRegistry:()=>P.uf,fieldMatchers:()=>we.sJ,fieldReducers:()=>Ce.AS,filterFieldConfigOverrides:()=>$t.aW,findCommonLabels:()=>Q.yO,findHighlightChunksInText:()=>x.Oq,findMatchesInText:()=>x.bs,findUniqueLabels:()=>Q.s6,fixCellTemplateExpressions:()=>L.Zo,formatLabels:()=>Q.h6,formattedValueToString:()=>Pe.cN,frameMatchers:()=>we.RE,getActiveThreshold:()=>M.yQ,getAllValuesFromDimension:()=>g.Km,getBuiltInThemes:()=>Se.k,getColumnFromDimension:()=>g.P4,getColumnsFromDimension:()=>g.g6,getDataFrameRow:()=>i.Yn,getDataSourceRef:()=>ne.p$,getDataSourceUID:()=>ne.Iz,getDefaultRelativeTimeRange:()=>vn.Cn,getDefaultTimeRange:()=>vn.E2,getDimensionByName:()=>g.xB,getDisplayProcessor:()=>O.J,getDisplayValueAlignmentFactors:()=>L.XS,getFieldColorMode:()=>P.Hs,getFieldColorModeForField:()=>P.Qi,getFieldConfigWithMinMax:()=>S.xg,getFieldDisplayName:()=>T.Ct,getFieldDisplayValues:()=>L.PI,getFieldDisplayValuesProxy:()=>R.F,getFieldMatcher:()=>we.NS,getFieldSeriesColor:()=>P.lz,getFieldTypeFromValue:()=>i.oE,getFlotPairs:()=>U.R,getFlotPairsConstant:()=>U.r,getFrameDisplayName:()=>T.Ri,getFrameMatchers:()=>we.Dq,getHistogramFields:()=>at.ix,getLinksSupplier:()=>I._M,getLocale:()=>De.JK,getLocaleData:()=>De.XN,getMinMaxAndDelta:()=>S.AP,getNextRefId:()=>u.M,getPanelOptionsWithDefaults:()=>$t.F,getProcessedDataFrames:()=>i.Bt,getRawDisplayProcessor:()=>O.H,getRowUniqueId:()=>o.t9,getScaleCalculator:()=>S.jc,getSearchFilterScopedVar:()=>G.c,getSeriesTimeStep:()=>ee,getThemeById:()=>Se.g,getTimeField:()=>i.KR,getTimeZone:()=>Ae.O,getTimeZoneGroups:()=>Ie.U3,getTimeZoneInfo:()=>Ie.QZ,getTimeZones:()=>Ie.P3,getUniqueFieldName:()=>T.fk,getValueFormat:()=>Pe.j_,getValueFormats:()=>Pe.Ke,getValueFormatterIndex:()=>Pe.uH,getValueFromDimension:()=>g.WK,getValueMatcher:()=>we.kK,getWeekdayIndex:()=>De.xQ,getWeekdayIndexByEnglishName:()=>De.pp,getZone:()=>Ie.HD,guessDecimals:()=>ae.E,guessFieldTypeForField:()=>i.dF,guessFieldTypeFromNameAndValue:()=>i.by,guessFieldTypeFromValue:()=>i.HW,guessFieldTypes:()=>i.XQ,hasLinks:()=>L.eG,hasLogsContextSupport:()=>On.Ol,hasLogsContextUiSupport:()=>On.wj,hasMsResolution:()=>de,hasQueryExportSupport:()=>Un.Ee,hasQueryImportSupport:()=>Un.FL,hasQueryModificationSupport:()=>On._0,hasSupplementaryQuerySupport:()=>On.Nc,hasTimeField:()=>o.S1,hasToggleableQueryFiltersSupport:()=>On.FP,histogramBucketSizes:()=>at.rW,histogramFieldInfo:()=>at.Rt,histogramFieldsToFrame:()=>at.cg,histogramFrameBucketMaxFieldName:()=>at.dA,histogramFrameBucketMinFieldName:()=>at.d$,histogramTransformer:()=>at.OA,identityOverrideProcessor:()=>N.hS,incrRound:()=>at.ZU,incrRoundDn:()=>at.rs,incrRoundUp:()=>at.Uh,intervalToAbbreviatedDurationString:()=>pt.dU,isBooleanUnit:()=>Pe.j9,isCustomFieldProp:()=>$t.TQ,isDataFrame:()=>i.ci,isDataFrameWithValue:()=>i.LI,isDataSourcePluginContext:()=>Mt.S,isDataSourceRef:()=>ne.fN,isDateTime:()=>De.Ar,isDateTimeInput:()=>De.u8,isEmptyObject:()=>oe.R,isHistogramFrameBucketMaxFieldName:()=>at.H1,isHistogramFrameBucketMinFieldName:()=>at.NX,isIconName:()=>Ut.n6,isLikelyAscendingVector:()=>Fe.g2,isLiveChannelJoinEvent:()=>Tn.Cz,isLiveChannelLeaveEvent:()=>Tn.jQ,isLiveChannelMessageEvent:()=>Tn.Z7,isLiveChannelStatusEvent:()=>Tn.ew,isObject:()=>Ht.Gv,isReducerID:()=>Ce.Em,isStandardFieldProp:()=>$t.nx,isSystemOverride:()=>vt.Ow,isSystemOverrideWithRef:()=>vt.ZW,isTableData:()=>i.pH,isTimeSeriesField:()=>o.hF,isTimeSeriesFrame:()=>o.aH,isTimeSeriesFrames:()=>o.jq,isTruthy:()=>Ht.zz,isUnsignedPluginSignature:()=>Jt.x,isValidDate:()=>pt.vd,isValidDuration:()=>pt.di,isValidGoDuration:()=>pt.pp,isValidGrafanaDuration:()=>pt.V3,isValidLiveChannelAddress:()=>Tn.aj,localTimeFormat:()=>ke.Od,locale:()=>Pe.Hg,locationUtil:()=>w.I,makeClassES5Compatible:()=>z.Y,makeTimeRange:()=>vn.HW,mapInternalLinkToExplore:()=>K.u,matchAllLabels:()=>Q._p,matchPluginId:()=>H._,monacoLanguageRegistry:()=>ze.l,nullToValue:()=>tt.C,numberOverrideProcessor:()=>N.m0,objRemoveUndefined:()=>oe.w,onUpdateDatasourceJsonDataOption:()=>ne.PG,onUpdateDatasourceJsonDataOptionChecked:()=>ne.EX,onUpdateDatasourceJsonDataOptionSelect:()=>ne.BD,onUpdateDatasourceOption:()=>ne.zX,onUpdateDatasourceResetOption:()=>ne.yV,onUpdateDatasourceSecureJsonDataOption:()=>ne.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>ne.wY,outerJoinDataFrames:()=>Fe.Fd,parseDuration:()=>pt.E9,parseFlags:()=>x.bQ,parseLabels:()=>Q.Xy,parseLiveChannelAddress:()=>Tn.DG,patchArrayVectorProrotypeMethods:()=>Qe.V,preProcessPanelData:()=>i.N$,preferredVisualizationTypes:()=>Ht.Nx,rangeUtil:()=>be,readCSV:()=>_.Jh,reduceField:()=>Ce.Nw,renderLegendFormat:()=>te.j,renderMarkdown:()=>f.G,renderTextPanelMarkdown:()=>f.P,restoreCustomOverrideRules:()=>$t.H9,reverseDataFrame:()=>i.q7,roundDecimals:()=>ae.h,scaledUnits:()=>Pe.yP,scopeFilterOperatorMap:()=>St.n,selectOverrideProcessor:()=>N.hL,serializeStateToUrlParam:()=>B.Pp,setLocale:()=>De.xS,setTimeZoneResolver:()=>Ae.G,setWeekStart:()=>De.$D,shallowCompare:()=>p.ab,simpleCountUnit:()=>Pe.UR,sortDataFrame:()=>i.ES,sortThresholds:()=>M.RU,standardEditorsRegistry:()=>j.D,standardFieldConfigEditorRegistry:()=>j.G,standardTransformers:()=>Xe.c,standardTransformersRegistry:()=>Ke.h,store:()=>Oe.M,stringFormater:()=>Pe.cH,stringOverrideProcessor:()=>N.OU,stringStartsAsRegEx:()=>v.AP,stringToJsRegex:()=>v.dO,stringToMs:()=>v.dc,systemDateFormats:()=>ke.WC,textUtil:()=>E.sQ,thresholdsOverrideProcessor:()=>N.N7,timeZoneAbbrevation:()=>dt.jw,timeZoneFormatUserFriendly:()=>Ie.le,toCSV:()=>_._O,toDataFrame:()=>i.Vc,toDataFrameDTO:()=>i.Kl,toDuration:()=>De.Ah,toFilteredDataFrameDTO:()=>i.By,toFixed:()=>Pe.Mg,toFixedScaled:()=>Pe.gZ,toFixedUnit:()=>Pe.G8,toFloatOrUndefined:()=>v.$D,toIconName:()=>Ut.Uo,toIntegerOrUndefined:()=>v.vb,toLegacyResponseData:()=>i.w3,toLiveChannelId:()=>Tn.Qp,toNumberString:()=>v.kT,toOption:()=>Te.z,toPascalCase:()=>v.MX,toURLRange:()=>B.sQ,toUtc:()=>De.yT,transformDataFrame:()=>je.m,trimTable:()=>n.F,unEscapeStringFromRegex:()=>v.xb,unaryOperators:()=>re.j,unitOverrideProcessor:()=>N.lG,updateDatasourcePluginJsonDataOption:()=>ne.lO,updateDatasourcePluginOption:()=>ne.pN,updateDatasourcePluginResetOption:()=>ne.QP,updateDatasourcePluginSecureJsonDataOption:()=>ne.wp,urlUtil:()=>B.kM,useFieldOverrides:()=>I.rJ,usePluginContext:()=>bn.Q,userHasAllPermissions:()=>ea.Fj,userHasAnyPermission:()=>ea.jW,userHasPermission:()=>ea.ZU,userHasPermissionInMetadata:()=>ea.T6,validateFieldConfig:()=>I.BF,valueMappingsOverrideProcessor:()=>N.xT,valueMatchers:()=>we.hI,vectorator:()=>Jn.E,withLoadingIndicator:()=>X.k});var n=e(67414),s=e(78368),l=e(85404),r=e(37471),i=e(14236),g=e(61443),o=e(19845),d=e(9631),c=e(33948),a=e(89667),p=e(21423),u=e(77789),m=e(52622),v=e(54479),x=e(21),f=e(36663),E=e(80997),h=e(89550),y=e(65463),b=e(18226),D=e(69129),P=e(8066),C=e(66670),M=e(47737),I=e(90708),R=e(92461),T=e(28240),S=e(58563),L=e(56323),O=e(57875),j=e(69550),N=e(27310),F=e(60264),U=e(39306),w=e(71733),B=e(76885),K=e(6709),W=e(87885),z=e(92341),Y=e(28802),X=e(72495),q=e(62398),G=e(92053),te=e(43659),H=e(80147),se=e(83077),ne=e(22391),le=e(95344),_=e(72436),Q=e(8249),ae=e(97706),oe=e(92041);const J=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],ee=Ks=>{let Hs,bs,Ys=Number.MAX_VALUE;for(let La=0;La<Ks.values.length;La++){const Xs=Ks.values[La];if(Hs!==void 0){const Ta=Xs-Hs;bs===void 0&&(Ys=Ta),Ta<Ys&&(Ys=Ta)}Hs=Xs}return Ys},de=Ks=>{for(let Hs=0;Hs<Ks.values.length;Hs++){const bs=Ks.values[Hs];if(bs!=null){const Ys=bs.toString();if(Ys.length===13&&Ys%1e3!==0)return!0}}return!1};var xe=e(11710),re=e(27618),ue=e(25352),Te=e(50877),ge=e(14588),Oe=e(68941),Ue=e(7144),Xe=e(57934),we=e(85200),qe=e(18282),We=e(1173),Ce=e(75059),je=e(2514),Ke=e(97497),_e=e(58972),Fe=e(73060),at=e(77678),Ct=e(50311),Dt=e(46294),tt=e(39624),ze=e(96915),pe=e(75972),Se=e(97594),fe=e(23596),Ee=e(60578),Pe=e(83195),he=e(85858),be=e(65879),Ae=e(1933),De=e(47232),Ie=e(91410),ke=e(42994),dt=e(72724),Pt=e(53531),pt=e(70416),Tt=e(19484),jt=e(65158),$t=e(581),sn=e(28528),Yt=e(13834),qt=e(76287),bn=e(92470),Mt=e(95187),Jt=e(51527),Ut=e(8887),Gt=e(43585),Lt=e(29505),At=e(26272),Nt=e(62625),Dn=e(25137),An=e(24293),Pn=e(12470),Xn=e(50082),Tn=e(55004),ht=e(74135),St=e(37891),Ge=e(43429),Ve=e(47070),lt=e(40187),It=e(41987),Qe=e(35853),vt=e(37055),Ot=e(81010),zt=e(25019),vn=e(43127),ln=e(64388),On=e(9557),wn=e(8790),Un=e(73372),cs=e(94624),Zn=e(91890),wt=e(41260),Ft=e(11261),Ht=e(39070),ut=e(58649),pn=e(36120),Jn=e(18008);const Qn="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let fs=!1;class ls extends Array{get buffer(){return this}set buffer(Hs){this.length=0;const bs=Hs?.length;if(bs){let Ys=65e3,La=Math.ceil(bs/Ys);for(let Xs=0;Xs<La;Xs++)this.push.apply(this,Hs.slice(Xs*Ys,(Xs+1)*Ys))}}constructor(Hs){super(),this.buffer=Hs??[],fs||(console.warn(Qn),fs=!0)}toJSON(){return[...this]}}var vs=e(33526),ea=e(29263)},96915:(k,A,e)=>{"use strict";e.d(A,{l:()=>s});var n=e(83077);const s=new n.O},65158:(k,A,e)=>{"use strict";e.d(A,{m:()=>d});var n=e(2543),s=e.n(n),l=e(66670),r=e(43429),i=e(60264),g=e(95344),o=e(28528);class d extends r.Ud{constructor(a){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new l.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=a}get defaults(){let a=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const p=new i.pv;this.optionsSupplier(p,{data:[]});for(const u of p.getItems())u.defaultValue!=null&&(0,n.set)(a,u.path,u.defaultValue)}return a}get fieldConfigDefaults(){const a=this._fieldConfigDefaults.defaults;a.custom={};for(const p of this.fieldConfigRegistry.list())p.defaultValue!==void 0&&(0,n.set)(a,p.id,p.defaultValue);return{defaults:{...a},overrides:this._fieldConfigDefaults.overrides}}setDefaults(a){return(0,g.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=a,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(a){return(0,g.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=a,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(a){return this.onPanelMigration=a,this}setPanelChangeHandler(a){return this.onPanelTypeChanged=a,this}setPanelOptions(a){return this.optionsSupplier=a,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(a){return this.dataSupport={...this.dataSupport,...a},this}useFieldConfig(a={}){return this._initConfigRegistry=()=>(0,o.O)(a,this.meta.name),this}setSuggestionsSupplier(a){return this.suggestionsSupplier=a,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(a){return this.meta.id===a}}},581:(k,A,e)=>{"use strict";e.d(A,{F:()=>o,H9:()=>m,TQ:()=>v,aW:()=>c,nx:()=>x});var n=e(2543),s=e.n(n),l=e(8066),r=e(24293),i=e(37055),g=e(50082);function o({plugin:f,currentOptions:E,currentFieldConfig:h,isAfterPluginChange:y}){const b=(0,n.mergeWith)({},f.defaults,E||{},(C,M)=>{if((0,n.isArray)(M))return M}),D=d(h,f),P=p(f,D,y);return{options:b,fieldConfig:P}}function d(f,E){const h=E.fieldConfigDefaults,y={defaults:(0,n.mergeWith)({},h.defaults,f?f.defaults:{},(b,D)=>{if((0,n.isArray)(D))return D}),overrides:f?.overrides??[]};a(y.defaults,"",E.fieldConfigRegistry),y.defaults.thresholds&&u(y.defaults.thresholds),y.overrides=c(y.overrides,b=>E.fieldConfigRegistry.getIfExists(b.id)!==void 0);for(const b of y.overrides)for(const D of b.properties)D.id==="thresholds"&&u(D.value);return y}function c(f,E){return f.map(h=>{const y=h.properties.filter(E);return{...h,properties:y}})}function a(f,E,h){let y=!1;for(const[b,D]of Object.entries(f)){const P=`${E}${b}`,C=!!h.getIfExists(P);if(C){y=!0;continue}(0,n.isArray)(D)||!(0,n.isObject)(D)?C||(0,n.unset)(f,b):a(D,`${P}.`,h)||(0,n.unset)(f,b)}return y}function p(f,E,h){if(!h)return E;const y=f.fieldConfigRegistry.getIfExists(i.uo.Color);if(y&&y.settings){const b=y.settings,D=l.uf.getIfExists(E.defaults.color?.mode);if(!b.byValueSupport&&(!D||D.isByValue))return E.defaults.color={mode:r.Y.PaletteClassic},E;if(b.byValueSupport&&b.preferThresholdsMode&&D?.id!==r.Y.Fixed&&(!D||!D.isByValue))return E.defaults.color={mode:r.Y.Thresholds},E;if(b.bySeriesSupport&&D?.isByValue)return E.defaults.color={mode:r.Y.PaletteClassic},E}return E}function u(f){f.mode||(f.mode=g.O.Absolute),f.steps?f.steps.length&&(f.steps[0].value=-1/0):f.steps=[]}function m(f,E){const h={defaults:{...f.defaults,custom:E.defaults.custom},overrides:[...f.overrides]};for(const y of E.overrides)for(const b of y.properties)if(v(b)){const D=h.overrides.find(P=>(0,n.isEqual)(P.matcher,y.matcher));D?D!==y&&D.properties.push(b):h.overrides.push(y)}return h}function v(f){return f.id.startsWith("custom.")}function x(f){return!v(f)}},28528:(k,A,e)=>{"use strict";e.d(A,{O:()=>r});var n=e(66670),s=e(69550),l=e(60264);function r(g={},o){const d=new n.K,c=s.G.list(),a={};if(g.useCustomConfig){const p=new l.bk;g.useCustomConfig(p);for(const u of p.getRegistry().list())if(u.isCustom=!0,u.id="custom."+u.id,i(u,c)){const m=a[u.category[0]]??[];m.push(u),a[u.category[0]]=m}else d.register(u)}for(let p of c){const u=p.id;if(!(g.disableStandardOptions&&g.disableStandardOptions.indexOf(u)>-1)){if(g.standardOptions){const m=g.standardOptions[u]?.hideFromDefaults,v=g.standardOptions[u]?.defaultValue,x=g.standardOptions[u]?.settings;m&&(p={...p,hideFromDefaults:m}),v&&(p={...p,defaultValue:v}),x&&(p={...p,settings:p.settings?{...p.settings,...x}:x})}if(d.register(p),p.category&&a[p.category[0]])for(let m of a[p.category[0]])d.register(m)}}for(const p of d.list())if(p.path.indexOf("[")>0)throw new Error(`[${o}] Field config paths do not support arrays: ${p.id}`);return d}function i(g,o){return!!o.find(d=>g.category&&d.category&&g.category[0]===d.category[0])}},77789:(k,A,e)=>{"use strict";e.d(A,{M:()=>n});const n=l=>{for(let r=0;;r++){const i=s(r);if(!l.some(g=>g.refId===i))return i}};function s(l){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return l<r.length?r[l]:s(Math.floor(l/r.length)-1)+r[l%r.length]}},29263:(k,A,e)=>{"use strict";e.d(A,{Fj:()=>l,T6:()=>s,ZU:()=>n,jW:()=>r});function n(i,g){return!!g.permissions?.[i]}function s(i,g){return!!g.accessControl?.[i]}function l(i,g){return i.every(o=>n(o,g))}function r(i,g){return i.some(o=>n(o,g))}},67414:(k,A,e)=>{"use strict";e.d(A,{F:()=>l,c:()=>s});var n=e(9631);function s(r,i){let[g]=r,[o]=i,d=g.length,c=g[0],a=g[d-1],p=o.length,u=o[0],m=o[p-1],v;if(d)if(p){if(u>a)v=r.map((x,f)=>r[f].concat(i[f]));else if(m<c)v=i.map((x,f)=>i[f].concat(r[f]));else if(u<=c&&m>=a)v=i;else if(u>c&&m<a){let x=(0,n.Ls)(u,g);x=g[x]<u?x+1:x;let f=(0,n.Ls)(m,g);f=g[f]>m?f-1:f,v=r.map((E,h)=>r[h].slice(0,x).concat(i[h]).concat(r[h].slice(f+1)))}else if(u>=c){let x=(0,n.Ls)(u,g);x=g[x]<u?x-1:x,v=r.map((f,E)=>r[E].slice(0,x).concat(i[E]))}else if(m>=c){let x=(0,n.Ls)(m,g);x=g[x]<m?x:x+1,v=i.map((f,E)=>i[E].concat(r[E].slice(x)))}}else v=r;else p?v=i:v=[[]];return v}function l(r,i,g){let[o,...d]=r,c,a;return o[0]<i&&(c=(0,n.Ls)(i,o),o[c]<i&&c++),o[o.length-1]>g&&(a=(0,n.Ls)(g,o),o[a]>g&&a--),(c!=null||a!=null)&&(o=o.slice(c??0,a),d=d.map(p=>p.slice(c??0,a))),[o,...d]}},36663:(k,A,e)=>{"use strict";e.d(A,{G:()=>g,P:()=>o});var n=e(60023),s=e(33836),l=e(80997);let r=!1;const i={pedantic:!1,gfm:!0,breaks:!1};function g(d,c){r||(n.xI.use((0,s.z)()),n.xI.setOptions({...i}),r=!0);let a;c?.breaks&&(a={...i,breaks:!0});const p=(0,n.xI)(d||"",a);if(typeof p!="string")throw new Error("Failed to process markdown synchronously.");return c?.noSanitize?p:(0,l.G$)(p)}function o(d,c){r||(n.xI.use((0,s.z)()),n.xI.setOptions({...i}),r=!0);const a=(0,n.xI)(d||"");if(typeof a!="string")throw new Error("Failed to process markdown synchronously.");return c?.noSanitize?a:(0,l.G$)(a)}},80997:(k,A,e)=>{"use strict";e.d(A,{G$:()=>p,Jf:()=>m,aj:()=>d,sQ:()=>f});var n=e(16750),s=e(42838),l=e.n(s),r=e(34005),i=e.n(r);const g=Object.keys(r.whiteList).reduce((E,h)=>(E[h]=r.whiteList[h]?.concat(["class","style"]),E),{}),o=new r.FilterXSS({whiteList:g,css:{whiteList:{...r.getDefaultCSSWhiteList(),"flex-direction":!0,"flex-wrap":!0,"flex-basis":!0,"flex-grow":!0,"flex-shrink":!0,"flex-flow":!0,gap:!0,order:!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"align-items":!0,"align-content":!0,"align-self":!0}}});function d(E){try{return l().sanitize(E,{USE_PROFILES:{html:!0},FORBID_TAGS:["form","input"]})}catch{return console.error("String could not be sanitized",E),x(E)}}function c(E){return l().sanitize(E,{RETURN_TRUSTED_TYPE:!0,ADD_ATTR:["xmlns:atom","version","property","content"],ADD_TAGS:["rss","meta","channel","title","link","description","atom:link","item","pubDate","guid"],PARSER_MEDIA_TYPE:"application/xhtml+xml"})}function a(E){return l().sanitize(E,{RETURN_TRUSTED_TYPE:!0})}function p(E){try{return o.process(E)}catch{return console.error("String could not be sanitized",E),"Text string could not be sanitized"}}function u(E){return l().sanitize(E,{USE_PROFILES:{svg:!0,svgFilters:!0}})}function m(E){return(0,n.J)(E)}function v(E){return/\u001b\[\d{1,2}m/.test(E)}function x(E){return String(E).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}const f={escapeHtml:x,hasAnsiCodes:v,sanitize:d,sanitizeTextPanelContent:p,sanitizeUrl:m,sanitizeSVGContent:u,sanitizeTrustedTypes:a,sanitizeTrustedTypesRSS:c}},54479:(k,A,e)=>{"use strict";e.d(A,{$D:()=>v,$f:()=>f,AP:()=>c,MX:()=>x,dO:()=>a,dc:()=>p,jD:()=>o,kT:()=>u,vb:()=>m,xb:()=>d});var n=e(2543),s=e.n(n);const r="([\\"+["(","[","{","}","]",")","\\","|","*","+","-",".","?","<",">","#","&","^","$"].join("\\")+"])",i=new RegExp(r,"g"),g=new RegExp("(\\\\)"+r,"g");function o(E){return E&&E.replace(i,"\\$1")}function d(E){return E&&E.replace(g,"$2")}function c(E){return E?E[0]==="/":!1}function a(E){if(!c(E))return new RegExp(`^${E}$`);const h=E.match(new RegExp("^/(.*?)/(g?i?m?y?s?)$"));if(!h)throw new Error(`'${E}' is not a valid regular expression.`);return new RegExp(h[1],h[2])}function p(E){if(!E)return 0;const h=parseInt(E,10),y=E.slice(String(h).length),b=1e3,D=b*60,P=D*60,C=P*24;switch(y){case"s":return h*b;case"m":return h*D;case"h":return h*P;case"d":return h*C;default:if(!y)return isNaN(h)?0:h;throw new Error("Not supported unit: "+y)}}function u(E){return E!=null&&Number.isFinite(E)?E.toString():""}function m(E){if(!E)return;const h=parseInt(E,10);return isNaN(h)?void 0:h}function v(E){if(!E)return;const h=parseFloat(E);return isNaN(h)?void 0:h}function x(E){const h=(0,n.camelCase)(E);return h.charAt(0).toUpperCase()+h.substring(1)}function f(E){return E.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}},21:(k,A,e)=>{"use strict";e.d(A,{Oq:()=>n,bQ:()=>g,bs:()=>l});function n({searchWords:o,textToHighlight:d}){const c=[];for(const a of o)typeof a=="string"&&c.push(...l(d,a));return c}const s=o=>o.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function l(o,d){if(!o||!d)return[];const c=[],{cleaned:a,flags:p}=g(s(d));let u;try{u=new RegExp(`(?:${a})`,p)}catch{return c}return o.replace(u,(m,...v)=>{if(m){const x=v[v.length-2];c.push({text:m,start:x,length:m.length,end:x+m.length})}return""}),c}const r="-",i=/\(\?([ims-]+)\)/g;function g(o){const d=new Set(["g"]);return{cleaned:o.replace(i,(a,p)=>{const u=p.startsWith(r);for(let m=0;m<p.length;++m){const v=p.charAt(m);u||p.charAt(m-1)===r?d.delete(v):v!==r&&d.add(v)}return""}),flags:Array.from(d).join("")}}},23596:(k,A,e)=>{"use strict";e.d(A,{MV:()=>E,X4:()=>v,a:()=>f,e$:()=>x,eM:()=>p,tL:()=>m,ze:()=>g});var n=e(84140);function s(h,y=0,b=1){return Math.min(Math.max(y,h),b)}function l(h){h=h.slice(1);const y=new RegExp(`.{1,${h.length>=6?2:1}}`,"g");let b=h.match(y);if(!b)return"";let D=Array.from(b);return D[0].length===1&&(D=D.map(P=>P+P)),D?`rgb${D.length===4?"a":""}(${D.map((P,C)=>C<3?parseInt(P,16):Math.round(parseInt(P,16)/255*1e3)/1e3).join(", ")})`:""}function r(h){const y=h.toString(16);return y.length===1?`0${y}`:y}function i(h){if(h.indexOf("#")===0)return h;const{values:y}=c(h);return`#${y.map(b=>r(b)).join("")}`}function g(h){if(h[0]==="#")return h;const y=(0,n.A)(h);return y.getAlpha()===1?y.toHexString():y.toHex8String()}function o(h){return h.startsWith("rgb")?h:(0,n.A)(h).toRgbString()}function d(h){const y=c(h),{values:b}=y,D=b[0],P=b[1]/100,C=b[2]/100,M=P*Math.min(C,1-C),I=(S,L=(S+D/30)%12)=>C-M*Math.max(Math.min(L-3,9-L,1),-1);let R="rgb";const T=[Math.round(I(0)*255),Math.round(I(8)*255),Math.round(I(4)*255)];return y.type==="hsla"&&(R+="a",T.push(b[3])),a({type:R,values:T})}function c(h){if(typeof h!="string")return h;if(h.charAt(0)==="#")return c(l(h));const y=h.indexOf("("),b=h.substring(0,y);if(["rgb","rgba","hsl","hsla","color"].indexOf(b)===-1)throw new Error(`Unsupported '${h}' color. The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()`);let D=h.substring(y+1,h.length-1),P;if(b==="color"){if(D=D.split(" "),P=D.shift(),D.length===4&&D[3].charAt(0)==="/"&&(D[3]=D[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(P)===-1)throw new Error(`Unsupported ${P} color space. The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.`)}else D=D.split(",");return D=D.map(C=>parseFloat(C)),{type:b,values:D,colorSpace:P}}function a(h){const{type:y,colorSpace:b}=h;let D=h.values;return y.indexOf("rgb")!==-1?D=D.map((P,C)=>C<3?parseInt(P,10):P):y.indexOf("hsl")!==-1&&(D[1]=`${D[1]}%`,D[2]=`${D[2]}%`),y.indexOf("color")!==-1?D=`${b} ${D.join(" ")}`:D=`${D.join(", ")}`,`${y}(${D})`}function p(h,y,b){const D=u(h),P=u(y,b);return(Math.max(D,P)+.05)/(Math.min(D,P)+.05)}function u(h,y){const b=c(h);let D=b.type==="hsl"?c(d(h)).values:b.values;if(y&&b.type==="rgba"){const C=c(y),M=D[3];D[0]=D[0]*M+C.values[0]*(1-M),D[1]=D[1]*M+C.values[1]*(1-M),D[2]=D[2]*M+C.values[2]*(1-M)}const P=D.map(C=>(b.type!=="color"&&(C/=255),C<=.03928?C/12.92:((C+.055)/1.055)**2.4));return Number((.2126*P[0]+.7152*P[1]+.0722*P[2]).toFixed(3))}function m(h,y=.15){return u(h)>.5?x(h,y):f(h,y)}function v(h,y){if(h==="")return"#000000";if(y=s(y),h[0]==="#"){if(h.length===9)h=h.substring(0,7);else if(h.length<=5){let D="#";for(let P=1;P<4;P++)D+=h[P]+h[P];h=D}return h+Math.round(y*255).toString(16).padStart(2,"0")}else{if(h[3]==="(")return h.replace(")",`, ${y})`);if(h[4]==="(")return h.substring(0,h.lastIndexOf(","))+`, ${y})`}const b=c(h);return b.type==="color"?b.values[3]=`/${y}`:b.values[3]=y,a(b)}function x(h,y){const b=c(h);if(y=s(y),b.type.indexOf("hsl")!==-1)b.values[2]*=1-y;else if(b.type.indexOf("rgb")!==-1||b.type.indexOf("color")!==-1)for(let D=0;D<3;D+=1)b.values[D]*=1-y;return a(b)}function f(h,y){const b=c(h);if(y=s(y),b.type.indexOf("hsl")!==-1)b.values[2]+=(100-b.values[2])*y;else if(b.type.indexOf("rgb")!==-1)for(let D=0;D<3;D+=1)b.values[D]+=(255-b.values[D])*y;else if(b.type.indexOf("color")!==-1)for(let D=0;D<3;D+=1)b.values[D]+=(1-b.values[D])*y;return a(b)}const E={clamp:s,hexToRgb:l,rgbToHex:i,asHexString:g,asRgbString:o,hslToRgb:d,decomposeColor:c,recomposeColor:a,getContrastRatio:p,getLuminance:u,emphasize:m,alpha:v,darken:x,lighten:f}},60578:(k,A,e)=>{"use strict";e.d(A,{D:()=>l});var n=e(96540),s=e(75972);const l=(0,n.createContext)((0,s.a)());l.displayName="ThemeContext"},75972:(k,A,e)=>{"use strict";e.d(A,{a:()=>F});function n(){const w=["xs","sm","md","lg","xl","xxl"],B="px",K={xs:0,sm:544,md:769,lg:992,xl:1200,xxl:1440};function W(Y){return`@media (min-width:${typeof Y=="number"?Y:K[Y]}${B})`}function z(Y){return`@media (max-width:${(typeof Y=="number"?Y:K[Y])-5/100}${B})`}return{values:K,up:W,down:z,keys:w,unit:B}}var s=e(2543),l=e(23596);const r={white:"#FFFFFF",black:"#000000",gray25:"#2c3235",gray15:"#22252b",gray10:"#181b1f",gray05:"#111217",darkLayer0:"#18181A",darkLayer1:"#212124",darkLayer2:"#2a2a2f",darkBorder1:"#34343B",darkBorder2:"#64646B",gray90:"#F4F5F5",gray100:"#F4F5F5",gray80:"#D0D1D3",lightBorder1:"#E4E7E7",blueDarkMain:"#3D71D9",blueDarkText:"#6E9FFF",redDarkMain:"#D10E5C",redDarkText:"#FF5286",greenDarkMain:"#1A7F4B",greenDarkText:"#6CCF8E",orangeDarkMain:"#FF9900",orangeDarkText:"#fbad37",blueLightMain:"#3871DC",blueLightText:"#1F62E0",redLightMain:"#E0226E",redLightText:"#CF0E5B",greenLightMain:"#1B855E",greenLightText:"#0A764E",orangeLightMain:"#FF9900",orangeLightText:"#B5510D"};class i{constructor(){this.mode="dark",this.whiteBase="204, 204, 220",this.border={weak:`rgba(${this.whiteBase}, 0.12)`,medium:`rgba(${this.whiteBase}, 0.20)`,strong:`rgba(${this.whiteBase}, 0.30)`},this.text={primary:`rgb(${this.whiteBase})`,secondary:`rgba(${this.whiteBase}, 0.65)`,disabled:`rgba(${this.whiteBase}, 0.6)`,link:r.blueDarkText,maxContrast:r.white},this.primary={main:r.blueDarkMain,text:r.blueDarkText,border:r.blueDarkText},this.secondary={main:`rgba(${this.whiteBase}, 0.10)`,shade:`rgba(${this.whiteBase}, 0.14)`,transparent:`rgba(${this.whiteBase}, 0.08)`,text:this.text.primary,contrastText:`rgb(${this.whiteBase})`,border:`rgba(${this.whiteBase}, 0.08)`},this.info=this.primary,this.error={main:r.redDarkMain,text:r.redDarkText},this.success={main:r.greenDarkMain,text:r.greenDarkText},this.warning={main:r.orangeDarkMain,text:r.orangeDarkText},this.background={canvas:r.gray05,primary:r.gray10,secondary:r.gray15},this.action={hover:`rgba(${this.whiteBase}, 0.16)`,selected:`rgba(${this.whiteBase}, 0.12)`,selectedBorder:r.orangeDarkMain,focus:`rgba(${this.whiteBase}, 0.16)`,hoverOpacity:.08,disabledText:this.text.disabled,disabledBackground:`rgba(${this.whiteBase}, 0.04)`,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(270deg, #F55F3E 0%, #FF8833 100%)",brandVertical:"linear-gradient(0.01deg, #F55F3E 0.01%, #FF8833 99.99%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.15}}class g{constructor(){this.mode="light",this.blackBase="36, 41, 46",this.primary={main:r.blueLightMain,border:r.blueLightText,text:r.blueLightText},this.text={primary:`rgba(${this.blackBase}, 1)`,secondary:`rgba(${this.blackBase}, 0.75)`,disabled:`rgba(${this.blackBase}, 0.64)`,link:this.primary.text,maxContrast:r.black},this.border={weak:`rgba(${this.blackBase}, 0.12)`,medium:`rgba(${this.blackBase}, 0.30)`,strong:`rgba(${this.blackBase}, 0.40)`},this.secondary={main:`rgba(${this.blackBase}, 0.08)`,shade:`rgba(${this.blackBase}, 0.15)`,transparent:`rgba(${this.blackBase}, 0.08)`,contrastText:`rgba(${this.blackBase},  1)`,text:this.text.primary,border:this.border.weak},this.info={main:r.blueLightMain,text:r.blueLightText},this.error={main:r.redLightMain,text:r.redLightText,border:r.redLightText},this.success={main:r.greenLightMain,text:r.greenLightText},this.warning={main:r.orangeLightMain,text:r.orangeLightText},this.background={canvas:r.gray90,primary:r.white,secondary:r.gray100},this.action={hover:`rgba(${this.blackBase}, 0.12)`,selected:`rgba(${this.blackBase}, 0.08)`,selectedBorder:r.orangeLightMain,hoverOpacity:.08,focus:`rgba(${this.blackBase}, 0.12)`,disabledBackground:`rgba(${this.blackBase}, 0.04)`,disabledText:this.text.disabled,disabledOpacity:.38},this.gradients={brandHorizontal:"linear-gradient(90deg, #FF8833 0%, #F53E4C 100%)",brandVertical:"linear-gradient(0.01deg, #F53E4C -31.2%, #FF8833 113.07%)"},this.contrastThreshold=3,this.hoverFactor=.03,this.tonalOffset=.2}}function o(U){const w=new i,B=new g,K=(U.mode??"dark")==="dark"?w:B,{primary:W=K.primary,secondary:z=K.secondary,info:Y=K.info,warning:X=K.warning,success:q=K.success,error:G=K.error,tonalOffset:te=K.tonalOffset,hoverFactor:H=K.hoverFactor,contrastThreshold:se=K.contrastThreshold,...ne}=U;function le(Q,ae=se){return(0,l.eM)(w.text.maxContrast,Q,K.background.primary)>=ae?w.text.maxContrast:B.text.maxContrast}const _=({color:Q,name:ae})=>{if(Q={...Q,name:ae},!Q.main)throw new Error(`Missing main color for ${ae}`);return Q.text||(Q.text=Q.main),Q.border||(Q.border=Q.text),Q.shade||(Q.shade=K.mode==="light"?(0,l.e$)(Q.main,te):(0,l.a)(Q.main,te)),Q.transparent||(Q.transparent=(0,l.X4)(Q.main,.15)),Q.contrastText||(Q.contrastText=le(Q.main)),Q.borderTransparent||(Q.borderTransparent=(0,l.X4)(Q.border,.25)),Q};return(0,s.merge)({...K,primary:_({color:W,name:"primary"}),secondary:_({color:z,name:"secondary"}),info:_({color:Y,name:"info"}),error:_({color:G,name:"error"}),success:_({color:q,name:"success"}),warning:_({color:X,name:"warning"}),getContrastText:le,emphasize:(Q,ae)=>(0,l.tL)(Q,ae??H)},ne)}function d(U,w){const B={padding:1,headerHeight:4,background:U.background.primary,borderColor:U.border.weak,boxShadow:"none"},K={borderColor:U.border.medium,borderHover:U.border.strong,text:U.text.primary,background:U.mode==="dark"?U.background.canvas:U.background.primary};return{height:{sm:3,md:4,lg:6},input:K,panel:B,dropdown:{background:K.background},tooltip:{background:U.background.secondary,text:U.text.primary},dashboard:{background:U.background.canvas,padding:1},overlay:{background:U.mode==="dark"?"rgba(63, 62, 62, 0.45)":"rgba(208, 209, 211, 0.24)"},sidemenu:{width:57},menuTabs:{height:42},textHighlight:{text:U.warning.contrastText,background:U.warning.main},horizontalDrawer:{defaultHeight:400},table:{rowHoverBackground:U.action.hover,rowSelected:U.action.selected}}}function c(U){return U.mode==="dark"?{z1:"0px 1px 2px rgba(1, 4, 9, 0.75)",z2:"0px 4px 8px rgba(1, 4, 9, 0.75)",z3:"0px 8px 24px rgb(1, 4, 9)"}:{z1:"0px 1px 2px rgba(24, 26, 27, 0.2)",z2:"0px 4px 8px rgba(24, 26, 27, 0.2)",z3:"0px 13px 20px 1px rgba(24, 26, 27, 0.18)"}}function a(U){const w=U.borderRadius??2;return{radius:{default:"2px",pill:"9999px",circle:"100%"},borderRadius:W=>`${(W??1)*w}px`}}function p(U={}){const{gridSize:w=8}=U,B=W=>typeof W=="string"?W:W*w,K=(...W)=>(W.length===0&&(W[0]=1),W.map(z=>{const Y=B(z);return typeof Y=="number"?`${Y}px`:Y}).join(" "));return K.gridSize=w,K.x0="0px",K.x0_25="2px",K.x0_5="4px",K.x1="8px",K.x1_5="12px",K.x2="16px",K.x2_5="20px",K.x3="24px",K.x4="32px",K.x5="40px",K.x6="48px",K.x8="64px",K.x10="80px",K}const u={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},m={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function v(U=["all"],w={}){const{duration:B=m.standard,easing:K=u.easeInOut,delay:W=0}=w;return(Array.isArray(U)?U:[U]).map(z=>`${z} ${typeof B=="string"?B:E(B)} ${K} ${typeof W=="string"?W:E(W)}`).join(",")}function x(...U){return U.map(w=>`@media (prefers-reduced-motion: ${w})`).join(",")}function f(U){if(!U)return 0;const w=U/36;return Math.round((4+15*w**.25+w/5)*10)}function E(U){return`${Math.round(U)}ms`}function h(){return{create:v,duration:m,easing:u,getAutoHeightDuration:f,handleMotion:x}}const y='"Inter", "Helvetica", "Arial", sans-serif',b="'Roboto Mono', monospace";function D(U,w={}){const{fontFamily:B=y,fontFamilyMonospace:K=b,fontSize:W=14,fontWeightLight:z=300,fontWeightRegular:Y=400,fontWeightMedium:X=500,fontWeightBold:q=500,htmlFontSize:G=14}=w,te=W/14,H=_=>`${_/G*te}rem`,se=(_,Q,ae,oe,J)=>{if(ae%2!==0||Q%2!==0)throw new Error("Font size and line height should be integer multiples of 2 to prevent issues with alignment");return{fontFamily:B,fontWeight:_,fontSize:H(Q),lineHeight:ae/Q,...B===y?{letterSpacing:`${P(oe/Q)}em`}:{},...J}},ne={h1:se(Y,28,32,-.25),h2:se(Y,24,28,0),h3:se(Y,22,24,0),h4:se(Y,18,22,.25),h5:se(Y,16,22,0),h6:se(X,14,22,.15),body:se(Y,W,22,.15),bodySmall:se(Y,12,18,.15),code:{...se(Y,14,16,.15),fontFamily:K}};return{htmlFontSize:G,pxToRem:H,fontFamily:B,fontFamilyMonospace:K,fontSize:W,fontWeightLight:z,fontWeightRegular:Y,fontWeightMedium:X,fontWeightBold:q,size:{base:"14px",xs:"10px",sm:"12px",md:"14px",lg:"18px"},...ne}}function P(U){return Math.round(U*1e5)/1e5}var C=e(25137);function M(U){const w={name:"Grafana Default",typography:{fontFamily:{sansSerif:U.typography.fontFamily,monospace:U.typography.fontFamilyMonospace},size:{base:`${U.typography.fontSize}px`,xs:U.typography.size.xs,sm:U.typography.size.sm,md:U.typography.size.md,lg:U.typography.size.lg},heading:{h1:U.typography.h1.fontSize,h2:U.typography.h2.fontSize,h3:U.typography.h3.fontSize,h4:U.typography.h4.fontSize,h5:U.typography.h5.fontSize,h6:U.typography.h6.fontSize},weight:{light:U.typography.fontWeightLight,regular:U.typography.fontWeightRegular,semibold:U.typography.fontWeightMedium,bold:U.typography.fontWeightBold},lineHeight:{xs:U.typography.bodySmall.lineHeight,sm:U.typography.bodySmall.lineHeight,md:U.typography.body.lineHeight,lg:U.typography.h2.lineHeight},link:{decoration:"none",hoverDecoration:"none"}},breakpoints:{xs:`${U.breakpoints.values.xs}px`,sm:`${U.breakpoints.values.sm}px`,md:`${U.breakpoints.values.md}px`,lg:`${U.breakpoints.values.lg}px`,xl:`${U.breakpoints.values.xl}px`,xxl:`${U.breakpoints.values.xxl}px`},spacing:{base:U.spacing.gridSize,insetSquishMd:U.spacing(.5,1),d:U.spacing(2),xxs:U.spacing(.25),xs:U.spacing(.5),sm:U.spacing(1),md:U.spacing(2),lg:U.spacing(3),xl:U.spacing(4),gutter:U.spacing(4),formSpacingBase:U.spacing.gridSize,formMargin:`${U.spacing.gridSize*4}px`,formFieldsetMargin:`${U.spacing.gridSize*2}px`,formInputHeight:U.spacing.gridSize*4,formButtonHeight:U.spacing.gridSize*4,formInputPaddingHorizontal:`${U.spacing.gridSize}px`,formInputAffixPaddingHorizontal:`${U.spacing.gridSize/2}px`,formInputMargin:`${U.spacing.gridSize*2}px`,formLabelPadding:"0 0 0 2px",formLabelMargin:`0 0 ${U.spacing.gridSize/2+"px"} 0`,formValidationMessagePadding:"4px 8px",formValidationMessageMargin:"4px 0 0 0",inlineFormMargin:"4px"},border:{radius:{sm:U.shape.borderRadius(1),md:U.shape.borderRadius(2),lg:U.shape.borderRadius(3)},width:{sm:"1px"}},height:{sm:U.spacing.gridSize*U.components.height.sm,md:U.spacing.gridSize*U.components.height.md,lg:U.spacing.gridSize*U.components.height.lg},panelPadding:U.components.panel.padding*U.spacing.gridSize,panelHeaderHeight:U.spacing.gridSize*U.components.panel.headerHeight,zIndex:U.zIndex},B={...I,black:"#000000",white:"#ffffff",dark1:"#141414",dark2:"#161719",dark3:"#1f1f20",dark4:"#212124",dark5:"#222426",dark6:"#262628",dark7:"#292a2d",dark8:"#2f2f32",dark9:"#343436",dark10:"#424345",gray1:"#555555",gray2:"#8e8e8e",gray3:"#b3b3b3",gray4:"#d8d9da",gray5:"#ececec",gray6:"#f4f5f8",gray7:"#fbfbfb",redBase:"#e02f44",redShade:"#c4162a",greenBase:"#299c46",greenShade:"#23843b",red:"#d44a3a",yellow:"#ecbb13",purple:"#9933cc",variable:"#32d1df",orange:"#eb7b18",orangeDark:"#ff780a"},K={bg1:U.colors.background.primary,bg2:U.colors.background.secondary,bg3:U.colors.action.hover,dashboardBg:U.colors.background.canvas,bgBlue1:U.colors.primary.main,bgBlue2:U.colors.primary.shade},W={border1:U.colors.border.weak,border2:U.colors.border.medium,border3:U.colors.border.strong},z={textStrong:U.colors.text.maxContrast,textHeading:U.colors.text.primary,text:U.colors.text.primary,textSemiWeak:U.colors.text.secondary,textWeak:U.colors.text.secondary,textFaint:U.colors.text.disabled,textBlue:U.colors.primary.text},Y={formLabel:U.colors.text.primary,formDescription:U.colors.text.secondary,formInputBg:U.components.input.background,formInputBgDisabled:U.colors.action.disabledBackground,formInputBorder:U.components.input.borderColor,formInputBorderHover:U.components.input.borderHover,formInputBorderActive:U.colors.primary.border,formInputBorderInvalid:U.colors.error.border,formInputPlaceholderText:U.colors.text.disabled,formInputText:U.components.input.text,formInputDisabledText:U.colors.action.disabledText,formFocusOutline:U.colors.primary.main,formValidationMessageText:U.colors.error.contrastText,formValidationMessageBg:U.colors.error.main};return{...w,type:U.colors.mode==="dark"?C.I.Dark:C.I.Light,isDark:U.isDark,isLight:U.isLight,name:U.name,palette:{...B,brandPrimary:B.orange,brandSuccess:U.colors.success.main,brandWarning:U.colors.warning.main,brandDanger:U.colors.error.main,queryRed:U.colors.error.text,queryGreen:U.colors.success.text,queryPurple:"#fe85fc",queryOrange:B.orange,online:U.colors.success.main,warn:U.colors.success.main,critical:U.colors.success.main},colors:{...K,...W,...Y,...z,bodyBg:U.colors.background.canvas,panelBg:U.components.panel.background,panelBorder:U.components.panel.borderColor,pageHeaderBg:U.colors.background.canvas,pageHeaderBorder:U.colors.background.canvas,dropdownBg:Y.formInputBg,dropdownShadow:B.black,dropdownOptionHoverBg:K.bg2,link:U.colors.text.primary,linkDisabled:U.colors.text.disabled,linkHover:U.colors.text.maxContrast,linkExternal:U.colors.text.link},shadows:{listItem:"none"},visualization:U.visualization}}const I={gray98:"#f7f8fa",gray97:"#f1f5f9",gray95:"#e9edf2",gray90:"#dce1e6",gray85:"#c7d0d9",gray70:"#9fa7b3",gray60:"#7b8087",gray33:"#464c54",gray25:"#2c3235",gray15:"#202226",gray10:"#141619",gray05:"#0b0c0e",blue95:"#5794f2",blue85:"#33a2e5",blue80:"#3274d9",blue77:"#1f60c4",red88:"#e02f44"};var R=e(24293);function T(U){const w=U.mode==="light"?L():S(),B={};for(const z of w)for(const Y of z.shades)if(B[Y.name]=Y.color,Y.aliases)for(const X of Y.aliases)B[X]=Y.color;B.transparent=U.mode==="light"?"rgba(255, 255, 255, 0)":"rgba(0,0,0,0)",B["panel-bg"]=U.background.primary,B.text=U.text.primary;const K=z=>{if(!z)return R.F;const Y=B[z];if(Y)return Y;if(z[0]==="#"||z.indexOf("rgb")>-1)return z;const X=j[z.toLowerCase()];return X?(B[z]=X,X):z},W=O();return{hues:w,palette:W,getColorByName:K}}function S(){return[{name:"red",shades:[{color:"#FFA6B0",name:"super-light-red"},{color:"#FF7383",name:"light-red"},{color:"#F2495C",name:"red",primary:!0},{color:"#E02F44",name:"semi-dark-red"},{color:"#C4162A",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFCB7D",name:"super-light-orange",aliases:[]},{color:"#FFB357",name:"light-orange",aliases:[]},{color:"#FF9830",name:"orange",aliases:[],primary:!0},{color:"#FF780A",name:"semi-dark-orange",aliases:[]},{color:"#FA6400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFF899",name:"super-light-yellow",aliases:[]},{color:"#FFEE52",name:"light-yellow",aliases:[]},{color:"#FADE2A",name:"yellow",aliases:[],primary:!0},{color:"#F2CC0C",name:"semi-dark-yellow",aliases:[]},{color:"#E0B400",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#C8F2C2",name:"super-light-green",aliases:[]},{color:"#96D98D",name:"light-green",aliases:[]},{color:"#73BF69",name:"green",aliases:[],primary:!0},{color:"#56A64B",name:"semi-dark-green",aliases:[]},{color:"#37872D",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#C0D8FF",name:"super-light-blue",aliases:[]},{color:"#8AB8FF",name:"light-blue",aliases:[]},{color:"#5794F2",name:"blue",aliases:[],primary:!0},{color:"#3274D9",name:"semi-dark-blue",aliases:[]},{color:"#1F60C4",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#DEB6F2",name:"super-light-purple",aliases:[]},{color:"#CA95E5",name:"light-purple",aliases:[]},{color:"#B877D9",name:"purple",aliases:[],primary:!0},{color:"#A352CC",name:"semi-dark-purple",aliases:[]},{color:"#8F3BB8",name:"dark-purple",aliases:[]}]}]}function L(){return[{name:"red",shades:[{color:"#FF7383",name:"super-light-red"},{color:"#F2495C",name:"light-red"},{color:"#E02F44",name:"red",primary:!0},{color:"#C4162A",name:"semi-dark-red"},{color:"#AD0317",name:"dark-red"}]},{name:"orange",shades:[{color:"#FFB357",name:"super-light-orange",aliases:[]},{color:"#FF9830",name:"light-orange",aliases:[]},{color:"#FF780A",name:"orange",aliases:[],primary:!0},{color:"#FA6400",name:"semi-dark-orange",aliases:[]},{color:"#E55400",name:"dark-orange",aliases:[]}]},{name:"yellow",shades:[{color:"#FFEE52",name:"super-light-yellow",aliases:[]},{color:"#FADE2A",name:"light-yellow",aliases:[]},{color:"#F2CC0C",name:"yellow",aliases:[],primary:!0},{color:"#E0B400",name:"semi-dark-yellow",aliases:[]},{color:"#CC9D00",name:"dark-yellow",aliases:[]}]},{name:"green",shades:[{color:"#96D98D",name:"super-light-green",aliases:[]},{color:"#73BF69",name:"light-green",aliases:[]},{color:"#56A64B",name:"green",aliases:[],primary:!0},{color:"#37872D",name:"semi-dark-green",aliases:[]},{color:"#19730E",name:"dark-green",aliases:[]}]},{name:"blue",shades:[{color:"#8AB8FF",name:"super-light-blue",aliases:[]},{color:"#5794F2",name:"light-blue",aliases:[]},{color:"#3274D9",name:"blue",aliases:[],primary:!0},{color:"#1F60C4",name:"semi-dark-blue",aliases:[]},{color:"#1250B0",name:"dark-blue",aliases:[]}]},{name:"purple",shades:[{color:"#CA95E5",name:"super-light-purple",aliases:[]},{color:"#B877D9",name:"light-purple",aliases:[]},{color:"#A352CC",name:"purple",aliases:[],primary:!0},{color:"#8F3BB8",name:"semi-dark-purple",aliases:[]},{color:"#7C2EA3",name:"dark-purple",aliases:[]}]}]}function O(){return["green","semi-dark-yellow","light-blue","semi-dark-orange","red","blue","purple","#705DA0","dark-green","yellow","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]}const j={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},N={activePanel:999,navbarFixed:1e3,sidemenu:1020,dropdown:1030,typeahead:1030,tooltip:1040,modalBackdrop:1050,modal:1060,portal:1061};function F(U={}){const{colors:w={},spacing:B={},shape:K={},typography:W={}}=U,z=o(w),Y=n(),X=p(B),q=a(K),G=D(z,W),te=c(z),H=h(),se=d(z,te),ne=T(z),le={name:z.mode==="dark"?"Dark":"Light",isDark:z.mode==="dark",isLight:z.mode==="light",colors:z,breakpoints:Y,spacing:X,shape:q,components:se,typography:G,shadows:te,transitions:H,visualization:ne,zIndex:{...N},flags:{}};return{...le,v1:M(le)}}},97594:(k,A,e)=>{"use strict";e.d(A,{g:()=>l,k:()=>r});var n=e(83077),s=e(75972);function l(c){return(i.getIfExists(c)??i.get("dark")).build()}function r(c){return i.list().filter(a=>c?!0:!a.isExtra)}const i=new n.O(()=>[{id:"system",name:"System preference",build:g},{id:"dark",name:"Dark",build:()=>(0,s.a)({colors:{mode:"dark"}})},{id:"light",name:"Light",build:()=>(0,s.a)({colors:{mode:"light"}})},{id:"blue-night",name:"Blue night",build:d,isExtra:!0},{id:"midnight",name:"Midnight",build:o,isExtra:!0}]);function g(){const a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return l(a)}function o(){const c="204, 204, 220";return(0,s.a)({name:"Midnight",colors:{mode:"dark",background:{canvas:"#000000",primary:"#000000",secondary:"#181818"},border:{weak:`rgba(${c}, 0.17)`,medium:`rgba(${c}, 0.25)`,strong:`rgba(${c}, 0.35)`}}})}function d(){return(0,s.a)({name:"Blue night",colors:{mode:"dark",background:{canvas:"#15161d",primary:"#15161d",secondary:"#1d1f2e"},border:{weak:"#2e304f",medium:"#2e304f",strong:"#2e304f"}}})}},75059:(k,A,e)=>{"use strict";e.d(A,{AS:()=>c,C6:()=>p,Em:()=>o,H3:()=>u,Nw:()=>d,gy:()=>g});var n=e(2543),s=e.n(n),l=e(39070),r=e(11261),i=e(83077),g=(D=>(D.sum="sum",D.max="max",D.min="min",D.logmin="logmin",D.mean="mean",D.variance="variance",D.stdDev="stdDev",D.last="last",D.median="median",D.first="first",D.count="count",D.range="range",D.diff="diff",D.diffperc="diffperc",D.delta="delta",D.step="step",D.firstNotNull="firstNotNull",D.lastNotNull="lastNotNull",D.changeCount="changeCount",D.distinctCount="distinctCount",D.allIsZero="allIsZero",D.allIsNull="allIsNull",D.allValues="allValues",D.uniqueValues="uniqueValues",D.p1="p1",D.p2="p2",D.p3="p3",D.p4="p4",D.p5="p5",D.p6="p6",D.p7="p7",D.p8="p8",D.p9="p9",D.p10="p10",D.p11="p11",D.p12="p12",D.p13="p13",D.p14="p14",D.p15="p15",D.p16="p16",D.p17="p17",D.p18="p18",D.p19="p19",D.p20="p20",D.p21="p21",D.p22="p22",D.p23="p23",D.p24="p24",D.p25="p25",D.p26="p26",D.p27="p27",D.p28="p28",D.p29="p29",D.p30="p30",D.p31="p31",D.p32="p32",D.p33="p33",D.p34="p34",D.p35="p35",D.p36="p36",D.p37="p37",D.p38="p38",D.p39="p39",D.p40="p40",D.p41="p41",D.p42="p42",D.p43="p43",D.p44="p44",D.p45="p45",D.p46="p46",D.p47="p47",D.p48="p48",D.p49="p49",D.p50="p50",D.p51="p51",D.p52="p52",D.p53="p53",D.p54="p54",D.p55="p55",D.p56="p56",D.p57="p57",D.p58="p58",D.p59="p59",D.p60="p60",D.p61="p61",D.p62="p62",D.p63="p63",D.p64="p64",D.p65="p65",D.p66="p66",D.p67="p67",D.p68="p68",D.p69="p69",D.p70="p70",D.p71="p71",D.p72="p72",D.p73="p73",D.p74="p74",D.p75="p75",D.p76="p76",D.p77="p77",D.p78="p78",D.p79="p79",D.p80="p80",D.p81="p81",D.p82="p82",D.p83="p83",D.p84="p84",D.p85="p85",D.p86="p86",D.p87="p87",D.p88="p88",D.p89="p89",D.p90="p90",D.p91="p91",D.p92="p92",D.p93="p93",D.p94="p94",D.p95="p95",D.p96="p96",D.p97="p97",D.p98="p98",D.p99="p99",D))(g||{});function o(D){return Object.keys(g).includes(D)}function d(D){const{field:P,reducers:C}=D;if(!P||!C||C.length<1)return{};if(P.state?.calcs){const O=[];for(const j of C)P.state.calcs.hasOwnProperty(j)||O.push(j);if(O.length<1)return{...P.state.calcs}}P.state||(P.state={});const M=c.list(C),I=P.values;if(I&&I.length<1){const O={...P.state.calcs};for(const j of M)O[j.id]=j.emptyInputResult!==null?j.emptyInputResult:null;return P.state.calcs=O}const{nullValueMode:R=l.UW.Ignore}=P.config,T=R===l.UW.Ignore,S=R===l.UW.AsZero;if(M.length===1&&M[0].reduce){const O=M[0].reduce(P,T,S);return P.state.calcs={...P.state.calcs,...O},O}let L=u(P,T,S);for(const O of M)!L.hasOwnProperty(O.id)&&O.reduce&&(L={...L,...O.reduce(P,T,S)});return P.state.calcs={...P.state.calcs,...L},L}const c=new i.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:f,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:x,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:v,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:m,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!0,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:E,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:E,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:h,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:y,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:D=>({allValues:[...D.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:D=>({uniqueValues:[...new Set(D.values)]}),preservesUnits:!1},...a()]),a=(D=[...Array.from({length:99},(P,C)=>C+1)])=>{const P=[],C=M=>M>3&&M<21?"th":M%10===1?"st":M%10===2?"nd":M%10===3?"rd":"th";return D.forEach(M=>{const I=M/100,R=`p${M}`,T=`${M}${C(M)} %`,S=`${M}${C(M)} percentile value`;P.push({id:R,name:T,description:S,standard:!1,reduce:(L,O,j)=>({[R]:b(L,I,O,j)}),preservesUnits:!0})}),P},p={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function u(D,P,C){const M={...p},I=D.values;if(!I)return M;const R=D.type===r.PU.number||D.type===r.PU.time;for(let T=0;T<I.length;T++){let S=I[T];if(T===0&&(M.first=S),M.last=S,S==null){if(P)continue;C&&(S=0)}if(M.count++,S!=null&&!Number.isNaN(S)){const L=M.firstNotNull===null;if(L&&(M.firstNotNull=S),R){if(M.sum+=S,M.allIsNull=!1,M.nonNullCount++,!L){const O=S-M.lastNotNull;M.step>O&&(M.step=O),M.lastNotNull>S?(M.previousDeltaUp=!1,T===I.length-1&&(M.delta+=S)):(M.previousDeltaUp?M.delta+=O:M.delta+=S,M.previousDeltaUp=!0)}S>M.max&&(M.max=S),S<M.min&&(M.min=S),S<M.logmin&&S>0&&(M.logmin=S)}S!==0&&(M.allIsZero=!1),M.lastNotNull=S}}return M.max===-Number.MAX_VALUE&&(M.max=null),M.min===Number.MAX_VALUE&&(M.min=null),M.step===Number.MAX_VALUE&&(M.step=null),M.nonNullCount>0&&(M.mean=M.sum/M.nonNullCount),M.allIsNull&&(M.allIsZero=!1),M.max!==null&&M.min!==null&&(M.range=M.max-M.min),(0,n.isNumber)(M.firstNotNull)&&(0,n.isNumber)(M.lastNotNull)&&(M.diff=M.lastNotNull-M.firstNotNull),(0,n.isNumber)(M.firstNotNull)&&(0,n.isNumber)(M.diff)&&(M.diffperc=M.diff/M.firstNotNull),M}function m(D,P,C){return{first:D.values[0]}}function v(D,P,C){const M=D.values;for(let I=0;I<M.length;I++){const R=M[I];if(R!=null&&!Number.isNaN(R))return{firstNotNull:R}}return{firstNotNull:null}}function x(D,P,C){const M=D.values;return{last:M[M.length-1]}}function f(D,P,C){const M=D.values;let I=M.length-1;for(;I>=0;){const R=M[I--];if(R!=null&&!Number.isNaN(R))return{lastNotNull:R}}return{lastNotNull:null}}function E(D,P,C){if(!(D.type===r.PU.number||D.type===r.PU.time))return{variance:0,stdDev:0};let M=0,I=0,R=0;const T=D.values;for(let S=0;S<T.length;S++){const L=T[S];if(L!=null){R++;let O=I;I+=(L-O)/R,M+=(L-O)*(L-I)}}if(R>0){const S=M/R;return{variance:S,stdDev:Math.sqrt(S)}}return{variance:0,stdDev:0}}function h(D,P,C){const M=D.values;let I=0,R=!0,T=null;for(let S=0;S<M.length;S++){let L=M[S];if(L===null){if(P)continue;C&&(L=0)}!R&&T!==L&&I++,R=!1,T=L}return{changeCount:I}}function y(D,P,C){const M=D.values,I=new Set;for(let R=0;R<M.length;R++){let T=M[R];if(T===null){if(P)continue;C&&(T=0)}I.add(T)}return{distinctCount:I.size}}function b(D,P,C,M){let I=D.values;C&&(I=I.filter(S=>S!==null)),M&&(I=I.map(S=>S===null?0:S));const R=I.slice().sort((S,L)=>S-L),T=Math.round((R.length-1)*P);return R[T]}},85200:(k,A,e)=>{"use strict";e.d(A,{Dq:()=>h,NS:()=>E,RE:()=>x,hI:()=>f,kK:()=>y,sJ:()=>v});var n=e(83077),s=e(7029),l=e(24814),r=e(58972),i=e(72693),g=e(8549),o=e(83855),d=e(60005),c=e(21262),a=e(70218),p=e(55008),u=e(16378),m=e(75754);const v=new n.O(()=>[...(0,i.nz)(),...(0,s._)(),...(0,r.P7)(),...(0,o.W)(),l.u]),x=new n.O(()=>[...(0,i.UM)(),...(0,r.Y7)(),...(0,g.i)()]),f=new n.O(()=>[...(0,c._)(),...(0,a.E)(),...(0,d.d)(),...(0,m.m)(),...(0,p.G)(),...(0,u.z)()]);function E(b){const D=v.get(b.id);if(!D)throw new Error("Unknown field matcher: "+b.id);return D.get(b.options)}function h(b){const D=x.get(b.id);if(!D)throw new Error("Unknown frame matcher: "+b.id);return D.get(b.options)}function y(b){const D=f.get(b.id);if(!D)throw new Error("Unknown value matcher: "+b.id);return D.get(b.options)}},58972:(k,A,e)=>{"use strict";e.d(A,{P7:()=>v,PP:()=>i,Y7:()=>x});var n=e(28240),s=e(54479),l=e(11261),r=e(1173),i=(f=>(f.exclude="exclude",f.include="include",f))(i||{});const g={id:r.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:f=>{const h=d(new Set([f]));return(y,b,D)=>f===y.name||f===(0,n.Ct)(y,b,D)||!!(h&&h(y,b,D))},getOptionsDisplayText:f=>`Field name: ${f}`},o={id:r.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:f=>{const{names:E,mode:h="include"}=f,y=new Set(E??[]),b=d(y),D=(P,C,M)=>y.has(P.name)||y.has((0,n.Ct)(P,C,M))||!!(b&&b(P,C,M));return h==="exclude"?(P,C,M)=>!D(P,C,M):D},getOptionsDisplayText:f=>{const{names:E,mode:h}=f,y=(E??[]).join(", ");return h==="exclude"?`All except: ${y}`:`All of: ${y}`}};function d(f){let E;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(f.has(l.Bc)?E=(y,b)=>!!y.labels&&y.labels?.__name__===y.name:(f.has("Time")||f.has("time"))&&(E=(y,b)=>b.meta?.typeVersion==null&&y.type===l.PU.time)),E}const c={id:r.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:f=>{const E=u(f);return(h,y,b)=>{const D=(0,n.Ct)(h,y,b);return!!E&&E.test(D)}},getOptionsDisplayText:f=>`Field name by pattern: ${f}`},a={id:r.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:f=>(E,h,y)=>h.refId===f,getOptionsDisplayText:f=>`Math all fields returned by query with reference ID: ${f}`},p={id:r.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:f=>{const E=c.get(f?.pattern||""),h=o.get({mode:"include",names:f?.names??[]});return(y,b,D)=>h(y,b,D)||E(y,b,D)},getOptionsDisplayText:f=>{const E=f?.pattern??"",h=f?.names?.join(",")??"";return`Field name by pattern: ${E} or names: ${h}`}},u=f=>{if(f)try{return(0,s.dO)(f)}catch(E){console.error(E);return}},m={id:r.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:f=>{const E=(0,s.dO)(f);return h=>E.test(h.name||"")},getOptionsDisplayText:f=>`Frame name: ${f}`};function v(){return[g,c,o,p,a]}function x(){return[m]}},72693:(k,A,e)=>{"use strict";e.d(A,{UM:()=>b,Yg:()=>a,nz:()=>y,zx:()=>m});var n=e(11261),s=e(85200),l=e(1173);const r={id:l.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const P=D.map(C=>(0,s.NS)(C));return(C,M,I)=>{for(const R of P)if(R(C,M,I))return!0;return!1}},getOptionsDisplayText:D=>{let P="";for(const C of D){P.length>0&&(P+=" OR ");const M=s.sJ.get(C.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return P}},i={id:l.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const P=D.map(C=>(0,s.Dq)(C));return C=>{for(const M of P)if(M(C))return!0;return!1}},getOptionsDisplayText:D=>{let P="";for(const C of D){P.length>0&&(P+=" OR ");const M=s.RE.get(C.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return P}},g={id:l.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const P=D.map(C=>(0,s.NS)(C));return(C,M,I)=>{for(const R of P)if(!R(C,M,I))return!1;return!0}},getOptionsDisplayText:D=>{let P="";for(const C of D){P.length>0&&(P+=" AND ");const M=s.sJ.get(C.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return P}},o={id:l.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const P=D.map(C=>(0,s.Dq)(C));return C=>{for(const M of P)if(!M(C))return!1;return!0}},getOptionsDisplayText:D=>{let P="";for(const C of D){P.length>0&&(P+=" AND ");const M=s.RE.get(C.id);P+=M.getOptionsDisplayText?M.getOptionsDisplayText(C):M.name}return P}},d={id:l.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:D=>{const P=(0,s.NS)(D);return(C,M,I)=>!P(C,M,I)},getOptionsDisplayText:D=>{const P=s.sJ.get(D.id);return"NOT "+(P.getOptionsDisplayText?P.getOptionsDisplayText(D.options):P.name)}},c={id:l.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:D=>{const P=(0,s.Dq)(D);return C=>!P(C)},getOptionsDisplayText:D=>{const P=s.RE.get(D.id);return"NOT "+(P.getOptionsDisplayText?P.getOptionsDisplayText(D.options):P.name)}},a=D=>!0,p=D=>!0,u=D=>!1,m=D=>D.type!==n.PU.time,v=D=>!1,x={id:l.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:D=>a,getOptionsDisplayText:D=>"Always"},f={id:l.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:D=>p,getOptionsDisplayText:D=>"Always"},E={id:l.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:D=>u,getOptionsDisplayText:D=>"Never"},h={id:l.cV.neverMatch,name:"No Frames",description:"Never Match",get:D=>v,getOptionsDisplayText:D=>"Never"};function y(){return[r,g,d,x,E]}function b(){return[i,o,c,f,h]}},97497:(k,A,e)=>{"use strict";e.d(A,{h:()=>l,m:()=>s});var n=e(83077),s=(r=>(r.Combine="combine",r.CalculateNewFields="calculateNewFields",r.CreateNewVisualization="createNewVisualization",r.Filter="filter",r.PerformSpatialOperations="performSpatialOperations",r.Reformat="reformat",r.ReorderAndRename="reorderAndRename",r))(s||{});const l=new n.O},2514:(k,A,e)=>{"use strict";e.d(A,{m:()=>c});var n=e(62467),s=e(69862),l=e(81160),r=e(85200),i=e(97497);const g=(p,u)=>m=>{const v=i.h.get(p.id);if(!v)return m;const f={...v.transformation.defaultOptions??{},...p.options},E=p.filter?.options?(0,r.Dq)(p.filter):void 0;return m.pipe((0,s.Z)(h=>(0,n.of)(o(h,E)).pipe(v.transformation.operator(f,u),d(h,v,E))))};function o(p,u){return u?p.filter(m=>u(m)):p}const d=(p,u,m)=>v=>v.pipe((0,l.T)(x=>{if(x===p)return x;if(m){let f=0;const E=p.filter((h,y)=>{const b=!m(h);return b&&!f&&(f=y),b});E.length&&x.splice(f,0,...E)}return x}));function c(p,u,m){const v=(0,n.of)(u);if(!p.length)return v;const x=[],f=m??{interpolate:E=>E};for(let E=0;E<p.length;E++){const h=p[E];if(a(h))x.push(h(f));else{if(h.disabled)continue;x.push(g(h,f))}}return v.pipe.apply(v,x)}function a(p){return typeof p=="function"}},57934:(k,A,e)=>{"use strict";e.d(A,{c:()=>xe});var n=e(66350),s=e(82150),l=e(50311),r=e(34125),i=e(64224),g=e(35602),o=e(1173),d=e(18282);const c={id:d.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(re,ue)=>Te=>{const ge={};return re.include&&(ge.include={id:o.jR.byRefId,options:re.include}),re.exclude&&(ge.exclude={id:o.jR.byRefId,options:re.exclude}),Te.pipe(i.I.operator(ge,ue))}};var a=e(73376),p=e(15400),u=e(81160),m=e(28240),v=e(81010);const x={id:d.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:re=>{for(const ue of re)for(const Te of ue.fields)if(Te.type==="time")return v.M.Applicable;return v.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(re,ue)=>Te=>Te.pipe((0,u.T)(ge=>f(re,ge,ue)))},f=({timeField:re,outputFormat:ue,timezone:Te},ge,Oe)=>!Array.isArray(ge)||ge.length===0?ge:((0,m.Fm)(ge),ue=Oe?.interpolate(ue)??ue,ge.map(Ue=>({...Ue,fields:Ue.fields.map(Xe=>(Xe.state?.displayName===re&&(Xe=(0,l.Xv)(Xe,ue,{timeZone:Te})),Xe))})));var E=e(25094),h=e(68133),y=e(11261),b=e(85200);const D="Time",P="Time",C="Value",M=v.N.Empty,I=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,R={id:d.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:D,rowField:P,valueField:C},isApplicable:re=>{let ue=0;for(const Te of re)ue+=Te.fields.length;return ue>=3?v.M.Applicable:v.M.NotApplicable},isApplicableDescription:re=>{let ue=0;for(const Te of re)ue+=Te.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${ue} fields.`},operator:(re,ue)=>Te=>Te.pipe((0,u.T)(ge=>{const Oe=ue.interpolate(re.columnField||D),Ue=ue.interpolate(re.rowField||P),Xe=ue.interpolate(re.valueField||C),we=re.emptyValue||M;if(ge.length!==1)return ge;const qe=ge[0],We=S(qe,Oe),Ce=S(qe,Ue),je=S(qe,Xe),Ke=`${Ue}\\${Oe}`;if(!We||!Ce||!je)return ge;const _e=T(We.values),Fe=T(Ce.values),at={};for(let Dt=0;Dt<je.values.length;Dt++){const tt=We.values[Dt],ze=Ce.values[Dt],pe=je.values[Dt];at[tt]||(at[tt]={}),at[tt][ze]=pe}const Ct=[{name:Ke,values:Fe,type:y.PU.string,config:{}}];for(const Dt of _e){let tt=[];for(const ze of Fe){const pe=at[Dt][ze]??L(we);tt.push(pe)}I&&typeof Dt=="number"&&(je.config={...je.config,displayNameFromDS:void 0}),Ct.push({name:Dt.toString(),values:tt,config:je.config,type:je.type})}return[{fields:Ct,length:Fe.length}]}))};function T(re){const ue=new Set;for(let Te=0;Te<re.length;Te++)ue.add(re[Te]);return Array.from(ue)}function S(re,ue){for(let Te=0;Te<re.fields.length;Te++){const ge=re.fields[Te];let Oe;if(I?Oe=b.sJ.get(o.Ct.byName).get(ue)(ge,re,[re]):Oe=ue===(0,m.Ct)(ge),Oe)return ge}return null}function L(re){switch(re){case v.N.False:return!1;case v.N.True:return!0;case v.N.Null:return null;case v.N.Empty:default:return""}}var O=e(77678),j=e(41511),N=e(6829),F=e(67641);const U=10,w={id:d.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:U},operator:(re,ue)=>Te=>Te.pipe((0,u.T)(ge=>{let Oe=U;return re.limitField!==void 0&&(typeof re.limitField=="string"?(0,F.w)()?Oe=parseInt(ue.interpolate(re.limitField),10):Oe=parseInt(re.limitField,10):Oe=re.limitField),ge.map(Ue=>Ue.length>Oe?{...Ue,fields:Ue.fields.map(Xe=>({...Xe,values:Xe.values.slice(0,Oe)})),length:Oe}:Ue)}))};var B=e(58140),K=e(64586),W=e(82280);const z={id:d.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:re=>ue=>ue.pipe((0,u.T)(Te=>{const ge=Y(re.renameByName);return!Array.isArray(Te)||Te.length===0?Te:Te.map(Oe=>({...Oe,fields:ge(Oe)}))}))},Y=re=>ue=>!re||Object.keys(re).length===0?ue.fields:ue.fields.map(Te=>{const ge=(0,m.Ct)(Te,ue),Oe=re[ge];return typeof Oe!="string"||Oe.length===0?Te:{...Te,config:{...Te.config,displayName:Oe},state:{...Te.state,displayName:Oe}}}),X={id:d.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:re=>re.length>1?v.M.NotPossible:v.M.Applicable,operator:(re,ue)=>Te=>Te.pipe(g.D.operator({include:re.includeByName?{names:q(re.includeByName)}:void 0,exclude:{names:q(re.excludeByName)}},ue),W.x.operator(re,ue),z.operator(re,ue))},q=re=>re?Object.keys(re).filter(ue=>re[ue]):[];var G=e(21128),te=e(54479);const H={id:d.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:re=>ue=>ue.pipe((0,u.T)(Te=>!Array.isArray(Te)||Te.length===0?Te:Te.map(se(re))))},se=re=>ue=>{const Te=(0,te.dO)(re.regex),ge=ue.fields.map(Oe=>{const Ue=(0,m.Ct)(Oe,ue);if(!Te.test(Ue))return Oe;const Xe=Ue.replace(Te,re.renamePattern);return{...Oe,config:{...Oe.config,displayName:Xe},state:{...Oe.state,displayName:Xe}}});return{...ue,fields:ge}};var ne=e(2543),le=e(37471),_=e(14236),Q=e(19845);const ae={id:d.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:re=>ue=>ue.pipe((0,u.T)(Te=>{if(!Array.isArray(Te)||Te.length===0||(Te=Te.filter(we=>we.length>0),!(0,Q.jq)(Te)))return Te;const ge={},Oe=new Set,Ue=new le.k,Xe={name:y.aI,values:[],config:{},type:y.PU.string};for(let we=0;we<Te.length;we++){const qe=Te[we];for(let We=0;We<qe.fields.length;We++){const Ce=qe.fields[We];if(Ce.type===y.PU.time){ge[we]=We,Oe.has(y.LE)||(Ue.addField(oe(Ce,y.LE)),Ue.addField(Xe),Oe.add(y.LE));continue}Oe.has(y.Bc)||(Ue.addField(oe(Ce,y.Bc)),Oe.add(y.Bc))}}for(let we=0;we<Te.length;we++){const qe=Te[we];for(let We=0;We<qe.length;We++){const Ce=ge[we],je=Ce===0?1:0;Ue.add({[y.LE]:qe.fields[Ce].values[We],[y.aI]:(0,m.Ri)(qe),[y.Bc]:qe.fields[je].values[We]})}}return[(0,_.ES)(Ue,0,!0)]}))},oe=(re,ue)=>({...(0,ne.omit)(re,["values","state","labels","config","name"]),name:ue,values:[],config:{...(0,ne.omit)(re.config,["displayName","displayNameFromDS"])}}),J={id:d.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(re,ue)=>Te=>Te.pipe((0,u.T)(ge=>!Array.isArray(ge)||ge.length===0||!re?.sort?.length?ge:ee(ge,re.sort,ue)))};function ee(re,ue,Te){return re.map(ge=>{const Oe=de(ge,ue,Te);return Oe.length&&Oe[0].index!=null?(0,_.ES)(ge,Oe[0].index,Oe[0].desc):ge})}function de(re,ue,Te){return ue.map(ge=>ge.index!=null?ge:(0,F.w)()?{...ge,index:re.fields.findIndex(Oe=>Te.interpolate(ge.field)===(0,m.Ct)(Oe,re))}:{...ge,index:re.fields.findIndex(Oe=>ge.field===(0,m.Ct)(Oe,re))})}const xe={noopTransformer:K.W,filterFieldsTransformer:i.z,filterFieldsByNameTransformer:g.D,filterFramesTransformer:i.I,filterFramesByRefIdTransformer:c,filterByValueTransformer:a.Sv,formatStringTransformer:p.yt,formatTimeTransformer:x,orderFieldsTransformer:W.x,organizeFieldsTransformer:X,reduceTransformer:G.Wj,concatenateTransformer:s.vz,calculateFieldTransformer:n.SC,joinByFieldTransformer:j.L,seriesToColumnsTransformer:j.L,seriesToRowsTransformer:ae,renameFieldsTransformer:z,labelsToFieldsTransformer:N.V,ensureColumnsTransformer:r.b,groupByTransformer:E.of,sortByTransformer:J,mergeTransformer:B.o,renameByRegexTransformer:H,histogramTransformer:O.OA,convertFieldTypeTransformer:l.zM,groupingToMatrixTransformer:R,limitTransformer:w,groupToNestedTable:h._}},66350:(k,A,e)=>{"use strict";e.d(A,{Bp:()=>E,SC:()=>C,UY:()=>f,Uj:()=>b,ip:()=>h,sw:()=>U});var n=e(2543),s=e.n(n),l=e(81160),r=e(14236),i=e(28240),g=e(39070),o=e(11261),d=e(11710),c=e(27618),a=e(75059),p=e(85200),u=e(1173),m=e(34125),v=e(18282),x=e(64586),f=(w=>(w.ReduceRow="reduceRow",w.CumulativeFunctions="cumulativeFunctions",w.WindowFunctions="windowFunctions",w.BinaryOperation="binary",w.UnaryOperation="unary",w.Index="index",w))(f||{}),E=(w=>(w.Percentage="percentage",w.Fixed="fixed",w))(E||{}),h=(w=>(w.Trailing="trailing",w.Centered="centered",w))(h||{});const y={reducer:a.gy.sum},b={reducer:a.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},D={left:"",operator:d.k.Add,right:""},P={operator:c._.Abs,fieldName:""},C={id:v.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:a.gy.sum}},operator:(w,B)=>K=>{const W=w&&w.timeSeries!==!1?m.b.operator(null,B):x.W.operator({},B);return w.alias!=null&&(w.alias=B.interpolate(w.alias)),K.pipe(W,(0,l.T)(z=>{const Y=w.mode??"reduceRow";let X;switch(Y){case"reduceRow":X=O((0,n.defaults)(w.reduce,y),z);break;case"cumulativeFunctions":X=L((0,n.defaults)(w.cumulative,y),z);break;case"windowFunctions":X=M((0,n.defaults)(w.window,b),z);break;case"unary":X=F((0,n.defaults)(w.unary,P),z);break;case"binary":const q={...w.binary,left:B.interpolate(w.binary?.left),right:B.interpolate(w.binary?.right)};X=N((0,n.defaults)(q,D),z);break;case"index":return z.map(G=>{const te=[...Array(G.length).keys()];if(w.index?.asPercentile)for(let se=0;se<te.length;se++)te[se]=te[se]/te.length;const H={name:w.alias??"Row",type:o.PU.number,values:te,config:w.index?.asPercentile?{unit:"percentunit"}:{}};return{...G,fields:w.replaceFields?[H]:[...G.fields,H]}})}return X?z.map(q=>{const G=X(q);if(!G)return q;const te={name:U(w),type:o.PU.number,config:{},values:G};let H=[];if(w.replaceFields){const{timeField:se}=(0,r.KR)(q);se&&w.timeSeries!==!1?H=[se,te]:H=[te]}else H=[...q.fields,te];return{...q,fields:H}}):z}))}};function M(w,B){if(w.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let K=(0,p.NS)({id:u.Ct.numeric});return w.field&&(K=(0,p.NS)({id:u.Ct.byNames,options:{names:[w.field]}})),W=>{const z=Math.ceil(w.windowSize*(w.windowSizeMode==="percentage"?W.length:1));let Y=null;for(const X of W.fields)if(K(X,W,B)){Y=X;break}if(Y){if(![a.gy.mean,a.gy.stdDev,a.gy.variance].includes(w.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${w.reducer}`);return w.windowAlignment==="centered"?R(W,w.reducer,Y,z):I(W,w.reducer,Y,z)}}}function I(w,B,K,W){const z=[];let Y=0,X=0;for(let q=0;q<w.length;q++)if(B===a.gy.mean){const G=K.values[q];G!=null&&(X++,Y+=G,q>W-1&&(Y-=K.values[q-W],X--)),z.push(X===0?0:Y/X)}else if(B===a.gy.variance){const G=Math.max(0,q-W+1),te=q+1;z.push(T(K.values.slice(G,te)))}else if(B===a.gy.stdDev){const G=Math.max(0,q-W+1),te=q+1;z.push(S(K.values.slice(G,te)))}return z}function R(w,B,K,W){const z=[];let Y=0,X=0;const q=Math.ceil(W/2)-1,G=Math.floor(W/2);for(let te=0;te<w.length;te++){const H=te-G,se=te+q;if(B===a.gy.mean){if(te===0)for(let ne=0;ne<q+1&&ne<K.values.length;ne++)K.values[ne]!=null&&(Y+=K.values[ne],X++);else se<K.values.length&&K.values[se]!=null&&(Y+=K.values[se],X++),H>0&&K.values[H-1]!=null&&(Y-=K.values[H-1],X--);z.push(X===0?0:Y/X)}else if(B===a.gy.variance){const ne=K.values.slice(Math.max(0,H),Math.min(se+1,K.values.length));z.push(T(ne))}else if(B===a.gy.stdDev){const ne=K.values.slice(Math.max(0,H),Math.min(se+1,K.values.length));z.push(S(ne))}}return z}function T(w){if(w.length<1)return 0;let B=0,K=0,W=0;for(let Y=0;Y<w.length;Y++){const X=w[Y];if(X!=null){W++;let q=K;K+=(X-q)/W,B+=(X-q)*(X-K)}}return W===0?0:B/W}function S(w){return Math.sqrt(T(w))}function L(w,B){let K=(0,p.NS)({id:u.Ct.numeric});if(w.field&&(K=(0,p.NS)({id:u.Ct.byNames,options:{names:[w.field]}})),![a.gy.mean,a.gy.sum].includes(w.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${w.reducer}`);return W=>{let z=null;for(const q of W.fields)if(K(q,W,B)){z=q;break}if(!z)return;const Y=[];let X=0;for(let q=0;q<W.length;q++)X+=z.values[q]??0,w.reducer===a.gy.sum?Y.push(X):w.reducer===a.gy.mean&&Y.push(X/(q+1));return Y}}function O(w,B){let K=(0,p.NS)({id:u.Ct.numeric});w.include&&w.include.length&&(K=(0,p.NS)({id:u.Ct.byNames,options:{names:w.include}}));const W=a.AS.get(w.reducer);if(!W)throw new Error(`Unknown reducer: ${w.reducer}`);const z=W.reduce??a.H3,Y=w.nullValueMode===g.UW.Ignore,X=w.nullValueMode===g.UW.AsZero;return q=>{const G=[];for(const ne of q.fields)K(ne,q,B)&&G.push(ne.values);const te=G.length,H={name:"temp",values:new Array(te),type:o.PU.number,config:{}},se=[];for(let ne=0;ne<q.length;ne++){for(let le=0;le<te;le++)H.values[le]=G[le][ne];se.push(z(H,Y,X)[w.reducer])}return se}}function j(w,B,K){if(!B)return;for(const z of w.fields)if(B===(0,i.Ct)(z,w,K))return z.type===o.PU.boolean?z.values.map(Y=>Y?1:0):z.values;const W=parseFloat(B);if(!isNaN(W))return new Array(w.length).fill(W)}function N(w,B){const K=d.b.getIfExists(w.operator);return W=>{const z=j(W,w.left,B),Y=j(W,w.right,B);if(!z||!Y||!K)return;const X=new Array(z.length);for(let q=0;q<X.length;q++)X[q]=K.operation(z[q],Y[q]);return X}}function F(w,B){const K=c.j.getIfExists(w.operator);return W=>{let z=[];for(const X of W.fields)w.fieldName===(0,i.Ct)(X,W,B)&&X.type===o.PU.number&&(z=X.values);if(!z.length||!K)return;const Y=new Array(z.length);for(let X=0;X<Y.length;X++)Y[X]=K.operation(z[X]);return Y}}function U(w){if(w.alias?.length)return w.alias;switch(w.mode){case"cumulativeFunctions":{const{cumulative:B}=w;return`cumulative ${B?.reducer??""}${B?.field?`(${B.field})`:""}`}case"windowFunctions":{const{window:B}=w;return`${B?.windowAlignment??""} moving ${B?.reducer??""}${B?.field?`(${B.field})`:""}`}case"unary":{const{unary:B}=w;return`${B?.operator??""}${B?.fieldName?`(${B.fieldName})`:""}`}case"binary":{const{binary:B}=w;return`${B?.left??""} ${B?.operator??""} ${B?.right??""}`.replace(/\$/g,"")}case"reduceRow":{const B=a.AS.getIfExists(w.reduce?.reducer);if(B)return B.name}break;case"index":return"Row"}return"math"}},82150:(k,A,e)=>{"use strict";e.d(A,{vz:()=>i,x1:()=>r});var n=e(81160),s=e(11261),l=e(18282),r=(o=>(o.Drop="drop",o.FieldName="field",o.Label="label",o))(r||{});const i={id:l.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:o=>d=>d.pipe((0,n.T)(c=>!Array.isArray(c)||c.length<2?c:[g(c,o)]))};function g(o,d){let c=!0,a=o[0].length;const p=d.frameNameLabel??"frame";let u=[];for(const m of o){a!==m.length&&(c=!1,a=Math.max(a,m.length));for(const v of m.fields){const x={...v};x.state=void 0,m.name&&(d.frameNameMode==="drop"||(d.frameNameMode==="label"?(x.labels={...v.labels},x.labels[p]=m.name):!x.name||x.name===s.Bc?x.name=m.name:x.name=`${m.name} \xB7 ${v.name}`)),u.push(x)}}return c||(u=u.map(m=>{if(m.values.length===a)return m;const v=m.values.slice();return v.length=a,{...m,values:v}})),{fields:u,length:a}}},50311:(k,A,e)=>{"use strict";e.d(A,{Xv:()=>v,ks:()=>f,s7:()=>c,zM:()=>o});var n=e(81160),s=e(53531),l=e(11261),r=e(85200),i=e(1173),g=e(18282);const o={id:g.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(h,y)=>b=>b.pipe((0,n.T)(D=>o.transformer(h,y)(D))),transformer:h=>y=>!Array.isArray(y)||y.length===0?y:d(h,y)??[]};function d(h,y){if(!h.conversions.length)return y;const b=y.map(D=>({...D}));for(const D of h.conversions){if(!D.targetField)continue;const P=r.sJ.get(i.Ct.byName).get(D.targetField);for(const C of b)C.fields=C.fields.map(M=>P(M,C,b)?c(M,D):M)}return b}function c(h,y){switch(y.destinationType){case l.PU.time:return f(h,y.dateFormat);case l.PU.number:return u(h);case l.PU.string:return v(h,y.dateFormat,{timeZone:y.timezone},y.joinWith);case l.PU.boolean:return m(h);case l.PU.enum:return E(h,y.enumConfig);case l.PU.other:return x(h);default:return h}}const a=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function p(h,y){let b=y?{format:y}:void 0;const D=h.values.slice();let P=D.find(M=>M!=null),C=typeof P=="string"&&a.test(P);for(let M=0;M<D.length;M++)if(D[M]){let I=C?Date.parse(D[M]):(0,s.b)(D[M],b).valueOf();D[M]=Number.isFinite(I)?I:null}else D[M]=null;return{...h,type:l.PU.time,values:D}}function u(h){const y=h.values.slice(),b=y.some(D=>typeof D=="string");for(let D=0;D<y.length;D++){let P=y[D];b&&P!=null&&typeof P=="string"&&(P=P.replace(/,/g,""));const C=+P;y[D]=Number.isFinite(C)?C:null}return{...h,type:l.PU.number,values:y}}function m(h){const y=h.values.slice();for(let b=0;b<y.length;b++)y[b]=!!y[b];return{...h,type:l.PU.boolean,values:y}}function v(h,y,b,D){let P=h.values;switch(h.type){case l.PU.time:P=P.map(C=>(0,s.b)(C,b).format(y));break;case l.PU.other:P=P.map(C=>D?.length&&Array.isArray(C)?C.join(D):JSON.stringify(C));break;default:P=P.map(C=>`${C}`)}return{...h,type:l.PU.string,values:P}}function x(h){const y=h.values.slice();for(let b=0;b<y.length;b++)try{y[b]=JSON.parse(y[b])}catch{y[b]=null}return{...h,type:l.PU.other,values:y}}function f(h,y){const b=typeof h.values[0]=="number";return h.type===l.PU.time&&b?h:b?{...h,type:l.PU.time}:p(h,y)}function E(h,y){const b={...y},D=h.values.slice(),P=new Map;if(b.text&&b.text.length>0)for(let C=0;C<b.text.length;C++)P.set(b.text[C],C);else return h;for(let C=0;C<D.length;C++){const M=D[C];D[C]=P.get(M)}return{...h,config:{...h.config,type:{enum:b}},type:l.PU.enum,values:D}}},34125:(k,A,e)=>{"use strict";e.d(A,{b:()=>i});var n=e(81160),s=e(14236),l=e(18282),r=e(41511);const i={id:l.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(o,d)=>c=>c.pipe((0,n.T)(a=>i.transformer(o,d)(a))),transformer:(o,d)=>c=>{const a=g(c);return c.length>1&&a?r.L.transformer({byField:a},d)(c):c}};function g(o){let d;for(const c of o){const{timeField:a}=(0,s.KR)(c);if(!a)return;if(!d)d=a.name;else if(d!==a.name)return}return d}},64224:(k,A,e)=>{"use strict";e.d(A,{I:()=>g,z:()=>i});var n=e(81160),s=e(85200),l=e(18282),r=e(64586);const i={id:l.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(o,d)=>c=>!o.include&&!o.exclude?c.pipe(r.W.operator({},d)):(typeof o.include?.options=="string"?o.include.options=d.interpolate(o.include?.options):typeof o.include?.options?.pattern=="string"&&(o.include.options.pattern=d.interpolate(o.include?.options.pattern)),typeof o.exclude?.options=="string"?o.exclude.options=d.interpolate(o.exclude?.options):typeof o.exclude?.options?.pattern=="string"&&(o.exclude.options.pattern=d.interpolate(o.exclude?.options.pattern)),c.pipe((0,n.T)(a=>{const p=o.include?(0,s.NS)(o.include):null,u=o.exclude?(0,s.NS)(o.exclude):null,m=[];for(const v of a){const x=[];for(let E=0;E<v.fields.length;E++){const h=v.fields[E];if(u){if(u(h,v,a))continue;p||x.push(h)}p&&p(h,v,a)&&x.push(h)}if(!x.length)continue;const f={...v,fields:x};m.push(f)}return m})))},g={id:l.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(o,d)=>c=>!o.include&&!o.exclude?c.pipe(r.W.operator({},d)):c.pipe((0,n.T)(a=>{const p=o.include?(0,s.Dq)(o.include):null,u=o.exclude?(0,s.Dq)(o.exclude):null,m=[];for(const v of a){if(u){if(u(v))continue;p||m.push(v)}p&&p(v)&&m.push(v)}return m}))}},35602:(k,A,e)=>{"use strict";e.d(A,{D:()=>r,R:()=>i});var n=e(1173),s=e(64224),l=e(18282);const r={id:l.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(g,o)=>d=>d.pipe(s.z.operator({include:i(o,g.include,g.byVariable),exclude:i(o,g.exclude,g.byVariable)},o))},i=(g,o,d)=>{if(!o)return;const{names:c,pattern:a,variable:p}=o;if(d&&p){const u=g.interpolate(p);if(/\{.*\}/.test(u)){const m=u.slice(1).slice(0,-1).split(",");return{id:n.Ct.byNames,options:{names:m}}}return{id:n.Ct.byNames,options:{names:u.split(",")}}}if(!((!Array.isArray(c)||c.length===0)&&!a))return a?!Array.isArray(c)||c.length===0?{id:n.Ct.byRegexp,options:a}:{id:n.Ct.byRegexpOrNames,options:o}:{id:n.Ct.byNames,options:{names:c}}}},73376:(k,A,e)=>{"use strict";e.d(A,{Sm:()=>c,Sv:()=>a,j4:()=>d});var n=e(81160),s=e(28240),l=e(85200),r=e(1173),i=e(18282),g=e(64586),o=e(67641),d=(m=>(m.exclude="exclude",m.include="include",m))(d||{}),c=(m=>(m.all="all",m.any="any",m))(c||{});const a={id:i.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(m,v)=>x=>{const f=m.filters,E=m.match==="all",h=m.type==="include";if(!Array.isArray(f)||f.length===0)return x.pipe(g.W.operator({},v));const y=[];return(0,o.w)()&&y.push(...f.map(b=>{if(b.config.id===r.Js.between){let D=b.config.options.from,P=b.config.options.to;return typeof b.config.options.from=="string"&&(D=v.interpolate(D)),typeof b.config.options.to=="string"&&(P=v.interpolate(P)),{...b,config:{...b.config,options:{...b.config.options,to:P,from:D}}}}else if(b.config.options.value){let D=b.config.options.value;return typeof b.config.options.value=="string"&&(D=v.interpolate(D)),{...b,config:{...b.config,options:{...b.config.options,value:D}}}}return b})),x.pipe((0,n.T)(b=>{if(b.length===0)return b;const D=[];for(const P of b){const C=new Set,M=u(P,b);let I;(0,o.w)()?I=p(y,M):I=p(f,M);for(let S=0;S<P.length;S++){if(C.has(S))continue;let L=!0;for(const O of I){const j=O(S,P,b);if(!E&&j){L=!0;break}if(E&&!j){L=!1;break}L=j}L&&C.add(S)}const R=[],T=h?C.size:b[0].length-C.size;for(const S of P.fields){const L=[];for(let O=0;O<P.length;O++){if(h&&C.has(O)){L.push(S.values[O]);continue}if(!h&&!C.has(O)){L.push(S.values[O]);continue}}R.push({...S,values:L,state:{}})}D.push({...P,fields:R,length:T})}return D}))}},p=(m,v)=>{const x=()=>!1;return m.map(f=>{const E=v[f.fieldName]??-1;if(E<0)return console.warn(`[FilterByValue] Could not find index for field name: ${f.fieldName}`),x;const h=(0,l.kK)(f.config);return(y,b,D)=>h(y,b.fields[E],b,D)})},u=(m,v)=>{const x={};return m.fields.forEach((f,E)=>{const h=(0,s.Ct)(f,m,v);x[h]=E}),x}},15400:(k,A,e)=>{"use strict";e.d(A,{gs:()=>o,yt:()=>a});var n=e(81160),s=e(11261),l=e(81010),r=e(85200),i=e(1173),g=e(18282),o=(u=>(u.UpperCase="Upper Case",u.LowerCase="Lower Case",u.SentenceCase="Sentence Case",u.TitleCase="Title Case",u.PascalCase="Pascal Case",u.CamelCase="Camel Case",u.SnakeCase="Snake Case",u.KebabCase="Kebab Case",u.Trim="Trim",u.Substring="Substring",u))(o||{});const d=u=>{const m=u.split(" ");for(let v=0;v<m.length;v++)m[v]=m[v].charAt(0).toUpperCase()+m[v].slice(1).toLowerCase();return m},c=u=>m=>m.values.map(v=>{switch(u.outputFormat){case"Upper Case":return v.toUpperCase();case"Lower Case":return v.toLowerCase();case"Sentence Case":return v.charAt(0).toUpperCase()+v.slice(1);case"Title Case":return d(v).join(" ");case"Pascal Case":return d(v).join("");case"Camel Case":return v=d(v).join(""),v.charAt(0).toLowerCase()+v.slice(1);case"Snake Case":return v.toLowerCase().split(" ").join("_");case"Kebab Case":return v.toLowerCase().split(" ").join("-");case"Trim":return v.trim();case"Substring":return v.substring(u.substringStart,u.substringEnd)}}),a={id:g.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:u=>{for(const m of u)for(const v of m.fields)if(v.type==="string")return l.M.Applicable;return l.M.NotApplicable},operator:u=>m=>m.pipe((0,n.T)(v=>{if(v.length===0)return v;const x=r.sJ.get(i.Ct.byName).get(u.stringField),f=c(u),E=p(x,f);return v.map(h=>({...h,fields:E(h,v)}))}))},p=(u,m)=>(v,x)=>v.fields.map(f=>{if(u(f,v,x)){const E=m(f);return{...f,type:s.PU.string,values:E}}return f})},25094:(k,A,e)=>{"use strict";e.d(A,{Ce:()=>f,R3:()=>a,Y2:()=>x,of:()=>p});var n=e(81160),s=e(14236),l=e(28240),r=e(11261),i=e(81010),g=e(75059),o=e(18282),d=e(67641);const c=2;var a=(E=>(E.aggregate="aggregate",E.groupBy="groupby",E))(a||{});const p={id:o.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:E=>(0,d.f)(E)>=c?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:E=>{const h=(0,d.f)(E);return`The Group by transformation requires a series with at least ${c} fields to work. The maximum number of fields found on a series is ${h}`},operator:E=>h=>h.pipe((0,n.T)(y=>{if(!Object.keys(E.fields).find(P=>E.fields[P].operation==="groupby"))return y;const D=[];for(const P of y){const C=P.fields.filter(R=>u(R,E));if(C.length===0)continue;const M=x(P,C),I=f(C,M);for(const R of P.fields){if(!m(R,E))continue;const T=(0,l.Ct)(R),S=E.fields[T].aggregations,L={};M.forEach(O=>{const j=O[T],N=(0,g.Nw)({field:j,reducers:S});for(const F of S)Array.isArray(L[F])||(L[F]=[]),L[F].push(N[F])});for(const O of S){const j={name:`${T} (${O})`,values:L[O]??[],type:r.PU.other,config:{}};j.type=v(O,R,j),I.push(j)}}D.push({fields:I,length:M.size})}return D}))},u=(E,h)=>{const y=(0,l.Ct)(E);return h?.fields[y]?.operation==="groupby"},m=(E,h)=>{const y=(0,l.Ct)(E);return h?.fields[y]?.operation==="aggregate"&&Array.isArray(h?.fields[y].aggregations)&&h?.fields[y].aggregations.length>0};function v(E,h,y){switch(E){case g.gy.allIsNull:return r.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return h.type;default:return(0,s.dF)(y)??r.PU.string}}function x(E,h){const y=new Map;for(let b=0;b<E.length;b++){const D=String(h.map(C=>C.values[b])),P=y.get(D)??{};y.has(D)||y.set(D,P);for(let C of E.fields){const M=(0,l.Ct)(C);P[M]||(P[M]={name:M,type:C.type,config:{...C.config},values:[]}),P[M].values.push(C.values[b])}}return y}function f(E,h){const y=[];for(const b of E){const D=[],P=(0,l.Ct)(b);h.forEach(C=>{D.push(C[P].values[0])}),y.push({name:b.name,type:b.type,config:{...b.config},values:D})}return y}},68133:(k,A,e)=>{"use strict";e.d(A,{_:()=>m,l:()=>a});var n=e(81160),s=e(14236),l=e(28240),r=e(11261),i=e(81010),g=e(75059),o=e(25094),d=e(18282),c=e(67641);const a=!0,p=2;var u=(y=>(y.aggregate="aggregate",y.groupBy="groupby",y))(u||{});const m={id:d.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:a,fields:{}},isApplicable:y=>(0,c.f)(y)>=p?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:y=>{const b=(0,c.f)(y);return`The Group to nested table transformation requires a series with at least ${p} fields to work. The maximum number of fields found on a series is ${b}`},operator:y=>b=>b.pipe((0,n.T)(D=>{if(!Object.keys(y.fields).find(M=>y.fields[M].operation==="groupby"))return D;const C=[];for(const M of D){const I=M.fields.filter(L=>x(L,y));if(I.length===0)continue;const R=(0,o.Y2)(M,I),T=(0,o.Ce)(I,R),S=h(R,y);for(let L=0;L<M.fields.length;L++){const O=M.fields[L];if(!f(O,y))continue;const j=(0,l.Ct)(O),N=y.fields[j].aggregations,F={};R.forEach(U=>{const w=U[j],B=(0,g.Nw)({field:w,reducers:N});for(const K of N)Array.isArray(F[K])||(F[K]=[]),F[K].push(B[K])});for(const U of N){const w={name:`${j} (${U})`,values:F[U],type:r.PU.other,config:{}};w.type=E(U,O,w),T.push(w)}}T.push({config:{},name:"Nested frames",type:r.PU.nestedFrames,values:S}),C.push({fields:T,length:R.size})}return C}))};function v(y,b,D){return{meta:{custom:{noHeader:!(D.showSubframeHeaders===void 0?a:D.showSubframeHeaders)}},length:b,fields:y}}const x=(y,b)=>{const D=(0,l.Ct)(y);return b?.fields[D]?.operation==="groupby"},f=(y,b)=>{const D=(0,l.Ct)(y);return b?.fields[D]?.operation==="aggregate"&&Array.isArray(b?.fields[D].aggregations)&&b?.fields[D].aggregations.length>0},E=(y,b,D)=>{switch(y){case g.gy.allIsNull:return r.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return b.type;default:return(0,s.dF)(D)??r.PU.string}};function h(y,b){const D=[];for(const[,P]of y){const C=[];for(const[M,I]of Object.entries(P)){const R=b.fields[M];(R===void 0||R.aggregations===void 0||R.operation==="aggregate"&&R.aggregations.length===0||R.operation===null||R.operation===void 0)&&C.push(I)}C.length>0?D.push([v(C,C[0].values.length,b)]):D.push([v([],0,b)])}return D}},77678:(k,A,e)=>{"use strict";e.d(A,{H1:()=>b,NX:()=>h,OA:()=>f,Rt:()=>x,Uh:()=>M,ZU:()=>C,cg:()=>T,d$:()=>E,dA:()=>y,ix:()=>D,p3:()=>P,rW:()=>p,rs:()=>I});var n=e(81160),s=e(57875),l=e(75972),r=e(11261),i=e(41260),g=e(97706),o=e(18282),d=e(73060),c=e(39624),a=e(67641);const p=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],u=30,m=[],v=(S,L)=>S-L,x={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},f={id:o.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(S,L)=>O=>O.pipe((0,n.T)(j=>f.transformer(S,L)(j))),transformer:(S,L)=>O=>{if(!Array.isArray(O)||O.length===0)return O;let j,N;S.bucketSize&&((0,a.w)()&&(S.bucketSize=L.interpolate(S.bucketSize.toString())),typeof S.bucketSize=="string"?j=parseFloat(S.bucketSize):j=S.bucketSize,isNaN(j)&&(j=void 0)),S.bucketOffset&&((0,a.w)()&&(S.bucketOffset=L.interpolate(S.bucketOffset.toString())),typeof S.bucketOffset=="string"?N=parseFloat(S.bucketOffset):N=S.bucketOffset,isNaN(N)&&(N=void 0));const F={bucketSize:j,bucketOffset:N,combine:S.combine},U=P(O,F);return U==null?[]:[T(U)]}},E="xMin";function h(S){return S===E||S==="BucketMin"}const y="xMax";function b(S){return S===y||S==="BucketMax"}function D(S){if(S.meta?.type===i.m.HeatmapCells){let N=S.fields.find(z=>z.name==="yMin"),F=S.fields.find(z=>z.name==="yMax"),U=S.fields.find(z=>z.name==="count"),w=[...new Set(F.values)].sort((z,Y)=>z-Y),B=[...new Set(N.values)].sort((z,Y)=>z-Y),K=new Map;w.forEach(z=>K.set(z,0));for(let z=0;z<F.values.length;z++){let Y=F.values[z];K.set(Y,K.get(Y)+U.values[z])}return{xMin:{...N,name:"xMin",values:B},xMax:{...F,name:"xMax",values:w},counts:[{...U,values:[...K.values()]}]}}else if(S.meta?.type===i.m.HeatmapRows){let N=[],F=[],U=[],w="0";return S.fields.forEach(K=>{if(K.type===r.PU.number){let W=K.values.reduce((z,Y)=>z+Y,0);U.push(W),N.push(w),F.push(w=K.name)}}),U.push(0),N.push(w),F.push(w),{xMin:{...S.fields[1],name:"xMin",type:r.PU.string,values:N},xMax:{...S.fields[1],name:"xMax",type:r.PU.string,values:F},counts:[{...S.fields[1],name:"count",type:r.PU.number,values:U}]}}let L,O;const j=[];for(const N of S.fields)h(N.name)?L=N:b(N.name)?O=N:N.type===r.PU.number&&j.push(N);if(!O&&L&&L.values.length>1){let N=L.values,F=(0,g.h)(N[1]-N[0],6);O={...L,name:y,values:N.map(U=>U+F)}}if(!L&&O&&O?.values.length>1){let N=O.values,F=(0,g.h)(N[1]-N[0],6);L={...O,name:E,values:N.map(U=>U-F)}}if(L&&O&&j.length)return{xMin:L,xMax:O,counts:j}}function P(S,L){let O=L?.bucketSize,j=L?.bucketCount??u,N=L?.bucketOffset??0;if(S=S.map(X=>({...X,fields:X.fields.map(q=>{if(q.type===r.PU.number){const G=Number(q.config.noValue);Number.isNaN(G)?q={...q,values:q.values.filter(te=>te!=null)}:q=(0,c.A)(q,G)}return q})})),!O||O<0){let X=[];for(const ne of S)for(const le of ne.fields)le.type===r.PU.number&&(X=X.concat(le.values));X.sort((ne,le)=>ne-le);let q=1/0;if(X.length===1)q=1;else for(let ne=1;ne<X.length;ne++){let le=X[ne]-X[ne-1];le!==0&&(q=Math.min(q,le))}let G=X[0];const se=(X[X.length-1]-G)/j;for(let ne=0;ne<p.length;ne++){let le=p[ne];if(se<le&&le>=q){O=le;break}}}const F=X=>(0,g.h)(I(X-N,O)+N,9);let U=((""+O).match(/\.\d+$/)??["."])[0].length-1,w=[],B=[],K;for(const X of S)for(const q of X.fields)if(q.type===r.PU.number){let G=R(q.values,F,m,v);w.push(G),B.push({...q,config:{...q.config,unit:q.config.unit==="short"?"short":void 0}}),!K&&q.config.unit&&(K=q.config)}if(!B.length)return null;let W=(0,d.fj)(w);for(let X=1;X<W.length;X++){let q=W[X];for(let G=0;G<q.length;G++)q[G]==null&&(q[G]=0)}const z={name:E,values:W[0],type:r.PU.number,state:void 0,config:U===0?K??{}:{...K,decimals:U}},Y={...z,name:y,values:W[0].map(X=>X+O)};if(L?.combine){const X=new Array(W[0].length).fill(0);for(let q=1;q<W.length;q++)for(let G=0;G<X.length;G++)X[G]+=W[q][G];B=[{...B[0],name:"count",values:X,type:r.PU.number,state:{...B[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else B.forEach((X,q)=>{X.values=W[q+1]});return{xMin:z,xMax:Y,counts:B}}function C(S,L){return Math.round(S/L)*L}function M(S,L){return Math.ceil(S/L)*L}function I(S,L){return Math.floor(S/L)*L}function R(S,L,O,j){let N=new Map;for(let B=0;B<S.length;B++){let K=S[B];K!=null&&(K=L(K));let W=N.get(K);W?W.count++:N.set(K,{value:K,count:1})}O&&O.forEach(B=>N.delete(B));let F=[...N.values()];j&&F.sort((B,K)=>j(B.value,K.value));let U=Array(F.length),w=Array(F.length);for(let B=0;B<F.length;B++)U[B]=F[B].value,w[B]=F[B].count;return[U,w]}function T(S,L){if(!S.xMin.display){const O=(0,s.J)({field:S.xMin,theme:L??(0,l.a)()});S.xMin.display=O,S.xMax.display=O}return S.counts[0].display=(0,s.J)({field:S.counts[0],theme:L??(0,l.a)()}),{length:S.xMin.values.length,meta:{type:i.m.Histogram},fields:[S.xMin,S.xMax,...S.counts]}}},41511:(k,A,e)=>{"use strict";e.d(A,{L:()=>o,W:()=>g});var n=e(81160),s=e(85200),l=e(1173),r=e(18282),i=e(73060),g=(d=>(d.outer="outer",d.inner="inner",d.outerTabular="outerTabular",d))(g||{});const o={id:r.F.joinByField,aliasIds:[r.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(d,c)=>a=>a.pipe((0,n.T)(p=>o.transformer(d,c)(p))),transformer:(d,c)=>{let a;return p=>{if(p.length>1){d.byField&&!a&&(a=s.sJ.get(l.Ct.byName).get(c.interpolate(d.byField)));const u=(0,i.Fd)({frames:p,joinBy:a,mode:d.mode});if(u)return[u]}return p}}}},73060:(k,A,e)=>{"use strict";e.d(A,{Fd:()=>c,JI:()=>v,RC:()=>u,WO:()=>m,Yj:()=>d,fj:()=>f,g2:()=>E});var n=e(14236),s=e(11261),l=e(85200),r=e(1173),i=e(41511);function g(h){const{timeField:y}=(0,n.KR)(h[0]);if(y)return l.sJ.get(r.Ct.firstTimeField).get({});let b=[];for(const D of h[0].fields)D.type===s.PU.number&&b.push(D.name);for(let D=1;D<h.length;D++){const P=[];for(const C of h[0].fields)C.type===s.PU.number&&P.push(C.name);b=b.filter(C=>!P.includes(C))}return l.sJ.get(r.Ct.byName).get(b[0])}function o(h){return h.joinBy??g(h.frames)}function d(h,y){if(y>=0){let b=h.fields[y];b.type!==s.PU.string&&!E(b.values)&&(h=(0,n.ES)(h,y))}return h}function c(h){if(!h.frames?.length)return;const y=h.nullMode??(T=>{let S=T.config.custom?.spanNulls;return S===!0?u:S===-1?m:v});if(h.frames.length===1){let T=h.frames[0],S=T;const L=o(h);let O=S.fields.findIndex(j=>L(j,S,h.frames));if(h.keepOriginIndices&&(S={...T,fields:T.fields.map((j,N)=>{const F={...j},U={frameIndex:0,fieldIndex:N};return F.state?F.state.origin=U:F.state={origin:U},F})},O>0)){const j=S.fields[O],N=S.fields.filter((F,U)=>U!==O);N.unshift(j),S.fields=N,O=0}if(O>=0&&(S=d(S,O)),h.keep){let j=S.fields.filter((N,F)=>F===O||h.keep(N,S,h.frames));T!==S?S.fields=j:S={...T,fields:j}}return S}const b=[],D=[],P=[],C=[];let M=1;const I=o(h);for(let T=0;T<h.frames.length;T++){const S=h.frames[T];if(!S||!S.fields?.length)continue;const L=[u];let O,j=[],N=[];for(let U=0;U<S.fields.length;U++){const w=S.fields[U];if(w.state=w.state||{},!O&&I(w,S,h.frames))O=w;else{if(h.keep&&!h.keep(w,S,h.frames))continue;L.push(y(w));let B=w.labels??{},K=w.name;S.name&&(w.name===s.Bc?K=S.name:B.name==null&&(B={...B,name:S.name})),j.push({...w,name:K,labels:B})}h.keepOriginIndices&&(w.state.origin={frameIndex:T,fieldIndex:U})}if(!O)continue;P.length===0&&P.push(O),b.push(L);const F=[O.values];for(const U of j)F.push(U.values),P.push(U),h.keepDisplayNames||delete U.state?.displayName,N.push(M),M++;C.push(N),D.push(F)}let R=[];return h.mode===i.W.outerTabular?R=a(D,C,P.length,b):h.mode===i.W.inner?R=p(D):R=f(D,b,h.mode),{length:R[0]?R[0].length:0,fields:P.map((T,S)=>({...T,values:R[S]}))}}function a(h,y,b,D){let P={};for(let M=0;M<h.length;M++){let I=h[M],R=I[0];for(let T=0;T<h.length;T++){if(T===M)continue;let S=h[T],L=S[0];for(let O=0;O<R.length;O++){const j=R[O],N=b-1;let F=[j].concat(new Array(N)),U=0;for(let w=1;w<I.length;w++){const B=y[M][U];F[B]=I[w][O],U++}for(let w=0;w<L.length;w++)if(R[O]===L[w]){let B=0;for(let K=1;K<S.length;K++){const W=y[T][B];F[W]=S[K][w],B++}break}P[JSON.stringify(F)]=F}}}let C=[];for(let M=0;M<b;M++)C.push(new Array(0));for(let M in P){const I=P[M];for(let R=0;R<I.length;R++)C[R].push(I[R])}return C}function p(h){const y=[],b=(D,P,C)=>{if(P===D.length){y.push(C);return}const M=D[P],[I,...R]=M;for(let T=0;T<I.length;T++){const S=I[T];if(P===0||C.includes(S)){const L=[...C];P===0&&L.push(S);for(let O=0;O<R.length;O++)L.push(R[O][T]);b(D,P+1,L)}}};return b(h,0,[]),y.length===0?[]:y[0].map((D,P)=>y.map(C=>C[P]))}const u=0,m=1,v=2;function x(h,y,b){for(let D=0,P,C=-1;D<y.length;D++){let M=y[D];if(M>C){for(P=M-1;P>=0&&h[P]==null;)h[P--]=null;for(P=M+1;P<b&&h[P]==null;)h[C=P++]=null}}}function f(h,y,b=i.W.outer){let D=new Set;for(let I=0;I<h.length;I++){let T=h[I][0],S=T.length;for(let L=0;L<S;L++)D.add(T[L])}let P=[Array.from(D).sort((I,R)=>I-R)],C=P[0].length,M=new Map;for(let I=0;I<C;I++)M.set(P[0][I],I);for(let I=0;I<h.length;I++){let R=h[I],T=R[0];for(let S=1;S<R.length;S++){let L=R[S],O=Array(C).fill(void 0),j=y?y[I][S]:m,N=[];for(let F=0;F<L.length;F++){let U=L[F],w=M.get(T[F]);U===null?j!==u&&(O[w]=U,j===v&&N.push(w)):O[w]=U}x(O,N,C),P.push(O)}}return P}function E(h,y=50){const b=h.length;if(b<=1)return!0;let D=0,P=b-1;for(;D<=P&&h[D]==null;)D++;for(;P>=D&&h[P]==null;)P--;if(P<=D)return!0;const C=Math.max(1,Math.floor((P-D+1)/y));for(let M=h[D],I=D+C;I<=P;I+=C){const R=h[I];if(R!=null){if(R<=M)return!1;M=R}}return!0}},6829:(k,A,e)=>{"use strict";e.d(A,{V:()=>g,n:()=>i});var n=e(81160),s=e(28240),l=e(11261),r=e(18282),i=(d=>(d.Columns="columns",d.Rows="rows",d))(i||{});const g={id:r.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(d,c)=>a=>a.pipe((0,n.T)(p=>g.transformer(d,c)(p))),transformer:d=>c=>{if(d.mode==="rows")return o(c,d.keepLabels);const a=[],p=d.keepLabels?.length?new Set(d.keepLabels):void 0;for(const u of c){const m=[],v={};for(const x of u.fields){if(!x.labels){m.push(x);continue}const f={...x,config:{...x.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};m.push(f);for(const E of Object.keys(x.labels)){if(p&&!p.has(E))continue;if(d.valueLabel===E){f.name=x.labels[E];continue}(v[E]??(v[E]=new Set)).add(x.labels[E])}}for(const x in v)for(const f of v[x]){const E=new Array(u.length).fill(f);m.push({name:x,type:l.PU.string,values:E,config:{}})}a.push({...u,fields:m,length:u.length})}return a}};function o(d,c){const a=[];for(const p of d)for(const u of p.fields)if(u.labels){const m=[],v=[];if(c)for(const x of c)m.push(x),v.push(u.labels[x]);else for(const[x,f]of Object.entries(u.labels))m.push(x),v.push(f);v.length&&a.push({...p,name:(0,s.Ct)(u,p,d),fields:[{name:"label",type:l.PU.string,config:{},values:m},{name:"value",type:l.PU.string,config:{},values:v}],length:v.length})}return a}},58140:(k,A,e)=>{"use strict";e.d(A,{o:()=>o});var n=e(2543),s=e.n(n),l=e(81160),r=e(37471),i=e(81010),g=e(18282);const o={id:g.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:v=>v.length>1?i.M.Applicable:i.M.NotApplicable,isApplicableDescription:v=>`The merge transformation requires at least 2 data series to work. There is currently ${v.length} data series.`,operator:v=>x=>x.pipe((0,l.T)(f=>{if(!Array.isArray(f)||f.length<=1)return f;const E=f.filter(R=>R.fields.length>0);if(E.length===0)return[f[0]];const h=new Set,y={},b=[],D=new r.k;for(let R=0;R<E.length;R++){const T=E[R];for(let S=0;S<T.fields.length;S++){const L=T.fields[S];h.has(L.name)||(D.addField(d(L)),h.add(L.name)),y[L.name]=y[L.name]||{},y[L.name][R]=S,E.length-1===R&&u(y,L,E)&&b.push(L.name)}}if(b.length===0)return f;const P={},C=[],M=c(E,y,b),I=a(E,h,y);for(let R=0;R<E.length;R++){const T=E[R];for(let S=0;S<T.length;S++){const L=M(R,S),O=I(R,S);if(!Array.isArray(P[L])){P[L]=[O],C.push(m(L,P));continue}let j=!1;P[L]=P[L].map(N=>p(N,O)?(j=!0,{...N,...O}):N),j||(P[L].push(O),C.push(m(L,P)))}}for(const R of C){const T=P[R.key][R.index];T&&D.add(T)}return[D]}))},d=v=>({...(0,n.omit)(v,["values","state","labels","config"]),values:[],config:{...(0,n.omit)(v.config,"displayName")}}),c=(v,x,f)=>{const E=f.reduce((h,y)=>Object.keys(x[y]).reduce((b,D)=>(b[D]=b[D]||[],b[D].push(x[y][D]),b),h),{});return(h,y)=>E[h].reduce((b,D)=>b+v[h].fields[D].values[y],"")},a=(v,x,f)=>(E,h)=>{const y={},b=Array.from(x);for(const D of b){const P=f[D];if(!P)continue;const C=P[E];if(typeof C!="number")continue;const M=v[E];if(!M||!M.fields)continue;const I=M.fields[C];!I||!I.values||(y[D]=I.values[h])}return y},p=(v,x)=>{let f=!0;for(const E in x)if(!(typeof v[E]>"u")&&v[E]!==null&&v[E]!==x[E]){f=!1;break}return f},u=(v,x,f)=>Object.keys(v[x.name]).length===f.length,m=(v,x)=>({key:v,index:x[v].length-1})},64586:(k,A,e)=>{"use strict";e.d(A,{W:()=>s});var n=e(18282);const s={id:n.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:l=>r=>r,transformer:l=>r=>r}},46294:(k,A,e)=>{"use strict";e.d(A,{M:()=>r});var n=e(11261);const s={threshold:(g,o,d)=>g+d,midpoint:(g,o,d)=>(g+o)/2,plusone:(g,o,d)=>g+1};function l(g,o){return g.fields.find(d=>o!=null?d.name===o:d.type===n.PU.time)}function r(g){if(g.frame.length===0)return g.frame;let o=!0,{frame:d,refFieldName:c,refFieldPseudoMax:a,refFieldPseudoMin:p,insertMode:u}=g;u||(u=s.threshold);const m=l(d,c);if(m==null)return d;m.state={...m.state,nullThresholdApplied:!0};const v=d.fields.map(f=>f.config.custom?.insertNulls||m.config.interval||null),x=new Set(v);if(x.delete(null),x.size===0)return d;if(x.size===1){const f=x.values().next().value;if(f<=0)return d;const E=m.values,h=d.fields.map(b=>b.values),y=i(E,h,f,p,a,u,o);return y===h?d:{...d,length:y[0].length,fields:d.fields.map((b,D)=>({...b,values:y[D]}))}}return d}function i(g,o,d,c=null,a=null,p,u){const m=g.length,v=[];if(c!=null&&c<g[0]){let h=Math.ceil((g[0]-c)/d),y=g[0]-h*d;for(;y<g[0];)v.push(p(y-d,y,d)),y+=d}v.push(g[0]);let x=g[0];for(let h=1;h<m;h++){const y=g[h];for(;y-x>d&&(v.push(p(x,y,d)),x+=d,!!u););v.push(y),x=y}if(a!=null&&a>x)for(;x+d<a;)v.push(p(x,a,d)),x+=d;const f=v.length;if(f===m)return o;const E=[];for(let h of o){let y;if(h!==g){y=Array(f);for(let b=0,D=0;b<f;b++)y[b]=g[D]===v[b]?h[D++]:null}else y=v;E.push(y)}return E}},39624:(k,A,e)=>{"use strict";e.d(A,{A:()=>s,C:()=>n});function n(l){return{...l,fields:l.fields.map(r=>{const i=Number(r.config.noValue);return Number.isNaN(i)?r:s(r,i)})}}function s(l,r){const i=l.values.slice();for(let g=0;g<i.length;g++)i[g]===null&&(i[g]=r);return{...l,values:i}}},82280:(k,A,e)=>{"use strict";e.d(A,{X:()=>o,x:()=>g});var n=e(2543),s=e.n(n),l=e(81160),r=e(28240),i=e(18282);const g={id:i.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:a=>p=>p.pipe((0,l.T)(u=>{const m=d(a.indexByName);return!Array.isArray(u)||u.length===0?u:u.map(v=>({...v,fields:m(v.fields,u,v)}))}))},o=a=>(p,u)=>c(p,a)-c(u,a),d=a=>(p,u,m)=>{if(!Array.isArray(p)||p.length===0||!a||Object.keys(a).length===0)return p;const v=o(a);return(0,n.clone)(p).sort((x,f)=>v((0,r.Ct)(x,m,u),(0,r.Ct)(f,m,u)))},c=(a,p)=>Number.isInteger(p[a])?p[a]:Number.MAX_SAFE_INTEGER},21128:(k,A,e)=>{"use strict";e.d(A,{Wj:()=>a,rV:()=>c});var n=e(81160),s=e(14236),l=e(28240),r=e(11261),i=e(75059),g=e(85200),o=e(72693),d=e(18282),c=(f=>(f.SeriesToRows="seriesToRows",f.ReduceFields="reduceFields",f))(c||{});const a={id:d.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[i.gy.max]},operator:f=>E=>E.pipe((0,n.T)(h=>{if(!f?.reducers?.length)return h;const y=f.fields?(0,g.NS)(f.fields):f.includeTimeField&&f.mode==="reduceFields"?o.Yg:o.zx;if(f.mode==="reduceFields")return v(h,y,f.reducers);const b=p(h,y,f.reducers,f.labelsToFields);return b?[b]:[]}))};function p(f,E,h,y){const b=i.AS.list(h),D=b.map(M=>M.id),P=[],C=y?u(f):[];for(const M of f){const I=M.fields.filter(j=>E(j,M,f)),R=I.length,T=[],S=new Array(R);T.push({name:"Field",type:r.PU.string,values:S,config:{}});const L={};if(y)for(const j of C)L[j]=new Array(R),T.push({name:j,type:r.PU.string,values:L[j],config:{}});const O={};for(const j of b)O[j.id]=new Array(R),T.push({name:j.name,type:r.PU.other,values:O[j.id],config:{}});for(let j=0;j<I.length;j++){const N=I[j],F=(0,i.Nw)({field:N,reducers:D});if(y){if(S[j]=N.name,N.labels)for(const U in N.labels)L[U][j]=N.labels[U]}else S[j]=(0,l.Ct)(N,M,f);for(const U of b){const w=F[U.id];w===null?O[U.id][j]=NaN:O[U.id][j]=w}}for(const j of T)if(j.type===r.PU.other){const N=(0,s.dF)(j);N&&(j.type=N)}P.push({...M,fields:T,length:R})}return m(P)}function u(f){const E=new Set;for(const h of f)for(const y of h.fields)if(y.labels)for(const b of Object.keys(y.labels))E.add(b);return[...E]}function m(f){if(!f?.length)return;const E=f[0];for(let h=1;h<f.length;h++){const y=f[h];for(let b=0;b<E.fields.length;b++){const D=E.fields[b];for(let P=0;P<y.fields.length;P++){const C=y.fields[P],M=b===0&&P===0,I=D.type===C.type&&D.name===C.name;if(M||I){const R=D.values,T=C.values;D.values=R.concat(T)}}}}return E.name=void 0,E.length=E.fields[0].values.length,E}function v(f,E,h){const b=i.AS.list(h).map(P=>P.id),D=[];for(const P of f){const C=[];for(const M of P.fields)if(E(M,P,f)){const I=(0,i.Nw)({field:M,reducers:b});for(const R of b){const T=I[R],S={...M,type:x(R,M),values:[T]};S.state=void 0,b.length>1&&(S.labels||(S.labels={}),S.labels.reducer=i.AS.get(R).name),C.push(S)}}C.length&&D.push({...P,fields:C,length:1})}return D}function x(f,E){switch(f){case i.gy.allValues:case i.gy.uniqueValues:return r.PU.other;case i.gy.first:case i.gy.firstNotNull:case i.gy.last:case i.gy.lastNotNull:return E.type;default:return r.PU.number}}},67641:(k,A,e)=>{"use strict";e.d(A,{f:()=>s,w:()=>n});const n=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function s(l){let r=0;for(const i of l)i.fields.length>r&&(r=i.fields.length);return r}},43585:(k,A,e)=>{"use strict";e.d(A,{O:()=>n});var n=(s=>(s.NoData="no_data",s.Paused="paused",s.Alerting="alerting",s.OK="ok",s.Pending="pending",s.Unknown="unknown",s))(n||{})},8790:(k,A,e)=>{"use strict";e.d(A,{V:()=>n});var n=(s=>(s.Field="field",s.Text="text",s.Skip="skip",s))(n||{})},41987:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>i,Jk:()=>l,hX:()=>r});var n=e(43429),s=e(74135),l=(g=>(g.CloudAlerting="cloud-alerting",g.UnifiedAlerting="unified-alerting",g.Dashboard="dashboard",g.Explore="explore",g.Correlations="correlations",g.Unknown="unknown",g.PanelEditor="panel-editor",g.PanelViewer="panel-viewer",g))(l||{});class r extends n.Ud{constructor(){super(...arguments),this._extensionConfigs=[]}init(o){}setRootPage(o){return this.root=o,this}setComponentsFromLegacyExports(o){if(o.ConfigCtrl&&(this.angularConfigCtrl=o.ConfigCtrl),this.meta&&this.meta.includes){for(const d of this.meta.includes)if(d.type===n.ib.page&&d.component&&!o[d.component]){console.warn("App Page uses unknown component: ",d.component,this.meta);continue}}}get extensionConfigs(){return this._extensionConfigs}addLink(o){const{targets:d,...c}=o;return(Array.isArray(d)?d:[d]).forEach(p=>{this._extensionConfigs.push({...c,extensionPointId:p,type:s.u.link})}),this}addComponent(o){const{targets:d,...c}=o;return(Array.isArray(d)?d:[d]).forEach(p=>{this._extensionConfigs.push({...c,extensionPointId:p,type:s.u.component})}),this}exposeComponent(o){const{id:d,...c}=o;return this._extensionConfigs.push({...c,extensionPointId:`capabilities/${d}`,type:s.u.component}),this}configureExtensionLink(o){return this.addLink({targets:[o.extensionPointId],...o}),this}configureExtensionComponent(o){return this.addComponent({targets:[o.extensionPointId],...o}),this}}var i=(g=>(g.alpha="alpha",g.beta="beta",g.experimental="experimental",g.privatePreview="private preview",g.preview="preview",g))(i||{})},61268:(k,A,e)=>{"use strict";e.d(A,{r:()=>n});var n=(s=>(s.OpenSource="Open Source",s.Pro="Pro",s.Enterprise="Enterprise",s))(n||{})},58649:(k,A,e)=>{"use strict";e.d(A,{En:()=>l,d1:()=>s,tw:()=>n});const n=0,s=100,l="SAML"},94624:(k,A,e)=>{"use strict";e.d(A,{y:()=>n});var n=(s=>(s[s.Off=0]="Off",s[s.Crosshair=1]="Crosshair",s[s.Tooltip=2]="Tooltip",s))(n||{})},39070:(k,A,e)=>{"use strict";e.d(A,{Gu:()=>n,Gv:()=>g,Nx:()=>s,UW:()=>l,zz:()=>r});var n=(o=>(o.NotStarted="NotStarted",o.Loading="Loading",o.Streaming="Streaming",o.Done="Done",o.Error="Error",o))(n||{});const s=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var l=(o=>(o.Null="null",o.Ignore="connected",o.AsZero="null as zero",o))(l||{});const r=o=>!!o;function i(o){return o}function g(o){return typeof o=="object"&&o!==null?!0:!1}},11261:(k,A,e)=>{"use strict";e.d(A,{Bc:()=>s,LE:()=>l,PU:()=>n,aI:()=>r});var n=(i=>(i.time="time",i.number="number",i.string="string",i.boolean="boolean",i.trace="trace",i.geo="geo",i.enum="enum",i.other="other",i.frame="frame",i.nestedFrames="nestedFrames",i))(n||{});const s="Value",l="Time",r="Metric"},41260:(k,A,e)=>{"use strict";e.d(A,{m:()=>n});var n=(s=>(s.TimeSeriesWide="timeseries-wide",s.TimeSeriesLong="timeseries-long",s.TimeSeriesMany="timeseries-many",s.TimeSeriesMulti="timeseries-multi",s.NumericWide="numeric-wide",s.NumericMulti="numeric-multi",s.NumericLong="numeric-long",s.LogLines="log-lines",s.DirectoryListing="directory-listing",s.HeatmapRows="heatmap-rows",s.HeatmapCells="heatmap-cells",s.Histogram="histogram",s))(n||{})},91890:(k,A,e)=>{"use strict";e.d(A,{$0:()=>l,CC:()=>s,uP:()=>r,x0:()=>n,yd:()=>i});var n=(g=>(g.Datasource="Datasource",g.Correlations="Correlations",g.ExploreCorrelationsEditor="CorrelationsEditor",g))(n||{}),s=(g=>(g.Regex="regex",g.Logfmt="logfmt",g))(s||{}),l=(g=>(g.Series="series",g.Field="field",g.Fields="fields",g.Value="value",g.BuiltIn="built-in",g.Template="template",g))(l||{}),r=(g=>(g.Values="values",g))(r||{}),i=(g=>(g.Link="link",g.Off="off",g))(i||{})},40187:(k,A,e)=>{"use strict";e.d(A,{Is:()=>o,ZF:()=>i,mA:()=>r,tD:()=>l,v2:()=>g});var n=e(92341),s=e(43429);class l extends s.Ud{constructor(c){super(),this.DataSourceClass=c,this.components={}}setConfigEditor(c){return this.components.ConfigEditor=c,this}setConfigCtrl(c){return this.angularConfigCtrl=c,this}setQueryCtrl(c){return this.components.QueryCtrl=c,this}setAnnotationQueryCtrl(c){return this.components.AnnotationsQueryCtrl=c,this}setQueryEditor(c){return this.components.QueryEditor=c,this}setExploreQueryField(c){return this.components.ExploreQueryField=c,this}setExploreMetricsQueryField(c){return this.components.ExploreMetricsQueryField=c,this}setExploreLogsQueryField(c){return this.components.ExploreLogsQueryField=c,this}setQueryEditorHelp(c){return this.components.QueryEditorHelp=c,this}setExploreStartPage(c){return this.setQueryEditorHelp(c)}setVariableQueryEditor(c){return this.components.VariableQueryEditor=c,this}setMetadataInspector(c){return this.components.MetadataInspector=c,this}setComponentsFromLegacyExports(c){this.angularConfigCtrl=c.ConfigCtrl,this.components.QueryCtrl=c.QueryCtrl,this.components.AnnotationsQueryCtrl=c.AnnotationsQueryCtrl,this.components.ExploreQueryField=c.ExploreQueryField,this.components.QueryEditor=c.QueryEditor,this.components.QueryEditorHelp=c.QueryEditorHelp,this.components.VariableQueryEditor=c.VariableQueryEditor}}class r{constructor(c){this.name=c.name,this.id=c.id,this.type=c.type,this.meta=c.meta,this.cachingConfig=c.cachingConfig,this.uid=c.uid,this.apiVersion=c.apiVersion}filterQuery(c){return!0}getRef(){const c={type:this.type,uid:this.uid};return this.apiVersion&&(c.apiVersion=this.apiVersion),c}}var i=(d=>(d.Logs="Logs",d.Metrics="Metrics",d.Tracing="Tracing",d))(i||{}),g=(d=>(d.Cancelled="cancelled",d.Timeout="timeout",d.Unknown="unknown",d))(g||{});class o{}o=(0,n.Y)(o),r=(0,n.Y)(r)},24293:(k,A,e)=>{"use strict";e.d(A,{F:()=>s,Y:()=>n});var n=(l=>(l.Thresholds="thresholds",l.PaletteClassic="palette-classic",l.PaletteClassicByName="palette-classic-by-name",l.PaletteSaturated="palette-saturated",l.ContinuousGrYlRd="continuous-GrYlRd",l.ContinuousRdYlGr="continuous-RdYlGr",l.ContinuousBlYlRd="continuous-BlYlRd",l.ContinuousYlRd="continuous-YlRd",l.ContinuousBlPu="continuous-BlPu",l.ContinuousYlBl="continuous-YlBl",l.ContinuousBlues="continuous-blues",l.ContinuousReds="continuous-reds",l.ContinuousGreens="continuous-greens",l.ContinuousPurples="continuous-purples",l.Fixed="fixed",l.Shades="shades",l))(n||{});const s="#808080"},37055:(k,A,e)=>{"use strict";e.d(A,{Ow:()=>s,ZW:()=>n,uo:()=>l});function n(r){return i=>"__systemRef"in i&&i.__systemRef===r}const s=r=>"__systemRef"in r&&typeof r.__systemRef=="string";var l=(r=>(r.Unit="unit",r.Min="min",r.Max="max",r.Decimals="decimals",r.DisplayName="displayName",r.NoValue="noValue",r.Thresholds="thresholds",r.Mappings="mappings",r.Links="links",r.Color="color",r.Filterable="filterable",r))(l||{})},8887:(k,A,e)=>{"use strict";e.d(A,{Uo:()=>l,az:()=>n,n6:()=>s});const n={google:!0,microsoft:!0,github:!0,gitlab:!0,okta:!0,discord:!0,hipchat:!0,amazon:!0,"google-hangouts-alt":!0,pagerduty:!0,line:!0,anchor:!0,"adjust-circle":!0,"angle-double-down":!0,"angle-double-right":!0,"angle-double-left":!0,"angle-double-up":!0,"angle-down":!0,"angle-left":!0,"angle-right":!0,"angle-up":!0,"align-left":!0,"align-right":!0,"application-observability":!0,apps:!0,"archive-alt":!0,arrow:!0,"arrow-down":!0,"arrow-from-right":!0,"arrow-left":!0,"arrow-random":!0,"arrow-right":!0,"arrow-to-right":!0,"arrow-up":!0,"arrows-h":!0,"arrows-v":!0,asserts:!0,"expand-arrows":!0,"expand-arrows-alt":!0,at:!0,ai:!0,backward:!0,bars:!0,bell:!0,"bell-slash":!0,bolt:!0,book:!0,bookmark:!0,"book-open":!0,"brackets-curly":!0,bug:!0,building:!0,"calculator-alt":!0,"calendar-alt":!0,"calendar-slash":!0,camera:!0,capture:!0,"channel-add":!0,"chart-line":!0,check:!0,"check-circle":!0,"check-square":!0,circle:!0,"circle-mono":!0,"clipboard-alt":!0,"clock-nine":!0,cloud:!0,"cloud-download":!0,"cloud-upload":!0,"code-branch":!0,cog:!0,columns:!0,"comment-alt":!0,"comment-alt-message":!0,"comment-alt-share":!0,"comments-alt":!0,compass:!0,"compress-arrows":!0,copy:!0,"corner-down-right-alt":!0,"create-dashboard":!0,"credit-card":!0,crosshair:!0,cube:!0,dashboard:!0,database:!0,"dice-three":!0,docker:!0,"document-info":!0,"document-layout-left":!0,"download-alt":!0,draggabledots:!0,edit:!0,"ellipsis-v":!0,enter:!0,envelope:!0,"exchange-alt":!0,"exclamation-triangle":!0,"exclamation-circle":!0,exclamation:!0,"external-link-alt":!0,eye:!0,"eye-slash":!0,"ellipsis-h":!0,"fa fa-spinner":!0,favorite:!0,"file-alt":!0,"file-blank":!0,"file-copy-alt":!0,"file-download":!0,"file-edit-alt":!0,"file-landscape-alt":!0,filter:!0,flip:!0,folder:!0,font:!0,fire:!0,"folder-open":!0,"folder-plus":!0,"folder-upload":!0,forward:!0,"frontend-observability":!0,"gf-bar-alignment-after":!0,"gf-bar-alignment-before":!0,"gf-bar-alignment-center":!0,"gf-glue":!0,"gf-grid":!0,"gf-interpolation-linear":!0,"gf-interpolation-smooth":!0,"gf-interpolation-step-after":!0,"gf-interpolation-step-before":!0,"gf-landscape":!0,"gf-layout-simple":!0,"gf-logs":!0,"gf-ml":!0,"gf-movepane-left":!0,"gf-movepane-right":!0,"gf-portrait":!0,"gf-service-account":!0,"gf-show-context":!0,"gf-pin":!0,"gf-prometheus":!0,"gf-traces":!0,globe:!0,grafana:!0,"graph-bar":!0,heart:!0,"heart-rate":!0,"heart-break":!0,history:!0,"history-alt":!0,home:!0,"home-alt":!0,"horizontal-align-center":!0,"horizontal-align-left":!0,"horizontal-align-right":!0,hourglass:!0,import:!0,info:!0,"info-circle":!0,k6:!0,"key-skeleton-alt":!0,keyboard:!0,kubernetes:!0,"layer-group":!0,"layers-alt":!0,"library-panel":!0,"line-alt":!0,link:!0,"list-ui-alt":!0,"list-ul":!0,"list-ol":!0,lock:!0,"map-marker":!0,"map-marker-plus":!0,"map-marker-minus":!0,message:!0,minus:!0,"minus-circle":!0,"mobile-android":!0,monitor:!0,palette:!0,"panel-add":!0,paragraph:!0,"pathfinder-unite":!0,pause:!0,"pause-circle":!0,pen:!0,percentage:!0,play:!0,plug:!0,plus:!0,"plus-circle":!0,"plus-square":!0,power:!0,"presentation-play":!0,process:!0,"question-circle":!0,"record-audio":!0,repeat:!0,rocket:!0,"ruler-combined":!0,save:!0,search:!0,"search-minus":!0,"search-plus":!0,"share-alt":!0,shield:!0,"shield-exclamation":!0,signal:!0,signin:!0,signout:!0,sitemap:!0,slack:!0,"sliders-v-alt":!0,spinner:!0,"sort-amount-down":!0,"sort-amount-up":!0,"square-shape":!0,star:!0,"step-backward":!0,stopwatch:!0,"stopwatch-slash":!0,sync:!0,"sync-slash":!0,table:!0,"table-collapse-all":!0,"table-expand-all":!0,"tag-alt":!0,"telegram-alt":!0,"text-fields":!0,"thumbs-up":!0,times:!0,"times-circle":!0,"toggle-on":!0,"toggle-off":!0,"trash-alt":!0,unarchive:!0,unlock:!0,upload:!0,user:!0,"users-alt":!0,"user-arrows":!0,"vertical-align-bottom":!0,"vertical-align-center":!0,"vertical-align-top":!0,"web-section-alt":!0,"wrap-text":!0,rss:!0,x:!0,"add-user":!0,attach:!0};function s(r){return!r||typeof r!="string"?!1:r in n}function l(r){if(s(r))return r}},19484:(k,A,e)=>{"use strict";e.d(A,{R:()=>n});var n=(s=>(s.Grid="grid",s.List="list",s))(n||{})},26272:(k,A,e)=>{"use strict";e.d(A,{Tq:()=>g,ee:()=>r,kb:()=>i,r1:()=>l});var n=e(89550),s=e(65463);const l={alertSuccess:(0,n.R)("alert-success"),alertWarning:(0,n.R)("alert-warning"),alertError:(0,n.R)("alert-error"),alertInfo:(0,n.R)("alert-info")},r={refresh:(0,n.R)("refresh"),componentDidMount:(0,n.R)("component-did-mount"),dataReceived:(0,n.R)("data-received"),dataError:(0,n.R)("data-error"),dataFramesReceived:(0,n.R)("data-frames-received"),dataSnapshotLoad:(0,n.R)("data-snapshot-load"),editModeInitialized:(0,n.R)("init-edit-mode"),initPanelActions:(0,n.R)("init-panel-actions"),initialized:(0,n.R)("panel-initialized"),panelTeardown:(0,n.R)("panel-teardown"),render:(0,n.R)("render")};class i extends s.x{static{this.type="graph-hover"}}class g extends s.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(k,A,e)=>{"use strict";e.d(A,{Cz:()=>g,DG:()=>c,Qp:()=>p,Z7:()=>d,ZF:()=>l,aj:()=>a,ew:()=>i,jQ:()=>o,o4:()=>r,os:()=>s,qD:()=>n});var n=(u=>(u.DataSource="ds",u.Plugin="plugin",u.Grafana="grafana",u.Stream="stream",u))(n||{}),s=(u=>(u.DataStream="stream",u.DataFrame="frame",u.JSON="json",u))(s||{}),l=(u=>(u.Pending="pending",u.Connected="connected",u.Connecting="connecting",u.Disconnected="disconnected",u.Shutdown="shutdown",u.Invalid="invalid",u))(l||{}),r=(u=>(u.Status="status",u.Join="join",u.Leave="leave",u.Message="message",u))(r||{});function i(u){return u.type==="status"}function g(u){return u.type==="join"}function o(u){return u.type==="leave"}function d(u){return u.type==="message"}function c(u){if(u?.length){let m=u.trim().split("/");if(m.length>=3)return{scope:m[0],namespace:m[1],path:m.slice(2).join("/")}}}function a(u){return!!(u?.path&&u.namespace&&u.scope)}function p(u){if(!u.scope)return"";let m=u.scope;return!u.namespace||(m+="/"+u.namespace,!u.path)?m:m+"/"+u.path}},9557:(k,A,e)=>{"use strict";e.d(A,{$b:()=>n,Aj:()=>d,FP:()=>p,Nc:()=>c,Ol:()=>g,ZF:()=>i,_0:()=>u,_C:()=>r,cF:()=>o,s5:()=>s,tG:()=>l,wj:()=>a});var n=(m=>(m.emerg="critical",m.fatal="critical",m.alert="critical",m.crit="critical",m.critical="critical",m.warn="warning",m.warning="warning",m.err="error",m.eror="error",m.error="error",m.info="info",m.information="info",m.informational="info",m.notice="info",m.dbug="debug",m.debug="debug",m.trace="trace",m.unknown="unknown",m))(n||{});const s={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var l=(m=>(m[m.Number=0]="Number",m[m.String=1]="String",m[m.LabelsMap=2]="LabelsMap",m[m.Error=3]="Error",m))(l||{}),r=(m=>(m.none="No de-duplication",m.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",m.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",m.signature="De-duplication of successive lines that have identical punctuation and whitespace.",m))(r||{}),i=(m=>(m.Backward="BACKWARD",m.Forward="FORWARD",m))(i||{});const g=m=>!m||typeof m!="object"?!1:"getLogRowContext"in m;var o=(m=>(m.LogsVolume="LogsVolume",m.LogsSample="LogsSample",m))(o||{}),d=(m=>(m.FullRange="FullRange",m.Limited="Limited",m))(d||{});const c=(m,v)=>m?("getDataProvider"in m||"getSupplementaryRequest"in m)&&"getSupplementaryQuery"in m&&"getSupportedSupplementaryQueryTypes"in m&&m.getSupportedSupplementaryQueryTypes().includes(v):!1,a=m=>!m||typeof m!="object"?!1:"getLogRowContextUi"in m,p=m=>m!=null&&typeof m=="object"&&"toggleQueryFilter"in m&&"queryHasFilter"in m,u=m=>m!=null&&typeof m=="object"&&"modifyQuery"in m&&"getSupportedQueryModifications"in m},64388:(k,A,e)=>{"use strict";e.d(A,{k:()=>n});var n=(s=>(s[s.Standard=0]="Standard",s[s.Canvas=1]="Canvas",s[s.Custom=2]="Custom",s))(n||{})},62625:(k,A,e)=>{"use strict";e.d(A,{X:()=>n});var n=(s=>(s.None="None",s.Viewer="Viewer",s.Editor="Editor",s.Admin="Admin",s))(n||{})},47070:(k,A,e)=>{"use strict";e.d(A,{NV:()=>o,nQ:()=>i,v2:()=>g,wV:()=>r});var n=e(2543),s=e.n(n),l=e(11261),r=(d=>(d.Auto="auto",d.Vertical="vertical",d.Horizontal="horizontal",d))(r||{}),i=(d=>(d[d.Best=100]="Best",d[d.Good=70]="Good",d[d.OK=50]="OK",d))(i||{});class g{constructor(c,a){this.list=[],this.data=c,this.panel=a,this.dataSummary=this.computeDataSummary()}getListAppender(c){return new o(this.list,c)}computeDataSummary(){const c=this.data?.series||[];let a=0,p=0,u=0,m=0,v=0,x=0,f;for(const E of c){m+=E.length,E.meta?.preferredVisualisationType&&(f=E.meta.preferredVisualisationType);for(const h of E.fields)switch(x++,h.type){case l.PU.number:a+=1;break;case l.PU.time:p+=1;break;case l.PU.string:u+=1;break}E.length>v&&(v=E.length)}return{numberFieldCount:a,timeFieldCount:p,stringFieldCount:u,rowCountTotal:m,rowCountMax:v,fieldCount:x,preferredVisualisationType:f,frameCount:c.length,hasData:m>0,hasTimeField:p>0,hasNumberField:a>0,hasStringField:u>0}}getList(){return this.list}}class o{constructor(c,a){this.list=c,this.defaults=a}append(c){this.list.push((0,n.defaultsDeep)(c,this.defaults))}}},43429:(k,A,e)=>{"use strict";e.d(A,{Ac:()=>l,QE:()=>s,Ud:()=>o,ZK:()=>i,ib:()=>g,kv:()=>r,pn:()=>n});var n=(d=>(d.alpha="alpha",d.beta="beta",d.stable="stable",d.deprecated="deprecated",d))(n||{}),s=(d=>(d.panel="panel",d.datasource="datasource",d.app="app",d.renderer="renderer",d.secretsmanager="secretsmanager",d))(s||{}),l=(d=>(d.internal="internal",d.valid="valid",d.invalid="invalid",d.modified="modified",d.missing="missing",d))(l||{}),r=(d=>(d.grafana="grafana",d.commercial="commercial",d.community="community",d.private="private",d.core="core",d))(r||{}),i=(d=>(d.missingSignature="signatureMissing",d.invalidSignature="signatureInvalid",d.modifiedSignature="signatureModified",d.failedBackendStart="failedBackendStart",d.angular="angular",d))(i||{}),g=(d=>(d.dashboard="dashboard",d.page="page",d.panel="panel",d.datasource="datasource",d))(g||{});class o{addConfigPage(c){return this.configPages||(this.configPages=[]),this.configPages.push(c),this}setChannelSupport(){return console.warn("[deprecation] plugin is using ignored option: setChannelSupport",this.meta),this}constructor(){this.meta={}}}},74135:(k,A,e)=>{"use strict";e.d(A,{S:()=>s,u:()=>n});var n=(l=>(l.link="link",l.component="component",l))(n||{}),s=(l=>(l.AlertInstanceAction="grafana/alerting/instance/action",l.AlertingHomePage="grafana/alerting/home",l.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",l.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",l.CommandPalette="grafana/commandpalette/action",l.DashboardPanelMenu="grafana/dashboard/panel/menu",l.DataSourceConfig="grafana/datasources/config",l.ExploreToolbarAction="grafana/explore/toolbar/action",l.UserProfileTab="grafana/user/profile/tab",l))(s||{})},51527:(k,A,e)=>{"use strict";e.d(A,{x:()=>s});var n=e(43429);function s(l){return l&&l!==n.Ac.valid&&l!==n.Ac.internal}},73372:(k,A,e)=>{"use strict";e.d(A,{D_:()=>n,Ee:()=>l,FL:()=>s});var n=(r=>(r.Equal="Equal",r.NotEqual="NotEqual",r.EqualRegEx="EqualRegEx",r.NotEqualRegEx="NotEqualRegEx",r))(n||{});const s=r=>!r||typeof r!="object"?!1:"importFromAbstractQueries"in r,l=r=>!r||typeof r!="object"?!1:"exportToAbstractQueries"in r},37891:(k,A,e)=>{"use strict";e.d(A,{n:()=>n});const n={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match"}},12470:(k,A,e)=>{"use strict";e.d(A,{CO:()=>n,ZG:()=>s,zL:()=>l});var n=(r=>(r[r.never=0]="never",r[r.onDashboardLoad=1]="onDashboardLoad",r[r.onTimeRangeChanged=2]="onTimeRangeChanged",r))(n||{}),s=(r=>(r[r.disabled=0]="disabled",r[r.alphabeticalAsc=1]="alphabeticalAsc",r[r.alphabeticalDesc=2]="alphabeticalDesc",r[r.numericalAsc=3]="numericalAsc",r[r.numericalDesc=4]="numericalDesc",r[r.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",r[r.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",r[r.naturalAsc=7]="naturalAsc",r[r.naturalDesc=8]="naturalDesc",r))(s||{}),l=(r=>(r[r.dontHide=0]="dontHide",r[r.hideLabel=1]="hideLabel",r[r.hideVariable=2]="hideVariable",r))(l||{})},25137:(k,A,e)=>{"use strict";e.d(A,{I:()=>n});var n=(s=>(s.Light="light",s.Dark="dark",s))(n||{})},50082:(k,A,e)=>{"use strict";e.d(A,{O:()=>n});var n=(s=>(s.Absolute="absolute",s.Percentage="percentage",s))(n||{})},43127:(k,A,e)=>{"use strict";e.d(A,{Cn:()=>g,E2:()=>i,G$:()=>r,HW:()=>o,lE:()=>l});var n=e(52622),s=e(47232);const l=n.vp,r="YYYY-MM-DD HH:mm:ss";function i(){const d=(0,s.KQ)();return{from:(0,s.KQ)(d).subtract(6,"hour"),to:d,raw:{from:"now-6h",to:"now"}}}function g(){return{from:600,to:0}}function o(d,c){const a=typeof d=="string"?(0,s.KQ)(d):d,p=typeof c=="string"?(0,s.KQ)(c):c;return{from:a,to:p,raw:{from:a,to:p}}}},81010:(k,A,e)=>{"use strict";e.d(A,{M:()=>n,N:()=>s});var n=(l=>(l[l.NotPossible=-1]="NotPossible",l[l.NotApplicable=0]="NotApplicable",l[l.Applicable=1]="Applicable",l[l.HighlyApplicable=2]="HighlyApplicable",l))(n||{}),s=(l=>(l.True="true",l.False="false",l.Null="null",l.Empty="empty",l))(s||{})},25019:(k,A,e)=>{"use strict";e.d(A,{W:()=>s,d:()=>n});var n=(l=>(l.ValueToText="value",l.RangeToText="range",l.RegexToText="regex",l.SpecialValue="special",l))(n||{}),s=(l=>(l.True="true",l.False="false",l.Null="null",l.NaN="nan",l.NullAndNaN="null+nan",l.Empty="empty",l))(s||{})},29505:(k,A,e)=>{"use strict";e.d(A,{J$:()=>l,Qz:()=>n,ZV:()=>i,f5:()=>r,xi:()=>s});var n=(g=>(g.Legacy="legacy",g.Standard="standard",g.Custom="custom",g.Datasource="datasource",g))(n||{});class s{}class l extends s{getType(){return"standard"}}class r extends s{getType(){return"custom"}}class i extends s{getType(){return"datasource"}}},35853:(k,A,e)=>{"use strict";e.d(A,{V:()=>n});function n(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(s){return this[s]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(s,l){this[s]=l},writable:!0,enumerable:!1,configurable:!0},add:{value:function(s){this.push(s)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}n()},7144:(k,A,e)=>{"use strict";e.d(A,{b:()=>r});var n=e(74848),s=e(96540),l=e(68941);const r=i=>{const{children:g,storageKey:o,defaultValue:d}=i,[c,a]=(0,s.useState)({value:l.M.getObject(i.storageKey,i.defaultValue)});(0,s.useEffect)(()=>{const m=v=>{v.key===o&&a({value:l.M.getObject(i.storageKey,i.defaultValue)})};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}});const p=m=>{try{l.M.setObject(o,m)}catch(v){console.error(v)}a({value:m})},u=()=>{try{l.M.delete(o)}catch(m){console.log(m)}a({value:d})};return(0,n.jsx)(n.Fragment,{children:g(c.value,p,u)})}},60264:(k,A,e)=>{"use strict";e.d(A,{bk:()=>o,pv:()=>a,iF:()=>c});var n=e(2543),s=e(27310),l=e(69550),r=e(83077);class i{constructor(){this.properties=[]}addCustomEditor(u){return this.properties.push(u),this}getRegistry(){return new r.O(()=>this.properties)}getItems(){return this.properties}}var g=e(39070);class o extends i{addNumberInput(u){return this.addCustomEditor({...u,id:u.path,override:l.D.get("number").editor,editor:l.D.get("number").editor,process:s.m0,shouldApply:u.shouldApply??(()=>!0),settings:u.settings||{}})}addSliderInput(u){return this.addCustomEditor({...u,id:u.path,override:l.D.get("slider").editor,editor:l.D.get("slider").editor,process:s.m0,shouldApply:u.shouldApply??(()=>!0),settings:u.settings||{}})}addTextInput(u){return this.addCustomEditor({...u,id:u.path,override:l.D.get("text").editor,editor:l.D.get("text").editor,process:s.OU,shouldApply:u.shouldApply??(()=>!0),settings:u.settings||{}})}addSelect(u){return this.addCustomEditor({...u,id:u.path,override:l.D.get("select").editor,editor:l.D.get("select").editor,process:s.hL,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{options:[]}})}addRadio(u){return this.addCustomEditor({...u,id:u.path,override:l.D.get("radio").editor,editor:l.D.get("radio").editor,process:s.hL,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{options:[]}})}addBooleanSwitch(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("boolean").editor,override:l.D.get("boolean").editor,process:s.FM,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addColorPicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("color").editor,override:l.D.get("color").editor,process:s.hS,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addUnitPicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("unit").editor,override:l.D.get("unit").editor,process:s.lG,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addFieldNamePicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("field-name").editor,override:l.D.get("field-name").editor,process:s.hS,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}addGenericEditor(u,m){return this.addCustomEditor({...u,id:u.path,editor:m,override:m,process:s.hS,shouldApply:u.shouldApply?u.shouldApply:()=>!0,settings:u.settings||{}})}}class d{constructor(u){this.cfg=u,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=m=>{const v=this.cfg.values;return v?v(m):{getValue:x=>m.getValue(`${this.path}.${x}`),onChange:(x,f)=>m.onChange(`${this.path}.${x}`,f)}},this.path=u.path,this.category=u.category,this.defaultValue=this.getDefaultValue(u)}getDefaultValue(u){let m=(0,g.Gv)(u.defaultValue)?(0,n.cloneDeep)(u.defaultValue):{};const v=new a;u.build(v,{data:[]});for(const x of v.getItems())x.defaultValue!=null&&(0,n.set)(m,x.path,x.defaultValue);return m}}function c(p){return(0,g.Gv)(p)&&"id"in p&&p.id==="nested-panel-options"}class a extends i{addNestedOptions(u){const m=new d(u);return this.addCustomEditor(m)}addNumberInput(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("number").editor})}addSliderInput(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("slider").editor})}addTextInput(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("text").editor})}addStringArray(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("strings").editor})}addSelect(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("select").editor})}addMultiSelect(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("multi-select").editor})}addRadio(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("radio").editor})}addBooleanSwitch(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("boolean").editor})}addColorPicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("color").editor,settings:u.settings||{}})}addTimeZonePicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("timezone").editor,settings:u.settings||{}})}addUnitPicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("unit").editor})}addFieldNamePicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("field-name").editor})}addDashboardPicker(u){return this.addCustomEditor({...u,id:u.path,editor:l.D.get("dashboard-uid").editor})}}},28802:(k,A,e)=>{"use strict";e.d(A,{t:()=>l});var n=e(2543),s=e.n(n);function l(r){return typeof r=="number"?r:r===""||r===null||r===void 0||Array.isArray(r)?NaN:typeof r=="boolean"?r?1:0:(0,n.toNumber)(r)}},14588:(k,A,e)=>{"use strict";e.r(A),e.d(A,{insertAfterImmutably:()=>r,insertBeforeImmutably:()=>l,moveItemImmutably:()=>s,sortValues:()=>o});var n=e(52622);function s(d,c,a){const p=[...d];return Array.prototype.splice.call(p,a,0,Array.prototype.splice.call(p,c,1)[0]),p}function l(d,c,a){if(a<0||a>d.length)throw new Error("Index out of bounds");const p=[...d];return p.splice(a,0,c),p}function r(d,c,a){if(a<0||a>d.length)throw new Error("Index out of bounds");const p=[...d];return p.splice(a+1,0,c),p}const i=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),g=(d,c)=>d-c;function o(d){return(c,a)=>{if(c===a)return 0;if(a==null||typeof a=="string"&&a.trim()==="")return-1;if(c==null||typeof c=="string"&&c?.trim()==="")return 1;let p=i.compare;return typeof c=="number"&&typeof a=="number"&&(p=g),d===n.xB.Descending?p(a,c):p(c,a)}}},11710:(k,A,e)=>{"use strict";e.d(A,{b:()=>l,k:()=>s});var n=e(83077),s=(r=>(r.Add="+",r.Subtract="-",r.Divide="/",r.Multiply="*",r))(s||{});const l=new n.O(()=>[{id:"+",name:"Add",operation:(r,i)=>r+i,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(r,i)=>r-i,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(r,i)=>r*i,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(r,i)=>r/i,binaryOperationID:"/"}])},72436:(k,A,e)=>{"use strict";e.d(A,{F7:()=>a,Jh:()=>p,_O:()=>h,i8:()=>m});var n=e(2543),s=e.n(n),l=e(44809),r=e.n(l),i=e(37471),g=e(14236),o=e(28240),d=e(11261),c=e(83195),a=(y=>(y[y.full=0]="full",y[y.name=1]="name",y[y.none=2]="none",y))(a||{});function p(y,b){return new m(b).readCSV(y)}var u=(y=>(y[y.Starting=0]="Starting",y[y.InHeader=1]="InHeader",y[y.ReadingRows=2]="ReadingRows",y))(u||{});class m{constructor(b){this.chunk=(D,P)=>{for(let C=0;C<D.data.length;C++){const M=D.data[C];if(M.length<1)continue;const I=M[0];if(I){if(I.startsWith("#")){const R=I.indexOf("#",2);if(R>0){const T=I.slice(1,R),S=T==="name";if(S||{unit:"#"}.hasOwnProperty(T)){this.state===2&&(this.current=new i.k({fields:[]}),this.data.push(this.current));const O=I.slice(R+1);if(S){this.current.addFieldFor(void 0,O);for(let j=1;j<M.length;j++)this.current.addFieldFor(void 0,M[j])}else{const{fields:j}=this.current;for(let N=0;N<j.length;N++){j[N].config||(j[N].config={});const F=j[N].config;F[T]=N===0?O:M[N]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,g.HW)(I)===d.PU.string){for(const T of M)this.current.addFieldFor(void 0,T);this.state=1;continue}this.state=1}}if(this.state,this.state=2,M.length>this.current.fields.length){const{fields:R}=this.current;for(let T=R.length;T<M.length;T++)this.current.addFieldFor(M[T]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(M),this.callback&&this.callback.onRow(M)}},b||(b={}),this.config=b.config||{},this.callback=b.callback,this.current=new i.k({fields:[]}),this.state=0,this.data=[]}readCSV(b){this.current=new i.k({fields:[]}),this.data=[this.current];const D={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return r().parse(b,D),this.data}}function v(y,b){if(y==null)return"";const D=y.toString();return D.includes('"')?b.quoteChar+D.replace(/"/gi,'""')+b.quoteChar:D.includes(`
`)||b.delimiter&&D.includes(b.delimiter)?b.quoteChar+D+b.quoteChar:D}function x(y,b){return y.display?D=>{const P=y.display(D);return v((0,c.cN)(P),b)}:D=>v(D,b)}function f(y,b,D){const P=y==="name",C=y==="type";for(const M of b){const I=M.config;if(P||C||I&&I.hasOwnProperty(y)){let R="#"+y+"#";for(let T=0;T<b.length;T++){T>0&&(R=R+D.delimiter);let S=b[T].name;C?S=b[T].type:P||(S=b[T].config[y]),S&&(R=R+v(S,D))}return R+D.newline}}return""}function E(){const y=["x","y"];return y.toLocaleString?y.toLocaleString().charAt(1):","}function h(y,b){if(!y)return"";b=(0,n.defaults)(b,{delimiter:E(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let D=b.useExcelHeader?`sep=${b.delimiter}${b.newline}`:"";for(let P=0;P<y.length;P++){const C=y[P],{fields:M}=C;if(M.length===0)continue;if(b.headerStyle===0)D=D+f("name",M,b)+f("type",M,b)+f("unit",M,b)+f("dateFormat",M,b);else if(b.headerStyle===1){for(let R=0;R<M.length;R++)R>0&&(D+=b.delimiter),D+=`"${(0,o.Ct)(M[R],C).replace(/"/g,'""')}"`;D+=b.newline}const I=M[0].values.length;if(I>0){const R=M.map(T=>x(T,b));for(let T=0;T<I;T++){for(let S=0;S<M.length;S++){S>0&&(D=D+b.delimiter);const L=M[S].values[T];L!==null&&(D=D+R[S](L))}T!==I-1&&(D=D+b.newline)}}P!==y.length-1&&(D=D+b.newline)}return D}},6709:(k,A,e)=>{"use strict";e.d(A,{c:()=>l,u:()=>r});var n=e(71733),s=e(76885);const l={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function r(d){const{onClickFn:c,replaceVariables:a,link:p,scopedVars:u,range:m,field:v,internalLink:x}=d,f=g(p.internal?.query,u,a),E=g(p.internal?.panelsState,u,a),h=g(p.internal?.meta?.correlationData,u,a),y=p.title?p.title:x.datasourceName;return{title:a(y,u),href:i(x.datasourceUid,f,m,E),onClick:c?b=>{b.preventDefault&&b.preventDefault(),c({datasourceUid:x.datasourceUid,queries:[f],panelsState:E,correlationHelperData:h,range:m})}:void 0,target:p?.targetBlank?"_blank":"_self",origin:v}}function i(d,c,a,p){return n.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,s.Pp)({...a?.raw?{range:(0,s.sQ)(a.raw)}:{},datasource:d,queries:[c],panelsState:p}))}`)}function g(d,c,a){if(!d)return d;if(typeof d=="string")return a(d,c);const p=JSON.parse(JSON.stringify(d));return o(p,c,a)}function o(d,c,a){for(const p of Object.keys(d))typeof d[p]=="string"?d[p]=a(d[p],c):typeof d[p]=="object"&&d[p]!==null&&(d[p]=o(d[p],c,a));return d}},22391:(k,A,e)=>{"use strict";e.d(A,{BD:()=>c,EX:()=>a,Iz:()=>i,PG:()=>o,QP:()=>f,fN:()=>r,lO:()=>v,mn:()=>d,p$:()=>l,pN:()=>m,wY:()=>p,wp:()=>x,yV:()=>u,zX:()=>g});var n=e(2543),s=e.n(n);function l(E){const h={uid:E.uid,type:E.type};return E.apiVersion&&(h.apiVersion=E.apiVersion),h}function r(E){return typeof E=="object"&&typeof E?.uid=="string"}function i(E){if(r(E))return E.uid;if((0,n.isString)(E))return E}const g=(E,h)=>y=>{m(E,h,y.currentTarget.value)},o=(E,h)=>y=>{v(E,h,y.currentTarget.value)},d=(E,h)=>y=>{x(E,h,y.currentTarget.value)},c=(E,h)=>y=>{v(E,h,y.value)},a=(E,h)=>y=>{v(E,h,y.currentTarget.checked)},p=(E,h)=>y=>{x(E,h,y.value)},u=(E,h)=>y=>{f(E,h)};function m(E,h,y){const b=E.options;E.onOptionsChange({...b,[h]:y})}const v=(E,h,y)=>{const b=E.options;E.onOptionsChange({...b,jsonData:{...b.jsonData,[h]:y}})},x=(E,h,y)=>{const b=E.options;E.onOptionsChange({...b,secureJsonData:{...b.secureJsonData?b.secureJsonData:{},[h]:y}})},f=(E,h)=>{const y=E.options;E.onOptionsChange({...y,secureJsonData:{...y.secureJsonData?y.secureJsonData:{},[h]:""},secureJsonFields:{...y.secureJsonFields,[h]:!1}})}},95344:(k,A,e)=>{"use strict";e.d(A,{l:()=>s});const n={},s=(l,r,i)=>{let g=`[Deprecation warning] ${l}: ${r} is deprecated`;i&&(g+=`. Use ${i} instead`);const o=Date.now(),d=n[g];(!d||o-d>1e4)&&(console.warn(g),n[g]=o)}},87885:(k,A,e)=>{"use strict";e.d(A,{f:()=>n});var n=(s=>(s[s.Transformations=0]="Transformations",s[s.FieldConfig=1]="FieldConfig",s[s.FieldConfigOverrides=2]="FieldConfigOverrides",s))(n||{})},39306:(k,A,e)=>{"use strict";e.d(A,{R:()=>s,r:()=>l});var n=e(39070);function s({xField:r,yField:i,nullValueMode:g}){const o=r.values,d=i.values,c=o.length;if(d.length!==c)throw new Error("Unexpected field length");const a=g===n.UW.Ignore,p=g===n.UW.AsZero,u=[];for(let m=0;m<c;m++){const v=o[m];let x=d[m];if(x===null){if(a)continue;p&&(x=0)}v!==null&&u.push([v,x])}return u}function l(r,i){if(!i.from||!i.to||!r||r.length===0)return[];const g=i.from.valueOf(),o=i.to.valueOf(),d=r[0][1];return[[g,d],[o,d]]}},8249:(k,A,e)=>{"use strict";e.d(A,{Xy:()=>s,_p:()=>i,h6:()=>g,s6:()=>r,yO:()=>l});const n=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function s(o){const d={};return o.replace(n,(c,a,p,u)=>(d[a]=u,"")),d}function l(o){return o.reduce((d,c)=>{if(!c)throw new Error("Need parsed labels to find common labels.");return Object.keys(c).forEach(a=>{(d[a]===void 0||d[a]!==c[a])&&delete d[a]}),Object.keys(d).forEach(a=>{c[a]===void 0&&delete d[a]}),d},{...o[0]})}function r(o,d){const c={...o};return Object.keys(d).forEach(a=>{delete c[a]}),c}function i(o,d){if(!o)return!0;for(const[c,a]of Object.entries(o))if(!d||d[c]!==a)return!1;return!0}function g(o,d="",c){if(!o||Object.keys(o).length===0)return d;const p=Object.keys(o).sort().map(u=>`${u}="${o[u]}"`).join(", ");return c?p:["{",p,"}"].join("")}},71733:(k,A,e)=>{"use strict";e.d(A,{I:()=>p});var n=e(80997),s=e(76885);let l={appSubUrl:""},r,i;const g=u=>{try{return new URL(u)}catch{return}},o=u=>{const m=g(u);if(m&&m.origin!==window.location.origin)return u;const v=l.appSubUrl??"",x=v.endsWith("/")?1:0,f=u.startsWith("http");let E=v;return(!u.startsWith("/")||f)&&(E=`${window.location.origin}${v}`),u.length>0&&(u.indexOf(E+"/")===0||u===E)?u.slice(E.length-x):u},d=u=>u.startsWith("/")?`${l.appSubUrl}${o(u)}`:u,p={initialize:u=>{l=u.config,r=u.getTimeRangeForUrl,i=u.getVariablesUrlParams},stripBaseFromUrl:o,assureBaseUrl:d,updateSearchParams:(u,m)=>{const v=new URLSearchParams(m);try{const x=new URL(u);return v.forEach((f,E)=>x.searchParams.set(E,f)),x.href}catch{const x=new URLSearchParams(u);return v.forEach((f,E)=>{x.set(E,f)}),"?"+x.toString()}},getTimeRangeUrlParams:()=>r?s.kM.toUrlParams(r()):null,getVariablesUrlParams:u=>{if(!i)return null;const m=i(u);return s.kM.toUrlParams(m)},getUrlForPartial:(u,m)=>{const v=s.kM.parseKeyValue(u.search.startsWith("?")?u.search.substring(1):u.search);for(const x in m)m[x]===null||m[x]===void 0?delete v[x]:v[x]=m[x];return d(s.kM.renderUrl(u.pathname,v))},processUrl:u=>l.disableSanitizeHtml?u:n.sQ.sanitizeUrl(u)}},92341:(k,A,e)=>{"use strict";e.d(A,{Y:()=>n});function n(s){return new Proxy(s,{apply(l,r,i){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(l,i,r.constructor)}})}},80147:(k,A,e)=>{"use strict";e.d(A,{_:()=>n});function n(s,l){return l.id===s?!0:l.aliasIDs?l.aliasIDs.includes(s):!1}},25352:(k,A,e)=>{"use strict";e.d(A,{u:()=>n});var n=(s=>(s.id="id",s.title="title",s.subTitle="subtitle",s.mainStat="mainstat",s.secondaryStat="secondarystat",s.arc="arc__",s.icon="icon",s.color="color",s.source="source",s.target="target",s.detail="detail__",s.nodeRadius="noderadius",s.thickness="thickness",s.highlighted="highlighted",s.strokeDasharray="strokedasharray",s.fixedX="fixedx",s.fixedY="fixedy",s))(n||{})},97706:(k,A,e)=>{"use strict";e.d(A,{E:()=>s,h:()=>n});function n(l,r=0){if(Number.isInteger(l))return l;let i=10**r,g=l*i*(1+Number.EPSILON);return Math.round(g)/i}function s(l){return((""+l).split(".")[1]||"").length}},92041:(k,A,e)=>{"use strict";e.d(A,{R:()=>s,w:()=>n});const n=l=>Object.keys(l).reduce((r,i)=>(l[i]!==void 0&&(r[i]=l[i]),r),{}),s=l=>typeof l=="object"&&l!==null&&Object.keys(l).length===0},50877:(k,A,e)=>{"use strict";e.d(A,{z:()=>n});const n=s=>({label:s,value:s})},68941:(k,A,e)=>{"use strict";e.d(A,{M:()=>s});class n{get(r){return window.localStorage[r]}set(r,i){window.localStorage[r]=i}getBool(r,i){return i!==void 0&&!this.exists(r)?i:window.localStorage[r]==="true"}getObject(r,i){let g=i;if(this.exists(r)){const o=window.localStorage[r];try{g=JSON.parse(o)}catch(d){console.error(`Error parsing store object: ${r}. Returning default: ${i}. [${d}]`)}}return g}setObject(r,i){let g;try{g=JSON.stringify(i)}catch(o){throw new Error(`Could not stringify object: ${r}. [${o}]`)}try{this.set(r,g)}catch(o){const d=new Error(`Could not save item in localStorage: ${r}. [${o}]`);throw o instanceof Error&&(d.name=o.name),d}return!0}exists(r){return window.localStorage[r]!==void 0}delete(r){window.localStorage.removeItem(r)}}const s=new n},27618:(k,A,e)=>{"use strict";e.d(A,{_:()=>s,j:()=>l});var n=e(83077),s=(r=>(r.Abs="abs",r.Exp="exp",r.Ln="ln",r.Floor="floor",r.Ceil="ceil",r))(s||{});const l=new n.O(()=>[{id:"abs",name:"Absolute value",operation:r=>Math.abs(r),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:r=>Math.exp(r),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:r=>Math.log(r),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:r=>Math.floor(r),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:r=>Math.ceil(r),unaryOperationID:"ceil"}])},76885:(k,A,e)=>{"use strict";e.d(A,{Pp:()=>p,kM:()=>a,sQ:()=>u});var n=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function s(m,v){return v&&Object.keys(v).length>0&&(m+="?"+r(v)),m}function l(m,v){return encodeURIComponent(m).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,v?"%20":"+").replace(/[!'()*]/g,function(x){return"%"+x.charCodeAt(0).toString(16).toUpperCase()})}function r(m,v=!0){const x=[],f=/\[\]$/,E=v?(D,P)=>l(D,P):(D,P)=>encodeURIComponent(D),h=D=>Object.prototype.toString.call(D)==="[object Array]",y=(D,P)=>{if(P=typeof P=="function"?P():P===null||P===void 0?"":P,typeof P!="boolean")x[x.length]=E(D,!0)+"="+E(P,!0);else{const C=P?"":"="+E("false",!0);x[x.length]=E(D,!0)+C}},b=(D,P)=>{let C,M,I;if(D)if(h(P))for(C=0,M=P.length;C<M;C++)f.test(D)?y(D,P[C]):b(D,P[C]);else if(P&&String(P)==="[object Object]")for(I in P)b(D+"["+I+"]",P[I]);else y(D,P);else if(h(P))for(C=0,M=P.length;C<M;C++)y(P[C].name,P[C].value);else for(I in P)b(I,P[I]);return x};return b("",m).join("&")}function i(m){return r(m,!1)}function g(m,v){if(v!=null&&v!==""){const x=m.indexOf("?");x!==-1?m.length-x>1&&(m+="&"):m+="?",m+=v}return m}function o(){const v=window.location.search.substring(1).split("&"),x={};for(const f of v){const E=f.split("=");if(E.length>1){const h=decodeURIComponent(E[0]),y=decodeURIComponent(E[1]);h in x?x[h]=[...x[h],y]:x[h]=[y]}else if(E.length===1){const h=decodeURIComponent(E[0]);x[h]=!0}}return x}function d(m){const v={},x=(m||"").split("&");for(let f of x){let E,h,y;if(f&&(h=f=f.replace(/\+/g,"%20"),E=f.indexOf("="),E!==-1&&(h=f.substring(0,E),y=f.substring(E+1)),h=c(h),h!==void 0)){y=y!==void 0?c(y):!0;let b;typeof y=="string"&&y!==""?b=y==="true"||y==="false"?y==="true":y:b=y,v.hasOwnProperty(h)?Array.isArray(v[h])?v[h].push(y):v[h]=[v[h],isNaN(b)?y:b]:v[h]=isNaN(b)?y:b}}return v}function c(m){try{return decodeURIComponent(m)}catch{return}}const a={renderUrl:s,toUrlParams:r,appendQueryToUrl:g,getUrlSearchParams:o,parseKeyValue:d,serializeParams:i};function p(m,v){return v!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(m)}const u=m=>{let v=m.from;(0,n.Ar)(v)&&(v=v.valueOf().toString());let x=m.to;return(0,n.Ar)(x)&&(x=x.valueOf().toString()),{from:v,to:x}}},62398:(k,A,e)=>{"use strict";e.d(A,{An:()=>g,Zz:()=>r,bh:()=>o});var n=e(47737),s=e(54479),l=e(25019);function r(c,a){for(const p of c)switch(p.type){case l.d.ValueToText:if(a==null)continue;const u=p.options[a];if(u)return u;break;case l.d.RangeToText:if(a==null)continue;const m=parseFloat(a);if(isNaN(m)||!isNaN(p.options.from)&&m<p.options.from||!isNaN(p.options.to)&&m>p.options.to)continue;return p.options.result;case l.d.RegexToText:if(a==null||typeof a!="string")continue;const f=(0,s.dO)(p.options.pattern);if(a.match(f)){const E={...p.options.result};return E.text!=null&&(E.text=a.replace(f,p.options.result.text||"")),E}case l.d.SpecialValue:switch(p.options.match){case l.W.Null:{if(a==null)return p.options.result;break}case l.W.NaN:{if(typeof a=="number"&&isNaN(a))return p.options.result;break}case l.W.NullAndNaN:{if(typeof a=="number"&&isNaN(a)||a==null)return p.options.result;break}case l.W.True:{if(a===!0||a==="true")return p.options.result;break}case l.W.False:{if(a===!1||a==="false")return p.options.result;break}case l.W.Empty:{if(a==="")return p.options.result;break}}}return null}function i(c){return(typeof c=="number"||typeof c=="string"&&c.trim()!=="")&&!isNaN(c)}var g=(c=>(c[c.ValueToText=1]="ValueToText",c[c.RangeToText=2]="RangeToText",c))(g||{});function o(c,a){const p=[];let u=c.mappingType;if(c.mappingType||(c.valueMaps&&c.valueMaps.length?u=1:c.rangeMaps&&c.rangeMaps.length&&(u=2)),u===1)for(let m=0;m<c.valueMaps.length;m++){const v=c.valueMaps[m];p.push(d({...v,id:m,type:l.d.ValueToText},c.fieldConfig?.defaults?.thresholds||a))}else if(u===2)for(let m=0;m<c.rangeMaps.length;m++){const v=c.rangeMaps[m];p.push(d({...v,id:m,type:l.d.RangeToText},c.fieldConfig?.defaults?.thresholds||a))}return p}function d(c,a){const p={type:l.d.ValueToText,options:{}},u=[];let m;const v=parseFloat(c.text);if(a&&!isNaN(v)){const x=(0,n.yQ)(v,a.steps);x&&x.color&&(m=x.color)}switch(c.type){case 1:case l.d.ValueToText:c.value!=null&&(c.value==="null"?u.push({type:l.d.SpecialValue,options:{match:l.W.Null,result:{text:c.text,color:m}}}):p.options[String(c.value)]={text:c.text,color:m});break;case 2:case l.d.RangeToText:c.from==="null"||c.to==="null"?u.push({type:l.d.SpecialValue,options:{match:l.W.Null,result:{text:c.text,color:m}}}):u.push({type:l.d.RangeToText,options:{from:+c.from,to:+c.to,result:{text:c.text,color:m}}});break}return Object.keys(p.options).length>0&&u.unshift(p),u[0]}},92053:(k,A,e)=>{"use strict";e.d(A,{E:()=>s,c:()=>l});const n="__searchFilter",s=r=>r&&typeof r=="string"?r.indexOf(n)!==-1:!1,l=r=>{const{query:i,wildcardChar:g}=r;if(!s(i))return{};let{options:o}=r;return o=o||{searchFilter:""},{__searchFilter:{value:o.searchFilter?`${o.searchFilter}${g}`:`${g}`,text:""}}}},72495:(k,A,e)=>{"use strict";e.d(A,{k:()=>i});var n=e(44240),s=e(39697),l=e(65961),r=e(67791);function i({whileLoading:g,source:o}){return(0,n.h)((0,s.O)(200).pipe((0,l.u)(g),(0,r.Q)(o)),o)}},26517:(k,A,e)=>{"use strict";e.d(A,{Gl:()=>s,cL:()=>i,rT:()=>d,yW:()=>o});var n=e(83195);function s(c,a){const p=["","K","M","B","T"],u=(0,n.yP)(1e3,p);return(m,v,x)=>{if(m==null)return{text:""};const f=m<0;f&&(m=Math.abs(m));const E=u(m,v,x);return a?E.suffix=E.suffix!==void 0?`${E.suffix}${c}`:void 0:E.prefix=c,f&&(E.prefix=`-${E.prefix?.length?E.prefix:""}`),E}}const l=["f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],r=l.indexOf("");function i(c){const a=l.findIndex(p=>p.normalize("NFKD")===c.normalize("NFKD"));return a<0?0:a-r}const g=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];function o(c,a=0){const p=g.map(u=>" "+u+c);return(0,n.yP)(1024,p,a)}function d(c,a=0){const p=l.map(u=>" "+u+c);return(0,n.yP)(1e3,p,r+a)}},83195:(k,A,e)=>{"use strict";e.d(A,{Qc:()=>Q,cN:()=>Y,j_:()=>re,Ke:()=>Te,uH:()=>ue,j9:()=>_,Hg:()=>J,yP:()=>oe,UR:()=>ee,cH:()=>de,Mg:()=>te,gZ:()=>se,G8:()=>le});var n=e(2543);function s(ge,Oe){return ge===null?{text:""}:{text:te(ge,Oe),suffix:"%"}}function l(ge,Oe){return ge===null?{text:""}:{text:te(100*ge,Oe),suffix:"%"}}function r(ge,Oe){if(ge==null)return{text:""};const Ue=i(ge,Oe);return Ue.text.substring(0,1)==="-"?Ue.text="-0x"+Ue.text.substring(1):Ue.text="0x"+Ue.text,Ue}function i(ge,Oe){return ge==null?{text:""}:{text:parseFloat(te(ge,Oe)).toString(16).toUpperCase()}}function g(ge,Oe){return ge==null?{text:""}:{text:ge.toExponential(Oe??void 0)}}var o=e(42994),d=e(72724),c=e(47232),a=(ge=>(ge.Year="year",ge.Month="month",ge.Week="week",ge.Day="day",ge.Hour="hour",ge.Minute="minute",ge.Second="second",ge.Millisecond="millisecond",ge))(a||{});const p=["year","month","week","day","hour","minute","second","millisecond"],u={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1,millisecond:.001};function m(ge,Oe){return ge===null?{text:""}:Math.abs(ge)<1e3?{text:te(ge,Oe),suffix:" ns"}:Math.abs(ge)<1e6?se(ge/1e3,Oe," \xB5s"):Math.abs(ge)<1e9?se(ge/1e6,Oe," ms"):Math.abs(ge)<6e10?se(ge/1e9,Oe," s"):Math.abs(ge)<36e11?se(ge/6e10,Oe," min"):Math.abs(ge)<864e11?se(ge/36e11,Oe," hour"):se(ge/864e11,Oe," day")}function v(ge,Oe){return ge===null?{text:""}:Math.abs(ge)<1e3?{text:te(ge,Oe),suffix:" \xB5s"}:Math.abs(ge)<1e6?se(ge/1e3,Oe," ms"):se(ge/1e6,Oe," s")}function x(ge,Oe,Ue){return ge===null?{text:""}:Math.abs(ge)<1e3?{text:te(ge,Oe),suffix:" ms"}:Math.abs(ge)<6e4?se(ge/1e3,Oe," s"):Math.abs(ge)<36e5?se(ge/6e4,Oe," min"):Math.abs(ge)<864e5?se(ge/36e5,Oe," hour"):Math.abs(ge)<31536e6?se(ge/864e5,Oe," day"):se(ge/31536e6,Oe," year")}function f(ge,Oe){return ge===null?{text:""}:ge===0?{text:"0",suffix:" s"}:Math.abs(ge)<1e-6?se(ge*1e9,Oe," ns"):Math.abs(ge)<.001?se(ge*1e6,Oe," \xB5s"):Math.abs(ge)<1?se(ge*1e3,Oe," ms"):Math.abs(ge)<60?{text:te(ge,Oe),suffix:" s"}:Math.abs(ge)<3600?se(ge/60,Oe," min"):Math.abs(ge)<86400?se(ge/3600,Oe," hour"):Math.abs(ge)<604800?se(ge/86400,Oe," day"):Math.abs(ge)<31536e3?se(ge/604800,Oe," week"):se(ge/31556900,Oe," year")}function E(ge,Oe){return ge===null?{text:""}:Math.abs(ge)<60?{text:te(ge,Oe),suffix:" min"}:Math.abs(ge)<1440?se(ge/60,Oe," hour"):Math.abs(ge)<10080?se(ge/1440,Oe," day"):Math.abs(ge)<604800?se(ge/10080,Oe," week"):se(ge/525948,Oe," year")}function h(ge,Oe){return ge===null?{text:""}:Math.abs(ge)<24?{text:te(ge,Oe),suffix:" hour"}:Math.abs(ge)<168?se(ge/24,Oe," day"):Math.abs(ge)<8760?se(ge/168,Oe," week"):se(ge/8760,Oe," year")}function y(ge,Oe){return ge===null?{text:""}:Math.abs(ge)<7?{text:te(ge,Oe),suffix:" day"}:Math.abs(ge)<365?se(ge/7,Oe," week"):se(ge/365,Oe," year")}function b(ge,Oe,Ue){if(ge===null)return{text:""};if(ge===0)return{text:"0",suffix:" "+Ue+"s"};if(ge<0){const We=b(-ge,Oe,Ue);return We.suffix||(We.suffix=""),We.suffix+=" ago",We}ge*=u[Ue]*1e3;const Xe=[];let we=!1,qe=0;Oe!=null&&(qe=Oe);for(let We=0;We<p.length&&qe>=0;We++){const Ce=u[p[We]]*1e3,je=ge/Ce;if(je>=1||we){we=!0;const Ke=Math.floor(je),_e=p[We]+(Ke!==1?"s":"");Xe.push(Ke+" "+_e),ge=ge%Ce,qe--}}return{text:Xe.join(", ")}}function D(ge,Oe){if(ge===null)return{text:""};if(ge<1e3)return{text:(0,c.yT)(ge).format("SSS\\m\\s")};if(ge<6e4){let qe="ss\\s:SSS\\m\\s";return Oe===0&&(qe="ss\\s"),{text:(0,c.yT)(ge).format(qe)}}if(ge<36e5){let qe="mm\\m:ss\\s:SSS\\m\\s";return Oe===0?qe="mm\\m":Oe===1&&(qe="mm\\m:ss\\s"),{text:(0,c.yT)(ge).format(qe)}}let Ue="mm\\m:ss\\s:SSS\\m\\s";const Xe=`${("0"+Math.floor((0,c.Ah)(ge,"milliseconds").asHours())).slice(-2)}h`;return Oe===0?Ue="":Oe===1?Ue="mm\\m":Oe===2&&(Ue="mm\\m:ss\\s"),{text:Ue?`${Xe}:${(0,c.yT)(ge).format(Ue)}`:Xe}}function P(ge,Oe){return b(ge,Oe,"millisecond")}function C(ge,Oe){return b(ge,Oe,"second")}function M(ge){if(ge<0){const qe=M(-ge);return qe.suffix||(qe.suffix=""),qe.suffix+=" ago",qe}const Oe=[],Ue=Math.floor(ge/3600),Xe=Math.floor(ge%3600/60),we=Math.floor(ge%3600%60);return Ue>9?Oe.push(""+Ue):Oe.push("0"+Ue),Xe>9?Oe.push(""+Xe):Oe.push("0"+Xe),we>9?Oe.push(""+we):Oe.push("0"+we),{text:Oe.join(":")}}function I(ge){if(ge<0){const we=I(-ge);return we.suffix||(we.suffix=""),we.suffix+=" ago",we}let Oe="";const Ue=Math.floor(ge/(24*3600));Ue>0&&(Oe=Ue+" d ");const Xe=M(ge-Ue*24*3600);return{text:Oe+Xe.text}}function R(ge,Oe){return f(ge/100,Oe)}function T(ge,Oe){return D(ge,Oe)}function S(ge,Oe){return D(ge*1e3,Oe)}function L(ge,Oe){return(Ue,Xe,we,qe)=>Oe&&(0,c.KQ)().isSame(Ue,"day")?{text:(0,d.LE)(Ue,{format:Oe,timeZone:qe})}:{text:(0,d.LE)(Ue,{format:ge,timeZone:qe})}}const O=L("YYYY-MM-DD HH:mm:ss"),j=L("YYYY-MM-DD HH:mm:ss","HH:mm:ss"),N=L("MM/DD/YYYY h:mm:ss a"),F=L("MM/DD/YYYY h:mm:ss a","h:mm:ss a");function U(){return L((0,o.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function w(){return L((0,o.Od)({year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),(0,o.Od)({hour:"2-digit",minute:"2-digit",second:"2-digit"}))}function B(ge,Oe,Ue,Xe,we){return{text:(0,d.LE)(ge,{format:we?o.WC.fullDateMS:o.WC.fullDate,timeZone:Xe})}}function K(ge,Oe,Ue,Xe){return{text:(0,d.fq)(ge,{timeZone:Xe})}}var W=e(26517);const z=()=>[{name:"Misc",formats:[{name:"Number",id:"none",fn:le("")},{name:"String",id:"string",fn:de},{name:"short",id:"short",fn:oe(1e3,[""," K"," Mil"," Bil"," Tri"," Quadr"," Quint"," Sext"," Sept"])},{name:"SI short",id:"sishort",fn:(0,W.rT)("")},{name:"Percent (0-100)",id:"percent",fn:s},{name:"Percent (0.0-1.0)",id:"percentunit",fn:l},{name:"Humidity (%H)",id:"humidity",fn:le("%H")},{name:"Decibel",id:"dB",fn:le("dB")},{name:"Candela (cd)",id:"candela",fn:(0,W.rT)("cd")},{name:"Hexadecimal (0x)",id:"hex0x",fn:r},{name:"Hexadecimal",id:"hex",fn:i},{name:"Scientific notation",id:"sci",fn:g},{name:"Locale format",id:"locale",fn:J},{name:"Pixels",id:"pixel",fn:le("px")}]},{name:"Acceleration",formats:[{name:"Meters/sec\xB2",id:"accMS2",fn:le("m/sec\xB2")},{name:"Feet/sec\xB2",id:"accFS2",fn:le("f/sec\xB2")},{name:"G unit",id:"accG",fn:le("g")}]},{name:"Angle",formats:[{name:"Degrees (\xB0)",id:"degree",fn:le("\xB0")},{name:"Radians",id:"radian",fn:le("rad")},{name:"Gradian",id:"grad",fn:le("grad")},{name:"Arc Minutes",id:"arcmin",fn:le("arcmin")},{name:"Arc Seconds",id:"arcsec",fn:le("arcsec")}]},{name:"Area",formats:[{name:"Square Meters (m\xB2)",id:"areaM2",fn:le("m\xB2")},{name:"Square Feet (ft\xB2)",id:"areaF2",fn:le("ft\xB2")},{name:"Square Miles (mi\xB2)",id:"areaMI2",fn:le("mi\xB2")},{name:"Acres (ac)",id:"acres",fn:le("ac")},{name:"Hectares (ha)",id:"hectares",fn:le("ha")}]},{name:"Computation",formats:[{name:"FLOP/s",id:"flops",fn:(0,W.rT)("FLOPS")},{name:"MFLOP/s",id:"mflops",fn:(0,W.rT)("FLOPS",2)},{name:"GFLOP/s",id:"gflops",fn:(0,W.rT)("FLOPS",3)},{name:"TFLOP/s",id:"tflops",fn:(0,W.rT)("FLOPS",4)},{name:"PFLOP/s",id:"pflops",fn:(0,W.rT)("FLOPS",5)},{name:"EFLOP/s",id:"eflops",fn:(0,W.rT)("FLOPS",6)},{name:"ZFLOP/s",id:"zflops",fn:(0,W.rT)("FLOPS",7)},{name:"YFLOP/s",id:"yflops",fn:(0,W.rT)("FLOPS",8)}]},{name:"Concentration",formats:[{name:"parts-per-million (ppm)",id:"ppm",fn:le("ppm")},{name:"parts-per-billion (ppb)",id:"conppb",fn:le("ppb")},{name:"nanogram per cubic meter (ng/m\xB3)",id:"conngm3",fn:le("ng/m\xB3")},{name:"nanogram per normal cubic meter (ng/Nm\xB3)",id:"conngNm3",fn:le("ng/Nm\xB3")},{name:"microgram per cubic meter (\u03BCg/m\xB3)",id:"con\u03BCgm3",fn:le("\u03BCg/m\xB3")},{name:"microgram per normal cubic meter (\u03BCg/Nm\xB3)",id:"con\u03BCgNm3",fn:le("\u03BCg/Nm\xB3")},{name:"milligram per cubic meter (mg/m\xB3)",id:"conmgm3",fn:le("mg/m\xB3")},{name:"milligram per normal cubic meter (mg/Nm\xB3)",id:"conmgNm3",fn:le("mg/Nm\xB3")},{name:"gram per cubic meter (g/m\xB3)",id:"congm3",fn:le("g/m\xB3")},{name:"gram per normal cubic meter (g/Nm\xB3)",id:"congNm3",fn:le("g/Nm\xB3")},{name:"milligrams per decilitre (mg/dL)",id:"conmgdL",fn:le("mg/dL")},{name:"millimoles per litre (mmol/L)",id:"conmmolL",fn:le("mmol/L")}]},{name:"Currency",formats:[{name:"Dollars ($)",id:"currencyUSD",fn:(0,W.Gl)("$")},{name:"Pounds (\xA3)",id:"currencyGBP",fn:(0,W.Gl)("\xA3")},{name:"Euro (\u20AC)",id:"currencyEUR",fn:(0,W.Gl)("\u20AC")},{name:"Yen (\xA5)",id:"currencyJPY",fn:(0,W.Gl)("\xA5")},{name:"Rubles (\u20BD)",id:"currencyRUB",fn:(0,W.Gl)("\u20BD")},{name:"Hryvnias (\u20B4)",id:"currencyUAH",fn:(0,W.Gl)("\u20B4")},{name:"Real (R$)",id:"currencyBRL",fn:(0,W.Gl)("R$")},{name:"Danish Krone (kr)",id:"currencyDKK",fn:(0,W.Gl)("kr",!0)},{name:"Icelandic Kr\xF3na (kr)",id:"currencyISK",fn:(0,W.Gl)("kr",!0)},{name:"Norwegian Krone (kr)",id:"currencyNOK",fn:(0,W.Gl)("kr",!0)},{name:"Swedish Krona (kr)",id:"currencySEK",fn:(0,W.Gl)("kr",!0)},{name:"Czech koruna (czk)",id:"currencyCZK",fn:(0,W.Gl)("czk")},{name:"Swiss franc (CHF)",id:"currencyCHF",fn:(0,W.Gl)("CHF")},{name:"Polish Z\u0142oty (PLN)",id:"currencyPLN",fn:(0,W.Gl)("PLN")},{name:"Bitcoin (\u0E3F)",id:"currencyBTC",fn:(0,W.Gl)("\u0E3F")},{name:"Milli Bitcoin (\u0E3F)",id:"currencymBTC",fn:(0,W.Gl)("mBTC")},{name:"Micro Bitcoin (\u0E3F)",id:"currency\u03BCBTC",fn:(0,W.Gl)("\u03BCBTC")},{name:"South African Rand (R)",id:"currencyZAR",fn:(0,W.Gl)("R")},{name:"Indian Rupee (\u20B9)",id:"currencyINR",fn:(0,W.Gl)("\u20B9")},{name:"South Korean Won (\u20A9)",id:"currencyKRW",fn:(0,W.Gl)("\u20A9")},{name:"Indonesian Rupiah (Rp)",id:"currencyIDR",fn:(0,W.Gl)("Rp")},{name:"Philippine Peso (PHP)",id:"currencyPHP",fn:(0,W.Gl)("PHP")},{name:"Vietnamese Dong (VND)",id:"currencyVND",fn:(0,W.Gl)("\u0111",!0)},{name:"Turkish Lira (\u20BA)",id:"currencyTRY",fn:(0,W.Gl)("\u20BA",!0)},{name:"Malaysian Ringgit (RM)",id:"currencyMYR",fn:(0,W.Gl)("RM")},{name:"CFP franc (XPF)",id:"currencyXPF",fn:(0,W.Gl)("XPF")},{name:"Bulgarian Lev (BGN)",id:"currencyBGN",fn:(0,W.Gl)("BGN")},{name:"Guaran\xED (\u20B2)",id:"currencyPYG",fn:(0,W.Gl)("\u20B2")},{name:"Uruguay Peso (UYU)",id:"currencyUYU",fn:(0,W.Gl)("UYU")}]},{name:"Data",formats:[{name:"bytes(IEC)",id:"bytes",fn:(0,W.yW)("B")},{name:"bytes(SI)",id:"decbytes",fn:(0,W.rT)("B")},{name:"bits(IEC)",id:"bits",fn:(0,W.yW)("b")},{name:"bits(SI)",id:"decbits",fn:(0,W.rT)("b")},{name:"kibibytes",id:"kbytes",fn:(0,W.yW)("B",1)},{name:"kilobytes",id:"deckbytes",fn:(0,W.rT)("B",1)},{name:"mebibytes",id:"mbytes",fn:(0,W.yW)("B",2)},{name:"megabytes",id:"decmbytes",fn:(0,W.rT)("B",2)},{name:"gibibytes",id:"gbytes",fn:(0,W.yW)("B",3)},{name:"gigabytes",id:"decgbytes",fn:(0,W.rT)("B",3)},{name:"tebibytes",id:"tbytes",fn:(0,W.yW)("B",4)},{name:"terabytes",id:"dectbytes",fn:(0,W.rT)("B",4)},{name:"pebibytes",id:"pbytes",fn:(0,W.yW)("B",5)},{name:"petabytes",id:"decpbytes",fn:(0,W.rT)("B",5)}]},{name:"Data rate",formats:[{name:"packets/sec",id:"pps",fn:(0,W.rT)("p/s")},{name:"bytes/sec(IEC)",id:"binBps",fn:(0,W.yW)("B/s")},{name:"bytes/sec(SI)",id:"Bps",fn:(0,W.rT)("B/s")},{name:"bits/sec(IEC)",id:"binbps",fn:(0,W.yW)("b/s")},{name:"bits/sec(SI)",id:"bps",fn:(0,W.rT)("b/s")},{name:"kibibytes/sec",id:"KiBs",fn:(0,W.yW)("B/s",1)},{name:"kibibits/sec",id:"Kibits",fn:(0,W.yW)("b/s",1)},{name:"kilobytes/sec",id:"KBs",fn:(0,W.rT)("B/s",1)},{name:"kilobits/sec",id:"Kbits",fn:(0,W.rT)("b/s",1)},{name:"mebibytes/sec",id:"MiBs",fn:(0,W.yW)("B/s",2)},{name:"mebibits/sec",id:"Mibits",fn:(0,W.yW)("b/s",2)},{name:"megabytes/sec",id:"MBs",fn:(0,W.rT)("B/s",2)},{name:"megabits/sec",id:"Mbits",fn:(0,W.rT)("b/s",2)},{name:"gibibytes/sec",id:"GiBs",fn:(0,W.yW)("B/s",3)},{name:"gibibits/sec",id:"Gibits",fn:(0,W.yW)("b/s",3)},{name:"gigabytes/sec",id:"GBs",fn:(0,W.rT)("B/s",3)},{name:"gigabits/sec",id:"Gbits",fn:(0,W.rT)("b/s",3)},{name:"tebibytes/sec",id:"TiBs",fn:(0,W.yW)("B/s",4)},{name:"tebibits/sec",id:"Tibits",fn:(0,W.yW)("b/s",4)},{name:"terabytes/sec",id:"TBs",fn:(0,W.rT)("B/s",4)},{name:"terabits/sec",id:"Tbits",fn:(0,W.rT)("b/s",4)},{name:"pebibytes/sec",id:"PiBs",fn:(0,W.yW)("B/s",5)},{name:"pebibits/sec",id:"Pibits",fn:(0,W.yW)("b/s",5)},{name:"petabytes/sec",id:"PBs",fn:(0,W.rT)("B/s",5)},{name:"petabits/sec",id:"Pbits",fn:(0,W.rT)("b/s",5)}]},{name:"Date & time",formats:[{name:"Datetime ISO",id:"dateTimeAsIso",fn:O},{name:"Datetime ISO (No date if today)",id:"dateTimeAsIsoNoDateIfToday",fn:j},{name:"Datetime US",id:"dateTimeAsUS",fn:N},{name:"Datetime US (No date if today)",id:"dateTimeAsUSNoDateIfToday",fn:F},{name:"Datetime local",id:"dateTimeAsLocal",fn:U()},{name:"Datetime local (No date if today)",id:"dateTimeAsLocalNoDateIfToday",fn:w()},{name:"Datetime default",id:"dateTimeAsSystem",fn:B},{name:"From Now",id:"dateTimeFromNow",fn:K}]},{name:"Energy",formats:[{name:"Watt (W)",id:"watt",fn:(0,W.rT)("W")},{name:"Kilowatt (kW)",id:"kwatt",fn:(0,W.rT)("W",1)},{name:"Megawatt (MW)",id:"megwatt",fn:(0,W.rT)("W",2)},{name:"Gigawatt (GW)",id:"gwatt",fn:(0,W.rT)("W",3)},{name:"Milliwatt (mW)",id:"mwatt",fn:(0,W.rT)("W",-1)},{name:"Watt per square meter (W/m\xB2)",id:"Wm2",fn:le("W/m\xB2")},{name:"Volt-Ampere (VA)",id:"voltamp",fn:(0,W.rT)("VA")},{name:"Kilovolt-Ampere (kVA)",id:"kvoltamp",fn:(0,W.rT)("VA",1)},{name:"Volt-Ampere reactive (VAr)",id:"voltampreact",fn:(0,W.rT)("VAr")},{name:"Kilovolt-Ampere reactive (kVAr)",id:"kvoltampreact",fn:(0,W.rT)("VAr",1)},{name:"Watt-hour (Wh)",id:"watth",fn:(0,W.rT)("Wh")},{name:"Watt-hour per Kilogram (Wh/kg)",id:"watthperkg",fn:(0,W.rT)("Wh/kg")},{name:"Kilowatt-hour (kWh)",id:"kwatth",fn:(0,W.rT)("Wh",1)},{name:"Kilowatt-min (kWm)",id:"kwattm",fn:(0,W.rT)("W-Min",1)},{name:"Megawatt-hour (MWh)",id:"mwatth",fn:(0,W.rT)("Wh",2)},{name:"Ampere-hour (Ah)",id:"amph",fn:(0,W.rT)("Ah")},{name:"Kiloampere-hour (kAh)",id:"kamph",fn:(0,W.rT)("Ah",1)},{name:"Milliampere-hour (mAh)",id:"mamph",fn:(0,W.rT)("Ah",-1)},{name:"Joule (J)",id:"joule",fn:(0,W.rT)("J")},{name:"Electron volt (eV)",id:"ev",fn:(0,W.rT)("eV")},{name:"Ampere (A)",id:"amp",fn:(0,W.rT)("A")},{name:"Kiloampere (kA)",id:"kamp",fn:(0,W.rT)("A",1)},{name:"Milliampere (mA)",id:"mamp",fn:(0,W.rT)("A",-1)},{name:"Volt (V)",id:"volt",fn:(0,W.rT)("V")},{name:"Kilovolt (kV)",id:"kvolt",fn:(0,W.rT)("V",1)},{name:"Millivolt (mV)",id:"mvolt",fn:(0,W.rT)("V",-1)},{name:"Decibel-milliwatt (dBm)",id:"dBm",fn:(0,W.rT)("dBm")},{name:"Milliohm (m\u03A9)",id:"mohm",fn:(0,W.rT)("\u03A9",-1)},{name:"Ohm (\u03A9)",id:"ohm",fn:(0,W.rT)("\u03A9")},{name:"Kiloohm (k\u03A9)",id:"kohm",fn:(0,W.rT)("\u03A9",1)},{name:"Megaohm (M\u03A9)",id:"Mohm",fn:(0,W.rT)("\u03A9",2)},{name:"Farad (F)",id:"farad",fn:(0,W.rT)("F")},{name:"Microfarad (\xB5F)",id:"\xB5farad",fn:(0,W.rT)("F",-2)},{name:"Nanofarad (nF)",id:"nfarad",fn:(0,W.rT)("F",-3)},{name:"Picofarad (pF)",id:"pfarad",fn:(0,W.rT)("F",-4)},{name:"Femtofarad (fF)",id:"ffarad",fn:(0,W.rT)("F",-5)},{name:"Henry (H)",id:"henry",fn:(0,W.rT)("H")},{name:"Millihenry (mH)",id:"mhenry",fn:(0,W.rT)("H",-1)},{name:"Microhenry (\xB5H)",id:"\xB5henry",fn:(0,W.rT)("H",-2)},{name:"Lumens (Lm)",id:"lumens",fn:(0,W.rT)("Lm")}]},{name:"Flow",formats:[{name:"Gallons/min (gpm)",id:"flowgpm",fn:le("gpm")},{name:"Cubic meters/sec (cms)",id:"flowcms",fn:le("cms")},{name:"Cubic feet/sec (cfs)",id:"flowcfs",fn:le("cfs")},{name:"Cubic feet/min (cfm)",id:"flowcfm",fn:le("cfm")},{name:"Litre/hour",id:"litreh",fn:le("L/h")},{name:"Litre/min (L/min)",id:"flowlpm",fn:le("L/min")},{name:"milliLitre/min (mL/min)",id:"flowmlpm",fn:le("mL/min")},{name:"Lux (lx)",id:"lux",fn:le("lux")}]},{name:"Force",formats:[{name:"Newton-meters (Nm)",id:"forceNm",fn:(0,W.rT)("Nm")},{name:"Kilonewton-meters (kNm)",id:"forcekNm",fn:(0,W.rT)("Nm",1)},{name:"Newtons (N)",id:"forceN",fn:(0,W.rT)("N")},{name:"Kilonewtons (kN)",id:"forcekN",fn:(0,W.rT)("N",1)}]},{name:"Hash rate",formats:[{name:"hashes/sec",id:"Hs",fn:(0,W.rT)("H/s")},{name:"kilohashes/sec",id:"KHs",fn:(0,W.rT)("H/s",1)},{name:"megahashes/sec",id:"MHs",fn:(0,W.rT)("H/s",2)},{name:"gigahashes/sec",id:"GHs",fn:(0,W.rT)("H/s",3)},{name:"terahashes/sec",id:"THs",fn:(0,W.rT)("H/s",4)},{name:"petahashes/sec",id:"PHs",fn:(0,W.rT)("H/s",5)},{name:"exahashes/sec",id:"EHs",fn:(0,W.rT)("H/s",6)}]},{name:"Mass",formats:[{name:"milligram (mg)",id:"massmg",fn:(0,W.rT)("g",-1)},{name:"gram (g)",id:"massg",fn:(0,W.rT)("g")},{name:"pound (lb)",id:"masslb",fn:le("lb")},{name:"kilogram (kg)",id:"masskg",fn:(0,W.rT)("g",1)},{name:"metric ton (t)",id:"masst",fn:le("t")}]},{name:"Length",formats:[{name:"millimeter (mm)",id:"lengthmm",fn:(0,W.rT)("m",-1)},{name:"inch (in)",id:"lengthin",fn:le("in")},{name:"feet (ft)",id:"lengthft",fn:le("ft")},{name:"meter (m)",id:"lengthm",fn:(0,W.rT)("m")},{name:"kilometer (km)",id:"lengthkm",fn:(0,W.rT)("m",1)},{name:"mile (mi)",id:"lengthmi",fn:le("mi")}]},{name:"Pressure",formats:[{name:"Millibars",id:"pressurembar",fn:(0,W.rT)("bar",-1)},{name:"Bars",id:"pressurebar",fn:(0,W.rT)("bar")},{name:"Kilobars",id:"pressurekbar",fn:(0,W.rT)("bar",1)},{name:"Pascals",id:"pressurepa",fn:(0,W.rT)("Pa")},{name:"Hectopascals",id:"pressurehpa",fn:le("hPa")},{name:"Kilopascals",id:"pressurekpa",fn:le("kPa")},{name:"Inches of mercury",id:"pressurehg",fn:le('"Hg')},{name:"PSI",id:"pressurepsi",fn:oe(1e3,["psi","ksi","Mpsi"])}]},{name:"Radiation",formats:[{name:"Becquerel (Bq)",id:"radbq",fn:(0,W.rT)("Bq")},{name:"curie (Ci)",id:"radci",fn:(0,W.rT)("Ci")},{name:"Gray (Gy)",id:"radgy",fn:(0,W.rT)("Gy")},{name:"rad",id:"radrad",fn:(0,W.rT)("rad")},{name:"Sievert (Sv)",id:"radsv",fn:(0,W.rT)("Sv")},{name:"milliSievert (mSv)",id:"radmsv",fn:(0,W.rT)("Sv",-1)},{name:"microSievert (\xB5Sv)",id:"radusv",fn:(0,W.rT)("Sv",-2)},{name:"rem",id:"radrem",fn:(0,W.rT)("rem")},{name:"Exposure (C/kg)",id:"radexpckg",fn:(0,W.rT)("C/kg")},{name:"roentgen (R)",id:"radr",fn:(0,W.rT)("R")},{name:"Sievert/hour (Sv/h)",id:"radsvh",fn:(0,W.rT)("Sv/h")},{name:"milliSievert/hour (mSv/h)",id:"radmsvh",fn:(0,W.rT)("Sv/h",-1)},{name:"microSievert/hour (\xB5Sv/h)",id:"radusvh",fn:(0,W.rT)("Sv/h",-2)}]},{name:"Rotational Speed",formats:[{name:"Revolutions per minute (rpm)",id:"rotrpm",fn:le("rpm")},{name:"Hertz (Hz)",id:"rothz",fn:(0,W.rT)("Hz")},{name:"Kilohertz (kHz)",id:"rotkhz",fn:(0,W.rT)("Hz",1)},{name:"Megahertz (MHz)",id:"rotmhz",fn:(0,W.rT)("Hz",2)},{name:"Gigahertz (GHz)",id:"rotghz",fn:(0,W.rT)("Hz",3)},{name:"Radians per second (rad/s)",id:"rotrads",fn:le("rad/s")},{name:"Degrees per second (\xB0/s)",id:"rotdegs",fn:le("\xB0/s")}]},{name:"Temperature",formats:[{name:"Celsius (\xB0C)",id:"celsius",fn:le("\xB0C")},{name:"Fahrenheit (\xB0F)",id:"fahrenheit",fn:le("\xB0F")},{name:"Kelvin (K)",id:"kelvin",fn:le("K")}]},{name:"Time",formats:[{name:"Hertz (1/s)",id:"hertz",fn:(0,W.rT)("Hz")},{name:"nanoseconds (ns)",id:"ns",fn:m},{name:"microseconds (\xB5s)",id:"\xB5s",fn:v},{name:"milliseconds (ms)",id:"ms",fn:x},{name:"seconds (s)",id:"s",fn:f},{name:"minutes (m)",id:"m",fn:E},{name:"hours (h)",id:"h",fn:h},{name:"days (d)",id:"d",fn:y},{name:"duration (ms)",id:"dtdurationms",fn:P},{name:"duration (s)",id:"dtdurations",fn:C},{name:"duration (hh:mm:ss)",id:"dthms",fn:M},{name:"duration (d hh:mm:ss)",id:"dtdhms",fn:I},{name:"Timeticks (s/100)",id:"timeticks",fn:R},{name:"clock (ms)",id:"clockms",fn:T},{name:"clock (s)",id:"clocks",fn:S}]},{name:"Throughput",formats:[{name:"counts/sec (cps)",id:"cps",fn:ee("c/s")},{name:"ops/sec (ops)",id:"ops",fn:ee("ops/s")},{name:"requests/sec (rps)",id:"reqps",fn:ee("req/s")},{name:"reads/sec (rps)",id:"rps",fn:ee("rd/s")},{name:"writes/sec (wps)",id:"wps",fn:ee("wr/s")},{name:"I/O ops/sec (iops)",id:"iops",fn:ee("io/s")},{name:"events/sec (eps)",id:"eps",fn:ee("evt/s")},{name:"messages/sec (mps)",id:"mps",fn:ee("msg/s")},{name:"records/sec (rps)",id:"recps",fn:ee("rec/s")},{name:"rows/sec (rps)",id:"rowsps",fn:ee("rows/s")},{name:"counts/min (cpm)",id:"cpm",fn:ee("c/m")},{name:"ops/min (opm)",id:"opm",fn:ee("ops/m")},{name:"requests/min (rpm)",id:"reqpm",fn:ee("req/m")},{name:"reads/min (rpm)",id:"rpm",fn:ee("rd/m")},{name:"writes/min (wpm)",id:"wpm",fn:ee("wr/m")},{name:"events/min (epm)",id:"epm",fn:ee("evts/m")},{name:"messages/min (mpm)",id:"mpm",fn:ee("msgs/m")},{name:"records/min (rpm)",id:"recpm",fn:ee("rec/m")},{name:"rows/min (rpm)",id:"rowspm",fn:ee("rows/m")}]},{name:"Velocity",formats:[{name:"meters/second (m/s)",id:"velocityms",fn:le("m/s")},{name:"kilometers/hour (km/h)",id:"velocitykmh",fn:le("km/h")},{name:"miles/hour (mph)",id:"velocitymph",fn:le("mph")},{name:"knot (kn)",id:"velocityknot",fn:le("kn")}]},{name:"Volume",formats:[{name:"millilitre (mL)",id:"mlitre",fn:(0,W.rT)("L",-1)},{name:"litre (L)",id:"litre",fn:(0,W.rT)("L")},{name:"cubic meter",id:"m3",fn:le("m\xB3")},{name:"Normal cubic meter",id:"Nm3",fn:le("Nm\xB3")},{name:"cubic decimeter",id:"dm3",fn:le("dm\xB3")},{name:"gallons",id:"gallons",fn:le("gal")}]},{name:"Boolean",formats:[{name:"True / False",id:"bool",fn:Q("True","False")},{name:"Yes / No",id:"bool_yes_no",fn:Q("Yes","No")},{name:"On / Off",id:"bool_on_off",fn:Q("On","Off")}]}];function Y(ge){return`${ge.prefix??""}${ge.text}${ge.suffix??""}`}let X=[];const q={};let G=!1;function te(ge,Oe){if(ge===null)return"";if(ge===Number.NEGATIVE_INFINITY||ge===Number.POSITIVE_INFINITY)return ge.toLocaleString();if(Oe==null&&(Oe=H(ge)),ge===0)return ge.toFixed(Oe);const Ue=Oe?Math.pow(10,Math.max(0,Oe)):1,Xe=String(Math.round(ge*Ue)/Ue);if(Xe.indexOf("e")!==-1||ge===0)return Xe;const we=Xe.indexOf("."),qe=we===-1?0:Xe.length-we-1;return qe<Oe?(qe?Xe:Xe+".")+String(Ue).slice(1,Oe-qe+1):Xe}function H(ge){const Oe=Math.abs(ge);let Xe=-Math.floor(Math.log(Oe)/Math.LN10)+1;const we=Math.pow(10,-Xe);return Oe/we>2.25&&++Xe,ge%1===0&&(Xe=0),Math.max(0,Xe)}function se(ge,Oe,Ue){return{text:te(ge,Oe),suffix:ne(Ue,Math.abs(ge)>1)}}function ne(ge,Oe){if(!Oe)return ge;switch(ge){case" min":case" hour":case" day":case" week":case" year":return`${ge}s`;default:return ge}}function le(ge,Oe){return(Ue,Xe)=>{if(Ue===null)return{text:""};const we=te(Ue,Xe);return ge?Oe?{text:we,prefix:ge}:{text:we,suffix:" "+ge}:{text:we}}}function _(ge){return ge&&ge.startsWith("bool")}function Q(ge,Oe){return Ue=>({text:Ue?ge:Oe})}const ae=(ge,Oe)=>Math.log10(Oe)/Math.log10(ge);function oe(ge,Oe,Ue=0){return(Xe,we)=>{if(Xe==null)return{text:""};if(Xe===Number.NEGATIVE_INFINITY||Xe===Number.POSITIVE_INFINITY||isNaN(Xe))return{text:Xe.toLocaleString()};const qe=Xe===0?0:Math.floor(ae(ge,Math.abs(Xe))),We=Oe[(0,n.clamp)(Ue+qe,0,Oe.length-1)];return{text:te(Xe/ge**(0,n.clamp)(qe,-Ue,Oe.length-Ue-1),we),suffix:We}}}function J(ge,Oe){return ge==null?{text:""}:{text:ge.toLocaleString(void 0,{maximumFractionDigits:Oe??void 0})}}function ee(ge){const Ue=oe(1e3,["","K","M","B","T"]);return(Xe,we,qe)=>{if(Xe===null)return{text:""};const We=Ue(Xe,we,qe);return We.suffix+=" "+ge,We}}function de(ge){return{text:`${ge}`}}function xe(){X=z();for(const ge of X)for(const Oe of ge.formats)q[Oe.id]=Oe.fn;[{from:"farenheit",to:"fahrenheit"}].forEach(ge=>{const Oe=q[ge.to];Oe&&(q[ge.from]=Oe)}),G=!0}function re(ge){if(!ge)return le("");G||xe();const Oe=q[ge];if(!Oe&&ge){let Ue=ge.indexOf(":");if(Ue>0){const Xe=ge.substring(0,Ue),we=ge.substring(Ue+1);if(Xe==="prefix")return le(we,!0);if(Xe==="suffix")return le(we,!1);if(Xe==="time")return L(we);if(Xe==="si"){const qe=(0,W.cL)(we.charAt(0)),We=qe===0?we:we.substring(1);return(0,W.rT)(We,qe)}if(Xe==="count")return ee(we);if(Xe==="currency")return(0,W.Gl)(we);if(Xe==="bool"){if(Ue=we.indexOf("/"),Ue>=0){const qe=we.substring(0,Ue),We=we.substring(Ue+1);return Q(qe,We)}return Q(we,"-")}}return le(ge)}return Oe}function ue(){return G||xe(),q}function Te(){return G||xe(),X.map(ge=>({text:ge.name,submenu:ge.formats.map(Oe=>({text:Oe.name,value:Oe.id}))}))}},36120:(k,A,e)=>{"use strict";e.d(A,{$:()=>s});var n=e(18008);class s extends n.F{constructor(r){return super(),this.buffer=r.buffer||[],this.capacity=this.buffer.length,this.tail=r.append!=="head",this.index=0,this.add=this.getAddFunction(),r.capacity&&this.setCapacity(r.capacity),new Proxy(this,{get(i,g,o){if(typeof g!="symbol"){const d=+g;if(String(d)===g)return i.get(d)}return Reflect.get(i,g,o)},set(i,g,o,d){if(typeof g!="symbol"){const c=+g;if(String(c)===g)return i.set(c,o),!0}return Reflect.set(i,g,o,d)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?r=>{this.buffer.push(r),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:r=>{this.buffer.unshift(r),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?r=>{this.buffer[this.index]=r,this.index=(this.index+1)%this.buffer.length}:r=>{let i=this.index-1;i<0&&(i=this.buffer.length-1),this.buffer[i]=r,this.index=i}}setCapacity(r){if(this.capacity===r)return;const i=this.toArray();if(r>this.length)this.buffer=i;else if(r<this.capacity){const g=this.length-r;this.tail?this.buffer=i.slice(g,i.length):this.buffer=i.slice(0,i.length-g)}this.capacity=r,this.index=0,this.add=this.getAddFunction()}setAppendMode(r){const i=r!=="head";i!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=i,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(r){return this.buffer[(r+this.index)%this.buffer.length]}set(r,i){this.buffer[(r+this.index)%this.buffer.length]=i}get length(){return this.buffer.length}}},18008:(k,A,e)=>{"use strict";e.d(A,{E:()=>i,F:()=>l});var n,s;class l{constructor(){this[n]={}}*iterator(){for(let o=0;o<this.length;o++)yield this.get(o)}set(o,d){throw"unsupported operation"}add(o){throw"unsupported operation"}push(...o){for(const d of o)this.add(d);return this.length}[(s=Symbol.iterator,n=Symbol.unscopables,s)](){return this.iterator()}forEach(o){return i(this).forEach(o)}map(o){return i(this).map(o)}filter(o){return i(this).filter(o)}at(o){return this.get(o)}toArray(){const o=new Array(this.length);for(let d=0;d<this.length;d++)o[d]=this.get(d);return o}join(o){return this.toArray().join(o)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...o){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(o){throw new Error("Method not implemented.")}splice(o,d,...c){throw new Error("Method not implemented.")}unshift(...o){throw new Error("Method not implemented.")}fill(o,d,c){throw new Error("Method not implemented.")}copyWithin(o,d,c){throw new Error("Method not implemented.")}slice(o,d){return this.toArray().slice(o,d)}indexOf(o,d){return this.toArray().indexOf(o,d)}lastIndexOf(o,d){return this.toArray().lastIndexOf(o,d)}every(o,d){return this.toArray().every(o,d)}some(o,d){return this.toArray().some(o,d)}reduce(o,d){throw new Error("Method not implemented.")}reduceRight(o,d){throw new Error("Method not implemented.")}find(o,d){return this.toArray().find(o,d)}findIndex(o,d){return this.toArray().findIndex(o,d)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(o,d){return this.toArray().includes(o,d)}flatMap(o,d){return this.toArray().flatMap(o,d)}flat(o){throw new Error("Method not implemented.")}}const r=[];function i(g){return{*[Symbol.iterator](){for(let o=0;o<g.length;o++)yield g.get(o)},forEach(o){for(let d=0;d<g.length;d++)o(g.get(d),d,r)},map(o){const d=[];for(let c=0;c<g.length;c++)d.push(o(g.get(c),c,r));return d},filter(o){const d=[];let c=0;for(const a of this)o(a,c++,r)&&d.push(a);return d}}}},13390:(k,A,e)=>{"use strict";e.d(A,{X:()=>n});const n={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:s=>`data-testid ${s} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:s=>`${s} menu`,MenuGroup:s=>`${s} menu group`,MenuItem:s=>`${s} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:s=>`data-testid Panel header ${s}`,content:"data-testid panel content",headerItems:s=>`data-testid Panel header item ${s}`,menuItems:s=>`data-testid Panel menu item ${s}`,menu:s=>`data-testid Panel menu ${s}`,containerByTitle:s=>`${s} panel`,headerCornerInfo:s=>`Panel header ${s}`,status:s=>`data-testid Panel status ${s}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:s=>`gpl alias ${s}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:s=>`data-testid VizLegend series ${s}`},Drawer:{General:{title:s=>`Drawer title ${s}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:s=>`${s} field property editor`,fieldInput:s=>`data-testid Panel editor option pane field input ${s}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:s=>`data-testid Tab ${s}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:s=>`data-testid ${s}`,title:s=>`Query editor row title ${s}`,container:s=>`Query editor row ${s}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:s=>`Alert ${s}`,alertV2:s=>`data-testid Alert ${s}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:s=>`data-testid New transform ${s}`,transformationEditor:s=>`data-testid Transformation editor ${s}`,transformationEditorDebugger:s=>`data-testid Transformation editor debugger ${s}`},Transforms:{card:s=>`data-testid New transform ${s}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:s=>`${s}`,itemButton:s=>`data-testid ${s}`},QueryEditorToolbarItem:{button:s=>`QueryEditor toolbar item button ${s}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:s=>s?`data-testid Options group ${s}`:"data-testid Options group",toggle:s=>s?`data-testid Options group ${s} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:s=>`Plugin visualization item ${s}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:s=>`data-testid Value picker button ${s}`,select:s=>`data-testid Value picker select ${s}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:s=>`data-testid Collapse folder ${s}`,expandFolder:s=>`data-testid Expand folder ${s}`,dashboardItem:s=>`${n.Search.dashboardItems} ${s}`,dashboardCard:s=>`data-testid Search card ${s}`,folderHeader:s=>`data-testid Folder header ${s}`,folderContent:s=>`data-testid Folder content ${s}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:s=>`Call to action button ${s}`,buttonV2:s=>`data-testid Call to action button ${s}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:s=>`data-testid suggestion-${s}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:s=>`data-testid dashboard-row-title-${s}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:s=>`data-testid-extension-point-tab-${s}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option",variableLinkWrapper:"data-testid variable-link-wrapper"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"},EntityNotFound:{container:"data-testid entity-not-found"}}},13544:(k,A,e)=>{"use strict";e.d(A,{Tp:()=>l});var n=e(13390);const l={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:r=>`Data source list item ${r}`},EditDataSource:{url:r=>`/datasources/edit/${r}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:r=>`Data source plugin item ${r}`,dataSourcePluginsV2:r=>`Add new data source ${r}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:r=>`data-testid ${r}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:r=>`/d/${r}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally",shareExternally:"data-testid new share button share externally",shareSnapshot:"data-testid new share button share snapshot"}},NewExportButton:{container:"data-testid new export button",arrowMenu:"data-testid new export button arrow menu",Menu:{container:"data-testid new export button menu",exportAsJson:"data-testid new export button export as json"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:r=>`data-testid Dashboard template variables submenu Label ${r}`,submenuItemValueDropDownValueLinkTexts:r=>`data-testid Dashboard template variables Variable Value DropDown value link text ${r}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:r=>`data-testid Dashboard template variables Variable Value DropDown option text ${r}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:r=>`data-testid Dashboard annotations submenu Label ${r}`,annotationToggle:r=>`data-testid Dashboard annotations submenu Toggle ${r}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:r=>`Dashboard settings section item ${r}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"General"},Annotations:{List:{addAnnotationCTA:n.X.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:n.X.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:n.X.CallToActionCard.button("Add variable"),addVariableCTAV2:n.X.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:r=>`Variable editor Table Name field ${r}`,tableRowDefinitionFields:r=>`Variable editor Table Definition field ${r}`,tableRowArrowUpButtons:r=>`Variable editor Table ArrowUp button ${r}`,tableRowArrowDownButtons:r=>`Variable editor Table ArrowDown button ${r}`,tableRowDuplicateButtons:r=>`Variable editor Table Duplicate button ${r}`,tableRowRemoveButtons:r=>`Variable editor Table Remove button ${r}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:n.X.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:n.X.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:n.X.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:r=>`Dashboard search item ${r}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},SnapshotScene:{url:r=>`/dashboard/snapshot/${r}`,PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},ShareDashboardDrawer:{ShareExternally:{container:"data-testid share externally drawer container",copyUrlButton:"data-testid share externally copy url button",shareTypeSelect:"data-testid share externally share type select"},ShareSnapshot:{container:"data-testid share snapshot drawer container"}},ExportDashboardDrawer:{ExportAsJson:{container:"data-testid export as Json drawer container",codeEditor:"data-testid export as Json code editor",exportExternallyToggle:"data-testid export externally toggle type select",saveToFileButton:"data-testid save to file button",copyToClipboardButton:"data-testid copy to clipboard button",cancelButton:"data-testid cancel button"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:r=>`/d-solo/${r}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:r=>`data-testid browse dashboards row ${r}`,checkbox:r=>`data-testid ${r} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:r=>`data-testid dashboards-list-item-${r}`}}},ProfilePage:{url:"/profile"}},components:n.X}},76365:(k,A,e)=>{"use strict";e.d(A,{S6:()=>a,Jz:()=>v,oA:()=>m,Ik:()=>u});var n=e(11261),s=e(75972),l=e(57875),r=e(5546),i=e(2543);function g(f,E){const h=o(f);return d(h,E,"parents")}function o(f){return f.map(E=>{if(!E.parents?.length)return E;const h={...E,children:[]},y=[{child:h,parent:E.parents[0]}];for(;y.length;){const b=y.shift(),D={...b.parent,children:b.child?[b.child]:[],parents:[]};b.child&&(D.value=b.child.value,b.child.parents=[D]),b.parent.parents?.length&&y.push({child:D,parent:b.parent.parents[0]})}return h})}function d(f,E,h="children"){const y=h==="parents"?"children":"parents",b=[],D=[{previous:void 0,items:f,level:0}];for(;D.length;){const P=D.shift(),C=P.items.flatMap(T=>T.itemIndexes),M={value:P.items.reduce((T,S)=>T+S.value,0),itemIndexes:C,children:[],parents:[],start:0,level:P.level};if(b[P.level]=b[P.level]||[],b[P.level].push(M),P.previous){M[y]=[P.previous];const T=P.previous[h]?.reduce((S,L)=>S+L.value,0)||0;M.start=P.previous.start+T,P.previous[h].push(M)}const I=P.items.flatMap(T=>T[h]||[]),R=(0,i.groupBy)(I,T=>E.getLabel(T.itemIndexes[0]));for(const T of Object.values(R))D.push({previous:M,items:T,level:P.level+1})}return h==="parents"&&(b.reverse(),b.forEach((P,C)=>{P.forEach(M=>{M.level=C})})),b}function c(f,E){const h=[];let y=0,b;const D={};for(let C=0;C<f.data.length;C++){const M=f.getLevel(C),I=C>0?f.getLevel(C-1):void 0;if(h[M]=h[M]||[],I&&I>=M){const T=h[M][h[M].length-1];y=T.start+f.getValue(T.itemIndexes[0])+f.getValueRight(T.itemIndexes[0]),b=T.parents[0]}const R={itemIndexes:[C],value:f.getValue(C)+f.getValueRight(C),valueRight:f.isDiffFlamegraph()?f.getValueRight(C):void 0,start:y,parents:b&&[b],children:[],level:M};D[f.getLabel(C)]?D[f.getLabel(C)].push(R):D[f.getLabel(C)]=[R],b&&b.children.push(R),b=R,h[M].push(R)}const P=new p(E?.collapsingThreshold);return E?.collapsing&&P.addTree(h[0][0]),[h,D,P.getCollapsedMap()]}class a{constructor(E){this.map=new Map,this.map=E||new Map}get(E){return this.map.get(E)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(E,h){const y=new Map(this.map),b=this.map.get(E),D={...b,collapsed:h};for(const P of b.items)y.set(P,D);return new a(y)}setAllCollapsedStatus(E){const h=new Map(this.map);for(const y of this.map.keys()){const D={...this.map.get(y),collapsed:E};h.set(y,D)}return new a(h)}}class p{constructor(E){this.map=new Map,this.threshold=.99,E!==void 0&&(this.threshold=E)}addTree(E){const h=[E];for(;h.length;){const y=h.shift();y.parents?.length&&this.addItem(y,y.parents[0]),y.children.length&&h.unshift(...y.children)}}addItem(E,h){if(h&&E.value>h.value*this.threshold&&h.children.length===1)if(this.map.has(h)){const y=this.map.get(h);this.map.set(E,y),y.items.push(E)}else{const y={items:[h,E],collapsed:!0};this.map.set(h,y),this.map.set(E,y)}}getCollapsedMap(){return new a(this.map)}}function u(f){return f.missingFields.length?`Data is missing fields: ${f.missingFields.join(", ")}`:f.wrongTypeFields.length?`Data has fields of wrong type: ${f.wrongTypeFields.map(E=>`${E.name} has type ${E.type} but should be ${E.expectedTypes.join(" or ")}`).join(", ")}`:""}function m(f){const E=[["label",[n.PU.string,n.PU.enum]],["level",[n.PU.number]],["value",[n.PU.number]],["self",[n.PU.number]]],h=[],y=[];for(const b of E){const[D,P]=b,C=f.fields.find(M=>M.name===D);if(!C){h.push(D);continue}P.includes(C.type)||y.push({name:D,expectedTypes:P,type:C.type})}if(h.length>0||y.length>0)return{wrongTypeFields:y,missingFields:h}}class v{constructor(E,h,y=(0,s.a)()){this.data=E,this.options=h;const b=m(E);if(b)throw new Error(u(b));if(this.labelField=E.fields.find(P=>P.name==="label"),this.levelField=E.fields.find(P=>P.name==="level"),this.valueField=E.fields.find(P=>P.name==="value"),this.selfField=E.fields.find(P=>P.name==="self"),this.valueRightField=E.fields.find(P=>P.name==="valueRight"),this.selfRightField=E.fields.find(P=>P.name==="selfRight"),(this.valueField||this.selfField)&&!(this.valueField&&this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const D=this.labelField?.config?.type?.enum;D?(this.labelDisplayProcessor=(0,l.J)({field:this.labelField,theme:y}),this.uniqueLabels=D.text||[]):(this.labelDisplayProcessor=P=>({text:P+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,l.J)({field:this.valueField,theme:y})}isDiffFlamegraph(){return!!(this.valueRightField&&this.selfRightField)}getLabel(E){return this.labelDisplayProcessor(this.labelField.values[E]).text}getLevel(E){return this.levelField.values[E]}getValue(E){return x(this.valueField,E)}getValueRight(E){return x(this.valueRightField,E)}getSelf(E){return x(this.selfField,E)}getSelfRight(E){return x(this.selfRightField,E)}getSelfDisplay(E){return this.valueDisplayProcessor(this.getSelf(E))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case r.Zk.Bytes:return"RAM";case r.Zk.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(E){const h=this.getNodesWithLabel(E);if(!h?.length)return[[],[]];const y=g(h,this),b=d(h,this);return[y,b]}getNodesWithLabel(E){return this.initLevels(),this.uniqueLabelsMap[E]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[E,h,y]=c(this,this.options);this.levels=E,this.uniqueLabelsMap=h,this.collapsedMap=y}}}function x(f,E){return f?(typeof E=="number"?[E]:E).reduce((y,b)=>y+f.values[b],0):0}},85194:(k,A,e)=>{"use strict";e.d(A,{A:()=>Tn});var n=e(74848),s=e(32196),l=e(53076),r=e(96540),i=e(49185),g=e(60578),o=e(14578);const d=22*window.devicePixelRatio,c=10*window.devicePixelRatio,a=.5*window.devicePixelRatio,p=20*window.devicePixelRatio,u=.5*window.devicePixelRatio,m=4*window.devicePixelRatio,v=3*window.devicePixelRatio,x=3*window.devicePixelRatio,f=4*window.devicePixelRatio,E=2*window.devicePixelRatio,h=800,y=120;var b=e(64539),D=e(59093),P=e(28122);const M=({data:ht,itemData:St,onMenuItemClick:Ge,onItemFocus:Ve,onSandwich:lt,collapseConfig:It,onExpandGroup:Qe,onCollapseGroup:vt,onExpandAllGroups:Ot,onCollapseAllGroups:zt,getExtraContextMenuButtons:vn,collapsing:ln,allGroupsExpanded:On,allGroupsCollapsed:wn,selectedView:Un,search:cs})=>{function Zn(){const wt=vn?.(St,ht.data,{selectedView:Un,isDiff:ht.isDiffFlamegraph(),search:cs,collapseConfig:It})||[];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.D,{label:"Focus block",icon:"eye",onClick:()=>{Ve(),Ge()}}),(0,n.jsx)(b.D,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(St.label).then(()=>{Ge()})}}),(0,n.jsx)(b.D,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{lt(),Ge()}}),wt.map(({label:Ft,icon:Ht,onClick:ut})=>(0,n.jsx)(b.D,{label:Ft,icon:Ht,onClick:()=>ut()},Ft)),ln&&(0,n.jsxs)(D.r,{label:"Grouping",children:[It?It.collapsed?(0,n.jsx)(b.D,{label:"Expand group",icon:"angle-double-down",onClick:()=>{Qe(),Ge()}}):(0,n.jsx)(b.D,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{vt(),Ge()}}):null,!On&&(0,n.jsx)(b.D,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{Ot(),Ge()}}),!wn&&(0,n.jsx)(b.D,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{zt(),Ge()}})]})]})}return(0,n.jsx)("div",{"data-testid":"contextMenu",children:(0,n.jsx)(P.t,{renderMenuItems:Zn,x:St.posX+10,y:St.posY,focusOnOpen:!1})})};var I=e(83195),R=e(40845),T=e(48840),S=e(17464),L=e(69503);const O=({data:ht,item:St,totalTicks:Ge,position:Ve,collapseConfig:lt})=>{const It=(0,R.of)(U);if(!(St&&Ve))return null;let Qe;if(ht.isDiffFlamegraph()){const vt=N(ht,St,Ge);Qe=(0,n.jsx)(T.j,{className:It.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:vt,getRowId:Ot=>Ot.rowId})}else{const vt=j(ht,St,Ge);Qe=(0,n.jsxs)("p",{className:It.lastParagraph,children:[vt.unitTitle,(0,n.jsx)("br",{}),"Total: ",(0,n.jsx)("b",{children:vt.unitValue})," (",vt.percentValue,"%)",(0,n.jsx)("br",{}),"Self: ",(0,n.jsx)("b",{children:vt.unitSelf})," (",vt.percentSelf,"%)",(0,n.jsx)("br",{}),"Samples: ",(0,n.jsx)("b",{children:vt.samples})]})}return(0,n.jsx)(S.ZL,{children:(0,n.jsx)(L.o,{className:It.tooltipContainer,position:Ve,offset:{x:15,y:0},children:(0,n.jsxs)("div",{className:It.tooltipContent,children:[(0,n.jsxs)("p",{className:It.tooltipName,children:[ht.getLabel(St.itemIndexes[0]),lt&&lt.collapsed?(0,n.jsxs)("span",{children:[(0,n.jsx)("br",{}),"and ",lt.items.length," similar items"]}):""]}),Qe]})})})},j=(ht,St,Ge)=>{const Ve=ht.valueDisplayProcessor(St.value),lt=ht.getSelfDisplay(St.itemIndexes),It=Math.round(1e4*(Ve.numeric/Ge))/100,Qe=Math.round(1e4*(lt.numeric/Ge))/100;let vt=Ve.text+Ve.suffix,Ot=lt.text+lt.suffix;const zt=ht.getUnitTitle();return zt==="Count"&&(Ve.suffix||(vt=Ve.text),lt.suffix||(Ot=lt.text)),{percentValue:It,percentSelf:Qe,unitTitle:zt,unitValue:vt,unitSelf:Ot,samples:Ve.numeric.toLocaleString()}},N=(ht,St,Ge)=>{const lt=ht.getLevels()[0][0].valueRight,It=Ge-lt,Qe=St.value-St.valueRight,vt=Math.round(1e4*Qe/It)/100,Ot=Math.round(1e4*St.valueRight/lt)/100,zt=(Ot-vt)/vt*100,vn=F(ht,ht.valueDisplayProcessor(Qe)),ln=F(ht,ht.valueDisplayProcessor(St.valueRight)),On=(0,I.j_)("short");return[{rowId:"1",label:"% of total",baseline:vt+"%",comparison:Ot+"%",diff:On(zt).text+"%"},{rowId:"2",label:"Value",baseline:vn,comparison:ln,diff:F(ht,ht.valueDisplayProcessor(St.valueRight-Qe))},{rowId:"3",label:"Samples",baseline:On(Qe).text,comparison:On(St.valueRight).text,diff:On(St.valueRight-Qe).text}]};function F(ht,St){let Ge=St.text+St.suffix;return ht.getUnitTitle()==="Count"&&(St.suffix||(Ge=St.text)),Ge}const U=ht=>({tooltipContainer:(0,s.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,s.css)({title:"tooltipContent",fontSize:ht.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,s.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,s.css)({title:"lastParagraph",marginBottom:0}),name:(0,s.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,s.css)({title:"tooltipTable",maxWidth:"400px"})}),w=O;var B=e(84140),K=e(5546),W=e(21313);function z(ht,St=0){let Ge,Ve,lt,It,Qe,vt,Ot,zt;for(Ge=ht.length&3,Ve=ht.length-Ge,lt=St,Qe=3432918353,vt=461845907,zt=0;zt<Ve;)Ot=ht.charCodeAt(zt)&255|(ht.charCodeAt(++zt)&255)<<8|(ht.charCodeAt(++zt)&255)<<16|(ht.charCodeAt(++zt)&255)<<24,++zt,Ot=(Ot&65535)*Qe+(((Ot>>>16)*Qe&65535)<<16)&4294967295,Ot=Ot<<15|Ot>>>17,Ot=(Ot&65535)*vt+(((Ot>>>16)*vt&65535)<<16)&4294967295,lt^=Ot,lt=lt<<13|lt>>>19,It=(lt&65535)*5+(((lt>>>16)*5&65535)<<16)&4294967295,lt=(It&65535)+27492+(((It>>>16)+58964&65535)<<16);switch(Ot=0,Ge){case 3:Ot^=(ht.charCodeAt(zt+2)&255)<<16;case 2:Ot^=(ht.charCodeAt(zt+1)&255)<<8;case 1:Ot^=ht.charCodeAt(zt)&255;default:Ot=(Ot&65535)*Qe+(((Ot>>>16)*Qe&65535)<<16)&4294967295,Ot=Ot<<15|Ot>>>17,Ot=(Ot&65535)*vt+(((Ot>>>16)*vt&65535)<<16)&4294967295,lt^=Ot}return lt^=ht.length,lt^=lt>>>16,lt=(lt&65535)*2246822507+(((lt>>>16)*2246822507&65535)<<16)&4294967295,lt^=lt>>>13,lt=(lt&65535)*3266489909+(((lt>>>16)*3266489909&65535)<<16)&4294967295,lt^=lt>>>16,lt>>>0}const Y=[(0,B.A)({h:24,s:69,l:60}),(0,B.A)({h:34,s:65,l:65}),(0,B.A)({h:194,s:52,l:61}),(0,B.A)({h:163,s:45,l:55}),(0,B.A)({h:211,s:48,l:60}),(0,B.A)({h:246,s:40,l:65}),(0,B.A)({h:305,s:63,l:79}),(0,B.A)({h:47,s:100,l:73}),(0,B.A)({r:183,g:219,b:171}),(0,B.A)({r:244,g:213,b:152}),(0,B.A)({r:78,g:146,b:249}),(0,B.A)({r:249,g:186,b:143}),(0,B.A)({r:242,g:145,b:145}),(0,B.A)({r:130,g:181,b:216}),(0,B.A)({r:229,g:168,b:226}),(0,B.A)({r:174,g:162,b:224}),(0,B.A)({r:154,g:196,b:138}),(0,B.A)({r:242,g:201,b:109}),(0,B.A)({r:101,g:197,b:219}),(0,B.A)({r:249,g:147,b:78}),(0,B.A)({r:234,g:100,b:96}),(0,B.A)({r:81,g:149,b:206}),(0,B.A)({r:214,g:131,b:206}),(0,B.A)({r:128,g:110,b:183})],X=H(1,100,0,1),q=H(100,100,0,1),G=`linear-gradient(90deg, ${X} 0%, ${q} 100%)`,te=`linear-gradient(90deg, ${Y[0]} 0%, ${Y[2]} 30%, ${Y[6]} 50%, ${Y[7]} 70%, ${Y[8]} 100%)`;function H(ht,St,Ge,Ve){const lt=Math.min(1,ht/St/(Ve-Ge)),It=50-50*lt,Qe=65+7*lt;return(0,B.A)({h:It,s:100,l:Qe})}function se(ht,St){const Ge=J(ht),lt=z(Ge||"",0)%Y.length;let It=Y[lt].clone();return St.isLight&&(It=It.brighten(15)),It}const ne=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],le=`linear-gradient(90deg, ${ne[0]} 0%, ${ne[1]} 50%, ${ne[2]} 100%)`,_=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],Q=`linear-gradient(90deg, ${_[0]} 0%, ${_[1]} 50%, ${_[2]} 100%)`;function ae(ht,St,Ge,Ve,lt){const It=lt===K.yU.Default?ne:_,Qe=(0,W.scaleLinear)().domain([-100,0,100]).range(It),vt=ht-St,Ot=Ge-Ve;if(Ve===0||Ot===0){const wn=Qe(0);return(0,B.A)(wn)}const zt=Math.round(1e4*vt/Ot)/100,ln=(Math.round(1e4*St/Ve)/100-zt)/zt*100,On=Qe(ln);return(0,B.A)(On)}const oe=[["phpspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.php+)(?<line_info>.*)$/],["pyspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.py+)(?<line_info>.*)$/],["rbspy",/^(?<packageName>([^\/]*\/)*)(?<filename>.*\.rb+)(?<line_info>.*)$/],["nodespy",/^(\.\/node_modules\/)?(?<packageName>[^/]*)(?<filename>.*\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$/],["gospy",/^(?<packageName>.*?\/.*?\.|.*?\.|.+)(?<functionName>.*)$/],["javaspy",/^(?<packageName>.+\/)(?<filename>.+\.)(?<functionName>.+)$/],["dotnetspy",/^(?<packageName>.+)\.(.+)\.(.+)\(.*\)$/],["tracing",/^(?<packageName>.+?):.*$/],["pyroscope-rs",/^(?<packageName>[^::]+)/],["ebpfspy",/^(?<packageName>.+)$/],["unknown",/^(?<packageName>.+)$/]];function J(ht){for(const[St,Ge]of oe){const Ve=ht.match(Ge);if(Ve)return Ve.groups?.packageName||""}}function ee(ht){const{canvasRef:St,data:Ge,root:Ve,depth:lt,direction:It,wrapperWidth:Qe,rangeMin:vt,rangeMax:Ot,matchedLabels:zt,textAlign:vn,totalViewTicks:ln,totalColorTicks:On,totalTicksRight:wn,colorScheme:Un,focusedItemData:cs,collapsedMap:Zn}=ht,wt=Te(St,Qe,lt),Ft=(0,R.$j)(),Ht=(0,r.useMemo)(()=>{const Jn=(0,B.A)(Ft.colors.background.secondary);return Ft.isLight?Jn.darken(10).toHexString():Jn.lighten(10).toHexString()},[Ft]),ut=ue(On,wn,Un,Ft,Ht,vt,Ot,zt,cs?cs.item.level:0),pn=de(wt,Ge,ut,vn,Zn);(0,r.useEffect)(()=>{if(!wt)return;wt.clearRect(0,0,wt.canvas.width,wt.canvas.height);const Jn=new Path2D;re(Ve,It,Ge,ln,vt,Ot,Qe,Zn,(Qn,fs,ls,vs,ea,Ks,Hs)=>{Hs?Jn.rect(fs,ls,vs,ea):pn(Qn,fs,ls,vs,ea,Ks)}),wt.fillStyle=Ht,wt.fill(Jn)},[wt,Ge,Ve,Qe,vt,Ot,ln,It,pn,Zn,Ht])}function de(ht,St,Ge,Ve,lt){return(0,r.useMemo)(()=>ht?(Qe,vt,Ot,zt,vn,ln)=>{ht.beginPath(),ht.rect(vt+u,Ot,zt,vn),ht.fillStyle=Ge(Qe,ln,!1),ht.stroke(),ht.fill();const On=lt.get(Qe);let wn=ln;On&&On.collapsed&&(wn=`(${On.items.length}) `+ln),zt>=p&&(On?(ge(ht,St,wn,Qe,zt,Ve==="left"?vt+f+E:vt,Ot,Ve),xe(ht,vt,Ot,vn,Qe,On)):ge(ht,St,wn,Qe,zt,vt,Ot,Ve))}:()=>{},[ht,Ge,Ve,St,lt])}function xe(ht,St,Ge,Ve,lt,It){const Qe=St+f;ht.beginPath(),ht.rect(St,Ge,Qe-St+v+x,Ve),ht.fill(),ht.beginPath(),It.collapsed?ht.rect(Qe,Ge+Ve/4,v,Ve/2):It.items[0]===lt?ht.rect(Qe,Ge+Ve/2,v,Ve/2):It.items[It.items.length-1]===lt?ht.rect(Qe,Ge,v,Ve/2):ht.rect(Qe,Ge,v,Ve),ht.fillStyle="#666",ht.fill()}function re(ht,St,Ge,Ve,lt,It,Qe,vt,Ot){const zt=[];zt.push({item:ht,levelOffset:0});const vn=Qe*window.devicePixelRatio/Ve/(It-lt);let ln;for(;zt.length>0;){const{item:On,levelOffset:wn}=zt.shift();let Un=On.value;const cs=Un*vn<=c,Zn=Un*vn-(cs?0:u*2),wt=d;if(Zn<a)continue;let Ft=0,Ht=!1;const ut=vt.get(On),pn=ut&&ut.collapsed;if(pn&&ln===ut.items[0]?(Ft=St==="children"?-1:1,Ht=!0):ln=void 0,!Ht){const Qn=Oe(On.start,Ve,lt,vn),fs=(On.level+wn)*d;let ls=Ge.getLabel(On.itemIndexes[0]);pn&&(ln=On),Ot(On,Qn,fs,Zn,wt,ls,cs)}const Jn=St==="children"?On.children:On.parents;Jn&&zt.unshift(...Jn.map(Qn=>({item:Qn,levelOffset:wn+Ft})))}}function ue(ht,St,Ge,Ve,lt,It,Qe,vt,Ot){return(0,r.useCallback)(function(vn,ln,On){if(On&&!vt)return lt;const wn=vn.valueRight!==void 0&&(Ge===K.yU.Default||Ge===K.yU.DiffColorBlind)?ae(vn.value,vn.valueRight,ht,St,Ge):Ge===K.zM.ValueBased?H(vn.value,ht,It,Qe):se(ln,Ve);return vt?vt.has(ln)?wn.toHslString():lt:vn.level>Ot-1?wn.toHslString():wn.lighten(15).toHslString()},[ht,St,Ge,Ve,It,Qe,vt,Ot,lt])}function Te(ht,St,Ge){const[Ve,lt]=(0,r.useState)();return(0,r.useEffect)(()=>{if(!(Ge&&ht.current))return;const It=ht.current.getContext("2d"),Qe=d*Ge;ht.current.width=Math.round(St*window.devicePixelRatio),ht.current.height=Math.round(Qe),ht.current.style.width=`${St}px`,ht.current.style.height=`${Qe/window.devicePixelRatio}px`,It.textBaseline="middle",It.font=12*window.devicePixelRatio+"px monospace",It.strokeStyle="white",lt(It)},[ht,lt,St,Ge]),Ve}function ge(ht,St,Ge,Ve,lt,It,Qe,vt){ht.save(),ht.clip(),ht.fillStyle="#222";const Ot=St.valueDisplayProcessor(Ve.value),zt=Ot.suffix?Ot.text+Ot.suffix:Ot.text,vn=ht.measureText(Ge),ln=lt-m;let On=`${Ge} (${zt})`,wn=Math.max(It,0)+m;vn.width>ln&&(ht.textAlign=vt,vt==="right"&&(On=Ge,wn=It+lt-m)),ht.fillText(On,wn,Qe+d/2+2),ht.restore()}function Oe(ht,St,Ge,Ve){return(ht-St*Ge)*Ve}const Ue=({data:ht,rangeMin:St,rangeMax:Ge,matchedLabels:Ve,setRangeMin:lt,setRangeMax:It,onItemFocused:Qe,focusedItemData:vt,textAlign:Ot,onSandwich:zt,colorScheme:vn,totalProfileTicks:ln,totalProfileTicksRight:On,totalViewTicks:wn,root:Un,direction:cs,depth:Zn,showFlameGraphOnly:wt,collapsedMap:Ft,setCollapsedMap:Ht,collapsing:ut,getExtraContextMenuButtons:pn,selectedView:Jn,search:Qn})=>{const fs=Xe(),[ls,{width:vs}]=(0,i.A)(),ea=(0,r.useRef)(null),[Ks,Hs]=(0,r.useState)(),[bs,Ys]=(0,r.useState)();ee({canvasRef:ea,colorScheme:vn,data:ht,focusedItemData:vt,root:Un,direction:cs,depth:Zn,rangeMax:Ge,rangeMin:St,matchedLabels:Ve,textAlign:Ot,totalViewTicks:wn,totalColorTicks:ht.isDiffFlamegraph()?ln:wn,totalTicksRight:On,wrapperWidth:vs,collapsedMap:Ft});const La=(0,r.useCallback)(Za=>{Hs(void 0);const Er=ea.current.clientWidth/wn/(Ge-St),Ar=we({x:Za.nativeEvent.offsetX,y:Za.nativeEvent.offsetY},Un,cs,Zn,Er,wn,St,Ft);Ys(Ar?{posY:Za.clientY,posX:Za.clientX,item:Ar,label:ht.getLabel(Ar.itemIndexes[0])}:void 0)},[ht,St,Ge,wn,Un,cs,Zn,Ft]),[Xs,Ta]=(0,r.useState)(),Lr=(0,r.useCallback)(Za=>{if(bs===void 0){Hs(void 0),Ta(void 0);const Er=ea.current.clientWidth/wn/(Ge-St),Ar=we({x:Za.nativeEvent.offsetX,y:Za.nativeEvent.offsetY},Un,cs,Zn,Er,wn,St,Ft);Ar&&(Ta({x:Za.clientX,y:Za.clientY}),Hs(Ar))}},[St,Ge,wn,bs,Ta,Un,cs,Zn,Ft]),$r=(0,r.useCallback)(()=>{Hs(void 0)},[]);return(0,r.useEffect)(()=>{const Za=Er=>{Er.target instanceof HTMLElement&&Er.target.parentElement?.id!=="flameGraphCanvasContainer_clickOutsideCheck"&&Ys(void 0)};return window.addEventListener("click",Za),()=>window.removeEventListener("click",Za)},[Ys]),(0,n.jsxs)("div",{className:fs.graph,children:[(0,n.jsx)("div",{className:fs.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:ls,children:(0,n.jsx)("canvas",{ref:ea,"data-testid":"flameGraph",onClick:La,onMouseMove:Lr,onMouseLeave:$r})}),(0,n.jsx)(w,{position:Xs,item:Ks,data:ht,totalTicks:wn,collapseConfig:Ks?Ft.get(Ks):void 0}),!wt&&bs&&(0,n.jsx)(M,{data:ht,itemData:bs,collapsing:ut,collapseConfig:Ft.get(bs.item),onMenuItemClick:()=>{Ys(void 0)},onItemFocus:()=>{lt(bs.item.start/wn),It((bs.item.start+bs.item.value)/wn),Qe(bs)},onSandwich:()=>{zt(ht.getLabel(bs.item.itemIndexes[0]))},onExpandGroup:()=>{Ht(Ft.setCollapsedStatus(bs.item,!1))},onCollapseGroup:()=>{Ht(Ft.setCollapsedStatus(bs.item,!0))},onExpandAllGroups:()=>{Ht(Ft.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{Ht(Ft.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(Ft.values()).every(Za=>Za.collapsed),allGroupsExpanded:Array.from(Ft.values()).every(Za=>!Za.collapsed),getExtraContextMenuButtons:pn,selectedView:Jn,search:Qn})]})},Xe=()=>({graph:(0,s.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,s.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,s.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,s.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,s.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),we=(ht,St,Ge,Ve,lt,It,Qe,vt)=>{let Ot=St,zt=Ge==="children"?0:Ve-1;const vn=Math.floor(ht.y/(d/window.devicePixelRatio));let ln;for(;Ot;){const On=Ot;if(Ot=void 0,zt===vn){ln=On;break}const wn=Ge==="children"?On.children:On.parents||[];for(const Un of wn){const cs=Oe(Un.start,It,Qe,lt),Zn=Oe(Un.start+Un.value,It,Qe,lt);if(cs<=ht.x&&ht.x<Zn){Ot=Un;const wt=vt.get(Un);(!wt||!wt.collapsed||wt.items[0]===Un)&&(zt=zt+(Ge==="children"?1:-1));break}}}return ln},qe=Ue;var We=e(29158);const Ce=(0,r.memo)(({data:ht,focusedItem:St,totalTicks:Ge,sandwichedLabel:Ve,onFocusPillClick:lt,onSandwichPillClick:It})=>{const Qe=(0,R.of)(je),vt=[],Ot=(0,I.j_)("short")(Ge),zt=ht.valueDisplayProcessor(Ge);let vn=zt.text+zt.suffix;const ln=ht.getUnitTitle();if(ln==="Count"&&(zt.suffix||(vn=zt.text)),vt.push((0,n.jsxs)("div",{className:Qe.metadataPill,children:[vn," | ",Ot.text,Ot.suffix," samples (",ln,")"]},"default")),Ve&&vt.push((0,n.jsxs)("span",{children:[(0,n.jsx)(o.I,{size:"sm",name:"angle-right"}),(0,n.jsxs)("div",{className:Qe.metadataPill,children:[(0,n.jsx)(o.I,{size:"sm",name:"gf-show-context"})," ",(0,n.jsx)("span",{className:Qe.metadataPillName,children:Ve.substring(Ve.lastIndexOf("/")+1)}),(0,n.jsx)(We.K,{className:Qe.pillCloseButton,name:"times",size:"sm",onClick:It,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})]})]},"sandwich")),St){const On=Math.round(1e4*(St.item.value/Ge))/100;vt.push((0,n.jsxs)("span",{children:[(0,n.jsx)(o.I,{size:"sm",name:"angle-right"}),(0,n.jsxs)("div",{className:Qe.metadataPill,children:[(0,n.jsx)(o.I,{size:"sm",name:"eye"})," ",On,"% of total",(0,n.jsx)(We.K,{className:Qe.pillCloseButton,name:"times",size:"sm",onClick:lt,tooltip:"Remove focus","aria-label":"Remove focus"})]})]},"focus"))}return(0,n.jsx)("div",{className:Qe.metadata,children:vt})});Ce.displayName="FlameGraphMetadata";const je=ht=>({metadataPill:(0,s.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:ht.colors.background.secondary,borderRadius:ht.shape.borderRadius(8),padding:ht.spacing(.5,1),fontSize:ht.typography.bodySmall.fontSize,fontWeight:ht.typography.fontWeightMedium,lineHeight:ht.typography.bodySmall.lineHeight,color:ht.colors.text.secondary}),pillCloseButton:(0,s.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:ht.spacing(0,.5)}),metadata:(0,s.css)({margin:"8px 0",textAlign:"center"}),metadataPillName:(0,s.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:ht.spacing(.5)})}),Ke=Ce,_e=({data:ht,rangeMin:St,rangeMax:Ge,matchedLabels:Ve,setRangeMin:lt,setRangeMax:It,onItemFocused:Qe,focusedItemData:vt,textAlign:Ot,onSandwich:zt,sandwichItem:vn,onFocusPillClick:ln,onSandwichPillClick:On,colorScheme:wn,showFlameGraphOnly:Un,getExtraContextMenuButtons:cs,collapsing:Zn,selectedView:wt,search:Ft,collapsedMap:Ht,setCollapsedMap:ut})=>{const pn=Fe(),[Jn,Qn]=(0,r.useState)(),[fs,ls]=(0,r.useState)(),[vs,ea]=(0,r.useState)(0),[Ks,Hs]=(0,r.useState)(),[bs,Ys]=(0,r.useState)(0);if((0,r.useEffect)(()=>{if(ht){let Ta=ht.getLevels(),Lr=Ta.length?Ta[0][0].value:0,$r=Ta.length?Ta[0][0].valueRight:void 0,Za=Lr,Er;if(vn){const[Ar,ho]=ht.getSandwichLevels(vn);Ta=ho,Er=Ar,Za=ho[0]?.[0]?.value??0}Qn(Ta),ls(Er),ea(Lr),Hs($r),Ys(Za)}},[ht,vn]),!Jn)return null;const La={data:ht,rangeMin:St,rangeMax:Ge,matchedLabels:Ve,setRangeMin:lt,setRangeMax:It,onItemFocused:Qe,focusedItemData:vt,textAlign:Ot,onSandwich:zt,colorScheme:wn,totalProfileTicks:vs,totalProfileTicksRight:Ks,totalViewTicks:bs,showFlameGraphOnly:Un,collapsedMap:Ht,setCollapsedMap:ut,getExtraContextMenuButtons:cs,collapsing:Zn,search:Ft,selectedView:wt},Xs=fs?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:pn.sandwichCanvasWrapper,children:[(0,n.jsxs)("div",{className:pn.sandwichMarker,children:["Callers",(0,n.jsx)(o.I,{className:pn.sandwichMarkerIcon,name:"arrow-down"})]}),(0,n.jsx)(qe,{...La,root:fs[fs.length-1][0],depth:fs.length,direction:"parents",collapsing:!1})]}),(0,n.jsxs)("div",{className:pn.sandwichCanvasWrapper,children:[(0,n.jsxs)("div",{className:(0,s.cx)(pn.sandwichMarker,pn.sandwichMarkerCalees),children:[(0,n.jsx)(o.I,{className:pn.sandwichMarkerIcon,name:"arrow-up"}),"Callees"]}),(0,n.jsx)(qe,{...La,root:Jn[0][0],depth:Jn.length,direction:"children",collapsing:!1})]})]}):(0,n.jsx)(qe,{...La,root:Jn[0][0],depth:Jn.length,direction:"children"});return(0,n.jsxs)("div",{className:pn.graph,children:[(0,n.jsx)(Ke,{data:ht,focusedItem:vt,sandwichedLabel:vn,totalTicks:bs,onFocusPillClick:ln,onSandwichPillClick:On}),Xs]})},Fe=()=>({graph:(0,s.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,s.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:`${d/window.devicePixelRatio}px`}),sandwichMarker:(0,s.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,s.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,s.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),at=_e;var Ct=e(76365),Dt=e(75198),tt=e(80292),ze=e(55852),pe=e(10354),Se=e(19727),fe=e(94354),Ee=e(38138),Pe=e(83122);const he=({search:ht,setSearch:St,selectedView:Ge,setSelectedView:Ve,containerWidth:lt,onReset:It,textAlign:Qe,onTextAlignChange:vt,showResetButton:Ot,colorScheme:zt,onColorSchemeChange:vn,stickyHeader:ln,extraHeaderElements:On,vertical:wn,isDiffMode:Un,setCollapsedMap:cs,collapsedMap:Zn})=>{const wt=(0,R.of)(ke),[Ft,Ht]=Ie(ht,St),ut=Ft!==""?(0,n.jsx)(ze.$n,{icon:"times",fill:"text",size:"sm",onClick:()=>{St(""),Ht("")},children:"Clear"}):null;return(0,n.jsxs)("div",{className:(0,s.cx)(wt.header,{[wt.stickyHeader]:ln}),children:[(0,n.jsx)("div",{className:wt.inputContainer,children:(0,n.jsx)(pe.p,{value:Ft||"",onChange:pn=>{Ht(pn.currentTarget.value)},placeholder:"Search...",suffix:ut})}),(0,n.jsxs)("div",{className:wt.rightContainer,children:[Ot&&(0,n.jsx)(ze.$n,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{It()},className:wt.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),(0,n.jsx)(be,{value:zt,onChange:vn,isDiffMode:Un}),(0,n.jsxs)(Se.e,{className:wt.buttonSpacing,children:[(0,n.jsx)(ze.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{cs(Zn.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:Ge===K.F8.TopTable}),(0,n.jsx)(ze.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{cs(Zn.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:Ge===K.F8.TopTable})]}),(0,n.jsx)(fe.z,{size:"sm",disabled:Ge===K.F8.TopTable,options:Ae,value:Qe,onChange:vt,className:wt.buttonSpacing}),(0,n.jsx)(fe.z,{size:"sm",options:De(lt,wn),value:Ge,onChange:Ve}),On&&(0,n.jsx)("div",{className:wt.extraElements,children:On})]})]})};function be(ht){const St=(0,R.of)(ke);let Ge=(0,n.jsxs)(Ee.W,{children:[(0,n.jsx)(Ee.W.Item,{label:"By package name",onClick:()=>ht.onChange(K.zM.PackageBased)}),(0,n.jsx)(Ee.W.Item,{label:"By value",onClick:()=>ht.onChange(K.zM.ValueBased)})]});const Ve={[K.zM.ValueBased]:St.colorDotByValue,[K.zM.PackageBased]:St.colorDotByPackage,[K.yU.DiffColorBlind]:St.colorDotDiffColorBlind,[K.yU.Default]:St.colorDotDiffDefault}[ht.value]||St.colorDotByValue;let lt=(0,n.jsx)("span",{className:(0,s.cx)(St.colorDot,Ve)});return ht.isDiffMode&&(Ge=(0,n.jsxs)(Ee.W,{children:[(0,n.jsx)(Ee.W.Item,{label:"Default (green to red)",onClick:()=>ht.onChange(K.yU.Default)}),(0,n.jsx)(Ee.W.Item,{label:"Color blind (blue to red)",onClick:()=>ht.onChange(K.yU.DiffColorBlind)})]}),lt=(0,n.jsxs)("div",{className:(0,s.cx)(St.colorDotDiff,Ve),children:[(0,n.jsx)("div",{children:"-100% (removed)"}),(0,n.jsx)("div",{children:"0%"}),(0,n.jsx)("div",{children:"+100% (added)"})]})),(0,n.jsx)(Pe.m,{overlay:Ge,children:(0,n.jsx)(ze.$n,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:St.buttonSpacing,"aria-label":"Change color scheme",children:lt})})}const Ae=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function De(ht,St){let Ge=[{value:K.F8.TopTable,label:"Top Table",description:"Only show top table"},{value:K.F8.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(ht>=h||St)&&Ge.push({value:K.F8.Both,label:"Both",description:"Show both the top table and flame graph"}),Ge}function Ie(ht,St){const[Ge,Ve]=(0,r.useState)(ht),lt=(0,tt.A)(ht);return(0,Dt.A)(()=>{St(Ge)},250,[Ge]),(0,r.useEffect)(()=>{lt!==ht&&ht!==Ge&&Ve(ht)},[ht,lt,Ge]),[Ge,Ve]}const ke=ht=>({header:(0,s.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:ht.spacing(1),marginTop:ht.spacing(1)}),stickyHeader:(0,s.css)({zIndex:ht.zIndex.navbarFixed,position:"sticky",background:ht.colors.background.primary}),inputContainer:(0,s.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,s.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,s.css)({label:"buttonSpacing",marginRight:ht.spacing(1)}),resetButton:(0,s.css)({label:"resetButton",display:"flex",marginRight:ht.spacing(2)}),resetButtonIconWrapper:(0,s.css)({label:"resetButtonIcon",padding:"0 5px",color:ht.colors.text.disabled}),colorDot:(0,s.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,s.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,s.css)({label:"colorDotByValue",background:G}),colorDotByPackage:(0,s.css)({label:"colorDotByPackage",background:te}),colorDotDiffDefault:(0,s.css)({label:"colorDotDiffDefault",background:le}),colorDotDiffColorBlind:(0,s.css)({label:"colorDotDiffColorBlind",background:Q}),extraElements:(0,s.css)({label:"extraElements",marginLeft:ht.spacing(1)})}),dt=he;var Pt=e(70713),pt=e(11261),Tt=e(25019),jt=e(90708),$t=e(77093),sn=e(52622);const Yt=(0,r.memo)(({data:ht,onSymbolClick:St,search:Ge,matchedLabels:Ve,onSearch:lt,sandwichItem:It,onSandwich:Qe,onTableSort:vt,colorScheme:Ot})=>{const zt=(0,r.useMemo)(()=>{let Un={};for(let cs=0;cs<ht.data.length;cs++){const Zn=ht.getValue(cs),wt=ht.getValueRight(cs),Ft=ht.getSelf(cs),Ht=ht.getLabel(cs);(!Ve||Ve.has(Ht))&&(Un[Ht]=Un[Ht]||{},Un[Ht].self=Un[Ht].self?Un[Ht].self+Ft:Ft,Un[Ht].total=Un[Ht].total?Un[Ht].total+Zn:Zn,Un[Ht].totalRight=Un[Ht].totalRight?Un[Ht].totalRight+wt:wt)}return Un},[ht,Ve]),vn=(0,R.of)(Gt),ln=(0,R.$j)(),[On,wn]=(0,r.useState)([{displayName:"Self",desc:!0}]);return(0,n.jsx)("div",{className:vn.topTableContainer,"data-testid":"topTable",children:(0,n.jsx)(Pt.Ay,{style:{width:"100%"},children:({width:Un,height:cs})=>{if(Un<3||cs<3)return null;const Zn=qt(ht,zt,Un,St,lt,Qe,ln,Ot,Ge,It);return(0,n.jsx)($t.X,{initialSortBy:On,onSortByChange:wt=>{wt&&wt.length&&vt?.(wt[0].displayName+"_"+(wt[0].desc?"desc":"asc")),wn(wt)},data:Zn,width:Un,height:cs})}})})});Yt.displayName="FlameGraphTopTableContainer";function qt(ht,St,Ge,Ve,lt,It,Qe,vt,Ot,zt){const vn=Jt(It,lt,Ot,zt),ln={type:pt.PU.string,name:"Symbol",values:[],config:{custom:{width:Ge-Mt-y*2},links:[{title:"Highlight symbol",url:"",onClick:Un=>{const Zn=Un.origin.field.values[Un.origin.rowIndex];Ve(Zn)}}]}};let On;if(ht.isDiffFlamegraph()){ln.config.custom.width=Ge-Mt-y*3;const Un=bn("Baseline","percent"),cs=bn("Comparison","percent"),Zn=bn("Diff","percent");Zn.config.custom.cellOptions.type=sn.ob.ColorText;const[wt,Ft]=vt===K.yU.DiffColorBlind?[_[0],_[2]]:[ne[0],ne[2]];Zn.config.mappings=[{type:Tt.d.ValueToText,options:{[1/0]:{text:"new",color:Ft}}},{type:Tt.d.ValueToText,options:{[-100]:{text:"removed",color:wt}}},{type:Tt.d.RangeToText,options:{from:0,to:1/0,result:{color:Ft}}},{type:Tt.d.RangeToText,options:{from:-1/0,to:0,result:{color:wt}}}];const Ht=ht.getLevels(),ut=Ht.length?Ht[0][0].value:0,pn=Ht.length?Ht[0][0].valueRight:void 0;for(let Jn in St){vn.values.push(null),ln.values.push(Jn);const Qn=St[Jn].total,fs=St[Jn].totalRight,ls=ut-pn,vs=Math.round(1e4*Qn/ls)/100,ea=Math.round(1e4*fs/pn)/100,Ks=(ea-vs)/vs*100;Zn.values.push(Ks),Un.values.push(vs),cs.values.push(ea)}On={fields:[vn,ln,Un,cs,Zn],length:ln.values.length}}else{const Un=bn("Self",ht.selfField.config.unit),cs=bn("Total",ht.valueField.config.unit);for(let Zn in St)vn.values.push(null),ln.values.push(Zn),Un.values.push(St[Zn].self),cs.values.push(St[Zn].total);On={fields:[vn,ln,Un,cs],length:ln.values.length}}return(0,jt.we)({data:[On],fieldConfig:{defaults:{},overrides:[]},replaceVariables:Un=>Un,theme:Qe})[0]}function bn(ht,St){const Ge={width:y,align:"auto",inspect:!1,cellOptions:{type:sn.ob.Auto}};return{type:pt.PU.number,name:ht,values:[],config:{unit:St,custom:Ge}}}const Mt=61;function Jt(ht,St,Ge,Ve){const lt={type:sn.ob.Custom,cellComponent:Qe=>(0,n.jsx)(Ut,{frame:Qe.frame,onSandwich:ht,onSearch:St,search:Ge,sandwichItem:Ve,rowIndex:Qe.rowIndex})},It={filterable:!1,width:Mt,hideHeader:!0,inspect:!1,align:"auto",cellOptions:lt};return{type:pt.PU.number,name:"actions",values:[],config:{custom:It}}}function Ut(ht){const St=Lt(),Ge=ht.frame.fields.find(It=>It.name==="Symbol")?.values[ht.rowIndex],Ve=ht.search===Ge,lt=ht.sandwichItem===Ge;return(0,n.jsxs)("div",{className:St.actionCellWrapper,children:[(0,n.jsx)(We.K,{className:St.actionCellButton,name:"search",variant:Ve?"primary":"secondary",tooltip:Ve?"Clear from search":"Search for symbol","aria-label":Ve?"Clear from search":"Search for symbol",onClick:()=>{ht.onSearch(Ve?"":Ge)}}),(0,n.jsx)(We.K,{className:St.actionCellButton,name:"gf-show-context",tooltip:lt?"Remove from sandwich view":"Show in sandwich view",variant:lt?"primary":"secondary","aria-label":lt?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{ht.onSandwich(lt?void 0:Ge)}})]})}const Gt=ht=>({topTableContainer:(0,s.css)({label:"topTableContainer",padding:ht.spacing(1),backgroundColor:ht.colors.background.secondary,height:"100%"})}),Lt=()=>({actionCellWrapper:(0,s.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,s.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),At=Yt,Nt=new l.A,Dn=({data:ht,onTableSymbolClick:St,onViewSelected:Ge,onTextAlignSelected:Ve,onTableSort:lt,getTheme:It,stickyHeader:Qe,extraHeaderElements:vt,vertical:Ot,showFlameGraphOnly:zt,disableCollapsing:vn,getExtraContextMenuButtons:ln})=>{const[On,wn]=(0,r.useState)(),[Un,cs]=(0,r.useState)(0),[Zn,wt]=(0,r.useState)(1),[Ft,Ht]=(0,r.useState)(""),[ut,pn]=(0,r.useState)(K.F8.Both),[Jn,{width:Qn}]=(0,i.A)(),[fs,ls]=(0,r.useState)("left"),[vs,ea]=(0,r.useState)(),[Ks,Hs]=(0,r.useState)(new Ct.S6),bs=(0,r.useMemo)(()=>It(),[It]),Ys=(0,r.useMemo)(()=>{if(!ht)return;const rr=new Ct.Jz(ht,{collapsing:!vn},bs);return Hs(rr.getCollapsedMap()),rr},[ht,bs,vn]),[La,Xs]=An(Ys),Ta=Xn(bs),Lr=Pn(Ft,Ys);(0,r.useEffect)(()=>{Qn>0&&Qn<h&&ut===K.F8.Both&&!Ot&&pn(K.F8.FlameGraph)},[ut,pn,Qn,Ot]);const $r=(0,r.useCallback)(()=>{wn(void 0),cs(0),wt(1)},[wn,wt,cs]);function Za(){ea(void 0)}(0,r.useEffect)(()=>{$r(),Za()},[ht,$r]);const Er=(0,r.useCallback)(rr=>{Ft===rr?Ht(""):(St?.(rr),Ht(rr),$r())},[Ht,$r,St,Ft]);if(!Ys)return null;const Ar=(0,n.jsx)(at,{data:Ys,rangeMin:Un,rangeMax:Zn,matchedLabels:Lr,setRangeMin:cs,setRangeMax:wt,onItemFocused:rr=>wn(rr),focusedItemData:On,textAlign:fs,sandwichItem:vs,onSandwich:rr=>{$r(),ea(rr)},onFocusPillClick:$r,onSandwichPillClick:Za,colorScheme:La,showFlameGraphOnly:zt,collapsing:!vn,getExtraContextMenuButtons:ln,selectedView:ut,search:Ft,collapsedMap:Ks,setCollapsedMap:Hs}),ho=(0,n.jsx)(At,{data:Ys,onSymbolClick:Er,search:Ft,matchedLabels:Lr,sandwichItem:vs,onSandwich:ea,onSearch:Ht,onTableSort:lt,colorScheme:La});let Fr;return zt||ut===K.F8.FlameGraph?Fr=Ar:ut===K.F8.TopTable?Fr=(0,n.jsx)("div",{className:Ta.tableContainer,children:ho}):ut===K.F8.Both&&(Ot?Fr=(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:Ta.verticalGraphContainer,children:Ar}),(0,n.jsx)("div",{className:Ta.verticalTableContainer,children:ho})]}):Fr=(0,n.jsxs)("div",{className:Ta.horizontalContainer,children:[(0,n.jsx)("div",{className:Ta.horizontalTableContainer,children:ho}),(0,n.jsx)("div",{className:Ta.horizontalGraphContainer,children:Ar})]})),(0,n.jsx)(g.D.Provider,{value:bs,children:(0,n.jsxs)("div",{ref:Jn,className:Ta.container,children:[!zt&&(0,n.jsx)(dt,{search:Ft,setSearch:Ht,selectedView:ut,setSelectedView:rr=>{pn(rr),Ge?.(rr)},containerWidth:Qn,onReset:()=>{$r(),Za()},textAlign:fs,onTextAlignChange:rr=>{ls(rr),Ve?.(rr)},showResetButton:!!(On||vs),colorScheme:La,onColorSchemeChange:Xs,stickyHeader:!!Qe,extraHeaderElements:vt,vertical:Ot,isDiffMode:Ys.isDiffFlamegraph(),setCollapsedMap:Hs,collapsedMap:Ks}),(0,n.jsx)("div",{className:Ta.body,children:Fr})]})})};function An(ht){const St=ht?.isDiffFlamegraph()?K.yU.Default:K.zM.PackageBased,[Ge,Ve]=(0,r.useState)(St);return(0,r.useEffect)(()=>{Ve(St)},[St]),[Ge,Ve]}function Pn(ht,St){return(0,r.useMemo)(()=>{if(ht&&St){const Ge=new Set;let Ve=Nt.filter(St.getUniqueLabels(),ht);if(Ve)for(let lt of Ve)Ge.add(St.getUniqueLabels()[lt]);return Ge}},[ht,St])}function Xn(ht){return{container:(0,s.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:ht.spacing(1)}),body:(0,s.css)({label:"body",flexGrow:1}),tableContainer:(0,s.css)({height:800}),horizontalContainer:(0,s.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:ht.spacing(1),width:"100%"}),horizontalGraphContainer:(0,s.css)({flexBasis:"50%"}),horizontalTableContainer:(0,s.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,s.css)({marginBottom:ht.spacing(1)}),verticalTableContainer:(0,s.css)({height:800})}}const Tn=Dn},5546:(k,A,e)=>{"use strict";e.d(A,{F8:()=>s,Zk:()=>n,yU:()=>r,zM:()=>l});var n=(i=>(i.Bytes="bytes",i.Short="short",i.Nanoseconds="ns",i))(n||{}),s=(i=>(i.TopTable="topTable",i.FlameGraph="flameGraph",i.Both="both",i))(s||{}),l=(i=>(i.ValueBased="valueBased",i.PackageBased="packageBased",i))(l||{}),r=(i=>(i.Default="default",i.DiffColorBlind="diffColorBlind",i))(r||{})},80822:(k,A,e)=>{"use strict";e.d(A,{Wn:()=>i,_k:()=>r});var n=e(21423),s=e(41260),l=e(11261);function r(m,v){const x=i({data:m.series},{data:v.series}).data;return{...m,series:x}}function i(m,v){if(!m)return a(v);v.data.forEach(h=>{const y=m.data.find(b=>u(b,h));if(!y){m.data.push(p(h));return}g(y,h)});const x=[...m.errors??[],...v.errors??[]];x.length>0&&(m.errors=x);const f=m.error??v.error;f!=null&&(m.error=f);const E=[...m.traceIds??[],...v.traceIds??[]];return E.length>0&&(m.traceIds=E),m}function g(m,v){const x=Math.max(m.fields.length,v.fields.length);for(let f=0;f<x;f++){if(!m.fields[f])continue;const E=o(m.fields[f],v.fields,f);if(E&&(m.fields[f].values=[].concat.apply(E.values,m.fields[f].values),E.nanos)){const h=m.fields[f].nanos?.slice()||[];m.fields[f].nanos=v.fields[f].nanos?.concat(h)}}m.length+=v.length,m.meta={...m.meta,stats:c(m.meta?.stats??[],v.meta?.stats??[])}}function o(m,v,x){const f=v.filter(E=>E.name===m.name);return f.length===1?f[0]:m.labels?f.find(E=>(0,n.ab)(m.labels??{},E.labels??{})):v[x]}const d="Summary: total bytes processed";function c(m,v){const x=m.find(h=>h.displayName===d),f=v.find(h=>h.displayName===d);if(f!=null&&x!=null)return[{value:f.value+x.value,displayName:d,unit:x.unit}];const E=f??x;return E!=null?[E]:[]}function a(m){return{...m,data:m.data.map(p)}}function p(m){return{...m,fields:m.fields.map(v=>({...v,values:v.values}))}}function u(m,v){if(m.refId!==v.refId||m.name!==v.name)return!1;const x=m.meta?.type,f=v.meta?.type;if(x!==f)return!1;if(x===s.m.TimeSeriesMulti){const y=m.fields.find(D=>D.type===l.PU.number),b=v.fields.find(D=>D.type===l.PU.number);return y===void 0||b===void 0?!1:(0,n.ab)(y.labels??{},b.labels??{})}const E=m.meta?.custom?.frameType,h=v.meta?.custom?.frameType;return E==="LabeledTimeValues"&&h==="LabeledTimeValues"?!0:E===h}},80937:(k,A,e)=>{"use strict";e.d(A,{t:()=>r});var n=e(84555),s=e(32370),l=e(76040);function r(c,a,p,u="="){if(!a||!p)throw new Error("Need label to add to query.");const m=i(c);if(!m.length)return c;const v=g(a,p,u);return o(c,m,v)}function i(c){const a=n.K3.parse(c),p=[];return a.iterate({enter:({to:u,from:m,type:v})=>{if(v.id===n.Fb){const x=(0,l.u)(c.substring(m,u));return p.push({query:x.query,from:m,to:u}),!1}}}),p}function g(c,a,p){const u=a===1/0?"+Inf":a.toString();return{label:c,op:p,value:u}}function o(c,a,p){const u=new s.l;let m="",v=0;for(let x=0;x<a.length;x++){const f=a[x],E=x===a.length-1,h=c.substring(v,f.from),y=E?c.substring(f.to):"";d(f.query.labels,p)||f.query.labels.push(p);const b=u.renderQuery(f.query);m+=h+b+y,v=f.to}return m}function d(c,a){return c.find(p=>p.label===a.label&&p.value===a.value)}},86204:(k,A,e)=>{"use strict";e.d(A,{L:()=>St});var n=e(74848),s=e(32196),l=e(96540),r=e(14236),i=e(7144),g=e(13544),o=e(14110),d=e(14578),c=e(55852),a=e(40845),p=e(81996),u=e(91793),m=e(3911),v=e(39558),x=e(67061),f=e(60029),E=e(10354),h=e(54438);const y="{}",b="__name__",D=25;function P(Ge){let Ve="";const lt=[];for(const It of Ge)if((It.name===b||It.selected)&&It.values&&It.values.length>0){const Qe=It.values.filter(vt=>vt.selected).map(vt=>vt.name);Qe.length>1?lt.push(`${It.name}=~"${Qe.map(p.Cs).join("|")}"`):Qe.length===1&&(It.name===b?Ve=Qe[0]:lt.push(`${It.name}="${(0,p.Qn)(Qe[0])}"`))}return[Ve,"{",lt.join(","),"}"].join("")}function C(Ge,Ve,lt){return Ge.map(It=>{const Qe=Ve[It.name];if(Qe){let vt;if(It.name===lt&&It.values)vt=It.values;else{const Ot=new Set(It.values?.filter(zt=>zt.selected).map(zt=>zt.name)||[]);vt=Qe.map(zt=>({name:zt,selected:Ot.has(zt)}))}return{...It,loading:!1,values:vt,hidden:!Qe,facets:vt.length}}return{...It,loading:!1,hidden:!Qe,values:void 0,facets:0}})}const M=(0,m.N)(Ge=>({wrapper:(0,s.css)({backgroundColor:Ge.colors.background.secondary,padding:Ge.spacing(1),width:"100%"}),list:(0,s.css)({marginTop:Ge.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,s.css)({"& + &":{margin:`${Ge.spacing(2)} 0`},position:"relative"}),selector:(0,s.css)({fontFamily:Ge.typography.fontFamilyMonospace,marginBottom:Ge.spacing(1)}),status:(0,s.css)({padding:Ge.spacing(.5),color:Ge.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[Ge.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,s.css)({opacity:1}),error:(0,s.css)({color:Ge.colors.error.main}),valueList:(0,s.css)({marginRight:Ge.spacing(1),resize:"horizontal"}),valueListWrapper:(0,s.css)({borderLeft:`1px solid ${Ge.colors.border.medium}`,margin:`${Ge.spacing(1)} 0`,padding:`${Ge.spacing(1)} 0 ${Ge.spacing(1)} ${Ge.spacing(1)}`}),valueListArea:(0,s.css)({display:"flex",flexWrap:"wrap",marginTop:Ge.spacing(1)}),valueTitle:(0,s.css)({marginLeft:`-${Ge.spacing(.5)}`,marginBottom:Ge.spacing(1)}),validationStatus:(0,s.css)({padding:Ge.spacing(.5),marginBottom:Ge.spacing(1),color:Ge.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class I extends l.Component{constructor(){super(...arguments),this.valueListsRef=l.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=Ve=>{this.setState({labelSearchTerm:Ve.target.value})},this.onChangeMetricSearch=Ve=>{this.setState({metricSearchTerm:Ve.target.value})},this.onChangeValueSearch=Ve=>{this.setState({valueSearchTerm:Ve.target.value})},this.onClickRunQuery=()=>{const Ve=P(this.state.labels);this.props.onChange(Ve)},this.onClickRunRateQuery=()=>{const lt=`rate(${P(this.state.labels)}[$__rate_interval])`;this.props.onChange(lt)},this.onClickClear=()=>{this.setState(Ve=>({labels:Ve.labels.map(It=>({...It,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(b,y)},this.onClickLabel=(Ve,lt,It)=>{const Qe=this.state.labels.find(zt=>zt.name===Ve);if(!Qe)return;const vt=!Qe.selected;let Ot={selected:vt};if(Qe.values&&!vt){const zt=Qe.values.map(vn=>({...vn,selected:!1}));Ot={...Ot,facets:0,values:zt}}this.setState({labelSearchTerm:""}),this.updateLabelState(Ve,Ot,"",()=>this.doFacettingForLabel(Ve))},this.onClickValue=(Ve,lt,It)=>{const Qe=this.state.labels.find(Ot=>Ot.name===Ve);if(!Qe||!Qe.values)return;this.setState({labelSearchTerm:""});const vt=Qe.values.map(Ot=>({...Ot,selected:Ot.name===lt?!Ot.selected:Ot.selected}));this.updateLabelState(Ve,{values:vt},"",()=>this.doFacetting(Ve))},this.onClickMetric=(Ve,lt,It)=>{const Qe=this.state.labels.find(zt=>zt.name===Ve);if(!Qe||!Qe.values)return;this.setState({metricSearchTerm:""});const vt=Qe.values.map(zt=>({...zt,selected:zt.name===lt||zt.selected?!zt.selected:zt.selected})),Ot=vt.some(zt=>zt.selected);this.updateLabelState(Ve,{selected:Ot,values:vt},"",()=>this.doFacetting(Ve))},this.onClickValidate=()=>{const Ve=P(this.state.labels);this.validateSelector(Ve)},this.doFacetting=Ve=>{const lt=P(this.state.labels);if(lt===y){const It=this.state.labels.map(Qe=>({...Qe,facets:0,values:void 0,hidden:!1}));this.setState({labels:It},()=>{this.state.labels.forEach(Qe=>(Qe.selected||Qe.name===b)&&this.fetchValues(Qe.name,lt))})}else this.fetchSeries(lt,Ve)}}updateLabelState(Ve,lt,It="",Qe){this.setState(vt=>{const Ot=vt.labels.map(vn=>vn.name===Ve?{...vn,...lt}:vn),zt=It?"":vt.error;return{labels:Ot,status:It,error:zt,validationStatus:""}},Qe)}componentDidMount(){const{languageProvider:Ve,lastUsedLabels:lt}=this.props;if(Ve){const It=lt;Ve.start(this.props.timeRange).then(()=>{let Qe=Ve.getLabelKeys();this.fetchValues(b,y);const vt=Qe.map((Ot,zt,vn)=>({name:Ot,selected:It.includes(Ot),loading:!1}));this.setState({labels:vt},()=>{this.state.labels.forEach(Ot=>{Ot.selected&&this.fetchValues(Ot.name,y)})})})}}doFacettingForLabel(Ve){const lt=this.state.labels.find(Qe=>Qe.name===Ve);if(!lt)return;const It=this.state.labels.filter(Qe=>Qe.selected).map(Qe=>Qe.name);this.props.storeLastUsedLabels(It),lt.selected?lt.values||this.fetchValues(Ve,P(this.state.labels)):this.doFacetting()}async fetchValues(Ve,lt){const{languageProvider:It}=this.props;this.updateLabelState(Ve,{loading:!0},`Fetching values for ${Ve}`);try{let Qe=await It.getLabelValues(Ve);if(lt!==P(this.state.labels)){this.updateLabelState(Ve,{loading:!1});return}const vt=[],{metricsMetadata:Ot}=It;for(const zt of Qe){const vn={name:zt};if(Ve===b&&Ot){const ln=Ot[zt];ln&&(vn.details=`(${ln.type}) ${ln.help}`)}vt.push(vn)}this.updateLabelState(Ve,{values:vt,loading:!1})}catch(Qe){console.error(Qe)}}async fetchSeries(Ve,lt){const{languageProvider:It}=this.props;lt&&this.updateLabelState(lt,{loading:!0},`Facetting labels for ${Ve}`);try{const Qe=await It.fetchSeriesLabels(Ve,!0);if(Ve!==P(this.state.labels)){lt&&this.updateLabelState(lt,{loading:!1});return}if(Object.keys(Qe).length===0){this.setState({error:`Empty results, no matching label for ${Ve}`});return}const vt=C(this.state.labels,Qe,lt);this.setState({labels:vt,error:""}),lt&&this.updateLabelState(lt,{loading:!1})}catch(Qe){console.error(Qe)}}async validateSelector(Ve){const{languageProvider:lt}=this.props;this.setState({validationStatus:`Validating selector ${Ve}`,error:""});const It=await lt.fetchSeries(Ve);this.setState({validationStatus:`Selector is valid (${It.length} series found)`})}render(){const{theme:Ve}=this.props,{labels:lt,labelSearchTerm:It,metricSearchTerm:Qe,status:vt,error:Ot,validationStatus:zt,valueSearchTerm:vn}=this.state,ln=M(Ve);if(lt.length===0)return(0,n.jsx)("div",{className:ln.wrapper,children:(0,n.jsx)(v._,{text:"Loading labels..."})});let On=lt.find(Ft=>Ft.name===b);On&&Qe&&(On={...On,values:On.values?.filter(Ft=>Ft.selected||Ft.name.includes(Qe))});let wn=lt.filter(Ft=>!Ft.hidden&&Ft.name!==b);It&&(wn=wn.filter(Ft=>Ft.selected||Ft.name.includes(It)));let Un=wn.filter(Ft=>Ft.selected&&Ft.values);vn&&(Un=Un.map(Ft=>({...Ft,values:Ft.values?.filter(Ht=>Ht.selected||Ht.name.includes(vn))})));const cs=P(this.state.labels),Zn=cs===y,wt=On?.values?.length||0;return(0,n.jsxs)("div",{className:ln.wrapper,children:[(0,n.jsxs)(x.B,{gap:3,children:[(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:ln.section,children:[(0,n.jsx)(f.J,{description:"Once a metric is selected only possible labels are shown.",children:"1. Select a metric"}),(0,n.jsx)("div",{children:(0,n.jsx)(E.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:Qe,"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})}),(0,n.jsx)("div",{role:"list",className:ln.valueListWrapper,"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList,children:(0,n.jsx)(u.Y1,{height:Math.min(450,wt*D),itemCount:wt,itemSize:D,itemKey:Ft=>On.values[Ft].name,width:300,className:ln.valueList,children:({index:Ft,style:Ht})=>{const ut=On?.values?.[Ft];return ut?(0,n.jsx)("div",{style:Ht,children:(0,n.jsx)(h.J,{name:On.name,value:ut?.name,title:ut.details,active:ut?.selected,onClick:this.onClickMetric,searchTerm:Qe})}):null}})})]})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:ln.section,children:[(0,n.jsx)(f.J,{description:"Once label values are selected, only possible label combinations are shown.",children:"2. Select labels to search in"}),(0,n.jsx)("div",{children:(0,n.jsx)(E.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:It,"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})}),(0,n.jsx)("div",{className:ln.list,style:{height:120},children:wn.map(Ft=>(0,n.jsx)(h.J,{name:Ft.name,loading:Ft.loading,active:Ft.selected,hidden:Ft.hidden,facets:Ft.facets,onClick:this.onClickLabel,searchTerm:It},Ft.name))})]}),(0,n.jsxs)("div",{className:ln.section,children:[(0,n.jsx)(f.J,{description:"Use the search field to find values across selected labels.",children:"3. Select (multiple) values for your labels"}),(0,n.jsx)("div",{children:(0,n.jsx)(E.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:vn,"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})}),(0,n.jsx)("div",{className:ln.valueListArea,ref:this.valueListsRef,children:Un.map(Ft=>(0,n.jsxs)("div",{role:"list","aria-label":`Values for ${Ft.name}`,className:ln.valueListWrapper,children:[(0,n.jsx)("div",{className:ln.valueTitle,children:(0,n.jsx)(h.J,{name:Ft.name,loading:Ft.loading,active:Ft.selected,hidden:Ft.hidden,facets:Ft.facets||Ft.values?.length,onClick:this.onClickLabel})}),(0,n.jsx)(u.Y1,{height:Math.min(200,D*(Ft.values?.length||0)),itemCount:Ft.values?.length||0,itemSize:28,itemKey:Ht=>Ft.values[Ht].name,width:200,className:ln.valueList,children:({index:Ht,style:ut})=>{const pn=Ft.values?.[Ht];return pn?(0,n.jsx)("div",{style:ut,children:(0,n.jsx)(h.J,{name:Ft.name,value:pn?.name,active:pn?.selected,onClick:this.onClickValue,searchTerm:vn})}):null}})]},Ft.name))})]})]})]}),(0,n.jsxs)("div",{className:ln.section,children:[(0,n.jsx)(f.J,{children:"4. Resulting selector"}),(0,n.jsx)("div",{"aria-label":"selector",className:ln.selector,children:cs}),zt&&(0,n.jsx)("div",{className:ln.validationStatus,children:zt}),(0,n.jsxs)(x.B,{children:[(0,n.jsx)(c.$n,{"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:Zn,onClick:this.onClickRunQuery,children:"Use query"}),(0,n.jsx)(c.$n,{"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:Zn,onClick:this.onClickRunRateQuery,children:"Use as rate query"}),(0,n.jsx)(c.$n,{"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:Zn,onClick:this.onClickValidate,children:"Validate selector"}),(0,n.jsx)(c.$n,{"data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"}),(0,n.jsx)("div",{className:(0,s.cx)(ln.status,(vt||Ot)&&ln.statusShowing),children:(0,n.jsx)("span",{className:Ot?ln.error:"",children:Ot||vt})})]})]})]})}}const R=(0,a.cV)(I);function T(Ge){return typeof Ge=="object"&&Ge!==null&&"isCanceled"in Ge}const S=Ge=>{let Ve=!1;return{promise:new Promise((It,Qe)=>{const vt={isCanceled:!0};Ge.then(Ot=>Ve?Qe(vt):It(Ot)),Ge.catch(Ot=>Qe(Ve?vt:Ot))}),cancel(){Ve=!0}}};var L=e(84555),O=e(2543),j=e(75357),N=e(39554),F=e(62938),U=e(85828);function w(){const Ge=new Map;return Ge.set("expandSuggestionDocs","true"),{onDidChangeValue:Ve=>{},onDidChangeTarget:Ve=>{},onWillSaveState:Ve=>{},get:(Ve,lt,It)=>Ge.get(Ve)??It,getBoolean:(Ve,lt,It)=>{const Qe=Ge.get(Ve);return Qe!==void 0?Qe==="true":It},getNumber:(Ve,lt,It)=>{const Qe=Ge.get(Ve);return Qe!==void 0?parseInt(Qe,10):It},store:(Ve,lt,It,Qe)=>{lt==null?Ge.delete(Ve):Ge.set(Ve,lt.toString())},remove:(Ve,lt)=>{Ge.delete(Ve)},keys:(Ve,lt)=>Array.from(Ge.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:Ve=>!0,flush:Ve=>Promise.resolve(void 0)}}let B=null;function K(){return B===null&&(B={storageService:w()}),B}var W=e(53076),z=e(32264),Y=e(20719);class X extends Error{constructor(Ve){super("should never happen")}}const q=new W.A({intraMode:1});function G(Ge){let Ve=Ge.getAllMetricNames();if(z.$.featureToggles.prometheusCodeModeMetricNamesSearch&&Ve.length>Ge.metricNamesSuggestionLimit){const{monacoSettings:lt}=Ge;lt.enableAutocompleteSuggestionsUpdate(),lt.inputInRange?Ve=q.filter(Ve,lt.inputInRange)?.slice(0,Ge.metricNamesSuggestionLimit).map(It=>Ve[It])??[]:Ve=Ve.slice(0,Ge.metricNamesSuggestionLimit)}return Ge.metricNamesToMetrics(Ve).map(lt=>({type:"METRIC_NAME",label:lt.name,insertText:lt.name,detail:`${lt.name} : ${lt.type}`,documentation:lt.help}))}const te=Y.AW.map(Ge=>({type:"FUNCTION",label:Ge.label,insertText:Ge.insertText??"",detail:Ge.detail,documentation:Ge.documentation}));async function H(Ge){const Ve=G(Ge);return[...te,...Ve]}const se=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(Ge=>({type:"DURATION",label:Ge,insertText:Ge}));function ne(Ge){return Ge.getHistory().slice(0,10).map(lt=>({type:"HISTORY",label:lt,insertText:lt}))}function le(Ge,Ve){const lt=[...Ve];return Ge!==void 0&&lt.push({name:"__name__",value:Ge,op:"="}),`{${lt.map(Qe=>`${Qe.name}${Qe.op}"${(0,p.Qn)(Qe.value)}"`).join(",")}}`}async function _(Ge,Ve,lt){if(Ge===void 0&&Ve.length===0)return Promise.resolve(lt.getAllLabelNames());{const It=le(Ge,Ve);return await lt.getSeriesLabels(It,Ve)}}async function Q(Ge,Ve,lt,It,Qe){return(await _(Ge,It,Qe)).map(Ot=>({type:"LABEL_NAME",label:Ot,insertText:`${Ot}${Ve}`,triggerOnInsert:lt}))}async function ae(Ge,Ve,lt){return Q(Ge,"=",!0,Ve,lt)}async function oe(Ge,Ve,lt){return Q(Ge,"",!1,Ve,lt)}async function J(Ge,Ve,lt,It){if(Ge===void 0&&lt.length===0)return It.getLabelValues(Ve);{const Qe=le(Ge,lt);return await It.getSeriesValues(Ve,Qe)}}async function ee(Ge,Ve,lt,It,Qe){return(await J(Ge,Ve,It,Qe)).map(Ot=>({type:"LABEL_VALUE",label:Ot,insertText:lt?Ot:`"${Ot}"`}))}function de(Ge,Ve){switch(Ge.type){case"IN_DURATION":return Promise.resolve(se);case"IN_FUNCTION":return H(Ve);case"AT_ROOT":return H(Ve);case"EMPTY":{const lt=G(Ve),It=ne(Ve);return Promise.resolve([...It,...te,...lt])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return ae(Ge.metricName,Ge.otherLabels,Ve);case"IN_GROUPING":return oe(Ge.metricName,Ge.otherLabels,Ve);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return ee(Ge.metricName,Ge.labelName,Ge.betweenQuotes,Ge.otherLabels,Ve);default:throw new X(Ge)}}function xe(Ge,Ve){switch(Ve){case"parent":return Ge.parent;case"firstChild":return Ge.firstChild;case"lastChild":return Ge.lastChild;case"nextSibling":return Ge.nextSibling;default:throw new X(Ve)}}function re(Ge,Ve){let lt=Ge;for(const[It,Qe]of Ve)if(lt=xe(lt,It),lt===null||lt.type.id!==Qe)return null;return lt}function ue(Ge,Ve){return Ve.slice(Ge.from,Ge.to)}function Te(Ge){const Ve=Ge.slice(1,Ge.length-1);if(Ge.startsWith('"')&&Ge.endsWith('"'))return Ve.replace(/\\"/,'"');if(Ge.startsWith("'")&&Ge.endsWith("'"))return Ve.replace(/\\'/,"'");if(Ge.startsWith("`")&&Ge.endsWith("`"))return Ve;throw new Error("FIXME: invalid string literal")}function ge(Ge,Ve){return Ge.every((lt,It)=>lt===Ve[It])}const Oe=0,Ue=[{path:[L.ww,L.Fb],fun:Dt},{path:[L.ab],fun:Fe},{path:[L.Dh],fun:at},{path:[L.LW,L.BG],fun:_e},{path:[Oe,L.df,L.ab],fun:Fe},{path:[Oe,L.BG],fun:_e},{path:[Oe,L.l4],fun:Ct},{path:[L.x$],fun:Ke}],Xe=new Map([[L.Hl,"="],[L.Ed,"=~"],[L.l3,"!="],[L.$i,"!~"]]);function we(Ge){const Ve=Ge.firstChild;return Ve===null?null:Xe.get(Ve.type.id)??null}function qe(Ge,Ve){if(Ge.type.id!==L.BG)return null;const lt=re(Ge,[["firstChild",L.IC]]);if(lt===null)return null;const It=re(lt,[["nextSibling",L.Lf]]);if(It===null)return null;const Qe=we(It);if(Qe===null)return null;const vt=re(Ge,[["lastChild",L.LW]]);if(vt===null)return null;const Ot=ue(lt,Ve),zt=Te(ue(vt,Ve));return{name:Ot,value:zt,op:Qe}}function We(Ge,Ve){return Ge.type.id!==L.ww?[]:Ge.getChildren(L.BG).map(It=>qe(It,Ve)).filter(pe)}function Ce(Ge){let Ve=Ge.firstChild;const lt=[];for(;Ve!==null;)lt.push(Ve),Ve=Ve.nextSibling;return lt}function je(Ge,Ve){if(Ge.type.id===Ve)return Ge;const lt=Ce(Ge);for(const It of lt){const Qe=je(It,Ve);if(Qe!==null)return Qe}return null}function Ke(Ge,Ve,lt){const It=re(Ge,[["parent",L.hI],["parent",L.Fn]]);if(It===null)return null;const Qe=It.getChild(L.Dh);if(Qe===null)return null;const vt=je(Qe,L.gw);return vt===null?null:{type:"IN_GROUPING",metricName:ue(vt,Ve),otherLabels:[]}}function _e(Ge,Ve,lt){const It=!Ge.type.isError,Qe=re(Ge,[["parent",L.BG]]);if(Qe===null)return null;const vt=re(Qe,[["firstChild",L.IC]]);if(vt===null)return null;const Ot=ue(vt,Ve),zt=re(Qe,[["parent",L.ww]]);if(zt===null)return null;const ln=We(zt,Ve).filter(Un=>Un.name!==Ot),On=re(zt,[["parent",L.Fb],["firstChild",L.gw]]);return On===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:Ot,betweenQuotes:It,otherLabels:ln}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:ue(On,Ve),labelName:Ot,betweenQuotes:It,otherLabels:ln}}function Fe(Ge,Ve,lt){return{type:"AT_ROOT"}}function at(Ge,Ve,lt){return{type:"IN_FUNCTION"}}function Ct(Ge,Ve,lt){return{type:"IN_DURATION"}}function Dt(Ge,Ve,lt){const It=re(Ge,[["firstChild",L.BG]]);if(It!==null&&!Ve.slice(It.to,lt).includes(","))return null;const Qe=re(Ge,[["parent",L.Fb],["firstChild",L.gw]]),vt=We(Ge,Ve);return Qe===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:vt}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:ue(Qe,Ve),otherLabels:vt}}function tt(Ge,Ve){const lt=Ge.cursorAt(Ve);for(;;){if(lt.from===Ve&&lt.to===Ve){const{node:It}=lt;if(It.type.isError)return It}if(!lt.next())break}return null}function ze(Ge,Ve){if(Ge==="")return{type:"EMPTY"};const lt=L.K3.parse(Ge),It=tt(lt,Ve),Qe=It!=null?It.cursor():lt.cursorAt(Ve),vt=Qe.node,Ot=[Qe.type.id];for(;Qe.parent();)Ot.push(Qe.type.id);for(let zt of Ue)if(ge(zt.path,Ot))return zt.fun(vt,Ge,Ve);return null}function pe(Ge){return Ge!=null}function Se(){return{showWords:!1}}function fe(Ge,Ve){switch(Ge){case"DURATION":return Ve.languages.CompletionItemKind.Unit;case"FUNCTION":return Ve.languages.CompletionItemKind.Variable;case"HISTORY":return Ve.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return Ve.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return Ve.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return Ve.languages.CompletionItemKind.Constructor;default:throw new X(Ge)}}function Ee(Ge,Ve){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(It,Qe)=>{const vt=It.getWordAtPosition(Qe),Ot=vt!=null?Ge.Range.lift({startLineNumber:Qe.lineNumber,endLineNumber:Qe.lineNumber,startColumn:vt.startColumn,endColumn:vt.endColumn}):Ge.Range.fromPositions(Qe),zt={column:Qe.column,lineNumber:Qe.lineNumber};if(Ve.monacoSettings.setInputInRange(It.getValueInRange(Ot)),window.getSelection){const wn=window.getSelection()?.toString();wn&&wn.length>0&&(zt.column=zt.column-wn.length)}const vn=It.getOffsetAt(zt),ln=ze(It.getValue(),vn);return(ln!=null?de(ln,Ve):Promise.resolve([])).then(wn=>{const Un=wn.length.toString().length;return{suggestions:wn.map((Zn,wt)=>({kind:fe(Zn.type,Ge),label:Zn.label,insertText:Zn.insertText,detail:Zn.detail,documentation:Zn.documentation,sortText:wt.toString().padStart(Un,"0"),range:Ot,command:Zn.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:Ve.monacoSettings.suggestionsIncomplete}})}}}var Pe=e(91306);const he=0;function be(Ge,Ve,lt,It){if(!Ge)return!1;const Qe=Ae(Ve,It);if(!Qe.length)return!1;let vt=Qe;if(Ge!==Ve){const Ot=Ae(Ge,It);vt=Qe.flatMap(zt=>Ot.filter(vn=>zt.text===vn.text)||zt)}return vt.map(Ot=>De(Ge,lt,Ot)).filter(Ie)}function Ae(Ge,Ve){const lt=[];return Ve.parse(Ge).iterate({enter:Qe=>{if(Qe.type.id===he){const vt=Qe.node;lt.push({node:vt,text:Ge.substring(vt.from,vt.to)})}}}),lt}function De(Ge,Ve,lt){if(Ve.length===1){const vt=lt.node.from===lt.node.to,Ot=vt&&lt.node.parent?lt.node.parent:lt.node,zt=vt?Ge.substring(Ot.from,Ot.to):lt.text;return{startLineNumber:1,startColumn:Ot.from+1,endLineNumber:1,endColumn:Ot.to+1,error:zt}}let It=0,Qe=0;for(let vt=0;vt<Ve.length;vt++){if(Qe=It+Ve[vt].length,lt.node.from>Qe){It+=Ve[vt].length+1;continue}return{startLineNumber:vt+1,startColumn:lt.node.from-It+1,endLineNumber:vt+1,endColumn:lt.node.to-It+1,error:lt.text}}return null}function Ie(Ge){return Ge!==null}const ke={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},dt={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},Pt=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],pt=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],Tt=[];for(let Ge=0,Ve=Pt;Ge<Ve.length;Ge++){let lt=Ve[Ge];Tt.push(lt+"_over_time")}const jt=["on","ignoring","group_right","group_left","by","without"],$t="("+jt.reduce(function(Ge,Ve){return Ge+"|"+Ve})+")",sn=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Yt=["offset"],bn={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:Pt.concat(pt).concat(Tt).concat(jt).concat(Yt),operators:sn,vectorMatching:$t,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},Mt={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:Se(),suggestFontSize:12,wordWrap:"on"},Jt=2,Ut=j.promLanguageDefinition.id;let Gt=!1;function Lt(Ge){if(Gt===!1){Gt=!0;const{aliases:Ve,extensions:lt,mimetypes:It}=j.promLanguageDefinition;Ge.languages.register({id:Ut,aliases:Ve,extensions:lt,mimetypes:It}),Ge.languages.setMonarchTokensProvider(Ut,bn),Ge.languages.setLanguageConfiguration(Ut,dt)}}const At=(Ge,Ve)=>({container:(0,s.css)({borderRadius:Ge.shape.radius.default,border:`1px solid ${Ge.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,s.css)({"::after":{content:`'${Ve}'`,fontFamily:Ge.typography.fontFamilyMonospace,opacity:.6}})}),Dn=Ge=>{const Ve=(0,F.A)(),lt=(0,l.useRef)(K()),It=(0,l.useRef)(null),{languageProvider:Qe,history:vt,onBlur:Ot,onRunQuery:zt,initialValue:vn,placeholder:ln,onChange:On,datasource:wn}=Ge,Un=(0,N.A)(Qe),cs=(0,N.A)(vt),Zn=(0,N.A)(zt),wt=(0,N.A)(Ot),Ft=(0,N.A)(On),Ht=(0,l.useRef)(null),ut=(0,a.$j)(),pn=At(ut,ln);return(0,l.useEffect)(()=>()=>{Ht.current?.()},[]),(0,n.jsx)("div",{"data-testid":g.Tp.components.QueryField.container,className:pn.container,ref:It,children:(0,n.jsx)(U.m,{overrideServices:lt.current,options:Mt,language:"promql",value:vn,beforeMount:Jn=>{Lt(Jn)},onMount:(Jn,Qn)=>{const fs=Jn.createContextKey("isEditorFocused"+Ve,!1);Jn.onDidBlurEditorWidget(()=>{fs.set(!1),wt.current(Jn.getValue())}),Jn.onDidFocusEditorText(()=>{fs.set(!0)});const ls=new Pe.M9({historyProvider:cs.current,languageProvider:Un.current}),vs=Ee(Qn,ls),ea={...vs,provideCompletionItems:(Ys,La,Xs,Ta)=>Jn.getModel()?.id!==Ys.id?{suggestions:[]}:vs.provideCompletionItems(Ys,La,Xs,Ta)},{dispose:Ks}=Qn.languages.registerCompletionItemProvider(Ut,ea);Ht.current=Ks;const Hs=()=>{const Ys=It.current;if(Ys!==null){const La=Jn.getContentHeight();Ys.style.height=`${La+Jt}px`,Ys.style.width="100%";const Xs=Ys.clientWidth;Jn.layout({width:Xs,height:La})}};Jn.onDidContentSizeChange(Hs),Hs();const bs=(0,O.debounce)(()=>{const Ys=Jn.getValue();Ft.current(Ys)},Un.current.datasource.getDebounceTimeInMilliseconds());if(Jn.getModel()?.onDidChangeContent(()=>{bs()}),Jn.addCommand(Qn.KeyMod.Shift|Qn.KeyCode.Enter,()=>{Zn.current(Jn.getValue())},"isEditorFocused"+Ve),Qn.editor.addKeybindingRule({keybinding:Qn.KeyMod.CtrlCmd|Qn.KeyCode.KeyF,command:null}),Jn.addCommand(Qn.KeyMod.CtrlCmd|Qn.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),ln){const Ys=[{range:new Qn.Range(1,1,1,1),options:{className:pn.placeholder,isWholeLine:!0}}];let La=[];const Xs=()=>{const Ta=Jn.getModel();if(!Ta)return;const Lr=Ta.getValueLength()===0?Ys:[];La=Ta.deltaDecorations(La,Lr)};Xs(),Jn.onDidChangeModelContent(Xs),Jn.onDidChangeModelContent(Ta=>{const Lr=Jn.getModel();if(!Lr)return;const $r=Lr.getValue(),Er=(be($r,wn.interpolateString($r,ke),Lr.getLinesContent(),L.K3)||[]).map(({error:Ar,...ho})=>({message:`${Ar?`Error parsing "${Ar}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:Qn.MarkerSeverity.Error,...ho}));Qn.editor.setModelMarkers(Lr,"owner",Er)})}}})})},An=Ge=>(0,n.jsx)(l.Suspense,{fallback:null,children:(0,n.jsx)(Dn,{...Ge})}),Pn=Ge=>{const Ve=(0,l.useRef)(null),{onRunQuery:lt,onChange:It,...Qe}=Ge,vt=vn=>{Ve.current=vn,It(vn),lt()},Ot=vn=>{It(vn)},zt=vn=>{It(vn)};return(0,n.jsx)(An,{onChange:zt,onRunQuery:vt,onBlur:Ot,...Qe})},Xn="grafana.datasources.prometheus.browser.labels";function Tn(Ge,Ve,lt){return Ge?"(Disabled)":Ve?lt?"Metrics browser":"(No metrics found)":"Loading metrics..."}class ht extends l.PureComponent{constructor(Ve){super(Ve),this.refreshHint=()=>{const{datasource:lt,query:It,data:Qe}=this.props,vt=lt.getInitHints(),Ot=vt.length>0?vt[0]:null;if(!Qe||Qe.series.length===0){this.setState({hint:Ot});return}const zt=(0,r.ci)(Qe.series[0])?Qe.series.map(r.w3):Qe.series,vn=lt.getQueryHints(It,zt);let ln=vn.length>0?vn[0]:null;this.setState({hint:ln??Ot})},this.refreshMetrics=async()=>{const{range:lt,datasource:{languageProvider:It}}=this.props;this.languageProviderInitializationPromise=S(It.start(lt));try{const Qe=await this.languageProviderInitializationPromise.promise;await Promise.all(Qe),this.onUpdateLanguage()}catch(Qe){if(!(T(Qe)&&Qe.isCanceled))throw Qe}},this.onChangeLabelBrowser=lt=>{this.onChangeQuery(lt,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(lt,It)=>{const{query:Qe,onChange:vt,onRunQuery:Ot}=this.props;if(vt){const zt={...Qe,expr:lt};vt(zt),It&&Ot&&Ot()}},this.onClickChooserButton=()=>{this.setState(lt=>({labelBrowserVisible:!lt.labelBrowserVisible})),(0,o.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:lt,query:It,onChange:Qe,onRunQuery:vt}=this.props,{hint:Ot}=this.state;Ot?.fix?.action&&Qe(lt.modifyQuery(It,Ot.fix.action)),vt()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:lt}}=this.props,{metrics:It}=lt;It&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(Ve){const{data:lt,datasource:{languageProvider:It},range:Qe}=this.props;It!==Ve.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const vt=this.rangeChangedToRefresh(Qe,Ve.range);(It!==Ve.datasource.languageProvider||vt)&&this.refreshMetrics(),lt&&Ve.data&&Ve.data.series!==lt.series&&this.refreshHint()}rangeChangedToRefresh(Ve,lt){if(Ve&&lt){const It=(0,p.eN)(Ve.from.valueOf())===(0,p.eN)(lt.from.valueOf()),Qe=(0,p.eN)(Ve.to.valueOf())===(0,p.eN)(lt.to.valueOf());return!(It&&Qe)}return!1}render(){const{datasource:Ve,datasource:{languageProvider:lt},query:It,ExtraFieldElement:Qe,history:vt=[],theme:Ot}=this.props,{labelBrowserVisible:zt,syntaxLoaded:vn,hint:ln}=this.state,On=lt.metrics.length>0,wn=Tn(Ve.lookupsDisabled,vn,On),Un=!(vn&&On);return(0,n.jsx)(i.b,{storageKey:Xn,defaultValue:[],children:(cs,Zn,wt)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:[(0,n.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:Un,type:"button","data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton,children:[wn,(0,n.jsx)(d.I,{name:zt?"angle-down":"angle-right"})]}),(0,n.jsx)("div",{className:"flex-grow-1 min-width-15",children:(0,n.jsx)(Pn,{languageProvider:lt,history:vt,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:It.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:Ve})})]}),zt&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(R,{languageProvider:lt,onChange:this.onChangeLabelBrowser,lastUsedLabels:cs||[],storeLastUsedLabels:Zn,deleteLastUsedLabels:wt,timeRange:this.props.range})}),Qe,ln?(0,n.jsx)("div",{className:(0,s.css)({flexBasis:"100%"}),children:(0,n.jsxs)("div",{className:"text-warning",children:[ln.label," ",ln.fix?(0,n.jsx)("button",{type:"button",className:(0,s.cx)((0,c.my)(Ot),"text-link","muted"),onClick:this.onClickHintFix,children:ln.fix.label}):null]})}):null]})})}}const St=(0,a.cV)(ht)},91306:(k,A,e)=>{"use strict";e.d(A,{M9:()=>l,Ol:()=>s,w0:()=>n});const n="codeModeSuggestionsIncomplete";function s(r){return r.type===n&&"detail"in r&&typeof r.detail=="object"&&r.detail!==null&&"limit"in r.detail&&"datasourceUid"in r.detail}class l{constructor(i){this.languageProvider=i.languageProvider,this.historyProvider=i.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(i=>i.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(i){const{metricsMetadata:g}=this.languageProvider;return i.map(d=>{const c=g?.[d];return{name:d,help:c?.help??"",type:c?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(n,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(i){this.inputInRange=i}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(k,A,e)=>{"use strict";e.d(A,{TT:()=>o,Zh:()=>d,jW:()=>g,k1:()=>r});var n=e(74848),s=e(32196),l=e(72093);const r=30,i=c=>{const{options:a,onOptionsChange:p}=c,u=useTheme2(),m=d(u);return jsxs(Fragment,{children:[a.access==="direct"&&jsx(Alert,{title:"Error",severity:"error",children:"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."}),jsx(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),jsx("hr",{className:`${m.hrTopSpace} ${m.hrBottomSpace}`}),jsx(DataSourceHttpSettingsOverhaul,{options:a,onOptionsChange:p,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),jsx("hr",{}),jsxs(ConfigSection,{className:m.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",children:[jsx(AdvancedHttpSettings,{className:m.advancedHTTPSettingsMargin,config:a,onChange:p}),jsx(AlertingSettingsOverhaul,{options:a,onOptionsChange:p}),jsx(PromSettings,{options:a,onOptionsChange:p})]})]})};function g(c){return(0,n.jsx)("a",{href:c||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer",children:"Visit docs for more details here."})}const o=(c,a,p)=>{const u="Value is not valid";return c&&!c.match(a)?(0,n.jsx)(l.P,{children:p||u}):!0};function d(c){return{additionalSettings:(0,s.css)({marginBottom:"25px"}),secondaryGrey:(0,s.css)({color:c.colors.secondary.text,opacity:"65%"}),inlineError:(0,s.css)({margin:"0px 0px 4px 245px"}),switchField:(0,s.css)({alignItems:"center"}),sectionHeaderPadding:(0,s.css)({paddingTop:"32px"}),sectionBottomPadding:(0,s.css)({paddingBottom:"28px"}),subsectionText:(0,s.css)({fontSize:"12px"}),hrBottomSpace:(0,s.css)({marginBottom:"56px"}),hrTopSpace:(0,s.css)({marginTop:"50px"}),textUnderline:(0,s.css)({textDecoration:"underline"}),versionMargin:(0,s.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,s.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,s.css)({paddingTop:"32px"}),alertingTop:(0,s.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,s.css)({fontWeight:400}),container:(0,s.css)({maxwidth:578})}}},75212:(k,A,e)=>{"use strict";e.d(A,{gs:()=>tt,UD:()=>ze});var n=e(2543),s=e(13288),l=e(75505),r=e(81160),i=e(59099),g=e(97716),o=e.n(g),d=e(65879),c=e(43659),a=e(43127),p=e(47232),u=e(37891),m=e(41987),v=e(26657),x=e(72574),f=e(47773),E=e(17172),h=e(32264),y=e(80937),b=e(74848),D=e(13544),P=e(71087),C=e(9e4),M=e(81580),I=e(79458),R=e(51440),T=e(68402),S=e(10354),L=e(80109);function O(Pe){const he=Pe.annotation,be=Pe.onAnnotationChange,Ae={expr:he.expr,refId:he.name,interval:he.step};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(P.D,{children:[(0,b.jsx)(L.$,{...Pe,query:Ae,showExplain:!1,onChange:De=>{be({...he,expr:De.expr})}}),(0,b.jsx)(C.U,{children:(0,b.jsx)(M.c,{label:"Min step",tooltip:(0,b.jsxs)(b.Fragment,{children:["An additional lower limit for the step parameter of the Prometheus query and for the"," ",(0,b.jsx)("code",{children:"$__interval"})," and ",(0,b.jsx)("code",{children:"$__rate_interval"})," variables."]}),children:(0,b.jsx)(R.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:De=>{be({...he,step:De.currentTarget.value})},defaultValue:Ae.interval,id:D.Tp.components.DataSource.Prometheus.annotations.minStep})})})]}),(0,b.jsx)(T.$,{v:.5}),(0,b.jsxs)(C.U,{children:[(0,b.jsx)(M.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,b.jsx)(S.p,{type:"text",placeholder:"{{alertname}}",value:he.titleFormat,onChange:De=>{be({...he,titleFormat:De.currentTarget.value})},"data-testid":D.Tp.components.DataSource.Prometheus.annotations.title})}),(0,b.jsx)(M.c,{label:"Tags",children:(0,b.jsx)(S.p,{type:"text",placeholder:"label1,label2",value:he.tagKeys,onChange:De=>{be({...he,tagKeys:De.currentTarget.value})},"data-testid":D.Tp.components.DataSource.Prometheus.annotations.tags})}),(0,b.jsx)(M.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,b.jsx)(S.p,{type:"text",placeholder:"{{instance}}",value:he.textFormat,onChange:De=>{be({...he,textFormat:De.currentTarget.value})},"data-testid":D.Tp.components.DataSource.Prometheus.annotations.text})}),(0,b.jsx)(M.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.",children:(0,b.jsx)(I.C,{value:he.useValueForTime,onChange:De=>{be({...he,useValueForTime:De.currentTarget.value})},"data-testid":D.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp})})]})]})}var j=e(50556),N=e(81996),F=e(32370),U=e(76040),w=e(62183);const B=/^label_names\(\)\s*$/,K=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,W=/^metrics\((.+)\)\s*$/,z=/^query_result\((.+)\)\s*$/,Y=/^label_names\((.+)\)\s*$/;function X(Pe){if(typeof Pe!="string")return Pe;const he={refId:"PrometheusDatasource-VariableQuery",qryType:w.B4.LabelNames},be=Pe.match(Y);if(be)return{...he,qryType:w.B4.LabelNames,match:be[1]};const Ae=Pe.match(B);if(Ae)return{...he,qryType:w.B4.LabelNames};const De=Pe.match(/^label_values\(/);if(De){const dt=Pe.match(K),Pt=dt?dt[2]:"",pt=dt?dt[1]:"";if(pt){const Tt=(0,U.u)(pt);return{...he,qryType:w.B4.LabelValues,label:Pt,metric:Tt.query.metric,labelFilters:Tt.query.labels}}else return{...he,qryType:w.B4.LabelValues,label:Pt}}const Ie=Pe.match(/^metrics\(/);if(Ie){const dt=Pe.match(W),Pt=dt?dt[1]:"";return{...he,qryType:w.B4.MetricNames,metric:Pt}}const ke=Pe.match(/^query_result\(/);if(ke){const dt=Pe.match(z),Pt=dt?dt[1]:"";return{...he,qryType:w.B4.VarQueryResult,varQuery:Pt}}return!Ae&&!De&&!Ie&&!ke?{...he,qryType:w.B4.SeriesQuery,seriesQuery:Pe}:he}function q(Pe){switch(Pe.qryType){case w.B4.LabelNames:return Pe.match?`label_names(${Pe.match})`:"label_names()";case w.B4.LabelValues:if(Pe.metric||Pe.labelFilters&&Pe.labelFilters.length!==0){const be={metric:Pe.metric,labels:Pe.labelFilters??[],operations:[]};return`label_values(${F.z.renderQuery(be)},${Pe.label})`}else return`label_values(${Pe.label})`;case w.B4.MetricNames:return`metrics(${Pe.metric})`;case w.B4.VarQueryResult:return`query_result(${G(Pe.varQuery)})`;case w.B4.SeriesQuery:return Pe.seriesQuery??"";case w.B4.ClassicQuery:return Pe.classicQuery??""}return""}function G(Pe){return Pe?Pe.replace(/[\r\n]+/gm,""):""}class te{constructor(he,be){this.datasource=he,this.query=be,this.datasource=he,this.query=be,this.range=(0,a.E2)()}process(he){this.range=he;const be=B,Ae=Y,De=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,Ie=W,ke=z,dt=this.query.match(be),Pt=this.query.match(Ae);if(Pt){const sn=`{__name__=~".*${Pt[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(sn,[]).then(Yt=>Yt.map(qt=>({text:qt})))}if(dt)return this.datasource.getTagKeys({filters:[],timeRange:he});const pt=this.query.match(De);if(pt){const sn=pt[1],Yt=pt[2];return H(sn)?this.labelValuesQuery(Yt,sn):this.labelValuesQuery(Yt)}const Tt=this.query.match(Ie);if(Tt)return this.metricNameQuery(Tt[1]);const jt=this.query.match(ke);return jt?this.queryResultQuery(jt[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(he,be){const Ae=(0,N.mv)(this.range.from,!1),De=(0,N.mv)(this.range.to,!0),Ie={...be&&{"match[]":be},start:Ae.toString(),end:De.toString()};if(!be||this.datasource.hasLabelsMatchAPISupport()){const ke=`/api/v1/label/${he}/values`;return this.datasource.metadataRequest(ke,Ie).then(dt=>(0,n.map)(dt.data.data,Pt=>({text:Pt})))}else return this.datasource.metadataRequest("/api/v1/series",Ie).then(dt=>{const Pt=(0,n.map)(dt.data.data,pt=>pt[he]||"").filter(pt=>pt!=="");return(0,n.uniq)(Pt).map(pt=>({text:pt,expandable:!0}))})}metricNameQuery(he){const be=(0,N.mv)(this.range.from,!1),Ae=(0,N.mv)(this.range.to,!0),De={start:be.toString(),end:Ae.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",De).then(ke=>(0,n.chain)(ke.data.data).filter(dt=>new RegExp(he).test(dt)).map(dt=>({text:dt,expandable:!0})).value())}queryResultQuery(he){const be="/api/v1/query",Ae={query:he,time:(0,N.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(be,Ae).then(De=>{switch(De.data.data.resultType){case"scalar":case"string":return[{text:De.data.data.result[1]||"",expandable:!1}];case"vector":return(0,n.map)(De.data.data.result,Ie=>{let ke=Ie.metric.__name__||"";return delete Ie.metric.__name__,ke+="{"+(0,n.map)(Ie.metric,(dt,Pt)=>Pt+'="'+dt+'"').join(",")+"}",ke+=" "+Ie.value[1]+" "+Ie.value[0]*1e3,{text:ke,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${De.data.data.resultType}]`)}})}metricNameAndLabelsQuery(he){const be=(0,N.mv)(this.range.from,!1),Ae=(0,N.mv)(this.range.to,!0),De={"match[]":he,start:be.toString(),end:Ae.toString()},Ie="/api/v1/series",ke=this;return this.datasource.metadataRequest(Ie,De).then(dt=>(0,n.map)(dt.data.data,Pt=>({text:ke.datasource.getOriginalMetricName(Pt),expandable:!0})))}}function H(Pe){return Pe&&Pe.split(" ").join("")!=="{}"}const se=20;function ne(Pe,he,be){const Ae=[],De=be?.languageProvider?.metricsMetadata;if(Pe.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))Ae.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Pe}}});else if(De&&ee(Pe)){const ke=oe(Pe),{nameMetric:dt}=J(ke,"histogram",De,!1);if(dt){const pt="Selected metric is a native histogram.";Ae.push({type:"HISTOGRAM_AVG",label:pt,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:Pe}}},{type:"HISTOGRAM_COUNT",label:pt,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:Pe}}},{type:"HISTOGRAM_SUM",label:pt,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:Pe}}},{type:"HISTOGRAM_FRACTION",label:pt,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:Pe}}},{type:"HISTOGRAM_STDDEV",label:pt,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:Pe}}},{type:"HISTOGRAM_STDVAR",label:pt,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:Pe}}})}}if(Pe.indexOf("rate(")===-1&&Pe.indexOf("increase(")===-1){const ke=Pe.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let dt=ke?ke[1]:"",Pt=!1;if(De){const pt=oe(Pe),Tt=J(pt,"counter",De,Pt);dt=Tt.nameMetric,Pt=Tt.certain}if(dt){const pt=ee(Pe);let jt=`Selected metric ${Pt?"is":"looks like"} a counter.`,$t;pt?$t={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:Pe}}:jt=`${jt} Consider calculating rate of counter by adding rate().`,Ae.push({type:"APPLY_RATE",label:jt,fix:$t})}}if(be&&be.ruleMappings){const ke=_(Pe,be.ruleMappings);Ae.push(...ke)}return he&&he.length>=se&&Pe.trim().match(/^\w+$/)&&Ae.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:Pe,preventSubmit:!0}}}),Ae}function le(Pe){const he=[];return Pe.lookupsDisabled&&he.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),he}function _(Pe,he){const be=[],Ae=Object.keys(he).reduce((De,Ie)=>{if(Pe.search(Ie)===-1)return De;if(he[Ie].length>1){const{idx:ke,expandedQuery:dt,identifier:Pt,identifierValue:pt}=Q(Pe,Ie,he[Ie]);return ke===-1?(be.push({type:"EXPAND_RULES_WARNING",label:"We found multiple recording rules that match in this query. To expand the recording rule, add an identifier label/value."}),De):{...De,[Ie]:{expandedQuery:dt,identifier:Pt,identifierValue:pt}}}else return{...De,[Ie]:{expandedQuery:he[Ie][0].query}}},{});return(0,n.size)(Ae)>0&&be.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:Pe,options:Ae}}}),be}function Q(Pe,he,be){const{query:Ae}=(0,U.u)(Pe),De=ae(he,Ae);if(De.length===0)return{idx:-1,identifier:"",identifierValue:"",expandedQuery:""};let Ie="",ke="",dt=-1;return De.forEach(Pt=>{dt===-1&&Pt.label.search("uuid")!==-1&&(Ie=Pt.label,ke=Pt.value)}),be.forEach((Pt,pt)=>{Pt.labels&&Object.entries(Pt.labels).forEach(([Tt,jt])=>{dt===-1&&Tt===Ie&&jt===ke&&(dt=pt)})}),{idx:dt,identifier:Ie,identifierValue:ke,expandedQuery:be[dt]?.query??""}}function ae(Pe,he){if(he.metric===Pe)return he.labels;if(he.binaryQueries)for(let be=0;be<he.binaryQueries.length;be++){const Ae=ae(Pe,he.binaryQueries[be].query);if(Ae&&Ae.length>0)return Ae}return[]}function oe(Pe){return Array.from(Pe.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([he])=>he).filter(he=>!he.startsWith("$")).flatMap(he=>he.split(":"))}function J(Pe,he,be,Ae){return{nameMetric:Pe.find(Ie=>{const ke=be[Ie];return ke&&ke.type.toLowerCase()===he?(Ae=!0,!0):!1})??"",certain:Ae}}function ee(Pe){return Pe.trim().match(/^\w+$|^\w+{.*}$/)}var de=e(33115),xe=e(59809),re=e(14110);function ue(Pe,he,be){const{app:Ae,targets:De}=he;if(Ae===m.Jk.Explore)for(const Ie of De)(0,re.rR)("grafana_prometheus_query_executed",{app:Ae,grafana_version:h.$.buildInfo.version,has_data:Pe.data.some(ke=>ke.length>0),has_error:Pe.error!==void 0,expr:Ie.expr,format:Ie.format,instant:Ie.instant,range:Ie.range,exemplar:Ie.exemplar,hinting:Ie.hinting,interval:Ie.interval,intervalFactor:Ie.intervalFactor,utcOffsetSec:Ie.utcOffsetSec,legend:Ie.legendFormat,valueWithRefId:Ie.valueWithRefId,requestId:he.requestId,showingGraph:Ie.showingGraph,showingTable:Ie.showingTable,editor_mode:Ie.editorMode,simultaneously_sent_query_count:De.length,time_range_from:he?.range?.from?.toISOString(),time_range_to:he?.range?.to?.toISOString(),time_taken:Date.now()-be.getTime()})}var Te=e(62467),ge=e(65474),Oe=e(29505),Ue=e(96540),Xe=e(39268),we=e(14186),qe=e(90182),We=e(21744),Ce=e(29993);const je=[{label:"Label names",value:w.B4.LabelNames},{label:"Label values",value:w.B4.LabelValues},{label:"Metrics",value:w.B4.MetricNames},{label:"Query result",value:w.B4.VarQueryResult},{label:"Series query",value:w.B4.SeriesQuery},{label:"Classic query",value:w.B4.ClassicQuery}],Ke="PrometheusVariableQueryEditor-VariableQuery",_e=({onChange:Pe,query:he,datasource:be,range:Ae})=>{const[De,Ie]=(0,Ue.useState)(void 0),[ke,dt]=(0,Ue.useState)(""),[Pt,pt]=(0,Ue.useState)(""),[Tt,jt]=(0,Ue.useState)(""),[$t,sn]=(0,Ue.useState)(""),[Yt,qt]=(0,Ue.useState)(""),[bn,Mt]=(0,Ue.useState)(""),[Jt,Ut]=(0,Ue.useState)([]),[Gt,Lt]=(0,Ue.useState)([]);(0,Ue.useEffect)(()=>{be.languageProvider.start(Ae)},[]),(0,Ue.useEffect)(()=>{if(he)if(he.qryType===w.B4.ClassicQuery)Ie(he.qryType),Mt(he.query??"");else{const Ve=Fe(he);pt(Ve.match??""),Ie(Ve.qryType),dt(Ve.label??""),jt(Ve.metric??""),Lt(Ve.labelFilters??[]),sn(Ve.varQuery??""),qt(Ve.seriesQuery??""),Mt(Ve.classicQuery??"")}},[he]),(0,Ue.useEffect)(()=>{if(De!==w.B4.LabelValues)return;const Ve=be.getVariables().map(lt=>({label:lt,value:lt}));if(!Tt)be.getTagKeys({filters:[]}).then(lt=>{const It=lt.map(({text:Qe})=>({label:Qe,value:Qe}));Ut([...Ve,...It])});else{const lt=[{label:"__name__",op:"=",value:Tt}],It=F.z.renderLabels(lt);be.languageProvider.fetchLabelsWithMatch(It).then(Qe=>{const Ot=Object.keys(Qe).map(zt=>({label:zt,value:zt}));Ut([...Ve,...Ot])})}},[be,De,Tt]);const At=(Ve,lt)=>{const vt={...{qryType:De,label:ke,metric:Tt,match:Pt,varQuery:$t,seriesQuery:Yt,classicQuery:bn,refId:"PrometheusVariableQueryEditor-VariableQuery"},...Ve,...lt?{labelFilters:lt}:{labelFilters:Gt}},Ot=q(vt);Pe({query:Ot,qryType:vt.qryType,refId:Ke})},Nt=Ve=>{Ie(Ve.value),Ve.value!==w.B4.SeriesQuery&&At({qryType:Ve.value??0})},Dn=Ve=>{const lt=Ve&&Ve.value?Ve.value:"";dt(lt),De===w.B4.LabelValues&&lt&&At({label:lt})},An=Ve=>{jt(Ve.metric),Lt(Ve.labels);const lt=Ve.metric,It=Ve.labels??[];De===w.B4.LabelValues&&ke&&(lt||It)&&At({qryType:De,metric:lt},It)},Pn=Ve=>{De===w.B4.LabelNames&&At({qryType:De,match:Ve})},Xn=Ve=>{De===w.B4.MetricNames&&Ve&&At({metric:Ve})},Tn=Ve=>{sn(Ve.currentTarget.value)},ht=Ve=>{qt(Ve.currentTarget.value)},St=Ve=>{Mt(Ve.currentTarget.value)},Ge=(0,Ue.useCallback)(()=>({metric:Tt,labels:Gt,operations:[]}),[Tt,Gt]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Query type",labelWidth:20,tooltip:(0,b.jsx)("div",{children:"The Prometheus data source plugin provides the following query types for template variables."}),children:(0,b.jsx)(qe.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:Nt,value:De,options:je,width:25,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType})})}),De===w.B4.LabelValues&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:(0,b.jsx)("div",{children:"Returns a list of label values for the label name in all metrics unless the metric is specified."}),children:(0,b.jsx)(qe.l6,{"aria-label":"label-select",onChange:Dn,value:ke,options:Jt,width:25,allowCustomValue:!0,isClearable:!0,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect})})}),(0,b.jsx)(Ce.I,{query:Ge(),datasource:be,onChange:An,variableEditor:!0})]}),De===w.B4.LabelNames&&(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:(0,b.jsx)("div",{children:"Returns a list of label names, optionally filtering by specified metric regex."}),children:(0,b.jsx)(S.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:Pt,onBlur:Ve=>{pt(Ve.currentTarget.value),Pn(Ve.currentTarget.value)},onChange:Ve=>{pt(Ve.currentTarget.value)},width:25,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex})})}),De===w.B4.MetricNames&&(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:(0,b.jsx)("div",{children:"Returns a list of metrics matching the specified metric regex."}),children:(0,b.jsx)(S.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:Tt,onChange:Ve=>{jt(Ve.currentTarget.value)},onBlur:Ve=>{jt(Ve.currentTarget.value),Xn(Ve.currentTarget.value)},width:25,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex})})}),De===w.B4.VarQueryResult&&(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Query",labelWidth:20,tooltip:(0,b.jsx)("div",{children:"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines)."}),children:(0,b.jsx)(We.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:$t,onChange:Tn,onBlur:()=>{De===w.B4.VarQueryResult&&$t&&At({qryType:De})},cols:100,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult})})}),De===w.B4.SeriesQuery&&(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Series Query",labelWidth:20,tooltip:(0,b.jsx)("div",{children:'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.'}),children:(0,b.jsx)(S.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:Yt,onChange:ht,onBlur:()=>{De===w.B4.SeriesQuery&&Yt&&At({qryType:De})},width:100,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery})})}),De===w.B4.ClassicQuery&&(0,b.jsx)(Xe.C,{children:(0,b.jsx)(we.I,{label:"Classic Query",labelWidth:20,tooltip:(0,b.jsx)("div",{children:"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric)."}),children:(0,b.jsx)(S.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:bn,onChange:St,onBlur:()=>{De===w.B4.ClassicQuery&&bn&&At({qryType:De})},width:100,"data-testid":D.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery})})})]})};function Fe(Pe){return typeof Pe=="string"?X(Pe):Pe.query?X(Pe.query):Pe}class at extends Oe.f5{constructor(he,be=(0,x.w)()){super(),this.datasource=he,this.templateSrv=be,this.editor=_e}query(he){let be;if(typeof he.targets[0]=="string"?be=he.targets[0]:be=he.targets[0].query,!be)return(0,Te.of)({data:[]});const Ae={...he.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:d.intervalToMs(this.datasource.interval),value:d.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(he.range)},De=this.templateSrv.replace(be,Ae,this.datasource.interpolateQueryExpr),Ie=new te(this.datasource,De);return(0,ge.H)(Ie.process(he.range)).pipe((0,r.T)(dt=>({data:dt})))}}const Ct="60s",Dt=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels"],tt="-Instant";class ze extends v.iy{constructor(he,be=(0,x.w)(),Ae){super(he),this.templateSrv=be,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(De,Ie)=>{const ke=(0,f.bE)({data:Ie}).data;if(!ke||!ke.length)return[];const dt=De.annotation,{tagKeys:Pt="",titleFormat:pt="",textFormat:Tt=""}=dt,jt=d.intervalToSeconds(dt.step||Ct)*1e3,$t=Pt.split(","),sn=[];for(const Yt of ke){if(Yt.fields.length===0)continue;const qt=Yt.fields[0],bn=Yt.fields[1],Mt=bn?.labels||{},Jt=Object.keys(Mt).filter(Dn=>$t.includes(Dn)).map(Dn=>Mt[Dn]),Ut=[];let Gt=0;bn.values.forEach(Dn=>{let An,Pn;const Xn=qt.values[Gt];De.annotation.useValueForTime?(An=Math.floor(parseFloat(Dn)),Pn=1):(An=Math.floor(parseFloat(Xn)),Pn=parseFloat(Dn)),Gt++,Ut.push([An,Pn])});const At=Ut.filter(Dn=>Dn[1]>0).map(Dn=>Dn[0]);let Nt=null;for(const Dn of At){if(Nt&&(Nt.timeEnd??0)+jt>=Dn){Nt.timeEnd=Dn;continue}Nt&&sn.push(Nt),Nt={time:Dn,timeEnd:Dn,annotation:dt,title:(0,c.j)(pt,Mt),tags:Jt,text:(0,c.j)(Tt,Mt)}}Nt&&(Nt.timeEnd=At[At.length-1],sn.push(Nt))}return sn},this.type="prometheus",this.id=he.id,this.url=he.url,this.access=he.access,this.basicAuth=he.basicAuth,this.withCredentials=!!he.withCredentials,this.interval=he.jsonData.timeInterval||"15s",this.queryTimeout=he.jsonData.queryTimeout,this.httpMethod=he.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=he.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=he.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=Ae??new j.Ay(this),this.lookupsDisabled=he.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(he.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=he.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=he.jsonData.prometheusVersion,this.defaultEditor=he.jsonData.defaultEditor,this.disableRecordingRules=he.jsonData.disableRecordingRules??!1,this.variables=new at(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=he.jsonData.cacheLevel??w.fD.Low,this.metricNamesAutocompleteSuggestionLimit=he.jsonData.codeModeMetricNamesSuggestionLimit??j.OP,this.cache=new de.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:he.jsonData.incrementalQueryOverlapWindow??de.Dr}),this.annotations={QueryEditor:O}}getQueryDisplayText(he){return he.expr}getPrometheusTargetSignature(he,be){return`${this.interpolateString(be.expr)}|${be.interval??he.interval}|${JSON.stringify(he.rangeRaw??"")}|${be.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",w.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",w.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",w.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",w.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(he,be){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:be!==this.datasourceConfigurationPrometheusFlavor?!1:o().gte(this.datasourceConfigurationPrometheusVersion,he)}_addTracingHeaders(he,be){he.headers={},this.access==="proxy"&&(he.headers["X-Dashboard-UID"]=be.dashboardUID,he.headers["X-Panel-Id"]=be.panelId)}directAccessError(){return(0,s.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(he,be,Ae={}){if(this.access==="direct")return this.directAccessError();be=be||{};for(const[ke,dt]of this.customQueryParameters)be[ke]==null&&(be[ke]=dt);let De=this.url+he;he.startsWith(`/api/datasources/uid/${this.uid}`)&&(De=he);const Ie=(0,n.defaults)(Ae,{url:De,method:this.httpMethod,headers:{}});return Ie.method==="GET"?be&&Object.keys(be).length&&(Ie.url=Ie.url+(Ie.url.search(/\?/)>=0?"&":"?")+Object.entries(be).map(([ke,dt])=>`${encodeURIComponent(ke)}=${encodeURIComponent(dt)}`).join("&")):(Ie.headers["Content-Type"]="application/x-www-form-urlencoded",Ie.data=be),(this.basicAuth||this.withCredentials)&&(Ie.withCredentials=!0),this.basicAuth&&(Ie.headers.Authorization=this.basicAuth),(0,E.AI)().fetch(Ie)}async importFromAbstractQueries(he){return he.map(be=>this.languageProvider.importFromAbstractQuery(be))}async exportToAbstractQueries(he){return he.map(be=>this.languageProvider.exportToAbstractQuery(be))}async metadataRequest(he,be={},Ae){if(Dt.some(De=>he.includes(De)))try{return await(0,l.s)(this._request(`/api/datasources/uid/${this.uid}/resources${he}`,be,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...Ae}))}catch(De){if(this.httpMethod==="POST"&&(0,E.NF)(De)&&(De.status===405||De.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw De}return await(0,l.s)(this._request(`/api/datasources/uid/${this.uid}/resources${he}`,be,{method:"GET",hideFromInspector:!0,...Ae}))}interpolateQueryExpr(he=[],be){if(!be.multi&&!be.includeAll)return fe(he);if(typeof he=="string")return Ee(he);const Ae=he.map(De=>Ee(De));return Ae.length===1?Ae[0]:"("+Ae.join("|")+")"}targetContainsTemplate(he){return this.templateSrv.containsTemplate(he.expr)}shouldRunExemplarQuery(he,be){if(he.exemplar){const Ae=this.languageProvider.histogramMetrics.find(ke=>he.expr.includes(ke)),De=be.targets.findIndex(ke=>ke.refId===he.refId),Ie=be.targets.slice(0,De).filter(ke=>!ke.hide);return!!(!Ae||Ae&&!Ie.some(ke=>ke.expr.includes(Ae)))}return!1}processTargetV2(he,be){const Ae=[],De={...he,exemplar:this.shouldRunExemplarQuery(he,be),requestId:be.panelId+he.refId,utcOffsetSec:be.range.to.utcOffset()*60};return h.$.featureToggles.promQLScope&&(De.scopes=(be.scopes??[]).map(Ie=>({name:Ie.metadata.name,...Ie.spec}))),h.$.featureToggles.groupByVariable&&(De.groupByKeys=be.groupByKeys),he.instant&&he.range?Ae.push({...De,refId:De.refId,instant:!1},{...De,refId:De.refId+tt,range:!1}):Ae.push(De),Ae}query(he){if(this.access==="direct")return this.directAccessError();let be,Ae;const De=he.targets.some(dt=>dt.instant);this.hasIncrementalQuery&&!De?(Ae=this.cache.requestInfo(he),be=Ae.requests[0]):be=he;const Ie=be.targets.map(dt=>this.processTargetV2(dt,be)),ke=new Date;return super.query({...be,targets:Ie.flat()}).pipe((0,r.T)(dt=>{const Pt={...dt,data:this.cache.procFrames(he,Ae,dt.data)};return(0,xe.J3)(Pt,he,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,i.M)(dt=>{ue(dt,he,ke)}))}metricFindQuery(he,be){if(!he)return Promise.resolve([]);const Ae={__interval:{text:this.interval,value:this.interval},__interval_ms:{text:d.intervalToMs(this.interval),value:d.intervalToMs(this.interval)},...this.getRangeScopedVars(be?.range??(0,a.E2)())},De=this.templateSrv.replace(he,Ae,this.interpolateQueryExpr);return new te(this,De).process(be?.range??(0,a.E2)())}getRangeScopedVars(he){const be=he.to.diff(he.from),Ae=Math.round(be/1e3);return{__range_ms:{text:be,value:be},__range_s:{text:Ae,value:Ae},__range:{text:Ae+"s",value:Ae+"s"}}}async annotationQuery(he){if(this.access==="direct"){const ke=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(ke)}const be=he.annotation,{expr:Ae=""}=be;if(!Ae)return Promise.resolve([]);const De=he.annotation.step||Ct,Ie={expr:Ae,range:!0,instant:!1,exemplar:!1,interval:De,refId:"X",datasource:this.getRef()};return await(0,l.s)((0,E.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,N.mv)(he.range.from,!1)*1e3).toString(),to:((0,N.mv)(he.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(Ie,{})]},requestId:`prom-query-${be.name}`}).pipe((0,r.T)(ke=>this.processAnnotationResponse(he,ke.data))))}async getTagKeys(he){if(!he||he.filters.length===0)return await this.languageProvider.fetchLabels(he.timeRange,he.queries),this.languageProvider.getLabelKeys().map(Ie=>({value:Ie,text:Ie}));const be=he.filters.map(Ie=>({label:Ie.key,value:Ie.value,op:Ie.operator})),Ae=F.z.renderLabels(be);let De=await this.languageProvider.fetchLabelsWithMatch(Ae);return Object.keys(De).filter(Ie=>!he.filters.find(ke=>ke.key===Ie)).map(Ie=>({value:Ie,text:Ie}))}async getTagValues(he){const be=he.filters.map(ke=>({label:ke.key,value:ke.value,op:ke.operator})),Ae=F.z.renderLabels(be);if(this.hasLabelsMatchAPISupport()){const ke=`[${this.uid}][${he.key}]`;return(await this.languageProvider.fetchSeriesValuesWithMatch(he.key,Ae,ke,he.timeRange)).map(dt=>({value:dt,text:dt}))}const De=this.getTimeRangeParams(he.timeRange??(0,a.E2)());return(await this.metadataRequest(`/api/v1/label/${he.key}/values`,De))?.data?.data?.map(ke=>({text:ke}))??[]}interpolateVariablesInQueries(he,be,Ae){let De=he;return he&&he.length&&(De=he.map(Ie=>{const ke=this.templateSrv.replace(Ie.expr,be,this.interpolateQueryExpr),dt=h.$.featureToggles.promQLScope?ke:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ae,ke),be,this.interpolateQueryExpr);return{...Ie,...h.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ae)}:{},datasource:this.getRef(),expr:dt,interval:this.templateSrv.replace(Ie.interval,be)}})),De}getQueryHints(he,be){return ne(he.expr??"",be,this)}getInitHints(){return le(this)}async loadRules(){try{const be=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;be&&(this.ruleMappings=Se(be))}catch(he){console.log("Rules API is experimental. Ignore next error."),console.error(he)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,p.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,p.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(he,be){let Ae=he.expr??"";switch(be.type){case"ADD_FILTER":{const{key:De,value:Ie}=be.options??{};De&&Ie&&(Ae=(0,y.t)(Ae,De,Ie));break}case"ADD_FILTER_OUT":{const{key:De,value:Ie}=be.options??{};De&&Ie&&(Ae=(0,y.t)(Ae,De,Ie,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{Ae=`histogram_quantile(0.95, sum(rate(${Ae}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{Ae=`histogram_avg(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{Ae=`histogram_fraction(0,0.2,rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{Ae=`histogram_count(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{Ae=`histogram_sum(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{Ae=`histogram_stddev(rate(${Ae}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{Ae=`histogram_stdvar(rate(${Ae}[$__rate_interval]))`;break}case"ADD_RATE":{Ae=`rate(${Ae}[$__rate_interval])`;break}case"ADD_SUM":{Ae=`sum(${Ae.trim()}) by ($1)`;break}case"EXPAND_RULES":{be.options&&(Ae=(0,N.P_)(Ae,be.options));break}default:break}return{...he,expr:Ae}}getAdjustedInterval(he){return(0,N.Xd)(this.cacheLevel,he)}getTimeRangeParams(he){return{start:(0,N.mv)(he.from,!1).toString(),end:(0,N.mv)(he.to,!0).toString()}}getOriginalMetricName(he){return(0,xe.hF)(he)}generateScopeFilters(he){return he?he.map(be=>({...be,value:this.templateSrv.replace(be.value,{},this.interpolateQueryExpr),operator:u.n[be.operator]})):[]}enhanceExprWithAdHocFilters(he,be){return!he||he.length===0?be:he.reduce((De,Ie)=>{const{key:ke,operator:dt}=Ie;let{value:Pt}=Ie;return(dt==="=~"||dt==="!~")&&(Pt=fe(Pt)),(0,y.t)(De,ke,Pt,dt)},be)}filterQuery(he){return!(he.hide||!he.expr)}applyTemplateVariables(he,be,Ae){const De={...be};De.__interval={value:"$__interval"},De.__interval_ms={value:"$__interval_ms"};const Ie=this.templateSrv.replace(he.expr,De,this.interpolateQueryExpr),ke=h.$.featureToggles.promQLScope?Ie:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ae,Ie),De,this.interpolateQueryExpr);return{...he,...h.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ae)}:{},expr:ke,interval:this.templateSrv.replace(he.interval,De),legendFormat:this.templateSrv.replace(he.legendFormat,De)}}getVariables(){return this.templateSrv.getVariables().map(he=>`$${he.name}`)}interpolateString(he,be){return this.templateSrv.replace(he,be,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case w.fD.Medium:return 600;case w.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case w.fD.Medium:return 7;case w.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,N.u3)(this.cacheLevel)}getDefaultQuery(he){const be={refId:"A",expr:"",range:!0,instant:!1};return he===m.Jk.UnifiedAlerting?{...be,instant:!0,range:!1}:he===m.Jk.Explore?{...be,instant:!0,range:!0}:be}}function pe(Pe,he,be,Ae){const De=Math.floor((he+Ae)/be)*be-Ae,Ie=Math.floor((Pe+Ae)/be)*be-Ae;return{end:De,start:Ie}}function Se(Pe){return Pe.reduce((he,be)=>be.rules.filter(Ae=>Ae.type==="recording").reduce((Ae,De)=>{const Ie=Ae[De.name]??[];return Ie.push({query:De.query,labels:De.labels}),Ae[De.name]=Ie,Ae},he),{})}function fe(Pe){return typeof Pe=="string"?Pe.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):Pe}function Ee(Pe){return typeof Pe=="string"?Pe.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):Pe}},50556:(k,A,e)=>{"use strict";e.d(A,{AU:()=>h,Ay:()=>D,OP:()=>v,pK:()=>E,xB:()=>f});var n=e(2543),s=e.n(n),l=e(28848),r=e.n(l),i=e(40187),g=e(43127),o=e(73372),d=e(81996),c=e(20719),a=e(76040),p=e(62183);const u=["job","instance"],m="{}",v=1e4,x=M=>({headers:{"X-Grafana-Cache":`private, max-age=${M}`}});function f(M,I){if(!I[M])return;const{type:R,help:T}=I[M];return`${R.toUpperCase()}: ${T}`}function E(M,I){if(I[M])return I[M].help}function h(M,I){if(I[M])return I[M].type}const y=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,b=86400;class D extends i.Is{constructor(I,R){super(),this.labelKeys=[],this.request=async(T,S,L={},O)=>{try{return(await this.datasource.metadataRequest(T,L,O)).data.data}catch(j){C(j)||console.error(j)}return S},this.start=async T=>(this.timeRange=T??(0,g.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,d.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async T=>{const S=this.datasource.getAdjustedInterval(this.timeRange),O=`/api/v1/label/${this.datasource.interpolateString(T)}/values`;return await this.request(O,[],S,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(T,S)=>{T&&(this.timeRange=T);let L="/api/v1/labels";const O=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const j=new URLSearchParams({...O});S?.forEach(F=>{const U=(0,a.u)(F.expr);U.query.metric!==""&&(j.append("match[]",U.query.metric),U.query.binaryQueries&&U.query.binaryQueries.forEach(w=>{j.append("match[]",w.query.metric)}))}),this.datasource.httpMethod==="GET"&&(L+=`?${j.toString()}`);const N=await this.request(L,[],j,this.getDefaultCacheHeaders());return Array.isArray(N)&&(this.labelKeys=N.slice().sort()),[]},this.getSeriesValues=async(T,S)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(T,S):(await this.getSeries(S))[T]??[],this.fetchSeriesValuesWithMatch=async(T,S,L,O=this.timeRange)=>{const j=T?this.datasource.interpolateString(T):null,N=S?this.datasource.interpolateString(S):null,U={...this.datasource.getAdjustedInterval(O),...N&&{"match[]":N}};let w={...this.getDefaultCacheHeaders(),...L&&{requestId:L}};return Object.keys(w).length||(w=void 0),await this.request(`/api/v1/label/${j}/values`,[],U,w)??[]},this.getSeriesLabels=async(T,S)=>{let L,O;this.datasource.hasLabelsMatchAPISupport()?(S.push({name:"__name__",value:"",op:"!="}),O=await this.fetchSeriesLabelsMatch(T),L=Object.keys(O)):(O=await this.getSeries(T),L=Object.keys(O));const j=new Set(S.map(N=>N.name));return L.filter(N=>!j.has(N))},this.fetchLabelsWithMatch=async(T,S)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(T,S):this.fetchSeriesLabels(T,S),this.fetchSeriesLabels=async(T,S)=>{const L=this.datasource.interpolateString(T),j={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":L},F=await this.request("/api/v1/series",[],j,this.getDefaultCacheHeaders()),{values:U}=(0,d.P7)(F,S);return U},this.fetchSeriesLabelsMatch=async(T,S)=>{const L=this.datasource.interpolateString(T),j={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":L};return(await this.request("/api/v1/labels",[],j,this.getDefaultCacheHeaders())).reduce((U,w)=>({...U,[w]:""}),{})},this.fetchSeries=async T=>{const S="/api/v1/series",O={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":T};return await this.request(S,{},O,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,n.once)(async()=>{const T=await Promise.all(u.map(S=>this.fetchLabelValues(S)));return u.reduce((S,L,O)=>({...S,[L]:T[O]}),{})}),this.datasource=I,this.histogramMetrics=[],this.timeRange=(0,g.E2)(),this.metrics=[],Object.assign(this,R)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==p.fD.None)return x(this.datasource.getCacheDurationInMinutes()*60)}cleanText(I){return I.split(y).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return c.Ay}async loadMetricsMetadata(){const I=x(this.datasource.getDaysToCacheMetadata()*b);this.metricsMetadata=(0,d.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...I}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(I){return(0,d.pt)(I)}exportToAbstractQuery(I){const R=I.expr;if(!R||R.length===0)return{refId:I.refId,labelMatchers:[]};const T=r().tokenize(R,c.Ay),S=(0,d.VH)(T),L=P(R,T);return L&&L.length>0&&S.push({name:"__name__",operator:o.D_.Equal,value:L}),{refId:I.refId,labelMatchers:S}}async getSeries(I,R){if(this.datasource.lookupsDisabled)return{};try{return I===m?await this.fetchDefaultSeries():await this.fetchSeriesLabels(I,R)}catch(T){return console.error(T),{}}}async getLabelValues(I){return await this.fetchLabelValues(I)}}function P(M,I){let R="";for(const T of I)if(typeof T=="string"){R=T;break}return R}function C(M){return typeof M=="object"&&M!==null&&"cancelled"in M&&M.cancelled===!0}},81996:(k,A,e)=>{"use strict";e.d(A,{Cs:()=>S,DX:()=>y,P7:()=>m,P_:()=>E,Qn:()=>T,Rg:()=>u,VH:()=>U,Xd:()=>w,eN:()=>b,ky:()=>W,mv:()=>K,pt:()=>N,u3:()=>B});var n=e(2543),s=e.n(n),l=e(28848),r=e.n(l),i=e(73372),g=e(77678),o=e(85858),d=e(80937),c=e(50556),a=e(9103),p=e(62183);const u=z=>{const Y=new Set,X=new RegExp("_bucket($|:)");for(let q=0;q<z.length;q++){const G=z[q];X.test(G)&&Y.add(G)}return[...Y]};function m(z,Y=!1){const X={};z.forEach(G=>{const{__name__:te,...H}=G;Y&&(X.__name__=X.__name__||new Set,X.__name__.has(te)||X.__name__.add(te)),Object.keys(H).forEach(se=>{X[se]||(X[se]=new Set),X[se].has(H[se])||X[se].add(H[se])})});const q={};return C(Object.keys(X)).forEach(G=>{q[G]=C(Array.from(X[G]))}),{values:q,keys:Object.keys(q)}}const v=/\{[^}]*?(\}|$)/,x=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function f(z,Y=1){if(!z.match(v)){if(z.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${z}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+z)}const X=z.slice(0,Y),q=X.lastIndexOf("{"),G=X.lastIndexOf("}");if(q===-1)throw new Error("Not inside selector, missing open brace: "+X);if(G>-1&&G>q)throw new Error("Not inside selector, previous selector already closed: "+X);const te=z.slice(Y),se=te.indexOf("}")+Y,ne=te.indexOf("{"),le=ne+Y;if(se===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+te);if(ne>-1&&le<se)throw new Error("Not inside selector, next selector opens before this one closed: "+te);const _=z.slice(q,se),Q={};_.replace(x,(xe,re,ue,Te)=>{const ge=z.indexOf(xe),Oe=ge+re.length+ue.length+1,Ue=ge+re.length+ue.length+Te.length-1;return(Y<Oe||Y>Ue)&&(Q[re]={value:Te,operator:ue}),""});const oe=z.slice(0,q).match(/[A-Za-z:][\w:]*$/);oe&&(Q.__name__={value:`"${oe[0]}"`,operator:"="});const J=Object.keys(Q).sort(),de=["{",J.map(xe=>`${xe}${Q[xe].operator}${Q[xe].value}`).join(","),"}"].join("");return{labelKeys:J,selector:de}}function E(z,Y){const X=H=>new RegExp(`(\\s|\\(|^)(${H})(\\s|$|\\(|\\[|\\{)`,"ig"),q=Object.keys(Y).reduce((H,se)=>{let ne=[],le=[],_=[];return H.filter(Boolean).forEach((Q,ae)=>{Q.match(X(se))&&(ne=Q.split(se),ne.length===2?(_.push(ae),le.push(...[ne[0],se,ne[1]].filter(Boolean))):ne.length>2&&(_.push(ae),ne=ne.map(J=>J===""?se:J),le.push(...ne)))}),_.forEach(Q=>H[Q]=""),H=H.filter(Boolean),H.push(...le),H},[z]);let G=!1;return q.map((H,se)=>{if(G)return G=!1,"";if(Y[H]){const{expandedQuery:ne,identifierValue:le,identifier:_}=Y[H];if(se+1!==q.length&&q[se+1].match(x)){G=!0;const Q=new RegExp(`(,)?(\\s)?(${_}=\\"${le}\\")(,)?(\\s)?`,"g"),ae=q[se+1].replace(Q,""),oe=/(\)\{|\}\{|\]\{)/;return h(ne+ae,oe)}else return ne}return H}).filter(Boolean).join("")}function h(z,Y){const X=z.match(Y);if(!X)return z;const q=X.index??0,G=z.slice(0,q+1),te=z.slice(q+1),H=[];te.replace(x,(_,Q,ae,oe,J,ee)=>(H.push({key:Q,operator:ae,value:oe,comma:J,space:ee}),""));let se=G;H.filter(Boolean).forEach(_=>{const Q=_.value.slice(1,-1);se=(0,d.t)(se,_.key,Q,_.operator)});let ne=H.reduce((_,Q)=>(_+=`${Q.key}${Q.operator}${Q.value}${Q.comma??""}${Q.space??""}`,_),"");ne="{"+ne+"}";const le=te.replace(ne,"");return se+le}function y(z){if(!z)return z;const Y={},X={};for(const G in z){const te=z[G][0];Y[G]=te,te.type==="histogram"&&(X[`${G}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${te.help})`},X[`${G}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${te.help})`},X[`${G}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${te.help})`}),te.type==="summary"&&(X[`${G}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${te.help})`},X[`${G}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${te.help})`})}const q={};return q.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...Y,...X,...q}}function b(z){return D(z/1e3)}function D(z){return Math.floor(z/60)}function P(z,Y=1){return Math.ceil(z/60)-Math.ceil(z/60)%Y}function C(z){return z.slice(0,c.OP)}function M(z){return z&&z.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const I=/[*+?()|\\.\[\]{}^$]/g;function R(z){return z.replace(I,"\\$&")}function T(z){return z.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function S(z){return T(R(z))}const L={"=":i.D_.Equal,"!=":i.D_.NotEqual,"=~":i.D_.EqualRegEx,"!~":i.D_.NotEqualRegEx},O=(0,n.invert)(L);function j(z){const Y=z.labelMatchers.map(X=>{const q=O[X.operator];return q?`${X.name}${q}"${X.value}"`:""}).filter(X=>X!=="").join(", ");return Y?`{${Y}}`:""}function N(z){return{refId:z.refId,expr:j(z),range:!0}}function F(z){return typeof z.content=="string"?z.content:""}function U(z){const Y=[];for(const X of z)if(X instanceof l.Token&&X.type==="context-labels"){let q="",G="",te="";const H=Array.isArray(X.content)?X.content:[X.content];for(let se of H)if(typeof se=="string"){let ne;ne=se,(ne==="="||ne==="!="||ne==="=~"||ne==="!~")&&(te=ne)}else if(se instanceof l.Token)switch(se.type){case"label-key":q=F(se);break;case"label-value":G=F(se),G=G.substring(1,G.length-1);const ne=L[te];ne&&Y.push({name:q,operator:ne,value:G});break}}return Y}function w(z,Y){if(z===p.fD.None)return{start:K(Y.from,!1).toString(),end:K(Y.to,!0).toString()};const X=K(Y.from,!1),q=(0,g.rs)(X,B(z)*60),G=K(Y.to,!0),te=P(G,B(z))*60;if(q===te){const ne=te+B(z)*60;return{start:q.toString(),end:ne.toString()}}const H=q.toString(),se=te.toString();return{start:H,end:se}}function B(z){switch(z){case p.fD.Medium:return 10;case p.fD.High:return 60;default:return 1}}function K(z,Y){return typeof z=="string"&&(z=o.parse(z,Y)),Math.ceil(z.valueOf()/1e3)}function W(z,Y){return Y===void 0&&(Y=a.o6),z.length=Math.min(z.length,Y),z}},20719:(k,A,e)=>{"use strict";e.d(A,{AW:()=>g,Ay:()=>c,n6:()=>d});const n=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],s=["by","group_left","group_right","ignoring","on","offset","without"],l=null,r=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],g=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...r,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],o=g.map(a=>a.label),d={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${g.map(a=>a.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${s.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},c=d},32370:(k,A,e)=>{"use strict";e.d(A,{l:()=>D,z:()=>P});var n=e(20719),s=e(1220),l=e(75161),r=e(38961),i=e(15145);function g(){return[{id:i.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:i.Ag.Functions,renderer:s.jY,addOperationHandler:s.iZ},o({id:i.jN.HistogramAvg}),o({id:i.jN.HistogramCount}),o({id:i.jN.HistogramSum}),{id:i.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:i.Ag.Functions,renderer:s.jY,addOperationHandler:s.iZ},o({id:i.jN.HistogramStddev}),o({id:i.jN.HistogramStdvar}),{id:i.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:i.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:s.kf,addOperationHandler:s.iZ},{id:i.jN.Ln,name:"Ln",params:[],defaultParams:[],category:i.Ag.Functions,renderer:s.jY,addOperationHandler:s.iZ},d(i.jN.Changes),d(i.jN.Rate,!0),d(i.jN.Irate),d(i.jN.Increase,!0),d(i.jN.Idelta),d(i.jN.Delta),o({id:i.jN.HoltWinters,params:[(0,s.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:s.nU,addOperationHandler:p,changeTypeHandler:c}),o({id:i.jN.PredictLinear,params:[(0,s.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:s.nU,addOperationHandler:p,changeTypeHandler:c}),o({id:i.jN.QuantileOverTime,params:[(0,s.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:i.Ag.RangeFunctions,renderer:s.Kl,addOperationHandler:p,changeTypeHandler:c}),...l.Iu,{id:i.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:i.Ag.BinaryOps,renderer:(M,I,R)=>R,addOperationHandler:u},o({id:i.jN.Abs}),o({id:i.jN.Absent}),o({id:i.jN.Acos,category:i.Ag.Trigonometric}),o({id:i.jN.Acosh,category:i.Ag.Trigonometric}),o({id:i.jN.Asin,category:i.Ag.Trigonometric}),o({id:i.jN.Asinh,category:i.Ag.Trigonometric}),o({id:i.jN.Atan,category:i.Ag.Trigonometric}),o({id:i.jN.Atanh,category:i.Ag.Trigonometric}),o({id:i.jN.Ceil}),o({id:i.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),o({id:i.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),o({id:i.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),o({id:i.jN.Cos,category:i.Ag.Trigonometric}),o({id:i.jN.Cosh,category:i.Ag.Trigonometric}),o({id:i.jN.DayOfMonth,category:i.Ag.Time}),o({id:i.jN.DayOfWeek,category:i.Ag.Time}),o({id:i.jN.DayOfYear,category:i.Ag.Time}),o({id:i.jN.DaysInMonth,category:i.Ag.Time}),o({id:i.jN.Deg}),d(i.jN.Deriv),o({id:i.jN.Exp}),o({id:i.jN.Floor}),o({id:i.jN.Hour}),o({id:i.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:r.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:r.r}],defaultParams:["",",",""],renderer:m,explainHandler:v,addOperationHandler:x}),o({id:i.jN.Log10}),o({id:i.jN.Log2}),o({id:i.jN.Minute}),o({id:i.jN.Month}),o({id:i.jN.Pi,renderer:M=>`${M.id}()`}),o({id:i.jN.Rad}),d(i.jN.Resets),o({id:i.jN.Round,category:i.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),o({id:i.jN.Scalar}),o({id:i.jN.Sgn}),o({id:i.jN.Sin,category:i.Ag.Trigonometric}),o({id:i.jN.Sinh,category:i.Ag.Trigonometric}),o({id:i.jN.Sort}),o({id:i.jN.SortDesc}),o({id:i.jN.Sqrt}),o({id:i.jN.Stddev}),o({id:i.jN.Tan,category:i.Ag.Trigonometric}),o({id:i.jN.Tanh,category:i.Ag.Trigonometric}),o({id:i.jN.Time,renderer:M=>`${M.id}()`}),o({id:i.jN.Timestamp}),o({id:i.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:M=>`${M.id}(${M.params[0]})`}),o({id:i.jN.Year})]}function o(C){return{...C,id:C.id,name:C.name??(0,s.DQ)(C.id),params:C.params??[],defaultParams:C.defaultParams??[],category:C.category??i.Ag.Functions,renderer:C.renderer??(C.params?s.kf:s.jY),addOperationHandler:C.addOperationHandler??s.iZ}}function d(C,M=!1){return{id:C,name:(0,s.DQ)(C),params:[(0,s.z2)(M)],defaultParams:[M?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:i.Ag.RangeFunctions,renderer:a,addOperationHandler:p,changeTypeHandler:c}}function c(C,M){return(C.params[0]==="$__rate_interval"&&M.defaultParams[0]!=="$__rate_interval"||C.params[0]==="$__interval"&&M.defaultParams[0]!=="$__interval")&&(C.params=M.defaultParams),C}function a(C,M,I){let R=(C.params??[])[0]??"5m";return`${M.id}(${I}[${R}])`}function p(C,M,I){const R={id:C.id,params:C.defaultParams};return M.operations.length>0&&I.getOperationDef(M.operations[0].id).addOperationHandler===p?{...M,operations:[R,...M.operations.slice(1)]}:{...M,operations:[R,...M.operations]}}function u(C,M){return{...M,binaryQueries:[...M.binaryQueries??[],{operator:"/",query:M}]}}function m(C,M,I){const R=C.params[0]??"",S=`"${C.params[1]??""}"`;return`${C.id}(${I}, "${R}", ${S}, "${C.params.slice(2).join(S)}")`}function v(C,M){let I=M?.documentation??"no docs";return typeof C.params[1]!="string"&&(I+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),I}function x(C,M){const I={id:C.id,params:C.defaultParams};return{...M,operations:[...M.operations,I]}}function f(){return[...(0,s.G3)(i.jN.Sum),...(0,s.G3)(i.jN.Avg),...(0,s.G3)(i.jN.Min),...(0,s.G3)(i.jN.Max),...(0,s.G3)(i.jN.Count),...(0,s.G3)(i.jN.Group),...(0,s.jC)(i.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,s.jC)(i.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,s.jC)(i.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),...(0,s.jC)(i.jN.Quantile,{params:[{name:"Value",type:"number"}],defaultParams:[1]}),E(i.jN.SumOverTime),E(i.jN.AvgOverTime),E(i.jN.MinOverTime),E(i.jN.MaxOverTime),E(i.jN.CountOverTime),E(i.jN.LastOverTime),E(i.jN.PresentOverTime),E(i.jN.AbsentOverTime),E(i.jN.StddevOverTime)]}function E(C){return{id:C,name:(0,s.DQ)(C),params:[(0,s.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:i.Ag.RangeFunctions,renderer:h,addOperationHandler:p}}function h(C,M,I){let R=(C.params??[])[0]??"$__interval";return`${M.id}(${I}[${R}])`}var y=e(83077);class b{constructor(M){this.categories=[],this.operationsRegistry=new y.O(M)}setOperationCategories(M){this.categories=M}getOperationsForCategory(M){return this.operationsRegistry.list().filter(I=>I.category===M&&!I.hideFromList)}getAlternativeOperations(M){return this.operationsRegistry.list().filter(I=>I.alternativesKey&&I.alternativesKey===M)}getCategories(){return this.categories}getOperationDef(M){return this.operationsRegistry.getIfExists(M)}renderOperations(M,I){for(const R of I){const T=this.operationsRegistry.getIfExists(R.id);if(!T)throw new Error(`Could not find operation ${R.id} in the registry`);M=T.renderer(R,T,M)}return M}renderBinaryQueries(M,I){if(I)for(const R of I)M=`${this.renderBinaryQuery(M,R)}`;return M}renderBinaryQuery(M,I){let R=M+` ${I.operator} `;return I.vectorMatches&&(R+=`${I.vectorMatchesType}(${I.vectorMatches}) `),R+this.renderQuery(I.query,!0)}renderLabels(M){if(M.length===0)return"";let I="{";for(const R of M)I!=="{"&&(I+=", "),I+=`${R.label}${R.op}"${R.value}"`;return I+"}"}renderQuery(M,I){let R=`${M.metric??""}${this.renderLabels(M.labels)}`;return R=this.renderOperations(R,M.operations),!I&&this.hasBinaryOp(M)&&M.binaryQueries?.length&&(R=`(${R})`),R=this.renderBinaryQueries(R,M.binaryQueries),I&&(this.hasBinaryOp(M)||M.binaryQueries?.length)&&(R=`(${R})`),R}hasBinaryOp(M){return M.operations.find(I=>this.getOperationDef(I.id)?.category===i.Ag.BinaryOps)!==void 0}}class D extends b{constructor(){super(()=>{const M=[...g(),...f()];for(const I of M){const R=n.AW.find(T=>T.insertText===I.id);R&&(I.documentation=R.documentation)}return M}),this.setOperationCategories([i.Ag.Aggregations,i.Ag.RangeFunctions,i.Ag.Functions,i.Ag.BinaryOps,i.Ag.Trigonometric,i.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:i.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:i.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:i.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:i.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:i.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const P=new D},75161:(k,A,e)=>{"use strict";e.d(A,{AE:()=>r,C8:()=>l,Iu:()=>i});var n=e(1220),s=e(15145);const l=[{id:s.jN.Addition,name:"Add scalar",sign:"+"},{id:s.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:s.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:s.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:s.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:s.jN.Exponent,name:"Exponent",sign:"^"},{id:s.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:s.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:s.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:s.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:s.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:s.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],r=l.reduce((o,d)=>(o[d.sign]={id:d.id,comparison:d.comparison},o),{}),i=l.map(o=>{const d=[{name:"Value",type:"number"}];let c=[2];return o.comparison&&(d.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),c=[2,!1]),{id:o.id,name:o.name,params:d,defaultParams:c,alternativesKey:"binary scalar operations",category:s.Ag.BinaryOps,renderer:g(o.sign),addOperationHandler:n.iZ}});function g(o){return function(c,a,p){let u=c.params[0],m="";return c.params.length===2&&(m=c.params[1]?" bool":""),`${p} ${o}${m} ${u}`}}},38961:(k,A,e)=>{"use strict";e.d(A,{r:()=>o});var n=e(74848),s=e(96540),l=e(50877),r=e(90182),i=e(32370),g=e(1220);function o({onChange:c,index:a,operationId:p,value:u,query:m,datasource:v}){const[x,f]=(0,s.useState)({});return(0,n.jsx)(r.l6,{inputId:(0,g.OS)(p,a),autoFocus:u===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{f({isLoading:!0});const E=await d(m,v);f({options:E,isLoading:void 0})},isLoading:x.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:x.options,value:(0,l.z)(u),onChange:E=>c(a,E.value)})}async function d(c,a){let p=c.labels;a.type==="prometheus"&&(p=[{label:"__name__",op:"=",value:c.metric},...c.labels]);const u=i.z.renderLabels(p),m=await a.languageProvider.fetchLabelsWithMatch(u);return Object.keys(m).map(v=>({label:v,value:v}))}},9103:(k,A,e)=>{"use strict";e.d(A,{dm:()=>Pe,o6:()=>Ee});var n=e(74848),s=e(32196),l=e(76459),r=e.n(l),i=e(96540),g=e(23257),o=e.n(g),d=e(50877),c=e(13544),a=e(97801),p=e(81580),u=e(32264),m=e(40845),v=e(55852),x=e(14578),f=e(12681),E=e(88824),h=e(40276),y=e(90182),b=e(39268),D=e(14186),P=e(81996),C=e(26115),M=e(65307),I=e(37390),R=e(10354),T=e(62930),S=e(60782),L=e(19727),O=e(19384),j=e(15292),N=e(56034),F=e(14110),U=e(50556);async function w(De,Ie,ke){let dt=!0;const Pt=De.languageProvider.metricsMetadata;Pt&&Object.keys(Pt).length===0&&(dt=!1);let pt={},Tt={},jt;return jt=ke?.map($t=>{const sn=B($t,De),Yt=`${$t}\xA6${sn.description}`;return pt[$t]=sn,Tt[Yt]=sn,sn}),{isLoading:!1,hasMetadata:dt,metrics:jt??[],metaHaystackDictionary:Tt,nameHaystackDictionary:pt,totalMetricCount:jt?.length??0,filteredMetricCount:jt?.length??0}}function B(De,Ie){let ke=(0,U.AU)(De,Ie.languageProvider.metricsMetadata);const dt=(0,U.pK)(De,Ie.languageProvider.metricsMetadata);["histogram","summary"].forEach(Tt=>{dt?.toLowerCase().includes(Tt)&&ke!==Tt&&(ke+=` (${Tt})`)});const Pt=De.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return ke==="histogram"&&!Pt&&(ke="native histogram"),{value:De,type:ke,description:dt}}function K(De,Ie){const ke=W(De);return!De.isLoading&&De.filteredMetricCount!==ke.length&&Ie(Se(ke.length)),Y(ke,De.pageNum,De.resultsPerPage)}function W(De){let Ie=De.metrics;return De.fuzzySearchQuery&&!De.useBackend&&(De.fullMetaSearch?Ie=De.metaHaystackOrder.map(ke=>De.metaHaystackDictionary[ke]):Ie=De.nameHaystackOrder.map(ke=>De.nameHaystackDictionary[ke])),De.selectedTypes.length>0&&(Ie=Ie.filter((ke,dt)=>De.selectedTypes.some(pt=>ke.type&&pt.value?ke.type.includes(pt.value):!ke.type&&pt.value==="no type"))),De.includeNullMetadata||(Ie=Ie.filter(ke=>ke.type!==void 0&&ke.description!==void 0)),Ie}function z(De){if(!De.metrics.length)return[];const Ie=De.resultsPerPage===0?1:De.resultsPerPage,ke=Math.floor(W(De).length/Ie)+1;return[...Array(ke).keys()].map(dt=>dt+1)}function Y(De,Ie,ke){const dt=ke===0?1:ke,Pt=Ie===1?0:(Ie-1)*dt,pt=Pt+dt;return De.slice(Pt,pt)}const X=(De,Ie,ke)=>De<1?1:De>ke?ke:De??Ie;async function q(De,Ie,ke){const dt=(0,C.b4)(De),Pt=Ie.map(jt=>`,${jt.label}="${jt.value}"`),pt=`label_values({__name__=~".*${dt}"${Ie?Pt.join():""}},__name__)`;return await ke.metricFindQuery(pt).then(jt=>jt.map($t=>B($t.text,ke)))}function G(De,Ie,ke,dt){switch(De){case"grafana_prom_metric_encycopedia_tracking":(0,F.rR)(De,{metric:ke,hasMetadata:Ie?.hasMetadata,totalMetricCount:Ie?.totalMetricCount,fuzzySearchQuery:Ie?.fuzzySearchQuery,fullMetaSearch:Ie?.fullMetaSearch,selectedTypes:Ie?.selectedTypes,useRegexSearch:Ie?.useBackend,includeResultsWithoutMetadata:Ie?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,F.rR)(De,{disableTextWrap:Ie?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,F.rR)(De,{query:dt})}}const te=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],H={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function se(De){const{state:Ie,onChangeFullMetaSearch:ke,onChangeIncludeNullMetadata:dt,onChangeDisableTextWrap:Pt,onChangeUseBackend:pt}=De,Tt=(0,m.$j)(),jt=ne(Tt);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:jt.selectItem,children:[(0,n.jsx)(j.d,{"data-testid":Ue.searchWithMetadata,value:Ie.fullMetaSearch,disabled:Ie.useBackend||!Ie.hasMetadata,onChange:()=>ke()}),(0,n.jsx)("div",{className:jt.selectItemLabel,children:H.metadataSearchSwitch})]}),(0,n.jsxs)("div",{className:jt.selectItem,children:[(0,n.jsx)(j.d,{value:Ie.includeNullMetadata,disabled:!Ie.hasMetadata,onChange:()=>dt()}),(0,n.jsx)("div",{className:jt.selectItemLabel,children:H.includeNullMetadata})]}),(0,n.jsxs)("div",{className:jt.selectItem,children:[(0,n.jsx)(j.d,{value:Ie.disableTextWrap,onChange:()=>Pt()}),(0,n.jsx)("div",{className:jt.selectItemLabel,children:"Disable text wrap"})]}),(0,n.jsxs)("div",{className:jt.selectItem,children:[(0,n.jsx)(j.d,{"data-testid":Ue.setUseBackend,value:Ie.useBackend,onChange:()=>pt()}),(0,n.jsxs)("div",{className:jt.selectItemLabel,children:[H.setUseBackend,"\xA0"]}),(0,n.jsx)(N.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end",children:(0,n.jsx)(x.I,{name:"info-circle",size:"xs",className:jt.settingsIcon})})]})]})}function ne(De){return{settingsIcon:(0,s.css)({color:De.colors.text.secondary}),selectItem:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,s.css)({margin:`0 0 0 ${De.spacing(1)}`,alignSelf:"center",color:De.colors.text.secondary,fontSize:"12px"})}}var le=e(67061);function _({feedbackUrl:De}){const Ie=(0,m.of)(Q);return(0,n.jsx)(le.B,{children:(0,n.jsxs)("a",{href:De,className:Ie.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",children:[(0,n.jsx)(x.I,{name:"comment-alt-message"})," Give feedback"]})})}function Q(De){return{link:(0,s.css)({color:De.colors.text.secondary,fontSize:De.typography.bodySmall.fontSize,":hover":{color:De.colors.text.link},margin:"-25px 0 30px 0"})}}var ae=e(4936);function oe(De){const{metrics:Ie,onChange:ke,onClose:dt,query:Pt,state:pt,disableTextWrap:Tt}=De,jt=(0,m.$j)(),$t=J(jt,Tt);function sn(Ut){Ut.value&&(ke({...Pt,metric:Ut.value}),G("grafana_prom_metric_encycopedia_tracking",pt,Ut.value),dt())}function Yt(Ut){return pt.fullMetaSearch&&Ut?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{children:bn(Ut.type??"")}),(0,n.jsx)("td",{children:(0,n.jsx)(o(),{textToHighlight:Ut.description??"",searchWords:pt.metaHaystackMatches,autoEscape:!0,highlightClassName:$t.matchHighLight})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{children:bn(Ut.type??"")}),(0,n.jsx)("td",{children:Ut.description??""})]})}function qt(Ut,Gt,Lt){return(0,n.jsxs)(n.Fragment,{children:[Ut,(0,n.jsx)("span",{className:$t.tooltipSpace,children:(0,n.jsx)(N.m,{content:(0,n.jsxs)(n.Fragment,{children:["When creating a ",Gt,", Prometheus exposes multiple series with the type counter."," ",(0,ae.jW)(Lt)]}),placement:"bottom-start",interactive:!0,children:(0,n.jsx)(x.I,{name:"info-circle",size:"xs"})})})]})}function bn(Ut){return Ut?Ut.includes("(summary)")?qt(Ut,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):Ut.includes("(histogram)")?qt(Ut,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):Ut:""}function Mt(){let Ut;return pt.fuzzySearchQuery||(Ut="There are no metrics found in the data source."),Pt.labels.length>0&&(Ut="There are no metrics found. Try to expand your label filters."),(pt.fuzzySearchQuery||pt.selectedTypes.length>0)&&(Ut="There are no metrics found. Try to expand your search and filters."),(0,n.jsx)("tr",{className:$t.noResults,children:(0,n.jsx)("td",{colSpan:3,children:Ut})})}function Jt(Ut){return Ut.useBackend?[Ut.fuzzySearchQuery]:Ut.fullMetaSearch?Ut.metaHaystackMatches:Ut.nameHaystackMatches}return(0,n.jsxs)("table",{className:$t.table,children:[(0,n.jsx)("thead",{className:$t.stickyHeader,children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:`${$t.nameWidth} ${$t.tableHeaderPadding}`,children:"Name"}),pt.hasMetadata&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("th",{className:`${$t.typeWidth} ${$t.tableHeaderPadding}`,children:"Type"}),(0,n.jsx)("th",{className:`${$t.descriptionWidth} ${$t.tableHeaderPadding}`,children:"Description"})]}),(0,n.jsx)("th",{className:$t.selectButtonWidth,children:" "})]})}),(0,n.jsx)("tbody",{children:(0,n.jsxs)(n.Fragment,{children:[Ie.length>0&&Ie.map((Ut,Gt)=>(0,n.jsxs)("tr",{className:$t.row,children:[(0,n.jsx)("td",{className:$t.nameOverflow,children:(0,n.jsx)(o(),{textToHighlight:Ut?.value??"",searchWords:Jt(pt),autoEscape:!0,highlightClassName:$t.matchHighLight})}),pt.hasMetadata&&Yt(Ut),(0,n.jsx)("td",{children:(0,n.jsx)(v.$n,{size:"md",variant:"secondary",onClick:()=>sn(Ut),className:$t.centerButton,children:"Select"})})]},Ut?.value??Gt)),Ie.length===0&&!pt.isLoading&&Mt()]})})]})}const J=(De,Ie)=>({table:(0,s.css)({tableLayout:Ie?void 0:"fixed",borderRadius:De.shape.radius.default,width:"100%",whiteSpace:Ie?"nowrap":"normal",td:{padding:De.spacing(1)},"td,th":{minWidth:De.spacing(3),borderBottom:`1px solid ${De.colors.border.weak}`}}),row:(0,s.css)({label:"row",borderBottom:`1px solid ${De.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,s.css)({padding:"8px"}),matchHighLight:(0,s.css)({background:"inherit",color:De.components.textHighlight.text,backgroundColor:De.components.textHighlight.background}),nameWidth:(0,s.css)({width:Ie?void 0:"37.5%"}),nameOverflow:(0,s.css)({overflowWrap:Ie?void 0:"anywhere"}),typeWidth:(0,s.css)({width:Ie?void 0:"15%"}),descriptionWidth:(0,s.css)({width:Ie?void 0:"35%"}),selectButtonWidth:(0,s.css)({width:Ie?void 0:"12.5%"}),stickyHeader:(0,s.css)({position:"sticky",top:0,backgroundColor:De.colors.background.primary}),noResults:(0,s.css)({textAlign:"center",color:De.colors.text.secondary}),tooltipSpace:(0,s.css)({marginLeft:"4px"}),centerButton:(0,s.css)({display:"block",margin:"auto",border:"none"})});var ee=e(78036);const de=(De,Ie)=>({modal:(0,s.css)({width:"85vw",[De.breakpoints.down("md")]:{width:"100%"},[De.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,s.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,s.css)({flexBasis:"40%",paddingRight:"16px",[De.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,s.css)({flexGrow:1,flexBasis:"20%",[De.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,s.css)({marginBottom:De.spacing(1)}),resultsAmount:(0,s.css)({color:De.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,s.css)({margin:`4px 0 ${De.spacing(2)} 0`}),resultsDataCount:(0,s.css)({margin:0}),resultsDataFiltered:(0,s.css)({color:De.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,s.css)({display:"inline",verticalAlign:"text-top"}),results:(0,s.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,s.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,s.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,s.css)({visibility:"hidden"}),visible:(0,s.css)({visibility:"visible"}),settingsBtn:(0,s.css)({float:"right"}),noBorder:(0,s.css)({border:"none"}),resultsPerPageLabel:(0,s.css)({color:De.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,s.css)({display:"flex"})});var xe=e(53076),re=e(2543);const ue=new xe.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function Te(De,Ie,ke){const[dt,Pt,pt]=ue.search(De,Ie,0,1e5);let Tt=[],jt=new Set;if(dt&&pt){const $t=(sn,Yt)=>{Yt&&jt.add(sn)};for(let sn=0;sn<pt.length;sn++){let Yt=pt[sn];xe.A.highlight(De[Pt.idx[Yt]],Pt.ranges[Yt],$t),Tt.push(De[Pt.idx[Yt]])}ke([Tt,[...jt]])}else Ie||ke([[],[]])}const ge=(0,re.debounce)(Te,300),Oe=De=>{const{datasource:Ie,isOpen:ke,onClose:dt,onChange:Pt,query:pt,initialMetrics:Tt}=De,[jt,$t]=(0,i.useReducer)(Xe.reducer,(0,ee.ue)(pt)),sn=(0,m.$j)(),Yt=de(sn,jt.disableTextWrap),qt=(0,i.useCallback)(async()=>{$t(we(!0));const At=await w(Ie,pt,Tt);$t(qe({isLoading:!1,hasMetadata:At.hasMetadata,metrics:At.metrics,metaHaystackDictionary:At.metaHaystackDictionary,nameHaystackDictionary:At.nameHaystackDictionary,totalMetricCount:At.metrics.length,filteredMetricCount:At.metrics.length}))},[pt,Ie,Tt]);(0,i.useEffect)(()=>{qt()},[qt]);const bn=te.map(At=>({value:At.value,label:At.value,description:At.description})),Mt=(0,i.useMemo)(()=>r()(async At=>{$t(we(!0));const Nt=await q(At,pt.labels,Ie);$t(We({metrics:Nt,filteredMetricCount:Nt.length,isLoading:!1}))},Ie.getDebounceTimeInMilliseconds()),[Ie,pt]);function Jt(At){$t(_e(At))}function Ut(At){$t(Fe(At))}function Gt(At,Nt){jt.useBackend&&At===""?qt():jt.useBackend?Mt(At):Nt?ge(Object.keys(jt.metaHaystackDictionary),At,Ut):ge(Object.keys(jt.nameHaystackDictionary),At,Jt)}const Lt=(0,n.jsx)(se,{state:jt,onChangeFullMetaSearch:()=>{const At=!jt.fullMetaSearch;$t(at(At)),Pt({...pt,fullMetaSearch:At}),Gt(jt.fuzzySearchQuery,At)},onChangeIncludeNullMetadata:()=>{$t(Ct(!jt.includeNullMetadata)),Pt({...pt,includeNullMetadata:!jt.includeNullMetadata})},onChangeDisableTextWrap:()=>{$t(ze()),Pt({...pt,disableTextWrap:!jt.disableTextWrap}),G("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",jt,"")},onChangeUseBackend:()=>{const At=!jt.useBackend;$t(tt(At)),Pt({...pt,useBackend:At}),At===!1?qt():jt.fuzzySearchQuery!==""&&Mt(jt.fuzzySearchQuery)}});return(0,n.jsxs)(I.a,{"data-testid":Ue.metricModal,isOpen:ke,title:"Metrics explorer",onDismiss:dt,"aria-label":"Browse metrics",className:Yt.modal,children:[(0,n.jsx)(_,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),(0,n.jsxs)("div",{className:Yt.inputWrapper,"data-testid":c.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer,children:[(0,n.jsx)("div",{className:(0,s.cx)(Yt.inputItem,Yt.inputItemFirst),children:(0,n.jsx)(R.p,{autoFocus:!0,"data-testid":Ue.searchMetric,placeholder:H.browse,value:jt.fuzzySearchQuery,onInput:At=>{const Nt=At.currentTarget.value??"";$t(Ke(Nt)),Gt(Nt,jt.fullMetaSearch)}})}),jt.hasMetadata&&(0,n.jsx)("div",{className:Yt.inputItem,children:(0,n.jsx)(y.KF,{"data-testid":Ue.selectType,inputId:"my-select",options:bn,value:jt.selectedTypes,placeholder:H.type,onChange:At=>$t(Dt(At))})}),(0,n.jsx)("div",{children:(0,n.jsx)(T.y,{className:`${Yt.loadingSpinner} ${jt.isLoading?Yt.visible:""}`})}),(0,n.jsx)("div",{className:Yt.inputItem,children:(0,n.jsx)(S.G,{"aria-label":"Additional settings",content:Lt,placement:"bottom-end",closeButton:!1,children:(0,n.jsxs)(L.e,{className:Yt.settingsBtn,children:[(0,n.jsx)(v.$n,{variant:"secondary",size:"md",onClick:()=>$t(pe()),"data-testid":Ue.showAdditionalSettings,className:Yt.noBorder,children:"Additional Settings"}),(0,n.jsx)(v.$n,{className:Yt.noBorder,variant:"secondary",icon:jt.showAdditionalSettings?"angle-up":"angle-down"})]})})})]}),(0,n.jsxs)("div",{className:Yt.resultsData,children:[pt.metric&&(0,n.jsxs)("i",{className:Yt.currentlySelected,children:["Currently selected: ",pt.metric]}),pt.labels.length>0&&(0,n.jsxs)("div",{className:Yt.resultsDataFiltered,children:[(0,n.jsx)(x.I,{name:"info-circle",size:"sm"}),(0,n.jsx)("div",{className:Yt.resultsDataFilteredText,children:"\xA0These metrics have been pre-filtered by labels chosen in the label filters."})]})]}),(0,n.jsx)("div",{className:Yt.results,children:jt.metrics&&(0,n.jsx)(oe,{metrics:K(jt,$t),onChange:Pt,onClose:dt,query:pt,state:jt,disableTextWrap:jt.disableTextWrap})}),(0,n.jsxs)("div",{className:Yt.resultsFooter,children:[(0,n.jsxs)("div",{className:Yt.resultsAmount,children:["Showing ",jt.filteredMetricCount," of ",jt.totalMetricCount," results"]}),(0,n.jsx)(O.d,{currentPage:jt.pageNum??1,numberOfPages:z(jt).length,onNavigate:At=>{$t(je(At??1))}}),(0,n.jsxs)("div",{className:Yt.resultsPerPageWrapper,children:[(0,n.jsx)("p",{className:Yt.resultsPerPageLabel,children:"# Results per page\xA0"}),(0,n.jsx)(R.p,{"data-testid":Ue.resultsPerPage,value:X(jt.resultsPerPage,ee.J3,ee.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+ee.yH,type:"number",onInput:At=>{const Nt=+At.currentTarget.value;isNaN(Nt)||Nt>=ee.yH||$t(Ce(Nt))}})]})]})]})},Ue={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},Xe=(0,M.Z0)({name:"metrics-modal-state",initialState:(0,ee.ue)(),reducers:{filterMetricsBackend:(De,Ie)=>{De.metrics=Ie.payload.metrics,De.filteredMetricCount=Ie.payload.filteredMetricCount,De.isLoading=Ie.payload.isLoading},buildMetrics:(De,Ie)=>{De.isLoading=Ie.payload.isLoading,De.metrics=Ie.payload.metrics,De.hasMetadata=Ie.payload.hasMetadata,De.metaHaystackDictionary=Ie.payload.metaHaystackDictionary,De.nameHaystackDictionary=Ie.payload.nameHaystackDictionary,De.totalMetricCount=Ie.payload.totalMetricCount,De.filteredMetricCount=Ie.payload.filteredMetricCount},setIsLoading:(De,Ie)=>{De.isLoading=Ie.payload},setFilteredMetricCount:(De,Ie)=>{De.filteredMetricCount=Ie.payload},setResultsPerPage:(De,Ie)=>{De.resultsPerPage=Ie.payload},setPageNum:(De,Ie)=>{De.pageNum=Ie.payload},setFuzzySearchQuery:(De,Ie)=>{De.fuzzySearchQuery=Ie.payload,De.pageNum=1},setNameHaystack:(De,Ie)=>{De.nameHaystackOrder=Ie.payload[0],De.nameHaystackMatches=Ie.payload[1]},setMetaHaystack:(De,Ie)=>{De.metaHaystackOrder=Ie.payload[0],De.metaHaystackMatches=Ie.payload[1]},setFullMetaSearch:(De,Ie)=>{De.fullMetaSearch=Ie.payload,De.pageNum=1},setIncludeNullMetadata:(De,Ie)=>{De.includeNullMetadata=Ie.payload,De.pageNum=1},setSelectedTypes:(De,Ie)=>{De.selectedTypes=Ie.payload,De.pageNum=1},setUseBackend:(De,Ie)=>{De.useBackend=Ie.payload,De.fullMetaSearch=!1,De.pageNum=1},setDisableTextWrap:De=>{De.disableTextWrap=!De.disableTextWrap},showAdditionalSettings:De=>{De.showAdditionalSettings=!De.showAdditionalSettings}}}),{setIsLoading:we,buildMetrics:qe,filterMetricsBackend:We,setResultsPerPage:Ce,setPageNum:je,setFuzzySearchQuery:Ke,setNameHaystack:_e,setMetaHaystack:Fe,setFullMetaSearch:at,setIncludeNullMetadata:Ct,setSelectedTypes:Dt,setUseBackend:tt,setDisableTextWrap:ze,showAdditionalSettings:pe,setFilteredMetricCount:Se}=Xe.actions,fe=" ",Ee=1e3;function Pe({datasource:De,query:Ie,onChange:ke,onGetMetrics:dt,labelsFilters:Pt,metricLookupDisabled:pt,onBlur:Tt,variableEditor:jt}){const $t=(0,m.of)(he),[sn,Yt]=(0,i.useState)({}),qt=u.$.featureToggles.prometheusMetricEncyclopedia,bn=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],Mt=(0,i.useCallback)((Pn,Xn)=>{const Tn=Pn.label??Pn.value;return Tn?Tn.toLowerCase?Xn.split(fe).reduce((St,Ge)=>{const Ve=Tn.toLowerCase().includes(Ge.toLowerCase());let lt=!1;return qt&&(lt=Tn==="Metrics explorer"),St&&(Ve||lt)},!0):!0:!1},[qt]),Jt=(0,i.useCallback)((Pn,Xn)=>Pn.__isNew__?Pn.label:(0,n.jsx)(o(),{searchWords:Xn.inputValue.split(fe),textToHighlight:Pn.label??"",highlightClassName:$t.highlight}),[$t.highlight]),Ut=(Pn,Xn)=>{const Tn=(0,C.b4)(Pn);return be(Tn,Xn)},Gt=Pn=>De.metricFindQuery(Ut(Pn,Pt)).then(Tn=>{const ht=Tn.length;(0,P.ky)(Tn),ht>Tn.length?Yt({...sn,resultsTruncated:!0}):Yt({...sn,resultsTruncated:!1});const St=Tn.map(Ge=>({label:Ge.text,value:Ge.text}));return qt?[...bn,...St]:St}),Lt=()=>Promise.resolve([]),At=r()(Pn=>Gt(Pn),De.getDebounceTimeInMilliseconds()),Nt=Pn=>{const Xn=Pn.data;if(Xn.value==="BrowseMetrics"){const Tn=Pn.isFocused?$t.focus:"";return(0,n.jsx)("div",{...Pn.innerProps,ref:Pn.innerRef,className:`${$t.customOptionWidth} metric-encyclopedia-open`,"data-testid":c.Tp.components.Select.option,onKeyDown:ht=>{ht.code==="Enter"&&Yt({...sn,metricsModalOpen:!0})},children:(0,n.jsxs)("div",{className:`${$t.customOption} ${Tn} metric-encyclopedia-open`,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"metric-encyclopedia-open",children:Xn.label}),(0,n.jsx)("div",{className:`${$t.customOptionDesc} metric-encyclopedia-open`,children:Xn.description})]}),(0,n.jsxs)(v.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>Yt({...sn,metricsModalOpen:!0}),className:"metric-encyclopedia-open",children:["Open",(0,n.jsx)(x.I,{name:"arrow-right"})]})]})})}return(0,f.o5)(Pn)},Dn=({children:Pn,maxHeight:Xn,innerRef:Tn,innerProps:ht})=>{const St=(0,m.$j)(),Ge=(0,E.J)(St),Ve=!i.isValidElement(Pn)&&sn.resultsTruncated;return(0,n.jsxs)("div",{...ht,className:`${Ge.menu} ${$t.customMenuContainer}`,style:{maxHeight:Math.round(Xn*.9)},"aria-label":"Select options menu",children:[(0,n.jsx)(h.E,{scrollRefCallback:Tn,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0,children:Pn}),Ve&&(0,n.jsx)("div",{className:$t.customMenuFooter,children:(0,n.jsx)("div",{children:"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics."})})]})},An=()=>(0,n.jsx)(y.DW,{"data-testid":c.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!jt,inputId:"prometheus-metric-select",className:$t.select,value:Ie.metric?(0,d.z)(Ie.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:Jt,filterOption:Mt,minMenuHeight:250,onOpenMenu:async()=>{if(pt)return;Yt({isLoading:!0});const Pn=await dt(),Xn=Pn.map(ht=>ht.value),Tn=Pn.length;Pn.length>Ee&&(0,P.ky)(Pn),Yt(qt?{metrics:[...bn,...Pn],isLoading:void 0,initialMetrics:Xn,resultsTruncated:Tn>Pn.length}:{metrics:Pn,isLoading:void 0,resultsTruncated:Tn>Pn.length})},loadOptions:pt?Lt:At,isLoading:sn.isLoading,defaultOptions:sn.metrics??Array.from(new Array(25),()=>({value:""})),onChange:Pn=>{const Xn=Pn?.value;Xn?qt&&Xn==="BrowseMetrics"?(G("grafana_prometheus_metric_encyclopedia_open",null,"",Ie),Yt({...sn,metricsModalOpen:!0})):ke({...Ie,metric:Xn}):ke({...Ie,metric:""})},components:qt?{Option:Nt,MenuList:Dn}:{MenuList:Dn},onBlur:Tt});return(0,n.jsxs)(n.Fragment,{children:[qt&&!De.lookupsDisabled&&sn.metricsModalOpen&&(0,n.jsx)(Oe,{datasource:De,isOpen:sn.metricsModalOpen,onClose:()=>Yt({...sn,metricsModalOpen:!1}),query:Ie,onChange:ke,initialMetrics:sn.initialMetrics??[]}),jt?(0,n.jsx)(b.C,{children:(0,n.jsx)(D.I,{label:"Metric",labelWidth:20,tooltip:(0,n.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:An()})}):(0,n.jsx)(a.B,{children:(0,n.jsx)(p.c,{label:"Metric",children:An()})})]})}const he=De=>({select:(0,s.css)({minWidth:"125px"}),highlight:(0,s.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:De.colors.warning.contrastText,backgroundColor:De.colors.warning.main}),customOption:(0,s.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:De.colors.emphasize(De.colors.background.primary,.1)}}),customOptionlabel:(0,s.css)({color:De.colors.text.primary}),customOptionDesc:(0,s.css)({color:De.colors.text.secondary,fontSize:De.typography.size.xs,opacity:"50%"}),focus:(0,s.css)({backgroundColor:De.colors.emphasize(De.colors.background.primary,.1)}),customOptionWidth:(0,s.css)({minWidth:"400px"}),customMenuFooter:(0,s.css)({flex:0,display:"flex",justifyContent:"space-between",padding:De.spacing(1.5),borderTop:`1px solid ${De.colors.border.weak}`,color:De.colors.text.secondary}),customMenuContainer:(0,s.css)({display:"flex",flexDirection:"column",background:De.colors.background.primary,boxShadow:De.shadows.z3})}),be=(De,Ie)=>{const ke=Ie?Ae(Ie):[];return`label_values({__name__=~".*${De}"${ke?ke.join(""):""}},__name__)`},Ae=De=>De.map(Ie=>`,${Ie.label}="${Ie.value}"`)},29993:(k,A,e)=>{"use strict";e.d(A,{I:()=>R});var n=e(74848),s=e(96540),l=e(50556),r=e(81996),i=e(32370),g=e(26115),o=e(32196),d=e(2543),c=e(85269),a=e(97801),p=e(81580),u=e(39268),m=e(76892),v=e(76459),x=e.n(v),f=e(50877),E=e(13544),h=e(81392),y=e(3721),b=e(90182);function D({item:S,defaultOp:L,onChange:O,onDelete:j,onGetLabelNames:N,onGetLabelValues:F,invalidLabel:U,invalidValue:w,getLabelValuesAutofillSuggestions:B,debounceDuration:K}){const[W,z]=(0,s.useState)({}),[Y,X]=(0,s.useState)(!1),[q,G]=(0,s.useState)(!1),te=(le=S.op)=>P.find(_=>_.label===le)?.isMultiValue,H=le=>{if(le){const _=/\(([^)]+)\)/,Q=le?.match(_);return Q&&Q[0].indexOf("|")>0?[le]:le.indexOf("|")>0?le.split("|"):[le]}return[]},se=x()(le=>B(le,S.label),K),ne=S?.value??"";return(0,n.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,n.jsxs)(h.M,{children:[(0,n.jsx)(b.l6,{placeholder:"Select label","data-testid":E.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:S.label?(0,f.z)(S.label):null,allowCustomValue:!0,onOpenMenu:async()=>{z({isLoadingLabelNames:!0});const le=await N(S);X(!0),z({labelNames:le,isLoadingLabelNames:void 0})},onCloseMenu:()=>{X(!1)},isOpen:Y,isLoading:W.isLoadingLabelNames??!1,options:W.labelNames,onChange:le=>{le.label&&O({...S,op:S.op??L,label:le.label})},invalid:U}),(0,n.jsx)(b.l6,{"data-testid":E.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,f.z)(S.op??L),options:P,width:"auto",onChange:le=>{le.value!=null&&O({...S,op:le.value,value:te(le.value)?S.value:H(S?.value)[0]})}}),(0,n.jsx)(b.DW,{placeholder:"Select value","data-testid":E.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:te()?H(ne).map(f.z):H(ne).map(f.z)[0],allowCustomValue:!0,formatCreateLabel:le=>le,createOptionPosition:S.op?.includes("~")?"first":"last",onOpenMenu:async()=>{z({isLoadingLabelValues:!0});const le=await F(S);(0,r.ky)(le),G(!0),z({...W,labelValues:le,isLoadingLabelValues:void 0})},onCloseMenu:()=>{G(!1)},isOpen:q,defaultOptions:W.labelValues,isMulti:te(),isLoading:W.isLoadingLabelValues,loadOptions:se,onChange:le=>{if(le.value)O({...S,value:le.value,op:S.op??L});else{const _=le.map(Q=>Q.label).join("|");O({...S,value:_,op:S.op??L})}},invalid:w}),(0,n.jsx)(y.Z,{"aria-label":`remove-${S.label}`,icon:"times",variant:"secondary",onClick:j})]})},ne)}const P=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],C="Select at least 1 label filter (label and value)";function M({labelsFilters:S,onChange:L,onGetLabelNames:O,onGetLabelValues:j,labelFilterRequired:N,getLabelValuesAutofillSuggestions:F,debounceDuration:U,variableEditor:w}){const B="=",[K,W]=(0,s.useState)([{op:B}]);(0,s.useEffect)(()=>{S.length>0?W(S):W([{op:B}])},[S]);const z=q=>{W(q);const G=q.filter(te=>te.label!=null&&te.value!=null);(0,d.isEqual)(G,S)||L(G)},Y=K.some(q=>q.label&&q.value),X=()=>(0,n.jsx)(c.o,{items:K,onChange:z,renderItem:(q,G,te)=>(0,n.jsx)(D,{debounceDuration:U,item:q,defaultOp:B,onChange:G,onDelete:te,onGetLabelNames:O,onGetLabelValues:j,invalidLabel:N&&!q.label,invalidValue:N&&!q.value,getLabelValuesAutofillSuggestions:F})});return(0,n.jsx)(n.Fragment,{children:w?(0,n.jsx)(u.C,{children:(0,n.jsxs)("div",{className:(0,o.cx)((0,o.css)({display:"flex"})),children:[(0,n.jsx)(m.c,{width:20,tooltip:(0,n.jsx)("div",{children:"Optional: used to filter the metric select for this query type."}),children:"Label filters"}),X()]})}):(0,n.jsx)(a.B,{children:(0,n.jsx)(p.c,{label:"Label filters",error:C,invalid:N&&!Y,children:X()})})})}var I=e(9103);function R({datasource:S,query:L,onChange:O,onBlur:j,variableEditor:N}){const F=X=>{O({...L,labels:X})},U=(0,s.useCallback)(async X=>{const q=S.getVariables(),G=await X;return[...q.map(te=>({label:te,value:te})),...G.map(te=>({label:te.value,value:te.value,title:te.description}))]},[S]),w=async X=>{if(!L.metric)return await S.languageProvider.fetchLabels(),S.languageProvider.getLabelKeys().map(H=>({value:H}));const q=L.labels.filter(H=>H!==X);q.push({label:"__name__",op:"=",value:L.metric});const G=i.z.renderLabels(q);let te=await S.languageProvider.fetchLabelsWithMatch(G);return Object.keys(te).filter(H=>!q.find(se=>se.label===H)).map(H=>({value:H}))},B=(X,q)=>{const G={label:q??"__name__",op:"=~",value:(0,g.b4)(`.*${X}`)},te=L.labels.filter(le=>le.label!==G.label);te.push(G),L.metric&&te.push({label:"__name__",op:"=",value:L.metric});const H=te.map(le=>({...le,label:S.interpolateString(le.label),value:S.interpolateString(le.value)})),se=i.z.renderLabels(H);let ne;return S.hasLabelsMatchAPISupport()?ne=W(G,se):ne=K(G,se),ne.then(le=>((0,r.ky)(le),le))},K=(X,q)=>{if(!X.label)return Promise.resolve([]);const G=S.languageProvider.fetchSeries(q),te=S.interpolateString(X.label);return G.then(H=>{const se=new Set;return H.forEach(ne=>{const le=ne[te];se.add(le)}),Array.from(se).map(ne=>({label:ne,value:ne}))})},W=(X,q)=>{if(!X.label)return Promise.resolve([]);const G=`[${S.uid}][${L.metric}][${X.label}][${X.op}]`;return S.languageProvider.fetchSeriesValuesWithMatch(X.label,q,G).then(te=>te.map(H=>({value:H,label:H})))},z=async X=>{if(!X.label)return[];if(!L.metric)return(await S.languageProvider.getLabelValues(X.label)).map(H=>({value:H}));const q=L.labels.filter(H=>H!==X);q.push({label:"__name__",op:"=",value:L.metric});const G=q.map(H=>({...H,label:S.interpolateString(H.label),value:S.interpolateString(H.value)})),te=i.z.renderLabels(G);return S.hasLabelsMatchAPISupport()?W(X,te):K(X,te)},Y=(0,s.useCallback)(()=>U(T(S,L)),[S,L,U]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I.dm,{query:L,onChange:O,onGetMetrics:Y,datasource:S,labelsFilters:L.labels,metricLookupDisabled:S.lookupsDisabled,onBlur:j||(()=>{}),variableEditor:N}),(0,n.jsx)(M,{debounceDuration:S.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:B,labelsFilters:L.labels,onChange:F,onGetLabelNames:X=>U(w(X)),onGetLabelValues:X=>U(z(X)),variableEditor:N})]})}async function T(S,L){S.languageProvider.metricsMetadata||await S.languageProvider.loadMetricsMetadata(),S.languageProvider.metricsMetadata||(S.languageProvider.metricsMetadata={});let O;if(L.labels.length>0){const j=i.z.renderLabels(L.labels);O=(await S.languageProvider.getSeries(j,!0)).__name__??[]}else O=await S.languageProvider.getLabelValues("__name__")??[];return O.map(j=>({value:j,description:(0,l.xB)(j,S.languageProvider.metricsMetadata)}))}},26432:(k,A,e)=>{"use strict";e.d(A,{W:()=>a,i:()=>p});var n=e(74848),s=e(96540),l=e(67061),r=e(20719),i=e(32370),g=e(76040),o=e(27994),d=e(96625),c=e(3884);const a="Fetch all series matching metric name and label filters.",p=(0,s.memo)(({query:u})=>{const m=(0,g.u)(u||"").query,v={grammar:r.Ay,name:"promql"};return(0,n.jsxs)(l.B,{gap:.5,direction:"column",children:[(0,n.jsx)(o.r,{stepNumber:1,title:(0,n.jsx)(c.Z,{query:`${m.metric} ${i.z.renderLabels(m.labels)}`,lang:v}),children:a}),(0,n.jsx)(d.k,{stepNumber:2,queryModeller:i.z,query:m,lang:v})]})});p.displayName="PromQueryBuilderExplained"},80109:(k,A,e)=>{"use strict";e.d(A,{$:()=>o});var n=e(74848),s=e(32196),l=e(13544),r=e(40845),i=e(86204),g=e(26432);function o(c){const{query:a,datasource:p,range:u,onRunQuery:m,onChange:v,data:x,app:f,showExplain:E}=c,h=(0,r.of)(d);return(0,n.jsxs)("div",{"data-testid":l.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:h.wrapper,children:[(0,n.jsx)(i.L,{datasource:p,query:a,range:u,onRunQuery:m,onChange:v,history:[],data:x,app:f}),E&&(0,n.jsx)(g.i,{query:a.expr})]})}const d=c=>({wrapper:(0,s.css)({".gf-form":{marginBottom:0}})})},78036:(k,A,e)=>{"use strict";e.d(A,{J3:()=>n,mt:()=>r,ue:()=>l,yH:()=>s});const n=100,s=1e3;function l(i){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:n,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:i?.fullMetaSearch??!1,includeNullMetadata:i?.includeNullMetadata??!0,selectedTypes:[],useBackend:i?.useBackend??!1,disableTextWrap:i?.disableTextWrap??!1,showAdditionalSettings:!1}}function r(i){return{useBackend:i?.useBackend??!1,disableTextWrap:i?.disableTextWrap??!1,fullMetaSearch:i?.fullMetaSearch??!1,includeNullMetadata:i.includeNullMetadata??!1}}},1220:(k,A,e)=>{"use strict";e.d(A,{DQ:()=>v,G3:()=>E,Kl:()=>p,OS:()=>x,iZ:()=>m,jC:()=>h,jY:()=>o,kf:()=>d,nU:()=>a,z2:()=>f});var n=e(2543),s=e.n(n),l=e(55127),r=e.n(l),i=e(38961),g=e(15145);function o(R,T,S){const L=u(R,T,S),O=R.id+"(";return S&&L.push(S),O+L.join(", ")+")"}function d(R,T,S){const L=u(R,T,S),O=R.id+"(";return S&&L.unshift(S),O+L.join(", ")+")"}function c(R,T,S,L){if(T.params.length<2)throw`Cannot render a function with params of length [${T.params.length}]`;let O=(R.params??[])[0]??"5m";const j=u({...R,params:R.params.slice(1)},{...T,params:T.params.slice(1),defaultParams:T.defaultParams.slice(1)},S),N=R.id+"(";return S&&(L?j.push(`${S}[${O}]`):j.unshift(`${S}[${O}]`)),N+j.join(", ")+")"}function a(R,T,S){return c(R,T,S,!1)}function p(R,T,S){return c(R,T,S,!0)}function u(R,T,S){return(R.params??[]).map((L,O)=>T.params[O].type==="string"?'"'+L+'"':L)}function m(R,T){const S={id:R.id,params:R.defaultParams};return{...T,operations:[...T.operations,S]}}function v(R){return(0,n.capitalize)(R.replace(/_/g," "))}function x(R,T){return`operations.${R}.param.${T}`}function f(R=!1){const T=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return R&&T.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:T}}function E(R,T={}){return[{id:R,name:v(R),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:g.Ag.Aggregations,renderer:o,paramChangedHandler:M(`__${R}_by`),explainHandler:D(R,""),addOperationHandler:m,...T},{id:`__${R}_by`,name:`${v(R)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:y(R),paramChangedHandler:C(R),explainHandler:D(R,"by"),addOperationHandler:m,hideFromList:!0,...T},{id:`__${R}_without`,name:`${v(R)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:b(R),paramChangedHandler:C(R),explainHandler:D(R,"without"),addOperationHandler:m,hideFromList:!0,...T}]}function h(R,T,S={}){const L=E(R,S);return L[0].params.unshift(...T.params),L[1].params.unshift(...T.params),L[2].params.unshift(...T.params),L[0].defaultParams=T.defaultParams,L[1].defaultParams=[...T.defaultParams,""],L[2].defaultParams=[...T.defaultParams,""],L[1].renderer=P(R),L[2].renderer=P(R),L}function y(R){return function(S,L,O){return`${R} by(${S.params.join(", ")}) (${O})`}}function b(R){return function(S,L,O){return`${R} without(${S.params.join(", ")}) (${O})`}}function D(R,T){return function(L){const O=L.params.map(N=>`\`${N}\``).join(" and "),j=r()("label",L.params.length);switch(T){case"by":return`Calculates ${R} over dimensions while preserving ${j} ${O}.`;case"without":return`Calculates ${R} over the dimensions ${O}. All other labels are preserved.`;default:return`Calculates ${R} over the dimensions.`}}}function P(R){return function(S,L,O){const j=L.params.findIndex(U=>U.restParam),N=S.params.slice(0,j),F=S.params.slice(j);return`${R} by(${F.join(", ")}) (${N.map((U,w)=>L.params[w].type==="string"?`"${U}"`:U).join(", ")}, ${O})`}}function C(R){return function(S,L,O){return L.params.length<O.params.length?{...L,id:R}:L}}function M(R){return function(S,L,O){return L.params.length===O.params.length?{...L,id:R}:L}}function I(R,T){if(!R.label||!R.op||!R.value||T.length<2)return!1;const S=R.op.toString().startsWith("!");return T.filter(j=>j.label===R.label&&j.value===R.value&&j.op!==R.op).some(j=>!!(S&&j?.op?.toString().startsWith("!")===!1||S===!1&&j?.op?.toString().startsWith("!")))}},76040:(k,A,e)=>{"use strict";e.d(A,{u:()=>r});var n=e(84555),s=e(75161),l=e(26115);function r(f){const E=(0,l.qk)(f),y=n.K3.parse(E).topNode,D={query:{metric:"",labels:[],operations:[]},errors:[]};try{g(E,y,D)}catch(P){console.error(P),P instanceof Error&&D.errors.push({text:P.message})}return x(D.query)&&(D.errors=[]),i(f)&&(D.errors=[]),D}function i(f){const E={query:{metric:"",labels:[],operations:[]},errors:[]};f=f.replace(/\$__interval/g,"1s"),f=f.replace(/\$__interval_ms/g,"1000"),f=f.replace(/\$__rate_interval/g,"1s"),f=f.replace(/\$__range_ms/g,"1000"),f=f.replace(/\$__range_s/g,"1"),f=f.replace(/\$__range/g,"1s");const y=n.K3.parse(f).topNode;try{g(f,y,E)}catch{return!1}return E.errors.length===0}function g(f,E,h){const y=h.query;switch(E.type.id){case n.gw:{y.metric=(0,l.AA)(f,E);break}case n.BG:{y.labels.push(d(f,E));const b=E.getChild(l.Ql);b&&h.errors.push((0,l.xz)(f,b));break}case n.R6:{a(f,E,h);break}case n.Fn:{p(f,E,h);break}case n.df:{m(f,E,h);break}case l.Ql:{if(o(E))break;h.errors.push((0,l.xz)(f,E));break}default:{E.type.id===n.ek&&h.errors.push((0,l.xz)(f,E));let b=E.firstChild;for(;b;)g(f,b,h),b=b.nextSibling}}}function o(f){return f.prevSibling?.firstChild?.type.id===n.Fb}function d(f,E){const h=(0,l.AA)(f,E.getChild(n.IC)),y=(0,l.AA)(f,E.getChild(n.Lf)),b=(0,l.AA)(f,E.getChild(n.LW)).replace(/^["'`]|["'`]$/g,"");return{label:h,op:y,value:b}}const c=["changes","rate","irate","increase","delta"];function a(f,E,h){const y=h.query,b=E.getChild(n.m3),D=(0,l.AA)(f,b),P=E.getChild(n.Dh),C=[];let M="";if(c.includes(D)||D.endsWith("_over_time")){let R=(0,l.AA)(f,E).match(/\[(.+)\]/);R?.[1]&&(M=R[1],C.push(R[1]))}const I={id:D,params:C};if(y.operations.unshift(I),P){if((0,l.AA)(f,P)==="(["+M+"])")return;u(f,P,h,I)}}function p(f,E,h){const y=h.query,b=E.getChild(n.xb);let D=(0,l.AA)(f,b);const P=E.getChild(n.hI),C=[];P&&(P.getChild("By")&&D&&(D=`__${D}_by`),P.getChild(n.xB)&&(D=`__${D}_without`),C.push(...(0,l.R1)(f,P,n.IC)));const M=E.getChild(n.Dh),I={id:D,params:[]};y.operations.unshift(I),u(f,M,h,I),I.params.push(...C)}function u(f,E,h,y){if(E)switch(E.type.id){case n.Dh:{let b=E.firstChild;for(;b;){let D;b.type.id===n.df?D=b:D=b.getChild(n.df),D&&h.errors.push({text:"Query parsing is ambiguous.",from:D.from,to:D.to}),u(f,b,h,y),b=b.nextSibling}break}case n.Po:{y.params.push(parseFloat((0,l.AA)(f,E)));break}case n.LW:{y.params.push((0,l.AA)(f,E).replace(/"/g,""));break}default:g(f,E,h)}}function m(f,E,h){const y=h.query,b=E.firstChild,D=(0,l.AA)(f,b.nextSibling),P=v(f,E.getChild(n.eM)??E.getChild(n.Ue)),C=E.lastChild,M=s.AE[D],I=b.type.id===n.Po,R=C.type.id===n.Po,T=C.type.id===n.df;if(I||g(f,b,h),R)y.operations.push((0,l.rq)(M,f,C,!!P?.isBool));else if(T){const S=(0,l.z9)(C);S?.type.id===n.Po&&y.operations.push((0,l.rq)(M,f,S,!!P?.isBool)),g(f,C,h)}else{y.binaryQueries=y.binaryQueries||[];const S={operator:D,query:{metric:"",labels:[],operations:[]}};P?.isMatcher&&(S.vectorMatchesType=P.matchType,S.vectorMatches=P.matches),y.binaryQueries.push(S),g(f,C,{query:S.query,errors:h.errors})}}function v(f,E){if(E){if(E.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let h="";const y=E.getChild(n.x$);return y&&(h=(0,l.R1)(f,y,n.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:h,matchType:E.getChild(n.On)?"on":"ignoring"}}}}function x(f){return f.labels.length===0&&f.operations.length===0&&!f.metric}},26115:(k,A,e)=>{"use strict";e.d(A,{AA:()=>d,Ql:()=>n,R1:()=>a,b4:()=>p,qk:()=>i,rq:()=>c,xz:()=>l,z9:()=>s});const n=0;function s(u){return u.firstChild?s(u.firstChild):u}function l(u,m){return{text:d(u,m),from:m.from,to:m.to,parentType:m.parent?.name}}const r=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function i(u){return u.replace(r,(m,v,x,f,E,h,y)=>{const b=f||y;let D=v,P="0";return x&&(D=x,P="1"),E&&(D=E,P="2"),`__V_${P}__`+D+"__V__"+(b?"__F__"+b+"__F__":"")})}const g=[(u,m)=>`$${u}`,(u,m)=>`[[${u}${m?`:${m}`:""}]]`,(u,m)=>`\${${u}${m?`:${m}`:""}}`];function o(u){return u.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(m,v,x,f)=>g[parseInt(v,10)](x,f))}function d(u,m){return m?o(u.substring(m.from,m.to)):""}function c(u,m,v,x){const f=[parseFloat(d(m,v))];return u.comparison&&f.push(x),{id:u.id,params:f}}function a(u,m,v){if(m.type.id===v)return[d(u,m)];const x=[];let f=0,E=m.childAfter(f);for(;E;)x.push(...a(u,E,v)),f=E.to,E=m.childAfter(f);return x}const p=u=>u.split(" ").map(v=>`${v}.*`).join("")},27994:(k,A,e)=>{"use strict";e.d(A,{r:()=>i});var n=e(74848),s=e(32196),l=e(36663),r=e(40845);function i({title:o,stepNumber:d,markdown:c,children:a}){const p=(0,r.of)(g);return(0,n.jsxs)("div",{className:p.box,children:[d!==void 0&&(0,n.jsx)("div",{className:p.stepNumber,children:d}),(0,n.jsxs)("div",{className:p.boxInner,children:[o&&(0,n.jsx)("div",{className:p.header,children:(0,n.jsx)("span",{children:o})}),(0,n.jsxs)("div",{className:p.body,children:[c&&(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,l.G)(c)}}),a]})]})]})}const g=o=>({box:(0,s.css)({background:o.colors.background.secondary,padding:o.spacing(1),borderRadius:o.shape.radius.default,position:"relative"}),boxInner:(0,s.css)({marginLeft:o.spacing(4)}),stepNumber:(0,s.css)({fontWeight:o.typography.fontWeightMedium,background:o.colors.secondary.main,width:"20px",height:"20px",borderRadius:o.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:o.typography.bodySmall.fontSize}),header:(0,s.css)({paddingBottom:o.spacing(.5),display:"flex",alignItems:"center",fontFamily:o.typography.fontFamilyMonospace}),body:(0,s.css)({color:o.colors.text.secondary,"p:last-child":{margin:0},a:{color:o.colors.text.link,textDecoration:"underline"}})})},96625:(k,A,e)=>{"use strict";e.d(A,{k:()=>r});var n=e(74848),s=e(27994),l=e(3884);function r({query:i,queryModeller:g,stepNumber:o,lang:d,onMouseEnter:c,onMouseLeave:a}){return(0,n.jsx)(n.Fragment,{children:i.operations.map((p,u)=>{const m=g.getOperationDef(p.id);if(!m)return`Operation ${p.id} not found`;const v=m.renderer(p,m,"<expr>"),x=m.explainHandler?m.explainHandler(p,m):m.documentation??"no docs";return(0,n.jsx)("div",{onMouseEnter:()=>c?.(p,u),onMouseLeave:()=>a?.(p,u),children:(0,n.jsx)(s.r,{stepNumber:u+o,title:(0,n.jsx)(l.Z,{query:v,lang:d}),markdown:x})},u)})})}},3884:(k,A,e)=>{"use strict";e.d(A,{Z:()=>g});var n=e(74848),s=e(32196),l=e(28848),r=e.n(l),i=e(40845);function g({query:d,lang:c,className:a}){const p=(0,i.$j)(),u=o(p),m=r().highlight(d,c.grammar,c.name);return(0,n.jsx)("div",{className:(0,s.cx)(u.editorField,"prism-syntax-highlight",a),"aria-label":"selector",dangerouslySetInnerHTML:{__html:m}})}const o=d=>({editorField:(0,s.css)({fontFamily:d.typography.fontFamilyMonospace,fontSize:d.typography.bodySmall.fontSize})})},15145:(k,A,e)=>{"use strict";e.d(A,{Ag:()=>n,jN:()=>s,n5:()=>l});var n=(r=>(r.Aggregations="Aggregations",r.RangeFunctions="Range functions",r.Functions="Functions",r.BinaryOps="Binary operations",r.Trigonometric="Trigonometric",r.Time="Time Functions",r))(n||{}),s=(r=>(r.Abs="abs",r.Absent="absent",r.AbsentOverTime="absent_over_time",r.Acos="acos",r.Acosh="acosh",r.Asin="asin",r.Asinh="asinh",r.Atan="atan",r.Atanh="atanh",r.Avg="avg",r.AvgOverTime="avg_over_time",r.BottomK="bottomk",r.Ceil="ceil",r.Changes="changes",r.Clamp="clamp",r.ClampMax="clamp_max",r.ClampMin="clamp_min",r.Cos="cos",r.Cosh="cosh",r.Count="count",r.CountOverTime="count_over_time",r.CountScalar="count_scalar",r.CountValues="count_values",r.DayOfMonth="day_of_month",r.DayOfWeek="day_of_week",r.DayOfYear="day_of_year",r.DaysInMonth="days_in_month",r.Deg="deg",r.Delta="delta",r.Deriv="deriv",r.DropCommonLabels="drop_common_labels",r.Exp="exp",r.Floor="floor",r.Group="group",r.HistogramQuantile="histogram_quantile",r.HistogramAvg="histogram_avg",r.HistogramCount="histogram_count",r.HistogramSum="histogram_sum",r.HistogramFraction="histogram_fraction",r.HistogramStddev="histogram_stddev",r.HistogramStdvar="histogram_stdvar",r.HoltWinters="holt_winters",r.Hour="hour",r.Idelta="idelta",r.Increase="increase",r.Irate="irate",r.LabelJoin="label_join",r.LabelReplace="label_replace",r.Last="last",r.LastOverTime="last_over_time",r.Ln="ln",r.Log10="log10",r.Log2="log2",r.Max="max",r.MaxOverTime="max_over_time",r.Min="min",r.MinOverTime="min_over_time",r.Minute="minute",r.Month="month",r.Pi="pi",r.PredictLinear="predict_linear",r.Present="present",r.PresentOverTime="present_over_time",r.Quantile="quantile",r.QuantileOverTime="quantile_over_time",r.Rad="rad",r.Rate="rate",r.Resets="resets",r.Round="round",r.Scalar="scalar",r.Sgn="sgn",r.Sin="sin",r.Sinh="sinh",r.Sort="sort",r.SortDesc="sort_desc",r.Sqrt="sqrt",r.Stddev="stddev",r.StddevOverTime="stddev_over_time",r.Sum="sum",r.SumOverTime="sum_over_time",r.Tan="tan",r.Tanh="tanh",r.Time="time",r.Timestamp="timestamp",r.TopK="topk",r.Vector="vector",r.Year="year",r.Addition="__addition",r.Subtraction="__subtraction",r.MultiplyBy="__multiply_by",r.DivideBy="__divide_by",r.Modulo="__modulo",r.Exponent="__exponent",r.NestedQuery="__nested_query",r.EqualTo="__equal_to",r.NotEqualTo="__not_equal_to",r.GreaterThan="__greater_than",r.LessThan="__less_than",r.GreaterOrEqual="__greater_or_equal",r.LessOrEqual="__less_or_equal",r))(s||{}),l=(r=>(r.Rate="rate",r.Histogram="histogram",r.Binary="binary",r))(l||{})},33115:(k,A,e)=>{"use strict";e.d(A,{$i:()=>o,Dr:()=>i});var n=e(70416),s=e(47232),l=e(77678),r=e(67414);const i="10m",g=d=>`${d.type}|${d.name}|${JSON.stringify(d.labels??"")}`;class o{constructor(c){this.cache=new Map;const a=c.overlapString;if((0,n.di)(a)){const p=(0,n.E9)(a);this.overlapWindowMs=(0,n.WT)(p)}else{const p=(0,n.E9)(i);this.overlapWindowMs=(0,n.WT)(p)}this.getTargetSignature=c.getTargetSignature}requestInfo(c){const a=c.range.from.valueOf(),p=c.range.to.valueOf(),u=c.rangeRaw?.to?.toString()==="now";let m=u,v;const x=new Map;c.targets.forEach(f=>{let E=`${c.dashboardUID}|${c.panelId}|${f.refId}`,h=this.getTargetSignature(c,f);x.set(E,h)});for(const[f,E]of x){let h=this.cache.get(f);if(h?.sig!==E?m=!1:(v=h?.prevTo??1/0,m=p>v&&a<=v),!m)break}if(m&&v){let f=Math.max(v-this.overlapWindowMs,a);const E=(0,s.KQ)(p),h=(0,s.KQ)((0,l.rs)(f,c.intervalMs));c={...c,range:{...c.range,from:h,to:E}}}else x.forEach((f,E)=>{this.cache.delete(E)});return{requests:[c],targSigs:x,shouldCache:u}}procFrames(c,a,p){if(a?.shouldCache){const u=c.range.from.valueOf(),m=c.range.to.valueOf(),v=new Map;p.forEach(f=>{let E=`${c.dashboardUID}|${c.panelId}|${f.refId}`,h=v.get(E);h||(h=[],v.set(E,h)),h.push(f)});let x=[];v.forEach((f,E)=>{let h=(E?this.cache.get(E)?.frames:null)??[];f.forEach(b=>{if(b.length===0||b.fields.length===0)return;let D=g(b.fields[1]),P=h.find(C=>g(C.fields[1])===D);if(!P)h.push(b);else{let C=P.fields.map(R=>R.values),M=b.fields.map(R=>R.values),I=(0,r.c)(C,M);if(I){for(let R=0;R<I.length;R++)P.fields[R].values=I[R];P.length=P.fields[0].values.length}}});let y=[];h.forEach(b=>{let D=b.fields.map(C=>C.values),P=(0,r.F)(D,u,m);if(P[0].length>0){for(let C=0;C<P.length;C++)b.fields[C].values=P[C];y.push(b)}}),this.cache.set(E,{sig:a.targSigs.get(E),frames:y,prevTo:m}),x.push(...y)}),p=x.map(f=>({...f,fields:f.fields.map(E=>({...E,config:{...E.config},values:E.values.slice()}))}))}return p}}},59809:(k,A,e)=>{"use strict";e.d(A,{Bm:()=>I,J3:()=>v,L:()=>R,hF:()=>P});var n=e(2543),s=e.n(n),l=e(41987),r=e(41260),i=e(11261),g=e(28240),o=e(52622),d=e(57875),c=e(32264),a=e(19347);const p=/^[+-]?inf(?:inity)?$/i,u=(T,S)=>S.app===l.Jk.Explore&&(T.meta?.custom?.resultType==="vector"||T.meta?.custom?.resultType==="scalar")?!0:S.targets.find(O=>O.refId===T.refId)?.format==="table",m=(T,S)=>T.meta?.type===r.m.HeatmapCells?!1:S.targets.find(O=>O.refId===T.refId)?.format==="heatmap";function v(T,S,L){c.$.featureToggles.prometheusDataplane&&T.data.forEach(G=>{const te=S.targets.find(H=>H.refId===G.refId);te&&te.legendFormat==="__auto"&&G.fields.forEach(H=>{if(H.labels?.__name__&&H.labels?.__name__===H.name){const se={...H,name:i.Bc};H.config.displayNameFromDS=(0,g.Ct)(se,G,T.data)}})});const[O,j]=(0,n.partition)(T.data,G=>u(G,S)),N=f(O),[F,U]=(0,n.partition)(j,G=>G.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:w}=L,B=F.map(G=>{if(w?.length)for(const te of w){const H=G.fields.find(se=>se.name===te.name);if(H){const se=h(te);H.config.links=H.config.links?.length?[...H.config.links,...se]:se}}return{...G,meta:{...G.meta,dataTopic:o.QR.Annotations}}}),[K,W]=(0,n.partition)(U,G=>m(G,S));K.forEach(G=>{if(G.name==null){let te=G.fields.find(H=>H.type===i.PU.number);if(te){let H=te.labels?.le;H&&(G.name=H,te.config.displayNameFromDS=H)}}});const z=(0,n.groupBy)(K,G=>G.refId);let Y=[];for(const G in z){const te=z[G],H=(0,n.groupBy)(te,se=>{const ne=se.fields.find(le=>le.type===i.PU.number);if(ne?.labels&&x in ne.labels){const{le,..._}=ne?.labels;return Object.values(_).join()}return Object.values(ne?.labels??[]).join()});(0,n.forOwn)(H,(se,ne)=>{const le=se.sort(I);Y.push(C(M(le)))})}const X=W.map(G=>({...G,meta:{...G.meta,preferredVisualisationType:"graph"}})),q=(0,n.flatten)(Y);return{...T,data:[...X,...N,...q,...B]}}const x="le";function f(T){if(T.length===0||T.length===1&&T[0].length===0)return T;const S=(0,n.groupBy)(T,"refId"),L=Object.keys(S);return L.map(j=>{const N=E(L.length,j),F=D({data:[],valueName:N}),U=b([]),w=[];S[j].forEach(K=>{const z=K.fields[1]?.labels??{};Object.keys(z).sort().forEach(Y=>{if(!w.some(X=>X.name===Y)){const X=Y===x;w.push({name:Y,config:{filterable:!0},type:X?i.PU.number:i.PU.string,values:[]})}})}),S[j].forEach(K=>{const W=K.fields[0]?.values??[],z=K.fields[1]?.values??[];W.forEach(Y=>U.values.push(Y)),z.forEach(Y=>{F.values.push(R(Y));const X=K.fields[1].labels??{};w.forEach(q=>q.values.push(y(X,q.name)))})});const B=[U,...w,F];return{refId:j,fields:B,meta:{...S[j][0].meta,preferredVisualisationType:"rawPrometheus"},length:U.values.length}})}function E(T,S=""){return T>1?`Value #${S}`:"Value"}function h(T){const S=[];if(T.datasourceUid){const O=(0,a.l)().getInstanceSettings(T.datasourceUid);O&&S.push({title:T.urlDisplayLabel||`Query with ${O?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:T.datasourceUid,datasourceName:O?.name??"Data source not found"}})}return T.url&&S.push({title:T.urlDisplayLabel||`Go to ${T.url}`,url:T.url,targetBlank:!0}),S}function y(T,S){return T.hasOwnProperty(S)?S===x?R(T[S]):T[S]:""}function b(T,S=!1){return{name:i.LE,type:i.PU.time,config:{},values:T.map(L=>S?L[0]:L[0]*1e3)}}function D({data:T,valueName:S=i.Bc,parseValue:L=!0,labels:O,displayNameFromDS:j}){return{name:S,type:i.PU.number,display:(0,d.J)(),config:{displayNameFromDS:j},labels:O,values:T.map(N=>L?R(N[1]):N[1])}}function P(T){const S=T.__name__||"";delete T.__name__;const L=Object.entries(T).map(O=>`${O[0]}="${O[1]}"`).join(",");return`${S}{${L}}`}function C(T){if(T.length===0||T.length===1&&T[0].length===0)return[];const S=T[0].fields.find(O=>O.type===i.PU.time),L=T.map(O=>{let j=O.fields.find(N=>N.type===i.PU.number);return{...j,name:j.config.displayNameFromDS}});return[{...T[0],meta:{...T[0].meta,type:r.m.HeatmapRows},fields:[S,...L]}]}function M(T){for(let S=T.length-1;S>0;S--){const L=T[S].fields.find(j=>j.type===i.PU.number),O=T[S-1].fields.find(j=>j.type===i.PU.number);if(!L||!O)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let j=0;j<L.values.length;j++){const N=O.values[j]||[0];L.values[j]-=N,L.values[j]<1e-9&&(L.values[j]=0)}}return T}function I(T,S){let L,O;try{L=R(T.fields[1].state?.displayName??T.name??T.fields[1].name),O=R(S.fields[1].state?.displayName??S.name??S.fields[1].name)}catch(j){return console.error(j),0}return L>O?1:L<O?-1:0}function R(T){return p.test(T)?T[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(T)}},62183:(k,A,e)=>{"use strict";e.d(A,{B4:()=>r,N1:()=>s,fD:()=>n,m_:()=>l});var n=(i=>(i.Low="Low",i.Medium="Medium",i.High="High",i.None="None",i))(n||{}),s=(i=>(i.Cortex="Cortex",i.Mimir="Mimir",i.Prometheus="Prometheus",i.Thanos="Thanos",i))(s||{}),l=(i=>(i.Auto="__auto",i.Verbose="__verbose",i.Custom="__custom",i))(l||{}),r=(i=>(i[i.LabelNames=0]="LabelNames",i[i.LabelValues=1]="LabelValues",i[i.MetricNames=2]="MetricNames",i[i.VarQueryResult=3]="VarQueryResult",i[i.SeriesQuery=4]="SeriesQuery",i[i.ClassicQuery=5]="ClassicQuery",i))(r||{})},27642:(k,A,e)=>{"use strict";e.d(A,{L:()=>s,y:()=>l});var n=e(32264);function s(r){return{grafana_version:n.$.buildInfo.version,plugin_type:String(r.type),plugin_version:r.info.version,plugin_id:r.id,plugin_name:r.name}}function l(r){return{...s(r.meta),datasource_uid:r.uid}}},44027:(k,A,e)=>{"use strict";e.d(A,{G:()=>o});var n=e(96540),s=e(92470),l=e(95187),r=e(14110),i=e(27642);const g="grafana_plugin_";function o(){const c=(0,s.Q)();return(0,n.useMemo)(()=>{const a=(0,l.S)(c)?(0,i.y)(c.instanceSettings):(0,i.L)(c.meta);return(p,u)=>{if(!d(p))throw new Error(`Interactions reported in plugins should start with: "${g}".`);return(0,r.rR)(p,{...u,...a})}},[c])}function d(c){return c.startsWith(g)&&c.length>g.length}},61298:(k,A,e)=>{"use strict";e.d(A,{fX:()=>l,nB:()=>s,n_:()=>n,p6:()=>r});var n=(i=>(i.DashboardView="dashboard-view",i.DataRequest="data-request",i))(n||{});const s=i=>!!i.payload.page,l=i=>!!i.payload.interactionName,r=i=>!!i.payload.experimentId},14110:(k,A,e)=>{"use strict";e.d(A,{G$:()=>r,Jy:()=>i,Xp:()=>o,rR:()=>g});var n=e(32264),s=e(39601),l=e(63415);const r=d=>{(0,l.x$)().addEvent({type:l.on.MetaAnalytics,payload:d})},i=()=>{const d=s.Ny.getLocation(),c=`${n.$.appSubUrl??""}${d.pathname}${d.search}${d.hash}`;(0,l.x$)().addEvent({type:l.on.Pageview,payload:{page:c}})},g=(d,c)=>{n.$.reportingStaticContext&&n.$.reportingStaticContext instanceof Object&&(c={...c,...n.$.reportingStaticContext}),(0,l.x$)().addEvent({type:l.on.Interaction,payload:{interactionName:d,properties:c}})},o=(d,c,a)=>{(0,l.x$)().addEvent({type:l.on.ExperimentView,payload:{experimentId:d,experimentGroup:c,experimentVariant:a}})}},55882:(k,A,e)=>{"use strict";e.d(A,{s:()=>p});var n=e(74848),s=e(96540),l=e(22391),r=e(51527),i=e(13544),g=e(90182),o=e(67061),d=e(98624),c=e(19347),a=e(26657);class p extends s.PureComponent{constructor(m){super(m),this.dataSourceSrv=(0,c.l)(),this.state={},this.onChange=(v,x)=>{if(x.action==="clear"&&this.props.onClear){this.props.onClear();return}const f=this.dataSourceSrv.getInstanceSettings(v.value);f&&(this.props.onChange(f),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:m}=this.props;this.dataSourceSrv.getInstanceSettings(m)||this.setState({error:"Could not find data source "+m})}getCurrentValue(){const{current:m,hideTextValue:v,noDefault:x}=this.props;if(!m&&x)return;const f=this.dataSourceSrv.getInstanceSettings(m);if(f)return{label:f.name.slice(0,37),value:f.uid,imgUrl:f.meta.info.logos.small,hideText:v,meta:f.meta};const E=(0,l.Iz)(m);return E===a.dR.uid||E===a.dR.name?{label:E,value:E,hideText:v}:{label:(E??"no name")+" - not found",value:E??void 0,imgUrl:"",hideText:v}}getDataSourceOptions(){const{alerting:m,tracing:v,metrics:x,mixed:f,dashboard:E,variables:h,annotations:y,pluginId:b,type:D,filter:P,logs:C}=this.props;return this.dataSourceSrv.getList({alerting:m,tracing:v,metrics:x,logs:C,dashboard:E,mixed:f,variables:h,annotations:y,pluginId:b,filter:P,type:D}).map(I=>({value:I.name,label:`${I.name}${I.isDefault?" (default)":""}`,imgUrl:I.meta.info.logos.small,meta:I.meta}))}render(){const{autoFocus:m,onBlur:v,onClear:x,openMenuOnFocus:f,placeholder:E,width:h,inputId:y,disabled:b=!1,isLoading:D=!1}=this.props,{error:P}=this.state,C=this.getDataSourceOptions(),M=this.getCurrentValue(),I=typeof x=="function";return(0,n.jsx)("div",{"aria-label":"Data source picker select container","data-testid":i.Tp.components.DataSourcePicker.container,children:(0,n.jsx)(g.l6,{isLoading:D,disabled:b,"aria-label":"Select a data source","data-testid":i.Tp.components.DataSourcePicker.inputV2,inputId:y||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:I,backspaceRemovesValue:!1,onChange:this.onChange,options:C,autoFocus:m,onBlur:v,width:h,openMenuOnFocus:f,maxMenuHeight:500,placeholder:E,noOptionsMessage:"No datasources found",value:M??null,invalid:!!P||!!this.props.invalid,getOptionLabel:R=>R.meta&&(0,r.x)(R.meta.signature)&&R!==M?(0,n.jsxs)(o.B,{alignItems:"center",justifyContent:"space-between",children:[(0,n.jsx)("span",{children:R.label})," ",(0,n.jsx)(d.B,{status:R.meta.signature})]}):R.label||""})})}}},96937:(k,A,e)=>{"use strict";e.d(A,{f:()=>n,p:()=>s});let n=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function s(l){n=l}},97152:(k,A,e)=>{"use strict";e.d(A,{a:()=>s,e:()=>l});var n=e(74848);let s=({message:r})=>(0,n.jsxs)("div",{children:["Unable to render data: ",r,"."]});function l(r){s=r}},24308:(k,A,e)=>{"use strict";e.d(A,{Y:()=>l,m:()=>s});var n=e(74848);let s=()=>(0,n.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function l(r){s=r}},46235:(k,A,e)=>{"use strict";e.d(A,{V:()=>s,l:()=>l});var n=e(74848);let s=({children:r})=>(0,n.jsx)("div",{children:r});function l(r){s=r}},32264:(k,A,e)=>{"use strict";e.d(A,{$:()=>a,p:()=>i});var n=e(2543),s=e.n(n),l=e(42994),r=e(97594);class i{constructor(u){this.publicDashboardsEnabled=!0,this.snapshotEnabled=!0,this.datasources={},this.panels={},this.apps={},this.auth={},this.minRefreshInterval="",this.appUrl="",this.appSubUrl="",this.namespace="default",this.windowTitlePrefix="",this.newPanelTitle="",this.externalUserMngLinkUrl="",this.externalUserMngLinkName="",this.externalUserMngInfo="",this.allowOrgCreate=!1,this.feedbackLinksEnabled=!0,this.disableLoginForm=!1,this.defaultDatasource="",this.angularSupportEnabled=!1,this.authProxyEnabled=!1,this.exploreEnabled=!1,this.queryHistoryEnabled=!1,this.helpEnabled=!1,this.profileEnabled=!1,this.newsFeedEnabled=!0,this.ldapEnabled=!1,this.jwtHeaderName="",this.jwtUrlLogin=!1,this.sigV4AuthEnabled=!1,this.azureAuthEnabled=!1,this.secureSocksDSProxyEnabled=!1,this.samlEnabled=!1,this.samlName="",this.autoAssignOrg=!0,this.verifyEmailEnabled=!1,this.oauth={},this.rbacEnabled=!0,this.disableUserSignUp=!1,this.loginHint="",this.passwordHint="",this.loginError=void 0,this.viewersCanEdit=!1,this.editorsCanAdmin=!1,this.disableSanitizeHtml=!1,this.trustedTypesDefaultPolicyEnabled=!1,this.cspReportOnlyEnabled=!1,this.liveEnabled=!0,this.featureToggles={},this.anonymousEnabled=!1,this.anonymousDeviceLimit=void 0,this.licenseInfo={},this.rendererAvailable=!1,this.rendererVersion="",this.rendererDefaultImageWidth=1e3,this.rendererDefaultImageHeight=500,this.rendererDefaultImageScale=1,this.secretsManagerPluginEnabled=!1,this.supportBundlesEnabled=!1,this.http2Enabled=!1,this.grafanaJavascriptAgent={enabled:!1,customEndpoint:"",apiKey:"",errorInstrumentalizationEnabled:!0,consoleInstrumentalizationEnabled:!1,webVitalsInstrumentalizationEnabled:!1,tracingInstrumentalizationEnabled:!1},this.pluginCatalogURL="https://grafana.com/grafana/plugins/",this.pluginAdminEnabled=!0,this.pluginAdminExternalManageEnabled=!1,this.pluginCatalogHiddenPlugins=[],this.pluginCatalogManagedPlugins=[],this.pluginsCDNBaseURL="",this.expressionsEnabled=!1,this.awsAllowedAuthProviders=[],this.awsAssumeRoleEnabled=!1,this.azure={managedIdentityEnabled:!1,workloadIdentityEnabled:!1,userIdentityEnabled:!1,userIdentityFallbackCredentialsEnabled:!1,azureEntraPasswordCredentialsEnabled:!1},this.caching={enabled:!1},this.unifiedAlertingEnabled=!1,this.unifiedAlerting={minInterval:"",alertStateHistoryBackend:void 0,alertStateHistoryPrimary:void 0},this.recordedQueries={enabled:!0},this.featureHighlights={enabled:!1},this.reporting={enabled:!0},this.analytics={enabled:!0},this.googleAnalytics4SendManualPageViews=!1,this.sqlConnectionLimits={maxOpenConns:100,maxIdleConns:100,connMaxLifetime:14400},this.disableFrontendSandboxForPlugins=[],this.cloudMigrationFeedbackURL="",this.cloudMigrationPollIntervalMs=2e3,this.exploreDefaultTimeOffset="1h",this.bootData=u.bootData;const m={datasources:{},windowTitlePrefix:"Grafana - ",panels:{},newPanelTitle:"Panel Title",playlist_timespan:"1m",unsaved_changes_warning:!0,appUrl:"",appSubUrl:"",buildInfo:{version:"1.0",commit:"1",env:"production"},viewersCanEdit:!1,editorsCanAdmin:!1,disableSanitizeHtml:!1};(0,n.merge)(this,m,u),this.buildInfo=u.buildInfo||m.buildInfo,this.dateFormats&&l.WC.update(this.dateFormats),o(this),g(this),this.featureToggles.disableAngular&&(this.angularSupportEnabled=!1),this.theme2=(0,r.g)(this.bootData.user.theme),this.bootData.user.lightTheme=this.theme2.isLight,this.theme=this.theme2.v1}}function g(p){const u=p.featureToggles,v=window.localStorage.getItem("grafana.featureToggles");if(v){const x=v.split(",");for(const f of x){const[E,h]=f.split("="),y=h==="true"||h==="1";u[E]=y,console.log(`Setting feature toggle ${E} = ${y} via localstorage`)}}}function o(p){if(window.location.href.indexOf("__feature")===-1)return;const u=p.buildInfo.env==="development",m=new Set(["queryServiceFromUI"]);new URLSearchParams(window.location.search).forEach((x,f)=>{if(f.startsWith("__feature.")){const E=p.featureToggles,h=f.substring(10),y=x==="true"||x==="";y!==E[f]&&(u||m.has(h)?(E[h]=y,console.log(`Setting feature toggle ${h} = ${y} via url`)):console.log(`Unable to change feature toggle ${h} via url in production.`))}})}const d=window.grafanaBootData||{settings:{},user:{},navTree:[]},c=d.settings;c.bootData=d;const a=new i(c)},7117:(k,A,e)=>{"use strict";e.r(A),e.d(A,{CopyPanelEvent:()=>a.ah,DataSourcePicker:()=>L.s,DataSourceWithBackend:()=>P.iy,EchoEventType:()=>i.on,EmbeddedDashboard:()=>U.f,FakeEchoSrv:()=>i.c_,GrafanaBootConfig:()=>f.p,HealthCheckError:()=>P.b1,HealthStatus:()=>P.VQ,HistoryWrapper:()=>c.K9,LocationServiceProvider:()=>c._K,MetaAnalyticsEventName:()=>E.n_,PanelDataErrorView:()=>I.a,PanelRenderer:()=>M.m,PluginPage:()=>S.V,RefreshEvent:()=>a._,StreamingFrameAction:()=>d.Kh,ThemeChangedEvent:()=>a.E8,TimeRangeUpdatedEvent:()=>a.sR,config:()=>f.$,createDataSourcePluginEventProperties:()=>O.y,createMonitoringLogger:()=>D.DW,createPluginEventProperties:()=>O.L,createQueryRunner:()=>T.d,featureEnabled:()=>b.a,frameToMetricFindValue:()=>C.$h,getAngularLoader:()=>s.E,getAppEvents:()=>a.J7,getBackendSrv:()=>n.AI,getDataSourceSrv:()=>l.l,getEchoSrv:()=>i.x$,getGrafanaLiveSrv:()=>d.oF,getLegacyAngularInjector:()=>o.C,getLocationSrv:()=>r.X,getPluginComponentExtensions:()=>p.Dp,getPluginExtensions:()=>p.O3,getPluginImportUtils:()=>h.o,getPluginLinkExtensions:()=>p.Kf,getRunRequest:()=>T.XJ,getTemplateSrv:()=>g.w,hasAllPermissions:()=>W,hasAnyPermission:()=>z,hasPermission:()=>B,hasPermissionInMetadata:()=>K,isExperimentViewEvent:()=>E.p6,isExpressionReference:()=>P.s9,isFetchError:()=>n.NF,isInteractionEvent:()=>E.fX,isPageviewEvent:()=>E.nB,isPluginExtensionComponent:()=>v.a,isPluginExtensionLink:()=>v.D,loadPluginCss:()=>h.PL,locationSearchToObject:()=>c.SE,locationService:()=>c.Ny,logDebug:()=>D.MD,logError:()=>D.vV,logInfo:()=>D.fH,logWarning:()=>D.FF,navigationLogger:()=>c.Lc,registerEchoBackend:()=>i.pl,reportExperimentView:()=>y.Xp,reportInteraction:()=>y.rR,reportMetaAnalytics:()=>y.G$,reportPageview:()=>y.Jy,setAngularLoader:()=>s.w,setAppEvents:()=>a.H8,setBackendSrv:()=>n.u5,setChromeHeaderHeightHook:()=>F._,setCurrentUser:()=>x.l,setDataSourceSrv:()=>l.h,setEchoSrv:()=>i.H2,setEmbeddedDashboard:()=>U.p,setGrafanaLiveSrv:()=>d.S8,setLegacyAngularInjector:()=>o.j,setLocationService:()=>c.vG,setLocationSrv:()=>r.T,setPluginComponentHook:()=>m.A,setPluginExtensionGetter:()=>p.cE,setPluginExtensionsHook:()=>u.Vu,setPluginImportUtils:()=>h.se,setQueryRunnerFactory:()=>T.HC,setReturnToPreviousHook:()=>N._,setRunRequest:()=>T.pC,setTemplateSrv:()=>g.d,toDataQueryError:()=>R.u,toDataQueryResponse:()=>C.bE,useChromeHeaderHeight:()=>F.k,useLocationService:()=>c.at,usePluginComponent:()=>m.S,usePluginComponentExtensions:()=>u.kr,usePluginComponents:()=>u.f_,usePluginExtensions:()=>u.pc,usePluginInteractionReporter:()=>j.G,usePluginLinkExtensions:()=>u.vl,usePluginLinks:()=>u.Ux,useReturnToPrevious:()=>N.i});var n=e(17172),s=e(7376),l=e(19347),r=e(23509),i=e(63415),g=e(72574),o=e(81634),d=e(78731),c=e(39601),a=e(3591),p=e(4402),u=e(3197),m=e(79396),v=e(80882),x=e(61706),f=e(32264),E=e(61298),h=e(89191),y=e(14110),b=e(33378),D=e(34867),P=e(26657),C=e(47773),M=e(24308),I=e(97152),R=e(12091),T=e(63639),S=e(46235),L=e(55882),O=e(27642),j=e(44027),N=e(14778),F=e(23172),U=e(96937),w=e(29263);const B=Y=>(0,w.ZU)(Y,(0,x.H)()),K=(Y,X)=>(0,w.T6)(Y,X),W=Y=>(0,w.Fj)(Y,(0,x.H)()),z=Y=>(0,w.jW)(Y,(0,x.H)())},7376:(k,A,e)=>{"use strict";e.d(A,{E:()=>l,w:()=>s});let n;function s(r){n=r}function l(){return n}},63415:(k,A,e)=>{"use strict";e.d(A,{H2:()=>l,c_:()=>g,on:()=>n,pl:()=>i,x$:()=>r});var n=(o=>(o.Performance="performance",o.MetaAnalytics="meta-analytics",o.Pageview="pageview",o.Interaction="interaction",o.ExperimentView="experimentview",o.GrafanaJavascriptAgent="grafana-javascript-agent",o))(n||{});let s;function l(o){if(s instanceof g)for(const d of s.buffer)o.addEvent(d.event,d.meta);s=o}function r(){return s||(s=new g),s}const i=o=>{r().addBackend(o)};class g{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(d){}addEvent(d,c){this.buffer.push({event:d,meta:c})}}},39601:(k,A,e)=>{"use strict";e.d(A,{K9:()=>c,Lc:()=>v,Ny:()=>p,SE:()=>a,_K:()=>E,at:()=>f,vG:()=>u});var n=e(74848),s=e(17929),l=e(96540),r=e(76885),i=e(95344),g=e(91040),o=e(40621),d=e(32264);class c{constructor(y){this.history=y||s.zR({basename:d.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(y,b){const D=this.history.location,P=this.getSearchObject();for(const M in y)y[M]===null||y[M]===void 0?delete P[M]:P[M]=y[M];const C=r.kM.renderUrl(D.pathname,P);b?this.history.replace(C,this.history.location.state):this.history.push(C,this.history.location.state)}push(y){this.history.push(y)}replace(y){this.history.replace(y)}reload(){const y=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:y?y+1:1}})}getLocation(){return this.history.location}getSearchObject(){return a(this.history.location.search)}update(y){if((0,i.l)("LocationSrv","update","partial, push or replace"),y.partial&&y.query)this.partial(y.query,y.partial);else{const b={pathname:y.path};y.query&&(b.search=r.kM.toUrlParams(y.query)),y.replace?this.replace(b):this.push(b)}}}function a(h){let y=typeof h=="number"?String(h):h;return y.length>0?y.startsWith("?")?r.kM.parseKeyValue(y.substring(1)):r.kM.parseKeyValue(y):{}}let p=new c;const u=h=>{throw new Error("locationService can be only overriden in test environment")},m=(0,g.h)("Router"),v=m.logger;(0,o.h)("location",p,m);const x=l.createContext(void 0);function f(){const h=(0,l.useContext)(x);if(!h)throw new Error("useLocationService must be used within a LocationServiceProvider");return h}const E=({service:h,children:y})=>(0,n.jsx)(x.Provider,{value:h,children:y})},23509:(k,A,e)=>{"use strict";e.d(A,{T:()=>s,X:()=>l});let n;function s(r){n=r}function l(){return n}},63639:(k,A,e)=>{"use strict";e.d(A,{HC:()=>s,XJ:()=>g,d:()=>l,pC:()=>i});let n;const s=o=>{if(n)throw new Error("Runner should only be set when Grafana is starting.");n=o},l=()=>{if(!n)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return n()};let r;function i(o){if(r)throw new Error("runRequest function should only be set once, when Grafana is starting.");r=o}function g(){if(!r)throw new Error("getRunRequest can only be used after Grafana instance has started.");return r}},3591:(k,A,e)=>{"use strict";e.d(A,{E8:()=>l,H8:()=>o,J7:()=>d,_:()=>s,ah:()=>i,sR:()=>r});var n=e(65463);class s extends n.a{static{this.type="refresh"}}class l extends n.x{static{this.type="theme-changed"}}class r extends n.x{static{this.type="time-range-updated"}}class i extends n.x{static{this.type="copy-panel"}}let g;function o(c){g=c}function d(){return g}},17172:(k,A,e)=>{"use strict";e.d(A,{AI:()=>r,NF:()=>n,u5:()=>l});function n(i){return typeof i=="object"&&i!==null&&"status"in i&&"data"in i}let s;const l=i=>{s=i},r=()=>s},19347:(k,A,e)=>{"use strict";e.d(A,{h:()=>s,l:()=>l});let n;function s(r){n=r}function l(){return n}},81634:(k,A,e)=>{"use strict";e.d(A,{C:()=>l,j:()=>s});let n;const s=r=>{n=r},l=()=>n},78731:(k,A,e)=>{"use strict";e.d(A,{Kh:()=>n.Kh,S8:()=>l,oF:()=>r});var n=e(9631);let s;const l=i=>{s=i},r=()=>s},4402:(k,A,e)=>{"use strict";e.d(A,{Dp:()=>o,Kf:()=>g,O3:()=>i,cE:()=>l});var n=e(80882);let s;function l(d){if(s)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");s=d}function r(){if(!s)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return s}const i=d=>r()(d),g=d=>{const{extensions:c}=i(d);return{extensions:c.filter(n.D)}},o=d=>{const{extensions:c}=i(d);return{extensions:c.filter(n.a)}}},79396:(k,A,e)=>{"use strict";e.d(A,{A:()=>s,S:()=>l});let n;function s(r){if(n)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");n=r}function l(r){if(!n)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return n(r)}},3197:(k,A,e)=>{"use strict";e.d(A,{Ux:()=>g,Vu:()=>r,f_:()=>o,kr:()=>c,pc:()=>i,vl:()=>d});var n=e(96540),s=e(80882);let l;function r(a){if(l)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");l=a}function i(a){if(!l)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return l(a)}function g(a){const{extensions:p,isLoading:u}=i(a);return(0,n.useMemo)(()=>({links:p.filter(s.D),isLoading:u}),[p,u])}function o(a){const{extensions:p,isLoading:u}=i(a);return(0,n.useMemo)(()=>({components:p.filter(s.a).map(({component:m})=>m),isLoading:u}),[p,u])}function d(a){const{extensions:p,isLoading:u}=i(a);return(0,n.useMemo)(()=>({extensions:p.filter(s.D),isLoading:u}),[p,u])}function c(a){const{extensions:p,isLoading:u}=i(a);return(0,n.useMemo)(()=>({extensions:p.filter(s.a),isLoading:u}),[p,u])}},80882:(k,A,e)=>{"use strict";e.d(A,{D:()=>s,a:()=>l});var n=e(74135);function s(r){return r?r.type===n.u.link&&("path"in r||"onClick"in r):!1}function l(r){return r?r.type===n.u.component&&"component"in r:!1}},72574:(k,A,e)=>{"use strict";e.d(A,{d:()=>s,w:()=>l});let n;const s=r=>{n=r},l=()=>n},61706:(k,A,e)=>{"use strict";e.d(A,{H:()=>l,l:()=>s});let n=null;function s(r){if(n)throw new Error("User should only be set once, when Grafana is starting.");n=r}function l(){if(!n)throw new Error("User can only be used after Grafana instance has started.");return n}},26657:(k,A,e)=>{"use strict";e.d(A,{iy:()=>C,dR:()=>h,b1:()=>b,VQ:()=>D,s9:()=>y,ph:()=>I,x7:()=>M});var n=e(62467),s=e(75505),l=e(44240),r=e(63720),i=e(66847),g=e(40187),o=e(22391),d=e(55004),c=e(89667),a=e(92341),p=e(32264),u=e(19347),m=e(78731),v=e(17172),x=e(9631),f=e(47773);function E(R){const{intervalMs:T,maxDataPoints:S,requestId:L,panelId:O,queryCachingTTL:j,range:{from:N,to:F}}=R;if(!R.targets.length)return(0,n.of)({data:[]});const U={intervalMs:T,maxDataPoints:S,queryCachingTTL:j,timeRange:{from:N.valueOf().toString(),to:F.valueOf().toString(),timezone:R.timezone}};return(0,v.AI)().fetch({url:`/api/public/dashboards/${p.$.publicDashboardAccessToken}/panels/${O}/query`,method:"POST",data:U,requestId:L}).pipe((0,r.n)(w=>(0,n.of)((0,f.bE)(w,R.targets))),(0,i.W)(w=>(0,n.of)((0,f.bE)(w))))}const h=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function y(R){if(!R)return!1;const T=typeof R=="string"?R:R.type;return T===h.type||T===h.name||T==="-100"}class b extends Error{constructor(T,S){super(T),this.details=S,this.name="HealthCheckError"}}var D=(R=>(R.Unknown="UNKNOWN",R.OK="OK",R.Error="ERROR",R))(D||{}),P=(R=>(R.PluginID="X-Plugin-Id",R.DatasourceUID="X-Datasource-Uid",R.DashboardUID="X-Dashboard-Uid",R.PanelID="X-Panel-Id",R.PanelPluginId="X-Panel-Plugin-Id",R.QueryGroupID="X-Query-Group-Id",R.FromExpression="X-Grafana-From-Expr",R.SkipQueryCache="X-Cache-Skip",R))(P||{});class C extends g.mA{constructor(T){super(T),this.streamOptionsProvider=I}query(T){if(p.$.publicDashboardAccessToken)return E(T);const{intervalMs:S,maxDataPoints:L,queryCachingTTL:O,range:j,requestId:N,hideFromInspector:F=!1}=T;let U=T.targets,w=!1;const B=new Set,K=new Set,W=U.map(q=>{let G=this.getRef(),te=this.id,H=!0;if(y(q.datasource))return w=!0,{...q,datasource:h};if(q.datasource){const se=(0,u.l)().getInstanceSettings(q.datasource,T.scopedVars);if(!se)throw new Error(`Unknown Datasource: ${JSON.stringify(q.datasource)}`);const ne=se.rawRef??(0,o.p$)(se),le=se.id;(ne.uid!==G.uid||te!==le)&&(G=ne,te=le,H=!1)}return G.type?.length&&B.add(G.type),G.uid?.length&&K.add(G.uid),{...H?this.applyTemplateVariables(q,T.scopedVars,T.filters):q,datasource:G,datasourceId:te,intervalMs:S,maxDataPoints:L,queryCachingTTL:O}});if(!W.length)return(0,n.of)({data:[]});const z={queries:W,from:j?.from.valueOf().toString(),to:j?.to.valueOf().toString()};if(p.$.featureToggles.queryOverLive)return(0,m.oF)().getQueryData({request:T,body:z});const Y={};Y["X-Plugin-Id"]=Array.from(B).join(", "),Y["X-Datasource-Uid"]=Array.from(K).join(", ");let X="/api/ds/query?ds_type="+this.type;return p.$.featureToggles.queryServiceFromUI&&(p.$.featureToggles.queryService||p.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!w&&K.size,X=`/apis/query.grafana.app/v0alpha1/namespaces/${p.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),w&&(Y["X-Grafana-From-Expr"]="true",X+="&expression=true"),N&&(X+=`&requestId=${N}`),T.dashboardUID&&(Y["X-Dashboard-Uid"]=T.dashboardUID,T.panelId&&(Y["X-Panel-Id"]=`${T.panelId}`)),T.panelPluginId&&(Y["X-Panel-Plugin-Id"]=`${T.panelPluginId}`),T.queryGroupId&&(Y["X-Query-Group-Id"]=`${T.queryGroupId}`),T.skipQueryCache&&(Y["X-Cache-Skip"]="true"),(0,v.AI)().fetch({url:X,method:"POST",data:z,requestId:N,hideFromInspector:F,headers:Y}).pipe((0,r.n)(q=>{const G=(0,f.bE)(q,W);return G.data?.length&&G.data.find(te=>te.meta?.channel)?M(G,T,this.streamOptionsProvider):(0,n.of)(G)}),(0,i.W)(q=>(0,n.of)((0,f.bE)(q))))}getRequestHeaders(){const T={};return T["X-Plugin-Id"]=this.type,T["X-Datasource-Uid"]=this.uid,T}interpolateVariablesInQueries(T,S,L){return T.map(O=>this.applyTemplateVariables(O,S,L))}applyTemplateVariables(T,S,L){return T}async getResource(T,S,L){const O=this.getRequestHeaders();return(await(0,s.s)((0,v.AI)().fetch({...L,method:"GET",headers:L?.headers?{...L.headers,...O}:O,params:S??L?.params,url:`/api/datasources/uid/${this.uid}/resources/${T}`}))).data}async postResource(T,S,L){const O=this.getRequestHeaders();return(await(0,s.s)((0,v.AI)().fetch({...L,method:"POST",headers:L?.headers?{...L.headers,...O}:O,data:S??{...S},url:`/api/datasources/uid/${this.uid}/resources/${T}`}))).data}async callHealthCheck(){return(0,s.s)((0,v.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(T=>T.data).catch(T=>T.data)}async testDatasource(){return this.callHealthCheck().then(T=>T.status==="OK"?{status:"success",message:T.message}:Promise.reject({status:"error",message:T.message,error:new b(T.message,T.details)}))}}function M(R,T,S){const L=(0,m.oF)();if(!L)return(0,n.of)(R);const O=[],j=[];for(const N of R.data){const F=(0,d.DG)(N.meta?.channel);if(F){const U=N;j.push(L.getDataStream({addr:F,buffer:S(T,U),frame:(0,c.Nw)(N)}))}else O.push(N)}return O.length&&j.push((0,n.of)({...R,data:O})),j.length===1?j[0]:(0,l.h)(...j)}const I=(R,T)=>{const S={maxLength:R.maxDataPoints??500,action:x.Kh.Append};return R.rangeRaw?.to==="now"&&(S.maxDelta=R.range.to.valueOf()-R.range.from.valueOf()),S};C=(0,a.Y)(C)},23172:(k,A,e)=>{"use strict";e.d(A,{_:()=>s,k:()=>l});let n;const s=r=>{n=r},l=()=>(n||console.error("useChromeHeaderHeight hook not found"),n?.())},33378:(k,A,e)=>{"use strict";e.d(A,{a:()=>s});var n=e(32264);const s=l=>{const{enabledFeatures:r}=n.$.licenseInfo;return r&&r[l]}},34867:(k,A,e)=>{"use strict";e.d(A,{DW:()=>c,FF:()=>i,MD:()=>g,fH:()=>r,l$:()=>d,vV:()=>o});var n=e(32631),s=e(37930),l=e(32264);function r(a,p){l.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([a],{level:s.$b.INFO,context:p})}function i(a,p){l.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([a],{level:s.$b.WARN,context:p})}function g(a,p){l.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([a],{level:s.$b.DEBUG,context:p})}function o(a,p){l.$.grafanaJavascriptAgent.enabled&&n.P.api.pushError(a,{context:p})}function d(a,p,u){l.$.grafanaJavascriptAgent.enabled&&n.P.api.pushMeasurement({type:a,values:p,context:u})}function c(a,p){const u=m=>({source:a,...p,...m});return{logDebug:(m,v)=>g(m,u(v)),logInfo:(m,v)=>r(m,u(v)),logWarning:(m,v)=>i(m,u(v)),logError:(m,v)=>o(m,u(v)),logMeasurement:(m,v,x)=>d(m,v,u(x))}}},89191:(k,A,e)=>{"use strict";e.d(A,{PL:()=>s,o:()=>i,se:()=>r});var n=e(32264);async function s(g){try{const o=n.$.bootData.user.theme==="light"?g.light:g.dark;return window.System.import(o)}catch(o){console.error(o)}}let l;function r(g){if(l)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");l=g}function i(){if(!l)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return l}},47773:(k,A,e)=>{"use strict";e.d(A,{$h:()=>p,bE:()=>o});var n=e(39070),s=e(89667),l=e(14236),r=e(11261),i=e(12091);const g={severity:"info",text:"Cached response"};function o(u,m){const v={data:[],state:n.Gu.Done},x="traceId"in u?u.traceId:void 0;x!=null&&(v.traceIds=[x]);const f=u;if(f.data?.results){const E=f.data.results,h=m?.length?m.map(D=>D.refId):Object.keys(E),y=d(f),b=[];for(const D of h){const P=E[D];P&&(P.refId=D,b.push(P))}for(const D of b){if(D.error){const P={refId:D.refId,message:D.error,status:D.status};x!=null&&(P.traceId=x),v.error||(v.error={...P}),v.errors?v.errors.push({...P}):v.errors=[{...P}],v.state=n.Gu.Error}if(D.frames?.length){for(let P of D.frames){y&&(P=c(P));const C=(0,s.or)(P);C.refId||(C.refId=D.refId),v.data.push(C)}continue}if(D.series?.length)for(const P of D.series)P.refId||(P.refId=D.refId),v.data.push((0,l.Vc)(P));if(D.tables?.length)for(const P of D.tables)P.refId||(P.refId=D.refId),v.data.push((0,l.Vc)(P))}}return f.status&&f.status!==200&&(v.state!==n.Gu.Error&&(v.state=n.Gu.Error),v.error||(v.error=(0,i.u)(u))),v}function d(u){const m=u?.headers;return!m||!m.get?!1:m.get("X-Cache")==="HIT"}function c(u){return{...u,schema:{...u.schema,fields:[...u.schema?.fields??[]],meta:{...u.schema?.meta,notices:[...u.schema?.meta?.notices??[],g],isCachedResponse:!0}}}}function a(u){const m=o(u);if(m.error?.data?.message)return{status:"error",message:m.error.data.message,details:m.error?.data?.error?{message:m.error.data.error}:void 0};if(m.error?.refId&&m.error?.message)return{status:"error",message:m.error.message};throw u}function p(u){if(!u||!u.length)return[];const m=[];let v=u.fields.find(x=>x.type===r.PU.string);if(v||(v=u.fields.find(x=>x.type!==r.PU.time)),v)for(let x=0;x<v.values.length;x++)m.push({text:""+v.values[x]});return m}},14778:(k,A,e)=>{"use strict";e.d(A,{_:()=>s,i:()=>l});let n;const s=r=>{n=r},l=()=>n?n():()=>console.error("ReturnToPrevious hook not found")},52622:(k,A,e)=>{"use strict";e.d(A,{$N:()=>F,$l:()=>K,$m:()=>te,$p:()=>L,CD:()=>N,D7:()=>d,F8:()=>O,GR:()=>m,J1:()=>o,L4:()=>f,Lt:()=>b,Ly:()=>C,NU:()=>v,Nj:()=>y,ON:()=>D,QH:()=>s,QR:()=>n,RU:()=>r,SV:()=>j,T6:()=>z,TZ:()=>W,WQ:()=>l,Wq:()=>X,Y$:()=>p,aG:()=>g,dx:()=>x,eX:()=>B,fY:()=>H,gs:()=>h,lm:()=>M,ob:()=>Y,on:()=>E,qM:()=>G,q_:()=>i,uH:()=>c,vM:()=>a,vp:()=>le,wV:()=>R,xB:()=>U,yL:()=>u,yp:()=>S,zT:()=>se});var n=(_=>(_.AlertStates="alertStates",_.Annotations="annotations",_.Series="series",_))(n||{}),s=(_=>(_.Linear="linear",_.Quad="quad",_))(s||{}),l=(_=>(_.Clamped="clamped",_.Mod="mod",_))(l||{}),r=(_=>(_.Field="field",_.Fixed="fixed",_.Template="template",_))(r||{}),i=(_=>(_.Field="field",_.Fixed="fixed",_.Mapping="mapping",_))(i||{}),g=(_=>(_.Auto="auto",_.Coords="coords",_.Geohash="geohash",_.Lookup="lookup",_))(g||{}),o=(_=>(_.Count="count",_.Size="size",_))(o||{}),d=(_=>(_.auto="auto",_.ge="ge",_.le="le",_.unknown="unknown",_))(d||{}),c=(_=>(_.Ascending="Ascending",_.Descending="Descending",_))(c||{}),a=(_=>(_.Auto="auto",_.Bottom="bottom",_.Hidden="hidden",_.Left="left",_.Right="right",_.Top="top",_))(a||{}),p=(_=>(_.Series="series",_.Text="text",_))(p||{}),u=(_=>(_.Always="always",_.Auto="auto",_.Never="never",_))(u||{}),m=(_=>(_.Bars="bars",_.Line="line",_.Points="points",_))(m||{}),v=(_=>(_.Constant="constant",_.NegativeY="negative-Y",_))(v||{}),x=(_=>(_.Linear="linear",_.Smooth="smooth",_.StepAfter="stepAfter",_.StepBefore="stepBefore",_))(x||{}),f=(_=>(_.Linear="linear",_.Log="log",_.Ordinal="ordinal",_.Symlog="symlog",_))(f||{}),E=(_=>(_.Hue="hue",_.None="none",_.Opacity="opacity",_.Scheme="scheme",_))(E||{}),h=(_=>(_.None="none",_.Normal="normal",_.Percent="percent",_))(h||{}),y=(_=>(_[_.After=1]="After",_[_.Before=-1]="Before",_[_.Center=0]="Center",_))(y||{}),b=(_=>(_[_.Horizontal=0]="Horizontal",_[_.Vertical=1]="Vertical",_))(b||{}),D=(_=>(_[_.Down=-1]="Down",_[_.Left=-1]="Left",_[_.Right=1]="Right",_[_.Up=1]="Up",_))(D||{});const P={dash:[]};var C=(_=>(_.Area="area",_.Dashed="dashed",_.DashedAndArea="dashed+area",_.Line="line",_.LineAndArea="line+area",_.Off="off",_.Series="series",_))(C||{}),M=(_=>(_.Hidden="hidden",_.List="list",_.Table="table",_))(M||{});const I={calcs:[]};var R=(_=>(_.Auto="auto",_.Horizontal="horizontal",_.Vertical="vertical",_))(R||{});const T={timezone:[]};var S=(_=>(_.Background="background",_.BackgroundSolid="background_solid",_.None="none",_.Value="value",_))(S||{}),L=(_=>(_.Area="area",_.Line="line",_.None="none",_))(L||{}),O=(_=>(_.Auto="auto",_.Center="center",_))(O||{}),j=(_=>(_.Auto="auto",_.Name="name",_.None="none",_.Value="value",_.ValueAndName="value_and_name",_))(j||{}),N=(_=>(_.Inverted="inverted",_.SameAsValue="same_as_value",_.Standard="standard",_))(N||{}),F=(_=>(_.Multi="multi",_.None="none",_.Single="single",_))(F||{}),U=(_=>(_.Ascending="asc",_.Descending="desc",_.None="none",_))(U||{});const w={calcs:[]};var B=(_=>(_.Basic="basic",_.Gradient="gradient",_.Lcd="lcd",_))(B||{}),K=(_=>(_.Color="color",_.Hidden="hidden",_.Text="text",_))(K||{}),W=(_=>(_.Auto="auto",_.Left="left",_.Top="top",_))(W||{}),z=(_=>(_.Auto="auto",_.Manual="manual",_))(z||{}),Y=(_=>(_.Auto="auto",_.BasicGauge="basic",_.ColorBackground="color-background",_.ColorBackgroundSolid="color-background-solid",_.ColorText="color-text",_.Custom="custom",_.DataLinks="data-links",_.Gauge="gauge",_.GradientGauge="gradient-gauge",_.Image="image",_.JSONView="json-view",_.LcdGauge="lcd-gauge",_.Sparkline="sparkline",_))(Y||{}),X=(_=>(_.Basic="basic",_.Gradient="gradient",_))(X||{});const q={fields:[],reducer:[]};var G=(_=>(_.Auto="auto",_.Lg="lg",_.Md="md",_.Sm="sm",_))(G||{}),te=(_=>(_.CSV="csv",_.Date="date",_.Distributed="distributed",_.DoubleQuote="doublequote",_.Glob="glob",_.HTML="html",_.JSON="json",_.Lucene="lucene",_.PercentEncode="percentencode",_.Pipe="pipe",_.QueryParam="queryparam",_.Raw="raw",_.Regex="regex",_.SQLString="sqlstring",_.SingleQuote="singlequote",_.Text="text",_.UriEncode="uriencode",_))(te||{}),H=(_=>(_.exact="exact",_.none="none",_.numbers="numbers",_.signature="signature",_))(H||{}),se=(_=>(_.EQ="eq",_.GT="gt",_.GTE="gte",_.LT="lt",_.LTE="lte",_.NEQ="neq",_))(se||{});const ne={align:"auto",inspect:!1},le="browser"},33623:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>l,QB:()=>r});var n=e(52622);const s="11.2.0",l={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:n.wV.Auto,showValue:n.yL.Auto,stacking:n.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},r={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},16371:(k,A,e)=>{"use strict";e.d(A,{K:()=>l});var n=e(52622);const s="11.2.0",l={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},37827:(k,A,e)=>{"use strict";e.d(A,{K:()=>s});const n="11.2.0",s={selectedSeries:0}},44955:(k,A,e)=>{"use strict";e.d(A,{K:()=>l});var n=e(52622);const s="11.2.0",l={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto}},87487:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>s});const n="11.2.0",s={layers:[]},l={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var r=(g=>(g.Details="details",g.None="none",g))(r||{}),i=(g=>(g.Coords="coords",g.Fit="fit",g.Zero="zero",g))(i||{})},96529:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>g});var n=e(52622);const s="11.2.0";var l=(o=>(o.Opacity="opacity",o.Scheme="scheme",o))(l||{}),r=(o=>(o.Exponential="exponential",o.Linear="linear",o))(r||{}),i=(o=>(o.X="x",o.Xy="xy",o.Y="y",o))(i||{});const g={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:n.yL.Auto,tooltip:{mode:n.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>l,QB:()=>r});var n=e(52622);const s="11.2.0",l={bucketCount:30,bucketOffset:0},r={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},69383:(k,A,e)=>{"use strict";e.d(A,{K:()=>s});const n="11.2.0",s={showImage:!0}},65391:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>g});const n="11.2.0";var s=(o=>(o.Donut="donut",o.Pie="pie",o))(s||{}),l=(o=>(o.Name="name",o.Percent="percent",o.Value="value",o))(l||{}),r=(o=>(o.Percent="percent",o.Value="value",o))(r||{});const i={values:[]},g={displayLabels:[]}},89607:(k,A,e)=>{"use strict";e.d(A,{K:()=>l});var n=e(52622);const s="11.2.0",l={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0}},15821:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>l,QB:()=>r});var n=e(52622);const s="11.2.0",l={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:n.yL.Auto},r={fillOpacity:70,lineWidth:0}},64337:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>l,QB:()=>r});var n=e(52622);const s="11.2.0",l={colWidth:.9,rowHeight:.9,showValue:n.yL.Auto},r={fillOpacity:70,lineWidth:1}},52037:(k,A,e)=>{"use strict";e.d(A,{K:()=>l});var n=e(52622);const s="11.2.0",l={cellHeight:n.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>g});const n="11.2.0";var s=(o=>(o.Code="code",o.HTML="html",o.Markdown="markdown",o))(s||{}),l=(o=>(o.Go="go",o.Html="html",o.Json="json",o.Markdown="markdown",o.Plaintext="plaintext",o.Sql="sql",o.Typescript="typescript",o.Xml="xml",o.Yaml="yaml",o))(l||{});const r="plaintext",i={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},g={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(k,A,e)=>{"use strict";e.d(A,{KQ:()=>o,QB:()=>g});var n=e(52622);const s="11.2.0";var l=(d=>(d.Auto="auto",d.Manual="manual",d))(l||{}),r=(d=>(d.Lines="lines",d.Points="points",d.PointsAndLines="points+lines",d))(r||{});const i={exclude:[]},g={label:n.yL.Auto,show:"points"},o={series:[]}},73134:(k,A,e)=>{"use strict";e.d(A,{CO:()=>g,GW:()=>C,OA:()=>y,Ol:()=>u,QB:()=>P,Yb:()=>a,Ye:()=>M,ZG:()=>d,aD:()=>l,bf:()=>r,bt:()=>b,dM:()=>v,lt:()=>f,rw:()=>i,ss:()=>D,yV:()=>E});const n={tags:[]},s={exclude:!1,ids:[]},l={list:[]},r={builtIn:0,enable:!0,hide:!1},i={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var g=(I=>(I[I.never=0]="never",I[I.onDashboardLoad=1]="onDashboardLoad",I[I.onTimeRangeChanged=2]="onTimeRangeChanged",I))(g||{}),o=(I=>(I[I.dontHide=0]="dontHide",I[I.hideLabel=1]="hideLabel",I[I.hideVariable=2]="hideVariable",I))(o||{}),d=(I=>(I[I.alphabeticalAsc=1]="alphabeticalAsc",I[I.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",I[I.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",I[I.alphabeticalDesc=2]="alphabeticalDesc",I[I.disabled=0]="disabled",I[I.naturalAsc=7]="naturalAsc",I[I.naturalDesc=8]="naturalDesc",I[I.numericalAsc=3]="numericalAsc",I[I.numericalDesc=4]="numericalDesc",I))(d||{});const c={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var a=(I=>(I.ContinuousBlPu="continuous-BlPu",I.ContinuousBlYlRd="continuous-BlYlRd",I.ContinuousBlues="continuous-blues",I.ContinuousGrYlRd="continuous-GrYlRd",I.ContinuousGreens="continuous-greens",I.ContinuousPurples="continuous-purples",I.ContinuousRdYlGr="continuous-RdYlGr",I.ContinuousReds="continuous-reds",I.ContinuousYlBl="continuous-YlBl",I.ContinuousYlRd="continuous-YlRd",I.Fixed="fixed",I.PaletteClassic="palette-classic",I.PaletteClassicByName="palette-classic-by-name",I.Shades="shades",I.Thresholds="thresholds",I))(a||{});const p={h:9,w:12,x:0,y:0};var u=(I=>(I.Absolute="absolute",I.Percentage="percentage",I))(u||{});const m={steps:[]};var v=(I=>(I.RangeToText="range",I.RegexToText="regex",I.SpecialValue="special",I.ValueToText="value",I))(v||{}),x=(I=>(I.Empty="empty",I.False="false",I.NaN="nan",I.Null="null",I.NullAndNan="null+nan",I.True="true",I))(x||{});const f={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var E=(I=>(I[I.Crosshair=1]="Crosshair",I[I.Off=0]="Off",I[I.Tooltip=2]="Tooltip",I))(E||{});const h=0,y={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},b={overrides:[]},D={id:""},P={links:[],mappings:[]},C={collapsed:!1,panels:[]},M={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(k,A,e)=>{"use strict";e.d(A,{Gu:()=>l,gB:()=>s});var n=e(52622);const s={align:"auto",inspect:!1,cellOptions:{type:n.ob.Auto}};var l=(r=>(r.NotStarted="NotStarted",r.Loading="Loading",r.Streaming="Streaming",r.Done="Done",r.Error="Error",r))(l||{})},79422:(k,A,e)=>{"use strict";e.d(A,{Ye:()=>l,lt:()=>i,rw:()=>r,zL:()=>s});var n=e(73134),s=(m=>(m[m.dontHide=0]="dontHide",m[m.hideLabel=1]="hideLabel",m[m.hideVariable=2]="hideVariable",m))(s||{});const l=n.Ye,r={...n.rw},i=n.lt,g=n.OA,o=n.GW,d=n.QB,c=n.bt,a=n.ss,p=n.bf,u=n.aD},11807:(k,A,e)=>{"use strict";e.d(A,{l:()=>a});var n=e(74848),s=e(32196),l=e(73287),r=e(14110),i=e(40845),g=e(29158),o=e(88575),d=e(32372),c=e(94471);function a({rawSql:u,datasourceType:m}){const[v,x]=(0,l.A)(),f=(0,i.of)(p),E=y=>{x(y),(0,r.rR)("grafana_sql_preview_copied",{datasource:m})},h=(0,n.jsxs)("div",{className:f.labelWrapper,children:[(0,n.jsx)("span",{className:f.label,children:"Preview"}),(0,n.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>E(u),name:"copy"})]});return(0,n.jsx)(o.D,{label:h,className:f.grow,children:(0,n.jsx)(d.B,{language:"sql",height:80,value:(0,c.s)(u),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function p(u){return{grow:(0,s.css)({flexGrow:1}),label:(0,s.css)({fontSize:12,fontWeight:u.typography.fontWeightMedium}),labelWrapper:(0,s.css)({display:"flex",justifyContent:"space-between",paddingBottom:u.spacing(.5)})}}},94471:(k,A,e)=>{"use strict";e.d(A,{s:()=>s});var n=e(27633);function s(l){return n.Ay.format(l).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,r=>r.replace(/\s/g,""))}},42418:(k,A,e)=>{"use strict";e.d(A,{F:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(55852),o=e(14578),d=e(90613),c=e(94753);const a=l.forwardRef(({title:m,onRemove:v,children:x,buttonContent:f,elevated:E,bottomSpacing:h,topSpacing:y,className:b,severity:D="error",...P},C)=>{const M=(0,i.$j)(),R=u(M,D,!!m,E,h,y),T={error:"alert",warning:"alert",info:"status",success:"status"},S=P.role||T[D],L=P["aria-label"]||m;return(0,n.jsx)("div",{ref:C,className:(0,s.cx)(R.wrapper,b),role:S,"aria-label":L,...P,children:(0,n.jsxs)(d.a,{"data-testid":r.Tp.components.Alert.alertV2(D),display:"flex",backgroundColor:D,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:D,alignItems:"stretch",boxShadow:E?"z3":void 0,children:[(0,n.jsx)(d.a,{paddingTop:1,paddingRight:2,children:(0,n.jsx)("div",{className:R.icon,children:(0,n.jsx)(o.I,{size:"xl",name:p(D)})})}),(0,n.jsxs)(d.a,{paddingY:1,grow:1,children:[(0,n.jsx)(c.E,{color:"primary",weight:"medium",children:m}),x&&(0,n.jsx)("div",{className:R.content,children:x})]}),v&&!f&&(0,n.jsx)("div",{className:R.close,children:(0,n.jsx)(g.$n,{"aria-label":"Close alert",icon:"times",onClick:v,type:"button",fill:"text",variant:"secondary"})}),v&&f&&(0,n.jsx)(d.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,n.jsx)(g.$n,{"aria-label":"Close alert",variant:"secondary",onClick:v,type:"button",children:f})})]})})});a.displayName="Alert";const p=m=>{switch(m){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},u=(m,v,x,f,E,h)=>{const y=m.colors[v];return{wrapper:(0,s.css)({flexGrow:1,marginBottom:m.spacing(E??2),marginTop:m.spacing(h??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:m.colors.background.primary,zIndex:-1}}),icon:(0,s.css)({color:y.text,position:"relative",top:"-1px"}),content:(0,s.css)({color:m.colors.text.primary,paddingTop:x?m.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,s.css)({position:"relative",color:m.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},28270:(k,A,e)=>{"use strict";e.d(A,{p:()=>v});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(40845),g=e(88575),o=e(32982);const d=(0,r.memo)(()=>{const f=(0,i.of)(c);return(0,n.jsxs)("div",{className:f.ellipsis,children:[(0,n.jsx)("span",{className:f.firstDot,children:"."}),(0,n.jsx)("span",{className:f.secondDot,children:"."}),(0,n.jsx)("span",{className:f.thirdDot,children:"."})]})});d.displayName="EllipsisAnimated";const c=f=>({ellipsis:(0,s.css)({display:"inline"}),firstDot:(0,s.css)({[f.transitions.handleMotion("no-preference","reduce")]:{animation:`${a} 2s linear infinite`}}),secondDot:(0,s.css)({[f.transitions.handleMotion("no-preference","reduce")]:{animation:`${p} 2s linear infinite`}}),thirdDot:(0,s.css)({[f.transitions.handleMotion("no-preference","reduce")]:{animation:`${u} 2s linear infinite`}})}),a=(0,s.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,p=(0,s.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,u=(0,s.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,m=2*1e3;function v(f){const{invalid:E,loading:h,onFinishChange:y,saveErrorMessage:b="Error saving this value",error:D,children:P,disabled:C,...M}=f,[I,R]=r.useState({isLoading:!1,showSuccess:!1,showError:E}),T=(0,r.useRef)(null);r.useEffect(()=>{let N;if(I.showSuccess){const F=I.showError?0:m;N=setTimeout(()=>{R({...I,showSuccess:!1})},F)}return()=>{window.clearTimeout(N)}},[I]);const S=(0,r.useCallback)(N=>{E||(R({...I,isLoading:!0,showSuccess:!1}),y(N).then(()=>{R({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{R({...I,isLoading:!1,showError:!0})}))},[E,I,y]),L=(0,r.useMemo)(()=>(0,l.debounce)(S,600,{leading:!1}),[S]),O=E||I.showError||void 0,j=(0,i.of)(x);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{...M,loading:h||void 0,invalid:O,disabled:C,error:D||I.showError&&b,ref:T,className:j.widthFitContent,children:r.cloneElement(P(N=>{L(N)}))}),I.isLoading&&(0,n.jsxs)(o.r,{referenceElement:T.current,placement:"right",children:["Saving ",(0,n.jsx)(d,{})]}),I.showSuccess&&(0,n.jsx)(o.r,{suffixIcon:"check",referenceElement:T.current,placement:"right",children:"Saved!"})]})}v.displayName="AutoSaveField";const x=()=>({widthFitContent:(0,s.css)({width:"fit-content"})})},39938:(k,A,e)=>{"use strict";e.d(A,{E:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(70255),i=e(84140),g=e(40845),o=e(72129),d=e(14578),c=e(56034);const a=l.memo(({icon:x,color:f,text:E,tooltip:h,className:y,...b})=>{const D=(0,g.of)(v,f),P=(0,n.jsxs)("div",{className:(0,s.cx)(D.wrapper,y),...b,children:[x&&(0,n.jsx)(d.I,{name:x,size:"sm"}),E]});return h?(0,n.jsx)(c.m,{content:h,placement:"auto",children:P}):P});a.displayName="Badge";const p=({rootProps:x})=>{const f=(0,g.of)(m);return(0,n.jsx)(r.A,{width:60,height:22,containerClassName:f.container,...x})},u=(0,o.j)(a,p),m=()=>({container:(0,s.css)({lineHeight:1})}),v=(x,f)=>{let E=x.visualization.getColorByName(f),h="",y="",b="";return x.isDark?(y=(0,i.A)(E).setAlpha(.15).toString(),h=(0,i.A)(E).setAlpha(.25).toString(),b=(0,i.A)(E).lighten(15).toString()):(y=(0,i.A)(E).setAlpha(.15).toString(),h=(0,i.A)(E).setAlpha(.25).toString(),b=(0,i.A)(E).darken(20).toString()),{wrapper:(0,s.css)({display:"inline-flex",padding:"1px 4px",borderRadius:x.shape.radius.default,background:y,border:`1px solid ${h}`,color:b,fontWeight:x.typography.fontWeightRegular,gap:"2px",fontSize:x.typography.bodySmall.fontSize,lineHeight:x.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(k,A,e)=>{"use strict";e.d(A,{xE:()=>P});var n=e(74848),s=e(32196),l=e(96540),r=e(84140),i=e(47070),g=e(50082),o=e(58649),d=e(83195),c=e(24293),a=e(8066),p=e(13544),u=e(52622),m=e(29413),v=e(55852),x=e(9286);const f=18,E=50,h=150,y=1.5,b=1,D=10;class P extends l.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:u.eX.Gradient,orientation:i.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:g.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:U,className:w,theme:B}=this.props,{title:K}=this.props.value,W=I(this.props);return U?(0,n.jsxs)("button",{type:"button",style:W.wrapper,onClick:U,className:(0,s.cx)((0,v.my)(B),w),children:[(0,n.jsx)("div",{style:W.title,children:K}),this.renderBarAndValue()]}):(0,n.jsxs)("div",{style:W.wrapper,className:w,children:[K&&(0,n.jsx)("div",{style:W.title,children:K}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:U,showUnfilled:w,valueDisplayMode:B}=this.props,K=L(this.props);return(0,n.jsxs)("div",{style:K.wrapper,children:[B!==u.$l.Hidden&&(0,n.jsx)(x.i,{"data-testid":p.Tp.components.Panels.Visualization.BarGauge.valueV2,value:U,style:K.value}),w&&(0,n.jsx)("div",{style:K.emptyBar}),(0,n.jsx)("div",{style:K.bar})]})}renderRetroBars(){const{display:U,field:w,value:B,itemSpacing:K,alignmentFactors:W,orientation:z,lcdCellWidth:Y,text:X,valueDisplayMode:q,theme:G}=this.props,{valueHeight:te,valueWidth:H,maxBarHeight:se,maxBarWidth:ne,wrapperWidth:le,wrapperHeight:_}=R(this.props),Q=w.min??o.tw,ae=w.max??o.d1,oe=C(z),J=ae-Q,ee=oe?se:ne,de=K,xe=Math.floor(ee/Y),re=Math.floor((ee-de*xe)/xe),ue=j(this.props),ge=N(W||B,ue,H,te,z,X),Oe={width:`${le}px`,height:`${_}px`,display:"flex"};oe?(Oe.flexDirection="column-reverse",Oe.alignItems="center"):(Oe.flexDirection="row",Oe.alignItems="center",ge.justifyContent="flex-end");const Ue=[];for(let Xe=0;Xe<xe;Xe++){const we=Q+J/xe*Xe,qe=T(we,B,U),We={borderRadius:G.shape.radius.default};qe.isLit?We.backgroundImage=`radial-gradient(${qe.background} 10%, ${qe.backgroundShade})`:We.backgroundColor=qe.background,oe?(We.height=`${re}px`,We.width=`${ne}px`,We.marginTop=`${de}px`):(We.width=`${re}px`,We.height=`${se}px`,We.marginRight=`${de}px`),Ue.push((0,n.jsx)("div",{style:We},Xe.toString()))}return(0,n.jsxs)("div",{style:Oe,children:[Ue,q!==u.$l.Hidden&&(0,n.jsx)(x.i,{"data-testid":p.Tp.components.Panels.Visualization.BarGauge.valueV2,value:B,style:ge})]})}}function C(F){return F===i.wV.Vertical}function M(F){const{height:U,width:w,alignmentFactors:B,orientation:K,text:W,namePlacement:z}=F,Y=B?B.title:F.value.title;if(!Y)return{fontSize:0,width:0,height:0,placement:"above"};if(C(K)){const ne=W?.titleSize??14;return{fontSize:ne,width:w,height:ne*y,placement:"below"}}if(U>40&&z===u.TZ.Auto||z===u.TZ.Top){if(W?.titleSize)return{fontSize:W?.titleSize,width:0,height:W.titleSize*y,placement:"above"};const le=Math.max(Math.min(U*.45,E),17);return{fontSize:le/y,width:0,height:le,placement:"above"}}const te=Math.max(U*.6,f)/y,H=(0,m.kD)(Y,te),se=Math.min(H.width+15,w*.4);return{fontSize:W?.titleSize??te,height:0,width:se,placement:"left"}}function I(F){const U={display:"flex",overflow:"hidden",width:"100%"},w=M(F),B={fontSize:`${w.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return C(F.orientation)?(U.flexDirection="column-reverse",B.textAlign="center"):w.placement==="above"?U.flexDirection="column":(U.flexDirection="row",B.width=`${w.width}px`,B.textAlign="right",B.paddingRight="10px"),{wrapper:U,title:B}}function R(F){const{height:U,width:w,orientation:B,text:K,alignmentFactors:W,valueDisplayMode:z}=F,Y=M(F),X=W??F.value,q=(0,d.cN)(X);let G=0,te=0,H=0,se=0,ne=0,le=0;const _=K?.valueSize??Math.max(Y.fontSize,12),ae=(0,m.kD)(q,_).width+D*2;return C(B)?(K?.valueSize?H=K.valueSize*b:H=Math.min(Math.max(U*.1,f),E),se=w,z===u.$l.Hidden&&(H=0,se=0),G=U-(Y.height+H),te=w,ne=w,le=U-Y.height):(z===u.$l.Hidden?(H=0,se=0):(H=U-Y.height,se=Math.max(Math.min(w*.2,h),ae)),G=U-Y.height,te=w-se-Y.width,Y.placement==="above"?(ne=w,le=U-Y.height):(ne=w-Y.width,le=U)),{valueWidth:se,valueHeight:H,maxBarWidth:te,maxBarHeight:G,wrapperHeight:le,wrapperWidth:ne}}function T(F,U,w){if(F===null)return{background:c.F,border:c.F};const B=w?w(F).color:null;return B?U===null||isNaN(U.numeric)||F!==null&&F>U.numeric?{background:(0,r.A)(B).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,r.A)(B).setAlpha(.95).toRgbString(),backgroundShade:(0,r.A)(B).setAlpha(.55).toRgbString(),border:(0,r.A)(B).setAlpha(.9).toRgbString(),isLit:!0}:{background:c.F,border:c.F}}function S(F,U,w){const B=Math.min((F-U)/(w-U),1);return isNaN(B)?0:B}function L(F){const{displayMode:U,field:w,value:B,alignmentFactors:K,orientation:W,theme:z,text:Y}=F,{valueWidth:X,valueHeight:q,maxBarHeight:G,maxBarWidth:te}=R(F),H=w.min??o.tw,se=w.max??o.d1,ne=S(B.numeric,H,se),le=j(F),_=B.color??c.F,ae=N(K||B,le,X,q,W,Y),oe=U==="basic",J={display:"flex",flexGrow:1},ee={borderRadius:z.shape.radius.default,position:"relative",zIndex:1},de={background:z.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:z.shape.radius.default,position:"relative"};if(C(W)){const xe=Math.max(ne*G,1);J.flexDirection="column",J.justifyContent="flex-end",ee.transition="height 1s",ee.height=`${xe}px`,ee.width=`${te}px`,de.bottom="-3px",de.width=`${X}px`,oe?(ee.background=`${(0,r.A)(_).setAlpha(.35).toRgbString()}`,ee.borderTop=`2px solid ${_}`):ee.background=O(F,G)}else{const xe=Math.max(ne*te,1);J.flexDirection="row-reverse",J.justifyContent="flex-end",J.alignItems="stretch",ee.transition="width 1s",ee.height=`${G}px`,ee.width=`${xe}px`,de.left="-3px",de.height=`${q}px`,oe?(ee.background=`${(0,r.A)(_).setAlpha(.35).toRgbString()}`,ee.borderRight=`2px solid ${_}`):ee.background=O(F,te)}return{wrapper:J,bar:ee,value:ae,emptyBar:de}}function O(F,U){const{field:w,value:B,orientation:K,theme:W}=F,z=C(K)?"0deg":"90deg",Y=w.min,X=w.max;let q="",G=0,te=(0,a.Hs)(w.color?.mode);if(te.id===c.Y.Thresholds){const H=w.thresholds;for(let se=0;se<H.steps.length;se++){const ne=H.steps[se],le=F.theme.visualization.getColorByName(ne.color),_=H.mode===g.O.Percentage?ne.value/100:S(ne.value,Y,X),Q=_*U,ae=Math.round(Q-(Q-G)/2),oe=H.mode===g.O.Percentage?Y+(X-Y)*_:ne.value;if(q==="")q=`linear-gradient(${z}, ${le}, ${le}`;else{if(B.numeric<oe)break;G=Q,q+=` ${ae}px, ${le}`}}return q+")"}if(te.isContinuous&&te.getColors){const H=te.getColors(W);for(let se=0;se<H.length;se++){const ne=H[se];if(q==="")q=`linear-gradient(${z}, ${ne} 0px`;else{const _=se/(H.length-1)*U;q+=`, ${ne} ${_}px`}}return q+")"}return B.color??c.F}function j(F){if(F.valueDisplayMode==="text")return F.theme.colors.text.primary;const{value:U}=F;return U.color?U.color:c.F}function N(F,U,w,B,K,W){const z={color:U,height:`${B}px`,width:`${w}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:b};let Y=w;const X=(0,d.cN)(F);return C(K)?(z.fontSize=W?.valueSize??(0,m.Vr)(X,Y,B,b),z.justifyContent="center"):(z.fontSize=W?.valueSize??(0,m.Vr)(X,Y-D*2,B,b),z.justifyContent="flex-end",z.paddingLeft=`${D}px`,z.paddingRight=`${D}px`,Y-=D),z}},37494:(k,A,e)=>{"use strict";e.d(A,{yV:()=>N,yp:()=>S,$p:()=>L,F8:()=>O,SV:()=>j});var n=e(74848),s=e(32196),l=e(96540),r=e(55852),i=e(9286),g=e(84140),o=e(11261),d=e(83195),c=e(52622),a=e(24284),p=e(29413),u=e(5926),m=e(14578);const v=({percentChange:F,styles:U})=>{const w=F&&(F>0?"arrow-up":F<0?"arrow-down":void 0);return(0,n.jsxs)("div",{style:U.containerStyles,children:[w&&(0,n.jsx)(m.I,{name:w,height:U.iconSize,width:U.iconSize,viewBox:"6 6 12 12"}),x(F)]})},x=F=>F?.toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3})??"",f=1.2,E=30,h=500;class y{constructor(U){this.props=U;const{width:w,height:B,value:K,text:W}=U;this.valueColor=K.color??"gray",this.panelPadding=B>100?12:8,this.textValues=R(U),this.justifyCenter=I(U.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=w-this.panelPadding*2,this.maxTextHeight=B-this.panelPadding*2,W&&(W.titleSize&&(this.titleFontSize=W.titleSize,this.titleToAlignTo=void 0),W.valueSize&&(this.valueFontSize=W.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const U={fontSize:`${this.titleFontSize}px`,lineHeight:f};return(this.props.colorMode===S.Background||this.props.colorMode===S.BackgroundSolid)&&(U.color=(0,a.mZ)(this.valueColor,this.props.theme.isDark)),U}getValueStyles(){const U={fontSize:this.valueFontSize,fontWeight:h,lineHeight:f,position:"relative",zIndex:1};switch(this.justifyCenter&&(U.textAlign="center"),this.props.colorMode){case S.Value:U.color=this.valueColor;break;case S.Background:case S.BackgroundSolid:U.color=(0,a.mZ)(this.valueColor,this.props.theme.isDark);break;case S.None:U.color=this.props.theme.colors.text.primary;break}return U}getPercentChangeStyles(U,w,B){const W=this.getValueAndTitleContainerStyles(),z=Math.max(this.valueFontSize/2.5,12);let Y=Math.max(this.valueFontSize/3,10);const X=this.props.theme.visualization,q=T(U,w,B,X),G={fontSize:z,fontWeight:h,lineHeight:f,position:"relative",display:"flex",alignItems:"center",gap:Math.max(z/3,4),zIndex:1,color:q};switch(this.justifyCenter&&(G.textAlign="center"),W.flexDirection==="column"&&z>12&&(G.marginTop=-(z/4)),W.flexDirection==="row"&&(G.alignItems="baseline",G.lineHeight=f*2.5),this.props.colorMode){case S.Background:case S.BackgroundSolid:G.color=(0,a.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===j.None&&(G.fontSize=(0,p.Vr)(x(U),this.maxTextWidth*.8,this.maxTextHeight*.8,f,void 0,h),Y=G.fontSize*.8),{containerStyles:G,iconSize:Y}}getValueAndTitleContainerStyles(){const U={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(U.alignItems="center",U.justifyContent="center",U.flexGrow=1,U.gap="0.75ch"),U}getPanelStyles(){const{width:U,height:w,theme:B,colorMode:K,textMode:W}=this.props,z={width:`${U}px`,height:`${w}px`,padding:`${W===j.None?2:this.panelPadding}px`,borderRadius:B.shape.radius.default,position:"relative",display:"flex"},Y=B.isDark?1:-.7;switch(K){case S.Background:const X=(0,g.A)(this.valueColor).darken(15*Y).spin(8).toRgbString(),q=(0,g.A)(this.valueColor).darken(5*Y).spin(-8).toRgbString();z.background=`linear-gradient(120deg, ${X}, ${q})`;break;case S.BackgroundSolid:z.background=(0,g.A)(this.valueColor).toString();break;case S.Value:z.background="transparent";break}return this.justifyCenter&&(z.alignItems="center",z.flexDirection="row"),z}renderChart(){const{sparkline:U,colorMode:w}=this.props;if(!U||U.y?.type!==o.PU.number)return null;let B,K;switch(w){case S.Background:case S.BackgroundSolid:B="rgba(255,255,255,0.4)",K=(0,g.A)(this.valueColor).brighten(40).toRgbString();break;case S.None:case S.Value:default:K=this.valueColor,B=(0,g.A)(this.valueColor).setAlpha(.2).toRgbString();break}const W={custom:{drawStyle:c.GR.Line,lineWidth:1,fillColor:B,lineColor:K}};return(0,n.jsx)("div",{style:this.getChartStyles(),children:(0,n.jsx)(u.O,{height:this.chartHeight,width:this.chartWidth,sparkline:U,config:W,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class b extends y{constructor(U){super(U);const w=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth*w,this.maxTextHeight,f,void 0,h)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,f,E),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const U=super.getValueAndTitleContainerStyles();return U.flexDirection="row",U.alignItems="center",U.flexGrow=1,this.justifyCenter||(U.justifyContent="space-between"),U}renderChart(){return null}getPanelStyles(){const U=super.getPanelStyles();return U.alignItems="center",U}}class D extends y{constructor(U){super(U);const{width:w,height:B}=U,K=.5,W=.6,z=1-W,Y=.4;this.chartWidth=w,this.chartHeight=B*K,this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth*W,this.maxTextHeight*Y,f,E)),this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth*z,this.maxTextHeight*K,f,void 0,h))}getValueAndTitleContainerStyles(){const U=super.getValueAndTitleContainerStyles();return U.flexDirection="row",U.flexGrow=1,this.justifyCenter||(U.justifyContent="space-between"),U}getPanelStyles(){const U=super.getPanelStyles();return U.flexDirection="row",U.justifyContent="space-between",U}}class P extends y{constructor(U){super(U);const{width:w,height:B}=U,K=.15,W=.25;let z=0;this.chartHeight=B*W,this.chartWidth=w,this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth,B*K,f,E),z=this.titleFontSize*f),this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-z,f,void 0,h)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=B-this.titleFontSize*f-this.valueFontSize*f}getValueAndTitleContainerStyles(){const U=super.getValueAndTitleContainerStyles();return U.flexDirection="column",U.justifyContent="center",U}getPanelStyles(){const U=super.getPanelStyles();return U.flexDirection="column",U}}class C extends y{constructor(U){super(U);const{height:w}=U,B=.15;let K=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth,w*B,f,E),K=this.titleFontSize*f),this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-K,f,void 0,h)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const U=super.getValueAndTitleContainerStyles();return U.flexDirection="column",U.flexGrow=1,U}renderChart(){return null}getPanelStyles(){const U=super.getPanelStyles();return U.alignItems="center",U}}function M(F){const{width:U,height:w,sparkline:B}=F;return U/w>2.5&&!F.disableWideLayout?w>50&&B&&B.y.values.length>1?new D(F):new b(F):w>100&&B&&B.y.values.length>1?new P(F):new C(F)}function I(F,U){return F===O.Center?!0:(U??"").length===0}function R(F){const{value:U,alignmentFactors:w,count:B}=F;let{textMode:K}=F;const W=w?w.title:U.title,z=(0,d.cN)(w||U);switch(K===j.Auto&&(B??1)===1&&(K=j.Value),K){case j.Name:return{...U,title:void 0,prefix:void 0,suffix:void 0,text:U.title||"",titleToAlignTo:void 0,valueToAlignTo:W??"",tooltip:(0,d.cN)(U)};case j.Value:return{...U,title:void 0,titleToAlignTo:void 0,valueToAlignTo:z,tooltip:U.title};case j.None:return{numeric:U.numeric,color:U.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${U.title}
Value: ${(0,d.cN)(U)}`};case j.ValueAndName:default:return{...U,titleToAlignTo:W,valueToAlignTo:z}}}function T(F,U,w,B){return U===c.CD.SameAsValue?w.color:F*(U===c.CD.Inverted?-1:1)>0?B.getColorByName("green"):B.getColorByName("red")}var S=(F=>(F.Background="background",F.BackgroundSolid="background_solid",F.None="none",F.Value="value",F))(S||{}),L=(F=>(F.None="none",F.Line="line",F.Area="area",F))(L||{}),O=(F=>(F.Auto="auto",F.Center="center",F))(O||{}),j=(F=>(F.Auto="auto",F.Value="value",F.ValueAndName="value_and_name",F.Name="name",F.None="none",F))(j||{});class N extends l.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:U,className:w,hasLinks:B,theme:K}=this.props,W=M(this.props),z=W.getPanelStyles(),Y=W.getValueAndTitleContainerStyles(),X=W.getValueStyles(),q=W.getTitleStyles(),G=W.textValues,te=this.props.value.percentChange,H=this.props.percentChangeColorMode,se=te!=null&&!Number.isNaN(te),ne=B?void 0:G.tooltip;return U?(0,n.jsxs)("button",{type:"button",className:(0,s.cx)((0,r.my)(K),w),style:z,onClick:U,title:ne,children:[(0,n.jsxs)("div",{style:Y,children:[G.title&&(0,n.jsx)("div",{style:q,children:G.title}),(0,n.jsx)(i.i,{value:G,style:X})]}),W.renderChart()]}):(0,n.jsxs)("div",{className:w,style:z,title:ne,children:[(0,n.jsxs)("div",{style:Y,children:[G.title&&(0,n.jsx)("div",{style:q,children:G.title}),(0,n.jsx)(i.i,{value:G,style:X}),se&&(0,n.jsx)(v,{percentChange:te,styles:W.getPercentChangeStyles(te,H,X)})]}),W.renderChart()]})}}},54438:(k,A,e)=>{"use strict";e.d(A,{J:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(23257),i=e.n(r),g=e(40845),o=e(5313);const d=(0,l.forwardRef)(({name:a,value:p,hidden:u,facets:m,onClick:v,className:x,loading:f,searchTerm:E,active:h,style:y,title:b,highlightParts:D,...P},C)=>{const M=(0,g.$j)(),I=c(M),R=E?[E]:[],T=(0,l.useCallback)(L=>{v&&!u&&v(a,p,L)},[v,a,u,p]);let S=p||a;return m&&(S=`${S} (${m})`),(0,n.jsx)("button",{ref:C,onClick:T,style:y,title:b||S,type:"button",role:"option","aria-selected":!!h,className:(0,s.cx)(I.base,h&&I.active,f&&I.loading,u&&I.hidden,x,v&&!u&&I.hover),...P,children:D!==void 0?(0,n.jsx)(o.z,{text:S,highlightClassName:I.matchHighLight,highlightParts:D}):(0,n.jsx)(i(),{textToHighlight:S,searchWords:R,autoEscape:!0,highlightClassName:I.matchHighLight})},S)});d.displayName="Label";const c=a=>({base:(0,s.css)({display:"inline-block",cursor:"pointer",fontSize:a.typography.size.sm,lineHeight:a.typography.bodySmall.lineHeight,backgroundColor:a.colors.background.secondary,color:a.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:a.spacing(.5),borderRadius:a.shape.radius.default,border:"none",marginRight:a.spacing(1),marginBottom:a.spacing(.5)}),loading:(0,s.css)({fontWeight:a.typography.fontWeightMedium,backgroundColor:a.colors.primary.shade,color:a.colors.text.primary,[a.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:a.colors.text.primary},"50%":{color:a.colors.text.secondary},"100%":{color:a.colors.text.disabled}}}),active:(0,s.css)({fontWeight:a.typography.fontWeightMedium,backgroundColor:a.colors.primary.main,color:a.colors.primary.contrastText}),matchHighLight:(0,s.css)({background:"inherit",color:a.components.textHighlight.text,backgroundColor:a.components.textHighlight.background}),hidden:(0,s.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,s.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},55852:(k,A,e)=>{"use strict";e.d(A,{$n:()=>p,Ez:()=>y,Jt:()=>m,U_:()=>E,hs:()=>v,my:()=>h,z9:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16797),g=e(87266),o=e(14578),d=e(56034);const c=null,a=null,p=l.forwardRef(({variant:b="primary",size:D="md",fill:P="solid",icon:C,fullWidth:M,children:I,className:R,type:T="button",tooltip:S,disabled:L,tooltipPlacement:O,onClick:j,...N},F)=>{const U=(0,r.$j)(),w=v({theme:U,size:D,variant:b,fill:P,fullWidth:M,iconOnly:!I}),B=(0,s.cx)(w.button,{[w.disabled]:L},R),K=!!S,W=(0,n.jsxs)("button",{className:B,type:T,onClick:L?void 0:j,...N,"aria-disabled":K&&L,disabled:!K&&L,ref:S?void 0:F,children:[(0,n.jsx)(m,{icon:C,size:D,className:w.icon}),I&&(0,n.jsx)("span",{className:w.content,children:I})]});return S?(0,n.jsx)(d.m,{ref:F,content:S,placement:O,children:W}):W});p.displayName="Button";const u=l.forwardRef(({variant:b="primary",size:D="md",fill:P="solid",icon:C,fullWidth:M,children:I,className:R,onBlur:T,onFocus:S,disabled:L,tooltip:O,tooltipPlacement:j,...N},F)=>{const U=(0,r.$j)(),w=v({theme:U,fullWidth:M,size:D,variant:b,fill:P,iconOnly:!I}),B=(0,s.cx)(w.button,{[(0,s.css)(w.disabled,{pointerEvents:"none"})]:L},R),K=(0,n.jsxs)("a",{className:B,...N,tabIndex:L?-1:0,"aria-disabled":L,ref:O?void 0:F,children:[(0,n.jsx)(m,{icon:C,size:D,className:w.icon}),I&&(0,n.jsx)("span",{className:w.content,children:I})]});return O?(0,n.jsx)(d.m,{ref:F,content:O,placement:j,children:K}):K});u.displayName="LinkButton";const m=({icon:b,size:D,className:P,iconType:C})=>b?l.isValidElement(b)?l.cloneElement(b,{className:P,size:D}):(0,n.jsx)(o.I,{name:b,size:D,className:P,type:C}):null,v=b=>{const{theme:D,variant:P,fill:C="solid",size:M,iconOnly:I,fullWidth:R}=b,{height:T,padding:S,fontSize:L}=(0,g.SM)(M,D),O=E(D,P,C),j=f(D,P,C),N=(0,i.getFocusStyles)(D),F=D.spacing.gridSize*S-1;return{button:(0,s.css)({label:"button",display:"inline-flex",alignItems:"center",fontSize:L,fontWeight:D.typography.fontWeightMedium,fontFamily:D.typography.fontFamily,padding:`0 ${F}px`,height:D.spacing(T),lineHeight:`${D.spacing.gridSize*T-2}px`,verticalAlign:"middle",cursor:"pointer",borderRadius:D.shape.radius.default,"&:focus":N,"&:focus-visible":N,"&:focus:not(:focus-visible)":(0,i.getMouseFocusStyles)(D),...R&&{flexGrow:1,justifyContent:"center"},...O,":disabled":j,"&[disabled]":j}),disabled:(0,s.css)(j,{"&:hover":(0,s.css)(j)}),img:(0,s.css)({width:"16px",height:"16px",margin:D.spacing(0,1,0,.5)}),icon:I?(0,s.css)({marginRight:D.spacing(-S/2),marginLeft:D.spacing(-S/2)}):(0,s.css)({marginRight:D.spacing(S/2)}),content:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",height:"100%"})}};function x(b,D,P){let C=D.border,M="transparent",I="transparent";return D.name==="secondary"&&(M=D.border,I=b.colors.emphasize(D.border,.25),C=b.colors.border.strong),P==="outline"?{background:"transparent",color:D.text,border:`1px solid ${C}`,transition:b.transitions.create(["background-color","border-color","color"],{duration:b.transitions.duration.short}),"&:hover":{background:D.transparent,borderColor:b.colors.emphasize(C,.25),color:D.text}}:P==="text"?{background:"transparent",color:D.text,border:"1px solid transparent",transition:b.transitions.create(["background-color","color"],{duration:b.transitions.duration.short}),"&:focus":{outline:"none",textDecoration:"none"},"&:hover":{background:D.transparent,textDecoration:"none"}}:{background:D.main,color:D.contrastText,border:`1px solid ${M}`,transition:b.transitions.create(["background-color","box-shadow","border-color","color"],{duration:b.transitions.duration.short}),"&:hover":{background:D.shade,color:D.contrastText,boxShadow:b.shadows.z1,borderColor:I}}}function f(b,D,P){const C={cursor:"not-allowed",boxShadow:"none",color:b.colors.text.disabled,transition:"none"};return P==="text"?{...C,background:"transparent",border:"1px solid transparent"}:P==="outline"?{...C,background:"transparent",border:`1px solid ${b.colors.border.weak}`}:{...C,background:b.colors.action.disabledBackground,border:"1px solid transparent"}}function E(b,D,P){switch(D){case"secondary":return x(b,b.colors.secondary,P);case"destructive":return x(b,b.colors.error,P);case"success":return x(b,b.colors.success,P);case"primary":default:return x(b,b.colors.primary,P)}}const h=b=>(0,s.css)({background:"transparent",color:b.colors.text.primary,border:"none",padding:0}),y=b=>(0,s.css)({background:"transparent",border:"none",padding:0,fontFamily:"inherit",color:"inherit",height:"100%","&:hover":{background:"transparent",color:"inherit"}})},19727:(k,A,e)=>{"use strict";e.d(A,{e:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(40845);const i=(0,l.forwardRef)(({className:o,children:d,...c},a)=>{const p=(0,r.of)(g);return(0,n.jsx)("div",{ref:a,className:(0,s.cx)("button-group",p.wrapper,o),...c,children:d})});i.displayName="ButtonGroup";const g=o=>({wrapper:(0,s.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},61458:(k,A,e)=>{"use strict";e.d(A,{V:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({className:g,children:o})=>{const d=(0,l.of)(i);return(0,n.jsx)("div",{className:(0,s.cx)(d,g),children:o})},i=()=>(0,s.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}})},32012:(k,A,e)=>{"use strict";e.d(A,{H:()=>c});var n=e(74848),s=e(32196),l=e(48470),r=e(40845),i=e(55852),g=e(58898),o=e(30958),d=e(14578);const c=p=>{const{onChange:u,className:m,loadData:v,icon:x,buttonProps:f,hideDownIcon:E,variant:h,disabled:y,...b}=p,D=(0,r.of)(a),P=(0,r.of)(o.T);let C=p.children;return E||(C=[p.children,(0,n.jsx)(d.I,{name:"angle-down",className:D.icons.right},"down-icon")]),(0,n.jsx)(l.A,{onChange:(0,g.k)(u),loadData:(0,g.W)(v),dropdownClassName:(0,s.cx)(P.dropdown,D.popup),...b,expandIcon:null,children:(0,n.jsx)(i.$n,{icon:x,disabled:y,variant:h,...f??{},children:C})})};c.displayName="ButtonCascader";const a=p=>({popup:(0,s.css)({label:"popup",zIndex:p.zIndex.dropdown}),icons:{right:(0,s.css)({margin:"1px 0 0 4px"}),left:(0,s.css)({margin:"-1px 4px 0 0"})}})},76442:(k,A,e)=>{"use strict";e.d(A,{c:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({message:g,callToActionElement:o,footer:d,className:c})=>{const a=(0,l.of)(i);return(0,n.jsxs)("div",{className:(0,s.cx)([a.wrapper,c]),children:[g&&(0,n.jsx)("div",{className:a.message,children:g}),o,d&&(0,n.jsx)("div",{className:a.footer,children:d})]})},i=g=>({wrapper:(0,s.css)({label:"call-to-action-card",background:g.colors.background.secondary,borderRadius:g.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:g.spacing(3),[g.breakpoints.down("sm")]:{padding:g.spacing(3,1)}}),message:(0,s.css)({marginBottom:g.spacing(3),fontStyle:"italic"}),footer:(0,s.css)({marginTop:g.spacing(3)})})},10860:(k,A,e)=>{"use strict";e.d(A,{H:()=>C,Z:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16797),g=e(81507);const o=l.createContext(null),d=({disabled:M,href:I,onClick:R,children:T,isSelected:S,isCompact:L,className:O,...j})=>{const N=(0,l.useMemo)(()=>l.Children.toArray(T).some(B=>l.isValidElement(B)&&B.type===c),[T]),F=M||!R&&!I,U=R&&!M?R:void 0,w=(0,r.of)(g.i,M,F,S,L);return(0,n.jsx)(g.Q,{disableEvents:M,disableHover:F,isSelected:S,className:(0,s.cx)(w.container,O),...j,children:(0,n.jsxs)(o.Provider,{value:{href:I,onClick:U,disabled:M,isSelected:S},children:[!N&&(0,n.jsx)(c,{}),T]})})},c=({children:M,className:I,"aria-label":R})=>{const T=(0,l.useContext)(o),S=(0,r.of)(a),{href:L,onClick:O,isSelected:j}=T??{href:void 0,onClick:void 0,isSelected:void 0};return(0,n.jsxs)("h2",{className:(0,s.cx)(S.heading,I),children:[L?(0,n.jsx)("a",{href:L,className:S.linkHack,"aria-label":R,onClick:O,children:M}):O?(0,n.jsx)("button",{onClick:O,className:S.linkHack,"aria-label":R,type:"button",children:M}):(0,n.jsx)(n.Fragment,{children:M}),j!==void 0&&(0,n.jsx)("input",{"aria-label":"option",type:"radio",checked:j,readOnly:!0})]})};c.displayName="Heading";const a=M=>({heading:(0,s.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:M.typography.size.md,letterSpacing:"inherit",lineHeight:M.typography.body.lineHeight,color:M.colors.text.primary,fontWeight:M.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,s.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:M.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,i.getFocusStyles)(M),zIndex:1}}})}),p=({children:M,className:I})=>{const R=(0,r.of)(u);return(0,n.jsx)("div",{className:(0,s.cx)(R.tagList,I),children:M})};p.displayName="Tags";const u=M=>({tagList:(0,s.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),m=({children:M,className:I})=>{const R=(0,r.of)(v);return(0,n.jsx)("p",{className:(0,s.cx)(R.description,I),children:M})};m.displayName="Description";const v=M=>({description:(0,s.css)({width:"100%",gridArea:"Description",margin:M.spacing(1,0,0),color:M.colors.text.secondary,lineHeight:M.typography.body.lineHeight})}),x=({children:M,align:I="start",className:R})=>{const T=(0,r.of)(f);return(0,n.jsx)("div",{className:(0,s.cx)(T.media,R,(0,s.css)({alignSelf:I})),children:M})};x.displayName="Figure";const f=M=>({media:(0,s.css)({position:"relative",gridArea:"Figure",marginRight:M.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),E=(0,l.memo)(({children:M,className:I,separator:R="|"})=>{const T=(0,r.of)(h);let S=M;const L=l.Children.toArray(M).filter(Boolean);return L.length?(S=L.map((O,j)=>(0,n.jsx)("div",{className:T.metadataItem,children:O},`element_${j}`)),L.length>1&&R&&(S=L.reduce((O,j,N)=>[O,(0,n.jsx)("span",{className:T.separator,children:R},`separator_${N}`),j])),(0,n.jsx)("div",{className:(0,s.cx)(T.metadata,I),children:S})):null});E.displayName="Meta";const h=M=>({metadata:(0,s.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:M.typography.size.sm,color:M.colors.text.secondary,margin:M.spacing(.5,0,0),lineHeight:M.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,s.css)({zIndex:0}),separator:(0,s.css)({margin:`0 ${M.spacing(1)}`})}),y=({children:M,disabled:I,variant:R,className:T})=>{const S=(0,r.of)(b),O=(0,l.useContext)(o)?.disabled||I,j=R==="primary"?S.actions:S.secondaryActions;return(0,n.jsx)("div",{className:(0,s.cx)(j,T),children:l.Children.map(M,N=>l.isValidElement(N)?(0,l.cloneElement)(N,{disabled:O,...N.props}):null)})},b=M=>({actions:(0,s.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:M.spacing(1),gridArea:"Actions",marginTop:M.spacing(2)}),secondaryActions:(0,s.css)({alignSelf:"center",color:M.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:M.spacing(1),gridArea:"Secondary",marginTop:M.spacing(2)})}),D=({children:M,disabled:I,className:R})=>(0,n.jsx)(y,{variant:"primary",disabled:I,className:R,children:M});D.displayName="Actions";const P=({children:M,disabled:I,className:R})=>(0,n.jsx)(y,{variant:"secondary",disabled:I,className:R,children:M});P.displayName="SecondaryActions";const C=M=>({inner:(0,s.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...a(M),...h(M),...v(M),...f(M),...b(M),...u(M)});d.Heading=c,d.Tags=p,d.Figure=x,d.Meta=E,d.Actions=D,d.SecondaryActions=P,d.Description=m},81507:(k,A,e)=>{"use strict";e.d(A,{Q:()=>o,i:()=>d});var n=e(74848),s=e(32196),l=e(40845),r=e(16797);const i=({children:c,href:a})=>{const{inner:p}=(0,l.of)(g);return a?(0,n.jsx)("a",{className:p,href:a,children:c}):(0,n.jsx)(n.Fragment,{children:c})},g=c=>({inner:(0,s.css)({display:"flex",width:"100%",padding:c.spacing(2)})}),o=({children:c,disableEvents:a,disableHover:p,isSelected:u,className:m,href:v,...x})=>{const{oldContainer:f}=(0,l.of)(d,a,p,u);return(0,n.jsx)("div",{...x,className:(0,s.cx)(f,m),children:(0,n.jsx)(i,{href:v,children:c})})},d=(c,a=!1,p=!1,u,m)=>{const v=u!==void 0;return{container:(0,s.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:c.spacing(m?1:2),background:c.colors.background.secondary,borderRadius:c.shape.radius.default,marginBottom:"8px",pointerEvents:a?"none":"auto",[c.transitions.handleMotion("no-preference","reduce")]:{transition:c.transitions.create(["background-color","box-shadow","border-color","color"],{duration:c.transitions.duration.short})},...!p&&{"&:hover":{background:c.colors.emphasize(c.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":r.getFocusStyles(c)},...v&&{cursor:"pointer"},...u&&{outline:`solid 2px ${c.colors.primary.border}`}}),oldContainer:(0,s.css)({display:"flex",width:"100%",background:c.colors.background.secondary,borderRadius:c.shape.radius.default,position:"relative",pointerEvents:a?"none":"auto",marginBottom:c.spacing(1),[c.transitions.handleMotion("no-preference","reduce")]:{transition:c.transitions.create(["background-color","box-shadow","border-color","color"],{duration:c.transitions.duration.short})},...!p&&{"&:hover":{background:c.colors.emphasize(c.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":r.getFocusStyles(c)}})}}},3988:(k,A,e)=>{"use strict";e.d(A,{v:()=>h});var n=e(74848),s=e(32196),l=e(47078),r=e.n(l),i=e(48470),g=e(96540),o=e(40845),d=e(14578),c=e(29158),a=e(10354),p=e(67061),u=e(90182),m=e(58898),v=e(30958);const x=(0,s.css)({"&:focus":{outline:"none"}}),f=" / ";class E extends g.PureComponent{constructor(b){super(b),this.flattenOptions=(M,I=[])=>{let R=[];for(const T of M){const S=[...I];S.push(T),!T.items||T.items.length===0?R.push({singleLabel:S[S.length-1].label,label:S.map(L=>L.label).join(this.props.separator||f),value:S.map(L=>L.value)}):R=[...R,...this.flattenOptions(T.items,S)]}return R},this.getSearchableOptions=r()(M=>this.flattenOptions(M)),this.onChange=(M,I)=>{const R=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?I.map(S=>S.label).join(this.props.separator||f):I[I.length-1].label,T={rcValue:{value:M,label:R},focusCascade:!0,activeLabel:R,isSearching:!1,inputValue:R};this.setState(T),this.props.onSelect(I[I.length-1].value)},this.onSelect=M=>{const I=M.value||[],R=this.props.displayAllSelectedLevels?M.label:M.singleLabel||"",T={activeLabel:R,inputValue:R,rcValue:{value:I,label:R},isSearching:!1,focusCascade:!1};this.setState(T),this.props.onSelect(I[I.length-1])},this.onCreateOption=M=>{this.setState({activeLabel:M,inputValue:M,rcValue:[],isSearching:!1}),this.props.onSelect(M)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=M=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(M.key))return;const{activeLabel:I}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:I})},this.onSelectInputChange=M=>{this.setState({inputValue:M})};const D=this.getSearchableOptions(b.options),{rcValue:P,activeLabel:C}=this.setInitialValue(D,b.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:P,activeLabel:C,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(b,D){if(!D)return{rcValue:[],activeLabel:""};for(const P of b){const C=P.value||[];if(C[C.length-1]===D)return{rcValue:C,activeLabel:this.props.displayAllSelectedLevels?P.label:P.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:D}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:b,formatCreateLabel:D,placeholder:P,width:C,changeOnSelect:M,options:I,disabled:R,id:T,isClearable:S,theme:L}=this.props,{focusCascade:O,isSearching:j,rcValue:N,activeLabel:F,inputValue:U}=this.state,w=this.getSearchableOptions(I),B=(0,v.T)(L);return(0,n.jsx)("div",{children:j?(0,n.jsx)(u.l6,{allowCustomValue:b,placeholder:P,autoFocus:!O,onChange:this.onSelect,onBlur:this.onBlur,options:w,onCreateOption:this.onCreateOption,formatCreateLabel:D,width:C,onInputChange:this.onSelectInputChange,disabled:R,inputValue:U,inputId:T}):(0,n.jsx)(i.A,{onChange:(0,m.k)(this.onChange),options:I,changeOnSelect:M,value:N.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:R,dropdownClassName:B.dropdown,children:(0,n.jsx)("div",{className:x,children:(0,n.jsx)(a.p,{autoFocus:this.props.autoFocus,width:C,placeholder:P,onBlur:this.onBlurCascade,value:F,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,n.jsxs)(p.B,{gap:.5,children:[S&&F!==""&&(0,n.jsx)(c.K,{name:"times","aria-label":"Clear selection",onClick:K=>{K.preventDefault(),K.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,n.jsx)(d.I,{name:O?"angle-up":"angle-down"})]}),disabled:R,id:T})})})})}}const h=(0,o.cV)(E)},58898:(k,A,e)=>{"use strict";e.d(A,{W:()=>s,k:()=>n});const n=i=>(g,o)=>{i&&i(g.map(d=>String(d)),l(o))},s=i=>g=>{i&&i(l(g))},l=i=>i.map(r),r=i=>{const g=i.value?String(i.value):"";return{value:g,label:typeof i.label=="string"?i.label:g}}},30958:(k,A,e)=>{"use strict";e.d(A,{T:()=>g});var n=e(32196);const s=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),l=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),r=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),i=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),g=o=>({dropdown:(0,n.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:o.colors.background.canvas,border:`1px solid ${o.colors.border.weak}`,borderRadius:o.shape.radius.default,boxShadow:o.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:s,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:l,animationPlayState:"running"},"&-topLeft":{animationName:i,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${o.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:o.spacing(4),lineHeight:o.spacing(4),padding:o.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:o.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:o.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:o.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:o.colors.text.maxContrast,background:o.colors.background.secondary,"&:hover":{background:o.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:o.colors.background.secondary,content:"''",height:o.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:o.spacing(.5),width:o.spacing(3)}}}}}})})},8866:(k,A,e)=>{"use strict";e.d(A,{N:()=>l});var n=e(74848),s=e(96540);class l extends s.PureComponent{constructor(){super(...arguments),this.myRef=(0,s.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=i=>{const g=this.myRef.current;(!g||i.target instanceof Node&&!g.contains(i.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,n.jsx)("div",{ref:this.myRef,children:this.props.children})}}},10534:(k,A,e)=>{"use strict";e.d(A,{b:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(76412),i=e(40845),g=e(55852),o=e(14578),d=e(32982);const c=2*1e3;function a({onClipboardCopy:m,onClipboardError:v,children:x,getText:f,icon:E,variant:h,...y}){const b=(0,i.of)(u),[D,P]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let I;return D&&(I=setTimeout(()=>{P(!1)},c)),()=>{window.clearTimeout(I)}},[D]);const C=(0,l.useRef)(null),M=(0,l.useCallback)(async()=>{const I=f();try{await p(I,C),P(!0),m?.(I)}catch(R){v?.(I,R)}},[f,m,v]);return(0,n.jsxs)(n.Fragment,{children:[D&&(0,n.jsx)(d.r,{placement:"top",referenceElement:C.current,children:(0,n.jsx)(r.x,{i18nKey:"clipboard-button.inline-toast.success",children:"Copied"})}),(0,n.jsxs)(g.$n,{onClick:M,icon:E,variant:D?"success":h,"aria-label":D?"Copied":void 0,...y,className:(0,s.cx)(b.button,D&&b.successButton,y.className),ref:C,children:[x,D&&(0,n.jsx)("div",{className:b.successOverlay,children:(0,n.jsx)(o.I,{name:"check"})})]})]})}const p=async(m,v)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(m);{const x=document.createElement("textarea");v.current?.appendChild(x),x.value=m,x.focus(),x.select(),document.execCommand("copy"),x.remove()}},u=m=>({button:(0,s.css)({position:"relative"}),successButton:(0,s.css)({"> *":(0,s.css)({visibility:"hidden"})}),successOverlay:(0,s.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(k,A,e)=>{"use strict";e.d(A,{M:()=>a});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(40845),o=e(16797),d=e(14578),c=e(62930);const a=({label:u,isOpen:m,onToggle:v,className:x,contentClassName:f,children:E,labelId:h,loading:y=!1,headerDataTestId:b,contentDataTestId:D})=>{const[P,C]=(0,i.useState)(m),M=(0,g.of)(p),I=S=>{S.target instanceof HTMLElement&&S.target.tagName==="A"||(S.preventDefault(),S.stopPropagation(),v?.(!P),C(!P))},{current:R}=(0,i.useRef)((0,l.uniqueId)()),T=h??`collapse-label-${R}`;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{onClick:I,className:(0,s.cx)(M.header,x),children:[(0,n.jsx)("button",{type:"button",id:`collapse-button-${R}`,className:M.button,onClick:I,"aria-expanded":P&&!y,"aria-controls":`collapse-content-${R}`,"aria-labelledby":T,children:y?(0,n.jsx)(c.y,{className:M.spinner}):(0,n.jsx)(d.I,{name:P?"angle-up":"angle-down",className:M.icon})}),(0,n.jsx)("div",{className:M.label,id:`collapse-label-${R}`,"data-testid":b,children:u})]}),P&&(0,n.jsx)("div",{id:`collapse-content-${R}`,className:(0,s.cx)(M.content,f),"data-testid":D,children:E})]})},p=u=>({header:(0,s.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:u.typography.size.lg,padding:`${u.spacing(.5)} 0`,"&:focus-within":(0,o.getFocusStyles)(u)}),button:(0,s.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,s.css)({color:u.colors.text.secondary}),content:(0,s.css)({padding:`${u.spacing(2)} 0`}),spinner:(0,s.css)({display:"flex",alignItems:"center",width:u.spacing(2)}),label:(0,s.css)({display:"flex"})})},82762:(k,A,e)=>{"use strict";e.d(A,{S:()=>c,a:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(55852),g=e(14578);const o=a=>({collapse:(0,s.css)({label:"collapse",marginBottom:a.spacing(1),backgroundColor:a.colors.background.primary,border:`1px solid ${a.colors.border.weak}`,position:"relative",borderRadius:a.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,s.css)({label:"collapse__body",padding:a.spacing(a.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,s.css)({label:"bodyContentWrapper",flex:1,overflow:"hidden"}),loader:(0,s.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:a.spacing(.5)}),loaderActive:(0,s.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:a.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,s.css)({label:"collapse__header",padding:a.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,s.css)({label:"collapse__header--collapsed",padding:a.spacing(1,2,1,2)}),headerLabel:(0,s.css)({label:"collapse__header-label",fontWeight:a.typography.fontWeightMedium,marginRight:a.spacing(1),fontSize:a.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,s.css)({label:"collapse__icon",margin:a.spacing(.25,1,0,-1)})}),d=({isOpen:a,onToggle:p,...u})=>{const[m,v]=(0,l.useState)(a);return(0,n.jsx)(c,{isOpen:m,collapsible:!0,...u,onToggle:()=>{v(!m),p&&p(!m)}})},c=({isOpen:a,label:p,loading:u,collapsible:m,onToggle:v,className:x,children:f})=>{const E=(0,r.of)(i.my),h=(0,r.of)(o),y=()=>{v&&v(!a)},b=(0,s.cx)([h.collapse,x]),D=u?(0,s.cx)([h.loader,h.loaderActive]):(0,s.cx)([h.loader]),P=m?(0,s.cx)([h.header]):(0,s.cx)([h.headerCollapsed]);return(0,n.jsxs)("div",{className:b,children:[(0,n.jsxs)("button",{type:"button",className:(0,s.cx)(E,P),onClick:y,children:[m&&(0,n.jsx)(g.I,{className:h.icon,name:a?"angle-down":"angle-right"}),(0,n.jsx)("div",{className:(0,s.cx)([h.headerLabel]),children:p})]}),a&&(0,n.jsxs)("div",{className:(0,s.cx)([h.collapseBody]),children:[(0,n.jsx)("div",{className:D}),(0,n.jsx)("div",{className:h.bodyContentWrapper,children:f})]})]})};c.displayName="Collapse"},36314:(k,A,e)=>{"use strict";e.d(A,{A:()=>a});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(84140),o=e(40845),d=e(10354);const c=(0,i.forwardRef)(({color:m,onChange:v,isClearable:x=!1,onClick:f,onBlur:E,disabled:h,buttonAriaLabel:y,...b},D)=>{const[P,C]=(0,i.useState)(m),[M,I]=(0,i.useState)(m),R=(0,i.useMemo)(()=>(0,l.debounce)(v,100),[]);(0,i.useEffect)(()=>{const L=(0,g.A)(m);L.isValid()&&m!==M&&(C(L.toString()),I(m))},[m,M]);const T=L=>{const{value:O}=L.currentTarget;if(C(O),O===""&&x){R(O);return}const j=(0,g.A)(O);j.isValid()&&R(j.toString())},S=L=>{(0,g.A)(P).isValid()||C(m),E?.(L)};return(0,n.jsx)(d.p,{...b,value:P,onChange:T,disabled:h,onClick:f,onBlur:S,addonBefore:(0,n.jsx)(p,{onClick:f,ariaLabel:y,disabled:h,color:m}),ref:D})});c.displayName="ColorInput";const a=c,p=({color:m,onClick:v,disabled:x,ariaLabel:f})=>{const E=(0,o.of)(u);return(0,n.jsx)("button",{type:"button",onClick:v,"aria-label":f,disabled:x||!v,className:(0,s.cx)(E,(0,s.css)({backgroundColor:m}))})},u=m=>(0,s.css)({height:"100%",width:`${m.spacing.gridSize*4}px`,borderRadius:`${m.shape.radius.default} 0 0 ${m.shape.radius.default}`,border:`1px solid ${m.colors.border.medium}`})},83598:(k,A,e)=>{"use strict";e.d(A,{Dp:()=>v,sk:()=>m});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(3911),g=e(40321),o=e(13840),d=e(95868),c=e(70045),a=e(83876),p=e(70104);const u=(f,E="ColorPicker")=>class extends l.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,l.createRef)()}static{this.displayName=E}render(){const{theme:y,children:b,onChange:D,color:P}=this.props,C=x(y),M=l.createElement(f,{...this.props,children:null,onChange:D});return(0,n.jsx)(d.I,{content:M,hideAfter:300,children:(I,R,T)=>(0,n.jsxs)(n.Fragment,{children:[this.pickerTriggerRef.current&&(0,n.jsx)(o.A,{...T,referenceElement:this.pickerTriggerRef.current,wrapperClassName:C.colorPicker,onMouseLeave:R,onMouseEnter:I,onKeyDown:S=>(0,g.Q)(S,R)}),b?b({ref:this.pickerTriggerRef,showColorPicker:I,hideColorPicker:R}):(0,n.jsx)(a.q,{ref:this.pickerTriggerRef,onClick:I,onMouseLeave:R,color:y.visualization.getColorByName(P||"#000000"),"aria-label":P})]})})}},m=(0,r.cV)(u(c.$,"ColorPicker")),v=(0,r.cV)(u(p.o,"SeriesColorPicker")),x=(0,i.N)(f=>({colorPicker:(0,s.css)({position:"absolute",zIndex:f.zIndex.tooltip,color:f.colors.text.primary,maxWidth:"400px",fontSize:f.typography.size.sm})}))},99128:(k,A,e)=>{"use strict";e.d(A,{i:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(7612),i=e(65229),g=e(23596),o=e(40845),d=e(8866),c=e(36314),a=e(95151);const p=(0,l.forwardRef)(({value:m="",onChange:v,returnColorAs:x="rgb",...f},E)=>{const[h,y]=(0,l.useState)(m),[b,D]=(0,l.useState)(!1),P=(0,o.$j)(),C=(0,o.of)(u),M=(0,o.of)(a.$);return(0,i.A)(I=>{if(I===m)return;if(!I){v("");return}const R=P.visualization.getColorByName(I);v(x==="rgb"?g.MV.asRgbString(R):g.MV.asHexString(R))},500,[h]),(0,n.jsx)(d.N,{onClick:()=>D(!1),children:(0,n.jsxs)("div",{className:C.wrapper,children:[b&&!f.disabled&&(0,n.jsx)(r.p9,{"data-testid":"color-popover",color:h,onChange:y,className:(0,s.cx)(M.root,C.picker)}),(0,n.jsx)(c.A,{...f,theme:P,color:h,onChange:y,buttonAriaLabel:"Open color picker",onClick:()=>D(!0),onBlur:()=>D(!1),ref:E,isClearable:!0})]})})});p.displayName="ColorPickerInput";const u=m=>({wrapper:(0,s.css)({position:"relative"}),picker:(0,s.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,s.css)({position:"absolute"})})},70045:(k,A,e)=>{"use strict";e.d(A,{$:()=>h});var n=e(74848),s=e(32196),l=e(85690),r=e(96540),i=e(23596),g=e(40845),o=e(3911),d=e(83876),c=e(2543);function a(b,D){const P=new Array(b.length);for(let C=0;C<b.length;C++){const M=b.length-1-C;P[C]=D(b[M],M,b)}return P}const u=({hue:b,selectedColor:D,onColorSelect:P,...C})=>{const M=(0,c.upperFirst)(b.name),I=(0,g.of)(m);return(0,n.jsxs)("div",{className:I.colorRow,children:[(0,n.jsx)("div",{className:I.colorLabel,children:M}),(0,n.jsx)("div",{...C,className:I.swatchRow,children:a(b.shades,R=>(0,n.jsx)(d.q,{"aria-label":R.name,variant:R.primary?d.h.Large:d.h.Small,isSelected:R.name===D,color:R.color,onClick:()=>P(R.name)},R.name))})]})},m=b=>({colorRow:(0,s.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:b.spacing(2),padding:b.spacing(.5,0),"&:hover":{background:b.colors.background.secondary}}),colorLabel:(0,s.css)({paddingLeft:b.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,s.css)({display:"flex",gap:b.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),v=({color:b,onChange:D})=>{const P=(0,g.$j)(),C=(0,g.of)(x),M=[];for(const I of P.visualization.hues)M.push((0,n.jsx)(u,{selectedColor:b,hue:I,onColorSelect:D},I.name));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:C.swatches,children:M}),(0,n.jsxs)("div",{className:C.extraColors,children:[(0,n.jsx)(d.q,{isSelected:b==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>D("transparent")}),(0,n.jsx)(d.q,{isSelected:b==="text",color:P.colors.text.primary,label:"Text color",onClick:()=>D("text")})]})]})},x=b=>({container:(0,s.css)({display:"flex",flexDirection:"column"}),extraColors:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:b.spacing(1),padding:b.spacing(1,0)}),swatches:(0,s.css)({display:"grid",flexGrow:1})});var f=e(95151);class E extends r.Component{constructor(D){super(D),this.getTabClassName=P=>{const{activePicker:C}=this.state;return`ColorPickerPopover__tab ${C===P&&"ColorPickerPopover__tab--active"}`},this.handleChange=P=>{const{onChange:C,enableNamedColors:M,theme:I}=this.props;if(M)return C(P);C(i.MV.asHexString(I.visualization.getColorByName(P)))},this.onTabChange=P=>()=>this.setState({activePicker:P}),this.renderPicker=()=>{const{activePicker:P}=this.state,{color:C}=this.props;switch(P){case"spectrum":return(0,n.jsx)(f.A,{color:C,onChange:this.handleChange});case"palette":return(0,n.jsx)(v,{color:C,onChange:this.handleChange});default:return this.renderCustomPicker(P)}},this.renderCustomPicker=P=>{const{customPickers:C,color:M,theme:I}=this.props;return C?r.createElement(C[P].tabComponent,{color:M,theme:I,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:P}=this.props;return P?(0,n.jsx)(n.Fragment,{children:Object.keys(P).map(C=>(0,n.jsx)("button",{className:this.getTabClassName(C),onClick:this.onTabChange(C),type:"button",children:P[C].name},C))}):null},this.state={activePicker:"palette"}}render(){const{theme:D}=this.props,P=y(D);return(0,n.jsx)(l.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,n.jsxs)("div",{tabIndex:-1,className:P.colorPickerPopover,children:[(0,n.jsxs)("div",{className:P.colorPickerPopoverTabs,children:[(0,n.jsx)("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button",children:"Colors"}),(0,n.jsx)("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button",children:"Custom"}),this.renderCustomPickerTabs()]}),(0,n.jsx)("div",{className:P.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const h=(0,g.cV)(E);h.displayName="ColorPickerPopover";const y=(0,o.N)(b=>({colorPickerPopover:(0,s.css)({borderRadius:b.shape.radius.default,boxShadow:b.shadows.z3,background:b.colors.background.primary,border:`1px solid ${b.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:b.spacing(1,0),background:b.colors.background.secondary,color:b.colors.text.secondary,fontSize:b.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:b.colors.text.primary,fontWeight:b.typography.fontWeightMedium,background:b.colors.background.primary}}),colorPickerPopoverContent:(0,s.css)({width:"246px",fontSize:b.typography.bodySmall.fontSize,minHeight:"184px",padding:b.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,s.css)({display:"flex",width:"100%",borderRadius:`${b.shape.radius.default} ${b.shape.radius.default} 0 0`})}))},83876:(k,A,e)=>{"use strict";e.d(A,{h:()=>d,q:()=>c});var n=e(74848),s=e(32196),l=e(95382),r=e(96540),i=e(84140),g=e(13544),o=e(40845),d=(p=>(p.Small="small",p.Large="large",p))(d||{});const c=r.forwardRef(({color:p,label:u,variant:m="small",isSelected:v,"aria-label":x,...f},E)=>{const h=(0,o.$j)(),{isFocusVisible:y,focusProps:b}=(0,l.o)(),D=a(h,m,p,y,v),P=!!u,C=x||u;return(0,n.jsxs)("div",{ref:E,className:D.wrapper,"data-testid":g.Tp.components.ColorSwatch.name,...f,children:[P&&(0,n.jsx)("span",{className:D.label,children:u}),(0,n.jsx)("button",{className:D.swatch,...b,"aria-label":C?`${C} color`:"Pick a color",type:"button"})]})}),a=(p,u,m,v,x)=>{const f=(0,i.A)(m),h=u==="small"?"16px":"32px";let y="none";return f.getAlpha()<.1&&(y=`2px solid ${p.colors.border.medium}`),{wrapper:(0,s.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,s.css)({marginRight:p.spacing(1)}),swatch:(0,s.css)({width:h,height:h,background:`${m}`,border:y,borderRadius:p.shape.radius.circle,outlineOffset:"1px",outline:v?`2px solid  ${p.colors.primary.main}`:"none",boxShadow:x?`inset 0 0 0 2px ${m}, inset 0 0 0 4px ${p.colors.getContrastText(m)}`:"none",[p.transitions.handleMotion("no-preference")]:{transition:p.transitions.create(["transform"],{duration:p.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};c.displayName="ColorSwatch"},70104:(k,A,e)=>{"use strict";e.d(A,{o:()=>g,t:()=>o});var n=e(74848),s=e(40845),l=e(14186),r=e(15292),i=e(70045);const g=d=>{const{yaxis:c,onToggleAxis:a,color:p,...u}=d,m=a?{yaxis:{name:"Y-Axis",tabComponent(){return(0,n.jsx)(l.I,{labelWidth:20,label:"Use right y-axis",children:(0,n.jsx)(r.K,{value:c===2,label:"Use right y-axis",onChange:a})})}}}:void 0;return(0,n.jsx)(i.$,{...u,color:p||"#000000",customPickers:m})},o=(0,s.cV)(g)},95151:(k,A,e)=>{"use strict";e.d(A,{$:()=>p,A:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(7612),i=e(65229),g=e(84140),o=e(23596),d=e(40845),c=e(36314);const a=({color:m,onChange:v})=>{const[x,f]=(0,l.useState)(m);(0,i.A)(b=>{v(o.MV.asHexString(E.visualization.getColorByName(b)))},500,[x]);const E=(0,d.$j)(),h=(0,d.of)(p),y=(0,l.useMemo)(()=>x.startsWith("rgba")?x:(0,g.A)(E.visualization.getColorByName(m)).toRgbString(),[x,E,m]);return(0,n.jsxs)("div",{className:h.wrapper,children:[(0,n.jsx)(r.p9,{className:h.root,color:y,onChange:f}),(0,n.jsx)(c.A,{theme:E,color:y,onChange:f,className:h.colorInput})]})},p=m=>({wrapper:(0,s.css)({flexGrow:1}),root:(0,s.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${m.shape.radius.default} ${m.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${m.shape.radius.default} ${m.shape.radius.default}`},"&__alpha, &__hue":{height:m.spacing(2),position:"relative"},"&__pointer":{height:m.spacing(2),width:m.spacing(2)}}}),colorInput:(0,s.css)({marginTop:m.spacing(2)})}),u=a},82702:(k,A,e)=>{"use strict";e.d(A,{Z:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(55852);const g=({children:d,className:c,closeOnConfirm:a,confirmText:p="Save",confirmVariant:u="primary",disabled:m=!1,onCancel:v,onClick:x,onConfirm:f,size:E="md"})=>{const h=(0,l.useRef)(null),y=(0,l.useRef)(null),[b,D]=(0,l.useState)(!1),[P,C]=(0,l.useState)(!1),M=(0,r.of)(o);(0,l.useEffect)(()=>{b?(y.current?.focus(),C(!0)):P&&(h.current?.focus(),C(!1))},[P,b]);const I=j=>{j&&j.preventDefault(),D(!0),x?.()},R=j=>{j&&j.preventDefault(),D(!1),h.current?.focus(),v?.()},T=j=>{j&&j.preventDefault(),f?.(),a&&D(!1)},S=(0,s.cx)(c,M.mainButton,{[M.mainButtonHide]:b}),L=(0,s.cx)(M.confirmButton,{[M.confirmButtonHide]:!b}),O=(0,s.cx)(M.confirmButtonContainer,{[M.confirmButtonContainerHide]:!b});return(0,n.jsxs)("div",{className:M.container,children:[(0,n.jsx)("span",{className:S,children:typeof d=="string"?(0,n.jsx)(i.$n,{disabled:m,size:E,fill:"text",onClick:I,ref:h,children:d}):l.cloneElement(d,{disabled:m,onClick:I,ref:h})}),(0,n.jsx)("div",{className:O,children:(0,n.jsxs)("span",{className:L,children:[(0,n.jsx)(i.$n,{size:E,variant:u,onClick:T,ref:y,children:p}),(0,n.jsx)(i.$n,{size:E,fill:"text",onClick:R,children:"Cancel"})]})})]})};g.displayName="ConfirmButton";const o=d=>({container:(0,s.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,s.css)({opacity:1,[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,s.css)({opacity:0,[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","visibility"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,s.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,s.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,s.css)({alignItems:"flex-start",background:d.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","transform"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,s.css)({opacity:0,transform:"translateX(100%)",[d.transitions.handleMotion("no-preference")]:{transition:d.transitions.create(["opacity","transform","visibility"],{duration:d.transitions.duration.shortest,easing:d.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(k,A,e)=>{"use strict";e.d(A,{e:()=>r});var n=e(74848),s=e(55852),l=e(82702);const r=({size:i,disabled:g,onConfirm:o,"aria-label":d,closeOnConfirm:c})=>(0,n.jsx)(l.Z,{confirmText:"Delete",confirmVariant:"destructive",size:i||"md",disabled:g,onConfirm:o,closeOnConfirm:c,children:(0,n.jsx)(s.$n,{"aria-label":d,variant:"destructive",icon:"times",size:i||"sm"})})},45014:(k,A,e)=>{"use strict";e.d(A,{k:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(49785),i=e(13544),g=e(40845),o=e(55852),d=e(88575),c=e(10354),a=e(67061);const p=({body:m,confirmPromptText:v,confirmButtonLabel:x,confirmButtonVariant:f,dismissButtonVariant:E,dismissButtonLabel:h,onConfirm:y,onDismiss:b,onAlternative:D,alternativeButtonLabel:P,description:C,justifyButtons:M="flex-end",disabled:I})=>{const[R,T]=(0,l.useState)(I),S=(0,g.of)(u),L=(0,l.useRef)(null),O=F=>{T(v?.toLowerCase().localeCompare(F.currentTarget.value.toLowerCase())!==0)};(0,l.useEffect)(()=>{L.current?.focus()},[]),(0,l.useEffect)(()=>{T(I?!0:!!v)},[v,I]);const j=async()=>{T(!0);try{await y()}finally{T(!1)}},{handleSubmit:N}=(0,r.mN)();return(0,n.jsxs)("form",{onSubmit:N(j),children:[(0,n.jsxs)("div",{className:S.text,children:[m,C?(0,n.jsx)("div",{className:S.description,children:C}):null,v?(0,n.jsx)("div",{className:S.confirmationInput,children:(0,n.jsx)(a.B,{alignItems:"flex-start",children:(0,n.jsx)(d.D,{disabled:I,children:(0,n.jsx)(c.p,{placeholder:`Type "${v}" to confirm`,onChange:O})})})}):null]}),(0,n.jsx)("div",{className:S.buttonsContainer,children:(0,n.jsxs)(a.B,{justifyContent:M,gap:2,wrap:"wrap",children:[(0,n.jsx)(o.$n,{variant:E,onClick:b,fill:"outline",children:h}),(0,n.jsx)(o.$n,{type:"submit",variant:f,disabled:R,ref:L,"data-testid":i.Tp.pages.ConfirmModal.delete,children:x}),D?(0,n.jsx)(o.$n,{variant:"primary",onClick:D,children:P}):null]})})]})},u=m=>({text:(0,s.css)({fontSize:m.typography.h5.fontSize,color:m.colors.text.primary}),description:(0,s.css)({fontSize:m.typography.body.fontSize}),confirmationInput:(0,s.css)({paddingTop:m.spacing(1)}),buttonsContainer:(0,s.css)({paddingTop:m.spacing(3)})})},96374:(k,A,e)=>{"use strict";e.d(A,{u:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(37390),i=e(45014);const g=({isOpen:d,title:c,body:a,description:p,confirmText:u,confirmVariant:m="destructive",confirmationText:v,dismissText:x="Cancel",dismissVariant:f="secondary",alternativeText:E,modalClass:h,icon:y="exclamation-triangle",onConfirm:b,onDismiss:D,onAlternative:P,confirmButtonVariant:C="destructive",disabled:M})=>{const I=(0,l.of)(o);return(0,n.jsx)(r.a,{className:(0,s.cx)(I.modal,h),title:c,icon:y,isOpen:d,onDismiss:D,children:(0,n.jsx)(i.k,{body:a,description:p,confirmButtonLabel:u,dismissButtonLabel:x,dismissButtonVariant:f,confirmPromptText:v,alternativeButtonLabel:E,confirmButtonVariant:C,onConfirm:b,onDismiss:D,onAlternative:P,disabled:M})})},o=()=>({modal:(0,s.css)({width:"500px"})})},28122:(k,A,e)=>{"use strict";e.d(A,{t:()=>o});var n=e(74848),s=e(96540),l=e(29647),r=e(13544),i=e(38138),g=e(17464);const o=s.memo(({x:d,y:c,onClose:a,focusOnOpen:p=!0,renderMenuItems:u,renderHeader:m})=>{const v=(0,s.useRef)(null),[x,f]=(0,s.useState)({});(0,s.useLayoutEffect)(()=>{const D=v.current;if(D){const P=D.getBoundingClientRect(),C=5,M={right:window.innerWidth<d+P.width,bottom:window.innerHeight<c+P.height+C};f({position:"fixed",left:M.right?d-P.width-C:d-C,top:Math.max(0,M.bottom?c-P.height-C:c+C)})}},[d,c]),(0,l.A)(v,()=>{a?.()});const E=m?.(),h=u?.(),y=D=>{p&&D(0)},b=D=>{D.key==="Escape"&&(D.preventDefault(),D.stopPropagation(),a?.())};return(0,n.jsx)(g.ZL,{children:(0,n.jsx)(i.W,{header:E,ref:v,style:x,ariaLabel:r.Tp.components.Menu.MenuComponent("Context"),onOpen:y,onClick:a,onKeyDown:b,children:h})})});o.displayName="ContextMenu"},51686:(k,A,e)=>{"use strict";e.d(A,{n:()=>r});var n=e(74848),s=e(96540),l=e(28122);const r=({children:i,renderMenuItems:g,focusOnOpen:o=!0})=>{const[d,c]=(0,s.useState)(!1),[a,p]=(0,s.useState)({x:0,y:0});return(0,n.jsxs)(n.Fragment,{children:[i({openMenu:u=>{c(!0),p({x:u.pageX,y:u.pageY})}}),d&&(0,n.jsx)(l.t,{onClose:()=>c(!1),x:a.x,y:a.y,renderMenuItems:g,focusOnOpen:o})]})}},40276:(k,A,e)=>{"use strict";e.d(A,{E:()=>d,A:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(62295),i=e(40845);const g=({children:u})=>{const[m,v]=(0,l.useState)(!1),[x,f]=(0,l.useState)(!1),E=(0,l.useRef)(null),h=(0,l.useRef)(null),y=(0,i.of)(o);return(0,l.useEffect)(()=>{const b=new IntersectionObserver(D=>{D.forEach(P=>{P.target===E.current?v(!P.isIntersecting):P.target===h.current&&f(!P.isIntersecting)})});return[E,h].forEach(D=>{D.current&&b.observe(D.current)}),()=>b.disconnect()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,s.cx)(y.scrollIndicator,y.scrollTopIndicator,{[y.scrollIndicatorVisible]:m})}),(0,n.jsxs)("div",{className:y.scrollContent,children:[(0,n.jsx)("div",{ref:E}),u,(0,n.jsx)("div",{ref:h})]}),(0,n.jsx)("div",{className:(0,s.cx)(y.scrollIndicator,y.scrollBottomIndicator,{[y.scrollIndicatorVisible]:x})})]})},o=u=>({scrollContent:(0,s.css)({flex:1,position:"relative"}),scrollIndicator:(0,s.css)({height:u.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[u.transitions.handleMotion("no-preference","reduce")]:{transition:u.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,s.css)({background:`linear-gradient(0deg, transparent, ${u.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,s.css)({background:`linear-gradient(180deg, transparent, ${u.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,s.css)({opacity:1})}),d=({autoHide:u=!1,autoHideTimeout:m=200,setScrollTop:v,className:x,testId:f,autoHeightMin:E="0",autoHeightMax:h="100%",hideTracksWhenNotNeeded:y=!1,hideHorizontalTrack:b,hideVerticalTrack:D,scrollRefCallback:P,showScrollIndicators:C=!1,updateAfterMountMs:M,scrollTop:I,onScroll:R,children:T,divId:S})=>{const L=(0,l.useRef)(null),O=(0,i.of)(a);(0,l.useEffect)(()=>{L.current&&P&&P(L.current.view)},[L,P]),p(L.current,I),(0,l.useEffect)(()=>{M&&setTimeout(()=>{const W=L.current;W?.update&&W.update()},M)},[M]);function j(W,z,Y){return Y.style&&z&&(Y.style.display="none"),(0,n.jsx)("div",{...Y,className:W})}const N=(0,l.useCallback)(W=>j("track-horizontal",b,W),[b]),F=(0,l.useCallback)(W=>j("track-vertical",D,W),[D]),U=(0,l.useCallback)(W=>(0,n.jsx)("div",{...W,className:"thumb-horizontal"}),[]),w=(0,l.useCallback)(W=>(0,n.jsx)("div",{...W,className:"thumb-vertical"}),[]),B=(0,l.useCallback)(W=>(W.style&&W.style.WebkitOverflowScrolling==="touch"&&(W.style.WebkitOverflowScrolling="auto"),(0,n.jsx)("div",{...W,className:"scrollbar-view",id:S})),[S]),K=(0,l.useCallback)(()=>{L.current&&v&&v(L.current.getValues())},[v]);return(0,n.jsx)(r.Ay,{"data-testid":f,ref:L,className:(0,s.cx)(O.customScrollbar,x,{[O.scrollbarWithScrollIndicators]:C}),onScrollStop:K,autoHeight:!0,autoHide:u,autoHideTimeout:m,hideTracksWhenNotNeeded:y,autoHeightMax:h,autoHeightMin:E,renderTrackHorizontal:N,renderTrackVertical:F,renderThumbHorizontal:U,renderThumbVertical:w,renderView:B,onScroll:R,children:C?(0,n.jsx)(g,{children:T}):T})},c=d,a=u=>({customScrollbar:(0,s.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:u.shape.borderRadius(2),width:`${u.spacing(1)} !important`,right:0,bottom:u.spacing(.25),top:u.spacing(.25)},".track-horizontal":{borderRadius:u.shape.borderRadius(2),height:`${u.spacing(1)} !important`,right:u.spacing(.25),bottom:u.spacing(.25),left:u.spacing(.25)},".thumb-vertical":{background:u.colors.action.focus,borderRadius:u.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:u.colors.action.focus,borderRadius:u.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,s.css)({".scrollbar-view":{position:"static !important"}})});function p(u,m){(0,l.useEffect)(()=>{u&&m!=null&&u.scrollTop(m)},[m,u])}},14689:(k,A,e)=>{"use strict";e.d(A,{R:()=>l});var n=e(74848),s=e(55852);function l({link:r,buttonProps:i}){return(0,n.jsx)("a",{href:r.href,target:r.target,rel:"noreferrer",onClick:r.onClick?g=>{!(g.ctrlKey||g.metaKey||g.shiftKey)&&r.onClick&&(g.preventDefault(),r.onClick(g))}:void 0,children:(0,n.jsx)(s.$n,{icon:r.target==="_blank"?"external-link-alt":void 0,variant:"primary",size:"sm",...i,children:r.title})})}},64078:(k,A,e)=>{"use strict";e.d(A,{l:()=>R});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(28848),o=e.n(g),d=e(96540),c=e(80292),a=e(52845),p=e(29317),u=e(91890),m=e(6709),v=e(41781),x=e(40845),f=e(72307),E=e(40276),h=e(10354),y=e(17464),b=e(43538);class D{getBoundingClientRect(){const L=window.getSelection(),O=L&&L.anchorNode;return O&&O.parentElement?O.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const P=(S,L)=>S-L*Math.floor(S/L),C={builtInVariable:{pattern:/(\${\S+?})/}},M=[(0,v.D)({onlyIn:S=>"type"in S&&S.type==="code_block",getSyntax:()=>"links"},{...o().languages,links:C})],I=S=>({input:(0,h.n)({theme:S,invalid:!1}).input,editor:(0,s.css)({".token.builtInVariable":{color:S.colors.success.text},".token.variable":{color:S.colors.primary.text}}),suggestionsWrapper:(0,s.css)({boxShadow:S.shadows.z2}),wrapperOverrides:(0,s.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),R=(0,d.memo)(({value:S,onChange:L,suggestions:O,placeholder:j="http://your-grafana.com/d/000000010/annotations"})=>{const N=(0,d.useRef)(null),F=(0,x.of)(I),[U,w]=(0,d.useState)(!1),[B,K]=(0,d.useState)(0),[W,z]=(0,d.useState)((0,f.mO)(S)),Y=(0,c.A)(W),[X,q]=(0,d.useState)(0),G=[(0,l.cY)(({rects:oe})=>({alignmentAxis:oe.reference.width})),(0,l.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,l.BN)()],{refs:te,floatingStyles:H}=(0,r.we)({open:U,placement:"bottom-start",onOpenChange:w,middleware:G,whileElementsMounted:i.ll,strategy:"fixed"}),se=(0,d.useRef)({showingSuggestions:U,suggestions:O,suggestionsIndex:B,linkUrl:W,onChange:L});se.current={showingSuggestions:U,suggestions:O,suggestionsIndex:B,linkUrl:W,onChange:L};const ne=(0,d.useRef)(null);(0,d.useEffect)(()=>{q(T(ne.current,B))},[B]);const le=d.useCallback((oe,J)=>{if(!se.current.showingSuggestions){if(oe.key==="="||oe.key==="$"||oe.keyCode===32&&oe.ctrlKey){const ee=new D;return te.setReference(ee),w(!0)}return J()}switch(oe.key){case"Backspace":se.current.linkUrl.focusText.getText().length===1&&J();case"Escape":return w(!1),K(0);case"Enter":return oe.preventDefault(),Q(se.current.suggestions[se.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":oe.preventDefault();const ee=oe.key==="ArrowDown"?1:-1;return K(de=>P(de+ee,se.current.suggestions.length));default:return J()}},[]);(0,d.useEffect)(()=>{Y&&Y.selection.isFocused&&!W.selection.isFocused&&se.current.onChange(a.A.serialize(W))},[W,Y]);const _=d.useCallback(({value:oe})=>{z(oe)},[]),Q=(oe,J=N.current)=>{const de=ae()==="$";oe.origin!==u.$0.Template||oe.value===m.c.includeVars?J.insertText(`${de?"":"$"}{${oe.value}}`):J.insertText(`${de?"":"$"}{${oe.value}:queryparam}`),z(J.value),w(!1),K(0),se.current.onChange(a.A.serialize(J.value))},ae=()=>{const oe=document.getElementById("data-link-input");let J="",ee,de;return window.getSelection&&(ee=window.getSelection(),ee&&ee.rangeCount>0&&(de=ee.getRangeAt(0).cloneRange(),de.collapse(!0),de.setStart(oe,0),J=de.toString().slice(-1))),J};return(0,n.jsx)("div",{className:F.wrapperOverrides,children:(0,n.jsx)("div",{className:"slate-query-field__wrapper",children:(0,n.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[U&&(0,n.jsx)(y.ZL,{children:(0,n.jsx)("div",{ref:te.setFloating,style:H,children:(0,n.jsx)(E.A,{scrollTop:X,autoHeightMax:"300px",setScrollTop:({scrollTop:oe})=>q(oe),children:(0,n.jsx)(b.k,{activeRef:ne,suggestions:se.current.suggestions,onSuggestionSelect:Q,onClose:()=>w(!1),activeIndex:B})})})}),(0,n.jsx)(p.KE,{schema:f.yx,ref:N,placeholder:j,value:se.current.linkUrl,onChange:_,onKeyDown:(oe,J,ee)=>le(oe,ee),plugins:M,className:(0,s.cx)(F.editor,F.input,(0,s.css)({padding:"3px 8px"}))})]})})})});R.displayName="DataLinkInput";function T(S,L){return(S?.clientHeight??0)*L}},43538:(k,A,e)=>{"use strict";e.d(A,{k:()=>a});var n=e(74848),s=e(96540),l=e(32196),r=e(2543),i=e.n(r),g=e(37151),o=e(40845),d=e(33552);const c=u=>({list:(0,l.css)({borderBottom:`1px solid ${u.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,l.css)({background:u.colors.background.primary,width:"250px"}),item:(0,l.css)({background:"none",padding:"2px 8px",userSelect:"none",color:u.colors.text.primary,cursor:"pointer","&:hover":{background:u.colors.action.hover}}),label:(0,l.css)({color:u.colors.text.secondary}),activeItem:(0,l.css)({background:u.colors.background.secondary,"&:hover":{background:u.colors.background.secondary}}),itemValue:(0,l.css)({fontFamily:u.typography.fontFamilyMonospace,fontSize:u.typography.size.sm})}),a=({suggestions:u,...m})=>{const v=(0,s.useRef)(null);(0,g.A)(v,()=>{m.onClose&&m.onClose()});const x=(0,s.useMemo)(()=>(0,r.groupBy)(u,E=>E.origin),[u]),f=(0,o.of)(c);return(0,n.jsx)("div",{role:"menu",ref:v,className:f.wrapper,children:Object.keys(x).map((E,h)=>{const y=h===0?0:Object.keys(x).reduce((b,D,P)=>P>=h?b:b+x[D].length,0);return(0,s.createElement)(p,{...m,suggestions:x[E],label:`${(0,r.capitalize)(E)}`,activeIndex:m.activeIndex,activeIndexOffset:y,key:E})})})};a.displayName="DataLinkSuggestions";const p=s.memo(({activeIndex:u,activeIndexOffset:m,label:v,onClose:x,onSuggestionSelect:f,suggestions:E,activeRef:h})=>{const y=(0,o.of)(c);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(d.B,{className:y.list,items:E,renderItem:(b,D)=>{const P=D+m===u;return(0,n.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,l.cx)(y.item,P&&y.activeItem),ref:P?h:void 0,onClick:()=>{f(b)},title:b.documentation,children:(0,n.jsxs)("span",{className:y.itemValue,children:[(0,n.jsx)("span",{className:y.label,children:v})," ",b.label]})})}})})});p.displayName="DataLinkSuggestionsList"},59796:(k,A,e)=>{"use strict";e.d(A,{e:()=>d});var n=e(74848),s=e(32196),l=e(13544),r=e(14555),i=e(51686),g=e(59093),o=e(64539);const d=({children:c,links:a,style:p})=>{const u=[{items:(0,r.J)(a),label:"Data links"}],m=u[0].items.length,v=()=>u.map((f,E)=>(0,n.jsx)(g.r,{label:f.label,children:(f.items||[]).map((h,y)=>(0,n.jsx)(o.D,{url:h.url,label:h.label,target:h.target,icon:h.icon,active:h.active,onClick:h.onClick},`${f.label}-${E}-${y}}`))},`${f.label}${E}`)),x=(0,s.css)({cursor:"context-menu"});if(m>1)return(0,n.jsx)(i.n,{renderMenuItems:v,children:({openMenu:f})=>c({openMenu:f,targetClassName:x})});{const f=a()[0];return(0,n.jsx)("a",{href:f.href,onClick:f.onClick,target:f.target,title:f.title,style:{...p,overflow:"hidden",display:"flex"},"data-testid":l.Tp.components.DataLinksContextMenu.singleLink,children:c({})})}}},64919:(k,A,e)=>{"use strict";e.d(A,{e:()=>P});var n=e(74848),s=e(32196),l=e(91076),r=e(2543),i=e(96540),g=e(40845),o=e(55852),d=e(37390),c=e(14555),a=e(88575),p=e(10354),u=e(15292),m=e(64078);const v=M=>({listItem:(0,s.css)({marginBottom:M.spacing()}),infoText:(0,s.css)({paddingBottom:M.spacing(2),marginLeft:"66px",color:M.colors.text.secondary})}),x=(0,i.memo)(({index:M,value:I,onChange:R,suggestions:T,isLast:S})=>{const L=(0,g.of)(v),O=(F,U)=>{R(M,{...I,url:F},U)},j=F=>{R(M,{...I,title:F.target.value})},N=()=>{R(M,{...I,targetBlank:!I.targetBlank})};return(0,n.jsxs)("div",{className:L.listItem,children:[(0,n.jsx)(a.D,{label:"Title",children:(0,n.jsx)(p.p,{value:I.title,onChange:j,placeholder:"Show details"})}),(0,n.jsx)(a.D,{label:"URL",invalid:(0,c.F)(I.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL.",children:(0,n.jsx)(m.l,{value:I.url,onChange:O,suggestions:T})}),(0,n.jsx)(a.D,{label:"Open in new tab",children:(0,n.jsx)(u.d,{value:I.targetBlank||!1,onChange:N})}),S&&(0,n.jsx)("div",{className:L.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});x.displayName="DataLinkEditor";const f=({link:M,index:I,getSuggestions:R,onSave:T,onCancel:S})=>{const[L,O]=(0,i.useState)(M);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x,{value:L,index:I,isLast:!1,suggestions:R(),onChange:(j,N)=>{O(N)}}),(0,n.jsxs)(d.a.ButtonRow,{children:[(0,n.jsx)(o.$n,{variant:"secondary",onClick:()=>S(I),fill:"outline",children:"Cancel"}),(0,n.jsx)(o.$n,{onClick:()=>{T(I,L)},children:"Save"})]})]})};var E=e(72093),h=e(14578),y=e(29158);const b=({link:M,onEdit:I,onRemove:R,index:T,itemKey:S})=>{const L=(0,g.of)(D),{title:O="",url:j=""}=M,N=O.trim()!=="",F=j.trim()!=="",U=(0,c.F)(j);return(0,n.jsx)(l.sx,{draggableId:S,index:T,children:w=>(0,n.jsx)(n.Fragment,{children:(0,i.createElement)("div",{className:(0,s.cx)(L.wrapper,L.dragRow),ref:w.innerRef,...w.draggableProps,key:T},(0,n.jsxs)("div",{className:L.linkDetails,children:[(0,n.jsx)("div",{className:(0,s.cx)(L.url,!F&&L.notConfigured,U&&L.errored),children:N?O:"Data link title not provided"}),(0,n.jsx)("div",{className:(0,s.cx)(L.url,!F&&L.notConfigured,U&&L.errored),title:j,children:F?j:"Data link url not provided"}),U&&(0,n.jsx)(E.P,{children:"Explore data link may not work in the future. Please edit."})]}),(0,n.jsxs)("div",{className:L.icons,children:[(0,n.jsx)(y.K,{name:"pen",onClick:I,className:L.icon,tooltip:"Edit data link"}),(0,n.jsx)(y.K,{name:"trash-alt",onClick:R,className:L.icon,tooltip:"Remove data link"}),(0,n.jsx)("div",{className:L.dragIcon,...w.dragHandleProps,children:(0,n.jsx)(h.I,{name:"draggabledots",size:"lg"})})]}))})},S)},D=M=>({wrapper:(0,s.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",padding:"5px 0 5px 10px",borderRadius:M.shape.radius.default,background:M.colors.background.secondary,gap:8}),linkDetails:(0,s.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,s.css)({color:M.colors.error.text,fontStyle:"italic"}),notConfigured:(0,s.css)({fontStyle:"italic"}),title:(0,s.css)({color:M.colors.text.primary,fontSize:M.typography.size.sm,fontWeight:M.typography.fontWeightMedium}),url:(0,s.css)({color:M.colors.text.secondary,fontSize:M.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,s.css)({position:"relative"}),icons:(0,s.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,s.css)({cursor:"grab",color:M.colors.text.secondary,margin:M.spacing(0,.5)}),icon:(0,s.css)({color:M.colors.text.secondary})}),P=({links:M,onChange:I,getSuggestions:R,data:T,showOneClick:S=!1})=>{const[L,O]=(0,i.useState)(null),[j,N]=(0,i.useState)(!1),[F,U]=(0,i.useState)([]);(0,i.useEffect)(()=>{U(M??[])},[M]);const w=(0,g.of)(C),B=L!==null,K=(G,te)=>{if(j)if(te.title.trim()===""&&te.url.trim()===""){N(!1),O(null);return}else O(null),N(!1);const H=(0,r.cloneDeep)(F);H[G]=te,I(H),O(null)},W=()=>{let G=(0,r.cloneDeep)(F);O(G.length),N(!0)},z=G=>{j&&N(!1),O(null)},Y=G=>{const te=(0,r.cloneDeep)(F);te.splice(G,1),I(te)},X=G=>{if(!M||!G.destination)return;const te=(0,r.cloneDeep)(F),H=te[G.source.index];te.splice(G.source.index,1),te.splice(G.destination.index,0,H),U(te),I(te)},q=(G,te)=>S?(0,n.jsxs)("div",{className:w.oneClickOverlay,children:[(0,n.jsx)("span",{className:w.oneClickSpan,children:"One-click link"}),G]},te):G;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.JY,{onDragEnd:X,children:(0,n.jsx)(l.gL,{droppableId:"sortable-links",direction:"vertical",children:G=>(0,n.jsxs)("div",{className:w.wrapper,ref:G.innerRef,...G.droppableProps,children:[F.map((te,H)=>{const se=`${te.title}/${H}`,ne=(0,n.jsx)("div",{className:w.itemWrapper,children:(0,n.jsx)(b,{index:H,link:te,onChange:K,onEdit:()=>O(H),onRemove:()=>Y(H),data:T,itemKey:se},se)});return H===0?q(ne,se):ne}),G.placeholder]})})}),B&&L!==null&&(0,n.jsx)(d.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{z(L)},children:(0,n.jsx)(f,{index:L,link:j?{title:"",url:""}:F[L],data:T,onSave:K,onCancel:z,getSuggestions:R})}),(0,n.jsx)(o.$n,{size:"sm",icon:"plus",onClick:W,variant:"secondary",className:w.button,children:"Add link"})]})},C=M=>({wrapper:(0,s.css)({marginBottom:M.spacing(2),display:"flex",flexDirection:"column"}),oneClickOverlay:(0,s.css)({height:"auto",border:`2px dashed ${M.colors.text.link}`,fontSize:10,color:M.colors.text.primary,marginBottom:M.spacing(1)}),oneClickSpan:(0,s.css)({padding:10,marginBottom:-10,display:"inline-block"}),itemWrapper:(0,s.css)({padding:"4px 8px 8px 8px"}),button:(0,s.css)({marginLeft:M.spacing(1)})})},79961:(k,A,e)=>{"use strict";e.d(A,{n:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(14578),i=e(14689);function g({links:d}){const c=(0,l.of)(o);if(d.length===1)return(0,n.jsx)(i.R,{link:d[0]});const a=d.filter(u=>u.target==="_blank"),p=d.filter(u=>u.target==="_self");return(0,n.jsxs)(n.Fragment,{children:[p.map((u,m)=>(0,n.jsx)(i.R,{link:u},m)),(0,n.jsxs)("div",{className:c.wrapper,children:[(0,n.jsx)("p",{className:c.externalLinksHeading,children:"External links"}),a.map((u,m)=>(0,n.jsxs)("a",{href:u.href,target:u.target,className:c.externalLink,children:[(0,n.jsx)(r.I,{name:"external-link-alt"}),u.title]},m))]})]})}const o=d=>({wrapper:(0,s.css)({flexBasis:"150px",width:"100px",marginTop:d.spacing(1)}),externalLinksHeading:(0,s.css)({color:d.colors.text.secondary,fontWeight:d.typography.fontWeightRegular,fontSize:d.typography.size.sm,margin:0}),externalLink:(0,s.css)({color:d.colors.text.link,fontWeight:d.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:d.spacing(1)}})})},19849:(k,A,e)=>{"use strict";e.d(A,{i:()=>r});var n=e(74848),s=e(15292),l=e(14186);function r({options:i,onOptionsChange:g}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Alerting"}),(0,n.jsx)("div",{className:"gf-form-group",children:(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(l.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:i.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,n.jsx)(s.K,{value:i.jsonData.manageAlerts!==!1,onChange:o=>g({...i,jsonData:{...i.jsonData,manageAlerts:o.currentTarget.checked}})})})})})})]})}},28623:(k,A,e)=>{"use strict";e.d(A,{K:()=>o});var n=e(74848),s=e(55852),l=e(14186),r=e(39268),i=e(10354),g=e(21744);const o=({hasCert:d,label:c,onChange:a,onClick:p,placeholder:u})=>(0,n.jsxs)(r.C,{children:[(0,n.jsx)(l.I,{label:c,labelWidth:14,disabled:d,children:d?(0,n.jsx)(i.p,{type:"text",value:"configured",width:24}):(0,n.jsx)(g.f,{rows:7,onChange:a,placeholder:u,required:!0})}),d&&(0,n.jsx)(s.$n,{variant:"secondary",onClick:p,style:{marginLeft:4},children:"Reset"})]})},11184:(k,A,e)=>{"use strict";e.d(A,{P:()=>m});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(40845),o=e(55852),d=e(90090),c=e(14578),a=e(56286);const p=()=>({layout:(0,s.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),u=({header:x,onBlur:f,onChange:E,onRemove:h,onReset:y})=>{const b=(0,g.of)(p);return(0,n.jsxs)("div",{className:b.layout,children:[(0,n.jsx)(d.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:x.name||"",onChange:D=>E({...x,name:D.target.value}),onBlur:f}),(0,n.jsx)(a.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:x.configured,value:x.value,labelWidth:5,inputWidth:x.configured?11:12,placeholder:"Header Value",onReset:()=>y(x.id),onChange:D=>E({...x,value:D.target.value}),onBlur:f}),(0,n.jsx)(o.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:D=>h(x.id),children:(0,n.jsx)(c.I,{name:"trash-alt"})})]})};u.displayName="CustomHeaderRow";class m extends i.PureComponent{constructor(f){super(f),this.state={headers:[]},this.updateSettings=()=>{const{headers:b}=this.state,D=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([C,M])=>!C.startsWith("httpHeaderName"))),P=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([C,M])=>!C.startsWith("httpHeaderValue")));for(const[C,M]of b.entries())D[`httpHeaderName${C+1}`]=M.name,M.configured||(P[`httpHeaderValue${C+1}`]=M.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:D,secureJsonData:P})},this.onHeaderAdd=()=>{this.setState(b=>({headers:[...b.headers,{id:(0,l.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(b,D)=>{this.setState(({headers:P})=>({headers:P.map((C,M)=>b!==M?C:{...D})}))},this.onHeaderReset=b=>{this.setState(({headers:D})=>({headers:D.map((P,C)=>P.id!==b?P:{...P,value:"",configured:!1})}))},this.onHeaderRemove=b=>{this.setState(({headers:D})=>({headers:D.filter(P=>P.id!==b)}),this.updateSettings)};const{jsonData:E,secureJsonData:h,secureJsonFields:y}=this.props.dataSourceConfig;this.state={headers:Object.keys(E).sort().filter(b=>b.startsWith("httpHeaderName")).map((b,D)=>({id:(0,l.uniqueId)(),name:E[b],value:h!==void 0?h[b]:"",configured:y&&y[`httpHeaderValue${D+1}`]||!1}))}}render(){const{headers:f}=this.state,{dataSourceConfig:E}=this.props;return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)("h6",{children:"Custom HTTP Headers"})}),(0,n.jsx)("div",{children:f.map((h,y)=>(0,n.jsx)(u,{header:h,onChange:b=>{this.onHeaderChange(y,b)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},h.id))}),!E.readOnly&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(o.$n,{variant:"secondary",icon:"plus",type:"button",onClick:h=>{this.onHeaderAdd()},children:"Add header"})})]})}}var v=null},91409:(k,A,e)=>{"use strict";e.d(A,{t:()=>T});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(42418),o=e(90090),d=e(38894),c=e(14186),a=e(91634),p=e(14578),u=e(90182),m=e(15292),v=e(79924),x=e(94753),f=e(56286);const E=({dataSourceConfig:S,onChange:L})=>{const O=S.secureJsonData?S.secureJsonData.basicAuthPassword:"",j=()=>{L({...S,secureJsonData:{...S.secureJsonData,basicAuthPassword:""},secureJsonFields:{...S.secureJsonFields,basicAuthPassword:!1}})},N=F=>{L({...S,secureJsonData:{...S.secureJsonData,basicAuthPassword:F.currentTarget.value}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.I,{disabled:S.readOnly,children:(0,n.jsx)(o.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:S.basicAuthUser,onChange:F=>L({...S,basicAuthUser:F.currentTarget.value})})}),(0,n.jsx)(c.I,{disabled:S.readOnly,children:(0,n.jsx)(f.L,{isConfigured:!!(S.secureJsonFields&&S.secureJsonFields.basicAuthPassword),value:O||"",inputWidth:18,labelWidth:10,onReset:j,onChange:N})})]})};var h=e(11184);const y=26,b=({dataSourceConfig:S,onChange:L,showForwardOAuthIdentityOption:O=!0})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"gf-form-inline",children:[(0,n.jsx)(c.I,{label:"TLS Client Auth",labelWidth:y,disabled:S.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-tls-client-auth",value:S.jsonData.tlsAuth||!1,onChange:j=>L({...S.jsonData,tlsAuth:j.currentTarget.checked})})}),(0,n.jsx)(c.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:y,disabled:S.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-ca-cert",value:S.jsonData.tlsAuthWithCACert||!1,onChange:j=>L({...S.jsonData,tlsAuthWithCACert:j.currentTarget.checked})})})]}),(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)(c.I,{label:"Skip TLS Verify",labelWidth:y,disabled:S.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-skip-tls-verify",value:S.jsonData.tlsSkipVerify||!1,onChange:j=>L({...S.jsonData,tlsSkipVerify:j.currentTarget.checked})})})}),O&&(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)(c.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:y,disabled:S.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-forward-oauth",value:S.jsonData.oauthPassThru||!1,onChange:j=>L({...S.jsonData,oauthPassThru:j.currentTarget.checked})})})})]});var D=e(17081),P=e(95180);const C=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],M={label:"Server (default)",value:"proxy"},I=()=>(0,n.jsxs)(g.F,{severity:"info",title:"",topSpacing:3,children:[(0,n.jsxs)("p",{children:["Access mode controls how requests to the data source will be handled.",(0,n.jsxs)("strong",{children:["\xA0",(0,n.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]}),(0,n.jsx)(x.E,{weight:"medium",children:"Server access mode (Default):"}),(0,n.jsx)("p",{children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."}),(0,n.jsx)(x.E,{weight:"medium",children:"Browser access mode:"}),(0,n.jsx)("p",{children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})]}),R=26,T=S=>{const{defaultUrl:L,dataSourceConfig:O,onChange:j,showAccessOptions:N,sigV4AuthToggleEnabled:F,showForwardOAuthIdentityOption:U,azureAuthSettings:w,renderSigV4Editor:B,secureSocksDSProxyEnabled:K,urlLabel:W,urlDocs:z}=S,[Y,X]=(0,l.useState)(!1),[q,G]=(0,l.useState)(!1),te=(0,i.$j)();let H;const se=(0,l.useCallback)(J=>{const ee=w?.azureAuthSupported&&w.getAzureAuthEnabled(O)||!1;if(G(ee),ee){const de=O.jsonData.oauthPassThru!==void 0?O.jsonData.oauthPassThru:!1;J={...J,jsonData:{...O.jsonData,oauthPassThru:ee?!1:de}}}j({...O,...J})},[w,O,j]);switch(O.access){case"direct":H=(0,n.jsxs)(n.Fragment,{children:["Your access method is ",(0,n.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser.",z]});break;case"proxy":H=(0,n.jsxs)(n.Fragment,{children:["Your access method is ",(0,n.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server.",z]});break;default:H=(0,n.jsxs)(n.Fragment,{children:["Specify a complete HTTP URL (for example http://your_server:8080) ",z]})}const ne=(0,n.jsx)(u.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:C,value:C.filter(J=>J.value===O.access)[0]||M,onChange:J=>se({access:J.value}),disabled:O.readOnly}),le=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(O.url),_=(0,s.css)({boxShadow:`inset 0 0px 5px ${te.v1.palette.red}`}),Q=(0,s.cx)({"width-20":!0,[_]:!le}),ae=(0,l.useId)(),oe=(0,n.jsx)(a.p,{id:ae,className:Q,placeholder:L,value:O.url,"data-testid":r.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:J=>se({url:J.currentTarget.value}),disabled:O.readOnly});return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"page-heading",children:"HTTP"}),(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(o.z,{interactive:!!z,label:W??"URL",labelWidth:13,tooltip:H,inputEl:oe})}),N&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"gf-form-inline",children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(o.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:ne})}),(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsxs)("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>X(J=>!J),children:["Help\xA0",(0,n.jsx)(p.I,{name:Y?"angle-down":"angle-right",style:{marginBottom:0}})]})})]}),Y&&(0,n.jsx)(I,{})]}),O.access==="proxy"&&(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(d.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",children:"Allowed cookies"}),(0,n.jsx)(v.u,{tags:O.jsonData.keepCookies,width:40,onChange:J=>se({jsonData:{...O.jsonData,keepCookies:J}}),disabled:O.readOnly})]}),(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(o.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:O.jsonData.timeout,onChange:J=>{se({jsonData:{...O.jsonData,timeout:parseInt(J.currentTarget.value,10)}})},disabled:O.readOnly})})]})]})]}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Auth"}),(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsxs)("div",{className:"gf-form-inline",children:[(0,n.jsx)(c.I,{label:"Basic auth",labelWidth:R,disabled:O.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-basic-auth",value:O.basicAuth,onChange:J=>{se({basicAuth:J.currentTarget.checked})}})}),(0,n.jsx)(c.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:R,disabled:O.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-with-credentials",value:O.withCredentials,onChange:J=>{se({withCredentials:J.currentTarget.checked})}})})]}),w?.azureAuthSupported&&(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)(c.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:R,disabled:O.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-azure-auth",value:q,onChange:J=>{se(w.setAzureAuthEnabled(O,J.currentTarget.checked))}})})}),F&&(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)(c.I,{label:"SigV4 auth",labelWidth:R,disabled:O.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-sigv4-auth",value:O.jsonData.sigV4Auth||!1,onChange:J=>{se({jsonData:{...O.jsonData,sigV4Auth:J.currentTarget.checked}})}})})}),O.access==="proxy"&&(0,n.jsx)(b,{dataSourceConfig:O,onChange:J=>se({jsonData:J}),showForwardOAuthIdentityOption:q?!1:U})]}),O.basicAuth&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h6",{children:"Basic Auth Details"}),(0,n.jsx)("div",{className:"gf-form-group",children:(0,n.jsx)(E,{...S})})]}),w?.azureAuthSupported&&q&&w.azureSettingsUI&&(0,n.jsx)(w.azureSettingsUI,{dataSourceConfig:O,onChange:j}),O.jsonData.sigV4Auth&&F&&B,(O.jsonData.tlsAuth||O.jsonData.tlsAuthWithCACert)&&(0,n.jsx)(P.j,{dataSourceConfig:O,onChange:j}),O.access==="proxy"&&(0,n.jsx)(h.P,{dataSourceConfig:O,onChange:j})]}),K&&(0,n.jsx)(D.Y,{options:O,onOptionsChange:j})]})}},17081:(k,A,e)=>{"use strict";e.d(A,{Y:()=>r});var n=e(74848),s=e(15292),l=e(14186);function r({options:i,onOptionsChange:g}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Secure Socks Proxy"}),(0,n.jsx)("div",{className:"gf-form-group",children:(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(l.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy.",children:(0,n.jsx)(s.K,{value:i.jsonData.enableSecureSocksProxy??!1,onChange:o=>g({...i,jsonData:{...i.jsonData,enableSecureSocksProxy:o.currentTarget.checked}})})})})})})]})}},95180:(k,A,e)=>{"use strict";e.d(A,{j:()=>o});var n=e(74848),s=e(32196),l=e(90090),r=e(14578),i=e(56034),g=e(28623);const o=({dataSourceConfig:d,onChange:c})=>{const a=d.secureJsonFields&&d.secureJsonFields.tlsCACert,p=d.secureJsonFields&&d.secureJsonFields.tlsClientCert,u=d.secureJsonFields&&d.secureJsonFields.tlsClientKey,m=d.jsonData&&d.jsonData.serverName,v=E=>h=>{h.preventDefault();const y={...d.secureJsonFields};y[E]=!1,c({...d,secureJsonFields:y})},x=E=>h=>{const y={...d.secureJsonData};y[E]=h.currentTarget.value,c({...d,secureJsonData:y})},f=E=>{const h={...d.jsonData,serverName:E.currentTarget.value};c({...d,jsonData:h})};return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsxs)("div",{className:(0,s.cx)("gf-form",(0,s.css)({alignItems:"baseline"})),children:[(0,n.jsx)("h6",{children:"TLS/SSL Auth Details"}),(0,n.jsx)(i.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info",children:(0,n.jsx)(r.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,n.jsxs)("div",{children:[d.jsonData.tlsAuthWithCACert&&(0,n.jsx)(g.K,{hasCert:!!a,onChange:x("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:v("tlsCACert")}),d.jsonData.tlsAuth&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(l.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:m&&d.jsonData.serverName,onChange:f})}),(0,n.jsx)(g.K,{hasCert:!!p,label:"Client Cert",onChange:x("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:v("tlsClientCert")}),(0,n.jsx)(g.K,{hasCert:!!u,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:x("tlsClientKey"),onClick:v("tlsClientKey")})]})]})]})}},56181:(k,A,e)=>{"use strict";e.d(A,{l:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(29426),i=e(40845),g=e(8866),o=e(14578),d=e(72265);const c=(0,l.memo)(u=>{const m=(0,i.of)(p),{isOpen:v,onClose:x}=u;return v?(0,n.jsx)(g.N,{useCapture:!0,includeButtonPress:!1,onClick:x,children:(0,n.jsx)("div",{className:m.modal,"data-testid":"date-picker",children:(0,n.jsx)(a,{...u})})}):null});c.displayName="DatePicker";const a=(0,l.memo)(({value:u,minDate:m,maxDate:v,onChange:x})=>{const f=(0,i.of)(d.h2);return(0,n.jsx)(r.Ay,{className:f.body,tileClassName:f.title,value:u||new Date,minDate:m,maxDate:v,nextLabel:(0,n.jsx)(o.I,{name:"angle-right"}),prevLabel:(0,n.jsx)(o.I,{name:"angle-left"}),onChange:E=>{E&&!Array.isArray(E)&&x(E)},locale:"en"})});a.displayName="Body";const p=u=>({modal:(0,s.css)({zIndex:u.zIndex.modal,boxShadow:u.shadows.z3,backgroundColor:u.colors.background.primary,border:`1px solid ${u.colors.border.weak}`,borderTopLeftRadius:u.shape.radius.default,borderBottomLeftRadius:u.shape.radius.default,"button:disabled":{color:u.colors.text.disabled}})})},98239:(k,A,e)=>{"use strict";e.d(A,{l:()=>u});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(96540),o=e(47232),d=e(40845),c=e(10354),a=e(56181);const p=v=>(0,o.KQ)(v).format("L"),u=({value:v,minDate:x,maxDate:f,onChange:E,closeOnSelect:h,placeholder:y="Date",...b})=>{const[D,P]=(0,g.useState)(!1),C=(0,d.of)(m),M=[(0,l.UU)({crossAxis:!1,boundary:document.body}),(0,l.BN)()],{context:I,refs:R,floatingStyles:T}=(0,r.we)({open:D,placement:"bottom-start",onOpenChange:P,middleware:M,whileElementsMounted:i.ll,strategy:"fixed"}),S=(0,r.kp)(I),L=(0,r.s9)(I),{getReferenceProps:O,getFloatingProps:j}=(0,r.bv)([L,S]);return(0,n.jsxs)("div",{className:C.container,children:[(0,n.jsx)(c.p,{ref:R.setReference,type:"text",autoComplete:"off",placeholder:y,value:v&&p(v),onChange:N=>{N.target.value===""&&E("")},className:C.input,...b,...O()}),(0,n.jsx)("div",{className:C.popover,ref:R.setFloating,style:T,...j(),children:(0,n.jsx)(a.l,{isOpen:D,value:v&&typeof v!="string"?v:(0,o.KQ)().toDate(),minDate:x,maxDate:f,onChange:N=>{E(N),h&&P(!1)},onClose:()=>P(!1)})})]})},m=v=>({container:(0,s.css)({position:"relative"}),input:(0,s.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,s.css)({zIndex:v.zIndex.tooltip})})},63383:(k,A,e)=>{"use strict";e.d(A,{K:()=>S});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(18828),o=e(85690),d=e(93225),c=e(96540),a=e(29426),p=e(49045),u=e(72724),m=e(47232),v=e(1933),x=e(13390),f=e(40845),E=e(55852),h=e(14186),y=e(14578),b=e(10354),D=e(67061),P=e(88448),C=e(17464),M=e(66070),I=e(72265),R=e(47619),T=e(99225);const S=({date:N,maxDate:F,minDate:U,label:w,onChange:B,disabledHours:K,disabledMinutes:W,disabledSeconds:z,timeZone:Y,showSeconds:X=!0,clearable:q=!1})=>{const[G,te]=(0,c.useState)(!1),H=(0,c.useRef)(null),{overlayProps:se,underlayProps:ne}=(0,d.e)({onClose:()=>te(!1),isDismissable:!0,isOpen:G,shouldCloseOnInteractOutside:ue=>{const Te=document.getElementsByClassName(M.i)[0];return!(Te&&Te.contains(ue))}},H),{dialogProps:le}=(0,g.s)({},H),_=(0,f.$j)(),{modalBackdrop:Q}=(0,f.of)(P.o),ae=(0,p.A)(`(min-width: ${_.breakpoints.values.lg}px)`),oe=(0,f.of)(j),J=[(0,l.UU)({crossAxis:!1,boundary:document.body}),(0,l.BN)()],{refs:ee,floatingStyles:de}=(0,r.we)({open:G,placement:"bottom-start",onOpenChange:te,middleware:J,whileElementsMounted:i.ll,strategy:"fixed"}),xe=(0,c.useCallback)(ue=>{te(!1),B(ue)},[B]),re=(0,c.useCallback)(ue=>{ue.preventDefault(),te(!0)},[te]);return(0,n.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,n.jsx)(L,{date:N,onChange:B,isFullscreen:ae,onOpen:re,label:w,ref:ee.setReference,showSeconds:X,clearable:q,timeZone:Y}),G?ae?(0,n.jsx)(C.ZL,{children:(0,n.jsx)(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:H,...se,...le,children:(0,n.jsx)(O,{date:N,onChange:xe,isFullscreen:!0,onClose:()=>te(!1),maxDate:F,minDate:U,ref:ee.setFloating,style:de,showSeconds:X,disabledHours:K,disabledMinutes:W,disabledSeconds:z,timeZone:Y})})})}):(0,n.jsxs)(C.ZL,{children:[(0,n.jsx)("div",{className:Q,...ne}),(0,n.jsx)(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:H,...se,...le,children:(0,n.jsx)("div",{className:oe.modal,children:(0,n.jsx)(O,{date:N,maxDate:F,minDate:U,onChange:xe,isFullscreen:!1,onClose:()=>te(!1),showSeconds:X,disabledHours:K,disabledMinutes:W,disabledSeconds:z,timeZone:Y})})})})]}):null]})},L=c.forwardRef(({date:N,label:F,onChange:U,onOpen:w,timeZone:B,showSeconds:K=!0,clearable:W=!1},z)=>{const Y=(0,f.of)(j),X=K?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[q,G]=(0,c.useState)(()=>({value:N?(0,u.LE)(N,{timeZone:B}):W?"":(0,u.LE)((0,m.KQ)(),{timeZone:B}),invalid:!1}));(0,c.useEffect)(()=>{if(N){const le=(0,u.LE)(N,{format:X,timeZone:B});G({invalid:!(0,R.f)(le),value:(0,m.Ar)(N)?le:N})}},[N,X,B]);const te=(0,c.useCallback)(le=>{const _=!(0,R.f)(le.currentTarget.value);G({value:le.currentTarget.value,invalid:_})},[]),H=(0,c.useCallback)(()=>{if(!q.invalid&&q.value){const le=(0,m.oZ)((0,v.O)({timeZone:B}),q.value);U(le)}},[q,U,B]),se=(0,c.useCallback)(()=>{G({value:"",invalid:!1}),U()},[U]),ne=(0,n.jsx)(E.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:w});return(0,n.jsx)(h.I,{label:F,invalid:!!(q.value&&q.invalid),className:Y.field,children:(0,n.jsx)(b.p,{onChange:te,addonAfter:ne,value:q.value,onBlur:H,"data-testid":x.X.DateTimePicker.input,placeholder:"Select date/time",ref:z,suffix:W&&q.value&&(0,n.jsx)(y.I,{name:"times",className:Y.clearIcon,onClick:se})})})});L.displayName="DateTimeInput";const O=c.forwardRef(({date:N,onClose:F,onChange:U,isFullscreen:w,maxDate:B,minDate:K,style:W,showSeconds:z=!0,disabledHours:Y,disabledMinutes:X,disabledSeconds:q,timeZone:G},te)=>{const H=(0,f.of)(I.h2),se=(0,f.of)(j),[ne,le]=(0,c.useState)(()=>N&&N.isValid()?(0,m.oZ)((0,v.O)({timeZone:G}),N):(0,m.oZ)((0,v.O)({timeZone:G}),new Date)),[_,Q]=(0,c.useState)(()=>N&&N.isValid()?(0,T.Q)(N.toDate(),(0,v.O)({timeZone:G})):(0,T.Q)(new Date,(0,v.O)({timeZone:G}))),ae=(0,c.useCallback)(ee=>{ee&&!Array.isArray(ee)&&Q(ee)},[]),oe=(0,c.useCallback)(ee=>{le(ee)},[]),J=()=>{const ee=(0,m.KQ)(ne);ee.set("date",_.getDate()),ee.set("month",_.getMonth()),ee.set("year",_.getFullYear()),U(ee)};return(0,n.jsxs)("div",{className:(0,s.cx)(se.container,{[se.fullScreen]:w}),style:W,ref:te,children:[(0,n.jsx)(a.Ay,{next2Label:null,prev2Label:null,value:_,nextLabel:(0,n.jsx)(y.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:(0,n.jsx)(y.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:ae,locale:"en",className:H.body,tileClassName:H.title,maxDate:B,minDate:K}),(0,n.jsx)("div",{className:se.time,children:(0,n.jsx)(M.R,{showSeconds:z,onChange:oe,value:ne,disabledHours:Y,disabledMinutes:X,disabledSeconds:q})}),(0,n.jsxs)(D.B,{children:[(0,n.jsx)(E.$n,{type:"button",onClick:J,children:"Apply"}),(0,n.jsx)(E.$n,{variant:"secondary",type:"button",onClick:F,children:"Cancel"})]})]})});O.displayName="DateTimeCalendar";const j=N=>({container:(0,s.css)({padding:N.spacing(1),border:`1px ${N.colors.border.weak} solid`,borderRadius:N.shape.radius.default,backgroundColor:N.colors.background.primary,zIndex:N.zIndex.modal}),fullScreen:(0,s.css)({position:"absolute"}),time:(0,s.css)({marginBottom:N.spacing(2)}),modal:(0,s.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:N.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,s.css)({cursor:"pointer"}),field:(0,s.css)({marginBottom:0,width:"100%"})})},5308:(k,A,e)=>{"use strict";e.d(A,{N:()=>j});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(18828),o=e(85690),d=e(93225),c=e(96540),a=e(40845),p=e(76412),u=e(55852),m=e(40276),v=e(88575),x=e(14578),f=e(10354),E=e(56034),h=e(42617),y=e(11752),b=e(32432);const D=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,P=B=>({from:R(B.from),to:R(B.to)}),C=B=>{const K=S(B.from),W=S(B.to);return{from:K,to:W,display:`${K} to ${W}`}},M=(B,K=Date.now())=>I(B)?R(B)>Math.ceil(K/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},I=B=>D.test(B),R=B=>{const K=D.exec(B);if(!K||K.length!==4)return 0;const[,W,z,Y]=K,X=parseInt(z,10);if(isNaN(X))return 0;const q=X*T[Y];return W==="+"?q*-1:q},T={w:604800,d:86400,h:3600,m:60,s:1},S=B=>{if(B===0)return"now";const K=Math.abs(B);return B<0?`now+${L(K)}`:`now-${L(K)}`};function L(B){const K=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:z,value:Y}of K)if(B%Y===0)return`${B/Y}${z}`;const W=K[K.length-1];return`${B}${W.unit}`}const O=b.o.filter(B=>I(B.from));function j(B){const{timeRange:K,onChange:W}=B,[z,Y]=(0,c.useState)(!1),X=(0,c.useCallback)(()=>Y(!1),[]),q=C(K),[G,te]=(0,c.useState)({value:q.from,validation:M(q.from)}),[H,se]=(0,c.useState)({value:q.to,validation:M(q.to)}),ne=(0,c.useRef)(null),{overlayProps:le,underlayProps:_}=(0,d.e)({onClose:()=>Y(!1),isDismissable:!0,isOpen:z},ne),{dialogProps:Q}=(0,g.s)({},ne),ae=[(0,l.UU)({crossAxis:!1,boundary:document.body}),(0,l.BN)()],{context:oe,refs:J,floatingStyles:ee}=(0,r.we)({open:z,placement:"bottom-start",onOpenChange:Y,middleware:ae,whileElementsMounted:i.ll,strategy:"fixed"}),de=(0,r.kp)(oe),xe=(0,r.s9)(oe),{getReferenceProps:re,getFloatingProps:ue}=(0,r.bv)([xe,de]),Te=(0,a.of)(U(G.validation.errorMessage,H.validation.errorMessage)),ge=Xe=>{const we=P(Xe);we&&(X(),te({...G,value:Xe.from}),se({...H,value:Xe.to}),W(we))},Oe=(0,c.useCallback)(Xe=>{Xe.stopPropagation(),Xe.preventDefault(),Y(!z)},[z]),Ue=Xe=>{if(Xe.preventDefault(),!H.validation.isValid||!G.validation.isValid)return;const we=P({from:G.value,to:H.value,display:""});we&&(W(we),Y(!1))};return(0,n.jsxs)("div",{className:Te.container,children:[(0,n.jsxs)("button",{ref:J.setReference,className:Te.pickerInput,type:"button",onClick:Oe,...re(),children:[(0,n.jsx)("span",{className:Te.clockIcon,children:(0,n.jsx)(x.I,{name:"clock-nine"})}),(0,n.jsxs)("span",{children:[q.from," to ",q.to]}),(0,n.jsx)("span",{className:Te.caretIcon,children:(0,n.jsx)(x.I,{name:z?"angle-up":"angle-down",size:"lg"})})]}),z&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{role:"presentation",className:Te.backdrop,..._}),(0,n.jsx)(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:ne,...le,...Q,children:(0,n.jsx)("div",{className:Te.content,ref:J.setFloating,style:ee,...ue(),children:(0,n.jsxs)("div",{className:Te.body,children:[(0,n.jsx)(m.A,{className:Te.leftSide,hideHorizontalTrack:!0,children:(0,n.jsx)(y.l,{title:(0,p.t)("time-picker.time-range.example-title","Example time ranges"),options:O,onChange:ge,value:q})}),(0,n.jsxs)("div",{className:Te.rightSide,children:[(0,n.jsx)("div",{className:Te.title,children:(0,n.jsx)(h.e,{children:(0,n.jsx)(E.m,{content:(0,n.jsx)(N,{}),placement:"bottom",theme:"info",children:(0,n.jsx)("div",{children:(0,n.jsxs)(p.x,{i18nKey:"time-picker.time-range.specify",children:["Specify time range ",(0,n.jsx)(x.I,{name:"info-circle"})]})})})})}),(0,n.jsx)(v.D,{label:"From",invalid:!G.validation.isValid,error:G.validation.errorMessage,children:(0,n.jsx)(f.p,{onClick:Xe=>Xe.stopPropagation(),onBlur:()=>te({...G,validation:M(G.value)}),onChange:Xe=>te({...G,value:Xe.currentTarget.value}),value:G.value})}),(0,n.jsx)(v.D,{label:"To",invalid:!H.validation.isValid,error:H.validation.errorMessage,children:(0,n.jsx)(f.p,{onClick:Xe=>Xe.stopPropagation(),onBlur:()=>se({...H,validation:M(H.value)}),onChange:Xe=>se({...H,value:Xe.currentTarget.value}),value:H.value})}),(0,n.jsx)(u.$n,{"aria-label":"TimePicker submit button",onClick:Ue,children:"Apply time range"})]})]})})})})]})]})}const N=()=>{const B=(0,a.of)(F);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:B.supported,children:["Supported formats: ",(0,n.jsx)("code",{className:B.tooltip,children:"now-[digit]s/m/h/d/w"})]}),(0,n.jsx)("div",{children:"Example: to select a time range from 10 minutes ago to now"}),(0,n.jsx)("code",{className:B.tooltip,children:"From: now-10m To: now"}),(0,n.jsxs)("div",{className:B.link,children:["For more information see"," ",(0,n.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/",children:["docs ",(0,n.jsx)(x.I,{name:"external-link-alt"})]}),"."]})]})},F=B=>({supported:(0,s.css)({marginBottom:B.spacing(1)}),tooltip:(0,s.css)({margin:0}),link:(0,s.css)({marginTop:B.spacing(1)})}),U=(B,K)=>W=>{const z=(0,f.n)({theme:W,invalid:!1}),X=250+w(W,B)+w(W,K);return{backdrop:(0,s.css)({position:"fixed",zIndex:W.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,s.css)({display:"flex",position:"relative"}),pickerInput:(0,s.cx)(z.input,z.wrapper,(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${W.spacing.gridSize*W.components.height.md-2}px`})),caretIcon:(0,s.cx)(z.suffix,(0,s.css)({position:"relative",marginLeft:W.spacing(.5)})),clockIcon:(0,s.cx)(z.prefix,(0,s.css)({position:"relative",marginRight:W.spacing(.5)})),content:(0,s.css)({background:W.colors.background.primary,boxShadow:W.shadows.z3,position:"absolute",zIndex:W.zIndex.modal,width:"500px",top:"100%",borderRadius:W.shape.radius.default,border:`1px solid ${W.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,s.css)({display:"flex",height:`${X}px`}),description:(0,s.css)({color:W.colors.text.secondary,fontSize:W.typography.size.sm}),leftSide:(0,s.css)({width:"50% !important",borderRight:`1px solid ${W.colors.border.medium}`}),rightSide:(0,s.css)({width:"50%",padding:W.spacing(1)}),title:(0,s.css)({marginBottom:W.spacing(1)})}};function w(B,K){return K?K.length>34?B.spacing.gridSize*6.5:B.spacing.gridSize*4:0}},66070:(k,A,e)=>{"use strict";e.d(A,{R:()=>p,i:()=>a});var n=e(74848),s=e(32196),l=e(79770),r=e(47232),i=e(40845),g=e(16797),o=e(87266),d=e(14578),c=e(78537);const a="time-of-day-picker-panel",p=({minuteStep:v=1,showHour:x=!0,showSeconds:f=!1,onChange:E,value:h,size:y="auto",disabled:b,disabledHours:D,disabledMinutes:P,disabledSeconds:C})=>{const M=(0,i.of)(m);return(0,n.jsx)(l.A,{className:(0,s.cx)((0,o.lH)()[y],M.input),popupClassName:(0,s.cx)(M.picker,a),defaultValue:(0,r.AN)(),onChange:I=>{if((0,r.u8)(I))return E((0,r.KQ)(I))},allowEmpty:!1,showSecond:f,value:(0,r.AN)(h),showHour:x,minuteStep:v,inputIcon:(0,n.jsx)(u,{wrapperStyle:M.caretWrapper}),disabled:b,disabledHours:D,disabledMinutes:P,disabledSeconds:C})},u=({wrapperStyle:v=""})=>(0,n.jsx)("div",{className:v,children:(0,n.jsx)(d.I,{name:"angle-down"})}),m=v=>{const x=v.components.input.background,f=v.v1.palette.black,E=v.colors.background.secondary,h=v.shape.radius.default,y=v.components.input.borderColor;return{caretWrapper:(0,s.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:v.colors.text.secondary}),picker:(0,s.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:x,color:v.colors.text.secondary,borderColor:y,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${v.v1.palette.orange}`,borderRadius:h,color:v.colors.text.primary},"&:hover":{background:E,color:v.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:v.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${f}`,backgroundColor:x,borderColor:y,borderRadius:h,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:x,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,s.css)({".rc-time-picker-input":{backgroundColor:x,borderRadius:h,borderColor:y,color:v.colors.text.primary,height:v.spacing(4),"&:focus":(0,g.getFocusStyles)(v),"&:disabled":{backgroundColor:v.colors.action.disabledBackground,color:v.colors.action.disabledText,border:`1px solid ${v.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(k,A,e)=>{"use strict";e.d(A,{b:()=>f});var n=e(74848),s=e(32196),l=e(96540),r=e(47232),i=e(43127),g=e(13544),o=e(40845),d=e(8866),c=e(14578),a=e(10354),p=e(85068),u=e(3799),m=e(32432),v=e(47619);const x=()=>{},f=({value:h,onChange:y,onChangeTimeZone:b=x,clearable:D,weekStart:P,hideTimeZone:C=!0,timeZone:M="browser",placeholder:I="Select time range",isReversed:R=!0,hideQuickRanges:T=!1,disabled:S=!1,showIcon:L=!1})=>{const[O,j]=(0,l.useState)(!1),N=(0,o.of)(E,S),F=K=>{K.stopPropagation(),K.preventDefault(),!S&&j(!O)},U=()=>{j(!1)},w=K=>{U(),y(K)},B=K=>{K.stopPropagation();const W=(0,r.KQ)(null),z=(0,r.KQ)(null);y({from:W,to:z,raw:{from:W,to:z}})};return(0,n.jsxs)("div",{className:N.container,children:[(0,n.jsxs)("button",{type:"button",className:N.pickerInput,"data-testid":g.Tp.components.TimePicker.openButton,onClick:F,children:[L&&(0,n.jsx)(c.I,{name:"clock-nine",size:"sm",className:N.icon}),(0,n.jsx)(u.f,{value:h,timeZone:M,placeholder:I}),!S&&(0,n.jsxs)("span",{className:N.caretIcon,children:[(0,v.X)(h)&&D&&(0,n.jsx)(c.I,{className:N.clearIcon,name:"times",size:"lg",onClick:B}),(0,n.jsx)(c.I,{name:O?"angle-up":"angle-down",size:"lg"})]})]}),O&&(0,n.jsx)(d.N,{includeButtonPress:!1,onClick:U,children:(0,n.jsx)(p.r,{timeZone:M,value:(0,v.X)(h)?h:(0,i.E2)(),onChange:w,quickOptions:m.o,onChangeTimeZone:b,className:N.content,hideTimeZone:C,isReversed:R,hideQuickRanges:T,weekStart:P})})]})},E=(h,y=!1)=>{const b=(0,a.n)({theme:h,invalid:!1});return{container:(0,s.css)({display:"flex",position:"relative"}),content:(0,s.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:h.zIndex.dropdown}),pickerInput:(0,s.cx)(b.input,y&&b.inputDisabled,b.wrapper,(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${h.spacing.gridSize*4-2}px`})),caretIcon:(0,s.cx)(b.suffix,(0,s.css)({position:"relative",top:"-1px",marginLeft:h.spacing(.5)})),clearIcon:(0,s.css)({marginRight:h.spacing(.5),"&:hover":{color:h.colors.text.maxContrast}}),placeholder:(0,s.css)({color:h.colors.text.disabled,opacity:1}),icon:(0,s.css)({marginRight:h.spacing(.5)})}}},15666:(k,A,e)=>{"use strict";e.d(A,{$6:()=>b,_8:()=>C,xS:()=>P});var n=e(74848),s=e(32196),l=e(18828),r=e(85690),i=e(93225),g=e(96540),o=e(65879),d=e(72724),c=e(91410),a=e(85858),p=e(13544),u=e(40845),m=e(76412),v=e(19727),x=e(88448),f=e(27746),E=e(56034),h=e(85068),y=e(32432);function b(T){const[S,L]=(0,g.useState)(!1),{value:O,onMoveBackward:j,onMoveForward:N,onZoom:F,onError:U,timeZone:w,fiscalYearStartMonth:B,timeSyncButton:K,isSynced:W,history:z,onChangeTimeZone:Y,onChangeFiscalYearStartMonth:X,hideQuickRanges:q,widthOverride:G,isOnCanvas:te,onToolbarTimePickerClick:H,weekStart:se}=T,ne=Ue=>{T.onChange(Ue),L(!1)};(0,g.useEffect)(()=>{S&&H&&H()},[S,H]);const le=()=>{L(Ue=>!Ue)},_=()=>{L(!1)},Q=(0,g.createRef)(),ae=(0,g.createRef)(),{overlayProps:oe,underlayProps:J}=(0,i.e)({onClose:_,isDismissable:!0,isOpen:S,shouldCloseOnInteractOutside:Ue=>!ae.current?.contains(Ue)},Q),{dialogProps:ee}=(0,l.s)({},Q),de=(0,u.of)(I),{modalBackdrop:xe}=(0,u.of)(x.o),re=!o.isRelativeTime(O.raw.from)||!o.isRelativeTime(O.raw.to),ue=W?"active":te?"canvas":"default",ge=O?.to?.isBefore(O.from)?"exclamation-triangle":"clock-nine",Oe=M(O,w);return(0,n.jsxs)(v.e,{className:de.container,children:[re&&(0,n.jsx)(f.I,{"aria-label":(0,m.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:ue,onClick:j,icon:"angle-left",narrow:!0}),(0,n.jsx)(E.m,{ref:ae,content:(0,n.jsx)(P,{timeRange:O,timeZone:w}),placement:"bottom",interactive:!0,children:(0,n.jsx)(f.I,{"data-testid":p.Tp.components.TimePicker.openButton,"aria-label":(0,m.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:Oe}),"aria-controls":"TimePickerContent",onClick:le,icon:ge,isOpen:S,variant:ue,children:(0,n.jsx)(C,{...T})})}),S&&(0,n.jsxs)("div",{"data-testid":p.Tp.components.TimePicker.overlayContent,children:[(0,n.jsx)("div",{role:"presentation",className:(0,s.cx)(xe,de.backdrop),...J}),(0,n.jsx)(r.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{className:de.content,ref:Q,...oe,...ee,children:(0,n.jsx)(h.r,{timeZone:w,fiscalYearStartMonth:B,value:O,onChange:ne,quickOptions:y.o,history:z,showHistory:!0,widthOverride:G,onChangeTimeZone:Y,onChangeFiscalYearStartMonth:X,hideQuickRanges:q,onError:U,weekStart:se})})})]}),K,re&&(0,n.jsx)(f.I,{"aria-label":(0,m.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:N,icon:"angle-right",narrow:!0,variant:ue}),(0,n.jsx)(E.m,{content:D,placement:"bottom",children:(0,n.jsx)(f.I,{"aria-label":(0,m.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:F,icon:"search-minus",variant:ue})})]})}b.displayName="TimeRangePicker";const D=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(m.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,n.jsx)("br",{})," CTRL+Z"]})}),P=({timeRange:T,timeZone:S})=>{const L=(0,u.of)(R);return(0,n.jsxs)(n.Fragment,{children:[(0,d.LE)(T.from,{timeZone:S}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(m.x,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,d.LE)(T.to,{timeZone:S}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("span",{className:L.utc,children:(0,c.le)(S)})})]})},C=(0,g.memo)(({hideText:T,value:S,timeZone:L})=>{const O=(0,u.of)(R);return T?null:(0,n.jsxs)("span",{className:O.container,"aria-live":"polite","aria-atomic":"true",children:[(0,n.jsx)("span",{children:M(S,L)}),(0,n.jsx)("span",{className:O.utc,children:o.describeTimeRangeAbbreviation(S,L)})]})});C.displayName="TimePickerButtonLabel";const M=(T,S)=>{const L={to:a.isMathString(T.raw.to)?T.raw.to:T.to,from:a.isMathString(T.raw.from)?T.raw.from:T.from};return o.describeTimeRange(L,S)},I=T=>({container:(0,s.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,s.css)({display:"none",[T.breakpoints.down("sm")]:{display:"block"}}),content:(0,s.css)({position:"absolute",right:0,top:"116%",zIndex:T.zIndex.dropdown,[T.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:T.zIndex.modal}})}),R=T=>({container:(0,s.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,s.css)({color:T.v1.palette.orange,fontSize:T.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:T.typography.fontWeightMedium})})},72265:(k,A,e)=>{"use strict";e.d(A,{h2:()=>x,nB:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(29426),i=e(53531),g=e(40845),o=e(76412),d=e(14578),c=e(99225);const a={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function p({onChange:f,from:E,to:h,timeZone:y,weekStart:b="monday"}){const D=u(E,h,new Date,y),P=m(f,y),C=(0,g.of)(x);return(0,n.jsx)(r.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:C.body,tileClassName:C.title,value:D,nextLabel:(0,n.jsx)(d.I,{name:"angle-right"}),nextAriaLabel:(0,o.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,n.jsx)(d.I,{name:"angle-left"}),prevAriaLabel:(0,o.t)("time-picker.calendar.previous-month","Previous month"),onChange:P,locale:"en",calendarType:a[b]})}p.displayName="Body";function u(f,E,h=new Date,y){let b=f.isValid()?f.toDate():h,D=E.isValid()?E.toDate():h;return y&&(b=(0,c.Q)(b,y),D=(0,c.Q)(D,y)),b>D?[D,b]:[b,D]}function m(f,E){return(0,l.useCallback)(h=>{if(!Array.isArray(h))return console.error("onCalendarChange: should be run in selectRange={true}");if(h[0]&&h[1]){const y=(0,i.b)(v(h[0]),{timeZone:E}),b=(0,i.b)(v(h[1]),{timeZone:E});f(y,b)}},[f,E])}function v(f){return[f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds()]}const x=f=>{const E=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,s.css)({color:f.colors.text.primary,backgroundColor:f.colors.background.primary,fontSize:f.typography.size.md,border:"1px solid transparent","&:hover":{position:"relative"},"&:disabled":{color:f.colors.action.disabledText}}),body:(0,s.css)({zIndex:f.zIndex.modal,backgroundColor:f.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:f.colors.text.primary,border:0,fontWeight:f.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:f.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${E}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:f.colors.primary.contrastText,fontWeight:f.typography.fontWeightMedium,background:f.colors.primary.main,boxShadow:"none",border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:f.colors.primary.contrastText,fontWeight:f.typography.fontWeightMedium,background:f.colors.primary.main,abbr:{backgroundColor:f.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${E}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${E}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(k,A,e)=>{"use strict";e.d(A,{r:()=>xe});var n=e(74848),s=e(32196),l=e(96540),r=e(47232),i=e(65879),g=e(13544),o=e(40845),d=e(16797),c=e(76412),a=e(67647),p=e(14578),u=e(2543),m=e(91410),v=e(55852),x=e(88575),f=e(90182),E=e(63021),h=e(40675),y=e(40980),b=e(20333),D=e(79451),P=e(17624),C=e(67459),M=e(32432);const I=We=>{const{timeZone:Ce,fiscalYearStartMonth:je,timestamp:Ke=Date.now(),onChangeTimeZone:_e,onChangeFiscalYearStartMonth:Fe}=We,[at,Ct]=(0,l.useState)(!1),[Dt,tt]=(0,l.useState)("tz"),ze=(0,l.useId)(),pe=(0,l.useId)(),Se=(0,l.useId)(),fe=(0,l.useCallback)(he=>{he&&he.stopPropagation(),Ct(!at)},[at,Ct]),Ee=(0,o.of)(R);if(!(0,u.isString)(Ce))return null;const Pe=(0,m.QZ)(Ce,Ke);return Pe?(0,n.jsxs)("div",{children:[(0,n.jsxs)("section",{"aria-label":(0,c.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:Ee.container,children:[(0,n.jsxs)("div",{className:Ee.timeZoneContainer,children:[(0,n.jsxs)("div",{className:Ee.timeZone,children:[(0,n.jsx)(C.U,{title:Pe.name}),(0,n.jsx)("div",{className:Ee.spacer}),(0,n.jsx)(D.E,{info:Pe})]}),(0,n.jsx)(P.X,{timeZone:Ce,timestamp:Ke})]}),(0,n.jsx)("div",{className:Ee.spacer}),(0,n.jsx)(v.$n,{"data-testid":g.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:fe,size:"sm","aria-expanded":at,"aria-controls":ze,icon:at?"angle-up":"angle-down",children:(0,n.jsx)(c.x,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),at?(0,n.jsxs)("div",{className:Ee.editContainer,id:ze,children:[(0,n.jsxs)(E.U,{children:[(0,n.jsx)(h.o,{label:(0,c.t)("time-picker.footer.time-zone-option","Time zone"),active:Dt==="tz",onChangeTab:()=>{tt("tz")},"aria-controls":pe}),(0,n.jsx)(h.o,{label:(0,c.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:Dt==="fy",onChangeTab:()=>{tt("fy")},"aria-controls":Se})]}),(0,n.jsx)(y.J,{children:Dt==="tz"?(0,n.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:pe,className:(0,s.cx)(Ee.timeZoneContainer,Ee.timeSettingContainer),children:(0,n.jsx)(b.U,{includeInternal:!0,onChange:he=>{fe(),(0,u.isString)(he)&&_e(he)},onBlur:fe,menuShouldPortal:!1})}):(0,n.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:Se,className:(0,s.cx)(Ee.timeZoneContainer,Ee.timeSettingContainer),children:(0,n.jsx)(x.D,{className:Ee.fiscalYearField,label:(0,c.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,n.jsx)(f.l6,{value:je,menuShouldPortal:!1,options:M.Z,onChange:he=>{Fe&&Fe(he.value??0)}})})})})]}):null]}):null},R=We=>({container:(0,s.css)({borderTop:`1px solid ${We.colors.border.weak}`,padding:We.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,s.css)({borderTop:`1px solid ${We.colors.border.weak}`,padding:We.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,s.css)({marginLeft:"7px"}),timeSettingContainer:(0,s.css)({paddingTop:We.spacing(1)}),fiscalYearField:(0,s.css)({marginBottom:0}),timeZoneContainer:(0,s.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var T=e(42617),S=e(53531),L=e(72724),O=e(10354),j=e(56034),N=e(47619),F=e(18828),U=e(85690),w=e(93225),B=e(59875),K=e(88448),W=e(72265),z=e(67061);function Y({onClose:We,onApply:Ce}){return(0,n.jsxs)(z.B,{gap:2,justifyContent:"space-between",children:[(0,n.jsx)(v.$n,{variant:"secondary",onClick:We,children:(0,n.jsx)(c.x,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,n.jsx)(v.$n,{onClick:Ce,children:(0,n.jsx)(c.x,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}Y.displayName="Footer";var X=e(29158);function q({onClose:We}){return(0,n.jsxs)(z.B,{justifyContent:"space-between",children:[(0,n.jsx)(T.e,{children:(0,n.jsx)(c.x,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,n.jsx)(X.K,{"data-testid":g.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,c.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:We})]})}q.displayName="Header";const G=(We,Ce=!1)=>({container:(0,s.css)({top:0,position:"absolute",[`${Ce?"left":"right"}`]:"546px"}),modalContainer:(0,s.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,s.css)({display:"flex",flexDirection:"column",gap:We.spacing(1),padding:We.spacing(1),label:"calendar",boxShadow:We.shadows.z3,backgroundColor:We.colors.background.primary,border:`1px solid ${We.colors.border.weak}`,borderRadius:We.shape.radius.default}),modal:(0,s.css)({label:"modal",boxShadow:We.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:We.zIndex.modal})});function te(We){const Ce=(0,o.$j)(),{modalBackdrop:je}=(0,o.of)(K.o),Ke=G(Ce,We.isReversed),{isOpen:_e,isFullscreen:Fe,onClose:at}=We,Ct=(0,l.createRef)(),{dialogProps:Dt}=(0,F.s)({"aria-label":g.Tp.components.TimePicker.calendar.label},Ct),{overlayProps:tt}=(0,w.e)({isDismissable:!0,isOpen:_e,onClose:at},Ct),ze=!Fe;if(!_e)return null;const pe=(0,n.jsxs)("section",{className:Ke.calendar,ref:Ct,...tt,...Dt,"data-testid":g.Tp.components.TimePicker.calendar.label,children:[(0,n.jsx)(q,{...We}),(0,n.jsx)(W.nB,{...We}),ze&&(0,n.jsx)(Y,{...We})]});return ze?(0,n.jsxs)(B.Sf,{children:[(0,n.jsx)("div",{className:je}),(0,n.jsx)(U.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{className:Ke.modal,children:(0,n.jsx)("div",{className:Ke.modalContainer,children:pe})})})]}):(0,n.jsx)(U.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,n.jsx)("div",{className:Ke.container,children:pe})})}const H=(0,l.memo)(te);te.displayName="TimePickerCalendar";const se={default:()=>(0,c.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,c.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},ne=We=>{const{value:Ce,isFullscreen:je=!1,timeZone:Ke,onApply:_e,isReversed:Fe,fiscalYearStartMonth:at,onError:Ct,weekStart:Dt}=We,[tt,ze]=_(Ce.raw.from,Ce.raw.to,Ke),pe=(0,o.of)(ae),[Se,fe]=(0,l.useState)(tt),[Ee,Pe]=(0,l.useState)(ze),[he,be]=(0,l.useState)(!1),Ae=(0,l.useId)(),De=(0,l.useId)();(0,l.useEffect)(()=>{const[qt,bn]=_(Ce.raw.from,Ce.raw.to,Ke);fe(qt),Pe(bn)},[Ce.raw.from,Ce.raw.to,Ke]);const Ie=(0,l.useCallback)(qt=>{qt.preventDefault(),be(!0)},[be]),ke=(0,l.useCallback)(()=>{if(Ee.invalid||Se.invalid)return;const qt={from:Se.value,to:Ee.value},bn=i.convertRawToRange(qt,Ke,at);_e(bn)},[Se.invalid,Se.value,_e,Ke,Ee.invalid,Ee.value,at]),dt=(0,l.useCallback)((qt,bn)=>{const[Mt,Jt]=_(qt,bn,Ke);fe(Mt),Pe(Jt)},[Ke]),Pt=qt=>{qt.key==="Enter"&&ke()},pt=()=>{const qt={from:Se.value,to:Ee.value};navigator.clipboard.writeText(JSON.stringify(qt))},Tt=async()=>{const qt=await navigator.clipboard.readText();let bn;try{bn=JSON.parse(qt)}catch{Ct&&Ct(qt);return}const[Mt,Jt]=_(bn.from,bn.to,Ke);fe(Mt),Pe(Jt)},jt=i.convertRawToRange({from:"now/fy",to:"now/fy"},Ke,at),$t=(0,c.t)("time-picker.range-content.fiscal-year","Fiscal year"),sn=(0,n.jsx)("div",{className:pe.tooltip,children:i.isFiscal(Ce)?(0,n.jsx)(j.m,{content:`${$t}: ${jt.from.format("MMM-DD")} - ${jt.to.format("MMM-DD")}`,children:(0,n.jsx)(p.I,{name:"info-circle"})}):null}),Yt=(0,n.jsx)(v.$n,{"aria-label":(0,c.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":g.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:Ie});return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:pe.fieldContainer,children:[(0,n.jsx)(x.D,{label:(0,c.t)("time-picker.range-content.from-input","From"),invalid:Se.invalid,error:Se.errorMessage,children:(0,n.jsx)(O.p,{id:Ae,onClick:qt=>qt.stopPropagation(),onChange:qt=>dt(qt.currentTarget.value,Ee.value),addonAfter:Yt,onKeyDown:Pt,"data-testid":g.Tp.components.TimePicker.fromField,value:Se.value})}),sn]}),(0,n.jsxs)("div",{className:pe.fieldContainer,children:[(0,n.jsx)(x.D,{label:(0,c.t)("time-picker.range-content.to-input","To"),invalid:Ee.invalid,error:Ee.errorMessage,children:(0,n.jsx)(O.p,{id:De,onClick:qt=>qt.stopPropagation(),onChange:qt=>dt(Se.value,qt.currentTarget.value),addonAfter:Yt,onKeyDown:Pt,"data-testid":g.Tp.components.TimePicker.toField,value:Ee.value})}),sn]}),(0,n.jsxs)("div",{className:pe.buttonsContainer,children:[(0,n.jsx)(v.$n,{"data-testid":g.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,c.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:pt}),(0,n.jsx)(v.$n,{"data-testid":g.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,c.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:Tt}),(0,n.jsx)(v.$n,{"data-testid":g.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:ke,children:(0,n.jsx)(c.x,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,n.jsx)(H,{isFullscreen:je,isOpen:he,from:(0,S.b)(Se.value,{timeZone:Ke}),to:(0,S.b)(Ee.value,{timeZone:Ke}),onApply:ke,onClose:()=>be(!1),onChange:dt,timeZone:Ke,isReversed:Fe,weekStart:Dt})]})};function le(We,Ce,je){const Ke={from:We,to:Ce},_e=i.convertRawToRange(Ke,je);return!(_e.from.isSame(_e.to)||_e.from.isBefore(_e.to))}function _(We,Ce,je){const Ke=Q(We,je),_e=Q(Ce,je),Fe=!(0,N.f)(Ke,!1,je),at=!(0,N.f)(_e,!0,je),Ct=le(Ke,_e,je)&&!at;return[{value:Ke,invalid:Fe||Ct,errorMessage:Ct&&!Fe?se.range():se.default()},{value:_e,invalid:at,errorMessage:se.default()}]}function Q(We,Ce){return(0,r.Ar)(We)?(0,L.LE)(We,{timeZone:Ce}):We}function ae(We){return{fieldContainer:(0,s.css)({display:"flex"}),buttonsContainer:(0,s.css)({display:"flex",gap:We.spacing(.5),marginTop:We.spacing(1)}),tooltip:(0,s.css)({paddingLeft:We.spacing(1),paddingTop:We.spacing(3)})}}var oe=e(11752);const J=(We,Ce)=>i.convertRawToRange({from:We.from,to:We.to},Ce),ee=(We,Ce)=>{const je=(0,L.LE)(We.from,{timeZone:Ce}),Ke=(0,L.LE)(We.to,{timeZone:Ce});return{from:je,to:Ke,display:`${je} to ${Ke}`}},de=We=>{const{quickOptions:Ce=[],isReversed:je,isFullscreen:Ke,hideQuickRanges:_e,timeZone:Fe,fiscalYearStartMonth:at,value:Ct,onChange:Dt,history:tt,showHistory:ze,className:pe,hideTimeZone:Se,onChangeTimeZone:fe,onChangeFiscalYearStartMonth:Ee}=We,Pe=!tt?.length,he=Ke&&ze||!Ke&&(ze&&!Pe||!_e),be=(0,o.of)(Ue,je,_e,he,Ke),Ae=ge(tt,Fe),De=Oe(Ct.raw,Ce),[Ie,ke]=(0,l.useState)(""),dt=Ce.filter(pt=>pt.display.toLowerCase().includes(Ie.toLowerCase())),Pt=pt=>Dt(J(pt));return(0,n.jsxs)("div",{id:"TimePickerContent",className:(0,s.cx)(be.container,pe),children:[(0,n.jsxs)("div",{className:be.body,children:[(!Ke||!_e)&&(0,n.jsxs)("div",{className:be.rightSide,children:[(0,n.jsx)("div",{className:be.timeRangeFilter,children:(0,n.jsx)(a.Z,{width:0,value:Ie,onChange:ke,placeholder:(0,c.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,n.jsxs)("div",{className:be.scrollContent,children:[!Ke&&(0,n.jsx)(re,{...We,historyOptions:Ae}),!_e&&(0,n.jsx)(oe.l,{options:dt,onChange:Pt,value:De})]})]}),Ke&&(0,n.jsx)("div",{className:be.leftSide,children:(0,n.jsx)(ue,{...We,historyOptions:Ae})})]}),!Se&&Ke&&(0,n.jsx)(I,{timeZone:Fe,fiscalYearStartMonth:at,onChangeTimeZone:fe,onChangeFiscalYearStartMonth:Ee})]})},xe=We=>{const{widthOverride:Ce}=We,je=(0,o.$j)(),Ke=(Ce||window.innerWidth)>=je.breakpoints.values.lg;return(0,n.jsx)(de,{...We,isFullscreen:Ke})},re=We=>{const{value:Ce,hideQuickRanges:je,onChange:Ke,timeZone:_e,historyOptions:Fe=[],showHistory:at,onError:Ct,weekStart:Dt}=We,tt=(0,o.of)(Xe),ze=(0,r.Ar)(Ce.raw.from)||(0,r.Ar)(Ce.raw.to),[pe,Se]=(0,l.useState)(!ze),fe=je?!1:pe,Ee=Pe=>Ke(J(Pe,_e));return(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("div",{className:tt.header,children:(0,n.jsxs)("button",{type:"button",className:tt.expandButton,onClick:()=>{je||Se(!fe)},"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!fe,"aria-controls":"expanded-timerange",children:[(0,n.jsx)(T.e,{children:(0,n.jsx)(c.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!je&&(0,n.jsx)(p.I,{name:fe?"angle-down":"angle-up"})]})}),!fe&&(0,n.jsxs)("div",{className:tt.body,id:"expanded-timerange",children:[(0,n.jsx)("div",{className:tt.form,children:(0,n.jsx)(ne,{value:Ce,onApply:Ke,timeZone:_e,isFullscreen:!1,onError:Ct,weekStart:Dt})}),at&&(0,n.jsx)(oe.l,{title:(0,c.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Fe,onChange:Ee,placeholderEmpty:null})]})]})},ue=We=>{const{onChange:Ce,value:je,timeZone:Ke,fiscalYearStartMonth:_e,isReversed:Fe,historyOptions:at,onError:Ct,weekStart:Dt}=We,tt=(0,o.of)(we,We.hideQuickRanges),ze=pe=>Ce(J(pe,Ke));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:tt.container,children:[(0,n.jsx)("div",{className:tt.title,"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,n.jsx)(T.e,{children:(0,n.jsx)(c.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,n.jsx)(ne,{value:je,timeZone:Ke,fiscalYearStartMonth:_e,onApply:Ce,isFullscreen:!0,isReversed:Fe,onError:Ct,weekStart:Dt})]}),We.showHistory&&(0,n.jsx)("div",{className:tt.recent,children:(0,n.jsx)(oe.l,{title:(0,c.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:at||[],onChange:ze,placeholderEmpty:(0,n.jsx)(Te,{})})})]})},Te=(0,l.memo)(()=>{const We=(0,o.of)(qe),Ce=(0,c.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,n.jsxs)("div",{className:We.container,children:[(0,n.jsx)("div",{children:(0,n.jsx)("span",{children:Ce})}),(0,n.jsx)(c.x,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("a",{className:We.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,n.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function ge(We,Ce){return!Array.isArray(We)||We.length===0?[]:We.map(je=>ee(je,Ce))}Te.displayName="EmptyRecentList";const Oe=(We,Ce)=>(0,l.useMemo)(()=>{if(i.isRelativeTimeRange(We))return Ce.find(je=>je.from===We.from&&je.to===We.to)},[We,Ce]),Ue=(We,Ce,je,Ke,_e)=>({container:(0,s.css)({background:We.colors.background.primary,boxShadow:We.shadows.z3,width:`${_e?"546px":"262px"}`,borderRadius:We.shape.radius.default,border:`1px solid ${We.colors.border.weak}`,[`${Ce?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,s.css)({display:"flex",flexDirection:"row-reverse",height:`${Ke?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,s.css)({display:"flex",flexDirection:"column",borderRight:`${Ce?"none":`1px solid ${We.colors.border.weak}`}`,width:`${je?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Ce?1:0}),rightSide:(0,s.css)({width:`${_e?"40%":"100%"}; !important`,borderRight:Ce?`1px solid ${We.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,s.css)({padding:We.spacing(1)}),spacing:(0,s.css)({marginTop:"16px"}),scrollContent:(0,s.css)({overflowY:"auto",scrollbarWidth:"thin"})}),Xe=We=>({header:(0,s.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${We.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,s.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,d.getFocusStyles)(We)}),body:(0,s.css)({borderBottom:`1px solid ${We.colors.border.weak}`}),form:(0,s.css)({padding:"7px 9px 7px 9px"})}),we=(We,Ce)=>({container:(0,s.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Ce?"11px":"20%"}),title:(0,s.css)({marginBottom:"11px"}),recent:(0,s.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:We.spacing(1)})}),qe=We=>({container:(0,s.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,s.css)({color:We.colors.text.link})})},42617:(k,A,e)=>{"use strict";e.d(A,{e:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(40845);const i=o=>({text:(0,s.css)({fontSize:o.typography.size.md,fontWeight:o.typography.fontWeightMedium,color:o.colors.text.primary,margin:0,display:"flex"})}),g=(0,l.memo)(({children:o})=>{const d=(0,r.of)(i);return(0,n.jsx)("h3",{className:d.text,children:o})});g.displayName="TimePickerTitle"},3799:(k,A,e)=>{"use strict";e.d(A,{f:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(15666),g=e(47619);const o=(0,l.memo)(function({hideText:a,value:p,timeZone:u="browser",placeholder:m="No time range selected",className:v}){const x=(0,r.of)(d);return a?null:(0,n.jsx)("span",{className:v,children:(0,g.X)(p)?(0,n.jsx)(i._8,{value:p,timeZone:u}):(0,n.jsx)("span",{className:x.placeholder,children:m})})}),d=c=>({placeholder:(0,s.css)({color:c.colors.text.disabled,opacity:1})})},11752:(k,A,e)=>{"use strict";e.d(A,{l:()=>v});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(76412),g=e(42617),o=e(62938),d=e(16797);const c=b=>({container:(0,s.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,s.css)({background:b.colors.action.selected,fontWeight:b.typography.fontWeightMedium}),radio:(0,s.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,d.getFocusStyles)(b)}),label:(0,s.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:b.colors.action.hover,cursor:"pointer"}})}),a=(0,l.memo)(({value:b,onSelect:D,selected:P=!1,name:C})=>{const M=(0,r.of)(c),I=(0,o.A)();return(0,n.jsxs)("li",{className:(0,s.cx)(M.container,P&&M.selected),children:[(0,n.jsx)("input",{className:M.radio,checked:P,name:C,type:"checkbox","data-role":"item",tabIndex:-1,id:I,onChange:()=>D(b)}),(0,n.jsx)("label",{className:M.label,htmlFor:I,children:b.display})]})});a.displayName="TimeRangeOption";const p=(b,D)=>(b%D+D)%D,u=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],m=({localRef:b,options:D})=>{const[P,C]=(0,l.useState)(0);return(0,l.useEffect)(()=>{const I=b.current?.querySelectorAll('[data-role="item"]')||[],R=Array.from(I).findIndex(S=>S.checked),T=R>=0?R:0;I.forEach((S,L)=>{S.tabIndex=L===T?0:-1}),C(T)},[b,D]),[I=>{const R=b?.current?.querySelectorAll('[data-role="item"]'),T=R?.length??0;u.indexOf(I.key)>-1&&(I.preventDefault(),I.key!=="Tab"&&I.stopPropagation());let S=null;switch(I.key){case"ArrowUp":S=p(P-1,T);break;case"ArrowDown":S=p(P+1,T);break;case"Home":S=0;break;case"End":S=T-1;break;case"Enter":R?.[P]?.click();break;default:break}S!==null&&(C(S),R?.[S]?.focus(),R?.forEach((L,O)=>{L.tabIndex=O===S?0:-1}))}]},v=b=>{const D=(0,r.of)(h),{title:P,options:C,placeholderEmpty:M}=b;return typeof M<"u"&&C.length<=0?(0,n.jsx)(n.Fragment,{children:M}):P?(0,n.jsx)("section",{"aria-label":P,children:(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("div",{className:D.title,children:(0,n.jsx)(g.e,{children:P})}),(0,n.jsx)(x,{...b})]})}):(0,n.jsx)(x,{...b})},x=({options:b,value:D,onChange:P,title:C})=>{const M=(0,r.of)(y),I=(0,l.useRef)(null),[R]=m({localRef:I,options:b});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("ul",{role:"presentation",onKeyDown:R,ref:I,"aria-roledescription":(0,i.t)("time-picker.time-range.aria-role","Time range selection"),children:b.map((T,S)=>(0,n.jsx)(a,{value:T,selected:E(T,D),onSelect:P,name:C??(0,i.t)("time-picker.time-range.default-title","Time ranges")},f(T,S)))}),(0,n.jsx)("div",{className:M.grow})]})};function f(b,D){return`${b.from}-${b.to}-${D}`}function E(b,D){return!D||!b?!1:D.from===b.from&&D.to===b.to}const h=()=>({title:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),y=()=>({grow:(0,s.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(k,A,e)=>{"use strict";e.d(A,{U:()=>b});var n=e(74848),s=e(2543),l=e(96540),r=e(91410),i=e(76412),g=e(90182),o=e(32196),d=e(40845);const c=R=>{const{children:T,label:S}=R,L=(0,d.of)(a);return S?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:L.header,children:(0,n.jsx)("span",{className:L.label,children:S})}),T]}):(0,n.jsx)("div",{children:T})},a=R=>({header:(0,o.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${R.colors.border.weak}`,textTransform:"capitalize"}),label:(0,o.css)({fontSize:R.typography.size.sm,color:R.colors.text.secondary,fontWeight:R.typography.fontWeightMedium})});var p=e(17624),u=e(13544),m=e(14578),v=e(79451),x=e(67459);const f="tz-utc-offset",E=R=>{const{children:T,innerProps:S,innerRef:L,data:O,isSelected:j,isFocused:N}=R,F=(0,d.of)(y),U=Date.now(),w=(0,o.cx)(F.container,N&&F.containerFocused);if(!(0,s.isString)(O.value))return null;const B=(0,r.QZ)(O.value,U);return(0,n.jsx)("div",{className:w,...S,ref:L,"data-testid":u.Tp.components.Select.option,children:(0,n.jsxs)("div",{className:(0,o.cx)(F.leftColumn,F.row),children:[(0,n.jsxs)("div",{className:(0,o.cx)(F.leftColumn,F.wideRow),children:[(0,n.jsx)(x.U,{title:T}),(0,n.jsx)("div",{className:F.spacer}),(0,n.jsx)(v.E,{info:B})]}),(0,n.jsxs)("div",{className:F.rightColumn,children:[(0,n.jsx)(p.X,{timeZone:B?.ianaName||O.value,timestamp:U,className:f}),j&&(0,n.jsx)("span",{children:(0,n.jsx)(m.I,{name:"check"})})]})]})})},h=R=>{const{children:T,innerProps:S,innerRef:L,data:O,isSelected:j,isFocused:N}=R,F=(0,d.of)(y),U=Date.now(),w=(0,o.cx)(F.container,N&&F.containerFocused);if(!(0,s.isString)(O.value))return null;const B=(0,r.QZ)(O.value,U);return(0,n.jsx)("div",{className:w,...S,ref:L,"data-testid":u.Tp.components.Select.option,children:(0,n.jsxs)("div",{className:F.body,children:[(0,n.jsxs)("div",{className:F.row,children:[(0,n.jsx)("div",{className:F.leftColumn,children:(0,n.jsx)(x.U,{title:T})}),(0,n.jsx)("div",{className:F.rightColumn,children:j&&(0,n.jsx)("span",{children:(0,n.jsx)(m.I,{name:"check"})})})]}),(0,n.jsxs)("div",{className:F.row,children:[(0,n.jsx)("div",{className:F.leftColumn,children:(0,n.jsx)(v.E,{info:B})}),(0,n.jsx)("div",{className:F.rightColumn,children:(0,n.jsx)(p.X,{timestamp:U,timeZone:B?.ianaName||O.value,className:f})})]})]})})},y=R=>({container:(0,o.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:R.colors.action.hover}}),containerFocused:(0,o.css)({background:R.colors.action.hover}),body:(0,o.css)({display:"flex",fontWeight:R.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,o.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,o.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,o.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,o.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,o.css)({marginLeft:"6px"})}),b=R=>{const{onChange:T,width:S,autoFocus:L=!1,onBlur:O,value:j,includeInternal:N=!1,disabled:F=!1,inputId:U,menuShouldPortal:w=!0,openMenuOnFocus:B=!0}=R,K=D(N),W=P(K,j),z=M(),Y=S&&S<=45?h:E,X=(0,l.useCallback)(q=>{if(!q||!(0,s.isString)(q.value))return T(j);T(q.value)},[T,j]);return(0,n.jsx)(g.l6,{inputId:U,value:W,placeholder:(0,i.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:L,menuShouldPortal:w,openMenuOnFocus:B,width:S,filterOption:z,options:K,onChange:X,onBlur:O,components:{Option:Y,Group:c},disabled:F,"aria-label":(0,i.t)("time-picker.zone.select-aria-label","Time zone picker")})},D=R=>{const T=Date.now();return(0,r.U3)(R).map(L=>{const O=L.zones.reduce((j,N)=>{const F=(0,r.QZ)(N,T);return F&&j.push({label:F.name,value:F.zone,searchIndex:I(F,T)}),j},[]);return{label:L.name,options:O}})},P=(R,T)=>(0,l.useMemo)(()=>{if(T===void 0)return;const S=(0,s.toLower)(T);return R.find(O=>O.label?S.startsWith((0,s.toLower)(O.label)):C(S))?.options.find(O=>(0,s.isEmpty)(S)?O.value===r.g$.default:(0,s.toLower)(O.value)===S)},[R,T]),C=R=>{switch(R){case r.g$.default:case r.g$.localBrowserTime:case r.g$.utc:return!0;default:return!1}},M=()=>(0,l.useCallback)((R,T)=>!T||!R.data||!R.data.searchIndex?!0:R.data.searchIndex.indexOf((0,s.toLower)(T))>-1,[]),I=(R,T)=>{const S=[(0,s.toLower)(R.name),(0,s.toLower)(R.abbreviation),(0,s.toLower)((0,p.t)(T,R.zone))];for(const L of R.countries)S.push((0,s.toLower)(L.name)),S.push((0,s.toLower)(L.code));return S.join("|")}},79451:(k,A,e)=>{"use strict";e.d(A,{E:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(40845);const i=({info:d})=>{const c=(0,r.of)(o),a=g(d);return d?(0,n.jsx)("div",{className:c.description,children:a}):null},g=d=>(0,l.useMemo)(()=>{const c=[];if(!d)return"";if(d.name==="Europe/Simferopol")return"Ukraine, EEST";if(d.countries.length>0){const a=d.countries[0];c.push(a.name)}return d.abbreviation&&c.push(d.abbreviation),c.join(", ")},[d]),o=d=>({description:(0,s.css)({fontWeight:"normal",fontSize:d.typography.size.sm,color:d.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(k,A,e)=>{"use strict";e.d(A,{X:()=>o,t:()=>d});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(72724),g=e(40845);const o=a=>{const{timestamp:p,timeZone:u,className:m}=a,v=(0,g.of)(c);return(0,l.isString)(u)?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{className:(0,s.cx)(v.offset,m),children:d(p,u)})}):null},d=(a,p)=>`UTC${(0,i.LE)(a,{timeZone:p,format:"Z"})}`,c=a=>{const p=(0,s.css)({fontWeight:"normal",fontSize:a.typography.size.sm,color:a.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,s.css)(p,{color:a.colors.text.primary,background:a.colors.background.secondary,padding:"2px 5px",borderRadius:a.shape.radius.default,marginLeft:"4px"})}}},67459:(k,A,e)=>{"use strict";e.d(A,{U:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({title:g})=>{const o=(0,l.of)(i);return g?(0,n.jsx)("span",{className:o.title,children:g}):null},i=g=>({title:(0,s.css)({fontWeight:g.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(k,A,e)=>{"use strict";e.d(A,{l:()=>d,r:()=>o});var n=e(74848),s=e(96540),l=e(13544),r=e(90182);const i=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],g=c=>["saturday","sunday","monday"].includes(c),o=c=>g(c)?c:"monday",d=c=>{const{onChange:a,width:p,autoFocus:u=!1,onBlur:m,value:v,disabled:x=!1,inputId:f}=c,E=(0,s.useCallback)(h=>{h.value!==void 0&&a(h.value)},[a]);return(0,n.jsx)(r.l6,{inputId:f,value:i.find(h=>h.value===v)?.value,placeholder:l.Tp.components.WeekStartPicker.placeholder,autoFocus:u,openMenuOnFocus:!0,width:p,options:i,onChange:E,onBlur:m,disabled:x})}},32432:(k,A,e)=>{"use strict";e.d(A,{Z:()=>s,o:()=>n});const n=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],s=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(k,A,e)=>{"use strict";e.d(A,{X:()=>i,f:()=>r});var n=e(47232),s=e(85858),l=e(53531);function r(g,o,d){return(0,n.Ar)(g)?g.isValid():s.isMathString(g)?s.isValid(g):(0,l.b)(g,{roundUp:o,timeZone:d}).isValid()}function i(g){return s.isValid(g.from)&&s.isValid(g.to)}},99225:(k,A,e)=>{"use strict";e.d(A,{Q:()=>s});var n=e(91410);function s(l,r){const i=(0,n.HD)(r);if(!i)return l;const g=i.utcOffset(l.getTime()),o=l.getTimezoneOffset(),d=g-o;return new Date(l.getTime()-d*1e3*60)}},25994:(k,A,e)=>{"use strict";e.d(A,{c:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({direction:g="horizontal",spacing:o=2})=>{const d=(0,l.of)(i,o);return g==="vertical"?(0,n.jsx)("div",{className:d.verticalDivider}):(0,n.jsx)("hr",{className:d.horizontalDivider})};r.displayName="Divider";const i=(g,o)=>({horizontalDivider:(0,s.css)({borderTop:`1px solid ${g.colors.border.weak}`,margin:g.spacing(o,0),width:"100%"}),verticalDivider:(0,s.css)({borderRight:`1px solid ${g.colors.border.weak}`,margin:g.spacing(0,o),height:"100%"})})},69144:(k,A,e)=>{"use strict";e.d(A,{l:()=>s});var n=e(32196);const s=(l,r)=>{const i=r||"middle",g=l.colors.emphasize(l.colors.background.secondary,.15),o=l.colors.primary.border,d=l.spacing(2),c=4,a=200;let p="50%",u="50%";switch(i){case"start":{p="0%",u="0%";break}case"end":{p="100%",u="100%";break}}const m=(0,n.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:l.transitions.create("border-color"),zIndex:1},"&:after":{background:g,content:'""',position:"absolute",transition:l.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:l.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:o},"&:after":{background:o}}});return{dragHandleVertical:(0,n.cx)(m,(0,n.css)({cursor:"col-resize",width:d,"&:before":{borderRight:"1px solid transparent",height:"100%",left:p,transform:"translateX(-50%)"},"&:after":{left:p,top:"50%",height:a,width:c}})),dragHandleHorizontal:(0,n.cx)(m,(0,n.css)({height:d,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:u,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:u,height:c,width:a}}))}}},87978:(k,A,e)=>{"use strict";e.d(A,{_:()=>E});var n=e(74848),s=e(32196),l=e(18828),r=e(85690),i=e(93225),g=e(50848),o=e(96540),d=e(13544),c=e(40845),a=e(76412),p=e(40276),u=e(69144),m=e(29158),v=e(94753),x=e(24932);const f={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function E({children:C,onClose:M,closeOnMaskClick:I=!0,scrollableContent:R=!0,title:T,subtitle:S,width:L,size:O="md",tabs:j}){const[N,F,U]=h(),w=(0,c.of)(D),B=(0,c.of)(P,O),K=(0,c.of)(u.l),W=o.useRef(null),{dialogProps:z,titleProps:Y}=(0,l.s)({},W),{overlayProps:X}=(0,i.e)({isDismissable:!1,isOpen:!0,onClose:M},W);b();const q=(0,n.jsx)("div",{className:w.content,children:C}),G=N??L??f[O].width,te=f[O].minWidth;return(0,n.jsx)(g.A,{open:!0,onClose:M,placement:"right",getContainer:".main-view",className:w.drawerContent,rootClassName:w.drawer,classNames:{wrapper:B},styles:{wrapper:{width:G,minWidth:te}},width:"",motion:{motionAppear:!0,motionName:w.drawerMotion},maskClassName:w.mask,maskClosable:I,maskMotion:{motionAppear:!0,motionName:w.maskMotion},children:(0,n.jsx)(r.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,n.jsxs)("div",{"aria-label":typeof T=="string"?d.Tp.components.Drawer.General.title(T):d.Tp.components.Drawer.General.title("no title"),className:w.container,...X,...z,ref:W,children:[(0,n.jsx)("div",{className:(0,s.cx)(K.dragHandleVertical,w.resizer),onMouseDown:F,onTouchStart:U}),typeof T=="string"&&(0,n.jsxs)("div",{className:(0,s.cx)(w.header,!!j&&w.headerWithTabs),children:[(0,n.jsx)("div",{className:w.actions,children:(0,n.jsx)(m.K,{name:"times",variant:"secondary",onClick:M,"data-testid":d.Tp.components.Drawer.General.close,tooltip:(0,a.t)("grafana-ui.drawer.close","Close")})}),(0,n.jsxs)("div",{className:w.titleWrapper,children:[(0,n.jsx)(v.E,{element:"h3",...Y,children:T}),S&&(0,n.jsx)("div",{className:w.subtitle,"data-testid":d.Tp.components.Drawer.General.subtitle,children:S}),j&&(0,n.jsx)("div",{className:w.tabsWrapper,children:j})]})]}),typeof T!="string"&&T,R?(0,n.jsx)(p.E,{children:q}):q]})})})}function h(){const[C,M]=(0,o.useState)(void 0),I=(0,o.useCallback)(j=>{M(y(j.clientX))},[]),R=(0,o.useCallback)(j=>{const N=j.touches[0];M(y(N.clientX))},[]),T=(0,o.useCallback)(j=>{document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",T)},[I]),S=(0,o.useCallback)(j=>{document.removeEventListener("touchmove",R),document.removeEventListener("touchend",S)},[R]);function L(j){j.stopPropagation(),j.preventDefault(),document.addEventListener("mousemove",I),document.addEventListener("mouseup",T)}function O(j){j.stopPropagation(),j.preventDefault(),document.addEventListener("touchmove",R),document.addEventListener("touchend",S)}return[C,L,O]}function y(C){let M=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(M/document.body.clientWidth*100,98).toFixed(2)}vw`}function b(){(0,o.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const D=C=>({container:(0,s.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,s.css)({".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0},".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,s.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,s.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,s.css)({backgroundColor:"transparent",position:"fixed","&:before":{backgroundColor:`${C.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,".main-view &":{top:80},".main-view--search-bar-hidden &":{top:40},".main-view--chrome-hidden &":{top:0}}}),maskMotion:(0,s.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,s.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,s.css)({borderBottom:"none"}),actions:(0,s.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,s.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,s.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,s.css)({padding:C.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,s.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,s.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})});function P(C,M){return(0,s.css)({label:`drawer-content-wrapper-${M}`,overflow:"unset !important",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:"0 !important"}})}},9261:(k,A,e)=>{"use strict";e.d(A,{f:()=>m});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(85690),o=e(96540),d=e(40845),c=e(38138),a=e(64539),p=e(27746);const u=x=>{const{className:f,options:E,value:h,onChange:y,narrow:b,variant:D,...P}=x,C=(0,d.of)(v),[M,I]=(0,o.useState)(!1),R=[(0,l.cY)(0),(0,l.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,l.BN)()],{context:T,refs:S,floatingStyles:L}=(0,r.we)({open:M,placement:"bottom-end",onOpenChange:I,middleware:R,whileElementsMounted:i.ll}),O=(0,r.kp)(T),j=(0,r.s9)(T),{getReferenceProps:N,getFloatingProps:F}=(0,r.bv)([j,O]),U=w=>{y(w),I(!1)};return(0,n.jsxs)("div",{className:C.wrapper,children:[(0,n.jsx)(p.I,{className:f,isOpen:M,narrow:b,variant:D,ref:S.setReference,...N(),...P,children:h?.label||(h?.value!=null?String(h?.value):null)}),M&&(0,n.jsx)("div",{className:C.menuWrapper,ref:S.setFloating,...F(),style:L,children:(0,n.jsx)(g.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)(c.W,{tabIndex:-1,onClose:()=>I(!1),children:E.map(w=>(0,n.jsx)(a.D,{label:w.label??String(w.value),onClick:()=>U(w),active:w.value===h?.value,ariaChecked:w.value===h?.value,ariaLabel:w.ariaLabel||w.label,disabled:w.isDisabled,component:w.component,role:"menuitemradio"},`${w.value}`))})})})]})};u.displayName="ButtonSelect";const m=(0,o.memo)(u),v=x=>({wrapper:(0,s.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,s.css)({zIndex:x.zIndex.dropdown})})},83122:(k,A,e)=>{"use strict";e.d(A,{m:()=>u});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(96540),o=e(86634),d=e(40845),c=e(67892),a=e(18976),p=e(17464);const u=g.memo(({children:v,overlay:x,placement:f,offset:E,onVisibleChange:h})=>{const[y,b]=(0,g.useState)(!1),D=(0,g.useRef)(null),P=(0,g.useCallback)(w=>{b(w),h?.(w)},[h]),C=[(0,l.cY)({mainAxis:E?.[0]??8,crossAxis:E?.[1]??0}),(0,l.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,l.BN)()],{context:M,refs:I,floatingStyles:R}=(0,r.we)({open:y,placement:(0,a.O)(f),onOpenChange:P,middleware:C,whileElementsMounted:i.ll}),T=(0,r.kp)(M),S=(0,r.s9)(M),{getReferenceProps:L,getFloatingProps:O}=(0,r.bv)([S,T]),j=150,N=(0,d.of)(m,j),F=()=>{P(!1)},U=w=>{w.key==="Tab"&&P(!1)};return(0,n.jsxs)(n.Fragment,{children:[g.cloneElement(v,{ref:I.setReference,...L()}),y&&(0,n.jsx)(p.ZL,{children:(0,n.jsx)(r.s3,{context:M,children:(0,n.jsx)("div",{ref:I.setFloating,style:R,onClick:F,onKeyDown:U,children:(0,n.jsx)(o.A,{nodeRef:D,appear:!0,in:!0,timeout:{appear:j,exit:0,enter:0},classNames:N,children:(0,n.jsx)("div",{ref:D,children:c.renderOrCallToRender(x,{...O()})})})})})})]})});u.displayName="Dropdown";const m=(v,x)=>({appear:(0,s.css)({opacity:"0",position:"relative",transformOrigin:"top",[v.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,s.css)({opacity:"1",[v.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${x}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${x}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(k,A,e)=>{"use strict";e.d(A,{Z:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g})=>{const o=(0,l.of)(i);return(0,n.jsx)("div",{className:o.container,children:g})},i=g=>({container:(0,s.css)({borderLeft:`3px solid ${g.colors.info.main}`,backgroundColor:`${g.colors.background.secondary}`,padding:g.spacing(2),minWidth:"350px",borderRadius:g.shape.radius.default,marginBottom:g.spacing(4)})})},69529:(k,A,e)=>{"use strict";e.d(A,{p:()=>D});var n=e(74848),s=e(32196),l=e(8867),r=e(40845),i=e(90613),g=e(67061),o=e(94753),d=e(36348);const c=({width:M="auto",height:I})=>{const R=(0,r.of)(a);return(0,n.jsx)(l.default,{src:d,className:R.svg,height:I,width:M})};c.displayName="GrotCTA";const a=M=>({svg:(0,s.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:M.isDark?"#58558c":"#c9c5f4"}})});var p=e(96540),u=e(22687);const m=-20,v=5,x=-5,f=5,E=({width:M="auto",height:I})=>{const R=(0,p.useRef)(null),T=(0,r.of)(h);return(0,p.useEffect)(()=>{const S=L=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const O=R.current?.querySelector("#grot-not-found-arm"),j=R.current?.querySelector("#grot-not-found-magnifier"),{clientX:N,clientY:F}=L,{innerWidth:U,innerHeight:w}=window,B=F/w,K=N/U,W=y(B,m,v),z=y(K,x,f);window.requestAnimationFrame(()=>{O?.setAttribute("style",`transform: rotate(${W}deg) translateX(${z}%)`),j?.setAttribute("style",`transform: rotate(${W}deg) translateX(${z}%)`)})};return window.addEventListener("mousemove",S),()=>{window.removeEventListener("mousemove",S)}},[]),(0,n.jsx)(l.default,{innerRef:R,src:u,className:T.svg,height:I,width:M})};E.displayName="GrotNotFound";const h=M=>({svg:(0,s.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),y=(M,I,R)=>M*(R-I)+I;var b=e(9886);const D=({button:M,children:I,image:R,message:T,hideImage:S=!1,variant:L,role:O})=>{const j=(0,r.of)(C),N=R??P(L);return(0,n.jsx)(i.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:O,children:(0,n.jsxs)("div",{className:j.container,children:[!S&&N,(0,n.jsxs)(g.B,{direction:"column",alignItems:"center",children:[(0,n.jsx)(o.E,{variant:"h4",textAlignment:"center",children:T}),I&&(0,n.jsx)(o.E,{color:"secondary",textAlignment:"center",children:I})]}),M]})})};function P(M){switch(M){case"call-to-action":return(0,n.jsx)(c,{width:300});case"not-found":return(0,n.jsx)(E,{width:300});case"completed":return(0,n.jsx)(l.default,{src:b,width:300});default:throw new Error(`Unknown variant: ${M}`)}}const C=M=>({container:(0,s.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:M.spacing(4),maxWidth:"600px"})})},66602:(k,A,e)=>{"use strict";e.d(A,{Xc:()=>d,Xw:()=>o,tH:()=>g});var n=e(74848),s=e(96540),l=e(32631),r=e(42418),i=e(52446);class g extends s.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(a,p){l.P?.api?.pushError(a),this.setState({error:a,errorInfo:p}),this.props.onError&&this.props.onError(a)}componentDidUpdate(a){const{dependencies:p,onRecover:u}=this.props;if(this.state.error&&p&&a.dependencies){for(let m=0;m<p.length;m++)if(p[m]!==a.dependencies[m]){this.setState({error:null,errorInfo:null}),u&&u();break}}}render(){const{children:a}=this.props,{error:p,errorInfo:u}=this.state;return a({error:p,errorInfo:u})}}class o extends s.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:a,children:p,style:u,dependencies:m}=this.props;return(0,n.jsx)(g,{dependencies:m,children:({error:v,errorInfo:x})=>x?u==="alertbox"?(0,n.jsx)(r.F,{title:a||"",children:(0,n.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[v&&v.toString(),(0,n.jsx)("br",{}),x.componentStack]})}):(0,n.jsx)(i.D,{title:a||"",error:v,errorInfo:x}):p})}}function d(c,a={}){const p=u=>(0,n.jsx)(o,{...a,children:(0,n.jsx)(c,{...u})});return p.displayName="WithErrorBoundary",p}},52446:(k,A,e)=>{"use strict";e.d(A,{D:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({error:g,errorInfo:o,title:d})=>{const c=(0,l.of)(i);return(0,n.jsxs)("div",{className:c,children:[(0,n.jsx)("h2",{children:d}),(0,n.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[g&&g.toString(),(0,n.jsx)("br",{}),o&&o.componentStack]})]})};r.displayName="ErrorWithStack";const i=()=>(0,s.css)({width:"500px",margin:"64px auto"})},29678:(k,A,e)=>{"use strict";e.d(A,{y:()=>r});var n=e(74848),s=e(41987),l=e(39938);const r=({featureState:g,tooltip:o})=>{const d=i(g);return(0,n.jsx)(l.E,{text:d.text,color:d.color,icon:d.icon,tooltip:o})};function i(g){switch(g){case s.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case s.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case s.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case s.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case s.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(k,A,e)=>{"use strict";e.d(A,{gH:()=>m,wI:()=>f});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(20978),o=e(47172),d=e(83195),c=e(40845),a=e(42418),p=e(14578),u=e(73569);function m({options:D,children:P,readAs:C,onLoad:M,fileListRenderer:I,onFileRemove:R}){const[T,S]=(0,i.useState)([]),[L,O]=(0,i.useState)([]),j=(0,d.j_)("decbytes")(D?.maxSize?D?.maxSize:0),N=(0,i.useCallback)((te,H)=>{S(se=>se.map(ne=>(ne.id===te.id&&H(ne),ne)))},[]),F=(0,i.useCallback)((te,H,se)=>{let ne=te.map(y);if(D?.multiple===!1?S(ne):S(le=>[...le,...ne]),X(H),D?.onDrop)D.onDrop(te,H,se);else for(const le of ne){const _=new FileReader,Q=()=>{C?_[C](le.file):_.readAsText(le.file)};N(le,ae=>{ae.abortUpload=()=>{_.abort()},ae.retryUpload=()=>{N(le,oe=>{oe.error=null,oe.progress=void 0}),Q()}}),_.onabort=()=>{N(le,ae=>{ae.error=new DOMException("Aborted")})},_.onprogress=ae=>{N(le,oe=>{oe.progress=ae.loaded})},_.onload=()=>{M?.(_.result)},_.onerror=()=>{N(le,ae=>{ae.error=_.error})},Q()}},[M,D,C,N]),U=te=>{const H=T.filter(se=>te.id!==se.id);S(H),R?.(te)},{getRootProps:w,getInputProps:B,isDragActive:K}=(0,g.VB)({...D,useFsAccessApi:!1,onDrop:F,accept:x(D?.accept)}),W=(0,c.$j)(),z=b(W,K),Y=T.map(te=>I?I(te,U):(0,n.jsx)(u.I,{file:te,removeFile:U},te.id)),X=te=>{let H=[];te.map(se=>{se.errors.map(ne=>{H.findIndex(le=>le.code===ne.code&&le.message===ne.message)===-1&&H.push(ne)})}),O(H)},q=te=>(0,n.jsx)("div",{className:z.errorAlert,children:(0,n.jsx)(a.F,{title:"Upload failed",severity:"error",onRemove:G,children:te.map(H=>{switch(H.code){case o.O4.FileTooLarge:return(0,n.jsxs)("div",{children:["File is larger than ",(0,d.cN)(j)]},H.message+H.code);default:return(0,n.jsx)("div",{children:H.message},H.message+H.code)}})})}),G=()=>{O([])};return(0,n.jsxs)("div",{className:z.container,children:[(0,n.jsxs)("div",{"data-testid":"dropzone",...w({className:z.dropzone}),children:[(0,n.jsx)("input",{...B()}),P??(0,n.jsx)(f,{primaryText:E(T,D)})]}),L.length>0&&q(L),(0,n.jsxs)("small",{className:(0,s.cx)(z.small,z.acceptContainer),children:[D?.maxSize&&`Max file size: ${(0,d.cN)(j)}`,D?.maxSize&&D?.accept&&(0,n.jsx)("span",{className:z.acceptSeparator,children:"|"}),D?.accept&&h(D.accept)]}),Y]})}function v(D){return["txt","json","csv","xls","yml"].some(P=>D.match(P))?"text/plain":"application/octet-stream"}function x(D){return(0,l.isString)(D)?{[v(D)]:[D]}:Array.isArray(D)?D.reduce((P,C)=>{const M=v(C);return P[M]=P[M]?[...P[M],C]:[C],P},{}):D}function f({primaryText:D="Drop file here or click to upload",secondaryText:P=""}){const C=(0,c.$j)(),M=b(C);return(0,n.jsxs)("div",{className:(0,s.cx)(M.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,n.jsx)(p.I,{className:(0,s.cx)(M.icon),name:"upload",size:"xl"}),(0,n.jsx)("h6",{className:(0,s.cx)(M.primaryText),children:D}),(0,n.jsx)("small",{className:M.small,children:P})]})}function E(D,P){return P?.multiple===void 0||P?.multiple?"Upload file":D.length?"Replace file":"Upload file"}function h(D){return(0,l.isString)(D)?`Accepted file type: ${D}`:Array.isArray(D)?`Accepted file types: ${D.join(", ")}`:`Accepted file types: ${Object.values(D).flat().join(", ")}`}function y(D){return{id:(0,l.uniqueId)("file"),file:D,error:null}}function b(D,P){return{container:(0,s.css)({display:"flex",flexDirection:"column",width:"100%",padding:D.spacing(2),borderRadius:D.shape.radius.default,border:`1px dashed ${D.colors.border.strong}`,backgroundColor:P?D.colors.background.secondary:D.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,s.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,s.css)({textAlign:"center"}),icon:(0,s.css)({marginBottom:D.spacing(1)}),primaryText:(0,s.css)({marginBottom:D.spacing(1)}),acceptContainer:(0,s.css)({textAlign:"center",margin:0}),acceptSeparator:(0,s.css)({margin:`0 ${D.spacing(1)}`}),small:(0,s.css)({color:D.colors.text.secondary}),errorAlert:(0,s.css)({paddingTop:"10px"})}}},73569:(k,A,e)=>{"use strict";e.d(A,{I:()=>a});var n=e(74848),s=e(32196),l=e(83195),r=e(40845),i=e(53550),g=e(55852),o=e(14578),d=e(29158);const c="Remove file";function a({file:u,removeFile:m}){const v=(0,r.of)(p),{file:x,progress:f,error:E,abortUpload:h,retryUpload:y}=u,b=()=>E?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:v.error,children:E.message}),y&&(0,n.jsx)(d.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:y}),m&&(0,n.jsx)(d.K,{className:y?v.marginLeft:"",name:"trash-alt",onClick:()=>m(u),tooltip:c})]}):f&&x.size>f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("progress",{className:v.progressBar,max:x.size,value:f}),(0,n.jsxs)("span",{className:v.paddingLeft,children:[Math.round(f/x.size*100),"%"]}),h&&(0,n.jsx)(g.$n,{variant:"secondary",type:"button",fill:"text",onClick:h,children:"Cancel upload"})]}):m&&(0,n.jsx)(d.K,{name:"trash-alt",onClick:()=>m(u),tooltip:c,tooltipPlacement:"top"}),D=(0,l.j_)("decbytes")(x.size);return(0,n.jsxs)("div",{className:v.fileListContainer,children:[(0,n.jsxs)("span",{className:v.fileNameWrapper,children:[(0,n.jsx)(o.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,n.jsx)("span",{className:v.padding,children:(0,i.i)(x.name)}),(0,n.jsx)("span",{children:(0,l.cN)(D)})]}),(0,n.jsx)("div",{className:v.fileNameWrapper,children:b()})]})}function p(u){return{fileListContainer:(0,s.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:u.spacing(2),border:`1px dashed ${u.colors.border.medium}`,backgroundColor:`${u.colors.background.secondary}`,marginTop:u.spacing(1)}),fileNameWrapper:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,s.css)({padding:u.spacing(0,1)}),paddingLeft:(0,s.css)({paddingLeft:u.spacing(2)}),marginLeft:(0,s.css)({marginLeft:u.spacing(1)}),error:(0,s.css)({paddingRight:u.spacing(2),color:u.colors.error.text}),progressBar:(0,s.css)({borderRadius:u.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:u.colors.border.weak,borderRadius:u.shape.radius.default},"::-webkit-progress-value":{backgroundColor:u.colors.primary.main,borderRadius:u.shape.radius.default}})}}},92887:(k,A,e)=>{"use strict";e.d(A,{IB:()=>s.I,gH:()=>n.gH,wI:()=>n.wI});var n=e(37270),s=e(73569)},73546:(k,A,e)=>{"use strict";e.d(A,{e:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(62938),i=e(13544),g=e(40845),o=e(16797),d=e(53550),c=e(55852),a=e(14578);const p=({onFileUpload:m,className:v,children:x="Upload file",accept:f="*",size:E="md",showFileName:h})=>{const y=(0,g.of)(u(E)),[b,D]=(0,l.useState)(""),P=(0,r.A)(),C=(0,l.useCallback)(M=>{const I=M.currentTarget?.files?.[0];I&&D(I.name??""),m(M)},[m]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"file",id:P,className:y.fileUpload,onChange:C,multiple:!1,accept:f,"data-testid":i.Tp.components.FileUpload.inputField}),(0,n.jsxs)("label",{htmlFor:P,className:(0,s.cx)(y.labelWrapper,v),children:[(0,n.jsx)(a.I,{name:"upload",className:y.icon}),x]}),h&&b&&(0,n.jsx)("span",{"aria-label":"File name",className:y.fileName,"data-testid":i.Tp.components.FileUpload.fileNameSpan,children:(0,d.i)(b)})]})},u=m=>v=>{const x=(0,c.hs)({theme:v,variant:"primary",size:m,iconOnly:!1}),f=(0,o.getFocusStyles)(v);return{fileUpload:(0,s.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":f,"&:focus-visible + label":f}),labelWrapper:x.button,icon:x.icon,fileName:(0,s.css)({marginLeft:v.spacing(.5)})}}},67647:(k,A,e)=>{"use strict";e.d(A,{Z:()=>d});var n=e(74848),s=e(96540),l=e(54479);function r(...c){const a=s.useRef(null);return s.useEffect(()=>{c.forEach(p=>{p&&(typeof p=="function"?p(a.current):p.current=a.current)})},[c]),a}var i=e(55852),g=e(14578),o=e(10354);const d=(0,s.forwardRef)(({value:c,width:a,onChange:p,escapeRegex:u=!0,...m},v)=>{const x=(0,s.useRef)(null),f=r(v,x),E=c!==""?(0,n.jsx)(i.$n,{icon:"times",fill:"text",size:"sm",onClick:h=>{x.current?.focus(),p(""),h.stopPropagation()},children:"Clear"}):null;return(0,n.jsx)(o.p,{prefix:(0,n.jsx)(g.I,{name:"search"}),suffix:E,width:a,type:"text",value:u?(0,l.xb)(c??""):c,onChange:h=>p(u?(0,l.jD)(h.currentTarget.value):h.currentTarget.value),...m,ref:f})});d.displayName="FilterInput"},92174:(k,A,e)=>{"use strict";e.d(A,{m:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(55852),i=e(14578);const g=({label:d,selected:c,onClick:a,icon:p="check"})=>{const u=(0,l.of)(o),m=(0,l.of)(r.my);return(0,n.jsxs)("button",{type:"button",className:(0,s.cx)(m,u.wrapper,c&&u.selected),onClick:a,children:[(0,n.jsx)("span",{children:d}),c&&(0,n.jsx)(i.I,{name:p,className:u.icon})]})},o=d=>({wrapper:(0,s.css)({background:d.colors.background.secondary,borderRadius:d.shape.radius.pill,padding:d.spacing(0,2),fontSize:d.typography.bodySmall.fontSize,fontWeight:d.typography.fontWeightMedium,lineHeight:d.typography.bodySmall.lineHeight,color:d.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${d.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:d.colors.action.hover,color:d.colors.text.primary}}),selected:(0,s.css)({color:d.colors.text.primary,background:d.colors.action.selected,"&:hover":{background:d.colors.action.focus}}),icon:(0,s.css)({marginLeft:d.spacing(.5)})})},90090:(k,A,e)=>{"use strict";e.d(A,{z:()=>r});var n=e(74848),s=e(32196),l=e(38894);const r=({label:g,tooltip:o,labelWidth:d=6,inputWidth:c=12,inputEl:a,className:p,interactive:u,...m})=>{const v=i();return(0,n.jsxs)("div",{className:(0,s.cx)(v.formField,p),children:[(0,n.jsx)(l.I,{width:d,tooltip:o,interactive:u,children:g}),a||(0,n.jsx)("input",{type:"text",className:`gf-form-input ${c?`width-${c}`:""}`,...m,disabled:m.disabled})]})};r.displayName="FormField";const i=()=>({formField:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(k,A,e)=>{"use strict";e.d(A,{I:()=>o});var n=e(74848),s=e(46942),l=e.n(s),r=e(14578),i=e(56034);const o=({children:d,isFocused:c,isInvalid:a,className:p,htmlFor:u,tooltip:m,width:v,interactive:x,...f})=>{const E=l()(p,`gf-form-label width-${v||"10"}`,{"gf-form-label--is-focused":c,"gf-form-label--is-invalid":a});return(0,n.jsxs)("label",{className:E,...f,htmlFor:u,children:[d,m&&(0,n.jsx)(i.m,{placement:"top",content:m,theme:"info",interactive:x,children:(0,n.jsx)(r.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},9286:(k,A,e)=>{"use strict";e.d(A,{i:()=>l});var n=e(74848);function s(r){return r<20?.9:r<26?.8:.6}const l=({value:r,className:i,style:g,...o})=>{const d=(r.prefix??"").length>0,c=(r.suffix??"").length>0;let a;if(g&&g.fontSize&&typeof g.fontSize=="number"){const p=g.fontSize,u=s(p);a={fontSize:p*u}}return(0,n.jsx)("div",{className:i,style:g,...o,children:(0,n.jsxs)("div",{children:[d&&(0,n.jsx)("span",{children:r.prefix}),(0,n.jsx)("span",{children:r.text}),c&&(0,n.jsx)("span",{style:a,children:r.suffix})]})})};l.displayName="FormattedDisplayValue"},10880:(k,A,e)=>{"use strict";e.d(A,{S:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16797),g=e(60029);const o=l.forwardRef(({label:c,description:a,value:p,htmlValue:u,onChange:m,disabled:v,className:x,indeterminate:f,invalid:E,...h},y)=>{const b=(0,l.useCallback)(C=>{m&&m(C)},[m]),D=(0,r.of)(d,E),P=f?"mixed":void 0;return(0,n.jsxs)("label",{className:(0,s.cx)(D.wrapper,x),children:[(0,n.jsxs)("div",{className:D.checkboxWrapper,children:[(0,n.jsx)("input",{type:"checkbox",className:(0,s.cx)(D.input,f&&D.inputIndeterminate),checked:p,disabled:v,onChange:b,value:u,"aria-checked":P,...h,ref:y}),(0,n.jsx)("span",{className:D.checkmark})]}),c&&(0,n.jsx)("span",{className:D.label,children:c}),a&&(0,n.jsx)("span",{className:D.description,children:a})]})}),d=(c,a=!1)=>{const p=(0,g.f)(c),u=2,m=1,v=x=>a?c.colors.error.border:x;return{wrapper:(0,s.css)({display:"inline-grid",alignItems:"center",columnGap:c.spacing(m),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,s.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,i.getFocusStyles)(c),"&:focus:not(:focus-visible) + span":(0,i.getMouseFocusStyles)(c),"&:checked + span":{background:c.colors.primary.main,border:`1px solid ${v(c.colors.primary.main)}`,"&:hover":{background:c.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${c.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:c.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${v(c.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:c.colors.action.disabledBackground},"&:after":{borderColor:c.colors.action.disabledText}}}),inputIndeterminate:(0,s.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${v(c.colors.primary.main)}`,background:c.colors.primary.main,"&:hover":{background:c.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${c.colors.primary.contrastText}`,backgroundColor:c.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:c.colors.action.disabledBackground,border:`1px solid ${v(c.colors.error.transparent)}`,"&:after":{borderColor:c.colors.action.disabledText}}}),checkboxWrapper:(0,s.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,s.css)({position:"relative",zIndex:2,display:"inline-block",width:c.spacing(u),height:c.spacing(u),borderRadius:c.shape.radius.default,background:c.components.input.background,border:`1px solid ${v(c.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:v(c.components.input.borderHover)}}),label:(0,s.cx)(p.label,(0,s.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:c.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,s.cx)(p.description,(0,s.css)({gridColumnStart:2,gridRowStart:2,lineHeight:c.typography.bodySmall.lineHeight,marginTop:0}))}};o.displayName="Checkbox"},88575:(k,A,e)=>{"use strict";e.d(A,{D:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(67892),g=e(72093),o=e(60029);const d=l.forwardRef(({label:p,description:u,horizontal:m,invalid:v,loading:x,disabled:f,required:E,error:h,children:y,className:b,validationMessageHorizontalOverflow:D,htmlFor:P,...C},M)=>{const I=(0,r.of)(a),R=P??(0,i.getChildId)(y),T=typeof p=="string"?(0,n.jsx)(o.J,{htmlFor:R,description:u,children:`${p}${E?" *":""}`}):p,S=c({invalid:v,disabled:f,loading:x});return(0,n.jsxs)("div",{className:(0,s.cx)(I.field,m&&I.fieldHorizontal,b),...C,children:[T,(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:M,children:l.cloneElement(y,S)}),v&&h&&!m&&(0,n.jsx)("div",{className:(0,s.cx)(I.fieldValidationWrapper,{[I.validationMessageHorizontalOverflow]:!!D}),children:(0,n.jsx)(g.P,{children:h})})]}),v&&h&&m&&(0,n.jsx)("div",{className:(0,s.cx)(I.fieldValidationWrapper,I.fieldValidationWrapperHorizontal,{[I.validationMessageHorizontalOverflow]:!!D}),children:(0,n.jsx)(g.P,{children:h})})]})});d.displayName="Field";function c(p){for(const u in p)p[u]===void 0&&delete p[u];return p}const a=p=>({field:(0,s.css)({display:"flex",flexDirection:"column",marginBottom:p.spacing(2)}),fieldHorizontal:(0,s.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,s.css)({marginTop:p.spacing(.5)}),fieldValidationWrapperHorizontal:(0,s.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,s.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},95984:(k,A,e)=>{"use strict";e.d(A,{E:()=>s});var n=e(49785);const s=({name:l,control:r,children:i,...g})=>{const{fields:o,append:d,prepend:c,remove:a,swap:p,move:u,insert:m}=(0,n.jz)({control:r,name:l,...g});return i({fields:o,append:d,prepend:c,remove:a,swap:p,move:u,insert:m})}},84167:(k,A,e)=>{"use strict";e.d(A,{n:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(17408);const i=({label:o,children:d,className:c,...a})=>{const p=(0,l.of)(g);return(0,n.jsxs)("fieldset",{className:(0,s.cx)(p.wrapper,c),...a,children:[o&&(0,n.jsx)(r.s,{children:o}),d]})},g=o=>({wrapper:(0,s.css)({marginBottom:o.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(k,A,e)=>{"use strict";e.d(A,{P:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(14578);const i=({children:o,horizontal:d,className:c})=>{const a=(0,l.of)(g),p=(0,s.cx)(d?a.horizontal:a.vertical,c);return(0,n.jsxs)("div",{role:"alert",className:p,children:[(0,n.jsx)(r.I,{className:a.fieldValidationMessageIcon,name:"exclamation-triangle"}),o]})},g=o=>{const d=`
      font-size: ${o.typography.size.sm};
      font-weight: ${o.typography.fontWeightMedium};
      padding: ${o.spacing(.5,1)};
      color: ${o.colors.error.contrastText};
      background: ${o.colors.error.main};
      border-radius: ${o.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${o.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,s.css)(d,{margin:o.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${o.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,s.css)(d,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,s.css)({marginRight:o.spacing()})}}},51253:(k,A,e)=>{"use strict";e.d(A,{l:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(49785);function i({defaultValues:g,onSubmit:o,validateOnMount:d=!1,validateFieldsOnMount:c,children:a,validateOn:p="onSubmit",maxWidth:u=600,...m}){const{handleSubmit:v,trigger:x,formState:f,...E}=(0,r.mN)({mode:p,defaultValues:g});return(0,l.useEffect)(()=>{d&&x(c)},[x,c,d]),(0,n.jsx)("form",{className:(0,s.css)({maxWidth:u!=="none"?u+"px":u,width:"100%"}),onSubmit:v(o),...m,children:a({errors:f.errors,formState:f,trigger:x,...E})})}},14186:(k,A,e)=>{"use strict";e.d(A,{I:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(67892),g=e(72093),o=e(76892);const d=({children:a,label:p,tooltip:u,labelWidth:m="auto",invalid:v,loading:x,disabled:f,required:E,className:h,htmlFor:y,grow:b,shrink:D,error:P,transparent:C,interactive:M,...I})=>{const R=(0,r.$j)(),T=c(R,b,D),S=y??(0,i.getChildId)(a),L=typeof p=="string"?(0,n.jsx)(o.c,{interactive:M,width:m,tooltip:u,htmlFor:S,transparent:C,children:`${p}${E?" *":""}`}):p;return(0,n.jsxs)("div",{className:(0,s.cx)(T.container,h),...I,children:[L,(0,n.jsxs)("div",{className:T.childContainer,children:[(0,l.cloneElement)(a,{invalid:v,disabled:f,loading:x}),v&&P&&(0,n.jsx)("div",{className:(0,s.cx)(T.fieldValidationWrapper),children:(0,n.jsx)(g.P,{children:P})})]})]})};d.displayName="InlineField";const c=(a,p,u)=>({container:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${p?1:0} ${u?1:0} auto`,margin:`0 ${a.spacing(.5)} ${a.spacing(.5)} 0`}),childContainer:(0,s.css)({flex:`${p?1:0} ${u?1:0} auto`}),fieldValidationWrapper:(0,s.css)({marginTop:a.spacing(.5)})})},39268:(k,A,e)=>{"use strict";e.d(A,{C:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g,className:o,...d})=>{const c=(0,l.of)(i);return(0,n.jsx)("div",{className:(0,s.cx)(c.container,o),...d,children:g})},i=g=>({container:(0,s.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:g.spacing(.5)})})},76892:(k,A,e)=>{"use strict";e.d(A,{c:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(14578),i=e(56034);const g=({children:d,className:c,tooltip:a,width:p,transparent:u,interactive:m,as:v="label",...x})=>{const f=(0,l.of)(o,u,p);return(0,n.jsxs)(v,{className:(0,s.cx)(f.label,c),...x,children:[d,a&&(0,n.jsx)(i.m,{interactive:m,placement:"top",content:a,theme:"info",children:(0,n.jsx)(r.I,{tabIndex:0,name:"info-circle",size:"sm",className:f.icon})})]})},o=(d,c=!1,a)=>({label:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:d.spacing(0,1),fontWeight:d.typography.fontWeightMedium,fontSize:d.typography.size.sm,backgroundColor:c?"transparent":d.colors.background.secondary,height:d.spacing(d.components.height.md),lineHeight:d.spacing(d.components.height.md),marginRight:d.spacing(.5),borderRadius:d.shape.radius.default,border:"none",width:a?a!=="auto"?`${8*a}px`:a:"100%",color:d.colors.text.primary}),icon:(0,s.css)({color:d.colors.text.secondary,marginLeft:"10px",":hover":{color:d.colors.text.primary}})})},63056:(k,A,e)=>{"use strict";e.d(A,{e:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g,className:o,grow:d,...c})=>{const a=(0,l.of)(i,d);return(0,n.jsx)("div",{className:(0,s.cx)(a.container,o),...c,children:g})};r.displayName="InlineSegmentGroup";const i=(g,o)=>({container:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${o?1:0} 0 auto`,marginBottom:g.spacing(.5)})})},60029:(k,A,e)=>{"use strict";e.d(A,{J:()=>i,f:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(14578);const i=({children:o,description:d,className:c,category:a,...p})=>{const u=(0,l.of)(g),m=a?.map((v,x)=>(0,n.jsxs)("span",{className:u.categories,children:[(0,n.jsx)("span",{children:v}),(0,n.jsx)(r.I,{name:"angle-right",className:u.chevron})]},`${v}/${x}`));return(0,n.jsx)("div",{className:(0,s.cx)(u.label,c),children:(0,n.jsxs)("label",{...p,children:[(0,n.jsxs)("div",{className:u.labelContent,children:[m,o]}),d&&(0,n.jsx)("span",{className:u.description,children:d})]})})},g=o=>({label:(0,s.css)({label:"Label",fontSize:o.typography.size.sm,fontWeight:o.typography.fontWeightMedium,lineHeight:1.25,marginBottom:o.spacing(.5),color:o.colors.text.primary,maxWidth:"480px"}),labelContent:(0,s.css)({display:"flex",alignItems:"center"}),description:(0,s.css)({label:"Label-description",color:o.colors.text.secondary,fontSize:o.typography.size.sm,fontWeight:o.typography.fontWeightRegular,marginTop:o.spacing(.25),display:"block"}),categories:(0,s.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,s.css)({margin:o.spacing(0,.25)})})},91634:(k,A,e)=>{"use strict";e.d(A,{O:()=>g,p:()=>o});var n=e(74848),s=e(46942),l=e.n(s),r=e(96540),i=e(29734),g=(d=>(d.Invalid="invalid",d.Valid="valid",d))(g||{});class o extends r.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=c=>a=>{const p=(0,i.tf)(a.target.value,c);this.setState(u=>({...u,error:p?p[0]:null}))},this.populateEventPropsWithStatus=(c,a)=>{const p={...c};return a&&Object.keys(i.Pw).forEach(u=>{((0,i.K)(u,a)||c[u])&&(p[u]=async m=>{m.persist(),(0,i.K)(u,a)&&await this.validatorAsync(a[u]).apply(this,[m]),c[u]&&c[u].apply(null,[m,this.status])})}),p}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:c,className:a,hideErrorMessage:p,inputRef:u,...m}=this.props,{error:v}=this.state,x=l()("gf-form-input",{invalid:this.isInvalid},a),f=this.populateEventPropsWithStatus(m,c);return(0,n.jsxs)("div",{style:{flexGrow:1},children:[(0,n.jsx)("input",{...f,ref:u,className:x}),v&&!p&&(0,n.jsx)("span",{children:v})]})}}},24169:(k,A,e)=>{"use strict";e.d(A,{A:()=>i,s:()=>r});var n=e(74848),s=e(28581),l=e(14578);const r=g=>{const o=g.selectProps.menuIsOpen;return(0,n.jsx)(s.c.IndicatorsContainer,{...g,children:(0,n.jsx)(l.I,{name:o?"angle-up":"angle-down",style:{marginTop:"7px"}})})},i=r},11206:(k,A,e)=>{"use strict";e.d(A,{A:()=>r,l:()=>l});var n=e(74848),s=e(28581);const l=i=>{const{children:g}=i;return(0,n.jsx)(s.c.NoOptionsMessage,{...i,children:(0,n.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,n.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:g})})})},r=l},22209:(k,A,e)=>{"use strict";e.d(A,{DW:()=>T,l6:()=>R});var n=e(74848),s=e(46942),l=e.n(s),r=e(96540),i=e(28581),g=e(46005),o=e(8539),d=e(66963),c=e(60578),a=e(40276),p=e(62235),u=e(23731),m=e(56034),v=e(24169),x=e(11206),f=e(14578);const E=O=>{const{children:j,isSelected:N,data:F}=O;return(0,n.jsx)(i.c.Option,{...O,children:(0,n.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[F.imgUrl&&(0,n.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:F.imgUrl,alt:""}),(0,n.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,n.jsx)("div",{children:j}),F.description&&(0,n.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:F.description})]}),N&&(0,n.jsx)(f.I,{name:"check","aria-hidden":"true"})]})})},h=null;var y=e(32196),b=e(3911),D=e(40845);const P=(0,b.N)(O=>({header:(0,y.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${O.colors.background.secondary}`,"&:hover":{color:O.colors.text.maxContrast}}),label:(0,y.css)({flexGrow:1}),icon:(0,y.css)({paddingRight:"2px"})}));class C extends r.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(j=>({expanded:!j.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:j}=this.props.selectProps.value;j&&this.props.options.some(N=>N.value===j)&&this.setState({expanded:!0})}}componentDidUpdate(j){j.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:j,label:N,theme:F}=this.props,{expanded:U}=this.state,w=P(F);return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:w.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,n.jsx)("span",{className:w.label,children:N}),(0,n.jsx)(f.I,{className:w.icon,name:U?"angle-up":"angle-down"})]}),U&&j]})}}const M=(0,D.cV)(C),I=O=>(0,n.jsx)(i.c.MenuList,{...O,children:(0,n.jsx)(a.E,{autoHide:!1,autoHeightMax:"inherit",children:O.children})});class R extends r.PureComponent{static{this.contextType=c.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:E,SingleValue:p.K,IndicatorsContainer:v.A,MenuList:I,Group:M}}}render(){const{defaultValue:j,getOptionLabel:N,getOptionValue:F,onChange:U,options:w,placeholder:B,width:K,value:W,className:z,isDisabled:Y,isLoading:X,isSearchable:q,isClearable:G,backspaceRemovesValue:te,isMulti:H,autoFocus:se,openMenuOnFocus:ne,onBlur:le,maxMenuHeight:_,noOptionsMessage:Q,isOpen:ae,components:oe,tooltipContent:J,tabSelectsValue:ee,onCloseMenu:de,onOpenMenu:xe,allowCustomValue:re,formatCreateLabel:ue,"aria-label":Te}=this.props;let ge="";K&&(ge="width-"+K);let Oe=g.Ay;const Ue={};re&&(Oe=d.A,Ue.formatCreateLabel=ue??(qe=>qe));const Xe=l()("gf-form-input","gf-form-input--form-dropdown",ge,z),we={...R.defaultProps.components,...oe};return(0,n.jsx)(S,{onCloseMenu:de,onOpenMenu:xe,tooltipContent:J,isOpen:ae,children:(qe,We)=>(0,n.jsx)(Oe,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Xe,components:we,defaultValue:j,value:W,getOptionLabel:N,getOptionValue:F,menuShouldScrollIntoView:!1,isSearchable:q,onChange:U,options:w,placeholder:B||"Choose",styles:(0,u.A)(this.context),isDisabled:Y,isLoading:X,isClearable:G,autoFocus:se,onBlur:le,openMenuOnFocus:ne,maxMenuHeight:_,noOptionsMessage:Q,isMulti:H,backspaceRemovesValue:te,menuIsOpen:ae,onMenuOpen:qe,onMenuClose:We,tabSelectsValue:ee,"aria-label":Te,...Ue})})}}class T extends r.PureComponent{static{this.contextType=c.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:j,getOptionLabel:N,getOptionValue:F,onChange:U,placeholder:w,width:B,value:K,className:W,loadOptions:z,defaultOptions:Y,isLoading:X,loadingMessage:q,noOptionsMessage:G,isDisabled:te,isSearchable:H,isClearable:se,backspaceRemovesValue:ne,autoFocus:le,onBlur:_,openMenuOnFocus:Q,maxMenuHeight:ae,isMulti:oe,tooltipContent:J,onCloseMenu:ee,onOpenMenu:de,isOpen:xe}=this.props;let re="";B&&(re="width-"+B);const ue=l()("gf-form-input","gf-form-input--form-dropdown",re,W);return(0,n.jsx)(S,{onCloseMenu:ee,onOpenMenu:de,tooltipContent:J,isOpen:xe,children:(Te,ge)=>(0,n.jsx)(o.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:ue,components:{Option:E,SingleValue:p.K,IndicatorsContainer:v.A,NoOptionsMessage:x.A},defaultValue:j,value:K,getOptionLabel:N,getOptionValue:F,menuShouldScrollIntoView:!1,onChange:U,loadOptions:z,isLoading:X,defaultOptions:Y,placeholder:w||"Choose",styles:(0,u.A)(this.context),loadingMessage:q,noOptionsMessage:G,isDisabled:te,isSearchable:H,isClearable:se,autoFocus:le,onBlur:_,openMenuOnFocus:Q,maxMenuHeight:ae,isMulti:oe,backspaceRemovesValue:ne})})}}class S extends r.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:j}=this.props;j&&j(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:j}=this.props;j&&j(),this.setState({isOpenInternal:!1})}}render(){const{children:j,isOpen:N,tooltipContent:F}=this.props,{isOpenInternal:U}=this.state;let w;return(U||N)&&(w=!1),F?(0,n.jsx)(m.m,{show:w,content:F,placement:"bottom",children:(0,n.jsx)("div",{children:j(this.onOpenMenu,this.onCloseMenu)})}):(0,n.jsx)("div",{children:j(this.onOpenMenu,this.onCloseMenu)})}}const L=null},74716:(k,A,e)=>{"use strict";e.d(A,{d:()=>a});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(40845),o=e(14578),d=e(56034);class c extends i.PureComponent{constructor(){super(...arguments),this.state={id:(0,l.uniqueId)()},this.internalOnChange=m=>{m.stopPropagation(),this.props.onChange(m)}}render(){const{labelClass:m="",switchClass:v="",label:x,checked:f,disabled:E,transparent:h,className:y,theme:b,tooltip:D,tooltipPlacement:P}=this.props,C=p(b),M=this.state.id,I=`gf-form-label ${m} ${h?"gf-form-label--transparent":""} pointer`,R=(0,s.cx)(C.switch,v,{[C.switchTransparent]:h});return(0,n.jsx)("div",{className:C.container,children:(0,n.jsxs)("label",{htmlFor:M,className:(0,s.cx)("gf-form",C.labelContainer,y),children:[x&&(0,n.jsxs)("div",{className:I,children:[x,D&&(0,n.jsx)(d.m,{placement:P||"auto",content:D,theme:"info",children:(0,n.jsx)(o.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,n.jsxs)("div",{className:R,children:[(0,n.jsx)("input",{disabled:E,id:M,type:"checkbox",checked:f,onChange:this.internalOnChange}),(0,n.jsx)("span",{className:C.slider})]})]})})}}const a=(0,g.cV)(c),p=u=>{const m=(0,s.css)({background:u.v1.palette.gray1,borderRadius:u.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:u.components.input.background,transition:"0.4s",borderRadius:u.shape.radius.circle,boxShadow:u.shadows.z1}});return{container:(0,s.css)({display:"flex",flexShrink:0}),labelContainer:(0,s.css)({display:"flex",cursor:"pointer",marginRight:u.spacing(.5)}),switch:(0,s.css)({display:"flex",position:"relative",width:"56px",height:u.spacing(4),background:u.components.input.background,border:`1px solid ${u.components.input.borderColor}`,borderRadius:u.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${m}`]:{background:u.colors.primary.main},[`input:checked + .${m}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,s.css)({background:"transparent",border:0,width:"40px"}),slider:m}}},17408:(k,A,e)=>{"use strict";e.d(A,{s:()=>i});var n=e(74848),s=e(32196),l=e(40845);const r=g=>({legend:(0,s.css)({fontSize:g.typography.h3.fontSize,fontWeight:g.typography.fontWeightRegular,margin:g.spacing(0,0,2,0)})}),i=({children:g,className:o,...d})=>{const c=(0,l.of)(r);return(0,n.jsx)("legend",{className:(0,s.cx)(c.legend,o),...d,children:g})}},94354:(k,A,e)=>{"use strict";e.d(A,{z:()=>v});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(8887),g=e(40845),o=e(14578),d=e(13544),c=e(16797),a=e(56034),p=e(87266);const u=r.forwardRef(({children:f,active:E=!1,disabled:h=!1,size:y="md",onChange:b,onClick:D,id:P,name:C=void 0,description:M,fullWidth:I,"aria-label":R},T)=>{const S=(0,g.of)(m,y,I),L=(0,n.jsx)("input",{type:"radio",className:S.radio,onChange:b,onClick:D,disabled:h,id:P,checked:E,name:C,"aria-label":R,ref:T});return M?(0,n.jsxs)("div",{className:S.radioOption,"data-testid":d.Tp.components.RadioButton.container,children:[(0,n.jsx)(a.m,{content:M,placement:"bottom",children:L}),(0,n.jsx)("label",{className:S.radioLabel,htmlFor:P,title:M||R,children:f})]}):(0,n.jsxs)("div",{className:S.radioOption,"data-testid":d.Tp.components.RadioButton.container,children:[L,(0,n.jsx)("label",{className:S.radioLabel,htmlFor:P,title:M||R,children:f})]})});u.displayName="RadioButton";const m=(f,E,h)=>{const{fontSize:y,height:b,padding:D}=(0,p.SM)(E,f),P=f.colors.text.secondary,C=f.colors.text.primary,M=b*f.spacing.gridSize-4-2;return{radioOption:(0,s.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:h?"1 0 0":"none",textAlign:"center"}),radio:(0,s.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,background:f.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,c.getFocusStyles)(f),"&:focus:not(:focus-visible) + label":(0,c.getMouseFocusStyles)(f),"&:disabled + label":{color:f.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:y,height:`${M}px`,lineHeight:`${M}px`,color:P,padding:f.spacing(0,D),borderRadius:f.shape.radius.default,background:f.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:C}})}};function v({options:f,value:E,onChange:h,onClick:y,disabled:b,disabledOptions:D,size:P="md",id:C,className:M,fullWidth:I=!1,autoFocus:R=!1,"aria-label":T,invalid:S=!1}){const L=(0,r.useCallback)(w=>()=>{h&&h(w.value)},[h]),O=(0,r.useCallback)(w=>()=>{y&&y(w.value)},[y]),j=C??(0,l.uniqueId)("radiogroup-"),N=(0,r.useRef)(j),F=(0,g.of)(x),U=(0,r.useRef)(null);return(0,r.useEffect)(()=>{R&&U.current&&U.current.focus()},[R]),(0,n.jsx)("div",{role:"radiogroup","aria-label":T,className:(0,s.cx)(F.radioGroup,I&&F.fullWidth,S&&F.invalid,M),children:f.map((w,B)=>{const K=D&&w.value&&D.includes(w.value),W=w.icon?(0,i.Uo)(w.icon):void 0,z=!!(w.imgUrl||w.label||w.component);return(0,n.jsxs)(u,{size:P,disabled:K||b,active:E===w.value,"aria-label":w.ariaLabel,onChange:L(w),onClick:O(w),id:`option-${w.value}-${j}`,name:N.current,description:w.description,fullWidth:I,ref:E===w.value?U:void 0,children:[W&&(0,n.jsx)(o.I,{name:W,className:(0,s.cx)(z&&F.icon)}),w.imgUrl&&(0,n.jsx)("img",{src:w.imgUrl,alt:w.label,className:F.img}),w.label," ",w.component?(0,n.jsx)(w.component,{}):null]},`o.label-${B}`)})})}v.displayName="RadioButtonGroup";const x=f=>({radioGroup:(0,s.css)({display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${f.components.input.borderColor}`,borderRadius:f.shape.radius.default,padding:"2px"}),fullWidth:(0,s.css)({display:"flex"}),icon:(0,s.css)({marginRight:"6px"}),img:(0,s.css)({width:f.spacing(2),height:f.spacing(2),marginRight:f.spacing(1)}),invalid:(0,s.css)({border:`1px solid ${f.colors.error.border}`})})},79569:(k,A,e)=>{"use strict";e.d(A,{J:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({id:g,name:o,label:d,checked:c,value:a,disabled:p,description:u,onChange:m,...v})=>{const x=(0,l.of)(i);return(0,n.jsxs)("label",{title:u,className:x.label,children:[(0,n.jsx)("input",{...v,id:g,name:o,type:"radio",checked:c,value:a,disabled:p,className:x.input,onChange:()=>m&&m(g)}),(0,n.jsxs)("div",{children:[d,u&&(0,n.jsx)("div",{className:x.description,children:u})]})]})},i=g=>({input:(0,s.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:g.colors.background.canvas,width:`${g.spacing(2)} !important`,height:g.spacing(2),border:`1px solid ${g.colors.border.medium}`,borderRadius:g.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:g.v1.palette.white,border:`5px solid ${g.colors.primary.main}`},":disabled":{backgroundColor:`${g.colors.action.disabledBackground} !important`,borderColor:g.colors.border.weak},":disabled:checked":{border:`1px solid ${g.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:g.colors.text.disabled,borderRadius:g.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${g.colors.background.canvas}, 0 0 0 3px ${g.colors.primary.main}`}}),label:(0,s.css)({fontSize:g.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${g.spacing(2)} auto`,gap:g.spacing(1)}),description:(0,s.css)({fontSize:g.typography.size.sm,color:g.colors.text.secondary})})},83186:(k,A,e)=>{"use strict";e.d(A,{a:()=>o});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(40845),g=e(79569);function o({name:c,id:a,options:p,value:u,onChange:m,className:v,disabled:x,disabledOptions:f=[]}){const E=(0,i.of)(d),h=a??(0,l.uniqueId)("radiogroup-list-");return(0,n.jsx)("div",{id:a,className:(0,s.cx)(E.container,v),role:"radiogroup",children:p.map((y,b)=>{const D=`${h}-${b}`,P=u&&u===y.value,C=x||f.some(I=>I===y.value),M=()=>m&&y.value&&m(y.value);return(0,n.jsx)(g.J,{id:D,name:c,label:y.label,description:y.description,checked:P,value:y.value,disabled:C,onChange:M},b)})})}const d=c=>({container:(0,s.css)({display:"grid",gap:c.spacing(1)})})},87266:(k,A,e)=>{"use strict";e.d(A,{SM:()=>d,Xb:()=>r,g$:()=>i,gm:()=>l,lH:()=>g});var n=e(32196),s=e(16797);const l=c=>(0,n.css)({"&:focus":(0,s.getFocusStyles)(c)}),r=(c,a=!1)=>{const p=a?c.colors.error.border:c.components.input.borderColor,u=a?c.colors.error.shade:c.components.input.borderHover,m=c.components.input.background,v=c.components.input.text,x=c.isDark?"#2e2f35":"#bab4ca";return(0,n.cx)(i(c),(0,n.css)({background:m,lineHeight:c.typography.body.lineHeight,fontSize:c.typography.size.md,color:v,border:`1px solid ${p}`,"&:-webkit-autofill, &:-webkit-autofill:hover":{boxShadow:`inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${m}!important`,WebkitTextFillColor:`${v} !important`,borderColor:x},"&:-webkit-autofill:focus":{boxShadow:`0 0 0 2px ${c.colors.background.primary}, 0 0 0px 4px ${c.colors.primary.main}, inset 0 0 0 1px rgba(255, 255, 255, 0), inset 0 0 0 100px ${m}!important`,WebkitTextFillColor:`${v} !important`},"&:hover":{borderColor:u},"&:focus":{outline:"none"},"&:disabled":{backgroundColor:c.colors.action.disabledBackground,color:c.colors.action.disabledText,border:`1px solid ${c.colors.action.disabledBackground}`,"&:hover":{borderColor:p}},"&::placeholder":{color:c.colors.text.disabled,opacity:1}}))},i=c=>(0,n.css)({padding:c.spacing(0,1,0,1)}),g=()=>({sm:(0,n.css)({width:o("sm")}),md:(0,n.css)({width:o("md")}),lg:(0,n.css)({width:o("lg")}),auto:(0,n.css)({width:o("auto")})}),o=c=>{switch(c){case"sm":return"200px";case"md":return"320px";case"lg":return"580px";case"auto":default:return"auto"}};function d(c,a){switch(c){case"sm":return{padding:1,fontSize:a.typography.size.sm,height:a.components.height.sm};case"lg":return{padding:3,fontSize:a.typography.size.lg,height:a.components.height.lg};case"md":default:return{padding:2,fontSize:a.typography.size.md,height:a.components.height.md}}}},95164:(k,A,e)=>{"use strict";e.d(A,{_:()=>f});var n=e(74848),s=e(34796),l=e.n(s),r=e(96540),i=e(83195),g=e(58649),o=e(50082),d=e(52622),c=e(29413),a=e(55852),p=e(24293),u=e(47737);const m={mode:o.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function v(E,h,y,b){const D=y!=null,P=b===d.wV.Vertical?h:E,C=Math.min(P*.15/1.5,20),M=C*1.5,I=D?h-M:h,R=Math.min(I,E);return{showLabel:D,gaugeHeight:R,titleFontSize:C}}function x(E,h,y,b){if(h.color?.mode!==p.Y.Thresholds)return[{value:h.min??g.tw,color:y.color??p.F}];const D=h.thresholds??m,P=D.mode===o.O.Percentage,C=D.steps;let M=h.min??g.tw,I=h.max??g.d1;P&&(M=0,I=100);const R=(0,u.yQ)(M,C),T=(0,u.yQ)(I,C),S=[{value:+M.toFixed(E),color:b.visualization.getColorByName(R.color)}];let L=!0;for(let O=0;O<C.length;O++){const j=C[O];if(L){R===j&&(L=!1);continue}const N=C[O-1];if(S.push({value:j.value,color:b.visualization.getColorByName(N.color)}),j===T)break}return S.push({value:+I.toFixed(E),color:b.visualization.getColorByName(T.color)}),S}class f extends r.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:h,value:y,height:b,onClick:D,text:P,theme:C,orientation:M}=this.props,I=v(h,b,y.title,M),R=M===d.wV.Vertical?`${I.gaugeHeight}px`:"100%",T=(0,n.jsx)("div",{style:{height:`${I.gaugeHeight}px`,width:R},ref:S=>this.canvasElement=S});return(0,n.jsxs)(n.Fragment,{children:[D?(0,n.jsx)("button",{className:(0,a.my)(C),type:"button",onClick:D,children:T}):T,I.showLabel&&(0,n.jsx)("div",{style:{textAlign:"center",fontSize:P?.titleSize??I.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:R,top:"-4px",cursor:"default"},children:y.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:m}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:h,showThresholdLabels:y,showThresholdMarkers:b,width:D,height:P,theme:C,value:M,orientation:I}=this.props,R=v(D,P,M.title),T=I===d.wV.Vertical?R.gaugeHeight:D,S=Math.min(T,R.gaugeHeight),L=C.colors.background.secondary,O=y?1.5:1,j=Math.min(S/5.5,40)/O,N=j/5,F=(0,i.cN)(M),w=Math.min(T,S*1.3)*.9-((j+(b?N:0)+(y?10:0))*2+10),B=this.props.text?.valueSize??(0,c.Vr)(F,w,S,1,j*1.7),K=Math.max(B/2.5,12);let W=h.min??g.tw,z=h.max??g.d1,Y=M.numeric;h.thresholds?.mode===o.O.Percentage&&(W=0,z=100,M.percent===void 0?Y=(Y-W)/(z-W)*100:Y=M.percent*100);const X=h.decimals===void 0?2:h.decimals;b&&(W=+W.toFixed(X),z=+z.toFixed(X));const q={series:{gauges:{gauge:{min:W,max:z,neutralValue:h.custom?.neutral,background:{color:L},border:{color:null},shadow:{show:!1},width:j},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:x(X,h,M,C),label:{show:y,margin:N+1,font:{size:K}},show:b,width:N},value:{color:M.color,formatter:()=>F,font:{size:B,family:C.typography.fontFamily}},show:!0}}},G={data:[[0,Y]],label:M.title};try{this.canvasElement&&l().plot(this.canvasElement,[G],q)}catch(te){console.error("Gauge rendering error",te,q,M)}}render(){return(0,n.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},14578:(k,A,e)=>{"use strict";e.d(A,{I:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(8867),i=e(8887),g=e(40845),o=e(87019),d=e(78318);const c=p=>({icon:(0,s.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"}),orange:(0,s.css)({fill:p.v1.palette.orange}),spin:(0,s.css)({[p.transitions.handleMotion("no-preference","reduce")]:{animation:`${o.t} 2s infinite linear`}})}),a=l.forwardRef(({size:p="md",type:u="default",name:m,className:v,style:x,title:f="",...E},h)=>{const y=(0,g.of)(c);(0,i.n6)(m)||console.warn("Icon component passed an invalid icon name",m);const b=m==="fa fa-spinner"?"spinner":m,D=(0,d.Wj)(),P=(0,d.cs)(p),C=P,M=m.startsWith("gf-bar-align")?16:m.startsWith("gf-interp")?30:P,I=(0,d.Xi)(b,u),R=`${D}${I}/${b}.svg`,T=(0,s.cx)(y.icon,v,u==="mono"?{[y.orange]:m==="favorite"}:"",{[y.spin]:b==="spinner"});return(0,n.jsx)(r.default,{"aria-hidden":E.tabIndex===void 0&&!f&&!E["aria-label"]&&!E["aria-labelledby"]&&!E["aria-describedby"],innerRef:h,src:R,width:M,height:C,title:f,className:T,style:x,...E})});a.displayName="Icon"},78318:(k,A,e)=>{"use strict";e.d(A,{Wj:()=>i,Xi:()=>s,cs:()=>l});const n=["grafana","favorite","heart-break","heart","panel-add","library-panel","circle-mono"];function s(g,o){return g?.startsWith("gf-")?"custom":n.includes(g)?"mono":o==="default"?"unicons":o==="solid"?"solid":"mono"}function l(g){switch(g){case"xs":return 12;case"sm":return 14;case"md":return 16;case"lg":return 18;case"xl":return 24;case"xxl":return 36;case"xxxl":return 48}}let r;function i(){if(r)return r;const g=typeof window<"u"&&window.__grafana_public_path__;return g?r=g+"img/icons/":r="public/img/icons/",r}},29158:(k,A,e)=>{"use strict";e.d(A,{K:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(95344),i=e(23596),g=e(40845),o=e(16797),d=e(55852),c=e(78318),a=e(56034);const p=l.forwardRef((m,v)=>{const{size:x="md",variant:f="secondary"}=m;let E;x==="xxl"||x==="xxxl"?((0,r.l)("IconButton",'size="xxl" and size="xxxl"','size="xl"'),E="xl"):E=x;const h=(0,g.of)(u,E,f);let y,b;if("tooltip"in m){const{tooltip:D}=m;y=typeof D=="string"?D:void 0}else if("ariaLabel"in m||"aria-label"in m){const{ariaLabel:D,["aria-label"]:P}=m;y=P||D,b=v}if("tooltip"in m){const{name:D,iconType:P,className:C,tooltip:M,tooltipPlacement:I,...R}=m;return(0,n.jsx)(a.m,{ref:v,content:M,placement:I,children:(0,n.jsx)("button",{...R,ref:b,"aria-label":y,className:(0,s.cx)(h.button,C),type:"button",children:(0,n.jsx)(d.Jt,{icon:D,size:E,className:h.icon,iconType:P})})})}else{const{name:D,iconType:P,className:C,...M}=m;return(0,n.jsx)("button",{...M,ref:b,"aria-label":y,className:(0,s.cx)(h.button,C),type:"button",children:(0,n.jsx)(d.Jt,{icon:D,size:E,className:h.icon,iconType:P})})}});p.displayName="IconButton";const u=(m,v,x)=>{const f=(0,c.cs)(v)+m.spacing.gridSize;let E=m.colors.text.primary;return x==="primary"?E=m.colors.primary.text:x==="destructive"&&(E=m.colors.error.text),{button:(0,s.css)({zIndex:0,position:"relative",margin:`0 ${m.spacing.x0_5} 0 0`,boxShadow:"none",border:"none",display:"inline-flex",background:"transparent",justifyContent:"center",alignItems:"center",padding:0,color:E,"&[disabled], &:disabled":{cursor:"not-allowed",color:m.colors.action.disabledText,opacity:.65},"&:before":{zIndex:-1,position:"absolute",opacity:0,width:`${f}px`,height:`${f}px`,borderRadius:m.shape.radius.default,content:'""',[m.transitions.handleMotion("no-preference","reduce")]:{transitionDuration:"0.2s",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionProperty:"opacity"}},"&:focus, &:focus-visible":(0,o.getFocusStyles)(m),"&:focus:not(:focus-visible)":(0,o.getMouseFocusStyles)(m),"&:hover":{"&:before":{backgroundColor:x==="secondary"?m.colors.action.hover:i.MV.alpha(E,.12),opacity:1}}}),icon:(0,s.css)({verticalAlign:"baseline"})}}},86460:(k,A,e)=>{"use strict";e.d(A,{e:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(29678),g=e(37166);const o=(0,l.memo)((0,l.forwardRef)(({title:c,featureState:a,...p},u)=>{const m=(0,r.of)(d),v=a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:m.badge,children:(0,n.jsx)(i.y,{featureState:a})}),(0,n.jsx)("h3",{children:c})]}):(0,n.jsx)("h3",{children:c});return(0,n.jsx)(g.w,{branded:!0,title:v,urlTitle:"Read documentation",ref:u,...p})}));o.displayName="FeatureInfoBox";const d=c=>({badge:(0,s.css)({marginBottom:c.spacing(1)})})},37166:(k,A,e)=>{"use strict";e.d(A,{w:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(42418),g=e(14578);const o=l.memo(l.forwardRef(({title:c,className:a,children:p,branded:u,url:m,urlTitle:v,onDismiss:x,severity:f="info",...E},h)=>{const y=(0,r.of)(d);return(0,n.jsxs)(i.F,{severity:f,className:a,...E,ref:h,title:c,children:[(0,n.jsx)("div",{children:p}),m&&(0,n.jsxs)("a",{href:m,className:(0,s.cx)("external-link",y.docsLink),target:"_blank",rel:"noreferrer",children:[(0,n.jsx)(g.I,{name:"book"})," ",v||"Read more"]})]})}));o.displayName="InfoBox";const d=c=>({docsLink:(0,s.css)({display:"inline-block",marginTop:c.spacing(2)})})},32982:(k,A,e)=>{"use strict";e.d(A,{r:()=>a});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(96540),o=e(40845),d=e(14578),c=e(17464);function a({referenceElement:m,children:v,suffixIcon:x,placement:f}){const E=(0,o.of)(p),h=(0,o.$j)(),y=[(0,l.cY)(8),(0,l.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,l.BN)()],{context:b,refs:D,floatingStyles:P}=(0,r.we)({open:!0,placement:f,middleware:y,whileElementsMounted:i.ll,strategy:"fixed"});(0,g.useLayoutEffect)(()=>{D.setReference(m)},[m,D]);const{styles:C}=(0,r.DL)(b,{initial:({side:M})=>({opacity:0,transform:u(M,h)}),duration:h.transitions.duration.shortest});return(0,n.jsx)(c.ZL,{children:(0,n.jsx)("div",{style:{display:"inline-block",...P},ref:D.setFloating,"aria-live":"polite",children:(0,n.jsxs)("span",{className:(0,s.cx)(E.root),style:C,children:[v&&(0,n.jsx)("span",{children:v}),x&&(0,n.jsx)(d.I,{name:x})]})})})}const p=m=>({root:(0,s.css)({...m.typography.bodySmall,willChange:"transform",background:m.components.tooltip.background,color:m.components.tooltip.text,padding:m.spacing(.5,1.5),borderRadius:m.shape.radius.pill,display:"inline-flex",gap:m.spacing(.5),alignItems:"center"})}),u=(m,v)=>{switch(m){case"top":return`translateY(${v.spacing(1)})`;case"bottom":return`translateY(-${v.spacing(1)})`;case"left":return`translateX(${v.spacing(1)})`;case"right":return`translateX(-${v.spacing(1)})`}}},51440:(k,A,e)=>{"use strict";e.d(A,{D:()=>i});var n=e(74848),s=e(96540),l=e(29413),r=e(10354);const i=s.forwardRef((o,d)=>{const{defaultValue:c="",minWidth:a=10,maxWidth:p,onCommitChange:u,onKeyDown:m,onBlur:v,...x}=o,[f,E]=s.useState(c),[h,y]=s.useState(a);return(0,s.useEffect)(()=>{y(g(f.toString(),a,p))},[f,p,a]),(0,n.jsx)(r.p,{...x,ref:d,value:f.toString(),onChange:b=>{E(b.currentTarget.value)},width:h,onBlur:b=>{v?v(b):u&&u(b)},onKeyDown:b=>{m?m(b):b.key==="Enter"&&u&&u(b)},"data-testid":"autosize-input"})});function g(o,d,c){if(!o)return d;const p=(0,l.kD)(o.toString(),14).width/8+3;return d&&p<d?d:c&&p>c?c:p}i.displayName="AutoSizeInput"},10354:(k,A,e)=>{"use strict";e.d(A,{n:()=>a,p:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(71473),i=e(40845),g=e(3911),o=e(87266),d=e(62930);const c=(0,l.forwardRef)((p,u)=>{const{className:m,addonAfter:v,addonBefore:x,prefix:f,suffix:E,invalid:h,loading:y,width:b=0,...D}=p,[P,C]=(0,r.A)(),[M,I]=(0,r.A)(),R=(0,i.$j)(),T=a({theme:R,invalid:!!h,width:b});return(0,n.jsxs)("div",{className:(0,s.cx)(T.wrapper,m),"data-testid":"input-wrapper",children:[!!x&&(0,n.jsx)("div",{className:T.addon,children:x}),(0,n.jsxs)("div",{className:T.inputWrapper,children:[f&&(0,n.jsx)("div",{className:T.prefix,ref:P,children:f}),(0,n.jsx)("input",{ref:u,className:T.input,...D,style:{paddingLeft:f?C.width+12:void 0,paddingRight:E||y?I.width+12:void 0}}),(E||y)&&(0,n.jsxs)("div",{className:T.suffix,ref:M,children:[y&&(0,n.jsx)(d.y,{className:T.loadingIndicator,inline:!0}),E]})]}),!!v&&(0,n.jsx)("div",{className:T.addon,children:v})]})});c.displayName="Input";const a=(0,g.N)(({theme:p,invalid:u=!1,width:m})=>{const v="28px",x=(0,s.css)({position:"absolute",top:0,zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,fontSize:p.typography.size.md,height:"100%",minWidth:v,color:p.colors.text.secondary});return{wrapper:(0,s.cx)((0,s.css)({label:"input-wrapper",display:"flex",width:m?p.spacing(m):"100%",height:p.spacing(p.components.height.md),borderRadius:p.shape.radius.default,"&:hover":{"> .prefix, .suffix, .input":{borderColor:u?p.colors.error.border:p.colors.primary.border},"input[type='number']":{appearance:"textfield"},"input[type='number']::-webkit-inner-spin-button, input[type='number']::-webkit-outer-spin-button":{WebkitAppearance:"inner-spin-button !important",opacity:1}}})),inputWrapper:(0,s.css)({label:"input-inputWrapper",position:"relative",flexGrow:1,zIndex:1,"&:not(:first-child):last-child":{"> input":{borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0}},"&:first-child:not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0}},"&:not(:first-child):not(:last-child)":{"> input":{borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0}},input:{"&:not(:first-child)":{paddingLeft:v},"&:not(:last-child)":{paddingRight:v},"&[readonly]":{cursor:"default"}}}),input:(0,s.cx)((0,o.gm)(p),(0,o.Xb)(p,u),(0,s.css)({label:"input-input",position:"relative",zIndex:0,flexGrow:1,borderRadius:p.shape.radius.default,height:"100%",width:"100%"})),inputDisabled:(0,s.css)({backgroundColor:p.colors.action.disabledBackground,color:p.colors.action.disabledText,border:`1px solid ${p.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}),addon:(0,s.css)({label:"input-addon",display:"flex",justifyContent:"center",alignItems:"center",flexGrow:0,flexShrink:0,position:"relative","&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0,"> :last-child":{borderTopRightRadius:0,borderBottomRightRadius:0}},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0,"> :first-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"> *:focus":{zIndex:2}}),prefix:(0,s.cx)(x,(0,s.css)({label:"input-prefix",paddingLeft:p.spacing(1),paddingRight:p.spacing(.5),borderRight:"none",borderTopRightRadius:0,borderBottomRightRadius:0})),suffix:(0,s.cx)(x,(0,s.css)({label:"input-suffix",paddingLeft:p.spacing(1),paddingRight:p.spacing(1),marginBottom:"-2px",borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,right:0})),loadingIndicator:(0,s.css)({"& + *":{marginLeft:p.spacing(.5)}})}})},16504:(k,A,e)=>{"use strict";e.d(A,{e:()=>s});var n=e(49785);const s=n.xI},48840:(k,A,e)=>{"use strict";e.d(A,{j:()=>h});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(32885),g=e(39070),o=e(40845),d=e(14578),c=e(19384),a=e(56034),p=e(29158);const u=(0,s.css)({display:"flex",alignItems:"center",height:"100%"});function m({row:P,__rowID:C}){return(0,n.jsx)("div",{className:u,children:(0,n.jsx)(p.K,{tooltip:"toggle row expanded","aria-controls":C,name:P.isExpanded?"angle-down":"angle-right","aria-expanded":P.isExpanded,...P.getToggleRowExpandedProps(),size:"lg"})})}function v({isAllRowsExpanded:P,toggleAllRowsExpanded:C}){return(0,n.jsx)("div",{className:u,children:(0,n.jsx)(p.K,{"aria-label":P?"Collapse all rows":"Expand all rows",name:P?"table-collapse-all":"table-expand-all",onClick:()=>C(),size:"lg",tooltip:P?"Collapse all rows":"Expand all rows",variant:"secondary"})})}const x="__expander";function f(P,C=!1){return[{id:x,Cell:m,...C&&{Header:v},disableSortBy:!0,width:0},...P.map(M=>({id:M.id,accessor:M.id,Header:M.header||(()=>null),sortType:M.sortType||"alphanumeric",disableSortBy:!M.sortType,width:M.disableGrow?0:void 0,visible:M.visible,...M.cell&&{Cell:M.cell}}))]}const E=P=>{const C=P.colors.emphasize(P.colors.background.primary,.03);return{container:(0,s.css)({display:"flex",gap:P.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,s.css)({padding:P.spacing(1),minWidth:P.spacing(3)}),table:(0,s.css)({borderRadius:P.shape.radius.default,width:"100%"}),disableGrow:(0,s.css)({width:0}),header:(0,s.css)({borderBottom:`1px solid ${P.colors.border.weak}`,minWidth:P.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:P.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:P.spacing(2.5),textAlign:"left",fontWeight:P.typography.fontWeightMedium}}),row:(0,s.css)({label:"row",borderBottom:`1px solid ${P.colors.border.weak}`,"&:hover":{backgroundColor:C},"&:last-child":{borderBottom:0}}),expandedRow:(0,s.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,s.css)({borderBottom:`1px solid ${P.colors.border.weak}`,position:"relative",padding:P.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:P.spacing(2),background:P.colors.border.medium}}),expandedContentRow:(0,s.css)({label:"expanded-row-content"}),sortableHeader:(0,s.css)({"&&":{padding:0}})}};function h({className:P,columns:C,data:M,getRowId:I,headerTooltips:R,pageSize:T=0,renderExpandedRow:S,showExpandAll:L=!1,fetchData:O,initialSortBy:j=[]}){const N=(0,o.of)(E),F=(0,r.useMemo)(()=>f(C,L),[C,L]),U=y(),w=(0,r.useCallback)(H=>`${U}-${H.id}`.replace(/\s/g,""),[U]),B=[i.useSortBy,i.useExpanded],K=M.length>T,W=T>0;W&&B.push(i.usePagination);const z=(0,i.useTable)({columns:F,data:M,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!O,getRowId:I,initialState:{hiddenColumns:[!S&&x,...F.filter(H=>!(!H.visible||H.visible(M))).map(H=>H.id).filter(g.zz)].filter(g.zz),sortBy:j}},...B),{getTableProps:Y,getTableBodyProps:X,headerGroups:q,prepareRow:G}=z,{sortBy:te}=z.state;return(0,r.useEffect)(()=>{O&&O({sortBy:te})},[te,O]),(0,r.useEffect)(()=>{W&&z.setPageSize(T)},[W,T,z.setPageSize,z]),(0,n.jsxs)("div",{className:N.container,children:[(0,n.jsxs)("table",{...Y(),className:(0,s.cx)(N.table,P),children:[(0,n.jsx)("thead",{children:q.map(H=>{const{key:se,...ne}=H.getHeaderGroupProps();return(0,n.jsx)("tr",{...ne,children:H.headers.map(le=>{const{key:_,...Q}=le.getHeaderProps(),ae=R?.[le.id];return(0,n.jsx)("th",{className:(0,s.cx)(N.header,{[N.disableGrow]:le.width===0,[N.sortableHeader]:le.canSort}),...Q,...le.isSorted&&{"aria-sort":le.isSortedDesc?"descending":"ascending"},children:(0,n.jsx)(D,{column:le,headerTooltip:ae})},_)})},se)})}),(0,n.jsx)("tbody",{...X(),children:(W?z.page:z.rows).map(H=>{G(H);const{key:se,...ne}=H.getRowProps(),le=w(H),_=H.isExpanded;return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)("tr",{...ne,className:(0,s.cx)(N.row,_&&N.expandedRow),children:H.cells.map(Q=>{const{key:ae,...oe}=Q.getCellProps();return(0,n.jsx)("td",{className:N.cell,...oe,children:Q.render("Cell",{__rowID:le})},ae)})}),_&&S&&(0,n.jsx)("tr",{...ne,id:le,className:N.expandedContentRow,children:(0,n.jsx)("td",{className:N.expandedContentCell,colSpan:H.cells.length,children:S(H.original)})})]},se)})})]}),W&&K&&(0,n.jsx)("span",{children:(0,n.jsx)(c.d,{currentPage:z.state.pageIndex+1,numberOfPages:z.pageOptions.length,onNavigate:H=>z.gotoPage(H-1)})})]})}const y=()=>(0,r.useMemo)(()=>(0,l.uniqueId)("InteractiveTable"),[]),b=P=>({sortIcon:(0,s.css)({position:"absolute",top:P.spacing(1)}),headerTooltipIcon:(0,s.css)({marginLeft:P.spacing(.5)})});function D({column:{canSort:P,render:C,isSorted:M,isSortedDesc:I,getSortByToggleProps:R},headerTooltip:T}){const S=(0,o.of)(b),{onClick:L}=R(),O=(0,n.jsxs)(n.Fragment,{children:[C("Header"),T&&(0,n.jsx)(a.m,{theme:"info-alt",content:T.content,placement:"top-end",children:(0,n.jsx)(d.I,{className:S.headerTooltipIcon,name:T.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),M&&(0,n.jsx)("span",{"aria-hidden":"true",className:S.sortIcon,children:(0,n.jsx)(d.I,{name:I?"angle-down":"angle-up"})})]});return P?(0,n.jsx)("button",{type:"button",onClick:L,children:O}):O}},24022:(k,A,e)=>{"use strict";e.d(A,{B:()=>r});var n=e(74848),s=e(96540),l=e(44533);class r extends s.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,s.createRef)(),this.renderJson=()=>{const{json:g,config:o,open:d,onDidRender:c}=this.props,a=this.wrapperRef.current,p=new l.O(g,d,o);a.hasChildNodes()?a.replaceChild(p.render(),a.lastChild):a.appendChild(p.render()),c&&c(p.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:g}=this.props;return(0,n.jsx)("div",{className:g,ref:this.wrapperRef})}}},44533:(k,A,e)=>{"use strict";e.d(A,{O:()=>E});var n=e(2543);function s(h){return h.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function l(h){return!!h&&typeof h==="object"}function r(h){if(h===void 0)return"";if(h===null||typeof h=="object"&&!h.constructor)return"Object";const b=/function ([^(]*)/.exec(h.constructor.toString());return b&&b.length>1?b[1]:""}function i(h){return h===null?"null":typeof h}function g(h,y){const b=i(h);return b==="null"||b==="undefined"?b:(b==="string"&&(y='"'+s(y)+'"'),b==="function"?h.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":y)}let o="";function d(h){return l(h)?(o=r(h),Array.isArray(h)&&(o+="["+h.length+"]")):o=g(h,h.toString()),o}function c(h){return`json-formatter-${h}`}function a(h,y,b){const D=document.createElement(h);return y&&D.classList.add(c(y)),b!==void 0&&(b instanceof Node?D.appendChild(b):D.appendChild(document.createTextNode(String(b)))),D}const p=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,u=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,m=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,v=10,x=typeof window<"u"&&window.requestAnimationFrame||(h=>(h(),0)),f={animateOpen:!0,animateClose:!0};class E{constructor(y,b=1,D=f,P){this.json=y,this.open=b,this.config=D,this.key=P,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(y){this._isOpen=y}get isDate(){return this.type==="string"&&(p.test(this.json)||m.test(this.json)||u.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return l(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return r(this.json)}get type(){return i(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(y=>y||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(c("open")))}openAtDepth(y=1){y<0||(this.open=y,this.isOpen=y!==0,this.element&&(this.removeChildren(!1),y===0?this.element.classList.remove(c("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(c("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,n.isNumber)(this.json[0])||(0,n.isNumber)(this.json[1]))}renderArray(){const y=a("span");return y.appendChild(a("span","bracket","[")),this.isNumberArray()?(this.json.forEach((b,D)=>{D>0&&y.appendChild(a("span","array-comma",",")),y.appendChild(a("span","number",b))}),this.skipChildren=!0):y.appendChild(a("span","number",this.json.length)),y.appendChild(a("span","bracket","]")),y}render(y=!1){this.element=a("div","row");const b=a("a","toggler-link"),D=a("span","toggler");if(this.isObject&&b.appendChild(D),this.hasKey&&b.appendChild(a("span","key",`${this.key}:`)),this.isObject){const C=a("span","value"),M=a("span"),I=a("span","constructor-name",this.constructorName);if(M.appendChild(I),this.isArray){const R=this.renderArray();M.appendChild(R)}C.appendChild(M),b.appendChild(C)}else{const C=this.isUrl?a("a"):a("span");C.classList.add(c(this.type)),this.isDate&&C.classList.add(c("date")),this.isUrl&&(C.classList.add(c("url")),C.setAttribute("href",this.json));const M=g(this.json,this.json);C.appendChild(document.createTextNode(M)),b.appendChild(C)}const P=a("div","children");return this.isObject&&P.classList.add(c("object")),this.isArray&&P.classList.add(c("array")),this.isEmpty&&P.classList.add(c("empty")),this.config&&this.config.theme&&this.element.classList.add(c(this.config.theme)),this.isOpen&&this.element.classList.add(c("open")),y||this.element.appendChild(b),this.skipChildren?b.removeChild(D):this.element.appendChild(P),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&b.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(y=!1){const b=this.element&&this.element.querySelector(`div.${c("children")}`);if(!(!b||this.isEmpty))if(y){let D=0;const P=()=>{const C=this.keys[D],M=new E(this.json[C],this.open-1,this.config,C);b.appendChild(M.render()),D+=1,D<this.keys.length&&(D>v?P():x(P))};x(P)}else this.keys.forEach(D=>{const P=new E(this.json[D],this.open-1,this.config,D);b.appendChild(P.render())})}removeChildren(y=!1){const b=this.element&&this.element.querySelector(`div.${c("children")}`);if(y){let D=0;const P=()=>{b&&b.children.length&&(b.removeChild(b.children[0]),D+=1,D>v?P():x(P))};x(P)}else b&&(b.innerHTML="")}}},90613:(k,A,e)=>{"use strict";e.d(A,{a:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16795),g=e(55738);const o=(0,l.forwardRef)((p,u)=>{const{children:m,margin:v,marginX:x,marginY:f,marginTop:E,marginBottom:h,marginLeft:y,marginRight:b,padding:D,paddingX:P,paddingY:C,paddingTop:M,paddingBottom:I,paddingLeft:R,paddingRight:T,display:S,backgroundColor:L,grow:O,shrink:j,basis:N,flex:F,borderColor:U,borderStyle:w,borderRadius:B,direction:K,justifyContent:W,alignItems:z,boxShadow:Y,element:X,gap:q,width:G,minWidth:te,maxWidth:H,height:se,minHeight:ne,maxHeight:le,..._}=p,Q=(0,r.of)(a,v,x,f,E,h,y,b,D,P,C,M,I,R,T,S,L,O,j,N,F,U,w,B,K,W,z,Y,q),ae=(0,r.of)(g.E,G,te,H,se,ne,le),oe=X??"div";return(0,n.jsx)(oe,{ref:u,className:(0,s.cx)(Q.root,ae),..._,children:m})});o.displayName="Box";const d=(p,u)=>{switch(p){case"error":case"success":case"info":case"warning":return u.colors[p].borderTransparent;default:return p?u.colors.border[p]:void 0}},c=(p,u)=>{switch(p){case"error":case"success":case"info":case"warning":return u.colors[p].transparent;default:return p?u.colors.background[p]:void 0}},a=(p,u,m,v,x,f,E,h,y,b,D,P,C,M,I,R,T,S,L,O,j,N,F,U,w,B,K,W,z)=>({root:(0,s.css)([(0,i.Y)(p,u,Y=>({margin:p.spacing(Y)})),(0,i.Y)(p,m,Y=>({marginLeft:p.spacing(Y),marginRight:p.spacing(Y)})),(0,i.Y)(p,v,Y=>({marginTop:p.spacing(Y),marginBottom:p.spacing(Y)})),(0,i.Y)(p,x,Y=>({marginTop:p.spacing(Y)})),(0,i.Y)(p,f,Y=>({marginBottom:p.spacing(Y)})),(0,i.Y)(p,E,Y=>({marginLeft:p.spacing(Y)})),(0,i.Y)(p,h,Y=>({marginRight:p.spacing(Y)})),(0,i.Y)(p,y,Y=>({padding:p.spacing(Y)})),(0,i.Y)(p,b,Y=>({paddingLeft:p.spacing(Y),paddingRight:p.spacing(Y)})),(0,i.Y)(p,D,Y=>({paddingTop:p.spacing(Y),paddingBottom:p.spacing(Y)})),(0,i.Y)(p,P,Y=>({paddingTop:p.spacing(Y)})),(0,i.Y)(p,C,Y=>({paddingBottom:p.spacing(Y)})),(0,i.Y)(p,M,Y=>({paddingLeft:p.spacing(Y)})),(0,i.Y)(p,I,Y=>({paddingRight:p.spacing(Y)})),(0,i.Y)(p,R,Y=>({display:Y})),(0,i.Y)(p,T,Y=>({backgroundColor:c(Y,p)})),(0,i.Y)(p,w,Y=>({flexDirection:Y})),(0,i.Y)(p,S,Y=>({flexGrow:Y})),(0,i.Y)(p,L,Y=>({flexShrink:Y})),(0,i.Y)(p,O,Y=>({flexBasis:Y})),(0,i.Y)(p,j,Y=>({flex:Y})),(0,i.Y)(p,F,Y=>({borderStyle:Y})),(0,i.Y)(p,N,Y=>({borderColor:d(Y,p)})),(F||N)&&{borderWidth:"1px"},(0,i.Y)(p,B,Y=>({justifyContent:Y})),(0,i.Y)(p,K,Y=>({alignItems:Y})),(0,i.Y)(p,U,Y=>({borderRadius:p.shape.radius[Y]})),(0,i.Y)(p,W,Y=>({boxShadow:p.shadows[Y]})),(0,i.Y)(p,z,Y=>({gap:p.spacing(Y)}))])})},71259:(k,A,e)=>{"use strict";e.d(A,{x:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16795);const g=(0,l.forwardRef)((d,c)=>{const{alignItems:a,children:p,gap:u,columns:m,minColumnWidth:v,...x}=d,f=(0,r.of)(o,u,m,v,a);return(0,n.jsx)("div",{ref:c,...x,className:f.grid,children:p})});g.displayName="Grid";const o=(d,c,a,p,u)=>({grid:(0,s.css)([{display:"grid"},(0,i.Y)(d,c,m=>({gap:d.spacing(m)})),p&&(0,i.Y)(d,p,m=>({gridTemplateColumns:`repeat(auto-fill, minmax(${d.spacing(m)}, 1fr))`})),a&&(0,i.Y)(d,a,m=>({gridTemplateColumns:`repeat(${m}, 1fr)`})),(0,i.Y)(d,u,m=>({alignItems:m}))])})},66864:(k,A,e)=>{"use strict";e.d(A,{Gy:()=>o,PE:()=>g,gW:()=>d,mc:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=(m=>(m[m.Horizontal=0]="Horizontal",m[m.Vertical=1]="Vertical",m))(i||{});const g=({children:m,orientation:v=0,spacing:x="sm",justify:f="flex-start",align:E="normal",wrap:h=!1,width:y="100%",height:b="100%",...D})=>{const P=(0,r.of)(a,v,x,f,E,h);return(0,n.jsx)("div",{className:P.layout,style:{width:y,height:b},...D,children:l.Children.toArray(m).filter(Boolean).map((C,M)=>(0,n.jsx)("div",{className:P.childWrapper,children:C},M))})},o=({children:m,spacing:v,justify:x,align:f="center",wrap:E,width:h,height:y})=>(0,n.jsx)(g,{spacing:v,justify:x,orientation:0,align:f,width:h,height:y,wrap:E,children:m}),d=({children:m,spacing:v,justify:x,align:f,width:E,height:h})=>(0,n.jsx)(g,{spacing:v,justify:x,orientation:1,align:f,width:E,height:h,children:m}),c=({children:m,padding:v,margin:x,grow:f,shrink:E})=>{const h=(0,r.of)(u,v,x);return(0,n.jsx)("div",{className:(0,s.cx)(h.wrapper,f!==void 0&&(0,s.css)({flexGrow:f}),E!==void 0&&(0,s.css)({flexShrink:E})),children:m})},a=(m,v,x,f,E,h)=>{const y=x!=="none"?m.spacing(p[x]):0,b=v===0&&!h||v===1?0:`-${y}`,D=v===1?"vertical-group":"horizontal-group";return{layout:(0,s.css)({label:D,display:"flex",flexDirection:v===1?"column":"row",flexWrap:h?"wrap":"nowrap",justifyContent:f,alignItems:E,height:"100%",maxWidth:"100%",marginBottom:b}),childWrapper:(0,s.css)({label:"layoutChildrenWrapper",marginBottom:v===0&&!h?0:y,marginRight:v===0?y:0,display:"flex",alignItems:E,"&:last-child":{marginBottom:v===1?0:void 0,marginRight:v===0?0:void 0}})}},p={none:0,xs:.5,sm:1,md:2,lg:3},u=(m,v,x)=>{const f=v&&v!=="none"&&m.spacing(p[v])||0,E=x&&x!=="none"&&m.spacing(p[x])||0;return{wrapper:(0,s.css)({label:"container",margin:E,padding:f})}}},68402:(k,A,e)=>{"use strict";e.d(A,{$:()=>l});var n=e(74848),s=e(90613);const l=({v:r=0,h:i=0,layout:g})=>(0,n.jsx)(s.a,{paddingRight:i,paddingBottom:r,display:g==="inline"?"inline-block":"block"})},67061:(k,A,e)=>{"use strict";e.d(A,{B:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16795),g=e(55738);const o=l.forwardRef((c,a)=>{const{gap:p=1,alignItems:u,justifyContent:m,direction:v,wrap:x,children:f,grow:E,shrink:h,basis:y,flex:b,width:D,minWidth:P,maxWidth:C,height:M,minHeight:I,maxHeight:R,...T}=c,S=(0,r.of)(d,p,u,m,v,x,E,h,y,b),L=(0,r.of)(g.E,D,P,C,M,I,R);return(0,n.jsx)("div",{ref:a,className:(0,s.cx)(S.flex,L),...T,children:f})});o.displayName="Stack";const d=(c,a,p,u,m,v,x,f,E,h)=>({flex:(0,s.css)([{display:"flex"},(0,i.Y)(c,m,y=>({flexDirection:y})),(0,i.Y)(c,v,y=>({flexWrap:typeof y=="boolean"?y?"wrap":"nowrap":y})),(0,i.Y)(c,p,y=>({alignItems:y})),(0,i.Y)(c,u,y=>({justifyContent:y})),(0,i.Y)(c,a,y=>({gap:c.spacing(y)})),(0,i.Y)(c,x,y=>({flexGrow:y})),(0,i.Y)(c,f,y=>({flexShrink:y})),(0,i.Y)(c,E,y=>({flexBasis:y})),(0,i.Y)(c,h,y=>({flex:y}))])})},16795:(k,A,e)=>{"use strict";e.d(A,{Y:()=>s});function n(l,r,i,g){const o=r[g];if(o!=null)return{[l.breakpoints.up(g)]:i(o)}}function s(l,r,i){return r==null?null:typeof r!="object"||!("xs"in r)?i(r):[n(l,r,i,"xs"),n(l,r,i,"sm"),n(l,r,i,"md"),n(l,r,i,"lg"),n(l,r,i,"xl"),n(l,r,i,"xxl")]}},55738:(k,A,e)=>{"use strict";e.d(A,{E:()=>l});var n=e(32196),s=e(16795);const l=(r,i,g,o,d,c,a)=>(0,n.css)([(0,s.Y)(r,i,p=>({width:r.spacing(p)})),(0,s.Y)(r,g,p=>({minWidth:r.spacing(p)})),(0,s.Y)(r,o,p=>({maxWidth:r.spacing(p)})),(0,s.Y)(r,d,p=>({height:r.spacing(p)})),(0,s.Y)(r,c,p=>({minHeight:r.spacing(p)})),(0,s.Y)(r,a,p=>({maxHeight:r.spacing(p)}))])},50720:(k,A,e)=>{"use strict";e.d(A,{N:()=>g});var n=e(74848),s=e(96540),l=e(54625),r=e(71733),i=e(80997);const g=(0,s.forwardRef)(({href:o,children:d,...c},a)=>{const p=r.I.stripBaseFromUrl(i.sQ.sanitizeUrl(o??""));return(0,n.jsx)(l.Link,{ref:a,to:p,...c,children:d})});g.displayName="Link"},72109:(k,A,e)=>{"use strict";e.d(A,{Y:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(80997),i=e(71733),g=e(40845),o=e(14578),d=e(71356),c=e(50720);const a={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},p=(0,l.forwardRef)(({href:m,color:v="link",external:x=!1,inline:f=!0,variant:E="body",weight:h,icon:y,children:b,...D},P)=>{const C=r.sQ.sanitizeUrl(m??""),M=(0,g.$j)(),I=u(M,f,E,h,v),R=y||"external-link-alt";if(x)return(0,n.jsxs)("a",{href:C,ref:P,...D,target:"_blank",rel:"noreferrer",className:I,children:[b,(0,n.jsx)(o.I,{size:a[E]||"md",name:R})]});const T=i.I.stripBaseFromUrl(C);return(0,n.jsxs)(c.N,{ref:P,href:T,...D,className:I,children:[b,y&&(0,n.jsx)(o.I,{name:y,size:a[E]||"md"})]})});p.displayName="TextLink";const u=(m,v,x,f,E)=>(0,s.css)([x&&{...m.typography[x]},f&&{fontWeight:(0,d.iV)(f,m)},E&&{color:m.colors.text[E]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:m.colors.text.link}},v&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(k,A,e)=>{"use strict";e.d(A,{p:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(3911);const i=(0,r.N)((o=!1)=>({list:(0,s.css)({listStyleType:"none",margin:0,padding:0}),item:(0,s.css)({display:o&&"inline-block"||"block"})}));class g extends l.PureComponent{constructor(d){super(d)}render(){const{items:d,renderItem:c,getItemKey:a,className:p,inline:u}=this.props,m=i(u);return(0,n.jsx)("ul",{className:(0,s.cx)(m.list,p),children:d.map((v,x)=>(0,n.jsx)("li",{className:m.item,children:c(v,x)},a?a(v):x))})}}},1551:(k,A,e)=>{"use strict";e.d(A,{c:()=>r});var n=e(74848),s=e(96540),l=e(85918);class r extends s.PureComponent{render(){return(0,n.jsx)(l.p,{inline:!0,...this.props})}}},33552:(k,A,e)=>{"use strict";e.d(A,{B:()=>r});var n=e(74848),s=e(96540),l=e(85918);class r extends s.PureComponent{render(){return(0,n.jsx)(l.p,{...this.props})}}},57514:(k,A,e)=>{"use strict";e.d(A,{G:()=>a});var n=e(74848),s=e(32196),l=e(40845);const r=28,i=2.4,g=500,o=4e3,d=300,c=100/r*100;function a({width:u,delay:m=d,ariaLabel:v="Loading bar"}){const x=Math.min(Math.max(Math.round(u*i),g),o),f=(0,l.of)(p,m,x),E={overflow:"hidden"};return(0,n.jsx)("div",{style:E,children:(0,n.jsx)("div",{"aria-label":v,className:f.bar})})}const p=(u,m,v)=>{const x=(0,s.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${c}%)`}});return{bar:(0,s.css)({width:r+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[u.transitions.handleMotion("no-preference")]:{animationName:x,animationDelay:`${m}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${v}ms`},[u.transitions.handleMotion("reduce")]:{animationName:x,animationDelay:`${m}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*v}ms`}})}}},39558:(k,A,e)=>{"use strict";e.d(A,{_:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(62930);const i=({text:o,className:d,...c})=>{const a=(0,l.of)(g);return(0,n.jsxs)("div",{className:(0,s.cx)(a.container,d),...c,children:[o," ",(0,n.jsx)(r.y,{inline:!0})]})},g=o=>({container:(0,s.css)({marginBottom:o.spacing(4)})})},76218:(k,A,e)=>{"use strict";e.d(A,{O:()=>i});var n=e(74848),s=e(96540),l=e(90182),r=e(64278);const i=({value:g,onChange:o,context:d,item:c})=>{const a=c.settings??{},p=(0,r.sE)(d.data,a?.filter),u=(0,r.m3)(p,g,void 0,void 0,a.baseNameMode),m=(0,s.useCallback)(x=>{if(!(x&&!(0,r.v3)(x.value,p)))return o(x?.value)},[p,o]),v=u.find(x=>x.value===g);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.l6,{value:v,placeholder:a.placeholderText??"Select field",options:u,onChange:m,noOptionsMessage:a.noFieldsMessage,width:a.width,isClearable:a.isClearable!==!1})})}},9988:(k,A,e)=>{"use strict";e.d(A,{bx:()=>c,cH:()=>u});var n=e(74848),s=e(96540),l=e(11261),r=e(1173),i=e(85200),g=e(4025),o=e(90182);const d=(0,s.memo)(m=>{const{data:v,options:x,onChange:f,id:E}=m,h=a(v),y=p(h,x),b=(0,s.useCallback)(P=>f(P.value),[f]),D=y.find(P=>P.value===x);return(0,n.jsx)(o.l6,{inputId:E,value:D,options:y,onChange:b})});d.displayName="FieldTypeMatcherEditor";const c=[{value:l.PU.number,label:"Number",icon:(0,g.lV)(l.PU.number)},{value:l.PU.string,label:"String",icon:(0,g.lV)(l.PU.string)},{value:l.PU.time,label:"Time",icon:(0,g.lV)(l.PU.time)},{value:l.PU.boolean,label:"Boolean",icon:(0,g.lV)(l.PU.boolean)},{value:l.PU.trace,label:"Traces",icon:(0,g.lV)(l.PU.trace)},{value:l.PU.enum,label:"Enum",icon:(0,g.lV)(l.PU.enum)},{value:l.PU.other,label:"Other",icon:(0,g.lV)(l.PU.other)}],a=m=>(0,s.useMemo)(()=>{const v=new Map;for(const x of c)v.set(x.value,0);for(const x of m)for(const f of x.fields){const E=f.type||l.PU.other;let h=v.get(E);h||(h=0),v.set(E,h+1)}return v},[m]),p=(m,v)=>(0,s.useMemo)(()=>{let x=!1;const f=[];for(const E of c){const h=m.get(E.value),y=v===E.value;(h||y)&&f.push({...E,label:`${E.label} (${m.get(E.value)})`}),y&&(x=!0)}return v&&!x&&f.push({value:v,label:`${v} (No matches)`}),f},[m,v]),u={id:r.Ct.byType,component:d,matcher:i.sJ.get(r.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:m=>m}},19346:(k,A,e)=>{"use strict";e.d(A,{N:()=>p,r1:()=>x});var n=e(74848),s=e(32196),l=e(96540),r=e(75059),i=e(1173),g=e(85200),o=e(52622),d=e(40845),c=e(10354),a=e(90182);const p=[{label:"==",value:o.zT.EQ},{label:"!=",value:o.zT.NEQ},{label:">",value:o.zT.GT},{label:">=",value:o.zT.GTE},{label:"<",value:o.zT.LT},{label:"<=",value:o.zT.LTE}];function u(f){return f===r.gy.allIsNull||f===r.gy.allIsZero}const m=({options:f,onChange:E})=>{const h=(0,d.of)(v),y=(0,l.useMemo)(()=>r.AS.selectOptions([f?.reducer]),[f?.reducer]),b=(0,l.useCallback)(I=>E({...f,reducer:I.value}),[f,E]),D=(0,l.useCallback)(I=>E({...f,op:I.value}),[f,E]),P=(0,l.useCallback)(I=>{const R=I.currentTarget.valueAsNumber;return E({...f,value:R})},[f,E]),C=f??{},M=u(f.reducer);return(0,n.jsxs)("div",{className:h.spot,children:[(0,n.jsx)(a.l6,{value:y.current,options:y.options,onChange:b,placeholder:"Select field reducer"}),C.reducer&&!M&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.l6,{value:p.find(I=>I.value===C.op),options:p,onChange:D,"aria-label":"Comparison operator",width:19}),(0,n.jsx)(c.p,{type:"number",value:C.value,onChange:P})]})]})},v=f=>({spot:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),x={id:i.Ct.byValue,component:m,matcher:g.sJ.get(i.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:f=>`${f?.reducer} ${f?.op} ${f?.value}`}},74668:(k,A,e)=>{"use strict";e.d(A,{R:()=>p,X:()=>d});var n=e(74848),s=e(96540),l=e(28240),r=e(1173),i=e(85200),g=e(90182);const o=(u,m,v)=>{if(!v)return;let x=u.find(f=>!m.some(E=>f===E));if(x)return x};function d({value:u,data:m,onChange:v,placeholder:x}){const f=(0,s.useMemo)(()=>c(m),[m]),[E,h]=(0,s.useState)({refIds:[],value:void 0}),y=(0,s.useMemo)(()=>f.find(D=>D.value===u)??o(f,E.refIds,E.value),[u,f,E]),b=(0,s.useCallback)(D=>{v(D?.value)},[v]);return(f!==E.refIds||y?.value!==E.value)&&h({refIds:f,value:y?.value}),(0,n.jsx)(g.l6,{options:f,onChange:b,isClearable:!0,placeholder:x??"Select query refId",value:y})}function c(u){const m=new Map;for(const x of u){const f=x.refId??"",E=m.get(f)??[];E.length===0&&m.set(f,E),E.push(x)}const v=[];for(const[x,f]of m.entries())v.push({value:x,label:`Query: ${x??"(missing refId)"}`,description:a(f)});return v}function a(u){return`Frames (${u.length}):
    ${u.slice(0,Math.min(3,u.length)).map(m=>(0,l.Ri)(m)).join(", ")} ${u.length>3?"...":""}`}const p={id:r.Ct.byFrameRefID,component:u=>(0,n.jsx)(d,{value:u.options,data:u.data,onChange:u.onChange}),matcher:i.sJ.get(r.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:u=>u}},84349:(k,A,e)=>{"use strict";e.d(A,{g:()=>h});var n=e(83077),s=e(74848),l=e(96540),r=e(1173),i=e(85200),g=e(10354);const o=(0,l.memo)(y=>{const{options:b,onChange:D}=y,P=(0,l.useCallback)(C=>D(C.target.value),[D]);return(0,s.jsx)(g.p,{placeholder:"Enter regular expression",defaultValue:b,onBlur:P})});o.displayName="FieldNameByRegexMatcherEditor";const d={id:r.Ct.byRegexp,component:o,matcher:i.sJ.get(r.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:y=>y};var c=e(90182),a=e(64278);const p=(0,l.memo)(y=>{const{data:b,options:D,onChange:P,id:C}=y,M=(0,a.sE)(b),I=(0,a.m3)(M,D),R=(0,l.useCallback)(S=>{if((0,a.v3)(S.value,M))return P(S.value)},[M,P]),T=I.find(S=>S.value===D);return(0,s.jsx)(c.l6,{value:T,options:I,onChange:R,inputId:C})});p.displayName="FieldNameMatcherEditor";const u={id:r.Ct.byName,component:p,matcher:i.sJ.get(r.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:y=>y},m=(0,l.memo)(y=>{const{data:b,options:D,onChange:P}=y,{readOnly:C,prefix:M}=D,I=(0,a.sE)(b),R=(0,a.m3)(I,void 0),T=(0,l.useCallback)(S=>{if(Array.isArray(S))return P({...D,names:S.reduce((L,O)=>((0,a.v3)(O.value,I)&&L.push(O.value),L),[])})},[I,P,D]);if(C){const S=(D.names??[]).join(", ");return(0,s.jsx)(g.p,{value:S,readOnly:!0,disabled:!0,prefix:M})}return(0,s.jsx)(c.KF,{value:D.names,options:R,onChange:T})});m.displayName="FieldNameMatcherEditor";const v={id:r.Ct.byNames,component:m,matcher:i.sJ.get(r.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:y=>(y.names??[]).join(", "),excludeFromPicker:!0};var x=e(9988),f=e(19346),E=e(74668);const h=new n.O(()=>[u,d,x.cH,E.R,v,f.r1])},64278:(k,A,e)=>{"use strict";e.d(A,{BP:()=>g,m3:()=>d,sE:()=>o,v3:()=>i});var n=e(96540),s=e(28240),l=e(27310),r=e(4025);function i(c,a){return c?a.display.has(c)||a.raw.has(c):!1}function g(c,a){const p={display:new Set,raw:new Set,fields:new Map};for(const u of c)for(const m of u.fields){if(a&&!a(m))continue;const v=(0,s.Ct)(m,u,c);p.display.add(v),p.fields.set(v,m),m.name&&v!==m.name&&(p.raw.add(m.name),p.fields.set(m.name,m))}return p}function o(c,a){return(0,n.useMemo)(()=>g(c,a),[c,a])}function d(c,a,p,u,m){return(0,n.useMemo)(()=>{let v=!1;const x=[];if(p&&x.push(p),m===l.X4.OnlyBaseNames)for(const f of c.raw)!v&&f===a&&(v=!0),x.push({value:f,label:`${f} (base field name)`});else{for(const f of c.display){!v&&f===a&&(v=!0);const E=c.fields.get(f);(!u||u===E?.type)&&x.push({value:f,label:f,icon:E?(0,r.SS)(E):void 0})}if(m!==l.X4.ExcludeBaseNames)for(const f of c.raw)c.display.has(f)||(!v&&f===a&&(v=!0),x.push({value:f,label:`${f} (base field name)`}))}return a&&!v&&x.push({value:a,label:`${a} (not found)`}),x},[c,a,p,u,m])}},38138:(k,A,e)=>{"use strict";e.d(A,{W:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(90613),g=e(27183),o=e(59093),d=e(64539),c=e(32653);const a=l.forwardRef(({header:m,children:v,ariaLabel:x,onOpen:f,onClose:E,onKeyDown:h,...y},b)=>{const D=(0,r.of)(u),P=(0,l.useRef)(null);(0,l.useImperativeHandle)(b,()=>P.current);const[C]=(0,c.t)({isMenuOpen:!0,localRef:P,onOpen:f,onClose:E,onKeyDown:h});return(0,n.jsxs)(i.a,{...y,"aria-label":x,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:C,paddingX:0,paddingY:.5,ref:P,role:"menu",tabIndex:-1,children:[m&&(0,n.jsx)("div",{className:(0,s.cx)(D.header,!!v&&l.Children.toArray(v).length>0&&D.headerBorder),children:m}),v]})});a.displayName="Menu";const p=Object.assign(a,{Item:d.D,Divider:g.N,Group:o.r}),u=m=>({header:(0,s.css)({padding:m.spacing(.5,1,1,1)}),headerBorder:(0,s.css)({borderBottom:`1px solid ${m.colors.border.weak}`})})},27183:(k,A,e)=>{"use strict";e.d(A,{N:()=>r});var n=e(74848),s=e(32196),l=e(40845);function r(){const g=(0,l.of)(i);return(0,n.jsx)("div",{className:g.divider})}const i=g=>({divider:(0,s.css)({height:1,backgroundColor:g.colors.border.weak,margin:g.spacing(.5,0)})})},59093:(k,A,e)=>{"use strict";e.d(A,{r:()=>g});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(40845);const g=({label:d,ariaLabel:c,children:a})=>{const p=(0,i.of)(o),u=`group-label-${(0,l.uniqueId)()}`;return(0,n.jsxs)("div",{role:"group","aria-labelledby":!c&&d?u:void 0,"aria-label":c,children:[d&&(0,n.jsx)("label",{id:u,className:p.groupLabel,"aria-hidden":!0,children:d}),a]})};g.displayName="MenuGroup";const o=d=>({groupLabel:(0,s.css)({color:d.colors.text.secondary,fontSize:d.typography.size.sm,padding:d.spacing(.5,1)})})},64539:(k,A,e)=>{"use strict";e.d(A,{D:()=>m});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(16797),g=e(14578),o=e(67061),d=e(13544),c=e(32653);const a=x=>{if(!x)return!1;const f=x.parentElement.getBoundingClientRect(),E=x.getBoundingClientRect();return E.width!==0&&f.right+E.width+10>window.innerWidth},p=(0,l.memo)(({items:x,isOpen:f,close:E,customStyle:h})=>{const y=(0,r.of)(u),b=(0,l.useRef)(null),[D]=(0,c.t)({localRef:b,isMenuOpen:f,close:E}),[P,C]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{f&&b.current&&C(a(b.current))},[f]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:y.iconWrapper,"aria-hidden":!0,"data-testid":d.Tp.components.Menu.SubMenu.icon,children:(0,n.jsx)(g.I,{name:"angle-right",className:y.icon})}),f&&(0,n.jsx)("div",{ref:b,className:(0,s.cx)(y.subMenu,{[y.pushLeft]:P}),"data-testid":d.Tp.components.Menu.SubMenu.container,style:h,children:(0,n.jsx)("div",{tabIndex:-1,className:y.itemsWrapper,role:"menu",onKeyDown:D,children:x})})]})});p.displayName="SubMenu";const u=x=>({iconWrapper:(0,s.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,s.css)({opacity:.7,marginLeft:x.spacing(1),color:x.colors.text.secondary}),itemsWrapper:(0,s.css)({background:x.colors.background.primary,boxShadow:x.shadows.z3,display:"inline-block",borderRadius:x.shape.radius.default}),pushLeft:(0,s.css)({right:"100%",left:"unset"}),subMenu:(0,s.css)({position:"absolute",top:0,left:"100%",zIndex:x.zIndex.dropdown})}),m=l.memo(l.forwardRef((x,f)=>{const{url:E,icon:h,label:y,description:b,ariaLabel:D,ariaChecked:P,target:C,onClick:M,className:I,active:R,disabled:T,destructive:S,childItems:L,role:O,tabIndex:j=-1,customSubMenuContainerStyles:N,shortcut:F,testId:U}=x,w=(0,r.of)(v),[B,K]=(0,l.useState)(R),[W,z]=(0,l.useState)(!1),Y=(0,l.useCallback)(()=>{T||(z(!0),K(!0))},[T]),X=(0,l.useCallback)(()=>{T||(z(!1),K(!1))},[T]),q=L&&L.length>0,G=q?"div":E===void 0?"button":"a",te=(0,s.cx)({[w.item]:!0,[w.active]:B,[w.disabled]:T,[w.destructive]:S&&!T},I),H={[G==="button"?"disabled":"aria-disabled"]:T,...G==="a"&&T&&{href:void 0,onClick:void 0},...T&&{tabIndex:-1,"data-disabled":T}},se=(0,l.useRef)(null);(0,l.useImperativeHandle)(f,()=>se.current);const ne=Q=>{switch(Q.key){case"ArrowRight":Q.preventDefault(),Q.stopPropagation(),q&&(z(!0),K(!0));break;default:break}},le=()=>{z(!1),K(!1),se?.current?.focus()},_=!!(F&&F.length>0);return(0,n.jsxs)(G,{target:C,className:te,rel:C==="_blank"?"noopener noreferrer":void 0,href:E,onClick:M,onMouseEnter:Y,onMouseLeave:X,onKeyDown:ne,role:E?O:O||"menuitem","data-role":"menuitem",ref:se,"data-testid":U,"aria-label":D,"aria-checked":P,tabIndex:j,...H,children:[(0,n.jsxs)(o.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[h&&(0,n.jsx)(g.I,{name:h,className:w.icon,"aria-hidden":!0}),(0,n.jsx)("span",{className:w.ellipsis,children:y}),(0,n.jsxs)("div",{className:(0,s.cx)(w.rightWrapper,{[w.withShortcut]:_}),children:[_&&(0,n.jsxs)("div",{className:w.shortcut,children:[(0,n.jsx)(g.I,{name:"keyboard",title:"keyboard shortcut"}),F]}),q&&(0,n.jsx)(p,{items:L,isOpen:W,close:le,customStyle:N})]})]}),b&&(0,n.jsx)("div",{className:(0,s.cx)(w.description,w.ellipsis,{[w.descriptionWithIcon]:h!==void 0}),children:b}),x.component?(0,n.jsx)(x.component,{}):null]})}));m.displayName="MenuItem";const v=x=>({item:(0,s.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:x.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:x.spacing(.5,2),minHeight:x.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:x.colors.action.hover,color:x.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,i.getFocusStyles)(x)}),active:(0,s.css)({background:x.colors.action.hover}),destructive:(0,s.css)({color:x.colors.error.text,svg:{color:x.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:x.colors.error.main,color:x.colors.error.contrastText,svg:{color:x.colors.error.contrastText}}}),disabled:(0,s.css)({color:x.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:x.colors.action.disabledText}}),icon:(0,s.css)({opacity:.7,color:x.colors.text.secondary}),rightWrapper:(0,s.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,s.css)({minWidth:x.spacing(10.5)}),shortcut:(0,s.css)({display:"flex",alignItems:"center",gap:x.spacing(1),marginLeft:x.spacing(2),color:x.colors.text.secondary,opacity:.7}),description:(0,s.css)({...x.typography.bodySmall,color:x.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,s.css)({marginLeft:x.spacing(3)}),ellipsis:(0,s.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(k,A,e)=>{"use strict";e.d(A,{t:()=>i});var n=e(96540),s=e(94701);const l=(g,o)=>(g%o+o)%o,r=-1,i=({localRef:g,isMenuOpen:o,close:d,onOpen:c,onClose:a,onKeyDown:p})=>{const[u,m]=(0,n.useState)(r);return(0,n.useEffect)(()=>{o&&m(0)},[o]),(0,n.useEffect)(()=>{const x=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');x?.[u]?.focus(),x?.forEach((f,E)=>{f.tabIndex=E===u?0:-1})},[g,u]),(0,s.A)(()=>{c?.(m)}),[x=>{const f=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),E=f?.length??0;switch(x.key){case"ArrowUp":x.preventDefault(),x.stopPropagation(),m(l(u-1,E));break;case"ArrowDown":x.preventDefault(),x.stopPropagation(),m(l(u+1,E));break;case"ArrowLeft":x.preventDefault(),x.stopPropagation(),m(r),d?.();break;case"Home":x.preventDefault(),x.stopPropagation(),m(0);break;case"End":x.preventDefault(),x.stopPropagation(),m(E-1);break;case"Enter":x.preventDefault(),x.stopPropagation(),f?.[u]?.click();break;case"Escape":a?.();break;case"Tab":x.preventDefault(),a?.();break;default:break}p?.(x)}]}},37390:(k,A,e)=>{"use strict";e.d(A,{a:()=>v});var n=e(74848),s=e(32196),l=e(18828),r=e(85690),i=e(93225),g=e(59875),o=e(96540),d=e(40845),c=e(76412),a=e(29158),p=e(67061),u=e(29473),m=e(88448);function v(E){const{title:h,children:y,isOpen:b=!1,closeOnEscape:D=!0,closeOnBackdropClick:P=!0,className:C,contentClassName:M,onDismiss:I,onClickBackdrop:R,trapFocus:T=!0}=E,S=(0,d.of)(m.o),L=(0,o.useRef)(null),{overlayProps:O,underlayProps:j}=(0,i.e)({isKeyboardDismissDisabled:!D,isOpen:b,onClose:I},L),{dialogProps:N,titleProps:F}=(0,l.s)({},L);if(!b)return null;const U=(0,s.cx)(S.modalHeader,typeof h!="string"&&S.modalHeaderWithTabs);return(0,n.jsxs)(g.Sf,{children:[(0,n.jsx)("div",{role:"presentation",className:S.modalBackdrop,onClick:R||(P?I:void 0),...j}),(0,n.jsx)(r.n1,{contain:T,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{className:(0,s.cx)(S.modal,C),ref:L,...O,...N,children:[(0,n.jsxs)("div",{className:U,children:[typeof h=="string"&&(0,n.jsx)(f,{...E,title:h,id:F.id}),typeof h!="string"&&h,(0,n.jsx)("div",{className:S.modalHeaderClose,children:(0,n.jsx)(a.K,{name:"times",size:"xl",onClick:I,"aria-label":(0,c.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,n.jsx)("div",{className:(0,s.cx)(S.modalContent,M),children:y})]})})]})}function x({leftItems:E,children:h}){const y=(0,d.of)(m.o);return E?(0,n.jsx)("div",{className:y.modalButtonRow,children:(0,n.jsxs)(p.B,{justifyContent:"space-between",children:[(0,n.jsx)(p.B,{justifyContent:"flex-start",gap:2,children:E}),(0,n.jsx)(p.B,{justifyContent:"flex-end",gap:2,children:h})]})}):(0,n.jsx)("div",{className:y.modalButtonRow,children:(0,n.jsx)(p.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:h})})}v.ButtonRow=x;function f({icon:E,iconTooltip:h,title:y,id:b}){return(0,n.jsx)(u.r,{icon:E,iconTooltip:h,title:y,id:b})}},29473:(k,A,e)=>{"use strict";e.d(A,{r:()=>r});var n=e(74848),s=e(40845),l=e(88448);const r=({icon:i,iconTooltip:g,title:o,children:d,id:c})=>{const a=(0,s.of)(l.o);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:a.modalHeaderTitle,id:c,children:o}),d]})}},95246:(k,A,e)=>{"use strict";e.d(A,{O:()=>s});var n=e(74848);const s=({children:l})=>(0,n.jsx)("div",{className:"share-modal-body",children:(0,n.jsx)("div",{className:"share-modal-header",children:(0,n.jsx)("div",{className:"share-modal-content",children:l})})})},25897:(k,A,e)=>{"use strict";e.d(A,{J:()=>i});var n=e(74848),s=e(40675),l=e(63021),r=e(29473);const i=({icon:g,title:o,tabs:d,activeTab:c,onChangeTab:a})=>(0,n.jsx)(r.r,{icon:g,title:o,children:(0,n.jsx)(l.U,{hideBorder:!0,children:d.map((p,u)=>(0,n.jsx)(s.o,{label:p.label,icon:p.icon,suffix:p.tabSuffix,active:p.value===c,onChangeTab:()=>a(p)},`${p.value}-${u}`))})})},71678:(k,A,e)=>{"use strict";e.d(A,{$s:()=>g,EO:()=>i,YO:()=>r,wE:()=>l});var n=e(74848),s=e(96540);const l=s.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class r extends s.Component{constructor(d){super(d),this.showModal=(c,a)=>{this.setState({component:c,props:a})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:d.component||null,props:d.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,n.jsx)(l.Provider,{value:this.state,children:this.props.children})}}const i=()=>(0,n.jsx)(l.Consumer,{children:({component:o,props:d})=>o?(0,n.jsx)(o,{...d}):null}),g=l.Consumer},88448:(k,A,e)=>{"use strict";e.d(A,{o:()=>s});var n=e(32196);const s=l=>{const r=l.shape.radius.default;return{modal:(0,n.css)({position:"fixed",zIndex:l.zIndex.modal,background:l.colors.background.primary,boxShadow:l.shadows.z3,borderRadius:r,border:`1px solid ${l.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,n.css)({position:"fixed",zIndex:l.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:l.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,n.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:l.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,n.css)({borderBottom:`1px solid ${l.colors.border.weak}`}),modalHeaderTitle:(0,n.css)({fontSize:l.typography.size.lg,margin:l.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,n.css)({marginRight:l.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,n.css)({height:"100%",display:"flex",alignItems:"center",color:l.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,n.css)({overflow:"auto",padding:l.spacing(3),width:"100%"}),modalButtonRow:(0,n.css)({paddingTop:l.spacing(3)})}}},32372:(k,A,e)=>{"use strict";e.d(A,{B:()=>v});var n=e(74848),s=e(32196),l=e(96540),r=e(96915),i=e(13544),g=e(40845),o=e(85828),d=e(19716);function c(f){for(let E=f.length-1;E>0;E--){const h=f.charAt(E);if(h==="$")return{index:E,prefix:f.substring(E)};if(h===" "||h==="	"||h==='"'||h==="'")return{index:E+1,prefix:f.substring(E+1)}}return{index:0,prefix:f}}function a(f,E,h,y){const b=[];for(const D of h)E&&!D.label.startsWith(E)||b.push({...D,kind:p(f,D.kind),range:y,insertText:D.insertText??D.label});return b}function p(f,E){switch(E){case d.q.Method:return f.languages.CompletionItemKind.Method;case d.q.Field:return f.languages.CompletionItemKind.Field;case d.q.Property:return f.languages.CompletionItemKind.Property;case d.q.Constant:return f.languages.CompletionItemKind.Constant;case d.q.Text:return f.languages.CompletionItemKind.Text}return f.languages.CompletionItemKind.Text}function u(f,E,h,y){if(!(!E||!h))return f.languages.registerCompletionItemProvider(E,{triggerCharacters:["$"],provideCompletionItems:(b,D,P)=>{if(b.id!==y)return;const C={startLineNumber:D.lineNumber,endLineNumber:D.lineNumber,startColumn:D.column,endColumn:D.column};if(P.triggerCharacter==="$")return C.startColumn=D.column-1,{suggestions:a(f,"$",h(),C)};const M=b.getValueInRange({startLineNumber:D.lineNumber,startColumn:1,endLineNumber:D.lineNumber,endColumn:D.column}),{index:I,prefix:R}=c(M);C.startColumn=I+1;const T=a(f,R,h(),C);if(T.length)return{suggestions:T}}})}class m extends l.PureComponent{constructor(E){super(E),this.loadCustomLanguage=()=>{const{language:h}=this.props,y=r.l.getIfExists(h);return y?y.init():Promise.resolve()},this.getEditorValue=()=>"",this.onBlur=()=>{const{onBlur:h}=this.props;h&&h(this.getEditorValue())},this.onFocus=()=>{const{onFocus:h}=this.props;h&&h(this.getEditorValue())},this.onSave=()=>{const{onSave:h}=this.props;h&&h(this.getEditorValue())},this.handleBeforeMount=h=>{this.monaco=h;const{onBeforeEditorMount:y}=this.props;y?.(h)},this.handleOnMount=(h,y)=>{const{getSuggestions:b,language:D,onChange:P,onEditorDidMount:C}=this.props;this.modelId=h.getModel()?.id,this.getEditorValue=()=>h.getValue(),b&&this.modelId&&(this.completionCancel=u(y,D,b,this.modelId)),h.onKeyDown(M=>{M.keyCode===y.KeyCode.KeyS&&(M.ctrlKey||M.metaKey)&&(M.preventDefault(),this.onSave())}),P&&h.getModel()?.onDidChangeContent(()=>P(h.getValue())),C&&C(h,y)}}componentWillUnmount(){this.completionCancel&&this.completionCancel.dispose(),this.props.onEditorWillUnmount?.()}componentDidUpdate(E){const{getSuggestions:h,language:y}=this.props,b=E.language!==y;if(E.getSuggestions!==h||b){if(this.completionCancel&&this.completionCancel.dispose(),!this.monaco){console.warn("Monaco instance not loaded yet");return}h&&this.modelId&&(this.completionCancel=u(this.monaco,y,h,this.modelId))}b&&this.loadCustomLanguage()}render(){const{theme:E,language:h,width:y,height:b,showMiniMap:D,showLineNumbers:P,readOnly:C,monacoOptions:M}=this.props,{alwaysConsumeMouseWheel:I,...R}=M??{},T=this.props.value??"",S=T.length>100,L=this.props.containerStyles??x(E).container,O={wordWrap:"off",tabSize:2,codeLens:!1,contextmenu:!1,minimap:{enabled:S&&D,renderCharacters:!1},readOnly:C,lineNumbersMinChars:4,lineDecorationsWidth:1*E.spacing.gridSize,overviewRulerBorder:!1,automaticLayout:!0,padding:{top:.5*E.spacing.gridSize,bottom:.5*E.spacing.gridSize},fixedOverflowWidgets:!0,scrollbar:{alwaysConsumeMouseWheel:I??!1}};return P||(O.glyphMargin=!1,O.folding=!1,O.lineNumbers="off",O.lineNumbersMinChars=0),(0,n.jsx)("div",{className:L,onFocus:this.onFocus,onBlur:this.onBlur,"data-testid":i.Tp.components.CodeEditor.container,children:(0,n.jsx)(o.m,{width:y,height:b,language:h,value:T,options:{...O,...R??{}},beforeMount:this.handleBeforeMount,onMount:this.handleOnMount,keepCurrentModel:!0})})}}const v=(0,g.cV)(m),x=f=>({container:(0,s.css)({borderRadius:f.shape.radius.default,border:`1px solid ${f.components.input.borderColor}`})})},85828:(k,A,e)=>{"use strict";e.d(A,{m:()=>c});var n=e(74848),s=e(32196),l=e(13544),r=e(40845),i=e(16817);const g=p=>{const u=(0,i.A)(async()=>await p);return{...u,dependency:u.value}};var o=e(52446),d=e(39558);const c=p=>{const u=(0,r.of)(a),{loading:m,error:v,dependency:x}=g(Promise.all([e.e(8477),e.e(6556),e.e(8926)]).then(e.bind(e,16556)));if(m)return(0,n.jsx)(d._,{text:"Loading editor",className:u.container});if(v)return(0,n.jsx)(o.D,{title:"React Monaco Editor failed to load",error:v,errorInfo:{componentStack:v?.stack??""}});const f=x.ReactMonacoEditor;return(0,n.jsx)(f,{...p,loading:p.loading??null,wrapperProps:{"data-testid":l.Tp.components.ReactMonacoEditor.editorLazy}})},a=p=>({container:(0,s.css)({marginBottom:"unset",marginLeft:p.spacing(1)})})},19716:(k,A,e)=>{"use strict";e.d(A,{q:()=>n});var n=(s=>(s.Method="method",s.Field="field",s.Property="property",s.Constant="constant",s.Text="text",s))(n||{})},99544:(k,A,e)=>{"use strict";e.d(A,{O:()=>s});var n=e(19716);function s(l){const r="${"+l.value+"}",i=l.value===l.label?l.origin:`${l.label} / ${l.origin}`;return{label:r,kind:n.q.Property,detail:i,documentation:l.documentation}}},95247:(k,A,e)=>{"use strict";e.d(A,{d:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(16797),o=e(14578),d=e(29158),c=e(50720),a=e(15068);const p=(0,l.memo)(({title:m,section:v,parent:x,pageIcon:f,onGoBack:E,children:h,titleHref:y,parentHref:b,leftItems:D,isFullscreen:P,className:C,"aria-label":M,buttonOverflowAlignment:I="right",forceShowLeftItems:R=!1})=>{const T=(0,i.of)(u),S=(0,s.cx)("page-toolbar",T.toolbar,{"page-toolbar--fullscreen":P,[T.noPageIcon]:!f},C),L=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:T.truncateText,children:m}),v&&(0,n.jsxs)("span",{className:T.pre,children:[" / ",v]})]});return(0,n.jsxs)("nav",{className:S,"aria-label":M,children:[(0,n.jsxs)("div",{className:T.leftWrapper,children:[f&&!E&&(0,n.jsx)("div",{className:T.pageIcon,children:(0,n.jsx)(o.I,{name:f,size:"lg","aria-hidden":!0})}),E&&(0,n.jsx)("div",{className:T.pageIcon,children:(0,n.jsx)(d.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":r.Tp.components.BackButton.backArrow,onClick:E})}),(0,n.jsxs)("nav",{"aria-label":"Search links",className:T.navElement,children:[x&&b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.N,{"aria-label":`Search dashboard in the ${x} folder`,className:(0,s.cx)(T.titleText,T.parentLink,T.titleLink,T.truncateText),href:b,children:[x," ",(0,n.jsx)("span",{className:T.parentIcon})]}),y&&(0,n.jsx)("span",{className:(0,s.cx)(T.titleText,T.titleDivider),"aria-hidden":!0,children:"/"})]}),(m||!!D?.length)&&(0,n.jsxs)("div",{className:T.titleWrapper,children:[m&&(0,n.jsx)("h1",{className:T.h1Styles,children:y?(0,n.jsx)(c.N,{"aria-label":"Search dashboard by name",className:(0,s.cx)(T.titleText,T.titleLink),href:y,children:L}):(0,n.jsx)("div",{className:T.titleText,children:L})}),D?.map((O,j)=>(0,n.jsx)("div",{className:(0,s.cx)(T.leftActionItem,{[T.forceShowLeftActionItems]:R}),children:O},j))]})]})]}),(0,n.jsx)(a.U,{alignment:I,children:l.Children.toArray(h).filter(Boolean)})]})});p.displayName="PageToolbar";const u=m=>{const{spacing:v,typography:x}=m,f=(0,g.getFocusStyles)(m);return{pre:(0,s.css)({whiteSpace:"pre"}),toolbar:(0,s.css)({alignItems:"center",background:m.colors.background.canvas,display:"flex",gap:m.spacing(2),justifyContent:"space-between",padding:m.spacing(1.5,2),[m.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,s.css)({[m.breakpoints.down("md")]:{paddingLeft:m.spacing(2)}}),leftWrapper:(0,s.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,s.css)({display:"none",[m.breakpoints.up("sm")]:{display:"flex",paddingRight:m.spacing(1),alignItems:"center"}}),truncateText:(0,s.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,s.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,s.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,s.css)({margin:v(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,s.css)({marginLeft:m.spacing(.5)}),titleText:(0,s.css)({display:"flex",fontSize:x.size.lg,margin:0,borderRadius:m.shape.radius.default}),titleLink:(0,s.css)({"&:focus-visible":f}),titleDivider:(0,s.css)({padding:v(0,.5,0,.5),display:"none",[m.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,s.css)({display:"none",[m.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,s.css)({display:"none",alignItems:"center",paddingRight:v(.5),[m.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,s.css)({display:"flex"})}}},19384:(k,A,e)=>{"use strict";e.d(A,{d:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(55852),g=e(14578);const o=({currentPage:c,numberOfPages:a,onNavigate:p,hideWhenSinglePage:u,showSmallVersion:m,className:v})=>{const x=(0,r.of)(d),f=m?1:8,E=(0,l.useMemo)(()=>{const h=[...new Array(a).keys()],y=a>f,b=(D,P)=>(0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(i.$n,{size:"sm",variant:P,onClick:()=>p(D),children:D})},D);return h.reduce((D,P)=>{const C=P+1,M=C===c?"primary":"secondary",I=f,R=a-f+1,T=R-I,S=C===1||C===a,L=T>-1&&c>=I&&c<=R,O=m?1:3,j=m?0:2;return y?S||c<I&&C<I||T>=0&&c>R&&C>R||T<0&&c>=I&&C>R||L&&C>=c-j&&C<=c+j?D.push(b(C,M)):(C===I&&c<I||C===R&&c>R||L&&(C===c-O||C===c+O))&&D.push((0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(g.I,{className:x.ellipsis,name:"ellipsis-v"})},C)):D.push(b(C,M)),D},[])},[c,a,p,f,m,x.ellipsis,x.item]);return u&&a<=1?null:(0,n.jsx)("div",{className:(0,s.cx)(x.container,v),children:(0,n.jsxs)("ol",{children:[(0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(i.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>p(c-1),disabled:c===1,children:(0,n.jsx)(g.I,{name:"angle-left"})})}),E,(0,n.jsx)("li",{className:x.item,children:(0,n.jsx)(i.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>p(c+1),disabled:c===a,children:(0,n.jsx)(g.I,{name:"angle-right"})})})]})})},d=()=>({container:(0,s.css)({float:"right"}),item:(0,s.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,s.css)({transform:"rotate(90deg)"})})},89963:(k,A,e)=>{"use strict";e.d(A,{I:()=>o});var n=e(74848),s=e(32196),l=e(13544),r=e(40845),i=e(14578),g=e(56034);const o=({onCancel:a,loading:p})=>{const u=window.matchMedia("(prefers-reduced-motion: reduce)").matches,m=(0,r.of)(c);return p?(0,n.jsx)(g.m,{content:"Cancel query",children:(0,n.jsx)(i.I,{className:(0,s.cx)(m.spin,{[m.clickable]:!!a}),name:u?"hourglass":"sync",size:"sm",onClick:a,"data-testid":l.Tp.components.LoadingIndicator.icon})}):null},d=(0,s.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),c=a=>({clickable:(0,s.css)({cursor:"pointer"}),spin:(0,s.css)({[a.transitions.handleMotion("no-preference")]:{animation:`${d} 3s linear infinite`}})})},79041:(k,A,e)=>{"use strict";e.d(A,{XF:()=>r,d2:()=>i,e4:()=>l});var n=e(96540),s=e(18226);const l=(0,n.createContext)({eventsScope:"global",eventBus:new s.o}),r=l.Provider,i=()=>(0,n.useContext)(l)},91052:(k,A,e)=>{"use strict";e.d(A,{NR:()=>F});var n=e(89963),s=e(74848),l=e(32196),r=e(96540),i=e(42941),g=e(49185),o=e(39070),d=e(13544),c=e(40845),a=e(16797);function p({children:U,delay:w}){const[B,K]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{window.setTimeout(()=>{K(!0)},w)},[U,w]),(0,s.jsx)(s.Fragment,{children:B?U:null})}var u=e(14578),m=e(57514),v=e(94753),x=e(56034),f=e(83122),E=e(27746);function h({menu:U,title:w,placement:B="bottom",offset:K,dragClassCancel:W,menuButtonClass:z,onOpenMenu:Y}){const X=w?d.Tp.components.Panels.Panel.menu(w):"panel-menu-button",q=(0,r.useCallback)(G=>{G&&Y&&Y()},[Y]);return(0,s.jsx)(f.m,{overlay:U,placement:B,offset:K,onVisibleChange:q,children:(0,s.jsx)(E.I,{"aria-label":`Menu for panel with ${w?`title ${w}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":X,className:(0,l.cx)(z,W)})})}function y({menu:U,title:w,dragClass:B,children:K,offset:W=-32,onOpenMenu:z}){const Y=(0,c.of)(b),X=(0,r.useRef)(null),q=d.Tp.components.Panels.Panel.HoverWidget,G=(0,r.useCallback)(H=>{X.current?.setPointerCapture(H.pointerId)},[]),te=(0,r.useCallback)(H=>{X.current?.releasePointerCapture(H.pointerId)},[]);return K===void 0||r.Children.count(K)===0?null:(0,s.jsxs)("div",{className:(0,l.cx)(Y.container,"show-on-hover"),style:{top:W},"data-testid":q.container,children:[B&&(0,s.jsx)("div",{className:(0,l.cx)(Y.square,Y.draggable,B),onPointerDown:G,onPointerUp:te,ref:X,"data-testid":q.dragIcon,children:(0,s.jsx)(u.I,{name:"expand-arrows",className:Y.draggableIcon})}),K,U&&(0,s.jsx)(h,{menu:U,title:w,placement:"bottom",menuButtonClass:Y.menuButton,onOpenMenu:z})]})}function b(U){return{container:(0,l.css)({label:"hover-container-widget",[U.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:U.colors.background.secondary,color:U.colors.text.primary,border:`1px solid ${U.colors.border.weak}`,borderRadius:U.shape.radius.default,height:U.spacing(4),boxShadow:U.shadows.z1}),square:(0,l.css)({display:"flex",justifyContent:"center",alignItems:"center",width:U.spacing(4),height:"100%"}),draggable:(0,l.css)({cursor:"move",[U.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,l.css)({background:"inherit",border:"none","&:hover":{background:U.colors.secondary.main}}),draggableIcon:(0,l.css)({transform:"rotate(45deg)",color:U.colors.text.secondary,"&:hover":{color:U.colors.text.primary}})}}var D=e(55852);const P=(0,r.forwardRef)(({className:U,children:w,href:B,onClick:K,target:W,title:z,...Y},X)=>{const q=(0,c.of)(C);return B?(0,s.jsx)("a",{ref:X,href:B,onClick:K,target:W,title:z,className:(0,l.cx)(q.linkItem,U),...Y,children:w}):K?(0,s.jsx)(D.$n,{ref:X,className:(0,l.cx)(q.item,U),variant:"secondary",fill:"text",onClick:K,children:w}):(0,s.jsx)("span",{ref:X,className:(0,l.cx)(q.item,U),...Y,children:w})});P.displayName="TitleItem";const C=U=>{const w=(0,l.css)({color:`${U.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${U.shape.radius.default}`,padding:`${U.spacing(0,1)}`,height:`${U.spacing(U.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,a.getFocusStyles)(U),zIndex:1},"&: focus:not(:focus-visible)":(0,a.getMouseFocusStyles)(U),"&:hover ":{boxShadow:`${U.shadows.z1}`,background:`${U.colors.background.secondary}`,color:`${U.colors.text.primary}`}});return{item:w,linkItem:(0,l.cx)(w,(0,l.css)({cursor:"pointer"}))}};function M({description:U,className:w}){const B=(0,c.of)(I),K=()=>{const W=typeof U=="function"?U():U;return(0,s.jsx)("div",{className:"panel-info-content markdown-html",children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:W}})})};return U!==""?(0,s.jsx)(x.m,{interactive:!0,content:K,children:(0,s.jsx)(P,{className:(0,l.cx)(w,B.description),children:(0,s.jsx)(u.I,{name:"info-circle",size:"md"})})}):null}const I=U=>({description:(0,l.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function R({message:U,onClick:w,ariaLabel:B="status"}){const K=(0,c.of)(T);return(0,s.jsx)(E.I,{className:K.buttonStyles,onClick:w,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:U||"","aria-label":B,"data-testid":d.Tp.components.Panels.Panel.status("error")})}const T=U=>{const{headerHeight:w,padding:B}=U.components.panel;return{buttonStyles:(0,l.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:U.spacing(B),width:U.spacing(w),height:U.spacing(w),borderRadius:U.shape.radius.default})}};function S({width:U,height:w,children:B,padding:K="md",title:W="",description:z="",displayMode:Y="default",titleItems:X,menu:q,dragClass:G,dragClassCancel:te,hoverHeader:H=!1,hoverHeaderOffset:se,loadingState:ne,statusMessage:le,statusMessageOnClick:_,leftItems:Q,actions:ae,onCancelQuery:oe,onOpenMenu:J,collapsible:ee=!1,collapsed:de,onToggleCollapse:xe,onFocus:re,onMouseMove:ue,onMouseEnter:Te}){const ge=(0,c.$j)(),Oe=(0,c.of)(N),Ue=(0,r.useId)(),Xe=(0,r.useId)().replace(/:/g,"_"),we=!H,[qe,We]=(0,i.A)(!0);de===void 0&&(de=!qe);const Ce="show-on-hover",je=Y==="transparent",Ke=O(ge,we),{contentStyle:_e,innerWidth:Fe,innerHeight:at}=j(K,ge,Ke,de,w,U),Ct={height:Ke,cursor:G?"move":"auto"},Dt={width:U,height:de?void 0:w},[tt,{width:ze}]=(0,g.A)();Q&&(ae=Q);const pe=typeof W=="string"?d.Tp.components.Panels.Panel.title(W):"Panel",Se=(0,s.jsxs)(s.Fragment,{children:[!ee&&W&&(0,s.jsx)("div",{className:Oe.title,children:(0,s.jsx)(v.E,{element:"h2",variant:"h6",truncate:!0,title:typeof W=="string"?W:void 0,id:Xe,children:W})}),ee&&(0,s.jsx)("div",{className:Oe.title,children:(0,s.jsx)(v.E,{element:"h2",variant:"h6",children:(0,s.jsxs)("button",{type:"button",className:Oe.clearButtonStyles,onClick:()=>{We(),xe&&xe(!de)},"aria-expanded":!de,"aria-controls":de?void 0:Ue,children:[(0,s.jsx)(u.I,{name:de?"angle-right":"angle-down","aria-hidden":!!W,"aria-label":W?void 0:"toggle collapse panel"}),(0,s.jsx)(v.E,{variant:"h6",truncate:!0,id:Xe,children:W})]})})}),(0,s.jsxs)("div",{className:(0,l.cx)(Oe.titleItems,te),"data-testid":"title-items-container",children:[(0,s.jsx)(M,{description:z,className:te}),X]}),ne===o.Gu.Streaming&&(0,s.jsx)(x.m,{content:oe?"Stop streaming":"Streaming",children:(0,s.jsx)(P,{className:te,"data-testid":"panel-streaming",onClick:oe,children:(0,s.jsx)(u.I,{name:"circle-mono",size:"md",className:Oe.streaming})})}),ne===o.Gu.Loading&&oe&&(0,s.jsx)(p,{delay:2e3,children:(0,s.jsx)(x.m,{content:"Cancel query",children:(0,s.jsx)(P,{className:(0,l.cx)(te,Oe.pointer),"data-testid":"panel-cancel-query",onClick:oe,children:(0,s.jsx)(u.I,{name:"sync-slash",size:"md"})})})}),(0,s.jsx)("div",{className:Oe.rightAligned,children:ae&&(0,s.jsx)("div",{className:Oe.rightActions,children:L(ae,fe=>fe)})})]});return(0,s.jsxs)("section",{className:(0,l.cx)(Oe.container,{[Oe.transparentContainer]:je}),style:Dt,"aria-labelledby":W?Xe:void 0,"data-testid":pe,tabIndex:0,onFocus:re,onMouseMove:ue,onMouseEnter:Te,ref:tt,children:[(0,s.jsx)("div",{className:Oe.loadingBarContainer,children:ne===o.Gu.Loading?(0,s.jsx)(m.G,{width:ze,ariaLabel:"Panel loading bar"}):null}),H&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y,{menu:q,title:typeof W=="string"?W:void 0,offset:se,dragClass:G,onOpenMenu:J,children:Se}),le&&(0,s.jsx)("div",{className:Oe.errorContainerFloating,children:(0,s.jsx)(R,{message:le,onClick:_,ariaLabel:"Panel status"})})]}),we&&(0,s.jsxs)("div",{className:(0,l.cx)(Oe.headerContainer,G),style:Ct,"data-testid":"header-container",children:[le&&(0,s.jsx)("div",{className:te,children:(0,s.jsx)(R,{message:le,onClick:_,ariaLabel:"Panel status"})}),Se,q&&(0,s.jsx)(h,{menu:q,title:typeof W=="string"?W:void 0,placement:"bottom-end",menuButtonClass:(0,l.cx)(Oe.menuItem,te,Ce),onOpenMenu:J})]}),!de&&(0,s.jsx)("div",{id:Ue,"data-testid":d.Tp.components.Panels.Panel.content,className:(0,l.cx)(Oe.content,w===void 0&&Oe.containNone),style:_e,children:typeof B=="function"?B(Fe,at):B})]})}const L=(U,w)=>{const B=r.Children.toArray(U).filter(Boolean);return B.length>0?w(B):null},O=(U,w)=>w?U.spacing.gridSize*U.components.panel.headerHeight:0,j=(U,w,B,K,W,z)=>{const Y=(U==="md"?w.components.panel.padding:0)*w.spacing.gridSize,X=Y*2,q=1*2;let G=0;z&&(G=z-X-q);let te=0;return W&&(te=W-B-X-q),K&&(te=B),{contentStyle:{padding:Y},innerWidth:G,innerHeight:te}},N=U=>{const{background:w,borderColor:B,padding:K}=U.components.panel;return{container:(0,l.css)({label:"panel-container",backgroundColor:w,border:`1px solid ${B}`,position:"relative",borderRadius:U.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,a.getFocusStyles)(U),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,l.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${B}`}}),loadingBarContainer:(0,l.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,l.css)({contain:"none"}),content:(0,l.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,l.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,l.css)({cursor:"pointer"}),streaming:(0,l.css)({label:"panel-streaming",marginRight:0,color:U.colors.success.text,"&:hover":{color:U.colors.success.text}}),title:(0,l.css)({label:"panel-title",display:"flex",padding:U.spacing(0,K),minWidth:0,"& > h2":{minWidth:0}}),items:(0,l.css)({display:"flex"}),item:(0,l.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,l.css)({visibility:"hidden"}),menuItem:(0,l.css)({label:"panel-menu",border:"none",background:U.colors.secondary.main,"&:hover":{background:U.colors.secondary.shade}}),errorContainerFloating:(0,l.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,l.css)({display:"flex",padding:U.spacing(0,K),gap:U.spacing(1)}),rightAligned:(0,l.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,l.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,l.css)({alignItems:"center",display:"flex",gap:U.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},F=S;F.LoadingIndicator=n.I,F.TitleItem=P},88895:(k,A,e)=>{"use strict";e.d(A,{B:()=>n});var n=(s=>(s.ToggleSelection="select",s.AppendToSelection="append",s))(n||{})},52494:(k,A,e)=>{"use strict";e.d(A,{_:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g,className:o,...d})=>{const c=(0,l.of)(i);return(0,n.jsx)("div",{className:(0,s.cx)(c,o),...d,children:g})},i=g=>(0,s.css)({backgroundColor:g.components.panel.background,border:`1px solid ${g.components.panel.borderColor}`,borderRadius:g.shape.radius.default})},98624:(k,A,e)=>{"use strict";e.d(A,{B:()=>r});var n=e(74848),s=e(43429),l=e(39938);const r=({status:g,color:o,...d})=>{const c=i(g);return(0,n.jsx)(l.E,{text:c.text,color:c.color,icon:c.icon,tooltip:c.tooltip,...d})};r.displayName="PluginSignatureBadge";function i(g){switch(g||(g=s.Ac.invalid),g){case s.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case s.Ac.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case s.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case s.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case s.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},17464:(k,A,e)=>{"use strict";e.d(A,{ZL:()=>g,gF:()=>o,qB:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(40961),i=e(40845);function g(p){const{children:u,className:m,root:v,forwardedRef:x}=p,f=(0,i.$j)(),E=(0,l.useRef)(null),h=v??o();return E.current||(E.current=document.createElement("div"),m&&(E.current.className=m),E.current.style.position="relative",E.current.style.zIndex=`${f.zIndex.portal}`),(0,l.useLayoutEffect)(()=>(E.current&&h.appendChild(E.current),()=>{E.current&&h.removeChild(E.current)}),[h]),r.createPortal((0,n.jsx)("div",{ref:x,children:u}),E.current)}function o(){return window.document.getElementById("grafana-portal-container")??document.body}function d(){const p=(0,i.of)(c),u=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,n.jsx)("div",{id:"grafana-portal-container",className:(0,s.cx)({[p.grafanaPortalContainer]:u})})}const c=p=>({grafanaPortalContainer:(0,s.css)({position:"fixed",top:0,width:"100%",zIndex:p.zIndex.portal})}),a=l.forwardRef((p,u)=>(0,n.jsx)(g,{...p,forwardedRef:u}));a.displayName="RefForwardingPortal"},20084:(k,A,e)=>{"use strict";e.d(A,{X:()=>P});var n=e(74848),s=e(32196),l=e(46942),r=e.n(l),i=e(2543),g=e.n(i),o=e(96540),d=e(52845),c=e(29317),a=e(13544),p=e(80903),u=e(4269),m=e(88295),v=e(74738),x=e(31589),f=e(1020),E=e(99453),h=e(40845),y=e(16797),b=e(72307);class D extends o.PureComponent{constructor(I){super(I),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(O,j)=>{const N=O.document!==this.state.value.document,F=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(O),this.setState({value:O},()=>{if(N){const U=d.A.serialize(F)!==d.A.serialize(O);U&&j&&this.runOnChangeAndRunQuery(),U&&!j&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:O}=this.props,j=d.A.serialize(this.state.value);O&&O(this.cleanText(j))},this.runOnRunQuery=()=>{const{onRunQuery:O}=this.props;O&&(O(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(O,j,N)=>{const{onBlur:F}=this.props;if(F)F();else{const U=this.lastExecutedValue?d.A.serialize(this.lastExecutedValue):"",w=d.A.serialize(j.value);U!==w&&this.runOnChangeAndRunQuery()}return N()},this.runOnChangeDebounced=(0,i.debounce)(this.runOnChange,500);const{onTypeahead:R,cleanText:T,portalOrigin:S,onWillApplySuggestion:L}=I;this.plugins=[(0,p.Pz)({onTypeahead:R,cleanText:T,portalOrigin:S,onWillApplySuggestion:L}),(0,u.U)({handler:this.runOnChangeAndRunQuery}),(0,m.O)(),(0,v.v)(),(0,x.l)(),(0,f.T)(),(0,E.s)(),...I.additionalPlugins||[]].filter(O=>O),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,b.mO)(I.query||"",I.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(I,R){const{query:T,syntax:S,syntaxLoaded:L}=this.props;if(!I.syntaxLoaded&&L&&this.editor){const j=this.editor.insertText(" ").deleteBackward(1);this.onChange(j.value,!0)}const{value:O}=this.state;T!==I.query&&T!==d.A.serialize(O)&&this.setState({value:(0,b.mO)(T||"",S)})}cleanText(I){return I.replace(/[\r]/g,"")}render(){const{disabled:I,theme:R}=this.props,T=r()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":I}),S=C(R);return(0,n.jsx)("div",{className:(0,s.cx)(T,S.wrapper),children:(0,n.jsx)("div",{className:"slate-query-field","data-testid":a.Tp.components.QueryField.container,children:(0,n.jsx)(c.KE,{ref:L=>this.editor=L,schema:b.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:L=>{this.onChange(L.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const P=(0,h.cV)(D),C=M=>{const I=(0,y.getFocusStyles)(M);return{wrapper:(0,s.css)({"&:focus-within":I})}}},11134:(k,A,e)=>{"use strict";e.d(A,{cC:()=>p,cb:()=>a});var n=e(74848),s=e(91e3),l=e(96540),r=e(70416),i=e(13544),g=e(76412),o=e(19727),d=e(9261),c=e(27746);const a=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class p extends l.PureComponent{constructor(x){super(x),this.onChangeSelect=f=>{const{onIntervalChanged:E}=this.props;E&&f.value!=null&&E(f.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=x=>x===p.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:x,intervals:f,tooltip:E,value:h,text:y,isLoading:b,noIntervalPicker:D,width:P,showAutoInterval:C}=this.props,M=h||"",I=this.getVariant(),R=m({intervals:f,showAutoInterval:C}),T=R.find(({value:K})=>K===M),S=u(p.offOption.value);let L=T||S;L.label===S.label&&(L={value:""});const O=L.ariaLabel,j=(0,g.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:O}),N=(0,g.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),F=L.value===""?N:j,U=(0,g.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),w=(0,g.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),B=L.value===""?w:U;return(0,n.jsxs)(o.e,{className:"refresh-picker",children:[(0,n.jsx)(c.I,{"aria-label":y,tooltip:E,onClick:x,variant:I,icon:b?"spinner":"sync",style:P?{width:P}:void 0,"data-testid":i.Tp.components.RefreshPicker.runButtonV2,children:y}),!D&&(0,n.jsx)(d.f,{value:L,options:R,onChange:this.onChangeSelect,variant:I,"data-testid":i.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":F,tooltip:B})]})}}function u(v){switch(v){case p.liveOption.value:return{label:(0,g.t)("refresh-picker.live-option.label","Live"),value:v,ariaLabel:(0,g.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case p.offOption.value:return{label:(0,g.t)("refresh-picker.off-option.label","Off"),value:v,ariaLabel:(0,g.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case p.autoOption.value:return{label:(0,g.t)("refresh-picker.auto-option.label",p.autoOption.label),value:v,ariaLabel:(0,g.t)("refresh-picker.auto-option.aria-label",p.autoOption.ariaLabel)}}return{label:v,value:v}}function m({intervals:v=a,showAutoInterval:x=!1}={}){const f=v.map(E=>{const h=(0,r.E9)(E),y=(0,s.a)(h);return{label:E,value:E,ariaLabel:y}});return x&&f.unshift(u(p.autoOption.value)),f.unshift(u(p.offOption.value)),f}},44522:(k,A,e)=>{"use strict";e.d(A,{I:()=>l});var n=e(96540),s=e(80997);function l({component:r,content:i,...g}){return n.createElement(r||"span",{dangerouslySetInnerHTML:{__html:s.sQ.sanitize(i)},...g})}},56286:(k,A,e)=>{"use strict";e.d(A,{L:()=>d});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(55852),g=e(90090);const o=()=>({noRadiusInput:(0,s.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,s.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),d=({label:c="Password",labelWidth:a,inputWidth:p=12,onReset:u,isConfigured:m,tooltip:v,placeholder:x="Password",interactive:f,...E})=>{const h=o();return(0,n.jsx)(g.z,{label:c,tooltip:v,interactive:f,labelWidth:a,inputEl:m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"text",className:(0,s.cx)(`gf-form-input width-${p}`,h.noRadiusInput),disabled:!0,value:"configured",...(0,l.omit)(E,"value")}),(0,n.jsx)(i.$n,{onClick:u,variant:"secondary",type:"button",children:"Reset"})]}):(0,n.jsx)("input",{type:"password",className:`gf-form-input width-${p}`,placeholder:x,...E})})};d.displayName="SecretFormField"},9226:(k,A,e)=>{"use strict";e.d(A,{L4:()=>o});var n=e(74848),s=e(55852),l=e(10354),r=e(67061);const i="configured",g="Reset",o=({isConfigured:d,onReset:c,...a})=>(0,n.jsxs)(r.B,{children:[!d&&(0,n.jsx)(l.p,{...a,type:"password"}),d&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.p,{...a,type:"text",disabled:!0,value:i}),(0,n.jsx)(s.$n,{onClick:c,variant:"secondary",children:g})]})]})},49718:(k,A,e)=>{"use strict";e.d(A,{L:()=>n.L4});var n=e(9226)},58724:(k,A,e)=>{"use strict";e.d(A,{lp:()=>p});var n=e(74848),s=e(32196),l=e(40845),r=e(55852),i=e(90613),g=e(67061),o=e(21744);const d="configured",c="Reset",a=u=>({configuredStyle:(0,s.css)({minHeight:u.spacing(u.components.height.md),paddingTop:u.spacing(.5),resize:"none"})}),p=({isConfigured:u,onReset:m,...v})=>{const x=(0,l.of)(a);return(0,n.jsxs)(g.B,{children:[(0,n.jsxs)(i.a,{children:[!u&&(0,n.jsx)(o.f,{...v}),u&&(0,n.jsx)(o.f,{...v,rows:1,disabled:!0,value:d,className:(0,s.cx)(x.configuredStyle)})]}),u&&(0,n.jsx)(r.$n,{onClick:m,variant:"secondary",children:c})]})}},7968:(k,A,e)=>{"use strict";e.d(A,{l:()=>n.lp});var n=e(58724)},38401:(k,A,e)=>{"use strict";e.d(A,{Y:()=>a});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(40845),g=e(76892),o=e(13102),d=e(86997),c=e(2336);function a({options:p,value:u,onChange:m,Component:v,className:x,allowCustomValue:f,allowEmptyValue:E,placeholder:h,disabled:y,inputMinWidth:b,inputPlaceholder:D,onExpandedChange:P,autofocus:C=!1,...M}){const[I,R,T,S]=(0,c.Q)(C,P),L=b?Math.max(b,R):R,O=(0,i.of)(d.m);if(!T){const j=(0,l.isObject)(u)?u.label:u,N=j!=null?String(j):void 0;return(0,n.jsx)(I,{disabled:y,Component:v||(0,n.jsx)(g.c,{className:(0,s.cx)(O.segment,{[O.queryPlaceholder]:h!==void 0&&!u,[O.disabled]:y},x),children:N||h})})}return(0,n.jsx)(o.a,{...M,value:u&&!(0,l.isObject)(u)?{value:u}:u,placeholder:D,options:p,width:L,onClickOutside:()=>S(!1),allowCustomValue:f,allowEmptyValue:E,onChange:j=>{S(!1),m(j)}})}},83684:(k,A,e)=>{"use strict";e.d(A,{s:()=>u});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(41053),g=e(40845),o=e(76412),d=e(76892),c=e(13102),a=e(86997),p=e(2336);function u({value:v,onChange:x,loadOptions:f,reloadOptionsOnChange:E=!1,Component:h,className:y,allowCustomValue:b,allowEmptyValue:D,disabled:P,placeholder:C,inputMinWidth:M,inputPlaceholder:I,autofocus:R=!1,onExpandedChange:T,noOptionMessageHandler:S=m,...L}){const[O,j]=(0,i.A)(f,[f]),[N,F,U,w]=(0,p.Q)(R,T),B=M?Math.max(M,F):F,K=(0,g.of)(a.m);if(!U){const W=(0,l.isObject)(v)?v.label:v,z=W!=null?String(W):void 0;return(0,n.jsx)(N,{onClick:E?void 0:j,disabled:P,Component:h||(0,n.jsx)(d.c,{className:(0,s.cx)(K.segment,{[K.queryPlaceholder]:C!==void 0&&!v,[K.disabled]:P},y),children:z||C})})}return(0,n.jsx)(c.a,{...L,value:v&&!(0,l.isObject)(v)?{value:v}:v,placeholder:I,options:O.value??[],loadOptions:E?j:void 0,width:B,noOptionsMessage:S(O),allowCustomValue:b,allowEmptyValue:D,onClickOutside:()=>{w(!1)},onChange:W=>{w(!1),x(W)}})}function m(v){return v.loading?(0,o.t)("grafana-ui.segment-async.loading","Loading options..."):v.error?(0,o.t)("grafana-ui.segment-async.error","Failed to load options"):(0,o.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(k,A,e)=>{"use strict";e.d(A,{o:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(37151),i=e(40845),g=e(29413),o=e(76892),d=e(86997),c=e(2336);const a=14;function p({value:u,onChange:m,Component:v,className:x,placeholder:f,inputPlaceholder:E,disabled:h,autofocus:y=!1,onExpandedChange:b,...D}){const P=(0,l.useRef)(null),[C,M]=(0,l.useState)(u),[I,R]=(0,l.useState)((0,g.kD)((u||"").toString(),a).width),[T,,S,L]=(0,c.Q)(y,b),O=(0,i.of)(d.m);if((0,r.A)(P,()=>{L(!1),m(C)}),!S)return(0,n.jsx)(T,{disabled:h,Component:v||(0,n.jsx)(o.c,{className:(0,s.cx)(O.segment,{[O.queryPlaceholder]:f!==void 0&&!C,[O.disabled]:h},x),children:u||f})});const j=(0,s.css)({width:`${Math.max(I+20,32)}px`});return(0,n.jsx)("input",{...D,ref:P,autoFocus:!0,className:(0,s.cx)("gf-form gf-form-input",j),value:C,placeholder:E,onChange:N=>{const{width:F}=(0,g.kD)(N.target.value,a);R(F),M(N.target.value)},onBlur:()=>{L(!1),m(C)},onKeyDown:N=>{[13,27].includes(N.keyCode)&&(L(!1),m(C))}})}},64765:(k,A,e)=>{"use strict";e.d(A,{L:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(39268),i=e(76892);const g=({label:d,htmlFor:c,children:a,fill:p})=>{const u=(0,l.of)(o);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(r.C,{children:[(0,n.jsx)(i.c,{htmlFor:c,width:12,className:u.label,children:d}),a,p&&(0,n.jsx)("div",{className:u.fill,children:(0,n.jsx)(i.c,{children:""})})]})})},o=d=>({label:(0,s.css)({color:d.colors.primary.text}),fill:(0,s.css)({flexGrow:1,marginBottom:d.spacing(.5)})})},13102:(k,A,e)=>{"use strict";e.d(A,{a:()=>i});var n=e(74848),s=e(96540),l=e(40845),r=e(90182);function i({value:g,placeholder:o="",options:d=[],onChange:c,onClickOutside:a,loadOptions:p=void 0,width:u,noOptionsMessage:m="",allowCustomValue:v=!1,allowEmptyValue:x=!1,...f}){const E=(0,s.useRef)(null),h=(0,l.$j)();let y=u>0?u/h.spacing.gridSize:void 0,b,D={};return p?(b=r.DW,D={loadOptions:p,defaultOptions:!0}):b=r.l6,(0,n.jsx)("div",{...f,ref:E,children:(0,n.jsx)(b,{width:y,noOptionsMessage:m,placeholder:o,autoFocus:!0,isOpen:!0,onChange:c,options:d,value:g,closeMenuOnSelect:!1,onCloseMenu:()=>{if(E&&E.current){const P=E.current.querySelector('input[id^="react-select-"]');P&&(P.value||x)?c({value:P.value,label:P.value}):a()}},allowCustomValue:v,...D})})}},86997:(k,A,e)=>{"use strict";e.d(A,{m:()=>s});var n=e(32196);const s=l=>{const r="v1"in l?l.v1.palette:l.palette;return{segment:(0,n.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,n.css)({color:r.gray2}),disabled:(0,n.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(k,A,e)=>{"use strict";e.d(A,{Q:()=>i});var n=e(74848),s=e(96540),l=e(40845),r=e(55852);const i=(g,o)=>{const d=(0,s.useRef)(null),c=(0,l.of)(r.my),[a,p]=(0,s.useState)(g),[u,m]=(0,s.useState)(0),v=f=>{p(f),o&&o(f)};return[({Component:f,onClick:E,disabled:h})=>(0,n.jsx)("button",{type:"button",className:c,ref:d,disabled:h,onClick:()=>{v(!0),d&&d.current&&m(d.current.clientWidth*1.25),E?.()},children:f}),u,a,v]}},5342:(k,A,e)=>{"use strict";e.d(A,{O:()=>i,p:()=>g});var n=e(74848),s=e(40845),l=e(29158),r=e(88824);const i=({innerProps:o,children:d})=>{const c=(0,s.$j)(),a=(0,r.J)(c);return(0,n.jsx)("div",{...o,className:a.multiValueContainer,children:d})},g=({children:o,innerProps:d})=>{const c=(0,s.$j)(),a=(0,r.J)(c);return(0,n.jsx)(l.K,{...d,name:"times",size:"sm",className:a.multiValueRemove,tooltip:"Remove"})}},90182:(k,A,e)=>{"use strict";e.d(A,{Iv:()=>H,DW:()=>q,gZ:()=>te,KF:()=>X,l6:()=>Y,KA:()=>P.K,ip:()=>G});var n=e(74848),s=e(72635),l=e(96540),r=e(46005),i=e(8539),g=e(93943),o=e(66963),d=e(50877),c=e(40845),a=e(14578),p=e(62930),u=e(28581);const m=se=>{let ne;return"data-testid"in se.selectProps&&se.selectProps["data-testid"]&&(ne=se.selectProps["data-testid"]+"-input"),(0,n.jsx)(u.c.Input,{...se,"data-testid":ne})};function v({selectProps:se}){const ne=se.menuIsOpen,le=ne?"search":"angle-down",_=ne?"sm":"md";return(0,n.jsx)(a.I,{name:le,size:_})}var x=e(32196),f=e(10354);const E=(0,l.forwardRef)((se,ne)=>{const{children:le}=se,_=(0,c.$j)(),Q=(0,f.n)({theme:_,invalid:!1});return(0,n.jsx)("div",{className:(0,x.cx)(Q.suffix,(0,x.css)({position:"relative"})),ref:ne,children:le})});E.displayName="IndicatorsContainer";var h=e(87266);const y=(0,l.forwardRef)(function({focused:ne,invalid:le,disabled:_,children:Q,innerProps:ae,prefix:oe,...J},ee){const de=(0,c.of)(b,le,!!oe);return(0,n.jsxs)("div",{className:de.input,...ae,ref:ee,children:[oe&&(0,n.jsx)("div",{className:(0,x.cx)(de.prefix),children:oe}),Q]})}),b=(se,ne,le)=>{const _=(0,f.n)({theme:se,invalid:ne});return{input:(0,x.cx)((0,h.g$)(se),(0,x.css)({width:"100%",maxWidth:"100%",display:"flex",flexDirection:"row",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between",paddingRight:0,position:"relative",boxSizing:"border-box"}),le&&(0,x.css)({paddingLeft:0})),prefix:(0,x.cx)(_.prefix,(0,x.css)({position:"relative"}))}};var D=e(5342),P=e(4603),C=e(12681),M=e(88824);const I=({children:se,cx:ne,getClassNames:le,getStyles:_,Heading:Q,headingProps:ae,label:oe,selectProps:J,theme:ee})=>{const de=(0,c.of)(M.J);return(0,n.jsxs)("div",{className:de.group,children:[(0,n.jsx)(Q,{cx:ne,getClassNames:le,getStyles:_,selectProps:J,theme:ee,...ae,children:oe}),se]})};var R=e(94753);const T=se=>{const ne=(0,c.of)(M.J);return(0,n.jsx)("div",{className:ne.groupHeader,children:(0,n.jsx)(R.E,{weight:"bold",variant:"bodySmall",color:"secondary",children:se.children??""})})};var S=e(62235);class L extends l.Component{render(){const{children:ne}=this.props,{selectProps:le}=this.props;if(le&&Array.isArray(ne)&&Array.isArray(ne[0])&&le.maxVisibleValues!==void 0&&!(le.showAllSelectedWhenOpen&&le.menuIsOpen)){const[_,...Q]=ne,ae=_.slice(0,le.maxVisibleValues);return this.renderContainer([ae,...Q])}return this.renderContainer(ne)}renderContainer(ne){const{isMulti:le,theme:_,selectProps:Q}=this.props,ae=this.props.selectProps?.noMultiValueWrap&&!this.props.selectProps?.menuIsOpen,oe=(0,M.J)(_),J=Q["data-testid"],ee=(0,x.cx)(oe.valueContainer,{[oe.valueContainerMulti]:le&&!ae,[oe.valueContainerMultiNoWrap]:le&&ae});return(0,n.jsx)("div",{"data-testid":J,className:ee,children:ne})}}const O=(0,c.cV)(L);var j=e(23731);const N=(se,ne)=>{if(Array.isArray(se)){const le=se.filter(Boolean);return le?.length?le:void 0}if(typeof se=="object")return[se];if(typeof se=="string"||typeof se=="number"){const le=F(se,ne);if(le)return[le]}},F=(se,ne)=>{for(const le of ne)if("options"in le){let _=F(se,le.options);if(_)return _}else if("value"in le&&le.value===se)return le;return null},U=se=>se.map(({description:ne,...le})=>le),w=se=>{const{children:ne,innerProps:le,selectProps:{menuIsOpen:_,onMenuClose:Q,onMenuOpen:ae},isFocused:oe,isMulti:J,getValue:ee,innerRef:de}=se,xe=se.selectProps;return xe.renderControl?l.createElement(xe.renderControl,{isOpen:_,value:J?ee():ee()[0],ref:de,onClick:_?Q:ae,onBlur:Q,disabled:!!xe.disabled,invalid:!!xe.invalid}):(0,n.jsx)(y,{ref:de,innerProps:le,prefix:xe.prefix,focused:oe,invalid:!!xe.invalid,disabled:!!xe.disabled,children:ne})};function B({allowCustomValue:se=!1,allowCreateWhileLoading:ne=!1,"aria-label":le,"data-testid":_,autoFocus:Q=!1,backspaceRemovesValue:ae=!0,blurInputOnSelect:oe,cacheOptions:J,className:ee,closeMenuOnSelect:de=!0,components:xe,createOptionPosition:re="last",defaultOptions:ue,defaultValue:Te,disabled:ge=!1,filterOption:Oe,formatCreateLabel:Ue,getOptionLabel:Xe,getOptionValue:we,inputValue:qe,invalid:We,isClearable:Ce=!1,id:je,isLoading:Ke=!1,isMulti:_e=!1,inputId:Fe,isOpen:at,isOptionDisabled:Ct,isSearchable:Dt=!0,loadOptions:tt,loadingMessage:ze="Loading options...",maxMenuHeight:pe=300,minMenuHeight:Se,maxVisibleValues:fe,menuPlacement:Ee="auto",menuPosition:Pe,menuShouldPortal:he=!0,noOptionsMessage:be=(0,s.t)("grafana-ui.select.no-options-label","No options found"),onBlur:Ae,onChange:De,onCloseMenu:Ie,onCreateOption:ke,onInputChange:dt,onKeyDown:Pt,onMenuScrollToBottom:pt,onMenuScrollToTop:Tt,onOpenMenu:jt,onFocus:$t,openMenuOnFocus:sn=!1,options:Yt=[],placeholder:qt=(0,s.t)("grafana-ui.select.placeholder","Choose"),prefix:bn,renderControl:Mt,showAllSelectedWhenOpen:Jt=!0,tabSelectsValue:Ut=!0,value:Gt,virtualized:Lt=!1,noMultiValueWrap:At,width:Nt,isValidNewOption:Dn,formatOptionLabel:An,hideSelectedOptions:Pn,...Xn}){const Tn=(0,c.$j)(),ht=(0,M.J)(Tn),St=(0,l.useRef)(null),[Ge,Ve]=(0,l.useState)(!1),lt=(0,j.z)(Tn,Nt),[It,Qe]=(0,l.useState)(!!qe);(0,l.useEffect)(()=>{if(tt&&at&&St.current&&St.current.controlRef&&Ee==="auto"){const Un=window.innerHeight-St.current.controlRef.getBoundingClientRect().bottom;Ve(Un<pe)}},[pe,Ee,tt,at]);const vt=(0,l.useCallback)((Un,cs)=>{if(_e&&Un==null)return De([],cs);De(Un,cs)},[_e,De]);let Ot=r.Ay;const zt={};let vn={},ln;if(_e&&tt)ln=Gt;else if(_e&&Gt&&Array.isArray(Gt)&&!tt)ln=Gt.map(Un=>{const cs=F(Un.value??Un,Yt);return cs||(typeof Un=="string"?(0,d.z)(Un):Un)});else if(tt){const Un=Te||Gt;ln=Un?[Un]:[]}else ln=N(Gt,Yt);const On={"aria-label":le,"data-testid":_,autoFocus:Q,backspaceRemovesValue:ae,blurInputOnSelect:oe,captureMenuScroll:pt||Tt,closeMenuOnSelect:de,defaultValue:Te,disabled:ge,filterOption:It?Oe:null,getOptionLabel:Xe,getOptionValue:we,hideSelectedOptions:Pn,inputValue:qe,invalid:We,isClearable:Ce,id:je,isDisabled:ge,isLoading:Ke,isMulti:_e,inputId:Fe,isOptionDisabled:Ct,isSearchable:Dt,maxMenuHeight:pe,minMenuHeight:Se,maxVisibleValues:fe,menuIsOpen:at,menuPlacement:Ee==="auto"&&Ge?"top":Ee,menuPosition:Pe,menuShouldBlockScroll:!0,menuPortalTarget:he&&typeof document<"u"?document.body:void 0,menuShouldScrollIntoView:!1,onBlur:Ae,onChange:vt,onInputChange:(Un,cs)=>{const Zn=dt?.(Un,cs)??Un,wt=!!Zn;return wt!==It&&Qe(wt),Zn},onKeyDown:Pt,onMenuClose:Ie,onMenuOpen:jt,onMenuScrollToBottom:pt,onMenuScrollToTop:Tt,onFocus:$t,formatOptionLabel:An,openMenuOnFocus:sn,options:Lt?U(Yt):Yt,placeholder:qt,prefix:bn,renderControl:Mt,showAllSelectedWhenOpen:Jt,tabSelectsValue:Ut,value:_e?ln:ln?.[0],noMultiValueWrap:At};se&&(Ot=o.A,zt.allowCreateWhileLoading=ne,zt.formatCreateLabel=Ue??K,zt.onCreateOption=ke,zt.createOptionPosition=re,zt.isValidNewOption=Dn),tt&&(Ot=se?g.A:i.A,vn={loadOptions:tt,cacheOptions:J,defaultOptions:ue});const wn=Lt?C.zd:C.eB;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Ot,{ref:St,components:{MenuList:wn,Group:I,GroupHeading:T,ValueContainer:O,IndicatorsContainer:W,IndicatorSeparator:z,Control:w,Option:C.o5,ClearIndicator(Un){const{clearValue:cs}=Un;return(0,n.jsx)(a.I,{name:"times",role:"button","aria-label":"select-clear-value",className:ht.singleValueRemove,onMouseDown:Zn=>{Zn.preventDefault(),Zn.stopPropagation(),cs()}})},LoadingIndicator(){return(0,n.jsx)(p.y,{inline:!0})},LoadingMessage(){return(0,n.jsx)("div",{className:ht.loadingMessage,children:ze})},NoOptionsMessage(){return(0,n.jsx)("div",{className:ht.loadingMessage,"aria-label":"No options provided",children:be})},DropdownIndicator:v,SingleValue(Un){return(0,n.jsx)(S.K,{...Un,isDisabled:ge})},SelectContainer:P.K,MultiValueContainer:D.O,MultiValueRemove:ge?()=>null:D.p,Input:m,...xe},styles:lt,className:ee,...On,...zt,...vn,...Xn})})}function K(se){return(0,n.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,n.jsx)("div",{children:se}),(0,n.jsx)("div",{style:{flexGrow:1}}),(0,n.jsx)("div",{className:"muted small",style:{display:"flex",gap:"8px",alignItems:"center"},children:"Hit enter to add"})]})}function W(se){const{showAllSelectedWhenOpen:ne,maxVisibleValues:le,menuIsOpen:_}=se.selectProps,Q=se.getValue();if(le!==void 0&&Array.isArray(se.children)){const ae=Q.length;if(ae>le&&!(ne&&_)){const oe=[...se.children];return oe.splice(-1,0,(0,n.jsxs)("span",{id:"excess-values",children:["(+",ae-le,")"]},"excess-values")),(0,n.jsx)(E,{...se,children:oe})}}return(0,n.jsx)(E,{...se})}function z(){return(0,n.jsx)(n.Fragment,{})}function Y(se){return(0,n.jsx)(B,{...se})}function X(se){return(0,n.jsx)(B,{...se,isMulti:!0})}function q(se){return(0,n.jsx)(B,{...se})}function G(se){return(0,n.jsx)(B,{virtualized:!0,...se})}function te(se){return(0,n.jsx)(B,{virtualized:!0,...se})}function H(se){return(0,n.jsx)(B,{...se,isMulti:!0})}},4603:(k,A,e)=>{"use strict";e.d(A,{K:()=>d});var n=e(74848),s=e(32196),l=e(28581),r=e(40845),i=e(16797),g=e(87266),o=e(10354);const d=a=>{const{isDisabled:p,isFocused:u,children:m,selectProps:{invalid:v=!1}}=a,x=(0,r.of)(c,u,p,v);return(0,n.jsx)(l.c.SelectContainer,{...a,className:(0,s.cx)(x.wrapper,a.className),children:m})},c=(a,p,u,m)=>{const v=(0,o.n)({theme:a,invalid:m});return{wrapper:(0,s.cx)(v.wrapper,(0,g.Xb)(a,m),p&&(0,s.css)((0,i.getFocusStyles)(a)),u&&v.inputDisabled,(0,s.css)({position:"relative",boxSizing:"border-box",flexDirection:"row",flexWrap:"wrap",alignItems:"stretch",justifyContent:"space-between",minHeight:"32px",height:"auto",maxWidth:"100%",padding:0,cursor:u?"not-allowed":"pointer"}))}}},12681:(k,A,e)=>{"use strict";e.d(A,{eB:()=>m,o5:()=>b,zd:()=>h});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(91793),o=e(8887),d=e(13544),c=e(40845),a=e(40276),p=e(14578),u=e(88824);const m=({children:D,maxHeight:P,innerRef:C,innerProps:M})=>{const I=(0,c.$j)(),R=(0,u.J)(I);return(0,n.jsx)("div",{...M,className:R.menu,style:{maxHeight:P},"aria-label":"Select options menu",children:(0,n.jsx)(a.E,{scrollRefCallback:C,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,children:D})})};m.displayName="SelectMenu";const v=37,x=8,f=8,E=36,h=({children:D,maxHeight:P,innerRef:C,options:M,focusedOption:I})=>{const R=(0,c.$j)(),T=(0,u.J)(R),S=(0,i.useRef)(null),L=(0,i.useMemo)(()=>M.flatMap(w=>w.options?[w,...w.options]:[w]),[M]),O=L.findIndex(w=>w.value===I?.value);if((0,i.useLayoutEffect)(()=>{S.current?.scrollToItem(O)},[O]),!Array.isArray(D))return null;const j=D.flatMap((w,B)=>y(w)?[i.cloneElement(w,{children:null}),...w.props.children.slice(0,-1),i.cloneElement(w.props.children.at(-1),{innerProps:{style:{borderBottom:`1px solid ${R.colors.border.weak}`,height:v}}})]:[w]),F=((0,l.max)(L.map(w=>w.label?.length))??0)*x+f*2+E,U=Math.min(j.length*v,P);return(0,n.jsx)(g.Y1,{outerRef:C,ref:S,className:T.menu,height:U,width:F,"aria-label":"Select options menu",itemCount:j.length,itemSize:v,children:({index:w,style:B})=>(0,n.jsx)("div",{style:{...B,overflow:"hidden"},children:j[w]})})},y=D=>i.isValidElement(D)&&Array.isArray(D.props.children);h.displayName="VirtualizedSelectMenu";const b=({children:D,data:P,innerProps:C,innerRef:M,isFocused:I,isSelected:R,renderOptionLabel:T})=>{const S=(0,c.$j)(),L=(0,u.J)(S),O=P.icon?(0,o.Uo)(P.icon):void 0,{onMouseMove:j,onMouseOver:N,...F}=C;return(0,n.jsxs)("div",{ref:M,className:(0,s.cx)(L.option,I&&L.optionFocused,R&&L.optionSelected,P.isDisabled&&L.optionDisabled),...F,"data-testid":d.Tp.components.Select.option,title:P.title,children:[O&&(0,n.jsx)(p.I,{name:O,className:L.optionIcon}),P.imgUrl&&(0,n.jsx)("img",{className:L.optionImage,src:P.imgUrl,alt:P.label||String(P.value)}),(0,n.jsxs)("div",{className:L.optionBody,children:[(0,n.jsx)("span",{children:T?T(P):D}),P.description&&(0,n.jsx)("div",{className:L.optionDescription,children:P.description}),P.component&&(0,n.jsx)(P.component,{})]})]})};b.displayName="SelectMenuOptions"},62235:(k,A,e)=>{"use strict";e.d(A,{K:()=>m});var n=e(74848),s=e(32196),l=e(28581),r=e(8887),i=e(40845),g=e(96540);function o(x,f={}){const{duration:E=250,delay:h=250}=f,[y,b]=(0,g.useState)(x),D=(0,g.useRef)();return(0,g.useEffect)(()=>{let P;if(x)P=setTimeout(()=>{D.current=new Date,b(x)},h);else{const C=D.current?Date.now()-D.current.valueOf():0,M=()=>{D.current=void 0,b(x)};C>=E?M():P=setTimeout(M,E-C)}return()=>{P&&(clearTimeout(P),P=void 0)}},[x,E,h]),y}var d=e(14578),c=e(62930),a=e(31511),p=e(72960);const u=x=>({singleValue:(0,s.css)({label:"singleValue",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%",gridArea:"1 / 1 / 2 / 3"}),spinnerWrapper:(0,s.css)({width:"16px",height:"16px",display:"inline-block",marginRight:"10px",position:"relative",verticalAlign:"middle",overflow:"hidden"}),spinnerIcon:(0,s.css)({width:"100%",height:"100%",position:"absolute"}),optionIcon:(0,s.css)({marginRight:x.spacing(1),color:x.colors.text.secondary}),disabled:(0,s.css)({color:x.colors.text.disabled}),isOpen:(0,s.css)({color:x.colors.text.disabled})}),m=x=>{const{children:f,data:E,isDisabled:h}=x,y=(0,i.of)(u),b=o(E.loading||!1,{delay:250,duration:750}),D=E.icon?(0,r.Uo)(E.icon):void 0;return(0,n.jsxs)(l.c.SingleValue,{...x,className:(0,s.cx)(y.singleValue,h&&y.disabled,x.selectProps.menuIsOpen&&y.isOpen),children:[E.imgUrl?(0,n.jsx)(v,{loading:b,imgUrl:E.imgUrl,styles:y,alt:String(E.label??E.value)}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.n,{horizontal:!0,size:16,visible:b,duration:150,children:(0,n.jsx)("div",{className:y.spinnerWrapper,children:(0,n.jsx)(c.y,{className:y.spinnerIcon,inline:!0})})}),D&&(0,n.jsx)(d.I,{name:D,role:"img",className:y.optionIcon})]}),!E.hideText&&f]})},v=x=>(0,n.jsxs)("div",{className:x.styles.spinnerWrapper,children:[(0,n.jsx)(a.A,{duration:150,visible:x.loading,children:(0,n.jsx)(c.y,{className:x.styles.spinnerIcon,inline:!0})}),(0,n.jsx)(a.A,{duration:150,visible:!x.loading,children:(0,n.jsx)("img",{className:x.styles.spinnerIcon,src:x.imgUrl,alt:x.alt})})]})},88824:(k,A,e)=>{"use strict";e.d(A,{J:()=>l});var n=e(32196),s=e(3911);const l=(0,s.N)(r=>({menu:(0,n.css)({label:"grafana-select-menu",background:r.components.dropdown.background,boxShadow:r.shadows.z3,position:"relative",minWidth:"100%",zIndex:1}),option:(0,n.css)({label:"grafana-select-option",padding:"8px",position:"relative",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:r.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}}),optionIcon:(0,n.css)({marginRight:r.spacing(1)}),optionImage:(0,n.css)({label:"grafana-select-option-image",width:"16px",marginRight:"10px"}),optionDescription:(0,n.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:r.typography.size.sm,color:r.colors.text.secondary,whiteSpace:"normal",lineHeight:r.typography.body.lineHeight}),optionBody:(0,n.css)({label:"grafana-select-option-body",display:"flex",fontWeight:r.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),optionFocused:(0,n.css)({label:"grafana-select-option-focused",background:r.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${r.colors.primary.border}`}}),optionSelected:(0,n.css)({background:r.colors.action.selected,"&::before":{backgroundImage:r.colors.gradients.brandVertical,borderRadius:r.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:r.spacing(.5),left:0}}),optionDisabled:(0,n.css)({label:"grafana-select-option-disabled",backgroundColor:r.colors.action.disabledBackground,color:r.colors.action.disabledText,cursor:"not-allowed"}),singleValue:(0,n.css)({label:"grafana-select-single-value",color:r.components.input.text,gridArea:"1 / 1 / 2 / 3",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",boxSizing:"border-box",maxWidth:"100%"}),valueContainer:(0,n.css)({label:"grafana-select-value-container",alignItems:"center",display:"grid",position:"relative",boxSizing:"border-box",flex:"1 1 0%",outline:"none",overflow:"hidden"}),valueContainerMulti:(0,n.css)({label:"grafana-select-value-container-multi",flexWrap:"wrap",display:"flex"}),valueContainerMultiNoWrap:(0,n.css)({display:"grid",gridAutoFlow:"column"}),loadingMessage:(0,n.css)({label:"grafana-select-loading-message",padding:r.spacing(1),textAlign:"center",width:"100%"}),multiValueContainer:(0,n.css)({label:"grafana-select-multi-value-container",display:"flex",alignItems:"center",lineHeight:1,background:r.colors.background.secondary,borderRadius:r.shape.radius.default,margin:r.spacing(.25,1,.25,0),padding:r.spacing(.25,0,.25,1),color:r.colors.text.primary,fontSize:r.typography.size.sm,overflow:"hidden",whiteSpace:"nowrap","&:hover":{background:r.colors.emphasize(r.colors.background.secondary)}}),multiValueRemove:(0,n.css)({label:"grafana-select-multi-value-remove",margin:r.spacing(0,.5),cursor:"pointer",svg:{marginBottom:0}}),singleValueRemove:(0,n.css)({cursor:"pointer","&:hover":{color:r.colors.text.primary}}),groupHeader:(0,n.css)({padding:r.spacing(1,1,1,.75),borderLeft:"2px solid transparent"}),group:(0,n.css)({"&:not(:first-child)":{borderTop:`1px solid ${r.colors.border.weak}`},':has(+ [role="option"])':{borderBottom:`1px solid ${r.colors.border.weak}`}})}))},23731:(k,A,e)=>{"use strict";e.d(A,{A:()=>s,z:()=>l});var n=e(96540);function s(r){return{clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:function(i){return{...i,color:"inherit",margin:0,padding:0,zIndex:1,overflow:"hidden"}},loadingIndicator:()=>({}),loadingMessage:()=>({}),menu:()=>({}),menuList:({maxHeight:i})=>({maxHeight:i}),multiValue:()=>({}),multiValueLabel:()=>({overflow:"hidden",textOverflow:"ellipsis"}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:i=>({...i,color:r.colors.text.secondary}),singleValue:()=>({}),valueContainer:()=>({})}}function l(r,i){return(0,n.useMemo)(()=>({...s(r),menuPortal:g=>({...g,zIndex:r.zIndex.portal}),menu:({top:g,bottom:o,position:d})=>({top:g,bottom:o,position:d,minWidth:"100%",zIndex:r.zIndex.dropdown}),container:()=>({width:i?r.spacing(i):"100%",display:i==="auto"?"inline-flex":"flex"}),option:(g,o)=>({...g,opacity:o.isDisabled?.5:1})}),[r,i])}},62883:()=>{"use strict"},67570:(k,A,e)=>{"use strict";e.d(A,{u:()=>m});var n=e(2543),s=e.n(n),l=e(96540),r=e(13752),i=e(62467),g=e(11150),o=e(96083),d=e(63720),c=e(59099),a=e(54479),p=e(11134);function u(v){return{label:v,value:stringToMs(v)}}class m extends l.PureComponent{constructor(x){super(x),this.propsSubject=new r.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,d.n)(x=>p.cC.isLive(x.interval)?(0,i.of)({}):x.loading?g.t:(0,o.Y)((0,a.dc)(x.interval))),(0,c.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(x){p.cC.isLive(x.interval)&&p.cC.isLive(this.props.interval)||(0,n.isEqual)(x,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(k,A,e)=>{"use strict";e.d(A,{I1:()=>E,_$:()=>m,gl:()=>p});var n=e(2543),s=e.n(n),l=e(75059),r=e(47070),i=e(50082),g=e(62398),o=e(24293),d=e(90708),c=e(47737);const a=["reduceOptions","orientation"];function p(h,y,b){let D=h.options;if(h.fieldConfig=h.fieldConfig||{defaults:{},overrides:[]},y==="singlestat"&&b.angular)return u(h,b);for(const P of a)b.hasOwnProperty(P)&&(D[P]=(0,n.cloneDeep)(b[P]));return D}function u(h,y){const b=y.angular,D=l.AS.getIfExists(b.valueName),P={reduceOptions:{calcs:[D?D.id:l.gy.mean]},orientation:r.wV.Horizontal},C={};if(b.format&&(C.unit=b.format),b.tableColumn&&(P.reduceOptions.fields=`/^${b.tableColumn}$/`),b.nullPointMode&&(C.nullValueMode=b.nullPointMode),b.nullText&&(C.noValue=b.nullText),(b.decimals||b.decimals===0)&&(C.decimals=b.decimals),b.thresholds&&b.colors){const I=b.thresholds.split(",").map(T=>Number(T.trim())),R=[];for(const T of b.colors){const S=R.length-1;S>=0?R.push({value:I[S],color:T}):R.push({value:-1/0,color:T})}C.thresholds={mode:i.O.Absolute,steps:R}}const M=(0,g.bh)(b,C.thresholds);return M&&M.length&&(C.mappings=M),b.gauge&&b.gauge.show&&(C.min=b.gauge.minValue,C.max=b.gauge.maxValue),h.fieldConfig.defaults=C,P}function m(h){if(!h.options)return{};const y=parseFloat(h.pluginVersion||"6.1");let b=h.options;y<6.2&&(b=x(b)),y<6.3&&(b=v(b));const{fieldOptions:D}=b;if(y<6.6&&D){if(D&&D.override){const{override:M,...I}=b.fieldOptions;b={...b,fieldOptions:{...I,overrides:[]}}}let P=D?.defaults?.thresholds;P?delete D.defaults.thresholds:(P=D?.thresholds,delete D.thresholds),P&&(D.defaults.thresholds={mode:i.O.Absolute,steps:P});const{defaults:C}=D;C.color&&typeof C.color=="string"&&(C.color={mode:o.Y.Fixed,fixedColor:C.color}),(0,d.BF)(C)}if(y<7&&(h.fieldConfig=h.fieldConfig||{defaults:{},overrides:[]},h.fieldConfig={defaults:D&&D.defaults?{...h.fieldConfig.defaults,...D.defaults}:h.fieldConfig.defaults,overrides:D&&D.overrides?[...h.fieldConfig.overrides,...D.overrides]:h.fieldConfig.overrides},D&&(b.reduceOptions={values:D.values,limit:D.limit,calcs:D.calcs}),delete b.fieldOptions),y<7.1){const P=h.fieldConfig.defaults.title;P!=null&&(h.fieldConfig.defaults.displayName=P,delete h.fieldConfig.defaults.title)}if(y<8){const P=h.fieldConfig?.defaults;let C=P?.unit;C==="percent"?((0,n.isNumber)(P.min)||(P.min=0),(0,n.isNumber)(P.max)||(P.max=100)):C==="percentunit"&&((0,n.isNumber)(P.min)||(P.min=0),(0,n.isNumber)(P.max)||(P.max=1))}return b}function v(h){const{fieldOptions:y}=h;if(!y)return h;const{mappings:b,...D}=h.fieldOptions;let P;return h.thresholds&&(P={mode:i.O.Absolute,steps:f(h.thresholds)}),{...h,fieldOptions:{...D,defaults:{...y.defaults,mappings:b,thresholds:P}}}}function x(h){const{valueOptions:y}=h;if(!y)return h;const b={},D={};if(b.mappings=h.valueMappings,b.thresholds=h.thresholds,b.defaults=D,D.unit=y.unit,D.decimals=y.decimals,y.stat){const C=l.AS.get(y.stat);C&&(b.calcs=[C.id])}D.min=h.minValue,D.max=h.maxValue;const P={...h,fieldOptions:b};return(0,n.omit)(P,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function f(h){if(!h||!h.length)return;const y=h.map(b=>({value:b.value===null?-1/0:b.value,color:b.color}));return(0,c.RU)(y),y[0].value=-1/0,y}function E(h){return(0,g.bh)(h)}},37713:(k,A,e)=>{"use strict";e.d(A,{I1:()=>n.I1,_$:()=>n._$,gl:()=>n.gl});var n=e(63250)},47097:(k,A,e)=>{"use strict";e.d(A,{F:()=>u});var n=e(74848),s=e(32196),l=e(94659),r=e(9821),i=e(96540),g=e(40845),o=e(80427);const d=m=>{const{value:v,children:x,visible:f,placement:E,tipFormatter:h,...y}=m,b=(0,i.useRef)(null),D=(0,i.useRef)(null),P=(0,g.of)(c);function C(){D.current!==null&&cancelAnimationFrame(D.current)}function M(){D.current=requestAnimationFrame(()=>{b.current?.forceAlign()})}return(0,i.useEffect)(()=>(f?M():C(),C),[v,f]),(0,n.jsx)(o.A,{overlayClassName:P.tooltip,placement:E,overlay:h??v,overlayInnerStyle:{minHeight:"auto"},ref:b,visible:f,...y,children:x})},c=m=>({tooltip:(0,s.css)({position:"absolute",display:"block",visibility:"visible",fontSize:m.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:m.zIndex.tooltip})}),a=d;var p=e(24849);const u=({min:m,max:v,onChange:x,onAfterChange:f,orientation:E="horizontal",reverse:h,step:y,formatTooltipResult:b,value:D,tooltipAlwaysVisible:P=!0})=>{const C=(0,i.useCallback)(S=>{x?.(typeof S=="number"?[S,S]:S)},[x]),M=(0,i.useCallback)(S=>{f?.(typeof S=="number"?[S,S]:S)},[f]),I=E==="horizontal",R=(0,g.of)(p.$,I),T=(S,L)=>(0,n.jsx)(a,{value:L.value,visible:P||L.dragging,tipFormatter:b?()=>b(L.value):void 0,placement:I?"top":"right",children:S});return(0,n.jsxs)("div",{className:(0,s.cx)(R.container,R.slider),children:[(0,n.jsx)(l.Global,{styles:R.tooltip}),(0,n.jsx)(r.A,{min:m,max:v,step:y,defaultValue:D,range:!0,onChange:C,onChangeComplete:M,vertical:!I,reverse:h,handleRender:T})]})};u.displayName="RangeSlider"},77014:(k,A,e)=>{"use strict";e.d(A,{A:()=>c});var n=e(74848),s=e(32196),l=e(94659),r=e(9821),i=e(96540),g=e(40845),o=e(10354),d=e(24849);const c=({min:a,max:p,onChange:u,onAfterChange:m,orientation:v="horizontal",reverse:x,step:f,value:E,ariaLabelForHandle:h,marks:y,included:b})=>{const D=v==="horizontal",P=(0,g.of)(d.$,D,!!y),C=r.A,[M,I]=(0,i.useState)(E??a),R=(0,i.useCallback)(N=>{const F=typeof N=="number"?N:N[0];I(F),u?.(F)},[I,u]),T=(0,i.useCallback)(N=>{let F=+N.target.value;Number.isNaN(F)&&(F=0),I(F),u&&u(F),m&&m(F)},[u,m]),S=(0,i.useCallback)(N=>{const F=+N.target.value;F>p?I(p):F<a&&I(a)},[p,a]),L=(0,i.useCallback)(N=>{const F=typeof N=="number"?N:N[0];m?.(F)},[m]),O=D?[]:[P.sliderInputVertical],j=D?[]:[P.sliderInputFieldVertical];return(0,n.jsxs)("div",{className:(0,s.cx)(P.container,P.slider),children:[(0,n.jsx)(l.Global,{styles:P.tooltip}),(0,n.jsxs)("div",{className:(0,s.cx)(P.sliderInput,...O),children:[(0,n.jsx)(C,{min:a,max:p,step:f,defaultValue:E,value:M,onChange:R,onChangeComplete:L,vertical:!D,reverse:x,ariaLabelForHandle:h,marks:y,included:b}),(0,n.jsx)(o.p,{type:"text",className:(0,s.cx)(P.sliderInputField,...j),value:M,onChange:T,onBlur:S,min:a,max:p})]})]})};c.displayName="Slider"},24849:(k,A,e)=>{"use strict";e.d(A,{$:()=>r});var n=e(32196),s=e(94659),l=e(12415);const r=(i,g,o=!1)=>{const{spacing:d}=i,c=i.colors.border.strong,a=i.colors.primary.main,p=i.colors.primary.main,m=`box-shadow: 0px 0px 0px 6px ${i.colors.primary.transparent}`;return{container:(0,n.css)({width:"100%",margin:g?"inherit":d(1,3,1,1),paddingBottom:g&&o?i.spacing(1):"inherit",height:g?"auto":"100%"}),slider:(0,n.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${i.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${i.colors.text.disabled};
        font-size: ${i.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${i.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${p};
        box-shadow: ${i.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${m};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${i.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${i.colors.text.primary};
        border-color: ${i.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${a};
      }
      .rc-slider-rail {
        background-color: ${c};
        cursor: pointer;
      }
    `,tooltip:(0,s.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${i.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${i.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,n.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,n.css)({marginLeft:i.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,n.css)({margin:`0 0 ${i.spacing(3)} 0`,order:1})}}},5926:(k,A,e)=>{"use strict";e.d(A,{O:()=>E});var n=e(74848),s=e(2543),l=e(96540),r=e(39624),i=e(21423),g=e(11261),o=e(8066),d=e(52622),c=e(81297),a=e(51336),p=e(16895),u=e(73060),m=e(14236),v=e(46294);function x(h,y){const b=h.y.values.length,D={...h.y.config,...y},P=h.x??{name:"",values:[...Array(b).keys()],type:g.PU.number,config:{}};let C={refId:"sparkline",fields:[P,{...h.y,config:D}],length:b};return(0,u.g2)(P.values)||(C=(0,m.ES)(C,0)),(0,v.M)({frame:C,refFieldPseudoMin:h.timeRange?.from.valueOf(),refFieldPseudoMax:h.timeRange?.to.valueOf()})}const f={drawStyle:d.GR.Line,showPoints:d.yL.Auto,axisPlacement:d.vM.Hidden,pointSize:2};class E extends l.PureComponent{constructor(y){super(y);const b=x(y.sparkline,y.config);this.state={data:(0,p.bq)(b,(0,p.ro)(b)),alignedDataFrame:b,configBuilder:this.prepareConfig(b)}}static getDerivedStateFromProps(y,b){const D=x(y.sparkline,y.config),P=(0,r.C)(D);return P?{...b,data:(0,p.bq)(P,(0,p.ro)(P)),alignedDataFrame:P}:{...b}}componentDidUpdate(y,b){const{alignedDataFrame:D}=this.state;if(!D)return;let P=!1;if(y.sparkline!==this.props.sparkline){const C=!(0,i.bW)(this.state.alignedDataFrame,b.alignedDataFrame),M=!(0,s.isEqual)(D.fields[1].state?.range,b.alignedDataFrame.fields[1].state?.range);P=C||M}else P=!(0,s.isEqual)(y.config,this.props.config);P&&this.setState({configBuilder:this.prepareConfig(D)})}getYRange(y){let{min:b,max:D}=this.state.alignedDataFrame.fields[1].state?.range;const P=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(P)||(b=Math.min(b,+P),D=Math.max(D,+P)),b===D?(b===0?D=100:(b=0,D*=2),[b,D]):[Math.max(b,y.config.min??-1/0),Math.min(D,y.config.max??1/0)]}prepareConfig(y){const{theme:b}=this.props,D=new a.e;D.setCursor({show:!1,x:!1,y:!1});const P=y.fields[0];D.addScale({scaleKey:"x",orientation:d.Lt.Horizontal,direction:d.ON.Right,isTime:!1,range:()=>{const{sparkline:C}=this.props;if(C.x){if(C.timeRange&&C.x.type===g.PU.time)return[C.timeRange.from.valueOf(),C.timeRange.to.valueOf()];const M=C.x.values;return[M[0],M[M.length-1]]}return[0,C.y.values.length-1]}}),D.addAxis({scaleKey:"x",theme:b,placement:d.vM.Hidden});for(let C=0;C<y.fields.length;C++){const M=y.fields[C],I=M.config,R={...f,...I.custom};if(M===P||M.type!==g.PU.number)continue;const T=I.unit||"__fixed";D.addScale({scaleKey:T,orientation:d.Lt.Vertical,direction:d.ON.Up,range:()=>this.getYRange(M)}),D.addAxis({scaleKey:T,theme:b,placement:d.vM.Hidden});const S=(0,o.Qi)(M),L=S.getCalculator(M,b)(0,0),O=R.drawStyle===d.GR.Points?d.yL.Always:R.showPoints;D.addSeries({pxAlign:!1,scaleKey:T,theme:b,colorMode:S,thresholds:I.thresholds,drawStyle:R.drawStyle,lineColor:R.lineColor??L,lineWidth:R.lineWidth,lineInterpolation:R.lineInterpolation,showPoints:O,pointSize:R.pointSize,fillOpacity:R.fillOpacity,fillColor:R.fillColor,lineStyle:R.lineStyle,gradientMode:R.gradientMode})}return D}render(){const{data:y,configBuilder:b}=this.state,{width:D,height:P}=this.props;return(0,n.jsx)(c.Z,{data:y,config:b,width:D,height:P})}}},62930:(k,A,e)=>{"use strict";e.d(A,{y:()=>a});var n=e(74848),s=e(32196),l=e(8867),r=e(40845),i=e(4025),g=e(76412),o=e(87019),d=e(14578),c=e(78318);const a=({className:m,inline:v=!1,iconClassName:x,style:f,size:E="md"})=>{const h=(0,r.of)(p),y=(0,r.of)(u,E),D=window.matchMedia("(prefers-reduced-motion: reduce)").matches?"hourglass":"spinner";if(typeof E!="string"||!(0,i.rJ)(E)){const P=(0,c.Wj)(),C=(0,c.Xi)(D,"default"),M=`${P}${C}/${D}.svg`;return(0,n.jsx)("div",{"data-testid":"Spinner",style:f,className:(0,s.cx)({[h.inline]:v},y.wrapper,m),children:(0,n.jsx)(l.default,{src:M,width:E,height:E,className:(0,s.cx)(h.spin,y.icon,m),style:f})})}return(0,n.jsx)("div",{"data-testid":"Spinner",style:f,className:(0,s.cx)({[h.inline]:v},m),children:(0,n.jsx)(d.I,{className:(0,s.cx)(h.spin,x),name:D,size:E,"aria-label":(0,g.t)("grafana-ui.spinner.aria-label","Loading")})})},p=m=>({inline:(0,s.css)({display:"inline-block"}),spin:(0,s.css)({[m.transitions.handleMotion("no-preference")]:{animation:`${o.t} 2s infinite linear`}})}),u=(m,v)=>({wrapper:(0,s.css)({fontSize:typeof v=="string"?v:`${v}px`}),icon:(0,s.css)({display:"inline-block",fill:"currentColor",flexShrink:0,label:"Icon",lineHeight:0,verticalAlign:"middle"})})},21633:(k,A,e)=>{"use strict";e.d(A,{h:()=>p});var n=e(32196),s=e(2543),l=e.n(s),r=e(96540),i=e(40845),g=e(69144);const o=.3,d=new Set(["ArrowUp","ArrowDown"]),c=new Set(["ArrowLeft","ArrowRight"]),a={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function p(f){const{direction:E,initialSize:h=.5,dragPosition:y="middle",onResizing:b,onSizeChanged:D}=f,P=16,C=(0,r.useRef)(null),M=(0,r.useRef)(null),I=(0,r.useRef)(null),R=(0,r.useRef)(null),T=(0,r.useRef)(null),S=(0,r.useRef)("1fr"),L=(0,r.useRef)(void 0),O=(0,r.useRef)(void 0),j=a[E].dim,N=a[E].axis,F=a[E].min,U=a[E].max;v(R.current,Q=>{for(const ae of Q){if(!ae.target.isSameNode(R.current)||!M.current)return;const oe=M.current.getBoundingClientRect()[j],J=m(M.current);C.current.ariaValueNow=u(oe,J[F],J[U])}},500,[U,F,E,j]);const w=(0,r.useRef)(null),B=(0,r.useCallback)(Q=>{M.current&&(S.current=M.current.getBoundingClientRect()[j],T.current=R.current.getBoundingClientRect()[j],w.current=Q[N],C.current.setPointerCapture(Q.pointerId),L.current=m(M.current),O.current=void 0)},[j,N]),K=(0,r.useCallback)(Q=>{if(w.current!==null&&S.current!=="1fr"){const ae=Q[N]-w.current,oe=L.current,J=(0,s.clamp)(S.current+ae,oe[F],oe[U]),ee=J/(T.current-P);M.current.style.flexGrow=`${ee}`,I.current.style.flexGrow=`${1-ee}`,C.current.ariaValueNow=u(J,oe[F],oe[U]),b?.(ee,J)}},[P,N,F,U,b]),W=(0,r.useCallback)(Q=>{Q.preventDefault(),Q.stopPropagation(),C.current.releasePointerCapture(Q.pointerId),w.current=null,typeof S.current=="number"&&D?.(parseFloat(M.current.style.flexGrow),S.current)},[D]),z=(0,r.useRef)(new Set),Y=(0,r.useRef)(null),X=(0,r.useCallback)(Q=>{if(z.current.size===0){Y.current=null;return}else if(S.current==="1fr")return;const J=(Q-(Y.current??Q))*o;let ee=0;E==="row"?(z.current.has("ArrowLeft")&&(ee-=J),z.current.has("ArrowRight")&&(ee+=J)):(z.current.has("ArrowUp")&&(ee-=J),z.current.has("ArrowDown")&&(ee+=J));const de=L.current,xe=M.current.getBoundingClientRect()[j],re=(0,s.clamp)(xe+ee,de[F],de[U]),ue=re/(T.current-P);M.current.style.flexGrow=`${ue}`,I.current.style.flexGrow=`${1-ue}`,C.current.ariaValueNow=u(re,de[F],de[U]),b?.(ue,re),Y.current=Q,window.requestAnimationFrame(X)},[E,P,F,U,j,b]),q=(0,r.useCallback)(Q=>{if(!M.current||!I.current||!C.current||!R.current)return;if(Q.key==="Enter"){O.current===void 0?(O.current=M.current.style.flexGrow,M.current.style.flexGrow="0",I.current.style.flexGrow="1"):(M.current.style.flexGrow=O.current,I.current.style.flexGrow=`${1-parseFloat(O.current)}`,O.current=void 0);return}else if(Q.key==="Home"){L.current=m(M.current),T.current=R.current.getBoundingClientRect()[j];const oe=L.current[F]/(T.current-P);M.current.style.flexGrow=`${oe}`,I.current.style.flexGrow=`${1-oe}`,C.current.ariaValueNow="0";return}else if(Q.key==="End"){L.current=m(M.current),T.current=R.current.getBoundingClientRect()[j];const oe=L.current[U]/(T.current-P);M.current.style.flexGrow=`${oe}`,I.current.style.flexGrow=`${1-oe}`,C.current.ariaValueNow="100";return}if(!(E==="column"&&d.has(Q.key)||E==="row"&&c.has(Q.key))||z.current.has(Q.key))return;if(O.current=void 0,Q.preventDefault(),Q.stopPropagation(),S.current=M.current.getBoundingClientRect()[j],T.current=R.current.getBoundingClientRect()[j],L.current=m(M.current),!z.current.has(Q.key)){const oe=z.current.size===0;z.current.add(Q.key),oe&&window.requestAnimationFrame(X)}},[E,X,P,U,j,F]),G=(0,r.useCallback)(Q=>{E==="row"&&!c.has(Q.key)||E==="column"&&!d.has(Q.key)||(z.current.delete(Q.key),typeof S.current=="number"&&D?.(parseFloat(M.current.style.flexGrow),S.current))},[E,D]),te=(0,r.useCallback)(()=>{if(!M.current||!I.current)return;M.current.style.flexGrow="0.5",I.current.style.flexGrow="0.5";const Q=m(M.current);L.current=Q,S.current=M.current.getBoundingClientRect()[j],C.current.ariaValueNow=`${u(S.current,Q[F],Q[U])}`},[U,j,F]),H=(0,r.useCallback)(()=>{z.current.size>0&&(z.current.clear(),w.current=null,typeof S.current=="number"&&D?.(parseFloat(M.current.style.flexGrow),S.current))},[D]),se=(0,i.of)(x,E),ne=(0,i.of)(g.l,y),le=E==="column"?ne.dragHandleHorizontal:ne.dragHandleVertical,_=(0,r.useId)();return{containerProps:{ref:R,className:se.container},primaryProps:{ref:M,className:se.panel,style:{[F]:"min-content",flexGrow:(0,s.clamp)(h??.5,0,1)}},secondaryProps:{ref:I,className:se.panel,style:{flexGrow:(0,s.clamp)(1-h,0,1),[F]:"min-content"}},splitterProps:{onPointerUp:W,onPointerDown:B,onPointerMove:K,onKeyDown:q,onKeyUp:G,onDoubleClick:te,onBlur:H,ref:C,style:{[j]:`${P}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":h*100,"aria-controls":`start-panel-${_}`,"aria-label":"Pane resize widget",tabIndex:0,className:le}}}function u(f,E,h){return`${(0,s.clamp)((f-E)/(h-E)*100,0,100)}`}function m(f){const E=document.body.style.overflow,h=f.style.width,y=f.style.height,b=f.style.flexGrow;document.body.style.overflow="hidden",f.style.flexGrow="0";const{width:D,height:P}=f.getBoundingClientRect();f.style.flexGrow="100";const{width:C,height:M}=f.getBoundingClientRect();return document.body.style.overflow=E,f.style.width=h,f.style.height=y,f.style.flexGrow=b,{minWidth:D,maxWidth:C,minHeight:P,maxHeight:M}}function v(f,E,h=0,y){const b=(0,s.throttle)(E,h);(0,r.useLayoutEffect)(()=>{if(!f)return;const D=new ResizeObserver(b);return D.observe(f,{box:"device-pixel-content-box"}),()=>D.disconnect()},y)}function x(f,E){return{container:(0,n.css)({display:"flex",flexDirection:E==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,n.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(k,A,e)=>{"use strict";e.d(A,{S:()=>o});var n=e(74848),s=e(2543),l=e.n(s),r=e(96540),i=e(75059),g=e(90182);class o extends r.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:c,allowMultiple:a,defaultStat:p,onChange:u}=this.props,m=i.AS.list(c);if(m.length!==c.length){const v=m.map(f=>f.id),x=(0,s.difference)(c,v);console.warn("Unknown stats",x,c),u(m.map(f=>f.id))}!a&&c.length>1&&(console.warn("Removing extra stat",c),u([c[0]])),p&&c.length<1&&u([p])},this.onSelectionChange=c=>{const{onChange:a}=this.props;Array.isArray(c)?a(c.map(p=>p.value)):a(c&&c.value?[c.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(c){this.checkInput()}render(){const{stats:c,allowMultiple:a,defaultStat:p,placeholder:u,className:m,menuPlacement:v,width:x,inputId:f,filterOptions:E}=this.props,h=i.AS.selectOptions(c,E);return(0,n.jsx)(g.l6,{value:h.current,className:m,isClearable:!p,isMulti:a,width:x,isSearchable:!0,options:h.options,placeholder:u,onChange:this.onSelectionChange,menuPlacement:v,inputId:f})}}},15292:(k,A,e)=>{"use strict";e.d(A,{K:()=>p,d:()=>a});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(95344),o=e(40845),d=e(16797),c=e(14578);const a=(0,i.forwardRef)(({value:m,checked:v,onChange:x,id:f,label:E,disabled:h,invalid:y=!1,...b},D)=>{v&&(0,g.l)("Switch","checked prop","value");const P=(0,o.of)(u),C=(0,i.useRef)(f||(0,l.uniqueId)("switch-"));return(0,n.jsxs)("div",{className:(0,s.cx)(P.switch,y&&P.invalid),children:[(0,n.jsx)("input",{type:"checkbox",disabled:h,checked:m,onChange:M=>{!h&&x?.(M)},id:C.current,...b,ref:D}),(0,n.jsx)("label",{htmlFor:C.current,"aria-label":E??"Toggle switch",children:(0,n.jsx)(c.I,{name:"check",size:"xs"})})]})});a.displayName="Switch";const p=(0,i.forwardRef)(({transparent:m,className:v,showLabel:x,label:f,value:E,id:h,invalid:y,...b},D)=>{const P=(0,o.of)(u,m);return(0,n.jsxs)("div",{className:(0,s.cx)(P.inlineContainer,v,b.disabled&&P.disabled,y&&P.invalid),children:[x&&(0,n.jsx)("label",{htmlFor:h,className:(0,s.cx)(P.inlineLabel,E&&P.inlineLabelEnabled,"inline-switch-label"),children:f}),(0,n.jsx)(a,{...b,id:h,label:f,ref:D,value:E})]})});p.displayName="Switch";const u=(m,v)=>({switch:(0,s.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{opacity:0,left:"-100vw",zIndex:-1e3,position:"absolute","&:checked + label":{background:m.colors.primary.main,borderColor:m.colors.primary.main,"&:hover":{background:m.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:m.colors.primary.contrastText,color:m.colors.primary.main}},"&:disabled + label":{background:m.colors.action.disabledBackground,borderColor:m.colors.border.weak,cursor:"not-allowed",svg:{background:m.colors.text.disabled}},"&:disabled:checked + label":{background:m.colors.primary.transparent,svg:{color:m.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,d.getFocusStyles)(m),"&:focus:not(:focus-visible) + label":(0,d.getMouseFocusStyles)(m)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:m.shape.radius.pill,background:m.components.input.background,border:`1px solid ${m.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:m.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:m.shape.radius.circle,background:m.colors.text.secondary,boxShadow:m.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${m.colors.primary.contrastText}`}}}}),inlineContainer:(0,s.css)({padding:m.spacing(0,1),height:m.spacing(m.components.height.md),display:"inline-flex",alignItems:"center",background:v?"transparent":m.components.input.background,border:`1px solid ${v?"transparent":m.components.input.borderColor}`,borderRadius:m.shape.radius.default,"&:hover":{border:`1px solid ${v?"transparent":m.components.input.borderHover}`,".inline-switch-label":{color:m.colors.text.primary}}}),disabled:(0,s.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,s.css)({cursor:"pointer",paddingRight:m.spacing(1),color:m.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,s.css)({color:m.colors.text.primary}),invalid:(0,s.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${m.colors.error.border}`}})})},60734:(k,A,e)=>{"use strict";e.d(A,{q:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(29158),i=e(63021),g=e(40675),o=e(40980),d=e(40845),c=e(40276);function a({tabs:u,defaultTab:m,closeIconTooltip:v,onClose:x,testId:f}){const[E,h]=(0,l.useState)(u.some(C=>C.value===m)?m:u[0].value),y=(0,d.of)(p),b=(0,d.$j)(),D=C=>{h(C.value)},P=`calc(100% - (${b.components.menuTabs.height}px + ${b.spacing(1)}))`;return(0,n.jsxs)("div",{className:y.container,"data-testid":f,children:[(0,n.jsxs)(i.U,{className:y.tabs,children:[u.map(C=>(0,n.jsx)(g.o,{label:C.label,active:C.value===E,onChangeTab:()=>D(C),icon:C.icon},C.value)),(0,n.jsx)(r.K,{className:y.close,onClick:x,name:"times",tooltip:v??"Close"})]}),(0,n.jsx)(c.E,{autoHeightMin:P,autoHeightMax:P,children:(0,n.jsx)(o.J,{className:y.tabContent,children:u.find(C=>C.value===E)?.content})})]})}const p=u=>({container:(0,s.css)({height:"100%"}),tabContent:(0,s.css)({padding:u.spacing(2),backgroundColor:u.colors.background.primary,height:"100%"}),close:(0,s.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:u.typography.size.lg}),tabs:(0,s.css)({paddingTop:u.spacing(1),borderColor:u.colors.border.weak,ul:{marginLeft:u.spacing(2)}})})},92015:(k,A,e)=>{"use strict";e.d(A,{u:()=>d,d:()=>a});var n=e(74848),s=e(96540),l=e(75059),r=e(13544),i=e(32196);const g=p=>{const u=(0,i.css)({width:"100%",listStyle:"none"}),m=(0,i.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return p.value&&!Array.isArray(p.value)?(0,n.jsx)("span",{children:p.value}):p.value&&Array.isArray(p.value)&&p.value.length>0?(0,n.jsx)("ul",{className:u,children:p.value.map((v,x)=>{const f=Object.keys(v)[0];return(0,n.jsxs)("li",{className:m,children:[(0,n.jsx)("span",{children:f}),(0,n.jsx)("span",{children:v[f]})]},x)})}):o},o=()=>(0,n.jsx)("span",{children:"\xA0"});function d(p){const{totalColumnsWidth:u,footerGroups:m,isPaginationVisible:v,tableStyles:x}=p,f=r.Tp.components.Panels.Visualization.Table;return(0,n.jsx)("div",{style:{position:v?"relative":"absolute",width:u?`${u}px`:"100%",bottom:"0px"},children:m.map(E=>{const{key:h,...y}=E.getFooterGroupProps();return(0,s.createElement)("div",{className:x.tfoot,...y,key:h,"data-testid":f.footer},E.headers.map(b=>c(b,x)))})})}function c(p,u){const{key:m,...v}=p.getHeaderProps();return v?(v.style=v.style??{},v.style.position="absolute",v.style.justifyContent=p.justifyContent,(0,n.jsx)("div",{className:u.headerCell,...v,children:p.render("Footer")},m)):null}function a(p,u,m){if(u===void 0)return o;if(m){if(u[p]===void 0)return o;const v=l.AS.get(l.gy.count).name;return g({value:[{[v]:String(u[p])}]})}return g({value:u[p]})}},30355:(k,A,e)=>{"use strict";e.d(A,{a:()=>u,t:()=>p});var n=e(74848),s=e(58563),l=e(14236),r=e(11261),i=e(52622),g=e(40845),o=e(29413),d=e(9286),c=e(5926),a=e(57021);const p={type:i.ob.Sparkline,drawStyle:i.GR.Line,lineInterpolation:i.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:i.on.Hue,pointSize:2,barAlignment:i.Nj.Center,showPoints:i.yL.Never,hideValue:!1},u=x=>{const{field:f,innerWidth:E,tableStyles:h,cell:y,cellProps:b,timeRange:D}=x,P=m(y.value),C=(0,g.$j)();if(!P)return(0,n.jsx)("div",{...b,className:h.cellContainer,children:f.config.noValue||"no data"});P.x&&!P.x.config.interval&&P.x.values.length>1&&(P.x.config.interval=P.x.values[1]-P.x.values[0]),P.y.values=P.y.values.map(O=>Number.isFinite(O)?O:null);const M=(0,s.AP)(P.y);P.y.config.min=M.min,P.y.config.max=M.max,P.y.state={range:M},P.timeRange=D;const I=v(f),R={color:f.config.color,custom:{...p,...I}},T=f.config.custom?.cellOptions?.hideValue;let S=0,L=null;if(!T){const O=(0,l.LI)(y.value)?y.value.value:null,j=f.display(O),N=(0,a.zi)(f,j,y.row.index);S=(0,o.kD)(`${N.prefix??""}${N.text}${N.suffix??""}`,16).width+C.spacing.gridSize,L=(0,n.jsx)(d.i,{style:{width:`${S-C.spacing.gridSize}px`,textAlign:"right",marginRight:C.spacing(1)},value:j})}return(0,n.jsxs)("div",{...b,className:h.cellContainer,children:[L,(0,n.jsx)("div",{children:(0,n.jsx)(c.O,{width:E-S,height:h.cellHeightInner,sparkline:P,config:R,theme:h.theme})})]})};function m(x){if(Array.isArray(x))return{y:{name:"test",type:r.PU.number,values:x,config:{}}};if((0,l.ci)(x)){const f=x.fields.find(h=>h.type===r.PU.time),E=x.fields.find(h=>h.type===r.PU.number);if(f&&E)return{x:f,y:E}}}function v(x){let f=(0,a.bk)(x);if(f.type===i.ob.Auto&&(f={...f,type:i.ob.Sparkline}),f.type===i.ob.Sparkline)return f;throw new Error(`Expected options type ${i.ob.Sparkline} but got ${f.type}`)}},77093:(k,A,e)=>{"use strict";e.d(A,{X:()=>Xe});var n=e(74848),s=e(96540),l=e(32885),r=e(75059),i=e(11261),g=e(19845),o=e(13544),d=e(52622),c=e(40845),a=e(40276),p=e(19384),u=e(92015),m=e(4025),v=e(14578),x=e(32196),f=e(13840),E=e(91793),h=e(83195),y=e(67061),b=e(67647),D=e(9261),P=e(10880),C=e(60029);const M=28,I=M*5,R={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},T=Object.values(R),S=R.Contains,L=R.Expression,O=we=>{if(we=we.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(we)){const Ce=new Date(we);if(!isNaN(Ce.getTime())){const je=(0,h.j_)("dateTimeAsIso");return(0,h.cN)(je(Ce.getTime()))}}const qe=parseFloat(we);if(!isNaN(qe))return qe;const We=we.toLowerCase();return We==="true"||We==="false"?We==="true":we},j=({options:we,values:qe,caseSensitive:We,showOperators:Ce,onChange:je,searchFilter:Ke,setSearchFilter:_e,operator:Fe,setOperator:at})=>{const Ct=(0,s.useMemo)(()=>new RegExp(Ke,We?void 0:"i"),[Ke,We]),Dt=(0,s.useMemo)(()=>we.filter(Ie=>{if(!Ce||!Ke||Fe.value===S.value)return Ie.label===void 0?!1:Ct.test(Ie.label);if(Fe.value===L.value){if(Ie.value===void 0)return!1;try{const ke=Ke.replace(/\\/g,""),dt=new Function("$",`'use strict'; return ${ke};`),Pt=O(Ie.value);return dt(Pt)}catch{}return!1}else{if(Ie.value===void 0)return!1;const ke=O(Ie.value),dt=O(Ke);switch(Fe.value){case"=":return ke===dt;case"!=":return ke!==dt;case">":return ke>dt;case">=":return ke>=dt;case"<":return ke<dt;case"<=":return ke<=dt}return!1}}),[we,Ct,Ce,Fe,Ke]),tt=(0,s.useMemo)(()=>Dt.filter(Ie=>qe.includes(Ie)),[Dt,qe]),ze=(0,s.useMemo)(()=>Dt.length===tt.length,[Dt,tt]),pe=(0,s.useMemo)(()=>tt.length>0&&Dt.length>tt.length,[Dt,tt]),Se=(0,s.useMemo)(()=>tt.length?`${tt.length} selected`:"Select all",[tt]),fe=(0,s.useMemo)(()=>Dt.length!==tt.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[Dt,tt]),Ee=(0,c.of)(F),he=(0,c.$j)().spacing.gridSize,be=(0,s.useMemo)(()=>Math.min(Dt.length*M,I)+he,[he,Dt.length]),Ae=(0,s.useCallback)(Ie=>ke=>{const dt=ke.currentTarget.checked?qe.concat(Ie):qe.filter(Pt=>Pt.value!==Ie.value);je(dt)},[je,qe]),De=(0,s.useCallback)(()=>{if(Dt.length===tt.length){const Ie=qe.filter(ke=>!Dt.includes(ke));je(Ie)}else{const Ie=[...new Set([...qe,...Dt])];je(Ie)}},[je,qe,Dt,tt]);return(0,n.jsxs)(y.B,{direction:"column",gap:.25,children:[!Ce&&(0,n.jsx)(b.Z,{placeholder:"Filter values",onChange:_e,value:Ke}),Ce&&(0,n.jsxs)(y.B,{direction:"row",gap:0,children:[(0,n.jsx)(D.f,{variant:"canvas",options:T,onChange:at,value:Fe,tooltip:Fe.description}),(0,n.jsx)(b.Z,{placeholder:"Filter values",onChange:_e,value:Ke})]}),Dt.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.Y1,{height:be,itemCount:Dt.length,itemSize:M,itemData:{items:Dt,values:tt,onCheckedChanged:Ae,className:Ee.filterListRow},width:"100%",className:Ee.filterList,children:N}),(0,n.jsxs)(y.B,{direction:"column",gap:.25,children:[(0,n.jsx)("div",{className:(0,x.cx)(Ee.selectDivider)}),(0,n.jsx)("div",{className:(0,x.cx)(Ee.filterListRow),children:(0,n.jsx)(P.S,{value:ze,indeterminate:pe,label:Se,description:fe,onChange:De})})]})]}):(0,n.jsx)(C.J,{className:Ee.noValuesLabel,children:"No values"})]})};function N({index:we,style:qe,data:{onCheckedChanged:We,items:Ce,values:je,className:Ke}}){const _e=Ce[we],{value:Fe,label:at}=_e,Ct=je.find(Dt=>Dt.value===Fe)!==void 0;return(0,n.jsx)("div",{className:Ke,style:qe,title:at,children:(0,n.jsx)(P.S,{value:Ct,label:at,onChange:We(_e)})})}const F=we=>({filterList:(0,x.css)({label:"filterList"}),filterListRow:(0,x.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:we.spacing(.5),":hover":{backgroundColor:we.colors.action.hover}}),selectDivider:(0,x.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${we.colors.border.medium}`,padding:we.spacing(.5,2)}),noValuesLabel:(0,x.css)({paddingTop:we.spacing(1)})});var U=e(8866),w=e(29158),B=e(55852),K=e(57021);const W=({column:{preFilteredRows:we,filterValue:qe,setFilter:We},onClose:Ce,field:je,searchFilter:Ke,setSearchFilter:_e,operator:Fe,setOperator:at})=>{const Ct=(0,c.$j)(),Dt=(0,s.useMemo)(()=>(0,K.MY)(we,je),[we,je]),tt=(0,s.useMemo)(()=>(0,K.Yz)(Dt),[Dt]),ze=(0,s.useMemo)(()=>(0,K.Sj)(tt,qe),[tt,qe]),[pe,Se]=(0,s.useState)(ze),[fe,Ee]=(0,s.useState)(!1),Pe=(0,s.useCallback)(Ie=>Ce(),[Ce]),he=(0,s.useCallback)(Ie=>{const ke=pe.length?pe:void 0;We(ke),Ce()},[We,pe,Ce]),be=(0,s.useCallback)(Ie=>{We(void 0),Ce()},[We,Ce]),Ae=(0,s.useMemo)(()=>qe!==void 0,[qe]),De=(0,c.of)(z);return(0,n.jsx)(U.N,{onClick:Pe,useCapture:!0,children:(0,n.jsx)("div",{className:(0,x.cx)(De.filterContainer),onClick:Y,children:(0,n.jsxs)(y.B,{direction:"column",gap:3,children:[(0,n.jsxs)(y.B,{direction:"column",gap:.5,children:[(0,n.jsxs)(y.B,{justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)(C.J,{className:De.label,children:"Filter by values:"}),(0,n.jsx)(w.K,{name:"text-fields",tooltip:"Match case",style:{color:fe?Ct.colors.text.link:Ct.colors.text.disabled},onClick:()=>{Ee(Ie=>!Ie)}})]}),(0,n.jsx)("div",{className:(0,x.cx)(De.listDivider)}),(0,n.jsx)(j,{onChange:Se,values:pe,options:tt,caseSensitive:fe,showOperators:!0,searchFilter:Ke,setSearchFilter:_e,operator:Fe,setOperator:at})]}),(0,n.jsxs)(y.B,{gap:3,children:[(0,n.jsxs)(y.B,{children:[(0,n.jsx)(B.$n,{size:"sm",onClick:he,children:"Ok"}),(0,n.jsx)(B.$n,{size:"sm",variant:"secondary",onClick:Pe,children:"Cancel"})]}),Ae&&(0,n.jsx)(y.B,{children:(0,n.jsx)(B.$n,{fill:"text",size:"sm",onClick:be,children:"Clear filter"})})]})]})})})},z=we=>({filterContainer:(0,x.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:we.colors.background.primary,border:`1px solid ${we.colors.border.weak}`,padding:we.spacing(2),boxShadow:we.shadows.z3,borderRadius:we.shape.radius.default}),listDivider:(0,x.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${we.colors.border.medium}`,padding:we.spacing(.5,2)}),label:(0,x.css)({marginBottom:0})}),Y=we=>{we.stopPropagation()},X=({column:we,field:qe,tableStyles:We})=>{const Ce=(0,s.useRef)(null),[je,Ke]=(0,s.useState)(!1),_e=(0,c.of)(q),Fe=(0,s.useMemo)(()=>!!we.filterValue,[we.filterValue]),at=(0,s.useCallback)(()=>Ke(!0),[Ke]),Ct=(0,s.useCallback)(()=>Ke(!1),[Ke]),[Dt,tt]=(0,s.useState)(""),[ze,pe]=(0,s.useState)(S);return!qe||!qe.config.custom?.filterable?null:(0,n.jsxs)("button",{className:(0,x.cx)(We.headerFilter,Fe?_e.filterIconEnabled:_e.filterIconDisabled),ref:Ce,type:"button",onClick:at,children:[(0,n.jsx)(v.I,{name:"filter"}),je&&Ce.current&&(0,n.jsx)(f.A,{content:(0,n.jsx)(W,{column:we,tableStyles:We,field:qe,onClose:Ct,searchFilter:Dt,setSearchFilter:tt,operator:ze,setOperator:pe}),placement:"bottom-start",referenceElement:Ce.current,show:!0})]})},q=we=>({filterIconEnabled:(0,x.css)({label:"filterIconEnabled",color:we.colors.primary.text}),filterIconDisabled:(0,x.css)({label:"filterIconDisabled",color:we.colors.text.disabled})}),G=we=>{const{headerGroups:qe,showTypeIcons:We,tableStyles:Ce}=we,je=o.Tp.components.Panels.Visualization.Table;return(0,n.jsx)("div",{role:"rowgroup",className:Ce.headerRow,children:qe.map(Ke=>{const{key:_e,...Fe}=Ke.getHeaderGroupProps();return(0,s.createElement)("div",{className:Ce.thead,...Fe,key:_e,"aria-label":je.header,role:"row"},Ke.headers.map((at,Ct)=>te(at,Ce,We)))})})};function te(we,qe,We){const{key:Ce,...je}=we.getHeaderProps(),Ke=we.field??null,_e=Ke?.config.custom;we.canResize&&(je.style.userSelect=we.isResizing?"none":"auto"),je.style.position="absolute",je.style.justifyContent=we.justifyContent,je.style.left=we.totalLeft;let Fe=we.render("Header"),at=we.canSort&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{...we.getSortByToggleProps(),className:qe.headerCellLabel,children:[We&&(0,n.jsx)(v.I,{name:(0,m.SS)(Ke),title:Ke?.type,size:"sm",className:qe.typeIcon}),(0,n.jsx)("div",{children:Fe}),we.isSorted&&(we.isSortedDesc?(0,n.jsx)(v.I,{size:"lg",name:"arrow-down",className:qe.sortIcon}):(0,n.jsx)(v.I,{name:"arrow-up",size:"lg",className:qe.sortIcon}))]}),we.canFilter&&(0,n.jsx)(X,{column:we,tableStyles:qe,field:Ke})]});return at&&_e?.headerComponent?at=(0,n.jsx)(_e.headerComponent,{field:Ke,defaultContent:at}):_e?.headerComponent&&(Fe=(0,n.jsx)(_e.headerComponent,{field:Ke,defaultContent:Fe})),(0,n.jsxs)("div",{className:qe.headerCell,...je,role:"columnheader",children:[we.canSort&&at,!we.canSort&&Fe,!we.canSort&&we.canFilter&&(0,n.jsx)(X,{column:we,tableStyles:qe,field:Ke}),we.canResize&&(0,n.jsx)("div",{...we.getResizerProps(),className:qe.resizeHandle})]},Ce)}var H=e(64423),se=e(56978),ne=e(69129),le=e(79041);function _({tableStyles:we,nestedData:qe,rowIndex:We,width:Ce,cellHeight:je}){const Ke=qe.values,_e=[],Fe=(0,c.$j)(),at=(0,c.of)(Q);let Ct=we.rowHeight+Fe.spacing.gridSize;return Ke[We].forEach((Dt,tt)=>{const ze=!!Dt.meta?.custom?.noHeader,pe=we.rowHeight*(Dt.length+(ze?0:1)),Se={height:pe,paddingLeft:K.jV,position:"absolute",top:Ct};Ct+=pe+Fe.spacing.gridSize,_e.push((0,n.jsx)("div",{style:Se,children:(0,n.jsx)(Xe,{data:Dt,width:Ce-K.jV,height:we.rowHeight*(Dt.length+1),noHeader:ze,cellHeight:je})},`subTable_${We}_${tt}`))}),(0,n.jsx)("div",{className:at.subTables,children:_e})}const Q=we=>({subTables:(0,x.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:we.spacing(5),left:we.spacing(1),bottom:we.spacing(2),background:we.colors.border.medium}})});function ae(we,qe,We){return we.values[qe].reduce((Ke,_e)=>{if(_e.length){const Fe=!!_e.meta?.custom?.noHeader;return Ke+We.rowHeight*(_e.length+(Fe?0:1))+8}return Ke},We.rowHeight)??We.rowHeight}var oe=e(49618);const J=we=>{const{data:qe,rows:We,headerHeight:Ce,footerPaginationEnabled:je,rowHeight:Ke,itemCount:_e,pageIndex:Fe,tableState:at,prepareRow:Ct,onCellFilterAdded:Dt,width:tt,cellHeight:ze=d.qM.Sm,timeRange:pe,tableStyles:Se,nestedDataField:fe,listHeight:Ee,listRef:Pe,enableSharedCrosshair:he=!1,initialRowIndex:be=void 0,headerGroups:Ae,longestField:De}=we,[Ie,ke]=(0,s.useState)(be);be===void 0&&Ie!==void 0&&ke(void 0);const dt=(0,c.$j)(),Pt=(0,le.d2)();let pt=null;window.OffscreenCanvas!==void 0&&(pt=new OffscreenCanvas(256,1024).getContext("2d")),pt!=null&&(pt.font=`${dt.typography.fontSize}px ${dt.typography.body.fontFamily}`);const Tt=(0,s.useMemo)(()=>{const Lt=qe.fields.find(At=>At.type===i.PU.time);return Lt?(0,K.HY)(Lt):0},[qe]),jt=(0,s.useCallback)((Lt,At)=>{if(!Pt||!he||!(0,g.S1)(At))return;const Nt=At.fields.find(Dn=>Dn.type===i.PU.time);Pt.eventBus.publish(new ne.b_({point:{time:Nt.values[Lt]}}))},[he,Pt]),$t=(0,s.useCallback)(()=>{!Pt||!he||Pt.eventBus.publish(new ne.ql)},[he,Pt]),sn=(0,s.useCallback)(Lt=>{if(Lt.payload.point?.time&&Lt.payload.rowIndex!==void 0){const At=qe.fields.find(Pn=>Pn.type===i.PU.time),Nt=At.values[Lt.payload.rowIndex],Dn=Lt.payload.point.time;if((0,K.Iy)(Dn,Nt,Tt)){ke(Lt.payload.rowIndex);return}const An=At.values.findIndex(Pn=>(0,K.Iy)(Dn,Pn,Tt));if(An!==-1){ke(An);return}ke(void 0)}},[qe.fields,Tt]);(0,s.useEffect)(()=>{if(!Pt||!he||!(0,g.S1)(qe)||je)return;const Lt=new H.yU;return Lt.add(Pt.eventBus.getStream(ne.b_).pipe((0,se.B)(250)).subscribe({next:At=>{Pt.eventBus!==At.origin&&sn(At)}})),Lt.add(Pt.eventBus.getStream(ne.ql).pipe((0,se.B)(250)).subscribe({next:At=>{Pt.eventBus!==At.origin&&ke(void 0)}})),()=>{Lt.unsubscribe()}},[qe,he,je,sn,Pt]);let Yt;if(Ie!==void 0){const Lt=We.findIndex(At=>At.index===Ie);Lt!==-1&&(Yt=Ce+(Lt-1)*Ke)}const qt=(0,s.useCallback)(Lt=>at.pageIndex*at.pageSize+Lt,[at.pageIndex,at.pageSize]);let bn,Mt;for(const Lt of qe.fields){const At=Lt.config.custom,Nt=At!==void 0&&At.cellOptions!==void 0;Nt&&At.cellOptions.type===d.ob.ColorBackground&&At.cellOptions.applyToRow&&(bn=Dn=>{const An=Lt.display(Lt.values.get(Dn));return(0,K.HW)(Se,At.cellOptions,An)}),Nt&&(At.cellOptions.type===d.ob.Auto||At.cellOptions.type===d.ob.ColorBackground||At.cellOptions.type===d.ob.ColorText)&&At.cellOptions.wrapText?Mt=Lt:De!==void 0&&(Mt=De)}const Jt=(0,s.useCallback)(({index:Lt,style:At,rowHighlightIndex:Nt})=>{const Dn=qt(Lt),An=We[Dn];let Pn={};Ct(An);const Xn=at.expanded[An.id]?(0,x.css)({"&:hover":{background:"inherit"}}):{},Tn=fe&&at.expanded[An.id];if(Nt!==void 0&&An.index===Nt&&(At={...At,backgroundColor:dt.components.table.rowSelected},Pn={"aria-selected":"true"}),bn){const{bgColor:Ge,textColor:Ve}=bn(An.index);At.background=Ge,At.color=Ve}if(Mt){const Ve=qe.fields.filter(Qe=>!Qe.config.custom?.hidden).findIndex(Qe=>Qe.name===Mt.name),lt=dt.typography.body.lineHeight*dt.typography.fontSize,It=(0,K.M2)(Mt.values[Lt],Ae[0].headers[Ve],pt,lt,Se.rowHeight);At.height=It.height}const{key:ht,...St}=An.getRowProps({style:At,...Pn});return(0,n.jsxs)("div",{...St,className:(0,x.cx)(Se.row,Xn),onMouseEnter:()=>jt(Lt,qe),onMouseLeave:$t,children:[Tn&&(0,n.jsx)(_,{nestedData:fe,tableStyles:Se,rowIndex:An.index,width:tt,cellHeight:ze}),An.cells.map((Ge,Ve)=>(0,n.jsx)(oe.n,{tableStyles:Se,cell:Ge,onCellFilterAdded:Dt,columnIndex:Ve,columnCount:An.cells.length,timeRange:pe,frame:qe,rowStyled:bn!==void 0,rowExpanded:Tn,textWrapped:Mt!==void 0,height:Number(At.height)},Ve))]},ht)},[ze,qe,fe,Dt,jt,$t,Ct,qt,We,at.expanded,Se,Mt,dt.components.table.rowSelected,dt.typography.fontSize,dt.typography.body.lineHeight,pe,tt,bn,Ae,pt]),Ut=Lt=>{const At=qt(Lt),Nt=We[At];if(at.expanded[Nt.id]&&fe)return ae(fe,Nt.index,Se);if(Mt){const An=qe.fields.filter(Xn=>!Xn.config.custom?.hidden).findIndex(Xn=>Xn.name===Mt.name),Pn=dt.typography.fontSize*dt.typography.body.lineHeight;return(0,K.M2)(Mt.values[Lt],Ae[0].headers[An],pt,Pn,Se.rowHeight).height}return Se.rowHeight},Gt=Lt=>{const{scrollTop:At}=Lt.currentTarget;Pe.current!==null&&Pe.current.scrollTo(At)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.A,{onScroll:Gt,hideHorizontalTrack:!0,scrollTop:Yt,children:(0,n.jsx)(E._m,{height:Ee,itemCount:_e,itemSize:Ut,width:"100%",ref:Pe,style:{overflow:void 0},children:({index:Lt,style:At})=>Jt({index:Lt,style:At,rowHighlightIndex:Ie})},Ke+Fe)})})};function ee(we,qe){(0,s.useEffect)(()=>{if(we.current&&qe.current){const We=we.current.querySelector(".track-vertical"),Ce=qe.current.firstChild;Ce&&We&&(We.remove(),Ce instanceof HTMLElement&&(Ce.querySelector(":scope > .track-vertical")?.remove(),Ce.append(We)))}})}function de(we,qe,We,Ce){const je=JSON.stringify(Object.keys(we.expanded));(0,s.useEffect)(()=>{let Ke=0;Ce||(Number.isFinite(we.lastExpandedOrCollapsedIndex)&&(Ke=we.lastExpandedOrCollapsedIndex),Ke=we.pageIndex===0?Ke-1:Ke-we.pageIndex-we.pageIndex*we.pageSize),qe.current?.resetAfterIndex(Math.max(Ke,0))},[we.lastExpandedOrCollapsedIndex,we.pageSize,we.pageIndex,qe,We,je,Ce])}var xe=e(28240);function re({onColumnResize:we,onSortByChange:qe,data:We}){return(0,s.useCallback)((Ce,je)=>{switch(je.type){case"columnDoneResizing":if(we){const _e=Ce.columnResizing?.headerIdWidths?.[0]?.[0],Fe=parseInt(_e,10),at=Math.round(Ce.columnResizing.columnWidths?.[_e]),Ct=We.fields?.[Fe];if(!Ct)return Ce;const Dt=(0,xe.Ct)(Ct,We);we(Dt,at)}case"toggleSortBy":if(qe){const Ke=[];for(const _e of Ce.sortBy){const Fe=We.fields[parseInt(_e.id,10)];Fe&&Ke.push({displayName:(0,xe.Ct)(Fe,We),desc:_e.desc})}qe(Ke)}case"toggleRowExpanded":if(je.id)return{...Ce,lastExpandedOrCollapsedIndex:parseInt(je.id,10)}}return Ce},[We,we,qe])}function ue(we,qe){const We={};if(we){We.sortBy=[];for(const Ce of we)for(const je of qe)je.Header===Ce.displayName&&We.sortBy.push({id:je.id,desc:Ce.desc})}return We}var Te=e(69770);const ge=150,Oe=36,Ue="No data",Xe=(0,s.memo)(we=>{const{ariaLabel:qe,data:We,height:Ce,onCellFilterAdded:je,width:Ke,columnMinWidth:_e=ge,noHeader:Fe,resizable:at=!0,initialSortBy:Ct,footerOptions:Dt,showTypeIcons:tt,footerValues:ze,enablePagination:pe,cellHeight:Se=d.qM.Sm,timeRange:fe,enableSharedCrosshair:Ee=!1,initialRowIndex:Pe=void 0,fieldConfig:he}=we,be=(0,s.useRef)(null),Ae=(0,s.useRef)(null),De=(0,s.useRef)(null),Ie=(0,c.$j)(),ke=(0,Te.k)(Ie,Se),dt=Fe?0:ke.rowHeight,[Pt,pt]=(0,s.useState)(ze),Tt=he?.defaults?.noValue??Ue,jt=(0,s.useMemo)(()=>{const ln=Oe;let On=0;if(!Pt)return 0;for(const wn of Pt)Array.isArray(wn)&&wn.length>On&&(On=wn.length);return On>1?ln*On:ln},[Pt]),$t=(0,s.useMemo)(()=>We.fields.length?Array(We.length).fill(0):[],[We]),sn=!!(Dt?.countRows&&Dt.reducer&&Dt.reducer.length&&Dt.reducer[0]===r.gy.count),Yt=We.fields.find(ln=>ln.type===i.PU.nestedFrames),qt=Yt!==void 0,bn=(0,s.useMemo)(()=>(0,K.GH)(We,Ke,_e,qt,Pt,sn),[We,Ke,_e,Pt,qt,sn]),Mt=(0,s.useRef)(),Jt=re({...we,onSortByChange:ln=>{Mt.current(!1),we.onSortByChange&&we.onSortByChange(ln)}}),Ut=!!We.meta?.uniqueRowIdFields?.length,Gt=(0,s.useMemo)(()=>{const ln={columns:bn,data:$t,disableResizing:!at,stateReducer:Jt,autoResetPage:!1,initialState:ue(Ct,bn),autoResetFilters:!1,sortTypes:{number:K.Ok,"alphanumeric-insensitive":K.IM}};return Ut&&(ln.getRowId=(On,wn)=>(0,g.t9)(We,wn),ln.autoResetExpanded=!1),ln},[Ct,bn,$t,at,Jt,Ut,We]),{getTableProps:Lt,headerGroups:At,footerGroups:Nt,rows:Dn,prepareRow:An,totalColumnsWidth:Pn,page:Xn,state:Tn,gotoPage:ht,setPageSize:St,pageOptions:Ge,toggleAllRowsExpanded:Ve}=(0,l.useTable)(Gt,l.useFilters,l.useSortBy,l.useAbsoluteLayout,l.useResizeColumns,l.useExpanded,l.usePagination),lt=Tn;Mt.current=Ve,(0,s.useEffect)(()=>{Dt||pt(ze)},[ze,Dt]),(0,s.useEffect)(()=>{if(!Dt)return;if(!Dt.show){pt(void 0);return}if(sn){const On=[];On[0]=Dn.length.toString()??We.length.toString(),pt(On);return}const ln=(0,K.Ux)(At[0].headers,(0,K.XX)(Dn),Dt,Ie);pt(ln)},[Dt,Ie,Tn.filters,We]);let It=Ce-(dt+jt);pe&&(It-=ke.cellHeight);const Qe=Math.round(It/ke.rowHeight)-1;(0,s.useEffect)(()=>{Qe<=0||St(Qe)},[Qe,St]),(0,s.useEffect)(()=>{We.length/Qe<Tn.pageIndex&&ht(0)},[We]),de(lt,be,We,Ut),ee(De,Ae);const vt=(0,s.useCallback)(ln=>{ht(ln-1)},[ht]),Ot=pe?Xn.length:Dn.length;let zt=null;if(pe){const ln=Tn.pageIndex*Tn.pageSize+1;let On=ln+Tn.pageSize-1;const wn=Ke<550;On>We.length&&(On=We.length),zt=(0,n.jsxs)("div",{className:ke.paginationWrapper,children:[(0,n.jsx)(p.d,{currentPage:Tn.pageIndex+1,numberOfPages:Ge.length,showSmallVersion:wn,onNavigate:vt}),wn?null:(0,n.jsxs)("div",{className:ke.paginationSummary,children:[ln," - ",On<Dn.length?On:Dn.length," of ",Dn.length," rows"]})]})}const vn=(0,K.O4)(he,We);return(0,n.jsxs)("div",{...Lt(),className:ke.table,"aria-label":qe,role:"table",ref:Ae,style:{width:Ke,height:Ce},children:[(0,n.jsx)(a.E,{hideVerticalTrack:!0,children:(0,n.jsxs)("div",{className:ke.tableContentWrapper(Pn),children:[!Fe&&(0,n.jsx)(G,{headerGroups:At,showTypeIcons:tt,tableStyles:ke}),Ot>0?(0,n.jsx)("div",{"data-testid":o.Tp.components.Panels.Visualization.Table.body,ref:De,children:(0,n.jsx)(J,{headerGroups:At,data:We,rows:Dn,width:Ke,cellHeight:Se,headerHeight:dt,rowHeight:ke.rowHeight,itemCount:Ot,pageIndex:Tn.pageIndex,listHeight:It,listRef:be,tableState:Tn,prepareRow:An,timeRange:fe,onCellFilterAdded:je,nestedDataField:Yt,tableStyles:ke,footerPaginationEnabled:!!pe,enableSharedCrosshair:Ee,initialRowIndex:Pe,longestField:vn})}):(0,n.jsx)("div",{style:{height:Ce-dt,width:Ke},className:ke.noData,children:Tt}),Pt&&(0,n.jsx)(u.u,{isPaginationVisible:!!pe,footerValues:Pt,footerGroups:Nt,totalColumnsWidth:Pn,tableStyles:ke})]})}),zt]})});Xe.displayName="Table"},49618:(k,A,e)=>{"use strict";e.d(A,{n:()=>s});var n=e(74848);const s=({cell:l,tableStyles:r,onCellFilterAdded:i,timeRange:g,userProps:o,frame:d,rowStyled:c,rowExpanded:a,textWrapped:p,height:u})=>{const m=l.getCellProps(),v=l.column.field;if(!v?.display)return null;if(m.style){m.style.minWidth=m.style.width;const f=l.column.justifyContent;f==="flex-end"?(m.style.textAlign="right",m.style.direction="rtl",m.style.unicodeBidi="plaintext"):m.style.justifyContent=f}let x=(typeof l.column.width=="number"?l.column.width:24)-r.cellPadding*2;return(0,n.jsx)(n.Fragment,{children:l.render("Cell",{field:v,tableStyles:r,onCellFilterAdded:i,cellProps:m,innerWidth:x,timeRange:g,userProps:o,frame:d,rowStyled:c,rowExpanded:a,textWrapped:p,height:u})})}},69770:(k,A,e)=>{"use strict";e.d(A,{k:()=>s});var n=e(32196);function s(r,i){const g=r.colors.border.weak,o=r.colors.primary.border,d=6,c=l(r,i,d),a=c+2,p=28,u=(m,v,x,f,E,h,y,b,D)=>(0,n.css)({label:f?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${d}px`,width:"100%",height:D?"auto !important":`${a-1}px`,wordBreak:y?"break-all":"inherit",display:"flex",...E?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${g}`,color:b?"inherit":m??void 0,background:b?void 0:v??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:f&&!y?"visible":void 0,width:h||!f?"auto":"auto !important",height:(h||f)&&!y?"auto !important":`${a-1}px`,minHeight:`${a-1}px`,wordBreak:h?"break-word":void 0,whiteSpace:h&&f?"normal":"nowrap",boxShadow:f?`0 0 2px ${r.colors.primary.main}`:void 0,background:b?"inherit":x??r.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:f?void 0:"absolute",top:f?void 0:"1px",right:f?void 0:0,margin:f?r.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:r.spacing(1,.5,1,1),background:v?"none":"rgba(0, 0, 0, 0.5)",svg:{color:m}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:r,cellHeight:c,buildCellContainerStyle:u,cellPadding:d,cellHeightInner:c-d*2,rowHeight:a,table:(0,n.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,n.css)({label:"thead",height:`${p}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,n.css)({label:"tfoot",height:`${p}px`,borderTop:`1px solid ${g}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,n.css)({label:"row",borderBottom:`1px solid ${g}`}),headerCell:(0,n.css)({height:"100%",padding:`0 ${d}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:r.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,n.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:r.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:r.spacing(.5),"&:hover":{textDecoration:"underline",color:r.colors.text.link}}),cellContainerText:u(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:u(void 0,void 0,void 0,!1,!0),cellContainer:u(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:u(void 0,void 0,void 0,!1,!1),cellText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,n.css)({marginLeft:r.spacing(.5)}),cellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:r.colors.text.link,fontWeight:r.typography.fontWeightMedium,paddingRight:r.spacing(1.5),"&:hover":{textDecoration:"underline",color:r.colors.text.link}}),cellLinkForColoredCell:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:r.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,n.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,n.css)({display:"flex",height:`${c}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,n.css)({color:r.colors.text.secondary,fontSize:r.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:r.spacing(0,1,0,2)}),tableContentWrapper:m=>{const v=m!==void 0?`${m}px`:"100%";return(0,n.css)({label:"tableContentWrapper",width:v,display:"flex",flexDirection:"column"})},row:(0,n.css)({label:"row",borderBottom:`1px solid ${g}`,"&:hover":{backgroundColor:r.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,n.css)({height:"100%"}),resizeHandle:(0,n.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:o,opacity:0,[r.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:r.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,n.css)({marginRight:r.spacing(1),color:r.colors.text.secondary}),noData:(0,n.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${a}px`,cursor:"pointer"})}}function l(r,i,g){const o=r.typography.fontSize,d=r.typography.body.lineHeight;switch(i){case"md":return 42;case"lg":return 48;case"sm":default:return g*2+o*d}}},88407:(k,A,e)=>{"use strict";e.d(A,{Zi:()=>s,mc:()=>n});const n="=",s="!="},57021:(k,A,e)=>{"use strict";e.d(A,{jV:()=>_,HY:()=>Fe,MY:()=>ee,XX:()=>we,zi:()=>Ke,HW:()=>at,bk:()=>We,GH:()=>ae,Sj:()=>ue,Ux:()=>Ue,j1:()=>Q,O4:()=>Dt,M2:()=>Ct,Iy:()=>_e,o7:()=>Ce,IM:()=>Te,Ok:()=>ge,Yz:()=>xe});var n=e(2543),s=e(47078),l=e.n(s),r=e(84140),i=e(11261),g=e(28240),o=e(14236),d=e(19845),c=e(83195),a=e(75059),p=e(57875),u=e(52622),m=e(24284),v=e(74848),x=e(50082),f=e(58563),E=e(47070),h=e(97696),y=e(59796);const b={mode:x.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},D=tt=>{const{field:ze,innerWidth:pe,tableStyles:Se,cell:fe,cellProps:Ee,row:Pe}=tt,he=ze.display(fe.value),be=We(ze);let Ae=(0,f.xg)(ze,!1);Ae.thresholds||(Ae={...Ae,thresholds:b});let De=u.eX.Gradient,Ie;be.type===u.ob.Gauge&&(De=be.mode??u.eX.Gradient,Ie=be.valueDisplayMode!==void 0?be.valueDisplayMode:u.$l.Text);const ke=()=>(0,n.isFunction)(ze.getLinks)?ze.getLinks({valueRowIndex:Pe.index}):[],dt=!!ke().length,Pt=Ke(ze,he,fe.row.index),pt=Tt=>{const{openMenu:jt,targetClassName:$t}=Tt;return(0,v.jsx)(h.xE,{width:pe,height:Se.cellHeightInner,field:Ae,display:ze.display,text:{valueSize:14},value:he,orientation:E.wV.Horizontal,theme:Se.theme,alignmentFactors:Pt,onClick:jt,className:$t,itemSpacing:1,lcdCellWidth:8,displayMode:De,valueDisplayMode:Ie})};return(0,v.jsxs)("div",{...Ee,className:Se.cellContainer,children:[dt&&(0,v.jsx)(y.e,{links:ke,style:{display:"flex",width:"100%"},children:Tt=>pt(Tt)}),!dt&&pt({})]})};var P=e(90914);const C=tt=>{const{field:ze,row:pe,cellProps:Se,tableStyles:fe}=tt,Ee=(0,P.k)(ze,pe);return(0,v.jsx)("div",{...Se,className:fe.cellContainerText,children:Ee&&Ee.map((Pe,he)=>(0,v.jsx)("span",{className:fe.cellLink,onClick:Pe.onClick,children:(0,v.jsx)("a",{href:Pe.href,target:Pe.target,children:Pe.title})},he))})};var M=e(32196),I=e(96540),R=e(40845),T=e(55852),S=e(29158),L=e(67061),O=e(10534),j=e(87978),N=e(32372);function F({value:tt,onDismiss:ze,mode:pe}){let Se=tt;if((0,n.isString)(tt)){const Ee=tt.trim();if(Ee[0]==="{"||Ee[0]==="["||pe==="code")try{tt=JSON.parse(tt),pe="code"}catch{pe="text"}else pe="text"}else Se=JSON.stringify(tt,null," ");let fe=Se;return pe==="code"&&(fe=JSON.stringify(tt,null," ")),(0,v.jsxs)(j._,{onClose:ze,title:"Inspect value",children:[pe==="code"?(0,v.jsx)(N.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(fe&&fe.length)>100,value:fe,readOnly:!0}):(0,v.jsx)("pre",{children:fe}),(0,v.jsx)(O.b,{icon:"copy",getText:()=>fe,children:"Copy to Clipboard"})]})}var U=e(88407);function w({field:tt,cell:ze,previewMode:pe,showFilters:Se,onCellFilterAdded:fe}){const[Ee,Pe]=(0,I.useState)(!1),he=Q(tt)==="flex-end",be=!!tt.config.custom?.inspect,Ae={size:"sm",tooltipPlacement:"top"},De=(0,I.useCallback)(ke=>{fe&&fe({key:tt.name,operator:U.mc,value:ze.value})},[ze,tt,fe]),Ie=(0,I.useCallback)(ke=>{fe&&fe({key:tt.name,operator:U.Zi,value:ze.value})},[ze,tt,fe]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:`cellActions${he?" cellActionsLeft":""}`,children:(0,v.jsxs)(L.B,{gap:.5,children:[be&&(0,v.jsx)(S.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{Pe(!0)},...Ae}),Se&&(0,v.jsx)(S.K,{name:"search-plus",onClick:De,tooltip:"Filter for value",...Ae}),Se&&(0,v.jsx)(S.K,{name:"search-minus",onClick:Ie,tooltip:"Filter out value",...Ae})]})}),Ee&&(0,v.jsx)(F,{mode:pe,value:ze.value,onDismiss:()=>{Pe(!1)}})]})}const B=tt=>{const{field:ze,cell:pe,tableStyles:Se,row:fe,cellProps:Ee,frame:Pe,rowStyled:he,rowExpanded:be,textWrapped:Ae,height:De}=tt,Ie=!!ze.config.custom?.inspect,ke=ze.display(pe.value),dt=tt.onCellFilterAdded&&ze.config.filterable,Pt=dt&&pe.value!==void 0||Ie,pt=We(ze),Tt=!!(0,P.k)(ze,fe)?.length,jt=(0,R.of)(T.Ez),[$t,sn]=(0,I.useState)(!1);let Yt;const qt=140,bn=()=>{sn(!1)},Mt=()=>{sn(!0)};if(pt.type===u.ob.Custom){const Nt=pt.cellComponent;Yt=(0,v.jsx)(Nt,{field:ze,value:pe.value,rowIndex:fe.index,frame:Pe})}else I.isValidElement(pe.value)?Yt=pe.value:Yt=(0,c.cN)(ke);const Jt=typeof Yt=="string",Ut=ke.text.length<=qt&&/\s/.test(ke.text),Gt=K(Se,pt,ke,Ie,Jt,Ut,Ae,he,be);if(Jt){let Nt=Ee.style?.justifyContent;Nt==="flex-end"?Ee.style={...Ee.style,textAlign:"right"}:Nt==="center"&&(Ee.style={...Ee.style,textAlign:"center"})}De&&(Ee.style={...Ee.style,height:De}),Ae&&(Ee.style={...Ee.style,textWrap:"wrap"});const{key:Lt,...At}=Ee;return(0,v.jsxs)("div",{...At,onMouseEnter:Pt?Mt:void 0,onMouseLeave:Pt?bn:void 0,className:Gt,children:[!Tt&&(Jt?`${Yt}`:(0,v.jsx)("div",{className:Se.cellText,children:Yt})),Tt&&(0,v.jsx)(y.e,{links:()=>(0,P.k)(ze,fe)||[],children:Nt=>Nt.openMenu?(0,v.jsx)("button",{className:(0,M.cx)(jt,W(Se,pt,Nt.targetClassName)),onClick:Nt.openMenu,children:Yt}):(0,v.jsx)("div",{className:W(Se,pt,Nt.targetClassName),children:Yt})}),$t&&Pt&&(0,v.jsx)(w,{...tt,previewMode:"text",showFilters:dt})]},Lt)};function K(tt,ze,pe,Se=!1,fe=!1,Ee=!1,Pe=!1,he=!1,be=!1){let Ae,De,Ie;const ke=at(tt,ze,pe);return Ae=ke.textColor,De=ke.bgColor,Ie=ke.bgHoverColor,tt.buildCellContainerStyle(Ae,De,Ie,!Se,fe,Ee,Pe,he,be)}function W(tt,ze,pe){return ze.type===u.ob.Auto?(0,M.cx)(tt.cellLink,pe):(0,M.cx)(tt.cellLinkForColoredCell,pe)}var z=e(92015),Y=e(64136),X=e(27430);function q(tt){const{cell:ze,tableStyles:pe,cellProps:Se}=tt;let fe="";return ze.value instanceof X.A?fe=new Y.A().writeGeometry(ze.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):ze.value!=null&&(fe=`${ze.value}`),(0,v.jsx)("div",{...Se,className:pe.cellContainer,children:(0,v.jsx)("div",{className:pe.cellText,style:{fontFamily:"monospace"},children:fe})})}const G=10,te=tt=>{const{field:ze,cell:pe,tableStyles:Se,row:fe,cellProps:Ee}=tt,Pe=We(ze),{title:he,alt:be}=Pe.type===u.ob.Image?Pe:{title:void 0,alt:void 0},Ae=ze.display(pe.value),De=!!(0,P.k)(ze,fe)?.length,Ie=(0,v.jsx)("img",{style:{height:Se.cellHeight-G,width:"auto"},src:Ae.text,className:Se.imageCell,alt:be,title:he});return(0,v.jsxs)("div",{...Ee,className:Se.cellContainer,children:[!De&&Ie,De&&(0,v.jsx)(y.e,{style:{height:Se.cellHeight-G,width:"auto"},links:()=>(0,P.k)(ze,fe)||[],children:ke=>ke.openMenu?(0,v.jsx)("div",{onClick:ke.openMenu,role:"button",tabIndex:0,onKeyDown:dt=>{dt.key==="Enter"&&ke.openMenu&&ke.openMenu(dt)},children:Ie}):Ie})]})};function H(tt){const{cell:ze,tableStyles:pe,cellProps:Se,field:fe,row:Ee}=tt,Pe=!!fe.config.custom?.inspect,he=(0,M.css)({cursor:"pointer",fontFamily:"monospace"});let be=ze.value,Ae=be;if((0,n.isString)(be))try{be=JSON.parse(be)}catch{}else Ae=JSON.stringify(be,null," ");const De=!!(0,P.k)(fe,Ee)?.length,Ie=(0,R.of)(T.Ez);return(0,v.jsxs)("div",{...Se,className:Pe?pe.cellContainerNoOverflow:pe.cellContainer,children:[(0,v.jsxs)("div",{className:(0,M.cx)(pe.cellText,he),children:[!De&&(0,v.jsx)("div",{className:pe.cellText,children:Ae}),De&&(0,v.jsx)(y.e,{links:()=>(0,P.k)(fe,Ee)||[],children:ke=>ke.openMenu?(0,v.jsx)(T.$n,{className:(0,M.cx)(Ie),onClick:ke.openMenu,children:Ae}):(0,v.jsx)(v.Fragment,{children:Ae})})]}),Pe&&(0,v.jsx)(w,{...tt,previewMode:"code"})]})}var se=e(14578);function ne({row:tt,tableStyles:ze}){return(0,v.jsx)("div",{className:ze.expanderCell,...tt.getToggleRowExpandedProps(),children:(0,v.jsx)(se.I,{"aria-label":tt.isExpanded?"Collapse row":"Expand row",name:tt.isExpanded?"angle-down":"angle-right",size:"lg"})})}var le=e(30355);const _=50;function Q(tt){if(!tt)return"flex-start";if(tt.config.custom)switch(tt.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return tt.type===i.PU.number?"flex-end":"flex-start"}function ae(tt,ze,pe,Se,fe,Ee){const Pe=[];let he=0;Se&&(Pe.push({Header:()=>null,id:"expander",Cell:ne,width:_,minWidth:_,filter:(Ae,De,Ie)=>[],justifyContent:"left",field:tt.fields[0],sortType:"basic"}),ze-=_);for(const[Ae,De]of tt.fields.entries()){const Ie=De.config.custom||{};if(Ie.hidden||De.type===i.PU.nestedFrames)continue;Ie.width?ze-=Ie.width:he++;const ke=Pt=>{switch(Pt){case i.PU.number:case i.PU.frame:return"number";case i.PU.time:return"basic";default:return"alphanumeric-insensitive"}},dt=oe(Ie.cellOptions?.type,De);Pe.push({Cell:dt,id:Ae.toString(),field:De,Header:Ie.hideHeader?"":(0,g.Ct)(De,tt),accessor:(Pt,pt)=>De.values[pt],sortType:ke(De.type),width:Ie.width,minWidth:Ie.minWidth??pe,filter:l()(J(De)),justifyContent:Q(De),Footer:(0,z.d)(Ae,fe,Ee)})}let be=ze/he;for(let Ae=he;Ae>0;Ae--)for(const De of Pe)!De.width&&De.minWidth>be&&(De.width=De.minWidth,ze-=De.width,he-=1,be=ze/he);for(const Ae of Pe)Ae.width||(Ae.width=be),Ae.minWidth=50;return Pe}function oe(tt,ze){switch(tt){case u.ob.Custom:case u.ob.ColorText:case u.ob.ColorBackground:return B;case u.ob.Image:return te;case u.ob.Gauge:return D;case u.ob.Sparkline:return le.a;case u.ob.JSONView:return H;case u.ob.DataLinks:return C}if(ze.type===i.PU.geo)return q;if(ze.type===i.PU.frame){const pe=ze.values[0];return(0,o.ci)(pe)&&(0,d.aH)(pe)?le.a:H}return ze.type===i.PU.other?H:B}function J(tt){return function(ze,pe,Se){return ze.length===0||!Se||!tt?ze:ze.filter(fe=>{if(!fe.values.hasOwnProperty(pe))return!1;const Ee=de(fe,tt);return Se.find(Pe=>Pe.value===Ee)!==void 0})}}function ee(tt,ze){if(!ze||tt.length===0)return{};const pe={};for(let Se=0;Se<tt.length;Se++){const fe=de(tt[Se],ze);pe[fe||"(Blanks)"]=fe}return pe}function de(tt,ze){if(!ze||!tt)return"";const pe=ze.values[tt.index],Se=ze.display?ze.display(pe):pe;return ze.display?(0,c.cN)(Se):Se}function xe(tt){return Object.keys(tt).reduce((ze,pe)=>ze.concat({value:tt[pe],label:pe}),[]).sort(re)}function re(tt,ze){return tt.label===void 0&&ze.label===void 0?0:tt.label===void 0&&ze.label!==void 0?-1:tt.label!==void 0&&ze.label===void 0?1:tt.label<ze.label?-1:tt.label>ze.label?1:0}function ue(tt,ze){return ze?tt.filter(pe=>ze.some(Se=>Se.value===pe.value)):[]}function Te(tt,ze,pe){return String(tt.values[pe]).localeCompare(String(ze.values[pe]),void 0,{sensitivity:"base"})}function ge(tt,ze,pe){const Se=Oe(tt.values[pe]),fe=Oe(ze.values[pe]);return Se===fe?0:Se>fe?1:-1}function Oe(tt){return(0,o.LI)(tt)?tt.value??Number.NEGATIVE_INFINITY:tt==null||tt===""||isNaN(tt)?Number.NEGATIVE_INFINITY:typeof tt=="number"?tt:Number(tt)}function Ue(tt,ze,pe,Se){return je(tt),tt.map((fe,Ee)=>{if(fe?.field?.type!==i.PU.number)return Ee===0&&pe.reducer&&pe.reducer.length>0?a.AS.get(pe.reducer[0]).name:void 0;let Pe=(0,n.clone)(fe.field);return Pe.values=ze[fe.id],Pe.state=void 0,fe.field=Pe,pe.fields&&pe.fields.length>0?pe.fields.find(be=>be===fe?.field?.name)?Xe(fe.field,pe.reducer,Se):void 0:Xe(fe.field,pe.reducer||[],Se)})}function Xe(tt,ze,pe){const Se=ze[0];if(Se===void 0)return"";const fe=tt.display??(0,p.J)({field:tt,theme:pe}),Ee=(0,a.Nw)({field:tt,reducers:ze})[Se];return a.AS.get(Se).preservesUnits?(0,c.cN)(fe(Ee)):(0,c.cN)({text:Ee})}function we(tt){const ze=[];for(const pe in tt)for(const[Se,fe]of Object.entries(tt[pe].values))ze[Se]===void 0&&(ze[Se]=[]),ze[Se].push(fe);return ze}const qe={type:u.ob.Auto};function We(tt){return tt.config.custom?.displayMode?Ce(tt.config.custom?.displayMode):tt.config.custom?.cellOptions?tt.config.custom.cellOptions:qe}function Ce(tt){switch(tt){case"basic":case"gradient-gauge":case"lcd-gauge":let ze=u.eX.Basic;return tt==="gradient-gauge"?ze=u.eX.Gradient:tt==="lcd-gauge"&&(ze=u.eX.Lcd),{type:u.ob.Gauge,mode:ze};case"color-background":case"color-background-solid":let pe=u.Wq.Basic;return tt==="color-background"&&(pe=u.Wq.Gradient),{type:u.ob.ColorBackground,mode:pe};default:return{type:tt}}}function je(tt){const ze=tt.findIndex((pe,Se)=>pe?.id!==String(Se));ze===-1||tt[ze]?.id==="expander"||(tt.splice(ze,0,{id:String(ze)}),je(tt))}function Ke(tt,ze,pe){let Se=tt.state?.alignmentFactors;if(Se)return Se.text.length<ze.text.length&&(Se.text=ze.text),Se;{Se={...ze};const fe=Math.min(tt.values.length,pe+1e3);for(let Ee=pe+1;Ee<fe;Ee++)tt.display(tt.values[Ee]).text.length>Se.text.length&&(Se.text=ze.text);return tt.state?tt.state.alignmentFactors=Se:tt.state={alignmentFactors:Se},Se}}function _e(tt,ze,pe){return Math.abs(Math.floor(tt)-ze)<pe}function Fe(tt){let ze=-Number.MAX_VALUE,pe=Number.MAX_VALUE;if(tt.values.length<2)return 0;for(let Se=0;Se<tt.values.length;Se++){const fe=tt.values[Se];fe>ze&&(ze=fe),fe<pe&&(pe=fe)}return(ze-pe)/tt.values.length}function at(tt,ze,pe){const Se=tt.theme.isDark?1:-.7;let fe,Ee,Pe;if(ze.type===u.ob.ColorText)fe=pe.color;else if(ze.type===u.ob.ColorBackground){const he=ze.mode??u.Wq.Gradient;if(he===u.Wq.Basic)fe=(0,m.mZ)(pe.color,tt.theme.isDark),Ee=(0,r.A)(pe.color).toRgbString(),Pe=(0,r.A)(pe.color).setAlpha(1).toRgbString();else if(he===u.Wq.Gradient){const be=(0,r.A)(pe.color).setAlpha(1).toRgbString(),Ae=(0,r.A)(pe.color).darken(10*Se).spin(5);fe=(0,m.mZ)(pe.color,tt.theme.isDark),Ee=`linear-gradient(120deg, ${Ae.toRgbString()}, ${pe.color})`,Pe=`linear-gradient(120deg, ${Ae.setAlpha(1).toRgbString()}, ${be})`}}return{textColor:fe,bgColor:Ee,bgHoverColor:Pe}}function Ct(tt,ze,pe,Se,fe){const Ee=Number(ze.width??300),Pe=1.17,he=42;if(pe!==null&&typeof tt=="string"){const be=tt.split(/\s/),Ae=[];let De="",Ie=0,ke=0;for(let pt=0;pt<be.length;pt++){const Tt=be[pt];let jt=pe.measureText(De+" "+Tt).width;jt<Ee?(De+=" "+Tt,Ie++):(Ae.push({width:jt,line:De}),De=Tt,Ie=0)}for(let pt=0;pt<Ae.length;pt++)if(Ae[pt].width>Ee){let Tt=Math.floor(Ae[pt].width/Ee)-1;ke+=Tt}let dt=Ae.length+ke,Pt=38;return dt>5?Pt=dt*Se*Pe:Pt=dt*Se+he,{width:Ee,height:Pt}}return{width:Ee,height:fe}}function Dt(tt,ze){let pe;if(tt!==void 0&&tt.defaults.custom!==void 0&&tt.defaults.custom.cellOptions.wrapText){const fe=ze.fields.filter(Ee=>Ee.type===i.PU.string);if(fe.length>=1&&fe[0].values.length>0){const Ee=fe[0].values.length;let Pe=0;if(Ee<=30)for(const he of fe){const be=he.values[0].length;be>Pe&&(Pe=be,pe=he)}else for(const he of fe){const be=(0,n.sampleSize)(he.values,3),Ae=(be[0]?.length+be[1]?.length+be[2]?.length)/3;Ae>Pe&&(Pe=Ae,pe=he)}}}return pe}},14746:(k,A,e)=>{"use strict";e.d(A,{b:()=>u});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(72436),o=e(40845),d=e(3911),c=e(14578),a=e(21744);class p extends i.PureComponent{constructor(x){super(x),this.readCSV=(0,l.debounce)(()=>{const{config:h}=this.props,{text:y}=this.state;this.setState({data:(0,g.Jh)(y,{config:h})})},150),this.onTextChange=h=>{this.setState({text:h.target.value})};const{text:f,config:E}=x;this.state={text:f,data:(0,g.Jh)(f,{config:E})}}componentDidUpdate(x,f){const{text:E}=this.state;(E!==f.text||this.props.config!==x.config)&&this.readCSV(),this.props.text!==x.text&&this.props.text!==E&&this.setState({text:this.props.text}),this.state.data!==f.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:x,height:f,theme:E}=this.props,{data:h}=this.state,y=m(E);return(0,n.jsxs)("div",{className:y.tableInputCsv,children:[(0,n.jsx)(a.f,{style:{width:x,height:f},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:y.textarea}),h&&(0,n.jsx)("footer",{className:y.footer,children:h.map((b,D)=>(0,n.jsxs)("span",{children:["Rows:",b.length,", Columns:",b.fields.length," \xA0",(0,n.jsx)(c.I,{name:"check-circle"})]},D))})]})}}const u=(0,o.cV)(p);u.displayName="TableInputCSV";const m=(0,d.N)(v=>({tableInputCsv:(0,s.css)({position:"relative"}),textarea:(0,s.css)({height:"100%",width:"100%"}),footer:(0,s.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:v.colors.success.main,padding:`1px ${v.spacing(.5)}`,fontSize:"80%"})}))},53402:(k,A,e)=>{"use strict";e.d(A,{p:()=>i});var n=e(74848),s=e(32196),l=e(83195),r=e(40845);const i=({value:o})=>{const d=(0,r.of)(g);return(0,n.jsx)("span",{className:d.counter,children:(0,l.Hg)(o,0).text})},g=o=>({counter:(0,s.css)({label:"counter",marginLeft:o.spacing(1),borderRadius:o.spacing(3),backgroundColor:o.colors.action.hover,padding:o.spacing(.25,1),color:o.colors.text.secondary,fontWeight:o.typography.fontWeightMedium,fontSize:o.typography.size.sm})})},40675:(k,A,e)=>{"use strict";e.d(A,{o:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(16797),o=e(55852),d=e(14578),c=e(53402);const a=l.forwardRef(({label:u,active:m,icon:v,onChangeTab:x,counter:f,suffix:E,className:h,href:y,...b},D)=>{const P=(0,i.of)(p),C=(0,i.of)(o.my),M=()=>(0,n.jsxs)(n.Fragment,{children:[v&&(0,n.jsx)(d.I,{name:v}),u,typeof f=="number"&&(0,n.jsx)(c.p,{value:f}),E&&(0,n.jsx)(E,{className:P.suffix})]}),R={className:(0,s.cx)(C,P.link,m?P.activeStyle:P.notActive),"data-testid":r.Tp.components.Tab.title(u),...b,onClick:x,role:"tab","aria-selected":m};return y?(0,n.jsx)("div",{className:P.item,children:(0,n.jsx)("a",{...R,href:y,ref:D,children:M()})}):(0,n.jsx)("div",{className:P.item,children:(0,n.jsx)("button",{...R,type:"button",ref:D,children:M()})})});a.displayName="Tab";const p=u=>({item:(0,s.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:u.spacing(.5)}),link:(0,s.css)({color:u.colors.text.secondary,padding:u.spacing(1,1.5,.5),borderRadius:u.shape.radius.default,display:"block",height:"100%",svg:{marginRight:u.spacing(1)},"&:focus-visible":(0,g.getFocusStyles)(u),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:u.shape.radius.default,bottom:0}}),notActive:(0,s.css)({"a:hover, &:hover, &:focus":{color:u.colors.text.primary,"&::before":{backgroundColor:u.colors.action.hover}}}),activeStyle:(0,s.css)({label:"activeTabStyle",color:u.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:u.colors.gradients.brandHorizontal}}),suffix:(0,s.css)({marginLeft:u.spacing(1)})})},40980:(k,A,e)=>{"use strict";e.d(A,{J:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g,className:o,...d})=>{const c=(0,l.of)(i);return(0,n.jsx)("div",{...d,className:(0,s.cx)(c.tabContent,o),children:g})},i=g=>({tabContent:(0,s.css)({background:g.colors.background.primary})})},63021:(k,A,e)=>{"use strict";e.d(A,{U:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(40845);const i=(0,l.forwardRef)(({children:o,className:d,hideBorder:c=!1},a)=>{const p=(0,r.of)(g);return(0,n.jsx)("div",{className:(0,s.cx)(p.tabsWrapper,c&&p.noBorder,d),ref:a,children:(0,n.jsx)("div",{className:p.tabs,role:"tablist",children:o})})}),g=o=>({tabsWrapper:(0,s.css)({borderBottom:`1px solid ${o.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,s.css)({borderBottom:0}),tabs:(0,s.css)({position:"relative",display:"flex",height:`${o.components.menuTabs.height}px`,alignItems:"center"})});i.displayName="TabsBar"},90685:(k,A,e)=>{"use strict";e.d(A,{s:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(14578),o=e(53402);const d=(0,l.forwardRef)(({label:a,active:p,icon:u,counter:m,className:v,suffix:x,onChangeTab:f,href:E,...h},y)=>{const b=(0,i.of)(c),D=()=>(0,n.jsxs)(n.Fragment,{children:[u&&(0,n.jsx)(g.I,{name:u}),a,typeof m=="number"&&(0,n.jsx)(o.p,{value:m}),x&&(0,n.jsx)(x,{className:b.suffix})]}),P=(0,s.cx)(b.link,p&&b.activeStyle);return(0,n.jsx)("a",{href:E,className:P,...h,onClick:f,"aria-label":h["aria-label"]||r.Tp.components.Tab.title(a),role:"tab","aria-selected":p,ref:y,children:D()})});d.displayName="Tab";const c=a=>({link:(0,s.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:a.colors.text.primary,svg:{marginRight:a.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,s.css)({label:"activeTabStyle",color:a.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:a.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,s.css)({marginLeft:a.spacing(1)})})},78369:(k,A,e)=>{"use strict";e.d(A,{v:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(70255),i=e(40845),g=e(69613),o=e(72129),d=e(14578);const c=(0,l.forwardRef)(({name:v,onClick:x,icon:f,className:E,colorIndex:h,...y},b)=>{const D=(0,i.$j)(),P=m(D,v,h),C=I=>{I.preventDefault(),I.stopPropagation(),x?.(v,I)},M=(0,s.cx)(P.wrapper,E,{[P.hover]:x!==void 0});return x?(0,n.jsxs)("button",{...y,className:M,onClick:C,ref:b,children:[f&&(0,n.jsx)(d.I,{name:f}),v]}):(0,n.jsxs)("span",{...y,className:M,ref:b,children:[f&&(0,n.jsx)(d.I,{name:f}),v]})});c.displayName="Tag";const a=({rootProps:v})=>{const x=(0,i.of)(u);return(0,n.jsx)(r.A,{width:60,height:22,containerClassName:x.container,...v})},p=(0,o.j)(c,a),u=()=>({container:(0,s.css)({lineHeight:1})}),m=(v,x,f)=>{let E;return f===void 0?E=(0,g.MC)(x):E=(0,g.yC)(f),{wrapper:(0,s.css)({appearance:"none",borderStyle:"none",fontWeight:v.typography.fontWeightMedium,fontSize:v.typography.size.sm,lineHeight:v.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:E.color,color:v.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:v.shape.radius.default}),hover:(0,s.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(k,A,e)=>{"use strict";e.d(A,{L:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(72129),g=e(78369);const o=(0,l.memo)((0,l.forwardRef)(({displayMax:u,tags:m,icon:v,onClick:x,className:f,getAriaLabel:E,getColorIndex:h},y)=>{const b=(0,r.$j)(),D=p(b,!!(u&&u>0)),P=m.length,C=u?m.slice(0,u):m;return(0,n.jsxs)("ul",{className:(0,s.cx)(D.wrapper,f),"aria-label":"Tags",ref:y,children:[C.map((M,I)=>(0,n.jsx)("li",{className:D.li,children:(0,n.jsx)(g.v,{name:M,icon:v,onClick:x,"aria-label":E?.(M,I),"data-tag-id":I,colorIndex:h?.(M,I)})},M)),u&&u>0&&P-u>0&&(0,n.jsxs)("span",{className:D.moreTagsLabel,children:["+ ",P-u]})]})}));o.displayName="TagList";const d=({rootProps:u})=>{const m=(0,r.of)(a);return(0,n.jsxs)("div",{className:m.container,...u,children:[(0,n.jsx)(g.v.Skeleton,{}),(0,n.jsx)(g.v.Skeleton,{})]})},c=(0,i.j)(o,d),a=u=>({container:(0,s.css)({display:"flex",gap:u.spacing(1)})}),p=(u,m)=>({wrapper:(0,s.css)({position:"relative",alignItems:m?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:m?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,s.css)({color:u.colors.text.secondary,fontSize:u.typography.size.sm}),li:(0,s.css)({listStyle:"none"})})},79924:(k,A,e)=>{"use strict";e.d(A,{u:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(55852),g=e(10354),o=e(69613),d=e(29158);const c=({name:m,disabled:v,onRemove:x})=>{const{color:f,borderColor:E}=(0,l.useMemo)(()=>(0,o.MC)(m),[m]),h=(0,r.of)(a);return(0,n.jsxs)("li",{className:h.itemStyle,style:{backgroundColor:f,borderColor:E},children:[(0,n.jsx)("span",{className:h.nameStyle,children:m}),(0,n.jsx)(d.K,{name:"times",size:"lg",disabled:v,tooltip:`Remove "${m}" tag`,onClick:()=>x(m),className:h.buttonStyles})]})},a=m=>{const v=m.spacing.gridSize*3;return{itemStyle:(0,s.css)({display:"flex",gap:"3px",alignItems:"center",height:`${v}px`,lineHeight:`${v-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:m.shape.radius.default,padding:`0 ${m.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:m.typography.size.sm}),nameStyle:(0,s.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,s.css)({margin:0,"&:hover::before":{display:"none"}})}},p=({placeholder:m="New tag (enter key to add)",tags:v=[],onChange:x,width:f,className:E,disabled:h,addOnBlur:y,invalid:b,id:D})=>{const[P,C]=(0,l.useState)(""),M=(0,r.of)(u),I=(0,r.$j)(),R=(0,l.useCallback)(j=>{C(j.target.value)},[]),T=j=>{x(v.filter(N=>N!==j))},S=j=>{j?.preventDefault(),v.includes(P)||x(v.concat(P)),C("")},L=()=>{y&&P&&S()},O=j=>{j.key==="Enter"&&P!==""&&S(j)};return(0,n.jsxs)("div",{className:(0,s.cx)(M.wrapper,E,f?(0,s.css)({width:I.spacing(f)}):""),children:[(0,n.jsx)(g.p,{id:D,disabled:h,placeholder:m,onChange:R,value:P,onKeyDown:O,onBlur:L,invalid:b,suffix:(0,n.jsx)(i.$n,{fill:"text",className:M.addButtonStyle,onClick:S,size:"md",disabled:P.length<=0,children:"Add"})}),v?.length>0&&(0,n.jsx)("ul",{className:M.tags,children:v.map(j=>(0,n.jsx)(c,{name:j,onRemove:T,disabled:h},j))})]})},u=m=>({wrapper:(0,s.css)({minHeight:m.spacing(4),display:"flex",flexDirection:"column",gap:m.spacing(1),flexWrap:"wrap"}),tags:(0,s.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:m.spacing(.5)}),addButtonStyle:(0,s.css)({margin:`0 -${m.spacing(1)}`})})},94753:(k,A,e)=>{"use strict";e.d(A,{E:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(65848),g=e(56034);const o=l.forwardRef(({childElement:p,children:u},m)=>{const[v,x]=(0,l.useState)(!1),f=(0,l.useRef)(null);(0,l.useImperativeHandle)(m,()=>f.current);const E=(0,l.useMemo)(()=>new ResizeObserver(y=>{for(const b of y)b.target.clientWidth&&b.target.scrollWidth&&(b.target.scrollWidth>b.target.clientWidth&&x(!0),b.target.scrollWidth<=b.target.clientWidth&&x(!1))}),[]);(0,l.useEffect)(()=>{const{current:y}=f;return y&&E.observe(y),()=>{E.disconnect()}},[x,E]);const h=y=>typeof y=="string"?y:i.renderToStaticMarkup((0,n.jsx)(n.Fragment,{children:y})).replace(/(<([^>]+)>)/gi,"");return v?(0,n.jsx)(g.m,{ref:f,content:h(u),children:p(void 0)}):p(f)});o.displayName="TruncatedText";var d=e(71356);const c=l.forwardRef(({element:p="span",variant:u,weight:m,color:v,truncate:x,italic:f,textAlignment:E,children:h,tabular:y,...b},D)=>{const P=(0,r.of)(a,p,u,v,m,x,f,E,y),C=M=>(0,l.createElement)(p,{...b,style:void 0,className:P,ref:M},h);return!x||p==="span"?C(void 0):(0,n.jsx)(o,{childElement:C,children:h,ref:D})});c.displayName="Text";const a=(p,u,m,v,x,f,E,h,y)=>(0,s.css)([{margin:0,padding:0,...(0,d.d$)(p,u,m)},m&&{...p.typography[m]},v&&{color:(0,d.vT)(v,p)},x&&{fontWeight:(0,d.iV)(x,p)},f&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},E&&{fontStyle:"italic"},h&&{textAlign:h},y&&{fontFeatureSettings:'"tnum"'}])},71356:(k,A,e)=>{"use strict";e.d(A,{d$:()=>l,iV:()=>n,vT:()=>s});const n=(r,i)=>{switch(r){case"bold":return i.typography.fontWeightBold;case"medium":return i.typography.fontWeightMedium;case"light":return i.typography.fontWeightLight;case"regular":case void 0:return i.typography.fontWeightRegular}},s=(r,i)=>{switch(r){case"error":return i.colors.error.text;case"success":return i.colors.success.text;case"info":return i.colors.info.text;case"warning":return i.colors.warning.text;default:return r?i.colors.text[r]:void 0}},l=(r,i,g)=>{if(g)return r.typography[g];switch(i){case"span":return;case"h1":return r.typography.h1;case"h2":return r.typography.h2;case"h3":return r.typography.h3;case"h4":return r.typography.h4;case"h5":return r.typography.h5;case"h6":return r.typography.h6;default:return r.typography.body}}},21744:(k,A,e)=>{"use strict";e.d(A,{f:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(87266);const g=(0,l.forwardRef)(({invalid:d,className:c,...a},p)=>{const u=(0,r.of)(o,d);return(0,n.jsx)("textarea",{...a,className:(0,s.cx)(u.textarea,c),ref:p})}),o=(d,c=!1)=>({textarea:(0,s.cx)((0,i.Xb)(d),(0,i.gm)(d),(0,s.css)({display:"block",borderRadius:d.shape.radius.default,padding:`${d.spacing.gridSize/4}px ${d.spacing.gridSize}px`,width:"100%",borderColor:c?d.colors.error.border:d.components.input.borderColor}))});g.displayName="TextArea"},60782:(k,A,e)=>{"use strict";e.d(A,{G:()=>a});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(96540),o=e(40845),d=e(18976),c=e(29158);const a=(0,g.memo)(({children:u,theme:m="info",placement:v="auto",content:x,title:f,closeButton:E=!0,onClose:h,footer:y,fitContent:b=!1,onOpen:D,show:P})=>{const C=(0,g.useRef)(null),M=(0,o.$j)(),I=(0,o.of)(p),R=I[m],[T,S]=(0,g.useState)(P),L=P??T,O=[(0,l.cY)(8),(0,l.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,l.BN)(),(0,l.UE)({element:C})],{context:j,refs:N,floatingStyles:F}=(0,r.we)({open:L,placement:(0,d.O)(v),onOpenChange:W=>{P===void 0&&S(W),W?D?.():h?.()},middleware:O,whileElementsMounted:i.ll,strategy:"fixed"}),U=(0,r.kp)(j),w=(0,r.s9)(j),{getReferenceProps:B,getFloatingProps:K}=(0,r.bv)([w,U]);return(0,n.jsxs)(n.Fragment,{children:[(0,g.cloneElement)(u,{ref:N.setReference,tabIndex:0,"aria-expanded":L,...B()}),L&&(0,n.jsx)(r.s3,{context:j,modal:!1,closeOnFocusOut:!1,children:(0,n.jsxs)("div",{"data-testid":"toggletip-content",className:(0,s.cx)(R.container,{[I.fitContent]:b}),ref:N.setFloating,style:F,...K(),children:[(0,n.jsx)(r.ie,{strokeWidth:.3,stroke:M.colors.border.weak,className:R.arrow,ref:C,context:j}),!!f&&(0,n.jsx)("div",{className:R.header,children:f}),E&&(0,n.jsx)("div",{className:R.headerClose,children:(0,n.jsx)(c.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{S(!1),h?.()}})}),(0,n.jsxs)("div",{className:R.body,children:[(typeof x=="string"||(0,g.isValidElement)(x))&&x,typeof x=="function"&&x({})]}),!!y&&(0,n.jsx)("div",{className:R.footer,children:y})]})})]})});a.displayName="Toggletip";const p=u=>{const m=(0,d.f)(u,u.colors.background.primary,u.colors.border.weak,u.components.tooltip.text,{topBottom:2,rightLeft:2}),v=(0,d.f)(u,u.colors.error.main,u.colors.error.main,u.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:m,error:v,fitContent:(0,s.css)({maxWidth:"fit-content"})}}},27746:(k,A,e)=>{"use strict";e.d(A,{I:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(8887),i=e(13544),g=e(40845),o=e(16797),d=e(55852),c=e(14578),a=e(56034);const p=(0,l.forwardRef)(({tooltip:x,icon:f,iconSize:E,className:h,children:y,imgSrc:b,imgAlt:D,fullWidth:P,isOpen:C,narrow:M,variant:I="default",iconOnly:R,"aria-label":T,isHighlighted:S,...L},O)=>{const j=(0,g.of)(v),N=(0,s.cx)({[j.button]:!0,[j.buttonFullWidth]:P,[j.narrow]:M},j[I],h),F=(0,s.cx)({[j.content]:!0,[j.contentWithIcon]:!!f,[j.contentWithRightIcon]:C!==void 0}),U=(0,n.jsxs)("button",{ref:O,className:N,"aria-label":u(T,x),"aria-expanded":C,...L,children:[m(f,E),b&&(0,n.jsx)("img",{className:j.img,src:b,alt:D??""}),y&&!R&&(0,n.jsx)("div",{className:F,children:y}),C===!1&&(0,n.jsx)(c.I,{name:"angle-down"}),C===!0&&(0,n.jsx)(c.I,{name:"angle-up"}),S&&(0,n.jsx)("div",{className:j.highlight})]});return x?(0,n.jsx)(a.m,{ref:O,content:x,placement:"bottom",children:U}):U});p.displayName="ToolbarButton";function u(x,f){return x||(f?i.Tp.components.PageToolbar.item(f):void 0)}function m(x,f){return x?(0,r.n6)(x)?(0,n.jsx)(c.I,{name:x,size:`${f||"lg"}`}):x:null}const v=x=>{const f=(0,d.U_)(x,"primary","solid"),E=(0,d.U_)(x,"destructive","solid"),h=(0,s.css)({color:x.colors.text.primary,background:x.colors.secondary.main,"&:hover":{color:x.colors.text.primary,background:x.colors.secondary.shade,border:`1px solid ${x.colors.border.medium}`}});return{button:(0,s.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:x.spacing(x.components.height.md),padding:x.spacing(0,1),borderRadius:x.shape.radius.default,lineHeight:`${x.components.height.md*x.spacing.gridSize-2}px`,fontWeight:x.typography.fontWeightMedium,border:`1px solid ${x.colors.secondary.border}`,whiteSpace:"nowrap",[x.transitions.handleMotion("no-preference","reduce")]:{transition:x.transitions.create(["background","box-shadow","border-color","color"],{duration:x.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,o.getFocusStyles)(x),zIndex:1},"&:focus:not(:focus-visible)":(0,o.getMouseFocusStyles)(x),"&:hover":{boxShadow:x.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:x.colors.action.disabledOpacity,background:x.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:x.colors.text.disabled,background:x.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,s.css)({color:x.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:x.colors.text.primary,background:x.colors.background.secondary}}),canvas:h,active:(0,s.cx)(h,(0,s.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:x.shape.radius.default,backgroundImage:x.colors.gradients.brandHorizontal}})),primary:(0,s.css)(f),destructive:(0,s.css)(E),narrow:(0,s.css)({padding:x.spacing(0,.5)}),img:(0,s.css)({width:"16px",height:"16px",marginRight:x.spacing(1)}),buttonFullWidth:(0,s.css)({flexGrow:1}),content:(0,s.css)({flexGrow:1}),contentWithIcon:(0,s.css)({display:"none",paddingLeft:x.spacing(1),[`@media ${o.mediaUp(x.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,s.css)({paddingRight:x.spacing(.5)}),highlight:(0,s.css)({backgroundColor:x.colors.success.main,borderRadius:x.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(k,A,e)=>{"use strict";e.d(A,{U:()=>a});var n=e(74848),s=e(32196),l=e(18828),r=e(85690),i=e(93225),g=e(96540),o=e(40845),d=e(17464),c=e(27746);const a=(0,g.forwardRef)(({alignment:u="left",className:m,children:v,...x},f)=>{const E=g.Children.toArray(v).filter(O=>O!=null),[h,y]=(0,g.useState)(Array(E.length).fill(!1)),b=(0,g.useRef)(null),[D,P]=(0,g.useState)(!1),C=(0,g.useRef)(null),M=(0,g.createRef)(),{overlayProps:I}=(0,i.e)({onClose:()=>P(!1),isDismissable:!0,isOpen:D,shouldCloseOnInteractOutside:O=>{const j=(0,d.gF)();return!C.current?.contains(O)&&!j.contains(O)}},M),{dialogProps:R}=(0,l.s)({},M),T=(0,o.$j)(),S=u==="left"?h.indexOf(!1)-1:h.length,L=p(T,S,u);return(0,g.useLayoutEffect)(()=>{const O=new IntersectionObserver(j=>{j.forEach(N=>{if(N.target instanceof HTMLElement&&N.target.parentNode){const F=Array.prototype.indexOf.call(N.target.parentNode.children,N.target);y(U=>{const w=[...U];return w[F]=N.isIntersecting,w})}})},{threshold:1,root:b.current});return b.current&&Array.from(b.current.children).forEach(j=>{j instanceof HTMLElement&&j!==C.current&&O.observe(j)}),()=>O.disconnect()},[v]),(0,n.jsxs)("div",{ref:b,className:(0,s.cx)(L.container,m),...x,children:[E.map((O,j)=>(0,n.jsx)("div",{style:{order:j,visibility:h[j]?"visible":"hidden"},className:L.childWrapper,children:O},j)),h.includes(!1)&&(0,n.jsxs)("div",{ref:C,className:L.overflowButton,children:[(0,n.jsx)(c.I,{variant:D?"active":"default",tooltip:"Show more items",onClick:()=>P(!D),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),D&&(0,n.jsx)(r.n1,{contain:!0,autoFocus:!0,children:(0,n.jsx)("div",{className:L.overflowItems,ref:M,...I,...R,children:E.map((O,j)=>!h[j]&&O)})})]})]})});a.displayName="ToolbarButtonRow";const p=(u,m,v)=>({overflowButton:(0,s.css)({order:m}),overflowItems:(0,s.css)({alignItems:"center",backgroundColor:u.colors.background.primary,borderRadius:u.shape.radius.default,boxShadow:u.shadows.z2,display:"flex",flexWrap:"wrap",gap:u.spacing(1),marginTop:u.spacing(1),maxWidth:"80vw",padding:u.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:u.zIndex.dropdown}),container:(0,s.css)({alignItems:"center",display:"flex",gap:u.spacing(1),justifyContent:v==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,s.css)({alignItems:"center",display:"flex",gap:u.spacing(1)})})},13840:(k,A,e)=>{"use strict";e.d(A,{A:()=>c});var n=e(74848),s=e(34743),l=e(36376),r=e(7315),i=e(96540),g=e(40845),o=e(18976),d=e(17464);function c({content:a,show:p,placement:u,className:m,wrapperClassName:v,referenceElement:x,renderArrow:f,...E}){const h=(0,g.$j)(),y=(0,i.useRef)(null),b=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()];f&&b.push((0,s.UE)({element:y}));const{context:D,refs:P,floatingStyles:C}=(0,l.we)({open:p,placement:(0,o.O)(u),middleware:b,whileElementsMounted:r.ll,strategy:"fixed"});(0,i.useLayoutEffect)(()=>{P.setReference(x)},[x,P]);const{styles:M}=(0,l.DL)(D,{initial:()=>({opacity:0}),duration:h.transitions.duration.enteringScreen});return p?(0,n.jsx)(d.ZL,{children:(0,n.jsx)("div",{ref:P.setFloating,style:{...C,...M},className:v,...E,children:(0,n.jsxs)("div",{className:m,children:[f&&(0,n.jsx)(l.ie,{fill:h.colors.border.weak,ref:y,context:D}),typeof a=="string"&&a,i.isValidElement(a)&&i.cloneElement(a),typeof a=="function"&&a({})]})})}):void 0}},95868:(k,A,e)=>{"use strict";e.d(A,{I:()=>s});var n=e(96540);class s extends n.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:r,content:i,placement:g="auto"}=this.props,{show:o}=this.state;return r(this.showPopper,this.hidePopper,{show:o,placement:g,content:i})}}},56034:(k,A,e)=>{"use strict";e.d(A,{m:()=>a});var n=e(74848),s=e(34743),l=e(36376),r=e(7315),i=e(96540),g=e(13544),o=e(40845),d=e(18976),c=e(17464);const a=(0,i.forwardRef)(({children:u,theme:m,interactive:v,show:x,placement:f,content:E},h)=>{const y=(0,i.useRef)(null),[b,D]=(0,i.useState)(x),P=x??b,C=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)(),(0,s.UE)({element:y})],{context:M,refs:I,floatingStyles:R}=(0,l.we)({open:P,placement:(0,d.O)(f),onOpenChange:D,middleware:C,whileElementsMounted:r.ll}),T=(0,i.useId)(),S=(0,l.Mk)(M,{delay:{close:v?100:0},move:!1}),L=(0,l.iQ)(M),O=(0,l.s9)(M),{getReferenceProps:j,getFloatingProps:N}=(0,l.bv)([O,S,L]),F=typeof E=="function",w=(0,o.of)(p)[m??"info"],B=(0,i.useCallback)(W=>{I.setReference(W),typeof h=="function"?h(W):h&&(h.current=W)},[h,I]),K="aria-label"in u.props&&u.props["aria-label"]===E;return(0,n.jsxs)(n.Fragment,{children:[(0,i.cloneElement)(u,{ref:B,tabIndex:0,"aria-describedby":!K&&P?T:void 0,...j()}),P&&(0,n.jsx)(c.ZL,{children:(0,n.jsxs)("div",{ref:I.setFloating,style:R,...N(),children:[(0,n.jsx)(l.ie,{className:w.arrow,ref:y,context:M}),(0,n.jsxs)("div",{"data-testid":g.Tp.components.Tooltip.container,id:T,role:"tooltip",className:w.container,children:[typeof E=="string"&&E,(0,i.isValidElement)(E)&&(0,i.cloneElement)(E),F&&E({})]})]})})]})});a.displayName="Tooltip";const p=u=>{const m=(0,d.f)(u,u.components.tooltip.background,u.components.tooltip.background,u.components.tooltip.text,{topBottom:.5,rightLeft:1}),v=(0,d.f)(u,u.colors.error.main,u.colors.error.main,u.colors.error.contrastText,{topBottom:.5,rightLeft:1});return{info:m,"info-alt":m,error:v}}},5313:(k,A,e)=>{"use strict";e.d(A,{z:()=>r});var n=e(74848),s=e(96540);function l(i,g){const o=[];return i.forEach(d=>{o.push(d.start,d.end+1)}),o[0]!==0&&o.unshift(0),o[o.length-1]!==g&&o.push(g),o}const r=i=>{let{highlightParts:g,text:o,highlightClassName:d}=i;if(!g?.length)return null;let c=[],a=l(g,o.length),p=g[0].start===0;for(let u=1;u<a.length;u++){let m=a[u-1],v=a[u];c.push((0,s.createElement)(p?"mark":"span",{key:u-1,className:p?d:void 0},o.substring(m,v))),p=!p}return(0,n.jsx)("div",{children:c})}},2056:(k,A,e)=>{"use strict";e.d(A,{p:()=>g});var n=e(74848),s=e(96540),l=e(83195),r=e(3988);function i(o){return`Custom unit: ${o}`}class g extends s.PureComponent{constructor(){super(...arguments),this.onChange=d=>{this.props.onChange(d.value)}}render(){const{value:d,width:c}=this.props;let a;const u=(0,l.Ke)().map(m=>{const v=m.submenu.map(x=>{const f={label:x.text,value:x.value};return x.value===d&&(a=f),f});return{label:m.text,value:m.text,items:v}});return d&&!a&&(a={value:d,label:d}),(0,n.jsx)(r.v,{width:c,initialValue:a&&a.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:i,options:u,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(k,A,e)=>{"use strict";e.d(A,{e:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(16795);const i=({src:o,alt:d,width:c,height:a})=>{const p=(0,l.of)(g,c,a);return(0,n.jsx)("img",{className:p.image,src:o,alt:d})},g=(o,d=3,c=3)=>({image:(0,s.css)([(0,r.Y)(o,d,a=>({width:o.spacing(a)})),(0,r.Y)(o,c,a=>({height:o.spacing(a)})),{borderRadius:o.shape.radius.circle}])})},99635:(k,A,e)=>{"use strict";e.d(A,{n:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(47232),i=e(40845),g=e(56034);const o=u=>{const v=(0,r.KQ)(u).diff((0,r.KQ)(),"hours",!1);return`Active last ${(Math.floor(-v/24)+1)*24}h`},d=u=>{if(!u)return"";const[m,v]=u.split(" ");return`${m?.[0]??""}${v?.[0]??""}`.toUpperCase()},c=({userView:u,className:m,children:v,onClick:x,showTooltip:f=!0})=>{const{user:E,lastActiveAt:h}=u,y=(0,r.KQ)(h).diff((0,r.KQ)(),"minutes",!0)>=-15,b=(0,i.$j)(),D=(0,l.useMemo)(()=>p(b,y),[b,y]),P=(0,n.jsx)("button",{type:"button",onClick:x,className:(0,s.cx)(D.container,x&&D.pointer,m),"aria-label":`${E.name} icon`,children:v?(0,n.jsx)("div",{className:(0,s.cx)(D.content,D.textContent),children:v}):E.avatarUrl?(0,n.jsx)("img",{className:D.content,src:E.avatarUrl,alt:`${E.name} avatar`}):(0,n.jsx)("div",{className:(0,s.cx)(D.content,D.textContent),children:d(E.name)})});if(f){const C=(0,n.jsxs)("div",{className:D.tooltipContainer,children:[(0,n.jsx)("div",{className:D.tooltipName,children:E.name}),(0,n.jsx)("div",{className:D.tooltipDate,children:y?(0,n.jsxs)("div",{className:D.dotContainer,children:[(0,n.jsx)("span",{children:"Active last 15m"}),(0,n.jsx)("span",{className:D.dot})]}):o(h)})]});return(0,n.jsx)(g.m,{content:C,children:P})}else return P},a=u=>`0 0 0 1px ${u}`,p=(u,m)=>{const v=m?u.colors.primary.main:u.colors.border.medium,x=m?u.colors.primary.text:u.colors.border.strong;return{container:(0,s.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:u.shape.radius.circle,"& > *":{borderRadius:u.shape.radius.circle}}),content:(0,s.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${u.colors.background.primary} solid`,boxShadow:a(v),backgroundClip:"padding-box","&:hover":{boxShadow:a(x)}}),textContent:(0,s.css)({background:u.colors.background.primary,padding:0,color:u.colors.text.secondary,textAlign:"center",fontSize:u.typography.size.sm,"&:focus":{boxShadow:a(v)}}),tooltipContainer:(0,s.css)({textAlign:"center",padding:u.spacing(0,1)}),tooltipName:(0,s.css)({fontWeight:u.typography.fontWeightBold}),tooltipDate:(0,s.css)({fontWeight:u.typography.fontWeightRegular}),dotContainer:(0,s.css)({display:"flex",alignItems:"center"}),dot:(0,s.css)({height:"6px",width:"6px",backgroundColor:u.colors.primary.main,borderRadius:u.shape.radius.circle,display:"inline-block",marginLeft:u.spacing(1)}),pointer:(0,s.css)({cursor:"pointer"})}}},51986:(k,A,e)=>{"use strict";e.d(A,{i:()=>o});var n=e(74848),s=e(96540),l=e(13544),r=e(40845),i=e(55852),g=e(90182);function o({"aria-label":d,label:c,icon:a,options:p,onChange:u,variant:m,minWidth:v=16,size:x="sm",isFullWidth:f=!0,menuPlacement:E,fill:h,buttonCss:y}){const[b,D]=(0,s.useState)(!1),P=(0,r.$j)();return(0,n.jsxs)(n.Fragment,{children:[!b&&(0,n.jsx)(i.$n,{size:x||"sm",className:y,icon:a||"plus",onClick:()=>D(!0),variant:m,fill:h,fullWidth:f,"data-testid":l.Tp.components.ValuePicker.button(d??c),children:c}),b&&(0,n.jsx)("span",{style:{minWidth:P.spacing(v),flexGrow:f?1:void 0},children:(0,n.jsx)(g.l6,{placeholder:c,options:p,"aria-label":l.Tp.components.ValuePicker.select(d??c),isOpen:!0,onCloseMenu:()=>D(!1),autoFocus:!0,onChange:C=>{D(!1),u(C)},menuPlacement:E})})]})}},67266:(k,A,e)=>{"use strict";e.d(A,{KU:()=>o});var n=e(74848),s=e(32196),l=e(49185),r=e(40845),i=e(16797),g=e(40276);const o=({width:a,height:p,legend:u,children:m})=>{const v=(0,r.$j)(),x=(0,r.of)(d),f={display:"flex",width:`${a}px`,height:`${p}px`},[E,h]=(0,l.A)();if(!u)return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{style:f,className:x.viz,children:m(a,p)})});let{placement:y,maxHeight:b="35%",maxWidth:D="60%"}=u.props;document.body.clientWidth<v.breakpoints.values.lg&&(y="bottom");let P=null;const C={};switch(y){case"bottom":f.flexDirection="column",C.maxHeight=b,h.height&&(P={width:a,height:p-h.height});break;case"right":f.flexDirection="row",C.maxWidth=D,h.width&&(P={width:a-h.width,height:p}),u.props.width&&(C.width=u.props.width,P={width:a-u.props.width,height:p});break}return P?.width===0&&(P.width=a),P?.height===0&&(P.height=p),(0,n.jsxs)("div",{style:f,children:[(0,n.jsx)("div",{className:x.viz,children:P&&m(P.width,P.height)}),(0,n.jsx)("div",{style:C,ref:E,children:(0,n.jsx)(g.E,{hideHorizontalTrack:!0,children:u})})]})},d=a=>({viz:(0,s.css)({flexGrow:2,borderRadius:a.shape.radius.default,"&:focus-visible":(0,i.getFocusStyles)(a)})}),c=({children:a})=>(0,n.jsx)(n.Fragment,{children:a});o.Legend=c},94536:(k,A,e)=>{"use strict";e.d(A,{p:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(8066),i=e(40845);const g=l.memo(l.forwardRef(({color:d,className:c,gradient:a,lineStyle:p,...u},m)=>{const v=(0,i.$j)(),x=(0,i.of)(o);let f;if(a){const h=r.uf.get(a).getColors?.(v);h?.length?f=`linear-gradient(90deg, ${h.join(", ")})`:f=v.visualization.getColorByName("")}else f=d;let E;return p?.fill==="dot"&&!a?E={backgroundImage:`radial-gradient(circle at 2px 2px, ${d} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:p?.fill==="dash"&&!a?E={backgroundImage:`linear-gradient(to right, ${d} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:E={background:f,borderRadius:v.shape.radius.pill},(0,n.jsx)("div",{"data-testid":"series-icon",ref:m,className:(0,s.cx)(c,x.forcedColors,x.container),style:E,...u})})),o=d=>({container:(0,s.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,s.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});g.displayName="SeriesIcon"},96516:(k,A,e)=>{"use strict";e.d(A,{t:()=>R});var n=e(74848),s=e(96540),l=e(69129),r=e(52622),i=e(79041),g=e(88895),o=e(32196),d=e(40845),c=e(1551),a=e(33552),p=e(34375);const u=({items:T,itemRenderer:S,onLabelMouseOver:L,onLabelMouseOut:O,onLabelClick:j,placement:N,className:F,readonly:U})=>{const w=(0,d.of)(m);S||(S=K=>(0,n.jsx)(p.M,{item:K,onLabelClick:j,onLabelMouseOver:L,onLabelMouseOut:O,readonly:U}));const B=K=>`${K.getItemKey?K.getItemKey():K.label}`;switch(N){case"right":{const K=(W,z)=>(0,n.jsx)("span",{className:w.itemRight,children:S(W,z)});return(0,n.jsx)("div",{className:(0,o.cx)(w.rightWrapper,F),children:(0,n.jsx)(a.B,{items:T,renderItem:K,getItemKey:B})})}case"bottom":default:{const K=T.filter(Y=>Y.yAxis===1),W=T.filter(Y=>Y.yAxis!==1),z=(Y,X)=>(0,n.jsx)("span",{className:w.itemBottom,children:S(Y,X)});return(0,n.jsxs)("div",{className:(0,o.cx)(w.bottomWrapper,F),children:[K.length>0&&(0,n.jsx)("div",{className:w.section,children:(0,n.jsx)(c.c,{items:K,renderItem:z,getItemKey:B})}),W.length>0&&(0,n.jsx)("div",{className:(0,o.cx)(w.section,w.sectionRight),children:(0,n.jsx)(c.c,{items:W,renderItem:z,getItemKey:B})})]})}}};u.displayName="VizLegendList";const m=T=>{const S=(0,o.css)({paddingRight:"10px",display:"flex",fontSize:T.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:S,itemRight:(0,o.cx)(S,(0,o.css)({marginBottom:T.spacing(.5)})),rightWrapper:(0,o.css)({paddingLeft:T.spacing(.5)}),bottomWrapper:(0,o.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",paddingLeft:T.spacing(.5),gap:"15px 25px"}),section:(0,o.css)({display:"flex"}),sectionRight:(0,o.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var v=e(14578),x=e(83195),f=e(16797),E=e(94134);const h=({item:T,onLabelClick:S,onLabelMouseOver:L,onLabelMouseOut:O,className:j,readonly:N})=>{const F=(0,d.of)(y),U=(0,s.useCallback)(K=>{L&&L(T,K)},[T,L]),w=(0,s.useCallback)(K=>{O&&O(T,K)},[T,O]),B=(0,s.useCallback)(K=>{S&&S(T,K)},[T,S]);return(0,n.jsxs)("tr",{className:(0,o.cx)(F.row,j),children:[(0,n.jsx)("td",{children:(0,n.jsxs)("span",{className:F.itemWrapper,children:[(0,n.jsx)(E.R,{color:T.color,seriesName:T.fieldName??T.label,readonly:N,lineStyle:T.lineStyle}),(0,n.jsxs)("button",{disabled:N,type:"button",title:T.label,onBlur:w,onFocus:U,onMouseOver:U,onMouseOut:w,onClick:N?void 0:B,className:(0,o.cx)(F.label,T.disabled&&F.labelDisabled),children:[T.label," ",T.yAxis===2&&(0,n.jsx)("span",{className:F.yAxisLabel,children:"(right y-axis)"})]})]})}),T.getDisplayValues&&T.getDisplayValues().map((K,W)=>(0,n.jsx)("td",{className:F.value,children:(0,x.cN)(K)},`${K.title}-${W}`))]})};h.displayName="LegendTableItem";const y=T=>{const S=f.hoverColor(T.colors.background.primary,T);return{row:(0,o.css)({label:"LegendRow",fontSize:T.v1.typography.size.sm,borderBottom:`1px solid ${T.colors.border.weak}`,td:{padding:T.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:S}}),label:(0,o.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,o.css)({label:"LegendLabelDisabled",color:T.colors.text.disabled}),itemWrapper:(0,o.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,o.css)({textAlign:"right"}),yAxisLabel:(0,o.css)({color:T.colors.text.secondary})}},b="Name",D=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,P=({items:T,sortBy:S,sortDesc:L,itemRenderer:O,className:j,onToggleSort:N,onLabelClick:F,onLabelMouseOver:U,onLabelMouseOut:w,readonly:B,isSortable:K})=>{const W=(0,d.of)(C),z={};K&&(z[b]="");for(const Y of T)if(Y.getDisplayValues)for(const X of Y.getDisplayValues())z[X.title??"?"]=X.description??"";if(S!=null){let Y=new Map;T.forEach(q=>{if(S!==b&&q.getDisplayValues){const G=q.getDisplayValues().find(H=>H.title===S),te=G==null||Number.isNaN(G.numeric)?-1/0:G.numeric;Y.set(q,te)}});let X=L?-1:1;S===b?T.sort((q,G)=>X*D(q.label,G.label)):T.sort((q,G)=>{const te=Y.get(q)??0,H=Y.get(G)??0;return X*(te-H)})}return O||(O=(Y,X)=>(0,n.jsx)(h,{item:Y,onLabelClick:F,onLabelMouseOver:U,onLabelMouseOut:w,readonly:B},`${Y.label}-${X}`)),(0,n.jsxs)("table",{className:(0,o.cx)(W.table,j),children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[!K&&(0,n.jsx)("th",{}),Object.keys(z).map(Y=>(0,n.jsxs)("th",{title:z[Y],className:(0,o.cx)(W.header,N&&W.headerSortable,K&&W.nameHeader,{[W.withIcon]:S===Y}),onClick:()=>{N&&N(Y)},children:[Y,S===Y&&(0,n.jsx)(v.I,{size:"xs",name:L?"angle-down":"angle-up"})]},Y))]})}),(0,n.jsx)("tbody",{children:T.map(O)})]})},C=T=>({table:(0,o.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${T.colors.border.weak}`}}),header:(0,o.css)({color:T.colors.primary.text,fontWeight:T.typography.fontWeightMedium,borderBottom:`1px solid ${T.colors.border.weak}`,padding:T.spacing(.25,1,.25,1),fontSize:T.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,o.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,o.css)({paddingRight:"4px"}),headerSortable:(0,o.css)({cursor:"pointer"})});var M=e(29995),I=e(44895);function R({items:T,displayMode:S,sortBy:L,seriesVisibilityChangeBehavior:O=M.K.Isolate,sortDesc:j,onLabelClick:N,onToggleSort:F,placement:U,className:w,itemRenderer:B,readonly:K,isSortable:W}){const{eventBus:z,onToggleSeriesVisibility:Y,onToggleLegendSort:X}=(0,i.d2)(),q=(0,s.useCallback)((H,se)=>{z?.publish({type:l.b_.type,payload:{raw:se,x:0,y:0,dataId:H.label}})},[z]),G=(0,s.useCallback)((H,se)=>{z?.publish({type:l.ql.type,payload:{raw:se,x:0,y:0,dataId:H.label}})},[z]),te=(0,s.useCallback)((H,se)=>{N&&N(H,se),Y&&Y(H.fieldName??H.label,O===M.K.Hide?g.B.AppendToSelection:(0,I.W)(se))},[Y,N,O]);switch(S){case r.lm.Table:return(0,n.jsx)(P,{className:w,items:T,placement:U,sortBy:L,sortDesc:j,onLabelClick:te,onToggleSort:F||X,onLabelMouseOver:q,onLabelMouseOut:G,itemRenderer:B,readonly:K,isSortable:W});case r.lm.List:return(0,n.jsx)(u,{className:w,items:T,placement:U,onLabelMouseOver:q,onLabelMouseOut:G,onLabelClick:te,itemRenderer:B,readonly:K});default:return null}}R.displayName="VizLegend"},34375:(k,A,e)=>{"use strict";e.d(A,{M:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(94134),o=e(2543),d=e(83195),c=e(1551);const a=({stats:v})=>{const x=(0,i.of)(p);return v.length===0?null:(0,n.jsx)(c.c,{className:x.list,items:v,renderItem:f=>(0,n.jsxs)("div",{className:x.item,title:f.description,children:[f.title&&`${(0,o.capitalize)(f.title)}:`," ",(0,d.cN)(f)]})})},p=()=>({list:(0,s.css)({flexGrow:1,textAlign:"right"}),item:(0,s.css)({marginLeft:"8px"})});a.displayName="VizLegendStatsList";const u=({item:v,onLabelClick:x,onLabelMouseOver:f,onLabelMouseOut:E,className:h,readonly:y})=>{const b=(0,i.of)(m),D=(0,l.useCallback)(M=>{f&&f(v,M)},[v,f]),P=(0,l.useCallback)(M=>{E&&E(v,M)},[v,E]),C=(0,l.useCallback)(M=>{x&&x(v,M)},[v,x]);return(0,n.jsxs)("div",{className:(0,s.cx)(b.itemWrapper,v.disabled&&b.itemDisabled,h),"data-testid":r.Tp.components.VizLegend.seriesName(v.label),children:[(0,n.jsx)(g.R,{seriesName:v.fieldName??v.label,color:v.color,gradient:v.gradient,readonly:y,lineStyle:v.lineStyle}),(0,n.jsx)("button",{disabled:y,type:"button",onBlur:P,onFocus:D,onMouseOver:D,onMouseOut:P,onClick:C,className:b.label,children:v.label}),v.getDisplayValues&&(0,n.jsx)(a,{stats:v.getDisplayValues()})]})};u.displayName="VizLegendListItem";const m=v=>({label:(0,s.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,s.css)({label:"LegendLabelDisabled",color:v.colors.text.disabled}),itemWrapper:(0,s.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,s.css)({textAlign:"right"}),yAxisLabel:(0,s.css)({color:v.v1.palette.gray2})})},94134:(k,A,e)=>{"use strict";e.d(A,{R:()=>g});var n=e(74848),s=e(96540),l=e(83598),r=e(79041),i=e(94536);const g=(0,s.memo)(({seriesName:o,color:d,gradient:c,readonly:a,lineStyle:p})=>{const{onSeriesColorChange:u}=(0,r.d2)(),m=(0,s.useCallback)(v=>u(o,v),[o,u]);return o&&u&&d&&!a?(0,n.jsx)(l.Dp,{color:d,onChange:m,enableNamedColors:!0,children:({ref:v,showColorPicker:x,hideColorPicker:f})=>(0,n.jsx)(i.p,{color:d,className:"pointer",ref:v,onClick:x,onMouseLeave:f,lineStyle:p})}):(0,n.jsx)(i.p,{color:d,gradient:c,lineStyle:p})});g.displayName="VizLegendSeriesIcon"},29995:(k,A,e)=>{"use strict";e.d(A,{K:()=>n});var n=(s=>(s[s.Isolate=0]="Isolate",s[s.Hide=1]="Hide",s))(n||{})},44895:(k,A,e)=>{"use strict";e.d(A,{W:()=>s});var n=e(88895);function s(l){return l.ctrlKey||l.metaKey||l.shiftKey?n.B.AppendToSelection:n.B.ToggleSelection}},12509:(k,A,e)=>{"use strict";e.d(A,{S:()=>o});var n=e(74848),s=e(2543),l=e(96540),r=e(47070);const i=(c,a,p,u)=>{const m=g(c,a,u),v=g(a,c,u),x=Math.max(m,v);let f=Math.floor(c/x),E=Math.ceil(u/f);f=Math.ceil(u/E);const h=f-(f*E-u),y=c/h-p+p/h;return{width:c/f-p+p/f,height:a/E-p+p/E,widthOnLastRow:y,xCount:f,yCount:E}};function g(c,a,p){const u=Math.ceil(Math.sqrt(p*c/a));return Math.floor(u*a/c)*u<p?a/Math.ceil(u*a/c):c/u}class o extends l.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(a){super(a),this.state={values:a.getValues()}}componentDidUpdate(a){const{renderCounter:p,source:u}=this.props;(p!==a.renderCounter||u!==a.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:a,width:p,height:u}=this.props;return a===r.wV.Auto?p>u?r.wV.Vertical:r.wV.Horizontal:a}renderGrid(){const{renderValue:a,height:p,width:u,itemSpacing:m,getAlignmentFactors:v,orientation:x}=this.props,{values:f}=this.state,E=i(u,p,m,f.length),h=v?v(f,E.width,E.height):{};let y=0,b=0,D=[];for(let P=0;P<f.length;P++){const C=f[P],I=b===E.yCount-1?E.widthOnLastRow:E.width,R=E.height,T=y*I+m*y,S=b*R+m*b,L={position:"absolute",left:T,top:S,width:`${I}px`,height:`${R}px`};D.push((0,n.jsx)("div",{style:L,children:a({value:C,width:I,height:R,alignmentFactors:h,orientation:x,count:f.length})},P)),y++,y===E.xCount&&(y=0,b++)}return(0,n.jsx)("div",{style:{position:"relative"},children:D})}render(){const{renderValue:a,height:p,width:u,itemSpacing:m,getAlignmentFactors:v,autoGrid:x,orientation:f,maxVizHeight:E,minVizWidth:h,minVizHeight:y}=this.props,{values:b}=this.state;if(x&&f===r.wV.Auto)return this.renderGrid();const D={display:"flex"},P={display:"flex",overflow:`${h?"auto":"hidden"} ${y?"auto":"hidden"}`};let C=p,M=u;const I=this.getOrientation();switch(I){case r.wV.Horizontal:const T=(p+m)/b.length-m;P.flexDirection="column",P.height=`${p}px`,D.marginBottom=`${m}px`,M=u,C=(0,s.clamp)(T,y??0,E??T);break;case r.wV.Vertical:P.flexDirection="row",P.justifyContent="space-between",D.marginRight=`${m}px`,C=p,M=Math.max(u/b.length-m+m/b.length,h??0)}D.width=`${M}px`,D.height=`${C}px`;const R=v?v(b,M,C):{};return(0,n.jsx)("div",{style:P,children:b.map((T,S)=>(0,n.jsx)("div",{style:d(D,S,b.length),children:a({value:T,width:M,height:C,alignmentFactors:R,orientation:I,count:b.length})},S))})}}function d(c,a,p){return a===p-1?{...c,marginRight:0,marginBottom:0}:c}},3139:(k,A,e)=>{"use strict";e.d(A,{g:()=>g,o:()=>o});var n=e(74848),s=e(32196),l=e(40845),r=e(94536);const i=d=>({icon:(0,s.css)({marginRight:d.spacing(1),verticalAlign:"middle"}),seriesTable:(0,s.css)({display:"table"}),seriesTableRow:(0,s.css)({display:"table-row",fontSize:d.typography.bodySmall.fontSize}),seriesTableCell:(0,s.css)({display:"table-cell"}),label:(0,s.css)({wordBreak:"break-all"}),value:(0,s.css)({paddingLeft:d.spacing(2),textAlign:"right"}),activeSeries:(0,s.css)({fontWeight:d.typography.fontWeightBold,color:d.colors.text.maxContrast}),timestamp:(0,s.css)({fontWeight:d.typography.fontWeightBold,fontSize:d.typography.bodySmall.fontSize})}),g=({color:d,label:c,value:a,isActive:p})=>{const u=(0,l.of)(i);return(0,n.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,s.cx)(u.seriesTableRow,p&&u.activeSeries),children:[d&&(0,n.jsx)("div",{className:u.seriesTableCell,children:(0,n.jsx)(r.p,{color:d,className:u.icon})}),c&&(0,n.jsx)("div",{className:(0,s.cx)(u.seriesTableCell,u.label),children:c}),a&&(0,n.jsx)("div",{className:(0,s.cx)(u.seriesTableCell,u.value),children:a})]})},o=({timestamp:d,series:c})=>{const a=(0,l.of)(i);return(0,n.jsxs)(n.Fragment,{children:[d&&(0,n.jsx)("div",{className:a.timestamp,"aria-label":"Timestamp",children:d}),c.map((p,u)=>(0,n.jsx)(g,{isActive:p.isActive,label:p.label,color:p.color,value:p.value},`${p.label}-${u}`))]})}},75128:(k,A,e)=>{"use strict";e.d(A,{n:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(17464),i=e(69503);const g=({content:d,position:c,offset:a})=>{const p=(0,l.of)(o);return c?(0,n.jsx)(r.ZL,{className:p.portal,children:(0,n.jsx)(i.o,{position:c,offset:a||{x:0,y:0},children:d})}):null};g.displayName="VizTooltip";const o=()=>({portal:(0,s.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})})},69503:(k,A,e)=>{"use strict";e.d(A,{o:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(52908),i=e(40845),g=e(16797),o=e(10875);const d=({position:{x:a,y:p},offset:{x:u,y:m},children:v,allowPointerEvents:x=!1,className:f,...E})=>{const h=(0,l.useRef)(null),[y,b]=(0,l.useState)({width:0,height:0}),{width:D,height:P}=(0,r.A)(),[C,M]=(0,l.useState)({x:a+u,y:p+m}),I=(0,l.useMemo)(()=>new ResizeObserver(T=>{for(let S of T){const L=Math.floor(S.contentRect.width+16),O=Math.floor(S.contentRect.height+2*8);(y.width!==L||y.height!==O)&&b({width:Math.min(L,D),height:Math.min(O,P)})}}),[y,D,P]);(0,l.useLayoutEffect)(()=>(h.current&&I.observe(h.current),()=>{I.disconnect()}),[I]),(0,l.useLayoutEffect)(()=>{if(h&&h.current){const{x:T,y:S}=(0,o.Ju)(a,p,y.width,y.height,u,m,D,P);M({x:T,y:S})}},[D,P,a,u,p,m,y]);const R=(0,i.of)(c);return(0,n.jsx)("div",{ref:h,style:{position:"fixed",left:0,pointerEvents:x?"auto":"none",top:0,transform:`translate(${C.x}px, ${C.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...E,className:(0,s.cx)(R.wrapper,f),children:v})};d.displayName="VizTooltipContainer";const c=a=>({wrapper:(0,s.css)((0,g.getTooltipContainerStyles)(a))})},11389:(k,A,e)=>{"use strict";e.d(A,{o:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(13471);const i=({items:o,children:d,isPinned:c,scrollable:a=!1,maxHeight:p})=>{const u=(0,l.of)(g),m=a?{maxHeight:p,overflowY:"auto"}:{};return(0,n.jsxs)("div",{className:u.wrapper,style:m,children:[o.map(({label:v,value:x,color:f,colorIndicator:E,colorPlacement:h,isActive:y,lineStyle:b},D)=>(0,n.jsx)(r.B,{label:v,value:x,color:f,colorIndicator:E,colorPlacement:h,isActive:y,justify:"space-between",isPinned:c,lineStyle:b,showValueScroll:!a},D)),d]})},g=o=>({wrapper:(0,s.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${o.colors.border.medium}`,padding:o.spacing(1)})})},58749:(k,A,e)=>{"use strict";e.d(A,{S:()=>d});var n=e(74848),s=e(32196),l=e(67061),r=e(14689),i=e(55852),g=e(40845);const o="add-annotation-button",d=({dataLinks:a,annotate:p})=>{const u=(0,g.of)(c),m=()=>{const v={variant:"secondary"};return(0,n.jsx)(l.B,{direction:"column",justifyContent:"flex-start",children:a.map((x,f)=>(0,n.jsx)(r.R,{link:x,buttonProps:v},f))})};return(0,n.jsxs)("div",{className:u.wrapper,children:[a.length>0&&(0,n.jsx)("div",{className:u.dataLinks,children:m()}),p!=null&&(0,n.jsx)("div",{className:u.addAnnotations,children:(0,n.jsx)(i.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:o,onClick:p,children:"Add annotation"})})]})},c=a=>({wrapper:(0,s.css)({display:"flex",flexDirection:"column",flex:1,padding:a.spacing(0)}),dataLinks:(0,s.css)({borderTop:`1px solid ${a.colors.border.medium}`,padding:a.spacing(1)}),addAnnotations:(0,s.css)({borderTop:`1px solid ${a.colors.border.medium}`,padding:a.spacing(1)})})},52415:(k,A,e)=>{"use strict";e.d(A,{A:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(13471);const i=({item:o,isPinned:d})=>{const c=(0,l.of)(g),{label:a,value:p,color:u,colorIndicator:m}=o;return(0,n.jsx)("div",{className:c.wrapper,children:(0,n.jsx)(r.B,{label:a,value:p,color:u,colorIndicator:m,marginRight:"22px",isPinned:d})})},g=o=>({wrapper:(0,s.css)({display:"flex",flexDirection:"column",flex:1,padding:o.spacing(1)})})},13471:(k,A,e)=>{"use strict";e.d(A,{B:()=>h});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(32982),g=e(56034),o=e(24293),d=e(94536),c=e(79871),a=e(10875),p=(b=>(b[b.Leading=0]="Leading",b[b.Trailing=1]="Trailing",b))(p||{});const u=({color:b=o.F,colorIndicator:D=c.Ev,position:P=0,lineStyle:C})=>{const M=(0,r.of)(m);return D===c.fX.series?(0,n.jsx)(d.p,{color:b,lineStyle:C,className:P===0?M.leading:M.trailing}):(0,n.jsx)("span",{style:{backgroundColor:b},className:(0,s.cx)(P===0?M.leading:M.trailing,(0,a.L$)(D,M))})},m=b=>({leading:(0,s.css)({marginRight:b.spacing(.5)}),trailing:(0,s.css)({marginLeft:b.spacing(.5)}),value:(0,s.css)({width:"12px",height:"12px",borderRadius:b.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,s.css)({}),pie_1_4:(0,s.css)({}),pie_2_4:(0,s.css)({}),pie_3_4:(0,s.css)({}),marker_sm:(0,s.css)({width:"4px",height:"4px",borderRadius:b.shape.radius.circle,minWidth:"4px"}),marker_md:(0,s.css)({width:"8px",height:"8px",borderRadius:b.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,s.css)({width:"12px",height:"12px",borderRadius:b.shape.radius.circle,minWidth:"12px"})});var v=(b=>(b.label="label",b.value="value",b))(v||{});const x="Copied to clipboard",f=2*1e3,E=7,h=({label:b,value:D,color:P,colorIndicator:C,colorPlacement:M=c.lJ.first,justify:I="flex-start",isActive:R=!1,marginRight:T="0px",isPinned:S,lineStyle:L,showValueScroll:O})=>{const j=(0,r.of)(y,I,T),N=O?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"auto"}:{whiteSpace:"wrap",wordBreak:"break-word"},[F,U]=(0,l.useState)(!1),[w,B]=(0,l.useState)(null),[K,W]=(0,l.useState)(!1),z=(0,l.useRef)(null),Y=(0,l.useRef)(null);(0,l.useEffect)(()=>{let H;return K&&(H=setTimeout(()=>{W(!1)},f)),()=>{window.clearTimeout(H)}},[K]);const X=async(H,se)=>{if(!(navigator?.clipboard&&window.isSecureContext)){q(H,se);return}try{await navigator.clipboard.writeText(H),B({[`${se}`]:H}),W(!0)}catch{B(null)}},q=(H,se)=>{const ne=document.createElement("textarea");z.current?.appendChild(ne),ne.value=H,ne.focus(),ne.select();try{document.execCommand("copy")&&(B({[`${se}`]:H}),W(!0))}catch(le){console.error("Unable to copy to clipboard",le)}ne.remove()},G=H=>{H.currentTarget.offsetWidth<H.currentTarget.scrollWidth&&U(!0)},te=()=>U(!1);return b.length*E>window.innerWidth/2&&(b=b.replaceAll("{",`{
  `).replaceAll("}",`
}`).replaceAll(", ",`,
  `)),(0,n.jsxs)("div",{className:j.contentWrapper,children:[(P||b)&&(0,n.jsxs)("div",{className:j.valueWrapper,children:[P&&M===c.lJ.first&&(0,n.jsx)(u,{color:P,colorIndicator:C,lineStyle:L}),S?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(g.m,{content:b,interactive:!1,show:F,children:(0,n.jsxs)(n.Fragment,{children:[K&&w?.label&&(0,n.jsx)(i.r,{placement:"top",referenceElement:z.current,children:x}),(0,n.jsx)("div",{className:(0,s.cx)(j.label,R&&j.activeSeries,navigator?.clipboard&&j.copy),onMouseEnter:G,onMouseLeave:te,onClick:()=>X(b,"label"),ref:z,children:b})]})})}):(0,n.jsx)("div",{className:(0,s.cx)(j.label,R&&j.activeSeries),children:b})]}),(0,n.jsxs)("div",{className:j.valueWrapper,children:[P&&M===c.lJ.leading&&(0,n.jsx)(u,{color:P,colorIndicator:C,position:p.Leading,lineStyle:L}),S?(0,n.jsxs)(n.Fragment,{children:[K&&w?.value&&(0,n.jsx)(i.r,{placement:"top",referenceElement:Y.current,children:x}),(0,n.jsx)("div",{className:(0,s.cx)(j.value,R,navigator?.clipboard&&j.copy),style:N,onClick:()=>X(D?D.toString():"","value"),ref:Y,children:D})]}):(0,n.jsx)("div",{className:(0,s.cx)(j.value,R),style:N,children:D}),P&&M===c.lJ.trailing&&(0,n.jsx)(u,{color:P,colorIndicator:C,position:p.Trailing,lineStyle:L})]})]})},y=(b,D,P)=>({contentWrapper:(0,s.css)({display:"flex",alignItems:"start",justifyContent:D,marginRight:P}),label:(0,s.css)({color:b.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:b.spacing(2)}),value:(0,s.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,s.css)({display:"flex",alignItems:"center"}),activeSeries:(0,s.css)({fontWeight:b.typography.fontWeightBold,color:b.colors.text.maxContrast}),copy:(0,s.css)({cursor:"pointer"})})},79871:(k,A,e)=>{"use strict";e.d(A,{Ev:()=>l,fX:()=>n,lJ:()=>s});var n=(r=>(r.series="series",r.value="value",r.hexagon="hexagon",r.pie_1_4="pie_1_4",r.pie_2_4="pie_2_4",r.pie_3_4="pie_3_4",r.marker_sm="marker_sm",r.marker_md="marker_md",r.marker_lg="marker_lg",r))(n||{}),s=(r=>(r.hidden="hidden",r.first="first",r.leading="leading",r.trailing="trailing",r))(s||{});const l="series"},10875:(k,A,e)=>{"use strict";e.d(A,{Ju:()=>o,L$:()=>d,cp:()=>u});var n=e(11261),s=e(8066),l=e(83195),r=e(24293),i=e(52622),g=e(79871);const o=(m=0,v=0,x=0,f=0,E=0,h=0,y=0,b=0)=>{let D=m,P=v;const C=Math.max(m+E+x-(y-E),0),M=Math.abs(Math.min(m-E-x-E,0)),I=C>0,R=M>0,T=Math.max(v+h+f-(b-h),0),S=Math.abs(Math.min(v-h-f-h,0)),L=T>0,O=S>0;return I&&R?D=C>M?E:y-E-x:I?D=m-E-x:D=m+E,L&&O?P=T>S?h:b-h-f:L?P=v-h-f:P=v+h,{x:D,y:P}},d=(m,v)=>{switch(m){case g.fX.value:return v.value;case g.fX.hexagon:return v.hexagon;case g.fX.pie_1_4:return v.pie_1_4;case g.fX.pie_2_4:return v.pie_2_4;case g.fX.pie_3_4:return v.pie_3_4;case g.fX.marker_sm:return v.marker_sm;case g.fX.marker_md:return v.marker_md;case g.fX.marker_lg:return v.marker_lg;default:return v.value}},c=(m,v)=>m.numeric-v.numeric,a=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),p=(m,v)=>a.compare(`${m.value}`,`${v.value}`),u=(m,v,x,f,E,h,y=b=>!0)=>{let b=[],D=!0;for(let P=0;P<m.length;P++){const C=m[P];if(C===v||C.type===n.PU.time||!y(C)||C.config.custom?.hideFrom?.tooltip||C.config.custom?.hideFrom?.viz||E===i.$N.Single&&f!==P)continue;let M=x[P];if(M==null)continue;C.type===n.PU.number||C.type===n.PU.boolean||C.type===n.PU.enum||(D=!1);const I=m[P].values[M];if(I==null&&C.config.noValue==null)continue;const R=C.display(I),T=Number.isNaN(R.numeric)?h===i.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:R.numeric,S=(0,s.Qi)(C);let L=g.fX.series,O=g.lJ.first;S.isByValue&&(L=g.fX.value,O=g.lJ.trailing),b.push({label:C.state?.displayName??C.name,value:(0,l.cN)(R),color:R.color??r.F,colorIndicator:L,colorPlacement:O,isActive:E===i.$N.Multi&&f===P,numeric:T,lineStyle:C.config.custom?.lineStyle})}if(h!==i.xB.None&&b.length>1){const P=D?c:p,C=h===i.xB.Descending?-1:1;b.sort((M,I)=>C*P(M,I))}return b}},94333:(k,A,e)=>{"use strict";e.r(A),e.d(A,{Alert:()=>De.F,AlertingSettings:()=>Ve.i,AsyncMultiSelect:()=>gr.Iv,AsyncSelect:()=>gr.DW,AsyncVirtualizedSelect:()=>gr.gZ,AutoSaveField:()=>te.p,AutoSizeInput:()=>Si.D,Avatar:()=>Kn.e,Badge:()=>Oo.E,BarGauge:()=>Ct.xE,BarGaugeDisplayMode:()=>wa.eX,BigValue:()=>_e.yV,BigValueColorMode:()=>_e.yp,BigValueGraphMode:()=>_e.$p,BigValueJustifyMode:()=>_e.F8,BigValueTextMode:()=>_e.SV,Box:()=>bs.a,BrowserLabel:()=>hi.J,Button:()=>pn.$n,ButtonCascader:()=>D.H,ButtonGroup:()=>Jn.e,ButtonSelect:()=>Zo.f,CallToActionCard:()=>sn.c,Card:()=>Po.Z,CardContainer:()=>ri.Q,Cascader:()=>b.v,CertificationKey:()=>Qe.K,Checkbox:()=>Ai.S,ClickOutsideWrapper:()=>jt.N,ClipboardButton:()=>y.b,CodeEditor:()=>ae.B,CodeEditorSuggestionItemKind:()=>J.q,CollapsableSection:()=>dt.M,Collapse:()=>ke.S,ColorPicker:()=>I.sk,ColorPickerInput:()=>R.i,ConfirmButton:()=>a.Z,ConfirmModal:()=>_.u,Container:()=>bo.mc,ContextMenu:()=>Yt.t,ControlledCollapse:()=>ke.a,Counter:()=>je.p,CustomHeadersSettings:()=>Ge.P,CustomScrollbar:()=>E.E,DataLinkButton:()=>Pt.R,DataLinkInput:()=>Gt.l,DataLinksContextMenu:()=>Lt.e,DataLinksInlineEditor:()=>Ut.e,DataSourceHttpSettings:()=>St.t,DatePicker:()=>W.l,DatePickerWithInput:()=>z.l,DateTimePicker:()=>Y.K,DeleteButton:()=>p.e,Divider:()=>Rs.c,Drawer:()=>cs._,Dropdown:()=>_t.m,EmptySearchResult:()=>S.Z,EmptyState:()=>L.p,ErrorBoundary:()=>Tn.tH,ErrorBoundaryAlert:()=>Tn.Xw,ErrorWithStack:()=>ht.D,EventBusPlugin:()=>qr.Ku,EventsCanvas:()=>go.a,FIXED_UNIT:()=>po.s,FadeTransition:()=>Ot.A,FeatureBadge:()=>An.y,FeatureInfoBox:()=>Dn.e,Field:()=>Lr.D,FieldArray:()=>fo.E,FieldLinkList:()=>pt.n,FieldSet:()=>Za.n,FieldValidationMessage:()=>Er.P,FileDropzone:()=>Jo.gH,FileDropzoneDefaultChildren:()=>Jo.wI,FileListItem:()=>Jo.IB,FileUpload:()=>ui.e,FilterInput:()=>vi.Z,FilterPill:()=>le.m,Form:()=>Ft.l,FormattedValueDisplay:()=>Ei.i,FullWidthButtonContainer:()=>Tt.V,Gauge:()=>at._,Graph:()=>Rr.T,GraphContextMenu:()=>Vr.H,GraphContextMenuHeader:()=>Vr.i,GraphNG:()=>ja.o,GraphSeriesToggler:()=>Ie.M,GraphWithLegend:()=>tr.I,Grid:()=>La.x,HorizontalGroup:()=>bo.Gy,Icon:()=>d.I,IconButton:()=>c.K,InfoBox:()=>Nt.w,InlineField:()=>Ar.I,InlineFieldRow:()=>rr.C,InlineFormLabel:()=>ns.I,InlineLabel:()=>Fr.c,InlineSegmentGroup:()=>ho.e,InlineSwitch:()=>Bo.K,InlineToast:()=>P.r,Input:()=>Yo.p,InputControl:()=>ut.e,InteractiveTable:()=>q.j,JSONFormatter:()=>Pn.B,JsonExplorer:()=>Xn.O,KeyboardPlugin:()=>qr.Z7,Label:()=>Ta.J,LegacyForms:()=>zn,LegacyInputStatus:()=>s.O,Legend:()=>$r.s,Link:()=>ea.N,LinkButton:()=>pn.z9,List:()=>X.B,LoadingBar:()=>M.G,LoadingPlaceholder:()=>C._,Marker:()=>go.pH,Menu:()=>qt.W,MenuGroup:()=>bn.r,MenuItem:()=>Mt.D,Modal:()=>de.a,ModalHeader:()=>xe.r,ModalRoot:()=>Te.EO,ModalTabContent:()=>ue.O,ModalTabsHeader:()=>re.J,ModalsContext:()=>Te.wE,ModalsController:()=>Te.$s,ModalsProvider:()=>Te.YO,MultiSelect:()=>gr.KF,PageToolbar:()=>ge.d,Pagination:()=>H.d,PanelChrome:()=>Se.NR,PanelChromeLoadingIndicator:()=>fe.I,PanelContainer:()=>Di._,PanelContextProvider:()=>Ee.XF,PanelContextRoot:()=>Ee.e4,PlotLegend:()=>oo.$,PluginSignatureBadge:()=>cn.B,Popover:()=>v.A,PopoverController:()=>m.I,Portal:()=>f.ZL,PortalContainer:()=>f.qB,QueryField:()=>Q.X,RadioButtonDot:()=>jo.J,RadioButtonGroup:()=>To.z,RadioButtonList:()=>$o.a,RangeSlider:()=>wt.F,ReactMonacoEditor:()=>oe.m,RefreshPicker:()=>N.cC,RelativeTimeRangePicker:()=>xi.N,RenderUserContentAsHTML:()=>Ke.I,ScaleDistribution:()=>wa.L4,SecretInput:()=>ai.L,SecretTextArea:()=>yi.l,SecureSocksProxySettings:()=>lt.Y,Segment:()=>vn.Y,SegmentAsync:()=>ln.s,SegmentInput:()=>On.o,SegmentSection:()=>Un.L,SegmentSelect:()=>wn.a,Select:()=>gr.l6,SelectContainer:()=>gr.KA,SelectMenuOptions:()=>ci.o5,SeriesColorPicker:()=>I.Dp,SeriesColorPickerPopover:()=>T.o,SeriesColorPickerPopoverWithTheme:()=>T.t,SeriesIcon:()=>At.p,SeriesTable:()=>ze.o,SeriesTableRow:()=>ze.g,SeriesVisibilityChangeBehavior:()=>he.K,SeriesVisibilityChangeMode:()=>yo.B,SetInterval:()=>Oe.u,SlideOutTransition:()=>zt.n,Slider:()=>Zn.A,Space:()=>Xs.$,Sparkline:()=>Fe.O,Spinner:()=>vt.y,Stack:()=>Ys.B,StatsPicker:()=>j.S,Switch:()=>Bo.d,TLSAuthSettings:()=>It.j,Tab:()=>qe.o,TabContent:()=>Ce.J,TabbedContainer:()=>h.q,Table:()=>Ue.X,TableInputCSV:()=>Xe.b,TabsBar:()=>we.U,Tag:()=>se.v,TagList:()=>ne.L,TagsInput:()=>G.u,Text:()=>Hs.E,TextArea:()=>Ho.f,TextLink:()=>Ks.Y,TimeOfDayPicker:()=>w.R,TimePickerTooltip:()=>F.xS,TimeRangeInput:()=>Ri.b,TimeRangeLabel:()=>U.f,TimeRangePicker:()=>F.$6,TimeSeries:()=>Xo.Z,TimeZonePicker:()=>B.U,Toggletip:()=>x.G,ToolbarButton:()=>Qn.I,ToolbarButtonRow:()=>fs.U,Tooltip:()=>u.m,TooltipPlugin:()=>Mn.T,TooltipPlugin2:()=>qr.xl,UPLOT_AXIS_FONT_SIZE:()=>Ma.pi,UPlotChart:()=>ks.Z,UPlotConfigBuilder:()=>pr.e,UnitPicker:()=>O.p,UserIcon:()=>kn.n,ValuePicker:()=>ls.i,VerticalGroup:()=>bo.gW,VerticalTab:()=>We.s,VirtualizedSelect:()=>gr.ip,VizLayout:()=>Pe.KU,VizLegend:()=>be.t,VizLegendListItem:()=>Ae.M,VizRepeater:()=>pe.S,VizTooltip:()=>Dt.n,VizTooltipContainer:()=>tt.o,WeekStartPicker:()=>K.l,WithContextMenu:()=>Jt.n,XYCanvas:()=>go._X,ZoomPlugin:()=>tn.j,buildScaleKey:()=>Rt.My,clearButtonStyles:()=>pn.my,convertOldAngularValueMapping:()=>$t.I1,defaultIntervals:()=>N.cb,fieldMatchersUI:()=>vs.g,getCardStyles:()=>Po.H,getDragStyles:()=>Os.l,getInputStyles:()=>Yo.n,getPortalContainer:()=>f.gF,getSelectStyles:()=>Qo.J,getWeekStart:()=>K.r,graphFieldOptions:()=>na.t,graphTickFormatter:()=>io.Yn,graphTimeFormat:()=>io.Jc,preparePlotFrame:()=>Rt.mY,resetSelectStyles:()=>_o.A,sharedInputStyle:()=>Ht.Xb,sharedSingleStatMigrationHandler:()=>$t._$,sharedSingleStatPanelChangedHandler:()=>$t.gl,useGraphNGContext:()=>Ti.I,usePanelContext:()=>Ee.d2,useSplitter:()=>ha.h,variableSuggestionToCodeEditorSuggestion:()=>ee.O,withErrorBoundary:()=>Tn.Xc});var n=e(90090),s=e(91634),l=e(24169),r=e(11206),i=e(22209),g=e(74716),o=e(56286),d=e(14578),c=e(29158),a=e(82702),p=e(91605),u=e(56034),m=e(95868),v=e(13840),x=e(60782),f=e(17464),E=e(40276),h=e(60734),y=e(10534),b=e(3988),D=e(32012),P=e(32982),C=e(39558),M=e(57514),I=e(83598),R=e(99128),T=e(70104),S=e(41670),L=e(69529),O=e(2056),j=e(42734),N=e(11134),F=e(15666),U=e(3799),w=e(66070),B=e(20333),K=e(15648),W=e(56181),z=e(98239),Y=e(63383),X=e(33552),q=e(48840),G=e(79924),te=e(28270),H=e(19384),se=e(78369),ne=e(64149),le=e(92174),_=e(96374),Q=e(20084),ae=e(32372),oe=e(85828),J=e(19716),ee=e(99544),de=e(37390),xe=e(29473),re=e(25897),ue=e(95246),Te=e(71678),ge=e(95247),Oe=e(67570),Ue=e(77093),Xe=e(14746),we=e(63021),qe=e(40675),We=e(90685),Ce=e(40980),je=e(53402),Ke=e(44522),_e=e(37494),Fe=e(5926),at=e(95164),Ct=e(97696),Dt=e(75128),tt=e(69503),ze=e(3139),pe=e(12509),Se=e(91052),fe=e(89963),Ee=e(79041),Pe=e(67266),he=e(29995),be=e(96516),Ae=e(34375),De=e(42418),Ie=e(84656),ke=e(82762),dt=e(57418),Pt=e(14689),pt=e(79961),Tt=e(61458),jt=e(8866),$t=e(37713),sn=e(76442),Yt=e(28122),qt=e(38138),bn=e(59093),Mt=e(64539),Jt=e(51686),Ut=e(64919),Gt=e(64078),Lt=e(59796),At=e(94536),Nt=e(37166),Dn=e(86460),An=e(29678),Pn=e(24022),Xn=e(44533),Tn=e(66602),ht=e(52446),St=e(91409),Ge=e(11184),Ve=e(19849),lt=e(17081),It=e(95180),Qe=e(28623),vt=e(62930),Ot=e(31511),zt=e(72960),vn=e(38401),ln=e(83684),On=e(57752),wn=e(13102),Un=e(64765),cs=e(87978),Zn=e(77014),wt=e(47097),Ft=e(51253),Ht=e(87266),ut=e(16504),pn=e(55852),Jn=e(19727),Qn=e(27746),fs=e(15068),ls=e(51986),vs=e(84349),ea=e(50720),Ks=e(72109),Hs=e(94753),bs=e(90613),Ys=e(67061),La=e(71259),Xs=e(68402),Ta=e(60029),Lr=e(88575),$r=e(17408),Za=e(84167),Er=e(72093),Ar=e(14186),ho=e(63056),Fr=e(76892),rr=e(39268),fo=e(95984),_o=e(23731),gr=e(90182),ci=e(12681),Qo=e(88824),eo=e(62883),Do=e.n(eo),di={};for(const Es in eo)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","getWeekStart","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","SelectMenuOptions","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonDot","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect"].indexOf(Es)<0&&(di[Es]=()=>eo[Es]);e.d(A,di);var bo=e(66864),Oo=e(39938),To=e(94354),jo=e(79569),$o=e(83186),Yo=e(10354),Si=e(51440),vi=e(67647),ai=e(49718),yi=e(7968),Bo=e(15292),Ai=e(10880),Ho=e(21744),ui=e(73546),Jo=e(92887),Ri=e(54230),xi=e(5308),Po=e(10860),ri=e(81507),Ei=e(9286),Zo=e(9261),_t=e(83122),cn=e(98624),kn=e(99635),Kn=e(12942),ns=e(38894),Rs=e(25994),Os=e(69144),ha=e(21633),na=e(52198),wa=e(52622),pr=e(51336),Ma=e(30501),ks=e(81297),oo=e(24182),go=e(96747),qr=e(66737),po=e(52811),yo=e(88895),hi=e(54438),Di=e(52494),Rr=e(48747),tr=e(5484),Vr=e(33083),io=e(65036),ja=e(99755),Xo=e(18262),Ti=e(16998),Rt=e(65575),tn=e(76284),Mn=e(90606);const zn={SecretFormField:o.L,FormField:n.z,Select:i.l6,AsyncSelect:i.DW,IndicatorsContainer:l.s,NoOptionsMessage:r.l,Input:s.p,Switch:g.d}},31511:(k,A,e)=>{"use strict";e.d(A,{A:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(86634),i=e(40845);function g(d){const{visible:c,children:a,duration:p=250}=d,u=(0,i.of)(o,p),m=(0,l.useRef)(null);return(0,n.jsx)(r.A,{in:c,mountOnEnter:!0,unmountOnExit:!0,timeout:p,classNames:u,nodeRef:m,children:l.cloneElement(a,{ref:m})})}const o=(d,c)=>({enter:(0,s.css)({label:"enter",opacity:0}),enterActive:(0,s.css)({label:"enterActive",opacity:1,[d.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${c}ms ease-out`}}),exit:(0,s.css)({label:"exit",opacity:1}),exitActive:(0,s.css)({label:"exitActive",opacity:0,[d.transitions.handleMotion("no-preference","reduce")]:{transition:`opacity ${c}ms ease-out`}})})},72960:(k,A,e)=>{"use strict";e.d(A,{n:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(86634),i=e(40845);function g(d){const{visible:c,children:a,duration:p=250,horizontal:u,size:m}=d,v=(0,i.of)(o,p,u?"width":"height",m),x=(0,l.useRef)(null);return(0,n.jsx)(r.A,{in:c,mountOnEnter:!0,unmountOnExit:!0,timeout:p,classNames:v,nodeRef:x,children:l.cloneElement(a,{ref:x})})}const o=(d,c,a,p)=>({enter:(0,s.css)({label:"enter",[`${a}`]:0,opacity:0}),enterActive:(0,s.css)({label:"enterActive",[`${a}`]:`${p}px`,opacity:1,[d.transitions.handleMotion("no-preference")]:{transition:`opacity ${c}ms ease-out, ${a} ${c}ms ease-out`},[d.transitions.handleMotion("reduce")]:{transition:`opacity ${c}ms ease-out`}}),exit:(0,s.css)({label:"exit",[`${a}`]:`${p}px`,opacity:1}),exitActive:(0,s.css)({label:"exitActive",opacity:0,[`${a}`]:0,[d.transitions.handleMotion("no-preference")]:{transition:`opacity ${c}ms ease-out, ${a} ${c}ms ease-out`},[d.transitions.handleMotion("reduce")]:{transition:`opacity ${c}ms ease-out`}})})},81297:(k,A,e)=>{"use strict";e.d(A,{Z:()=>c});var n=e(74848),s=e(96540),l=e(36613),r=e(16895),i=e(7650);function g(a,p){return p.width===a.width&&p.height===a.height}function o(a,p){return p.data===a.data}function d(a,p){return p.config===a.config}class c extends s.Component{constructor(p){super(p),this.plotContainer=(0,s.createRef)(),this.plotCanvasBBox=(0,s.createRef)(),this.state={plot:null}}reinitPlot(){let{width:p,height:u,plotRef:m}=this.props;if(this.state.plot?.destroy(),p===0&&u===0)return;this.props.config.addHook("setSize",f=>{f.over});const v={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,r.uY)("UPlot",!1,"Reinitializing plot",v);const x=new l.A(v,this.props.data,this.plotContainer.current);m&&m(x),this.setState({plot:x})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(p){let{plot:u}=this.state;g(p,this.props)?d(p,this.props)?o(p,this.props)||u?.setData(this.props.data):this.reinitPlot():u?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},24182:(k,A,e)=>{"use strict";e.d(A,{$:()=>p,t:()=>a});var n=e(74848),s=e(96540),l=e(28240),r=e(8066),i=e(52622),g=e(40845),o=e(67266),d=e(96516),c=e(16895);function a(u,m){return u.getSeries().some(v=>{const x=v.props.dataFrameFieldIndex;if(!x)return!1;const f=m[x.frameIndex]?.fields[x.fieldIndex];return!(!f||f.config.custom?.hideFrom?.legend)})}const p=(0,s.memo)(({data:u,config:m,placement:v,calcs:x,displayMode:f,...E})=>{const h=(0,g.$j)(),y=m.getSeries().map(b=>{const D=b.props,P=D.dataFrameFieldIndex,C=m.getAxisPlacement(b.props.scaleKey);if(!P)return;const M=u[P.frameIndex]?.fields[P.fieldIndex];if(!M||M.config.custom?.hideFrom?.legend)return;const I=(0,l.Ct)(M,u[P.frameIndex],u),T=(0,r.lz)(M,h).color;return{disabled:!(D.show??!0),fieldIndex:P,color:T,label:I,yAxis:C===i.vM.Left||C===i.vM.Bottom?1:2,getDisplayValues:()=>(0,c.UO)(x,M,h),getItemKey:()=>`${I}-${P.frameIndex}-${P.fieldIndex}`,lineStyle:D.lineStyle}}).filter(b=>b!==void 0);return(0,n.jsx)(o.KU.Legend,{placement:v,...E,children:(0,n.jsx)(d.t,{placement:v,items:y,displayMode:f,sortBy:E.sortBy,sortDesc:E.sortDesc,isSortable:!0})})});p.displayName="PlotLegend"},52198:(k,A,e)=>{"use strict";e.d(A,{t:()=>s});var n=e(52622);const s={drawStyle:[{label:"Lines",value:n.GR.Line},{label:"Bars",value:n.GR.Bars},{label:"Points",value:n.GR.Points}],lineInterpolation:[{description:"Linear",value:n.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:n.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:n.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:n.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:n.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:n.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:n.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:n.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:n.yL.Always},{label:"Never",value:n.yL.Never}],axisPlacement:[{label:"Auto",value:n.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:n.vM.Left},{label:"Right",value:n.vM.Right},{label:"Hidden",value:n.vM.Hidden}],fillGradient:[{label:"None",value:n.on.None},{label:"Opacity",value:n.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:n.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:n.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:n.gs.None},{label:"Normal",value:n.gs.Normal},{label:"100%",value:n.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:n.Ly.Off},{label:"As lines",value:n.Ly.Line},{label:"As lines (dashed)",value:n.Ly.Dashed},{label:"As filled regions",value:n.Ly.Area},{label:"As filled regions and lines",value:n.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:n.Ly.DashedAndArea}]}},30501:(k,A,e)=>{"use strict";e.d(A,{Zj:()=>u,pi:()=>c,zH:()=>p});var n=e(83195),s=e(97706),l=e(42994),r=e(72724),i=e(52622),g=e(29413),o=e(52811),d=e(93060);const c=12,a=8;class p extends o.R{merge(f){this.props.size=(0,d.Y)("max",this.props.size,f.size),this.props.label||(this.props.label=f.label),this.props.placement===i.vM.Auto&&(this.props.placement=f.placement)}calculateSpace(f,E,h,y,b){const D=f.axes[E],P=f.scales[D.scale];if(D.side!==2||!P)return 30;const C=40;if(P.time){const M=b/C,I=(y-h)/M,R=m(f,[h],E,C,I);return(0,g.kD)(R[0],c).width+18}return C}calculateAxisSize(f,E,h){const y=f.axes[h];let b=y.ticks.size;if(y.side===2)b+=y.gap+c;else if(E?.length){let D=E.reduce((C,M)=>Math.max(C,(0,g.kD)(M,c).width),0);const P=Math.min(f.width*.4,D);b+=y.gap+y.labelGap+P}return Math.ceil(b)}getConfig(){let{scaleKey:f,label:E,show:h=!0,placement:y=i.vM.Auto,grid:b={show:!0},ticks:D,space:P,filter:C,gap:M=5,formatValue:I,splits:R,values:T,incrs:S,isTime:L,timeZone:O,theme:j,tickLabelRotation:N,size:F,color:U,border:w,decimals:B,distr:K=i.L4.Linear}=this.props;const W=`${c}px ${j.typography.fontFamily}`,z=j.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,n.j9)(f)&&(R=[0,1]),B===0&&K===i.L4.Linear&&(C=(X,q)=>q.map(G=>Number.isInteger(G)?G:null));let Y={scale:f,show:h,stroke:U??j.colors.text.primary,side:v(y),font:W,size:F??((X,q,G)=>this.calculateAxisSize(X,q,G)),rotate:N,gap:M,labelGap:0,grid:{show:b.show,stroke:z,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:w?.show?U??j.colors.text.primary:z,width:1/devicePixelRatio,size:4},D),splits:R,values:T,space:P??((X,q,G,te,H)=>this.calculateSpace(X,q,G,te,H)),filter:C,incrs:S};return w?.show&&(Y.border={stroke:U??j.colors.text.primary,width:1/devicePixelRatio,...w}),E!=null&&E.length>0&&(Y.label=E,Y.labelSize=c+a,Y.labelFont=W,Y.labelGap=a),T?Y.values=T:L?Y.values=m:I&&(Y.values=(X,q,G,te,H)=>{let se=(0,s.E)((0,s.h)(H,6));return q.map(ne=>I(ne,se>0?se:void 0))}),Y.timeZone=O,Y}}const u={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function m(x,f,E,h,y){const b=x.axes[E],D="timeZone"in b&&typeof b.timeZone=="string"?b.timeZone:void 0,P=x.scales.x,C=(P?.max??0)-(P?.min??0),M=Math.round(u.year/u.day)*u.day,I=Math.round(y/u.day)*u.day;let R=l.WC.interval.year;return y<u.second?R=l.WC.interval.millisecond:y<=u.minute?R=l.WC.interval.second:C<=u.day?R=l.WC.interval.minute:y<=u.day?R=l.WC.interval.hour:C<u.year?R=l.WC.interval.day:I===M?R=l.WC.interval.year:y<=u.year&&(R=l.WC.interval.month),f.map(T=>T==null?"":(0,r.LE)(T,{format:R,timeZone:D}))}function v(x){switch(x){case i.vM.Top:return 0;case i.vM.Right:return 1;case i.vM.Bottom:return 2;case i.vM.Left:}return 3}},51336:(k,A,e)=>{"use strict";e.d(A,{e:()=>b});var n=e(2543),s=e(36613),l=e(43127),r=e(91410),i=e(52622),g=e(16895),o=e(30501),d=e(93060),c=e(24293),a=e(23596),p=e(52811),u=e(74863);class m extends p.R{getConfig(){const{facets:P,drawStyle:C,pathBuilder:M,pointsBuilder:I,pointsFilter:R,lineInterpolation:T,lineWidth:S,lineStyle:L,barAlignment:O,barWidthFactor:j,barMaxWidth:N,showPoints:F,pointSize:U,scaleKey:w,pxAlign:B,spanNulls:K,show:W=!0}=this.props;let z={},Y=this.getLineColor();z.stroke=Y,z.width=S,L&&L.fill!=="solid"&&(L.fill==="dot"&&(z.cap="round"),z.dash=L.dash??[10,10]),M!=null?z.paths=M:C===i.GR.Points?z.paths=()=>null:C!=null&&(z.paths=(G,te,H,se)=>x(C,T,O,j,N)(G,te,H,se));const X=typeof Y=="string"?Y:(G,te)=>G.series[te]._stroke,q={points:{stroke:X,fill:X,size:!U||U<S?void 0:U,filter:R}};return I!=null?q.points.show=I:C===i.GR.Points?q.points.show=!0:F===i.yL.Auto?C===i.GR.Bars&&(q.points.show=!1):F===i.yL.Never?q.points.show=!1:F===i.yL.Always&&(q.points.show=!0),{scale:w,facets:P,spanGaps:typeof K=="number"?!1:K,value:()=>"",pxAlign:B,show:W,fill:this.getFill(),...z,...q}}getLineColor(){const{lineColor:P,gradientMode:C,colorMode:M,thresholds:I,theme:R,hardMin:T,hardMax:S,softMin:L,softMax:O,dynamicSeriesColor:j}=this.props;return C===i.on.None&&j?(N,F)=>j(F)??P??c.F:C===i.on.Scheme&&M?.id!==c.Y.Fixed?(0,u.pl)(1,R,M,I,T,S,L,O):C===i.on.Hue?(0,u.B5)(P??c.F,1,R):P??c.F}getFill(){const{lineColor:P,fillColor:C,gradientMode:M,fillOpacity:I,colorMode:R,thresholds:T,theme:S,hardMin:L,hardMax:O,softMin:j,softMax:N,dynamicSeriesColor:F}=this.props;if(C)return C;const U=M??i.on.None,w=(I??0)/100;if(U===i.on.None&&F&&w>0)return(B,K)=>{let W=B.series[K]._stroke;return a.MV.alpha(W??"",w)};switch(U){case i.on.Opacity:return(0,u.WO)(C??P,w);case i.on.Hue:return(0,u.B5)(C??P,w,S);case i.on.Scheme:if(R?.id!==c.Y.Fixed)return(0,u.pl)(w,S,R,T,L,O,j,N);default:if(w>0)return a.MV.alpha(P??"",w)}}}let v;function x(D,P,C=i.Nj.Center,M=.6,I=200){const R=s.A.paths;if(v||(v={linear:R.linear(),smooth:R.spline(),stepBefore:R.stepped({align:-1}),stepAfter:R.stepped({align:1})}),D===i.GR.Bars){let T=`bars|${C}|${M}|${I}`;return v[T]||(v[T]=R.bars({size:[M,I],align:C})),v[T]}else if(D===i.GR.Line){if(P===i.dx.StepBefore)return v.stepBefore;if(P===i.dx.StepAfter)return v.stepAfter;if(P===i.dx.Smooth)return v.smooth}return v.linear}var f=e(84140),E=e(50082);function h(D){const P=D.config.mode===i.Ly.Dashed||D.config.mode===i.Ly.DashedAndArea?[10,10]:[];function C(F,U,w,B){let K=F.ctx,W=0;for(let z=0;z<w.length;z++)if(w[z].color==="transparent"){W=z;break}K.lineWidth=2,K.setLineDash(P);for(let z=1;z<w.length;z++){const Y=w[z];let X;W>=z&&z>0?X=(0,f.A)(B.visualization.getColorByName(w[z-1].color)):X=(0,f.A)(B.visualization.getColorByName(Y.color)),X.getAlpha()===1&&X.setAlpha(.7);let q=Math.round(F.bbox.left),G=Math.round(F.valToPos(Y.value,U,!0)),te=Math.round(F.bbox.left+F.bbox.width),H=Math.round(F.valToPos(Y.value,U,!0));K.beginPath(),K.moveTo(q,G),K.lineTo(te,H),K.strokeStyle=X.toString(),K.stroke()}}function M(F,U,w,B){let K=F.ctx,W=(0,u.Z8)(F,U,w.map(z=>{let Y=(0,f.A)(B.visualization.getColorByName(z.color));return Y.getAlpha()===1&&Y.setAlpha(.15),[z.value,Y.toString()]}),!0);K.fillStyle=W,K.fillRect(F.bbox.left,F.bbox.top,F.bbox.width,F.bbox.height)}const{scaleKey:I,thresholds:R,theme:T,config:S,hardMin:L,hardMax:O,softMin:j,softMax:N}=D;return F=>{const U=F.ctx,{min:w,max:B}=F.scales.x,{min:K,max:W}=F.scales[I];if(w==null||B==null||K==null||W==null)return;let{steps:z,mode:Y}=R;if(Y===E.O.Percentage){let[X,q]=(0,u.EJ)(F,I,L,O,j,N),G=q-X;z=z.map(te=>({...te,value:X+G*(te.value/100)}))}switch(U.save(),S.mode){case i.Ly.Line:case i.Ly.Dashed:C(F,I,z,T);break;case i.Ly.Area:M(F,I,z,T);break;case i.Ly.LineAndArea:case i.Ly.DashedAndArea:M(F,I,z,T),C(F,I,z,T)}U.restore()}}const y={drag:{setScale:!1},points:{size:(D,P)=>D.series[P].points.size*2,width:(D,P,C)=>C/4},focus:{prox:30}};class b{constructor(P=l.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=C=>{let M=new Date(C);return this.tz?s.A.tzDate(M,this.tz):M},this.tz=(0,r.QZ)(P,Date.now())?.ianaName}addHook(P,C){(0,g.uY)("UPlotConfigBuilder",!1,"addHook",P),this.hooks[P]||(this.hooks[P]=[]),this.hooks[P].push(C)}addThresholds(P){this.thresholds[P.scaleKey]||(this.thresholds[P.scaleKey]=P,this.addHook("drawClear",h(P)))}addAxis(P){P.placement=P.placement??i.vM.Auto,P.grid=P.grid??{};let C=P.scaleKey;if(C==="x"&&(C+=P.timeZone??""),this.axes[C]){this.axes[C].merge(P);return}P.placement===i.vM.Auto&&(P.placement=this.hasLeftAxis?i.vM.Right:i.vM.Left),P.placement===i.vM.Left&&(this.hasLeftAxis=!0),P.placement===i.vM.Hidden&&(P.grid.show=!1,P.size=0),this.axes[C]=new o.zH(P)}getAxisPlacement(P){return this.axes[P]?.props.placement??i.vM.Left}setCursor(P){this.cursor=(0,n.merge)({},this.cursor,P)}setMode(P){this.mode=P}setSelect(P){this.select=P}addSeries(P){this.series.push(new m(P))}getSeries(){return this.series}addScale(P){const C=this.scales.find(M=>M.props.scaleKey===P.scaleKey);if(C){C.merge(P);return}this.scales.push(new d.G(P))}addBand(P){this.bands.push(P)}setStackingGroups(P){this.stackingGroups=P}getStackingGroups(){return this.stackingGroups}setPrepData(P){this.prepData=C=>(this.frames=C,P(C,this.getStackingGroups()))}setPadding(P){this.padding=P}getConfig(){if(this.cachedConfig)return this.cachedConfig;const P={...g.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};P.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(M=>M.getConfig()),P.series=[...P.series,...this.series.map(M=>M.getConfig())],P.scales=this.scales.reduce((M,I)=>({...M,...I.getConfig()}),{}),P.hooks=this.hooks,P.select=this.select;const C=(M="")=>(I,R)=>{let T=I.series[R].points._stroke;if(typeof T!="string"){let S=this.frames[0].fields[R];T=S.display(S.values[I.cursor.idxs[R]]).color}return T+M};return P.cursor=(0,n.merge)({},y,{points:{stroke:C("80"),fill:C()}},this.cursor),P.tzDate=this.tzDate,Array.isArray(this.padding)&&(P.padding=this.padding),this.stackingGroups.forEach(M=>{(0,g.Tz)(M).forEach(I=>{this.addBand(I)})}),this.bands.length&&(P.bands=this.bands),this.cachedConfig=P,P}ensureNonOverlappingAxes(P){const C=P.find(R=>R.props.scaleKey==="x"),M=P.filter(R=>R.props.grid?.show===void 0),I=M.findIndex(R=>R.props.placement===i.vM.Left||R.props.placement===i.vM.Right||R.props.placement===i.vM.Bottom&&R!==C);for(let R=0;R<M.length;R++)M[R]===C||R===I?M[R].props.grid.show=!0:M[R].props.grid.show=!1;return P}}},93060:(k,A,e)=>{"use strict";e.d(A,{G:()=>g,Y:()=>o});var n=e(36613),s=e(77678),l=e(83195),r=e(52622),i=e(52811);class g extends i.R{merge(c){this.props.min=o("min",this.props.min,c.min),this.props.max=o("max",this.props.max,c.max)}getConfig(){let{isTime:c,scaleKey:a,min:p,max:u,softMin:m,softMax:v,range:x,direction:f,orientation:E,centeredZero:h,decimals:y}=this.props;const b=this.props.distribution,D=c?{}:{distr:b===r.L4.Symlog?4:b===r.L4.Log?3:b===r.L4.Ordinal?2:1,log:b===r.L4.Log||b===r.L4.Symlog?this.props.log??2:void 0,asinh:b===r.L4.Symlog?this.props.linearThreshold??1:void 0};if(b===r.L4.Log){let O=this.props.log,j=O===2?Math.log2:Math.log10;p!=null&&(p<=0?p=null:p=O**Math.floor(j(p))),u!=null&&(u<=0?u=null:u=O**Math.ceil(j(u))),m!=null&&(m<=0?m=null:m=O**Math.floor(j(m))),v!=null&&(v<=0?v=null:v=O**Math.ceil(j(v)))}let P=m==null?3:1,C=v==null?3:1;const M={min:{pad:.1,hard:p??-1/0,soft:m||0,mode:P},max:{pad:.1,hard:u??1/0,soft:v||0,mode:C}};let I=m==null&&p!=null,R=v==null&&u!=null,T=I&&R;const S=(O,j,N,F)=>{const U=O.scales[F];let w=[j,N];if(!T&&j==null&&N==null)return w;let B=U.log??10;if(U.distr===1||U.distr===2||U.distr===4){if(h){let K=Math.abs(j),W=Math.abs(N),z=Math.max(K,W);z===0&&(z=80),j=-z,N=z}U.distr===4?w=n.A.rangeAsinh(j,N,B,!0):w=n.A.rangeNum(I?p:j,R?u:N,M)}else U.distr===3&&(w=n.A.rangeLog(p??j,u??N,B,!0));if(y===0)if(U.distr===1||U.distr===2)w[0]=(0,s.rs)(w[0],1),w[1]=(0,s.Uh)(w[1],1);else if(U.distr===3){let K=U.log===2?Math.log2:Math.log10;if(w[0]<=1)w[0]=1;else{let z=Math.floor(K(w[0]));w[0]=B**z}let W=Math.ceil(K(w[1]));w[1]=B**W,w[0]===w[1]&&(w[1]*=B)}else U.distr===4&&(w[0]=(0,s.rs)(w[0],1),w[1]=(0,s.Uh)(w[1],1));return(U.distr===1||U.distr===4)&&(I&&(w[0]=p),R&&(w[1]=u)),w[0]>=w[1]&&(w[0]=U.distr===3?1:0,w[1]=100),w};let L=!c&&!T;return(0,l.j9)(a)&&(L=!1,x=[0,1]),{[a]:{time:c,auto:L,range:x??S,dir:f,ori:E,...D}}}}function o(d,c,a){const p=c!=null,u=a!=null;return p?u?d==="min"?c<a?c:a:c>a?c:a:c:a}},74863:(k,A,e)=>{"use strict";e.d(A,{B5:()=>c,EJ:()=>m,WO:()=>d,Z8:()=>p,pl:()=>x});var n=e(84140),s=e(23596),l=e(24293),r=e(50082),i=e(52622),g=e(29413);function o(f,E,h){let y=0,b=0,D=0,P=0;return f===3?(b=E.top,P=E.top+E.height):f===2?(y=E.left+E.width,D=E.left):f===1?(b=E.top+E.height,P=E.top):f===0&&(y=E.left,D=E.left+E.width),h.createLinearGradient(y,b,D,P)}function d(f,E){return(h,y)=>{const b=(0,g.Yc)(),D=o(h.scales.x.ori===i.Lt.Horizontal?3:2,h.bbox,b);return D.addColorStop(0,s.MV.alpha(f,E)),D.addColorStop(1,s.MV.alpha(f,0)),D}}function c(f,E,h){return(y,b)=>{const D=(0,g.Yc)(),P=o(y.scales.x.ori===i.Lt.Horizontal?3:2,y.bbox,D),C=(0,n.A)(f).spin(-25).darken(5),M=(0,n.A)(f).saturate(20).spin(20).brighten(10);return h.isDark?(P.addColorStop(0,M.lighten(10).setAlpha(E).toString()),P.addColorStop(1,C.darken(10).setAlpha(E).toString())):(P.addColorStop(0,M.lighten(10).setAlpha(E).toString()),P.addColorStop(1,C.setAlpha(E).toString())),P}}var a=(f=>(f[f.Right=0]="Right",f[f.Up=1]="Up",f[f.Left=2]="Left",f[f.Down=3]="Down",f))(a||{});function p(f,E,h,y=!1){let b=f.scales[E],D=null,P=null;for(let w=0;w<h.length;w++){let B=h[w][0];if((B<=b.min||D==null)&&(D=w),P=w,B>=b.max)break}if(D===P)return h[D][1];let C=h[D][0],M=h[P][0];C===-1/0&&(C=b.min),M===1/0&&(M=b.max);let I=Math.round(f.valToPos(C,E,!0)),R=Math.round(f.valToPos(M,E,!0)),T=I-R;if(T===0)return h[P][1];let S,L,O,j;f.scales.x.ori===i.Lt.Horizontal?(S=O=0,L=I,j=R):(L=j=0,S=I,O=R);let F=(0,g.Yc)().createLinearGradient(S,L,O,j),U;for(let w=D;w<=P;w++){let B=h[w],K=w===D?I:w===P?R:Math.round(f.valToPos(B[0],E,!0)),W=(I-K)/T;y&&w>D&&F.addColorStop(W,U),F.addColorStop(W,U=B[1])}return F}function u(f,E){let h=f.scales[E],y=1/0,b=-1/0;return f.series.forEach((D,P)=>{if(D.show&&D.scale===E)if(D.min==null){let C=f.data[P];for(let M=0;M<C.length;M++)C[M]!=null&&(y=Math.min(y,C[M]),b=Math.max(b,C[M]))}else y=Math.min(y,D.min),b=Math.max(b,D.max)}),b===y&&(y=h.min,b=h.max),[y,b]}function m(f,E,h,y,b,D){let P=h??b??null,C=y??D??null;if(P==null||C==null){let[M,I]=u(f,E);P=P??M??0,C=C??I??100}return[P,C]}function v(f){return f==="transparent"||f[0]==="#"&&f.slice(-2)==="00"}function x(f,E,h,y,b,D,P,C){if(!h)throw Error("Missing colorMode required for color scheme gradients");if(!y)throw Error("Missing thresholds required for color scheme gradients");return(M,I)=>{let R=M.series[I].scale,T="";if(h.id===l.Y.Thresholds)if(y.mode===r.O.Absolute){const S=y.steps.map(L=>[L.value,v(L.color)?"#0000":s.MV.alpha(E.visualization.getColorByName(L.color),f)]);T=p(M,R,S,!0)}else{const[S,L]=m(M,R,b,D,P,C),O=L-S,j=y.steps.map(N=>[S+O*(N.value/100),s.MV.alpha(E.visualization.getColorByName(N.color),f)]);T=p(M,R,j,!0)}else if(h.getColors){const S=h.getColors(E),[L,O]=m(M,R,b,D,P,C),j=O-L,N=S.map((F,U)=>[L+j*(U/(S.length-1)),s.MV.alpha(E.visualization.getColorByName(F),f)]);T=p(M,R,N,!1)}return T}}},78226:(k,A,e)=>{"use strict";e.d(A,{a:()=>g});var n=e(74848),s=e(96540),l=e(1604),r=e(6967),i=e(97620);function g({id:o,events:d,renderEventMarker:c,mapEventToXYCoords:a,config:p}){const u=(0,s.useRef)(),[m,v]=(0,s.useState)(0),x=(0,l.A)();(0,s.useLayoutEffect)(()=>{p.addHook("init",E=>{u.current=E}),p.addHook("draw",()=>{x()&&v(E=>E+1)})},[p,v]);const f=(0,s.useMemo)(()=>{const E=[];if(!u.current||d.length===0)return E;for(let h=0;h<d.length;h++){const y=d[h];for(let b=0;b<y.length;b++){const D=a(y,{fieldIndex:b,frameIndex:h});D&&E.push((0,s.createElement)(r.p,{...D,key:`${o}-marker-${h}-${b}`},c(y,{fieldIndex:b,frameIndex:h})))}}return(0,n.jsx)(n.Fragment,{children:E})},[d,c,m]);return u.current?(0,n.jsx)(i._,{left:u.current.bbox.left/window.devicePixelRatio,top:u.current.bbox.top/window.devicePixelRatio,children:f}):null}},6967:(k,A,e)=>{"use strict";e.d(A,{p:()=>s});var n=e(74848);const s=({x:l,y:r,children:i})=>(0,n.jsx)("div",{style:{position:"absolute",top:`${r}px`,left:`${l}px`},children:i})},97620:(k,A,e)=>{"use strict";e.d(A,{_:()=>r});var n=e(74848),s=e(32196),l=e(96540);const r=({children:i,left:g,top:o})=>{const d=(0,l.useMemo)(()=>(0,s.css)({position:"absolute",overflow:"visible",left:`${g}px`,top:`${o}px`}),[g,o]);return(0,n.jsx)("div",{className:d,children:i})}},96747:(k,A,e)=>{"use strict";e.d(A,{_X:()=>l._,a:()=>n.a,pH:()=>s.p});var n=e(78226),s=e(6967),l=e(97620)},55129:(k,A,e)=>{"use strict";e.d(A,{M:()=>l});var n=e(52622),s=e(52811);function l(i,g){const o="na",d=`${i.min!==void 0?i.min:o}-${i.max!==void 0?i.max:o}`,c=`${i.custom?.axisSoftMin!==void 0?i.custom.axisSoftMin:o}-${i.custom?.axisSoftMax!==void 0?i.custom.axisSoftMax:o}`,a=`${i.custom?.axisPlacement!==void 0?i.custom?.axisPlacement:n.vM.Auto}`,p=i.unit??s.s,u=i.custom?.scaleDistribution?r(i.custom.scaleDistribution):n.L4.Linear,m=i.custom?.axisLabel?i.custom.axisLabel:o;return`${p}/${d}/${c}/${a}/${u}/${m}/${g}`}function r(i){return i.type===n.L4.Log?`${i.type}${i.log}`:i.type}},96287:(k,A,e)=>{"use strict";e.d(A,{J:()=>i});var n=e(74848),s=e(32196),l=e(29158),r=e(40845);const i=({onClick:o,"aria-label":d,style:c})=>{const a=(0,r.of)(g);return(0,n.jsx)(l.K,{"aria-label":d??"Close",className:a,name:"times",onClick:o,style:c})},g=o=>(0,s.css)({position:"absolute",margin:"0px",right:o.spacing(1),top:o.spacing(1.25)})},68268:(k,A,e)=>{"use strict";e.d(A,{K:()=>d});var n=e(2543),s=e.n(n),l=e(96540),r=e(64423),i=e(99165),g=e(69129),o=e(26272);const d=({config:c,eventBus:a,frame:p})=>{const u=(0,l.useRef)(p);return u.current=p,(0,l.useLayoutEffect)(()=>{let m=null;const v={point:{time:null},data:u.current};c.addHook("init",P=>{m=P});let x=null;c.addHook("setSeries",(P,C)=>{x=C}),c.addHook("setLegend",()=>{if(!(m.cursor.event==null)){let C=m.cursor.idxs.find(M=>M!=null);if(C==null)D();else{let M=C,I=x,R=m.data[0]??m.data[1][0];v.point.time=R[M],v.rowIndex=M??void 0,v.columnIndex=I??void 0,v.data=u.current;let T=m.cursor.top;v.point.panelRelY=T===0?.001:T>0?T/m.rect.height:1,b()}}});function f(P){const C=P.payload?.point?.time;if(C){const M=m.valToPos(C,"x");m.setCursor({left:M,top:m.rect.height/2})}}const E=new r.yU,h=new g.b_(v).setTags(["uplot"]),y=new g.ql().setTags(["uplot"]);let b=(0,n.throttle)(()=>{a.publish(h)},100),D=(0,n.throttle)(()=>{a.publish(y)},100);return E.add(a.getStream(g.b_).subscribe({next:P=>{a===P.origin||P.tags?.has("uplot")||f(P)}})),E.add(a.getStream(o.kb).subscribe({next:P=>f(P)})),E.add(a.getStream(g.ql).pipe((0,i.c)(50)).subscribe({next:P=>{a===P.origin||P.tags?.has("uplot")||m.cursor._lock||m.setCursor({left:-10,top:-10})}})),()=>{E.unsubscribe()}},[c]),null}},23117:(k,A,e)=>{"use strict";e.d(A,{Z:()=>d});var n=e(2543),s=e.n(n),l=e(96540);const r=.1,i=2,g=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),o=c=>{let a=c.root,p=new Set,u=null,m=null;if(!a)return;a.tabIndex=0;const v=(D,P)=>{const{cursor:C}=c;if(C.left===void 0||C.top===void 0)return;const{width:M,height:I}=c.over.style,[R,T]=[Math.floor(parseFloat(M)),Math.floor(parseFloat(I))];c.setCursor({left:(0,n.clamp)(C.left+D,0,R),top:(0,n.clamp)(C.top+P,0,T)})},x=D=>{if(p.size===0||!c){m=null;return}const M=(D-(m??D))*r;let I=0,R=0;p.has("ArrowUp")&&(R-=M),p.has("ArrowDown")&&(R+=M),p.has("ArrowLeft")&&(I-=M),p.has("ArrowRight")&&(I+=M),p.has("Shift")&&(I*=i,R*=i),v(I,R);const{cursor:T}=c;if(p.has(" ")&&T){const S=Number(c.over.style.height.slice(0,-2));c.setSelect({left:T.left<u?T.left:u,top:0,width:Math.abs(T.left-(u??T.left)),height:S},!1)}m=D,window.requestAnimationFrame(x)},f=D=>{if(D.key==="Tab"){c.setCursor({left:-5,top:-5});return}if(!g.has(D.key))return;if(D.preventDefault(),D.stopPropagation(),!p.has(D.key)){const C=p.size===0;p.add(D.key),u=D.key===" "&&u===null?c.cursor.left:u,C&&window.requestAnimationFrame(x)}},E=D=>{g.has(D.key)&&(p.delete(D.key),D.key===" "&&(D.preventDefault(),D.stopPropagation(),c.setSelect(c.select),u=null))},h=()=>{if(!a?.matches(":focus-visible"))return;const D=parseFloat(c.over.style.width),P=parseFloat(c.over.style.height);c.setCursor({left:D/2,top:P/2})},y=()=>{m=null,u=null,p.clear(),c.setSelect({left:0,top:0,width:0,height:0},!1)};a.addEventListener("keydown",f),a.addEventListener("keyup",E),a.addEventListener("focus",h),a.addEventListener("blur",y);const b=()=>{a?.removeEventListener("keydown",f),a?.removeEventListener("keyup",E),a?.removeEventListener("focus",h),a?.removeEventListener("blur",y),a=null};(c.hooks.destroy??=[]).push(b)},d=({config:c})=>((0,l.useLayoutEffect)(()=>c.addHook("init",o),[c]),null)},38761:(k,A,e)=>{"use strict";e.d(A,{b3:()=>p,xl:()=>f});var n=e(74848),s=e(32196),l=e(96540),r=e(40961),i=e(73134),g=e(40845),o=e(17464),d=e(96287);const c=void 0,a=10;var p=(h=>(h[h.xOne=0]="xOne",h[h.xAll=1]="xAll",h[h.xyOne=2]="xyOne",h))(p||{});function u(h,y){return{...h,...y,style:{...h.style,...y.style}}}function m(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const v=5,x=h=>h!=null&&!h.ctrlKey&&!h.metaKey,f=({config:h,hoverMode:y,render:b,clientZoom:D=!1,queryZoom:P,onSelectRange:C,maxWidth:M,syncMode:I=i.yV.Off,syncScope:R="global"})=>{const T=(0,l.useRef)(null),S=(0,l.useRef)(null);S.current==null&&(S.current=(0,o.gF)());const[{plot:L,isHovering:O,isPinned:j,contents:N,style:F,dismiss:U},w]=(0,l.useReducer)(u,null,m),B=(0,l.useRef)(),K=(0,g.of)(E,M),W=(0,l.useRef)(b);return W.current=b,(0,l.useLayoutEffect)(()=>{B.current={width:0,height:0,observer:new ResizeObserver(Ce=>{let je=B.current;for(const Ke of Ce)Ke.borderBoxSize?.length>0?(je.width=Ke.borderBoxSize[0].inlineSize,je.height=Ke.borderBoxSize[0].blockSize):(je.width=Ke.contentRect.width,je.height=Ke.contentRect.height)})};let z=!1,Y=!1,X=L,q=O,G=!1,te=j,H=F,se=!1;const ne=I===i.yV.Tooltip;I!==i.yV.Off&&h.scales[0].props.isTime&&h.setCursor({sync:{key:R,scales:["x",null]}});const le=()=>{ee?q=se&&G&&ne:q=J!=null||y===1&&G};let _=0,Q=0,ae=null,oe=L?.cursor.idxs.slice(),J=null,ee=!1,de=!1,xe=!1;const re=(Ce=!1)=>{de||(q?queueMicrotask(Te):setTimeout(Te,100),de=!0),Ce&&(xe=!0)},ue=Ce=>{T.current.contains(Ce.target)||ge()},Te=()=>{de=!1,xe&&(H={pointerEvents:te?"all":"none"},X.cursor._lock=te,te?(document.addEventListener("mousedown",ue,!0),document.addEventListener("keydown",ue,!0)):(document.removeEventListener("mousedown",ue,!0),document.removeEventListener("keydown",ue,!0)),xe=!1);let Ce={style:H,isPinned:te,isHovering:q,contents:q||ae!=null?W.current(X,oe,J,te,ge,ae,ee):null,dismiss:ge};w(Ce),ae=null},ge=()=>{let Ce=te;te=!1,q=!1,X.setCursor({left:-10,top:-10}),re(Ce)};h.addHook("init",Ce=>{w({plot:X=Ce}),D&&Ce.over.addEventListener("mousedown",je=>{if(x(je)&&je.button===0&&je.shiftKey){Y=!0,Ce.cursor.drag.x=!1,Ce.cursor.drag.y=!0;let Ke=_e=>{Ce.cursor.drag.x=!0,Ce.cursor.drag.y=!1,document.removeEventListener("mouseup",Ke,!0)};document.addEventListener("mouseup",Ke,!0)}},!0),Ce.over.addEventListener("click",je=>{if(je.target===Ce.over)if(je.ctrlKey||je.metaKey){let Ke;Ce.scales.x.ori===0?Ke=Ce.posToVal(Ce.cursor.left,"x"):Ke=Ce.posToVal(Ce.select.top+Ce.select.height,"x"),ae={from:Ke,to:Ke},re(!1)}else q&&J!=null&&!te&&(te=!0,re(!0))})}),h.addHook("setSelect",Ce=>{const je=Ce.scales.x.ori===0;if(!ee&&(D||P!=null))if(x(Ce.cursor.event)){if(C!=null){let Ke=[];const _e=!!Ce.cursor.drag.y,Fe=!!Ce.cursor.drag.x;let at=null,Ct=[];Fe&&(at={from:je?Ce.posToVal(Ce.select.left,"x"):Ce.posToVal(Ce.select.top+Ce.select.height,"x"),to:je?Ce.posToVal(Ce.select.left+Ce.select.width,"x"):Ce.posToVal(Ce.select.top,"x")}),_e&&h.scales.forEach(Dt=>{const tt=Dt.props.scaleKey;if(tt!=="x"){let ze={from:je?Ce.posToVal(Ce.select.top+Ce.select.height,tt):Ce.posToVal(Ce.select.left+Ce.select.width,tt),to:je?Ce.posToVal(Ce.select.top,tt):Ce.posToVal(Ce.select.left,tt)};Ct.push(ze)}}),Fe?_e?Ke=Ct.map(Dt=>({x:at,y:Dt})):Ke=[{x:at}]:_e&&(Ke=Ct.map(Dt=>({y:Dt}))),C(Ke)}else if(D&&Y){if(Ce.select.height>=v){for(let Ke in Ce.scales)if(Ke!=="x"){const _e=je?Ce.posToVal(Ce.select.top,Ke):Ce.posToVal(Ce.select.left+Ce.select.width,Ke),Fe=je?Ce.posToVal(Ce.select.top+Ce.select.height,Ke):Ce.posToVal(Ce.select.left,Ke);Ce.setScale(Ke,{min:Fe,max:_e})}z=!0}Y=!1}else if(P!=null&&Ce.select.width>=v){const Ke=je?Ce.posToVal(Ce.select.left,"x"):Ce.posToVal(Ce.select.top+Ce.select.height,"x"),_e=je?Ce.posToVal(Ce.select.left+Ce.select.width,"x"):Ce.posToVal(Ce.select.top,"x");P({from:Ke,to:_e}),z=!1}}else ae={from:je?Ce.posToVal(Ce.select.left,"x"):Ce.posToVal(Ce.select.top+Ce.select.height,"x"),to:je?Ce.posToVal(Ce.select.left+Ce.select.width,"x"):Ce.posToVal(Ce.select.top,"x")},re(!0);Ce.setSelect({left:0,width:0,top:0,height:0},!1)}),(D||P!=null)&&h.setCursor({bind:{dblclick:Ce=>()=>{if(!x(Ce.cursor.event))return null;if(D&&z){for(let je in Ce.scales)je!=="x"&&Ce.setScale(je,{min:null,max:null});z=!1}else if(P!=null){let je=Ce.scales.x;const Ke=je.min,_e=je.max,Fe=(_e-Ke)/2;P({from:Ke-Fe,to:_e+Fe})}return null}}}),h.addHook("setData",Ce=>{z=!1,Y=!1,te&&ge()}),h.addHook("setSeries",(Ce,je)=>{J=je,ee=Ce.cursor.event==null,le(),re()}),h.addHook("setLegend",Ce=>{oe=X?.cursor.idxs.slice(),G=oe.some((Ke,_e)=>_e>0&&Ke!=null),ee=Ce.cursor.event==null;let je=q;le(),(q||q!==je)&&re()});const Oe=16;let Ue=0,Xe=0;const we=()=>{q&&!te&&ge(),Ue=window.innerWidth-Oe,Xe=window.innerHeight-Oe},qe=()=>{se=X.rect.bottom<=Xe&&X.rect.top>=0&&X.rect.left>=0&&X.rect.right<=Ue};we(),h.addHook("ready",qe),h.addHook("setCursor",Ce=>{if(ee=Ce.cursor.event==null,!q)return;let{left:je=-10,top:Ke=-10}=Ce.cursor;if(je>=0||Ke>=0){let _e=Ce.rect.left+je,Fe=Ce.rect.top+Ke,at="",{width:Ct,height:Dt}=B.current;Ct+=a,Dt+=a,Q!==0?Fe+Dt<Xe||Fe-Dt<0?Q=0:Q!==-Dt&&(Q=-Dt):Fe+Dt>Xe&&Fe-Dt>=0&&(Q=-Dt),_!==0?_e+Ct<Ue||_e-Ct<0?_=0:_!==-Ct&&(_=-Ct):_e+Ct>Ue&&_e-Ct>=0&&(_=-Ct);const tt=_e+(_===0?a:-a),ze=Fe+(Q===0?a:-a);at=`translateX(${tt}px) ${_===0?"":"translateX(-100%)"} translateY(${ze}px) ${Q===0?"":"translateY(-100%)"}`,T.current!=null?T.current.style.transform=at:(H.transform=at,re())}});const We=Ce=>{qe(),q&&Ce.target instanceof Node&&Ce.target.contains(X.root)&&ge()};return window.addEventListener("resize",we),window.addEventListener("scroll",We,!0),()=>{window.removeEventListener("resize",we),window.removeEventListener("scroll",We,!0),document.removeEventListener("mousedown",ue,!0),document.removeEventListener("keydown",ue,!0)}},[h]),(0,l.useLayoutEffect)(()=>{const z=B.current;if(T.current!=null){z.observer.observe(T.current);const{width:Y,height:X}=T.current.getBoundingClientRect();z.width=Y,z.height=X;const q=L.cursor.event;q!=null?!(performance.now()-q.timeStamp>16)&&L.over.dispatchEvent(q):L.setCursor({left:L.cursor.left,top:L.cursor.top},!0)}else z.width=0,z.height=0},[O]),L&&O?(0,r.createPortal)((0,n.jsxs)("div",{className:(0,s.cx)(K.tooltipWrapper,j&&K.pinned),style:F,"aria-live":"polite","aria-atomic":"true",ref:T,children:[j&&(0,n.jsx)(d.J,{onClick:U}),N]}),S.current):null},E=(h,y)=>({tooltipWrapper:(0,s.css)({top:0,left:0,zIndex:h.zIndex.portal,whiteSpace:"pre",borderRadius:h.shape.radius.default,position:"fixed",background:h.colors.background.primary,border:`1px solid ${h.colors.border.weak}`,boxShadow:h.shadows.z2,userSelect:"text",maxWidth:y??"none"}),pinned:(0,s.css)({boxShadow:h.shadows.z3})})},66737:(k,A,e)=>{"use strict";e.d(A,{Ku:()=>s.K,Z7:()=>l.Z,xl:()=>n.xl});var n=e(38761),s=e(68268),l=e(23117)},52811:(k,A,e)=>{"use strict";e.d(A,{R:()=>s,s:()=>n});const n="__fixed";class s{constructor(r){this.props=r}}},16895:(k,A,e)=>{"use strict";e.d(A,{NN:()=>a,Tz:()=>u,UO:()=>h,bq:()=>v,ro:()=>m,sw:()=>x,uY:()=>b});var n=e(11261),s=e(50311),l=e(75059),r=e(57875),i=e(52622),g=e(40621),o=e(91040),d=e(55129);const c=(D,P,C)=>{let M=P%2?C[0]||C[2]:C[1]||C[3];return C[P]||!M?0:8},a={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[c,c,c,c],series:[],hooks:{}};var p=(D=>(D[D.Pos=1]="Pos",D[D.Neg=-1]="Neg",D))(p||{});function u(D){let P=[],{series:C,dir:M}=D,I=C.length-1,R=C.slice().reverse();return R.forEach((T,S)=>{if(S!==I){let L=R[S+1];P.push({series:[T,L],dir:-1*M})}}),P}function m(D){let P=new Map;return D.fields.forEach(({config:C,values:M,type:I},R)=>{if(R===0)return;let{custom:T}=C;if(T==null||T.hideFrom?.viz)return;let{stacking:S}=T;if(S==null)return;let{mode:L,group:O}=S;if(L===i.gs.None)return;let j=T.transform,N=f(j,M),F=T.drawStyle,U=F===i.GR.Bars?T.barAlignment:F===i.GR.Line?T.lineInterpolation:null,w=`${N}|${L}|${O}|${(0,d.M)(C,I)}|${F}|${U}`,B=P.get(w);B==null&&(B={series:[],dir:N},P.set(w,B)),B.series.push(R)}),[...P.values()]}function v(D,P,C){let M=Array(D.fields.length),I=P.length,R=D.length,T=I>0?Array(R).fill(0):[],S=I>0?Array(R).fill(!1):[],L=Array.from({length:I},()=>T.slice()),O=Array.from({length:I},()=>S.slice());if(P.forEach((j,N)=>{let F=O[N];j.series.forEach(U=>{let w=D.fields[U];if(w.config.custom?.hideFrom?.viz)return;let B=w.values;for(let K=0;K<R;K++)B[K]!=null&&(F[K]=!0)})}),D.fields.forEach((j,N)=>{let F=j.values;if(N===0){j.type===n.PU.time?M[0]=(0,s.ks)(j).values:M[0]=F;return}let{custom:U}=j.config;if(!U||U.hideFrom?.viz){M[N]=F;return}if(U.transform===i.NU.Constant){let B=F.findIndex(W=>W!=null),K=F[B];F=Array(F.length).fill(void 0),F[B]=K}else if(F=F.slice(),U.transform===i.NU.NegativeY)for(let B=0;B<F.length;B++)F[B]!=null&&(F[B]*=-1);let w=U.stacking?.mode;if(!w||w===i.gs.None)M[N]=F;else{let B=P.findIndex(Y=>Y.series.indexOf(N)>-1),K=L[B],W=O[B],z=M[N]=Array(R);for(let Y=0;Y<R;Y++){let X=F[Y];X!=null?z[Y]=K[Y]+=X:z[Y]=W[Y]?K[Y]:X}}}),C){let j=M.map((N,F)=>{let U=P.findIndex(w=>w.series.indexOf(F)>-1);return U!==-1?L[U]:N});C({totals:j})}return D.fields.forEach((j,N)=>{if(N===0||j.config.custom?.hideFrom?.viz)return;if(j.config.custom?.stacking?.mode===i.gs.Percent){let U=P.findIndex(W=>W.series.indexOf(N)>-1),w=L[U],B=P[U],K=M[N];for(let W=0;W<R;W++){let z=K[W];z!=null&&(K[W]=w[W]===0?0:B.dir*(z/w[W]))}}}),M}function x(D,P){let C,M=1,I=1,R=D.data[1][P],T=D.data[1][P];for(let S=1;S<D.data.length;S++){const O=D.data[S][P];O!=null&&(R==null?R=O:O>R&&(R=D.data[S][P],M=S),T==null?T=O:O<T&&(T=D.data[S][P],I=S))}return T==null&&R==null?C=void 0:T!=null&&R!=null?C=(D.valToPos(T,D.series[I].scale)+D.valToPos(R,D.series[M].scale))/2:C=D.valToPos(T||R,D.series[M||I].scale),C!==void 0&&C<0&&(C=D.bbox.height/devicePixelRatio),C}function f(D,P){const C=E(P);return D===i.NU.NegativeY?C?1:-1:C?-1:1}function E(D,P=100){const C=D.length;if(C===0)return!1;let M=0,I=C-1;for(;M<=I&&D[M]==null;)M++;for(;I>=M&&D[I]==null;)I--;let R=0,T=0;if(I>=M){const S=Math.max(1,Math.floor((I-M+1)/P));for(let L=M;L<=I;L+=S){const O=D[L];O!=null&&typeof O=="number"&&(O<0||Object.is(O,-0)?R++:O>0&&T++)}if(R>T)return!0}return!1}const h=(D,P,C)=>{if(!D?.length)return[];const M=S=>S==null?"-":S.toFixed(1),I=P.display??M;let R=null;const T=(0,l.Nw)({field:P,reducers:D});return D.map(S=>{const L=l.AS.get(S);let O=I;return L.id===l.gy.diffperc&&(O=(0,r.J)({field:{...P,config:{...P.config,unit:"percent"}},theme:C})),(L.id===l.gy.count||L.id===l.gy.changeCount||L.id===l.gy.distinctCount)&&(R||(R=(0,r.J)({field:{...P,config:{...P.config,unit:"none"}},theme:C})),O=R),{...O(T[S]),title:L.name,description:L.description}})},y=(0,o.h)("uPlot"),b=y.logger;(0,g.h)("graphng",void 0,y)},48747:(k,A,e)=>{"use strict";e.d(A,{T:()=>E});var n=e(74848),s=e(34796),l=e.n(s),r=e(2543),i=e(96540),g=e(61443),o=e(52622),d=e(75128),c=e(33083),a=e(3139),p=e(65036);const u=({dimensions:y,activeDimensions:b,pos:D,timeZone:P})=>{let C=null;if(b.xAxis===null)return null;b.yAxis&&(C=b.yAxis[0]);const M=b.xAxis[1]?(0,g.WK)(y.xAxis,b.xAxis[0],b.xAxis[1]):D.x,I=(0,p.DU)(y.yAxis.columns,y.xAxis.columns,M,P),R=I.time,T=I.results.map((S,L)=>({color:S.color,label:S.label,value:S.value,isActive:C===L}));return(0,n.jsx)(a.o,{series:T,timestamp:R})};u.displayName="MultiModeGraphTooltip";var m=e(83195),v=e(28240);const x=({dimensions:y,activeDimensions:b,timeZone:D})=>{if(b.yAxis===null||b.yAxis[1]===void 0||b.xAxis===null||b.xAxis[1]===void 0)return null;const P=(0,g.WK)(y.xAxis,b.xAxis[0],b.xAxis[1]),C=(0,g.P4)(y.xAxis,b.xAxis[0]),M=C.display?(0,m.cN)(C.display(P)):P,I=(0,g.P4)(y.yAxis,b.yAxis[0]),R=(0,g.WK)(y.yAxis,b.yAxis[0],b.yAxis[1]),T=I.display,S=T(R);return(0,n.jsx)(a.o,{series:[{color:S.color,label:(0,v.Ct)(I),value:(0,m.cN)(S)}],timestamp:M})};x.displayName="SingleModeGraphTooltip";const f=({mode:y=o.$N.Single,dimensions:b,activeDimensions:D,pos:P,timeZone:C})=>!D||!D.xAxis?null:y==="single"?(0,n.jsx)(x,{dimensions:b,activeDimensions:D,timeZone:C}):(0,n.jsx)(u,{dimensions:b,activeDimensions:D,pos:P,timeZone:C});f.displayName="GraphTooltip";class E extends i.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(b,D)=>{const{onHorizontalRegionSelected:P}=this.props;P&&P(D.xaxis.from,D.xaxis.to)},this.onPlotHover=(b,D,P)=>{this.setState({isTooltipVisible:!0,activeItem:P,pos:D})},this.onPlotClick=(b,D,P)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:P,contextPos:D})},this.renderTooltip=()=>{const{children:b,series:D,timeZone:P}=this.props,{pos:C,activeItem:M,isTooltipVisible:I}=this.state;let R;if(!I||!C||D.length===0||(i.Children.forEach(b,w=>{if(R)return;(w&&w.type&&(w.type.displayName||w.type.name))===d.n.displayName&&(R=w)}),!R))return null;const T=R.props,S=T.mode||"single";if(!M&&S==="single")return null;const L=T.tooltipComponent||f,O=M?M.series.seriesIndex:0,j=M?M.dataIndex:void 0,N={xAxis:[O,j],yAxis:M?[M.series.seriesIndex,M.dataIndex]:null},F={dimensions:{xAxis:(0,g.r4)("xAxis",D.map(w=>w.timeField)),yAxis:(0,g.r4)("yAxis",D.map(w=>w.valueField))},activeDimensions:N,pos:C,mode:T.mode||o.$N.Single,timeZone:P},U=i.createElement(L,{...F});return i.cloneElement(R,{content:U,position:{x:C.pageX,y:C.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:b}=this.props,{contextPos:D,contextItem:P,isContextVisible:C}=this.state;if(!C||!D||!P||b.length===0)return null;const M=P?P.series.seriesIndex:0,I=P?P.dataIndex:void 0,R={xAxis:[M,I],yAxis:P?[P.series.seriesIndex,P.dataIndex]:null},T={xAxis:(0,g.r4)("xAxis",b.map(j=>j.timeField)),yAxis:(0,g.r4)("yAxis",b.map(j=>j.valueField))},S=()=>this.setState({isContextVisible:!1}),L=()=>({datapoint:P.datapoint,dataIndex:P.dataIndex,series:P.series,seriesIndex:P.series.seriesIndex,pageX:D.pageX,pageY:D.pageY}),O={x:D.pageX,y:D.pageY,onClose:S,getContextMenuSource:L,timeZone:this.props.timeZone,dimensions:T,contextDimensions:R};return(0,n.jsx)(c.H,{...O})},this.getBarWidth=()=>{const{series:b}=this.props;return Math.min(...b.map(D=>D.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(b,D){b!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=l()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(b){return b.length===0?[{show:!0,min:-1,max:1}]:(0,r.uniqBy)(b.map(D=>{const P=D.yAxis?D.yAxis.index:1,C=D.yAxis&&D.yAxis.min&&!isNaN(D.yAxis.min)?D.yAxis.min:null,M=D.yAxis&&D.yAxis.tickDecimals&&!isNaN(D.yAxis.tickDecimals)?D.yAxis.tickDecimals:null;return{show:!0,index:P,position:P===1?"left":"right",min:C,tickDecimals:M}}),D=>D.index)}draw(){if(this.element===null)return;const{width:b,series:D,timeRange:P,showLines:C,showBars:M,showPoints:I,isStacked:R,lineWidth:T,timeZone:S,onHorizontalRegionSelected:L}=this.props;if(!b)return;const O=b/100,j=P.from.valueOf(),N=P.to.valueOf(),F=this.getYAxes(D),U={legend:{show:!1},series:{stack:R,lines:{show:C,lineWidth:T,zero:!1},points:{show:I,fill:1,fillColor:!1,radius:2},bars:{show:M,fill:1,barWidth:M?this.getBarWidth()/1.5:1,zero:!1,lineWidth:T},shadowSize:0},xaxis:{timezone:S,show:!0,mode:"time",min:j,max:N,label:"Datetime",ticks:O,timeformat:(0,p.Jc)(O,j,N),tickFormatter:p.Yn},yaxes:F,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:L?"x":null,color:"#666"},crosshair:{mode:"x"}};try{l().plot(this.element,D.filter(w=>w.isVisible),U)}catch(w){throw console.error("Graph rendering error",w,U,D),new Error("Error rendering panel")}}render(){const{ariaLabel:b,height:D,width:P,series:C}=this.props,M=C.length===0,I=this.renderTooltip(),R=this.renderContextMenu();return(0,n.jsxs)("div",{className:"graph-panel","aria-label":b,children:[(0,n.jsx)("div",{className:"graph-panel__chart",ref:T=>this.element=T,style:{height:D,width:P},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),M&&(0,n.jsx)("div",{className:"datapoints-warning",children:"No data"}),I,R]})}}const h=null},33083:(k,A,e)=>{"use strict";e.d(A,{H:()=>u,i:()=>m});var n=e(74848),s=e(32196),l=e(61443),r=e(72724),i=e(28122),g=e(9286),o=e(66864),d=e(59093),c=e(64539),a=e(94536),p=e(40845);const u=({getContextMenuSource:x,timeZone:f,itemsGroup:E,dimensions:h,contextDimensions:y,...b})=>{const D=x(),P=E?E.map(I=>({...I,items:I.items?.filter(R=>R.label)})):[],C=()=>{if(!D)return null;let I;if(h?.yAxis&&y?.yAxis?.[1]){const T=(0,l.WK)(h.yAxis,y.yAxis[0],y.yAxis[1]),S=D.series.valueField.display;I=S(T)}const R=(0,r.LE)(D.datapoint[0],{defaultWithMS:D.series.hasMsResolution,timeZone:f});return(0,n.jsx)(m,{timestamp:R,seriesColor:D.series.color,displayName:D.series.alias||D.series.label,displayValue:I})},M=()=>P?.map((I,R)=>(0,n.jsx)(d.r,{label:I.label,children:(I.items||[]).map(T=>(0,n.jsx)(c.D,{url:T.url,label:T.label,target:T.target,icon:T.icon,active:T.active,onClick:T.onClick},`${T.label}`))},`${I.label}${R}`));return(0,n.jsx)(i.t,{...b,renderMenuItems:M,renderHeader:C})},m=({timestamp:x,seriesColor:f,displayName:E,displayValue:h})=>{const y=(0,p.of)(v);return(0,n.jsxs)("div",{className:y.wrapper,children:[(0,n.jsx)("strong",{children:x}),(0,n.jsxs)(o.Gy,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(a.p,{color:f}),(0,n.jsx)("span",{className:y.displayName,children:E})]}),h&&(0,n.jsx)(g.i,{value:h})]})]})};function v(x){return{wrapper:(0,s.css)({padding:x.spacing(.5,1),fontSize:x.typography.size.sm,zIndex:x.zIndex.tooltip}),displayName:(0,s.css)({whiteSpace:"nowrap",paddingLeft:x.spacing(.5)})}}},84656:(k,A,e)=>{"use strict";e.d(A,{M:()=>r});var n=e(2543),s=e.n(n),l=e(96540);class r extends l.Component{constructor(g){super(g),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:g.series}}componentDidUpdate(g){const{series:o}=this.props;(0,n.isEqual)(g.series,o)||this.setState({hiddenSeries:[],toggledSeries:o})}onSeriesToggle(g,o){const{series:d,onHiddenSeriesChanged:c}=this.props,{hiddenSeries:a}=this.state;if(o.ctrlKey||o.metaKey||o.shiftKey){const v=a.indexOf(g)>-1?a.filter(f=>f!==g):a.concat([g]),x=d.map(f=>({...f,isVisible:v.indexOf(f.label)===-1}));this.setState({hiddenSeries:v,toggledSeries:x},()=>c?c(v):void 0);return}const p=d.map(v=>v.label),u=a.length+1===p.length?[]:(0,n.difference)(p,[g]),m=d.map(v=>({...v,isVisible:u.indexOf(v.label)===-1}));this.setState({hiddenSeries:u,toggledSeries:m},()=>c?c(u):void 0)}render(){const{children:g}=this.props,{toggledSeries:o}=this.state;return g({onSeriesToggle:this.onSeriesToggle,toggledSeries:o})}}},5484:(k,A,e)=>{"use strict";e.d(A,{I:()=>d});var n=e(74848),s=e(32196),l=e(40276),r=e(96516),i=e(40845),g=e(48747);const o=(a,p=!1,u=!1)=>{const m=a.reduce((x,f)=>x+(f[1]||0),0)===0,v=!a.reduce((x,f)=>x&&f[1]!==null,!0);return p&&v||u&&m},d=a=>{const{series:p,timeRange:u,width:m,height:v,showBars:x,showLines:f,showPoints:E,sortLegendBy:h,sortLegendDesc:y,legendDisplayMode:b,legendVisibility:D,placement:P,onSeriesToggle:C,onToggleSort:M,hideEmpty:I,hideZero:R,isStacked:T,lineWidth:S,onHorizontalRegionSelected:L,timeZone:O,children:j,ariaLabel:N}=a,{graphContainer:F,wrapper:U,legendContainer:w}=(0,i.of)(c,a.placement),B=p.reduce((K,W)=>o(W.data,I,R)?K:K.concat([{label:W.label,color:W.color||"",disabled:!W.isVisible,yAxis:W.yAxis.index,getDisplayValues:()=>W.info||[]}]),[]);return(0,n.jsxs)("div",{className:U,"aria-label":N,children:[(0,n.jsx)("div",{className:F,children:(0,n.jsx)(g.T,{series:p,timeRange:u,timeZone:O,showLines:f,showPoints:E,showBars:x,width:m,height:v,isStacked:T,lineWidth:S,onHorizontalRegionSelected:L,children:j})}),D&&(0,n.jsx)("div",{className:w,children:(0,n.jsx)(l.E,{hideHorizontalTrack:!0,children:(0,n.jsx)(r.t,{items:B,displayMode:b,placement:P,sortBy:h,sortDesc:y,onLabelClick:(K,W)=>{C&&C(K.label,W)},onToggleSort:M})})})]})},c=(a,p)=>({wrapper:(0,s.css)({display:"flex",flexDirection:p==="bottom"?"column":"row"}),graphContainer:(0,s.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,s.css)({padding:"10px 0",maxHeight:p==="bottom"?"35%":"none"})})},65036:(k,A,e)=>{"use strict";e.d(A,{DU:()=>g,Jc:()=>d,Yn:()=>o});var n=e(83195),s=e(28240),l=e(72724),r=e(42994);const i=(c,a)=>{let p=0,u=c.values.length-1,m;for(;;){if(p>u)return Math.max(u,0);m=Math.floor((p+u)/2);const v=c.values[m];if(v===a)return m;v&&v<a?p=m+1:u=m-1}},g=(c,a,p,u)=>{let m,v,x,f,E;const h=[];let y,b;for(m=0;m<c.length;m++){v=c[m];const D=a[m];x=i(D,p),f=p-D.values[x],E=D.values[x],(y===void 0||f>=0&&(f<y||y<0)||f<0&&f>y)&&(y=f,b=D.display?(0,n.cN)(D.display(E)):E);const P=v.display(v.values[x]);h.push({value:(0,n.cN)(P),datapointIndex:x,seriesIndex:m,color:P.color,label:(0,s.Ct)(v),time:D.display?(0,n.cN)(D.display(E)):E})}return{results:h,time:b}},o=(c,a)=>(0,l.LE)(c,{format:a?.options?.timeformat,timeZone:a?.options?.timezone}),d=(c,a,p)=>{if(a&&p&&c){const u=p-a,m=u/c/1e3,v=86400010,x=31536e6;return m<=10?r.WC.interval.millisecond:m<=45?r.WC.interval.second:u<=v?r.WC.interval.minute:m<=8e4?r.WC.interval.hour:u<=x?r.WC.interval.day:m<=31536e3?r.WC.interval.month:r.WC.interval.year}return r.WC.interval.minute}},99755:(k,A,e)=>{"use strict";e.d(A,{o:()=>f});var n=e(74848),s=e(96540),l=e(64423),r=e(99165),i=e(85200),g=e(1173),o=e(11261),d=e(69129),c=e(26272),a=e(79041),p=e(67266),u=e(81297),m=e(16895),v=e(65575);function x(E,h,y=[]){for(const b of y)if(typeof b=="function"){if(!b(E,h))return!1}else if(h[b]!==E[b])return!1;return!0}class f extends s.Component{constructor(h){super(h),this.panelContext={},this.subscription=new l.yU,this.getTimeRange=()=>this.props.timeRange;let y=this.prepState(h);y.alignedData=y.config.prepData([y.alignedFrame]),this.state=y,this.plotInstance=s.createRef()}static{this.contextType=a.e4}prepState(h,y=!0){let b=null;const{frames:D,fields:P,preparePlotFrame:C}=h,I=(C||v.mY)(D,P||{x:i.sJ.get(g.Ct.firstTimeField).get({}),y:i.sJ.get(g.Ct.byTypes).get(new Set([o.PU.number,o.PU.enum]))},h.timeRange);if((0,m.uY)("GraphNG",!1,"data aligned",I),I){let R=this.state?.config;y&&(R=h.prepConfig(I,this.props.frames,this.getTimeRange),(0,m.uY)("GraphNG",!1,"config prepared",R)),b={alignedFrame:I,config:R},(0,m.uY)("GraphNG",!1,"data prepared",b.alignedData)}return b}handleCursorUpdate(h){const y=h.payload?.point?.time,b=this.plotInstance.current;if(b&&y){const D=b.valToPos(y,"x");let P;if(D&&(P=(0,m.sw)(b,b.posToIdx(D))),!P||!D)return;b.setCursor({left:D,top:P})}}componentDidMount(){this.panelContext=this.context;const{eventBus:h}=this.panelContext;this.subscription.add(h.getStream(d.b_).pipe((0,r.c)(50)).subscribe({next:y=>{h!==y.origin&&this.handleCursorUpdate(y)}})),this.subscription.add(h.getStream(c.kb).pipe((0,r.c)(50)).subscribe({next:y=>this.handleCursorUpdate(y)})),this.subscription.add(h.getStream(d.ql).pipe((0,r.c)(50)).subscribe({next:()=>{const y=this.plotInstance?.current;y&&!y.cursor._lock&&y.setCursor({left:-10,top:-10})}}))}componentDidUpdate(h){const{frames:y,structureRev:b,timeZone:D,propsToDiff:P}=this.props,C=!x(h,this.props,P);if(y!==h.frames||C||D!==h.timeZone){let M=this.prepState(this.props,!1);M&&((this.state.config===void 0||D!==h.timeZone||b!==h.structureRev||!b||C)&&(M.config=this.props.prepConfig(M.alignedFrame,this.props.frames,this.getTimeRange),(0,m.uY)("GraphNG",!1,"config recreated",M.config)),M.alignedData=M.config.prepData([M.alignedFrame]),this.setState(M))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:h,height:y,children:b,renderLegend:D}=this.props,{config:P,alignedFrame:C,alignedData:M}=this.state;return P?(0,n.jsx)(p.KU,{width:h,height:y,legend:D(P),children:(I,R)=>(0,n.jsx)(u.Z,{config:P,data:M,width:I,height:R,plotRef:T=>this.plotInstance.current=T,children:b?b(P,C):null})}):null}}},16998:(k,A,e)=>{"use strict";e.d(A,{I:()=>l});var n=e(96540);const s=(0,n.createContext)({}),l=()=>{const{data:r,dimFields:i,mapSeriesIndexToDataFrameFieldIndex:g}=(0,n.useContext)(s),o=(0,n.useCallback)(()=>{const d=i.x;let c=null;for(let a=0;a<r.fields.length;a++)if(d(r.fields[a],r,[r])){c=r.fields[a];break}return c},[r,i]);return{dimFields:i,mapSeriesIndexToDataFrameFieldIndex:g,getXAxisField:o,alignedData:r}}},65575:(k,A,e)=>{"use strict";e.d(A,{My:()=>m,wX:()=>a,mY:()=>u});var n=e(11261),s=e(73060),l=e(52622),r=e(52811);const i={threshold:(x,f,E)=>x+E,midpoint:(x,f,E)=>(x+f)/2,plusone:(x,f,E)=>x+1};function g(x){if(x.frame.length===0)return x.frame;let f=!0,{frame:E,refFieldName:h,refFieldPseudoMax:y,refFieldPseudoMin:b,insertMode:D}=x;D||(D=i.threshold);const P=a(E,h);if(P==null)return E;P.state={...P.state,nullThresholdApplied:!0};const C=E.fields.map(I=>I.config.custom?.insertNulls||P.config.interval||null),M=new Set(C);if(M.delete(null),M.size===0)return E;if(M.size===1){const I=M.values().next().value;if(I<=0)return E;const R=P.values,T=E.fields.map(L=>L.values),S=o(R,T,I,b,y,D,f);return S===T?E:{...E,length:S[0].length,fields:E.fields.map((L,O)=>({...L,values:S[O]}))}}return E}function o(x,f,E,h=null,y=null,b,D){const P=x.length,C=[];if(h!=null&&h<x[0]){let T=Math.ceil((x[0]-h)/E),S=x[0]-T*E;for(;S<x[0];)C.push(b(S-E,S,E)),S+=E}C.push(x[0]);let M=x[0];for(let T=1;T<P;T++){const S=x[T];for(;S-M>E&&(C.push(b(M,S,E)),M+=E,!!D););C.push(S),M=S}if(y!=null&&y>M)for(;M+E<y;)C.push(b(M,y,E)),M+=E;const I=C.length;if(I===P)return f;const R=[];for(let T of f){let S;if(T!==x){S=Array(I);for(let L=0,O=0;L<I;L++)S[L]=x[O]===C[L]?T[O++]:null}else S=C;R.push(S)}return R}function d(x,f,E){let h,y;for(let b=0;b<f.length;b++)if(f[b]==null)y==null&&h!=null&&(y=b);else{if(y!=null){if(x[b]-h<E)for(;y<b;)f[y++]=void 0;y=null}h=x[b]}return f}function c(x){return x.type===n.PU.number&&x.config.custom?.drawStyle===l.GR.Bars&&!x.config.custom?.hideFrom?.viz}function a(x,f){return x.fields.find(E=>f!=null?E.name===f:E.type===n.PU.time)}function p(x,f){const E=a(x,f);let h=E?.values;for(let y=0;y<x.fields.length;y++){let b=x.fields[y];if(b===E||c(b))continue;let D=b.config.custom?.spanNulls;typeof D=="number"&&D!==-1&&h&&(b.values=d(h,b.values,D))}return x}function u(x,f,E){let h;e:for(let P of x)for(let C of P.fields)if(f.x(C,P,x)){h=C;break e}x=x.map(P=>h?.state?.nullThresholdApplied?P:g({frame:P,refFieldName:h.name,refFieldPseudoMin:E?.from.valueOf(),refFieldPseudoMax:E?.to.valueOf()}));let y=0;x.forEach(P=>{P.fields.forEach(C=>{c(C)&&(C.config.custom={...C.config.custom,spanNulls:-1},y++)})});let b=1/0;y>1&&x.forEach(P=>{if(!P.fields.some(c))return;const C=h.values;for(let M=0;M<C.length;M++)M>0&&(b=Math.min(b,C[M]-C[M-1]))});let D=(0,s.Fd)({frames:x,joinBy:f.x,keep:f.y,keepOriginIndices:!0});return D?(D=p(D,h.name),b!==1/0&&(D.fields.forEach((P,C)=>{let M=P.values;if(C===0){let I=M[M.length-1];M.push(I+b,I+2*b)}else c(P)?M.push(null,null):M.push(void 0,void 0)}),D.length+=2),D):null}function m(x,f){const E="na",h=`${x.min!==void 0?x.min:E}-${x.max!==void 0?x.max:E}`,y=`${x.custom?.axisSoftMin!==void 0?x.custom.axisSoftMin:E}-${x.custom?.axisSoftMax!==void 0?x.custom.axisSoftMax:E}`,b=`${x.custom?.axisPlacement!==void 0?x.custom?.axisPlacement:l.vM.Auto}`,D=x.unit??r.s,P=x.custom?.scaleDistribution?v(x.custom.scaleDistribution):l.L4.Linear,C=x.custom?.axisLabel?x.custom.axisLabel:E;return`${D}/${h}/${y}/${b}/${P}/${C}/${f}`}function v(x){return x.type===l.L4.Log?`${x.type}${x.log}`:x.type}},18262:(k,A,e)=>{"use strict";e.d(A,{Z:()=>L});var n=e(74848),s=e(96540),l=e(79041),r=e(24182),i=e(40845),g=e(99755),o=e(2543),d=e(36613),c=e(11261),a=e(83195),p=e(57875),u=e(8066),m=e(24293),v=e(28240),x=e(94624),f=e(52622),E=e(51336),h=e(74863),y=e(16895),b=e(65575);const D=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),P=Array(53);for(let O=0;O<P.length;O++)P[O]=2**O;const C=(O,j=1)=>O==null?"-":O.toFixed(j),M={drawStyle:f.GR.Line,showPoints:f.yL.Auto,axisPlacement:f.vM.Auto},I=({frame:O,theme:j,timeZones:N,getTimeRange:F,sync:U,allFrames:w,renderers:B,tweakScale:K=z=>z,tweakAxis:W=z=>z})=>{const z="__global_",Y=new E.e(N[0]);let X;Y.setPrepData(oe=>(X=oe[0],(0,y.bq)(oe[0],Y.getStackingGroups())));const q=O.fields[0];if(!q)return Y;const G="x";let te="";const H=q.config.custom?.axisPlacement!==f.vM.Hidden?f.vM.Bottom:f.vM.Hidden,se=q.config.custom?.axisPlacement!==f.vM.Hidden;if(q.type===c.PU.time){Y.addScale({scaleKey:G,orientation:f.Lt.Horizontal,direction:f.ON.Right,isTime:!0,range:()=>{const J=F();return[J.from.valueOf(),J.to.valueOf()]}});const oe=N.length>1?(J,ee)=>ee.map((de,xe)=>xe<2?null:de):void 0;for(let J=0;J<N.length;J++){const ee=N[J];Y.addAxis({scaleKey:G,isTime:!0,placement:H,show:se,label:q.config.custom?.axisLabel,timeZone:ee,theme:j,grid:{show:J===0&&q.config.custom?.axisGridShow},filter:oe})}N.length>1&&Y.addHook("drawAxes",J=>{J.ctx.save(),J.ctx.fillStyle=j.colors.text.primary,J.ctx.textAlign="left",J.ctx.textBaseline="bottom";let ee=0;J.axes.forEach(de=>{if(de.side===2){let xe=de._pos+de._size;J.ctx.fillText(N[ee],J.bbox.left,xe*d.A.pxRatio),ee++}}),J.ctx.restore()})}else Y.addScale({scaleKey:G,orientation:f.Lt.Horizontal,direction:f.ON.Right,range:(oe,J,ee)=>[q.config.min??J,q.config.max??ee]}),Y.addAxis({scaleKey:G,placement:H,show:se,label:q.config.custom?.axisLabel,theme:j,grid:{show:q.config.custom?.axisGridShow},formatValue:(oe,J)=>(0,a.cN)(q.display(oe,J))});let ne=B?.flatMap(oe=>Object.values(oe.fieldMap).filter(J=>oe.indicesOnly.indexOf(J)===-1))??[],le;for(let oe=1;oe<O.fields.length;oe++){const J=O.fields[oe],ee={...J.config,custom:{...M,...J.config.custom}},de=ee.custom;if(J===q||J.type!==c.PU.number&&J.type!==c.PU.enum)continue;let xe=J.display??C;J.config.custom?.stacking?.mode===f.gs.Percent&&(xe=(0,p.J)({field:{...J,config:{...J.config,unit:"percentunit"}},theme:j}));const re=(0,b.My)(ee,J.type),ue=(0,u.Qi)(J),ge=(0,u.lz)(J,j).color;if(Y.addScale(K({scaleKey:re,orientation:f.Lt.Vertical,direction:f.ON.Up,distribution:de.scaleDistribution?.type,log:de.scaleDistribution?.log,linearThreshold:de.scaleDistribution?.linearThreshold,min:J.config.min,max:J.config.max,softMin:de.axisSoftMin,softMax:de.axisSoftMax,centeredZero:de.axisCenteredZero,range:de.stacking?.mode===f.gs.Percent?(Ce,je,Ke)=>(je=je<0?-1:0,Ke=Ke>0?1:0,[je,Ke]):J.type===c.PU.enum?(Ce,je,Ke)=>[-1,J.config.type.enum.text.length]:void 0,decimals:J.config.decimals},J)),te||(te=re),de.axisPlacement!==f.vM.Hidden){let Ce;de.axisColorMode===f.Y$.Series&&(ue.isByValue&&J.config.custom?.gradientMode===f.on.Scheme&&ue.id===m.Y.Thresholds?Ce=(0,h.pl)(1,j,ue,J.config.thresholds):Ce=ge);const je={border:{show:de.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Ce||j.colors.text.primary},ticks:{show:de.axisBorderShow||!1,stroke:Ce||j.colors.text.primary},color:Ce||j.colors.text.primary};let Ke,_e,Fe;if(D.has(ee.unit))Ke=P;else if(J.type===c.PU.enum){let at=J.config.type.enum.text;Fe=at.map((Ct,Dt)=>Dt),_e=at}Y.addAxis(W({scaleKey:re,label:de.axisLabel,size:de.axisWidth,placement:de.axisPlacement??f.vM.Auto,formatValue:(at,Ct)=>(0,a.cN)(xe(at,Ct)),theme:j,grid:{show:de.axisGridShow},decimals:J.config.decimals,distr:de.scaleDistribution?.type,splits:Fe,values:_e,incrs:Ke,...je},J))}const Oe=de.drawStyle===f.GR.Points?f.yL.Always:de.showPoints;let Ue=()=>null;de.spanNulls!==!0&&(Ue=(Ce,je,Ke,_e)=>{let Fe=[],at=Ce.series[je];if(!Ke&&_e&&_e.length){const[Ct,Dt]=at.idxs,tt=Ce.data[0],ze=Ce.data[je],pe=Math.round(Ce.valToPos(tt[Ct],"x",!0)),Se=Math.round(Ce.valToPos(tt[Dt],"x",!0));_e[0][0]===pe&&Fe.push(Ct);for(let fe=0;fe<_e.length;fe++){let Ee=_e[fe],Pe=_e[fe+1];if(Pe&&Ee[1]===Pe[0]){let he=Ce.posToIdx(Ee[1],!0);if(ze[he]==null)for(let be=1;be<100;be++){if(ze[he+be]!=null){he+=be;break}if(ze[he-be]!=null){he-=be;break}}Fe.push(he)}}_e[_e.length-1][1]===Se&&Fe.push(Dt)}return Fe.length?Fe:null});let{fillOpacity:Xe}=de,we=null,qe=null;if(J.state?.origin){le||(le=R(O,w));const Ce=w[J.state.origin.frameIndex],je=Ce?.fields[J.state.origin.fieldIndex],Ke=(0,v.Ct)(je??J,Ce,w);if(ne.indexOf(Ke)>=0)we=()=>null,qe=()=>{};else if(de.transform===f.NU.Constant){const _e=d.A.paths.linear();we=(Fe,at)=>{const Ct=Fe._data,Dt=F();let tt=[Dt.from.valueOf(),Dt.to.valueOf()],ze=Ct[at].find(fe=>fe!=null),pe=[ze,ze],Se=Ct.slice();return Se[0]=tt,Se[at]=pe,_e({...Fe,_data:Se},at,0,1)}}if(de.fillBelowTo){const _e=O.fields.find(Dt=>de.fillBelowTo===Dt.name||de.fillBelowTo===Dt.config?.displayNameFromDS||de.fillBelowTo===(0,v.Ct)(Dt,O,w)),Fe=_e?(0,v.Ct)(_e,O,w):de.fillBelowTo,at=le.get(Ke),Ct=le.get(Fe);(0,o.isNumber)(Ct)&&(0,o.isNumber)(at)?(Y.addBand({series:[at,Ct],fill:void 0}),Xe||(Xe=35)):Xe=0}}let We;ue.id===m.Y.Thresholds&&(We=Ce=>(0,u.lz)(X.fields[Ce],j).color),Y.addSeries({pathBuilder:we,pointsBuilder:qe,scaleKey:re,showPoints:Oe,pointsFilter:Ue,colorMode:ue,fillOpacity:Xe,theme:j,dynamicSeriesColor:We,drawStyle:de.drawStyle,lineColor:de.lineColor??ge,lineWidth:de.lineWidth,lineInterpolation:de.lineInterpolation,lineStyle:de.lineStyle,barAlignment:de.barAlignment,barWidthFactor:de.barWidthFactor,barMaxWidth:de.barMaxWidth,pointSize:de.pointSize,spanNulls:de.spanNulls||!1,show:!de.hideFrom?.viz,gradientMode:de.gradientMode,thresholds:ee.thresholds,hardMin:J.config.min,hardMax:J.config.max,softMin:de.axisSoftMin,softMax:de.axisSoftMax,dataFrameFieldIndex:J.state?.origin}),de.thresholdsStyle&&ee.thresholds&&(de.thresholdsStyle.mode??f.Ly.Off)!==f.Ly.Off&&Y.addThresholds({config:de.thresholdsStyle,thresholds:ee.thresholds,scaleKey:re,theme:j,hardMin:J.config.min,hardMax:J.config.max,softMin:de.axisSoftMin,softMax:de.axisSoftMax})}let _=(0,y.ro)(O);Y.setStackingGroups(_),B?.forEach(oe=>{le||(le=R(O,w));let J={};for(let ee in oe.fieldMap){let de=oe.fieldMap[ee];J[ee]=le.get(de)}oe.init(Y,J)}),Y.scaleKeys=[G,te];const Q=15;let ae={dataIdx:(oe,J,ee,de)=>{let xe=oe.data[J];if(xe[ee]==null){let re=null,ue=null,Te;for(Te=ee;re==null&&Te-- >0;)xe[Te]!=null&&(re=Te);for(Te=ee;ue==null&&Te++<xe.length;)xe[Te]!=null&&(ue=Te);let ge=oe.data[0],Oe=oe.valToPos(de,"x"),Ue=ue==null?1/0:oe.valToPos(ge[ue],"x"),Xe=re==null?-1/0:oe.valToPos(ge[re],"x"),we=Oe-Xe,qe=Ue-Oe;we<=qe?we<=Q&&(ee=re):qe<=Q&&(ee=ue)}return ee}};return U&&U()!==x.y.Off&&(ae.sync={key:z,scales:[G,null]}),Y.setCursor(ae),Y};function R(O,j){const N=new Map;return O.fields.forEach((F,U)=>{const w=F.state?.origin;if(w){const B=j[w.frameIndex]?.fields[w.fieldIndex];B&&N.set((0,v.Ct)(B,j[w.frameIndex],j),U)}}),N}const T=["legend","options","theme"];class S extends s.Component{constructor(){super(...arguments),this.prepConfig=(j,N,F)=>{const{sync:U}=this.context,{theme:w,timeZone:B,renderers:K,tweakAxis:W,tweakScale:z}=this.props;return I({frame:j,theme:w,timeZones:Array.isArray(B)?B:[B],getTimeRange:F,sync:U,allFrames:N,renderers:K,tweakScale:z,tweakAxis:W})},this.renderLegend=j=>{const{legend:N,frames:F}=this.props;return!j||N&&!N.showLegend||!(0,r.t)(j,F)?null:(0,n.jsx)(r.$,{data:F,config:j,...N})}}static{this.contextType=l.e4}render(){return(0,n.jsx)(g.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:T,renderLegend:this.renderLegend})}}const L=(0,i.cV)(S);L.displayName="TimeSeries"},90606:(k,A,e)=>{"use strict";e.d(A,{T:()=>y});var n=e(74848),s=e(32196),l=e(96540),r=e(1604),i=e(94624),g=e(57875),o=e(24293),d=e(28240),c=e(83195),a=e(11261),p=e(14588),u=e(52622),m=e(3139),v=e(17464),x=e(69503),f=e(16895),E=e(40845);const h=10,y=({mode:C=u.$N.Single,sortOrder:M=u.xB.None,sync:I,timeZone:R,config:T,renderTooltip:S,...L})=>{const O=(0,l.useRef)(),j=(0,E.$j)(),[N,F]=(0,l.useState)(null),[U,w]=(0,l.useState)(null),[B,K]=(0,l.useState)([]),[W,z]=(0,l.useState)(null),[Y,X]=(0,l.useState)(!1),q=(0,r.A)();let G=null;const te=(0,E.of)(P);if((0,l.useLayoutEffect)(()=>{let _;const Q=()=>{q()&&(X(!0),O.current?.root.classList.add("plot-active"))},ae=()=>{q()&&(z(null),X(!1),O.current?.root.classList.remove("plot-active"))};return T.addHook("syncRect",(oe,J)=>_=J),T.addHook("init",oe=>{O.current=oe,oe.over.addEventListener("mouseenter",Q),oe.over.addEventListener("mouseleave",ae),G=oe.root.closest("[tabindex]"),G&&(G.addEventListener("focus",Q),G.addEventListener("blur",ae)),I&&I()===i.y.Crosshair&&oe.root.classList.add("shared-crosshair")}),T.addHook("setLegend",oe=>{q()&&(w(oe.legend.idx),K(oe.legend.idxs.slice()))}),T.addHook("setCursor",oe=>{if(!_||!q())return;const{x:J,y:ee}=D(oe,_);z(J!==void 0&&ee!==void 0?{x:J,y:ee}:null)}),T.addHook("setSeries",(oe,J)=>{q()&&F(J)}),()=>{z(null),O.current&&(O.current.over.removeEventListener("mouseleave",ae),O.current.over.removeEventListener("mouseenter",Q),G&&(G.removeEventListener("focus",Q),G.removeEventListener("blur",ae)))}},[T,z,X,w,K]),U===null||!Y&&I&&I()===i.y.Crosshair)return null;let H=L.data.fields[0];if(!H)return null;const se=H.display||(0,g.J)({field:H,timeZone:R,theme:j});let ne=null,le=se(H.values[U]).text;if(S)ne=S(L.data,N,U);else{if(C===u.$N.Single&&N!==null){const _=L.data.fields[N];if(!_)return null;const Q=B?.[N]??U;le=se(H.values[Q]).text;const oe=(_.display||(0,g.J)({field:_,timeZone:R,theme:j}))(_.values[Q]);ne=(0,n.jsx)(m.o,{series:[{color:oe.color||o.F,label:(0,d.Ct)(_,L.data,L.frames),value:oe?(0,c.cN)(oe):null}],timestamp:le})}if(C===u.$N.Multi){let _=[];const Q=L.data,ae=Q.fields,oe=[];for(let J=0;J<ae.length;J++){const ee=Q.fields[J];if(!ee||ee===H||ee.type===a.PU.time||ee.type!==a.PU.number||ee.config.custom?.hideFrom?.tooltip||ee.config.custom?.hideFrom?.viz)continue;const de=L.data.fields[J].values[B[J]],xe=ee.display(de);oe.push(de),_.push({color:xe.color||o.F,label:(0,d.Ct)(ee,Q,L.frames),value:xe?(0,c.cN)(xe):null,isActive:N===J})}if(M!==u.xB.None){const J=[..._],ee=p.sortValues(M);_.sort((de,xe)=>{const re=J.indexOf(de),ue=J.indexOf(xe);return ee(oe[re],oe[ue])})}ne=(0,n.jsx)(m.o,{series:_,timestamp:le})}}return(0,n.jsx)(v.ZL,{className:Y?te.tooltipWrapper:void 0,children:ne&&W&&(0,n.jsx)(x.o,{position:{x:W.x,y:W.y},offset:{x:h,y:h},children:ne})})};function b({left:C,top:M},I){return C===void 0||M===void 0?!1:C<0||C>I.width||M<0||M>I.height}function D(C,M){let I,R;const T=C.cursor.left||0,S=C.cursor.top||0;if(b(C.cursor,M)){const L=C.posToIdx(T);if(S<0||S>M.height){let O=(0,f.sw)(C,L);O&&(R=M.top+O,T>=0&&T<=M.width&&(I=M.left+C.valToPos(C.data[0][C.posToIdx(T)],C.series[0].scale)))}}else I=M.left+T,R=M.top+S;return{x:I,y:R}}const P=C=>({tooltipWrapper:(0,s.css)({"z-index":C.zIndex.portal+1+" !important"})})},76284:(k,A,e)=>{"use strict";e.d(A,{j:()=>r});var n=e(96540);const s=5,l=i=>i!=null&&!i.ctrlKey&&!i.metaKey,r=({onZoom:i,config:g,withZoomY:o=!1})=>((0,n.useLayoutEffect)(()=>{let d=!1,c=!1;o&&g.addHook("init",a=>{a.over.addEventListener("mousedown",p=>{if(l(p)&&p.button===0&&p.shiftKey){c=!0,a.cursor.drag.x=!1,a.cursor.drag.y=!0;let u=m=>{a.cursor.drag.x=!0,a.cursor.drag.y=!1,document.removeEventListener("mouseup",u,!0)};document.addEventListener("mouseup",u,!0)}},!0)}),g.addHook("setSelect",a=>{const p=a.scales.x.ori===0;if(l(a.cursor.event)){if(o&&c){if(a.select.height>=s){for(let u in a.scales)if(u!=="x"){const m=p?a.posToVal(a.select.top,u):a.posToVal(a.select.left+a.select.width,u),v=p?a.posToVal(a.select.top+a.select.height,u):a.posToVal(a.select.left,u);a.setScale(u,{min:v,max:m})}d=!0}c=!1}else if(a.select.width>=s){const u=p?a.posToVal(a.select.left,"x"):a.posToVal(a.select.top+a.select.height,"x"),m=p?a.posToVal(a.select.left+a.select.width,"x"):a.posToVal(a.select.top,"x");i({from:u,to:m}),d=!1}}a.setSelect({left:0,width:0,top:0,height:0},!1)}),g.setCursor({bind:{dblclick:a=>()=>{if(!l(a.cursor.event))return null;if(o&&d){for(let p in a.scales)p!=="x"&&a.setScale(p,{min:null,max:null});d=!1}else{let p=a.scales.x;const u=p.min,m=p.max,v=(m-u)/2;i({from:u-v,to:m+v})}return null}}})},[g,i,o]),null)},8984:(k,A,e)=>{"use strict";e.r(A),e.d(A,{ALERTING_COLOR:()=>r.xj,AxisPlacement:()=>d.vM,BarAlignment:()=>d.Nj,BarValueVisibility:()=>d.TC,BracesPlugin:()=>o.e1,ClearPlugin:()=>o.vJ,ClipboardPlugin:()=>o.sW,DEFAULT_ANNOTATION_COLOR:()=>r.Mk,DOMUtil:()=>r.bk,DrawStyle:()=>d.yg,EventsWithValidation:()=>r.Pw,GlobalStyles:()=>i.kH,GraphGradientMode:()=>d.on,GraphThresholdsStyleMode:()=>d.Ly,IndentationPlugin:()=>o.TA,LegendDisplayMode:()=>d.lm,LineInterpolation:()=>d.dx,NO_DATA_COLOR:()=>r.nO,NewlinePlugin:()=>o.Om,NodeGraphDataFrameFieldNames:()=>r.uc,OK_COLOR:()=>r.Xw,PENDING_COLOR:()=>r.ct,PointVisibility:()=>d.nT,REGION_FILL_ALPHA:()=>r.UJ,ReactUtils:()=>r.zt,RunnerPlugin:()=>o.Ul,SCHEMA:()=>r.yx,ScaleDirection:()=>d.ON,ScaleOrientation:()=>d.Lt,SearchFunctionType:()=>r.Tt,SelectionShortcutsPlugin:()=>o.l9,SlatePrism:()=>o.De,StackingMode:()=>d.gs,SuggestionsPlugin:()=>o.Pz,TableCellDisplayMode:()=>d.ob,ThemeContext:()=>i.Dx,TooltipDisplayMode:()=>d.$N,ansicolor:()=>r.DB,attachDebugger:()=>r.hF,calculateFontSize:()=>r.Vr,colors:()=>r.Tj,commonOptionsBuilder:()=>g.j,createLogger:()=>r.h,fuzzyMatch:()=>r.It,getCanvasContext:()=>r.Yc,getCellLinks:()=>r.kl,getScrollbarWidth:()=>r.XJ,getTagColor:()=>r.yC,getTagColorIndexFromName:()=>r.JF,getTagColorsFromName:()=>r.MC,getTextColorForAlphaBackground:()=>r.mZ,getTextColorForBackground:()=>r.sg,getTheme:()=>i.O4,hasValidationEvent:()=>r.K,isCompactUrl:()=>r.Fr,linkModelToContextMenuItems:()=>r.Jl,makeFragment:()=>r.dF,makeValue:()=>r.mO,measureText:()=>r.kD,mockTheme:()=>i.mG,mockThemeContext:()=>i.fq,regexValidation:()=>r.RP,sortedColors:()=>r.Ih,styleMixins:()=>i.YF,stylesFactory:()=>i.N3,useForceUpdate:()=>r.CH,useStyles:()=>i.IS,useStyles2:()=>i.of,useTheme:()=>i.DP,useTheme2:()=>i.$j,validate:()=>r.tf,withTheme:()=>i.SL,withTheme2:()=>i.cV});var n=e(94333),l={};for(const c in n)c!=="default"&&(l[c]=()=>n[c]);e.d(A,l);var s=e(80186),l={};for(const c in s)["default","Icon","IconButton","ConfirmButton","DeleteButton","Tooltip","PopoverController","Popover","Toggletip","Portal","getPortalContainer","PortalContainer","CustomScrollbar","TabbedContainer","ClipboardButton","Cascader","ButtonCascader","InlineToast","LoadingPlaceholder","LoadingBar","ColorPicker","SeriesColorPicker","ColorPickerInput","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","EmptySearchResult","EmptyState","UnitPicker","StatsPicker","RefreshPicker","defaultIntervals","TimeRangePicker","TimePickerTooltip","TimeRangeLabel","TimeOfDayPicker","TimeZonePicker","WeekStartPicker","getWeekStart","DatePicker","DatePickerWithInput","DateTimePicker","List","InteractiveTable","TagsInput","AutoSaveField","Pagination","Tag","TagList","FilterPill","ConfirmModal","QueryField","CodeEditor","ReactMonacoEditor","CodeEditorSuggestionItemKind","variableSuggestionToCodeEditorSuggestion","Modal","ModalHeader","ModalTabsHeader","ModalTabContent","ModalsProvider","ModalRoot","ModalsController","ModalsContext","PageToolbar","SetInterval","Table","TableInputCSV","TabsBar","Tab","VerticalTab","TabContent","Counter","RenderUserContentAsHTML","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Sparkline","Gauge","BarGauge","VizTooltip","VizTooltipContainer","SeriesTable","SeriesTableRow","VizRepeater","PanelChrome","PanelChromeLoadingIndicator","PanelContextProvider","PanelContextRoot","usePanelContext","VizLayout","SeriesVisibilityChangeBehavior","VizLegend","VizLegendListItem","Alert","GraphSeriesToggler","Collapse","ControlledCollapse","CollapsableSection","DataLinkButton","FieldLinkList","FullWidthButtonContainer","ClickOutsideWrapper","CallToActionCard","ContextMenu","Menu","MenuGroup","MenuItem","WithContextMenu","DataLinksInlineEditor","DataLinkInput","DataLinksContextMenu","SeriesIcon","InfoBox","FeatureInfoBox","FeatureBadge","JSONFormatter","JsonExplorer","ErrorBoundary","ErrorBoundaryAlert","withErrorBoundary","ErrorWithStack","DataSourceHttpSettings","CustomHeadersSettings","AlertingSettings","SecureSocksProxySettings","TLSAuthSettings","CertificationKey","Spinner","FadeTransition","SlideOutTransition","Segment","SegmentAsync","SegmentInput","SegmentSelect","SegmentSection","Drawer","Slider","RangeSlider","Form","sharedInputStyle","InputControl","Button","LinkButton","ButtonGroup","clearButtonStyles","ToolbarButton","ToolbarButtonRow","ValuePicker","fieldMatchersUI","Link","TextLink","Text","Box","Stack","Grid","Space","Label","Field","Legend","FieldSet","FieldValidationMessage","InlineField","InlineSegmentGroup","InlineLabel","InlineFieldRow","FieldArray","resetSelectStyles","SelectMenuOptions","getSelectStyles","HorizontalGroup","VerticalGroup","Container","Badge","RadioButtonGroup","RadioButtonDot","RadioButtonList","Input","getInputStyles","AutoSizeInput","FilterInput","Switch","InlineSwitch","Checkbox","TextArea","FileUpload","TimeRangeInput","RelativeTimeRangePicker","Card","getCardStyles","CardContainer","FormattedValueDisplay","ButtonSelect","Dropdown","PluginSignatureBadge","UserIcon","Avatar","InlineFormLabel","Divider","getDragStyles","useSplitter","LegacyForms","LegacyInputStatus","ScaleDistribution","BarGaugeDisplayMode","UPlotConfigBuilder","UPLOT_AXIS_FONT_SIZE","UPlotChart","PlotLegend","FIXED_UNIT","BrowserLabel","PanelContainer","Graph","GraphWithLegend","GraphContextMenu","GraphContextMenuHeader","graphTimeFormat","graphTickFormatter","GraphNG","TimeSeries","useGraphNGContext","preparePlotFrame","buildScaleKey","ZoomPlugin","TooltipPlugin","convertOldAngularValueMapping","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","MultiSelect","Select","SelectContainer","VirtualizedSelect","SecretInput","SecretTextArea","FileDropzone","FileDropzoneDefaultChildren","FileListItem","graphFieldOptions","EventsCanvas","Marker","XYCanvas","EventBusPlugin","KeyboardPlugin","TooltipPlugin2","SeriesVisibilityChangeMode"].indexOf(c)<0&&(l[c]=()=>s[c]);e.d(A,l);var r=e(67985),i=e(7918),g=e(42482),o=e(50955),d=e(49149)},38248:(k,A,e)=>{"use strict";e.d(A,{W:()=>m,r:()=>a});var n=e(74848),s=e(11261),l=e(27310),r=e(52622),i=e(88575),g=e(94354),o=e(10354),d=e(90182),c=e(52198);function a(v,x,f){const E=["Axis"];v.addRadio({path:"axisPlacement",name:"Placement",category:E,defaultValue:c.t.axisPlacement[0].value,settings:{options:c.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:E,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:h=>h.axisPlacement!==r.vM.Hidden,shouldApply:h=>h.type!==s.PU.time&&h.type!==s.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:E,settings:{placeholder:"Auto"},showIf:h=>h.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:E,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:h=>h.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:E,defaultValue:r.Y$.Text,settings:{options:[{value:r.Y$.Text,label:"Text"},{value:r.Y$.Series,label:"Series"}]},showIf:h=>h.axisPlacement!==r.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:E,defaultValue:!1,showIf:h=>h.axisPlacement!==r.vM.Hidden}),v.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:E,editor:m,override:m,defaultValue:{type:r.L4.Linear},shouldApply:h=>h.type===s.PU.number,process:l.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:E,defaultValue:!1,showIf:h=>h.scaleDistribution?.type!==r.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:x.axisSoftMin,category:E,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:x.axisSoftMax,category:E,settings:{placeholder:"See: Standard options > Max"}})}const p=[{label:"Linear",value:r.L4.Linear},{label:"Logarithmic",value:r.L4.Log},{label:"Symlog",value:r.L4.Symlog}],u=[{label:"2",value:2},{label:"10",value:10}],m=({value:v,onChange:x})=>{const f=v?.type??r.L4.Linear,E=v?.log??2;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginBottom:16},children:(0,n.jsx)(g.z,{value:f,options:p,onChange:h=>{x({...v,type:h,log:h===r.L4.Linear?void 0:E})}})}),(f===r.L4.Log||f===r.L4.Symlog)&&(0,n.jsx)(i.D,{label:"Log base",children:(0,n.jsx)(d.l6,{options:u,value:E,onChange:h=>{x({...v,log:h.value})}})}),f===r.L4.Symlog&&(0,n.jsx)(i.D,{label:"Linear threshold",children:(0,n.jsx)(o.p,{placeholder:"1",value:v?.linearThreshold,onChange:h=>{x({...v,linearThreshold:Number(h.currentTarget.value)})}})})]})}},11404:(k,A,e)=>{"use strict";e.d(A,{e:()=>d});var n=e(74848),s=e(2543),l=e.n(s),r=e(96540),i=e(92174),g=e(67061);const o=({value:c,onChange:a})=>{const p=(0,r.useCallback)(u=>{a({...c,[u]:!c[u]})},[c,a]);return(0,n.jsx)(g.B,{gap:.5,children:Object.keys(c).map(u=>{const m=u;return(0,n.jsx)(i.m,{icon:c[m]?"eye-slash":"eye",onClick:()=>p(m),label:(0,s.startCase)(m),selected:c[m]},m)})})};function d(c){c.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:o,override:o,shouldApply:()=>!0,hideFromDefaults:!0,process:a=>a})}},22680:(k,A,e)=>{"use strict";e.d(A,{H:()=>l});var n=e(69550),s=e(52622);function l(r,i=!0){r.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:!0}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:s.lm.List,settings:{options:[{value:s.lm.List,label:"List"},{value:s.lm.Table,label:"Table"}]},showIf:g=>g.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:g=>g.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:g=>g.legend.showLegend&&g.legend.placement==="right"}),i&&r.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:n.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:g=>g.legend.showLegend!==!1})}},56675:(k,A,e)=>{"use strict";e.d(A,{I:()=>p,m:()=>a});var n=e(74848),s=e(27310),l=e(11261),r=e(52622),i=e(94354),g=e(29158),o=e(10354),d=e(67061),c=e(52198);const a=({value:u,context:m,onChange:v,item:x})=>(0,n.jsxs)(d.B,{children:[(0,n.jsx)(i.z,{value:u?.mode||r.gs.None,options:x.settings?.options??[],onChange:f=>{v({...u,mode:f})}}),m.isOverride&&u?.mode&&u?.mode!==r.gs.None&&(0,n.jsx)(o.p,{type:"text",placeholder:"Group",suffix:(0,n.jsx)(g.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:u?.group,onChange:f=>{v({...u,group:f.currentTarget.value.trim()})}})]});function p(u,m,v=["Graph styles"]){u.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:v,defaultValue:m,editor:a,override:a,settings:{options:c.t.stacking},process:s.hS,shouldApply:x=>x.type===l.PU.number})}},71242:(k,A,e)=>{"use strict";e.d(A,{I:()=>n});function n(s,l=!0){l&&s.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),s.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(k,A,e)=>{"use strict";e.d(A,{D:()=>s});var n=e(52622);function s(l,r=!1,i=!1,g){const o=["Tooltip"],d=r?[{value:n.$N.Single,label:"Single"},{value:n.$N.None,label:"Hidden"}]:[{value:n.$N.Single,label:"Single"},{value:n.$N.Multi,label:"All"},{value:n.$N.None,label:"Hidden"}],c=[{value:n.xB.None,label:"None"},{value:n.xB.Ascending,label:"Ascending"},{value:n.xB.Descending,label:"Descending"}];l.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:o,defaultValue:g?.tooltip?.mode??n.$N.Single,settings:{options:d}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:o,defaultValue:g?.tooltip?.sort??n.xB.None,showIf:a=>a.tooltip?.mode===n.$N.Multi,settings:{options:c}}),i&&l.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:o,settings:{integer:!0},showIf:a=>a.tooltip?.mode!==n.$N.None}),l.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:o,settings:{integer:!0},showIf:a=>a.tooltip?.mode!==n.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:o,defaultValue:void 0,settings:{integer:!0},showIf:a=>a.tooltip?.mode===n.$N.Multi})}},42482:(k,A,e)=>{"use strict";e.d(A,{j:()=>n});var n={};e.r(n),e.d(n,{ScaleDistributionEditor:()=>s.W,StackingEditor:()=>o.m,addAxisConfig:()=>s.r,addHideFrom:()=>l.e,addLegendOptions:()=>r.H,addStackingConfig:()=>o.I,addTextSizeOptions:()=>g.I,addTooltipOptions:()=>i.D});var s=e(38248),l=e(11404),r=e(22680),i=e(89654),g=e(71242),o=e(56675)},49149:(k,A,e)=>{"use strict";e.d(A,{$N:()=>n.$N,Lt:()=>n.Lt,Ly:()=>n.Ly,Nj:()=>n.Nj,ON:()=>n.ON,TC:()=>n.yL,dx:()=>n.dx,gs:()=>n.gs,lm:()=>n.lm,nT:()=>n.yL,ob:()=>n.ob,on:()=>n.on,vM:()=>n.vM,yg:()=>n.GR});var n=e(52622)},74738:(k,A,e)=>{"use strict";e.d(A,{v:()=>n});function n(){return{onKeyDown(s,l,r){const i=l.value;if(i.selection.isExpanded)return r();if(s.key==="k"&&s.ctrlKey){s.preventDefault();const g=i.anchorText.text,o=i.selection.anchor.offset,c=g.length-o;return l.deleteForward(c),!0}return r()}}}},99453:(k,A,e)=>{"use strict";e.d(A,{s:()=>l});const n=(r,i,g)=>{if(!r.length)return;const o=r.slice(0,-1).join("").length+r.length-1;return r.join(`
`).slice(i,o+g)},s=r=>r?.replace(/[\uFEFF]/g,"");function l(){const r={onCopy(i,g,o){i.preventDefault();const{document:d,selection:c}=g.value,{start:{offset:a},end:{offset:p}}=c,u=d.getLeafBlocksAtRange(c).toArray().map(v=>v.text),m=s(n(u,a,p));return m&&i.clipboardData&&i.clipboardData.setData("Text",m),!0},onPaste(i,g,o){if(i.preventDefault(),i.clipboardData){const c=s(i.clipboardData.getData("Text"))?.split(`
`);if(c&&c.length){g.insertText(c[0]);for(const a of c.slice(1))g.splitBlock().insertText(a)}}return!0}};return{...r,onCut(i,g,o){return r.onCopy(i,g,o),g.deleteAtRange(g.value.selection),!0}}}},1020:(k,A,e)=>{"use strict";e.d(A,{T:()=>a});var n=e(57746),s=e(82611),l=e(52845);const r=(0,n.Sn)("mod+["),i=(0,n.Sn)("shift+tab"),g=(0,n.Sn)("mod+]"),o="  ",d=(p,u,m)=>{const{startBlock:v,endBlock:x,selection:{start:{offset:f,key:E},end:{offset:h,key:y}}}=u.value;if(l.A.serialize(u.value)==="")return;p.preventDefault();const b=v.getFirstText();b&&f===0&&E===b.key&&h===b.text.length&&y===b.key||!v.equals(x)?c(u,"right"):u.insertText(o)},c=(p,u)=>{const m=p.value.selection,v=p.value.document.getLeafBlocksAtRange(m).toArray();if(u==="left")for(const x of v){const f=x.text.length-x.text.trimLeft().length,E=x.getFirstText().key,h={anchor:{key:E,offset:f,path:[]},focus:{key:E,offset:f,path:[]}};p.deleteBackwardAtRange(s.Q6.create(h),Math.min(o.length,f))}else{const{startText:x}=p.value,f=x.text.slice(0,m.start.offset),E=/^\s*$/.test(f);for(const h of v)p.insertTextByKey(h.getFirstText().key,0,o);E&&p.moveStartBackward(o.length)}};function a(){return{onKeyDown(p,u,m){if(r(p)||i(p))p.preventDefault(),c(u,"left");else if(g(p))p.preventDefault(),c(u,"right");else if(p.key==="Tab")d(p,u,m);else return m();return!0}}}},50955:(k,A,e)=>{"use strict";e.d(A,{e1:()=>r,vJ:()=>i.v,sW:()=>g.s,TA:()=>o.T,Om:()=>d.O,Ul:()=>c.U,l9:()=>a.l,De:()=>p.D,Pz:()=>u.Pz});var n=e(62938);const s={"[":"]","{":"}","(":")"},l="brace_match";function r(){return{onKeyDown(m,v,x){const{value:f}=v;switch(m.key){case"(":case"{":case"[":{const{start:{offset:E,key:h},end:{offset:y,key:b},focus:{offset:D}}=f.selection,P=f.focusText.text;if(f.selection.isExpanded)return m.preventDefault(),v.insertTextByKey(h,E,m.key).insertTextByKey(b,y+1,s[m.key]).moveEndBackward(1),!0;if(D===P.length||P[D]===" "||Object.values(s).includes(P[D])){m.preventDefault();const C=s[m.key],M={key:`${l}-${(0,n.A)()}`,type:`${l}-${C}`,anchor:{key:h,offset:E,object:"point"},focus:{key:b,offset:y+1,object:"point"},object:"annotation"};return v.insertText(m.key).insertText(C).addAnnotation(M).moveBackward(1),!0}break}case")":case"}":case"]":{const E=f.anchorText.text,h=f.selection.anchor.offset,y=E[h],b=m.key,D=`${l}-${b}`,P=f.annotations.find(C=>C?.type===D&&C.anchor.key===f.anchorText.key);if(P&&y===b&&!f.selection.isExpanded)return m.preventDefault(),v.moveFocusForward(1).removeAnnotation(P).moveAnchorForward(1),!0;break}case"Backspace":{const E=f.anchorText.text,h=f.selection.anchor.offset,y=E[h-1],b=E[h];if(s[y]&&s[y]===b)return m.preventDefault(),v.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return x()}}}var i=e(74738),g=e(99453),o=e(1020),d=e(88295),c=e(4269),a=e(31589),p=e(41781),u=e(80903)},88295:(k,A,e)=>{"use strict";e.d(A,{O:()=>s});function n(l){let r=l.length-l.trimLeft().length;if(r){let i=l[0];for(;--r;)i+=l[0];return i}return""}function s(){return{onKeyDown(l,r,i){const g=r.value;if(g.selection.isExpanded)return i();if(l.key==="Enter"){l.preventDefault();const{startBlock:o}=g,d=o.text,c=n(d);return r.splitBlock().insertText(c).focus()}return i()}}}},4269:(k,A,e)=>{"use strict";e.d(A,{U:()=>n});function n({handler:s}){return{onKeyDown(l,r,i){return s&&l.key==="Enter"&&(l.shiftKey||l.ctrlKey)?(l.preventDefault(),s(l),r):i()}}}},31589:(k,A,e)=>{"use strict";e.d(A,{l:()=>l});var n=e(57746);const s=(0,n.Sn)("mod+l");function l(){return{onKeyDown(r,i,g){if(s(r)){r.preventDefault();const{focusBlock:o,document:d}=i.value;i.moveAnchorToStartOfBlock(),d.getNextBlock(o.key)?i.moveFocusToStartOfNextBlock():i.moveFocusToEndOfText()}else return g();return!0}}}},84694:(k,A,e)=>{"use strict";e.d(A,{A:()=>s});const s="prism-token"},41781:(k,A,e)=>{"use strict";e.d(A,{D:()=>u,R:()=>f});var n=e(28848),s=e.n(n),l=e(82611),r=e(84694),i=e(74848),g=e(49568);function o(E){return E.object==="block"&&E.type==="code_block"}function d(E){return"javascript"}function c(E,h,y){const{decoration:b}=E;if(b.type!==r.A)return y();const D=b.data.get("className");return(0,i.jsx)("span",{className:D,children:E.children})}class a extends(0,g.Record)({onlyIn:o,getSyntax:d,renderDecoration:c}){constructor(h){super(h)}}const p=a;function u(E={},h=s().languages){const y=new p(E);return{decorateNode:(b,D,P)=>{if(!y.onlyIn(b))return P();const C=l.eB.create(b),M=y.getSyntax(C),I=h[M];if(!I)return[];const T=C.getTexts().map(j=>j&&j.getText()).join(`
`),S=s().tokenize(T,I),L=f(S),O=D.value.data.set("tokens",L);return D.setData(O),m(y,S,C)},renderDecoration:(b,D,P)=>y.renderDecoration({children:b.children,decoration:b.decoration},D,P)}}function m(E,h,y){const b=y.getTexts(),D=[];let P=0,C=0;return b.forEach(M=>{C=P+M.getText().length;let I=0;function R(T,S){if(typeof T=="string"){if(S){const L=v({text:M,textStart:P,textEnd:C,start:I,end:I+T.length,className:`prism-token token ${S}`,block:y});L&&D.push(L)}I+=T.length}else if(S=`${S} ${T.type}`,T.alias&&(S+=" "+T.alias),typeof T.content=="string"){const L=v({text:M,textStart:P,textEnd:C,start:I,end:I+T.content.length,className:`prism-token token ${S}`,block:y});L&&D.push(L),I+=T.content.length}else for(let L=0;L<T.content.length;L+=1)R(T.content[L],S)}h.forEach(R),P=C+1}),D}function v({text:E,textStart:h,textEnd:y,start:b,end:D,className:P,block:C}){return b>=y||D<=h?null:(b=Math.max(b,h),D=Math.min(D,y),b-=h,D-=h,C.createDecoration({object:"decoration",anchor:{key:E.key,offset:b,object:"point"},focus:{key:E.key,offset:D,object:"point"},type:r.A,data:{className:P}}))}function x(E){return typeof E=="string"?[{content:E,types:[],aliases:[]}]:Array.isArray(E)?E.flatMap(h=>x(h)):E instanceof s().Token?x(E.content).flatMap(h=>{let y=[];return typeof E.alias=="string"?y=[E.alias]:y=E.alias??[],{content:h.content,types:[E.type,...h.types],aliases:[...y,...h.aliases]}}):[]}function f(E){const h=x(E);if(!h.length)return[];const y=h[0];y.prev=null,y.next=h.length>=2?h[1]:null,y.offsets={start:0,end:y.content.length};for(let D=1;D<h.length-1;D++)h[D].prev=h[D-1],h[D].next=h[D+1],h[D].offsets={start:h[D-1].offsets.end,end:h[D-1].offsets.end+h[D].content.length};const b=h[h.length-1];return b.prev=h.length>=2?h[h.length-2]:null,b.next=null,b.offsets={start:h.length>=2?h[h.length-2].offsets.end:0,end:h.length>=2?h[h.length-2].offsets.end+b.content.length:b.content.length},h}},80903:(k,A,e)=>{"use strict";e.d(A,{Pz:()=>F});var n=e(74848),s=e(2543),l=e(32196),r=e(96540),i=e(40961),g=e(91793),o=e(60578),d=e(50774),c=e(49579);const a=B=>B.reduce((K,{items:W,label:z})=>(K.push({label:z,kind:d.I.GroupTitle}),W.reduce((Y,X)=>(Y.push(X),Y),K)),[]),p=B=>B.reduce((K,W)=>K.length<W.label.length?W.label:K,""),u=(B,K,W)=>{const z=(0,c.A)(W,{font:B.typography.fontFamilyMonospace,fontSize:B.typography.bodySmall.fontSize,fontWeight:"normal"}),Y=v(z.width,B),X=m(z.height,B),q=x(X,K);return{listWidth:Y,listHeight:q,itemHeight:X}},m=(B,K)=>{const W=K.spacing.gridSize*2;return B+W},v=(B,K)=>{const W=K.spacing.gridSize*3;return Math.min(Math.max(B+W,200),800)},x=(B,K)=>{const W=Math.min(K.length,10),z=100,Y=W*B;return Math.max(Y,z)};var f=e(36663),E=e(40845);const h=(B,K,W)=>({typeaheadItem:(0,l.css)({label:"type-ahead-item",zIndex:11,padding:B.spacing(1,1,1,2),border:B.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:B.colors.background.secondary,color:B.colors.text.secondary,boxShadow:`0 0 20px ${B.v1.colors.dropdownShadow}`,visibility:W===!0?"visible":"hidden",width:"250px",minHeight:`${K+parseInt(B.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),y=({item:B,height:K})=>{const W=B&&!!B.documentation,z=B?B.label:"",Y=(0,f.G)(B?.documentation),X=(0,E.$j)(),q=h(X,K,W);return(0,n.jsxs)("div",{className:(0,l.cx)([q.typeaheadItem]),children:[(0,n.jsx)("b",{children:z}),(0,n.jsx)("hr",{}),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:Y}})]})};var b=e(23257),D=e.n(b),P=e(5313);const C=B=>({typeaheadItem:(0,l.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:B.typography.fontFamilyMonospace,padding:B.spacing(1,1,1,2),fontSize:B.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[B.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,l.css)({label:"type-ahead-item-selected",backgroundColor:B.colors.background.secondary}),typeaheadItemMatch:(0,l.css)({label:"type-ahead-item-match",color:B.v1.palette.yellow,borderBottom:`1px solid ${B.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,l.css)({label:"type-ahead-item-group-title",color:B.colors.text.secondary,fontSize:B.typography.bodySmall.fontSize,lineHeight:B.typography.body.lineHeight,padding:B.spacing(1)})}),M=B=>{const K=(0,E.of)(C),{isSelected:W,item:z,prefix:Y,style:X,onMouseEnter:q,onMouseLeave:G,onClickItem:te}=B,H=W?(0,l.cx)([K.typeaheadItem,K.typeaheadItemSelected]):(0,l.cx)([K.typeaheadItem]),se=(0,l.cx)([K.typeaheadItemMatch]),ne=(0,l.cx)([K.typeaheadItemGroupTitle]),le=z.label||"";return z.kind===d.I.GroupTitle?(0,n.jsx)("li",{className:ne,style:X,children:(0,n.jsx)("span",{children:le})}):(0,n.jsx)("li",{role:"none",children:(0,n.jsx)("button",{role:"menuitem",className:H,style:X,onMouseDown:te,onMouseEnter:q,onMouseLeave:G,type:"button",children:z.highlightParts!==void 0?(0,n.jsx)(P.z,{text:le,highlightClassName:se,highlightParts:z.highlightParts}):(0,n.jsx)(D(),{textToHighlight:le,searchWords:[Y??""],autoEscape:!0,highlightClassName:se})})})},I=(B,K)=>B-K*Math.floor(B/K);class R extends r.PureComponent{constructor(){super(...arguments),this.listRef=(0,r.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const K=a(this.props.groupedItems),W=p(K),{listWidth:z,listHeight:Y,itemHeight:X}=u(this.context,K,W);this.setState({listWidth:z,listHeight:Y,itemHeight:X,allItems:K})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(K,W)=>{if(this.state.typeaheadIndex!==null&&W.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,s.isEqual)(K.groupedItems,this.props.groupedItems)===!1){const z=a(this.props.groupedItems),Y=p(z),{listWidth:X,listHeight:q,itemHeight:G}=u(this.context,z,Y);this.setState({listWidth:X,listHeight:q,itemHeight:G,allItems:z,typeaheadIndex:null})}},this.onMouseEnter=K=>{this.setState({hoveredItem:K})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=K=>{const W=this.state.allItems.length;if(W){const z=this.state.typeaheadIndex||0;let Y=I(z+K,W);this.state.allItems[Y].kind===d.I.GroupTitle&&(Y=I(Y+K,W)),this.setState({typeaheadIndex:Y});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=o.D}get menuPosition(){if(!window.getSelection)return"";const K=window.getSelection(),W=K&&K.anchorNode;if(W&&W.parentElement){const z=W.parentElement.getBoundingClientRect(),Y=window.scrollX,X=window.scrollY;return`position: absolute; display: flex; top: ${z.top+X+z.height+6}px; left: ${z.left+Y-2}px`}return""}render(){const{prefix:K,isOpen:W=!1,origin:z}=this.props,{allItems:Y,listWidth:X,listHeight:q,itemHeight:G,hoveredItem:te,typeaheadIndex:H}=this.state,se=S(this.context),ne=te||H,le=Y[te||H||0];return(0,n.jsxs)(T,{origin:z,isOpen:W,style:this.menuPosition,children:[(0,n.jsx)("ul",{role:"menu",className:se.typeahead,"data-testid":"typeahead",children:(0,n.jsx)(g.Y1,{ref:this.listRef,itemCount:Y.length,itemSize:G,itemKey:_=>{const Q=Y&&Y[_];return Q?`${_}-${Q.label}`:`${_}`},width:X,height:q,children:({index:_,style:Q})=>{const ae=Y&&Y[_];return ae?(0,n.jsx)(M,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(ae):{},isSelected:H===null?!1:Y[H]===ae,item:ae,prefix:K,style:Q,onMouseEnter:()=>this.onMouseEnter(_),onMouseLeave:this.onMouseLeave}):null}})}),ne&&(0,n.jsx)(y,{height:q,item:le})]})}}class T extends r.PureComponent{constructor(K){super(K);const{index:W=0,origin:z="query",style:Y}=K;this.node=document.createElement("div"),this.node.setAttribute("style",Y),this.node.classList.add("slate-typeahead",`slate-typeahead-${z}-${W}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),i.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const S=B=>({typeahead:(0,l.css)({maxHeight:300,overflowY:"auto",strong:{color:B.v1.palette.yellow}})});var L=e(72307),O=e(75071),j=e(84694);const N=250;function F({onTypeahead:B,cleanText:K,onWillApplySuggestion:W,portalOrigin:z}){let Y,X={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const q=(0,s.debounce)(U,N),G=te=>{X={...X,...te}};return{onBlur:(te,H,se)=>(X={...X,groupedItems:[]},se()),onClick:(te,H,se)=>(X={...X,groupedItems:[]},se()),onKeyDown:(te,H,se)=>{const le=X.groupedItems.length;switch(te.key){case"Escape":{if(le)return te.preventDefault(),X={...X,groupedItems:[]},H.insertText("");break}case"ArrowDown":case"ArrowUp":if(le){te.preventDefault(),Y.moveMenuIndex(te.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(te.shiftKey||te.ctrlKey)&&le)return te.preventDefault(),Y.insertSuggestion();break}case"Tab":{if(le)return te.preventDefault(),Y.insertSuggestion();break}default:{te.key.length===1&&q(H,G,B,K);break}}return se()},commands:{selectSuggestion:(te,H)=>{const se=X.groupedItems;if(!se||!se.length)return te;const ne=te.applyTypeahead(H);return q(te,G,B,K),ne},applyTypeahead:(te,H)=>{let se=H.insertText||H.label;const ne=H.kind==="function",le=H.move||0,_=le>0?le:0,Q=le<0?-le:0,{typeaheadPrefix:ae,typeaheadText:oe,typeaheadContext:J}=X;W&&(se=W(se,{groupedItems:X.groupedItems,typeaheadContext:J,typeaheadPrefix:ae,typeaheadText:oe}));const{forward:ee,backward:de}=w(se,ae,oe,ne,H.deleteBackwards,K);if(se.match(/\n/)){const xe=(0,L.dF)(se);return te.deleteBackward(de).deleteForward(ee).insertFragment(xe).focus(),te}return X={...X,groupedItems:[]},te.snapshotSelection().deleteBackward(de).deleteForward(ee).insertText(se).moveForward(_).moveBackward(Q).focus(),te}},renderEditor(te,H,se){if(H.value.selection.isExpanded)return se();const ne=se();return(0,n.jsxs)(n.Fragment,{children:[ne,(0,n.jsx)(R,{menuRef:le=>Y=le,origin:z,prefix:X.typeaheadPrefix,isOpen:!!X.groupedItems.length,groupedItems:X.groupedItems,onSelectSuggestion:H.selectSuggestion})]})}}}const U=async(B,K,W,z)=>{if(!W)return;const{value:Y}=B,{selection:X}=Y,q=Y.document.getClosestBlock(Y.focusBlock.key),G=Y.selection.start.offset-1,te=q&&q.getDecorations(B),H=te?te.filter(de=>de.start.offset<=G&&de.end.offset>G&&de.type===j.A).toArray():[],se=te&&te.filter(de=>de.end.offset<=G&&de.type===j.A&&de.data.get("className").includes("label-key")).last(),ne=se&&Y.focusText.text.slice(se.start.offset,se.end.offset),le=H.map(de=>de.data.get("className")).join(" ").split(" ").filter(de=>de.length);let _=Y.focusText.text,Q=_.slice(0,X.focus.offset);H.length&&(_=Y.focusText.text.slice(H[0].start.offset,H[0].end.offset),Q=Y.focusText.text.slice(H[0].start.offset,X.focus.offset));const ae=Q.match(/(?:!?=~?"?|")(.*)/);ae?Q=ae[1]:z&&(Q=z(Q));const{suggestions:oe,context:J}=await W({prefix:Q,text:_,value:Y,wrapperClasses:le,labelKey:ne||void 0,editor:B}),ee=oe.map(de=>{if(!de.items)return de;const xe=de.searchFunctionType||(de.prefixMatch?O.T.Prefix:O.T.Word),re=O.H[xe];let ue={...de};return Q&&(de.skipFilter||(ue.items=ue.items.filter(Te=>(Te.filterText||Te.label).length>=Q.length),ue.items=re(ue.items,Q)),ue.items=ue.items.filter(Te=>!(Te.insertText===Q||(Te.filterText??Te.label)===Q))),de.skipSort||(ue.items=(0,s.sortBy)(ue.items,Te=>Te.sortText===void 0?Te.sortValue!==void 0?Te.sortValue:Te.label:Te.sortText||Te.label)),ue}).filter(de=>de.items&&de.items.length);K({groupedItems:ee,typeaheadPrefix:Q,typeaheadContext:J,typeaheadText:_}),B.blur().focus()};function w(B,K,W,z,Y,X){const q=Y||K.length,G=X?X(W):W,te=W.indexOf(K),H=te>-1?G.length-te-K.length:G.length-K.length;return{forward:!!(K&&H>0||B===W)&&!z?H+te:0,backward:q}}},63211:(k,A,e)=>{"use strict";e.d(A,{k:()=>T});var n=e(74848),s=e(94659),l=e(40845);function r(S){return(0,s.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function i(S){return(0,s.css)({".alert-state-paused, .alert-state-pending":{color:S.colors.text.secondary,fontWeight:S.typography.fontWeightMedium},".alert-state-ok":{color:S.colors.success.text,fontWeight:S.typography.fontWeightMedium},".alert-state-warning":{color:S.colors.warning.text,fontWeight:S.typography.fontWeightMedium},".alert-state-critical":{color:S.colors.error.text,fontWeight:S.typography.fontWeightMedium}})}function g(S){return(0,s.css)({".panel-options-group":{borderBottom:`1px solid ${S.colors.border.weak}`},".panel-options-group__header":{padding:S.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:S.colors.text.primary,"&:hover":{background:S.colors.emphasize(S.colors.background.primary,.03)}},".panel-options-group__icon":{color:S.colors.text.secondary,marginRight:S.spacing(1),padding:S.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:S.spacing(1,2,1,4)}})}function o(S){return(0,s.css)({".card-section":{marginBottom:S.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:S.colors.background.secondary,boxShadow:"none",padding:S.spacing(2),borderRadius:"4px","&:hover":{background:S.colors.emphasize(S.colors.background.secondary,.03)},".label-tag":{marginLeft:S.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:S.spacing(2)},".card-item-type":{color:S.colors.text.secondary,textTransform:"uppercase",fontSize:S.typography.size.sm,fontWeight:S.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:S.typography.size.sm},".card-item-name":{color:S.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:S.spacing(1)},".card-item-sub-name":{color:S.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:S.colors.text.secondary,textTransform:"uppercase",marginBottom:S.spacing(2),fontSize:S.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:S.typography.size.sm,display:"inline-block",marginLeft:S.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:S.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:S.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:S.typography.h3.fontSize},[S.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[S.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[S.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:S.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:S.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:S.typography.h4.fontSize},".card-item-sub-name":{fontSize:S.typography.size.sm},".layout-selector":{marginRight:0}}})}function d(S){return(0,s.css)({"code, pre, kbd, samp":{...S.typography.code,fontSize:S.typography.bodySmall.fontSize,backgroundColor:S.colors.background.primary,color:S.colors.text.primary,border:`1px solid ${S.colors.border.medium}`,borderRadius:"4px"},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:`0 0 ${S.typography.body.lineHeight}`,lineHeight:S.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function c(S){return(0,s.css)({".delta-html":{background:S.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:S.colors.text.primary,fontFamily:S.typography.fontFamilyMonospace,fontSize:S.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:S.colors.text.secondary,display:"inline-block",fontSize:S.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:S.colors.text.primary,fontSize:S.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:S.v1.palette.gray5,".diff-line-number":{color:S.colors.text.primary}},".diff-json-new":{backgroundColor:S.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:S.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:S.colors.primary.shade},".diff-json-deleted":{backgroundColor:S.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:S.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:S.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:S.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:S.colors.action.hover,borderRadius:"3px",color:S.colors.text.primary,display:"inline",fontSize:`${S.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:S.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:S.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var a=e(16797);function p(S){const L=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,s.css)({html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",height:"100%",fontSize:`${S.typography.htmlFontSize}px`,fontFamily:S.typography.fontFamily,lineHeight:S.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:S.colors.mode},body:{height:"100%",width:"100%",position:L?"unset":"absolute",color:S.colors.text.primary,backgroundColor:S.colors.background.canvas,...S.typography.body,...L&&{overflowY:"scroll !important",paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}},"h1, .h1":u(S.typography.h1),"h2, .h2":u(S.typography.h2),"h3, .h3":u(S.typography.h3),"h4, .h4":u(S.typography.h4),"h5, .h5":u(S.typography.h5),"h6, .h6":u(S.typography.h6),p:{margin:S.spacing(0,0,2)},textarea:{overflow:"auto"},button:{letterSpacing:S.typography.body.letterSpacing,"&:focus-visible":(0,a.getFocusStyles)(S),"&:focus":{outline:"none"}},"small, .small":{fontSize:S.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:S.typography.fontWeightMedium},em:{fontStyle:"italic",color:S.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:S.spacing(0,0,0,2),margin:S.spacing(0,0,2),borderLeft:`5px solid ${S.v1.palette.gray3}`,p:{marginBottom:0,fontSize:S.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:S.typography.body.lineHeight,color:S.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:S.spacing(2),fontStyle:"normal",lineHeight:S.typography.body.lineHeight},"a.external-link":{color:S.colors.text.link,textDecoration:"normal","&:hover":{color:S.colors.text.link,textDecoration:"underline"}},".link":{color:S.colors.text.primary,cursor:"pointer"},".link:hover":{color:S.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:S.spacing(2),marginBottom:S.spacing(2),border:0,borderTop:`1px solid ${S.colors.border.medium}`},"mark, .mark":{background:S.colors.warning.main},"ul, ol":{padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:S.typography.body.lineHeight},dl:{marginBottom:S.spacing(2)},"dt, dd":{lineHeight:S.typography.body.lineHeight},dt:{fontWeight:S.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{color:"inherit",font:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{borderCollapse:"collapse",borderSpacing:0},th:{fontWeight:S.typography.fontWeightMedium},"td, th":{padding:0},".muted":{color:S.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:S.colors.text.primary},".text-warning":{color:S.colors.warning.text,"&:hover, &:focus":{color:S.colors.emphasize(S.colors.warning.text,.15)}},".text-error":{color:S.colors.error.text,"&:hover, &:focus":{color:S.colors.emphasize(S.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:S.colors.emphasize(S.colors.success.text,.15)}},a:{cursor:"pointer",color:S.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,a.getFocusStyles)(S),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:S.components.textHighlight.background,color:S.components.textHighlight.text,padding:0},".template-variable":{color:S.colors.primary.text}})}function u(S){return{margin:0,fontSize:S.fontSize,lineHeight:S.lineHeight,fontWeight:S.fontWeight,letterSpacing:S.letterSpacing,fontFamily:S.fontFamily,marginBottom:"0.45em"}}function m(S){return(0,s.css)({"iframe.intercom-borderless-frame":{colorScheme:S.colors.mode}})}function v(S){return(0,s.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-child(odd)":{background:S.colors.emphasize(S.colors.background.primary,.02)}},th:{width:"auto",padding:S.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:S.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:S.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:S.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:"50%"},"&--hover":{"tbody tr:hover":{background:S.colors.emphasize(S.colors.background.primary,.05)}}}})}function x(S){const L=typeof window<"u"&&window.__grafana_public_path__,O=L?`${L}fonts/`:"public/fonts/";return(0,s.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${O}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${O}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${O}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${O}inter/Inter-Medium.woff2') format('woff2')`}}])}function f(S){return(0,s.css)({"input, button, select, textarea":{fontFamily:S.typography.body.fontFamily,fontSize:S.typography.body.fontSize,fontWeight:S.typography.body.fontWeight,lineHeight:S.typography.body.lineHeight},"input, select":{backgroundColor:S.components.input.background,color:S.components.input.text,border:"none",boxShadow:"none"},textarea:{height:"auto"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"}})}function E(S){return(0,s.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:S.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:S.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:S.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:S.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:S.isDark?S.colors.primary.text:S.colors.primary.main},".json-formatter-boolean":{color:S.isDark?S.colors.primary.text:S.colors.error.main},".json-formatter-null":{color:S.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:S.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:S.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:S.isDark?"#027bff":S.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:S.isDark?"#9494ff":S.colors.primary.main},".json-formatter-key":{color:S.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:S.spacing(.25),marginRight:S.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:S.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:S.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:S.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function h(S){return(0,s.css)({".gf-form-select-box__control":{width:"100%",marginRight:S.spacing(.5),backgroundColor:S.components.input.background,border:`1px solid ${S.components.input.borderColor}`,borderRadius:S.shape.radius.default,color:S.components.input.text,cursor:"default",height:S.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:S.components.input.background,borderColor:S.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${S.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:S.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:S.colors.background.primary,boxShadow:S.shadows.z3,position:"absolute",zIndex:S.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:S.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:S.components.input.background,"&.gf-form-select-box__option--is-focused":{color:S.colors.text.primary,background:S.colors.action.hover,borderImage:S.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:S.colors.text.primary}}},".gf-form-select-box__placeholder":{color:S.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:S.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:S.typography.bodySmall.fontSize,color:S.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${S.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function y(S){return(0,s.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:S.spacing(3),marginBottom:S.spacing(2)},table:{marginBottom:S.spacing(2),"td, th":{padding:S.spacing(.5,1)},th:{fontWeight:S.typography.fontWeightMedium,background:S.colors.background.secondary}},"table, th, td":{border:`1px solid ${S.colors.border.medium}`,borderCollapse:"collapse"},a:{color:S.colors.text.link,textDecoration:"none","&:hover":{color:S.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function b(S){const L=S.breakpoints.values.xxl+S.spacing.gridSize*2+S.components.sidemenu.width,O=window.grafanaBootData?.settings.featureToggles.bodyScrolling;return(0,s.css)({".grafana-app":O?{display:"flex",flexDirection:"column",height:"100vh"}:{display:"flex",alignItems:"stretch",position:"absolute",width:"100%",height:"100%",top:0,left:0},".main-view":O?{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0}:{position:"relative",display:"flex",flexDirection:"column",flexGrow:1,height:"100%",flex:"1 1 0",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:S.spacing(2),paddingRight:S.spacing(2),[S.breakpoints.up("sm")]:{margin:S.spacing(0,1)},[S.breakpoints.up("md")]:{margin:S.spacing(0,2)},[`@media (min-width: ${L}px)`]:{maxWidth:`${S.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:S.spacing(2),paddingLeft:S.spacing(2),paddingRight:S.spacing(2)},".page-body":{padding:S.spacing(1),background:S.components.panel.background,border:`1px solid ${S.components.panel.borderColor}`,marginBottom:"32px",[S.breakpoints.up("md")]:{padding:S.spacing(2)},[S.breakpoints.up("lg")]:{padding:S.spacing(3)}},".page-heading":{fontSize:S.typography.h4.fontSize,marginTop:0,marginBottom:S.spacing(2)},".page-action-bar":{marginBottom:S.spacing(2),display:"flex",alignItems:"flex-start",gap:S.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:S.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:S.spacing(2)},".page-sub-heading-icon":{marginLeft:S.spacing(1),marginTop:S.spacing(.5)},".page-hidden":{display:"none"}})}function D(S){return(0,s.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:S.colors.text.secondary}}},".query-keyword":{fontWeight:S.typography.fontWeightMedium,color:`${S.colors.primary.text} !important`},".query-part":{backgroundColor:S.colors.background.secondary,"&:hover":{background:S.colors.emphasize(S.colors.background.secondary,.03)}},".query-segment-operator":{color:`${S.v1.palette.orange} !important`},".tight-form-func":{background:S.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:S.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}function P(S){return(0,s.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:S.components.input.background,color:S.colors.text.secondary,borderColor:S.components.input.borderColor,fontSize:S.typography.body.fontSize},".rc-time-picker-input":{padding:S.spacing(0,1),height:S.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:S.colors.background.secondary},"li:hover":{backgroundColor:S.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var C=e(72129);const M=S=>(0,s.css)({".react-loading-skeleton":C.Q});function I(S){return(0,s.css)({".slate-query-field":{fontSize:S.typography.fontSize,fontFamily:S.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:S.colors.text.primary,backgroundColor:S.components.input.background,backgroundImage:"none",border:`1px solid ${S.components.input.borderColor}`,borderRadius:S.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:S.zIndex.typeahead,borderRadius:S.shape.radius.default,border:`1px solid ${S.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:S.components.panel.background,color:S.colors.text.primary,boxShadow:S.shadows.z2},".typeahead-group__title":{color:S.colors.text.secondary,fontSize:S.typography.size.sm,lineHeight:S.typography.body.lineHeight,padding:S.spacing(1)},".typeahead-item":{height:"auto",fontFamily:S.typography.fontFamilyMonospace,padding:S.spacing(1,1,1,2),fontSize:S.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:S.isDark?S.v1.palette.dark9:S.v1.palette.gray6,".typeahead-item-hint":{fontSize:S.typography.size.xs,color:S.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:S.v1.palette.yellow,borderBottom:`1px solid ${S.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:S.colors.text.secondary},".token.variable, .token.entity":{color:S.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:S.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:S.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:S.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:S.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function R(S){return(0,s.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function T(){const S=(0,l.$j)();return(0,n.jsx)(s.Global,{styles:[r(S),g(S),i(S),d(S),c(S),p(S),m(S),v(S),x(S),f(S),E(S),o(S),y(S),b(S),D(S),P(S),M(S),I(S),R(S),h(S)]})}},40845:(k,A,e)=>{"use strict";e.d(A,{$j:()=>v,DP:()=>m,IS:()=>x,SL:()=>p,cV:()=>u,fq:()=>E,of:()=>f});var n=e(74848),s=e(4146),l=e.n(s),r=e(47078),i=e.n(r),g=e(96540),o=e(60578),d=e(3911);let c=null;const a=new WeakMap,p=h=>{const y=b=>{const D=c||o.D;return(0,n.jsx)(D.Consumer,{children:P=>(0,n.jsx)(h,{...b,theme:P.v1})})};return y.displayName=`WithTheme(${h.displayName})`,l()(y,h),y},u=h=>{const y=b=>{const D=c||o.D;return(0,n.jsx)(D.Consumer,{children:P=>(0,n.jsx)(h,{...b,theme:P})})};return y.displayName=`WithTheme(${h.displayName})`,l()(y,h),y};function m(){return(0,g.useContext)(c||o.D).v1}function v(){return(0,g.useContext)(c||o.D)}function x(h){const y=m();let b=a.get(h);return b||(b=(0,d.N)(h),a.set(h,b)),b(y)}function f(h,...y){const b=v();let D=a.get(h);return D||(D=i()(h,{maxSize:10}),a.set(h,D)),D(b,...y)}const E=h=>(c=g.createContext(h),()=>{c=null})},7918:(k,A,e)=>{"use strict";e.d(A,{kH:()=>d.k,Dx:()=>n.D,O4:()=>i,mG:()=>g,fq:()=>s.fq,YF:()=>c,N3:()=>o.N,IS:()=>s.IS,of:()=>s.of,DP:()=>s.DP,$j:()=>s.$j,SL:()=>s.SL,cV:()=>s.cV});var n=e(60578),s=e(40845),l=e(75972);let r;const i=(a="dark")=>r?r(a):(0,l.a)({colors:{mode:a}}).v1,g=a=>(r=a,()=>{r=null});var o=e(3911),d=e(63211),c=e(16797)},16797:(k,A,e)=>{"use strict";e.r(A),e.d(A,{cardChrome:()=>s,focusCss:()=>d,getFocusStyles:()=>a,getMouseFocusStyles:()=>c,getTooltipContainerStyles:()=>p,hoverColor:()=>l,listItem:()=>r,listItemSelected:()=>i,mediaUp:()=>g});var n=e(84140);function s(u){return`
    background: ${u.colors.background.secondary};
    &:hover {
      background: ${l(u.colors.background.secondary,u)};
    }
    box-shadow: ${u.components.panel.boxShadow};
    border-radius: ${u.shape.radius.default};
`}function l(u,m){return m.isDark?(0,n.A)(u).brighten(2).toString():(0,n.A)(u).darken(2).toString()}function r(u){return`
  background: ${u.colors.background.secondary};
  &:hover {
    background: ${l(u.colors.background.secondary,u)};
  }
  box-shadow: ${u.components.panel.boxShadow};
  border-radius: ${u.shape.radius.default};
`}function i(u){return`
    background: ${l(u.colors.background.secondary,u)};
    color: ${u.colors.text.maxContrast};
`}function g(u){return`only screen and (min-width: ${u})`}const o=u=>u.hasOwnProperty("v1"),d=u=>{const m=o(u),v=m?u.colors.background.canvas:u.colors.bodyBg,x=m?u.colors.primary.main:u.colors.formFocusOutline;return`
  outline: 2px dotted transparent;
  outline-offset: 2px;
  box-shadow: 0 0 0 2px ${v}, 0 0 0px 4px ${x};
  transition-property: outline, outline-offset, box-shadow;
  transition-duration: 0.2s;
  transition-timing-function: cubic-bezier(0.19, 1, 0.22, 1);`};function c(u){return{outline:"none",boxShadow:"none"}}function a(u){return{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${u.colors.background.canvas}, 0 0 0px 4px ${u.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow"}}const p=u=>({overflow:"hidden",background:u.colors.background.secondary,boxShadow:u.shadows.z2,maxWidth:"800px",padding:u.spacing(1),borderRadius:u.shape.radius.default,zIndex:u.zIndex.tooltip})},3911:(k,A,e)=>{"use strict";e.d(A,{N:()=>l});var n=e(47078),s=e.n(n);function l(r){return s()(r)}},50774:(k,A,e)=>{"use strict";e.d(A,{I:()=>n});var n=(s=>(s.GroupTitle="GroupTitle",s))(n||{})},29621:()=>{"use strict"},4025:(k,A,e)=>{"use strict";e.d(A,{GO:()=>r,SS:()=>i,Uo:()=>n.Uo,lV:()=>g,rJ:()=>l});var n=e(8887),s=e(11261);const l=o=>["xs","sm","md","lg","xl","xxl","xxxl"].includes(o),r=()=>Object.keys(n.az);function i(o){return g(o?.type)}function g(o){if(o)switch(o){case s.PU.time:return"clock-nine";case s.PU.string:return"font";case s.PU.number:return"calculator-alt";case s.PU.boolean:return"toggle-on";case s.PU.trace:return"info-circle";case s.PU.enum:return"list-ol";case s.PU.geo:return"map-marker";case s.PU.other:return"brackets-curly"}return"question-circle"}},80186:(k,A,e)=>{"use strict";e.r(A),e.d(A,{CompletionItemKind:()=>i.I,getAvailableIcons:()=>d.GO,getFieldTypeIcon:()=>d.SS,getFieldTypeIconName:()=>d.lV,isIconSize:()=>d.rJ,toIconName:()=>d.Uo});var n=e(64611),s=e.n(n),x={};for(const f in n)f!=="default"&&(x[f]=()=>n[f]);e.d(A,x);var l=e(11866),r=e.n(l),x={};for(const f in l)f!=="default"&&(x[f]=()=>l[f]);e.d(A,x);var i=e(50774),g=e(29621),o=e.n(g),x={};for(const f in g)["default","CompletionItemKind"].indexOf(f)<0&&(x[f]=()=>g[f]);e.d(A,x);var d=e(4025),c=e(19932),a=e.n(c),x={};for(const f in c)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(x[f]=()=>c[f]);e.d(A,x);var p=e(72389),u=e.n(p),x={};for(const f in p)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(x[f]=()=>p[f]);e.d(A,x);var m=e(65484),v=e.n(m),x={};for(const f in m)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(x[f]=()=>m[f]);e.d(A,x)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(k,A,e)=>{"use strict";e.d(A,{Q:()=>n});const n=(s,l)=>{s.key==="Tab"||s.altKey||s.ctrlKey||s.metaKey||(s.stopPropagation(),s.key==="Escape"&&l())}},24284:(k,A,e)=>{"use strict";e.d(A,{Ih:()=>E,Mk:()=>i,Tj:()=>p,UJ:()=>a,Xw:()=>g,ct:()=>c,mZ:()=>f,nO:()=>d,sg:()=>x,xj:()=>o});var n=e(2543),s=e.n(n),l=e(84140);const r=4,i="rgba(0, 211, 255, 1)",g="rgba(11, 237, 50, 1)",o="rgba(237, 46, 24, 1)",d="rgba(150, 150, 150, 1)",c="rgba(247, 149, 32, 1)",a=.09,p=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function u(h){const y=(0,n.map)(h,m),b=(0,n.sortBy)(y,["h"]),D=(0,n.chunk)(b,r),P=(0,n.map)(D,M=>(0,n.sortBy)(M,"l")),C=(0,n.flattenDeep)((0,n.zip)(...P));return(0,n.map)(C,v)}function m(h){return(0,l.A)(h).toHsl()}function v(h){return(0,l.A)(h).toHexString()}function x(h){return(0,l.A)(h).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function f(h,y){const b=(0,l.A)(h),D=b.getBrightness();return b.getAlpha()<.3?y?"rgb(247, 248, 250)":"rgb(32, 34, 38)":D>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let E=u(p)},14555:(k,A,e)=>{"use strict";e.d(A,{F:()=>s,J:()=>n});const n=l=>l().map(r=>({label:r.title,ariaLabel:r.title,url:r.href,target:r.target,icon:`${r.target==="_blank"?"external-link-alt":"link"}`,onClick:r.onClick})),s=l=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(l)},40621:(k,A,e)=>{"use strict";e.d(A,{h:()=>n});function n(s,l,r){}},53550:(k,A,e)=>{"use strict";e.d(A,{i:()=>n});function n(s){const r=s.lastIndexOf("."),i=s.substring(r),g=s.substring(0,r);return g.length<16?s:`${g.substring(0,16)}...${i}`}},9830:(k,A,e)=>{"use strict";e.d(A,{I:()=>l});var n=e(2543),s=e.n(n);function l(r,i){let g=0,o=r.indexOf(i);i=i.replace(/\s/g,"");const d=[];if(o!==-1)return{distance:0,found:!0,ranges:[{start:o,end:o+i.length-1}]};for(const c of i){const a=r.indexOf(c,o);if(a===-1)return{distance:1/0,ranges:[],found:!1};if(o!==-1&&(g+=a-o),o=a+1,d.length===0)d.push({start:a,end:a});else{const p=(0,n.last)(d);a===p.end+1?p.end++:d.push({start:a,end:a})}}return{distance:g,ranges:d,found:!0}}},76412:(k,A,e)=>{"use strict";e.d(A,{t:()=>o,x:()=>i});var n=e(74848),s=e(72635),l=e(32389);function r(){typeof s.default.options.resources!="object"&&s.default.use(l.r9).init({resources:{},returnEmptyString:!1,lng:"en-US"})}const i=d=>(r(),(0,n.jsx)(l.x6,{...d})),g=s.default.t,o=(d,c,a)=>(r(),g(d,c,a))},67985:(k,A,e)=>{"use strict";e.d(A,{xj:()=>i.xj,Mk:()=>i.Mk,bk:()=>n,Pw:()=>g.Pw,nO:()=>i.nO,uc:()=>y,Xw:()=>i.Xw,ct:()=>i.ct,UJ:()=>i.UJ,zt:()=>r,yx:()=>o.yx,Tt:()=>x.T,DB:()=>f.DB,hF:()=>h.h,Vr:()=>m.Vr,Tj:()=>i.Tj,h:()=>E.h,It:()=>b.I,Yc:()=>m.Yc,kl:()=>u.k,XJ:()=>p,yC:()=>c.yC,JF:()=>c.JF,MC:()=>c.MC,mZ:()=>i.mZ,sg:()=>i.sg,K:()=>g.K,Fr:()=>d.F,Jl:()=>d.J,dF:()=>o.dF,mO:()=>o.mO,kD:()=>m.kD,RP:()=>g.RP,Ih:()=>i.Ih,CH:()=>v.C,tf:()=>g.tf});var n={};e.r(n),e.d(n,{getNextCharacter:()=>l,getPreviousCousin:()=>s}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(D){const P=(this.document||this.ownerDocument).querySelectorAll(D);let C=this,M;do{for(M=P.length;--M>=0&&P.item(M)!==C;);C=C.parentElement}while(M<0&&C);return C});function s(D,P){let C=D.parentElement.previousSibling,M;for(;C;){if(M=C.querySelector(P),M)return M;C=C.previousSibling}}function l(D){const P=(D||window).getSelection();if(!P||!P.anchorNode)return null;const C=P.getRangeAt(0),M=P.anchorNode.textContent,I=C.startOffset;return M.slice(I,I+1)}var r=e(67892),i=e(24284),g=e(29734),o=e(72307),d=e(14555),c=e(69613);let a=null;function p(){if(a!==null)return a;if(typeof document<"u"){const D=document.createElement("div"),P={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(P).map(C=>{D.style[C]=P[C]}),document.body.appendChild(D),a=D.offsetWidth-D.clientWidth,document.body.removeChild(D)}else a=0;return a||0}var u=e(90914),m=e(29413),v=e(69731),x=e(75071),f=e(88838),E=e(91040),h=e(40621),y=(D=>(D.id="id",D.title="title",D.subTitle="subTitle",D.mainStat="mainStat",D.secondaryStat="secondaryStat",D.source="source",D.target="target",D.detail="detail__",D.arc="arc__",D.color="color",D))(y||{}),b=e(9830)},87019:(k,A,e)=>{"use strict";e.d(A,{t:()=>s});var n=e(32196);const s=(0,n.keyframes)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(359deg)"}})},91040:(k,A,e)=>{"use strict";e.d(A,{h:()=>r});var n=e(2543),s=e.n(n);const l=(0,n.throttle)((...i)=>{console.log(...i)},500),r=i=>{let g=!1;return typeof window<"u"&&(g=window.localStorage.getItem("grafana.debug")==="true"),{logger:(o,d=!1,...c)=>{},enable:()=>g=!0,disable:()=>g=!1,isEnabled:()=>g}}},29413:(k,A,e)=>{"use strict";e.d(A,{Vr:()=>o,Yc:()=>i,kD:()=>g});let n;const s=new Map,l=500;let r="";function i(){return n||(n=document.createElement("canvas").getContext("2d")),n}function g(d,c,a=400){const p=`${a} ${c}px 'Inter'`,u=d+p,m=s.get(u);if(m)return m;const v=i();r!==p&&(v.font=r=p);const x=v.measureText(d);return s.size===l&&s.clear(),s.set(u,x),x}function o(d,c,a,p,u,m){const v=g(d,14,m),x=c/(v.width+2)*14,f=a/p,E=Math.min(f,x);return Math.min(E,u??E)}},67892:(k,A,e)=>{"use strict";e.r(A),e.d(A,{getChildId:()=>s,renderOrCallToRender:()=>l});var n=e(96540);function s(r){let i;const g=n.Children.only(r);return"id"in g?.props?i=g.props.id:"inputId"in g.props&&(i=g?.props.inputId),typeof i=="string"?i:void 0}function l(r,i){if(n.isValidElement(r)||typeof r=="string"||typeof r=="number")return r;if(typeof r=="function"&&i)return r(i);throw new Error(`${r} is not a React element nor a function that returns React element`)}},75071:(k,A,e)=>{"use strict";e.d(A,{H:()=>g,T:()=>s});var n=e(9830),s=(o=>(o.Word="Word",o.Prefix="Prefix",o.Fuzzy="Fuzzy",o))(s||{});const g={Word:(o,d)=>o.filter(c=>(c.filterText||c.label).includes(d)),Prefix:(o,d)=>o.filter(c=>(c.filterText||c.label).startsWith(d)),Fuzzy:(o,d)=>(d=d.toLowerCase(),o.filter(c=>{const{distance:a,ranges:p,found:u}=(0,n.I)(c.label.toLowerCase(),d);return u?(c.sortValue=a,c.highlightParts=p,!0):!1}))}},72129:(k,A,e)=>{"use strict";e.d(A,{Q:()=>r,j:()=>i});var n=e(74848),s=e(32196);const r={animationName:(0,s.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},i=(g,o)=>Object.assign(g,{Skeleton:c=>(0,n.jsx)(o,{...c,rootProps:{style:r}})})},72307:(k,A,e)=>{"use strict";e.d(A,{dF:()=>l,mO:()=>r,yx:()=>s});var n=e(82611);const s={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},l=(i,g)=>{const o=i.split(`
`).map(c=>n.eB.create({type:"code_line",nodes:[n.EY.create(c)]})),d=n.eB.create({data:{syntax:g},type:"code_block",nodes:o});return n.yo.create({nodes:[d]})},r=(i,g)=>{const o=l(i,g);return n.WT.create({document:o})}},90914:(k,A,e)=>{"use strict";e.d(A,{k:()=>n});const n=(s,l)=>{let r;if(s.getLinks&&(r=s.getLinks({valueRowIndex:l.index})),!!r){for(let i=0;i<r?.length;i++)if(r[i].onClick){const g=r[i].onClick;r[i].onClick=o=>{o.ctrlKey||o.metaKey||o.shiftKey||(o.preventDefault(),g(o,{field:s,rowIndex:l.index}))}}return r}}},69613:(k,A,e)=>{"use strict";e.d(A,{JF:()=>l,MC:()=>r,yC:()=>i});const n=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],s=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function l(d=""){const c=g(d.toLowerCase());return Math.abs(c%n.length)}function r(d=""){const c=l(d);return i(c)}function i(d){return{color:n[d],borderColor:s[d]}}function g(d){let c=5381;for(let a=0;a<d.length;a++)c=(c<<5)+c+d.charCodeAt(a);return c}var o={getTagColorsFromName:r}},18976:(k,A,e)=>{"use strict";e.d(A,{O:()=>s,f:()=>l});var n=e(32196);function s(r){switch(r){case"auto":return"bottom";case"auto-start":return"bottom-start";case"auto-end":return"bottom-end";default:return r??"bottom"}}function l(r,i,g,o,d){return{arrow:(0,n.css)({fill:i}),container:(0,n.css)({backgroundColor:i,borderRadius:r.shape.radius.default,border:`1px solid ${g}`,boxShadow:r.shadows.z2,color:o,fontSize:r.typography.bodySmall.fontSize,padding:r.spacing(d.topBottom,d.rightLeft),[r.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.3s"},zIndex:r.zIndex.tooltip,maxWidth:"400px",overflowWrap:"break-word","&[data-popper-interactive='false']":{pointerEvents:"none"}}),headerClose:(0,n.css)({color:r.colors.text.secondary,position:"absolute",right:r.spacing(1),top:r.spacing(1.5),backgroundColor:"transparent",border:0}),header:(0,n.css)({paddingTop:r.spacing(1),paddingBottom:r.spacing(2)}),body:(0,n.css)({paddingTop:r.spacing(1),paddingBottom:r.spacing(1)}),footer:(0,n.css)({paddingTop:r.spacing(2),paddingBottom:r.spacing(1)})}}},69731:(k,A,e)=>{"use strict";e.d(A,{C:()=>s});var n=e(96540);function s(){const[l,r]=(0,n.useState)(0);return(0,n.useCallback)(()=>r(i=>i+1),[])}},29734:(k,A,e)=>{"use strict";e.d(A,{K:()=>l,Pw:()=>n,RP:()=>r,tf:()=>s});var n=(i=>(i.onBlur="onBlur",i.onFocus="onFocus",i.onChange="onChange",i))(n||{});const s=(i,g)=>{const o=g.reduce((d,c)=>c.rule(i)?d:d.concat(c.errorMessage),[]);return o.length>0?o:null},l=(i,g)=>g&&g[i],r=(i,g)=>({rule:o=>!!o.match(i),errorMessage:g||"Value is not valid"})},96712:(k,A,e)=>{"use strict";e.d(A,{Nz:()=>Hi,J3:()=>Mi,Pl:()=>_i});var n=e(74848),s=e(1503),l=e(96540),r=e(71468),i=e(24180),g=e(24160),o=e(39601),d=e(14110),c=e(32264),a=e(66602),p=e(63211),u=e(67061),m=e(71678),v=e(17464),x=e(99758),f=e(99140);const E=(0,l.forwardRef)((ft,hn)=>(0,n.jsx)("div",{id:"ngRoot",ref:hn,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));E.displayName="AngularRoot";var h=e(95344),y=e(7376),b=e(81634),D=e(17172),P=e(19347),C=e(72574),M=e(10096),I=e(14792),R=e(74856),T=e(71500),S=e(6923);async function L(){if(c.$.angularSupportEnabled){const{AngularApp:ft}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),hn=new ft;hn.init(),hn.bootstrap()}else(0,y.w)({load:(ft,hn,dn)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,b.j)({get:ft=>{switch(ft){case"backendSrv":return(0,h.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,D.AI)();case"contextSrv":return(0,h.l)("getLegacyAngularInjector","contextSrv"),M.contextSrv;case"dashboardSrv":return(0,h.l)("getLegacyAngularInjector","getDashboardSrv"),(0,I.UA)();case"datasourceSrv":return(0,h.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,P.l)();case"linkSrv":return(0,h.l)("getLegacyAngularInjector","linkSrv"),(0,S.mQ)();case"validationSrv":return(0,h.l)("getLegacyAngularInjector","validationSrv"),T.P;case"timeSrv":return(0,h.l)("getLegacyAngularInjector","timeSrv"),(0,R.jG)();case"templateSrv":return(0,h.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,C.w)()}throw"Angular is disabled.  Unable to expose: "+ft}})}var O=e(32196),j=e(46942),N=e.n(j),F=e(40845),U=e(55852),w=e(76888),B=e(60619),K=e(33390),W=e(18828),z=e(85690),Y=e(93225),X=e(14578),q=e(57514),G=e(69529),te=e(8484),H=e(65178),se=e(35822);const ne=0,le=ft=>{const hn=l.useRef(null),dn=l.useRef(null),_n=l.useRef(ft.items);_n.current=ft.items;const ss=(0,se.useVirtual)({size:_n.current.length,parentRef:dn}),{query:Yn,search:Bs,currentRootActionId:Ns,activeIndex:Ps,options:za}=(0,s.useKBar)(da=>({search:da.searchQuery,currentRootActionId:da.currentRootActionId,activeIndex:da.activeIndex}));l.useEffect(()=>{const da=ta=>{ta.key==="ArrowUp"||ta.ctrlKey&&ta.key==="p"?(ta.preventDefault(),Yn.setActiveIndex(Ba=>{let Ea=Ba>ne?Ba-1:Ba;if(typeof _n.current[Ea]=="string"){if(Ea===0)return Ba;Ea-=1}return Ea})):ta.key==="ArrowDown"||ta.ctrlKey&&ta.key==="n"?(ta.preventDefault(),Yn.setActiveIndex(Ba=>{let Ea=Ba<_n.current.length-1?Ba+1:Ba;if(typeof _n.current[Ea]=="string"){if(Ea===_n.current.length-1)return Ba;Ea+=1}return Ea})):ta.key==="Enter"&&(ta.preventDefault(),hn.current?.click())};return window.addEventListener("keydown",da),()=>window.removeEventListener("keydown",da)},[Yn]);const{scrollToIndex:Pa}=ss;l.useEffect(()=>{Pa(Ps,{align:Ps<=1?"end":"auto"})},[Ps,Pa]),l.useEffect(()=>{Yn.setActiveIndex(typeof ft.items[ne]=="string"?ne+1:ne)},[Bs,Ns,ft.items,Yn]);const fa=l.useCallback((da,ta)=>{if(typeof ta=="string")return;const Ba=ta.url;ta.command?(ta.command.perform(ta),Yn.toggle()):Ba?da.ctrlKey||da.metaKey||da.shiftKey||Yn.toggle():(Yn.setSearch(""),Yn.setCurrentRootAction(ta.id)),za.callbacks?.onSelectAction?.(ta)},[Yn,za]),_a=(0,H.usePointerMovedSinceMount)();return(0,n.jsx)("div",{ref:dn,style:{maxHeight:ft.maxHeight||400,position:"relative",overflow:"auto"},children:(0,n.jsx)("div",{role:"listbox",id:s.KBAR_LISTBOX,style:{height:`${ss.totalSize}px`,width:"100%"},children:ss.virtualItems.map(da=>{const ta=_n.current[da.index],{target:Ba,url:Ea}=ta,or=typeof ta!="string"&&{onPointerMove:()=>_a&&Ps!==da.index&&Yn.setActiveIndex(da.index),onPointerDown:()=>Yn.setActiveIndex(da.index),onClick:ro=>fa(ro,ta)},co=da.index===Ps,Mo={id:(0,s.getListboxItemId)(da.index),role:"option","aria-selected":co,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${da.start}px)`},...or},No=l.cloneElement(ft.onRender({item:ta,active:co}),{ref:da.measureRef});return Ea?(0,n.jsx)("a",{href:typeof Ea=="function"?Ea(Bs):Ea,target:Ba,ref:co?hn:null,...Mo,children:No},da.index):(0,n.jsx)("div",{ref:co?hn:null,...Mo,children:No},da.index)})})})},_=l.forwardRef(({action:ft,active:hn,currentRootActionId:dn},_n)=>{const ss=l.useMemo(()=>{if(!dn)return ft.ancestors;const Ps=ft.ancestors.findIndex(za=>za.id===dn);return ft.ancestors.slice(Ps+1)},[ft.ancestors,dn]),Yn=(0,F.of)(Q);let Bs=ft.name;const Ns=Ps=>!!(Ps.command?.perform||Ps.url);return ft.children.length&&!Ns(ft)&&!Bs.endsWith("...")&&(Bs+="..."),(0,n.jsx)("div",{ref:_n,className:(0,O.cx)(Yn.row,hn&&Yn.activeRow),children:(0,n.jsxs)("div",{className:Yn.actionContainer,children:[ft.icon,(0,n.jsxs)("div",{className:Yn.textContainer,children:[ss.map(Ps=>(0,n.jsx)(l.Fragment,{children:!Ns(Ps)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:Yn.breadcrumbAncestor,children:Ps.name}),(0,n.jsx)("span",{className:Yn.breadcrumbSeparator,children:"\u203A"})]})},Ps.id)),(0,n.jsx)("span",{children:Bs})]}),ft.subtitle&&(0,n.jsx)("span",{className:Yn.subtitleText,children:ft.subtitle})]})})});_.displayName="ResultItem";const Q=ft=>({row:(0,O.css)({padding:ft.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:ft.shape.radius.default,margin:ft.spacing(0,1)}),activeRow:(0,O.css)({color:ft.colors.text.maxContrast,background:ft.colors.emphasize(ft.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:ft.spacing(.5),borderRadius:ft.shape.radius.default,backgroundImage:ft.colors.gradients.brandVertical}}),actionContainer:(0,O.css)({display:"flex",gap:ft.spacing(1),alignItems:"baseline",fontSize:ft.typography.fontSize,width:"100%"}),textContainer:(0,O.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,O.css)({color:ft.colors.text.secondary}),breadcrumbSeparator:(0,O.css)({color:ft.colors.text.secondary,marginLeft:ft.spacing(1),marginRight:ft.spacing(1)}),subtitleText:(0,O.css)({...ft.typography.bodySmall,color:ft.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var ae=e(76459),oe=e.n(ae),J=e(16233),ee=e(62301),de=e(24439);const xe=6,re=5,ue=4,Te=3,ge=2,Oe=1,Ue=100,Xe=5,we=oe()(We,200);async function qe(){if(!J.TP.user.isSignedIn)return[];const ft=(await ee.A.getDashboardOpened()).slice(0,Xe),dn=(await(0,de.getGrafanaSearcher)().search({kind:["dashboard"],limit:Xe,uid:ft})).view.toArray();return dn.sort((ss,Yn)=>{const Bs=ft.indexOf(ss.uid),Ns=ft.indexOf(Yn.uid);return Bs-Ns}),dn.map(ss=>{const{url:Yn,name:Bs}=ss;return{id:`recent-dashboards${Yn}`,name:`${Bs}`,section:(0,te.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:xe,url:Yn}})}async function We(ft){if(ft.length===0||!J.TP.user.isSignedIn&&!c.$.bootData.settings.anonymousEnabled)return[];const hn=await(0,de.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:ft,limit:Ue});return hn.view.map(_n=>{const{url:ss,name:Yn,kind:Bs,location:Ns}=_n;return{id:`go/${Bs}${ss}`,name:`${Yn}`,section:Bs==="dashboard"?(0,te.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,te.t)("command-palette.section.folder-search-results","Folders"),priority:Oe,url:ss,subtitle:hn.view.dataFrame.meta?.custom?.locationInfo[Ns]?.name}})}function Ce(ft,hn){const[dn,_n]=(0,l.useState)([]),[ss,Yn]=(0,l.useState)(!1),Bs=(0,l.useRef)(0);return(0,l.useEffect)(()=>{const Ns=Date.now();hn&&ft.length>0?(Yn(!0),we(ft).then(Ps=>{Ns>Bs.current&&(_n(Ps),Yn(!1),Bs.current=Ns)})):(_n([]),Yn(!1),Bs.current=Ns)},[hn,ft]),{searchResults:dn,isFetchingSearchResults:ss}}var je=e(31678),Ke=e(28215),_e=e(28444),Fe=e(28138),at=e(38645),Ct=e(93522);const Dt=ft=>{let hn=ft.children||[];if(ft.id==="help"){const dn=()=>{Fe.A.publish(new _e.S8({component:Ct.N}))};ft.children=[...hn,...(0,at.Dd)(),...Se(),{id:"keyboard-shortcuts",text:(0,te.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:dn}]}return ft},tt=(ft,hn)=>{const dn={...ft},_n=dn.onClick;return dn.onClick=()=>{(0,d.rR)("grafana_navigation_item_clicked",{path:dn.url??dn.id,menuIsDocked:hn,itemIsBookmarked:!!(c.$.featureToggles.pinNavItems&&dn?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!c.$.featureToggles.pinNavItems}),_n?.()},dn.children&&(dn.children=dn.children.map(ss=>tt(ss,hn))),dn},ze=(ft,hn)=>!!ft.children?.some(dn=>dn===hn?!0:ze(dn,hn)),pe=(ft,hn,dn)=>{const{id:_n,parentItem:ss}=hn;if(dn==="/")return ft.find(Yn=>Yn.id===Ke.Id);if(hn.id!=="profile"){for(const Yn of ft){const Bs=!!(Yn.id&&Yn.id===_n),Ns=Yn.text===hn.text&&Yn.url===hn.url;if(Bs||Ns)return Yn;if(Yn.children){const Ps=pe(Yn.children,hn);if(Ps)return Ps}}if(ss)return pe(ft,ss)}};function Se(){const{buildInfo:ft,licenseInfo:hn}=c.$,dn=hn.stateInfo?` (${hn.stateInfo})`:"",_n=[];return _n.push({target:"_blank",id:"version",text:`${ft.edition}${dn}`,url:hn.licenseUrl,icon:"external-link-alt"}),ft.hasUpdate&&_n.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),_n}var fe=e(2769);function Ee(ft){return"navModel."+ft.id}function Pe(ft,hn=[]){const dn=[];for(let _n of ft){_n.id==="help"&&(_n=Dt({..._n}),delete _n.url);const{url:ss,target:Yn,text:Bs,isCreateAction:Ns,children:Ps,onClick:za,keywords:Pa}=_n,fa=!!Ps?.length;if(!(ss||za||fa))continue;let _a=ss;ss&&(_n.id==="connections-add-new-connection"||_n.id==="standalone-plugin-page-/connections/add-new-connection")&&(_a=or=>{const co=Pa?.find(Mo=>Mo.toLowerCase().includes(or.toLowerCase()));return co?`${ss}?search=${co}`:ss});const da=Ns?(0,te.t)("command-palette.section.actions","Actions"):(0,te.t)("command-palette.section.pages","Pages"),ta=Ns?re:ue,Ba=hn.map(or=>or.text).join(" > "),Ea={id:Ee(_n),name:Bs,section:da,url:_a,target:Yn,parent:hn.length>0&&!Ns?Ee(hn[hn.length-1]):void 0,perform:za,keywords:Pa?.join(" "),priority:ta,subtitle:Ns?void 0:Ba};if(dn.push(Ea),Ps?.length){const or=Pe(Ps,[...hn,_n]);dn.push(...or)}}return dn}const he=(ft,hn)=>{const dn=[{id:"preferences/theme",name:(0,te.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,te.t)("command-palette.section.preferences","Preferences"),priority:Te},{id:"preferences/dark-theme",name:(0,te.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,fe.K)("dark"),parent:"preferences/theme",priority:Te},{id:"preferences/light-theme",name:(0,te.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,fe.K)("light"),parent:"preferences/theme",priority:Te}],_n=Pe(ft);return[...dn,...hn,..._n]};var be=e(74135),Ae=e(3197);const De={};function Ie(){const{extensions:ft}=(0,Ae.vl)({extensionPointId:be.S.CommandPalette,context:De,limitPerPlugin:3});return(0,l.useMemo)(()=>ft.map(hn=>({section:hn.category??"Extensions",priority:ge,id:hn.id,name:hn.title,target:hn.path,perform:()=>hn.onClick&&hn.onClick()})),[ft])}function ke(ft){const[hn,dn]=(0,l.useState)([]),[_n,ss]=(0,l.useState)([]),Yn=Ie(),Bs=(0,je.useSelector)(Ns=>Ns.navBarTree);return(0,l.useEffect)(()=>{const Ns=he(Bs,Yn);dn(Ns)},[Bs,Yn]),(0,l.useEffect)(()=>{ft||qe().then(Ns=>ss(Ns)).catch(Ns=>{console.error("Error loading recent dashboard actions",Ns)})},[ft]),ft?hn:[..._n,...hn]}var dt=e(53076);const Pt={name:"none",priority:s.Priority.NORMAL};function pt(ft,hn){return hn.priority-ft.priority}function Tt(){const{search:ft,actions:hn,rootActionId:dn}=(0,s.useKBar)(Pa=>({search:Pa.searchQuery,actions:Pa.actions,rootActionId:Pa.currentRootActionId})),_n=l.useMemo(()=>Object.keys(hn).reduce((Pa,fa)=>{const _a=hn[fa];if(!_a.parent&&!dn&&Pa.push(_a),_a.id===dn)for(let da=0;da<_a.children.length;da++)Pa.push(_a.children[da]);return Pa},[]).sort(pt),[hn,dn]),ss=l.useCallback(Pa=>{let fa=[];for(let _a=0;_a<Pa.length;_a++)fa.push(Pa[_a]);return function _a(da,ta=fa){for(let Ba=0;Ba<da.length;Ba++)if(da[Ba].children.length>0){let Ea=da[Ba].children;for(let or=0;or<Ea.length;or++)ta.push(Ea[or]);_a(da[Ba].children,ta)}return ta}(Pa)},[]),Yn=!ft,Bs=l.useMemo(()=>Yn?_n:ss(_n),[ss,_n,Yn]),Ns=jt(Bs,ft),Ps=l.useMemo(()=>{let Pa={},fa=[],_a=[];for(let ta=0;ta<Ns.length;ta++){const Ba=Ns[ta],Ea=Ba.action,or=Ba.score||s.Priority.NORMAL,co={name:typeof Ea.section=="string"?Ea.section:Ea.section?.name||Pt.name,priority:typeof Ea.section=="string"?or:Ea.section?.priority||0+or};Pa[co.name]||(Pa[co.name]=[],fa.push(co)),Pa[co.name].push({priority:Ea.priority+or,action:Ea})}_a=fa.sort(pt).map(ta=>({name:ta.name,actions:Pa[ta.name].sort(pt).map(Ba=>Ba.action)}));let da=[];for(let ta=0;ta<_a.length;ta++){let Ba=_a[ta];Ba.name!==Pt.name&&da.push(Ba.name);for(let Ea=0;Ea<Ba.actions.length;Ea++)da.push(Ba.actions[Ea])}return da},[Ns]),za=l.useMemo(()=>dn,[Ps]);return l.useMemo(()=>({results:Ps,rootActionId:za}),[za,Ps])}function jt(ft,hn){const dn=sn(),_n=l.useMemo(()=>({filtered:ft,search:hn}),[ft,hn]),{filtered:ss,search:Yn}=(0,H.useThrottledValue)(_n);return l.useMemo(()=>{if(Yn.trim()==="")return ss.map(Ps=>({score:0,action:Ps}));const Bs=ss.map(({name:Ps,keywords:za})=>`${Ps} ${za??""}`.toLowerCase()),Ns=[];if(Yn.length>$t){const Ps=Yn.toLowerCase();for(let za=0;za<Bs.length;za++){const fa=Bs[za].indexOf(Ps);if(fa>-1){const _a=fa*-1,da=ss[za];Ns.push({score:_a,action:da})}}}else{const Ps=dn.split(Yn).length,za=1/0,Pa=Ps<5?4:0,[,fa,_a]=dn.search(Bs,Yn,Pa,za);if(fa&&_a)for(let da=0;da<_a.length;da++){const ta=_a[da],Ba=_a.length-da,Ea=ss[fa.idx[ta]];Ns.push({score:Ba,action:Ea})}}return Ns},[ss,Yn,dn])}const $t=25;function sn(){const ft=l.useRef();return ft.current||(ft.current=new dt.A({intraMode:0,intraIns:0})),ft.current}function Yt(){const ft=(0,F.of)(bn),{query:hn,showing:dn,searchQuery:_n}=(0,s.useKBar)(Pa=>({showing:Pa.visualState===s.VisualState.showing,searchQuery:Pa.searchQuery})),ss=ke(_n);(0,s.useRegisterActions)(ss,[ss]);const{searchResults:Yn,isFetchingSearchResults:Bs}=Ce(_n,dn),Ns=(0,l.useRef)(null),{overlayProps:Ps}=(0,Y.e)({isOpen:dn,onClose:()=>hn.setVisualState(s.VisualState.animatingOut)},Ns),{dialogProps:za}=(0,W.s)({},Ns);return(0,l.useEffect)(()=>{dn&&(0,d.rR)("command_palette_opened")},[dn]),ss.length>0?(0,n.jsx)(s.KBarPortal,{children:(0,n.jsx)(s.KBarPositioner,{className:ft.positioner,children:(0,n.jsx)(s.KBarAnimator,{className:ft.animator,children:(0,n.jsx)(z.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{...Ps,...za,children:[(0,n.jsxs)("div",{className:ft.searchContainer,children:[(0,n.jsx)(X.I,{name:"search",size:"md"}),(0,n.jsx)(s.KBarSearch,{defaultPlaceholder:(0,te.t)("command-palette.search-box.placeholder","Search or jump to..."),className:ft.search}),(0,n.jsx)("div",{className:ft.loadingBarContainer,children:Bs&&(0,n.jsx)(q.G,{width:500,delay:0})})]}),(0,n.jsx)("div",{className:ft.resultsContainer,children:(0,n.jsx)(qt,{isFetchingSearchResults:Bs,searchResults:Yn})})]})})})})}):null}const qt=({isFetchingSearchResults:ft,searchResults:hn})=>{const{results:dn,rootActionId:_n}=Tt(),ss=(0,F.of)(bn),Yn=(0,te.t)("command-palette.section.dashboard-search-results","Dashboards"),Bs=(0,te.t)("command-palette.section.folder-search-results","Folders"),Ns=(0,l.useMemo)(()=>hn.filter(fa=>fa.id.startsWith("go/dashboard")).map(fa=>new s.ActionImpl(fa,{store:{}})),[hn]),Ps=(0,l.useMemo)(()=>hn.filter(fa=>fa.id.startsWith("go/folder")).map(fa=>new s.ActionImpl(fa,{store:{}})),[hn]),za=(0,l.useMemo)(()=>{const fa=[...dn];return Ps.length>0&&(fa.push(Bs),fa.push(...Ps)),Ns.length>0&&(fa.push(Yn),fa.push(...Ns)),fa},[dn,Yn,Ns,Bs,Ps]);return!ft&&za.length===0?(0,n.jsx)(G.p,{variant:"not-found",role:"alert",message:(0,te.t)("command-palette.empty-state.message","No results found")}):(0,n.jsx)(le,{items:za,maxHeight:650,onRender:({item:fa,active:_a})=>{const da=za[0]===fa;return typeof fa=="string"?(0,n.jsx)("div",{className:(0,O.cx)(ss.sectionHeader,da&&ss.sectionHeaderFirst),children:fa}):(0,n.jsx)(_,{action:fa,active:_a,currentRootActionId:_n})}})},bn=ft=>({positioner:(0,O.css)({zIndex:ft.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:ft.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,O.css)({maxWidth:ft.breakpoints.values.md,width:"100%",background:ft.colors.background.primary,color:ft.colors.text.primary,borderRadius:ft.shape.radius.default,border:`1px solid ${ft.colors.border.weak}`,overflow:"hidden",boxShadow:ft.shadows.z3}),loadingBarContainer:(0,O.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,O.css)({alignItems:"center",background:ft.components.input.background,borderBottom:`1px solid ${ft.colors.border.weak}`,display:"flex",gap:ft.spacing(1),padding:ft.spacing(1,2),position:"relative"}),search:(0,O.css)({fontSize:ft.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:ft.components.input.text}),spinner:(0,O.css)({height:"22px"}),resultsContainer:(0,O.css)({paddingBottom:ft.spacing(1)}),sectionHeader:(0,O.css)({padding:ft.spacing(1.5,2,2,2),fontSize:ft.typography.bodySmall.fontSize,fontWeight:ft.typography.fontWeightMedium,color:ft.colors.text.secondary,borderTop:`1px solid ${ft.colors.border.weak}`,marginTop:ft.spacing(1)}),sectionHeaderFirst:(0,O.css)({paddingBottom:ft.spacing(1),borderTop:"none",marginTop:0})});var Mt=e(59875),Jt=e(86634),Ut=e(13544),Gt=e(29158),Lt=e(40276),At=e(91219),Nt=e(8856),Dn=e(78685),An=e(8887),Pn=e(94753),Xn=e(18759);const Tn=({children:ft})=>{const hn=(0,F.of)(ht);return(0,n.jsxs)(n.Fragment,{children:[ft,(0,n.jsx)("span",{className:hn.highlight})]})},ht=ft=>({highlight:(0,O.css)({backgroundColor:ft.colors.success.main,borderRadius:ft.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var St=e(50720);function Ge({children:ft,isActive:hn,onClick:dn,target:_n,url:ss,onPin:Yn,isPinned:Bs}){const Ns=(0,F.$j)(),Ps=Ve(Ns,hn),za=!_n&&ss.startsWith("/")?St.N:"a",Pa=(0,n.jsxs)("div",{className:Ps.linkContent,children:[ft,_n==="_blank"&&(0,n.jsx)(X.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,n.jsxs)("div",{className:(0,O.cx)(Ps.wrapper,{[Ps.wrapperActive]:hn,[Ps.wrapperBookmark]:c.$.featureToggles.pinNavItems}),children:[(0,n.jsx)(za,{"data-testid":Ut.Tp.components.NavMenu.item,className:Ps.container,href:ss,target:_n,onClick:dn,...hn&&{"aria-current":"page"},children:Pa}),c.$.featureToggles.pinNavItems&&ss&&ss!=="/bookmarks"&&(0,n.jsx)(Gt.K,{name:"bookmark",className:"pin-icon",iconType:Bs?"solid":"default",onClick:()=>Yn(ss),"aria-label":Bs?(0,te.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,te.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}Ge.displayName="MegaMenuItemText";const Ve=(ft,hn)=>({wrapper:(0,O.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,O.css)({".pin-icon":{display:"none"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{display:"inline-flex"}}}),wrapperActive:(0,O.css)({backgroundColor:ft.colors.background.secondary,borderTopRightRadius:ft.shape.radius.default,borderBottomRightRadius:ft.shape.radius.default,position:"relative","&::before":{backgroundImage:ft.colors.gradients.brandVertical,borderRadius:ft.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:ft.spacing(.5)}}),container:(0,O.css)({alignItems:"center",color:hn?ft.colors.text.primary:ft.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:ft.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${ft.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,O.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})}),lt=2;function It({link:ft,activeItem:hn,level:dn=0,onClick:_n,onPin:ss,isPinned:Yn}){const{chrome:Bs}=(0,w.Il)(),Ps=Bs.useState().megaMenuDocked,za=(0,i.zy)(),Pa=ft.highlightText?Tn:l.Fragment,fa=ze(ft,hn),_a=ft===hn||dn===lt&&fa,[da,ta]=(0,Dn.A)(`grafana.navigation.expanded[${ft.text}]`,!!fa),Ba=dn<lt&&!!(vt(ft)||ft.emptyMessage),Ea=(0,l.useRef)(null),or=(0,F.of)(Qe);if((0,l.useEffect)(()=>{fa&&ta(!0)},[fa,za,Ps,ta]),(0,l.useEffect)(()=>{_a&&Ea.current&&Ot(Ea.current)&&Ea.current.scrollIntoView({block:"center"})},[_a]),!ft.url)return null;let co=null;return ft.icon?co=(0,n.jsx)(X.I,{className:or.icon,name:(0,An.Uo)(ft.icon)??"link",size:"lg"}):ft.img&&(co=(0,n.jsx)(u.B,{width:3,justifyContent:"center",children:(0,n.jsx)("img",{className:or.img,src:ft.img,alt:""})})),(0,n.jsxs)("li",{ref:Ea,className:or.listItem,children:[(0,n.jsxs)("div",{className:(0,O.cx)(or.menuItem,{[or.menuItemWithIcon]:!!(dn===0&&co)}),children:[dn!==0&&(0,n.jsx)(Xn.T,{level:dn===lt?dn-1:dn,spacing:3}),dn===lt&&(0,n.jsx)("div",{className:or.itemConnector}),(0,n.jsx)("div",{className:or.collapseButtonWrapper,children:Ba&&(0,n.jsx)(Gt.K,{"aria-label":`${da?"Collapse":"Expand"} section ${ft.text}`,className:or.collapseButton,onClick:()=>ta(!da),name:da?"angle-down":"angle-right",size:"md",variant:"secondary"})}),(0,n.jsx)("div",{className:or.collapsibleSectionWrapper,children:(0,n.jsx)(Ge,{isActive:_a,onClick:()=>{ft.onClick?.(),_n?.()},target:ft.target,url:ft.url,onPin:()=>ss(ft),isPinned:Yn(ft.url),children:(0,n.jsxs)("div",{className:(0,O.cx)(or.labelWrapper,{[or.hasActiveChild]:fa,[or.labelWrapperWithIcon]:!!(dn===0&&co)}),children:[dn===0&&co&&(0,n.jsx)(Pa,{children:co}),(0,n.jsx)(Pn.E,{truncate:!0,children:ft.text})]})})})]}),Ba&&da&&(0,n.jsx)("ul",{className:or.children,children:vt(ft)?ft.children.filter(Mo=>!Mo.isCreateAction).map(Mo=>(0,n.jsx)(It,{link:Mo,activeItem:hn,onClick:_n,level:dn+1,onPin:ss,isPinned:Yn},`${ft.text}-${Mo.text}`)):(0,n.jsx)("div",{className:or.emptyMessage,"aria-live":"polite",children:ft.emptyMessage})})]})}const Qe=ft=>({icon:(0,O.css)({width:ft.spacing(3)}),img:(0,O.css)({height:ft.spacing(2),width:ft.spacing(2)}),listItem:(0,O.css)({flex:1,maxWidth:"100%"}),menuItem:(0,O.css)({display:"flex",alignItems:"center",gap:ft.spacing(1),height:ft.spacing(4),paddingLeft:ft.spacing(.5),position:"relative"}),menuItemWithIcon:(0,O.css)({paddingLeft:ft.spacing(0)}),collapseButtonWrapper:(0,O.css)({display:"flex",justifyContent:"center",width:ft.spacing(3),flexShrink:0}),itemConnector:(0,O.css)({position:"relative",height:"100%",width:ft.spacing(1.5),"&::before":{borderLeft:`1px solid ${ft.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,O.css)({margin:0}),collapsibleSectionWrapper:(0,O.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,O.css)({display:"flex",alignItems:"center",gap:ft.spacing(2),minWidth:0,paddingLeft:ft.spacing(1)}),labelWrapperWithIcon:(0,O.css)({paddingLeft:ft.spacing(.5)}),hasActiveChild:(0,O.css)({color:ft.colors.text.primary}),children:(0,O.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,O.css)({color:ft.colors.text.secondary,fontStyle:"italic",padding:ft.spacing(1,1.5,1,7)})});function vt(ft){return!!(ft.children&&ft.children.length>0)}function Ot(ft){const hn=ft.getBoundingClientRect();return hn.bottom<0||hn.top>=window.innerHeight}const zt=()=>{const ft=(0,Nt.Pj)(),hn=(0,l.useMemo)(()=>ft.data?.navbar?.bookmarkUrls||[],[ft]);return c.$.featureToggles.pinNavItems?hn:[]},vn="300px",ln=(0,l.memo)((0,l.forwardRef)(({onClose:ft,...hn},dn)=>{const _n=(0,je.useSelector)(Ea=>Ea.navBarTree),ss=(0,F.of)(On),Yn=(0,i.zy)(),{chrome:Bs}=(0,w.Il)(),Ns=(0,je.useDispatch)(),Ps=Bs.useState(),[za]=(0,Nt.o)(),Pa=zt(),fa=_n.filter(Ea=>Ea.id!=="profile"&&Ea.id!=="help").map(Ea=>tt(Ea,Ps.megaMenuDocked)),_a=pe(fa,Ps.sectionNav.node,Yn.pathname),da=()=>{Bs.setMegaMenuDocked(!Ps.megaMenuDocked),Ps.megaMenuDocked&&Bs.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(Ps.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})},ta=(0,l.useCallback)(Ea=>!Ea||!Pa?.length?!1:Pa?.includes(Ea),[Pa]),Ba=Ea=>{const or=Ea.url;if(or&&c.$.featureToggles.pinNavItems){const co=ta(or),Mo=co?Pa.filter(ro=>or!==ro):[...Pa,or],No=co?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,d.rR)(No,{path:or}),za({patchPrefsCmd:{navbar:{bookmarkUrls:Mo}}}).then(ro=>{ro.error||Ns((0,At.ve)({item:Ea,isSaved:!co}))})}};return(0,n.jsxs)("div",{"data-testid":Ut.Tp.components.NavMenu.Menu,ref:dn,...hn,children:[(0,n.jsxs)("div",{className:ss.mobileHeader,children:[(0,n.jsx)(X.I,{name:"bars",size:"xl"}),(0,n.jsx)(Gt.K,{tooltip:(0,te.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:ft,size:"xl",variant:"secondary"})]}),(0,n.jsx)("nav",{className:ss.content,children:(0,n.jsx)(Lt.E,{showScrollIndicators:!0,hideHorizontalTrack:!0,children:(0,n.jsx)("ul",{className:ss.itemList,"aria-label":(0,te.t)("navigation.megamenu.list-label","Navigation"),children:fa.map((Ea,or)=>(0,n.jsxs)(u.B,{direction:or===0?"row-reverse":"row",alignItems:"center",children:[or===0&&(0,n.jsx)(Gt.K,{id:"dock-menu-button",className:ss.dockMenuButton,tooltip:Ps.megaMenuDocked?(0,te.t)("navigation.megamenu.undock","Undock menu"):(0,te.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:da,variant:"secondary"}),(0,n.jsx)(It,{link:Ea,isPinned:ta,onClick:Ps.megaMenuDocked?void 0:ft,activeItem:_a,onPin:Ba})]},Ea.text))})})})]})}));ln.displayName="MegaMenu";const On=ft=>({content:(0,O.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,O.css)({display:"flex",justifyContent:"space-between",padding:ft.spacing(1,1,1,2),borderBottom:`1px solid ${ft.colors.border.weak}`,[ft.breakpoints.up("md")]:{display:"none"}}),itemList:(0,O.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:ft.spacing(1,1,2,1),[ft.breakpoints.up("md")]:{width:vn}}),dockMenuButton:(0,O.css)({display:"none",[ft.breakpoints.up("xl")]:{display:"inline-flex"}})});var wn=e(13390),Un=e(27746);function cs({href:ft,isCurrent:hn,text:dn,index:_n,flexGrow:ss}){const Yn=(0,F.of)(Zn),Bs=()=>{(0,d.rR)("grafana_breadcrumb_clicked",{url:ft})};return(0,n.jsx)("li",{className:Yn.breadcrumbWrapper,style:{flexGrow:ss},children:hn?(0,n.jsx)("span",{"data-testid":wn.X.Breadcrumbs.breadcrumb(dn),className:Yn.breadcrumb,"aria-current":"page",title:dn,children:dn}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{onClick:Bs,"data-testid":wn.X.Breadcrumbs.breadcrumb(dn),className:(0,O.cx)(Yn.breadcrumb,Yn.breadcrumbLink),title:dn,href:ft,children:dn}),(0,n.jsx)("div",{className:Yn.separator,"aria-hidden":!0,children:(0,n.jsx)(X.I,{name:"angle-right"})})]})})}const Zn=ft=>({breadcrumb:(0,O.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",padding:ft.spacing(0,.5),whiteSpace:"nowrap",color:ft.colors.text.secondary}),breadcrumbLink:(0,O.css)({color:ft.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,O.css)({alignItems:"center",color:ft.colors.text.primary,display:"flex",flex:1,minWidth:0,maxWidth:"max-content",[ft.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,O.css)({color:ft.colors.text.secondary})});function wt({breadcrumbs:ft,className:hn}){const dn=(0,F.of)(Ht);return(0,n.jsx)("nav",{"aria-label":"Breadcrumbs",className:hn,children:(0,n.jsx)("ol",{className:dn.breadcrumbs,children:ft.map((_n,ss)=>(0,l.createElement)(cs,{..._n,isCurrent:ss===ft.length-1,key:ss,index:ss,flexGrow:Ft(ss,ft.length)}))})})}function Ft(ft,hn){return hn<5&&ft>0&&ft<hn-2||hn>6&&ft>1&&ft<hn-3?4:10}const Ht=ft=>({breadcrumbs:(0,O.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var ut=e(3984),pn=e(57571),Jn=e(10804);const Qn="mega-menu-toggle";function fs({actions:ft,searchBarHidden:hn,sectionNav:dn,pageNav:_n,onToggleMegaMenu:ss,onToggleSearchBar:Yn,onToggleKioskMode:Bs}){const{chrome:Ns}=(0,w.Il)(),Ps=Ns.useState(),za=(0,je.useSelector)(_a=>_a.navIndex)[Ke.Id],Pa=(0,F.of)(ls),fa=(0,ut.Z)(dn,_n,za);return(0,n.jsxs)("div",{"data-testid":wn.X.NavToolbar.container,className:Pa.pageToolbar,children:[(0,n.jsx)("div",{className:Pa.menuButton,children:(0,n.jsx)(Gt.K,{id:Qn,name:"bars",tooltip:Ps.megaMenuOpen?(0,te.t)("navigation.toolbar.close-menu","Close menu"):(0,te.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:ss,"data-testid":wn.X.NavBar.Toggle.button})}),(0,n.jsx)(wt,{breadcrumbs:fa,className:Pa.breadcrumbsWrapper}),(0,n.jsxs)("div",{className:Pa.actions,children:[ft,hn&&(0,n.jsx)(Un.I,{onClick:Bs,narrow:!0,title:(0,te.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),ft&&(0,n.jsx)(Jn.K,{}),(0,n.jsx)(Un.I,{onClick:Yn,narrow:!0,title:(0,te.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar"),children:(0,n.jsx)(X.I,{name:hn?"angle-down":"angle-up",size:"xl"})})]})]})}const ls=ft=>({breadcrumbsWrapper:(0,O.css)({display:"flex",overflow:"hidden",[ft.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,O.css)({height:pn.l,display:"flex",padding:ft.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${ft.colors.border.weak}`}),menuButton:(0,O.css)({display:"flex",alignItems:"center",marginRight:ft.spacing(1)}),actions:(0,O.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:ft.spacing(1),flexGrow:1,gap:ft.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function vs({}){const ft=(0,F.$j)(),{chrome:hn}=(0,w.Il)(),dn=hn.useState(),_n=dn.searchBarHidden||dn.kioskMode===je.KioskMode.TV,ss=(0,l.useRef)(null),Yn=(0,l.useRef)(null),Bs=ft.transitions.duration.shortest,Ns=(0,F.of)(Ks,Bs),Ps=dn.megaMenuOpen&&!dn.megaMenuDocked,za=()=>hn.setMegaMenuOpen(!1),{overlayProps:Pa,underlayProps:fa}=(0,Y.e)({isDismissable:!0,isOpen:!0,onClose:za,shouldCloseOnInteractOutside:ta=>!document.getElementById(Qn)?.contains(ta)},ss),{dialogProps:_a}=(0,W.s)({},ss),da=(0,F.of)(ea,_n);return(0,n.jsx)("div",{className:da.wrapper,children:(0,n.jsxs)(Mt.Sf,{children:[(0,n.jsx)(Jt.A,{nodeRef:ss,in:Ps,unmountOnExit:!0,classNames:Ns.overlay,timeout:{enter:Bs,exit:0},children:(0,n.jsx)(z.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)(ln,{className:da.menu,onClose:za,ref:ss,...Pa,..._a})})}),(0,n.jsx)(Jt.A,{nodeRef:Yn,in:Ps,unmountOnExit:!0,classNames:Ns.backdrop,timeout:{enter:Bs,exit:0},children:(0,n.jsx)("div",{ref:Yn,className:da.backdrop,...fa})})]})})}const ea=(ft,hn)=>{const dn=hn?pn.l:pn.l*2;return{backdrop:(0,O.css)({backdropFilter:"blur(1px)",backgroundColor:ft.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:hn?0:pn.l,zIndex:ft.zIndex.modalBackdrop,[ft.breakpoints.up("md")]:{top:dn}}),menu:(0,O.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:ft.zIndex.modal,position:"fixed",top:hn?0:pn.l,backgroundColor:ft.colors.background.primary,boxSizing:"content-box",flex:"1 1 0",[ft.breakpoints.up("md")]:{right:"unset",borderRight:`1px solid ${ft.colors.border.weak}`,top:dn}}),wrapper:(0,O.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:ft.zIndex.sidemenu})}},Ks=(ft,hn)=>{const dn={[ft.transitions.handleMotion("no-preference")]:{transitionDuration:`${hn}ms`,transitionTimingFunction:ft.transitions.easing.easeInOut},[ft.breakpoints.down("md")]:{overflow:"hidden"}},_n={...dn,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},ss={...dn,transitionProperty:"opacity"},Yn={width:"100%",[ft.breakpoints.up("md")]:{boxShadow:ft.shadows.z3,width:vn}},Bs={boxShadow:"none",width:0},Ns={opacity:1},Ps={opacity:0};return{backdrop:{enter:(0,O.css)(Ps),enterActive:(0,O.css)(ss,Ns),enterDone:(0,O.css)(Ns)},overlay:{enter:(0,O.css)(Bs),enterActive:(0,O.css)(_n,Yn),enterDone:(0,O.css)(Yn)}}};var Hs=e(70944),bs=e(19727);const Ys=({label:ft,onClick:hn,onDismiss:dn})=>{const _n=(0,F.of)(La);return(0,n.jsxs)(bs.e,{className:_n.buttonGroup,children:[(0,n.jsx)(U.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:hn,title:ft,className:_n.mainDismissableButton,"data-testid":Ut.Tp.components.ReturnToPrevious.backButton,children:ft}),(0,n.jsx)(U.$n,{icon:"times","aria-label":(0,te.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:dn,"data-testid":Ut.Tp.components.ReturnToPrevious.dismissButton})]})},La=ft=>({mainDismissableButton:(0,O.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,O.css)({width:"fit-content",backgroundColor:ft.colors.background.secondary})});Ys.displayName="DismissableButton";const Xs=({href:ft,title:hn})=>{const dn=(0,F.of)(Ta),{chrome:_n}=(0,w.Il)(),ss=(0,l.useCallback)(()=>{o.Ny.push(ft),_n.clearReturnToPrevious("clicked")},[ft,_n]),Yn=(0,l.useCallback)(()=>{_n.clearReturnToPrevious("dismissed")},[_n]);return(0,n.jsx)("div",{className:dn.returnToPrevious,"data-testid":Ut.Tp.components.ReturnToPrevious.buttonGroup,children:(0,n.jsx)(Ys,{label:(0,te.t)("return-to-previous.button.label","Back to {{title}}",{title:hn}),onClick:ss,onDismiss:Yn})})},Ta=ft=>({returnToPrevious:(0,O.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:ft.zIndex.tooltip,position:"fixed",bottom:ft.spacing.x4,boxShadow:ft.shadows.z3})});Xs.displayName="ReturnToPrevious";var Lr=e(2543),$r=e(80997),Za=e(71733),Er=e(83122),Ar=e(2913),ho=e(19361),Fr=e(42941),rr=e(87978),fo=e(62372),_o=e(49185),gr=e(69386),ci=e(4172);function Qo({feedUrl:ft}){const hn=(0,F.of)(eo),{state:dn,getNews:_n}=(0,ci.n)(ft),[ss,Yn]=(0,_o.A)();return(0,l.useEffect)(()=>{_n()},[_n]),dn.error?(0,n.jsx)("div",{className:hn.innerWrapper,children:dn.error&&dn.error.message}):(0,n.jsxs)("div",{ref:ss,children:[dn.loading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(gr.K.Skeleton,{showImage:!0,width:Yn.width}),(0,n.jsx)(gr.K.Skeleton,{showImage:!0,width:Yn.width}),(0,n.jsx)(gr.K.Skeleton,{showImage:!0,width:Yn.width}),(0,n.jsx)(gr.K.Skeleton,{showImage:!0,width:Yn.width}),(0,n.jsx)(gr.K.Skeleton,{showImage:!0,width:Yn.width})]}):(0,n.jsx)(n.Fragment,{children:Yn.width>0&&dn.value?.map((Bs,Ns)=>(0,n.jsx)(gr.K,{index:Ns,showImage:!0,width:Yn.width,data:dn.value},Ns))}),(0,n.jsx)("div",{className:hn.grot,children:(0,n.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",children:(0,n.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})})})]})}const eo=ft=>({innerWrapper:(0,O.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,O.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:ft.spacing(5,0),img:{width:"186px",height:"186px"}})});function Do({className:ft}){const[hn,dn]=(0,Fr.A)(!1),_n=(0,F.of)(di);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Un.I,{className:ft,onClick:dn,iconOnly:!0,icon:"rss","aria-label":"News"}),hn&&(0,n.jsx)(rr._,{title:(0,n.jsxs)("div",{className:_n.title,children:[(0,n.jsx)(Pn.E,{element:"h2",children:(0,te.t)("news.title","Latest from the blog")}),(0,n.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:_n.grot,children:(0,n.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})}),(0,n.jsx)("div",{className:_n.actions,children:(0,n.jsx)(Gt.K,{name:"times",variant:"secondary",onClick:dn,"data-testid":Ut.Tp.components.Drawer.General.close,tooltip:(0,te.t)("news.drawer.close","Close Drawer")})})]}),onClose:dn,size:"md",children:(0,n.jsx)(Qo,{feedUrl:fo.$})})]})}const di=ft=>({title:(0,O.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:ft.spacing(2),borderBottom:`1px solid ${ft.colors.border.weak}`}),grot:(0,O.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:ft.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,O.css)({position:"absolute",right:ft.spacing(1),top:ft.spacing(2)})});var bo=e(32931),Oo=e(51986);function To({orgs:ft,onSelectChange:hn}){const dn=(0,F.of)(jo);return(0,n.jsx)(Oo.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:dn.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:ft.map(_n=>({label:_n.name,description:_n.role,value:_n})),onChange:hn,icon:"building"})}const jo=ft=>({buttonCss:(0,O.css)({color:ft.colors.text.secondary,"&:hover":{color:ft.colors.text.primary}})});var $o=e(90182);function Yo({orgs:ft,onSelectChange:hn}){const dn=(0,F.of)(Si),{orgName:_n,orgId:ss,orgRole:Yn}=J.TP.user,[Bs,Ns]=(0,l.useState)(()=>({label:_n,value:{role:Yn,orgId:ss,name:_n},description:Yn})),Ps=za=>{Ns(za),hn(za)};return(0,n.jsx)($o.l6,{"aria-label":"Change organization",width:"auto",value:Bs,prefix:(0,n.jsx)(X.I,{className:"prefix-icon",name:"building"}),className:dn.select,options:ft.map(za=>({label:za.name,description:za.role,value:za})),onChange:Ps})}const Si=ft=>({select:(0,O.css)({border:"none",background:"none",color:ft.colors.text.secondary,"&:hover":{color:ft.colors.text.primary,"& .prefix-icon":(0,O.css)({color:ft.colors.text.primary})}})});function vi(){const ft=(0,F.$j)(),hn=(0,je.useDispatch)(),dn=(0,je.useSelector)(Ps=>Ps.organization.userOrgs),_n=Ps=>{Ps.value&&((0,bo.bA)(Ps.value.orgId),o.Ny.push(`/?orgId=${Ps.value.orgId}`),window.location.reload())};(0,l.useEffect)(()=>{J.TP.isSignedIn&&hn((0,bo.wV)())},[hn]);const ss=ft.breakpoints.values.sm,[Yn,Bs]=(0,l.useState)(!window.matchMedia(`(min-width: ${ss}px)`).matches);if((0,B.Y)({breakpoint:ss,onChange:Ps=>{Bs(!Ps.matches)}}),dn?.length<=1)return null;const Ns=Yn?To:Yo;return(0,n.jsx)(Ns,{orgs:dn,onSelectChange:_n})}var ai=e(38138);function yi(ft){const hn=[];for(const dn of ft)dn.isCreateAction&&hn.push(dn),dn.children&&hn.push(...yi(dn.children));return hn}const Bo=({})=>{const ft=(0,F.of)(Ai),hn=(0,F.$j)(),dn=(0,je.useSelector)(Pa=>Pa.navBarTree),_n=hn.breakpoints.values.sm,[ss,Yn]=(0,l.useState)(!1),[Bs,Ns]=(0,l.useState)(!window.matchMedia(`(min-width: ${_n}px)`).matches),Ps=(0,l.useMemo)(()=>yi(dn),[dn]);(0,B.Y)({breakpoint:_n,onChange:Pa=>{Ns(!Pa.matches)}});const za=()=>(0,n.jsx)(ai.W,{children:Ps.map((Pa,fa)=>(0,n.jsx)(ai.W.Item,{url:Pa.url,label:Pa.text,onClick:()=>(0,d.rR)("grafana_menu_item_clicked",{url:Pa.url,from:"quickadd"})},fa))});return Ps.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Er.m,{overlay:za,placement:"bottom-end",onVisibleChange:Yn,children:(0,n.jsx)(Un.I,{iconOnly:!0,icon:Bs?"plus-circle":"plus",isOpen:Bs?void 0:ss,"aria-label":"New"})}),(0,n.jsx)(Jn.K,{className:ft.separator})]}):null},Ai=ft=>({buttonContent:(0,O.css)({alignItems:"center",display:"flex"}),buttonText:(0,O.css)({[ft.breakpoints.down("md")]:{display:"none"}}),separator:(0,O.css)({[ft.breakpoints.down("sm")]:{display:"none"}})});function Ho(){const ft=(0,i.zy)(),hn=(0,F.of)(ui);let dn=$r.sQ.sanitizeUrl(Za.I.getUrlForPartial(ft,{forceLogin:"true"}));return dn.startsWith("//")&&(dn=dn.replace(/\/+/g,"/")),(0,n.jsx)("a",{className:hn.link,href:dn,target:"_self",children:"Sign in"})}const ui=ft=>({link:(0,O.css)({paddingRight:ft.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var Jo=e(64539);function Ri({node:ft}){const hn=(0,F.of)(xi),dn=tt((0,Lr.cloneDeep)(ft),!1);return dn?(0,n.jsx)(ai.W,{header:(0,n.jsxs)("div",{onClick:_n=>_n.stopPropagation(),className:hn.header,children:[(0,n.jsx)("div",{children:dn.text}),dn.subTitle&&(0,n.jsx)("div",{className:hn.subTitle,children:dn.subTitle})]}),children:dn.children?.map(_n=>_n.url?(0,n.jsx)(Jo.D,{url:_n.url,label:_n.text,icon:_n.icon,target:_n.target},_n.id):(0,n.jsx)(Jo.D,{icon:_n.icon,onClick:_n.onClick,label:_n.text},_n.id))}):null}const xi=ft=>({header:(0,O.css)({fontSize:ft.typography.h5.fontSize,fontWeight:ft.typography.h5.fontWeight,padding:ft.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,O.css)({color:ft.colors.text.secondary,fontSize:ft.typography.bodySmall.fontSize})});var Po=e(10354),ri=e(16797),Ei=e(63917);function Zo(){const ft=(0,F.$j)(),{query:hn}=(0,s.useKBar)(Bs=>({kbarSearchQuery:Bs.searchQuery,kbarIsOpen:Bs.visualState===s.VisualState.showing})),dn=ft.breakpoints.values.sm,[_n,ss]=(0,l.useState)(!window.matchMedia(`(min-width: ${dn}px)`).matches);(0,B.Y)({breakpoint:dn,onChange:Bs=>{ss(!Bs.matches)}});const Yn=()=>{hn.toggle()};return _n?(0,n.jsx)(Un.I,{iconOnly:!0,icon:"search","aria-label":(0,te.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:Yn}):(0,n.jsx)(_t,{onClick:Yn})}function _t({onClick:ft}){const hn=(0,F.of)(cn),dn=(0,l.useMemo)(()=>(0,Ei.gn)(),[]);return(0,n.jsx)("div",{className:hn.wrapper,children:(0,n.jsxs)("div",{className:hn.inputWrapper,children:[(0,n.jsx)("div",{className:hn.prefix,children:(0,n.jsx)(X.I,{name:"search"})}),(0,n.jsx)("button",{className:hn.fakeInput,onClick:ft,children:(0,te.t)("nav.search.placeholderCommandPalette","Search or jump to...")}),(0,n.jsxs)("div",{className:hn.suffix,children:[(0,n.jsx)(X.I,{name:"keyboard"}),(0,n.jsxs)(Pn.E,{variant:"bodySmall",children:[dn,"+k"]})]})]})})}const cn=ft=>{const hn=(0,Po.n)({theme:ft});return{wrapper:hn.wrapper,inputWrapper:hn.inputWrapper,prefix:hn.prefix,suffix:(0,O.css)([hn.suffix,{display:"flex",gap:ft.spacing(.5)}]),fakeInput:(0,O.css)([hn.input,{textAlign:"left",paddingLeft:28,color:ft.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,O.css)`
          ${(0,ri.focusCss)(ft)}
        `}]),button:(0,O.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}};function kn({children:ft,align:hn="left"}){const dn=(0,F.of)(Kn),ss=(0,F.$j)().breakpoints.values.sm,[Yn,Bs]=(0,l.useState)(!window.matchMedia(`(min-width: ${ss}px)`).matches);return(0,B.Y)({breakpoint:ss,onChange:Ns=>{Bs(!Ns.matches)}}),Yn?(0,n.jsx)(n.Fragment,{children:ft}):(0,n.jsx)("div",{"data-testid":"wrapper",className:(0,O.cx)(dn.wrapper,{[dn[hn]]:hn==="right"}),children:ft})}const Kn=ft=>({wrapper:(0,O.css)({display:"flex",gap:ft.spacing(.5),alignItems:"center"}),right:(0,O.css)({justifyContent:"flex-end"}),left:(0,O.css)({}),center:(0,O.css)({})}),ns=(0,l.memo)(function(){const hn=(0,F.of)(Rs),dn=(0,je.useSelector)(Ps=>Ps.navIndex),_n=(0,i.zy)(),ss=(0,Lr.cloneDeep)(dn.help),Yn=ss?Dt(ss):void 0,Bs=dn.profile;let Ns=Ar.config.appSubUrl||"/";return!Ar.config.bootData.user.isSignedIn&&!Ar.config.anonymousEnabled&&(Ns=$r.sQ.sanitizeUrl(Za.I.getUrlForPartial(_n,{forceLogin:"true"}))),(0,n.jsxs)("div",{className:hn.layout,children:[(0,n.jsxs)(kn,{children:[(0,n.jsx)("a",{className:hn.logo,href:Ns,title:"Go to home",children:(0,n.jsx)(ho.M.MenuLogo,{className:hn.img})}),(0,n.jsx)(vi,{})]}),(0,n.jsx)(kn,{children:(0,n.jsx)(Zo,{})}),(0,n.jsxs)(kn,{align:"right",children:[(0,n.jsx)(Bo,{}),Yn&&(0,n.jsx)(Er.m,{overlay:()=>(0,n.jsx)(Ri,{node:Yn}),placement:"bottom-end",children:(0,n.jsx)(Un.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),Ar.config.newsFeedEnabled&&(0,n.jsx)(Do,{}),!M.contextSrv.user.isSignedIn&&(0,n.jsx)(Ho,{}),Bs&&(0,n.jsx)(Er.m,{overlay:()=>(0,n.jsx)(Ri,{node:Bs}),placement:"bottom-end",children:(0,n.jsx)(Un.I,{className:hn.profileButton,imgSrc:M.contextSrv.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})})]})]})}),Rs=ft=>({layout:(0,O.css)({height:pn.l,display:"flex",gap:ft.spacing(1),alignItems:"center",padding:ft.spacing(0,1,0,2),borderBottom:`1px solid ${ft.colors.border.weak}`,justifyContent:"space-between",[ft.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,O.css)({height:ft.spacing(3),width:ft.spacing(3)}),logo:(0,O.css)({display:"flex"}),profileButton:(0,O.css)({padding:ft.spacing(0,.25),img:{borderRadius:ft.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function Os({children:ft}){const{chrome:hn}=(0,w.Il)(),dn=hn.useState(),_n=dn.searchBarHidden||dn.kioskMode===je.KioskMode.TV,ss=(0,F.$j)(),Yn=(0,F.of)(ha,_n),Bs=ss.breakpoints.values.xl,Ns=K.A.getBool(Hs.hE,!0),Ps=!dn.chromeless&&dn.megaMenuDocked&&dn.megaMenuOpen;(0,B.Y)({breakpoint:Bs,onChange:Ba=>{Ns&&(hn.setMegaMenuDocked(Ba.matches,!1),hn.setMegaMenuOpen(Ba.matches?K.A.getBool(Hs.k0,dn.megaMenuOpen):!1))}});const za=(0,O.cx)({[Yn.content]:!0,[Yn.contentNoSearchBar]:_n,[Yn.contentChromeless]:dn.chromeless}),Pa=()=>{hn.setMegaMenuOpen(!dn.megaMenuOpen)},{pathname:fa,search:_a}=o.Ny.getLocation(),da=fa+_a,ta=dn.returnToPrevious&&da!==dn.returnToPrevious.href;return(0,l.useEffect)(()=>{dn.returnToPrevious&&da===dn.returnToPrevious.href&&hn.clearReturnToPrevious("auto_dismissed")},[hn,da]),(0,l.useEffect)(()=>{const Ba=(0,o.SE)(_a);hn.setKioskModeFromUrl(Ba.kiosk)},[hn,_a]),(0,n.jsxs)("div",{className:N()("main-view",{"main-view--search-bar-hidden":_n&&!dn.chromeless,"main-view--chrome-hidden":dn.chromeless}),children:[!dn.chromeless&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.z9,{className:Yn.skipLink,href:"#pageContent",children:"Skip to main content"}),(0,n.jsxs)("header",{className:(0,O.cx)(Yn.topNav),children:[!_n&&(0,n.jsx)(ns,{}),(0,n.jsx)(fs,{searchBarHidden:_n,sectionNav:dn.sectionNav.node,pageNav:dn.pageNav,actions:dn.actions,onToggleSearchBar:hn.onToggleSearchBar,onToggleMegaMenu:Pa,onToggleKioskMode:hn.onToggleKioskMode})]})]}),(0,n.jsx)("div",{className:za,children:(0,n.jsxs)("div",{className:Yn.panes,children:[Ps&&(0,n.jsx)(ln,{className:Yn.dockedMegaMenu,onClose:()=>hn.setMegaMenuOpen(!1)}),(0,n.jsx)("main",{className:(0,O.cx)(Yn.pageContainer,{[Yn.pageContainerMenuDocked]:c.$.featureToggles.bodyScrolling&&Ps}),id:"pageContent",children:ft})]})}),!dn.chromeless&&!dn.megaMenuDocked&&(0,n.jsx)(vs,{}),!dn.chromeless&&(0,n.jsx)(Yt,{}),ta&&dn.returnToPrevious&&(0,n.jsx)(Xs,{href:dn.returnToPrevious.href,title:dn.returnToPrevious.title})]})}const ha=(ft,hn)=>({content:(0,O.css)({display:"flex",flexDirection:"column",paddingTop:pn.l*2,flexGrow:1,height:c.$.featureToggles.bodyScrolling?"auto":"100%"}),contentNoSearchBar:(0,O.css)({paddingTop:pn.l}),contentChromeless:(0,O.css)({paddingTop:0}),dockedMegaMenu:(0,O.css)({background:ft.colors.background.primary,borderRight:`1px solid ${ft.colors.border.weak}`,display:"none",[ft.breakpoints.up("xl")]:{display:"block"}},c.$.featureToggles.bodyScrolling?{position:"fixed",height:`calc(100% - ${hn?pn.l:pn.l*2}px)`,zIndex:1}:{zIndex:ft.zIndex.navbarFixed}),topNav:(0,O.css)({display:"flex",position:"fixed",zIndex:ft.zIndex.navbarFixed,left:0,right:0,background:ft.colors.background.primary,flexDirection:"column"}),panes:(0,O.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"},!c.$.featureToggles.bodyScrolling&&{height:"100%",minHeight:0,width:"100%",[ft.breakpoints.up("md")]:{flexDirection:"row"}}),pageContainerMenuDocked:(0,O.css)({paddingLeft:"300px"}),pageContainer:(0,O.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1},!c.$.featureToggles.bodyScrolling&&{minHeight:0,minWidth:0,overflow:"auto","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0}}),skipLink:(0,O.css)({position:"fixed",top:-1e3,":focus":{left:ft.spacing(1),top:ft.spacing(1),zIndex:ft.zIndex.portal}})});var na=e(26272),wa=e(82467),pr=e(16001),Ma=e(3169),ks=e(94701),oo=e(42418);function go({appNotification:ft,onClearNotification:hn}){const dn=(0,F.of)(qr);(0,ks.A)(()=>{setTimeout(()=>{hn(ft.id)},je.timeoutMap[ft.severity])});const _n=ft.component||ft.text||ft.traceId;return(0,n.jsx)(oo.F,{severity:ft.severity,title:ft.title,onRemove:()=>hn(ft.id),elevated:!0,children:_n&&(0,n.jsxs)("div",{className:dn.wrapper,children:[(0,n.jsx)("span",{children:ft.component||ft.text}),ft.traceId&&(0,n.jsxs)("span",{className:dn.trace,children:["Trace ID: ",ft.traceId]})]})})}function qr(ft){return{wrapper:(0,O.css)({display:"flex",flexDirection:"column"}),trace:(0,O.css)({fontSize:ft.typography.pxToRem(10)})}}function po(){const ft=(0,je.useSelector)(ss=>(0,pr.fX)(ss.appNotifications)),hn=(0,je.useDispatch)(),dn=(0,F.of)(yo);(0,l.useEffect)(()=>{Fe.A.on(na.r1.alertWarning,ss=>hn((0,wa.dx)((0,Ma.q8)(...ss)))),Fe.A.on(na.r1.alertSuccess,ss=>hn((0,wa.dx)((0,Ma.tZ)(...ss)))),Fe.A.on(na.r1.alertError,ss=>hn((0,wa.dx)((0,Ma.gi)(...ss)))),Fe.A.on(na.r1.alertInfo,ss=>hn((0,wa.dx)((0,Ma.Cf)(...ss))))},[hn]);const _n=ss=>{hn((0,wa.Do)(ss))};return(0,n.jsx)("div",{className:dn.wrapper,children:(0,n.jsx)(u.B,{direction:"column",children:ft.map((ss,Yn)=>(0,n.jsx)(go,{appNotification:ss,onClearNotification:_n},`${ss.id}-${Yn}`))})})}function yo(ft){return{wrapper:(0,O.css)({label:"app-notifications-list",zIndex:ft.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var hi=e(96374);function Di(ft){const[hn,dn]=(0,l.useState)({component:null,props:{}}),_n=(0,l.useMemo)(()=>{function ss(Bs,Ns){dn({component:Bs,props:Ns})}function Yn(){dn({component:null,props:{}})}return{component:hn.component,props:{...hn.props,isOpen:!0,onDismiss:Yn},showModal:ss,hideModal:Yn}},[hn]);return(0,l.useEffect)(()=>{Fe.A.subscribe(_e.S8,({payload:Yn})=>{dn({component:Yn.component,props:Yn.props})}),Fe.A.subscribe(_e.bY,Yn=>{Rr(Yn,dn)});let ss="";o.Ny.getHistory().listen(Yn=>{Yn.pathname!==ss&&dn({component:null,props:{}}),ss=Yn.pathname})},[]),(0,n.jsx)(m.wE.Provider,{value:_n,children:ft.children})}function Rr({payload:ft},hn){const{confirmText:dn,onConfirm:_n=()=>{},onDismiss:ss,text2:Yn,altActionText:Bs,onAltAction:Ns,noText:Ps,text:za,text2htmlBind:Pa,yesText:fa="Yes",icon:_a,title:da="Confirm",yesButtonVariant:ta}=ft,Ba=()=>hn({component:null,props:{}}),Ea={confirmText:fa,confirmButtonVariant:ta,confirmationText:dn,icon:_a,title:da,body:za,description:Yn&&Pa?$r.sQ.sanitize(Yn):Yn,isOpen:!0,dismissText:Ps,onConfirm:()=>{_n(),Ba()},onDismiss:()=>{ss?.(),Ba()},onAlternative:Ns?()=>{Ns(),Ba()}:void 0,alternativeText:Bs};hn({component:hi.u,props:Ea})}var tr=e(66899),Vr=e.n(tr),io=e(64388),ja=e(52446),Xo=e(69444);function Ti({error:ft,errorInfo:hn}){const dn=(0,i.zy)(),_n=ft?.name==="ChunkLoadError",ss=(0,F.of)(Rt);return(0,l.useEffect)(()=>{_n&&dn.search.indexOf("chunkNotFound")===-1&&(window.location.href=Za.I.getUrlForPartial(dn,{chunkNotFound:!0}))},[dn,_n]),(0,n.jsx)(Xo.Y,{navId:"error",layout:io.k.Canvas,children:(0,n.jsxs)("div",{className:ss.container,children:[_n&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"Unable to find application file"}),(0,n.jsx)("br",{}),(0,n.jsx)("h2",{className:"page-heading",children:"Grafana has likely been updated. Please try reloading the page."}),(0,n.jsx)("br",{}),(0,n.jsx)(U.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:"Reload"}),(0,n.jsx)(ja.D,{title:"Error details",error:ft,errorInfo:hn})]}),!_n&&(0,n.jsx)(ja.D,{title:"An unexpected error happened",error:ft,errorInfo:hn})]})})}const Rt=ft=>({container:(0,O.css)({width:"500px",margin:ft.spacing(8,"auto")})});function tn(){const ft=(0,F.of)(qa);return(0,n.jsx)("div",{className:ft.container,"aria-live":"polite",role:"status","aria-label":(0,te.t)("bouncing-loader.label","Loading"),children:(0,n.jsx)("div",{className:ft.bounce,children:(0,n.jsx)("img",{alt:"",src:"public/img/grafana_icon.svg",className:ft.logo})})})}const Mn=(0,O.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),zn=(0,O.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),Es=(0,O.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),Ts=(0,O.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),qa=ft=>({container:(0,O.css)({opacity:0,[ft.transitions.handleMotion("no-preference")]:{animationName:Mn,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[ft.transitions.handleMotion("reduce")]:{animationName:zn,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,O.css)({textAlign:"center",[ft.transitions.handleMotion("no-preference")]:{animationName:Es,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,O.css)({display:"inline-block",[ft.transitions.handleMotion("no-preference")]:{animationName:Ts,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function aa(){const ft=(0,F.of)(ar);return(0,n.jsx)("div",{className:(0,O.cx)({[ft.loadingPage]:!c.$.featureToggles.bodyScrolling,[ft.loadingPageBodyScrolling]:c.$.featureToggles.bodyScrolling}),children:(0,n.jsx)(tn,{})})}const ar=ft=>({loadingPage:(0,O.css)({backgroundColor:ft.colors.background.primary,height:"100%",flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"}),loadingPageBodyScrolling:(0,O.css)({backgroundColor:ft.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function Aa(ft){const{chrome:hn,keybindings:dn}=(0,w.Il)();return hn.setMatchedRoute(ft.route),(0,l.useLayoutEffect)(()=>{dn.clearAndInitGlobalBindings(ft.route)},[dn,ft.route]),(0,l.useEffect)(()=>(Dr(ft.route),ao(),(0,o.Lc)("GrafanaRoute",!1,"Mounted",ft.match),()=>{(0,o.Lc)("GrafanaRoute",!1,"Unmounted",ft.route),Dr(ft.route,!0)}),[]),(0,l.useEffect)(()=>{ao(),(0,d.Jy)(),(0,o.Lc)("GrafanaRoute",!1,"Updated",ft)}),(0,o.Lc)("GrafanaRoute",!1,"Rendered",ft.route),(0,n.jsx)(a.tH,{children:({error:_n,errorInfo:ss})=>_n?(0,n.jsx)(Ti,{error:_n,errorInfo:ss}):(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)(aa,{}),children:(0,n.jsx)(ft.route.component,{...ft,queryParams:(0,o.SE)(ft.location.search)})})})}function yr(ft){return ft.pageClass?ft.pageClass.split(" "):[]}function Dr(ft,hn=!1){for(const dn of yr(ft))hn?document.body.classList.remove(dn):document.body.classList.add(dn)}function ao(){document.body.classList.remove("sidemenu-open--xs");const ft=document.getElementById("tooltip");ft?.parentElement?.removeChild(ft);const hn=document.querySelectorAll(".tooltip");for(let dn=0;dn<hn.length;dn++){const _n=hn[dn];_n.parentElement?.removeChild(_n)}for(const dn of Vr().drops)dn.destroy()}var Qr=e(96378),Uo=e(62625),Co=e(78731),lo=e(3911);class xo extends l.PureComponent{constructor(){super(...arguments),this.styles=Yr(c.$.theme2),this.state={},this.initListener=()=>{const hn=(0,Co.oF)();hn&&(this.subscription=hn.getConnectionState().subscribe({next:dn=>{this.setState({show:!dn})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:hn}=this.state;return hn?!J.TP.isSignedIn||!c.$.liveEnabled||J.TP.user.orgRole===Uo.X.None?null:(0,n.jsx)("div",{className:this.styles.foot,children:(0,n.jsx)(oo.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})}):null}}const Yr=(0,lo.N)(ft=>({foot:(0,O.css)({position:"fixed",bottom:0,left:0,right:0,zIndex:1e4,cursor:"wait",margin:ft.spacing(2)}),warn:(0,O.css)({maxWidth:"400px",margin:"auto"})}));let zr=[],qo=[];function Mi(ft){zr.push(ft)}function _i(ft){qo.push(ft)}class Hi extends l.Component{constructor(hn){super(hn),this.renderRoute=dn=>{const _n=dn.roles?dn.roles():[];return(0,n.jsx)(g.CompatRoute,{exact:dn.exact===void 0?!0:dn.exact,sensitive:dn.sensitive===void 0?!1:dn.sensitive,path:dn.path,render:ss=>_n?.length&&!_n.some(Yn=>J.TP.hasRole(Yn))?(0,n.jsx)(i.rd,{to:"/"}):(0,n.jsx)(Aa,{...ss,route:dn})},dn.path)},this.state={}}async componentDidMount(){await L(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return(0,n.jsx)(i.dO,{children:(0,x.kz)().map(hn=>this.renderRoute(hn))})}render(){const{app:hn}=this.props,{ready:dn}=this.state;(0,o.Lc)("AppWrapper",!1,"rendering");const _n=ss=>{(0,d.rR)("command_palette_action_selected",{actionId:ss.id,actionName:ss.name})};return(0,n.jsx)(r.Provider,{store:f.M_,children:(0,n.jsx)(a.Xw,{style:"page",children:(0,n.jsx)(w.YE.Provider,{value:hn.context,children:(0,n.jsx)(Qr.N,{value:c.$.theme2,children:(0,n.jsx)(s.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:_n}},children:(0,n.jsx)(i.Ix,{history:o.Ny.getHistory(),children:(0,n.jsx)(o._K,{service:o.Ny,children:(0,n.jsx)(g.CompatRouter,{children:(0,n.jsxs)(Di,{children:[(0,n.jsx)(p.k,{}),(0,n.jsx)("div",{className:"grafana-app",children:(0,n.jsxs)(Os,{children:[(0,n.jsx)(E,{}),(0,n.jsx)(po,{}),(0,n.jsxs)(u.B,{gap:0,grow:1,direction:"column",children:[qo.map((ss,Yn)=>(0,n.jsx)(ss,{},Yn.toString())),dn&&this.renderRoutes()]}),zr.map((ss,Yn)=>(0,n.jsx)(ss,{},Yn.toString()))]})}),(0,n.jsx)(xo,{}),(0,n.jsx)(m.EO,{}),(0,n.jsx)(v.qB,{})]})})})})})})})})})}}},91950:(k,A,e)=>{"use strict";e.d(A,{A:()=>l,f:()=>i});var n=e(2543),s=e.n(n);class l{constructor(o){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",o){if(o.columns)for(const d of o.columns)this.addColumn(d);if(o.rows)for(const d of o.rows)this.addRow(d)}}sort(o){o.col===null||o.col===void 0||this.columns.length<=o.col||(this.rows.sort((d,c)=>(d=d[o.col],c=c[o.col],+(d==null)-+(c==null)||+(d>c)||-(d<c))),o.desc&&this.rows.reverse(),this.columns[o.col].sort=!0,this.columns[o.col].desc=o.desc)}addColumn(o){this.columnMap[o.text]||(this.columns.push(o),this.columnMap[o.text]=o)}addRow(o){this.rows.push(o)}}function r(g,o,d){let c=!1;for(let a=0;a<g.length;a++)if(o[a]!==void 0&&d[a]!==void 0){if(o[a]!==d[a])return!1}else(o[a]===void 0||d[a]===void 0)&&(c=!0);return c}function i(g,...o){const d=g||new l;if(arguments.length===1)return d;if(arguments.length===2)return d.columns=o[0].hasOwnProperty("columns")?[...o[0].columns]:[],d.rows=o[0].hasOwnProperty("rows")?[...o[0].rows]:[],d;const c=o.filter(f=>!!f.columns),a={},p=c.slice().reduce((f,E)=>(E.columns.forEach(h=>{const{text:y}=h;a[y]===void 0&&(a[y]=f.length,f.push(h))}),f),[]),u=c.map(f=>f.columns.map(E=>a[E.text])),m=c.reduce((f,E,h)=>{const y=u[h];return E.rows.forEach(b=>{const D=[];y.forEach((P,C)=>{D[P]=b[C]}),f.push(D)}),f},[]),v={},x=m.reduce((f,E,h)=>{if(!v[h]){let y=h+1;for(;y<m.length;){const b=(0,n.findIndex)(m,D=>r(p,E,D),y);if(b>-1){const D=m[b];for(let P=0;P<p.length;P++)E[P]===void 0&&D[P]!==void 0&&(E[P]=D[P]);v[b]=D,y=b+1}else break}f.push(E)}return f},[]);return d.columns=p,d.rows=x,d}},97007:(k,A,e)=>{"use strict";e.d(A,{N:()=>s});var n=e(65307);const s=(0,n.VP)("core/cleanUpState")},82467:(k,A,e)=>{"use strict";e.d(A,{Do:()=>n.Do,Vz:()=>s.Vz,YA:()=>s.YA,dx:()=>n.dx});var n=e(16001),s=e(28215)},28138:(k,A,e)=>{"use strict";e.d(A,{A:()=>l,l:()=>s});var n=e(18226);const s=new n.o,l=s},52487:(k,A,e)=>{"use strict";e.d(A,{x:()=>w});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(40845),g=e(68402),o=e(90613),d=e(94753),c=e(55852),a=e(9025),p=e(8484),u=e(27677),m=e(43907),v=e(67061),x=e(90182),f=e(25469),E=e(17172);class h extends r.Component{constructor(te){super(te),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,l.debounce)(this.search,300,{leading:!0,trailing:!0})}search(te){return this.setState({isLoading:!0}),(0,l.isNil)(te)&&(te=""),(0,E.AI)().get("/api/serviceaccounts/search").then(H=>H.serviceAccounts.map(se=>({id:se.id,value:se.id,label:se.login,imgUrl:se.avatarUrl,login:se.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:te,onSelected:H,inputId:se}=this.props,{isLoading:ne}=this.state;return(0,n.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,n.jsx)(x.DW,{isClearable:!0,className:te,inputId:se,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:H,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"})})}}var y=e(98742);class b extends r.Component{constructor(te){super(te),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,l.debounce)(this.search,300,{leading:!0,trailing:!0})}search(te){return this.setState({isLoading:!0}),(0,l.isNil)(te)&&(te=""),(0,E.AI)().get(`/api/org/users/lookup?query=${te}&limit=100`).then(H=>H.map(se=>({id:se.userId,value:se.userId,label:se.login,imgUrl:se.avatarUrl,login:se.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:te,onSelected:H,inputId:se}=this.props,{isLoading:ne}=this.state;return(0,n.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,n.jsx)(x.DW,{isClearable:!0,className:te,inputId:se,isLoading:ne,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:H,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"})})}}var D=e(24897),P=(G=>(G.None="None",G.Team="Team",G.User="User",G.ServiceAccount="ServiceAccount",G.BuiltInRole="builtInRole",G))(P||{});const C=({title:G=(0,p.t)("access-control.add-permission.title","Add permission for"),permissions:te,assignments:H,onAdd:se,onCancel:ne})=>{const[le,_]=(0,r.useState)(P.None),[Q,ae]=(0,r.useState)(0),[oe,J]=(0,r.useState)(0),[ee,de]=(0,r.useState)(""),[xe,re]=(0,r.useState)(""),ue=(0,r.useMemo)(()=>{const ge=[];return H.users&&ge.push({value:P.User,label:(0,p.t)("access-control.add-permission.user-label","User")}),H.serviceAccounts&&ge.push({value:P.ServiceAccount,label:(0,p.t)("access-control.add-permission.serviceaccount-label","Service Account")}),H.teams&&ge.push({value:P.Team,label:(0,p.t)("access-control.add-permission.team-label","Team")}),H.builtInRoles&&ge.push({value:P.BuiltInRole,label:(0,p.t)("access-control.add-permission.role-label","Role")}),ge},[H]);(0,r.useEffect)(()=>{te.length>0&&re(te[0])},[te]);const Te=()=>le===P.Team&&Q>0||le===P.User&&oe>0||le===P.ServiceAccount&&oe>0||P.BuiltInRole&&D.XT.hasOwnProperty(ee);return(0,n.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,n.jsx)(f.J,{onClick:ne}),(0,n.jsx)("h5",{children:G}),(0,n.jsx)("form",{name:"addPermission",onSubmit:ge=>{ge.preventDefault(),se({userId:oe,teamId:Q,builtInRole:ee,permission:xe,target:le})},children:(0,n.jsxs)(v.B,{gap:1,direction:"row",children:[(0,n.jsx)(x.l6,{"aria-label":"Role to add new permission to",value:le,options:ue,onChange:ge=>_(ge.value),disabled:ue.length===0,width:"auto"}),le===P.User&&(0,n.jsx)(b,{onSelected:ge=>J(ge?.value||0)}),le===P.ServiceAccount&&(0,n.jsx)(h,{onSelected:ge=>J(ge?.value||0)}),le===P.Team&&(0,n.jsx)(y.e,{onSelected:ge=>ae(ge.value?.id||0)}),le===P.BuiltInRole&&(0,n.jsx)(x.l6,{"aria-label":"Built-in role picker",options:Object.values(D.XT).filter(ge=>ge!==D.XT.None).map(ge=>({value:ge,label:ge})),onChange:ge=>de(ge.value||""),width:"auto"}),(0,n.jsx)(x.l6,{"aria-label":"Permission Level",width:"auto",value:te.find(ge=>ge===xe),options:te.map(ge=>({label:ge,value:ge})),onChange:ge=>re(ge.value||"")}),(0,n.jsx)(c.$n,{type:"submit",disabled:!Te(),children:(0,n.jsx)(p.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var M=e(56034),I=e(14578);const R=({item:G,permissionLevels:te,canSet:H,onRemove:se,onChange:ne})=>{const le=(0,i.of)(j);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:T(G)}),(0,n.jsx)("td",{children:L(G)}),(0,n.jsx)("td",{children:G.isInherited&&(0,n.jsx)("em",{className:le.inherited,children:"Inherited from folder"})}),(0,n.jsx)("td",{children:(0,n.jsx)(x.l6,{disabled:!H||!G.isManaged,onChange:_=>ne(G,_.value),value:te.find(_=>_===G.permission),options:te.map(_=>({value:_,label:_}))})}),(0,n.jsx)("td",{children:G.warning?(0,n.jsx)(M.m,{content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.a,{marginBottom:1,children:G.warning}),O(G)]}),children:(0,n.jsx)(I.I,{name:"exclamation-triangle",className:le.warning})}):(0,n.jsx)(M.m,{content:O(G),children:(0,n.jsx)(I.I,{name:"info-circle"})})}),(0,n.jsx)("td",{children:G.isManaged?(0,n.jsx)(c.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!H,onClick:()=>se(G),"aria-label":`Remove permission for ${S(G)}`}):(0,n.jsx)(M.m,{content:G.isInherited?"Inherited Permission":"Provisioned Permission",children:(0,n.jsx)(c.$n,{size:"sm",icon:"lock","aria-label":"Locked permission indicator"})})})]})},T=G=>G.teamId?(0,n.jsx)("img",{className:"filter-table__avatar",src:G.teamAvatarUrl,alt:`Avatar for team ${G.teamId}`}):G.userId?(0,n.jsx)("img",{className:"filter-table__avatar",src:G.userAvatarUrl,alt:`Avatar for user ${G.userId}`}):(0,n.jsx)(I.I,{size:"xl",name:"shield"}),S=G=>G.userId?G.userLogin:G.teamId?G.team:G.builtInRole,L=G=>G.userId?(0,n.jsxs)("span",{children:[G.userLogin," "]},"name"):G.teamId?(0,n.jsxs)("span",{children:[G.team," "]},"name"):G.builtInRole?(0,n.jsxs)("span",{children:[G.builtInRole," "]},"name"):(0,n.jsx)("span",{},"name"),O=G=>`Actions: ${[...new Set(G.actions)].sort().join(" ")}`,j=G=>({warning:(0,s.css)({color:G.colors.warning.main}),inherited:(0,s.css)({color:G.colors.text.secondary,flexWrap:"nowrap"})}),N=({title:G,items:te,compareKey:H,permissionLevels:se,canSet:ne,onRemove:le,onChange:_})=>{const Q=(0,r.useMemo)(()=>{const ae={};for(let oe of te){const J=oe[H];if(!ae[J]){ae[J]=oe;continue}if(oe.actions.length>ae[J].actions.length){ae[J]=oe;continue}oe.actions.length===ae[J].actions.length&&!oe.isInherited&&(ae[J]=oe)}return Object.keys(ae).map(oe=>ae[oe])},[te,H]);return Q.length===0?null:(0,n.jsx)("div",{children:(0,n.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{children:G}),(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"40%"},children:(0,n.jsx)(p.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"1%"}})]})}),(0,n.jsx)("tbody",{children:Q.map((ae,oe)=>(0,n.jsx)(R,{item:ae,onRemove:le,onChange:_,canSet:ne,permissionLevels:se},`${oe}-${ae.userId}`))})]})})},F="",U={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},w=({title:G=(0,p.t)("access-control.permissions.title","Permissions"),buttonLabel:te=(0,p.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:H=(0,p.t)("access-control.permissions.no-permissions","There are no permissions"),resource:se,resourceId:ne,canSetPermissions:le,addPermissionTitle:_,getWarnings:Q,epilogue:ae})=>{const oe=(0,i.of)(q),[J,ee]=(0,r.useState)(!1),[de,xe]=(0,r.useState)([]),[re,ue]=(0,r.useState)(U),Te=(0,r.useCallback)(async()=>{let Fe=await K(se,ne);Q&&(Fe=Q(Fe)),xe(Fe)},[se,ne,Q]);(0,r.useEffect)(()=>{B(se).then(Fe=>(ue(Fe),Te()))},[se,ne,Te]);const ge=Fe=>{let at=null;Fe.target===P.User||Fe.target===P.ServiceAccount?at=W(se,ne,Fe.userId,Fe.permission):Fe.target===P.Team?at=z(se,ne,Fe.teamId,Fe.permission):Fe.target===P.BuiltInRole&&(at=Y(se,ne,Fe.builtInRole,Fe.permission)),at!==null&&at.then(Te)},Oe=Fe=>{let at=null;Fe.userId?at=W(se,ne,Fe.userId,F):Fe.teamId?at=z(se,ne,Fe.teamId,F):Fe.isServiceAccount&&Fe.userId?at=W(se,ne,Fe.userId,F):Fe.builtInRole&&(at=Y(se,ne,Fe.builtInRole,F)),at!==null&&at.then(Te)},Ue=(Fe,at)=>{Fe.permission!==at&&(Fe.userId?ge({permission:at,userId:Fe.userId,target:P.User}):Fe.isServiceAccount?ge({permission:at,userId:Fe.userId,target:P.User}):Fe.teamId?ge({permission:at,teamId:Fe.teamId,target:P.Team}):Fe.builtInRole&&ge({permission:at,builtInRole:Fe.builtInRole,target:P.BuiltInRole}))},Xe=(0,r.useMemo)(()=>(0,l.sortBy)(de.filter(Fe=>Fe.teamId),["team","isManaged"]),[de]),we=(0,r.useMemo)(()=>(0,l.sortBy)(de.filter(Fe=>Fe.userId&&!Fe.isServiceAccount),["userLogin","isManaged"]),[de]),qe=(0,r.useMemo)(()=>(0,l.sortBy)(de.filter(Fe=>Fe.userId&&Fe.isServiceAccount),["userLogin","isManaged"]),[de]),We=(0,r.useMemo)(()=>(0,l.sortBy)(de.filter(Fe=>Fe.builtInRole),["builtInRole","isManaged"]),[de]),Ce=(0,p.t)("access-control.permissions.role","Role"),je=(0,p.t)("access-control.permissions.user","User"),Ke=(0,p.t)("access-control.permissions.serviceaccount","Service Account"),_e=(0,p.t)("access-control.permissions.team","Team");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[le&&se==="folders"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,n.jsx)(m.x,{selectedItems:{folder:{[ne]:!0},dashboard:{},panel:{},$all:!1}}),(0,n.jsx)(g.$,{v:2})]}),de.length===0&&(0,n.jsx)(o.a,{children:(0,n.jsx)(d.E,{children:H})}),(0,n.jsx)(N,{title:Ce,items:We,compareKey:"builtInRole",permissionLevels:re.permissions,onChange:Ue,onRemove:Oe,canSet:le}),(0,n.jsx)(N,{title:je,items:we,compareKey:"userLogin",permissionLevels:re.permissions,onChange:Ue,onRemove:Oe,canSet:le}),(0,n.jsx)(N,{title:Ke,items:qe,compareKey:"userLogin",permissionLevels:re.permissions,onChange:Ue,onRemove:Oe,canSet:le}),(0,n.jsx)(N,{title:_e,items:Xe,compareKey:"team",permissionLevels:re.permissions,onChange:Ue,onRemove:Oe,canSet:le}),le&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$n,{className:oe.addPermissionButton,variant:"primary",onClick:()=>ee(!0),icon:"plus",children:te},"add-permission"),(0,n.jsx)(a.a,{in:J,children:(0,n.jsx)(C,{title:_,onAdd:ge,permissions:re.permissions,assignments:re.assignments,onCancel:()=>ee(!1)})})]})]}),ae&&ae(de)]})},B=async G=>{try{return await(0,u.AI)().get(`/api/access-control/${G}/description`)}catch(te){return console.error("failed to load resource description: ",te),U}},K=(G,te)=>(0,u.AI)().get(`/api/access-control/${G}/${te}`),W=(G,te,H,se)=>X(G,te,"users",H,se),z=(G,te,H,se)=>X(G,te,"teams",H,se),Y=(G,te,H,se)=>X(G,te,"builtInRoles",H,se),X=(G,te,H,se,ne)=>(0,u.AI)().post(`/api/access-control/${G}/${te}/${H}/${se}`,{permission:ne}),q=G=>({breakdown:(0,s.css)({...G.typography.bodySmall,color:G.colors.text.secondary,marginBottom:G.spacing(2)}),addPermissionButton:(0,s.css)({marginBottom:G.spacing(2)})})},9025:(k,A,e)=>{"use strict";e.d(A,{a:()=>o});var n=e(74848),s=e(96540),l=e(22669);const r="200px",i=200,g={transition:`max-height ${i}ms ease-in-out`,overflow:"hidden"},o=({children:d,in:c,maxHeight:a=r,style:p=g})=>{const u=(0,s.useRef)(null),m={exited:{maxHeight:0},entering:{maxHeight:a},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,n.jsx)(l.Ay,{in:c,timeout:i,nodeRef:u,children:v=>(0,n.jsx)("div",{style:{...p,...m[v]},ref:u,children:d})})}},70944:(k,A,e)=>{"use strict";e.d(A,{dk:()=>x,hE:()=>m,k0:()=>v});var n=e(24120),s=e(49426),l=e(64388),r=e(26272),i=e(32264),g=e(14110),o=e(39601),d=e(28138),c=e(8484),a=e(33390);function p(E,h){if(E===h)return!0;if(!(E instanceof Object)||!(h instanceof Object))return!1;const y=Object.keys(E),b=y.length;for(let D=0;D<b;D++)if(!(y[D]in h))return!1;for(let D=0;D<b;D++)if(E[y[D]]!==h[y[D]])return!1;return b===Object.keys(h).length}var u=e(31678);const m="grafana.navigation.docked",v="grafana.navigation.open";class x{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=i.$.theme2.breakpoints.values.xl&&a.A.getBool(m,window.innerWidth>=i.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new s.t({chromeless:!0,sectionNav:{node:{text:(0,c.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:a.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&a.A.getBool(v,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:l.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=h=>{const y=this.state.getValue().returnToPrevious;(0,g.rR)("grafana_return_to_previous_button_created",{page:h.href,previousPage:y?.href}),this.update({returnToPrevious:h}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(h))},this.clearReturnToPrevious=h=>{const y=this.state.getValue().returnToPrevious;y&&(0,g.rR)("grafana_return_to_previous_button_dismissed",{action:h,page:y.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=h=>{const{megaMenuDocked:y}=this.state.getValue();y&&a.A.set(v,h),(0,g.rR)("grafana_mega_menu_open",{state:h}),this.update({megaMenuOpen:h})},this.setMegaMenuDocked=(h,y=!0)=>{y&&a.A.set(m,h),(0,g.rR)("grafana_mega_menu_docked",{state:h}),this.update({megaMenuDocked:h})},this.onToggleSearchBar=()=>{const{searchBarHidden:h,kioskMode:y}=this.state.getValue(),b=!h;a.A.set(this.searchBarStorageKey,b),y&&o.Ny.partial({kiosk:null}),this.update({searchBarHidden:b,kioskMode:null})},this.onToggleKioskMode=()=>{const h=this.getNextKioskMode();this.update({kioskMode:h}),o.Ny.partial({kiosk:this.getKioskUrlValue(h)})}}setMatchedRoute(h){this.currentRoute!==h&&(this.currentRoute=h,this.routeChangeHandled=!1)}update(h){const y=this.state.getValue(),b={...y};this.routeChangeHandled||(b.actions=void 0,b.pageNav=void 0,b.sectionNav={node:{text:(0,c.t)("nav.home.title","Home")},main:{text:""}},b.chromeless=this.currentRoute?.chromeless,b.layout=l.k.Standard,this.routeChangeHandled=!0),Object.assign(b,h),b.chromeless=b.kioskMode===u.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(b,y)||this.state.next(b)}ignoreStateUpdate(h,y){return!!(p(h,y)||(h.sectionNav!==y.sectionNav||h.pageNav!==y.pageNav)&&h.actions===y.actions&&h.layout===y.layout&&f(h.sectionNav.node,y.sectionNav.node)&&f(h.pageNav,y.pageNav))}useState(){return(0,n.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),o.Ny.partial({kiosk:null})}setKioskModeFromUrl(h){let y;switch(h){case"tv":y=u.KioskMode.TV;break;case"1":case!0:y=u.KioskMode.Full}y&&y!==this.state.getValue().kioskMode&&this.update({kioskMode:y})}getKioskUrlValue(h){switch(h){case u.KioskMode.TV:return"tv";case u.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:h,searchBarHidden:y}=this.state.getValue();return y||h===u.KioskMode.TV?(d.A.emit(r.r1.alertInfo,[(0,c.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),u.KioskMode.Full):h?null:u.KioskMode.TV}}function f(E,h){if(E===h)return!0;const y=E?.children?.find(D=>D.active),b=h?.children?.find(D=>D.active);return E?.text===h?.text&&E?.url===h?.url&&y?.url===b?.url&&f(E?.parentItem,h?.parentItem)}},75269:(k,A,e)=>{"use strict";e.d(A,{H:()=>l});var n=e(96540),s=e(76888);const l=n.memo(({actions:r})=>{const{chrome:i}=(0,s.Il)();return(0,n.useLayoutEffect)(()=>{i.update({actions:r})}),null});l.displayName="TopNavUpdate"},10804:(k,A,e)=>{"use strict";e.d(A,{K:()=>r});var n=e(74848),s=e(32196),l=e(40845);function r({className:g,leftActionsSeparator:o}){const d=(0,l.of)(i);return o?(0,n.jsx)("div",{className:(0,s.cx)(g,d.leftActionsSeparator)}):(0,n.jsx)("div",{className:(0,s.cx)(g,d.line)})}const i=g=>({leftActionsSeparator:(0,s.css)({display:"flex",flexGrow:1}),line:(0,s.css)({width:1,backgroundColor:g.colors.border.medium,height:24})})},57571:(k,A,e)=>{"use strict";e.d(A,{l:()=>n});const n=40},19361:(k,A,e)=>{"use strict";e.d(A,{M:()=>c});var n=e(74848),s=e(32196),l=e(23596),r=e(40845);const i=({className:a,logo:p})=>(0,n.jsx)("img",{className:a,src:`${p||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),g=({className:a,children:p})=>{const u=(0,r.$j)(),m=(0,s.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${u.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[u.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,n.jsx)("div",{className:(0,s.cx)(m,a),children:p})},o=({className:a})=>(0,n.jsx)("img",{className:a,src:"public/img/grafana_icon.svg",alt:"Grafana"}),d=()=>{const a=(0,r.$j)();return(0,s.css)({background:l.MV.alpha(a.colors.background.primary,.7),backgroundSize:"cover"})};class c{static{this.LoginLogo=i}static{this.LoginBackground=g}static{this.MenuLogo=o}static{this.LoginBoxBackground=d}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},3984:(k,A,e)=>{"use strict";e.d(A,{Z:()=>n});function n(s,l,r){const i=[];let g=!1,o;function d(c,a=!1){if(g)return;const p=c.url?.split("?")??["",""];let u=p[0];const m=new URLSearchParams(p[1]);if(m.has("editview")&&(u+=`?editview=${m.get("editview")}`),r&&u===r.url){i.unshift({text:r.text,href:c.url??""}),g=!0;return}const v=u.length>0&&o===u;if(o=u,!c.hideFromBreadcrumbs&&!(a&&v)){const f=c.children?.findIndex(E=>E.active)??-1;if(f>0){const E=c.children?.[f];E&&i.unshift({text:E.text,href:E.url??""})}i.unshift({text:c.text,href:c.url??""})}c.parentItem&&d(c.parentItem)}return l&&d(l),d(s,!0),i}},25469:(k,A,e)=>{"use strict";e.d(A,{J:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(29158);const i=({onClick:o,"aria-label":d,style:c})=>{const a=(0,l.of)(g);return(0,n.jsx)(r.K,{"aria-label":d??"Close",className:a,name:"times",onClick:o,style:c,tooltip:"Close"})},g=o=>(0,s.css)({position:"absolute",right:o.spacing(.5),top:o.spacing(1)})},27921:(k,A,e)=>{"use strict";e.d(A,{A:()=>s});var n=e(96540);const s=l=>(0,n.lazy)(l)},7521:(k,A,e)=>{"use strict";e.d(A,{A:()=>p});var n=e(74848),s=e(32196),l=e(13544),r=e(14578),i=e(42418),g=e(55852),o=e(76442);const d=(0,s.css)({textAlign:"center"}),c=(0,s.css)({maxWidth:"700px",margin:"0 auto"}),p=({title:u,buttonIcon:m,buttonLink:v,buttonTitle:x,buttonDisabled:f,onClick:E,proTip:h,proTipLink:y,proTipLinkTitle:b,proTipTarget:D,infoBox:P,infoBoxTitle:C})=>{const M=()=>(0,n.jsxs)(n.Fragment,{children:[h?(0,n.jsxs)("span",{children:[(0,n.jsx)(r.I,{name:"rocket"}),(0,n.jsxs)(n.Fragment,{children:[" ProTip: ",h," "]}),y&&(0,n.jsx)("a",{href:y,target:D,className:"text-link",children:b})]},"proTipFooter"):"",P?(0,n.jsx)(i.F,{severity:"info",title:C??"",className:c,children:(0,n.jsx)("div",{dangerouslySetInnerHTML:P})}):""]}),I=M()?"":(0,s.css)({marginBottom:"20px"}),R=v?g.z9:g.$n,T=(0,n.jsx)(R,{size:"lg",onClick:E,href:v,icon:m,className:I,"data-testid":l.Tp.components.CallToActionCard.buttonV2(x),disabled:f,children:x});return(0,n.jsx)(o.c,{className:d,message:u,footer:M(),callToActionElement:T})}},38645:(k,A,e)=>{"use strict";e.d(A,{DH:()=>p,Dd:()=>d,wi:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(14578),o=e(8484);let d=()=>[{target:"_blank",id:"documentation",text:(0,o.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,o.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,o.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function c(x){return{hasReleaseNotes:!0,isBeta:x.includes("-beta")}}function a(x){const{buildInfo:f,licenseInfo:E}=r.$,h=[],y=E.stateInfo?` (${E.stateInfo})`:"";if(x||h.push({target:"_blank",id:"license",text:`${f.edition}${y}`,url:E.licenseUrl}),f.hideVersion)return h;const{hasReleaseNotes:b}=c(f.version);return h.push({target:"_blank",id:"version",text:f.versionString,url:b?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),f.hasUpdate&&h.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),h}function p(x){d=x}const u=(0,l.memo)(({customLinks:x,hideEdition:f})=>{const E=(x||d()).concat(a(f)),h=(0,i.of)(v);return(0,n.jsx)("footer",{className:h.footer,children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("ul",{className:h.list,children:E.map((y,b)=>(0,n.jsx)("li",{className:h.listItem,children:(0,n.jsx)(m,{item:y})},b))})})})});u.displayName="Footer";function m({item:x}){const f=x.url?(0,n.jsx)("a",{href:x.url,target:x.target,rel:"noopener noreferrer",id:x.id,children:x.text}):x.text;return(0,n.jsxs)(n.Fragment,{children:[x.icon&&(0,n.jsx)(g.I,{name:x.icon})," ",f]})}const v=x=>({footer:(0,s.css)({...x.typography.bodySmall,color:x.colors.text.primary,display:"block",padding:x.spacing(2,0),position:"relative",width:"98%","a:hover":{color:x.colors.text.maxContrast,textDecoration:"underline"},[x.breakpoints.down("md")]:{display:"none"}}),list:(0,s.css)({listStyle:"none"}),listItem:(0,s.css)({display:"inline-block","&:after":{content:"' | '",padding:x.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},53153:(k,A,e)=>{"use strict";e.d(A,{S:()=>x});var n=e(74848),s=e(96540),l=e(49785),r=e(13544),i=e(32264),g=e(40845),o=e(42418),d=e(88575),c=e(67061),a=e(55852),p=e(56034),u=e(4691),m=e(78361),v=e(35043);const x=({onSubmit:f,onSkip:E,showDefaultPasswordWarning:h})=>{const y=(0,g.of)(u.$),[b,D]=(0,s.useState)(!1),[P,C]=(0,s.useState)(!0),{handleSubmit:M,register:I,getValues:R,formState:{errors:T},watch:S}=(0,l.mN)({defaultValues:{newPassword:"",confirmNew:""}}),L=S("newPassword"),O=j=>{f(j.newPassword)};return(0,n.jsxs)("form",{onSubmit:M(O),children:[h&&(0,n.jsx)(o.F,{severity:"info",title:"Continuing to use the default password exposes you to security risks."}),(0,n.jsx)(d.D,{label:"New password",invalid:!!T.newPassword,error:T?.newPassword?.message,children:(0,n.jsx)(m.s,{onFocus:()=>D(!0),...I("newPassword",{required:"New Password is required",onBlur:()=>C(!1),validate:{strongPasswordValidationRegister:v.DP}}),id:"new-password",autoFocus:!0,autoComplete:"new-password"})}),b&&(0,n.jsx)(v.zJ,{pristine:P,password:L,strongPasswordValidations:v.NQ}),(0,n.jsx)(d.D,{label:"Confirm new password",invalid:!!T.confirmNew,error:T?.confirmNew?.message,children:(0,n.jsx)(m.s,{...I("confirmNew",{required:"Confirmed Password is required",validate:j=>j===R().newPassword||"Passwords must match!"}),id:"confirm-new-password",autoComplete:"new-password"})}),(0,n.jsxs)(c.B,{direction:"column",children:[(0,n.jsx)(a.$n,{type:"submit",className:y.submitButton,children:"Submit"}),!i.$.auth.basicAuthStrongPasswordPolicy&&E&&(0,n.jsx)(p.m,{content:"If you skip you will be prompted to change password next time you log in.",placement:"bottom",children:(0,n.jsx)(a.$n,{className:y.skipButton,fill:"text",onClick:E,type:"button","data-testid":r.Tp.pages.Login.skip,children:"Skip"})})]})]})}},72235:(k,A,e)=>{"use strict";e.d(A,{l:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(49785);function i({defaultValues:g,onSubmit:o,validateOnMount:d=!1,validateFieldsOnMount:c,children:a,validateOn:p="onSubmit",maxWidth:u=600,...m}){const{handleSubmit:v,trigger:x,formState:f,...E}=(0,r.mN)({mode:p,defaultValues:g});return(0,l.useEffect)(()=>{d&&x(c)},[x,c,d]),(0,n.jsx)("form",{className:(0,s.css)({maxWidth:u!=="none"?u+"px":u,width:"100%"}),onSubmit:v(o),...m,children:a({errors:f.errors,formState:f,trigger:x,...E})})}},30249:(k,A,e)=>{"use strict";e.d(A,{o:()=>m});var n=e(74848),s=e(96540),l=e(85200),r=e(1173),i=e(11261),g=e(90708),o=e(67266),d=e(81297),c=e(16895),a=e(40458);function p(v,x,f=[]){for(const E of f)if(typeof E=="function"){if(!E(v,x))return!1}else if(x[E]!==v[E])return!1;return!0}const u={x:l.sJ.get(r.Ct.firstTimeField).get({}),y:l.sJ.get(r.Ct.byTypes).get(new Set([i.PU.number,i.PU.enum]))};class m extends s.Component{constructor(x){super(x),this.getTimeRange=()=>this.props.timeRange;let f=this.prepState(x);f.alignedData=f.config.prepData([f.alignedFrame]),this.state=f,this.plotInstance=s.createRef()}prepState(x,f=!0){let E=null;const{frames:h,fields:y=u,preparePlotFrame:b,replaceVariables:D,dataLinkPostProcessor:P}=x,C=b??a.m,M=h.some(R=>R.fields.some(T=>(T.config.links?.length??0)>0)),I=C(h,{...y,y:M?()=>!0:y.y},x.timeRange);if((0,c.uY)("GraphNG",!1,"data aligned",I),I){let R=I;if(M){const S=Array.isArray(this.props.timeZone)?this.props.timeZone[0]:this.props.timeZone;let L=h.map((O,j)=>({...O,fields:I.fields.filter((N,F)=>F===0||N.state?.origin?.frameIndex===j),length:I.length}));L.forEach((O,j)=>{O.fields.forEach(N=>{N.getLinks=(0,g._M)(O,N,{...N.state?.scopedVars,__dataContext:{value:{data:L,field:N,frame:O,frameIndex:j}}},D,S,P)})}),R={...I,fields:I.fields.filter((O,j)=>j===0||y.y(O,I,[I]))}}let T=this.state?.config;f&&(T=x.prepConfig(R,this.props.frames,this.getTimeRange),(0,c.uY)("GraphNG",!1,"config prepared",T)),E={alignedFrame:R,config:T},(0,c.uY)("GraphNG",!1,"data prepared",E.alignedData)}return E}componentDidUpdate(x){const{frames:f,structureRev:E,timeZone:h,cursorSync:y,propsToDiff:b}=this.props,D=!p(x,this.props,b);if(f!==x.frames||D||h!==x.timeZone||y!==x.cursorSync){let P=this.prepState(this.props,!1);P&&((this.state.config===void 0||h!==x.timeZone||y!==x.cursorSync||E!==x.structureRev||!E||D)&&(P.config=this.props.prepConfig(P.alignedFrame,this.props.frames,this.getTimeRange),(0,c.uY)("GraphNG",!1,"config recreated",P.config)),P.alignedData=P.config.prepData([P.alignedFrame]),this.setState(P))}}render(){const{width:x,height:f,children:E,renderLegend:h}=this.props,{config:y,alignedFrame:b,alignedData:D}=this.state;return y?(0,n.jsx)(o.KU,{width:x,height:f,legend:h(y),children:(P,C)=>(0,n.jsx)(d.Z,{config:y,data:D,width:P,height:C,plotRef:M=>this.plotInstance.current=M,children:E?E(y,b):null})}):null}}},40458:(k,A,e)=>{"use strict";e.d(A,{m:()=>c});var n=e(11261),s=e(73060),l=e(46294);function r(a,p,u){let m,v;for(let x=0;x<p.length;x++)if(p[x]==null)v==null&&m!=null&&(v=x);else{if(v!=null&&m!=null){if(a[x]-m<u)for(;v<x;)p[v++]=void 0;v=null}m=a[x]}return p}var i=e(52622);function g(a){return a.type===n.PU.number&&a.config.custom?.drawStyle===i.GR.Bars&&!a.config.custom?.hideFrom?.viz}function o(a,p){return a.fields.find(u=>p!=null?u.name===p:u.type===n.PU.time)}function d(a,p){const u=o(a,p);let m=u?.values;for(let v=0;v<a.fields.length;v++){let x=a.fields[v];if(x===u||g(x))continue;let f=x.config.custom?.spanNulls;typeof f=="number"&&f!==-1&&m&&(x.values=r(m,x.values,f))}return a}function c(a,p,u){let m;e:for(let E of a)for(let h of E.fields)if(p.x(h,E,a)){m=h;break e}a=a.map(E=>m?.state?.nullThresholdApplied?E:(0,l.M)({frame:E,refFieldName:m.name,refFieldPseudoMin:u?.from.valueOf(),refFieldPseudoMax:u?.to.valueOf()}));let v=a.reduce((E,h)=>E+h.fields.reduce((y,b)=>y+(g(b)?1:0),0),0),x=1/0;v>1&&a.forEach(E=>{if(!E.fields.some(g))return;const h=m.values;for(let y=0;y<h.length;y++)y>0&&(x=Math.min(x,h[y]-h[y-1]))});let f=(0,s.Fd)({frames:a,joinBy:p.x,keep:p.y,keepOriginIndices:!0,keepDisplayNames:!0,nullMode:E=>{if(g(E))return s.WO;let h=E.config.custom?.spanNulls;return h===!0?s.RC:h===-1?s.WO:s.JI}});return f?(f=d(f,m.name),x!==1/0&&(f.fields.forEach((E,h)=>{let y=E.values;if(h===0){let b=y[y.length-1];y.push(b+x,b+2*x)}else g(E)?y.push(null,null):y.push(void 0,void 0)}),f.length+=2),f):null}},18759:(k,A,e)=>{"use strict";e.d(A,{T:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(16795);function i({children:o,spacing:d,level:c}){const a=(0,l.of)(g,d,c);return(0,n.jsx)("span",{className:(0,s.css)(a.indentor),children:o})}const g=(o,d,c)=>({indentor:(0,s.css)((0,r.Y)(o,d,a=>({paddingLeft:o.spacing(a*c)})))})},61680:(k,A,e)=>{"use strict";e.d(A,{b:()=>r});var n=e(74848),s=e(96540),l=e(33390);const r=i=>{const{children:g,storageKey:o,defaultValue:d}=i,[c,a]=(0,s.useState)({value:l.A.getObject(i.storageKey,i.defaultValue)});(0,s.useEffect)(()=>{const m=v=>{v.key===o&&a({value:l.A.getObject(i.storageKey,i.defaultValue)})};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}});const p=m=>{try{l.A.setObject(o,m)}catch(v){console.error(v)}a({value:m})},u=()=>{try{l.A.delete(o)}catch(m){console.log(m)}a({value:d})};return(0,n.jsx)(n.Fragment,{children:g(c.value,p,u)})}},87570:(k,A,e)=>{"use strict";e.d(A,{A:()=>d});var n=e(74848),s=e(96540),l=e(17172),r=e(2913),i=e(8484);const g=()=>!!r.Ay.oauth&&Object.keys(r.Ay.oauth).length>0;class o extends s.PureComponent{constructor(p){super(p),this.changePassword=u=>{const m={newPassword:u,confirmNew:u,oldPassword:"admin"};if(this.props.resetCode){const v={code:this.props.resetCode,newPassword:u,confirmPassword:u};(0,l.AI)().post("/api/user/password/reset",v).then(()=>{this.toGrafana()})}else(0,l.AI)().put("/api/user/password",m).then(()=>{this.toGrafana()}).catch(v=>console.error(v))},this.login=u=>{this.setState({loginErrorMessage:void 0,isLoggingIn:!0}),(0,l.AI)().post("/login",u,{showErrorAlert:!1}).then(m=>{if(this.result=m,u.password!=="admin"||r.Ay.ldapEnabled||r.Ay.authProxyEnabled){this.toGrafana();return}else this.changeView(u.password==="admin")}).catch(m=>{const v=(0,l.NF)(m)?c(m):void 0;this.setState({isLoggingIn:!1,loginErrorMessage:v||(0,i.t)("login.error.unknown","Unknown error occurred")})})},this.changeView=u=>{this.setState({isChangingPassword:!0,showDefaultPasswordWarning:u})},this.toGrafana=()=>{this.result?.redirectUrl?r.Ay.appSubUrl!==""&&!this.result.redirectUrl.startsWith(r.Ay.appSubUrl)?window.location.assign(r.Ay.appSubUrl+this.result.redirectUrl):window.location.assign(this.result.redirectUrl):window.location.assign(r.Ay.appSubUrl+"/")},this.state={isLoggingIn:!1,isChangingPassword:!1,showDefaultPasswordWarning:!1,loginErrorMessage:r.Ay.loginError}}render(){const{children:p}=this.props,{isLoggingIn:u,isChangingPassword:m,showDefaultPasswordWarning:v,loginErrorMessage:x}=this.state,{login:f,toGrafana:E,changePassword:h}=this,{loginHint:y,passwordHint:b,disableLoginForm:D,disableUserSignUp:P}=r.Ay;return(0,n.jsx)(n.Fragment,{children:p({isOauthEnabled:g(),loginHint:y,passwordHint:b,disableLoginForm:D,disableUserSignUp:P,login:f,isLoggingIn:u,changePassword:h,skipPasswordChange:E,isChangingPassword:m,showDefaultPasswordWarning:v,loginErrorMessage:x})})}}const d=o;function c(a){switch(a.data?.messageId){case"password-auth.empty":case"password-auth.failed":case"password-auth.invalid":return(0,i.t)("login.error.invalid-user-or-password","Invalid username or password");case"login-attempt.blocked":return(0,i.t)("login.error.blocked","You have exceeded the number of login attempts for this user. Please try again later.");default:return a.data?.message}}},4691:(k,A,e)=>{"use strict";e.d(A,{$:()=>m,Q:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(49785),i=e(13544),g=e(40845),o=e(88575),d=e(10354),c=e(55852),a=e(8484),p=e(78361);const u=({children:v,onSubmit:x,isLoggingIn:f,passwordHint:E,loginHint:h})=>{const y=(0,g.of)(m),b=(0,l.useId)(),D=(0,l.useId)(),{handleSubmit:P,register:C,formState:{errors:M}}=(0,r.mN)({mode:"onChange"});return(0,n.jsx)("div",{className:y.wrapper,children:(0,n.jsxs)("form",{onSubmit:P(x),children:[(0,n.jsx)(o.D,{label:(0,a.t)("login.form.username-label","Email or username"),invalid:!!M.user,error:M.user?.message,children:(0,n.jsx)(d.p,{...C("user",{required:(0,a.t)("login.form.username-required","Email or username is required")}),id:b,autoFocus:!0,autoCapitalize:"none",placeholder:h||(0,a.t)("login.form.username-placeholder","email or username"),"data-testid":i.Tp.pages.Login.username})}),(0,n.jsx)(o.D,{label:(0,a.t)("login.form.password-label","Password"),invalid:!!M.password,error:M.password?.message,children:(0,n.jsx)(p.s,{...C("password",{required:(0,a.t)("login.form.password-required","Password is required")}),id:D,autoComplete:"current-password",placeholder:E||(0,a.t)("login.form.password-placeholder","password")})}),(0,n.jsx)(c.$n,{type:"submit","data-testid":i.Tp.pages.Login.submit,className:y.submitButton,disabled:f,children:f?(0,a.t)("login.form.submit-loading-label","Logging in..."):(0,a.t)("login.form.submit-label","Log in")}),v]})})},m=v=>({wrapper:(0,s.css)({width:"100%",paddingBottom:v.spacing(2)}),submitButton:(0,s.css)({justifyContent:"center",width:"100%"}),skipButton:(0,s.css)({alignSelf:"flex-start"})})},20851:(k,A,e)=>{"use strict";e.d(A,{GU:()=>c,YO:()=>p,qm:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(19361),o=e(38645);const d=({children:u,enterAnimation:m=!0})=>{const v=(0,i.of)(p);return(0,n.jsx)("div",{className:(0,s.cx)(v.loginInnerBox,m&&v.enterAnimation),children:u})},c=({children:u,branding:m,isChangingPassword:v})=>{const x=(0,i.of)(p),[f,E]=(0,l.useState)(!1),h=m?.loginSubtitle??g.M.GetLoginSubTitle(),y=m?.loginTitle??g.M.LoginTitle,b=m?.loginBoxBackground||g.M.LoginBoxBackground(),D=m?.loginLogo,P=m?.hideEdition??g.M.HideEdition;return(0,l.useEffect)(()=>E(!0),[]),(0,n.jsxs)(g.M.LoginBackground,{className:(0,s.cx)(x.container,f&&x.loginAnim,m?.loginBackground,{[x.containerBodyScrolling]:r.$.featureToggles.bodyScrolling}),children:[(0,n.jsx)("div",{className:x.loginMain,children:(0,n.jsxs)("div",{className:(0,s.cx)(x.loginContent,b,"login-content-box"),children:[(0,n.jsxs)("div",{className:x.loginLogoWrapper,children:[(0,n.jsx)(g.M.LoginLogo,{className:x.loginLogo,logo:D}),(0,n.jsx)("div",{className:x.titleWrapper,children:v?(0,n.jsx)("h1",{className:x.mainTitle,children:"Update your password"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:x.mainTitle,children:y}),h&&(0,n.jsx)("h3",{className:x.subTitle,children:h})]})})]}),(0,n.jsx)("div",{className:x.loginOuterBox,children:u})]})}),m?.hideFooter?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(o.wi,{hideEdition:P,customLinks:m?.footerLinks})]})},a=(0,s.keyframes)`
from{
  opacity: 0;
  transform: translate(-60px, 0px);
}

to{
  opacity: 1;
  transform: translate(0px, 0px);
}`,p=u=>({loginMain:(0,s.css)({flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:"100%"}),container:(0,s.css)({minHeight:"100%",backgroundPosition:"center",backgroundRepeat:"no-repeat",minWidth:"100%",marginLeft:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),containerBodyScrolling:(0,s.css)({flex:1}),loginAnim:(0,s.css)({"&:before":{opacity:1},".login-content-box":{opacity:1}}),submitButton:(0,s.css)({justifyContent:"center",width:"100%"}),loginLogo:(0,s.css)({width:"100%",maxWidth:60,marginBottom:u.spacing(2),[u.breakpoints.up("sm")]:{maxWidth:100}}),loginLogoWrapper:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:u.spacing(3)}),titleWrapper:(0,s.css)({textAlign:"center"}),mainTitle:(0,s.css)({fontSize:22,[u.breakpoints.up("sm")]:{fontSize:32}}),subTitle:(0,s.css)({fontSize:u.typography.size.md,color:u.colors.text.secondary}),loginContent:(0,s.css)({maxWidth:478,width:"calc(100% - 2rem)",display:"flex",alignItems:"stretch",flexDirection:"column",position:"relative",justifyContent:"flex-start",zIndex:1,minHeight:320,borderRadius:u.shape.radius.default,padding:u.spacing(2,0),opacity:0,[u.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.5s ease-in-out"},[u.breakpoints.up("sm")]:{minHeight:u.spacing(40),justifyContent:"center"}}),loginOuterBox:(0,s.css)({display:"flex",overflowY:"hidden",alignItems:"center",justifyContent:"center"}),loginInnerBox:(0,s.css)({padding:u.spacing(0,2,2,2),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,maxWidth:415,width:"100%",transform:"translate(0px, 0px)",[u.transitions.handleMotion("no-preference")]:{transition:"0.25s ease"}}),enterAnimation:(0,s.css)({[u.transitions.handleMotion("no-preference")]:{animation:`${a} ease-out 0.2s`}})})},60188:(k,A,e)=>{"use strict";e.d(A,{Q:()=>o});var n=e(74848),s=e(2543),l=e.n(s),r=e(96540),i=e(10354),g=e(88575);class o extends r.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=r.createRef(),this.updateValue=()=>{const c=this.inputRef.current?.value;let a=!1,p="";const u=this.props.min,m=this.props.max;let v=c!==""?Number(c):void 0;v&&!Number.isNaN(v)&&(u!=null&&v<u?(p=u.toString(),a=!0):m!=null&&v>m?(p=m.toString(),a=!0):p=c??"",this.setState({text:p,inputCorrected:a})),a&&this.updateValueDebounced(),!Number.isNaN(v)&&v!==this.props.value&&this.props.onChange(v)},this.updateValueDebounced=(0,s.debounce)(this.updateValue,500),this.onChange=c=>{this.setState({text:c.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=c=>{c.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(c){if(this.props.value!==c.value){const a=isNaN(this.props.value)?"":`${this.props.value}`;a!==this.state.text&&this.setState({text:a})}}renderInput(){return(0,n.jsx)(i.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:c}=this.state;if(c){let a="",{min:p,max:u}=this.props;return u==null?p!=null&&(a=`< ${p}`):p!=null?a=`${p} < > ${u}`:a=`> ${u}`,(0,n.jsx)(g.D,{invalid:c,error:`Out of range ${a}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},77268:(k,A,e)=>{"use strict";e.d(A,{a:()=>o});var n=e(74848),s=e(32196),l=e(40845),r=e(83598),i=e(29158),g=e(83876);const o=({value:c,settings:a,onChange:p,details:u})=>{const m=(0,l.$j)(),v=(0,l.of)(d);return(0,n.jsx)(r.sk,{color:c??"",onChange:p,enableNamedColors:a?.enableNamedColors!==!1,children:({ref:x,showColorPicker:f,hideColorPicker:E})=>(0,n.jsxs)("div",{className:v.spot,children:[(0,n.jsx)("div",{className:v.colorPicker,children:(0,n.jsx)(g.q,{ref:x,onClick:f,onMouseLeave:E,color:c?m.visualization.getColorByName(c):m.components.input.borderColor})}),u&&(0,n.jsxs)(n.Fragment,{children:[c?(0,n.jsx)("span",{className:v.colorText,onClick:f,children:c}):(0,n.jsx)("span",{className:v.placeholderText,onClick:f,children:a?.placeholder??"Select color"}),a?.isClearable&&c&&(0,n.jsx)(i.K,{name:"times",onClick:()=>p(void 0),tooltip:"Clear settings"})]})]})})},d=c=>({spot:(0,s.css)({cursor:"pointer",color:c.colors.text.primary,background:c.components.input.background,padding:"3px",height:c.v1.spacing.formInputHeight,border:`1px solid ${c.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${c.components.input.borderHover}`}}),colorPicker:(0,s.css)({padding:`0 ${c.spacing(1)}`}),colorText:(0,s.css)({flexGrow:2}),placeholderText:(0,s.css)({flexGrow:2,color:c.colors.text.secondary})})},72626:(k,A,e)=>{"use strict";e.d(A,{w:()=>r});var n=e(74848),s=e(96540),l=e(60188);const r=({value:i,onChange:g,item:o})=>{const{settings:d}=o,c=(0,s.useCallback)(a=>{g(d?.integer&&a!==void 0?Math.floor(a):a)},[g,d?.integer]);return(0,n.jsx)(l.Q,{value:i,min:d?.min,max:d?.max,step:d?.step,placeholder:d?.placeholder,onChange:c})}},33919:(k,A,e)=>{"use strict";e.d(A,{H:()=>tt,u:()=>ze});var n=e(74848),s=e(69550),l=e(27310),r=e(11261),i=e(50082),g=e(15292),o=e(94354),d=e(20333),c=e(76218),a=e(96540),p=e(32196),u=e(2543),m=e(47737),v=e(60578),x=e(24284),f=e(10354),E=e(83598),h=e(29158),y=e(55852),b=e(60029),D=e(3911);const P=[{value:i.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:i.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class C extends a.PureComponent{constructor(Se){super(Se),this.onAddThreshold=()=>{const{steps:Ee}=this.state;let Pe=0;Ee.length>1&&(Pe=Ee[Ee.length-1].value+10);let he=x.Tj.filter(De=>!Ee.some(Ie=>Ie.color===De))[1];he||(he="#CCCCCC");const be={value:Pe,color:he,key:M++},Ae=[...Ee,be];(0,m.RU)(Ae),this.setState({steps:Ae},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=Ee=>{const{steps:Pe}=this.state;Pe.length&&Ee.key!==Pe[0].key&&this.setState({steps:Pe.filter(he=>he.key!==Ee.key)},this.onChange)},this.onChangeThresholdValue=(Ee,Pe)=>{const he=Ee.target.value.replace(/,/g,"."),be=parseFloat(he),Ae=isNaN(be)?"":be,De=this.state.steps.map(Ie=>(Ie.key===Pe.key&&(Ie={...Ie,value:Ae}),Ie));De.length&&(De[0].value=-1/0),(0,m.RU)(De),this.setState({steps:De})},this.onChangeThresholdColor=(Ee,Pe)=>{const{steps:he}=this.state,be=he.map(Ae=>(Ae.key===Ee.key&&(Ae={...Ae,color:Pe}),Ae));this.setState({steps:be},this.onChange)},this.onBlur=()=>{const Ee=[...this.state.steps];(0,m.RU)(Ee),this.setState({steps:Ee},this.onChange)},this.onChange=()=>{this.props.onChange(R(this.props.thresholds,this.state.steps))},this.onModeChanged=Ee=>{this.props.onChange({...this.props.thresholds,mode:Ee})};const fe=I(Se.thresholds.steps);fe[0].value=-1/0,this.state={steps:fe},this.latestThresholdInputRef=a.createRef()}renderInput(Se,fe,Ee){const Pe=this.props.thresholds.mode===i.O.Percentage,he=`Threshold ${Ee+1}`;return isFinite(Se.value)?(0,n.jsx)(f.p,{type:"number",step:"0.0001",onChange:be=>this.onChangeThresholdValue(be,Se),value:Se.value,"aria-label":he,ref:Ee===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,n.jsxs)("div",{className:fe.inputPrefix,children:[(0,n.jsx)("div",{className:fe.colorPicker,children:(0,n.jsx)(E.sk,{color:Se.color,onChange:be=>this.onChangeThresholdColor(Se,be),enableNamedColors:!0})}),Pe&&(0,n.jsx)("div",{className:fe.percentIcon,children:"%"})]}),suffix:(0,n.jsx)(h.K,{className:fe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(Se),tooltip:`Remove ${he}`})},Pe.toString()):(0,n.jsx)(f.p,{type:"text",value:"Base","aria-label":he,disabled:!0,prefix:(0,n.jsx)("div",{className:fe.colorPicker,children:(0,n.jsx)(E.sk,{color:Se.color,onChange:be=>this.onChangeThresholdColor(Se,be),enableNamedColors:!0})})})}render(){const{thresholds:Se}=this.props,{steps:fe}=this.state;return(0,n.jsx)(v.D.Consumer,{children:Ee=>{const Pe=T(Ee);return(0,n.jsxs)("div",{className:Pe.wrapper,children:[(0,n.jsx)(y.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Pe.addButton,fullWidth:!0,children:"Add threshold"}),(0,n.jsx)("div",{className:Pe.thresholds,children:fe.slice(0).reverse().map((he,be)=>(0,n.jsx)("div",{className:Pe.item,children:this.renderInput(he,Pe,be)},`${he.key}`))}),(0,n.jsxs)("div",{children:[(0,n.jsx)(b.J,{description:"Percentage means thresholds relative to min & max",children:"Thresholds mode"}),(0,n.jsx)(o.z,{options:P,onChange:this.onModeChanged,value:Se.mode})]})]})}})}}let M=100;function I(pe){return(!pe||pe.length===0)&&(pe=[{value:-1/0,color:"green"}]),pe.filter((Se,fe)=>(0,u.isNumber)(Se.value)||fe===0).map(Se=>({color:Se.color,value:Se.value===null?-1/0:Se.value,key:M++}))}function R(pe,Se){return{mode:pe.mode??i.O.Absolute,steps:Se.map(Ee=>{const{key:Pe,...he}=Ee;return he})}}const T=(0,D.N)(pe=>({wrapper:(0,p.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,p.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${pe.spacing(2)};
    `,item:(0,p.css)`
      margin-bottom: ${pe.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,p.css)`
      padding: 0 ${pe.spacing(1)};
    `,addButton:(0,p.css)`
      margin-bottom: ${pe.spacing(1)};
    `,percentIcon:(0,p.css)`
      font-size: ${pe.typography.bodySmall.fontSize};
      color: ${pe.colors.text.secondary};
    `,inputPrefix:(0,p.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,p.css)`
      color: ${pe.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${pe.colors.text};
      }
    `}));class S extends a.PureComponent{constructor(Se){super(Se)}render(){const{onChange:Se}=this.props;let fe=this.props.value;return fe||(fe={mode:i.O.Percentage,steps:[]}),(0,n.jsx)(C,{thresholds:fe,onChange:Se})}}var L=e(25019),O=e(40845),j=e(66864),N=e(14578),F=e(37390),U=e(80744),w=e(25148),B=e(91076),K=e(51986),W=e(90182);function z({mapping:pe,index:Se,onChange:fe,onRemove:Ee,onDuplicate:Pe,showIconPicker:he}){const{key:be,result:Ae,id:De}=pe,Ie=(0,O.of)(Y),ke=(0,a.useRef)(null),dt=(0,a.useCallback)(Ut=>{const Gt={...pe,result:{...pe.result}};Ut(Gt),fe(Se,Gt)},[pe,Se,fe]);(0,a.useEffect)(()=>{ke.current&&pe.isNew&&(ke.current.focus(),dt(Ut=>{Ut.isNew=!1}))},[pe,ke,dt]);const Pt=Ut=>{dt(Gt=>{Gt.result.color=Ut})},pt=()=>{dt(Ut=>{Ut.result.color=void 0})},Tt=Ut=>{dt(Gt=>{Gt.result.icon=Ut})},jt=()=>{dt(Ut=>{Ut.result.icon=void 0})},$t=Ut=>{dt(Gt=>{Gt.key=Ut.currentTarget.value})},sn=Ut=>{dt(Gt=>{Gt.result.text=Ut.currentTarget.value})},Yt=Ut=>{dt(Gt=>{Gt.from=parseFloat(Ut.currentTarget.value)})},qt=Ut=>{dt(Gt=>{Gt.to=parseFloat(Ut.currentTarget.value)})},bn=Ut=>{dt(Gt=>{Gt.pattern=Ut.currentTarget.value})},Mt=Ut=>{dt(Gt=>{Gt.specialMatch=Ut.value})},Jt=[{label:"Null",value:L.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:L.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:L.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:L.W.True,description:"Boolean true values"},{label:"False",value:L.W.False,description:"Boolean false values"},{label:"Empty",value:L.W.Empty,description:"Empty string"}];return(0,n.jsx)(B.sx,{draggableId:De,index:Se,children:Ut=>(0,n.jsxs)("tr",{className:Ie.dragRow,ref:Ut.innerRef,...Ut.draggableProps,children:[(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:Ie.dragHandle,...Ut.dragHandleProps,children:(0,n.jsx)(N.I,{name:"draggabledots",size:"lg"})})}),(0,n.jsx)("td",{className:Ie.typeColumn,children:pe.type}),(0,n.jsxs)("td",{children:[pe.type===L.d.ValueToText&&(0,n.jsx)(f.p,{ref:ke,type:"text",value:be??"",onChange:$t,placeholder:"Exact value to match"}),pe.type===L.d.RangeToText&&(0,n.jsxs)("div",{className:Ie.rangeInputWrapper,children:[(0,n.jsx)(f.p,{type:"number",value:pe.from??"",placeholder:"Range start",onChange:Yt,prefix:"From"}),(0,n.jsx)(f.p,{type:"number",value:pe.to??"",placeholder:"Range end",onChange:qt,prefix:"To"})]}),pe.type===L.d.RegexToText&&(0,n.jsx)(f.p,{type:"text",value:pe.pattern??"",placeholder:"Regular expression",onChange:bn}),pe.type===L.d.SpecialValue&&(0,n.jsx)(W.l6,{value:Jt.find(Gt=>Gt.value===pe.specialMatch),options:Jt,onChange:Mt})]}),(0,n.jsx)("td",{children:(0,n.jsx)(f.p,{type:"text",value:Ae.text??"",onChange:sn,placeholder:"Optional display text"})}),(0,n.jsxs)("td",{className:Ie.textAlignCenter,children:[Ae.color&&(0,n.jsxs)(j.Gy,{spacing:"sm",justify:"center",children:[(0,n.jsx)(E.sk,{color:Ae.color,onChange:Pt,enableNamedColors:!0}),(0,n.jsx)(h.K,{name:"times",onClick:pt,tooltip:"Remove color",tooltipPlacement:"top"})]}),!Ae.color&&(0,n.jsx)(E.sk,{color:"gray",onChange:Pt,enableNamedColors:!0,children:Gt=>(0,n.jsx)(y.$n,{variant:"primary",fill:"text",onClick:Gt.showColorPicker,ref:Gt.ref,size:"sm",children:"Set color"})})]}),he&&(0,n.jsx)("td",{className:Ie.textAlignCenter,children:(0,n.jsxs)(j.Gy,{spacing:"sm",justify:"center",children:[(0,n.jsx)(w.n,{onChange:Tt,onClear:jt,value:Ae.icon,size:U.Iy.SMALL,folderName:U.Iu.Icon,mediaType:U.zu.Icon,color:Ae.color}),Ae.icon&&(0,n.jsx)(h.K,{name:"times",onClick:jt,tooltip:"Remove icon",tooltipPlacement:"top"})]})}),(0,n.jsx)("td",{className:Ie.textAlignCenter,children:(0,n.jsxs)(j.Gy,{spacing:"sm",children:[(0,n.jsx)(h.K,{name:"copy",onClick:()=>Pe(Se),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),(0,n.jsx)(h.K,{name:"trash-alt",onClick:()=>Ee(Se),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})]})})]})},De)}const Y=pe=>({dragRow:(0,p.css)({position:"relative"}),dragHandle:(0,p.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${pe.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,p.css)({display:"flex","> div:first-child":{marginRight:pe.spacing(2)}}),regexInputWrapper:(0,p.css)({display:"flex","> div:first-child":{marginRight:pe.spacing(2)}}),typeColumn:(0,p.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,p.css)({textAlign:"center"})});function X({value:pe,onChange:Se,onClose:fe,showIconPicker:Ee}){const Pe=(0,O.of)(q),[he,be]=(0,a.useState)([]);(0,a.useEffect)(()=>{be(ne(pe))},[pe]);const Ae=Tt=>{if(!pe||!Tt.destination)return;const jt=[...he],$t=jt[Tt.source.index];jt.splice(Tt.source.index,1),jt.splice(Tt.destination.index,0,$t),be(jt)},De=(Tt,jt)=>{const $t=[...he];$t.splice(Tt,1,jt),be($t)},Ie=Tt=>{const jt=[...he];jt.splice(Tt,1),be(jt)},ke=[{label:"Value",value:L.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:L.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:L.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:L.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],dt=Tt=>{be([...he,te({type:Tt.value,result:{},isNew:!0})])},Pt=Tt=>{const jt=H(he[Tt]),$t=[...he];$t.splice(Tt,0,{...jt});for(let sn=Tt;sn<he.length;sn++)$t[sn].result.index=sn;be($t)},pt=()=>{Se(se(he)),fe()};return(0,a.useEffect)(()=>{pe?.length||dt({value:L.d.ValueToText})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:Pe.tableWrap,children:(0,n.jsxs)("table",{className:Pe.editTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:"Condition"}),(0,n.jsx)("th",{style:{textAlign:"left"},children:"Display text"}),(0,n.jsx)("th",{style:{width:"10%"},children:"Color"}),Ee&&(0,n.jsx)("th",{style:{width:"10%"},children:"Icon"}),(0,n.jsx)("th",{style:{width:"1%"}})]})}),(0,n.jsx)(B.JY,{onDragEnd:Ae,children:(0,n.jsx)(B.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:Tt=>(0,n.jsxs)("tbody",{ref:Tt.innerRef,...Tt.droppableProps,children:[he.map((jt,$t)=>(0,n.jsx)(z,{mapping:jt,index:$t,onChange:De,onRemove:Ie,onDuplicate:Pt,showIconPicker:Ee},jt.id)),Tt.placeholder]})})})]})}),(0,n.jsxs)(F.a.ButtonRow,{leftItems:(0,n.jsx)(K.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:ke,onChange:dt}),children:[(0,n.jsx)(y.$n,{variant:"secondary",fill:"outline",onClick:fe,children:"Cancel"}),(0,n.jsx)(y.$n,{variant:"primary",onClick:pt,children:"Update"})]})]})}const q=pe=>({tableWrap:(0,p.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,p.css)({width:"100%",marginBottom:pe.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:pe.colors.action.hover}," th, td":{padding:pe.spacing(1)}})});function G(){return(0,u.uniqueId)("mapping-")}function te(pe){return{type:L.d.ValueToText,result:{},id:G(),...pe}}function H(pe){return{...te(pe),id:G()}}function se(pe){const Se=[],fe={type:L.d.ValueToText,options:{}};return pe.forEach((Ee,Pe)=>{const he={...Ee.result,index:Pe};switch((!he.text||he.text.trim().length===0)&&(he.text=void 0),Ee.type){case L.d.ValueToText:Ee.key!=null&&(fe.options[Ee.key]=he);break;case L.d.RangeToText:Ee.from!=null&&Ee.to!=null&&Se.push({type:Ee.type,options:{from:Ee.from,to:Ee.to,result:he}});break;case L.d.RegexToText:Ee.pattern!=null&&Se.push({type:Ee.type,options:{pattern:Ee.pattern,result:he}});break;case L.d.SpecialValue:Se.push({type:Ee.type,options:{match:Ee.specialMatch,result:he}})}}),Object.keys(fe.options).length>0&&Se.unshift(fe),Se}function ne(pe){const Se=[];if(pe)for(const fe of pe)switch(fe.type){case L.d.ValueToText:for(const Ee in fe.options)Se.push(te({type:fe.type,result:fe.options[Ee],key:Ee}));break;case L.d.RangeToText:Se.push(te({type:fe.type,result:fe.options.result,from:fe.options.from??0,to:fe.options.to??0}));break;case L.d.RegexToText:Se.push(te({type:fe.type,result:fe.options.result,pattern:fe.options.pattern}));break;case L.d.SpecialValue:Se.push(te({type:fe.type,result:fe.options.result,specialMatch:fe.options.match??L.W.Null}))}return Se.sort((fe,Ee)=>(fe.result.index??0)>(Ee.result.index??0)?1:-1),Se}const le=(0,a.memo)(pe=>{const{value:Se,onChange:fe,item:Ee}=pe,Pe=(0,O.of)(_),he=Ee.settings?.icon,[be,Ae]=(0,a.useState)(!1),De=(0,a.useCallback)(()=>{Ae(!1)},[Ae]),Ie=(0,a.useMemo)(()=>ne(Se),[Se]),ke=(0,a.useCallback)((Pt,pt)=>{Ie[pt].result.color=Pt,fe(se(Ie))},[Ie,fe]),dt=(0,a.useCallback)((Pt,pt)=>{Ie[pt].result.icon=Pt,fe(se(Ie))},[Ie,fe]);return(0,n.jsxs)(j.gW,{children:[(0,n.jsx)("table",{className:Pe.compactTable,children:(0,n.jsx)("tbody",{children:Ie.map((Pt,pt)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[Pt.type===L.d.ValueToText&&Pt.key,Pt.type===L.d.RangeToText&&(0,n.jsxs)("span",{children:["[",Pt.from," - ",Pt.to,"]"]}),Pt.type===L.d.RegexToText&&Pt.pattern,Pt.type===L.d.SpecialValue&&Pt.specialMatch]}),(0,n.jsx)("td",{children:(0,n.jsx)(N.I,{name:"arrow-right"})}),(0,n.jsx)("td",{children:Pt.result.text}),Pt.result.color&&(0,n.jsx)("td",{children:(0,n.jsx)(E.sk,{color:Pt.result.color,onChange:Tt=>ke(Tt,pt),enableNamedColors:!0})}),he&&Pt.result.icon&&(0,n.jsx)("td",{"data-testid":"iconPicker",children:(0,n.jsx)(w.n,{onChange:Tt=>dt(Tt,pt),value:Pt.result.icon,size:U.Iy.SMALL,folderName:U.Iu.Icon,mediaType:U.zu.Icon,color:Pt.result.color})})]},pt.toString()))})}),(0,n.jsxs)(y.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>Ae(!0),children:[Ie.length>0&&(0,n.jsx)("span",{children:"Edit value mappings"}),Ie.length===0&&(0,n.jsx)("span",{children:"Add value mappings"})]}),(0,n.jsx)(F.a,{isOpen:be,title:"Value mappings",onDismiss:De,className:Pe.modal,closeOnBackdropClick:!1,children:(0,n.jsx)(X,{value:Se,onChange:fe,onClose:De,showIconPicker:he})})]})});le.displayName="ValueMappingsEditor";const _=pe=>({modal:(0,p.css)({width:"980px"}),compactTable:(0,p.css)({width:"100%","tbody td":{padding:pe.spacing(.5)}})});var Q=e(59429);const ae=({value:pe,onChange:Se,item:fe})=>{const{placeholder:Ee,isClearable:Pe}=fe?.settings??{},he=(0,a.useCallback)(be=>{Se(be?.value?.uid)},[Se]);return(0,n.jsx)(Q.b,{isClearable:Pe,defaultOptions:!0,onChange:he,placeholder:Ee,value:pe})};var oe=e(77268),J=e(8066),ee=e(24293),de=e(88575);const xe=({value:pe,onChange:Se,item:fe,id:Ee})=>{const Pe=(0,O.$j)(),he=(0,O.of)(ue),be=(0,J.Hs)(pe?.mode),De=(fe.settings?.byValueSupport?J.uf.list():J.uf.list().filter(pt=>!pt.isByValue)).filter(pt=>!pt.excludeFromPicker).map(pt=>{let Tt=pt.isByValue?" (by value)":"";return{value:pt.id,label:`${pt.name}${Tt}`,description:pt.description,isContinuous:pt.isContinuous,isByValue:pt.isByValue,component(){return(0,n.jsx)(re,{mode:pt,theme:Pe})}}}),Ie=pt=>{Se({...pe,mode:pt.value})},ke=pt=>{Se({...pe,mode:Pt,fixedColor:pt})},dt=pt=>{Se({...pe,mode:Pt,seriesBy:pt})},Pt=pe?.mode??ee.Y.Thresholds;if(Pt===ee.Y.Fixed||Pt===ee.Y.Shades)return(0,n.jsxs)("div",{className:he.group,children:[(0,n.jsx)(W.l6,{minMenuHeight:200,options:De,value:Pt,onChange:Ie,className:he.select,inputId:Ee}),(0,n.jsx)(oe.a,{value:pe?.fixedColor,onChange:ke})]});if(fe.settings?.bySeriesSupport&&be.isByValue){const pt=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginBottom:Pe.spacing(2)},children:(0,n.jsx)(W.l6,{minMenuHeight:200,options:De,value:Pt,onChange:Ie,inputId:Ee})}),(0,n.jsx)(de.D,{label:"Color series by",children:(0,n.jsx)(o.z,{value:pe?.seriesBy??"last",options:pt,onChange:dt})})]})}return(0,n.jsx)(W.l6,{minMenuHeight:200,options:De,value:Pt,onChange:Ie,inputId:Ee})},re=({mode:pe,theme:Se})=>{if(!pe.getColors)return null;const fe=pe.getColors(Se).map(Se.visualization.getColorByName),Ee={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(pe.isContinuous)Ee.background=`linear-gradient(90deg, ${fe.join(",")})`;else{let Pe="",he="";for(let be=0;be<fe.length;be++){const Ae=fe[be];if(Pe==="")Pe=`linear-gradient(90deg, ${Ae} 0%`;else{const Ie=be/(fe.length-1)*100;Pe+=`, ${he} ${Ie}%, ${Ae} ${Ie}%`}he=Ae}Ee.background=Pe}return(0,n.jsx)("div",{style:Ee})},ue=pe=>({group:(0,p.css)({display:"flex"}),select:(0,p.css)({marginRight:pe.spacing(1),flexGrow:1})});var Te=e(91890),ge=e(64919);const Oe=({value:pe,onChange:Se,context:fe})=>(0,n.jsx)(ge.e,{links:pe,onChange:Se,data:fe.data,getSuggestions:()=>fe.getSuggestions?fe.getSuggestions(Te.uP.Values):[]});class Ue extends a.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:Se}=this.props,{settings:fe}=Se;let Ee=Se.settings?.options||[];fe?.getOptions&&(Ee=await fe.getOptions(this.props.context)),this.state.options!==Ee&&this.setState({isLoading:!1,options:Ee})}}componentDidMount(){this.updateOptions()}componentDidUpdate(Se){const fe=Se.item?.settings,Ee=this.props.item?.settings;if(fe!==Ee)this.updateOptions();else if(Ee?.getOptions){const Pe=Se.context?.data,he=this.props.context?.data;Pe!==he&&this.updateOptions()}}render(){const{options:Se,isLoading:fe}=this.state,{value:Ee,onChange:Pe,item:he}=this.props,{settings:be}=he;return(0,n.jsx)(W.KF,{isLoading:fe,value:Ee,defaultValue:Ee,allowCustomValue:be?.allowCustomValue,onChange:Ae=>{Pe(Ae.map(De=>De.value).flatMap(De=>De!==void 0?[De]:[]))},options:Se})}}var Xe=e(72626);class we extends a.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:Se}=this.props,{settings:fe}=Se;let Ee=Se.settings?.options||[];fe?.getOptions&&(Ee=await fe.getOptions(this.props.context)),this.state.options!==Ee&&this.setState({isLoading:!1,options:Ee})}}componentDidMount(){this.updateOptions()}componentDidUpdate(Se){const fe=Se.item?.settings,Ee=this.props.item?.settings;if(fe!==Ee)this.updateOptions();else if(Ee?.getOptions){const Pe=Se.context?.data,he=this.props.context?.data;Pe!==he&&this.updateOptions()}}render(){const{options:Se,isLoading:fe}=this.state,{value:Ee,onChange:Pe,item:he}=this.props,{settings:be}=he;let Ae=Se.find(De=>De.value===Ee);return!Ae&&Ee&&(Ae={label:`${Ee}`,value:Ee}),(0,n.jsx)(W.l6,{isLoading:fe,value:Ae,defaultValue:Ee,allowCustomValue:be?.allowCustomValue,isClearable:be?.isClearable,onChange:De=>Pe(De?.value),options:Se})}}var qe=e(57602),We=e(42734);const Ce=({value:pe,onChange:Se,item:fe,id:Ee})=>(0,n.jsx)(We.S,{stats:pe,onChange:Se,allowMultiple:!!fe.settings?.allowMultiple,defaultStat:fe.settings?.defaultStat,inputId:Ee});var je=e(29286),Ke=e(32264);class _e extends a.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=Se=>{const{value:fe,onChange:Ee}=this.props,Pe=[...fe];Pe.splice(Se,1),Ee(Pe)},this.onValueChange=(Se,fe)=>{if("key"in Se&&Se.key!=="Enter")return;const{value:Ee,onChange:Pe}=this.props,he=Se.currentTarget.value.trim();if(fe<0){he&&(Se.currentTarget.value="",Pe([...Ee,he])),this.setState({showAdd:!1});return}if(!he)return this.onRemoveString(fe);const be=[...Ee];be[fe]=he,Pe(be)}}render(){const{value:Se,item:fe}=this.props,{showAdd:Ee}=this.state,Pe=Fe(Ke.$.theme2),he=fe.settings?.placeholder||"Add text";return(0,n.jsxs)("div",{children:[Se.map((be,Ae)=>(0,n.jsx)(f.p,{className:Pe.textInput,defaultValue:be||"",onBlur:De=>this.onValueChange(De,Ae),onKeyDown:De=>this.onValueChange(De,Ae),suffix:(0,n.jsx)(N.I,{className:Pe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(Ae)})},`${Ae}/${be}`)),Ee?(0,n.jsx)(f.p,{autoFocus:!0,className:Pe.textInput,placeholder:he,defaultValue:"",onBlur:be=>this.onValueChange(be,-1),onKeyDown:be=>this.onValueChange(be,-1),suffix:(0,n.jsx)(N.I,{name:"plus-circle"})}):(0,n.jsx)(y.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:he})]})}}const Fe=(0,D.N)(pe=>({textInput:(0,p.css)({marginBottom:"5px","&:hover":{border:`1px solid ${pe.components.input.borderHover}`}}),trashIcon:(0,p.css)({color:pe.colors.text.secondary,cursor:"pointer","&:hover":{color:pe.colors.text.primary}})}));var at=e(2056);function Ct({value:pe,onChange:Se,item:fe}){const Ee=(0,O.of)(Dt);return fe?.settings?.isClearable&&pe!=null?(0,n.jsxs)("div",{className:Ee.wrapper,children:[(0,n.jsx)("span",{className:Ee.first,children:(0,n.jsx)(at.p,{value:pe,onChange:Se})}),(0,n.jsx)(h.K,{name:"times",onClick:()=>Se(void 0),tooltip:"Clear unit selection"})]}):(0,n.jsx)(at.p,{value:pe,onChange:Se})}const Dt=pe=>({wrapper:(0,p.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,p.css)({marginRight:pe.spacing(1),flexGrow:2})}),tt=()=>{const pe={id:"number",name:"Number",description:"Allows numeric values input",editor:Xe.w},Se={id:"slider",name:"Slider",description:"Allows numeric values input",editor:qe.G},fe={id:"text",name:"Text",description:"Allows string values input",editor:je.g},Ee={id:"strings",name:"String array",description:"An array of strings",editor:_e},Pe={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(Yt){const{id:qt,...bn}=Yt;return(0,n.jsx)(g.d,{...bn,onChange:Mt=>Yt.onChange(Mt.currentTarget.checked)})}},he={id:"select",name:"Select",description:"Allows option selection",editor:we},be={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Ue},Ae={id:"radio",name:"Radio",description:"Allows option selection",editor(Yt){return(0,n.jsx)(o.z,{...Yt,options:Yt.item.settings?.options})}},De={id:"unit",name:"Unit",description:"Allows unit input",editor:Ct},Ie={id:"color",name:"Color",description:"Allows color selection",editor(Yt){return(0,n.jsx)(oe.a,{value:Yt.value,onChange:Yt.onChange,settings:Yt.item.settings,details:!0})}},ke={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:xe},dt={id:"links",name:"Links",description:"Allows defining data links",editor:Oe},Pt={id:"stats-picker",name:"Stats Picker",editor:Ce,description:""},pt={id:"timezone",name:"Time zone",description:"Time zone selection",editor:d.U},Tt={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:c.O};return[fe,pe,Se,Pe,Ae,he,De,dt,Pt,Ee,pt,ke,Ie,be,Tt,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:ae},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:le},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:S}]},ze=()=>{const pe=["Standard options"],Se={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:s.D.get("text").editor,override:s.D.get("text").editor,process:l.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:pe},fe={id:"unit",path:"unit",name:"Unit",description:"",editor:s.D.get("unit").editor,override:s.D.get("unit").editor,process:l.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:pe},Ee={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:s.D.get("boolean").editor,override:s.D.get("boolean").editor,process:l.FM,shouldApply:pt=>pt.type===r.PU.number,showIf:pt=>pt.min===void 0||pt.max===void 0,category:pe},Pe={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:s.D.get("number").editor,override:s.D.get("number").editor,process:l.m0,settings:{placeholder:"auto"},shouldApply:pt=>pt.type===r.PU.number,category:pe},he={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:s.D.get("number").editor,override:s.D.get("number").editor,process:l.m0,settings:{placeholder:"auto"},shouldApply:pt=>pt.type===r.PU.number,category:pe},be={id:"decimals",path:"decimals",name:"Decimals",editor:s.D.get("number").editor,override:s.D.get("number").editor,process:l.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:pt=>pt.type===r.PU.number,category:pe},Ae={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:s.D.get("text").editor,override:s.D.get("text").editor,process:l.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:pe},De={id:"links",path:"links",name:"Data links",editor:s.D.get("links").editor,override:s.D.get("links").editor,process:l.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:["Data links"],getItemsCount:pt=>pt?pt.length:0},Ie={id:"color",path:"color",name:"Color scheme",editor:s.D.get("fieldColor").editor,override:s.D.get("fieldColor").editor,process:l.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:pe},ke={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:s.D.get("mappings").editor,override:s.D.get("mappings").editor,process:l.xT,settings:{},defaultValue:[],shouldApply:pt=>pt.type!==r.PU.time,category:["Value mappings"],getItemsCount:pt=>pt?pt.length:0},dt={id:"thresholds",path:"thresholds",name:"Thresholds",editor:s.D.get("thresholds").editor,override:s.D.get("thresholds").editor,process:l.N7,settings:{},defaultValue:{mode:i.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:pt=>pt?pt.steps.length:0},Pt={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:s.D.get("boolean").editor,override:s.D.get("boolean").editor,process:l.FM,shouldApply:()=>!0,settings:{},category:pe};return[fe,Pe,he,Ee,be,Se,Ie,Ae,De,ke,dt,Pt]}},57602:(k,A,e)=>{"use strict";e.d(A,{G:()=>c});var n=e(74848),s=e(32196),l=e(94659),r=e(9821),i=e(96540),g=e(40845),o=e(24849),d=e(60188);const c=({value:u,onChange:m,item:v})=>{const x=(0,i.useRef)(null),{settings:f}=v,E=f?.min||0,h=f?.max||100,y=f?.step,b=f?.marks||{[E]:E,[h]:h},D=f?.included,P=f?.ariaLabelForHandle,C=75,M=!0,I=(0,g.$j)(),[R,T]=(0,i.useState)(u??E),[S,L]=(0,i.useState)(C);(0,i.useEffect)(()=>{u!=null&&u!==R&&T(u)},[u,R]),(0,i.useEffect)(()=>{const w=getComputedStyle(x.current),B=w.getPropertyValue("font-weight")||"normal",K=w.getPropertyValue("font-size")||"16px",W=w.getPropertyValue("font-family")||"Arial",z="0",Y=4,X=8,q=Math.max((h+(y||0)).toString().length,(h-(y||0)).toString().length)+Y,G=z.repeat(q),te=a(G,`${B} ${K} ${W}`);te&&L(te+X*2)},[h,y]);const O=(0,i.useCallback)(w=>{const B=typeof w=="number"?w:w[0];T(B),m&&m(B)},[T,m]),j=(0,i.useCallback)(w=>{let B=w;(Number.isNaN(B)||!B)&&(B=0),T(B),m&&m(B)},[m]),N=(0,o.$)(I,M,!!b),F=p(I,S),U=M?[]:[N.sliderInputVertical];return(0,n.jsxs)("div",{className:(0,s.cx)(N.container,N.slider),children:[(0,n.jsx)(l.Global,{styles:N.slider}),(0,n.jsxs)("div",{className:(0,s.cx)(N.sliderInput,...U),children:[(0,n.jsx)(r.A,{min:E,max:h,step:y,defaultValue:u,value:R,onChange:O,vertical:!M,reverse:!1,ariaLabelForHandle:P,marks:b,included:D}),(0,n.jsx)("span",{className:F.numberInputWrapper,ref:x,children:(0,n.jsx)(d.Q,{value:R,onChange:j,max:h,min:E,step:y})})]})]})};function a(u,m){const x=document.createElement("canvas").getContext("2d");return x?(x.font=m,x.measureText(u).width):null}const p=(u,m)=>({numberInputWrapper:(0,s.css)({marginLeft:u.spacing(3),maxHeight:"32px",maxWidth:m,minWidth:m,overflow:"visible",width:"100%"})})},29286:(k,A,e)=>{"use strict";e.d(A,{g:()=>i});var n=e(74848),s=e(96540),l=e(21744),r=e(10354);const i=({value:g,onChange:o,item:d,suffix:c})=>{const a=d.settings?.useTextarea?l.f:r.p,p=(0,s.useCallback)(u=>{let m=g??"";"key"in u?u.key==="Enter"&&!d.settings?.useTextarea&&(m=u.currentTarget.value.trim()):m=u.currentTarget.value.trim(),m!==g&&o(m===""?void 0:m)},[g,d.settings?.useTextarea,o]);return(0,n.jsx)(a,{placeholder:d.settings?.placeholder,defaultValue:g||"",rows:d.settings?.useTextarea&&d.settings.rows||5,onBlur:p,onKeyDown:p,suffix:c})}},69444:(k,A,e)=>{"use strict";e.d(A,{Y:()=>K});var n=e(74848),s=e(32196),l=e(96540),r=e(64388),i=e(32264),g=e(40845),o=e(76888);function d({children:z,scrollRefCallback:Y,scrollTop:X,divId:q}){const G=(0,g.of)(c),te=(0,l.useRef)(null);return(0,l.useEffect)(()=>{!i.$.featureToggles.bodyScrolling&&te.current&&Y&&Y(te.current)},[te,Y]),(0,l.useEffect)(()=>{!i.$.featureToggles.bodyScrolling&&te.current&&X!=null&&te.current?.scrollTo(0,X)},[X]),i.$.featureToggles.bodyScrolling?z:(0,n.jsx)("div",{ref:te,className:(0,s.cx)(G.nativeScrollbars,"scrollbar-view"),id:q,children:z})}function c(){return{nativeScrollbars:(0,s.css)({label:"native-scroll-container",minHeight:"calc(100% + 0px)",maxHeight:"calc(100% + 0px)",display:"flex",flexDirection:"column",flexGrow:1,overflow:"auto"})}}var a=e(39419);const p=({isLoading:z,children:Y,className:X})=>{let q=X?(0,n.jsx)("div",{className:X,children:Y}):Y;return(0,n.jsx)(n.Fragment,{children:z?(0,n.jsx)(a.A,{}):q})};var u=e(13773),m=e(17172),v=e(94753),x=e(29158),f=e(88575),E=e(10354);const h=({value:z,onEdit:Y})=>{const X=(0,g.of)(y),[q,G]=(0,l.useState)(z),[te,H]=(0,l.useState)(!1),[se,ne]=(0,l.useState)(!1),[le,_]=(0,l.useState)();(0,l.useEffect)(()=>{G(z)},[z]);const Q=(0,l.useCallback)(async ae=>{const oe=ae.currentTarget.value;if(!oe)_("Please enter a title");else if(oe===z)_(void 0),H(!1);else{ne(!0);try{await Y(oe),_(void 0),H(!1)}catch(J){(0,m.NF)(J)?_(J.data.message):J instanceof Error&&_(J.message)}ne(!1)}},[Y,z]);return te?(0,n.jsx)("div",{className:X.inputContainer,children:(0,n.jsx)(f.D,{className:X.field,loading:se,invalid:!!le,error:le,children:(0,n.jsx)(E.p,{className:X.input,defaultValue:q,onKeyDown:ae=>{ae.key==="Enter"&&Q(ae)},autoFocus:!0,onBlur:Q,onChange:ae=>G(ae.currentTarget.value),onFocus:()=>H(!0)})})}):(0,n.jsx)("div",{className:X.textContainer,children:(0,n.jsxs)("div",{className:X.textWrapper,children:[(0,n.jsx)(v.E,{element:"h1",truncate:!0,children:q}),(0,n.jsx)(x.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>H(!0)})]})})};h.displayName="EditableTitle";const y=z=>({textContainer:(0,s.css)({minWidth:0}),field:(0,s.css)({flex:1,left:`calc(-${z.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,s.css)({input:{...z.typography.h1}}),inputContainer:(0,s.css)({display:"flex",flex:1}),textWrapper:(0,s.css)({alignItems:"center",display:"flex",gap:z.spacing(1)})});function b({navItem:z,renderTitle:Y,actions:X,info:q,subTitle:G,onEditTitle:te}){const H=(0,g.of)(D),se=G??z.subTitle,ne=te?(0,n.jsx)(h,{value:z.text,onEdit:te}):(0,n.jsxs)("div",{className:H.title,children:[z.img&&(0,n.jsx)("img",{className:H.img,src:z.img,alt:`logo for ${z.text}`}),Y?Y(z.text):(0,n.jsx)("h1",{children:z.text})]});return(0,n.jsxs)("div",{className:H.pageHeader,children:[(0,n.jsxs)("div",{className:H.topRow,children:[(0,n.jsxs)("div",{className:H.titleInfoContainer,children:[ne,q&&(0,n.jsx)(u.Q,{info:q})]}),(0,n.jsx)("div",{className:H.actions,children:X})]}),se&&(0,n.jsx)("div",{className:H.subTitle,children:se})]})}const D=z=>({topRow:(0,s.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:z.spacing(1,3)}),title:(0,s.css)({display:"flex",flexDirection:"row",maxWidth:"100%",h1:{display:"flex",marginBottom:0}}),actions:(0,s.css)({display:"flex",flexDirection:"row",gap:z.spacing(1)}),titleInfoContainer:(0,s.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:z.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,s.css)({label:"page-header",display:"flex",flexDirection:"column",gap:z.spacing(1),marginBottom:z.spacing(2)}),subTitle:(0,s.css)({position:"relative",color:z.colors.text.secondary}),img:(0,s.css)({width:"32px",height:"32px",marginRight:z.spacing(2)})});var P=e(63021),C=e(8984),M=e(40675);function I({navItem:z}){const Y=(0,g.of)(R);return(0,n.jsx)("div",{className:Y.tabsWrapper,children:(0,n.jsx)(P.U,{children:z.children.map((X,q)=>{const G=X.icon?(0,C.toIconName)(X.icon):void 0;return!X.hideFromTabs&&(0,n.jsx)(M.o,{label:X.text,active:X.active,icon:G,counter:X.tabCounter,href:X.url,suffix:X.tabSuffix,onChangeTab:X.onClick},`${X.url}-${q}`)})})})}const R=z=>({tabsWrapper:(0,s.css)({paddingBottom:z.spacing(3)})});var T=e(25508),S=e(17422),L=e(99140),O=e(31678);function j(z,Y){if(Y)return Y;if(z&&L.M_)return(0,O.useSelector)((0,T.Mz)(N,X=>(0,S.tc)(X,z??"home")))}function N(z){return z.navIndex}var F=e(28215),U=e(19361),w=e(3984);function B(z,Y){const X=(0,O.useSelector)(q=>q.navIndex)?.[F.Id];(0,l.useEffect)(()=>{const q=(z?.node!==z?.main?z?.node:z?.main)??{text:"Grafana"},G=(0,w.Z)(q,Y,X).map(te=>te.text).reverse();G[G.length-1]=U.M.AppTitle,document.title=G.join(" - ")},[X,z,Y])}const K=({navId:z,navModel:Y,pageNav:X,renderTitle:q,onEditTitle:G,actions:te,subTitle:H,children:se,className:ne,info:le,layout:_=r.k.Standard,scrollTop:Q,scrollRef:ae,...oe})=>{const J=(0,g.of)(W),ee=j(z,Y),{chrome:de}=(0,o.Il)();B(ee,X);const xe=X??ee?.node;return(0,l.useLayoutEffect)(()=>{ee&&de.update({sectionNav:ee,pageNav:X,layout:_})},[ee,X,de,_]),(0,n.jsxs)("div",{className:(0,s.cx)(J.wrapper,ne),...oe,children:[_===r.k.Standard&&(0,n.jsx)(d,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:Q,scrollRefCallback:ae,children:(0,n.jsxs)("div",{className:J.pageInner,children:[xe&&(0,n.jsx)(b,{actions:te,onEditTitle:G,navItem:xe,renderTitle:q,info:le,subTitle:H}),X&&X.children&&(0,n.jsx)(I,{navItem:X}),(0,n.jsx)("div",{className:J.pageContent,children:se})]})}),_===r.k.Canvas&&(0,n.jsx)(d,{divId:"page-scrollbar",autoHeightMin:"100%",scrollTop:Q,scrollRefCallback:ae,children:(0,n.jsx)("div",{className:J.canvasContent,children:se})}),_===r.k.Custom&&se]})};K.Contents=p;const W=z=>({wrapper:(0,s.css)(i.$.featureToggles.bodyScrolling?{label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",position:"relative"}:{label:"page-wrapper",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0}),pageContent:(0,s.css)({label:"page-content",flexGrow:1}),primaryBg:(0,s.css)({background:z.colors.background.primary}),pageInner:(0,s.css)({label:"page-inner",padding:z.spacing(2),borderBottom:"none",background:z.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:z.spacing(0,0,0,0),[z.breakpoints.up("md")]:{padding:z.spacing(4)}}),canvasContent:(0,s.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:z.spacing(2),flexBasis:"100%",flexGrow:1})})},13773:(k,A,e)=>{"use strict";e.d(A,{Q:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(40845);function i({info:o}){const d=(0,r.of)(g);return(0,n.jsx)("div",{className:d.container,children:o.map((c,a)=>(0,n.jsxs)(l.Fragment,{children:[(0,n.jsxs)("div",{className:d.infoItem,children:[(0,n.jsx)("div",{className:d.label,children:c.label}),c.value]}),a+1<o.length&&(0,n.jsx)("div",{"data-testid":"page-info-separator",className:d.separator})]},a))})}const g=o=>({container:(0,s.css)({display:"flex",flexDirection:"row",gap:o.spacing(1.5),overflow:"auto"}),infoItem:(0,s.css)({...o.typography.bodySmall,display:"flex",flexDirection:"column",gap:o.spacing(.5)}),label:(0,s.css)({color:o.colors.text.secondary}),separator:(0,s.css)({borderLeft:`1px solid ${o.colors.border.weak}`})})},39419:(k,A,e)=>{"use strict";e.d(A,{A:()=>i});var n=e(74848),s=e(90613),l=e(39558);const i=({pageName:g=""})=>{const o=`Loading ${g}...`;return(0,n.jsx)(s.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,n.jsx)(l._,{text:o})})}},7392:(k,A,e)=>{"use strict";e.d(A,{L:()=>o});var n=e(74848),s=e(32196),l=e(13544),r=e(40845),i=e(69529),g=e(72109);function o({entity:c="Page"}){const a=(0,r.of)(d);return(0,n.jsx)("div",{className:a.container,"data-testid":l.Tp.components.EntityNotFound.container,children:(0,n.jsxs)(i.p,{message:`${c} not found`,variant:"not-found",children:["We're looking but can't seem to find this ",c.toLowerCase(),". Try returning"," ",(0,n.jsx)(g.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,n.jsx)(g.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})}function d(c){return{container:(0,s.css)({padding:c.spacing(8,2,2,2)})}}},68313:(k,A,e)=>{"use strict";e.d(A,{$:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(55852),o=e(90182),d=e(14578),c=e(17706);const a=({onChange:u,maxMenuHeight:m,isWidget:v=!1})=>{const x=()=>r.$.featureToggles.vizAndWidgetSplit?v?(0,c.nr)():(0,c.if)():(0,c.A4)(),f=(0,l.useMemo)(x,[v]),E=(0,l.useMemo)(()=>f.map(C=>({label:C.name,imgUrl:C.info.logos.small,value:C})).sort((C,M)=>C.label?.localeCompare(M.label)),[f]),[h,y]=(0,l.useState)([]),b=(0,l.useCallback)(C=>{const M=C.filter(I=>I.value).map(I=>I.value);u(M),y(C)},[u]),D=(0,i.of)(p),P={defaultOptions:!0,getOptionLabel:C=>C.label,getOptionValue:C=>C.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:m,options:E,value:h,onChange:b};return(0,n.jsxs)("div",{className:D.container,children:[h.length>0&&(0,n.jsx)(g.$n,{size:"xs",icon:"trash-alt",fill:"text",className:D.clear,onClick:()=>b([]),"aria-label":"Clear types",children:"Clear types"}),(0,n.jsx)(o.KF,{...P,prefix:(0,n.jsx)(d.I,{name:"filter"}),"aria-label":"Panel Type filter"})]})};function p(u){return{container:(0,s.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,s.css)`
      label: clear;
      font-size: ${u.spacing(1.5)};
      position: absolute;
      top: -${u.spacing(4.5)};
      right: 0;
    `}}},78361:(k,A,e)=>{"use strict";e.d(A,{s:()=>g});var n=e(74848),s=e(96540),l=e(13544),r=e(10354),i=e(29158);const g=(0,s.forwardRef)((o,d)=>{const[c,a]=(0,s.useState)(!1);return(0,n.jsx)(r.p,{...o,type:c?"text":"password","data-testid":l.Tp.pages.Login.password,ref:d,suffix:(0,n.jsx)(i.K,{name:c?"eye-slash":"eye","aria-controls":o.id,role:"switch","aria-checked":c,onClick:()=>{a(!c)},tooltip:c?"Hide password":"Show password"})})});g.displayName="PasswordField"},22214:(k,A,e)=>{"use strict";e.d(A,{j:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(36663),i=e(40845);const g=l.memo(l.forwardRef(({className:c,children:a,markdown:p,styleOverrides:u,onRemove:m,...v},x)=>{const f=(0,i.of)(E=>d(E,u?.borderTop));return(0,n.jsxs)("div",{className:(0,s.cx)(f.wrapper,c),...v,ref:x,children:[p&&o(p),a]})}));function o(c){const a=(0,r.G)(c);return(0,n.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:a}})}g.displayName="OperationRowHelp";const d=(c,a)=>{const p=c.shape.radius.default,u=c.colors.background.secondary;return{wrapper:(0,s.css)`
      padding: ${c.spacing(2)};
      border: 2px solid ${u};
      border-top: ${a?a+u:"none"};
      border-radius: 0 0 ${p} ${p};
      position: relative;
      top: -4px;
    `}}},10343:(k,A,e)=>{"use strict";e.d(A,{A:()=>d,q:()=>o});var n=e(74848),s=e(32196),l=e(13544),r=e(40845),i=e(29158);function g(a){const p=(0,r.of)(c);return(0,n.jsx)("div",{className:(0,s.cx)(p.icon,"active"in a&&a.active&&p.active),children:(0,n.jsx)(i.K,{name:a.icon,tooltip:a.title,className:p.icon,disabled:!!a.disabled,onClick:a.onClick,type:"button","data-testid":a.dataTestId??l.Tp.components.QueryEditorRow.actionButton(a.title),..."active"in a&&{"aria-pressed":a.active}})})}function o(a){return(0,n.jsx)(g,{...a})}const d=a=>(0,n.jsx)(g,{...a}),c=a=>({icon:(0,s.css)({display:"flex",position:"relative",color:a.colors.text.secondary}),active:(0,s.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:a.shape.radius.default,bottom:-8,backgroundImage:a.colors.gradients.brandHorizontal}})})},7788:(k,A,e)=>{"use strict";e.d(A,{u:()=>x});var n=e(74848),s=e(32196),l=e(91076),r=e(96540),i=e(22589),g=e(14110),o=e(40845),d=e(67892),c=e(29158),a=e(67061),p=e(14578),u=e(8484);const m=({actionsElement:E,disabled:h,draggable:y,collapsable:b=!0,dragHandleProps:D,headerElement:P,isContentVisible:C,onRowToggle:M,reportDragMousePosition:I,title:R,id:T,expanderMessages:S})=>{const L=(0,o.of)(v);let O=C?(0,u.t)("query-operation.header.collapse-row","Collapse query row"):(0,u.t)("query-operation.header.expand-row","Expand query row");S!==void 0&&C?O=S.close:S!==void 0&&(O=S?.open);const j=(0,u.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,n.jsxs)("div",{className:L.header,children:[(0,n.jsxs)("div",{className:L.column,children:[b&&(0,n.jsx)(c.K,{name:C?"angle-down":"angle-right",tooltip:O,className:L.collapseIcon,onClick:M,"aria-expanded":C,"aria-controls":T}),R&&(0,n.jsx)("div",{className:L.titleWrapper,onClick:M,"aria-label":"Query operation row title",children:(0,n.jsx)("div",{className:(0,s.cx)(L.title,h&&L.disabled),children:R})}),P]}),(0,n.jsxs)(a.B,{gap:1,alignItems:"center",children:[E,y&&(0,n.jsx)("div",{onMouseMove:I,...D,children:(0,n.jsx)(p.I,{title:j,name:"draggabledots",size:"lg",className:L.dragIcon})})]})]})},v=E=>({header:(0,s.css)`
    label: Header;
    padding: ${E.spacing(.5,.5)};
    border-radius: ${E.shape.radius.default};
    background: ${E.colors.background.secondary};
    min-height: ${E.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,s.css)`
    label: Column;
    display: flex;
    align-items: center;
  `,dragIcon:(0,s.css)`
    cursor: grab;
    color: ${E.colors.text.disabled};
    margin: ${E.spacing(0,.5)};
    &:hover {
      color: ${E.colors.text};
    }
  `,collapseIcon:(0,s.css)`
    margin-left: ${E.spacing(.5)};
    color: ${E.colors.text.disabled};
    }
  `,titleWrapper:(0,s.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${E.spacing(.5)};
  `,title:(0,s.css)`
    font-weight: ${E.typography.fontWeightBold};
    color: ${E.colors.text.link};
    margin-left: ${E.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,s.css)`
    color: ${E.colors.text.disabled};
  `});m.displayName="QueryOperationRowHeader";function x({children:E,actions:h,title:y,headerElement:b,onClose:D,onOpen:P,isOpen:C,disabled:M,draggable:I,collapsable:R,index:T,id:S,expanderMessages:L}){const[O,j]=(0,r.useState)(C!==void 0?C:!0),N=(0,o.of)(f),F=(0,r.useCallback)(()=>{j(!O)},[O,j]);(0,r.useEffect)(()=>{typeof C=="boolean"&&j(C)},[C]);const U=(0,r.useCallback)(W=>{if(W.defaultPrevented){const z=W.currentTarget.getBoundingClientRect(),Y=W.clientX-z.left,X=W.clientY-z.top;(0,g.rR)("query_row_reorder_drag_position",{x:Y/z.width,y:X/z.height,width:z.width,height:z.height})}},[]);(0,i.A)(()=>{O?P&&P():D&&D()},[O]);const w={isOpen:O,onOpen:()=>{j(!0)},onClose:()=>{j(!1)}},B=h&&d.renderOrCallToRender(h,w),K=b&&d.renderOrCallToRender(b,w);return I?(0,n.jsx)(l.sx,{draggableId:S,index:T,children:W=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{ref:W.innerRef,className:N.wrapper,...W.draggableProps,children:[(0,n.jsx)("div",{children:(0,n.jsx)(m,{id:S,actionsElement:B,disabled:M,draggable:!0,collapsable:R,dragHandleProps:W.dragHandleProps,headerElement:K,isContentVisible:O,onRowToggle:F,reportDragMousePosition:U,title:y,expanderMessages:L})}),O&&(0,n.jsx)("div",{className:N.content,children:E})]})})}):(0,n.jsxs)("div",{className:N.wrapper,children:[(0,n.jsx)(m,{id:S,actionsElement:B,disabled:M,draggable:!1,collapsable:R,headerElement:K,isContentVisible:O,onRowToggle:F,reportDragMousePosition:U,title:y,expanderMessages:L}),O&&(0,n.jsx)("div",{className:N.content,children:E})]})}const f=E=>({wrapper:(0,s.css)`
      margin-bottom: ${E.spacing(2)};
    `,content:(0,s.css)`
      margin-top: ${E.spacing(.5)};
      margin-left: ${E.spacing(3)};
    `});x.displayName="QueryOperationRow"},37425:(k,A,e)=>{"use strict";e.d(A,{n:()=>xe});var n=e(74848),s=e(96540),l=e(40845),r=e(8866),i=e(17464),g=e(32196),o=e(62930),d=e(14578),c=e(56034),a=e(10354),p=e(87266),u=e(16797),m=e(88824);const v=(0,s.forwardRef)(({children:re,iconName:ue},Te)=>{const ge=(0,l.of)(x);return(0,n.jsxs)("div",{className:ge.container,ref:Te,children:[ue&&(0,n.jsx)(d.I,{name:ue,size:"xs"}),re]})});v.displayName="ValueContainer";const x=re=>{const{prefix:ue}=(0,a.n)({theme:re}),{multiValueContainer:Te}=(0,m.J)(re);return{container:(0,g.cx)(ue,Te,(0,g.css)`
        position: relative;
        padding: ${re.spacing(.5,1,.5,1)};

        svg {
          margin-right: ${re.spacing(.5)};
        }
      `)}},f=360,E=300,h=320,y=360,b=320,D=360,P=y+D,C=re=>re.stopPropagation(),M=({appliedRoles:re,basicRole:ue,disabled:Te,isFocused:ge,query:Oe,showBasicRole:Ue,width:Xe,isLoading:we,onOpen:qe,onClose:We,onQueryChange:Ce,...je})=>{const Ke=(0,l.of)(R,!1,!!ge,!!Te,!1,Xe),_e=(0,s.useRef)(null);(0,s.useEffect)(()=>{ge&&_e.current?.focus()});const Fe=Ct=>{const Dt=Ct.target?.value;Ce(Dt)},at=Ue&&ue!=="None";return ge?(0,n.jsxs)("div",{className:Ke.wrapper,children:[at&&(0,n.jsx)(v,{children:ue}),re.map(Ct=>(0,n.jsx)(v,{children:Ct.group+":"+(Ct.displayName||Ct.name)},Ct.uid)),!Te&&(0,n.jsx)("input",{...je,className:Ke.input,ref:_e,onMouseDown:C,onChange:Fe,"data-testid":"role-picker-input",placeholder:ge?"Select role":"",value:Oe}),(0,n.jsx)("div",{className:Ke.suffix,children:(0,n.jsx)(d.I,{name:"angle-up",className:Ke.dropdownIndicator,onMouseDown:We})})]}):(0,n.jsxs)("div",{className:(0,g.cx)(Ke.wrapper,Ke.selectedRoles),onMouseDown:qe,children:[at&&(0,n.jsx)(v,{children:ue}),(0,n.jsx)(I,{appliedRoles:re,numberOfRoles:re.length,showBuiltInRole:at}),we&&(0,n.jsx)("div",{className:Ke.spinner,children:(0,n.jsx)(o.y,{size:16,inline:!0})})]})};M.displayName="RolePickerInput";const I=({showBuiltInRole:re,numberOfRoles:ue,appliedRoles:Te})=>{const ge=(0,l.of)(Oe=>T(Oe));return(0,n.jsx)(n.Fragment,{children:ue?(0,n.jsx)(c.m,{content:(0,n.jsx)("div",{className:ge.tooltip,children:Te?.map(Oe=>(0,n.jsx)("p",{children:Oe.group+":"+(Oe.displayName||Oe.name)},Oe.uid))}),children:(0,n.jsx)(v,{children:`${re?"+":""}${ue} role${ue>1?"s":""}`})}):!re&&(0,n.jsx)(v,{children:"No roles assigned"})})},R=(re,ue,Te,ge,Oe,Ue)=>{const Xe=(0,a.n)({theme:re,invalid:ue});return{wrapper:(0,g.cx)(Xe.wrapper,(0,p.Xb)(re,ue),Te&&(0,g.css)`
          ${u.focusCss(re.v1)}
        `,ge&&Xe.inputDisabled,(0,g.css)({minWidth:Ue||f+"px",width:Ue,minHeight:"32px",maxHeight:"200px",overflow:"scroll",overflowX:"hidden",overflowY:"auto",height:"auto",flexDirection:"row",paddingRight:re.spacing(1),maxWidth:"100%",alignItems:"center",display:"flex",flexWrap:"wrap",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",cursor:"default"}),Oe&&(0,g.css)`
          padding-left: 0;
        `),input:(0,g.cx)((0,p.Xb)(re,ue),(0,g.css)`
        max-width: 120px;
        border: none;
        cursor: ${Te?"default":"pointer"};
      `),suffix:Xe.suffix,dropdownIndicator:(0,g.css)`
      cursor: pointer;
    `,selectedRoles:(0,g.css)`
      display: flex;
      align-items: center;
      cursor: ${ge?"not-allowed":"pointer"};
    `,tooltip:(0,g.css)`
      p {
        margin-bottom: ${re.spacing(.5)};
      }
    `,spinner:(0,g.css)({display:"flex",flexGrow:1,justifyContent:"flex-end"})}},T=re=>({tooltip:(0,g.css)`
    p {
      margin-bottom: ${re.spacing(.5)};
    }
  `});var S=e(72109),L=e(40276),O=e(67061),j=e(55852),N=e(83186),F=e(31678);const U=re=>({hideScrollBar:(0,g.css)({".scrollbar-view":{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}}),menuWrapper:(0,g.css)({display:"flex",maxHeight:"650px",position:"absolute",zIndex:re.zIndex.dropdown,overflow:"hidden",minWidth:"auto"}),menu:(0,g.css)({minWidth:`${h}px`,maxWidth:`${y}px`,"& > div":{paddingTop:re.spacing(1)}}),menuLeft:(0,g.css)({flexDirection:"row-reverse"}),subMenu:(0,g.css)({height:"100%",minWidth:`${b}px`,maxWidth:`${D}px`,display:"flex",flexDirection:"column",borderLeft:`1px solid ${re.components.input.borderColor}`,"& > div":{paddingTop:re.spacing(1)}}),subMenuLeft:(0,g.css)({borderRight:`1px solid ${re.components.input.borderColor}`,borderLeft:"unset"}),groupHeader:(0,g.css)({padding:re.spacing(0,4.5),display:"flex",alignItems:"center",color:re.colors.text.primary,fontWeight:re.typography.fontWeightBold}),container:(0,g.css)({padding:re.spacing(1),border:`1px ${re.colors.border.weak} solid`,borderRadius:re.shape.radius.default,backgroundColor:re.colors.background.primary,zIndex:re.zIndex.modal}),menuSection:(0,g.css)({marginBottom:re.spacing(2)}),menuOptionCheckbox:(0,g.css)({display:"flex",margin:re.spacing(0,1,0,.25)}),menuButtonRow:(0,g.css)({backgroundColor:re.colors.background.primary,padding:re.spacing(1)}),menuOptionBody:(0,g.css)({fontWeight:re.typography.fontWeightRegular,padding:re.spacing(0,1.5,0,0)}),menuOptionDisabled:(0,g.css)({color:re.colors.text.disabled,cursor:"not-allowed"}),menuOptionExpand:(0,g.css)({position:"absolute",right:re.spacing(2.5),color:re.colors.text.disabled,"&:after":{content:'">"'}}),menuOptionInfoSign:(0,g.css)({color:re.colors.text.disabled}),basicRoleSelector:(0,g.css)({margin:re.spacing(1,1.25,1,1.5)}),subMenuPortal:(0,g.css)({height:"100%","> div":{height:"100%"}}),subMenuButtonRow:(0,g.css)({backgroundColor:re.colors.background.primary,padding:re.spacing(1)}),checkboxPartiallyChecked:(0,g.css)({input:{"&:checked + span":{"&:after":{borderWidth:"0 3px 0px 0",transform:"rotate(90deg)"}}}}),loadingSpinner:(0,g.css)({marginLeft:re.spacing(1)})}),w=Object.values(F.OrgRole).map(re=>({label:re===F.OrgRole.None?"No basic role":re,value:re})),B=({value:re,onChange:ue,disabled:Te,disabledMesssage:ge,tooltipMessage:Oe})=>{const Ue=(0,l.of)(U),Xe=(0,l.$j)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:Ue.groupHeader,children:[(0,n.jsx)("span",{style:{marginRight:Xe.spacing(1)},children:"Basic roles"}),Te&&ge&&(0,n.jsx)(c.m,{placement:"right-end",interactive:!0,content:(0,n.jsx)("div",{children:ge}),children:(0,n.jsx)(d.I,{name:"question-circle"})}),!Te&&Oe&&(0,n.jsx)(c.m,{placement:"right-end",interactive:!0,content:Oe,children:(0,n.jsx)(d.I,{name:"info-circle",size:"xs"})})]}),(0,n.jsx)(N.a,{name:"Basic Role Selector",className:Ue.basicRoleSelector,options:w,value:re,onChange:ue,disabled:Te})]})};var K=e(10880);const W=(0,s.memo)(s.forwardRef(({name:re,value:ue,isFocused:Te,isSelected:ge,partiallySelected:Oe,disabled:Ue,onChange:Xe,onClick:we,onOpenSubMenu:qe,onCloseSubMenu:We,children:Ce,root:je},Ke)=>{const _e=(0,l.$j)(),Fe=(0,m.J)(_e),at=(0,l.of)(U),Ct=(0,g.cx)(Fe.option,Te&&Fe.optionFocused,Ue&&at.menuOptionDisabled),Dt=Se=>{Ue||ue&&Xe(ue)},tt=Se=>{we&&we(ue)},ze=()=>{qe&&qe(ue)},pe=()=>{We&&We()};return(0,n.jsx)("div",{onMouseEnter:ze,onMouseLeave:pe,children:(0,n.jsxs)("div",{ref:Ke,className:Ct,"aria-label":"Role picker option",onClick:tt,children:[(0,n.jsx)(K.S,{value:ge,className:(0,g.cx)(at.menuOptionCheckbox,{[at.checkboxPartiallyChecked]:Oe}),onChange:Dt,disabled:Ue}),(0,n.jsxs)("div",{className:(0,g.cx)(Fe.optionBody,at.menuOptionBody),children:[(0,n.jsx)("span",{children:re}),(0,n.jsx)("span",{className:at.menuOptionExpand})]}),je&&Ce&&(0,n.jsx)(i.ZL,{className:at.subMenuPortal,root:je,children:Ce})]})})}));W.displayName="RoleMenuGroupOption";const z=(0,s.forwardRef)(({data:re,isFocused:ue,isSelected:Te,disabled:ge,onChange:Oe,hideDescription:Ue},Xe)=>{const we=(0,l.$j)(),qe=(0,m.J)(we),We=(0,l.of)(U),Ce=(0,g.cx)(qe.option,ue&&qe.optionFocused,ge&&We.menuOptionDisabled),je=Ke=>{ge||(Ke.preventDefault(),Ke.stopPropagation(),Oe(re))};return(0,n.jsxs)("div",{ref:Xe,className:Ce,"aria-label":"Role picker option",onClick:je,children:[(0,n.jsx)(K.S,{value:Te,className:We.menuOptionCheckbox,onChange:je,disabled:ge}),(0,n.jsxs)("div",{className:(0,g.cx)(qe.optionBody,We.menuOptionBody),children:[(0,n.jsx)("span",{children:re.displayName||re.name}),!Ue&&re.description&&(0,n.jsx)("div",{className:qe.optionDescription,children:re.description})]}),re.description&&(0,n.jsx)(c.m,{content:re.description,children:(0,n.jsx)(d.I,{name:"info-circle",className:We.menuOptionInfoSign})})]})});z.displayName="RoleMenuOption";var Y=e(3246);const X=({options:re,selectedOptions:ue,disabledOptions:Te,onSelect:ge,onClear:Oe,showOnLeft:Ue})=>{const Xe=(0,l.$j)(),we=(0,m.J)(Xe),qe=(0,l.of)(U),We=async()=>{Oe&&Oe()};return(0,n.jsxs)("div",{className:(0,g.cx)(qe.subMenu,{[qe.subMenuLeft]:Ue}),"aria-label":"Role picker submenu",children:[(0,n.jsx)(L.E,{autoHide:!1,autoHeightMax:`${E}px`,hideHorizontalTrack:!0,children:(0,n.jsx)("div",{className:we.optionBody,children:re.map((Ce,je)=>(0,n.jsx)(z,{data:Ce,isSelected:!!(Ce.uid&&(ue.find(Ke=>Ke.uid===Ce.uid)||Te?.find(Ke=>Ke.uid===Ce.uid))),disabled:!!(Ce.uid&&Te?.find(Ke=>Ke.uid===Ce.uid))||(0,Y.W)(Ce),onChange:ge,hideDescription:!0},je))})}),(0,n.jsx)("div",{className:qe.subMenuButtonRow,children:(0,n.jsx)(O.B,{justifyContent:"flex-end",children:(0,n.jsx)(j.$n,{size:"sm",fill:"text",onClick:We,children:"Clear"})})})]})},q=(0,s.forwardRef)(({roles:re,renderedName:ue,showGroups:Te,optionGroups:ge,onGroupChange:Oe,groupSelected:Ue,groupPartiallySelected:Xe,subMenuNode:we,selectedOptions:qe,onRoleChange:We,onClearSubMenu:Ce,showOnLeftSubMenu:je},Ke)=>{const[_e,Fe]=(0,s.useState)(!1),[at,Ct]=(0,s.useState)(""),Dt=(0,l.$j)(),tt=(0,m.J)(Dt),ze=(0,l.of)(U),pe=(0,s.useCallback)(fe=>{Ct(fe),Fe(!0)},[]),Se=(0,s.useCallback)(()=>{Fe(!1),Ct("")},[]);return(0,n.jsx)("div",{children:re.length>0&&(0,n.jsxs)("div",{className:ze.menuSection,children:[(0,n.jsx)("div",{className:ze.groupHeader,children:ue}),(0,n.jsx)("div",{className:tt.optionBody}),Te&&ge?.length?ge.map(fe=>(0,n.jsx)(W,{name:fe.name,value:fe.value,isSelected:Ue(fe.value)||Xe(fe.value),partiallySelected:Xe(fe.value),disabled:fe.options?.every(Y.W),onChange:Oe,onOpenSubMenu:pe,onCloseSubMenu:Se,root:we,isFocused:_e&&at===fe.value,children:_e&&at===fe.value&&(0,n.jsx)(X,{options:fe.options,selectedOptions:qe,onSelect:We,onClear:()=>Ce(at),showOnLeft:je})},fe.value)):re.map(fe=>(0,n.jsx)(z,{data:fe,isSelected:!!(fe.uid&&qe.find(Ee=>Ee.uid===fe.uid)),disabled:(0,Y.W)(fe),onChange:We,hideDescription:!0},fe.uid))]})})});q.displayName="RoleMenuGroupsSection";var G=(re=>(re.fixed="fixed",re.custom="custom",re.plugin="plugin",re))(G||{});const te={ldap:"LDAP",current:"Current org"},H=(0,n.jsxs)(n.Fragment,{children:['You can now select the "No basic role" option and add permissions to your custom needs. You can find more information in\xA0',(0,n.jsx)(S.Y,{href:"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles",variant:"bodySmall",external:!0,children:"our documentation"}),"."]}),se=({basicRole:re,options:ue,appliedRoles:Te,showGroups:ge,basicRoleDisabled:Oe,disabledMessage:Ue,showBasicRole:Xe,onSelect:we,onBasicRoleSelect:qe,onUpdate:We,updateDisabled:Ce,offset:je,menuLeft:Ke,apply:_e})=>{const[Fe,at]=(0,s.useState)(Te),[Ct,Dt]=(0,s.useState)(re),[tt,ze]=(0,s.useState)({}),pe=(0,s.useRef)(null),Se=(0,l.$j)(),fe=(0,m.J)(Se),Ee=(0,l.of)(U);(0,s.useEffect)(()=>{we(Fe)},[Fe,we]),(0,s.useEffect)(()=>{qe&&Ct&&qe(Ct)},[Ct,qe]),(0,s.useEffect)(()=>{const pt=ue.filter(ne).sort(ee),Tt=ue.filter(le).sort(ee),jt=ue.filter(_).sort(ee),$t={fixed:Q(Tt).sort((sn,Yt)=>sn.name.localeCompare(Yt.name)),custom:Q(pt).sort((sn,Yt)=>sn.name.localeCompare(Yt.name)),plugin:Q(jt).sort((sn,Yt)=>sn.name.localeCompare(Yt.name))};ze({fixed:{groupType:"fixed",optionGroup:$t.fixed,renderedName:"Fixed roles",roles:Tt},custom:{groupType:"custom",optionGroup:$t.custom,renderedName:"Custom roles",roles:pt},plugin:{groupType:"plugin",optionGroup:$t.plugin,renderedName:"Plugin roles",roles:jt}})},[ue]);const Pe=pt=>{const Tt=[];for(const jt of Fe)ae(jt)===pt&&Tt.push(jt);return Tt},he=(pt,Tt)=>{const jt=Pe(Tt),$t=tt[pt]?.optionGroup.find(sn=>sn.value===Tt);return jt.length>0&&jt.length>=$t.options.length},be=(pt,Tt)=>{const jt=Pe(Tt),$t=tt[pt]?.optionGroup.find(sn=>sn.value===Tt);return jt.length>0&&jt.length<$t.options.length},Ae=pt=>{Fe.find(Tt=>Tt.uid===pt.uid)?at(Fe.filter(Tt=>Tt.uid!==pt.uid)):at([...Fe,pt])},De=(pt,Tt)=>{const jt=tt[pt]?.optionGroup.find($t=>$t.value===Tt);if(jt)if(he(pt,Tt)||be(pt,Tt))at(Fe.filter($t=>!jt.options.find(sn=>$t.uid===sn.uid)));else{const $t=jt.options.filter(Yt=>Yt.delegatable),sn=Fe.filter(Yt=>!jt.options.find(qt=>Yt.uid===qt.uid));at([...sn,...$t])}},Ie=pt=>{Dt(pt)},ke=async()=>{at([])},dt=pt=>{const Tt=Fe.filter(jt=>ae(jt)!==pt);at(Tt)},Pt=()=>{We(Fe,Ct)};return(0,n.jsxs)("div",{className:(0,g.cx)(fe.menu,Ee.menuWrapper,{[Ee.menuLeft]:Ke},(0,g.css)({top:`${je.vertical}px`,left:Ke?"unset":`${je.horizontal}px`,right:Ke?`${je.horizontal}px`:"unset"})),children:[(0,n.jsxs)("div",{className:Ee.menu,"aria-label":"Role picker menu",children:[(0,n.jsxs)(L.E,{autoHide:!1,autoHeightMax:`${E}px`,hideHorizontalTrack:!0,hideVerticalTrack:!0,className:(0,g.cx)(Ee.hideScrollBar),children:[Xe&&(0,n.jsx)("div",{className:Ee.menuSection,children:(0,n.jsx)(B,{value:Ct,onChange:Ie,disabled:Oe,disabledMesssage:Ue,tooltipMessage:H})}),Object.entries(tt).map(([pt,Tt])=>(0,n.jsx)(q,{roles:Tt.roles,renderedName:Tt.renderedName,showGroups:ge,optionGroups:Tt.optionGroup,groupSelected:jt=>he(Tt.groupType,jt),groupPartiallySelected:jt=>be(Tt.groupType,jt),onGroupChange:jt=>De(Tt.groupType,jt),subMenuNode:pe?.current,selectedOptions:Fe,onRoleChange:Ae,onClearSubMenu:dt,showOnLeftSubMenu:Ke},pt))]}),(0,n.jsx)("div",{className:Ee.menuButtonRow,children:(0,n.jsxs)(O.B,{justifyContent:"flex-end",children:[(0,n.jsx)(j.$n,{size:"sm",fill:"text",onClick:ke,disabled:Ce,children:"Clear all"}),(0,n.jsx)(j.$n,{size:"sm",onClick:Pt,disabled:Ce,children:_e?"Apply":"Update"})]})})]}),(0,n.jsx)("div",{ref:pe})]})},ne=re=>!re.name?.startsWith("fixed:")&&!re.name.startsWith("plugins:"),le=re=>re.name?.startsWith("fixed:"),_=re=>re.name?.startsWith("plugins:"),Q=re=>{const ue={};return re.forEach(ge=>{const Oe=ae(ge),Ue=oe(ge);ue[Oe]||(ue[Oe]={name:Ue,roles:[]}),ue[Oe].roles.push(ge)}),Object.entries(ue).map(([ge,Oe])=>({name:te[ge]||de(Oe.name),value:ge,options:Oe.roles.sort(ee)}))},ae=re=>{const ue=J(re),Te=oe(re);return`${ue}:${Te}`},oe=re=>re.group||"Other",J=re=>{const ue=re.name.indexOf(":");return ue<0?"unknown":re.name.substring(0,ue)},ee=(re,ue)=>re.name.localeCompare(ue.name),de=re=>re.slice(0,1).toUpperCase()+re.slice(1),xe=({basicRole:re,appliedRoles:ue,roleOptions:Te,disabled:ge,isLoading:Oe,basicRoleDisabled:Ue,basicRoleDisabledMessage:Xe,showBasicRole:we,onRolesChange:qe,onBasicRoleChange:We,canUpdateRoles:Ce=!0,apply:je=!1,maxWidth:Ke=f,width:_e})=>{const[Fe,at]=(0,s.useState)(!1),[Ct,Dt]=(0,s.useState)(ue),[tt,ze]=(0,s.useState)(re),[pe,Se]=(0,s.useState)(""),[fe,Ee]=(0,s.useState)({vertical:0,horizontal:0}),[Pe,he]=(0,s.useState)(!1),be=(0,s.useRef)(null),Ae=(0,l.$j)(),De=typeof _e=="number"?Ae.spacing(_e):_e;(0,s.useEffect)(()=>{ze(re),Dt(ue)},[ue,re,We]);const Ie=(0,s.useCallback)(()=>{const{horizontal:qt,vertical:bn,menuToLeft:Mt}=ke();qt&&bn&&(Ee({horizontal:qt,vertical:bn}),he(Mt))},[]);(0,s.useEffect)(()=>{Fe&&Ie()},[Fe,Ct,Ie]);const ke=()=>{const qt=be?.current?.getBoundingClientRect();if(!qt)return{};const{bottom:bn,top:Mt,left:Jt,right:Ut}=qt;let Gt=Jt,Lt=!1;const At=window.innerHeight-bn;let Nt=bn+5,Dn=!1;return At<E+20&&(Nt=Mt-E-50),Mt<E+50&&(Nt=Mt,Gt=Ut+5,Dn=!0),Gt+P>window.innerWidth&&(Gt=window.innerWidth-(Dn?Jt:Ut),Lt=!0),{horizontal:Gt,vertical:Nt,menuToLeft:Lt}},dt=(0,s.useCallback)(qt=>{ge||(qt.preventDefault(),qt.stopPropagation(),Ie(),at(!0))},[ge,Ie]),Pt=(0,s.useCallback)(()=>{at(!1),Se(""),Dt(ue),ze(re)},[ue,re]),pt=()=>Fe&&Pt(),Tt=qt=>{Se(qt||"")},jt=qt=>{Dt(qt)},$t=qt=>{ze(qt)},sn=(qt,bn)=>{We&&bn&&bn!==re&&We(bn),Ce&&qe(qt),Se(""),at(!1)},Yt=()=>{const qt=Te.map(bn=>({...bn,delegatable:Ce&&bn.delegatable}));return pe&&pe.trim()!==""?qt.filter(bn=>bn.name?.toLowerCase().includes(pe.toLowerCase())):qt};return(0,n.jsx)("div",{"data-testid":"role-picker",style:{position:"relative",maxWidth:De||Ke,width:De},ref:be,children:(0,n.jsxs)(r.N,{onClick:pt,useCapture:!1,children:[(0,n.jsx)(M,{basicRole:tt,appliedRoles:Ct,query:pe,onQueryChange:Tt,onOpen:dt,onClose:Pt,isFocused:Fe,disabled:ge,showBasicRole:we,width:De,isLoading:Oe}),Fe&&(0,n.jsx)(i.ZL,{children:(0,n.jsx)("div",{onClick:qt=>qt.stopPropagation(),children:(0,n.jsx)(se,{options:Yt(),basicRole:tt,appliedRoles:ue,onBasicRoleSelect:$t,onSelect:jt,onUpdate:sn,showGroups:pe.length===0||pe.trim()==="",basicRoleDisabled:Ue,disabledMessage:Xe,showBasicRole:we,updateDisabled:Ue&&!Ce,apply:je,offset:fe,menuLeft:Pe})})})]})})}},89062:(k,A,e)=>{"use strict";e.d(A,{y:()=>d});var n=e(74848),s=e(96540),l=e(41053),r=e(10096),i=e(31678),g=e(37425),o=e(85927);const d=({basicRole:c,roles:a,userId:p,orgId:u,onBasicRoleChange:m,roleOptions:v,disabled:x,basicRoleDisabled:f,basicRoleDisabledMessage:E,apply:h=!1,onApplyRoles:y,pendingRoles:b,maxWidth:D,width:P,isLoading:C})=>{const[{loading:M,value:I=a||[]},R]=(0,l.A)(async()=>{try{if(a)return a;if(h&&b?.length)return b;if(r.contextSrv.hasPermission(i.AccessControlAction.ActionUserRolesList)&&p>0)return await(0,o.Xh)(p,u)}catch{console.error("Error loading options")}return[]},[u,p,b,a]);(0,s.useEffect)(()=>{u&&R()},[R,u]);const T=async L=>{h?y&&y(L,p,u):(await(0,o.eA)(L,p,u),await R())},S=r.contextSrv.hasPermission(i.AccessControlAction.ActionUserRolesAdd)&&r.contextSrv.hasPermission(i.AccessControlAction.ActionUserRolesRemove);return(0,n.jsx)(g.n,{appliedRoles:I,basicRole:c,onRolesChange:T,onBasicRoleChange:m,roleOptions:v,isLoading:M||C,disabled:x,basicRoleDisabled:f,basicRoleDisabledMessage:E,showBasicRole:!0,apply:h,canUpdateRoles:S,maxWidth:D,width:P})}},85927:(k,A,e)=>{"use strict";e.d(A,{G3:()=>o,RL:()=>l,Xh:()=>r,eA:()=>i,xN:()=>g});var n=e(17172),s=e(3246);const l=async d=>{let c="/api/access-control/roles?delegatable=true";d&&(c+=`&targetOrgId=${d}`);const a=await(0,n.AI)().get(c);return!a||!a.length?[]:a.map(s.c)},r=async(d,c)=>{let a=`/api/access-control/users/${d}/roles`;c&&(a+=`?targetOrgId=${c}`);try{const p=await(0,n.AI)().get(a);return!p||!p.length?[]:p.map(s.c)}catch(p){return(0,n.NF)(p)&&(p.isHandled=!0),[]}},i=(d,c,a)=>{let p=`/api/access-control/users/${c}/roles`;a&&(p+=`?targetOrgId=${a}`);const u=d.flatMap(m=>m.uid);return(0,n.AI)().put(p,{orgId:a,roleUids:u})},g=async(d,c)=>{let a=`/api/access-control/teams/${d}/roles`;c&&(a+=`?targetOrgId=${c}`);try{const p=await(0,n.AI)().get(a);return!p||!p.length?[]:p.map(s.c)}catch(p){return(0,n.NF)(p)&&(p.isHandled=!0),[]}},o=(d,c,a)=>{let p=`/api/access-control/teams/${c}/roles`;a&&(p+=`?targetOrgId=${a}`);const u=d.flatMap(m=>m.uid);return(0,n.AI)().put(p,{orgId:a,roleUids:u})}},3246:(k,A,e)=>{"use strict";e.d(A,{W:()=>n,c:()=>s});const n=l=>l.delegatable!==void 0&&!l.delegatable,s=l=>{const r="fixed:";if(!l.displayName&&l.name.startsWith(r)){let i="";i=l.name.replace(r,"").replace(/:/g," "),l.displayName=i}return l}},47694:(k,A,e)=>{"use strict";e.d(A,{y:()=>a});var n=e(74848),s=e(8867),l=e(80997),r=e(62938);const i=2,g=5,o=v=>{const x=v.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return x?x[0]:null},d=v=>v.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[i],c=v=>{let x=d(v);if(!x){x=`x${(0,r.A)()}`;const E=v.indexOf("<svg")+g;v=v.substring(0,E)+`id="${x}" `+v.substring(E)}let f=o(v);if(f){let E=f.replace(/(#(.*?))?\./g,`#${x} .`);v=v.replace(f,E)}return v},a=v=>{const{cleanStyle:x,...f}=v;return(0,n.jsx)(s.default,{...f,cacheRequests:!0,preProcessor:x?m:u})};let p=new Map;function u(v){let x=p.get(v);return x||(x=l.sQ.sanitizeSVGContent(v),p.set(v,x)),x}function m(v){let x=p.get(v);return x||(x=l.sQ.sanitizeSVGContent(v),x.indexOf('<style type="text/css">')>-1&&(x=c(x)),p.set(v,x)),x}},59429:(k,A,e)=>{"use strict";e.d(A,{b:()=>p});var n=e(74848),s=e(76459),l=e.n(s),r=e(96540),i=e(90182),g=e(27677),o=e(28676);const d=(u="Dashboards",m)=>`${u}/${m}`;async function c(u=""){return g.IB.search({type:"dash-db",query:u,limit:100}).then(m=>m.map(v=>({value:{uid:v.uid,title:v.title,folderTitle:v.folderTitle,folderUid:v.folderUid},label:d(v?.folderTitle,v.title)})))}const a=l()(c,250,{leading:!0}),p=({value:u,onChange:m,placeholder:v="Select dashboard",noOptionsMessage:x="No dashboards found",...f})=>{const[E,h]=(0,r.useState)();(0,r.useEffect)(()=>{!u||u===E?.value?.uid||(async()=>{const b=await(0,o.n)().getDashboardDTO(u);b.dashboard&&h({value:{uid:b.dashboard.uid,title:b.dashboard.title,folderTitle:b.meta.folderTitle,folderUid:b.meta.folderUid},label:d(b.meta?.folderTitle,b.dashboard.title)})})()},[u]);const y=(0,r.useCallback)(b=>{h(b),m?.(b?.value)},[m,h]);return(0,n.jsx)(i.DW,{loadOptions:a,onChange:y,placeholder:v,noOptionsMessage:x,value:E,defaultOptions:!0,...f})}},36607:(k,A,e)=>{"use strict";e.d(A,{d:()=>oe});var n=e(74848),s=e(96540),l=e(32264),r=e(32196),i=e(34743),g=e(36376),o=e(7315),d=e(76459),c=e.n(d),a=e(40845),p=e(10354),u=e(14578),m=e(42418),v=e(57514),x=e(8484),f=e(55314),E=e(24439),h=e(40957),y=e(31678),b=e(70255),D=e(91793),P=e(10022),C=e(29158),M=e(94753),I=e(18759),R=e(37690);const T=40,S="md",L=(ee,de)=>`${ee}-${de||"root"}`;function O({items:ee,focusedItemIndex:de,foldersAreOpenable:xe,idPrefix:re,selectedFolder:ue,onFolderExpand:Te,onFolderSelect:ge,isItemLoaded:Oe,requestLoadMore:Ue}){const Xe=(0,s.useRef)(null),we=(0,a.of)(F),qe=(0,s.useMemo)(()=>({items:ee,focusedItemIndex:de,foldersAreOpenable:xe,selectedFolder:ue,onFolderExpand:Te,onFolderSelect:ge,idPrefix:re}),[ee,de,xe,ue,Te,ge,re]),We=(0,s.useCallback)(je=>Oe(je),[Oe]),Ce=(0,s.useCallback)((je,Ke)=>{const{parentUID:_e}=ee[je];Ue(_e)},[Ue,ee]);return(0,n.jsx)("div",{className:we.table,role:"tree",children:ee.length>0?(0,n.jsx)(P.A,{ref:Xe,itemCount:ee.length,isItemLoaded:We,loadMoreItems:Ce,children:({onItemsRendered:je,ref:Ke})=>(0,n.jsx)(D.Y1,{ref:Ke,height:T*Math.min(6.5,ee.length),width:"100%",itemData:qe,itemSize:T,itemCount:ee.length,onItemsRendered:je,children:N})}):(0,n.jsx)("div",{className:we.emptyMessage,children:(0,n.jsx)(x.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const j=[100,200,130,160,150];function N({index:ee,style:de,data:xe}){const{items:re,focusedItemIndex:ue,foldersAreOpenable:Te,selectedFolder:ge,onFolderExpand:Oe,onFolderSelect:Ue,idPrefix:Xe}=xe,{item:we,isOpen:qe,level:We,parentUID:Ce}=re[ee],je=(0,s.useRef)(null),Ke=(0,s.useId)(),_e=(0,y.useSelector)(R.ku),Fe=(0,y.useSelector)(R.Am),at=(we.uid?Fe[we.uid]:_e)?.items??[];let Ct=[];we.uid&&(Ct=(Ce?Fe[Ce]:_e)?.items??[]);const Dt=(0,a.of)(F),tt=(0,s.useCallback)(pe=>{pe.preventDefault(),pe.stopPropagation(),we.uid&&Oe(we.uid,!qe)},[we.uid,qe,Oe]),ze=(0,s.useCallback)(()=>{we.kind==="folder"&&Ue(we)},[we,Ue]);return we.kind==="ui"&&we.uiKind==="pagination-placeholder"?(0,n.jsxs)("span",{style:de,className:Dt.row,children:[(0,n.jsx)(I.T,{level:We,spacing:2}),(0,n.jsx)(b.A,{width:j[ee%j.length]})]}):we.kind!=="folder"?null:(0,n.jsx)("div",{ref:je,style:de,className:(0,r.cx)(Dt.row,{[Dt.rowFocused]:ee===ue,[Dt.rowSelected]:we.uid===ge}),tabIndex:-1,onClick:ze,"aria-expanded":qe,"aria-selected":we.uid===ge,"aria-labelledby":Ke,"aria-level":We+1,role:"treeitem","aria-owns":at.length>0?at.map(pe=>L(Xe,pe.uid)).join(" "):void 0,"aria-setsize":at.length,"aria-posinset":Ct.findIndex(pe=>pe.uid===we.uid)+1,id:L(Xe,we.uid),children:(0,n.jsxs)("div",{className:Dt.rowBody,children:[(0,n.jsx)(I.T,{level:We,spacing:2}),Te?(0,n.jsx)(C.K,{size:S,onMouseDown:tt,tabIndex:-1,"aria-label":qe?`Collapse folder ${we.title}`:`Expand folder ${we.title}`,name:qe?"angle-down":"angle-right"}):(0,n.jsx)("span",{className:Dt.folderButtonSpacer}),(0,n.jsx)("label",{className:Dt.label,id:Ke,children:(0,n.jsx)(M.E,{truncate:!0,children:we.title})})]})})}const F=ee=>{const de=(0,r.css)({height:T,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:ee.spacing(.5),overflow:"hidden",padding:ee.spacing(0,1)});return{table:(0,r.css)({background:ee.components.input.background}),emptyMessage:(0,r.css)({padding:ee.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,r.css)({paddingLeft:ee.spacing(.5)}),row:(0,r.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${ee.colors.border.weak}`}}),rowFocused:(0,r.css)({backgroundColor:ee.colors.background.secondary}),rowSelected:(0,r.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:ee.shape.radius.default,backgroundImage:ee.colors.gradients.brandVertical}}),rowBody:de,label:(0,r.css)({lineHeight:T+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var U=e(16797);function w({handleClearSelection:ee,isLoading:de,invalid:xe,label:re,...ue},Te){const ge=(0,a.$j)(),Oe=K(ge,xe),Ue=Xe=>{(Xe.key==="Enter"||Xe.key===" ")&&ee?.(Xe)};return(0,n.jsx)("div",{className:Oe.wrapper,children:(0,n.jsxs)("div",{className:Oe.inputWrapper,children:[re?(0,n.jsx)("div",{className:Oe.prefix,children:(0,n.jsx)(u.I,{name:"folder"})}):void 0,(0,n.jsxs)("button",{type:"button",className:(0,r.cx)(Oe.fakeInput,re?Oe.hasPrefix:void 0),...ue,ref:Te,children:[de?(0,n.jsx)(b.A,{width:100}):re?(0,n.jsx)(M.E,{truncate:!0,children:re}):(0,n.jsx)(M.E,{truncate:!0,color:"secondary",children:(0,n.jsx)(x.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!de&&ee&&(0,n.jsx)(u.I,{role:"button",tabIndex:0,"aria-label":(0,x.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:Oe.clearIcon,name:"times",onClick:ee,onKeyDown:Ue})]}),(0,n.jsx)("div",{className:Oe.suffix,children:(0,n.jsx)(u.I,{name:"angle-down"})})]})})}const B=(0,s.forwardRef)(w),K=(ee,de=!1)=>{const xe=(0,p.n)({theme:ee,invalid:de});return{wrapper:xe.wrapper,inputWrapper:xe.inputWrapper,prefix:(0,r.css)([xe.prefix,{pointerEvents:"none",color:ee.colors.text.primary}]),suffix:(0,r.css)([xe.suffix,{pointerEvents:"none"}]),fakeInput:(0,r.css)([xe.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,r.css)`
          ${(0,U.focusCss)(ee)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,r.css)({paddingLeft:28}),clearIcon:(0,r.css)({color:ee.colors.text.secondary,cursor:"pointer","&:hover":{color:ee.colors.text.primary},"&:focus:not(:focus-visible)":(0,U.getMouseFocusStyles)(ee),"&:focus-visible":(0,U.getFocusStyles)(ee)})}};var W=e(25508),z=e(92955),Y=e(93519),X=e(64756);const q=(0,W.Mz)([ee=>ee,(ee,de)=>de],(ee,de)=>{const xe=new Set,re=[],ue={};let Te=!1;for(const ge of de){if(xe.has(ge.requestId))continue;const Oe=f.cU.endpoints.listFolders.select({parentUid:ge.arg.parentUid,page:ge.arg.page,limit:ge.arg.limit,permission:ge.arg.permission})(ee);Oe.status==="pending"&&(Te=!0);const Ue=Oe.originalArgs?.parentUid;Ue?(ue[Ue]||(ue[Ue]=[]),ue[Ue].push(Oe)):re.push(Oe)}return{isLoading:Te,rootPages:re,pagesByParent:ue}});function G(ee){const de=ee.at(-1),xe=de?.originalArgs?.page;return de?.data?[de.data.length<de.originalArgs.limit,xe]:[!1,xe]}function te(ee,de,xe){const re=(0,X.wA)(),ue=(0,s.useRef)([]),Te=(0,X.d4)(Ue=>q(Ue,ue.current)),ge=(0,s.useCallback)(Ue=>{const Xe=Ue?Te.pagesByParent[Ue]:Te.rootPages,[we,qe]=G(Xe??[]);if(we)return;const We={parentUid:Ue,page:(qe??0)+1,limit:z.md,permission:xe},Ce=re(f.cU.endpoints.listFolders.initiate(We));ue.current=ue.current.concat([Ce])},[Te,re,xe]);return(0,s.useEffect)(()=>()=>{for(const Ue of ue.current)Ue.unsubscribe()},[]),{items:(0,s.useMemo)(()=>{if(!ee)return[];function Ue(we,qe,We){const Ce=qe.flatMap(Ke=>(Ke.data??[]).flatMap(Fe=>{const at=de[Fe.uid],Ct={isOpen:!!at,level:We,item:{kind:"folder",title:Fe.title,uid:Fe.uid}},Dt=at&&Te.pagesByParent[Fe.uid];if(Dt){const tt=Ue(Fe.uid,Dt,We+1);return[Ct,...tt]}return Ct})),[je]=G(qe);return je||Ce.push(...(0,Y.T)(z.md,we,We)),Ce}const Xe=Ue(void 0,Te.rootPages,1);return Xe.unshift(H),Xe},[Te,ee,de]),isLoading:Te.isLoading,requestNextPage:ge}}const H={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function se({tree:ee,handleCloseOverlay:de,handleFolderSelect:xe,handleFolderExpand:re,idPrefix:ue,search:Te,visible:ge}){const[Oe,Ue]=(0,s.useState)(-1),Xe=!!l.$.featureToggles.nestedFolders;(0,s.useEffect)(()=>{ge&&Ue(-1)},[ge]),(0,s.useEffect)(()=>{Ue(0)},[Te]),(0,s.useEffect)(()=>{document.getElementById(L(ue,ee[Oe]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[Oe,ue,ee]);const we=(0,s.useCallback)(qe=>{const We=Xe&&!Te;switch(qe.key){case"ArrowRight":case"ArrowLeft":We&&(qe.preventDefault(),re(ee[Oe].item.uid,qe.key==="ArrowRight"));break;case"ArrowUp":Oe>0&&(qe.preventDefault(),Ue(Oe-1));break;case"ArrowDown":Oe<ee.length-1&&(qe.preventDefault(),Ue(Oe+1));break;case"Enter":qe.preventDefault();const Ce=ee[Oe].item;Ce.kind==="folder"&&xe(Ce);break;case"Tab":qe.stopPropagation(),de();break;case"Escape":qe.stopPropagation(),qe.preventDefault(),de();break}},[Oe,de,re,xe,Xe,Te,ee]);return{focusedItemIndex:Oe,handleKeyDown:we}}const ne=c()(le,300);async function le(ee,de){const xe=await(0,E.getGrafanaSearcher)().search({query:ee,kind:["folder"],limit:100,permission:de}),re=xe.view.map(ue=>(0,h.hI)(ue,xe.view));return{...xe,items:re}}function _({value:ee,invalid:de,showRootFolder:xe=!0,clearable:re=!1,excludeUIDs:ue,permission:Te=y.PermissionLevelString.Edit,onChange:ge}){const Oe=(0,a.of)(Q),Ue=(0,f.kH)(ee||f.hT),Xe=!!l.$.featureToggles.nestedFolders,[we,qe]=(0,s.useState)(""),[We,Ce]=(0,s.useState)(null),[je,Ke]=(0,s.useState)(!1),[_e,Fe]=(0,s.useState)(!1),[at,Ct]=(0,s.useState)(!1),[Dt,tt]=(0,s.useState)({}),ze=(0,s.useId)(),[pe]=(0,s.useState)(void 0),Se=(0,s.useRef)(0),fe=!!(at&&!(we&&We)),{items:Ee,isLoading:Pe,requestNextPage:he}=te(fe,Dt,Te);(0,s.useEffect)(()=>{if(!we){Ce(null);return}const At=Date.now();Ke(!0),ne(we,Te).then(Nt=>{if(At>Se.current){const Dn=Nt.view.map(An=>(0,h.hI)(An,Nt.view));Ce({...Nt,items:Dn}),Ke(!1),Se.current=At}})},[we,Te]);const be=[(0,i.UU)({crossAxis:!1,boundary:document.body})],{context:Ae,refs:De,floatingStyles:Ie,elements:ke}=(0,g.we)({open:at,placement:"bottom",onOpenChange:At=>{At&&(qe(""),Fe(!0)),Ct(At)},middleware:be,whileElementsMounted:o.ll}),dt=(0,g.kp)(Ae),Pt=(0,g.s9)(Ae),{getReferenceProps:pt,getFloatingProps:Tt}=(0,g.bv)([Pt,dt]),jt=(0,s.useCallback)(async(At,Nt)=>{tt(Dn=>({...Dn,[At]:Nt})),Nt&&!Dt[At]&&he(At)},[he,Dt]),$t=(0,s.useCallback)(At=>{ge&&ge(At.uid,At.title),Ct(!1)},[ge]),sn=(0,s.useCallback)(At=>{At.preventDefault(),At.stopPropagation(),ge&&ge(void 0,void 0)},[ge]),Yt=(0,s.useCallback)(()=>Ct(!1),[Ct]),qt=(0,s.useCallback)(At=>{we||he(At)},[we,he]),bn=(0,s.useMemo)(()=>{let At=[];return fe?At=Ee:At=We?.items.map(Nt=>({isOpen:!1,level:0,item:{kind:"folder",title:Nt.title,uid:Nt.uid}}))??[],(!xe||ue?.length)&&(At=At.filter(Nt=>!(!xe&&Nt===H||ue?.includes(Nt.item.uid)))),At},[Ee,ue,fe,We?.items,xe]),Mt=(0,s.useCallback)(At=>{const Nt=bn[At];if(!Nt)return!1;const Dn=Nt.item;return!(Dn.kind==="ui"&&Dn.uiKind==="pagination-placeholder")},[bn]),Jt=Pe||je,{focusedItemIndex:Ut,handleKeyDown:Gt}=se({tree:bn,handleCloseOverlay:Yt,handleFolderSelect:$t,handleFolderExpand:jt,idPrefix:ze,search:we,visible:at});let Lt=Ue.data?.title;return ee===""&&(Lt="Dashboards"),at?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.p,{ref:De.setReference,autoFocus:!0,prefix:Lt?(0,n.jsx)(u.I,{name:"folder"}):null,placeholder:Lt??(0,x.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:we,invalid:de,className:Oe.search,onChange:At=>qe(At.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":ze,"aria-owns":ze,"aria-activedescendant":L(ze,bn[Ut]?.item.uid),role:"combobox",suffix:(0,n.jsx)(u.I,{name:"search"}),...pt(),onKeyDown:Gt}),(0,n.jsx)("fieldset",{ref:De.setFloating,id:ze,className:Oe.tableWrapper,style:{...Ie,width:ke.domReference?.clientWidth},...Tt(),children:pe?(0,n.jsx)(m.F,{className:Oe.error,severity:"warning",title:(0,x.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:pe.message||pe.toString?.()||(0,x.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,n.jsxs)("div",{children:[Jt&&(0,n.jsx)("div",{className:Oe.loader,children:(0,n.jsx)(v.G,{width:600})}),(0,n.jsx)(O,{items:bn,selectedFolder:ee,focusedItemIndex:Ut,onFolderExpand:jt,onFolderSelect:$t,idPrefix:ze,foldersAreOpenable:Xe&&!(we&&We),isItemLoaded:Mt,requestLoadMore:qt})]})})]}):(0,n.jsx)(B,{label:Lt,handleClearSelection:re&&ee!==void 0?sn:void 0,invalid:de,isLoading:Ue.isLoading,autoFocus:_e,ref:De.setReference,"aria-label":Lt?(0,x.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:Lt}):void 0,...pt()})}const Q=ee=>({button:(0,r.css)({maxWidth:"100%"}),error:(0,r.css)({marginBottom:0}),tableWrapper:(0,r.css)({boxShadow:ee.shadows.z3,position:"relative",zIndex:ee.zIndex.portal}),loader:(0,r.css)({position:"absolute",top:0,left:0,right:0,zIndex:ee.zIndex.portal+1,overflow:"hidden"}),search:(0,r.css)({input:{cursor:"default"}})});var ae=e(85242);function oe(ee){const de=l.$.featureToggles.newFolderPicker||l.$.featureToggles.nestedFolders,{initialTitle:xe,dashboardId:re,enableCreateNew:ue,...Te}=ee;return de?(0,n.jsx)(_,{...Te}):(0,n.jsx)(J,{...ee})}function J({value:ee,showRootFolder:de,onChange:xe,initialTitle:re,dashboardId:ue,enableCreateNew:Te,inputId:ge,skipInitialLoad:Oe}){const Ue=(0,s.useCallback)(Xe=>{xe&&xe(Xe.uid,Xe.title)},[xe]);return(0,n.jsx)(ae.sR,{onChange:Ue,showRoot:de,initialFolderUid:ee,initialTitle:re,inputId:ge,skipInitialLoad:Oe,dashboardId:ue,enableCreateNew:Te})}},85242:(k,A,e)=>{"use strict";e.d(A,{sR:()=>b});var n=e(74848),s=e(32196),l=e(76459),r=e.n(l),i=e(96540),g=e(16817),o=e(26272),d=e(13544),c=e(14110),a=e(40845),p=e(10354),u=e(90182),m=e(28138),v=e(8484),x=e(16233),f=e(11230),E=e(31678);const h="+ Add new",y="-10";function b(M){const{dashboardId:I,allowEmpty:R,onChange:T,filter:S,enableCreateNew:L,inputId:O,onClear:j,enableReset:N,initialFolderUid:F,initialTitle:U="",permissionLevel:w=E.PermissionLevelString.Edit,rootName:B,showRoot:K=!0,skipInitialLoad:W,searchQueryType:z,customAdd:Y,folderWarning:X,invalid:q}=M,G=B??"Dashboards",[te,H]=(0,i.useState)(null),[se,ne]=(0,i.useState)(!1),[le,_]=(0,i.useState)(""),[Q,ae]=(0,i.useState)(te?.title??""),oe=(0,a.of)(C),J=typeof j=="function",ee=(0,i.useCallback)(async qe=>{const We=await(0,f.c0)(qe,w,z),je=D(We,S);return(0,c.rR)("grafana_folder_picker_results_loaded",{results:je.length,searchTermLength:qe.length,enableCreateNew:!!L}),(x.TP.hasPermission(E.AccessControlAction.DashboardsWrite)||x.TP.hasPermission(E.AccessControlAction.DashboardsCreate))&&G?.toLowerCase().startsWith(qe.toLowerCase())&&K&&je.unshift({label:G,value:""}),N&&qe===""&&U!==""&&!je.find(_e=>_e.label===U)&&je.unshift({label:U,value:F}),L&&Y?[...je,{value:y,label:h,title:qe}]:je},[N,F,U,w,G,K,z,S,L,Y]),de=(0,i.useMemo)(()=>r()(ee,300,{leading:!0}),[ee]),xe=async()=>{const qe={label:U,value:void 0},We={label:G,value:""},Ce=await ee("");let je=null;F!=null?je=Ce.find(Ke=>Ke.value===F)||null:N&&U?je=qe:F&&(je=Ce.find(Ke=>Ke.id===F)||null),!je&&!R&&(x.TP.isEditor?je=We:!!I?je=qe:je=Ce.length>0?Ce[0]:qe),!se&&H(je)};(0,i.useEffect)(()=>{te&&te.value!==F&&!se&&te.value&&te.label&&T({uid:te.value,title:te.label})},[te,F]),(0,g.A)(async()=>{if(W){const qe=await P({getFolder:f.Ql,folderUid:F,folderName:U});H(qe)}await xe()},[W,F,U]),(0,i.useEffect)(()=>{te&&te.id===y&&ne(!0)},[te]);const re=(0,i.useCallback)((qe,We)=>{if(qe?.value===y)H({id:y,title:le}),ae(le);else{if(qe||(qe={value:"",label:G}),We.action==="clear"&&j){j();return}H(qe),T({uid:qe.value,title:qe.label})}},[T,j,G,le]),ue=(0,i.useCallback)(async qe=>{if(X?.warningCondition(qe))return(0,c.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const We=await(0,f.vV)({title:qe});let Ce={value:"",label:"Not created"};return We.uid?((0,c.rR)("grafana_folder_picker_folder_created",{status:"success"}),m.A.emit(o.r1.alertSuccess,["Folder Created","OK"]),Ce={value:We.uid,label:We.title},H(We),re(Ce,{action:"create-option",option:Ce})):((0,c.rR)("grafana_folder_picker_folder_created",{status:"failed"}),m.A.emit(o.r1.alertError,["Folder could not be created"])),Ce},[X,re]),Te=(0,i.useCallback)(qe=>{const We=!!Y?.disallowValues;if(qe.key==="Enter"&&We&&!Y?.isAllowedValue(Q)){qe.preventDefault();return}switch(qe.key){case"Enter":{ue(te?.title),ne(!1);break}case"Escape":H({value:"",label:G}),ne(!1)}},[Y?.disallowValues,Y?.isAllowedValue,Q,ue,te?.title,G]),ge=qe=>{const We=qe.currentTarget.value;ae(We),H({id:void 0,title:We})},Oe=()=>{H({value:"",label:G}),ne(!1)},Ue=(qe,{action:We})=>{We==="input-change"&&_(Ce=>qe),We==="menu-close"&&_(Ce=>qe)},Xe=()=>X?.warningCondition(Q)?(0,n.jsx)(X.warningComponent,{}):null,we=()=>X?.warningCondition(le)?(0,n.jsx)(X.warningComponent,{}):null;return se?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Xe,{}),(0,n.jsx)("div",{className:oe.newFolder,children:"Press enter to create the new folder."}),(0,n.jsx)(p.p,{width:30,autoFocus:!0,value:Q,onChange:ge,onKeyDown:Te,placeholder:"Press enter to confirm new folder.",onBlur:Oe})]}):(0,n.jsxs)("div",{"data-testid":d.Tp.components.FolderPicker.containerV2,children:[(0,n.jsx)(we,{}),(0,n.jsx)(u.gZ,{inputId:O,"data-testid":d.Tp.components.FolderPicker.input,loadingMessage:(0,v.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:te,inputValue:le,onInputChange:Ue,value:te,allowCustomValue:L&&!Y,loadOptions:de,onChange:re,onCreateOption:ue,invalid:q,isClearable:J})]})}function D(M,I){return(I?I(M):M).map(T=>({label:T.title,value:T.uid}))}async function P({folderName:M,folderUid:I,getFolder:R}){if(I==null)throw new Error("folderUid is not found.");return M?{label:M,value:I}:{label:(await R(I)).title,value:I}}const C=M=>({newFolder:(0,s.css)({color:M.colors.warning.main,fontSize:M.typography.bodySmall.fontSize,paddingBottom:M.spacing(1)})})},73725:(k,A,e)=>{"use strict";e.d(A,{r:()=>d});var n=e(74848),s=e(16817),l=e(90182),r=e(14578),i=e(53477),g=e(24439);const o=()=>(0,g.getGrafanaSearcher)().getSortOptions();function d({onChange:c,value:a,placeholder:p,filter:u,getSortOptions:m,isClearable:v}){const x=(0,s.A)(async()=>{const E=await(m??o)();return u?E.filter(h=>u.includes(h.value)):E},[m,u]);if(x.loading)return null;const f=!!(a?.includes("desc")||a?.startsWith("-"));return(0,n.jsx)(l.l6,{width:28,onChange:c,value:x.value?.find(E=>E.value===a)??null,options:x.value,"aria-label":"Sort",placeholder:p??`Sort (Default ${i.r4.label})`,prefix:(0,n.jsx)(r.I,{name:f?"sort-amount-down":"sort-amount-up"}),isClearable:v},a)}},98742:(k,A,e)=>{"use strict";e.d(A,{e:()=>o});var n=e(74848),s=e(2543),l=e.n(s),r=e(96540),i=e(17172),g=e(90182);class o extends r.Component{constructor(c){super(c),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,s.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:c}=this.props;c&&(0,i.AI)().get(`/api/teams/${c}`).then(a=>{this.setState({value:{value:a,label:a.name,imgUrl:a.avatarUrl}})})}search(c){return this.setState({isLoading:!0}),(0,s.isNil)(c)&&(c=""),(0,i.AI)().get(`/api/teams/search?perpage=100&page=1&query=${c}`).then(a=>{const p=a.teams.map(u=>({value:u,label:u.name,imgUrl:u.avatarUrl}));return this.setState({isLoading:!1}),p})}render(){const{onSelected:c,className:a}=this.props,{isLoading:p,value:u}=this.state;return(0,n.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,n.jsx)(g.DW,{isLoading:p,defaultOptions:!0,loadOptions:this.debouncedSearch,value:u,onChange:c,className:a,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"})})}}},46334:(k,A,e)=>{"use strict";e.d(A,{$:()=>o,E:()=>g});var n=e(74848),s=e(32196),l=e(69613),r=e(40845),i=e(14578);const g=({count:d,label:c,onClick:a,removeIcon:p})=>{const{color:u}=(0,l.MC)(c),m=(0,r.of)(o),v=d!==0&&(0,n.jsx)("span",{style:{marginLeft:"3px"},children:`(${d})`});return(0,n.jsxs)("span",{className:m.badge,style:{backgroundColor:u},children:[p&&(0,n.jsx)(i.I,{onClick:a,name:"times"}),c," ",v]})},o=d=>({badge:(0,s.css)({...d.typography.bodySmall,backgroundColor:d.v1.palette.gray1,borderRadius:d.shape.radius.default,color:d.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:d.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},99818:(k,A,e)=>{"use strict";e.d(A,{$:()=>v});var n=e(74848),s=e(32196),l=e(96540),r=e(28581),i=e(54479),g=e(40845),o=e(90182),d=e(14578),c=e(8484),a=e(46334);const p=({data:f,className:E,label:h,isFocused:y,innerProps:b})=>{const D=(0,g.of)(u);return(0,n.jsx)("div",{className:(0,s.cx)(D.option,y&&D.optionFocused),"aria-label":"Tag option",...b,children:(0,n.jsx)("div",{className:(0,s.cx)(D.optionInner,E),children:typeof h=="string"?(0,n.jsx)(a.E,{label:h,removeIcon:!1,count:f.count??0}):h})})},u=f=>({option:(0,s.css)({padding:f.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:f.colors.background.secondary}}),optionFocused:(0,s.css)({background:f.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,s.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),m=(f,E)=>RegExp((0,i.jD)(E),"i").test(f.value),v=({allowCustomValue:f=!1,formatCreateLabel:E,hideValues:h,inputId:y,isClearable:b,onChange:D,placeholder:P,tagOptions:C,tags:M,width:I})=>{const R=(0,g.of)(x),T=M.map(X=>({value:X,label:X,count:0})),[S,L]=(0,l.useState)(T),[O,j]=(0,l.useState)(!1),[N,F]=(0,l.useState)(M),[U,w]=(0,l.useState)(T),B=(0,l.useMemo)(()=>M.join(),[M]),K=(0,l.useCallback)(async()=>(await C()).map(q=>M.includes(q.term)?{value:q.term,label:q.term,count:0}:{value:q.term,label:q.term,count:q.count}),[C,M]),W=(0,l.useCallback)(async()=>{j(!0);const X=await K();f&&U.forEach(q=>X.push(q)),L(X),j(!1)},[f,U,K]);(0,l.useEffect)(()=>{M.length>0&&S.length===0&&W()},[W,S.length,M.length]),(0,l.useEffect)(()=>{M!==N&&(F(M),W())},[W,N,M]);const z=X=>{X.forEach(q=>q.count=0),D((X||[]).map(q=>q.value)),f&&w(X.filter(q=>!M.includes(q)))},Y={onFocus:W,isLoading:O,options:S,allowCreateWhileLoading:!0,allowCustomValue:f,formatCreateLabel:E,defaultOptions:!0,filterOption:m,getOptionLabel:X=>X.label,getOptionValue:X=>X.value,inputId:y,isMulti:!0,onChange:z,loadingMessage:(0,c.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,c.t)("tag-filter.no-tags","No tags found"),placeholder:P||(0,c.t)("tag-filter.placeholder","Filter by tag"),value:T,width:I,components:{Option:p,MultiValueLabel:()=>null,MultiValueRemove(X){const{data:q}=X;return(0,n.jsx)(r.c.MultiValueRemove,{...X,children:(0,n.jsx)(a.E,{label:q.label,removeIcon:!0,count:q.count},q.label)})},MultiValueContainer:h?()=>null:r.c.MultiValueContainer}};return(0,n.jsxs)("div",{className:R.tagFilter,children:[b&&M.length>0&&(0,n.jsx)("button",{className:R.clear,onClick:()=>z([]),children:"Clear tags"}),(0,n.jsx)(o.KF,{...Y,prefix:(0,n.jsx)(d.I,{name:"tag-alt"}),"aria-label":"Tag filter"},B)]})};v.displayName="TagFilter";const x=f=>{const E=(0,a.$)(f);return{tagFilter:(0,s.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${E.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,s.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:f.colors.text.secondary,"&:hover":{color:f.colors.text.primary}})}}},25573:(k,A,e)=>{"use strict";e.d(A,{m:()=>u});var n=e(74848),s=e(2543),l=e.n(s),r=e(26272),i=e(65879),g=e(47232),o=e(15666),d=e(76412),c=e(28138),a=e(61680);const p="grafana.dashboard.timepicker.history",u=h=>(0,n.jsx)(a.b,{storageKey:p,defaultValue:[],children:(y,b)=>{const D=v(y),P=m(D);return(0,n.jsx)(o.$6,{...h,history:P,onChange:C=>{x(C,D,b),h.onChange(C)},onError:C=>c.A.emit(r.r1.alertError,[(0,d.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,d.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:C})])})}});function m(h){return h.map(y=>i.convertRawToRange(y,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function v(h){return h.map(y=>{const b=typeof y.from=="string"?y.from:y.from.toISOString(),D=typeof y.to=="string"?y.to:y.to.toISOString();return{from:b,to:D}})}function x(h,y,b){if(!f(h))return;const D={from:typeof h.raw.from=="string"?h.raw.from:h.raw.from.toISOString(),to:typeof h.raw.to=="string"?h.raw.to:h.raw.to.toISOString()},P=E([D,...y]);b(P)}function f(h){return(0,g.Ar)(h.raw.from)||(0,g.Ar)(h.raw.to)}function E(h){return(0,s.uniqBy)(h,y=>y.from+y.to).slice(0,4)}},82389:(k,A,e)=>{"use strict";e.d(A,{I:()=>p});var n=e(74848),s=e(96540),l=e(24293),r=e(11261),i=e(52622),g=e(67266),o=e(96516),d=e(30249),c=e(28895);const a=["rowHeight","colWidth","showValue","mergeValues","alignValue","tooltip","paginationRev"];class p extends s.Component{constructor(){super(...arguments),this.getValueColor=(m,v,x)=>{const f=this.props.frames[m]?.fields[v];if(f?.display){const E=f.display(x);if(E.color)return E.color}return l.F},this.prepConfig=(m,v,x)=>(0,c.iE)({frame:m,getTimeRange:x,allFrames:this.props.frames,...this.props,timeZones:Array.isArray(this.props.timeZone)?this.props.timeZone:[this.props.timeZone],rowHeight:m.fields.length>2?this.props.rowHeight:1,getValueColor:this.getValueColor,hoverMulti:this.props.tooltip?.mode===i.$N.Multi}),this.renderLegend=m=>{const{legend:v,legendItems:x}=this.props;return!m||!x||!v||v.showLegend===!1?null:(0,n.jsx)(g.KU.Legend,{placement:v.placement,children:(0,n.jsx)(o.t,{placement:v.placement,items:x,displayMode:v.displayMode,readonly:!0})})}}render(){return(0,n.jsx)(d.o,{...this.props,fields:{x:m=>m.type===r.PU.time,y:m=>m.type===r.PU.number||m.type===r.PU.boolean||m.type===r.PU.string||m.type===r.PU.enum},prepConfig:this.prepConfig,propsToDiff:a,renderLegend:this.renderLegend})}}},28895:(k,A,e)=>{"use strict";e.d(A,{pm:()=>L,GY:()=>Y,c5:()=>X,jY:()=>W,EI:()=>B,uB:()=>w,iE:()=>j,Qe:()=>U,Or:()=>K});var n=e(24293),s=e(28240),l=e(83195),r=e(11261),i=e(50082),g=e(58563),o=e(47737),d=e(73060),c=e(46294),a=e(39624),p=e(73134),u=e(52622),m=e(51336),v=e(52811),x=e(16895),f=e(36613),E=e(23596),h=e(39758),y=e(4134);const{round:b,min:D,ceil:P}=Math,C=2;let M=6;const I=h.ur;function R(q,G,te,H,se){(0,h.mn)(te,q,I,G,(ne,le,_)=>{let Q=H*le,ae=H*_;se(ne,Q,ae)})}function T(q){const{mode:G,numSeries:te,isDiscrete:H,hasMappedNull:se,rowHeight:ne=0,colWidth:le=0,showValue:_,mergeValues:Q=!1,theme:ae,label:oe,formatValue:J,alignValue:ee="left",getTimeRange:de,getValueColor:xe,getFieldConfig:re,hoverMulti:ue}=q;let Te,ge;const Oe=Ee=>{ge=Array(te).fill(null).map(Pe=>Array(Ee).fill(null))},Ue=`500 ${Math.round(12*devicePixelRatio)}px ${ae.typography.fontFamily}`,Xe=Array(te).fill(null);let we=null;const qe=[le,1/0],We=1-qe[0],Ce=(qe[1]??1/0)*f.A.pxRatio,je=new Map,Ke=new Map;function _e(Ee){je.forEach((Pe,he)=>{Ee.fillStyle=he,Ee.fill(Pe)}),Ke.forEach((Pe,he)=>{Ee.strokeStyle=he,Ee.stroke(Pe)}),je.clear(),Ke.clear()}function Fe(Ee,Pe,he,be,Ae,De,Ie,ke,dt,Pt,pt,Tt,jt){Ie=Math.max(1,Ie);const $t=xe(Pt+1,Tt),sn=re(Pt),Yt=S(sn,$t);if(ge[Pt][pt]={x:b(Ae-he),y:b(De-be),w:Ie,h:ke,sidx:Pt+1,didx:pt,fillColor:Yt},jt){let qt=Yt,bn=je.get(qt);if(bn==null&&je.set(qt,bn=new Path2D),Pe(bn,Ae,De,Ie,ke),dt){let Mt=$t,Jt=Ke.get(Mt);Jt==null&&Ke.set(Mt,Jt=new Path2D),Pe(Jt,Ae+dt/2,De+dt/2,Ie-dt,ke-dt)}}else Ee.beginPath(),Pe(Ee,Ae,De,Ie,ke),Ee.fillStyle=Yt,Ee.fill(),dt&&(Ee.beginPath(),Pe(Ee,Ae+dt/2,De+dt/2,Ie-dt,ke-dt),Ee.strokeStyle=$t,Ee.lineWidth=dt,Ee.stroke())}const at=(Ee,Pe,he,be)=>(f.A.orient(Ee,Pe,(Ae,De,Ie,ke,dt,Pt,pt,Tt,jt,$t,sn,Yt,qt,bn)=>{let Mt=b((Ae.width||0)*f.A.pxRatio),Jt=H(Pe),Ut=Jt&&se(Pe);Ee.ctx.save(),bn(Ee.ctx,Ee.bbox.left,Ee.bbox.top,Ee.bbox.width,Ee.bbox.height),Ee.ctx.clip(),R(ne,Pe-1,te,sn,(Gt,Lt,At)=>{if(G===L.Changes)for(let Nt=0;Nt<Ie.length;Nt++){let Dn=Ie[Nt];if(Dn!=null||Ut){let An=Math.round(Pt(De[Nt],ke,$t,Tt)),Pn=Nt;for(;++Pn<Ie.length&&(Ie[Pn]===void 0||Q&&Ie[Pn]===Dn););let Xn=Pn===Ie.length?Tt+$t+Mt:Math.round(Pt(De[Pn],ke,$t,Tt));Fe(Ee.ctx,bn,Tt,jt,An,b(jt+Lt),Xn-An,b(At),Mt,Gt,Nt,Dn,Jt),Nt=Pn-1}}else if(G===L.Samples){let Nt=Pt(De[1],ke,$t,Tt)-Pt(De[0],ke,$t,Tt),Dn=Nt*We,An=b(D(Ce,Nt-Dn)-Mt),Pn=An/2;for(let Xn=he;Xn<=be;Xn++){let Tn=Ie[Xn];if(Tn!=null||Ut){let ht=Pt(De[Xn],ke,$t,Tt);Fe(Ee.ctx,bn,Tt,jt,b(ht-Pn),b(jt+Lt),An,b(At),Mt,Gt,Xn,Tn,Jt)}}}}),Jt&&(Ee.ctx.lineWidth=Mt,_e(Ee.ctx)),Ee.ctx.restore()}),null),Ct=J==null||_===u.yL.Never?!1:(Ee,Pe,he,be)=>(Ee.ctx.save(),Ee.ctx.rect(Ee.bbox.left,Ee.bbox.top,Ee.bbox.width,Ee.bbox.height),Ee.ctx.clip(),Ee.ctx.font=Ue,Ee.ctx.textAlign=G===L.Changes?ee:"center",Ee.ctx.textBaseline="middle",f.A.orient(Ee,Pe,(Ae,De,Ie,ke,dt,Pt,pt,Tt,jt,$t,sn)=>{let Yt=b((Ae.width||0)*f.A.pxRatio),bn=H(Pe)&&se(Pe),Mt=b(pt(Se[Pe-1],dt,sn,jt));for(let Jt=0;Jt<Ie.length;Jt++)if(Ie[Jt]!=null||bn){const Ut=ge[Pe-1][Jt];if(!Ut||Ut.x>=$t)continue;let Gt=Math.floor(Ut?.w/M);if(_===u.yL.Auto&&Gt<2)continue;let Lt=J(Pe,Ie[Jt]),At=b(Ut.x+Tt+Ut.w/2);G===L.Changes&&(ee==="left"?At=b(Ut.x+Tt+Yt+C):ee==="right"&&(At=b(Ut.x+Tt+Ut.w-Yt-C))),Ee.ctx.fillStyle=ae.colors.getContrastText(Ut.fillColor,3),Ee.ctx.fillText(Lt.slice(0,Gt),At,Mt)}}),Ee.ctx.restore(),!1),Dt=Ee=>{let Pe="";for(let he=32;he<=126;he++)Pe+=String.fromCharCode(he);M=Math.ceil(Ee.ctx.measureText(Pe).width/Pe.length*f.A.pxRatio),M+=2.5,Ee.root.querySelectorAll(".u-cursor-pt").forEach(he=>{he.style.borderRadius="0"})},tt=Ee=>{Te=Te||new y.C$(0,0,Ee.bbox.width,Ee.bbox.height),Te.clear(),Oe(Ee.data[0].length),Ee.series.forEach(Pe=>{Pe._paths=null})};function ze(Ee,Pe,he=!1){Xe.fill(null),we=null,!(Ee<0)&&Te.get(Ee,0,f.A.pxRatio,1e4,be=>{Ee>=be.x&&Ee<=be.x+be.w&&(Pe>=be.y&&Pe<=be.y+be.h?Xe[be.sidx]=we=be:(ue||he)&&(Xe[be.sidx]=be))})}const pe={x:G===L.Changes,y:!1,dataIdx:(Ee,Pe)=>{if(Pe===1){if(Te.o.length===0&&Te.q==null)for(const Ae of ge)for(const De of Ae)De&&Te.add(De);let he=Ee.cursor.left*f.A.pxRatio,be=Ee.cursor.top*f.A.pxRatio;ze(he,be,Ee.cursor.event==null)}return Xe[Pe]?.didx},focus:{prox:1e3,dist:(Ee,Pe)=>we?.sidx===Pe?0:1/0},points:{fill:"rgba(255,255,255,0.2)",bbox:(Ee,Pe)=>{let he=Xe[Pe],be=he!=null;return{left:be?he.x/f.A.pxRatio:-10,top:be?he.y/f.A.pxRatio:-10,width:be?he.w/f.A.pxRatio:0,height:be?he.h/f.A.pxRatio:0}}}},Se=Array(te).fill(0),fe=[0,1];return{cursor:pe,xSplits:G===L.Samples?(Ee,Pe,he,be,Ae,De)=>{let Ie=[],ke=Ee.data[0][1]-Ee.data[0][0],dt=P(Ae/ke);for(let Pt=0;Pt<Ee.data[0].length;Pt+=dt){let pt=Ee.data[0][Pt];pt>=he&&pt<=be&&Ie.push(pt)}return Ie}:null,xRange:Ee=>{const Pe=de();let he=Pe.from.valueOf(),be=Pe.to.valueOf();if(G===L.Samples){let Ie=(Ee.data[0][1]-Ee.data[0][0])/2;he<=Ee.data[0][0]&&(he=Ee.data[0][0]-Ie);let ke=Ee.data[0].length-1;be>=Ee.data[0][ke]&&(be=Ee.data[0][ke]+Ie)}return[he,be]},ySplits:Ee=>(R(ne,null,te,Ee.bbox.height,(Pe,he,be)=>{let Ae=b(he+be/2);Se[Pe]=Ee.posToVal(Ae/f.A.pxRatio,v.s)}),Se),yValues:(Ee,Pe)=>Pe.map((he,be)=>oe(be+1)),yRange:fe,drawPaths:at,drawPoints:Ct,init:Dt,drawClear:tt}}function S(q,G){if(G[0]==="#"&&G.length===9)return G;const te=(q.fillOpacity??100)/100;return(0,E.X4)(G,te)}var L=(q=>(q.Changes="changes",q.Samples="samples",q))(L||{});const O={lineWidth:0,fillOpacity:80},j=({frame:q,theme:G,timeZones:te,getTimeRange:H,mode:se,rowHeight:ne,colWidth:le,showValue:_,alignValue:Q,mergeValues:ae,getValueColor:oe,hoverMulti:J})=>{const ee=new m.e(te[0]),de="x",xe=Ue=>{const Xe=Ue.config?.color?.mode;return!(Xe&&Ue.display&&Xe.startsWith("continuous-"))},re=Ue=>Ue.config.mappings?.some(Xe=>Xe.type===p.dM.SpecialValue&&Xe.options.match==="null")||!1,ue=(Ue,Xe)=>{const we=q.fields[Ue];return we.state?.origin?.fieldIndex!==void 0&&we.state?.origin?.frameIndex!==void 0&&oe?oe(we.state?.origin?.frameIndex,we.state?.origin?.fieldIndex,Xe):n.F},Te={mode:se,numSeries:q.fields.length-1,isDiscrete:Ue=>xe(q.fields[Ue]),hasMappedNull:Ue=>re(q.fields[Ue]),mergeValues:ae,rowHeight:ne,colWidth:le,showValue:_,alignValue:Q,theme:G,label:Ue=>(0,s.Ct)(q.fields[Ue],q),getFieldConfig:Ue=>q.fields[Ue].config.custom,getValueColor:ue,getTimeRange:H,formatValue:(Ue,Xe)=>(0,l.cN)(q.fields[Ue].display(Xe)),hoverMulti:J},ge=T(Te);ee.addHook("init",ge.init),ee.addHook("drawClear",ge.drawClear),ee.setPrepData(Ue=>(0,x.bq)(Ue[0],(0,x.ro)(Ue[0]))),ee.setCursor(ge.cursor),ee.addScale({scaleKey:de,isTime:!0,orientation:u.Lt.Horizontal,direction:u.ON.Right,range:ge.xRange}),ee.addScale({scaleKey:v.s,isTime:!1,orientation:u.Lt.Vertical,direction:u.ON.Up,range:ge.yRange}),ee.addAxis({scaleKey:de,isTime:!0,splits:ge.xSplits,placement:u.vM.Bottom,timeZone:te[0],theme:G,grid:{show:!0}}),ee.addAxis({scaleKey:v.s,isTime:!1,placement:u.vM.Left,splits:ge.ySplits,values:ge.yValues,grid:{show:!1},ticks:{show:!1},gap:16,theme:G});let Oe=0;for(let Ue=0;Ue<q.fields.length;Ue++){if(Ue===0)continue;const Xe=q.fields[Ue],we=Xe.config,qe={...O,...we.custom};Xe.state.seriesIndex=Oe++,ee.addSeries({scaleKey:v.s,pathBuilder:ge.drawPaths,pointsBuilder:ge.drawPoints,lineWidth:qe.lineWidth,fillOpacity:qe.fillOpacity,theme:G,show:!qe.hideFrom?.viz,thresholds:we.thresholds,dataFrameFieldIndex:Xe.state?.origin})}return ee};function N(q){let G=q.config.custom?.spanNulls;return G?G===!0?1/0:G:-1}function F(q,G){const te=q.config.thresholds;if(q.type!==r.PU.number||!te||!te.steps.length)return;const H=B(q.config,G);if(H.length!==te.steps.length)return;const se=new Map,ne=new Map;for(let Q=0;Q<H.length;Q++)se.set(te.steps[Q],H[Q].label),ne.set(H[Q].label,H[Q].color);let le=q.values;const _=new Array(q.values.length);if(te.mode===i.O.Percentage){const{min:Q,max:ae}=(0,g.xg)(q),oe=ae-Q;le=le.map(J=>J==null?J:(J-Q)/oe*100)}for(let Q=0;Q<_.length;Q++){const ae=le[Q];ae==null?_[Q]=ae:_[Q]=se.get((0,o.yQ)(ae,te.steps))}return{...q,config:{...q.config,custom:{...q.config.custom,spanNulls:N(q)}},type:r.PU.string,values:_,display:Q=>({text:String(Q),color:ne.get(String(Q)),numeric:NaN})}}function U(q,G,te,H){if(!q?.length)return{warn:"No data in response"};(0,s.Fm)(q);let se=!1;const ne=[];for(let le of q){let _=-1,Q=-1;for(let de=0;de<le.fields.length;de++)if(le.fields[de].type===r.PU.time){if(_===-1)_=de;else if(Q===-1){Q=de;break}}let ae=_!==-1,oe=!1;if(le=(0,d.Yj)(le,_),Q!==-1){let de={...le,fields:le.fields.filter((re,ue)=>ue!==Q)},xe={length:le.length,fields:[le.fields[Q]]};le=(0,d.Fd)({frames:[de,xe],keepDisplayNames:!0,nullMode:()=>d.WO}),le.fields.forEach((re,ue)=>{if(ue>0){let Te=re.values;for(let ge=0;ge<Te.length;ge++)Te[ge]==null&&(Te[ge]=null)}}),oe=!0}let J=(0,c.M)({frame:le,refFieldPseudoMin:te.from.valueOf(),refFieldPseudoMax:te.to.valueOf()});J!==le&&(oe=!0),le=(0,a.C)(J);const ee=[];for(let de of le.fields)if(!de.config.custom?.hideFrom?.viz)switch(de.type){case r.PU.time:ae=!0,se=!0,ee.push(de);break;case r.PU.enum:case r.PU.number:if(G&&de.config.color?.mode===n.Y.Thresholds){const xe=F(de,H);if(xe){ee.push(xe),oe=!0;continue}}case r.PU.boolean:case r.PU.string:de={...de,config:{...de.config,custom:{...de.config.custom,spanNulls:N(de)}}},oe=!0,ee.push(de);break;default:oe=!0}ae&&ee.length>1&&(se=!0,oe?ne.push({...le,fields:ee}):ne.push(le))}return se?ne.length?{frames:ne}:{warn:"No graphable fields"}:{warn:"Data does not have a time field"}}function w(q){const G=[];for(let te of q){const H=te.fields.filter(se=>se.type===r.PU.time);if(H.length>0)for(let se of te.fields)se.type!==r.PU.time&&G.push({fields:[...H,se],length:te.length})}return G}function B(q,G){const te=[],H=q.thresholds;if(!H||!H.steps.length)return te;const se=H.steps,ne=(0,l.j_)(H.mode===i.O.Percentage?"percent":q.unit??""),le=_=>(0,l.cN)(ne(_,q.decimals??void 0));for(let _=0;_<se.length;_++){let Q=se[_],ae=Q.value,oe="",J="";ae===-1/0&&_<se.length-1?(ae=se[_+1].value,oe="< "):J="+",te.push({label:`${oe}${le(ae)}${J}`,color:G.visualization.getColorByName(Q.color),yAxis:1})}return te}function K(q,G,te){if(!(!q||G.showLegend===!1))return W(z(q),te)}function W(q,G){if(!q.length)return;const te=[],H=q[0].config,se=H.color?.mode??n.Y.Fixed,ne=H.thresholds;if(se===n.Y.Thresholds&&ne?.steps&&ne.steps.length>1)return B(H,G);if(se.startsWith("continuous"))return;const le=new Map;return q.forEach(_=>{_.config.custom?.hideFrom?.legend||_.values.forEach(Q=>{let ae=_.display(Q);ae.color&&le.set(ae.text,ae.color)})}),le.forEach((_,Q)=>{Q.length>0&&te.push({label:Q,color:G.visualization.getColorByName(_??n.F),yAxis:1})}),te}function z(q){const G=[];for(const te of q)for(const H of te.fields)H.type!==r.PU.time&&G.push(H);return G}function Y(q,G){let te,H=G+1;if(H>=q.values.length)return null;const se=q.values[G];for(;te===void 0;){if(H>=q.values.length)return null;const ne=q.values[H];ne===void 0||ne===se?H++:te=H}return te}function X(q){if(q<0||Number.isNaN(q))return"";let G,te,H,se,ne,le,_,Q;return _=Math.floor(q/1e3),le=Math.floor(_/60),_=_%60,ne=Math.floor(le/60),le=le%60,se=Math.floor(ne/24),ne=ne%24,G=Math.floor(se/365),G>0&&(se=se%365),te=Math.floor(se/30),te>0&&(se=se%30),H=Math.floor(se/7),H>0&&(se=se%7),Q=Math.round(q%1e3*1e3)/1e3,(G>0?G+"y "+(te>0?te+"mo ":"")+(H>0?H+"w ":"")+(se>0?se+"d ":""):te>0?te+"mo "+(H>0?H+"w ":"")+(se>0?se+"d ":""):H>0?H+"w "+(se>0?se+"d ":""):se>0?se+"d "+(ne>0?ne+"h ":""):ne>0?ne+"h "+(le>0?le+"m ":""):le>0?le+"m "+(_>0?_+"s ":""):_>0?_+"s "+(Q>0?Q+"ms ":""):Q>0?Q+"ms ":"0").trim()}},76323:(k,A,e)=>{"use strict";e.d(A,{J:()=>g});var n=e(74848),s=e(32196),l=e(96540),r=e(14110),i=e(40845);const g=({text:d="PRO",className:c,experimentId:a,eventVariant:p="",...u})=>{const m=(0,i.of)(o);return(0,l.useEffect)(()=>{a&&(0,r.Xp)(a,"test",p)},[a,p]),(0,n.jsx)("span",{className:(0,s.cx)(m.badge,c),...u,children:d})},o=d=>({badge:(0,s.css)`
      margin-left: ${d.spacing(1.25)};
      border-radius: ${d.shape.borderRadius(5)};
      background-color: ${d.colors.success.main};
      padding: ${d.spacing(.25,.75)};
      color: white; // use the same color for both themes
      font-weight: ${d.typography.fontWeightMedium};
      font-size: ${d.typography.pxToRem(10)};
    `})},77454:(k,A,e)=>{"use strict";e.d(A,{El:()=>a,Iz:()=>d,ep:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(14110),i=e(40845),g=e(14578),o=e(55852);const d=({featureName:x,className:f,children:E,text:h,featureId:y,eventVariant:b="",size:D="md",...P})=>{const C=(0,i.of)(c,D);return(0,l.useEffect)(()=>{(0,r.Xp)(`feature-highlights-${y}`,"test",b)},[b,y]),(0,n.jsxs)("div",{className:(0,s.cx)(C.box,f),...P,children:[(0,n.jsx)(g.I,{name:"rocket",className:C.icon}),(0,n.jsxs)("div",{className:C.inner,children:[(0,n.jsxs)("p",{className:C.text,children:["You\u2019ve discovered a Pro feature! ",h||`Get the Grafana Pro plan to access ${x}.`]}),(0,n.jsx)(o.z9,{variant:"secondary",size:D,className:C.button,href:"https://grafana.com/profile/org/subscription",target:"__blank",rel:"noopener noreferrer",children:"Upgrade"})]})]})},c=(x,f)=>{const E=x.shape.borderRadius(2),h=f==="md"?"body":"bodySmall";return{box:(0,s.css)`
      display: flex;
      align-items: center;
      position: relative;
      border-radius: ${E};
      background: ${x.colors.success.transparent};
      padding: ${x.spacing(2)};
      color: ${x.colors.success.text};
      font-size: ${x.typography[h].fontSize};
      text-align: left;
      line-height: 16px;
      margin: ${x.spacing(0,"auto",3,"auto")};
      max-width: ${x.breakpoints.values.xxl}px;
      width: 100%;
    `,inner:(0,s.css)`
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: space-between;
    `,text:(0,s.css)`
      margin: 0;
    `,button:(0,s.css)`
      background-color: ${x.colors.success.main};
      font-weight: ${x.typography.fontWeightLight};
      color: white;

      &:hover {
        background-color: ${x.colors.success.main};
      }

      &:focus-visible {
        box-shadow: none;
        color: ${x.colors.text.primary};
        outline: 2px solid ${x.colors.primary.main};
      }
    `,icon:(0,s.css)`
      margin: ${x.spacing(.5,1,.5,.5)};
    `}},a=({listItems:x,image:f,featureUrl:E,featureName:h,description:y,caption:b,action:D})=>{const P=(0,i.of)(p);return(0,n.jsxs)("div",{className:P.container,children:[(0,n.jsxs)("div",{className:P.content,children:[(0,n.jsxs)("h3",{className:P.title,children:["Get started with ",h]}),y&&(0,n.jsx)("h6",{className:P.description,children:y}),(0,n.jsx)("ul",{className:P.list,children:x.map((C,M)=>(0,n.jsxs)("li",{children:[(0,n.jsx)(g.I,{name:"check",size:"xl",className:P.icon})," ",C]},M))}),D?.link&&(0,n.jsx)(o.z9,{variant:"primary",href:D.link,children:D.text}),D?.onClick&&(0,n.jsx)(o.$n,{variant:"primary",onClick:D.onClick,children:D.text}),E&&(0,n.jsx)(o.z9,{fill:"text",href:E,className:P.link,target:"_blank",rel:"noreferrer noopener",children:"Learn more"})]}),(0,n.jsxs)("div",{className:P.media,children:[(0,n.jsx)("img",{src:v(f),alt:"Feature screenshot"}),b&&(0,n.jsx)("p",{className:P.caption,children:b})]})]})},p=x=>({container:(0,s.css)`
      display: flex;
      justify-content: space-between;
    `,content:(0,s.css)`
      width: 45%;
      margin-right: ${x.spacing(4)};
    `,media:(0,s.css)`
      width: 55%;

      img {
        width: 100%;
      }
    `,title:(0,s.css)`
      color: ${x.colors.text.maxContrast};
    `,description:(0,s.css)`
      color: ${x.colors.text.primary};
      font-weight: ${x.typography.fontWeightLight};
    `,list:(0,s.css)`
      list-style: none;
      margin: ${x.spacing(4,0,2,0)};

      li {
        display: flex;
        align-items: flex-start;
        color: ${x.colors.text.primary};
        padding: ${x.spacing(1,0)};
      }
    `,icon:(0,s.css)`
      color: ${x.colors.success.main};
      margin-right: ${x.spacing(1)};
    `,link:(0,s.css)`
      margin-left: ${x.spacing(2)};
    `,caption:(0,s.css)`
      font-weight: ${x.typography.fontWeightLight};
      margin: ${x.spacing(1,0,0)};
    `}),u=({featureName:x,description:f,featureUrl:E,image:h})=>{const y=(0,i.of)(m);return(0,n.jsxs)("div",{className:y.container,children:[(0,n.jsxs)("h3",{className:y.title,children:["Get started with ",x]}),f&&(0,n.jsx)("h6",{className:y.description,children:f}),(0,n.jsx)(o.z9,{fill:"text",href:E,target:"_blank",rel:"noreferrer noopener",children:"Learn more"}),(0,n.jsx)("div",{className:y.media,children:(0,n.jsx)("img",{src:v(h),alt:"Feature screenshot"})})]})},m=x=>({container:(0,s.css)`
      overflow: auto;
      height: 100%;
    `,title:(0,s.css)`
      color: ${x.colors.text.maxContrast};
    `,description:(0,s.css)`
      color: ${x.colors.text.primary};
      font-weight: ${x.typography.fontWeightLight};
    `,media:(0,s.css)`
      width: 100%;
      margin-top: ${x.spacing(2)};

      img {
        width: 100%;
      }
    `}),v=x=>x.startsWith("http")?x:"/public/img/enterprise/highlights/"+x},35043:(k,A,e)=>{"use strict";e.d(A,{DP:()=>a,NQ:()=>c,zJ:()=>p});var n=e(74848),s=e(32196),l=e(90613),r=e(40845),i=e(14578),g=e(94753),o=e(2913),d=e(8484);const c=[{message:"At least 12 characters",validation:v=>v.length>=12},{message:"One uppercase letter",validation:v=>/[A-Z]+/.test(v)},{message:"One lowercase letter",validation:v=>/[a-z]+/.test(v)},{message:"One number",validation:v=>/[0-9]+/.test(v)},{message:"One symbol",validation:v=>/[\W]/.test(v)}],a=v=>!o.Ay.auth.basicAuthStrongPasswordPolicy||c.every(x=>x.validation(v))||(0,d.t)("profile.change-password.strong-password-validation-register","Password does not comply with the strong password policy"),p=({strongPasswordValidations:v,password:x,pristine:f})=>(0,n.jsx)(l.a,{marginBottom:2,children:v.map(E=>(0,n.jsx)(u,{strongPasswordValidation:E,password:x,pristine:f},E.message))}),u=({strongPasswordValidation:v,password:x,pristine:f})=>{const E=(0,r.of)(m),{basicAuthStrongPasswordPolicy:h}=o.Ay.auth;if(!h)return null;const{message:y,validation:b}=v,D=x.length>0&&b(x),P=D||f?"check":"exclamation-triangle",C=D?"secondary":f?"primary":"error";let M;return D?M=E.icon.valid:f?M=E.icon.pending:M=E.icon.error,(0,n.jsxs)(l.a,{display:"flex",alignItems:"center",marginTop:1,children:[(0,n.jsx)(i.I,{className:(0,s.cx)(E.icon.style,M),name:P}),(0,n.jsx)(g.E,{color:C,children:y})]},y)},m=v=>({icon:{style:(0,s.css)({marginRight:v.spacing(1)}),valid:(0,s.css)({color:v.colors.success.text}),pending:(0,s.css)({color:v.colors.secondary.text}),error:(0,s.css)({color:v.colors.error.text})}})},93522:(k,A,e)=>{"use strict";e.d(A,{N:()=>p});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(37390),g=e(71259),o=e(94753),d=e(8484),c=e(63917);const a=x=>[{category:(0,d.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,d.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,d.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,d.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,d.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${x} + k`],description:(0,d.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,d.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,d.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,d.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,d.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,d.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,d.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,d.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,d.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,d.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,d.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,d.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${x} + s`],description:(0,d.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,d.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,d.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,d.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,d.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,d.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,d.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,d.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${x} + o`],description:(0,d.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,d.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,d.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,d.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,d.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,d.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,d.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,d.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,d.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,d.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],p=({onDismiss:x})=>{const f=(0,r.of)(v),E=(0,l.useMemo)(()=>(0,c.gn)(),[]),h=(0,l.useMemo)(()=>a(E),[E]);return(0,n.jsx)(i.a,{title:(0,d.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:x,onClickBackdrop:x,children:(0,n.jsx)(g.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(h).map(({category:y,shortcuts:b})=>(0,n.jsx)("section",{children:(0,n.jsxs)("table",{className:f.table,children:[(0,n.jsx)("caption",{children:(0,n.jsx)(o.E,{element:"p",variant:"h5",children:y})}),(0,n.jsx)("thead",{className:"sr-only",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Keys"}),(0,n.jsx)("th",{children:"Description"})]})}),(0,n.jsx)("tbody",{children:b.map(({keys:D,description:P})=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:f.keys,children:D.map(C=>(0,n.jsx)(u,{children:C},C))}),(0,n.jsx)("td",{children:(0,n.jsx)(o.E,{variant:"bodySmall",element:"p",children:P})})]},D.join()))})]})},y))})})},u=({children:x})=>{const f=(0,r.of)(v),E=(0,l.useMemo)(()=>m(x),[x]),h=(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:E}});return(0,n.jsx)("kbd",{className:f.shortcutTableKey,children:(0,n.jsx)(o.E,{variant:"code",children:h})})};function m(x){let f,E;if(x.includes("ctrl"))f="ctrl",E="Control";else if(x.includes("esc"))f="esc",E="Escape";else return x;return x.replace(f,`<span class="sr-only">${E}</span><span aria-hidden="true" role="none">${f}</span>`)}function v(x){return{table:(0,s.css)({borderCollapse:"separate",borderSpacing:x.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,s.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,s.css)({display:"inline-block",textAlign:"center",marginRight:x.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${x.colors.border.medium}`,borderRadius:x.shape.radius.default,color:x.colors.text.primary,backgroundColor:x.colors.background.secondary})}}},2913:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>r,_R:()=>g,config:()=>s.$,yn:()=>o,zj:()=>i});var n=e(43429),s=e(32264);let l=s.$;const r=l,i=()=>l,g=d=>{l={...l,...d}},o=s.$.panels?.debug?.state===n.pn.alpha},15054:(k,A,e)=>{"use strict";e.d(A,{FG:()=>u,HG:()=>i,IZ:()=>a,MM:()=>v,Pz:()=>r,bJ:()=>o,cV:()=>l,cx:()=>d,dU:()=>s,o9:()=>g,sD:()=>n,tH:()=>c,wV:()=>m});const n=30,s=8,l=24,r="v",i="h",g=4,o=250,d=n*3,c="panel-copy",a=2,p=23763571993,u=40,m="VisualizationSelectPane.ListMode",v="WidgetSelectPane.ListMode"},76888:(k,A,e)=>{"use strict";e.d(A,{Il:()=>i,YE:()=>r,k9:()=>d,ni:()=>g});var n=e(96540),s=e(39601),l=e(32264);const r=(0,n.createContext)(void 0);function i(){const c=(0,n.useContext)(r);if(!c)throw new Error("No GrafanaContext found");return c}function g(){const{chrome:c}=i();return(0,n.useCallback)((a,p)=>{const{pathname:u,search:m}=s.Ny.getLocation();c.setReturnToPrevious({title:a,href:p??u+m})},[c])}const o=40;function d(){const{chrome:c}=i(),{kioskMode:a,searchBarHidden:p,chromeless:u}=c.useState();return a||u||!l.$.featureToggles.bodyScrolling?0:p?o:o*2}},3169:(k,A,e)=>{"use strict";e.d(A,{Cf:()=>u,_2:()=>m,gi:()=>a,q8:()=>p,tZ:()=>c});var n=e(96540),s=e(62938),l=e(94954),r=e(31678),i=e(82467);const g={title:"",text:"",severity:r.AppNotificationSeverity.Success,icon:"check"},o={title:"",text:"",severity:r.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},d={title:"",text:"",severity:r.AppNotificationSeverity.Error,icon:"exclamation-triangle"},c=(v,x="",f)=>({...g,title:v,text:x,id:(0,s.A)(),timestamp:Date.now(),showing:!0}),a=(v,x="",f,E)=>({...d,text:(0,l.q)(x),title:v,id:(0,s.A)(),traceId:f,component:E,timestamp:Date.now(),showing:!0}),p=(v,x="",f)=>({...o,title:v,text:x,traceId:f,id:(0,s.A)(),timestamp:Date.now(),showing:!0}),u=(v,x="",f)=>({severity:r.AppNotificationSeverity.Info,icon:"info-circle",title:v,text:x,id:(0,s.A)(),timestamp:Date.now(),showing:!0});function m(){const v=(0,r.useDispatch)();return(0,n.useMemo)(()=>({success:(x,f="")=>{v((0,i.dx)(c(x,f)))},warning:(x,f="",E)=>{v((0,i.dx)(p(x,f,E)))},error:(x,f="",E)=>{v((0,i.dx)(a(x,f,E)))},info:(x,f="")=>{v((0,i.dx)(u(x,f)))}}),[v])}},10096:(k,A,e)=>{"use strict";e.d(A,{Ef:()=>s.E,contextSrv:()=>l.TP,lE:()=>n.A,rO:()=>r.r});var n=e(28138),s=e(18898),l=e(16233),r=e(31140)},39640:(k,A,e)=>{"use strict";e.d(A,{$H:()=>c,Ay:()=>a});var n=e(2543),s=e(33390),l=e(38877),r=e(19347);const i=y=>{const b=(0,r.l)().getInstanceSettings(y.datasourceName);return{id:y.ts.toString(),createdAt:y.ts,datasourceName:y.datasourceName,datasourceUid:b?.uid||"",starred:y.starred,comment:y.comment,queries:y.queries}},g=y=>{if(!(0,r.l)().getInstanceSettings({uid:y.datasourceUid}))throw new Error("Datasource not found.");return{ts:y.createdAt,datasourceName:y.datasourceName,starred:y.starred,comment:y.comment,queries:y.queries}};var o=e(75533);const d="grafana.explore.richHistory",c=1e4;class a{async getRichHistory(b){const D=v().map(i),P=b.starred?D.filter(I=>I.starred===!0):D,C=b.from&&b.to?[b.from,b.to]:void 0,M=(0,o.a_)(P,b.sortOrder,b.datasourceFilters,b.search,C);return{richHistory:M,total:M.length}}async addToRichHistory(b){const D=Date.now(),P={id:D.toString(),createdAt:D,...b},C=g(P),M=u(v()),I=C.queries.map(O=>(0,n.omit)(O,["key","refId"])),R=M.length>0&&M[0].queries.map(O=>(0,n.omit)(O,["key","refId"]));if((0,n.isEqual)(I,R)){const O=new Error("Entry already exists");throw O.name=l.m.DuplicatedEntry,O}const{queriesToKeep:T,limitExceeded:S}=m(M),L=[C,...T];try{s.A.setObject(d,L)}catch(O){if(O instanceof Error&&O.name==="QuotaExceededError")h(l.m.StorageFull,`Saving rich history failed: ${O.message}`);else throw O}return S?{warning:{type:l.C.LimitExceeded,message:`Query history reached the limit of ${c}. Old, not-starred items have been removed.`},richHistoryQuery:P}:{richHistoryQuery:P}}async deleteAll(){s.A.delete(d)}async deleteRichHistory(b){const D=parseInt(b,10),C=s.A.getObject(d,[]).filter(M=>M.ts!==D);s.A.setObject(d,C)}async updateStarred(b,D){return p(b,P=>P.starred=D)}async updateComment(b,D){return p(b,P=>P.comment=D)}async getSettings(){return{activeDatasourcesOnly:s.A.getObject(o.mE.activeDatasourcesOnly)??s.A.getObject(o.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:s.A.getObject(o.mE.retentionPeriod,7),starredTabAsFirstTab:s.A.getBool(o.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:s.A.getObject(o.mE.datasourceFilters,[]).map(D=>D.value)}}async updateSettings(b){s.A.set(o.mE.activeDatasourcesOnly,b.activeDatasourcesOnly),s.A.set(o.mE.retentionPeriod,b.retentionPeriod),s.A.set(o.mE.starredTabAsFirstTab,b.starredTabAsFirstTab),s.A.setObject(o.mE.datasourceFilters,(b.lastUsedDatasourceFilters||[]).map(D=>({value:D})))}}function p(y,b){const D=parseInt(y,10),P=s.A.getObject(d,[]),C=(0,n.find)(P,{ts:D});if(!C)throw new Error("Rich history item not found.");return b(C),s.A.setObject(d,P),i(C)}function u(y){const b=s.A.getObject(o.mE.retentionPeriod,7),D=(0,o.wQ)(b,{isLastTs:!1});return y.filter(P=>P.ts>D||P.starred===!0)||[]}function m(y){let b=!1,D=y.length-1;for(;D>=0&&y.length>=c;)y[D].starred||(y.splice(D,1),b=!0),D--;return{queriesToKeep:y,limitExceeded:b}}function v(){const y=s.A.getObject(d,[]);return x(y)}function x(y){return y.map(D=>{const P=D.queries.map((C,M)=>f(D,C,M));return{...D,queries:P}})}function f(y,b,D){const P="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof b=="object"?b:E(b)?JSON.parse(b):{expr:b,refId:P[D]}}function E(y){try{JSON.parse(y)}catch{return!1}return!0}function h(y,b){const D=new Error(b);throw D.name=y,D}},38877:(k,A,e)=>{"use strict";e.d(A,{C:()=>s,m:()=>n});var n=(l=>(l.StorageFull="StorageFull",l.DuplicatedEntry="DuplicatedEntry",l))(n||{}),s=(l=>(l.LimitExceeded="LimitExceeded",l))(s||{})},75533:(k,A,e)=>{"use strict";e.d(A,{a_:()=>i,mE:()=>p,wQ:()=>g});var n=e(2543),s=e.n(n),l=e(47232),r=e(91650);function i(u,m,v,x,f){const E=d(u,v),h=c(E,x),y=f?o(h,f):h;return a(y,m)}const g=(u,m)=>{let v=m.now;return v||(v=m.tz?(0,l.oZ)(m.tz):(0,l.KQ)()),v.add(-u,"d"),(m.isLastTs?v.endOf("d"):v.startOf("d")).valueOf()};function o(u,m){return u.filter(v=>v.createdAt>m[0]&&v.createdAt<m[1])}function d(u,m){return m.length>0?u.filter(v=>m.includes(v.datasourceName)):u}function c(u,m){return u.filter(v=>v.comment.includes(m)?!0:v.queries.filter(f=>Object.values((0,n.omit)(f,["datasource","key","refId","hide","queryType"])).some(E=>E?.toString().includes(m))).length>0)}const a=(u,m)=>{let v;return m===r.x.Ascending&&(v=(x,f)=>x.createdAt<f.createdAt?-1:x.createdAt>f.createdAt?1:0),m===r.x.Descending&&(v=(x,f)=>x.createdAt<f.createdAt?1:x.createdAt>f.createdAt?-1:0),m===r.x.DatasourceZA&&(v=(x,f)=>x.datasourceName<f.datasourceName?-1:x.datasourceName>f.datasourceName?1:0),m===r.x.DatasourceAZ&&(v=(x,f)=>x.datasourceName<f.datasourceName?1:x.datasourceName>f.datasourceName?-1:0),u.sort(v)},p={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(k,A,e)=>{"use strict";e.d(A,{tU:()=>f,a:()=>x,gQ:()=>E});var n=e(32264),s=e(10096),l=e(91650),r=e(39640),i=e(75505),g=e(17172),o=e(19347),d=e(65615);const c=h=>{const y=(0,o.l)().getInstanceSettings({uid:h.datasourceUid});return{id:h.uid,createdAt:h.createdAt*1e3,datasourceName:y?.name||"",datasourceUid:h.datasourceUid,starred:h.starred,comment:h.comment,queries:h.queries}},a=h=>({uid:h.id,createdAt:Math.floor(h.createdAt/1e3),datasourceUid:h.datasourceUid,starred:h.starred,comment:h.comment,queries:h.queries});class p{constructor(){this.preferenceService=new d.W("user")}async addToRichHistory(y){const{result:b}=await(0,g.AI)().post("/api/query-history",{dataSourceUid:y.datasourceUid,queries:y.queries});return{richHistoryQuery:c(b)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(y){(0,g.AI)().delete(`/api/query-history/${y}`)}async getRichHistory(y){const b=u(y);let D="query-history-get-all";y.starred&&(D="query-history-get-starred");const C=(await(0,i.s)((0,g.AI)().fetch({method:"GET",url:`/api/query-history?${b}`,requestId:D}))).data,M=(C.result.queryHistory||[]).map(c),I=C.result.totalCount||0;return{richHistory:M,total:I}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(y,b){const D=await(0,g.AI)().patch(`/api/query-history/${y}`,{comment:b});return c(D.result)}updateSettings(y){return this.preferenceService.patch({queryHistory:{homeTab:y.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(y,b){let D;return b?D=await(0,g.AI)().post(`/api/query-history/star/${y}`):D=await(0,g.AI)().delete(`/api/query-history/star/${y}`),c(D.result)}}function u(h){let y=`${h.datasourceFilters.map(b=>{const D=(0,o.l)().getInstanceSettings(b).uid;return`datasourceUid=${encodeURIComponent(D)}`}).join("&")}`;return h.search&&(y=y+`&searchString=${h.search}`),h.sortOrder&&(y=y+`&sort=${h.sortOrder===l.x.Ascending?"time-asc":"time-desc"}`),h.starred||(y=y+`&to=${h.to}`,y=y+`&from=${h.from}`),y=y+"&limit=100",y=y+`&page=${h.page||1}`,h.starred&&(y=y+`&onlyStarred=${h.starred}`),y}const m=new r.Ay,v=new p,x=()=>n.$.queryHistoryEnabled?v:m,f=()=>m,E=()=>n.$.queryHistoryEnabled?{availableFilters:[l.x.Descending,l.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:s.contextSrv.isSignedIn}:{availableFilters:[l.x.Descending,l.x.Ascending,l.x.DatasourceAZ,l.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(k,A,e)=>{"use strict";e.d(A,{u:()=>s});var n=e(96540);function s(l,r){const[i,g]=(0,n.useState)();return(0,n.useEffect)(()=>{const o=l.subscribe(r,g);return()=>o.unsubscribe()},[l,r]),i}},60619:(k,A,e)=>{"use strict";e.d(A,{Y:()=>s});var n=e(96540);function s({breakpoint:l,onChange:r}){(0,n.useEffect)(()=>{const i=window.matchMedia(`(min-width: ${l}px)`),g=o=>r(o);return i.addEventListener("change",g),()=>i.removeEventListener("change",g)},[l,r])}},25249:(k,A,e)=>{"use strict";e.d(A,{C:()=>l});var n=e(31678),s=e(17422);const l=r=>{const i=(0,n.useSelector)(g=>g.navIndex);return(0,s.tc)(i,r)}},83277:(k,A,e)=>{"use strict";e.d(A,{s:()=>r});var n=e(96540),s=e(24180),l=e(39601);function r(){const{search:i}=(0,s.zy)(),g=(0,n.useMemo)(()=>(0,l.SE)(i||""),[i]),o=(0,n.useCallback)((d,c)=>l.Ny.partial(d,c),[]);return[g,o]}},74513:(k,A,e)=>{"use strict";e.d(A,{MB:()=>l,NY:()=>r,Nm:()=>a,Yj:()=>p,dK:()=>m,d_:()=>i,fY:()=>d,jQ:()=>o,rT:()=>g,rd:()=>u,wi:()=>c});var n=e(2543),s=e.n(n);const l="en-US",r="fr-FR",i="es-ES",g="de-DE",o="pt-BR",d="zh-Hans",c="pseudo-LOCALE",a=l,p=[{code:l,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:r,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:i,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:g,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:d,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:o,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const v=e(55905);if(v.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:x,ENTERPRISE_I18N_NAMESPACE:f}=v("app/extensions/locales/localeExtensions");for(const E of p){const h=x[E.code];h&&(E.loader[f]=h)}}}const u=p.map(v=>v.code),m=(0,n.uniq)(p.flatMap(v=>Object.keys(v.loader)))},84753:(k,A,e)=>{"use strict";e.d(A,{Y:()=>a,a:()=>p});var n=e(5086),s=e(32017),l=e.n(s),r=e(47078),i=e.n(r),g=e(8484);const o=u=>i()(u,{isEqual:l()}),d=o((u,m)=>new Intl.DateTimeFormat(u,m)),c=o((u,m)=>new Intl.DurationFormat(u,m)),a=o((u,m={})=>{if(typeof u=="string")return a(new Date(u),m);const v=(0,g.iL)();return d(v.language,m).format(u)}),p=o((u,m={})=>{const v=(0,g.iL)();return c(v.language,m).format(u)})},8484:(k,A,e)=>{"use strict";e.d(A,{x6:()=>u,iL:()=>v,JL:()=>a,t:()=>m});var n=e(74848),s=e(72635),l=e(94997),r=e(32389),i=e(74513);const g=x=>x.split("-")[0].toLowerCase(),o={type:"backend",init(){},async read(x,f,E){let h=i.Yj.find(D=>D.code===x);if(h||(h=i.Yj.find(D=>g(D.code)===g(x))),!h)return E(new Error(`No message loader available for ${x}`),null);const y=h.loader[f];if(!y)return E(new Error(`No message loader available for ${x} with namespace ${f}`),null);const b=await y();E(null,b)}};let d,c;async function a(x){const f={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:i.rd,fallbackLng:i.Nm,ns:i.dK};if(c=s.default,x==="detect"){c=c.use(l.A);const h={order:["navigator"],caches:[]};f.detection=h}else f.lng=i.rd.includes(x)?x:void 0;return await c.use(o).use(r.r9).init(f),d=s.default.getFixedT(null,i.dK),{language:c.resolvedLanguage}}function p(x){const f=VALID_LANGUAGES.includes(x)?x:void 0;return i18n.changeLanguage(f)}const u=x=>(0,n.jsx)(r.x6,{shouldUnescape:!0,ns:i.dK,...x}),m=(x,f,E)=>(d||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),d=s.default.t),d(x,f,E));function v(){return d?c||s.default:(console.warn("An attempt to internationalize was made before it was initialized. This was probably caused by calling a locale-aware function in the root module scope, instead of in render"),s.default)}},18898:(k,A,e)=>{"use strict";e.d(A,{E:()=>s});class n{constructor(){this.panelsRendered=0,this.enabled=void 0}renderingCompleted(){this.panelsRendered+=1,window.panelsRendered=this.panelsRendered}}const s=new n},16001:(k,A,e)=>{"use strict";e.d(A,{$K:()=>x,Do:()=>a,XC:()=>u,XR:()=>p,dx:()=>c,fX:()=>y,g5:()=>v,oF:()=>m,qN:()=>h});var n=e(65307),s=e(25508),l=e(31678);const r=25,i="notifications",g=`${i}/lastRead`,o={byId:C(),lastRead:Number.parseInt(window.localStorage.getItem(g)??`${Date.now()}`,10)},d=(0,n.Z0)({name:"appNotifications",initialState:o,reducers:{notifyApp:(I,{payload:R})=>{Object.values(I.byId).some(T=>b(R,T)&&T.showing)||(I.byId[R.id]=R,M(I.byId))},hideAppNotification:(I,{payload:R})=>{R in I.byId&&(I.byId[R].showing=!1,M(I.byId))},clearNotification:(I,{payload:R})=>{delete I.byId[R],M(I.byId)},clearAllNotifications:I=>{I.byId={},M(I.byId)},readAllNotifications:(I,{payload:R})=>{I.lastRead=R}}}),{notifyApp:c,hideAppNotification:a,clearNotification:p,clearAllNotifications:u,readAllNotifications:m}=d.actions,v=d.reducer,x=I=>I.lastRead,f=I=>I.byId,E=(0,s.Mz)(f,I=>Object.values(I).sort((R,T)=>T.timestamp-R.timestamp)),h=(0,s.Mz)(E,I=>I.filter(D)),y=(0,s.Mz)(f,I=>Object.values(I).filter(R=>R.showing));function b(I,R){return I.icon===R.icon&&I.severity===R.severity&&I.text===R.text&&I.title===R.title}function D(I){return I.severity===l.AppNotificationSeverity.Warning||I.severity===l.AppNotificationSeverity.Error}function P(I){return typeof I=="object"&&I!==null&&"id"in I&&"icon"in I&&"title"in I&&"text"in I}function C(){const I=window.localStorage.getItem(i);if(!I)return{};const R=JSON.parse(I);return Object.values(R).every(T=>P(T))?R:{}}function M(I){const R=Object.values(I).filter(D).sort((T,S)=>S.timestamp-T.timestamp).slice(0,r).reduce((T,S)=>(T[S.id]={id:S.id,severity:S.severity,icon:S.icon,title:S.title,text:S.text,traceId:S.traceId,timestamp:S.timestamp,showing:!1},T),{});try{window.localStorage.setItem(i,JSON.stringify(R))}catch(T){console.error("Unable to persist notifications to local storage"),console.error(T)}}},91219:(k,A,e)=>{"use strict";e.d(A,{I_:()=>u,L1:()=>g,TU:()=>a,ci:()=>d,fc:()=>c,ve:()=>p});var n=e(65307),s=e(32264),l=e(36689);const r=s.$.bootData?.navTree??[];function i(m){return m.map(v=>{const x=v.children&&i(v.children);return{...v,children:x,text:(0,l.C)(v.id)??v.text,subTitle:(0,l.o)(v.id)??v.subTitle,emptyMessage:(0,l.C)(v.emptyMessageId)}})}const g="starred/",o=(0,n.Z0)({name:"navBarTree",initialState:()=>i(s.$.bootData?.navTree??[]),reducers:{setStarred:(m,v)=>{const x=m.find(b=>b.id==="starred"),{id:f,title:E,url:h,isStarred:y}=v.payload;if(x)if(y){x.children||(x.children=[]);const b={id:g+f,text:E,url:h};x.children.push(b),x.children.sort((D,P)=>D.text.localeCompare(P.text))}else{const b=x.children?.findIndex(D=>D.id===g+f)??-1;b>-1&&x?.children?.splice(b,1)}},setBookmark:(m,v)=>{if(!s.$.featureToggles.pinNavItems)return;const x=m.find(h=>h.id==="bookmarks"),{item:f,isSaved:E}=v.payload;if(x)if(E){x.children||=[];const h={...f,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:x.id,text:x.text}};x.children.push(h)}else x.children=x.children?.filter(h=>h.url!==f.url)??[]},updateDashboardName:(m,v)=>{const{id:x,title:f,url:E}=v.payload,h=m.find(y=>y.id==="starred");if(h){const y=h.children?.find(b=>b.id===x);y&&(y.text=f,y.url=E,h.children?.sort((b,D)=>b.text.localeCompare(D.text)))}},removePluginFromNavTree:(m,v)=>{const x="plugin-page-"+v.payload.pluginID,f=m.findIndex(E=>E.id===x);f>-1&&m.splice(f,1)}}}),{setStarred:d,removePluginFromNavTree:c,updateDashboardName:a,setBookmark:p}=o.actions,u=o.reducer},28215:(k,A,e)=>{"use strict";e.d(A,{Id:()=>g,Im:()=>m,Vz:()=>p,YA:()=>u,_h:()=>x,s2:()=>o});var n=e(65307),s=e(2543),l=e.n(s),r=e(2913),i=e(36689);const g="home";function o(){const f={},E=(0,s.cloneDeep)(r.Ay.bootData.navTree),h=E.find(b=>b.id===g),y=E.filter(b=>b.id!==g);return h&&d(f,[h]),d(f,y,f[g]),f}function d(f,E,h){const y=[];for(const b of E){const D={...b,text:(0,i.C)(b.id)??b.text,subTitle:(0,i.o)(b.id)??b.subTitle,emptyMessage:(0,i.C)(b.emptyMessageId),parentItem:h};D.id&&(f[D.id]=D),D.children&&d(f,D.children,D),y.push(D)}h&&(h.children=y),f["not-found"]={...c("Page not found","404 Error").node},f.error={...c("Page error","An unexpected error").node}}function c(f,E){const h={text:f,subTitle:E,icon:"exclamation-triangle"};return{node:h,main:h}}const a={},p=(0,n.VP)("navIndex/updateNavIndex"),u=(0,n.VP)("navIndex/updateConfigurationSubtitle"),m=(0,n.VP)("navIndex/removeNavIndex"),v=(f,E)=>({...f,parentItem:{...f.parentItem,text:f.parentItem?.text??"",subTitle:E}}),x=(f=a,E)=>{if(p.match(E)){let y=function(P){if(P.children)for(const C of P.children)b[C.id]={...C,parentItem:P};P.parentItem&&y(P.parentItem)};var h=y;const b={},D=E.payload;return y(D),{...f,...b}}else if(u.match(E)){const y=`Organization: ${E.payload}`;return{...f,cfg:{...f.cfg,subTitle:y},datasources:v(f.datasources,y),correlations:v(f.correlations,y),users:v(f.users,y),teams:v(f.teams,y),plugins:v(f.plugins,y),"org-settings":v(f["org-settings"],y),apikeys:v(f.apikeys,y)}}else m.match(E)&&delete f[E.payload];return f}},17422:(k,A,e)=>{"use strict";e.d(A,{rH:()=>g,tc:()=>i});var n=e(41811),s=e(71101),l=e(28215);const r=()=>{const c={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:c,main:c}},i=(0,n.A)((c,a,p,u=!1)=>{if(c[a]){const m=c[a],v=u?m:g(m),x=o(v,a);return{node:m,main:x}}return p||r()});function g(c){return c.id===s.Rj?c:c.parentItem&&c.parentItem.id!==l.Id?g(c.parentItem):c}function o(c,a){return c.id===a?{...c,active:!0}:c.children&&c.children.length>0?{...c,children:c.children.map(p=>o(p,a))}:c}const d=c=>`${c.main.text}${c.node.text?": "+c.node.text:""}`},65615:(k,A,e)=>{"use strict";e.d(A,{W:()=>s});var n=e(27677);class s{constructor(r){this.resourceUri=r}update(r){return n.IB.put(`/api/${this.resourceUri}/preferences`,r)}patch(r){return n.IB.patch(`/api/${this.resourceUri}/preferences`,r)}load(){return n.IB.get(`/api/${this.resourceUri}/preferences`)}}},2619:(k,A,e)=>{"use strict";e.d(A,{Q:()=>r});var n=e(96540),s=e(13752),l=e(69731);class r{constructor(o){this._subject=new s.B,this._state=o}useState(){return i(this)}get state(){return this._state}setState(o){this._state={...this._state,...o},this._subject.next(this._state)}subscribeToState(o){return this._subject.subscribe(o)}}function i(g){const o=(0,l.C)();return(0,n.useEffect)(()=>{const d=g.subscribeToState({next:o});return()=>d.unsubscribe()},[g,o]),g.state}},27677:(k,A,e)=>{"use strict";e.d(A,{Mf:()=>Xe,IB:()=>we,AI:()=>qe});var n=e(56568),s=e(13752),l=e(75505),r=e(88483),i=e(64423),g=e(13288),o=e(65474),d=e(20039),c=e(81160),a=e(69862),p=e(59099),u=e(37748),m=e(66847),v=e(67791),x=e(16126),f=e(41560),E=e(69850),h=e(1005),y=e(62938),b=e(26272),D=e(40187),P=e(95344),C=e(32264),M=e(28138),I=e(2913),R=e(92315),T=e(67027),S=e(28676),L=e(74848),O=e(32196),j=e(40845),N=e(17464),F=e(37166),U=e(55852),w=e(88448);const B=We=>{const Ce=(0,j.of)(K),je=(0,j.$j)(),Ke=(0,w.o)(je),_e=!!We.maxConcurrentSessions,Fe=()=>{window.location.reload()};return(0,L.jsxs)(N.ZL,{children:[(0,L.jsx)("div",{className:Ke.modal,children:(0,L.jsxs)(F.w,{title:"You have been automatically signed out",severity:"warning",className:Ce.infobox,children:[(0,L.jsxs)("div",{className:Ce.text,children:[(0,L.jsxs)("p",{children:["Your session token was automatically revoked because you have reached",(0,L.jsx)("strong",{children:` the maximum number of ${_e?We.maxConcurrentSessions:""} concurrent sessions `}),"for your account."]}),(0,L.jsxs)("p",{children:[(0,L.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})]}),(0,L.jsx)(U.$n,{size:"md",variant:"primary",onClick:Fe,children:"Sign in"})]})}),(0,L.jsx)("div",{className:(0,O.cx)(Ke.modalBackdrop,Ce.backdrop)})]})},K=We=>({infobox:(0,O.css)`
    margin-bottom: 0;
  `,text:(0,O.css)`
    margin: ${We.spacing(1,0,2)};
  `,backdrop:(0,O.css)`
    background-color: ${We.colors.background.canvas};
    opacity: 0.8;
  `});var W=e(28444),z=e(2543);const Y=We=>{const Ce=We.method,je=ne(We),Ke=le(je),_e=_(We,Ke),Fe=J(We);return{method:Ce,headers:je,body:_e,credentials:Fe}},X={canParse:()=>!0,parse:We=>(We.get("accept")||We.set("accept","application/json, text/plain, */*"),We)},q=We=>({canParse:Ce=>(Ce?.method?Ce?.method.toLowerCase():"")===We,parse:Ce=>(Ce.get("content-type")||Ce.set("content-type","application/json"),Ce)}),G=q("post"),te=q("put"),H=q("patch"),se=[G,te,H,X],ne=We=>{const Ce=We?.headers?new Headers(We.headers):new Headers;return se.filter(_e=>_e.canParse(We)).reduce((_e,Fe)=>Fe.parse(_e),Ce)},le=We=>{if(!We)return!1;const Ce=We.get("content-type");return!!(Ce&&Ce.toLowerCase()==="application/json")},_=(We,Ce)=>We&&(!We.data||typeof We.data=="string"||We.data instanceof Blob?We.data:Ce?JSON.stringify(We.data):new URLSearchParams(We.data));async function Q(We,Ce){if(Ce)switch(Ce){case"arraybuffer":return We.arrayBuffer();case"blob":return We.blob();case"json":return We.headers.get("Content-Length")==="0"?(console.warn(`${We.url} returned an invalid JSON`),{}):await We.json();case"text":return We.text()}const je=await We.text();try{return JSON.parse(je)}catch{}return je}function ae(We){return Object.keys(We).map(Ce=>{const je=We[Ce];return Array.isArray(je)?je.map(Ke=>`${encodeURIComponent(Ce)}=${encodeURIComponent(Ke)}`).join("&"):`${encodeURIComponent(Ce)}=${encodeURIComponent(je)}`}).join("&")}const oe=We=>{const Ce=(0,z.omitBy)(We.params,Ke=>Ke===void 0||Ke&&Ke.length===0),je=ae(Ce);return We.params&&je.length?`${We.url}?${je}`:We.url},J=We=>We&&(We.credentials?We.credentials:We.withCredentials?((0,P.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var ee=e(21969),de=(We=>(We[We.Pending=0]="Pending",We[We.InProgress=1]="InProgress",We[We.Done=2]="Done",We))(de||{});class xe{constructor(Ce=!1){this.state={},this.queue=new s.B,this.updates=new s.B,this.add=(je,Ke)=>this.queue.next({id:je,options:Ke,state:0}),this.setInProgress=je=>this.queue.next({id:je,state:1}),this.setDone=je=>this.queue.next({id:je,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=je=>{const Ke=Object.keys(je).filter(Fe=>je[Fe].state===1).length;return{noOfPending:Object.keys(je).filter(Fe=>je[Fe].state===0).length,noOfInProgress:Ke,state:je}},this.publishUpdate=(je,Ke)=>{this.printState(je,Ke),this.updates.next(je)},this.printState=(je,Ke)=>{if(!Ke)return;const _e=Object.keys(je.state).reduce((Fe,at)=>{const Ct={id:at,state:je.state[at].state};return Fe.push(Ct),Fe},[]);console.log("FetchQueue noOfStarted",je.noOfInProgress),console.log("FetchQueue noOfNotStarted",je.noOfPending),console.log("FetchQueue state",_e)},this.queue.subscribe(je=>{const{id:Ke,state:_e,options:Fe}=je;if(this.state[Ke]||(this.state[Ke]={state:0,options:{url:""}}),_e===2){delete this.state[Ke];const Ct=this.getUpdate(this.state);this.publishUpdate(Ct,Ce);return}this.state[Ke].state=_e,Fe&&(this.state[Ke].options=Fe);const at=this.getUpdate(this.state);this.publishUpdate(at,Ce)})}}var re=e(95864);class ue{constructor(Ce,je,Ke){const _e=Ke?.http2Enabled?1e3:5;Ce.getUpdates().pipe((0,x.p)(({noOfPending:Fe})=>Fe>0),(0,re.H)(({state:Fe,noOfInProgress:at})=>{const Ct=Object.keys(Fe).filter(pe=>Fe[pe].state===de.Pending&&!(0,ee.dr)(Fe[pe].options.url)).reduce((pe,Se)=>{const fe={id:Se,options:Fe[Se].options};return pe.push(fe),pe},[]),Dt=Object.keys(Fe).filter(pe=>Fe[pe].state===de.Pending&&(0,ee.dr)(Fe[pe].options.url)).reduce((pe,Se)=>{const fe={id:Se,options:Fe[Se].options};return pe.push(fe),pe},[]),tt=Math.max(_e-at-Ct.length,0),ze=Dt.slice(0,tt);return Ct.concat(ze)})).subscribe(({id:Fe,options:at})=>{je.add(Fe,at)})}}class Te{constructor(Ce,je){this.queue=new s.B,this.responses=new s.B,this.add=(Ke,_e)=>{this.queue.next({id:Ke,options:_e})},this.getResponses=Ke=>this.responses.asObservable().pipe((0,x.p)(_e=>_e.id===Ke)),this.queue.subscribe(Ke=>{const{id:_e,options:Fe}=Ke;Ce.setInProgress(_e),this.responses.next({id:_e,observable:je(Fe)})})}}var ge=e(16233);const Oe="cancel_all_requests_request_id",Ue="grafana-trace-id";class Xe{constructor(Ce){this.inFlightRequests=new s.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new s.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:d.$,appEvents:M.A,contextSrv:ge.TP,logout:()=>{ge.TP.setLoggedOut()}},Ce&&(this.dependencies={...this.dependencies,...Ce}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new xe,this.responseQueue=new Te(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new ue(this.fetchQueue,this.responseQueue,(0,I.zj)())}async initGrafanaDeviceID(){try{const je=await(await n.Ay.load()).get();this.deviceID=je.visitorId}catch(Ce){console.error(Ce)}}async request(Ce){return await(0,l.s)(this.fetch(Ce).pipe((0,c.T)(je=>je.data)))}fetch(Ce){const je=(0,y.A)(),Ke=this.fetchQueue;return new r.c(_e=>{const Fe=new i.yU;return Fe.add(this.responseQueue.getResponses(je).subscribe(at=>{Fe.add(at.observable.subscribe(_e))})),this.fetchQueue.add(je,Ce),function(){Ke.setDone(je),Fe.unsubscribe()}})}internalFetch(Ce){Ce.requestId&&this.inFlightRequests.next(Ce.requestId),Ce=this.parseRequestOptions(Ce);const je=(0,T.r)();return je!==null&&je!==""&&C.$.jwtUrlLogin&&C.$.jwtHeaderName&&(Ce.headers=Ce.headers??{},Ce.headers[C.$.jwtHeaderName]=`${je}`),this.deviceID&&(Ce.headers=Ce.headers??{},Ce.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Ce).pipe(this.handleStreamResponse(Ce),this.handleStreamError(Ce),this.handleStreamCancellation(Ce))}resolveCancelerIfExists(Ce){this.inFlightRequests.next(Ce)}cancelAllInFlightRequests(){this.inFlightRequests.next(Oe)}async datasourceRequest(Ce){return(0,l.s)(this.fetch(Ce))}parseRequestOptions(Ce){const je=this.dependencies.contextSrv.user?.orgId;return Ce.retry=Ce.retry??0,(0,ee.Lr)(Ce.url)&&(je&&(Ce.headers=Ce.headers??{},Ce.headers["X-Grafana-Org-Id"]=je),Ce.url.startsWith("/")&&(Ce.url=Ce.url.substring(1)),Ce.headers?.Authorization&&(Ce.headers["X-DS-Authorization"]=Ce.headers.Authorization,delete Ce.headers.Authorization),this.noBackendCache&&(Ce.headers=Ce.headers??{},Ce.headers["X-Grafana-NoCache"]="true")),Ce.hideFromInspector===void 0&&(Ce.hideFromInspector=(0,ee.Lr)(Ce.url)&&!(0,ee.dr)(Ce.url)),Ce}getFromFetchStream(Ce){const je=oe(Ce),Ke=Y(Ce);return this.dependencies.fromFetch(je,Ke).pipe((0,a.Z)(async _e=>{const{status:Fe,statusText:at,ok:Ct,headers:Dt,url:tt,type:ze,redirected:pe}=_e,Se=Ce.responseType??(le(Dt)?"json":void 0),fe=await Q(_e,Se);return{status:Fe,statusText:at,ok:Ct,data:fe,headers:Dt,url:tt,type:ze,redirected:pe,config:Ce,traceId:_e.headers.get(Ue)??void 0}}))}showApplicationErrorAlert(Ce){}showSuccessAlert(Ce){const{config:je}=Ce;if(je.showSuccessAlert===!1||je.showSuccessAlert===void 0&&(je.method==="GET"||(0,ee.dr)(je.url)||!(0,ee.Lr)(je.url)))return;const Ke=Ce.data;Ke?.message&&this.dependencies.appEvents.emit(b.r1.alertSuccess,[Ke.message])}showErrorAlert(Ce,je){if(Ce.showErrorAlert===!1||Ce.showErrorAlert===void 0&&((0,ee.dr)(Ce.url)||!(0,ee.Lr)(Ce.url)))return;let Ke="",_e=je.data.message;_e==="Unexpected error"&&je.message&&(_e=je.message),_e.length>80&&(Ke=_e,_e="Error"),je.status===422&&(Ke=je.data.message,_e="Validation failed"),this.dependencies.appEvents.emit(je.status<500?b.r1.alertWarning:b.r1.alertError,[_e,Ke,je.data.traceID])}processRequestError(Ce,je){return je.data=je.data??{message:"Unexpected error"},typeof je.data=="string"&&(je.data={message:je.data,error:je.statusText,response:je.data}),je.data&&!je.data.message&&typeof je.data.error=="string"&&(je.data.message=je.data.error),je.data.message&&setTimeout(()=>{je.isHandled||this.showErrorAlert(Ce,je)},50),this.inspectorStream.next({response:je,requestId:Ce.requestId}),je}handleStreamResponse(Ce){return je=>je.pipe((0,c.T)(Ke=>{if(!Ke.ok){const{status:_e,statusText:Fe,data:at}=Ke;throw{status:_e,statusText:Fe,data:at,config:Ce,traceId:Ke.headers.get(Ue)??void 0}}return Ke}),(0,p.M)(Ke=>{this.showSuccessAlert(Ke),this.inspectorStream.next({response:Ke,requestId:Ce.requestId})}))}handleStreamError(Ce){const{isSignedIn:je}=this.dependencies.contextSrv.user;return Ke=>Ke.pipe((0,u.l)(_e=>_e.pipe((0,a.Z)((Fe,at)=>{const Ct=at===0&&Ce.retry===0;if(Fe.status===401&&(0,ee.Lr)(Ce.url)&&Ct&&je){if(Fe.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new W.S8({component:B,props:{maxConcurrentSessions:Fe.data?.error?.maxConcurrentSessions}})),(0,g.$)(()=>Fe);let Dt=this.loginPing();return(0,R.m)()&&(0,R.W)()*1e3<Date.now()&&(Dt=this.rotateToken()),(0,o.H)(Dt).pipe((0,m.W)(tt=>(tt.status===401&&this.dependencies.logout(),(0,g.$)(tt))))}return(0,g.$)(Fe)}))),(0,m.W)(_e=>(0,g.$)(()=>this.processRequestError(Ce,_e))))}handleStreamCancellation(Ce){return je=>je.pipe((0,v.Q)(this.inFlightRequests.pipe((0,x.p)(Ke=>{let _e=!1;return Ce&&Ce.requestId&&Ce.requestId===Ke&&(_e=!0),Ke===Oe&&(_e=!0),_e}))),(0,f.v)(()=>({type:D.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Ce})))}getInspectorStream(){return this.inspectorStream}async get(Ce,je,Ke,_e){return this.request({..._e,method:"GET",url:Ce,params:je,requestId:Ke})}async delete(Ce,je,Ke){return this.request({...Ke,method:"DELETE",url:Ce,data:je})}async post(Ce,je,Ke){return this.request({...Ke,method:"POST",url:Ce,data:je})}async patch(Ce,je,Ke){return this.request({...Ke,method:"PATCH",url:Ce,data:je})}async put(Ce,je,Ke){return this.request({...Ke,method:"PUT",url:Ce,data:je})}withNoBackendCache(Ce){return this.noBackendCache=!0,Ce().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,E.j)(()=>{this._tokenRotationInProgress=null}),(0,h.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Ce){return this.get("/api/search",Ce)}getDashboardByUid(Ce){return(0,P.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,S.n)().getDashboardDTO(Ce)}validateDashboard(Ce){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Ce){return this.get(`/api/public/dashboards/${Ce}`)}getFolderByUid(Ce,je={}){const Ke=new URLSearchParams;return je.withAccessControl&&Ke.set("accesscontrol","true"),this.get(`/api/folders/${Ce}?${Ke.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const we=new Xe,qe=()=>we},16233:(k,A,e)=>{"use strict";e.d(A,{SM:()=>a,TP:()=>m});var n=e(2543),s=e.n(n),l=e(29263),r=e(65879),i=e(17172),g=e(33378),o=e(92315),d=e(31678),c=e(2913);const a="auto";class p{constructor(){this.id=0,this.uid="",this.isGrafanaAdmin=!1,this.isSignedIn=!1,this.orgRole="",this.orgId=0,this.orgName="",this.login="",this.externalUserId="",this.orgCount=0,this.timezone="",this.fiscalYearStartMonth=0,this.helpFlags1=0,this.theme="dark",this.hasEditPermissionInFolders=!1,this.email="",this.name="",this.locale="",this.language="",this.weekStart="",this.gravatarUrl="",this.analytics={identifier:""},this.authenticatedBy="",c.Ay.bootData.user&&(0,n.extend)(this,c.Ay.bootData.user)}}class u{constructor(){this.sidemenuSmallBreakpoint=!1,this.tokenRotationJobId=0,c.Ay.bootData||(c.Ay.bootData={user:{},settings:{},navTree:[]}),this.user=new p,this.isSignedIn=this.user.isSignedIn,this.isGrafanaAdmin=this.user.isGrafanaAdmin,this.isEditor=this.hasRole("Editor")||this.hasRole("Admin"),this.hasEditPermissionInFolders=this.user.hasEditPermissionInFolders,this.minRefreshInterval=c.Ay.minRefreshInterval,this.scheduleTokenRotationJob()}async fetchUserPermissions(){try{this.user.permissions=await(0,i.AI)().get("/api/access-control/user/actions",{reloadcache:!0})}catch(f){console.error(f)}}setLoggedOut(){this.cancelTokenRotationJob(),this.user.isSignedIn=!1,this.isSignedIn=!1,window.location.reload()}hasRole(f){return f==="ServerAdmin"?this.isGrafanaAdmin:this.user.orgRole===f}licensedAccessControlEnabled(){return(0,g.a)("accesscontrol")}hasPermissionInMetadata(f,E){return(0,l.T6)(f,E)}hasPermission(f){return(0,l.ZU)(f,this.user)}isGrafanaVisible(){return document.visibilityState===void 0||document.visibilityState==="visible"}isAllowedInterval(f){return!c.Ay.minRefreshInterval||f===a?!0:r.intervalToMs(f)>=r.intervalToMs(c.Ay.minRefreshInterval)}getValidInterval(f){return this.isAllowedInterval(f)?f:c.Ay.minRefreshInterval}getValidIntervals(f){return this.minRefreshInterval?f.filter(E=>E!=="").filter(this.isAllowedInterval):f}hasAccessToExplore(){return this.hasPermission(d.AccessControlAction.DataSourcesExplore)&&c.Ay.exploreEnabled}evaluatePermission(f){return(0,l.jW)(f,this.user)?[]:["Reject"]}scheduleTokenRotationJob(){if(this.canScheduleRotation()){let f=(0,o.W)(),h=(f-Math.floor(Math.random()*19+1))*1e3-Date.now();this.tokenRotationJobId=setTimeout(()=>{if((0,o.W)()>f){this.scheduleTokenRotationJob();return}this.rotateToken().then()},h)}}canScheduleRotation(){return!(!this.isSignedIn||(0,o.W)()===0)}cancelTokenRotationJob(){this.tokenRotationJobId>0&&clearTimeout(this.tokenRotationJobId)}rotateToken(){return fetch(c.Ay.appSubUrl+"/api/user/auth-tokens/rotate",{method:"POST"}).then(f=>{if(f.status===200){this.scheduleTokenRotationJob();return}if(f.status===401){this.setLoggedOut();return}}).catch(f=>{console.error(f)})}}let m=new u;const v=x=>{throw new Error("contextSrv can be only overridden in test environment")}},42614:(k,A,e)=>{"use strict";e.d(A,{n:()=>s});var n=e(63415);const s=(r,i)=>{(0,n.x$)().addEvent({type:n.on.Performance,payload:{name:r,value:i}})},l=r=>faro?.api?.pushError(r)},62301:(k,A,e)=>{"use strict";e.d(A,{A:()=>d});var n=e(2543),s=e.n(n),l=e(17172),r=e(2913),i=e(33390);class g{constructor(){}addDashboardImpression(a){const p=this.impressionKey();let u=[];i.A.exists(p)&&(u=JSON.parse(i.A.get(p)),(0,n.isArray)(u)||(u=[])),u=u.filter(m=>a!==m),u.unshift(a),u.length>50&&u.pop(),i.A.set(p,JSON.stringify(u))}async convertToUIDs(){let a=this.getImpressions();const p=(0,n.filter)(a,m=>(0,n.isNumber)(m));if(!p.length)return;const u=await(0,l.AI)().get(`/api/dashboards/ids/${p.join(",")}`);i.A.set(this.impressionKey(),JSON.stringify([...(0,n.filter)(a,m=>(0,n.isString)(m)),...u]))}getImpressions(){const a=i.A.get(this.impressionKey())||"[]";return JSON.parse(a)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,n.filter)(this.getImpressions(),p=>(0,n.isString)(p))}impressionKey(){return"dashboard_impressions-"+r.Ay.bootData.user.orgId}}const d=new g},4898:(k,A,e)=>{"use strict";e.d(A,{R:()=>h});let n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},s={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},l={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},r={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},i=null;for(let y=1;y<20;++y)n[111+y]="f"+y;for(let y=0;y<=9;++y)n[y+96]=y.toString();function g(y){if(y.type==="keypress"){let b=String.fromCharCode(y.which);return y.shiftKey||(b=b.toLowerCase()),b}return n[y.which]?n[y.which]:s[y.which]?s[y.which]:String.fromCharCode(y.which).toLowerCase()}function o(y,b){return y.sort().join(",")===b.sort().join(",")}function d(y){let b=[];return y.shiftKey&&b.push("shift"),y.altKey&&b.push("alt"),y.ctrlKey&&b.push("ctrl"),y.metaKey&&b.push("meta"),b}function c(y){if(y.preventDefault){y.preventDefault();return}y.returnValue=!1}function a(y){if(y.stopPropagation){y.stopPropagation();return}y.cancelBubble=!0}function p(y){return y==="shift"||y==="ctrl"||y==="alt"||y==="meta"}function u(){if(!i){i={};for(let y in n){const b=parseInt(y,10);b>95&&b<112||n.hasOwnProperty(y)&&(i[n[y]]=y)}}return i}function m(y,b,D){return D||(D=u()[y]?"keydown":"keypress"),D==="keypress"&&b.length&&(D="keydown"),D}function v(y){return y==="+"?["+"]:(y=y.replace(/\+{2}/g,"+plus"),y.split("+"))}function x(y,b){let D,P,C,M=[];for(D=v(y),C=0;C<D.length;++C)P=D[C],r[P]&&(P=r[P]),b&&b!=="keypress"&&l[P]&&(P=l[P],M.push("shift")),p(P)&&M.push(P);if(!P)throw new Error("Unable to get key");return b=m(P,M,b),{key:P,modifiers:M,action:b}}function f(y,b){return y===null||y===document?!1:y===b?!0:f(y.parentNode,b)}class E{constructor(b){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=D=>{D=D||{};let P=!1,C;for(C in this._sequenceLevels){if(D[C]){P=!0;continue}this._sequenceLevels[C]=0}P||(this._nextExpectedAction=!1)},this._getMatches=(D,P,C,M,I,R)=>{let T,S,L=[],O=C.type;if(!this._callbacks[D])return[];for(O==="keyup"&&p(D)&&(P=[D]),T=0;T<this._callbacks[D].length;++T)if(S=this._callbacks[D][T],!(!M&&S.seq&&this._sequenceLevels[S.seq]!==S.level)&&O===S.action&&(O==="keypress"&&!C.metaKey&&!C.ctrlKey||o(P,S.modifiers))){let j=!M&&S.combo===I,N=M&&S.seq===M&&S.level===R;(j||N)&&this._callbacks[D].splice(T,1),L.push(S)}return L},this._fireCallback=(D,P,C,M)=>{const I=P.target||P.srcElement;I&&I instanceof HTMLElement&&this.stopCallback(P,I,C,M)||D(P,C)===!1&&(c(P),a(P))},this._handleKey=(D,P,C)=>{let M=this._getMatches(D,P,C),I,R={},T=0,S=!1;for(I=0;I<M.length;++I)M[I].seq&&(T=Math.max(T,M[I].level??0));for(I=0;I<M.length;++I){const O=M[I].seq;if(O){if(M[I].level!==T)continue;S=!0,R[O]=1,this._fireCallback(M[I].callback,C,M[I].combo,O);const j=O.lastIndexOf(D),N=O.slice(0,j);for(const[F,U]of Object.entries(this._sequenceLevels))U>0&&F.startsWith(N)&&(R[F]=1);continue}S||this._fireCallback(M[I].callback,C,M[I].combo)}for(const O of this._callbacks[D]??[])O.action===C.type&&O.seq&&O.level===0&&(R[O.seq]=1);let L=C.type==="keypress"&&this._ignoreNextKeypress;C.type===this._nextExpectedAction&&!p(D)&&!L&&this._resetSequences(R),this._ignoreNextKeypress=S&&C.type==="keydown"},this._handleKeyEvent=D=>{if(!(D instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const P=D;if(P.repeat)return;typeof P.which!="number"&&(P.which=P.keyCode);let C=g(P);if(C){if(P.type==="keyup"&&this._ignoreNextKeyup===C){this._ignoreNextKeyup=!1;return}this.handleKey(C,d(P),P)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(D,P,C,M)=>{this._sequenceLevels[D]=0;const I=T=>()=>{this._nextExpectedAction=T,++this._sequenceLevels[D],this._resetSequenceTimer()},R=T=>{this._fireCallback(C,T,D),M!=="keyup"&&(this._ignoreNextKeyup=g(T)),this._resetSequenceTimer()};for(let T=0;T<P.length;++T){let L=T+1===P.length?R:I(M||x(P[T+1]).action);this._bindSingle(P[T],L,M,D,T)}},this._bindSingle=(D,P,C,M,I)=>{this._directMap[D+":"+C]=P,D=D.replace(/\s+/g," ");let R=D.split(" "),T;if(R.length>1){this._bindSequence(D,R,P,C);return}T=x(D,C),this._callbacks[T.key]=this._callbacks[T.key]||[];const S={type:T.action,metaKey:!1,ctrlKey:!1};this._getMatches(T.key,T.modifiers,S,M,D,I);const L={callback:P,modifiers:T.modifiers,action:T.action,seq:M,level:I,combo:D};this._callbacks[T.key][M?"unshift":"push"](L)},this._bindMultiple=(D,P,C)=>{for(let M=0;M<D.length;++M)this._bindSingle(D[M],P,C)},this.bind=(D,P,C)=>(D=D instanceof Array?D:[D],this._bindMultiple(D,P,C),self),this.unbind=(D,P)=>this.bind(D,function(){},P),this.bindGlobal=(D,P,C)=>{if(this.bind(D,P,C),D instanceof Array){for(let M=0;M<D.length;M++)this._globalCallbacks[D[M]]=!0;return}this._globalCallbacks[D]=!0},this.unbindGlobal=(D,P)=>{if(this.unbind(D,P),D instanceof Array){for(let C=0;C<D.length;C++)this._globalCallbacks[D[C]]=!1;return}this._globalCallbacks[D]=!1},this.trigger=(D,P)=>{let C=this;return C._directMap[D+":"+P]&&C._directMap[D+":"+P]({},D),C},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(D,P,C,M)=>{if(this._globalCallbacks[C]||M&&this._globalCallbacks[M]||(" "+P.className+" ").indexOf(" mousetrap ")>-1||f(P,this.target))return!1;if("composedPath"in D&&typeof D.composedPath=="function"){let I=D.composedPath()[0];I!==D.target&&I instanceof HTMLElement&&(P=I)}return!!(P.tagName==="INPUT"||P.tagName==="SELECT"||P.tagName==="TEXTAREA"||"isContentEditable"in P&&P.isContentEditable)},this.handleKey=(...D)=>this._handleKey(...D),this.addKeycodes=D=>{for(let P in D)D.hasOwnProperty(P)&&(n[P]=D[P]);i=null},this.target=b,this.target.addEventListener("keypress",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)}),this.target.addEventListener("keydown",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)}),this.target.addEventListener("keyup",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)})}}const h=new E(document)},2769:(k,A,e)=>{"use strict";e.d(A,{K:()=>o,O:()=>d});var n=e(97594),s=e(3591),l=e(28138),r=e(2913),i=e(10096),g=e(65615);async function o(c,a){const p=r.config.theme2,u=(0,n.g)(c);if(l.A.publish(new s.E8(u)),p.colors.mode!==u.colors.mode){const x=document.createElement("link");x.rel="stylesheet",x.href=r.config.bootData.assets[u.colors.mode],x.onload=()=>{const f=document.getElementsByTagName("link");for(let E=0;E<f.length;E++){const h=f[E];h.href&&h.href.includes(`build/grafana.${p.colors.mode}`)&&h.remove()}},document.head.insertBefore(x,document.head.firstChild)}if(a||!i.contextSrv.isSignedIn)return;const m=new g.W("user"),v=await m.load();await m.update({...v,theme:u.colors.mode})}async function d(c){const a=r.config.theme2;o(a.isDark?"light":"dark",c)}},33390:(k,A,e)=>{"use strict";e.d(A,{A:()=>l});class n{get(i){return window.localStorage[i]}set(i,g){window.localStorage[i]=g}getBool(i,g){return g!==void 0&&!this.exists(i)?g:window.localStorage[i]==="true"}getObject(i,g){let o=g;if(this.exists(i)){const d=window.localStorage[i];try{o=JSON.parse(d)}catch(c){console.error(`Error parsing store object: ${i}. Returning default: ${g}. [${c}]`)}}return o}setObject(i,g){let o;try{o=JSON.stringify(g)}catch(d){throw new Error(`Could not stringify object: ${i}. [${d}]`)}try{this.set(i,o)}catch(d){const c=new Error(`Could not save item in localStorage: ${i}. [${d}]`);throw d instanceof Error&&(c.name=d.name),c}return!0}exists(i){return window.localStorage[i]!==void 0}delete(i){window.localStorage.removeItem(i)}}const l=new n},31140:(k,A,e)=>{"use strict";e.d(A,{A:()=>c,r:()=>d});var n=e(2543),s=e.n(n),l=e(54479),r=e(83195);function i(a,p){if(!a)return!1;if(a[0]==="/"){const u=(0,l.dO)(a);return p.match(u)!=null}return a===p}function g(a){return a===0?.001:a/10}function o(a){return a?{colors:[{opacity:0},{opacity:a/10}]}:null}function d(a,p,u){for(let m=0;m<a.length;m++){const v=a[m],x=p.yaxes,f=v.yaxis||1,E=x[f-1],h=(0,r.j_)(E.format);(0,n.isNumber)(p.decimals)?v.updateLegendValues(h,p.decimals):(0,n.isNumber)(E.decimals)?v.updateLegendValues(h,E.decimals+1):v.updateLegendValues(h,null)}}class c{constructor(p){this.datapoints=p.datapoints,this.label=p.alias,this.id=p.alias,this.alias=p.alias,this.aliasEscaped=(0,n.escape)(p.alias),this.color=p.color,this.bars={fillColor:p.color},this.valueFormater=(0,r.j_)("none"),this.stats={},this.legend=!0,this.unit=p.unit,this.dataFrameIndex=p.dataFrameIndex,this.fieldIndex=p.fieldIndex,this.hasMsResolution=this.isMsResolutionNeeded()}applySeriesOverrides(p){this.lines={},this.dashes={dashLength:[]},this.points={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack,delete this.bars.show;for(let u=0;u<p.length;u++){const m=p[u];i(m.alias,this.alias)&&(m.lines!==void 0&&(this.lines.show=m.lines),m.dashes!==void 0&&(this.dashes.show=m.dashes,this.lines.lineWidth=0),m.points!==void 0&&(this.points.show=m.points),m.bars!==void 0&&(this.bars.show=m.bars),m.fill!==void 0&&(this.lines.fill=g(m.fill)),m.fillGradient!==void 0&&(this.lines.fillColor=o(m.fillGradient)),m.stack!==void 0&&(this.stack=m.stack),m.linewidth!==void 0&&(this.lines.lineWidth=this.dashes.show?0:m.linewidth,this.dashes.lineWidth=m.linewidth),m.dashLength!==void 0&&(this.dashes.dashLength[0]=m.dashLength),m.spaceLength!==void 0&&(this.dashes.dashLength[1]=m.spaceLength),m.nullPointMode!==void 0&&(this.nullPointMode=m.nullPointMode),m.pointradius!==void 0&&(this.points.radius=m.pointradius),m.steppedLine!==void 0&&(this.lines.steps=m.steppedLine),m.zindex!==void 0&&(this.zindex=m.zindex),m.fillBelowTo!==void 0&&(this.fillBelowTo=m.fillBelowTo),m.color!==void 0&&this.setColor(m.color),m.transform!==void 0&&(this.transform=m.transform),m.legend!==void 0&&(this.legend=m.legend),m.hideTooltip!==void 0&&(this.hideTooltip=m.hideTooltip),m.yaxis!==void 0&&(this.yaxis=m.yaxis),m.hiddenSeries!==void 0&&(this.hiddenSeries=m.hiddenSeries))}}getFlotPairs(p){const u=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.diffperc=0,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;const m=p==="connected",v=p==="null as zero";let x,f,E=0,h,y=0,b=!0;for(let D=0;D<this.datapoints.length;D++){if(f=this.datapoints[D][0],x=this.datapoints[D][1],h!==void 0){const P=x-h;P<this.stats.timeStep&&(this.stats.timeStep=P)}if(h=x,f===null){if(m)continue;v&&(f=0)}f!==null&&((0,n.isNumber)(f)&&(this.stats.total+=f,this.allIsNull=!1,E++),f>this.stats.max&&(this.stats.max=f),f<this.stats.min&&(this.stats.min=f),this.stats.first===null?this.stats.first=f:y>f?(b=!1,D===this.datapoints.length-1&&(this.stats.delta+=f)):(b?this.stats.delta+=f-y:this.stats.delta+=f,b=!0),y=f,f<this.stats.logmin&&f>0&&(this.stats.logmin=f),f!==0&&(this.allIsZero=!1)),u.push([x,f])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),u.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/E,this.stats.current=u[u.length-1][1],this.stats.current===null&&u.length>1&&(this.stats.current=u[u.length-2][1])),this.stats.max!==null&&this.stats.min!==null&&(this.stats.range=this.stats.max-this.stats.min),this.stats.current!==null&&this.stats.first!==null&&(this.stats.diff=this.stats.current-this.stats.first,this.stats.diffperc=this.stats.diff/this.stats.first),this.stats.count=u.length,u}updateLegendValues(p,u){this.valueFormater=p,this.decimals=u}formatValue(p){return(0,n.isFinite)(p)||(p=null),(0,r.cN)(this.valueFormater(p,this.decimals))}isMsResolutionNeeded(){for(let p=0;p<this.datapoints.length;p++)if(this.datapoints[p][1]!==null&&this.datapoints[p][1]!==void 0){const u=this.datapoints[p][1].toString();if(u.length===13&&u%1e3!==0)return!0}return!1}hideFromLegend(p){return!!(p.hideEmpty&&this.allIsNull||!this.legend||p.hideZero&&this.allIsZero)}setColor(p){this.color=p,this.bars.fillColor=p}}},6262:(k,A,e)=>{"use strict";e.d(A,{G:()=>r});var n=e(80997),s=e(32264);const l=s.$.bootData.settings.cspReportOnlyEnabled,r={createHTML:(i,g,o)=>l?(console.error("[HTML not sanitized with Trusted Types]",i,g,o),i):i.replace(/<script/gi,"&lt;script"),createScript:i=>i,createScriptURL:(i,g,o)=>l?(console.error("[ScriptURL not sanitized with Trusted Types]",i,g,o),i):n.sQ.sanitizeUrl(i)};s.$.bootData.settings.trustedTypesDefaultPolicyEnabled&&window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",r)},96378:(k,A,e)=>{"use strict";e.d(A,{N:()=>c,e:()=>a});var n=e(74848),s=e(96540),l=e(70255),r=e(60578),i=e(3591),g=e(32264),o=e(10096),d=e(34295);const c=({children:p,value:u})=>{const[m,v]=(0,s.useState)(u);return(0,s.useEffect)(()=>{const x=o.lE.subscribe(i.E8,f=>{g.$.theme2=f.payload,v(f.payload)});return()=>x.unsubscribe()},[]),(0,n.jsx)(r.D.Provider,{value:m,children:(0,n.jsx)(l.z,{baseColor:m.colors.emphasize(m.colors.background.secondary),highlightColor:m.colors.emphasize(m.colors.background.secondary,.1),borderRadius:m.shape.radius.default,children:p})})},a=(p,u)=>function(v){return(0,n.jsx)(c,{value:u,children:s.createElement(p,{...v})})}},67278:(k,A,e)=>{"use strict";e.d(A,{c:()=>n});class n extends window.Worker{constructor(l,r){const i=l.toString(),g=i.split("/");g.pop();const o=`${g.join("/")}/`,d=`importScripts('${i}');`,c=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${o}'; ${d}`],{type:"application/javascript"}));super(c,r),URL.revokeObjectURL(c)}}},80714:(k,A,e)=>{"use strict";e.d(A,{F:()=>n});function n(s={}){return{...s,accesscontrol:!0}}},94041:(k,A,e)=>{"use strict";e.d(A,{b:()=>n});const n=(s,l,r)=>(s.splice(r,0,s.splice(l,1)[0]),s)},92315:(k,A,e)=>{"use strict";e.d(A,{W:()=>n,m:()=>s});function n(){const l=document.cookie.split("; ").find(i=>i.startsWith("grafana_session_expiry="));if(!l)return 0;let r=l.split("=").at(1);return r?parseInt(r,10):0}function s(){return document.cookie.split("; ").findIndex(l=>l.startsWith("grafana_session_expiry="))>-1}},63917:(k,A,e)=>{"use strict";e.d(A,{gn:()=>l});function n(){const r=navigator.userAgent.indexOf("MSIE")>-1,i=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,o=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),d=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return r&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||i&&(d&&parseFloat(d[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||g&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(o&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function s(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function l(){return s()?"\u2318":"ctrl"}},34525:(k,A,e)=>{"use strict";e.d(A,{TS:()=>l});class n{_linkTo(o,d){d<=0&&o.inputEdges.push(this),d>=0&&o.outputEdges.push(this),o.edges.push(this)}link(o,d){if(!o)throw Error("inputNode is required");if(!d)throw Error("outputNode is required");return this.unlink(),this.inputNode=o,this.outputNode=d,this._linkTo(o,1),this._linkTo(d,-1),this}unlink(){let o;const d=this.inputNode,c=this.outputNode;d&&c&&(o=d.edges.indexOf(this),o>-1&&d.edges.splice(o,1),o=c.edges.indexOf(this),o>-1&&c.edges.splice(o,1),o=d.outputEdges.indexOf(this),o>-1&&d.outputEdges.splice(o,1),o=c.inputEdges.indexOf(this),o>-1&&c.inputEdges.splice(o,1))}}class s{constructor(o){this.name=o,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(o){return o?typeof o=="object"?this.inputEdges.find(d=>d.inputNode?.name===o.name):this.inputEdges.find(d=>d.inputNode?.name===o):null}getEdgeTo(o){return o?typeof o=="object"?this.outputEdges.find(d=>d.outputNode?.name===o.name):this.outputEdges.find(d=>d.outputNode?.name===o):null}getOptimizedInputEdges(){const o=[];return this.inputEdges.forEach(d=>{d.inputNode?.inputEdges.map(a=>a.inputNode)?.forEach(a=>{const p=a?.getEdgeTo(this.name);p&&o.push(p)})}),this.inputEdges.filter(d=>o.indexOf(d)===-1)}}class l{constructor(){this.nodes={}}createNode(o){const d=new s(o);return this.nodes[o]=d,d}createNodes(o){const d=[];return o.forEach(c=>{d.push(this.createNode(c))}),d}link(o,d){let c=[],a=[];const p=[],u=[];o instanceof Array?c=o:c=[o],d instanceof Array?a=d:a=[d];for(let v=0;v<c.length;v++){const x=c[v];if(typeof x=="string"){const f=this.getNode(x);if(!f)throw Error(`cannot link input node named ${x} since it doesn't exist in graph`);p.push(f)}else p.push(x)}for(let v=0;v<a.length;v++){const x=a[v];if(typeof x=="string"){const f=this.getNode(x);if(!f)throw Error(`cannot link output node named ${x} since it doesn't exist in graph`);u.push(f)}else u.push(x)}const m=[];return p.forEach(v=>{u.forEach(x=>{m.push(this.createEdge().link(v,x))})}),m}descendants(o){if(!o.length)return new Set;const d=new Set(i(o)?o.map(c=>this.nodes[c]).filter(c=>c!==void 0):o);return this.descendantsRecursive(d)}descendantsRecursive(o,d=new Set){for(const c of o){const a=new Set;for(const{inputNode:p}of c.inputEdges)p&&!d.has(p)&&(d.add(p),a.add(p));this.descendantsRecursive(a,d)}return d}createEdge(){return new n}getNode(o){return this.nodes[o]}}const r=g=>{Object.keys(g.nodes).forEach(o=>{const d=g.nodes[o];let c=d.outputEdges.map(p=>p.outputNode?.name).join(", ");c||(c="<none>");let a=d.inputEdges.map(p=>p.inputNode?.name).join(", ");a||(a="<none>"),console.log(`${d.name}:
 - links to:   ${c}
 - links from: ${a}`)})};function i(g){return g.length>0&&typeof g[0]=="string"}},94954:(k,A,e)=>{"use strict";e.d(A,{q:()=>s});var n=e(17172);function s(l){if(typeof l=="string")return l;if(l){if(l instanceof Error)return l.message;if((0,n.NF)(l)){if(l.data&&l.data.message)return l.data.message;if(l.statusText)return l.statusText}}return JSON.stringify(l)}},87490:(k,A,e)=>{"use strict";e.d(A,{HQ:()=>h,Ll:()=>T,MA:()=>I,WP:()=>v,Xe:()=>D,_u:()=>w,bI:()=>C,dY:()=>N,di:()=>L,dr:()=>y,eF:()=>S,o$:()=>b,uE:()=>U,uJ:()=>K,uq:()=>P,w4:()=>M,zT:()=>j,zq:()=>F});var n=e(44329),s=e(62938),l=e(52622),r=e(76885),i=e(41987),g=e(43127),o=e(77789),d=e(65879),c=e(19347),a=e(11134),p=e(33390),u=e(66718);const m={dedupStrategy:l.fY.none},v="0123456789abcdefghijklmnopqrstuvwxyz",x=(0,n.d_)(v,3),f="grafana.explore.datasource",E=W=>`${f}.${W}`,h=W=>p.A.getObject(E(W)),y=(W,z)=>p.A.setObject(E(W),z);function b(){for(;;){const W=x(3);if(!/^\d+$/.test(W))return W}}async function D(W){const{queries:z,dsRef:Y,timeRange:X,scopedVars:q,adhocFilters:G}=W,te=(await Promise.allSettled(z.filter(se=>se.datasource?.uid!==u.Uj).map(async se=>{const ne=await(0,c.l)().get(se.datasource||Y);return{...ne.interpolateVariablesInQueries?.([se],q??{},G)[0]||se,...!ne.meta.mixed&&{datasource:ne.getRef()}}}))).filter(se=>se.status==="fulfilled").map(se=>se.value),H=JSON.stringify({[b()]:{range:(0,r.sQ)(X.raw),queries:te,datasource:Y?.uid}});return r.kM.renderUrl("/explore",{panes:H,schemaVersion:1})}function P(W){return`explore_${W}`}function C(W,z,Y,X,q,G,te){const H=Number.parseInt(W,36),{interval:se,intervalMs:ne}=B(X,Y.minInterval,Y.maxDataPoints),le={app:i.Jk.Explore,timezone:G||g.lE,startTime:Date.now(),interval:se,intervalMs:ne,panelId:H,targets:z,range:X,requestId:P(W),rangeRaw:X.raw,scopedVars:{__interval:{text:se,value:se},__interval_ms:{text:ne,value:ne},...te},maxDataPoints:Y.maxDataPoints,liveStreaming:Y.liveStreaming,skipQueryCache:!0};return{queries:z,request:le,scanning:q,id:R(),done:!1}}const M=({key:W,...z})=>z,I=(W,z)=>{if(W==null)return"";try{return JSON.stringify(W,null,z)}catch(Y){console.error(Y)}return""};function R(W=0){return`Q-${(0,s.A)()}-${W}`}async function T(W,z=0,Y){let X,q,G;return Y?q=Y:W.length>0&&W[W.length-1].datasource?q=W[W.length-1].datasource:(X=await(0,c.l)().get(),G=X.getDefaultQuery?.(i.Jk.Explore),q=X.getRef()),X||(X=await(0,c.l)().get(q),G=X.getDefaultQuery?.(i.Jk.Explore)),{...G,refId:(0,o.M)(W),key:R(z),datasource:q}}const S=(W,z,Y=0)=>{const X=R(Y),q=W.refId||(0,o.M)(z);return{...W,refId:q,key:X}};async function L(W,z){if(W&&typeof W=="object"&&W.length>0){const Y=[];for(let X=0;X<W.length;X++){const q=W[X],G=R(X);let te=q.refId;te||(te=(0,o.M)(Y));let H=!0;if(q.datasource)try{await(0,c.l)().get(q.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),H=!1}H&&Y.push({...q,refId:te,key:G})}return Y}try{const Y=z??(await(0,c.l)().get()).getRef();return[await T(W??[],void 0,Y)]}catch{return[]}}const O=["refId","key","context","datasource"];function j(W){return W&&W.some(z=>Object.entries(z).filter(([X,q])=>O.indexOf(X)===-1).filter(([X,q])=>q).length>0)}const N=W=>W.reduce((Y,X,q)=>{const G=X.datasource?.uid||X.key;return Y.concat(`${G}-${q}`)},[]),F=(W,z,Y)=>d.convertRawToRange(z,W,Y),U=W=>a.cC.isLive(W)?l.uH.Ascending:l.uH.Descending,w=W=>{W&&W.unsubscribe()};function B(W,z,Y){return Y?d.calculateInterval(W,Y,z):{interval:"1s",intervalMs:1e3}}const K=W=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(W);else{const z=document.createElement("textarea");z.value=W,document.body.appendChild(z),z.select(),document.execCommand("copy"),document.body.removeChild(z)}}},78827:(k,A,e)=>{"use strict";e.r(A),e.d(A,{default:()=>n});function n(s,l){l=l||{};const r=l.delimiter||".";let i=l.maxDepth||3,g=1;const o={};function d(c,a){Object.entries(c).forEach(([p,u])=>{const m=l?.safe&&Array.isArray(u),x=Object.prototype.toString.call(u)==="[object Object]",f=a?a+r+p:p;if(l?.maxDepth||(i=g+1),!m&&x&&Object.keys(u).length&&g<i)return++g,d(u,f);o[f]=u})}return d(s,null),o}},68576:(k,A,e)=>{"use strict";e.d(A,{A:()=>o});var n=e(95344),s=e(54479),l=e(65879),r=e(83195);const g={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:d=>((0,n.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,s.$f)(d)),roundInterval:d=>((0,n.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),l.roundInterval(d)),secondsToHms:d=>((0,n.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),l.secondsToHms(d)),secondsToHhmmss:d=>{const c=[],a=Math.floor(d/3600),p=Math.floor(d%3600/60),u=Math.floor(d%3600%60);return a>9?c.push(""+a):c.push("0"+a),p>9?c.push(""+p):c.push("0"+p),u>9?c.push(""+u):c.push("0"+u),c.join(":")},toPercent:(d,c)=>Math.floor(d/c*1e4)/100+"%",addSlashes:d=>d.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:d=>((0,n.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),l.describeInterval(d)),intervalToSeconds:d=>((0,n.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),l.intervalToSeconds(d)),intervalToMs:d=>((0,n.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),l.intervalToMs(d)),calculateInterval:(d,c,a)=>((0,n.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),l.calculateInterval(d,c,a)),queryColorDot:(d,c)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+d,"font-size:"+c+"px"].join(";")+'"></div>',slugifyForUrl:d=>d.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:d=>((0,n.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,s.dO)(d)),toFixed:(d,c)=>{if(d===null)return"";const a=c?Math.pow(10,Math.max(0,c)):1,p=String(Math.round(d*a)/a);if(p.indexOf("e")!==-1||d===0)return p;if(c!=null){const u=p.indexOf("."),m=u===-1?0:p.length-u-1;if(m<c)return(m?p:p+".")+String(a).slice(1,c-m+1)}return p},toFixedScaled:(d,c,a,p,u)=>a===null?g.toFixed(d,c)+u:g.toFixed(d,a+p)+u,roundValue:(d,c)=>{if(d===null)return null;const a=Math.pow(10,c),p=(a*d).toFixed(c);return Math.round(parseFloat(p))/a},getUnitFormats:r.Ke};typeof Proxy<"u"?g.valueFormats=new Proxy(g.valueFormats,{get(d,c,a){if(typeof c!="string")throw{message:`Value format ${String(c)} is not a string`};const p=(0,r.j_)(c);return p?(u,m,v,x)=>(0,r.cN)(p(u,m,v,x?"utc":"browser")):Reflect.get(d,c,a)}}):g.valueFormats=(0,r.uH)();const o=g},78160:(k,A,e)=>{"use strict";e.d(A,{j:()=>s,z:()=>l});var n=e(42614);function s(r){if(!(!performance||!performance.mark))try{performance.mark(`${r}_started`)}catch(i){console.error(`[Metrics] Failed to startMeasure ${r}`,i)}}function l(r){if(!(!performance||!performance.mark))try{const i=`${r}_started`,g=`${r}_completed`,o=`${r}_measured`;performance.mark(g);const d=performance.measure(o,i,g);return(0,n.n)(`${r}_ms`,d.duration),performance.clearMarks(i),performance.clearMarks(g),performance.clearMeasures(o),d}catch(i){console.error(`[Metrics] Failed to stopMeasure ${r}`,i);return}}},36689:(k,A,e)=>{"use strict";e.d(A,{C:()=>s,o:()=>l});var n=e(8484);function s(r){switch(r){case"home":return(0,n.t)("nav.home.title","Home");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,n.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,n.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,n.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","Apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"monitoring":return(0,n.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function l(r){switch(r){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,n.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(k,A,e)=>{"use strict";e.d(A,{v:()=>l});var n=e(2543),s=e.n(n);function l(r){return(0,n.isArray)(r)?r.map(l):(0,n.isPlainObject)(r)?Object.keys(r).sort().reduce((i,g)=>{const o=r[g];return o!=null&&(i[g]=l(o)),i},{}):r}},21969:(k,A,e)=>{"use strict";e.d(A,{Ih:()=>s,Lr:()=>i,U7:()=>l,dr:()=>r,fE:()=>g});var n=e(77789);function s(o){const d=["refId","hide","key","queryType","datasource"];for(const c in o)if(c!=="label"&&!d.includes(c))return!1;return!0}function l(o,d,c){const a={...d,refId:(0,n.M)(o),hide:!1};return!a.datasource&&c&&(a.datasource=c),[...o,a]}function r(o){return o.indexOf("api/datasources/proxy")!==-1||o.indexOf("api/ds/query")!==-1}function i(o){return!o.match(/^http/)}function g(o){return o||void 0}},81523:(k,A,e)=>{"use strict";e.d(A,{Ax:()=>S,DI:()=>f,Gx:()=>h,IA:()=>M,NC:()=>P,TR:()=>O,U3:()=>C,X1:()=>y,cX:()=>D,ev:()=>R,l0:()=>x,oU:()=>b,rs:()=>E,x8:()=>L,xB:()=>v.x});var n=e(2543),s=e.n(n),l=e(76885),r=e(72724),i=e(19347),g=e(82467),o=e(3169),d=e(8484),c=e(99140),a=e(38877),p=e(75533),u=e(11401),m=e(16233),v=e(91650);async function x(N){const{queries:F,localOverride:U,datasource:w,starred:B,comment:K,showNotif:W}=N,z=W?.quotaExceededError??!0,Y=W?.limitExceededWarning??!0,X=W?.otherErrors??!0,q=F&&F.filter(G=>j(G));if(q.length>0){let G=!1,te=!1,H;try{H=(await(U?(0,u.tU)():(0,u.a)()).addToRichHistory({datasourceUid:w.uid,datasourceName:w.name??"",queries:q,starred:B,comment:K??""})).warning}catch(se){return se instanceof Error&&(se.name===a.m.StorageFull?(G=!0,z&&(0,c.JD)((0,g.dx)((0,o.gi)(se.message)))):X&&se.name!==a.m.DuplicatedEntry&&(0,c.JD)((0,g.dx)((0,o.gi)((0,d.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),se.message)))),{richHistoryStorageFull:G,limitExceeded:te}}return H&&H.type===a.C.LimitExceeded&&(te=!0,Y&&(0,c.JD)((0,g.dx)((0,o.q8)(H.message)))),{richHistoryStorageFull:G,limitExceeded:te}}return{}}async function f(N){const F={...N,from:N.to===void 0?N.to:(0,p.wQ)(N.to,{isLastTs:!0,tz:m.TP.user?.timezone}),to:N.from===void 0?N.from:(0,p.wQ)(N.from,{isLastTs:!0,tz:m.TP.user?.timezone})};return await(0,u.a)().getRichHistory(F)}async function E(N){await(0,u.a)().updateSettings(N)}async function h(){return await(0,u.a)().getSettings()}async function y(){return(0,u.a)().deleteAll()}async function b(N,F){try{return await(0,u.a)().updateStarred(N,F)}catch(U){U instanceof Error&&(0,c.JD)((0,g.dx)((0,o.gi)((0,d.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),U.message)));return}}async function D(N,F){try{return await(0,u.a)().updateComment(N,F)}catch(U){U instanceof Error&&(0,c.JD)((0,g.dx)((0,o.gi)((0,d.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),U.message)));return}}async function P(N){try{return await(0,u.a)().deleteRichHistory(N),N}catch(F){F instanceof Error&&(0,c.JD)((0,g.dx)((0,o.gi)((0,d.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),F.message)));return}}const C=N=>{const F={range:{from:(0,d.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,d.t)("explore.rich-history-utils.default-to","now")},datasource:N.datasourceName,queries:N.queries},U=(0,l.Pp)(F),w=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return l.kM.renderUrl(`${w}/explore`,{left:U})},M=N=>{let F;switch(N){case 0:F=(0,d.t)("explore.rich-history-utils.today","today");break;case 1:F=(0,d.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:F=(0,d.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:F=(0,d.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:F=(0,d.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${N}`})}return F};function I(N){return(0,r.LE)(N,{format:"MMMM D"})}function R(N){const F=(0,n.omit)(N,["key","refId","datasource"]);return JSON.stringify(F)}function T(N,F){let U="";return F===v.x.DatasourceAZ||F===v.x.DatasourceZA?U=N.datasourceName:U=I(N.createdAt),U}function S(N,F){return F?.getQueryDisplayText?F.getQueryDisplayText(N):R(N)}function L(N,F){let U={};return N.forEach(w=>{let B=T(w,F);B in U?U[B]=[...U[B],w]:U[B]=[w]}),U}function O(){return(0,i.l)().getList({mixed:!0}).map(N=>({name:N.name,uid:N.uid}))}function j(N){const F=(0,n.omit)(N,["key","refId","datasource"]);return Object.keys(F).length>0}},91650:(k,A,e)=>{"use strict";e.d(A,{x:()=>n});var n=(s=>(s.Descending="Descending",s.Ascending="Ascending",s.DatasourceAZ="Datasource A-Z",s.DatasourceZA="Datasource Z-A",s))(n||{})},7030:(k,A,e)=>{"use strict";e.d(A,{$l:()=>h,Sp:()=>f,VN:()=>E,VP:()=>x,fn:()=>v});var n=e(41811),s=e(32264),l=e(17172),r=e(39601),i=e(80943),g=e(82467),o=e(3169),d=e(11982),c=e(99140),a=e(8484),p=e(87490);function u(){return`${window.location.protocol}//${window.location.host}${s.$.appSubUrl}`}function m(y){let b=y.replace(u(),"");return b.startsWith("/")?b.substring(1,b.length):b}const v=(0,n.A)(async function(y){try{return(await(0,l.AI)().post("/api/short-urls",{path:m(y)})).url}catch(b){console.error("Error when creating shortened link: ",b),(0,c.JD)((0,g.dx)((0,o.gi)("Error generating shortened link")))}}),x=async y=>{const b=await v(y);b?((0,p.uJ)(b),(0,c.JD)((0,g.dx)((0,o.tZ)("Shortened link copied to clipboard")))):(0,c.JD)((0,g.dx)((0,o.gi)("Error generating shortened link")))},f=async(y,b,D)=>{const P=E(y,b,D);if(b.useShortUrl)return await x(P);(0,p.uJ)(P),(0,c.JD)((0,g.dx)((0,o.tZ)((0,a.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},E=(y,b,D)=>{const P=r.Ny.getLocation(),C=i.jh.getTimeRange(D??y),M=h(b,C,D);return(0,d.uZ)({uid:y.state.uid,slug:y.state.meta.slug,currentQueryParams:P.search,updateQuery:M,absolute:!0})},h=(y,b,D)=>{const P={};return D&&(P.viewPanel=D.state.key),y.useAbsoluteTimeRange&&(P.from=b.state.value.from.toISOString(),P.to=b.state.value.to.toISOString()),y.theme!=="current"&&(P.theme=y.theme),P}},92247:(k,A,e)=>{"use strict";e.r(A),e.d(A,{getPrecision:()=>i,getScaledDecimals:()=>s,getStringPrecision:()=>g,grafanaTimeFormat:()=>l,logp:()=>r,tickStep:()=>n});function n(o,d,c){const a=Math.sqrt(50),p=Math.sqrt(10),u=Math.sqrt(2),m=Math.abs(d-o)/Math.max(0,c);let v=Math.pow(10,Math.floor(Math.log(m)/Math.LN10));const x=m/v;return x>=a?v*=10:x>=p?v*=5:x>=u&&(v*=2),d<o?-v:v}function s(o,d){return o-Math.floor(Math.log(d)/Math.LN10)}function l(o,d,c){if(d&&c&&o){const a=c-d,p=a/o/1e3,u=864e5,m=31536e6;return p<=45?"HH:mm:ss":p<=7200||a<=u?"HH:mm":p<=8e4?"MM/DD HH:mm":p<=2419200||a<=m?"MM/DD":"YYYY-MM"}return"HH:mm"}function r(o,d){return Math.log(o)/Math.log(d)}function i(o){const d=o.toString();return g(d)}function g(o){if(isNaN(o))return 0;const d=o.indexOf(".");return d===-1?0:o.length-d-1}},80582:(k,A,e)=>{"use strict";e.d(A,{Wb:()=>s,Zk:()=>l,zG:()=>r});var n=e(47232);const s=(i,g)=>{const o={from:(0,n.yT)(g.from),to:(0,n.yT)(g.to)},d=(o.to.valueOf()-o.from.valueOf())/2;let c,a;return i===-1?(c=o.to.valueOf()-d,a=o.from.valueOf()-d):i===1?(c=o.to.valueOf()+d,a=o.from.valueOf()+d,c>Date.now()&&o.to.valueOf()<Date.now()&&(c=Date.now(),a=o.from.valueOf())):(c=o.to.valueOf(),a=o.from.valueOf()),{from:a,to:c}},l=(i,g)=>{const o=i.to.valueOf()-i.from.valueOf(),d=i.to.valueOf()-o/2,c=o===0?3e4:o*g,a=d+c/2;return{from:d-c/2,to:a}};async function r(){const i=await navigator.clipboard.readText();let g;try{return g=JSON.parse(i),!g.from||!g.to?{range:i,isError:!0}:{range:g,isError:!1}}catch{return{range:i,isError:!0}}}},94515:(k,A,e)=>{"use strict";e.d(A,{iU:()=>s});var n=e(47232);function s(i,g){if(!(i.fromDayOfWeek||i.from)&&!(i.toDayOfWeek||i.to))return[];const o={...i};o.from&&!o.to&&(o.to=o.from),!o.from&&o.to&&(o.from=o.to);const d={from:l(o.from),to:l(o.to)};if(!o.fromDayOfWeek&&o.toDayOfWeek&&(o.fromDayOfWeek=o.toDayOfWeek),!o.toDayOfWeek&&o.fromDayOfWeek&&(o.toDayOfWeek=o.fromDayOfWeek),o.fromDayOfWeek&&(d.from.dayOfWeek=Number(o.fromDayOfWeek)),o.toDayOfWeek&&(d.to.dayOfWeek=Number(o.toDayOfWeek)),d.from.dayOfWeek&&d.from.h==null&&d.from.m==null&&(d.from.h=0,d.from.m=0,d.from.s=0),d.to.dayOfWeek&&d.to.h==null&&d.to.m==null&&(d.to.h=23,d.to.m=59,d.to.s=59),!d.from||!d.to)return[];d.from.h==null&&(d.from.h=0),d.to.h==null&&(d.to.h=23);const c=[],a=(0,n.KQ)(g.from).utc();for(a.set("hour",0),a.set("minute",0),a.set("second",0),a.set("millisecond",0),a.add(d.from.h,"hours"),a.add(d.from.m,"minutes"),a.add(d.from.s,"seconds");a.unix()<=g.to.unix();){for(;d.from.dayOfWeek&&d.from.dayOfWeek!==a.isoWeekday();)a.add(24,"hours");if(a.unix()>g.to.unix())break;const p=(0,n.KQ)(a).utc();if(p.hour)if(d.from.h<=d.to.h)p.add(d.to.h-d.from.h,"hours");else if(d.from.h>d.to.h)for(;p.hour()!==d.to.h;)p.add(1,"hours");else for(p.add(24-d.from.h,"hours");p.hour()!==d.to.h;)p.add(1,"hours");for(p.set("minute",d.to.m??0),p.set("second",d.to.s??0);d.to.dayOfWeek&&d.to.dayOfWeek!==p.isoWeekday();)p.add(24,"hours");a.unix()<g.from.unix()&&p.unix()<g.from.unix()||a.unix()>g.to.unix()&&p.unix()>g.to.unix()||c.push({from:a.valueOf(),to:p.valueOf()}),a.add(24,"hours")}return c}function l(i){const g={};if(!i?.length)return g;const o=i.split(":");return o?.length&&(g.h=Math.min(23,Math.max(0,Number(o[0]))),o.length>1&&(g.m=Math.min(60,Math.max(0,Number(o[1]))),o.length>2&&(g.s=Math.min(60,Math.max(0,Number(o[2])))))),g}function r(i){if(!i||i.h==null&&i.m==null&&i.s==null)return"";let g=String(i.h??0).padStart(2,"0")+":"+String(i.m??0).padStart(2,"0");return i.s!=null&&(g+=String(i.s??0).padStart(2,"0")),g}},67027:(k,A,e)=>{"use strict";e.d(A,{r:()=>s});let n="";const s=()=>{const r=new URLSearchParams(window.location.search).get("auth_token");return r!==null&&r!==""?(n=r,r):n}},62651:(k,A,e)=>{"use strict";e.r(A),e.d(A,{addExtensionReducers:()=>_m,init:()=>Gm});var n=e(33378),s=e(32264),l=e(14110),r=e(10096),i=e(6320),g=e(99758),o=e(2272),d=e(31678),c=e(75192),a=e(74848),p=e(90182),u=e(14578);const m="licensedRole",v=[{value:"server_admin",label:"Server admin"},{value:"admin_editor",label:"Admin/editor"},{value:"viewer",label:"Viewer"}],x=({filters:V,onChange:ye,className:Be})=>(0,a.jsx)(p.KF,{value:V.find(Je=>Je.name===m)?.value,options:v,onChange:Je=>{ye({name:m,value:Je})},prefix:(0,a.jsx)(u.I,{name:"filter"}),width:64,placeholder:"Filter by licensed role",menuShouldPortal:!0,className:Be}),f=()=>{(0,c.jT)(x)};var E=e(96712),h=e(47232),y=e(32196),b=e(36663),D=e(40845),P=e(90613);function C({message:V,variant:ye}){const Be=(0,D.of)(M);return(0,a.jsx)(P.a,{display:"flex",backgroundColor:ye,borderRadius:"default",paddingY:1,paddingX:2,alignItems:"stretch",children:(0,a.jsx)("div",{className:Be.content,children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,b.G)(V)}})})})}function M(V){return{content:(0,y.css)({p:{margin:0},a:{color:V.colors.text.link}})}}var I=e(96540),R=e(75816),T=e(75505),S=e(17172);function L({baseURL:V}){async function ye(Be){try{const{data:Je,...it}=await(0,T.s)((0,S.AI)().fetch({...Be,url:V+Be.url,showErrorAlert:Be.showErrorAlert,data:Be.body}));return{data:Je,meta:it}}catch(Je){return Be.manageError?Be.manageError(Je):{error:Je}}}return ye}const O=(0,R.xP)({reducerPath:"announcementBannerGeneratedAPI",baseQuery:L({baseURL:`/apis/banners.grafana.app/v0alpha1/namespaces/${s.$.namespace}`}),tagTypes:["AnnouncementBannerList"],endpoints:()=>({})}),j="/announcement-banners",N=O.injectEndpoints({endpoints:V=>({listAnnouncementBanner:V.query({query:()=>({url:j}),providesTags:["AnnouncementBannerList"]}),createAnnouncementBanner:V.mutation({query:ye=>({url:j,method:"POST",body:ye}),invalidatesTags:["AnnouncementBannerList"]}),getAnnouncementBanner:V.query({query:ye=>({url:`${j}/${ye.name}`})}),deleteAnnouncementBanner:V.mutation({query:ye=>({url:`${j}/${ye.name}`,method:"DELETE"})}),updateAnnouncementBanner:V.mutation({query:ye=>({url:`${j}/${ye.name}`,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},body:JSON.stringify(ye.body)}),invalidatesTags:["AnnouncementBannerList"]})}),overrideExisting:!1}),{useListAnnouncementBannerQuery:F,useCreateAnnouncementBannerMutation:U,useGetAnnouncementBannerQuery:w,useDeleteAnnouncementBannerMutation:B,useUpdateAnnouncementBannerMutation:K}=N,W=N.enhanceEndpoints({});function z(V){const[ye,Be]=U(),[Je,it]=K();return[(0,I.useCallback)(Qt=>V?Je({name:V,body:{metadata:{name:V},spec:Qt}}):ye({metadata:{generateName:"banner"},spec:Qt}),[ye,V,Je]),V?it:Be]}function Y(){const V=F();return[V.data?.items?.at(-1),V.isLoading]}function X(){const[V]=Y(),{message:ye,variant:Be,enabled:Je,endTime:it,startTime:bt,visibility:Qt}=V?.spec||{message:"",variant:"info"},{isSignedIn:un}=r.contextSrv.user,an=(0,h.AN)().isBetween(bt,it,void 0,"[]");return!Je||!an||!(Qt==="everyone"||Qt==="authenticated"&&un)?null:(0,a.jsx)(C,{message:ye,variant:Be})}async function q(){(0,E.Pl)(X)}var G=e(69444),te=e(49785),H=e(26272),se=e(3591),ne=e(67061),le=e(84167),_=e(88575),Q=e(15292),ae=e(32372),oe=e(63383),J=e(94354),ee=e(55852),de=e(8484),xe=e(24180),re=e(37390);const ue=({confirmRedirect:V,onDiscard:ye,onLocationChange:Be})=>{const[Je,it]=(0,I.useState)(!1),[bt,Qt]=(0,I.useState)(null),[un,an]=(0,I.useState)(!1);(0,I.useEffect)(()=>{const Wn=es=>{V&&(es.preventDefault(),es.returnValue="")};return window.addEventListener("beforeunload",Wn),()=>{window.removeEventListener("beforeunload",Wn)}},[V]);const Ln=Wn=>{const es=window.location.pathname,us=Wn.pathname;if(es===us)return!0;const ps=Be?.(Wn);let ds=V&&!un;return ps!==void 0&&(ds=ds&&ps),ds?(it(!0),Qt(Wn),!1):(ps&&ye(),!0)},$n=()=>{it(!1),Qt(null)},Hn=()=>{it(!1),an(!0),ye()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(xe.XG,{when:!0,message:Ln}),bt&&un&&(0,a.jsx)(xe.rd,{to:bt}),(0,a.jsx)(Te,{isOpen:Je,onDiscard:Hn,onBackToForm:$n})]})},Te=({onDiscard:V,onBackToForm:ye,isOpen:Be})=>(0,a.jsxs)(re.a,{isOpen:Be,title:"Leave page?",onDismiss:ye,icon:"exclamation-triangle",className:(0,y.css)`
        width: 500px;
      `,children:[(0,a.jsx)("h5",{children:"Changes that you made may not be saved."}),(0,a.jsxs)(re.a.ButtonRow,{children:[(0,a.jsx)(ee.$n,{variant:"secondary",onClick:ye,fill:"outline",children:"Continue editing"}),(0,a.jsx)(ee.$n,{variant:"destructive",onClick:V,children:"Discard unsaved changes"})]})]});var ge=e(94753);function Oe({message:V,variant:ye}){return(0,a.jsxs)(ne.B,{direction:"column",width:"100%",gap:2,children:[(0,a.jsx)(ge.E,{variant:"h3",children:(0,a.jsx)(de.x6,{i18nKey:"banner.preview.title",children:"Preview"})}),(0,a.jsx)(C,{message:V||(0,de.t)("banner.preview.message.default","Update this preview by modifying the message field."),variant:ye})]})}function Ue(V){return V?{...V,startTime:V.startTime?(0,h.KQ)(V.startTime):(0,h.KQ)(),endTime:V.endTime?(0,h.KQ)(V.endTime):void 0}:{enabled:!1,message:"",variant:"info",visibility:"everyone",startTime:(0,h.KQ)()}}function Xe({banner:V,name:ye}){const[Be,Je]=z(ye),{register:it,control:bt,handleSubmit:Qt,watch:un,reset:an,formState:{errors:Ln,isDirty:$n},getValues:Hn}=(0,te.mN)({defaultValues:Ue(V)}),[Wn,es,us]=un(["startTime","message","variant"]);(0,I.useEffect)(()=>{const ds=(0,se.J7)();if(Je.isSuccess){const xs=Hn();ds.publish({type:H.r1.alertSuccess.name,payload:[(0,de.t)("banner.api.result.saved","Banner settings saved")]}),an({...xs,startTime:xs.startTime||null,endTime:xs.endTime||null})}},[Je.isSuccess,an,Hn]);const ps=async ds=>{(0,l.rR)("grafana_banner_saved",{enabled:ds.enabled,endSelected:!!ds.endTime,daysShown:ds.endTime?ds.startTime&&(0,h.KQ)(ds.endTime).diff(ds.startTime,"days"):void 0,visibility:ds.visibility,variant:ds.variant});const xs={...ds,startTime:ds.startTime?ds.startTime.toISOString():null,endTime:ds.endTime?ds.endTime.toISOString():null};Be(xs)};return(0,a.jsxs)(ne.B,{direction:"column",gap:2,children:[(0,a.jsx)(Oe,{message:es,variant:us}),(0,a.jsx)("form",{onSubmit:Qt(ps),style:{maxWidth:650},children:(0,a.jsxs)(le.n,{label:(0,de.t)("banner.form.title","Configure banner"),children:[(0,a.jsx)(ue,{onDiscard:an,confirmRedirect:$n}),(0,a.jsx)(_.D,{label:(0,de.t)("banner.form.enabled.label","Enabled"),children:(0,a.jsx)(Q.d,{...it("enabled"),label:"Enabled"})}),(0,a.jsx)(_.D,{label:(0,de.t)("banner.form.message.label","Message"),description:(0,a.jsx)(de.x6,{i18nKey:"banner.form.message.description",children:"Text content of the banner. Supports markdown."}),children:(0,a.jsx)(te.xI,{name:"message",control:bt,render:({field:{ref:ds,...xs}})=>(0,a.jsx)(ae.B,{...xs,height:200,language:"markdown"})})}),(0,a.jsx)(_.D,{label:(0,de.t)("banner.form.start.label","Starts at"),description:(0,a.jsx)(de.x6,{i18nKey:"banner.form.start.description",children:"The banner will be shown staring from this date/time."}),children:(0,a.jsx)(te.xI,{name:"startTime",control:bt,render:({field:{ref:ds,value:xs,...ua}})=>(0,a.jsx)(oe.K,{...ua,date:xs||void 0,showSeconds:!1,clearable:!0})})}),(0,a.jsx)(_.D,{label:(0,de.t)("banner.form.end.label","Ends at"),invalid:!!Ln?.endTime,error:Ln?.endTime?.message,description:(0,a.jsx)(de.x6,{i18nKey:"banner.form.end.description",children:"If no end date is selected, the banner is displayed indefinitely."}),children:(0,a.jsx)(te.xI,{name:"endTime",control:bt,rules:{validate:ds=>!Wn||!ds||ds>Wn?!0:(0,de.t)("banner.form.end.error","End time must be after start time")},render:({field:{ref:ds,value:xs,...ua}})=>(0,a.jsx)(oe.K,{...ua,date:xs||void 0,showSeconds:!1,clearable:!0})})}),(0,a.jsx)(_.D,{label:(0,de.t)("banner.form.visibility.label","Visibility"),children:(0,a.jsx)(te.xI,{control:bt,name:"visibility",render:({field:{ref:ds,...xs}})=>(0,a.jsx)(J.z,{...xs,options:[{label:(0,de.t)("banner.form.options.everyone","Everyone"),value:"everyone"},{label:(0,de.t)("banner.form.options.authenticated","Authenticated users"),value:"authenticated"}]})})}),(0,a.jsx)(ne.B,{children:(0,a.jsx)(_.D,{label:(0,de.t)("banner.form.variant.label","Variant"),children:(0,a.jsx)(te.xI,{name:"variant",control:bt,render:({field:{ref:ds,onChange:xs,...ua}})=>(0,a.jsx)(p.l6,{...ua,onChange:ca=>{xs(ca.value)},placeholder:"Select banner type",options:[{label:(0,de.t)("banner.form.options.info","Info"),value:"info"},{label:(0,de.t)("banner.form.options.warning","Warning"),value:"warning"},{label:(0,de.t)("banner.form.options.error","Error"),value:"error"}]})})})}),(0,a.jsx)(ee.$n,{type:"submit",disabled:!$n||Je.isLoading,children:Je.isLoading?(0,a.jsx)(de.x6,{i18nKey:"banner.form.button-saving",children:"Saving..."}):(0,a.jsx)(de.x6,{i18nKey:"banner.form.button-save",children:"Save"})})]})})]})}function we(){const[V,ye]=Y();return(0,I.useEffect)(()=>{(0,l.Jy)()},[]),(0,a.jsx)(G.Y,{navId:"banner-settings",children:(0,a.jsx)(G.Y.Contents,{isLoading:ye,children:(0,a.jsx)(Xe,{banner:V?.spec,name:V?.metadata.name})})})}var qe=e(73399),We=e(13280),Ce=e(95273),je=(V=>(V.Monthly="monthly",V.Weekly="weekly",V.Daily="daily",V.Hourly="hourly",V.Never="never",V.Custom="custom",V.Once="once",V))(je||{}),Ke=(V=>(V.Hours="hours",V.Days="days",V.Weeks="weeks",V.Months="months",V))(Ke||{}),_e=(V=>(V.Default="",V.SentBy="sent-by",V.None="none",V))(_e||{}),Fe=(V=>(V.Paused="paused",V.Scheduled="scheduled",V.Expired="expired",V.Draft="draft",V.Never="not scheduled",V))(Fe||{}),at=(V=>(V.PDF="pdf",V.CSV="csv",V.Image="image",V.PDFTables="pdf-tables",V.PDFTablesAppendix="pdf-tables-appendix",V))(at||{});const Ct=[{value:"landscape",label:"Landscape",icon:"gf-landscape"},{value:"portrait",label:"Portrait",icon:"gf-portrait"}],Dt=[{value:"grid",label:"Grid",icon:"gf-grid"},{value:"simple",label:"Simple",icon:"gf-layout-simple"}];var tt=(V=>(V.SelectDashboard="select-dashboard",V.FormatReport="format-report",V.Schedule="schedule",V.Share="share",V.Confirm="confirm",V))(tt||{});const ze="last";var pe=(V=>(V.Stats="stats",V.Users="users",V.PublicDashboards="public-dashboards",V))(pe||{}),Se=e(82421),fe=(V=>(V.ReportingCreate="reports:create",V.ReportingWrite="reports:write",V.ReportingDelete="reports:delete",V.ReportingRead="reports:read",V.ReportingSend="reports:send",V.ReportingSettingsWrite="reports.settings:write",V.ReportingSettingsRead="reports.settings:read",V.DataSourcesPermissionsRead="datasources.permissions:read",V.DataSourcesPermissionsWrite="datasources.permissions:write",V.DataSourcesCachingWrite="datasources.caching:write",V.LicensingRead="licensing:read",V.LicensingWrite="licensing:write",V.LicensingReportsRead="licensing.reports:read",V.DashboardsInsightsRead="dashboards.insights:read",V.ActionBannersWrite="banners:write",V))(fe||{}),Ee=e(40964),Pe=(V=>(V.General="general",V.KeyCert="key-cert",V.ConnectToIdP="connect-to-idp",V.AssertionMapping="assertion-mapping",V.SaveAndTest="save-and-test",V))(Pe||{}),he=e(71468),be=e(56034),Ae=e(72109),De=e(10354),Ie=e(14186);const ke=({value:V,label:ye,placeholder:Be,width:Je,id:it,onChange:bt})=>{const Qt=(0,D.of)(dt),un=an=>{const Ln=an.currentTarget.value;bt(Ln)};return(0,a.jsx)("div",{className:Qt.assertionEditorRow,children:(0,a.jsx)(Ie.I,{label:ye,labelWidth:16,htmlFor:it,children:(0,a.jsx)(De.p,{width:Je||30,id:it,value:V||"",onChange:un,placeholder:Be})})})},dt=V=>({assertionEditorRow:(0,y.css)`
      display: flex;
      margin-bottom: ${V.spacing(1)};
    `,inputLabel:(0,y.css)`
      color: ${V.components.input.text};
      background: ${V.components.input.background};
    `}),Pt=({isConfigured:V,onReset:ye,label:Be,...Je})=>{const it=(0,D.of)(pt);return(0,a.jsxs)("div",{className:it.inputWithReset,children:[(0,a.jsx)(Ie.I,{label:Be,labelWidth:16,htmlFor:Je.id,children:(0,a.jsx)(a.Fragment,{children:V?(0,a.jsx)(De.p,{...Je,value:"configured",disabled:!0}):(0,a.jsx)(De.p,{...Je})})}),V&&(0,a.jsx)(ee.$n,{className:it.resetButton,variant:"primary",size:"md",onClick:ye,children:"Reset"})]})},pt=V=>({resetButton:(0,y.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,inputWithReset:(0,y.css)`
      padding: 0;
      display: flex;
    `});var Tt=e(17408),jt=e(39938),$t=e(42418),sn=e(20604);function Yt(V){return{error:V.authConfig.updateError,warning:V.authConfig.warning}}const qt={resetError:sn.SH,resetWarning:sn.yk},Jt=(0,he.connect)(Yt,qt)(({error:V,warning:ye,resetError:Be,resetWarning:Je})=>(0,a.jsxs)("div",{children:[V&&(0,a.jsx)($t.F,{title:V.message,onRemove:()=>Be(),children:V.errors?.map((it,bt)=>(0,a.jsx)("div",{children:it},bt))}),ye&&(0,a.jsx)($t.F,{title:ye.message,onRemove:()=>Je(),severity:"warning",children:ye.errors?.map((it,bt)=>(0,a.jsx)("div",{children:it},bt))})]}));var Ut=e(50720);function Gt({validationResults:V,onStepChange:ye,visitedSteps:Be=[],getNextUrl:Je,steps:it,activeStep:bt=it[0].id}){const Qt=(0,D.of)(Lt),un=it[it.length-1];return(0,a.jsx)("ol",{className:Qt.container,children:it.map(an=>{const Ln=an.id===un.id,$n=an.id===bt,Hn=Be.includes(an.id)||bt===un.id,Wn=!Ln&&!V[an.id].valid,es=!$n&&!Ln&&Hn,us=es&&!Wn,ps=es&&Wn,ds=(0,y.cx)(Qt.item,{[Qt.active]:$n,[Qt.successItem]:us,[Qt.warnItem]:ps});return(0,a.jsxs)("li",{className:ds,children:[us&&(0,a.jsx)(u.I,{name:"check",size:"xl",className:Qt.successItem}),ps&&(0,a.jsx)(u.I,{name:"exclamation-triangle",className:Qt.warnItem}),(0,a.jsx)(Ut.N,{onClick:$n?void 0:()=>ye(an.id),href:Je(an.id),className:Qt.link,children:an.name}),!Ln&&(0,a.jsx)("div",{className:Qt.divider,children:"\u2014"})]},an.id)})})}const Lt=V=>({container:(0,y.css)`
      counter-reset: item;
      list-style-type: none;
      width: 100%;
      position: relative;
      display: flex;
      justify-content: center;
      border: 1px solid ${V.colors.border.weak};
      margin: ${V.spacing(4,0)};
    `,item:(0,y.css)`
      color: ${V.colors.text.secondary};
      display: flex;
      align-items: center;
    `,successItem:(0,y.css)`
      a {
        &::before {
          content: '';
        }
      }

      svg {
        color: ${V.colors.success.text};
        margin: ${V.spacing(0,.5,0,-1)};
      }
    `,warnItem:(0,y.css)`
      a::before {
        content: '';
      }
      svg {
        color: ${V.colors.warning.text};
        margin: ${V.spacing(0,1,.5,-.5)};
      }
    `,link:(0,y.css)`
      color: inherit;
      &:hover {
        color: ${V.colors.text.link};
      }

      &::before {
        content: counter(item) '  ';
        counter-increment: item;
      }
    `,active:(0,y.css)`
      font-weight: 500;
      color: ${V.colors.text.maxContrast};

      &::before {
        font-weight: 500;
      }
    `,divider:(0,y.css)`
      padding: ${V.spacing(2)};
    `}),At=({error:V,onReset:ye})=>(0,a.jsx)("div",{children:V&&(0,a.jsx)($t.F,{title:V.message,onRemove:ye,severity:"warning",children:V.errors?.map((Be,Je)=>(0,a.jsx)("div",{children:Be},Je))})});var Nt=e(39601),Dn=e(2543);const An="/admin/authentication/saml",Pn=s.$.appUrl+"saml/metadata",Xn=s.$.appUrl+"saml/acs",Tn=s.$.appUrl+"saml/slo";function ht(V){return{enabled:St(V.enabled),allowSignUp:St(V.allow_sign_up),autoLogin:St(V.auto_login),singleLogout:St(V.single_logout),allowIdpInitiated:St(V.allow_idp_initiated),skipOrgRoleSync:St(V.skip_org_role_sync),name:Ge(V.name),privateKey:Ge(V.private_key),privateKeyPath:Ge(V.private_key_path),certificate:Ge(V.certificate),certificatePath:Ge(V.certificate_path),signatureAlgorithm:Ge(V.signature_algorithm),idpMetadata:Ge(V.idp_metadata),idpMetadataPath:Ge(V.idp_metadata_path),idpMetadataUrl:Ge(V.idp_metadata_url),maxIssueDelay:Ge(V.max_issue_delay),metadataValidDuration:Ge(V.metadata_valid_duration),relayState:Ge(V.relay_state),assertionAttributeName:Ge(V.assertion_attribute_name),assertionAttributeLogin:Ge(V.assertion_attribute_login),assertionAttributeEmail:Ge(V.assertion_attribute_email),assertionAttributeGroups:Ge(V.assertion_attribute_groups),assertionAttributeRole:Ge(V.assertion_attribute_role),assertionAttributeOrg:Ge(V.assertion_attribute_org),allowedOrganizations:Ge(V.allowed_organizations),orgMapping:Ge(V.org_mapping),roleValuesNone:Ge(V.role_values_none),roleValuesViewer:Ge(V.role_values_viewer),roleValuesEditor:Ge(V.role_values_editor),roleValuesAdmin:Ge(V.role_values_admin),roleValuesGrafanaAdmin:Ge(V.role_values_grafana_admin),nameIdFormat:Ge(V.name_id_format),clientId:Ge(V.client_id),clientSecret:Ge(V.client_secret),tokenUrl:Ge(V.token_url),forceUseGraphApi:St(V.force_use_graph_api)}}function St(V){return V==="true"}function Ge(V){return V||""}function Ve(V){return V?"true":"false"}function lt(V){return{enabled:Ve(V.enabled),allow_sign_up:Ve(V.allowSignUp),auto_login:Ve(V.autoLogin),single_logout:Ve(V.singleLogout),allow_idp_initiated:Ve(V.allowIdpInitiated),skip_org_role_sync:Ve(V.skipOrgRoleSync),name:Ge(V.name),private_key:Ge(V.privateKey),private_key_path:Ge(V.privateKeyPath),certificate:Ge(V.certificate),certificate_path:Ge(V.certificatePath),signature_algorithm:Ge(V.signatureAlgorithm),idp_metadata:Ge(V.idpMetadata),idp_metadata_path:Ge(V.idpMetadataPath),idp_metadata_url:Ge(V.idpMetadataUrl),max_issue_delay:Ge(V.maxIssueDelay),metadata_valid_duration:Ge(V.metadataValidDuration),relay_state:Ge(V.relayState),assertion_attribute_name:Ge(V.assertionAttributeName),assertion_attribute_login:Ge(V.assertionAttributeLogin),assertion_attribute_email:Ge(V.assertionAttributeEmail),assertion_attribute_groups:Ge(V.assertionAttributeGroups),assertion_attribute_role:Ge(V.assertionAttributeRole),assertion_attribute_org:Ge(V.assertionAttributeOrg),allowed_organizations:Ge(V.allowedOrganizations),org_mapping:Ge(V.orgMapping),role_values_none:Ge(V.roleValuesNone),role_values_viewer:Ge(V.roleValuesViewer),role_values_editor:Ge(V.roleValuesEditor),role_values_admin:Ge(V.roleValuesAdmin),role_values_grafana_admin:Ge(V.roleValuesGrafanaAdmin),name_id_format:Ge(V.nameIdFormat),client_id:Ge(V.clientId),client_secret:Ge(V.clientSecret),token_url:Ge(V.tokenUrl),force_use_graph_api:Ve(V.forceUseGraphApi)}}function It(V){const{keyCertValueType:ye,metadataValueType:Be,signRequests:Je}=V,{certificate_path:it,private_key_path:bt,certificate:Qt,private_key:un,idp_metadata_url:an,idp_metadata_path:Ln,idp_metadata:$n,...Hn}=lt(V),Wn={updates:{"auth.saml":Hn},removals:{"auth.saml":[]}};return ye==="path"?(bt&&!On(bt)&&(Wn.updates["auth.saml"].private_key_path=bt,Wn.updates["auth.saml"].private_key=""),it&&!On(it)&&(Wn.updates["auth.saml"].certificate_path=it,Wn.updates["auth.saml"].certificate="")):ye==="base64"&&(un&&!On(un)&&(Wn.updates["auth.saml"].private_key=un,Wn.updates["auth.saml"].private_key_path=""),Qt&&!On(Qt)&&(Wn.updates["auth.saml"].certificate=Qt,Wn.updates["auth.saml"].certificate_path="")),Je||(Wn.updates["auth.saml"].signature_algorithm=""),Be==="url"?(Wn.updates["auth.saml"].idp_metadata_url=an,Wn.updates["auth.saml"].idp_metadata_path="",Wn.updates["auth.saml"].idp_metadata=""):Be==="path"?(Wn.updates["auth.saml"].idp_metadata_path=Ln,Wn.updates["auth.saml"].idp_metadata_url="",Wn.updates["auth.saml"].idp_metadata=""):Be==="base64"&&(Wn.updates["auth.saml"].idp_metadata=$n,Wn.updates["auth.saml"].idp_metadata_url="",Wn.updates["auth.saml"].idp_metadata_path=""),Wn}function Qe(V,ye){const Be={};return Object.keys(V).forEach(Je=>{V[Je]!==ye[Je]&&(Be[Je]=V[Je])}),Be}function vt(V){const ye=V?.split(/[,\s]/),Be=[];return ye?.forEach(Je=>{const it=Je.split(":");if(it.length===3){const bt=zt(it[2]);bt&&Be.push({externalOrg:it[0],orgId:it[1],role:bt})}}),Be}function Ot(V){return V.map(Be=>`${Be.externalOrg}:${Be.orgId}:${Be.role}`).join(",")}function zt(V){return V==="Admin"||V==="Editor"||V==="Viewer"?V:null}const vn={enabled:"false",skip_org_role_sync:"false"};function ln(V){return(0,Dn.isEqual)(V,vn)}function On(V){return V?/^\*+$/.test(V):!1}function wn(V,ye,Be){switch(V){case"privateKey":return ye[V]===Be.private_key&&!!Be.private_key;case"privateKeyPath":return ye[V]===Be.private_key_path&&!!Be.private_key_path;case"certificate":return ye[V]===Be.certificate&&!!Be.certificate;case"certificatePath":return ye[V]===Be.certificate_path&&!!Be.certificate_path;default:return!1}}function Un(V){return V.idpMetadataPath?"path":V.idpMetadata?"base64":"url"}const cs=V=>`${An}/${V||""}`,Zn=V=>{if(!V)return ro[0];const ye=ro.findIndex(Be=>Be.id===V);return ye===ro.length-1?ro[ye]:ro[ye+1]},wt=V=>{if(!V||V===ro[0].id)return;const ye=ro.findIndex(Be=>Be.id===V);return ro[ye-1]},Ft=V=>{const ye=wt(V);ye&&ye.id!==V&&Nt.Ny.push(cs(ye.id))},Ht=(0,I.forwardRef)(({activeStep:V,disabled:ye},Be)=>{const Je=(0,D.of)(ut),it=(0,I.useRef)(null),bt=wt(V),Qt=Zn(V),un=Qt.id===V;(0,I.useImperativeHandle)(Be,()=>({click:()=>{it.current?.click()}}));const an=()=>{it.current?.click(),Ft(V)};return(0,a.jsx)("div",{className:Je.buttonRow,children:(0,a.jsx)("div",{className:Je.buttonRowInner,children:(0,a.jsxs)("div",{children:[bt&&(0,a.jsxs)(ee.$n,{variant:"secondary",onClick:an,children:["Previous: ",bt.name]}),!un&&(0,a.jsxs)(ee.$n,{ref:it,disabled:ye,type:"submit",children:["Next: ",Qt.name]})]})})})});Ht.displayName="ButtonRow";const ut=V=>({buttonRow:(0,y.css)`
      display: flex;
      padding: ${V.spacing(2,0,.5,0)};
      border-top: 1px solid ${V.colors.border.weak};
      width: 100%;
      background-color: ${V.colors.background.primary};
      button {
        &:first-of-type {
          margin-right: ${V.spacing(2)};
        }
        &:last-of-type {
          margin-right: 0;
        }
      }
    `,buttonRowInner:(0,y.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
    `});var pn=e(38138),Jn=e(83122),Qn=e(29158),fs=e(96374);const ls=({enabled:V,isNewConfig:ye,onSave:Be,onSaveAndEnable:Je,onDisable:it,onRemove:bt})=>{const Qt=(0,D.of)(vs);let un={text:"Not enabled",color:"blue"};V?un={text:"Enabled",color:"green",icon:"check"}:ye||(un={text:"Not enabled",color:"blue"});const[an,Ln]=(0,I.useState)(!1),$n=()=>{bt(),Ln(!1),window.location.href="/admin/authentication"},Hn=(0,a.jsx)(pn.W,{children:(0,a.jsx)(pn.W.Item,{label:"Delete",icon:"trash-alt",onClick:()=>{Ln(!0)}})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:Qt.actionBarContainer,children:[(0,a.jsxs)("div",{className:Qt.protocolContainer,children:[(0,a.jsx)("span",{className:Qt.protocolLabel,children:"Protocol"}),(0,a.jsx)("span",{children:"SAML 2.0"})]}),!ye&&(0,a.jsxs)("div",{className:Qt.statusContainer,children:[(0,a.jsx)("span",{className:Qt.statusLabel,children:"Status"}),(0,a.jsx)(jt.E,{...un,className:Qt.statusBadge})]}),!V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.$n,{variant:"secondary",onClick:Be,children:"Save"}),(0,a.jsx)(ee.$n,{variant:"primary",onClick:Je,children:"Save and enable"})]}),V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.$n,{variant:"primary",onClick:Be,children:"Save and apply"}),(0,a.jsx)(be.m,{content:"Disable will disable Grafana to not use SAML auth.",placement:"top",children:(0,a.jsx)(ee.$n,{variant:"secondary",fill:"outline",onClick:it,children:"Disable"})})]}),!ye&&(0,a.jsx)(Jn.m,{overlay:Hn,placement:"bottom-start",children:(0,a.jsx)(Qn.K,{tooltip:"More actions",tooltipPlacement:"top",variant:"secondary",name:"ellipsis-v"})})]}),(0,a.jsx)(fs.u,{title:"Delete SAML configuration",body:"Are you sure you want to permanently delete this SAML configuration? All changes made in the UI will be removed.",confirmText:"Delete configuration",confirmationText:V?"delete":"",dismissText:"Back to editing",isOpen:an,onDismiss:()=>Ln(!1),onConfirm:$n})]})},vs=V=>({actionBarContainer:(0,y.css)`
      display: flex;
      flexdirection: row;
      gap: ${V.spacing(1)};
      align-items: center;
      justify-content: flex-end;
    `,iniFileLabel:(0,y.css)`
      display: flex;
      color: ${V.colors.text.primary};
      justify-content: flex-end;
    `,tooltipContainer:(0,y.css)`
      padding: ${V.spacing(0,1)};
    `,statusContainer:(0,y.css)`
      display: flex;
      flex-direction: column;
      font-size: ${V.typography.bodySmall.fontSize};
      border-left: 1px solid ${V.colors.border.medium};
      padding: ${V.spacing(0,2)};
    `,statusBadge:(0,y.css)`
      span {
        font-size: ${V.typography.size.xs};
      }
    `,statusLabel:(0,y.css)`
      color: ${V.colors.text.secondary};
    `,protocolContainer:(0,y.css)`
      display: flex;
      flex-direction: column;
      font-size: ${V.typography.bodySmall.fontSize};
      padding-right: ${V.spacing(1)};
    `,protocolLabel:(0,y.css)`
      color: ${V.colors.text.secondary};
    `});var ea=e(60610),Ks=e(65307);const Hs={assertionAttributeName:"displayName",assertionAttributeLogin:"mail",assertionAttributeEmail:"mail"},bs={storedSamlSettings:{},samlSettings:{},samlStep:1,activeStep:Pe.General,signRequests:!1,keyCertValueType:"base64",keyConfigured:!1,certConfigured:!1,metadataValueType:"url",configChanged:!1,showSavedBadge:!1,visitedSteps:[],isUpdated:!1,isLoading:!1,configFoundInIniFile:!1},Ys=(0,Ks.Z0)({name:"samlConfig",initialState:bs,reducers:{settingsLoaded:(V,ye)=>({...V,samlSettings:ye.payload,configChanged:!1,isLoading:!1}),setStoredSAMLSettings:(V,ye)=>({...V,storedSamlSettings:ye.payload}),setConfigFoundInIniFile:(V,ye)=>({...V,configFoundInIniFile:ye.payload}),settingsUpdated:(V,ye)=>({...V,samlSettings:ye.payload,configChanged:!0}),settingsLoadingBegin:V=>({...V,isLoading:!0}),settingsLoadingEnd:V=>({...V,isLoading:!1}),samlStepChanged:(V,ye)=>({...V,samlStep:ye.payload}),setSignRequests:(V,ye)=>({...V,signRequests:ye.payload}),setKeyCertValueType:(V,ye)=>({...V,keyCertValueType:ye.payload}),setKeyConfigured:(V,ye)=>({...V,keyConfigured:ye.payload}),setCertConfigured:(V,ye)=>({...V,certConfigured:ye.payload}),setMetadataValueType:(V,ye)=>({...V,metadataValueType:ye.payload}),settingsChanged:(V,ye)=>({...V,configChanged:ye.payload}),setError:(V,ye)=>({...V,error:ye.payload}),resetError:V=>({...V,error:void 0}),setShowSavedBadge:(V,ye)=>({...V,showSavedBadge:ye.payload}),addVisitedStep:(V,ye)=>({...V,visitedSteps:[...V.visitedSteps,...ye.payload]}),clearSAMLState:V=>({...V,isUpdated:!1,visitedSteps:[]})}}),{settingsLoaded:La,settingsUpdated:Xs,samlStepChanged:Ta,setStoredSAMLSettings:Lr,setSignRequests:$r,setKeyCertValueType:Za,setKeyConfigured:Er,setCertConfigured:Ar,setMetadataValueType:ho,settingsChanged:Fr,setShowSavedBadge:rr,setConfigFoundInIniFile:fo,addVisitedStep:_o,clearSAMLState:gr,settingsLoadingBegin:ci,settingsLoadingEnd:Qo,setError:eo,resetError:Do}=Ys.actions,bo={samlConfig:Ys.reducer},Oo=()=>s.$.featureToggles?.ssoSettingsApi&&s.$.featureToggles?.ssoSettingsSAML;async function To(){return Oo()?$o():jo()}async function jo(){const ye=(await(0,S.AI)().get("/api/admin/settings"))["auth.saml"]||{};return[ht(ye),ye]}async function $o(){const V=await(0,S.AI)().get("/api/v1/sso-settings/saml"),ye=V?V.settings:{},Be=Po(ye);return[ye,Be]}function Yo(V,ye){if(Oo()){const Be=ri(V);return vi(Be)}else return Si(V,ye)}function Si(V,ye){const Be=It(V);if(Be.updates){const Je=Qe(Be.updates["auth.saml"],ye);Be.updates["auth.saml"]=Je}return(0,ea.DZ)(Be)}function vi(V){return async ye=>{if(r.contextSrv.hasPermission(d.AccessControlAction.SettingsWrite))try{return await(0,S.AI)().put("/api/v1/sso-settings/saml",{provider:"saml",settings:{...V}},{showErrorAlert:!1}),ye(Do()),!0}catch(Be){if((0,S.NF)(Be)){Be.isHandled=!0;const Je={message:Be.data?.message,errors:Be.data?.errors};return ye(eo(Je)),!1}}return!1}}function ai(){return Oo()?yi():Bo()}function yi(){return async V=>{if(r.contextSrv.hasPermission(d.AccessControlAction.SettingsWrite))try{return await(0,S.AI)().delete("/api/v1/sso-settings/saml",void 0,{showSuccessAlert:!1,showErrorAlert:!1}),V(Do()),!0}catch(ye){if((0,S.NF)(ye)){ye.isHandled=!0;const Be={message:ye.data?.message,errors:ye.data?.errors};return V(eo(Be)),!1}}return!1}}function Bo(){const V={removals:{"auth.saml":["enabled","name","single_logout","allow_sign_up","auto_login","certificate","certificate_path","private_key","private_key_path","signature_algorithm","idp_metadata","idp_metadata_path","idp_metadata_url","max_issue_delay","metadata_valid_duration","allow_idp_initiated","relay_state","assertion_attribute_name","assertion_attribute_login","assertion_attribute_email","assertion_attribute_groups","assertion_attribute_role","assertion_attribute_org","allowed_organizations","org_mapping","role_values_none","role_values_viewer","role_values_editor","role_values_admin","role_values_grafana_admin","name_id_format","skip_org_role_sync","client_id","client_secret","token_url","force_use_graph_api"]}};return(0,ea.DZ)(V)}function Ai(V){return Oo()?Ho(V):ui()}function Ho(V){return vi({...V,enabled:!0})}function ui(){const V={updates:{"auth.saml":{enabled:"true"}}};return(0,ea.DZ)(V)}function Jo(V){return Oo()?Ri(V):xi()}function Ri(V){return vi({...V,enabled:!1})}function xi(){const V={updates:{"auth.saml":{enabled:"false"}}};return(0,ea.DZ)(V)}function Po(V){return{enabled:V?.enabled?"true":"false",name:V?.name,allow_sign_up:V?.allowSignUp?"true":"false",auto_login:V?.autoLogin?"true":"false",single_logout:V?.singleLogout?"true":"false",allow_idp_initiated:V?.allowIdpInitiated?"true":"false",skip_org_role_sync:V?.skipOrgRoleSync?"true":"false",private_key:V?.privateKey,private_key_path:V?.privateKeyPath,certificate:V?.certificate,certificate_path:V?.certificatePath,signature_algorithm:V?.signatureAlgorithm,idp_metadata:V?.idpMetadata,idp_metadata_path:V?.idpMetadataPath,idp_metadata_url:V?.idpMetadataUrl,max_issue_delay:V?.maxIssueDelay,metadata_valid_duration:V?.metadataValidDuration,relay_state:V?.relayState,assertion_attribute_name:V?.assertionAttributeName,assertion_attribute_login:V?.assertionAttributeLogin,assertion_attribute_email:V?.assertionAttributeEmail,assertion_attribute_groups:V?.assertionAttributeGroups,assertion_attribute_role:V?.assertionAttributeRole,assertion_attribute_org:V?.assertionAttributeOrg,allowed_organizations:V?.allowedOrganizations,org_mapping:V?.orgMapping,role_values_none:V?.roleValuesNone,role_values_viewer:V?.roleValuesViewer,role_values_editor:V?.roleValuesEditor,role_values_admin:V?.roleValuesAdmin,role_values_grafana_admin:V?.roleValuesGrafanaAdmin,name_id_format:V?.nameIdFormat,client_id:V?.clientId,client_secret:V?.clientSecret,token_url:V?.tokenUrl,force_use_graph_api:V?.forceUseGraphApi?"true":"false"}}function ri(V){return{enabled:V?.enabled,name:V?.name,allowSignUp:V?.allowSignUp,autoLogin:V?.autoLogin,singleLogout:V?.singleLogout,allowIdpInitiated:V?.allowIdpInitiated,skipOrgRoleSync:V?.skipOrgRoleSync,privateKey:V?.privateKey,privateKeyPath:V?.privateKeyPath,certificate:V?.certificate,certificatePath:V?.certificatePath,signatureAlgorithm:V?.signatureAlgorithm,idpMetadata:V?.idpMetadata,idpMetadataPath:V?.idpMetadataPath,idpMetadataUrl:V?.idpMetadataUrl,maxIssueDelay:V?.maxIssueDelay,metadataValidDuration:V?.metadataValidDuration,relayState:V?.relayState,assertionAttributeName:V?.assertionAttributeName,assertionAttributeLogin:V?.assertionAttributeLogin,assertionAttributeEmail:V?.assertionAttributeEmail,assertionAttributeGroups:V?.assertionAttributeGroups,assertionAttributeRole:V?.assertionAttributeRole,assertionAttributeOrg:V?.assertionAttributeOrg,allowedOrganizations:V?.allowedOrganizations,orgMapping:V?.orgMapping,roleValuesNone:V?.roleValuesNone,roleValuesViewer:V?.roleValuesViewer,roleValuesEditor:V?.roleValuesEditor,roleValuesAdmin:V?.roleValuesAdmin,roleValuesGrafanaAdmin:V?.roleValuesGrafanaAdmin,nameIdFormat:V?.nameIdFormat,clientId:V?.clientId,clientSecret:V?.clientSecret,tokenUrl:V?.tokenUrl,forceUseGraphApi:V?.forceUseGraphApi}}var Ei=e(39547),Zo=e.n(Ei);function _t(V,ye,Be){na(Be,V(ye))}function cn(V){const ye={valid:!0,errors:[]};return _t(ns,V,ye),_t(Rs,V,ye),_t(Os,V,ye),_t(ha,V,ye),ye}function kn(V,ye){switch(ye){case SAMLStepKey.General:return!ns(V).valid;case SAMLStepKey.KeyCert:return!Rs(V).valid;case SAMLStepKey.ConnectToIdP:return!Os(V).valid;case SAMLStepKey.AssertionMapping:return!ha(V).valid;default:return!1}}function Kn(V){const ye={};return ro.forEach(({id:Be})=>{switch(Be){case Pe.General:ye[Be]=ns(V);return;case Pe.KeyCert:ye[Be]=Rs(V);return;case Pe.ConnectToIdP:ye[Be]=Os(V);return;case Pe.AssertionMapping:ye[Be]=ha(V);return}}),ye}function ns(V){const ye={valid:!0,errors:[]},{allowIdpInitiated:Be,relayState:Je}=V;return Be===!0&&!Je&&wa(ye,"Relay state should be configured"),Je&&Je.length>80&&wa(ye,"Relay state should be 80 characters or less"),ye}function Rs(V){const ye={valid:!0,errors:[]},{signRequests:Be,privateKey:Je,privateKeyPath:it,certificate:bt,certificatePath:Qt}=V;return Be&&!Je&&!it&&wa(ye,"Private key should be configured if sign requests is enabled"),Be&&!bt&&!Qt&&wa(ye,"Certificate key should be configured if sign requests is enabled"),Je&&!Je.startsWith("***")&&!Ma(Je)&&wa(ye,"Not valid PEM private key"),bt&&!bt.startsWith("***")&&!oo(bt)&&wa(ye,"Not valid PEM certificate"),ye}function Os(V){const ye={valid:!0,errors:[]},{idpMetadataUrl:Be,idpMetadataPath:Je,idpMetadata:it,metadataValueType:bt}=V;return(bt==="base64"&&!it||bt==="url"&&!Be||bt==="path"&&!Je||!Be&&!Je&&!it)&&wa(ye,"IdP metadata should be configured"),ye}function ha(V){return{valid:!0,errors:[]}}function na(V,ye){ye.valid||(V.valid=!1,V.errors?.push(...ye.errors))}function wa(V,ye){V.valid=!1,V.errors?.push(ye)}function pr(V){return/^([0-9]*(\.[0-9]*)?[smh]+)+$/.test(V)}function Ma(V){try{const ye=atob(V);return ks(ye)}catch{return!1}}function ks(V){try{const ye=Ei.pem.decode(V);return!(ye.length>1||ye[0].type!=="PRIVATE KEY")}catch{return!1}}function oo(V){try{const ye=atob(V);return go(ye)}catch{return!1}}function go(V){try{const ye=Ei.pki.certificateFromPem(V),Be=new Date;return!(ye.validity.notBefore>Be||ye.validity.notAfter<Be)}catch{return!1}}const qr=5e3;function po(){return async V=>{if(r.contextSrv.hasPermission(d.AccessControlAction.SettingsRead))try{V(ci());const[ye,Be]=await To();V(Lr(Be)),V($r(!!ye.signatureAlgorithm||!!ye.privateKeyPath||!!ye.privateKey||!!ye.certificatePath||!!ye.certificate)),V(Za(ye.privateKeyPath?"path":"base64")),V(Er(!!ye.privateKeyPath||!!ye.privateKey)),V(Ar(!!ye.certificatePath||!!ye.certificate)),V(ho(Un(ye))),V(La(ye))}catch{V(Qo())}}}function yo(V,ye){return async Be=>{Be(Do());const Je=cn(V);if(!Je.valid){Be(eo({message:"Cannot save settings",errors:Je.errors}));return}await Be(Yo(V,ye))&&(Be(tr()),Be(po()))}}function hi(){return async V=>{await V(ai())&&(V(tr()),V(po()))}}function Di(V){return async ye=>{await ye(Ai(V))&&(ye(tr()),ye(po()))}}function Rr(V){return async ye=>{await ye(Jo(V))&&(ye(tr()),ye(po()))}}function tr(){return async V=>{V(rr(!0)),setTimeout(()=>{V(rr(!1))},qr)}}const Vr=V=>{const{samlSettings:ye,storedSamlSettings:Be,isUpdated:Je,visitedSteps:it,keyCertValueType:bt,keyConfigured:Qt,certConfigured:un,signRequests:an,metadataValueType:Ln,showSavedBadge:$n,error:Hn}=V.samlConfig;return{isUpdated:Je,samlSettings:ye,storedSamlSettings:Be,visitedSteps:it,keyCertValueType:bt,keyConfigured:Qt,certConfigured:un,signRequests:an,metadataValueType:Ln,showSavedBadge:$n,error:Hn}},io={addVisitedStep:_o,clearSAMLState:gr,saveSAMLSettings:yo,enableSAML:Di,disableSAML:Rr,resetSAMLSettings:hi,setError:eo,resetError:Do},ja=(0,he.connect)(Vr,io),Xo=({samlSettings:V,storedSamlSettings:ye,keyCertValueType:Be,metadataValueType:Je,signRequests:it,activeStep:bt,addVisitedStep:Qt,children:un,clearSAMLState:an,confirmRedirect:Ln,keyConfigured:$n,certConfigured:Hn,isUpdated:Wn,error:es,resetError:us,visitedSteps:ps,showSavedBadge:ds,label:xs,className:ua,getFormData:ca,onSubmit:Ds,saveSAMLSettings:Ws,enableSAML:er,disableSAML:hr,resetSAMLSettings:pa})=>{const qs=(0,D.of)(Ti),js=Zn(bt),$a=(0,xe.W6)(),Ia=(0,I.useRef)(null),[fr,Va]=(0,I.useState)(Ln||Wn);(0,I.useEffect)(()=>{(wr=>{(0,l.rR)("authentication_saml_step",{step:wr}),wr===ro[ro.length-1].id?Qt(ro.map(zi=>zi.id)):Qt([wr])})(bt)},[bt,Qt]),(0,I.useEffect)(()=>{Va(Ln||Wn)},[Ln,Wn]);const Sr=oa=>{oa.preventDefault();const wr=cs(js.id);Ds(),$a.push(wr)},Ir=()=>{let oa={...V,keyCertValueType:Be,signRequests:it,metadataValueType:Je,keyConfigured:$n,certConfigured:Hn};if(ca){const wr=ca();oa={...oa,...wr}}return oa},rl=async oa=>{const wr=Ir();oa&&(wr.enabled=!0),Ws(wr,ye),(0,l.rR)("authentication_saml_saved",{enabled:wr.enabled}),Va(!1),an()},dl=()=>{(0,l.rR)("authentication_saml_enabled"),er(V)},uo=()=>{(0,l.rR)("authentication_saml_disabled"),hr(V)},vo=()=>{an(),(0,l.rR)("authentication_saml_abandoned")},Go=()=>{(0,l.rR)("authentication_saml_removed"),pa()},si=oa=>!ro.map(zi=>cs(zi.id)).includes(oa.pathname),Vi=()=>{const oa=ro[ro.length-1].id;bt!==oa&&Ia.current?.click()},Lo=Kn(Ir());return(0,a.jsxs)("form",{onSubmit:Sr,className:qs.container,children:[(0,a.jsx)(ls,{enabled:V.enabled,isNewConfig:ln(ye),onSave:()=>rl(),onSaveAndEnable:()=>rl(!0),onEnable:dl,onDisable:uo,onRemove:Go}),(0,a.jsx)(ue,{confirmRedirect:fr,onDiscard:vo,onLocationChange:si}),(0,a.jsxs)("div",{className:qs.inner,children:[(0,a.jsx)(Gt,{steps:ro,activeStep:bt,visitedSteps:ps,onStepChange:Vi,getNextUrl:cs,validationResults:Lo}),(0,a.jsx)(Jt,{}),(0,a.jsx)(At,{error:es,onReset:us}),(0,a.jsxs)("div",{className:(0,y.cx)(qs.content,ua),children:[(0,a.jsx)(le.n,{label:(0,a.jsxs)("div",{className:qs.header,children:[xs&&(0,a.jsx)(Tt.s,{children:xs}),(0,a.jsx)("div",{children:ds&&(0,a.jsx)(jt.E,{text:"Saved",color:"green",icon:"check"})})]}),children:un}),(0,a.jsx)(Ht,{ref:Ia,activeStep:bt})]})]})]})},Ti=V=>({container:(0,y.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      align-content: center;
    `,header:(0,y.css)`
      display: flex;
      justify-content: space-between;
    `,inner:(0,y.css)`
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      flex: 1 0 auto;
    `,content:(0,y.css)`
      padding-bottom: ${V.spacing(3)};
    `}),Rt=ja(Xo),tn=[{label:"Default",value:""},{label:"Unspecified",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified"},{label:"Email address",value:"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},{label:"Persistent",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"},{label:"Transient",value:"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"}];function Mn(V){return{samlSettings:V.samlConfig.samlSettings,clientSecretConfigured:!0}}const zn={settingsUpdated:Xs},Es=(0,he.connect)(Mn,zn),Ts=({clientSecretConfigured:V,samlSettings:ye,settingsUpdated:Be})=>{const Je=(0,D.of)(qa),{assertionAttributeName:it,assertionAttributeLogin:bt,assertionAttributeEmail:Qt,assertionAttributeRole:un,assertionAttributeGroups:an,assertionAttributeOrg:Ln,clientId:$n,clientSecret:Hn,tokenUrl:Wn,forceUseGraphApi:es,roleValuesNone:us,roleValuesViewer:ps,roleValuesEditor:ds,roleValuesAdmin:xs,roleValuesGrafanaAdmin:ua,orgMapping:ca,allowedOrganizations:Ds,nameIdFormat:Ws,skipOrgRoleSync:er}=ye,{handleSubmit:hr,control:pa,register:qs,getValues:js,setValue:$a,formState:{isDirty:Ia}}=(0,te.mN)({defaultValues:{assertionAttributeName:it,assertionAttributeLogin:bt,assertionAttributeEmail:Qt,assertionAttributeRole:un,assertionAttributeGroups:an,assertionAttributeOrg:Ln,clientId:$n,clientSecret:Hn,tokenUrl:Wn,forceUseGraphApi:es,roleValuesNone:us,roleValuesViewer:ps,roleValuesEditor:ds,roleValuesAdmin:xs,roleValuesGrafanaAdmin:ua,orgMapping:ca,allowedOrganizations:Ds,nameIdFormat:Ws||"",skipOrgRoleSync:er}}),fr=({...Lo})=>{Ia&&Be({...ye,...Lo})},Va=Lo=>js(Lo)!=="",Sr=Lo=>{$a(Lo,"",{shouldDirty:!0}),rl(!1)},[Ir,rl]=(0,I.useState)(V&&Va("clientSecret")),dl=()=>{rl(V&&Va("clientSecret"))},{orgRole:uo,isGrafanaAdmin:vo}=r.contextSrv.user,Go=vo,si=uo==="Admin"||Go,Vi=uo==="Editor"||si;return(0,a.jsxs)(Rt,{activeStep:Pe.AssertionMapping,onSubmit:hr(fr),confirmRedirect:Ia,getFormData:js,className:Je.wrapper,label:"User mapping",children:[(0,a.jsx)("div",{className:Je.description,children:"Map SAML assertion attributes to the Grafana user attributes. Assertion attributes support template mappings. Team sync is available if groups attribute is configured."}),(0,a.jsxs)("div",{className:Je.mappingContainer,children:[(0,a.jsxs)("div",{className:Je.mappingSection,children:[(0,a.jsxs)("div",{className:Je.mappingHeader,children:["Assertion attributes mappings",(0,a.jsx)(be.m,{content:"Assertion attributes mapping in Grafana takes user information from a SAML response and uses it to create or update a user in its database. It reads attributes\u2014key/value pairs\u2014within the assertion, such as Name, Login handle, and email. Configurations allow for key selection modification.",placement:"top",children:(0,a.jsx)(u.I,{name:"info-circle",className:Je.icon})})]}),(0,a.jsx)(te.xI,{name:"assertionAttributeName",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Name attribute",id:"assertionAttributeName",placeholder:"displayName"})}),(0,a.jsx)(te.xI,{name:"assertionAttributeLogin",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Login attribute",placeholder:"mail",id:"assertionAttributeLogin"})}),(0,a.jsx)(te.xI,{name:"assertionAttributeEmail",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Email attribute",placeholder:"mail",id:"assertionAttributeEmail"})}),(0,a.jsx)(te.xI,{name:"assertionAttributeGroups",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Groups attribute",id:"assertionAttributeGroups"})}),(0,a.jsx)(te.xI,{name:"assertionAttributeRole",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Role attribute",id:"assertionAttributeRole"})}),si&&(0,a.jsx)(te.xI,{name:"assertionAttributeOrg",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Org attribute",id:"assertionAttributeOrg"})})]}),(0,a.jsxs)("div",{className:Je.mappingSection,children:[Vi&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:Je.mappingHeader,children:["Role mapping",(0,a.jsx)(be.m,{content:"Role mapping syncs user roles from your identity provider to Grafana by configuring role attributes for None, Viewer, Editor, Admin, and Grafana Admin roles. In case there is no match, the default role in Grafana is Viewer.",placement:"top",children:(0,a.jsx)(u.I,{name:"info-circle",className:Je.icon})})]}),(0,a.jsx)(te.xI,{name:"roleValuesNone",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"None",width:60,id:"roleValuesNone"})}),(0,a.jsx)(te.xI,{name:"roleValuesViewer",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Viewer",width:60,id:"roleValuesViewer"})}),(0,a.jsx)(te.xI,{name:"roleValuesEditor",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Editor",width:60,id:"roleValuesEditor"})})]}),si&&(0,a.jsx)(te.xI,{name:"roleValuesAdmin",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Admin",width:60,id:"roleValuesAdmin"})}),Go&&(0,a.jsx)(te.xI,{name:"roleValuesGrafanaAdmin",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Grafana Admin",width:60,id:"roleValuesGrafanaAdmin"})}),(0,a.jsx)(_.D,{label:"Skip organization role sync",description:"Prevent synchronizing for SAML users organization roles from your IdP.",children:(0,a.jsx)(Q.d,{...qs("skipOrgRoleSync"),defaultChecked:er,id:"skipOrgRoleSync"})})]}),Go&&(0,a.jsxs)("div",{className:Je.mappingSection,children:[(0,a.jsxs)("div",{className:Je.mappingHeader,children:["Org mapping",(0,a.jsx)(be.m,{content:"Organization mapping allows you to assign users to particular organization in Grafana depending on attribute value obtained from identity provider. Use the configuration to assign users from your organization to the Grafana organization.",placement:"top",children:(0,a.jsx)(u.I,{name:"info-circle",className:Je.icon})})]}),(0,a.jsx)(te.xI,{name:"orgMapping",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Org mapping",width:60,id:"orgMapping"})})]})]}),(0,a.jsx)("div",{className:Je.mappingContainer,children:(0,a.jsxs)("div",{className:Je.mappingSection,children:[(0,a.jsx)("div",{className:Je.mappingHeader,children:"Azure AD Service Account Configuration"}),(0,a.jsxs)("div",{className:Je.description,children:["If you have users that belong to more than 150 groups in your Azure AD organization, you need to setup a service account in Azure AD to get all the groups via Graph API. This service account will be used to get all the groups for the user. Read more about Azure AD service account configuration in the\xA0",(0,a.jsx)(Ae.Y,{style:{fontSize:"inherit"},external:!0,href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/saml/#configure-a-graph-api-application-in-azure-ad",children:"documentation"}),"."]}),(0,a.jsx)(te.xI,{name:"clientId",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Client ID",width:60,id:"clientId"})}),(0,a.jsx)(te.xI,{name:"clientSecret",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(Pt,{...oa,className:Je.clientSecretInput,width:60,id:"clientSecret",isConfigured:Ir,onReset:()=>Sr("clientSecret"),onBlur:dl,label:"Client Secret"})}),(0,a.jsx)(te.xI,{name:"tokenUrl",control:pa,render:({field:{ref:Lo,...oa}})=>(0,a.jsx)(ke,{...oa,label:"Access Token URL",width:60,id:"tokenUrl"})}),(0,a.jsx)(_.D,{label:"Force use Graph API",description:"Force the use of Graph API to get all the groups for the user.",children:(0,a.jsx)(Q.d,{...qs("forceUseGraphApi"),defaultChecked:es,id:"forceUseGraphApi"})})]})}),(0,a.jsx)(_.D,{label:"Allowed organizations",description:"List of comma- or space-separated SAML organization names. User should be a member of at least one organization to log in.",children:(0,a.jsx)(De.p,{...qs("allowedOrganizations"),id:"allowedOrganizations",width:60})}),(0,a.jsx)(_.D,{label:"Name identifier format",description:"Name identifier formats control how the users at identity provider are mapped to users in Grafana",children:(0,a.jsx)(te.xI,{name:"nameIdFormat",control:pa,render:({field:{ref:Lo,onChange:oa,...wr}})=>(0,a.jsx)(p.l6,{...wr,onChange:zi=>{oa(zi.value)},width:30,options:tn,"aria-label":"nameIdFormat"})})})]})},qa=V=>({wrapper:(0,y.css)`
      width: 100%;
    `,description:(0,y.css)`
      color: ${V.colors.text.secondary};
      font-size: ${V.typography.bodySmall.fontSize};
      margin-bottom: ${V.spacing(2)};
      text-align: justify;
      width: ${V.spacing(76.5)};
    `,mappingContainer:(0,y.css)`
      background: ${V.colors.background.secondary};
      padding: ${V.spacing(2)};
      margin-bottom: ${V.spacing(4)};
    `,mappingSection:(0,y.css)`
      margin-bottom: ${V.spacing(2)};
    `,mappingHeader:(0,y.css)`
      display: flex;
      margin-bottom: ${V.spacing(2)};
    `,assertionEditorRow:(0,y.css)`
      display: flex;
      margin-bottom: ${V.spacing(1)};
    `,icon:(0,y.css)`
      fill: ${V.colors.secondary.text};
      margin-top: ${V.spacing(.5)};
      margin-left: ${V.spacing(.5)};
    `,clientSecretInput:(0,y.css)`
      background: ${V.components.input.background};
      color: ${V.components.input.text};
      margin-bottom: ${V.spacing(1)};
      width: 480px;
    `}),aa=Es(Ts);var ar=e(10534),Aa=e(21744),yr=e(73546);function Dr(V){return{samlSettings:V.samlConfig.samlSettings,metadataValueType:V.samlConfig.metadataValueType}}const ao={settingsUpdated:Xs,setMetadataValueType:ho},Qr=(0,he.connect)(Dr,ao),Uo=[{label:"URL for metadata",value:"url"},{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],Co=({samlSettings:V,metadataValueType:ye,settingsUpdated:Be,setMetadataValueType:Je})=>{const it=(0,D.of)(lo),{idpMetadataUrl:bt,idpMetadataPath:Qt,idpMetadata:un,singleLogout:an}=V,{handleSubmit:Ln,control:$n,register:Hn,watch:Wn,getValues:es,setValue:us,formState:{errors:ps,isDirty:ds}}=(0,te.mN)({mode:"onBlur",defaultValues:{idpMetadataUrl:bt,idpMetadataPath:Qt,idpMetadata:un,metadataValueType:ye||"url"}}),xs=Wn("metadataValueType"),ua=({metadataValueType:Ds,...Ws})=>{ds&&(Be({...V,...Ws}),Je(Ds))},ca=async Ds=>{if(Ds?.currentTarget?.files?.length){const er=await Ds.currentTarget.files[0].text(),hr=btoa(er);us("idpMetadata",hr,{shouldDirty:!0})}};return(0,a.jsx)(Rt,{activeStep:Pe.ConnectToIdP,onSubmit:Ln(ua),confirmRedirect:ds,getFormData:es,className:it.wrapper,label:"Connect Grafana with Identity Provider",children:(0,a.jsxs)("div",{className:it.externalBorder,children:[(0,a.jsxs)("div",{className:it.doubleSideContainer,children:[(0,a.jsxs)("div",{className:it.internalContainer,children:[(0,a.jsxs)("div",{className:it.internalContainerHeader,children:[(0,a.jsx)("div",{className:it.stepNumber,children:"1"}),(0,a.jsx)("h4",{children:"Configure IdP using Grafana metadata"})]}),(0,a.jsxs)("div",{className:it.internalContainerBody,children:[(0,a.jsx)("div",{className:it.description,children:"To configure your identity provider (IdP) you will need the Grafana metadata URL. All below endpoints must be reachable by your Identity Provider (IdP)."}),(0,a.jsx)(_.D,{label:"Metadata URL",description:"SP metadata URL / SP Entity ID",children:(0,a.jsxs)("div",{className:it.inputWithCopyToClipboard,children:[(0,a.jsx)(De.p,{width:50,id:"spMetadata",value:Pn,disabled:!0}),(0,a.jsx)(ar.b,{className:it.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Pn,children:"Copy"})]})}),(0,a.jsx)(_.D,{label:"Assertion Consumer Service URL",description:"Assertion consumer service POST binding URL",children:(0,a.jsxs)("div",{className:it.inputWithCopyToClipboard,children:[(0,a.jsx)(De.p,{width:50,id:"spACS",value:Xn,disabled:!0}),(0,a.jsx)(ar.b,{className:it.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Xn,children:"Copy"})]})}),an&&(0,a.jsx)(_.D,{label:"SLO URL",description:"Logout service redirect binding URL / Logout service POST binding URL",children:(0,a.jsxs)("div",{className:it.inputWithCopyToClipboard,children:[(0,a.jsx)(De.p,{width:50,id:"spSLO",value:Tn,disabled:!0}),(0,a.jsx)(ar.b,{className:it.copyToClipboardButton,variant:"primary",size:"md",icon:"copy",getText:()=>Tn,children:"Copy"})]})})]})]}),(0,a.jsxs)("div",{className:it.internalContainer,children:[(0,a.jsxs)("div",{className:it.internalContainerHeader,children:[(0,a.jsx)("div",{className:it.stepNumber,children:"2"}),(0,a.jsx)("h4",{children:"Finish configuring Grafana using IdP data"})]}),(0,a.jsxs)("div",{className:it.internalContainerBody,children:[(0,a.jsx)("div",{className:it.description,children:"Visit your IdP's configuration panel, add new app and use metadata from step one to connect with Grafana. You will need to copy your IdP's metadata and provide it below. Test connection and copy assertion labels/values."}),(0,a.jsx)(_.D,{label:"IdP's metadata ",description:"Must be the same as set-up or required by IdP.",children:(0,a.jsx)(te.xI,{name:"metadataValueType",control:$n,render:({field:{ref:Ds,...Ws}})=>(0,a.jsx)(J.z,{...Ws,options:Uo})})}),xs==="url"&&(0,a.jsx)(_.D,{label:"Metadata URL",description:"URL for IdP metadata",invalid:!!ps.idpMetadataUrl,error:ps.idpMetadataUrl?.message,children:(0,a.jsx)(De.p,{...Hn("idpMetadataUrl",{validate:Ds=>xs==="url"&&!!Ds||"Required"}),id:"metadataUrl",width:60})}),xs==="base64"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Base64-encoded IdP metadata",invalid:!!ps.idpMetadata,error:ps.idpMetadata?.message,children:(0,a.jsx)(te.xI,{name:"idpMetadata",control:$n,rules:{validate:Ds=>xs==="base64"&&!!Ds||"Required"},render:({field:{ref:Ds,...Ws}})=>(0,a.jsx)(Aa.f,{...Ws,id:"metadataBase64",width:60})})}),(0,a.jsx)(yr.e,{showFileName:!1,onFileUpload:ca,className:it.uploadButton})]}),xs==="path"&&(0,a.jsx)(_.D,{label:"Path to IdP metadata file",invalid:!!ps.idpMetadataPath,error:ps.idpMetadataPath?.message,children:(0,a.jsx)(De.p,{...Hn("idpMetadataPath",{validate:Ds=>xs==="path"&&!!Ds||"Required"}),id:"metadataPath",width:60})}),(0,a.jsx)("div",{className:it.description,children:"If you want to test the connection from your IdP's panel make sure to allow IdP initiated login and provide the relay state information."})]})]})]}),(0,a.jsxs)("div",{className:it.internalContainerHeader,children:[(0,a.jsx)("div",{className:it.stepNumber,children:"3"}),(0,a.jsx)("h4",{children:"Configure assertions, group, group and org mappings in the next step."})]})]})})},lo=V=>({wrapper:(0,y.css)`
      width: 100%;
    `,description:(0,y.css)`
      color: ${V.colors.text.secondary};
      margin-bottom: ${V.spacing(2)};
      font-size: ${V.typography.bodySmall.fontSize};
    `,externalBorder:(0,y.css)`
      border-radius: ${V.shape.borderRadius(1)};
      border: 1px solid ${V.colors.border.medium};
    `,doubleSideContainer:(0,y.css)`
      display: flex;
      flex-direction: row;
      justify-content: space-around;
    `,internalContainer:(0,y.css)`
      flex: 1 1 0;
      border-bottom: 1px solid ${V.colors.border.medium};
      &:first-child {
        border-right: 1px solid ${V.colors.border.medium};
      }
    `,internalContainerHeader:(0,y.css)`
      display: flex;
      justify-content: center;
      border-bottom: 1px solid ${V.colors.border.medium};
      padding: ${V.spacing(2)};
      text-align: center;
      h4 {
        margin-bottom: 0;
      }
    `,internalContainerBody:(0,y.css)`
      padding: ${V.spacing(2)};
    `,stepNumber:(0,y.css)`
      border: 1px solid ${V.colors.background.secondary};
      border-radius: ${V.shape.borderRadius(4)};
      background: ${V.colors.background.secondary};
      color: ${V.colors.text.secondary};
      width: ${V.spacing(3)};
      height: ${V.spacing(3)};
      margin-right: ${V.spacing(1)};
      font-weight: ${V.typography.fontWeightBold};
    `,copyToClipboardButton:(0,y.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,inputWithCopyToClipboard:(0,y.css)`
      padding: 0;
      display: flex;
    `,uploadButton:(0,y.css)`
      margin-bottom: ${V.spacing(2)};
    `}),xo=Qr(Co),Yr=V=>{const{samlSettings:ye}=V.samlConfig;return{samlSettings:ye}},zr={settingsUpdated:Xs},_i=(0,he.connect)(Yr,zr)(({samlSettings:V,settingsUpdated:ye})=>{const{allowSignUp:Be,name:Je,autoLogin:it,singleLogout:bt,allowIdpInitiated:Qt,relayState:un,maxIssueDelay:an,metadataValidDuration:Ln}=V||{},{handleSubmit:$n,register:Hn,watch:Wn,getValues:es,formState:{isDirty:us,errors:ps}}=(0,te.mN)({mode:"onBlur",defaultValues:{allowSignUp:Be,name:Je,autoLogin:it,singleLogout:bt,allowIdpInitiated:Qt,relayState:un,maxIssueDelay:an,metadataValidDuration:Ln}}),ds=Wn("allowIdpInitiated"),xs=Ds=>{us&&ye({...V,...Ds})},ua=Ds=>!Ds||pr(Ds)?!0:"Not a valid duration",ca=Ds=>ds&&Ds?Ds.length>80?"Relay state needs to be 80 characters or less":!0:"Relay state is required";return(0,a.jsxs)(Rt,{activeStep:Pe.General,onSubmit:$n(xs),confirmRedirect:us,getFormData:es,label:"General settings",children:[(0,a.jsx)(ne.B,{children:(0,a.jsx)(_.D,{label:"Display name for this SAML 2.0 integration",description:"Helpful if you use more than one SSO IdP provider or protocol.",children:(0,a.jsx)(De.p,{...Hn("name"),id:"displayName",placeholder:"SAML"})})}),(0,a.jsx)(_.D,{label:"Allow signup",description:"Whether to allow new Grafana user creation through SAML login. If not enabled, then only existing Grafana users can log in with SAML.",children:(0,a.jsx)(Q.d,{...Hn("allowSignUp"),defaultChecked:Be,id:"allowSignup"})}),(0,a.jsx)(_.D,{label:"Auto login",description:"Attempt to log in with SAML automatically, skipping the login screen.",children:(0,a.jsx)(Q.d,{...Hn("autoLogin"),defaultChecked:it,id:"autoLogin"})}),(0,a.jsx)(_.D,{label:"Single logout",description:"Allows users to log out from IdP session and applications associated with the current IdP session established via SAML.",children:(0,a.jsx)(Q.d,{...Hn("singleLogout"),defaultChecked:bt,id:"singleLogout"})}),(0,a.jsx)(_.D,{label:"Identity provider initiated login",description:"Allows users to log in into Grafana directly from identity provider.",children:(0,a.jsx)(Q.d,{...Hn("allowIdpInitiated"),defaultChecked:Qt,id:"allowIdpInitiated"})}),ds&&(0,a.jsx)(_.D,{label:"Relay state",description:"Required. Should match relay state configured in IdP and trailing space is required.",required:ds,invalid:ds&&!!ps.relayState,error:ps.relayState?.message,children:(0,a.jsx)(De.p,{...Hn("relayState",{validate:ca}),width:60,id:"relayState",defaultValue:un})}),(0,a.jsx)(_.D,{label:"Max issue delay",description:"Duration, since the IdP issued a response and Grafana is allowed to process it.",invalid:!!ps.maxIssueDelay,error:ps.maxIssueDelay?.message,children:(0,a.jsx)(De.p,{...Hn("maxIssueDelay",{validate:ua}),width:24,id:"max_issue_delay",defaultValue:an,placeholder:"90s"})}),(0,a.jsx)(_.D,{label:"Metadata valid duration",description:"Duration, for how long Grafana metadata is valid.",invalid:!!ps.metadataValidDuration,error:ps.metadataValidDuration?.message,children:(0,a.jsx)(De.p,{...Hn("metadataValidDuration",{validate:ua}),defaultValue:Ln,width:24,id:"metadataValidDuration",placeholder:"48h"})})]})}),Hi=({isConfigured:V,onReset:ye,onFileUpload:Be,...Je})=>{const it=(0,D.of)(ft);return(0,a.jsxs)("div",{className:it.inputWithReset,children:[(0,a.jsxs)("div",{className:it.textAreaInput,children:[V&&(0,a.jsx)(Aa.f,{...Je,value:"configured",disabled:!0}),!V&&(0,a.jsx)(Aa.f,{...Je})]}),V&&(0,a.jsx)(ee.$n,{className:it.fileUploadButton,variant:"primary",size:"md",onClick:ye,children:"Reset"}),!V&&(0,a.jsx)(yr.e,{className:it.fileUploadButton,showFileName:!1,onFileUpload:Be})]})},ft=V=>({resetButton:(0,y.css)`
      border-top-left-radius: 0px;
      border-bottom-left-radius: 0px;
    `,fileUploadButton:(0,y.css)`
      margin-left: ${V.spacing(1)};
    `,inputWithReset:(0,y.css)`
      padding: 0;
      display: flex;
    `,textAreaInput:(0,y.css)`
      width: ${V.spacing(60)};
    `});var hn=e(87978),dn=e(66864);const Yn=(0,he.connect)(void 0,{})(({onClose:V,onGenerateCert:ye})=>{const{handleSubmit:Be,register:Je,formState:{errors:it}}=(0,te.mN)({mode:"onBlur",defaultValues:{validityDays:365,organization:"",country:"",state:"",city:""}}),bt=an=>!an||an.length>=2&&an.length<=3?!0:"Country code must have a length of 2 or 3 characters.",Qt=an=>an===void 0||isNaN(Number(an))||an<1||an>1e4?"Validity days must be a positive integer between 1 and 10000.":!0,un=an=>{ye(an)};return(0,a.jsx)(hn._,{title:"SAML key and certificate",subtitle:"The following data will be included in the generated certificate",size:"md",onClose:V,children:(0,a.jsxs)("form",{onSubmit:an=>(an.stopPropagation(),Be(un)(an)),children:[(0,a.jsx)(_.D,{label:"Your organization",htmlFor:"organization",children:(0,a.jsx)(De.p,{...Je("organization"),width:48,id:"organization"})}),(0,a.jsx)(_.D,{label:"Country code",invalid:!!it.country,error:it.country?.message,htmlFor:"country",children:(0,a.jsx)(De.p,{...Je("country",{validate:bt}),width:48,id:"country"})}),(0,a.jsx)(_.D,{label:"State",htmlFor:"state",children:(0,a.jsx)(De.p,{...Je("state"),width:48,id:"state"})}),(0,a.jsx)(_.D,{label:"City",htmlFor:"city",children:(0,a.jsx)(De.p,{...Je("city"),width:48,id:"city"})}),(0,a.jsx)(_.D,{label:"Validity days",description:"Number of days the generated certificate is valid for.",invalid:!!it.validityDays,error:it.validityDays?.message,htmlFor:"validityDays",children:(0,a.jsx)(De.p,{...Je("validityDays",{validate:Qt}),width:48,id:"validityDays"})}),(0,a.jsxs)(dn.Gy,{children:[(0,a.jsx)(ee.$n,{type:"submit",size:"md",variant:"primary",tooltip:"Generate the certificate and private key",children:"Generate"}),(0,a.jsx)(ee.$n,{type:"button",size:"md",variant:"secondary",onClick:V,children:"Close"})]})]})})});function Bs(V){const{samlSettings:ye,storedSamlSettings:Be,signRequests:Je,keyCertValueType:it,keyConfigured:bt,certConfigured:Qt}=V.samlConfig;return{samlSettings:ye,storedSettings:Be,signRequests:Je,keyCertValueType:it,keyConfigured:bt,certConfigured:Qt}}const Ns={settingsUpdated:Xs,setSignRequests:$r,setKeyCertValueType:Za,setKeyConfigured:Er,setCertConfigured:Ar},Ps=(0,he.connect)(Bs,Ns),za=[{label:"Base64-encoded content",value:"base64"},{label:"Path to file",value:"path"}],Pa=[{label:"RSA-SHA256",value:"rsa-sha256"},{label:"RSA-SHA512",value:"rsa-sha512"},{label:"RSA-SHA1",value:"rsa-sha1"}],fa={signRequests:!1,privateKey:"",privateKeyPath:"",certificate:"",certificatePath:"",signatureAlgorithm:"",keyConfigured:!1,certConfigured:!1,keyCertValueType:"base64"},da=Ps(({samlSettings:V,storedSettings:ye,signRequests:Be,keyCertValueType:Je,keyConfigured:it,certConfigured:bt,setKeyCertValueType:Qt,setSignRequests:un,setKeyConfigured:an,setCertConfigured:Ln,settingsUpdated:$n})=>{const{privateKey:Hn,privateKeyPath:Wn,certificate:es,certificatePath:us,signatureAlgorithm:ps}=V||{},{handleSubmit:ds,control:xs,register:ua,watch:ca,getValues:Ds,setValue:Ws,formState:{errors:er,isDirty:hr}}=(0,te.mN)({mode:"onBlur",defaultValues:{privateKey:Hn||"",privateKeyPath:Wn||"",certificate:es||"",certificatePath:us||"",signatureAlgorithm:ps||"rsa-sha256",keyCertValueType:Je,signRequests:Be||!!Hn||!!Wn||!!es||!!us||!!ps,keyConfigured:!1,certConfigured:!1}}),pa=(0,se.J7)(),[qs,js]=(0,I.useState)(!1),$a=ca("signRequests"),Ia=ca("keyCertValueType"),fr=Ds(),Va=it&&wn("privateKey",fr,ye),Sr=it&&wn("privateKeyPath",fr,ye),Ir=bt&&wn("certificate",fr,ye),rl=bt&&wn("certificatePath",fr,ye),dl=oa=>{if(hr){const{signRequests:wr,keyCertValueType:zi,certConfigured:lu,keyConfigured:Xi,...xp}=oa;wr?($n({...V,...xp}),Qt(zi)):($n({...V,...xp,...fa}),Qt(fa.keyCertValueType)),un(wr)}},uo=()=>{let{...oa}=Ds();return $a||(oa={...oa,...fa}),{...oa,keyConfigured:it,certConfigured:bt}},vo=oa=>()=>{Ws(oa,"",{shouldDirty:!0}),["privateKey","privateKeyPath"].includes(oa)?an(!1):Ln(!1)},Go=oa=>async wr=>{if(wr?.currentTarget?.files?.length){const lu=await wr.currentTarget.files[0].text(),Xi=btoa(lu);Ws(oa,Xi,{shouldDirty:!0})}};function si(oa){const wr="0123456789abcdef",zi=new Uint32Array(oa);crypto.getRandomValues(zi);let lu="";for(let Xi=0;Xi<oa;Xi++)lu+=wr[Math.floor(zi[Xi]/2**32*wr.length)];return lu}const Vi=oa=>{js(!1);const wr=Zo().pki.rsa.generateKeyPair(2048),zi=Zo().pki.privateKeyToAsn1(wr.privateKey),lu=Zo().pki.wrapRsaPrivateKey(zi),Xi=Zo().pki.createCertificate();Xi.publicKey=wr.publicKey,Xi.serialNumber="01"+si(16),Xi.validity.notBefore=new Date,Xi.validity.notAfter=new Date(new Date().getTime()+1e3*60*60*24*oa.validityDays);const xp=[{name:"organizationName",value:oa.organization},{name:"countryName",value:oa.country},{shortName:"ST",value:oa.state},{name:"localityName",value:oa.city}];Xi.setSubject(xp),Xi.setIssuer(xp),Xi.sign(wr.privateKey);const Qm=Zo().pki.certificateToPem(Xi),Ym=Zo().pki.privateKeyInfoToPem(lu);Ws("privateKey",btoa(Ym),{shouldDirty:!0}),Ws("certificate",btoa(Qm),{shouldDirty:!0}),pa.publish({type:H.r1.alertSuccess.name,payload:["The SAML certificate and key have been successfully generated."]})},Lo=(oa,wr,zi)=>wr?!0:Je==="base64"&&zi==="privateKey"&&oa&&!Ma(oa)?"Not valid PEM key":Je==="base64"&&zi==="certificate"&&oa&&!oo(oa)?"Not valid PEM certificate":!0;return(0,a.jsxs)(Rt,{activeStep:Pe.KeyCert,onSubmit:ds(dl),confirmRedirect:hr,getFormData:uo,label:"Sign requests",children:[(0,a.jsx)(_.D,{label:"Sign requests",description:"Sign outgoing requests to IdP",children:(0,a.jsx)(Q.d,{...ua("signRequests"),id:"signRequests"})}),$a&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Signing and encryption key and certificate",htmlFor:"certOptions",description:`Certificate and private key for exchanging information between the Grafana and the IdP.
              The private key needs to be issued in a PKCS#8 format. Certificate should be valid X.509 certificate.`,children:(0,a.jsx)(te.xI,{name:"keyCertValueType",control:xs,render:({field:{ref:oa,...wr}})=>(0,a.jsx)(J.z,{...wr,options:za,id:"certOptions"})})}),Ia==="base64"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Private key",htmlFor:"privateKey",description:"Base64-encoded private key",invalid:!!er.privateKey,error:er.privateKey?.message,children:(0,a.jsx)(te.xI,{name:"privateKey",control:xs,rules:{validate:oa=>Lo(oa,it,"privateKey")},render:({field:{ref:oa,...wr}})=>(0,a.jsx)(Hi,{...wr,id:"privateKey",required:!0,isConfigured:Va,onReset:vo("privateKey"),onFileUpload:Go("privateKey")})})}),(0,a.jsx)(_.D,{label:"Certificate",htmlFor:"certificate",description:"Base64-encoded Grafana X.509 certificate",invalid:!!er.certificate,error:er.certificate?.message,children:(0,a.jsx)(te.xI,{name:"certificate",control:xs,rules:{validate:oa=>Lo(oa,bt,"certificate")},render:({field:{ref:oa,...wr}})=>(0,a.jsx)(Hi,{...wr,id:"certificate",required:!0,isConfigured:Ir,onReset:vo("certificate"),onFileUpload:Go("certificate")})})}),(0,a.jsx)(_.D,{children:(0,a.jsx)(ee.$n,{variant:"secondary",onClick:()=>js(!0),children:"Generate key and certificate"})}),qs&&(0,a.jsx)(Yn,{onClose:()=>js(!1),onGenerateCert:Vi})]}),Ia==="path"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Private key",description:"Path to the Grafana private key",invalid:!!er.privateKey,error:er.privateKey?.message,children:(0,a.jsx)(te.xI,{name:"privateKeyPath",control:xs,render:({field:{ref:oa,...wr}})=>(0,a.jsx)(Pt,{...wr,width:60,id:"privateKeyPath",isConfigured:Sr,onReset:vo("privateKeyPath")})})}),(0,a.jsx)(_.D,{label:"Certificate",description:"Path to the Grafana X.509 certificate",invalid:!!er.certificate,error:er.certificate?.message,children:(0,a.jsx)(te.xI,{name:"certificatePath",control:xs,render:({field:{ref:oa,...wr}})=>(0,a.jsx)(Pt,{...wr,width:60,id:"certificatePath",isConfigured:rl,onReset:vo("certificatePath")})})})]}),(0,a.jsx)(_.D,{label:"Signature algorithm",htmlFor:"signatureAlgorithm",description:"Signature algorithm used for signing requests to the IdP. Must be the same as set-up or required by IdP.",children:(0,a.jsx)(te.xI,{name:"signatureAlgorithm",control:xs,render:({field:{ref:oa,...wr}})=>(0,a.jsx)(J.z,{...wr,options:Pa,id:"signatureAlgorithm"})})})]})]})});function ta(V){const{samlSettings:ye,storedSamlSettings:Be,keyCertValueType:Je,metadataValueType:it,signRequests:bt,keyConfigured:Qt,certConfigured:un}=V.samlConfig;return{samlSettings:ye,storedSamlSettings:Be,keyCertValueType:Je,metadataValueType:it,signRequests:bt,keyConfigured:Qt,certConfigured:un}}const Ba={settingsUpdated:Xs,saveSAMLSettings:yo},co=(0,he.connect)(ta,Ba)(({samlSettings:V,storedSamlSettings:ye,keyCertValueType:Be,metadataValueType:Je,signRequests:it,keyConfigured:bt,certConfigured:Qt,settingsUpdated:un,saveSAMLSettings:an})=>{const{handleSubmit:Ln,getValues:$n,formState:{isDirty:Hn}}=(0,te.mN)(),Wn=({enabled:us})=>{Hn&&un({...V,enabled:us})},es=async()=>{let us={...V,keyCertValueType:Be,keyConfigured:bt,certConfigured:Qt,signRequests:it,metadataValueType:Je,enabled:!0};an(us,ye),(0,l.rR)("authentication_saml_saved"),gr()};return(0,a.jsx)(Rt,{activeStep:Pe.SaveAndTest,onSubmit:Ln(Wn),confirmRedirect:Hn,getFormData:$n,label:"Test and enable",children:(0,a.jsxs)(ne.B,{direction:"column",alignItems:"flex-start",gap:2,children:[(0,a.jsx)(ge.E,{children:"If you are ready to apply your SAML configuration use the \u201CSave and enable\u201D button. You will be able to disable the configuration."}),(0,a.jsx)(ee.$n,{variant:"primary",onClick:es,children:"Save and enable"})]})})});function Mo(){const V={id:"saml",type:"SAML",protocol:"SAML 2.0",displayName:"SAML",configPath:"saml/general"};(0,qe.registerAuthProvider)(V,No)}async function No(){if(r.contextSrv.hasPermission(d.AccessControlAction.SettingsRead)){const[V,ye]=await To(),Be=ln(ye),Je=Object.keys(V).length===0||Object.keys(ye).length===0;return Be?{configured:!1,enabled:!1,hide:Je}:{configured:!0,enabled:!!V.enabled,name:V.name,hide:Je}}return{configured:!1,enabled:!1}}const ro=[{id:Pe.General,name:"General settings",component:_i},{id:Pe.KeyCert,name:"Sign requests",component:da},{id:Pe.ConnectToIdP,name:"Connect Grafana with Identity Provider",component:xo},{id:Pe.AssertionMapping,name:"User mapping",component:aa},{id:Pe.SaveAndTest,name:"Test and enable",component:co}];var ki=e(31906);function Hl(V,ye){const{isLoading:Be,samlSettings:Je}=V.samlConfig,{step:it}=ye.match.params;return{isLoading:Be,samlSettings:Je,activeStep:it}}const Gi={loadSAMLSettings:po},bi=(0,he.connect)(Hl,Gi),Ui={text:"Setup SAML single sign on",subTitle:`This guided application will guide you through the configuration
  process of SAML. You will need to follow steps and visit your Identity
  Provider's application to connect it with Grafana (The Service provider).
  This guided application will help you keep track of your progress.`,icon:"shield",id:"SAML"},ul=bi(({isLoading:V,samlSettings:ye,activeStep:Be,loadSAMLSettings:Je})=>{(0,I.useEffect)(()=>{Je()},[Je]);const it=(0,I.useCallback)(()=>{const bt=ro.find(({id:Qt})=>Qt===Be)?.component;return bt?(0,a.jsx)(bt,{}):null},[Be]);return(0,a.jsx)(G.Y,{navId:"authentication",pageNav:Ui,children:(0,a.jsx)(G.Y.Contents,{children:V||(0,Dn.isEmpty)(ye)?(0,a.jsx)(ki.a,{}):it()})})});var hl=e(76888),lc=e(65463);class fl extends lc.x{static{this.type="page-banner-display"}}var ol=(V=>(V[V.info=0]="info",V[V.warning=1]="warning",V[V.error=2]="error",V))(ol||{});function Sl(){const[V,ye]=(0,I.useState)(),Be=Tl(V?.severity),Je=(0,D.of)(an=>kl(an,Be)),{chrome:it}=(0,hl.Il)(),bt=it.useState();(0,I.useEffect)(function(){const an=r.lE.subscribe(fl,Ln=>{bt.chromeless||ye(Ln.payload)});return function(){an.unsubscribe()}},[bt.chromeless]);const Qt=(0,I.useCallback)(()=>{ye(void 0),V?.onClose&&V.onClose()},[V]);if(!V)return null;const un=V.body;return(0,a.jsxs)("div",{className:Je.banner,children:[(0,a.jsx)("div",{className:Je.icon,children:(0,a.jsx)(u.I,{size:"xl",name:Be.icon})}),(0,a.jsx)("div",{className:Je.content,children:(0,a.jsx)(un,{severity:V.severity??ol.info})}),V?.onClose&&(0,a.jsx)("div",{className:Je.icon,children:(0,a.jsx)(Qn.K,{size:"xl",name:"times",onClick:Qt,className:Je.close,"aria-label":"Close banner",tooltip:"Close"})})]})}function Tl(V){const ye=(0,D.$j)();return(0,I.useMemo)(()=>{switch(V){case ol.error:return{icon:"exclamation-circle",background:ye.colors.error.main,text:ye.colors.error.contrastText};case ol.warning:return{icon:"exclamation-triangle",background:ye.colors.warning.main,text:ye.colors.warning.contrastText};case ol.info:default:return{icon:"info-circle",background:ye.colors.info.main,text:ye.colors.info.contrastText}}},[ye,V])}function kl(V,ye){return{banner:(0,y.css)`
      flex-grow: 0;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      background-color: ${ye.background};
      border-radius: 2px;
      height: 52px;
    `,icon:(0,y.css)`
      padding: ${V.spacing(0,2)};
      color: ${ye.text};
      display: flex;
    `,content:(0,y.css)`
      flex-grow: 1;
      display: flex;
      align-items: center;
      color: ${ye.text};
    `,close:(0,y.css)`
      color: ${ye.text};
    `}}function Ml(){(0,E.Pl)(Sl)}var fi=e(17422),gl=e(74984),$e=e(77454),Ye=e(35538),rt=e(34258),xt=e(7521);const Kt=V=>{const{enableDataSourceCache:ye,dataSource:Be,pageId:Je}=V,it=r.contextSrv.hasPermissionInMetadata(fe.DataSourcesCachingWrite,Be);return Be.jsonData?.disableGrafanaCache?(0,a.jsx)(xt.A,{title:"Caching cannot be enabled for this data source.",buttonTitle:"Enable",buttonIcon:"database",proTip:"This data source's configuration does not permit caching to be enabled.",buttonDisabled:!0}):(0,a.jsx)(xt.A,{title:"Caching is not enabled for this data source.",buttonTitle:"Enable",buttonIcon:"database",onClick:()=>{ye(Je)},proTip:"Enabling caching can reduce the amount of redundant requests sent to the data source.",proTipLink:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",proTipLinkTitle:"Learn more",buttonDisabled:!it})},en=V=>{const{cleanCache:ye,dataSource:Be,pageId:Je}=V,[it,bt]=(0,I.useState)(!1),Qt=Ln=>()=>{bt(Ln)},un=()=>{ye(Je),bt(!1)},an=r.contextSrv.hasPermissionInMetadata(fe.DataSourcesCachingWrite,Be);return(0,a.jsxs)("div",{children:[(0,a.jsx)(ee.$n,{variant:"destructive",onClick:Qt(!0),disabled:!an,children:"Clear cache"}),(0,a.jsx)(fs.u,{isOpen:it,title:"Clear cache",body:"Warning: This action impacts all cache-enabled data sources. If you are using Memcached, the system clears all data from the Memcached instance. Do you want to continue?",confirmText:"Clear cache",onConfirm:un,onDismiss:Qt(!1)})]})};var mn=e(60029);const jn=V=>{const{disableDataSourceCache:ye,dataSource:Be,pageId:Je}=V,it=r.contextSrv.hasPermissionInMetadata(fe.DataSourcesCachingWrite,Be);return(0,a.jsx)(ee.$n,{variant:"destructive",onClick:()=>ye(Je),disabled:!it,children:"Disable"})},Vn=V=>{const{updateDataSourceCache:ye,pageId:Be,useDefaultTTL:Je,setUseDefaultTTL:it,defaultTTLMs:bt,ttlQueriesMs:Qt,setTtlQueriesMs:un,ttlResourcesMs:an,setTtlResourcesMs:Ln,loading:$n,enabled:Hn,dataSource:Wn,dataSourceID:es,dataSourceUID:us}=V,ps=r.contextSrv.hasPermissionInMetadata(fe.DataSourcesCachingWrite,Wn);return(0,a.jsxs)(ne.B,{direction:"column",alignItems:"flex-start",children:[(0,a.jsx)(_.D,{description:`Enable this to use the default TTL set in Grafana's configuration (${bt} ms)`,label:"Use default TTL",disabled:$n||!ps,children:(0,a.jsx)(Q.d,{value:Je,onChange:()=>{it(!Je)}})}),(0,a.jsx)(_.D,{description:"The time-to-live for a query cache item in milliseconds. Example: 5000",label:"Query TTL",disabled:$n||Je||!ps,children:(0,a.jsx)(De.p,{type:"number",className:"max-width-10",placeholder:"1000",min:0,value:(Je?bt:Qt)||0,onChange:ds=>{un(ds.currentTarget.valueAsNumber)}})}),(0,a.jsx)(_.D,{description:"The time-to-live for resources cache items in milliseconds. Example: 5000",label:(0,a.jsxs)(mn.J,{children:[(0,a.jsx)("span",{children:"Resource TTL"}),(0,a.jsx)(be.m,{content:(0,a.jsxs)("div",{children:["Resources are dynamic values that Grafana data source plugins retrieve from data sources for use in the query editor. Examples are Splunk namespaces, Prometheus labels, and CloudWatch metric names. Since these values update less frequently, you might prefer a longer cache TTL for Resources than queries. See the ",(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",children:"docs"})," ","for more info."]}),children:(0,a.jsx)(u.I,{name:"question-circle"})})]}),disabled:$n||Je||!ps,children:(0,a.jsx)(De.p,{type:"number",className:"max-width-10",placeholder:"1000",min:0,value:(Je?bt:an)||0,onChange:ds=>{Ln(ds.currentTarget.valueAsNumber)}})}),(0,a.jsxs)(ne.B,{gap:2,alignItems:"flex-start",justifyContent:"flex-start",children:[(0,a.jsx)(jn,{...V}),(0,a.jsx)(ee.$n,{disabled:$n||!ps,onClick:()=>ye(Be,{dataSourceID:es,dataSourceUID:us,enabled:Hn,defaultTTLMs:bt,ttlQueriesMs:Qt,ttlResourcesMs:an,useDefaultTTL:Je}),children:"Save"})]})]})};var qn=e(27677),Us=(V=>(V.LoadDataSourceCache="LOAD_DATA_SOURCE_CACHE",V))(Us||{});const Is=V=>({type:"LOAD_DATA_SOURCE_CACHE",payload:V});function $s(V){return async ye=>{const Be=await(0,qn.AI)().post(`/api/datasources/${V}/cache/enable`,{});ye(Is(Be))}}function Vs(V){return async ye=>{const Be=await(0,qn.AI)().post(`/api/datasources/${V}/cache/disable`,{});ye(Is(Be))}}function Ra(V,ye){return async Be=>{const Je=await(0,qn.AI)().post(`/api/datasources/${V}/cache`,ye);Be(Is(Je))}}function ga(V){return async ye=>{const Be=await(0,qn.AI)().get(`/api/datasources/${V}/cache`);ye(Is(Be))}}function Js(V){return async ye=>{const Be=await(0,qn.AI)().post(`/api/datasources/${V}/cache/clean`,{});ye(Is(Be))}}function ia(V,ye){return{...V.dataSourceCache,pageId:ye.uid,dataSource:V.dataSources.dataSource}}const Fa={disableDataSourceCache:Vs,updateDataSourceCache:Ra,enableDataSourceCache:$s,loadDataSourceCache:ga,loadDataSource:rt.ak,cleanCache:Js,loadDataSourceMeta:rt.xI},Ya=(0,he.connect)(ia,Fa),ma=V=>{const[ye,Be]=(0,I.useState)(V.enabled),[Je,it]=(0,I.useState)(!0),[bt,Qt]=(0,I.useState)(V.useDefaultTTL),[un,an]=(0,I.useState)(V.ttlQueriesMs),[Ln,$n]=(0,I.useState)(V.ttlResourcesMs),{pageId:Hn,dataSource:Wn,loadDataSource:es,loadDataSourceCache:us,loadDataSourceMeta:ps,enableDataSourceCache:ds}=V;(0,I.useEffect)(()=>{Be(Wn.jsonData?.disableGrafanaCache?!1:V.enabled),Qt(V.useDefaultTTL),an(V.ttlQueriesMs),$n(V.ttlResourcesMs),it(!1)},[V.useDefaultTTL,V.ttlQueriesMs,V.ttlResourcesMs,V.enabled,Wn.jsonData?.disableGrafanaCache]),(0,I.useEffect)(()=>{es(Hn).then(ps),us(Hn)},[us,es,ps,Hn]);const xs=r.contextSrv.hasPermissionInMetadata(fe.DataSourcesCachingWrite,Wn),ua=ye?Vn({...V,loading:Je,useDefaultTTL:bt,setUseDefaultTTL:Qt,ttlQueriesMs:un,setTtlQueriesMs:an,ttlResourcesMs:Ln,setTtlResourcesMs:$n}):(0,Ye.z5)()?(0,a.jsx)(Wa,{action:xs?{text:"Enable caching",onClick:()=>{ds(Hn)}}:void 0}):Kt(V);return(0,a.jsxs)(a.Fragment,{children:[(0,Ye.z5)()&&(0,a.jsx)($e.Iz,{featureId:"query-caching",eventVariant:"trial",featureName:"query caching",text:"Enable query caching for free during your trial of Grafana Pro."}),(0,a.jsxs)("div",{className:"page-action-bar",children:[ye&&!(0,Ye.z5)()&&(0,a.jsx)("h3",{className:"page-sub-heading",children:"Caching"}),(0,a.jsx)("div",{className:"page-action-bar__spacer"}),(0,a.jsx)(ne.B,{gap:2,alignItems:"flex-end",justifyContent:"flex-end",children:ye&&(0,a.jsx)(en,{...V})})]}),ua]})},Wa=({action:V})=>{const ye=(0,D.$j)();return(0,a.jsx)($e.El,{action:V,listItems:["Load dashboards in less than a second from the cache, even when they include big queries and lots of users are looking at once","Save money and avoid rate limiting by reducing the number of API calls you make to data sources like Splunk, CloudWatch and Github","Author dashboards more smoothly by caching the data used to construct queries, like fields in ServiceNow or metrics available from Datadog"],image:`query-caching-${ye.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/query-caching",featureName:"query caching",description:"With query caching, you can load dashboards faster and reduce costly queries to data sources by temporarily storing query results in memory, Redis, or Memcached."})},Tr=Ya(ma),Jr=()=>{const{uid:V}=(0,xe.g)(),ye=(0,gl.$m)("cache"),Be=(0,d.useSelector)(it=>it.navIndex),Je=(0,fi.tc)(Be,`datasource-cache-${V}`,ye);return(0,a.jsx)(G.Y,{navId:"datasources",pageNav:Je.main,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Tr,{uid:V})})})};var _r=e(85464);const Mr=({uid:V})=>((0,_r.oU)(V),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($e.Iz,{featureName:"query caching",featureId:"query-caching"}),(0,a.jsx)(Wa,{})]})),Ka=()=>{const{uid:V}=(0,xe.g)(),ye=(0,_r.$m)("cache"),Be=(0,d.useSelector)(it=>it.navIndex),Je=(0,fi.tc)(Be,`datasource-cache-${V}`,ye);return(0,a.jsx)(G.Y,{navId:"datasources",pageNav:Je.main,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Mr,{uid:V})})})},Vo={enabled:!1,dataSourceID:0,dataSourceUID:"",ttlQueriesMs:0,ttlResourcesMs:0,defaultTTLMs:0,useDefaultTTL:!0},to={dataSourceCache:(V=Vo,ye)=>{switch(ye.type){case Us.LoadDataSourceCache:return{...ye.payload}}return V}};var Ao=e(31152);const Oi=()=>{const{uid:V}=(0,xe.g)(),{navId:ye,pageNav:Be}=(0,Ao.n)("cache");return(0,a.jsx)(G.Y,{navId:ye,pageNav:Be,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Tr,{uid:V})})})},zo=()=>{const{uid:V}=(0,xe.g)(),{navId:ye,pageNav:Be}=(0,Ao.n)("cache");return(0,a.jsx)(G.Y,{navId:ye,pageNav:Be,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Mr,{uid:V})})})};var ti=e(70713),br=e(11261),As=e(39070),ya=e(24308),ws=e(52622),Da=e(91052),jr=e(37166);const Zr="YYYY-MM-DD",nt=async(V,ye)=>await(0,S.AI)().get(`/api/usage/dashboard/${V}/views/recent?limit=${ye}`,{retry:0}),Le=async(V,ye)=>await(0,S.AI)().get(`/api/usage/dashboard/${V}/views?limit=${ye}`),et=V=>{const ye=[];for(let Be in V)ye.push(V[Be]);return ye.sort((Be,Je)=>(0,h.KQ)(Be.day,Zr).valueOf()-(0,h.KQ)(Je.day,Zr).valueOf()),ye},mt=async(V,ye)=>{const Be=await(0,S.AI)().get(`/api/usage/dashboard/${V}/daily`,{days:ye});return et(Be)},kt=async(V,ye)=>{const Be=await(0,S.AI)().get(`/api/usage/dashboard/${V}/public/daily`,{days:ye});return et(Be)},yn=async(V,ye,Be)=>{const Je=await(0,S.AI)().get(`/api/usage/datasource/${V}/daily`,{from:ye,to:Be});return et(Je)},fn=async V=>await(0,S.AI)().get(`/api/usage/dashboard/${V}/info`);var Cn=e(3911);const as=(0,Cn.N)(V=>{const ye=V.colors.background.secondary;return{tabContent:(0,y.css)`
      height: 100%;
    `,tabsBar:(0,y.css)`
      padding-left: ${V.spacing(2)};
      margin: ${V.spacing(3,-1,-3,-3)};
    `,graphContainer:(0,y.css)`
      margin-top: ${V.spacing(2)};
      background-color: ${ye};
    `,panelContent:(0,y.css)`
      contain: none;
    `,userBoxesContainer:(0,y.css)`
      display: flex;
      margin-top: ${V.spacing(3)};

      > div + div {
        margin-left: ${V.spacing(2)};
      }
    `,userBox:(0,y.css)`
      padding: ${V.spacing(2)};
      flex: 1;
      text-align: center;
      background-color: ${ye};
      border-radius: 3px;

      button,
      img {
        margin: ${V.spacing(0,0,1,0)};
      }
    `,userName:(0,y.css)`
      font-weight: ${V.typography.fontWeightBold};
    `,tableContainer:(0,y.css)`
      margin-top: ${V.spacing(3)};
      background-color: ${ye};
      padding-bottom: ${V.spacing(1)};
      border-radius: 3px;

      [role='cell']:first-child > div {
        padding: 4px;
      }
      [role='columnheader']:first-child {
        height: 33px;
      }
      [role='row']:not(:only-child):nth-child(odd) {
        background-color: ${V.colors.background.primary};
      }
    `,tableHeader:(0,y.css)`
      padding: ${V.spacing(0,2,.5,2)};
      display: flex;
      justify-content: space-between;
      align-items: center;

      h4 {
        margin-bottom: 0px;
        padding: ${V.spacing(3,0)};
      }
    `,userIcon:(0,y.css)`
      margin: 0 0;
      width: 26px;
      height: 26px;
      line-height: 20px;

      & > * {
        width: 26px;
        height: 26px;
        line-height: 20px;
      }
    `}}),ts=(V,ye)=>({dataSourceUid:ye.uid}),_s={loadDataSource:rt.ak,loadDataSourceMeta:rt.xI},Fs=(0,he.connect)(ts,_s);class Ha extends I.PureComponent{constructor(ye){super(ye),this.state={dailySummaries:[],from:"",to:""}}async componentDidMount(){const{dataSourceUid:ye,loadDataSource:Be,loadDataSourceMeta:Je}=this.props;if(Be(ye).then(Je),(0,n.a)("analytics")){let it=(0,h.KQ)().subtract(30,"days").format(Zr),bt=(0,h.KQ)().format(Zr);const Qt=await yn(ye,it,bt);this.setState({dailySummaries:Qt,from:it,to:bt})}}buildTimeRange(){const{from:ye,to:Be}=this.state,Je=(0,h.KQ)(ye),it=(0,h.KQ)(Be).add(24,"hours");return{from:Je,to:it,raw:{from:ye,to:Be}}}convertDailySummariesToDataFrame(ye,Be,Je){const it=[],bt=[];return ye.forEach(Qt=>{it.push((0,h.KQ)(Qt.day,Zr).valueOf());let un=Qt[Be];Be==="loadDuration"&&(un=Qt.queries?Qt.loadDuration/(Qt.queries*1e6):0),bt.push(un)}),{name:Be,fields:[{name:"Time",type:br.PU.time,config:{},values:it},{name:Be,type:Je,config:{},values:bt}],length:ye.length}}renderChart(ye,Be){const{dailySummaries:Je}=this.state,{color:it,fieldType:bt,showBars:Qt,timeRange:un,title:an,valueField:Ln,width:$n}=ye,Wn={series:[this.convertDailySummariesToDataFrame(Je,Ln,bt)],state:As.Gu.Done,timeRange:un},es={legend:{showLegend:!1,displayMode:ws.lm.Hidden,calcs:[],placement:"bottom"},tooltip:{mode:ws.$N.Multi,sort:ws.xB.Descending}},us={defaults:{color:{mode:"fixed",fixedColor:it},custom:{showPoints:ws.yL.Never,drawStyle:Qt?ws.GR.Bars:ws.GR.Line,fillOpacity:Qt?50:0}},overrides:[]};return(0,a.jsx)("div",{className:Be.graphContainer,children:(0,a.jsx)(Da.NR,{title:an,width:$n,height:220,displayMode:"transparent",loadingState:Wn.state,children:(ps,ds)=>(0,a.jsx)(ya.m,{title:an,width:ps,height:ds,pluginId:"timeseries",data:Wn,fieldConfig:us,options:es})})})}renderContent(){const{theme:ye}=this.props,Be=as(ye),{dailySummaries:Je}=this.state,it=this.buildTimeRange();return Je?.length>0?(0,a.jsx)(ti.Ay,{disableHeight:!0,children:({width:bt})=>{const Qt=[{title:"Queries last 30 days",valueField:"queries",fieldType:br.PU.number,width:bt,timeRange:it,color:"green",showBars:!0,showLines:!1},{title:"Errors last 30 days",valueField:"errors",fieldType:br.PU.number,width:bt,timeRange:it,color:ye.colors.error.border,showBars:!0,showLines:!1},{title:"Average load duration last 30 days (ms)",valueField:"loadDuration",fieldType:br.PU.number,width:bt,timeRange:it,color:ye.colors.primary.border,showBars:!0,showLines:!1}];return(0,a.jsx)("main",{style:{width:bt},children:Qt.map(un=>this.renderChart(un,Be))})}}):(0,a.jsx)("span",{children:"No available data for this data source."})}render(){return(0,n.a)("analytics.writers")&&!(0,n.a)("analytics")?(0,a.jsx)(jr.w,{title:"Feature not available with an expired license",url:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",urlTitle:"Read more on license expiration",children:(0,a.jsx)("span",{children:"Data source insights are not available with an expired license. Data will continue to be collected but you need to update your license to see this page."})}):(0,a.jsxs)(a.Fragment,{children:[(0,Ye.z5)()&&(0,a.jsx)($e.Iz,{featureId:"data-source-insights",eventVariant:"trial",featureName:"data source usage insights",text:"Enable data source usage insights for free during your trial of Grafana Pro."}),this.renderContent()]})}}const Zs=Fs((0,D.cV)(Ha)),Pr=()=>{const{uid:V}=(0,xe.g)(),{navId:ye,pageNav:Be}=(0,Ao.n)("insights");return(0,a.jsx)(G.Y,{navId:ye,pageNav:Be,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Zs,{uid:V})})})},Or=({uid:V})=>{(0,_r.oU)(V);const ye=(0,D.$j)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($e.Iz,{featureName:"data source usage insights",featureId:"data-source-insights"}),(0,a.jsx)($e.El,{listItems:["Demonstrate and improve the value of your observability service by keeping track of user engagement","Keep Grafana performant by identifying and fixing slow, error-prone data sources","Clean up your instance by finding and removing unused data sources","Review individual data source usage insights at a glance in the UI, sort search results by usage and errors, or dig into detailed usage logs"],image:`datasource-insights-${ye.isLight?"light":"dark"}.png`,featureName:"data source usage insights",description:"Usage Insights provide detailed information about data source usage, like the number of views, queries, and errors users have experienced. You can use this to improve users\u2019 experience and troubleshoot issues",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/usage-insights/dashboard-datasource-insights"})]})},nr=()=>{const{uid:V}=(0,xe.g)(),{navId:ye,pageNav:Be}=(0,Ao.n)("insights");return(0,a.jsx)(G.Y,{navId:ye,pageNav:Be,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Or,{uid:V})})})};var Xa=e(52487),mr=e(91062),no=e(87455),ir=e(25469),Br=e(98742);const il=["loki"],Gl="X-Prom-Label-Policy";function yd(V){return!!V.basicAuth&&il.includes(V.type)}function Ro(V){const Be=/\{([^{}]*)\}/.exec(V);return Be&&Be.length>1?Be[1].trim():""}function pl(V){const Be=/\{{0,1}([^\{\}]*)\}{0,1}/.exec(V);return Be&&Be.length>1?`{ ${Be[1].trim()} }`:""}function cu(V){const Be=/\w+\:\{{0,1}([^\{\}]*)\}{0,1}/.exec(V);return Be&&Be.length>1?Be[1].trim():""}const ml=V=>V?/^{*\s*(?:\s*\w+\s*(?:=|!=|=~|!~)\s*\"[^\"]+\"\s*,*)+\s*}*$/.test(V.trim()):!1,Nh=V=>{const ye=[];return V.length&&V.forEach(Be=>{Number(Be.teamId)&&ye.push(Number(Be.teamId))}),ye},Qi=(V,ye)=>{const Be=(0,de.t)("access-control.permissions.lbac-warning-service-account","Warning: This service account has full data access with no Team LBAC rules applied."),Je=(0,de.t)("access-control.permissions.lbac-warning-team","Warning: This team has full data access with no Team LBAC rules applied.");return ye.map(it=>{if(it.builtInRole&&it.permission!=="Admin"){const bt=(0,de.t)("access-control.permissions.lbac-warning-basic-role",`Warning: ${it.builtInRole} may have full data access with no Team LBAC rules applied.`);it.warning=bt}else it.isServiceAccount&&it.userId?it.warning=Be:it.teamId&&!V.includes(it.teamId)&&(it.warning=Je);return{...it}})},du=(V,ye)=>{const Be=t("access-control.permissions.lbac-warning-rule","Warning: This team might not have permission to the query the datasource.");return ye.map(Je=>(Je.teamId&&!V.includes(Number(Je.teamId))&&(Je.warning=Be),{...Je}))},wh=({onSubmit:V,onClose:ye})=>{const Be=(0,D.of)(Fh),{handleSubmit:Je,register:it,control:bt,formState:{errors:Qt}}=(0,te.mN)({});return(0,a.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,a.jsx)(ir.J,{onClick:ye}),(0,a.jsx)("h5",{children:"Create LBAC Rule"}),(0,a.jsx)("form",{name:"addTeamLBAC",onSubmit:Je(V),children:(0,a.jsxs)(ne.B,{gap:1,direction:"row",children:[(0,a.jsx)(_.D,{label:"Team",children:(0,a.jsx)(te.xI,{render:({field:{onChange:un,ref:an,...Ln}})=>(0,a.jsx)(Br.e,{...Ln,onSelected:$n=>un($n.value?.id)}),control:bt,name:"team",rules:{required:{value:!0,message:"Required"}}})}),(0,a.jsx)(_.D,{label:"Rule",invalid:!!Qt.rule,error:Qt?.rule?.message,children:(0,a.jsx)(De.p,{className:Be.input,type:"text",placeholder:'{label="foo", label2="bar"}',...it("rule",{required:"Rule is required",validate:un=>ml(un)||"Invalid LBAC rule syntax"}),width:30,invalid:!!Qt.rule})}),(0,a.jsx)(_.D,{label:"",children:(0,a.jsx)(ee.$n,{type:"submit",children:(0,a.jsx)(de.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})})]})})]})},Fh=V=>({input:(0,y.css)({"& input":{fontFamily:V.typography.fontFamilyMonospace}})});var oi=e(91605),Wh=e(92762),Kh=e(71713);const Rc=({isEditing:V,value:ye,disabled:Be,error:Je,onChange:it})=>{const[bt,Qt]=(0,I.useState)(Ro(ye)),un=(0,D.$j)(),an=(0,D.of)($h);return(0,I.useEffect)(()=>{V||Qt(Ro(ye))},[V,ye]),(0,a.jsx)("div",{className:an.wrapper,children:V?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(De.p,{className:an.input,value:bt,onChange:Ln=>{const $n=Ln.currentTarget.value;Qt($n),it&&it(`{ ${$n} }`)},invalid:!!Je,suffix:Je&&(0,a.jsx)(be.m,{content:Je,children:(0,a.jsx)(u.I,{name:"exclamation-triangle"})})})}):(0,a.jsx)("span",{style:{color:Be?un.colors.text.disabled:"unset"},children:(0,a.jsx)(Wh.Z,{query:ye,language:{grammar:Kh.Ay,name:"logql"}})})})},$h=V=>({wrapper:(0,y.css)({padding:V.spacing(0,1)}),input:(0,y.css)({"& input":{fontFamily:V.typography.fontFamilyMonospace}})});var Lc=e(12942);const Vh=({team:V,disabled:ye,warning:Be})=>{const Je=(0,D.of)(zh);return V?!V.name&&!V.avatarUrl?(0,a.jsxs)("span",{className:Je.notFound,children:["Team with id ",V.id," not found"]}):(0,a.jsxs)("div",{className:Je.wrapper,children:[V.avatarUrl&&(0,a.jsx)(Lc.e,{src:V.avatarUrl,alt:""}),(0,a.jsx)("span",{className:(0,y.cx)(Je.label,{[Je.disabled]:ye}),children:V.name}),Be&&(0,a.jsx)(be.m,{content:(0,a.jsx)(P.a,{children:Be}),children:(0,a.jsx)(u.I,{name:"exclamation-triangle",className:Je.warning})})]}):(0,a.jsx)(a.Fragment,{})},zh=V=>({wrapper:(0,y.css)({display:"flex",alignItems:"center"}),label:(0,y.css)({overflow:"hidden",marginLeft:V.spacing(2),marginRight:V.spacing(2)}),avatar:(0,y.css)({width:"24px",height:"24px"}),notFound:(0,y.css)({color:V.colors.text.secondary}),disabled:(0,y.css)({color:V.colors.text.disabled}),warning:(0,y.css)({color:V.colors.warning.main})}),_h=({teamRules:V,team:ye,disabled:Be,onChange:Je,warning:it})=>{const[bt,Qt]=(0,I.useState)({}),[un,an]=(0,I.useState)({}),[Ln,$n]=(0,I.useState)(V),[Hn,Wn]=(0,I.useState)({}),es=(0,D.of)(Hh);if((0,I.useEffect)(()=>{$n(V)},[V]),!V?.length)return null;const us=(Ds,Ws)=>{an({...un,[Ds]:Ws?Ln[Ds]:void 0}),Qt({...bt,[Ds]:Ws})},ps=(Ds,Ws)=>{an({...un,[Ds]:Ws})},ds=Ds=>{const Ws=un[Ds];if(Ws){if(!ml(Ws)){Wn({...Hn,[Ds]:"Invalid LBAC rule syntax"});return}const er=Ln.map((hr,pa)=>pa===Ds&&Ws?Ws:hr);Je(er),Qt({...bt,[Ds]:!1})}},xs=Ds=>{const Ws=Ln.slice(0,Ds).concat(Ln.slice(Ds+1));Je(Ws)},ua=()=>{Qt({...bt,[Ln.length]:!0}),$n(Ln.concat(""))},ca=Ds=>{us(Ds,!1),Ds===Ln.length-1&&!Ln[Ds]&&$n(Ln.slice(0,-1))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("tr",{role:"row",children:[(0,a.jsx)("td",{children:(0,a.jsx)(Vh,{team:ye,warning:it})}),(0,a.jsx)("td",{}),(0,a.jsx)("td",{children:(0,a.jsx)(Rc,{value:Ln[0],isEditing:bt[0],error:Hn[0],onChange:Ds=>ps(0,Ds)})}),(0,a.jsx)("td",{children:Be?(0,a.jsx)("div",{className:es.buttonsCell,children:(0,a.jsx)(ee.$n,{tooltip:"Provisioned rule",size:"sm",icon:"lock"})}):(0,a.jsxs)("div",{className:es.buttonsCell,children:[Ln?.length===1&&!bt[0]&&(0,a.jsx)("div",{className:es.buttonRight,children:(0,a.jsx)(Qn.K,{name:"plus-circle",tooltip:"Add new rule","aria-label":"add team rule",onClick:()=>ua()})}),bt[0]?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:es.editButton,children:(0,a.jsx)(ee.$n,{size:"sm",variant:"primary",onClick:()=>ds(0),children:"Save"})}),(0,a.jsx)("div",{className:es.editButton,children:(0,a.jsx)(ee.$n,{size:"sm",variant:"secondary",onClick:()=>ca(0),children:"Cancel"})})]}):(0,a.jsx)("div",{className:es.editButton,children:(0,a.jsx)(Qn.K,{name:"pen","aria-label":"edit team rule",onClick:()=>us(0,!0)})}),(0,a.jsx)("div",{className:es.buttonRight,children:(0,a.jsx)(oi.e,{"aria-label":"Delete rule",size:"sm",onConfirm:()=>xs(0)})})]})})]},`${ye.id}-0`),Ln.length>1&&Ln.slice(1).map((Ds,Ws)=>(0,a.jsxs)("tr",{role:"row",children:[(0,a.jsx)("td",{}),(0,a.jsx)("td",{className:es.ruleOr,children:"OR"}),(0,a.jsx)("td",{children:(0,a.jsx)(Rc,{value:Ds,isEditing:bt[Ws+1],error:Hn[Ws+1],onChange:er=>ps(Ws+1,er)})}),(0,a.jsx)("td",{children:Be?(0,a.jsx)("div",{className:es.buttonsCell,children:(0,a.jsx)(ee.$n,{tooltip:"Provisioned rule",size:"sm",icon:"lock"})}):(0,a.jsxs)("div",{className:es.buttonsCell,children:[Ws===Ln?.length-2&&!bt[Ws+1]&&(0,a.jsx)("div",{className:es.buttonRight,children:(0,a.jsx)(Qn.K,{name:"plus-circle",tooltip:"Add new rule","aria-label":"add team rule",onClick:()=>ua()})}),bt[Ws+1]?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:es.editButton,children:(0,a.jsx)(ee.$n,{size:"sm",variant:"primary",onClick:()=>ds(Ws+1),children:"Save"})}),(0,a.jsx)("div",{className:es.editButton,children:(0,a.jsx)(ee.$n,{size:"sm",variant:"secondary",onClick:()=>ca(Ws+1),children:"Cancel"})})]}):(0,a.jsx)("div",{className:es.editButton,children:(0,a.jsx)(Qn.K,{name:"pen","aria-label":"edit team rule",onClick:()=>us(Ws+1,!0)})}),(0,a.jsx)("div",{className:es.buttonRight,children:(0,a.jsx)(oi.e,{"aria-label":"Delete rule",size:"sm",onConfirm:()=>xs(Ws+1)})})]})})]},`${ye.id}-${Ws+1}`))]})},Hh=V=>({editButton:(0,y.css)({display:"flex",alignItems:"center",marginLeft:V.spacing(2)}),buttonRight:(0,y.css)({display:"flex",alignItems:"center",marginLeft:V.spacing(2),marginRight:V.spacing(.5)}),buttonsCell:(0,y.css)({display:"flex",justifyContent:"end",alignItems:"center"}),ruleOr:(0,y.css)({color:V.colors.text.secondary})}),kh={teamLBACConfig:{rules:[]}},xd=(0,Ks.Z0)({name:"teamLBAC",initialState:kh,reducers:{teamLBACLoaded:(V,ye)=>({...V,teamLBACConfig:ye.payload})}}),{teamLBACLoaded:uu}=xd.actions,Gh={teamLBAC:xd.reducer};function cc(V){return async ye=>{const Be=await(0,S.AI)().get(`api/datasources/uid/${V}/lbac/teams`);ye(uu(Be))}}function Qh(V,ye){return async Be=>{await(0,S.AI)().put(`api/datasources/uid/${V}/lbac/teams`,{...ye}),Be(cc(V))}}function Yh(V){return{teamLBACConfig:V.teamLBAC?.teamLBACConfig}}const Jh={getTeamLBAC:cc,updateTeamLBACRules:Qh},Zh=(0,he.connect)(Yh,Jh),Xh=({teamLBACConfig:V,dataSourceConfig:ye,readOnly:Be,onTeamLBACUpdate:Je,getTeamLBAC:it,updateTeamLBACRules:bt,items:Qt})=>{const[un,an]=(0,I.useState)([]),[Ln,$n]=(0,I.useState)(!1),[Hn,Wn]=(0,I.useState)(new Set),[es,us]=(0,I.useState)(new Set),[ps,ds]=(0,I.useState)(new Set),[xs,ua]=(0,I.useState)(new Set),ca=(0,I.useMemo)(()=>V?.rules||[],[V?.rules]),Ds=(0,D.of)(qh);(0,I.useEffect)(()=>{it(ye.uid)},[ye.uid,it]),(0,I.useEffect)(()=>{(async()=>{const $a=ca.map(Sr=>Sr.teamId);if(!$a?.length)return;const Va=((await(0,S.AI)().get("/api/teams/search",{teamId:$a}))?.teams).map(Sr=>({id:Sr.id,value:Sr.id,teamId:Sr.id,name:Sr.name,avatarUrl:Sr.avatarUrl}));an(Va)})()},[ca]),(0,I.useEffect)(()=>{if(!Qt?.length)return;const js=new Set(ca.map(Ir=>Ir.teamId)),$a=new Set(Qt.map(Ir=>Ir.teamId)),Ia=new Set(Qt.filter(Ir=>Ir.isServiceAccount).map(Ir=>Ir.id)),fr=new Set(Qt.filter(Ir=>typeof Ir.builtInRole=="string"&&Ir.builtInRole.trim()!==""&&Ir.permission!=="Admin").map(Ir=>Ir.builtInRole)),Va=new Set([...$a].filter(Ir=>Ir!==void 0&&!js.has(Ir.toString())).map(Ir=>Ir?.toString()||"")),Sr=new Set([...js].filter(Ir=>Ir&&!$a.has(Number(Ir))));Sr&&ua(Sr),Va&&ds(Va),Ia&&us(Ia),fr&&Wn(fr)},[Qt,ca]);const Ws=(0,I.useCallback)(async js=>{await bt(ye.uid,{rules:js}),await Je()},[ye.uid,Je,bt]),er=async({team:js,rule:$a})=>{let Ia=[];ca.find(Va=>Va.teamId===js.toString())?Ia=ca.map(Va=>Va.teamId===js.toString()?{...Va,rules:[...Va.rules,pl($a)]}:{...Va}):Ia=ca.concat({teamId:js.toString(),rules:[pl($a)]}),await Ws(Ia),$n(!1)},hr=async(js,$a)=>{const Ia=[];ca.forEach(fr=>{if(fr.teamId===js){if(!$a?.length)return;Ia.push({...fr,rules:$a})}else Ia.push({...fr})}),await Ws(Ia)},pa=r.contextSrv.hasPermission(fe.DataSourcesPermissionsWrite)&&!Be,qs=js=>{if(js.userId)return js.userLogin;if(js.teamId)return js.team;if(js.builtInRole)return js.builtInRole};return(0,a.jsxs)("div",{children:[Be&&(0,a.jsx)(no.r,{}),(0,a.jsxs)(ne.B,{direction:"column",gap:2,children:[(0,a.jsxs)(mr.A,{title:"Data Access",description:"Here you can configure access to specific data within the datasource. ",children:[(0,a.jsx)(a.Fragment,{children:(xs.size>0||ps.size>0||es.size>0||Hn.size>0)&&ca.length>0&&(0,a.jsx)("div",{children:(0,a.jsxs)($t.F,{title:"Permission warning",severity:"warning",children:["Recommended setup is to allow team query permissions only.",(0,a.jsxs)("ul",{className:Ds.warning,children:[xs.size>0&&(0,a.jsx)("div",{children:"Teams cannot query the data source. Add query permissions for the following teams:"}),[...xs].map(js=>{const $a=un?.find(Ia=>Ia.id?.toString()===js)?.name;return(0,a.jsx)("li",{className:Ds.warningli,children:`Team ${$a}`},js)}),(ps.size>0||es.size>0)&&(0,a.jsx)("div",{children:"Teams can query all logs. Add Team LBAC rules for the following teams:"}),[...ps].map(js=>{const $a=Qt?.find(Ia=>Ia.teamId?.toString()===js);if($a)return(0,a.jsx)("li",{className:Ds.warningli,children:`Team ${qs($a)}`},js)}),[...es].map(js=>{const $a=Qt?.find(Ia=>Ia.id===js);if($a)return(0,a.jsx)("li",{className:Ds.warningli,children:`Service account ${qs($a)}`},js)}),Hn.size>0&&(0,a.jsx)("div",{children:"Role can access all logs with `query`` permission. Remove permission for the following:"}),[...Hn].map(js=>(0,a.jsx)("li",{className:Ds.warningli,children:`Role ${js}`},js))]})]})})}),(0,a.jsxs)(ne.B,{direction:"column",alignItems:"start",gap:2,children:[(0,a.jsx)("h4",{children:"Team Label-based access control"}),(0,a.jsxs)("ul",{className:Ds.warning,children:[(0,a.jsx)(u.I,{name:"info"})," Note: Feature preview notes for Team LBAC rules will not be applied if the linked Cloud Access Policy has label selectors."]}),"Here you can configure label-based access control (LBAC) rules for teams, ",(0,a.jsx)("br",{}),"allowing you to restrict which logs a team can query based on logql.",(0,a.jsx)("ul",{className:(0,y.css)({marginLeft:16}),children:(0,a.jsxs)("li",{children:["Ex: A rule ",(0,a.jsx)("code",{children:'cluster="us-west-0", namespace=~"dev|prod"'})]})}),pa&&(0,a.jsx)(ee.$n,{onClick:()=>$n(!0),children:"Create LBAC rule"}),Ln&&(0,a.jsx)(wh,{onSubmit:er,onClose:()=>$n(!1)})]})]}),!(0,Dn.isEmpty)(ca)&&(0,a.jsxs)("table",{role:"grid",className:"filter-table gf-form-group","aria-labelledby":"team_lbac_rules",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{style:{width:"30%"},children:"Team"}),(0,a.jsx)("th",{style:{width:"1%"}}),(0,a.jsx)("th",{children:"Label selector"}),(0,a.jsx)("th",{style:{width:"1%"}})]})}),(0,a.jsx)("tbody",{children:ca.map((js,$a)=>{const Ia=js.rules,fr=js.teamId;let Va="";return xs.has(js.teamId)&&(Va="Warning: This team may not have permission to query the datasource."),(0,a.jsx)(_h,{teamRules:Ia,disabled:!pa,team:un.find(Sr=>Sr.id?.toString()===fr)||{id:Number(fr),name:"",avatarUrl:""},onChange:Sr=>hr(fr,Sr),warning:Va},$a)})})]})]})]})},qh=V=>({wrapper:(0,y.css)({display:"flex",flexDirection:"column",overflowX:"auto",overflowY:"hidden",width:"100%"}),sectionHeader:(0,y.css)({marginBottom:V.spacing(2)}),warning:(0,y.css)({fontSize:V.typography.bodySmall.fontSize}),warningli:(0,y.css)({listStyle:"inside"})}),hu=Zh(Xh);function ef(V,ye){const{uid:Be}=ye;return{resourceId:Be,dataSourceConfig:V.dataSources.dataSource,teamLBACConfig:V.teamLBAC?.teamLBACConfig}}const fu={loadDataSource:rt.ak,loadDataSourceMeta:rt.xI,updateDataSource:rt.jB},gu=(0,he.connect)(ef,fu)(({resourceId:V,dataSourceConfig:ye,teamLBACConfig:Be,loadDataSource:Je,loadDataSourceMeta:it,updateDataSource:bt})=>{(0,I.useEffect)(()=>{Je(V)},[V,Je]);const Qt=r.contextSrv.hasPermissionInMetadata(fe.DataSourcesPermissionsWrite,ye);(0,I.useEffect)(()=>{Je(V).then(it)},[Je,it,V]);const un=()=>{Je(V)},an=()=>es=>{if(!Hn||!Be?.rules?.length)return es;const us=Nh(Be?.rules);return Qi(us,es)},{readOnly:Ln,hasWriteRights:$n}=(0,_r.u1)(ye.uid),Hn=s.$.featureToggles.teamHttpHeaders&&yd(ye),Wn=Ln||!Qt||!$n;return(0,a.jsxs)(ne.B,{direction:"column",gap:2,children:[(0,Ye.z5)()&&(0,a.jsx)($e.Iz,{featureId:"data-source-permissions",eventVariant:"trial",featureName:"data source permissions",text:"Enable data source permissions for free during your trial of Grafana Pro."}),(0,a.jsx)(Xa.x,{resource:"datasources",resourceId:V,canSetPermissions:Qt,getWarnings:Hn?an():void 0,epilogue:Hn?es=>(0,a.jsx)(hu,{dataSourceConfig:ye,readOnly:Wn,onTeamLBACUpdate:un,items:es}):void 0})]})}),sf=()=>{const{uid:V}=(0,xe.g)(),{navId:ye,pageNav:Be}=(0,Ao.n)("permissions");return(0,a.jsx)(G.Y,{navId:ye,pageNav:Be,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(gu,{uid:V})})})},af=({uid:V})=>((0,_r.oU)(V),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($e.Iz,{featureName:"data source permissions",featureId:"data-source-permissions"}),(0,a.jsx)(rf,{})]})),rf=({action:V})=>{const ye=(0,D.$j)();return(0,a.jsx)($e.El,{action:V,featureName:"data source permissions",description:"With data source permissions, you can protect sensitive data by limiting access to this data source to specific users, teams, and roles.",listItems:["Protect sensitive data, like security logs, production databases, and personally-identifiable information","Clean up users\u2019 experience by hiding data sources they don\u2019t need to use","Share Grafana access more freely, knowing that users will not unwittingly see sensitive data"],image:`ds-permissions-${ye.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/datasource_permissions"})},ii=af,pu=()=>{const{uid:V}=(0,xe.g)(),{navId:ye,pageNav:Be}=(0,Ao.n)("permissions");return(0,a.jsx)(G.Y,{navId:ye,pageNav:Be,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(ii,{uid:V})})})};var Ni=e(16233),dc=e(33390);const Ql=({title:V,subTitle:ye,severity:Be,onButtonClick:Je,buttonText:it})=>{const bt=(0,D.IS)(cf);return(0,a.jsx)("div",{className:bt.container,children:(0,a.jsx)("div",{className:"page-container",children:(0,a.jsx)($t.F,{title:V,severity:Be,buttonContent:it,onRemove:Je,children:ye})})})},uc=({isLicensingReader:V,children:ye})=>V?(0,a.jsx)("a",{href:"/admin/licensing",children:ye}):(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",target:"_blank",rel:"noreferrer noopener",children:ye}),mu=({isLicensingReader:V})=>(0,a.jsx)(Ql,{title:"Your Grafana Enterprise license has expired",subTitle:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(uc,{isLicensingReader:V,children:"Some features"})," have been disabled."]}),severity:"error"}),vu=({isLicensingReader:V})=>(0,a.jsx)(Ql,{title:"Your Grafana Enterprise license is invalid",subTitle:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(uc,{isLicensingReader:V,children:"Some features"})," have been disabled."]}),severity:"error"}),of=({days:V,onCloseWarning:ye,isLicensingReader:Be})=>(0,a.jsx)(Ql,{onButtonClick:ye,title:"Your Grafana Enterprise license will expire soon",subTitle:(0,a.jsxs)(a.Fragment,{children:[V," days remaining, after which"," ",(0,a.jsx)(uc,{isLicensingReader:Be,children:"Enterprise features will be disabled."})]}),severity:"info",buttonText:"Dismiss"}),lf=({days:V,onCloseWarning:ye,isLicensingReader:Be})=>(0,a.jsx)(Ql,{onButtonClick:ye,title:"Your Grafana Enterprise token needs to be renewed",subTitle:(0,a.jsxs)(a.Fragment,{children:["Your license token has ",V," days remaining, after which"," ",(0,a.jsx)(uc,{isLicensingReader:Be,children:"Enterprise features will be disabled."})]}),severity:"info",buttonText:"Dismiss"}),yu=({activeUsers:V,maxUsers:ye,slug:Be,onRefreshWarning:Je})=>(0,a.jsx)(Ql,{onButtonClick:Je,title:"You have exceeded the included number of active users",subTitle:(0,a.jsxs)(a.Fragment,{children:["Your Grafana Enterprise license includes ",ye," active users; you currently have ",V," active users. Please"," ",Be?(0,a.jsx)("a",{href:"https://grafana.com/orgs/"+Be+"/licenses",target:"_blank",rel:"noreferrer noopener",children:"upgrade your license."}):"upgrade your license."]}),severity:"error",buttonText:"Refresh"}),cf=V=>({container:(0,y.css)`
      position: absolute;
      bottom: 0;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      z-index: 3;
    `}),xu=80,Ed=100,df=0,Dd=1,uf=2,hf=3,Dp=4,Eu=5,bp=6,Du=5,bu=3600,Pu="grafana.licence.warning.dismissUntil",vl="users",hc="AWS/Marketplace",li=async()=>(0,qn.AI)().get("/api/licensing/token"),fc=async V=>(0,qn.AI)().post("/api/licensing/token",{token:V}),ff=async()=>(0,qn.AI)().post("/api/licensing/token/renew",{}),bd=async()=>(0,qn.AI)().get("/api/licensing/refresh-stats");function Cu(){(0,E.J3)(gf)}function gf(){const[V,ye]=(0,I.useState)(!1),[Be,Je]=(0,I.useState)(s.$.licensing),it=dc.A.get(Pu),bt=it&&it>(0,h.KQ)().valueOf(),Qt=Ni.TP.hasPermission(fe.LicensingRead),un=Ni.TP.hasPermission(fe.LicensingRead),an=Qt&&mf()&&!bt,Ln=Qt&&Pd()&&!bt,$n=yl();let Hn=!1,Wn=0,es=0;if(Be.limitBy===vl){const ds=Ol(Be.includedUsers,Be.activeUsers);Hn=$n&&ds&&(Qt||un),Wn=Be.activeUsers,es=Be.includedUsers}if(jc()||Tu())return null;const us=()=>{const ds=(0,h.KQ)().add(Du,"d").valueOf();dc.A.set(Pu,ds),ye(!0)},ps=async()=>{const ds=await bd().catch(xs=>null);if(ds){const xs={...Be,activeUsers:ds.active_users};s.$.licensing=xs,Je(xs)}};if(V)return null;if(pf())return(0,a.jsx)(vu,{isLicensingReader:un});if(Su())return(0,a.jsx)(mu,{isLicensingReader:un});if(Hn)return(0,a.jsx)(yu,{activeUsers:Wn,maxUsers:es,slug:Be.slug,onRefreshWarning:Qt?ps:void 0});if(an){const ds=vf();return setTimeout(us,1e3*bu),(0,a.jsx)(of,{days:ds,onCloseWarning:us,isLicensingReader:un})}else if(Ln){const ds=yf();return setTimeout(us,1e3*bu),(0,a.jsx)(lf,{days:ds,onCloseWarning:us,isLicensingReader:un})}return null}function pf(){const{expiry:V,hasLicense:ye}=s.$.licenseInfo;return ye&&!V}function mf(){const{licenseExpiry:V,licenseExpiryWarnDays:ye=30}=s.$.licensing;return V>0&&(0,h.KQ)(V*1e3)<(0,h.KQ)().add(ye,"d")}function vf(){const{licenseExpiry:V}=s.$.licensing;return Math.ceil((V-(0,h.KQ)().unix())/3600/24)}function Su(){const{licenseExpiry:V}=s.$.licensing;return V>0&&(0,h.KQ)(V*1e3)<(0,h.KQ)()}function Pd(){const{tokenExpiry:V,tokenExpiryWarnDays:ye=3}=s.$.licensing;return V>0&&(0,h.KQ)(V*1e3)<(0,h.KQ)().add(ye,"d")}function yf(){const{tokenExpiry:V}=s.$.licensing;return Math.ceil((V-(0,h.KQ)().unix())/3600/24)}function Ol(V,ye){return V===void 0||ye===void 0?!1:V!==-1&&ye>V}function yl(){return!s.$.licensing.usageBilling}function xf(){const V=/\/d-solo\//,ye=window.location.pathname;return V.test(ye)}function jc(){return xf()}function Tu(){const V=/\/admin\/licensing$/,ye=window.location.pathname;return V.test(ye)}var Ef=e(51372),Il=e(72724),Df=e(55356);const Mu=({orgSlug:V,licenseId:ye})=>{let Be="https://grafana.com/contact";return V&&ye&&(Be=`https://grafana.com/orgs/${V}/tickets?support=licensing&licenseId=${ye}`),(0,a.jsx)(ee.z9,{href:Be,target:"_blank",rel:"noopener noreferrer",children:"Contact customer support"})};var Cd=e(81507);const gc=({title:V,children:ye,footer:Be,state:Je,status:it,className:bt})=>{const Qt=(0,D.$j)(),un=qi(Qt,Je);return(0,a.jsx)(Cd.Q,{className:(0,y.cx)(un.container,bt),disableHover:!0,children:(0,a.jsxs)("div",{className:un.inner,children:[(V||it)&&(0,a.jsxs)("div",{className:un.row,children:[V&&(0,a.jsx)("h3",{className:un.title,children:V}),it&&(0,a.jsx)(wi,{state:Je,status:it})]}),(0,a.jsx)("div",{className:un.content,children:ye}),Be&&(0,a.jsx)("div",{className:un.footer,children:Be})]})})},qi=(0,Cn.N)((V,ye)=>({container:(0,y.css)`
      padding: ${V.spacing(2)};
      margin-bottom: 0;
      ${ye&&`border: 1px solid ${V.colors[ye].border}`};
    `,inner:(0,y.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,title:(0,y.css)`
      font-size: ${V.typography.h3.fontSize};
      color: ${V.colors.text.secondary};
      margin-bottom: 0;
    `,row:(0,y.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin-bottom: ${V.spacing(2)};
      align-items: center;
    `,content:(0,y.css)`
      display: flex;
      flex-direction: column;
      flex: 1 0 auto;
      width: 100%;
    `,footer:(0,y.css)`
      display: flex;
      flex-direction: column;
      align-items: self-start;
      margin-top: ${V.spacing(2)};
    `})),wi=({state:V,status:ye})=>{const Be=new Map([["warning","bell"],["error","exclamation-triangle"]]),Je=(0,D.$j)(),it=bf(Je,V);return V&&Be.has(V)?(0,a.jsxs)("div",{role:"alert",className:it.container,children:[(0,a.jsx)(u.I,{name:Be.get(V)}),ye]}):null},bf=(V,ye)=>({container:(0,y.css)`
      background-color: ${V.colors.background.primary};
      color: ${ye&&V.colors[ye].text};
      padding: ${V.spacing(.5)} ${V.spacing(1)};

      svg {
        margin-right: ${V.spacing(1)};
      }
    `}),Pf=({state:V,title:ye,orgSlug:Be,licenseId:Je})=>{const it=(0,D.of)(Cf);return V?(0,a.jsx)($t.F,{title:ye,severity:V,className:it.container,children:(0,a.jsx)(Mu,{orgSlug:Be,licenseId:Je})}):null},Cf=V=>({container:(0,y.css)`
      background: ${V.colors.secondary.main};
      margin-bottom: ${V.spacing(3)};
    `}),Sd=({content:V,state:ye})=>{const Be=(0,D.$j)(),Je=Al(Be,ye);return(0,a.jsx)(a.Fragment,{children:V.map(it=>{if(!it)return null;const bt={marginLeft:`${it.indentLevel||0}em`};return(0,a.jsxs)("div",{className:Je.row,children:[(0,a.jsxs)("span",{style:bt,children:[it.name,it.tooltip&&(0,a.jsx)(be.m,{placement:"top",content:it.tooltip,theme:"info",children:(0,a.jsx)(u.I,{name:"info-circle",size:"sm"})})]}),(0,a.jsx)("span",{className:it.highlight?Je.highlight:"",children:it.value})]},it.name)})})},Al=(V,ye)=>({row:(0,y.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin-bottom: ${V.spacing(2)};
      align-items: center;
      svg {
        margin-left: ${V.spacing(.5)};
        cursor: pointer;
      }
    `,highlight:(0,y.css)`
      background-color: ${V.colors.background.primary};
      color: ${ye&&V.colors[ye].text};
      padding: ${V.spacing(.5)} ${V.spacing(1)};
      margin-right: -${V.spacing(1)};

      svg {
        margin-right: ${V.spacing(1)};
      }
    `}),Ou=({isUploading:V,title:ye,onFileUpload:Be,isDisabled:Je,licensedUrl:it})=>{const bt=Sf();return(0,a.jsxs)(a.Fragment,{children:[ye&&(0,a.jsx)("h2",{className:bt.title,children:ye}),V?(0,a.jsx)(ee.$n,{disabled:!0,children:"Uploading\u2026"}):Je?(0,a.jsx)(ee.$n,{disabled:!0,children:"Upload a new token"}):(0,a.jsx)(yr.e,{onFileUpload:Be,accept:".jwt",children:"Upload a new token"}),it&&(0,a.jsxs)("p",{className:bt.instanceUrl,children:["Instance URL: ",(0,a.jsx)("code",{children:it})]})]})},Sf=(0,Cn.N)(()=>({title:(0,y.css)`
      margin-top: 30px;
      margin-bottom: 20px;
    `,instanceUrl:(0,y.css)`
      margin-top: 10px;
    `})),Tf=(V,ye)=>(ye?`${ye} of `:"")+(V>0?V:"unlimited"),Mf=V=>(0,h.KQ)(V.exp*1e3)<(0,h.KQ)(),Of=V=>(0,h.KQ)(V.exp*1e3)<(0,h.KQ)().add(s.$.licensing.tokenExpiryWarnDays,"d"),Iu=V=>Math.ceil((V.exp-(0,h.KQ)().unix())/3600/24),Rl=V=>V?Mf(V)?{state:"error",status:"Expired",title:"Token expired",message:"Contact support to renew your token, or visit the Cloud portal to learn more."}:Of(V)?{state:"warning",status:` Expiring in ${Iu(V)} day(s)`,title:"Token expires soon",message:`Your token expires in ${Iu(V)} day(s). Contact support to renew your token.`}:{state:"",status:"",title:"",message:""}:{state:"",status:"",title:"",message:""},If=V=>V.trial_exp&&(0,h.KQ)(V.trial_exp*1e3)<(0,h.KQ)(),Au=V=>V.trial_exp?Math.ceil((V.trial_exp-(0,h.KQ)().unix())/3600/24):0,Ru=(V,ye)=>{const{active_users:Be=0,active_anonymous_devices:Je=0}=V||{};return Be+Math.floor(Je/(ye?.anonymousRatio||1))},Af=V=>!V||!V.trial||!V.trial_exp?{state:"",status:"",title:"",message:""}:If(V)?{state:"error",status:"Expired",title:"Trial expired",message:"Your trial period has expired, please contact sales to purchase a license."}:{state:"info",status:` Trial expiring in ${Au(V)} day(s)`,title:"Trial active",message:`Your trial expires in ${Au(V)} day(s), please contact sales to purchase a license.`},Lu=(V,ye=0)=>100*ye/V,Bc=(V,ye)=>{let Be="",Je="",it="",bt="";if(!V)return{state:Be,status:Je,title:it,message:bt};if(V.limit_by===vl){const Qt=Ru(ye,V),un=V.included_users;let an=0;typeof Qt=="number"&&(an=Lu(un,Qt)),an>Ed?(Be="error",Je="Quota exceeded: active users",it="User limit exceeded",bt=`There are more than ${un} active users using Grafana.`,bt+=" Contact support to increase the quotas."):an>=xu&&(Be="warning",an>=Ed?(Je="Limit reached",it="User utilization limit reached",bt=`You are at your limit of ${un} active users.`):(Je="Reaching limit",it="User utilization reaching limit",bt=`There are ${Qt} active users.`,bt+=` You are approaching your limit of ${un} active users.`),Je+=": active users",bt+=" Contact support to increase the quotas.")}return{state:Be,status:Je,title:it,message:bt}},ju=({token:V,stats:ye,tokenRenewed:Be,tokenUpdated:Je,isLoading:it,licensedUrl:bt})=>{const[Qt,un]=(0,I.useState)(!1),[an,Ln]=(0,I.useState)(!1),$n=Rl(V).state,Hn=Bc(V,ye).state,Wn=Ni.TP.hasPermission(fe.LicensingWrite),es=(0,D.of)(Rf),us=Ru(ye,V),ps=V?.anonymousRatio||1,ds=ca=>{const Ds=ca.currentTarget?.files?.[0];if(Ds){Nt.Ny.partial({tokenUpdated:null,tokenRenewed:null});const Ws=new FileReader,er=()=>async hr=>{un(!0);try{await fc(hr.target.result),Nt.Ny.partial({tokenUpdated:!0}),setTimeout(()=>{location.reload()},1e3)}catch(pa){throw un(!1),pa}};Ws.onload=er(),Ws.readAsText(Ds)}},xs=async()=>{Nt.Ny.partial({tokenUpdated:null,tokenRenewed:null}),Ln(!0);try{await ff(),Nt.Ny.partial({tokenRenewed:!0}),setTimeout(()=>{location.reload()},1e3)}catch(ca){throw Ln(!1),ca}};if(!Ni.TP.hasPermission(fe.LicensingRead))return null;if(it)return(0,a.jsx)(ki.a,{text:"Loading licensing info..."});let ua="You are running Grafana Enterprise without a license. The Enterprise features are disabled.";return V&&![Dd,Eu].includes(V.status)&&(ua="There is a problem with your Enterprise license token. The Enterprise features are disabled."),!V||![Dd,Eu].includes(V.status)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Df.UpgradeInfo,{editionNotice:ua}),(0,a.jsx)("div",{className:es.uploadWrapper,children:(0,a.jsx)(Ou,{title:"Have a license?",onFileUpload:ds,isUploading:Qt,isDisabled:!Wn,licensedUrl:bt})})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:es.title,children:"License details"}),(0,a.jsx)(Td,{...Bc(V,ye),orgSlug:V.slug,licenseId:V.lid}),(0,a.jsx)(Td,{...Rl(V),orgSlug:V.slug,licenseId:V.lid}),(0,a.jsx)(Td,{...Af(V),orgSlug:V.slug,licenseId:V.lid}),Je&&(0,a.jsx)($t.F,{title:"License token uploaded. Restart Grafana for the changes to take effect.",severity:"success",onRemove:()=>Nt.Ny.partial({tokenUpdated:null})}),Be&&(0,a.jsx)($t.F,{title:"License token renewed.",severity:"success",onRemove:()=>Nt.Ny.partial({tokenRenewed:null})}),(0,a.jsxs)("div",{className:es.row,children:[(0,a.jsx)(gc,{title:"License",className:es.licenseCard,footer:(0,a.jsx)(ee.z9,{variant:"secondary",href:V.details_url||`${V.iss}/licenses/${V.lid}`,"aria-label":"View details about your license in Grafana Cloud",target:"_blank",rel:"noopener noreferrer",children:"License details"}),children:(0,a.jsx)(Sd,{content:[{name:V.prod?.length<=1?"Product":"Products",value:V.prod?.length<=1?V.prod[0]||"None":(0,a.jsx)("ul",{children:V.prod?.map(ca=>(0,a.jsx)("li",{children:ca},ca))})},V.iss===hc&&V.account?{name:"AWS Account",value:V.account}:{name:"Company",value:V.company},{name:"License ID",value:V.lid},V.iss===hc?null:{name:"URL",value:V.sub,tooltip:"License URL is the root URL of your Grafana instance. The license will not work on an instance of Grafana with a different root URL."},{name:"Purchase date",value:(0,Il.LE)(V.nbf*1e3)},V.iss===hc?null:{name:"License expires",value:(0,Il.LE)(V.lexp*1e3),highlight:!!Rl(V)?.state,tooltip:"The license expiration date is the date when the current license is no longer active. As the license expiration date approaches, Grafana Enterprise displays a banner."},V.iss===hc?null:{name:"Usage billing",value:V.usage_billing?"On":"Off",tooltip:"You can request Grafana Labs to turn on usage billing to allow an unlimited number of active users. When usage billing is enabled, Grafana does not enforce active user limits or display warning banners. Instead, you are charged for active users above the limit, according to your customer contract."}]})}),(0,a.jsx)(gc,{...Rl(V),title:"Token",footer:(0,a.jsxs)("div",{className:es.row,children:[V.iss!==hc&&(0,a.jsx)(Ou,{onFileUpload:ds,isUploading:Qt,isDisabled:!Wn}),an?(0,a.jsx)("span",{children:" (Renewing...)"}):(0,a.jsx)(ee.$n,{variant:"secondary",onClick:xs,disabled:!Wn,children:"Renew token"})]}),children:(0,a.jsxs)(a.Fragment,{children:[$n&&(0,a.jsx)(Pf,{title:"Contact support to renew your token, or visit the Cloud portal to learn more.",state:$n,orgSlug:V.slug,licenseId:V.lid}),(0,a.jsxs)("div",{className:es.message,children:[(0,a.jsx)(u.I,{name:"document-info"}),"Read about"," ",(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-expiration/",target:"_blank",rel:"noreferrer noopener",children:"license expiration"})," ","and"," ",(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/activate-license/",target:"_blank",rel:"noreferrer noopener",children:"license activation"}),"."]}),(0,a.jsx)(Sd,{content:[{name:"Token ID",value:V.jti},{name:"Token issued",value:(0,Il.LE)(V.iat*1e3)},{name:"Token expires",value:(0,Il.LE)(V.exp*1e3),highlight:!!Rl(V)?.state,tooltip:"Grafana automatically updates the token before it expires. If your token is not updating, contact support."}],state:$n})]})}),(0,a.jsx)(gc,{...Bc(V,ye),title:"Utilization",footer:(0,a.jsx)("small",{className:es.footerText,children:"Utilization of licenced users is determined based on signed-in users' activity in the past 30 days."}),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:es.message,children:[(0,a.jsx)(u.I,{name:"document-info"}),"Read about"," ",(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-restrictions/#active-users-limit",target:"_blank",rel:"noreferrer noopener",children:"active user limits"})," ","and"," ",(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-restrictions/#concurrent-sessions-limit",target:"_blank",rel:"noreferrer noopener",children:"concurrent session limits"}),"."]}),V.limit_by===vl&&(0,a.jsx)(Sd,{content:[{name:"Active licensed users",value:Tf(V.included_users,us),highlight:Lu(V.included_users,us)>=xu},...s.$.bootData.settings.anonymousEnabled?[{name:"Authenticated users",value:ye?.active_users||0,indentLevel:1},{name:"Anonymous users",value:Math.floor((ye?.active_anonymous_devices||0)/ps),tooltip:`For every ${ps} anonymous ${ps>1?"devices":"device"}, Grafana counts 1 user.`,indentLevel:1}]:[]],state:Hn})]})})]})]})},Rf=V=>({title:(0,y.css)`
      margin: ${V.spacing(4)} 0;
    `,infoText:(0,y.css)`
      font-size: ${V.typography.size.sm};
    `,uploadWrapper:(0,y.css)`
      margin-left: 79px;
    `,row:(0,y.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
      flex-wrap: wrap;
      gap: ${V.spacing(2)};

      & > div {
        flex: 1 1 340px;
      }
    `,footerText:(0,y.css)`
      margin-bottom: ${V.spacing(2)};
    `,licenseCard:(0,y.css)`
      background: url('/public/img/licensing/card-bg-${V.isLight?"light":"dark"}.svg') center no-repeat;
      background-size: cover;
    `,message:(0,y.css)`
      height: 70px;
      a {
        color: ${V.colors.text.link};

        &:hover {
          text-decoration: underline;
        }
      }

      svg {
        margin-right: ${V.spacing(.5)};
      }
    `}),Td=({state:V,message:ye,title:Be,orgSlug:Je,licenseId:it})=>{const bt=(0,D.of)(Lf);return V?(0,a.jsx)($t.F,{title:Be,severity:V||void 0,children:(0,a.jsxs)("div",{className:bt.container,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:ye}),(0,a.jsx)("a",{className:bt.link,href:"https://grafana.com/docs/grafana/latest/enterprise/license/license-restrictions/",target:"_blank",rel:"noopener noreferrer",children:"Learn about Enterprise licenses"})]}),(0,a.jsx)(Mu,{orgSlug:Je,licenseId:it})]})}):null},Lf=V=>({container:(0,y.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      width: 100%;
    `,link:(0,y.css)`
      font-size: ${V.typography.bodySmall.fontSize};
      text-decoration: underline;
      color: ${V.colors.text.secondary};

      &:hover {
        color: ${V.colors.text.primary};
      }
    `}),jf=({queryParams:V})=>{const[ye,Be]=(0,I.useState)(null),[Je,it]=(0,I.useState)(null),[bt,Qt]=(0,I.useState)(!1),{tokenUpdated:un,tokenRenewed:an}=V;return(0,I.useEffect)(()=>Ni.TP.hasPermission(fe.LicensingRead)?(Qt(!0),(async()=>{const $n=await li().catch(()=>null),Hn=await bd().catch(()=>null);Be($n),it(Hn),Qt(!1)})(),Cu):void 0,[]),(0,a.jsx)(G.Y,{navId:"licensing",children:(0,a.jsxs)(G.Y.Contents,{children:[(0,a.jsx)(Ef.ServerStats,{}),(0,a.jsx)(ju,{token:ye,stats:Je,tokenUpdated:un,tokenRenewed:an,isLoading:bt,licensedUrl:s.$.licenseInfo?.appUrl})]})})};var Bu=e(63415),Ll=e(2913),Bf=e(27746),Md=e(20120),Yl=(V=>(V.Test="test",V.Control="control",V))(Yl||{});const Uc=V=>"feature-highlights"+(V?`-${V}`:""),Uf={isDrawerOpen:!1,drawerTab:pe.Stats},Od=(0,Ks.Z0)({name:"metaAnalytics",initialState:Uf,reducers:{setDrawerOpen:(V,ye)=>({...V,isDrawerOpen:ye.payload}),setDrawerTab:(V,ye)=>({...V,drawerTab:ye.payload})}}),{setDrawerOpen:pc,setDrawerTab:Uu}=Od.actions,Nf={metaAnalytics:Od.reducer};var wf=e(63021),Ff=e(40675),Wf=e(40980),Nc=e(72254),Kf=e(24293);class mc extends I.PureComponent{convertSummariesToDataFrame(ye,Be){const Je=[],it=[];return Be.forEach(bt=>{Je.push((0,h.KQ)(bt.day,Zr).valueOf()),it.push(bt[ye.name])}),{fields:[{name:"Time",type:br.PU.time,config:{},values:Je},{name:ye.name,type:ye.type,config:{displayName:ye.label??ye.name,color:ye.color?{mode:Kf.Y.Fixed,fixedColor:ye.color}:void 0},values:it}],length:Be.length}}buildTimeRange(){const{dailySummaries:ye}=this.props,Be=(0,h.KQ)(ye[0].day),Je=(0,h.KQ)(ye[ye.length-1].day).add(12,"hours");return{from:Be,to:Je,raw:{from:Be,to:Je}}}renderChart(ye){const{dailySummaries:Be,theme:Je}=this.props,{timeRange:it,showBars:bt,title:Qt,width:un,fields:an,isStacked:Ln=!1}=ye,$n=as(Je),Hn=an.map(ps=>this.convertSummariesToDataFrame(ps,Be)),Wn={series:Hn,state:As.Gu.Done,timeRange:it},es={legend:{showLegend:Hn.length>1,displayMode:ws.lm.List,placement:"bottom",calcs:[]},tooltip:{mode:ws.$N.Multi,sort:ws.xB.Descending}},us={defaults:{custom:{showPoints:ws.yL.Never,drawStyle:bt?ws.GR.Bars:ws.GR.Line,stacking:Ln?{mode:ws.gs.Normal}:void 0,fillOpacity:bt?50:0}},overrides:[]};return(0,a.jsx)("div",{className:$n.graphContainer,children:(0,a.jsx)(Da.NR,{title:Qt,width:un,height:220,displayMode:"transparent",loadingState:Wn.state,children:(ps,ds)=>(0,a.jsx)(ya.m,{title:Qt,width:ps,height:ds,pluginId:"timeseries",data:Wn,fieldConfig:us,options:es})})})}}class $f extends mc{render(){const{dailySummaries:ye,theme:Be}=this.props;if(ye&&ye.length>0){const Je=this.buildTimeRange();return(0,a.jsx)(ti.Ay,{disableHeight:!0,children:({width:it})=>it===0?null:(0,a.jsxs)("main",{style:{width:it},children:[this.renderChart({title:"Daily query count",fields:[{name:"queries",type:br.PU.number},{name:"cachedQueries",type:br.PU.number,label:"cached queries"}],width:it,timeRange:Je,showBars:!1,showLines:!0}),this.renderChart({title:"Views last 30 days",fields:[{name:"views",type:br.PU.number}],width:it,timeRange:Je,showBars:!0,showLines:!1}),this.renderChart({title:"Errors last 30 days",fields:[{name:"errors",type:br.PU.number,color:Be.colors.error.border}],width:it,timeRange:Je,showBars:!1,showLines:!0})]})})}return(0,a.jsx)("span",{children:"No data."})}}const Vf={setDrawerOpen:pc},zf=(0,D.cV)((0,he.connect)(null,Vf)($f));class _f extends mc{render(){const{dailySummaries:ye,theme:Be}=this.props;if(ye&&ye.length>0){const Je=this.buildTimeRange();return(0,a.jsx)(ti.Ay,{disableHeight:!0,children:({width:it})=>it===0?null:(0,a.jsxs)("main",{style:{width:it},children:[this.renderChart({title:"Daily query count",fields:[{name:"queries",type:br.PU.number},{name:"cachedQueries",type:br.PU.number,label:"cached queries"}],width:it,timeRange:Je,showBars:!1,showLines:!0}),this.renderChart({title:"Errors last 30 days",fields:[{name:"errors",type:br.PU.number,color:Be.colors.error.border}],width:it,timeRange:Je,showBars:!1,showLines:!0})]})})}return(0,a.jsx)("span",{children:"No data."})}}const Hf=(0,D.cV)(_f);var Nu=e(90708),Fi=e(99635),Wi=e(77093);class xl extends mc{constructor(ye){super(ye),this.onOpenVersionHistory=()=>{const{setDrawerOpen:Be}=this.props;Be(!1),Nt.Ny.partial({editview:"versions"})},this.state={dashboardUsersInfo:null}}async componentDidMount(){const{dashboard:ye}=this.props;try{const Be=await fn(ye.id);this.setState({dashboardUsersInfo:Be})}catch(Be){console.log("Error getting dashboard users info",Be)}}formatDate(ye){const Be=ye.diff((0,h.KQ)().startOf("day"),"days",!0);if(Be<-6)return ye.format("YYYY-MM-DD");if(Be<-1)return ye.locale("en").format("dddd");if(Be<0)return"Yesterday";{const Je=ye.diff((0,h.KQ)(),"minutes",!0);return Je<-60?"Today":Je<-15?"Last hour":"Currently viewing"}}renderUserBox(ye,Be,Je){return(0,a.jsxs)("div",{className:Je.userBox,"aria-label":"User information box",children:[(0,a.jsx)("h6",{"aria-label":"User box title",children:ye}),(0,a.jsx)(Fi.n,{userView:Be,showTooltip:!1}),(0,a.jsx)("div",{className:Je.userName,children:Be.user.name}),(0,a.jsx)("div",{children:(0,h.KQ)(Be.lastActiveAt).format("YYYY-MM-DD")})]})}renderViewsChart(){const ye=this.buildTimeRange();return(0,a.jsx)(ti.Ay,{disableHeight:!0,children:({width:Be})=>Be===0?null:(0,a.jsx)("main",{style:{width:Be},children:this.renderChart({title:"Views last 30 days",fields:[{name:"views",type:br.PU.number}],width:Be,timeRange:ye,showBars:!0,showLines:!1})})})}convertUserViewsToDataFrame(ye,Be){const{userViews:Je}=this.props;if(Je&&Je.length>0){const it=[],bt=[],Qt=[];Je.forEach($n=>{it.push(this.formatDate((0,h.KQ)($n.lastActiveAt))),bt.push($n.user.name),Qt.push((0,a.jsx)(Fi.n,{className:ye.userIcon,userView:$n,showTooltip:!1}))});const un={displayName:" ",filterable:!1,custom:{width:50,align:"center",minWidth:50,cellOptions:{type:ws.ob.ColorText},inspect:!1}},an=[{fields:[{name:" ",type:br.PU.other,config:un,values:Qt},{name:"User",type:br.PU.string,config:{},values:bt},{name:"When",type:br.PU.string,config:{},values:it}],length:Je.length}],Ln=(0,Nu.we)({data:an,theme:Be,replaceVariables:$n=>$n,fieldConfig:{}});return Ln.length>0?Ln[0]:null}else return null}render(){const{dailySummaries:ye,dashboard:Be,theme:Je,userViews:it}=this.props,{dashboardUsersInfo:bt}=this.state,Qt=as(Je),un=this.convertUserViewsToDataFrame(Qt,Je);return(0,a.jsxs)("div",{children:[ye&&ye.length>0&&this.renderViewsChart(),(0,a.jsxs)("div",{className:Qt.userBoxesContainer,children:[bt?.creator&&this.renderUserBox("Created",bt.creator,Qt),bt?.lastEditor&&this.renderUserBox("Last edited",bt.lastEditor,Qt),it?.length>0&&this.renderUserBox("Last viewed",it[0],Qt)]}),it?.length>0&&(0,a.jsxs)("div",{className:Qt.tableContainer,children:[(0,a.jsxs)("div",{className:Qt.tableHeader,children:[(0,a.jsx)("h4",{children:"Last 30 dashboard viewers"}),Be.meta.showSettings&&(0,a.jsx)(ee.$n,{icon:"history",variant:"secondary",onClick:this.onOpenVersionHistory,"aria-label":"Version history button",children:"Dashboard version history"})]}),(0,a.jsx)(ti.Ay,{disableHeight:!0,children:({width:an})=>{if(an===0)return null;const Ln=35*(un.length+1);return(0,a.jsx)("main",{style:{width:an},children:(0,a.jsx)(Wi.X,{data:un,height:Ln,width:an,"aria-label":"Recent users table"})})}})]})]})}}const Sp={setDrawerOpen:pc},Tp=(0,D.cV)((0,he.connect)(null,Sp)(xl)),wu=30;class Fu extends I.PureComponent{constructor(ye){super(ye),this.onSelectTab=Be=>{this.props.setDrawerTab(Be.value||pe.Stats)},this.state={dailySummaries:[],publicDailySummaries:[],userViews:[]}}async componentDidMount(){const{dashboard:ye}=this.props,Be=[];for(let Je=0;Je<30;Je++)Be.push((0,h.KQ)(Date.now()).subtract(Je,"days").format(Zr));if(ye?.id&&ye.meta.url){const Je=await mt(ye.id,Be),it=await Le(ye.id,wu);let bt=[];(0,Nc.iR)()&&(bt=await kt(ye.id,Be)),this.setState({dailySummaries:Je,userViews:it,publicDailySummaries:bt})}}renderHeader(ye){const Be=[{label:"Stats",value:pe.Stats},{label:"Users and activity",value:pe.Users}];return(0,Nc.iR)()&&Be.push({label:"Public dashboards",value:pe.PublicDashboards}),(0,a.jsx)(wf.U,{className:ye.tabsBar,children:Be.map((Je,it)=>(0,a.jsx)(Ff.o,{label:Je.label,active:Je.value===this.props.drawerTab,onChangeTab:()=>this.onSelectTab(Je)},`${Je.value}-${it}`))})}render(){const{dailySummaries:ye,publicDailySummaries:Be,userViews:Je}=this.state,{dashboard:it,drawerTab:bt,setDrawerOpen:Qt,theme:un}=this.props,an=as(un);return(0,a.jsx)(hn._,{scrollableContent:!0,title:`${it.title} - analytics`,size:"md",onClose:()=>Qt(!1),subtitle:this.renderHeader(an),expandable:!0,children:(0,a.jsxs)(Wf.J,{className:an.tabContent,children:[(0,Ye.z5)()&&(0,a.jsx)($e.Iz,{featureId:"dashboard-insights",eventVariant:"trial",featureName:"dashboard usage insights",text:"Get full access to usage insights for free during your trial of Grafana Pro."}),bt===pe.Stats&&(0,a.jsx)(Hf,{dashboard:it,dailySummaries:ye}),bt===pe.Users&&(0,a.jsx)(Tp,{dashboard:it,dailySummaries:ye,userViews:Je}),(0,Nc.iR)()&&bt===pe.PublicDashboards&&(0,a.jsx)(zf,{dashboard:it,dailySummaries:Be})]})})}}function kf(V){return{drawerTab:V.metaAnalytics.drawerTab}}const Wu={setDrawerOpen:pc,setDrawerTab:Uu},Gf=(0,D.cV)((0,he.connect)(kf,Wu)(Fu)),Ku=({onClick:V,isHighlighted:ye})=>(0,a.jsx)(Bf.I,{icon:"info-circle",tooltip:"Dashboard insights",onClick:V,isHighlighted:ye}),Qf=({dashboard:V,isDrawerOpen:ye,setDrawerOpen:Be})=>{const Je=V?.id&&V.meta.url,it=(0,Ye.z5)();return(0,I.useEffect)(()=>{Je&&it&&(0,l.Xp)(Uc("dashboard-insights-dot"),Yl.Test,"trial")},[Je,it]),Je&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ku,{onClick:()=>{Be(!0),(0,l.rR)("dashboards_toolbar_actions_clicked",{item:"insights"})},isHighlighted:it}),ye&&(0,a.jsx)(Gf,{dashboard:V})]})};function Yf(V){return{isDrawerOpen:V.metaAnalytics.isDrawerOpen}}const Jf={setDrawerOpen:pc},Zf=({dashboard:V})=>{const ye=V?.id&&V.meta.url,[Be,Je]=(0,I.useState)(!1);return(0,I.useEffect)(()=>{ye&&(0,l.Xp)(Uc("dashboard-insights-dot"),Yl.Test,"")},[ye]),ye&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ku,{isHighlighted:!0,onClick:()=>{Je(!0)}}),Be&&(0,a.jsx)(Vu,{dashboard:V,onClose:()=>Je(!1)})]})},$u=()=>{(0,n.a)("analytics")?r.contextSrv.hasPermission(fe.DashboardsInsightsRead)&&(0,Md.fP)({show:()=>!0,component:(0,he.connect)(Yf,Jf)(Qf),index:-1}):s.$.featureToggles.featureHighlights&&(0,Md.fP)({show:()=>!0,component:Zf,index:-1})},Vu=({onClose:V,dashboard:ye})=>{const Be=(0,D.$j)();return(0,a.jsxs)(hn._,{onClose:V,title:`${ye?.title} - analytics`,width:"50%",children:[(0,a.jsx)($e.Iz,{featureName:"dashboard usage insights",featureId:"dashboard-insights"}),(0,a.jsx)($e.ep,{featureName:"dashboard usage insights",image:`usage-insights-${Be.isLight?"light":"dark"}.png`,featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/usage-insights/dashboard-datasource-insights",description:"Usage Insights provide detailed information about dashboard usage, like the number of views, queries, and errors users have experienced. You can use this to improve users\u2019 experience and troubleshoot issues."})]})};class zu{constructor(ye){this.options=ye,this.buffer=[],this.supportedEvents=[Bu.on.MetaAnalytics],this.addEvent=Be=>{this.buffer.push(Be)},this.flush=()=>{if(this.buffer.length===0)return;const Be=[];for(const Je of this.buffer)Be.push({type:Je.type,...Je.payload,meta:Je.meta});this.buffer=[],this.options.url&&(0,S.AI)().fetch({method:"POST",url:this.options.url,showSuccessAlert:!1,showErrorAlert:!1,data:Be}).toPromise()}}}const Id=({users:V,onClick:ye,limit:Be=4})=>{const Je=(0,D.of)(Xf);if(!V.length)return null;Be=Be>0?Be:4;const it=V.length>Be,bt=V.length-Be,Qt=bt>99;return(0,a.jsxs)("div",{className:Je.container,"aria-label":"Users indicator container",children:[it&&(0,a.jsx)(Fi.n,{onClick:ye,userView:{user:{name:"Extra users"},lastActiveAt:""},showTooltip:!1,children:Qt?"...":`+${bt}`}),V.slice(0,it?Be:Be+1).reverse().map(un=>(0,a.jsx)(Fi.n,{userView:un},un.user.name))]})},Xf=V=>({container:(0,y.css)({display:"flex",justifyContent:"center",flexDirection:"row-reverse",marginLeft:V.spacing(1),"& > button":{marginLeft:V.spacing(-1)}}),dots:(0,y.css)({marginBottom:"3px"})});function qf(V){return ye=>{ye(pc(!0)),ye(Uu(V))}}const eg={openDrawer:qf},tg=(0,he.connect)(null,eg),_u=4,ng=6e4;function Hu(V,ye){const Be=Ni.TP.user;nt(V,_u+10).then(Je=>{const it=Je.filter(bt=>bt.user.id!==Be.id);ye(bt=>(0,Dn.isEqual)(it,bt)?bt:it)})}const sg=({dashboard:V,openDrawer:ye})=>{const Be=V?.id,[Je,it]=(0,I.useState)([]);return(0,I.useEffect)(()=>{if(!Be||!V?.meta.url)return;Hu(Be,it);const bt=setInterval(()=>Hu(Be,it),ng);return()=>{clearInterval(bt)}},[Be,V]),(0,a.jsx)(Id,{users:Je,limit:_u,onClick:()=>ye(pe.Users)})},ag=()=>{Ni.TP.hasPermission(fe.DashboardsInsightsRead)&&(0,Md.UP)({show:()=>!0,component:tg(sg),index:"end"})},ku=()=>{const V=(0,Ll.zj)().analytics?.enabled,ye=(0,n.a)("analytics");ye&&(0,Bu.pl)(new zu({url:Gu()})),V&&(ye?Ni.TP.user.isSignedIn&&(ag(),$u()):s.$.featureToggles.featureHighlights&&$u())},Gu=()=>{const V=(0,Ll.zj)().publicDashboardAccessToken;return V!==""?`api/public/ma/events/${V}`:"api/ma/events"},rg=()=>{const{uid:V}=(0,xe.g)(),ye=(0,gl.$m)("insights"),Be=(0,d.useSelector)(it=>it.navIndex),Je=(0,fi.tc)(Be,`datasource-insights-${V}`,ye);return(0,a.jsx)(G.Y,{navId:"datasources",pageNav:Je.main,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Zs,{uid:V})})})},og=()=>{const{uid:V}=(0,xe.g)(),ye=(0,_r.$m)("insights"),Be=(0,d.useSelector)(it=>it.navIndex),Je=(0,fi.tc)(Be,`datasource-insights-${V}`,ye);return(0,a.jsx)(G.Y,{navId:"datasources",pageNav:Je.main,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(Or,{uid:V})})})},Qu=()=>{const{uid:V}=(0,xe.g)(),ye=(0,gl.$m)("permissions"),Be=(0,d.useSelector)(it=>it.navIndex),Je=(0,fi.tc)(Be,`datasource-permissions-${V}`,ye);return(0,a.jsx)(G.Y,{navId:"datasources",pageNav:Je.main,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(gu,{uid:V})})})},vc=()=>{const{uid:V}=(0,xe.g)(),ye=(0,_r.$m)("permissions"),Be=(0,d.useSelector)(it=>it.navIndex),Je=(0,fi.tc)(Be,`datasource-permissions-${V}`,ye);return(0,a.jsx)(G.Y,{navId:"datasources",pageNav:Je.main,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)(ii,{uid:V})})})};var Ad=e(13544),wc=e(62930),Fc=e(20851),Yu=e(83277),jl=e(82467),Bn=e(3169),lg=e(72686),Ju=(V=>(V.NOT_FOUND_MAGIC_LINK="publicdashboards.magicLinkNotFound",V.EXPIRED_MAGIC_LINK="publicdashboards.magicLinkExpired",V))(Ju||{}),El=(V=>(V.INTERNAL_SERVER_ERROR="publicdashboards.internalServerError",V.INVALID_SESSION="publicdashboards.invalidSession",V.EXPIRED_SESSION="publicdashboards.sessionExpired",V))(El||{});const Mp={title:"Request access",description:"You'll receive an email with a one-time link."},yc="Something went wrong",cg="To request access to the dashboard again, enter your email. You'll receive an email with a one-time link.",dg={"publicdashboards.internalServerError":yc,"publicdashboards.magicLinkNotFound":"This link has expired or already been used","publicdashboards.magicLinkExpired":"This magic link has expired","publicdashboards.invalidSession":"You no longer have access","publicdashboards.sessionExpired":"Your access has expired"},Zu=V=>V?{title:dg[String(V)]||yc,description:cg}:Mp;function Dl(V){return typeof V=="object"&&V!=null&&"error"in V}function Wc(V){return Dl(V)&&(0,S.NF)(V.error)}const Rd=lg.Sm.injectEndpoints({endpoints:V=>({requestAccess:V.mutation({query:ye=>({url:"/public/dashboards/share/request-access",method:"POST",data:ye})}),confirmAccess:V.mutation({query:({magicLinkToken:ye,accessToken:Be})=>({url:`/public/dashboards/share/${ye}`,method:"POST"}),async onQueryStarted({accessToken:ye},{dispatch:Be,queryFulfilled:Je}){try{await Je,Be((0,jl.dx)((0,Bn.tZ)((0,de.t)("public-dashboard.email-sharing.success-confirm-access","Access confirmed!")))),window.location.assign(s.$.appSubUrl+`public-dashboards/${ye}`)}catch(it){if(Wc(it)){const{data:{messageId:bt}}=it.error;bt&&Object.values(Ju).includes(bt)&&window.location.assign(s.$.appSubUrl+`public-dashboards/${ye}/request-access?error=${bt}`)}}}}),addRecipient:V.mutation({query:({recipient:ye,uid:Be})=>({url:`/public-dashboards/${Be}/share/recipients`,method:"POST",data:{recipient:ye}}),async onQueryStarted(ye,{dispatch:Be,queryFulfilled:Je}){await Je,Be((0,jl.dx)((0,Bn.tZ)((0,de.t)("public-dashboard.email-sharing.success-send-recipient-invitation","The email invitation has been sent."))))},invalidatesTags:(ye,Be,{dashboardUid:Je})=>[{type:"PublicDashboard",id:Je}]}),deleteRecipient:V.mutation({query:({uid:ye,recipientUid:Be})=>({url:`/public-dashboards/${ye}/share/recipients/${Be}`,method:"DELETE"}),async onQueryStarted({recipientEmail:ye},{dispatch:Be,queryFulfilled:Je}){await Je,Be((0,jl.dx)((0,Bn.tZ)((0,de.t)("public-dashboard.email-sharing.success-revoke-access-title","Access Revoked"),(0,de.t)("public-dashboard.email-sharing.success-revoke-access-description","You have successfully revoked access for {{recipientEmail}}.",{recipientEmail:ye}))))},invalidatesTags:(ye,Be,{dashboardUid:Je})=>[{type:"PublicDashboard",id:Je},"UsersWithActiveSessions","ActiveUserDashboards"]}),reshareAccessToRecipient:V.mutation({query:({uid:ye,recipientUid:Be})=>({url:`/public-dashboards/${ye}/share/recipients/${Be}`,method:"PATCH"}),async onQueryStarted(ye,{dispatch:Be,queryFulfilled:Je}){await Je,Be((0,jl.dx)((0,Bn.tZ)((0,de.t)("public-dashboard.email-sharing.success-resend-recipient-invitation","The email invitation has been resent."))))}}),getActiveUsers:V.query({query:()=>({url:"/public-dashboards/share/users?status=active"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:V.query({query:ye=>({url:`/public-dashboards/share/users/${ye}/dashboards?status=active`}),providesTags:(ye,Be,Je)=>[{type:"ActiveUserDashboards",id:Je}]}),revokeAllAccess:V.mutation({query:({email:ye})=>({url:`/public-dashboards/share/users/${ye}`,method:"DELETE"}),async onQueryStarted({email:ye},{dispatch:Be,queryFulfilled:Je}){await Je,Be((0,jl.dx)((0,Bn.tZ)((0,de.t)("public-dashboard.email-sharing.success-revoke-all-accesses-title","Access Revoked"),(0,de.t)("public-dashboard.email-sharing.success-revoke-all-accesses-description","{{email}}'s access to all public dashboards has been successfully removed.",{email:ye}))))},invalidatesTags:["UsersWithActiveSessions"]})}),overrideExisting:!0}),{useRequestAccessMutation:el,useGetActiveUserDashboardsQuery:Op,useGetActiveUsersQuery:Ip,useConfirmAccessMutation:Ld}=Rd,ug=null,Xu=Ad.Tp.pages.PublicDashboardConfirmAccess;function hg(){const V=(0,D.of)(fg),{accessToken:ye}=(0,xe.g)(),[{magicLinkToken:Be}]=(0,Yu.s)(),[Je,{isLoading:it,isSuccess:bt}]=Ld(),Qt=async()=>{await Je({accessToken:ye,magicLinkToken:String(Be)})};return(0,a.jsx)(Fc.GU,{branding:{loginTitle:"Dashboard access",loginSubtitle:"Get access to the dashboard for 30 days. After 30 days, you can request access again to continue viewing the dashboard.",hideFooter:!0},children:(0,a.jsx)(Fc.qm,{children:(0,a.jsxs)(ee.$n,{"data-testid":Xu.submitButton,disabled:it||bt,type:"submit",className:V.form,onClick:Qt,children:[(0,a.jsx)("span",{children:"Confirm access"}),it&&(0,a.jsx)(wc.y,{className:V.loadingSpinner})]})})})}const fg=V=>({loadingSpinner:(0,y.css)({marginLeft:V.spacing(1)}),form:(0,y.css)({justifyContent:"center",width:"100%"})}),qu=(0,y.css)`
  justify-content: center;
  width: 100%;
`,Bl=Ad.Tp.pages.RequestViewAccess,gg=()=>{const V=(0,D.of)(pg),{accessToken:ye}=(0,xe.g)(),[{error:Be}]=(0,Yu.s)(),[Je,{isLoading:it,isSuccess:bt}]=el(),{register:Qt,handleSubmit:un,formState:{errors:an},reset:Ln}=(0,te.mN)({mode:"onSubmit"}),$n=Zu(Be?String(Be):void 0),Hn=async Wn=>{await Je({accessToken:ye,email:Wn.email}).unwrap(),Ln()};return(0,a.jsx)(Fc.GU,{branding:{loginTitle:$n.title,loginSubtitle:$n.description,hideFooter:!0},children:(0,a.jsx)(Fc.qm,{children:(0,a.jsxs)("form",{className:qu,onSubmit:un(Hn),children:[(0,a.jsx)(_.D,{label:"Email",error:an?.email?.message,invalid:!!an.email,children:(0,a.jsx)(De.p,{"data-testid":Bl.recipientInput,placeholder:"email",autoCapitalize:"none",...Qt("email",{required:"Email is required",pattern:{value:Nc._l,message:"Invalid email"}})})}),(0,a.jsxs)(ee.$n,{"data-testid":Bl.submitButton,disabled:bt,type:"submit",className:qu,children:[bt?"Access requested":"Request access"," ",it&&(0,a.jsx)(wc.y,{className:V.loadingSpinner})]})]})})})},pg=V=>({loadingSpinner:(0,y.css)`
    margin-left: ${V.spacing(1)};
  `}),mg=gg;var vg=e(26657),eh=e(64152),jd=e(99140),Ul=e(19347),Jl=e(10880),Zl=e(28138),yg=e(14678),Kc=e(39268),th=e(38894),nh=e(51612);const xg=V=>{const{onChange:ye,value:Be}=V,Je=(0,D.of)(Eg);return(0,a.jsxs)(Kc.C,{className:Je.filter,children:[(0,a.jsx)(th.I,{width:"auto",children:"Filter by data source"}),(0,a.jsx)(Ie.I,{children:(0,a.jsx)(nh.s,{width:30,placeholder:"Select a data source",onChange:it=>{ye({name:it.name,id:it.id,uid:it.uid})},noDefault:!0,current:Be})}),(0,a.jsx)(Ie.I,{children:(0,a.jsx)(ee.$n,{className:Je.button,icon:"trash-alt",variant:"secondary",onClick:()=>{ye(void 0)}})})]})},Eg=V=>({filter:(0,y.css)`
      margin-bottom: ${s.$.theme.spacing.md};
    `,button:(0,y.css)`
      color: ${V.colors.text.secondary};
    `});var $c=e(65879);const sh=({recordedQuery:V,buttons:ye})=>{const Be=(0,D.of)(ah),Je=(0,Ul.l)()?.getInstanceSettings(V.queries[0]?.datasource);return(0,a.jsxs)("div",{className:Be.alert,children:[Je?.meta&&(0,a.jsx)("img",{className:Be.media,src:Je.meta.info.logos.small,alt:"Query logo"}),(0,a.jsx)("div",{className:Be.body,children:(0,a.jsxs)("div",{className:Be.info,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:Be.heading,children:V.name}),(0,a.jsx)("p",{className:Be.description,children:gi(V)})]}),(0,a.jsx)("div",{className:Be.buttonWrapper,children:ye.map((it,bt)=>(0,a.jsx)("div",{className:Be.button,children:it},`button-${bt}`))})]})})]})},gi=V=>{const ye=[`Interval: ${(0,$c.secondsToHms)(V.interval)}`,`Range: Last ${(0,$c.secondsToHms)(V.range)}`],Be=(0,Ul.l)()?.getInstanceSettings(V.queries[0]?.datasource);return Be!==void 0&&ye.unshift(Be.name),V.description!==""&&ye.push(`${V.description}`),ye.join(" | ")},ah=V=>{const ye=V.shape.borderRadius();return{info:(0,y.css)`
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    `,heading:(0,y.css)`
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      margin-bottom: 0;
      font-size: ${V.typography.size.md};
      letter-spacing: inherit;
      line-height: ${V.typography.body.lineHeight};
      color: ${V.colors.text.primary};
      font-weight: ${V.typography.fontWeightMedium};
    `,description:(0,y.css)`
      width: 100%;
      margin: ${V.spacing(1,0,0)};
      color: ${V.colors.text.secondary};
      line-height: ${V.typography.body.lineHeight};
    `,alert:(0,y.css)`
      flex-grow: 1;
      position: relative;
      border-radius: ${ye};
      display: flex;
      flex-direction: row;
      align-items: center;
      background: ${V.colors.background.secondary};
      box-shadow: ${V.shadows.z1};
      margin-bottom: ${V.spacing(1)};

      &:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: ${V.colors.background.primary};
        z-index: -1;
      }
    `,body:(0,y.css)`
      color: ${V.colors.text.secondary};
      padding: ${V.spacing(2)};
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      overflow-wrap: break-word;
      word-break: break-word;
    `,content:(0,y.css)`
      color: ${V.colors.text.secondary};
      padding-top: ${V.spacing(1)};
      margin-left: 26px;
    `,media:(0,y.css)`
      margin-left: ${V.spacing(2)};
      width: 40px;
    `,buttonWrapper:(0,y.css)`
      padding: ${V.spacing(1)};
      background: none;
      display: flex;
      align-items: center;
      margin-right: ${V.spacing()};
    `,button:(0,y.css)`
      margin-left: ${V.spacing()};
    `}},Ap={recordedQueries:[],isLoading:!1,errorRecordedQueryTestResponse:""},Ki=(0,Ks.Z0)({name:"recorded-queries",initialState:Ap,reducers:{loadRecordedQueries:V=>({...V,isLoading:!0}),endLoadRecordedQueries:V=>({...V,isLoading:!1}),loadedRecordedQueries:(V,ye)=>{const Be=ye.payload;return{...V,recordedQueries:Be}},updateRecordedQueries:(V,ye)=>{const Be=ye.payload,Je=V.recordedQueries.map(it=>it.id===Be.id?Be:it);return{...V,recordedQueries:Je}},deleteRecordedQueries:(V,ye)=>{const Be=ye.payload,Je=V.recordedQueries.filter(it=>it.id!==Be.id);return{...V,recordedQueries:Je}},setPrometheusWriteTarget:(V,ye)=>{const Be=ye.payload;return{...V,prometheusWriteTarget:Be}}}}),{loadRecordedQueries:Ii,endLoadRecordedQueries:Dg,loadedRecordedQueries:Vc,updateRecordedQueries:zc,deleteRecordedQueries:rh,setPrometheusWriteTarget:bg}=Ki.actions,Rp={recordedQueries:Ki.reducer},Nl="api/recording-rules";function oh(){return async V=>{V(Ii());try{const ye=await(0,S.AI)().get(Nl);V(Vc(ye))}finally{V(Dg())}}}function Pg(V){return async ye=>{await(0,S.AI)().put(Nl,V),ye(zc(V))}}function Cg(V){return async ye=>{await(0,S.AI)().delete(`${Nl}/${V.id}`),ye(rh(V))}}function Sg(V){return(0,T.s)((0,S.AI)().fetch({method:"POST",url:Nl,data:V,showErrorAlert:!1}))}function Tg(V){return(0,T.s)((0,S.AI)().fetch({method:"POST",url:`${Nl}/test`,data:V,showSuccessAlert:!1,showErrorAlert:!1}))}function ih(){return async V=>{try{const ye=await(0,T.s)((0,S.AI)().fetch({method:"GET",url:`${Nl}/writer`,showSuccessAlert:!1,showErrorAlert:!1}));V(bg(ye.data))}catch(ye){ye.status!==404&&console.error(ye)}}}function Bd(V){return(0,T.s)((0,S.AI)().fetch({method:"POST",url:`${Nl}/writer`,data:V,showSuccessAlert:!1,showErrorAlert:!1}))}const lh=V=>V.recordedQueries,Mg=V=>V.prometheusWriteTarget,Og=V=>({expr:`${V.prom_name}{id="${V.id}", name="${V.name}"}`,legendFormat:"",interval:"",exemplar:!0,datasource:V.dest_data_source_uid});function Lp(V){return{recordedQueries:lh(V.recordedQueries)}}const Ec={getRecordedQueriesAsync:oh},Ig=(0,he.connect)(Lp,Ec),Ag=({onAddQuery:V,getRecordedQueriesAsync:ye,recordedQueries:Be,onChangeDataSource:Je,filterValue:it})=>{const[bt,Qt]=(0,I.useState)(!1),[un,an]=(0,I.useState)(it),[Ln,$n]=(0,I.useState)([]),Hn=(0,D.of)(_c);(0,I.useEffect)(()=>{ye()},[bt,ye]);const Wn=(xs,ua)=>{$n(ua?Ln.concat(xs):Ln.filter(ca=>!(0,Dn.isEqual)(ca,xs)))},es=()=>{(0,l.rR)("cloud_user_clicked_add_selected_recorded_queries",{recorded_queries_selected:Ln.map(ua=>ua.name)});const xs=(0,Ul.l)().getInstanceSettings(yg.uv);Je?.(xs),Ln.map(Og).forEach(ua=>{V?.(ua)}),Qt(!1),$n([]),Zl.A.emit(H.r1.alertSuccess,["Selected recorded queries added to the editor. The data source has been changed to mixed."])},us=Lg(Be,un).map(xs=>(0,a.jsx)(Rg,{onQueryToggle:Wn,recordedQuery:xs},xs.id)),ps=()=>{Qt(!1),$n([])},ds=()=>{(0,l.rR)("cloud_user_clicked_add_recorded_query_button"),Qt(!0)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.$n,{icon:"plus",onClick:ds,variant:"secondary",className:Hn.openButton,children:"Recorded query"}),(0,a.jsxs)(re.a,{isOpen:bt,title:"Add recorded query",onDismiss:ps,className:Hn.modal,children:[(0,a.jsx)(xg,{value:un?.name,onChange:an}),(0,a.jsxs)($t.F,{title:"",severity:"info",children:["To create a new Recorded Query, return to the query editor and use the "," ",(0,a.jsx)(u.I,{name:"record-audio"})," "," icon in the series bar."]}),us.length>0?us:un&&(0,a.jsxs)("div",{className:Hn.noQueries,children:["No recorded queries available for ",un?.name]}),(0,a.jsxs)("div",{className:Hn.modalButtons,children:[(0,a.jsx)(ee.$n,{variant:"secondary",className:Hn.modalButton,onClick:ps,children:"Cancel"}),(0,a.jsx)(ee.$n,{variant:"primary",className:Hn.modalButton,onClick:es,disabled:Ln.length===0,children:"Add"})]})]})]})},Rg=({onQueryToggle:V,recordedQuery:ye})=>{const[Be,Je]=(0,I.useState)(!1);return(0,a.jsx)(sh,{recordedQuery:ye,buttons:[(0,a.jsx)(Jl.S,{name:ye.id,value:Be,onChange:()=>{V(ye,!Be),Je(!Be)}},`${ye.id}-checked`)]})},Lg=(V,ye)=>{const Be=(0,Ul.l)();return V.filter(Je=>Je.active).filter(Je=>!ye||Je.queries[0].datasource.uid===ye.uid).sort((Je,it)=>{const bt=Be?.getInstanceSettings(Je.queries[0]?.datasource),Qt=Be?.getInstanceSettings(it.queries[0]?.datasource),un=bt?.meta.name.localeCompare(Qt?.meta.name??"");if(un!==void 0&&un!==0)return un;const an=bt?.name.localeCompare(Qt?.name??"");return an!==void 0&&an!==0?an:Je.name.localeCompare(it.name)})},_c=V=>({modalButtons:(0,y.css)`
      display: flex;
      justify-content: end;
    `,openButton:(0,y.css)`
      margin-left: -8px;
    `,modalButton:(0,y.css)`
      margin-left: ${V.spacing(1)};
    `,modal:(0,y.css)`
      width: 750px;
    `,noQueries:(0,y.css)`
      margin-left: ${V.spacing(1)};
      margin-bottom: ${V.spacing(3)};
    `}),jg=Ig(Ag);var Xl=e(12470),Ud=e(43127),Hc=e(92041),Bg=e(51253),Nd=e(5308),ch=e(88448),kc=e(10343),Gc=e(20601),Qc=e(24240),Dc=e(87421);const dh=[{label:"30 seconds",value:30},{label:"1 minute",value:60},{label:"5 minutes",value:300},{label:"30 minutes",value:1800},{label:"1 hour",value:3600},{label:"12 hours",value:43200},{label:"24 hours",value:86400},{label:"1 week",value:604800},{label:"1 month",value:2592e3}],Ug=({label:V,description:ye,value:Be,onChange:Je})=>(0,a.jsx)("div",{children:(0,a.jsx)(_.D,{label:V,description:ye,required:!0,children:(0,a.jsx)(p.l6,{options:dh,onChange:it=>{Je(it.value)},value:Be,"aria-label":`${V}-select`,menuShouldPortal:!0})})});function Yc(V){return{variables:(0,Dc.UN)(V)}}const mo=(0,he.connect)(Yc),bc=({href:V,trackingSource:ye})=>{const Be=(0,D.of)(uh);return(0,a.jsx)("a",{href:V,className:Be.docsLink,target:"_blank",rel:"noreferrer",onClick:()=>(0,l.rR)("cloud_user_clicked_create_recorded_query_modal_documentation_icon",{source:ye}),children:(0,a.jsx)(u.I,{name:"info-circle"})})},Eo=({query:V,queries:ye,dataSource:Be,variables:Je})=>{const[it,bt]=(0,I.useState)(!1),[Qt,un]=(0,I.useState)(),[an,Ln]=(0,I.useState)("info"),[$n,Hn]=(0,I.useState)(""),Wn=(0,D.of)(ch.o),es=(0,D.of)(uh);(0,I.useEffect)(()=>{(async()=>{r.contextSrv.hasPermission(fe.LicensingRead)&&un(await li().catch(()=>{}))})()},[]);const us=()=>{Hn(""),Ln("info"),bt(!1)},ps=async pa=>{try{return await ua(pa,ca)}catch(qs){Ln("error"),(0,S.NF)(qs)&&Hn(qs.data.message);return}},ds=async pa=>{const qs=await ps(pa);qs&&Sg(qs).then(()=>{Ln("success"),Hn("Your new recorded query is recording successfully!"),(0,l.rR)("cloud_user_created_recorded_query")}).catch(js=>{Ln("error"),Hn(js.data.message)})},xs=async pa=>{const qs=await ps(pa);qs&&Tg(qs).then(js=>{Ln("info"),Hn(js.data.message)}).catch(js=>{Ln("error"),Hn(js.data.message)})},ua=async(pa,qs)=>{const js={target_ref_id:V?V.refId:"",name:pa.name,description:pa.description,interval:pa.interval,range:pa.range,count:pa.isCount,active:!0},$a=ye?.map(async Ia=>{const fr=Ia.datasource||Be?.name,Va=await(0,Ul.l)().get(fr),Ir=Va.interpolateVariablesInQueries?Va.interpolateVariablesInQueries([Ia],{...qs})[0]:Ia;return Ir.datasourceId=Va?Va.id:-1,Ir.datasource===void 0&&(Ia.datasource!==void 0&&Ia.datasource!==null?Ir.datasource=Ia.datasource:Va&&(Ir.datasource={uid:Va.uid,type:Va.type})),Ir});return js.queries=$a?await Promise.all($a):[],js},ca=Je?.filter(pa=>pa.hide!==Xl.zL.hideVariable),Ds=(0,a.jsxs)("h2",{className:Wn.modalHeaderTitle,children:["Create recorded query",(0,a.jsx)(bc,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"modal-title"})]}),Ws=an!=="success"?(0,a.jsx)("div",{"aria-label":"Test the recorded query",children:(0,a.jsx)(u.I,{name:"sync"})}):void 0,er=an==="success"?(0,a.jsx)(ee.$n,{type:"button",variant:"primary",onClick:us,"aria-label":"Close recording query button",children:"Close"}):(0,a.jsx)(ee.$n,{type:"button",variant:"secondary",onClick:us,fill:"outline","aria-label":"Cancel recording query button",children:"Cancel"}),hr=()=>{switch(an){case"info":return $n===""?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)(a.Fragment,{children:["Results:",(0,a.jsx)("pre",{children:$n})]});default:return(0,a.jsx)(a.Fragment,{children:$n})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(kc.q,{title:"Create recorded query",icon:"record-audio",onClick:()=>{bt(!0),(0,l.rR)("cloud_user_clicked_create_recorded_query_icon")}}),(0,a.jsx)(re.a,{isOpen:it,title:Ds,onDismiss:us,className:es.modal,children:(0,a.jsx)(Bg.l,{onSubmit:ds,validateOn:"all",children:({register:pa,errors:qs,control:js,getValues:$a})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Name",description:"Give this query a name",invalid:!!qs.name,error:qs.name?.message,required:!0,children:(0,a.jsx)(De.p,{...pa("name",{required:{value:!0,message:"Name is required"}}),id:"add-recorded-query-name",autoFocus:!0})}),(0,a.jsx)(_.D,{label:"Description",description:"Provide a description for this query",children:(0,a.jsx)(De.p,{...pa("description"),id:"add-recorded-query-desc"})}),(0,a.jsx)("div",{className:es.timeSelect,children:(0,a.jsx)(te.xI,{name:"interval",control:js,defaultValue:dh[0].value,render:({field:{ref:Ia,value:fr,onChange:Va,...Sr}})=>(0,a.jsx)(Ug,{label:"Interval",description:"Decide how often to record this query",value:fr,onChange:Va})})}),(0,a.jsx)("div",{className:es.timeSelect,children:(0,a.jsx)(te.xI,{name:"range",control:js,defaultValue:(0,Ud.Cn)().from,render:({field:{ref:Ia,value:fr,onChange:Va,...Sr}})=>{const Ir=(0,a.jsxs)(a.Fragment,{children:["Select this query's relative time range",(0,a.jsx)(bc,{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/#time-units-and-relative-ranges",trackingSource:"time-range"})]}),rl=(0,a.jsx)(mn.J,{description:Ir,children:"Relative Time Range *"});return(0,a.jsx)(_.D,{label:rl,invalid:!!qs.range,error:qs.name?.message,required:!0,children:(0,a.jsx)(Nd.N,{timeRange:{from:fr,to:0},onChange:dl=>Va(dl.from)})})}})}),ca?.length>0?(0,a.jsx)(_.D,{label:"Template variables",description:"Select a value for each template variable",children:(0,a.jsx)(a.Fragment,{children:ca.map(Ia=>{const{picker:fr,setValue:Va}=Gc.B.get(Ia.type);return(0,a.jsx)(Ie.I,{label:Ia.name,labelWidth:16,children:(0,a.jsx)(fr,{onVariableChange:Sr=>{(0,Qc.SP)(Sr)&&!(0,Hc.R)(Sr.current)&&Va(Sr,Sr.current)},variable:Ia,readOnly:!1})},Ia.name)})})}):null,(0,a.jsx)(_.D,{label:"Count query results",description:(0,a.jsxs)(a.Fragment,{children:["Count the rows returned from this query",(0,a.jsx)(bc,{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#create-a-recorded-query",trackingSource:"count-field"})]}),children:(0,a.jsx)(Q.d,{...pa("isCount"),id:"add-recorded-query-count"})}),(0,a.jsxs)($t.F,{className:es.testQuery,severity:an,title:an==="success"?"Successful":"Test this recorded query",buttonContent:Ws,onRemove:an!=="success"?()=>xs($a()):void 0,children:[hr(),$n==="An unknown issue is preventing the system from processing your query."&&Ng(Qt)]}),(0,a.jsxs)(re.a.ButtonRow,{children:[er,an!=="success"&&(0,a.jsx)(ee.$n,{type:"submit","aria-label":"Start recording query button",children:"Start recording query"})]})]})})})]})},Ng=V=>{let ye="https://grafana.com/contact";return V&&V.slug&&V.lid&&(ye=`https://grafana.com/orgs/${V.slug}/tickets?support=licensing&licenseId=${V.lid}`),(0,a.jsxs)(a.Fragment,{children:["To submit a support ticket to Grafana Labs, complete the ",(0,a.jsx)("a",{href:ye,children:"Contact Grafana Labs"})]})},uh=V=>({modal:(0,y.css)`
      width: 550px;
    `,testQuery:(0,y.css)`
      margin-top: ${V.spacing(3)};
    `,timeSelect:(0,y.css)`
      width: 50%;
    `,docsLink:(0,y.css)`
      margin-left: ${V.spacing(.5)};
    `}),wg=mo(Eo),hh=()=>{const ye=jd.M_.getState().recordedQueries.prometheusWriteTarget;return!!ye?.data_source_uid&&!!ye?.remote_write_path};function Fg(){(0,n.a)("recordedqueries")&&s.$?.recordedQueries?.enabled&&(r.contextSrv.user.orgRole!==""&&(0,jd.JD)(ih()),eh.d.addExtraRenderAction(ye=>hh()&&(ye.dataSource?.meta.backend||(0,vg.s9)(ye.dataSource))?(0,a.jsx)(wg,{...ye}):null),eh.m.addExtraRenderAction(ye=>hh()?(0,a.jsx)(jg,{...ye}):null))}var wd=e(39419),jp=e(76442);const Bp=()=>{const V=(0,D.of)(fh);return(0,a.jsx)(jp.c,{className:V.cta,message:"No recorded queries defined",footer:(0,a.jsxs)("span",{children:[(0,a.jsx)(u.I,{name:"rocket"}),"ProTip: ","You can record queries from the query editor."]},"proTipFooter"),callToActionElement:(0,a.jsx)(a.Fragment,{})})},fh=V=>({cta:(0,y.css)`
      text-align: center;
    `});function gh(V){return{navModel:(0,fi.tc)(V.navIndex,"recordedQueries"),recordedQueries:lh(V.recordedQueries),isLoading:V.recordedQueries.isLoading}}const Up={getRecordedQueriesAsync:oh,updateRecordedQuery:Pg,deleteRecordedQuery:Cg},Np=(0,he.connect)(gh,Up),Wg=({navModel:V,isLoading:ye,recordedQueries:Be,getRecordedQueriesAsync:Je,updateRecordedQuery:it,deleteRecordedQuery:bt})=>{(0,I.useEffect)(()=>{Je()},[Je]);const Qt=(0,D.of)(wp),[un,an]=(0,I.useState)(),Ln=Be.map(Hn=>{const Wn=[(0,a.jsx)(ee.$n,{onClick:async()=>{await it({...Hn,active:!Hn.active})},variant:Hn.active?"secondary":"primary",children:Hn.active?"Pause recording":"Resume recording"},"toggle-recorded-query-active"),(0,a.jsx)(ee.$n,{"aria-label":"Delete recorded query",onClick:()=>an(Hn),variant:"destructive",children:"Delete"},"delete-recorded-query")];return(0,a.jsx)(sh,{recordedQuery:Hn,buttons:Wn},Hn.id)}),$n=()=>ye?(0,a.jsx)(wd.A,{}):Ln.length===0?(0,a.jsx)(Bp,{}):Ln;return(0,a.jsx)(G.Y,{navModel:V,children:(0,a.jsxs)(G.Y.Contents,{children:[(0,a.jsx)("div",{className:Qt.header,children:(0,a.jsx)(ee.z9,{icon:"cog",href:"/recorded-queries/write-target",children:"Edit remote write target"})}),$n(),un&&(0,a.jsx)(fs.u,{isOpen:!0,icon:"trash-alt",title:"Delete",body:(0,a.jsxs)("div",{children:["Are you sure you want to delete '",un.name,"'?"]}),confirmText:"Delete",onDismiss:()=>an(void 0),onConfirm:async()=>{await bt(un),an(void 0)}})]})})},wp=V=>({header:(0,y.css)`
      display: flex;
      justify-content: flex-end;
      margin-bottom: ${V.spacing(1)};
    `,title:(0,y.css)`
      margin-bottom: 0;
      width: 100%;
    `}),Fp=Np(Wg);function Wp(V){return{navModel:(0,fi.tc)(V.navIndex,"recordedQueries"),prometheusWriteTarget:Mg(V.recordedQueries)}}const Kp={getPrometheusWriteTarget:ih},$p=(0,he.connect)(Wp,Kp),Vp=({navModel:V,prometheusWriteTarget:ye,getPrometheusWriteTarget:Be})=>{const[Je,it]=(0,I.useState)(),[bt,Qt]=(0,I.useState)(ye?.remote_write_path),un=(0,D.of)(zp),{register:an,handleSubmit:Ln}=(0,te.mN)({defaultValues:ye});(0,I.useEffect)(()=>{Be()},[Be]),(0,I.useEffect)(()=>{(async()=>{if(ye){const es=await(0,Ul.l)().getInstanceSettings(ye.data_source_uid);it(es)}})()},[ye]);const $n=Wn=>{Kg(Je?.uid,Wn.remote_write_path)},Hn=(0,a.jsxs)("span",{children:["Select the data source where metrics will be written",(0,a.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/enterprise/recorded-queries/#remote-write-target",className:un.docsLink,target:"_blank",rel:"noreferrer",children:(0,a.jsx)(u.I,{name:"info-circle"})})]});return(0,a.jsx)(G.Y,{navModel:V,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsxs)("form",{onSubmit:Ln($n),style:{maxWidth:"600px"},children:[(0,a.jsx)(_.D,{label:Hn,children:(0,a.jsx)(nh.s,{onChange:it,current:Je?.name,placeholder:"Select a data source",type:"prometheus",noDefault:!0,alerting:!0,"aria-label":"Write target config select data source"})}),(0,a.jsx)(_.D,{label:"Remote write path",children:(0,a.jsx)(De.p,{...an("remote_write_path"),onChange:Wn=>Qt(Wn.currentTarget.value),placeholder:"/api/v1/write","aria-label":"Write target config remote write path"})}),(0,a.jsx)(ee.$n,{disabled:!bt||!Je,type:"submit","aria-label":"Write target config save",children:"Save"})]},ye?.data_source_uid)})})};function Kg(V,ye){Bd({data_source_uid:V,remote_write_path:ye}).then(()=>{Zl.A.emit(H.r1.alertSuccess,["Prometheus remote write target created"])}).catch(Be=>{Zl.A.emit(H.r1.alertError,[Be.data.message])})}const zp=V=>({docsLink:(0,y.css)`
      margin-left: ${V.spacing(1)};
    `}),_p=$p(Vp);var $g=e(71733),Hp=e(76323),ph=e(1702),Jc=e(22699),Zc=e(65163),Vg=e(91119),mh=e(85174),Pc=e(76885),vh=e(74856),wl=e(34842),Xc=e(25304);const Fd="/public/img/grafana_icon.svg",qc="https://grafana.com/static/assets/img/grafana_logo_lockup_ltbg.png",Yi="/reports",zg="api/reports/images/",Cc=2,Wd={1:{label:"Zoom in",style:{transform:"translateX(-10%)"}},2:{label:"Standard"},3:{label:"Zoom out",style:{width:"100%",left:"91%"}}};var yh=e(75096);const Kd=()=>{if(!window.Intl)return"";const V=window.Intl.DateTimeFormat();if(!V.resolvedOptions)return"";const ye=V.resolvedOptions();return ye.timeZone?ye.timeZone:""},ed={from:"",to:"",raw:{from:"",to:""}},$d={id:0,name:"",recipients:"",replyTo:"",message:`Hi, 
Please find attached a PDF status report. If you have any questions, feel free to contact me!
Best,`,dashboardId:void 0,dashboardName:"",dashboards:[{dashboard:void 0,timeRange:ed.raw}],schedule:{frequency:je.Weekly,timeZone:Kd()},formats:[at.PDF],scaleFactor:Cc,options:{orientation:"landscape",layout:"grid",timeRange:ed.raw},enableDashboardUrl:!0,state:Fe.Scheduled},td={reports:[],report:$d,hasFetchedList:!1,hasFetchedSingle:!1,searchQuery:"",reportCount:0,isLoading:!0,isUpdated:!1,visitedSteps:[],settings:{branding:{reportLogoUrl:"",emailLogoUrl:"",emailFooterMode:_e.SentBy,emailFooterText:"",emailFooterLink:""}}},Vd=(0,Ks.Z0)({name:"reports",initialState:td,reducers:{reportsLoaded:(V,ye)=>({...V,reports:ye.payload,reportCount:ye.payload.length,hasFetchedList:!0}),reportLoaded:(V,ye)=>({...V,report:ye.payload,hasFetchedSingle:!0,isLoading:!1}),updateReportProp:(V,ye)=>({...V,isUpdated:!0,report:ye.payload}),clearReportState:V=>({...V,isUpdated:!1,visitedSteps:[],report:$d}),reportLoadingBegin:V=>({...V,isLoading:!0}),reportLoadingEnd:V=>({...V,isLoading:!1}),testEmailSendBegin:V=>({...V,testEmailIsSending:!0}),testEmailSendEnd:V=>({...V,testEmailIsSending:!1}),setLastUid:(V,ye)=>({...V,lastUid:(0,yh.q4)(ye.payload)}),addVisitedStep:(V,ye)=>({...V,visitedSteps:[...V.visitedSteps,...ye.payload]})}}),{clearReportState:ni,reportLoaded:_g,reportsLoaded:Hg,updateReportProp:ql,reportLoadingBegin:kg,reportLoadingEnd:Gg,testEmailSendBegin:Qg,testEmailSendEnd:Yg,setLastUid:ec,addVisitedStep:Sa}=Vd.actions,Jg={reports:Vd.reducer},zd=V=>V?.length?Object.fromEntries(V.map(ye=>{const{getValueForUrl:Be}=Gc.B.get(ye.type),Je=Be(ye);return[ye.name,Array.isArray(Je)?Je:[Je]]})):{},bl=V=>{if(!V?.length)return{};const ye=(0,yh.pY)();return Object.fromEntries(V.map(Be=>{const{name:Je}=Be.state,it=ye[Je],bt=(Array.isArray(it)?it:[it]).map(Qt=>Qt?.toString()??"");return[Je,bt]}))},Zg=(V,ye,Be)=>!ye||!Object.keys(ye).length?V.map(Je=>({...Je,usedInRepeat:Be?.has(Je.name)})):V.map(Je=>{const it=ye[Je.name];if(!it||!(0,Qc.SP)(Je))return Je;const bt=it.map(un=>Je.options.find(an=>an.value===un)||{text:un,value:un}).filter(Boolean),Qt="multi"in Je&&Je.multi;return{...Je,usedInRepeat:Be?.has(Je.name),current:{...Je.current,text:Qt?bt.map(un=>un?.text):bt[0].text,value:Qt?bt.map(un=>un?.value):bt[0].value},options:Je.options.map(un=>({...un,selected:typeof un.value=="string"&&it.includes(un.value)}))}}),Xg=()=>{const V="var-",ye=new URLSearchParams(window.location.search),Be={};for(const[Je,it]of ye.entries())if(Je.startsWith(V)){const bt=Je.replace(V,"");Be[bt]=[...Be[bt]||[],it]}return Be},_d=V=>V.some(ye=>(0,Qc.P4)(ye)&&ye.refresh===Xl.CO.onTimeRangeChanged),Hr=(V,ye,Be)=>{const Je=tc(V,ye,Be);return Je&&Je.usedInRepeat},tc=(V,ye,Be)=>Be.find(Je=>"current"in Je&&Je.current.value?Je.current.value.length===1&&Je.current.value[0]===V&&Je.type===ye:!1),xh=()=>{if(!window.location.search)return null;const V=new URLSearchParams(window.location.search);return{timeRange:{to:V.get("to")||"",from:V.get("from")||""},dashboard:{uid:V.get("db-uid")||"",name:V.get("db-name")||""},variables:Xg()}},kp=V=>{if(V.id)return V;const ye=xh();if(!ye)return V;const{timeRange:Be,dashboard:Je,variables:it}=ye;let bt=[...initialState.report.dashboards];return Be?.from&&Be?.to&&(bt[0]={...bt[0],timeRange:{...Be,raw:Be}}),Je.name&&Je.uid&&(bt[0]={...bt[0],dashboard:{uid:Je.uid,name:Je.name}}),it&&Object.keys(it).length&&(bt[0]={...bt[0],reportVariables:it}),{...V,dashboards:bt}},qg=()=>{const V=new URLSearchParams(window.location.search),ye=V.get("to"),Be=V.get("from");return Be&&ye?{from:Be,to:ye}:null},Sc=(V,ye)=>`${Yi}/${V}${ye?"/"+ye:""}`,Eh=V=>ye=>`${Yi}/${ye}${V?"/"+V:""}`,Hd=V=>{const ye=Pc.kM.toUrlParams((0,Xc.z)()),Be=Pc.kM.toUrlParams((0,vh.jG)().timeRangeForUrl()),Je=V instanceof wl.H$?V?.state.uid:V?.uid,it=V instanceof wl.H$?V?.state.title:V?.title;return`reports/new/?${ye}&${Be}&db-uid=${Je}&db-name=${it}`},sd=({dashboard:V,onDismiss:ye})=>{const Be=(0,D.of)(Dh),Je=!(0,n.a)("reports.creation");function it(){(0,l.rR)("dashboards_sharing_report_create_clicked"),ye&&ye()}return Je?(0,a.jsxs)("div",{className:Be.container,children:[(0,a.jsx)($e.Iz,{featureName:"reporting",featureId:"reporting-tab"}),(0,a.jsx)($e.ep,{image:"reporting-email.png",featureName:"reporting",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/reporting",description:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,Ye.z5)()&&(0,a.jsxs)("div",{className:Be.highlight,children:[(0,a.jsx)($e.Iz,{featureId:"reporting-tab",eventVariant:"trial",featureName:"reporting",text:"Create unlimited reports during your trial of Grafana Pro."}),(0,a.jsx)("h3",{children:"Get started with reporting"}),(0,a.jsx)("h6",{children:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule."})]}),(0,a.jsx)(ee.z9,{href:Hd(V),onClick:it,className:Be.button,children:"Create report using this dashboard"}),(0,Ye.z5)()&&(0,a.jsx)(ee.z9,{fill:"text",href:"https://grafana.com/docs/grafana/latest/enterprise/reporting",children:"Learn more"})]})},Dh=V=>({container:(0,y.css)`
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    `,button:(0,y.css)`
      margin-right: ${V.spacing(2)};
    `,highlight:(0,y.css)`
      margin-bottom: ${V.spacing(3)};

      h6 {
        font-weight: ${V.typography.fontWeightLight};
      }
    `});var Fl=e(17624),ad=e(28676),ep=e(34214),nc=e(72401);const Tc=(V,ye={hour:0,minute:0},Be)=>{const Je=`${ye.hour}:${ye.minute}:00`,it=typeof V=="string"?ll(V):V,bt=new Date(`${(0,h.KQ)(it).format("YYYY/MM/DD")} ${Je}`),Qt=(0,Il.LE)(bt.getTime(),{timeZone:Be,format:"Z"});return Pl((0,h.KQ)(bt).format())+Qt},Pl=V=>V.includes("Z")?V.replace("Z",""):V.slice(0,-6),ll=V=>V?(0,h.KQ)(V.split("T")[0]).toDate():"",rd=V=>String(V).length===1?`0${V}`:String(V),Mc=V=>{if(!V)return{hour:0,minute:0};const ye=V.match(/T(\d+):(\d+)/);if(ye){const[,Be,Je]=ye;return{hour:parseInt(Be,10),minute:parseInt(Je,10)}}return{hour:0,minute:0}},Gp=V=>V?dateTime(V).isBefore(dateTime()):!1,bh=(V,ye)=>{if(!V)return{time:void 0,date:void 0};const{hour:Be,minute:Je}=Mc(V);return{date:(0,Il.LE)(V,{format:"MMMM DD, YYYY",timeZone:ye??""}),time:`${rd(Be)}:${rd(Je)}`}},Ph=V=>{if(!V.from||!V.to)return"Dashboard time range";const ye=parseInt(V.from,10),Be=parseInt(V.to,10);return!isNaN(ye)&&!isNaN(Be)?(0,$c.describeTimeRange)({from:(0,h.KQ)(ye),to:(0,h.KQ)(Be)}):(0,$c.describeTimeRange)(V)},Ch=V=>!V||!V.from||!V.to,Wl=V=>[29,30,31].includes(V),sc="api/reports";function kd(){return async V=>{const ye=await(0,S.AI)().get(sc);V(Hg(ye))}}function Sh(V,ye,Be){return async Je=>{const it=await(0,ad.n)().getDashboardDTO(V),bt=new ep.G(it.dashboard,it.meta),Qt=od(bt.panels);if(_d(bt.templating.list)){const an=Ch(Be)?bt?.time:Be;(0,vh.jG)().setTime(an)}const un=Zg(bt.templating.list,ye||zd(bt.templating.list),Qt);await Je((0,nc._q)(it.dashboard.uid,{...bt,templating:{list:un}})),Je(ec(V))}}function od(V,ye=new Set){return V.forEach(Be=>{Be.repeat&&ye.add(Be.repeat),Be.panels&&od(Be.panels,ye)}),ye}function Gd(V){return async ye=>{ye(kg());try{const Be=await(0,S.AI)().get(`${sc}/${V}`);Be.dashboards||(Be.dashboards=[{dashboard:{uid:Be.dashboardUid,id:Be.dashboardId,name:Be.dashboardName},reportVariables:Be.templateVars,timeRange:Be.options.timeRange}]);for(const Je of Be.dashboards)Je.dashboard.uid&&await ye(Sh(Je.dashboard.uid,Je.reportVariables,Je.timeRange));ye(_g(Be))}catch{ye(Gg())}}}function Th(V){return ye=>(ye(Qg()),(0,S.AI)().post(`${sc}/test-email/`,V).finally(()=>ye(Yg())))}function cl(V){return async ye=>{await(0,S.AI)().delete(`${sc}/${V}`),ye(kd())}}function id(V){return async()=>{try{await(0,S.AI)().post(sc,V)}catch(ye){throw ye}}}function ld(V,ye){return async Be=>{const Je=["hour","minute","day"];V={...V,schedule:Object.fromEntries(Object.entries(V.schedule).filter(([it,bt])=>!Je.includes(it)))},await(0,S.AI)().put(`${sc}/${V.id}`,V),ye&&Be(kd())}}const tp=V=>(0,Dn.upperFirst)(V.map(ye=>{switch(ye){case at.CSV:case at.PDF:return ye.toUpperCase();case at.Image:return"embedded image";case at.PDFTablesAppendix:return"PDF tables appendix";case at.PDFTables:return"PDF tables"}}).join(", ")),Qd=(V={})=>{const{time:ye,startDate:Be,endDate:Je,endTime:it,timeZone:bt,frequency:Qt,dayOfMonth:un,workdaysOnly:an,intervalFrequency:Ln,intervalAmount:$n,sendTime:Hn}=V,Wn=!ye&&Be?Mc(String(Be)):ye,es=Be&&Hn!=="now"?Tc(Be,Wn,bt):"",us=Je&&![je.Once,je.Never].includes(Qt)?Tc(Je,it,bt):"",ps={frequency:Qt,timeZone:bt,workdaysOnly:an,intervalFrequency:Ln,intervalAmount:$n?parseInt($n,10):0,startDate:es,endDate:us,dayOfMonth:un===ze?ze:""};return Object.fromEntries(Object.entries(ps).filter(([ds,xs])=>xs))};function Yd(V){const ye=["th","st","nd","rd"],Be=V%100;return V+(ye[(Be-20)%10]||ye[Be]||ye[0])}const Mh=(V,ye=Ke.Hours)=>V===je.Custom&&ye===Ke.Hours,cd=(V,ye=Ke.Hours)=>[je.Hourly,je.Daily].includes(V)||Mh(V,ye);function dd({startDate:V,endDate:ye,intervalFrequency:Be=Ke.Hours,intervalAmount:Je=2,frequency:it,dayOfMonth:bt,timeZone:Qt,workdaysOnly:un}){if(!V)return"";const an="en-US",{hour:Ln,minute:$n}=Mc(V),Hn=rd($n),Wn=rd(Ln),es=(0,h.KQ)(ll(V)).locale(an).format("dddd"),us=bt==="last"?"last":Yd(ll(V).getDate());let ps,ds;const xs=(0,Fl.t)(Date.now(),Qt),ua=`at ${Wn}:${Hn}${xs?` ${xs}`:""}`,ca=un&&cd(it,Be)?", Monday to Friday":"";if(ye){const Ds=(0,h.KQ)(ll(V)).locale(an).format("LL"),Ws=(0,h.KQ)(ll(ye)).locale(an).format("LL");Ws!==Ds?ps=`${Ds} - ${Ws}`:ps=Ds}switch(it){case je.Monthly:ds=`Monthly on the ${us} day ${ua}`;break;case je.Weekly:ds=`Every ${es} ${ua}`;break;case je.Daily:ds=`Daily ${ua}`;break;case je.Hourly:ds=`Hourly at minute ${Hn}`;break;case je.Custom:ds=`Every ${Je} ${Be}`;break;case je.Once:ds=`Once on ${(0,h.KQ)(ll(V)).locale(an).format("LL")}`;break;case je.Never:ds="Never";break;default:ds=""}return ps&&ds?`${ds}, ${ps}${ca}`:(it===je.Custom&&(ds+=`, ${Be===Ke.Hours?`from ${Wn}:${Hn}${xs?` ${xs}`:""}`:`from ${(0,h.KQ)(ll(V)).locale(an).format("LL")}`}`),ds+ca)}const np=new Map([[je.Monthly,"month"],[je.Daily,"day"],[je.Weekly,"week"],[je.Hourly,"hour"]]),$i=V=>{const{frequency:ye,intervalFrequency:Be=Ke.Hours,intervalAmount:Je="2"}=V;if(ye===je.Never)return"The report will not be sent.";const it=V.workdaysOnly?", Monday to Friday.":".",bt=[];if(!V.startDate){bt.push("The report will be sent immediately after it is saved");const un=ye===je.Custom?`${Je} ${Be}`:np.get(ye);return un&&bt.push(`and will be sent every ${un}`),bt.join(" ")+it}const Qt=dd(Qd(V));return Qt&&bt.push(`The report will be sent: ${Qt}.`),bt.join(" ")},Fo=V=>{const ye=td.report.schedule;return Object.keys(ye).length!==Object.keys(V).length?!0:Object.entries(ye).some(([Be,Je])=>Je!==V[Be])},ko=V=>Array.isArray(V)?V?.length:!0,Jd=V=>{const ye=[{step:tt.SelectDashboard,fields:["dashboards"]},{step:tt.FormatReport,fields:["formats"]},{step:tt.Share,fields:["name","recipients"]}],Be=!V.dashboards?.[0]?.dashboard?.uid;return Ko.reduce((Je,it)=>{if(Je[it.id]={valid:!0},it.id===tt.SelectDashboard)return Je[tt.SelectDashboard].valid=!Be,Je;{const bt=ye.find(Qt=>Qt.step===it.id)?.fields;return bt&&(Je[it.id].valid=bt.every(Qt=>V[Qt]&&ko(V[Qt]))),Je}},{})},Zd=(V,ye)=>{const Be=Jd(V);return ye?!Be[ye].valid:Object.values(Be).some(Je=>!Je.valid)},Kl=({uid:V,name:ye,className:Be})=>{const Je=(0,D.of)(Xd);return V?(0,a.jsx)("a",{href:`${s.$.appUrl}d/${V}`,className:(0,y.cx)(Je.link,Be),target:"_blank",rel:"noreferrer",children:ye||"View dashboard"}):null},Xd=V=>({link:(0,y.css)`
      display: inline-block;
      color: ${V.colors.text.link};
      margin-top: ${V.spacing(1)};
      font-size: ${V.typography.bodySmall.fontSize};

      :hover {
        text-decoration: underline;
      }
    `}),tl=V=>{if(!V)return Ko[0];const ye=Ko.findIndex(Be=>Be.id===V);return ye===Ko.length-1?Ko[ye]:Ko[ye+1]},qd=V=>{if(!V||V===Ko[0].id)return;const ye=Ko.findIndex(Be=>Be.id===V);return Ko[ye-1]},sp=(V,ye)=>{const Be=qd(V);Be&&Be.id!==V&&Nt.Ny.push(Sc(Be.id,ye))};var Wo=e(13390);const so={reportForm:{nextStep:V=>`data-testid report form next ${V}`,previousStep:V=>`data-testid report form previous ${V}`,selectDashboard:V=>`data-testid report select dashboard ${V}`,formatCheckbox:V=>`data-testid report form checkbox format ${V}`,nameInput:"data-testid report name input",sendTestEmailButton:"data-testid report send test email button",useRecipientsCheckbox:"data-testid report send test email use recipients checkbox",sendTestEmailConfirmButton:"data-testid report send test email confirm button",submitButton:"data-testid report form submit button"},scheduleReport:{shareMenuItem:"data-testid new share button schedule report"}},pi={pages:{Report:{url:"/reports",createButtonCTA:Wo.X.CallToActionCard.buttonV2("Create a new report")}},components:so},rc=(0,I.forwardRef)(({activeStep:V,disabled:ye,reportId:Be},Je)=>{const it=(0,D.of)(oc),bt=(0,I.useRef)(null),Qt=qd(V),un=tl(V),an=un.id===V;return(0,I.useImperativeHandle)(Je,()=>({click:()=>{bt.current?.click()}})),(0,a.jsx)("div",{className:it.buttonRow,children:(0,a.jsx)("div",{className:it.buttonRowInner,children:(0,a.jsxs)("div",{children:[Qt&&(0,a.jsxs)(ee.$n,{variant:"secondary",onClick:()=>sp(V,Be),"data-testid":pi.components.reportForm.previousStep(Qt.name),children:["Previous: ",Qt.name]}),!an&&(0,a.jsx)(ee.$n,{ref:bt,disabled:ye,type:"submit","data-testid":pi.components.reportForm.nextStep(un.name),children:`Next: ${un.name}`})]})})})});rc.displayName="ButtonRow";const oc=V=>({buttonRow:(0,y.css)`
      display: flex;
      padding: ${V.spacing(2,0,.5,0)};
      border-top: 1px solid ${V.colors.border.weak};
      width: 100%;
      background-color: ${V.colors.background.primary};
      button {
        &:first-of-type {
          margin-right: ${V.spacing(2)};
        }
        &:last-of-type {
          margin-right: 0;
        }
      }
    `,buttonRowInner:(0,y.css)`
      display: flex;
      justify-content: space-between;
      width: 100%;
    `}),eu=V=>V?V.frequency===je.Never?"Save and exit":V.startDate?"Schedule send":"Send now":"Save report",Li=V=>{const ye=V.state,Be=V.schedule.frequency===je.Never,Je=Be||[Fe.Draft,Fe.Expired,Fe.Paused].includes(ye),it=Be||[Fe.Expired].includes(ye);return{isNever:Be,showPlay:Je,disableEdit:it,reportState:ye}},ap=V=>{let ye=Fe.Scheduled;return V===Fe.Expired?ye=V:V!==Fe.Paused&&(ye=Fe.Paused),ye},Oh=V=>{const{report:ye}=V.reports;return{report:ye}},Ih={loadReport:Gd,deleteReport:cl,updateReport:ld},rp=(0,he.connect)(Oh,Ih),op=({report:V,loadReport:ye,deleteReport:Be,updateReport:Je,disabled:it})=>{const bt=(0,D.of)(Pi),[Qt,un]=(0,I.useState)(!1),an=Ni.TP.hasPermission(fe.ReportingDelete),Ln=Ni.TP.hasPermission(fe.ReportingWrite),{showPlay:$n,disableEdit:Hn,reportState:Wn}=Li(V),es=async()=>{const ps=ap(Wn);await Je({...V,state:ps}),V.id&&ye(V.id)},us=()=>{Be(V.id),un(!1),Nt.Ny.push(Yi)};return(0,a.jsxs)("div",{className:bt.editActions,children:[(0,a.jsx)(ee.z9,{href:Sc(tt.SelectDashboard,V.id),type:"button",disabled:!Ln,children:"Edit report"}),(0,a.jsx)(ee.$n,{type:"button",variant:"secondary",disabled:Hn||!Ln||it,onClick:es,children:$n?Wn===Fe.Draft?eu(V.schedule):"Resume":"Pause"}),(0,a.jsx)(Qn.K,{variant:"destructive","aria-label":"Delete report",tooltip:"Delete",name:"trash-alt",disabled:!an,onClick:()=>un(!0)}),(0,a.jsx)(fs.u,{isOpen:Qt,title:"Delete report",body:"Are you sure you want to delete this report?",confirmText:"Delete",onConfirm:us,onDismiss:()=>un(!1)})]})},Pi=V=>({editActions:(0,y.css)`
      display: flex;
      align-items: center;
      justify-content: flex-end;
      width: 100%;
      margin-bottom: ${V.spacing(3)};

      button,
      a {
        margin-left: ${V.spacing(2)};
      }
    `}),nl=rp(op),tu=(0,I.forwardRef)(({saveDraft:V,children:ye,existingReport:Be,disabled:Je,activeStep:it,onDiscard:bt,schedule:Qt},un)=>{const an=(0,D.of)(ip),Ln=tl(it),$n=(0,I.useRef)(null),Hn=Ln.id===it,Wn=Be?"Update report":eu(Qt);return(0,I.useImperativeHandle)(un,()=>({click:()=>{$n.current?.click()}})),(0,a.jsxs)("div",{className:an.container,children:[Hn&&(0,a.jsx)(ee.$n,{ref:$n,disabled:Je,type:"submit","data-testid":pi.components.reportForm.submitButton,children:Wn}),(0,a.jsx)(ee.$n,{variant:"secondary",onClick:V,children:"Save as draft"}),ye,(0,a.jsx)(ee.$n,{variant:"destructive",fill:"outline",onClick:bt,children:"Discard"})]})});tu.displayName="PageActions";const ip=V=>({container:(0,y.css)`
      display: flex;
      justify-content: flex-end;
      width: 100%;

      & > button,
      & > a {
        margin-right: ${V.spacing(3)};
      }
    `}),ud=V=>{const{report:ye,isUpdated:Be,visitedSteps:Je}=V.reports;return{existingReport:!!ye.id,isUpdated:Be,report:ye,visitedSteps:Je}},hd={addVisitedStep:Sa,clearReportState:ni,createReport:id,updateReport:ld},lp=(0,he.connect)(ud,hd),cp=({activeStep:V,addVisitedStep:ye,children:Be,clearReportState:Je,confirmRedirect:it,createReport:bt,disabled:Qt,editMode:un,existingReport:an,getFormData:Ln,isUpdated:$n,onSubmit:Hn,report:Wn,reportId:es,updateReport:us,visitedSteps:ps,pageActions:ds})=>{const xs=(0,D.of)(dp),ua=tl(V),ca=(0,xe.W6)(),Ds=(0,I.useRef)(null),[Ws,er]=(0,I.useState)(!1);(0,I.useEffect)(()=>{(Sr=>{Sr===Ko[Ko.length-1].id?ye(Ko.map(Ir=>Ir.id)):ye([Sr])})(V)},[V,ye]),(0,I.useEffect)(()=>{Ws&&ca.push(Yi)},[Ws,ca]);const hr=Va=>{Va.preventDefault();const Sr=Sc(ua.id,es);Hn(),ca.push(Sr)},pa=async()=>{if(Ln){const Sr=Ln();Wn={...Wn,...Sr}}er(!0),await(Wn.id?us:bt)({...Wn,state:Fe.Draft}),(0,l.rR)("reports_draft_saved",{step:V,state:Wn.id?Wn.state:"new"}),Je()},qs=()=>{Je(),(0,l.rR)("reports_report_abandoned",{namePopulated:!!Wn.name,recipientsPopulated:!!Wn.recipients,replyToPopulated:!!Wn.replyTo,numberOfDashboardsSelected:Wn.dashboards.length,scheduleCustomized:Fo(Wn.schedule)})},js=Va=>!Ko.map(Ir=>Sc(Ir.id,es)).includes(Va.pathname),$a=()=>{const Va=Ko[Ko.length-1].id;V!==Va&&Ds.current?.click()},Ia=()=>{const Va=new URLSearchParams(ca.location.search),Sr=Va.get("db-uid");Sr?(Va.delete("db-uid"),Va.delete("db-name"),ca.push(`/d/${Sr}?${Va}`)):ca.push(Yi)},fr=(0,I.useMemo)(()=>Jd(Wn),[Wn]);return(0,a.jsxs)("form",{onSubmit:hr,className:xs.container,children:[un?(0,a.jsx)(nl,{disabled:Qt}):(0,a.jsx)(tu,{saveDraft:pa,existingReport:an,ref:Ds,activeStep:V,disabled:Qt,onDiscard:Ia,schedule:Wn.schedule,children:ds}),(0,a.jsx)(ue,{confirmRedirect:!Ws&&!!(it||$n),onDiscard:qs,onLocationChange:js}),(0,a.jsxs)("div",{className:xs.inner,children:[!un&&(0,a.jsx)(Gt,{activeStep:V,onStepChange:$a,getNextUrl:Eh(es),visitedSteps:ps,steps:Ko,validationResults:fr}),(0,a.jsxs)("div",{className:xs.content,children:[Be,!un&&(0,a.jsx)(rc,{ref:Ds,activeStep:V,disabled:Qt,reportId:es})]})]})]})},dp=V=>({container:(0,y.css)`
      display: flex;
      flex-direction: column;
      height: 100%;
      align-content: center;
    `,inner:(0,y.css)`
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      flex: 1 0 auto;
    `,content:(0,y.css)`
      padding-bottom: ${V.spacing(3)};
      width: min(70%, 800px);
    `}),Oc=lp(cp),up=V=>{const{report:ye,isUpdated:Be}=V.reports;return{report:ye,isUpdated:Be}},hp={createReport:id,updateReport:ld,clearReportState:ni},Ah=(0,he.connect)(up,hp)(({report:V,createReport:ye,updateReport:Be,clearReportState:Je,isUpdated:it,reportId:bt})=>{const{formats:Qt,options:un,schedule:an,dashboards:Ln}=V,{handleSubmit:$n,formState:{isSubmitSuccessful:Hn}}=(0,te.mN)(),Wn=(0,D.of)(nu),es=!!bt&&!it,us=Zd(V),{time:ps,date:ds}=bh(an.startDate,an.timeZone),{time:xs,date:ua}=bh(an.endDate,an.timeZone);(0,I.useEffect)(()=>{Hn&&Nt.Ny.push(Yi)},[Hn]);const ca=async()=>{const hr=V.id?Be:ye;if(V.state===Fe.Draft){const pa=V.schedule.frequency===je.Never?Fe.Never:Fe.Scheduled;V={...V,state:pa}}await hr(V),(0,l.rR)("reports_report_submitted",{replyToPopulated:!!V.replyTo,includesDashboardLink:V.enableDashboardUrl,numberOfDashboardsSelected:V.dashboards.length,templateVariablesSelected:V.dashboards.some(pa=>!!pa.reportVariables),orientation:V.options.orientation,layout:V.options.layout,frequency:V.schedule.frequency,sendTime:V.schedule.startDate?"later":"now",endDate:!!V.schedule.endDate}),Je()},{orientation:Ds,layout:Ws}=td.report.options,er=[{title:"Select dashboard",id:tt.SelectDashboard,items:(Ln||[]).flatMap((hr,pa,qs)=>[{title:`Source dashboard${pa===0?"*":""}`,value:hr.dashboard?.uid?(0,a.jsx)(Kl,{name:hr.dashboard.name,uid:hr.dashboard?.uid,className:Wn.dashboardLink}):"",id:"name",required:!0},{title:"Template variables",value:(0,a.jsx)(fp,{variables:hr.reportVariables,className:Wn.title})},{title:"Time range",value:Ph(hr.timeRange)},...qs.length>1&&pa!==qs.length-1?[{title:"",value:""}]:[]])},{title:"Format report",id:tt.FormatReport,items:[{title:"Preferred format*",value:tp(Qt),id:"formats",required:!0},...Qt.includes(at.PDF)?[{title:"PDF orientation",value:(0,Dn.capitalize)(un.orientation||Ds)},{title:"PDF layout",value:(0,Dn.capitalize)(un.layout||Ws)},{title:"Scale factor",value:Wd[V.scaleFactor||Cc].label}]:[]]},{title:"Schedule",id:tt.Schedule,items:[{title:"Recurrence",value:(0,Dn.capitalize)(an.frequency)},...an.frequency===je.Custom?[{title:"Repeat every",value:`${an.intervalAmount} ${an.intervalFrequency}`}]:[],...an.frequency!==je.Never?[{title:"Start date",value:ds||"Now"},{title:"Start time",value:ps||"Now"},{title:"End date",value:ua},{title:"End time",value:xs},{title:"Time zone",value:an.timeZone?(0,Fl.t)(Date.now(),an.timeZone):""}]:[],...cd(an.frequency,an.intervalFrequency)?[{title:"Send Monday to Friday only",value:an.workdaysOnly?(0,a.jsx)(u.I,{name:"check",size:"xl"}):(0,a.jsx)(u.I,{name:"minus",size:"xl"})}]:[],{value:$i(V.schedule),title:""}]},{title:"Share",id:tt.Share,items:[{title:"Report name*",value:V.name,id:"name",required:!0},{title:"Recipients*",value:V.recipients,id:"recipients",required:!0},{title:"Reply-to-email",value:V.replyTo||"none"},{title:"Message",value:V.message||"none"},{title:"Dashboard link",value:V.enableDashboardUrl?(0,a.jsx)(u.I,{name:"check",size:"xl"}):(0,a.jsx)(u.I,{name:"minus",size:"xl"})}]}];return(0,a.jsx)(Oc,{activeStep:tt.Confirm,confirmRedirect:!Hn&&it,disabled:us,editMode:es,onSubmit:$n(ca),reportId:bt,children:(0,a.jsx)(le.n,{label:es?"":"5. Confirm",children:er.map(hr=>{const pa=Zd(V,hr.id);return(0,a.jsxs)("div",{className:Wn.section,children:[(0,a.jsxs)("div",{className:Wn.sectionHeader,children:[(0,a.jsx)("h5",{className:Wn.sectionTitle,children:hr.title}),(0,a.jsx)(ee.z9,{variant:pa?"primary":"secondary",fill:"text",href:Sc(hr.id,bt),size:"sm",children:"Edit"})]}),hr.items.filter(qs=>qs.value!==void 0).map((qs,js)=>{const $a=!!qs.required&&(!qs.value||Array.isArray(qs.value)&&!qs.value.length);return qs.title?(0,a.jsxs)("div",{className:Wn.row,children:[(0,a.jsxs)("div",{className:(0,y.cx)(Wn.title,$a&&Wn.warning),children:[qs.title,":"]}),(0,a.jsx)("div",{className:(0,y.cx)(Wn.value,qs.value==="none"&&!$a?Wn.textMuted:""),children:$a?(0,a.jsx)(u.I,{name:"exclamation-triangle",className:Wn.warning}):qs.value})]},js):(0,a.jsx)("div",{className:(0,y.cx)(Wn.row,Wn.textMuted),children:qs.value},js)})]},hr.title)})})})}),nu=V=>({section:(0,y.css)`
      width: 100%;
      padding: ${V.spacing(3,0)};
      margin-bottom: ${V.spacing(3)};
    `,sectionHeader:(0,y.css)`
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: ${V.spacing(1)};
      border: 1px solid ${V.colors.border.weak};
    `,sectionTitle:(0,y.css)`
      margin: 0;
    `,row:(0,y.css)`
      border: 1px solid ${V.colors.border.weak};
      border-top: none;
      display: flex;
      width: 100%;
      padding: ${V.spacing(1)};
    `,warning:(0,y.css)`
      color: ${V.colors.warning.text};
    `,title:(0,y.css)`
      width: 30%;
      color: ${V.colors.text.secondary};
    `,textMuted:(0,y.css)`
      color: ${V.colors.text.secondary};
    `,value:(0,y.css)`
      width: 70%;
      word-break: break-word;
    `,dashboardLink:(0,y.css)`
      color: ${V.colors.text.primary};
      font-size: ${V.typography.body.fontSize};
      margin-top: 0;
    `}),fp=({variables:V,className:ye})=>{const Be=(0,D.of)(nu);return!V||!Object.keys(V).length?(0,a.jsx)("span",{className:Be.textMuted,children:"none"}):(0,a.jsx)(a.Fragment,{children:Object.entries(V).map(([Je,it])=>(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:ye,children:Je}),": ",it.join(", "),";"," "]},Je))})};var gd=e(77014),Rh=e(13344),Ic=e(85858);const ji=V=>Ic.isValid(V.from)&&Ic.isValid(V.to),su=V=>!V||!ji(V)?{from:"",to:""}:{to:V.to.valueOf().toString(),from:V.from.valueOf().toString()},au=V=>{const ye=Lh(V.from),Be=Lh(V.to);return ji({from:ye,to:Be})?{from:ye,to:Be,raw:{from:ye,to:Be}}:ed},Lh=V=>{const ye=parseInt(V,10);return isNaN(ye)?V:(0,h.yT)(ye)},jh=()=>(0,a.jsx)($t.F,{severity:"warning",title:"Not supported",children:"The value All in template variables used in repeating rows or panels is not supported in PDF"}),pd=V=>V?.length?!V.some(ye=>!!ye.dashboard?.uid):!0,Ji=r.contextSrv.hasPermission(fe.ReportingWrite)||r.contextSrv.hasPermission(fe.ReportingCreate),sl=()=>{const V=s.$.rendererVersion;if(V==="")return null;const Be=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/.exec(V);let Je="";if(Be&&Be.length>1&&(Je=Be[1]),Je==="")return 1;let it=parseInt(Je,10);return isNaN(it)&&(it=1),it},gp=V=>{const{report:ye}=V.reports;return{report:ye}},pp={updateReportProp:ql},ru=(0,he.connect)(gp,pp),ou=new Map([["grid","Display the panels in their positions on the dashboard."],["simple","Display one panel per row."]]),mp=new Map([[at.PDF,{description:"Attach the report as a PDF"}],[at.PDFTablesAppendix,{description:"Include table data as PDF appendix",dependsOn:at.PDF,hide:!Ll.Ay.featureToggles.pdfTables}],[at.Image,{description:"Embed a dashboard image in the email"}],[at.CSV,{description:"Attach a CSV file of table panel data"}],[at.PDFTables,{description:"Attach a separate PDF of table data",hide:!Ll.Ay.featureToggles.pdfTables}]]),Bh=({report:V,updateReportProp:ye,reportId:Be})=>{const Je=(0,D.of)(Z),{dashboards:it,formats:bt,options:Qt,name:un,scaleFactor:an=Cc}=V||{},{handleSubmit:Ln,control:$n,register:Hn,watch:Wn,getValues:es,formState:{isDirty:us}}=(0,te.mN)({defaultValues:{formats:bt,scaleFactor:an,options:{layout:Qt.layout,orientation:Qt.orientation,timeRange:Qt.timeRange}}}),ps=Wn("options.layout"),ds=Wn("options.orientation"),xs=Wn("formats"),ua=Wn("scaleFactor"),ca=sl(),Ds=(0,n.a)("reports.email")&&!pd(V.dashboards),Ws=(0,I.useMemo)(()=>{const qs=V.dashboards.flatMap($a=>$a.dashboard?.uid?(0,Dc.SS)($a.dashboard.uid):[]);return Hr(Rh.To,"query",qs)&&xs.includes(at.PDF)},[V.dashboards,xs]),er=({formats:qs,options:js,scaleFactor:$a})=>{us&&ye({...V,options:{...V.options,...js},formats:qs,scaleFactor:$a})},hr=()=>{const{formats:qs,options:js,scaleFactor:$a}=es();return{options:{...V.options,...js},formats:qs,scaleFactor:$a}},pa=()=>{if(pd(it))return;const qs={title:un,scaleFactor:ua};return ds&&(qs.orientation=ds),ps&&(qs.layout=ps),xs&&xs.includes(at.PDFTablesAppendix)&&(qs.includeTables="true"),qs.dashboards=JSON.stringify(it.map(js=>{const{from:$a,to:Ia}=au(js.timeRange).raw||ed.raw;return{dashboard:{uid:js.dashboard?.uid},timeRange:{from:$a.valueOf().toString(),to:Ia.valueOf().toString()},reportVariables:js.reportVariables}})),Pc.kM.appendQueryToUrl("api/reports/render/pdfs/",Pc.kM.toUrlParams(qs))};return(0,a.jsx)(Oc,{activeStep:tt.FormatReport,onSubmit:Ln(er),confirmRedirect:us,getFormData:hr,reportId:Be,pageActions:[(0,a.jsx)(ee.z9,{onClick:()=>Ds&&(0,l.rR)("reports_preview_pdf"),icon:"external-link-alt",href:pa(),size:"xs",target:"_blank",rel:"noreferrer noopener",variant:"secondary",disabled:!Ds,children:"Preview PDF"},"preview")],children:(0,a.jsxs)(le.n,{label:"2. Format report",disabled:!Ji,children:[Ws&&(0,a.jsx)(jh,{}),(0,a.jsx)(le.n,{children:(0,a.jsx)(ne.B,{direction:"column",alignItems:"start",children:[...mp].map(([qs,js])=>{const{onChange:$a,...Ia}=Hn("formats");return!js.hide&&(!js.dependsOn||xs.includes(js.dependsOn))&&(0,I.createElement)(Jl.S,{...Ia,hidden:js.hide||js.dependsOn&&xs.includes(js.dependsOn),key:qs,htmlValue:qs,label:js.description,className:(0,y.cx)(js.dependsOn&&Je.subCheckbox),"data-testid":pi.components.reportForm.formatCheckbox(qs),onChange:fr=>{qs==="csv"&&fr.currentTarget.checked&&ca!==null&&ca<3&&r.lE.emit(H.r1.alertError,["To export CSV files, you must update the Grafana Image Renderer plugin."]),$a(fr)}})})})}),(xs.includes(at.PDF)||xs.includes(at.PDFTables))&&(0,a.jsxs)(le.n,{label:"Style the PDF",children:[(0,a.jsx)(_.D,{label:"Orientation",children:(0,a.jsx)(te.xI,{name:"options.orientation",control:$n,render:({field:{ref:qs,...js}})=>(0,a.jsx)(J.z,{...js,options:Ct,size:"md"})})}),(0,a.jsx)(_.D,{label:"Layout",description:ou.get(ps),children:(0,a.jsx)(te.xI,{name:"options.layout",control:$n,render:({field:{ref:qs,...js}})=>(0,a.jsx)(J.z,{...js,options:Dt,size:"md"})})}),(0,a.jsx)(_.D,{label:"Zoom",description:"Zoom in to enlarge text, or zoom out to see more data (like table columns) per panel.",className:Je.sliderField,children:(0,a.jsx)(te.xI,{name:"scaleFactor",control:$n,render:({field:{ref:qs,value:js,...$a}})=>(0,a.jsx)(gd.A,{...$a,value:Number(js),min:1,max:3,step:1,marks:Wd,included:!1})})})]})]})})},Z=V=>({sliderField:(0,y.css)`
      max-width: 350px;
      // Hide Slider input
      input {
        display: none;
      }
    `,subCheckbox:(0,y.css)`
      margin-left: ${V.spacing(2)};
    `}),me=ru(Bh);var Me=e(68316),Ne=e(98239),Ze=e(66070),ct=e(20333);const gt=V=>{const{report:ye}=V.reports;return{report:ye}},Bt={updateReportProp:ql},Vt=(0,he.connect)(gt,Bt),Xt=[{label:"Once",value:je.Once},{label:"Hourly",value:je.Hourly},{label:"Daily",value:je.Daily},{label:"Weekly",value:je.Weekly},{label:"Monthly",value:je.Monthly},{label:"Custom",value:je.Custom},{label:"Never",value:je.Never}],nn=[{label:"hours",value:Ke.Hours},{label:"days",value:Ke.Days},{label:"weeks",value:Ke.Weeks},{label:"months",value:Ke.Months}],on=V=>V==="now"&&Wl((0,h.KQ)().toDate().getDate()),rn=Vt(({report:V,updateReportProp:ye,reportId:Be})=>{const{handleSubmit:Je,control:it,watch:bt,register:Qt,setValue:un,getValues:an,formState:{isDirty:Ln}}=(0,te.mN)(),{frequency:$n,timeZone:Hn,startDate:Wn,endDate:es,dayOfMonth:us,intervalAmount:ps,intervalFrequency:ds}=V.schedule,xs=$n===je.Never?"":Wn,ua=xs?"later":"now",ca={startDate:xs,sendTime:ua,intervalFrequency:Ke.Hours,intervalAmount:"2",sendOnLastDayOfMonth:us===ze,...V.schedule},Ds=bt("schedule",ca)||{},{frequency:Ws,startDate:er,endDate:hr,intervalFrequency:pa=Ke.Hours,dayOfMonth:qs,sendOnLastDayOfMonth:js,sendTime:$a=ua,workdaysOnly:Ia}=Ds,fr=(0,D.of)(Nn),Va=new Date(er),Sr=uo=>{if(Ln){const vo=Qd(uo.schedule);ye({...V,schedule:vo})}},Ir=()=>({schedule:Qd(an().schedule)}),rl=uo=>{const vo=js&&(0,Me.c)(uo);un("schedule.sendOnLastDayOfMonth",vo),un("schedule.dayOfMonth",vo?ze:"")},dl=uo=>{const vo=(0,h.KQ)(er).endOf("month").toDate();un("schedule.startDate",vo),un("schedule.dayOfMonth",uo?ze:"")};return(0,a.jsx)(Oc,{activeStep:tt.Schedule,onSubmit:Je(Sr),confirmRedirect:Ln,getFormData:Ir,reportId:Be,children:(0,a.jsxs)(le.n,{label:"3. Schedule",children:[(0,a.jsx)(_.D,{label:"Frequency",children:(0,a.jsx)(te.xI,{defaultValue:$n,name:"schedule.frequency",render:({field:{ref:uo,onChange:vo,...Go}})=>(0,a.jsx)(J.z,{...Go,fullWidth:!0,options:Xt,disabled:!Ji,onChange:si=>{cd(si,pa)||un("schedule.workdaysOnly",!1),vo(si)}}),control:it})}),Ws!==je.Never&&(0,a.jsx)(_.D,{label:"Time",children:(0,a.jsx)(te.xI,{control:it,name:"schedule.sendTime",defaultValue:ua,render:({field:{ref:uo,onChange:vo,...Go}})=>(0,a.jsx)(J.z,{...Go,onChange:si=>{si!=="now"&&!er?un("schedule.startDate",(0,h.KQ)().toDate()):si==="now"&&un("schedule.startDate",""),vo(si)},options:[{label:"Send now",value:"now"},{label:"Send later",value:"later"}]})})}),(0,a.jsxs)(a.Fragment,{children:[Ws===je.Custom&&(0,a.jsxs)(ne.B,{children:[(0,a.jsx)(_.D,{label:"Repeat every",children:(0,a.jsx)(De.p,{type:"number",min:"2",...Qt("schedule.intervalAmount"),placeholder:"e.g. 2",defaultValue:ps||2,id:"repeat-frequency"})}),(0,a.jsx)(_.D,{label:" ",children:(0,a.jsx)(te.xI,{control:it,defaultValue:nn.find(uo=>uo.value===ds)?.value||Ke.Hours,render:({field:{ref:uo,onChange:vo,...Go}})=>(0,a.jsx)(p.l6,{...Go,onChange:si=>vo(si.value),options:nn,width:16,placeholder:"hours","aria-label":"Custom frequency"}),name:"schedule.intervalFrequency"})})]}),Ws===je.Monthly&&(on($a)||$a==="later")&&(0,a.jsx)(_.D,{children:(0,a.jsx)(te.xI,{control:it,defaultValue:qs===ze,render:({field:{onChange:uo,...vo}})=>(0,a.jsx)(Jl.S,{...vo,label:"Send on the last day of month",onChange:Go=>{dl(Go.currentTarget.checked),uo(Go.currentTarget.checked)}}),name:"schedule.sendOnLastDayOfMonth"})})]}),(0,a.jsx)("div",{className:$a!=="now"&&Ws!==je.Never?"":fr.hidden,children:(0,a.jsxs)(ne.B,{children:[(0,a.jsx)(_.D,{label:"Start date",children:(0,a.jsx)(te.xI,{name:"schedule.startDate",control:it,defaultValue:ll(xs),render:({field:{ref:uo,onChange:vo,...Go}})=>(0,a.jsx)(Ne.l,{...Go,width:16,placeholder:"Select date","aria-label":"Report schedule start date",closeOnSelect:!0,onChange:si=>{const Vi=new Date(si);rl(Vi),vo(Vi)}})})}),(0,a.jsx)(_.D,{label:"Start time",children:(0,a.jsx)(te.xI,{name:"schedule.time",render:({field:{onChange:uo,ref:vo,value:Go,...si}})=>(0,a.jsx)(Ze.R,{...si,value:Go,minuteStep:10,disabled:!Ji,onChange:Vi=>{Vi.isValid()&&uo({hour:Vi.hour?.(),minute:Vi.minute?.()})}}),defaultValue:Mc(Wn),control:it})}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(_.D,{label:"Time zone",children:(0,a.jsx)(te.xI,{name:"schedule.timeZone",render:({field:{ref:uo,...vo}})=>(0,a.jsx)(ct.U,{...vo,width:30,disabled:!Ji}),defaultValue:Hn||Kd(),control:it})})})]})}),Ws===je.Monthly&&!js&&(Wl(Va.getDate())||on($a))&&(0,a.jsxs)("small",{className:fr.warningText,children:["Note: some months do not have a"," ",Yd(on($a)?(0,h.KQ)().toDate().getDate():Va.getDate())," day and reports will not be sent on those months. Choose an earlier date or"," ",(0,a.jsx)("strong",{children:'"Send on the last day of month"'})," to send a report at the end of each month."]}),![je.Once,je.Never].includes(Ws)&&(0,a.jsxs)(ne.B,{children:[(0,a.jsx)(_.D,{label:"End date",children:(0,a.jsx)(te.xI,{name:"schedule.endDate",control:it,defaultValue:ll(es),render:({field:{ref:uo,...vo}})=>(0,a.jsx)(Ne.l,{...vo,width:16,placeholder:"Does not end","aria-label":"Report schedule end date",minDate:new Date(er),closeOnSelect:!0})})}),hr&&(Ws===je.Hourly||Mh(Ws,pa))&&(0,a.jsx)(_.D,{label:"End time",children:(0,a.jsx)(te.xI,{name:"schedule.endTime",render:({field:{onChange:uo,ref:vo,value:Go,...si}})=>(0,a.jsx)(Ze.R,{...si,value:Go,minuteStep:10,disabled:!Ji,onChange:Vi=>{Vi?.isValid()&&uo({hour:Vi.hour?.(),minute:Vi.minute?.()})}}),defaultValue:Mc(es),control:it})})]}),cd(Ws,pa)&&(0,a.jsx)(_.D,{children:(0,a.jsx)(Jl.S,{...Qt("schedule.workdaysOnly"),label:"Send Monday to Friday only",defaultChecked:Ia})}),(0,a.jsxs)(ne.B,{alignItems:"center",children:[(0,a.jsx)(u.I,{name:"calendar-alt"}),$i({...ca,...Ds})]})]})})}),Nn=V=>({warningText:(0,y.css)`
      color: ${V.colors.warning.main};
      display: block;
      margin: -${V.spacing(1)} 0 ${V.spacing(3)} 0;
    `,hidden:(0,y.css)`
      display: none;
    `});var ms=e(54230),rs=e(59429);const gs=V=>{const{report:ye}=V.reports;return{report:ye,templating:V.templating.keys}},os={updateReportProp:ql,initVariables:Sh,cleanUpVariables:nc._m},Fn=(0,he.connect)(gs,os),Gn={dashboard:void 0,timeRange:{from:"",to:"",raw:{from:"",to:""}},reportVariables:{}},ba=({report:V,reportId:ye,updateReportProp:Be,initVariables:Je,cleanUpVariables:it})=>{const{handleSubmit:bt,control:Qt,formState:{isDirty:un},setValue:an,getValues:Ln,watch:$n}=(0,te.mN)({defaultValues:{dashboards:V.dashboards||[Gn]}}),{fields:Hn,append:Wn,remove:es}=(0,te.jz)({control:Qt,name:"dashboards",keyName:"fieldId"}),us=$n("dashboards"),ps=(0,D.of)(is);(0,I.useEffect)(()=>{const Ds=xh();if(Ds){const{dashboard:Ws,variables:er,timeRange:hr}=Ds;er&&Ws.uid&&Je(Ws.uid,er,hr),Ws.uid&&(an("dashboards.0.dashboard",Ws,{shouldDirty:!0}),hr&&an("dashboards.0.timeRange",{...hr,raw:hr},{shouldDirty:!0}))}},[Je,V,an]);const ds=Ds=>(Ws,er)=>{an(`dashboards.${Ds}.timeRange`,{from:"",to:""});const hr=Ln().dashboards?.map(({dashboard:qs})=>qs);if(!Ws){if(!er)return;hr.some(js=>js?.uid===er)||it(er);return}const pa=hr.filter(qs=>qs?.uid===Ws.uid).length>1;if(Ws.uid&&!pa){const qs=V.dashboards?.[Ds],js=Ws.uid===qs?.dashboard?.uid?qs?.reportVariables:void 0;Je(Ws.uid,js)}},xs=Ds=>{const Ws=ua(Ds.dashboards);un&&Be({...V,dashboards:Ws})},ua=Ds=>{const Ws=Ds?.filter(({dashboard:er})=>er?.uid).map(({dashboard:er,timeRange:hr})=>{const pa=er?.uid;return{dashboard:pa?{uid:pa,name:er?.name}:void 0,timeRange:su(hr?.raw),reportVariables:pa?zd((0,Dc.SS)(pa).filter(qs=>qs.hide!==Xl.zL.hideVariable)):void 0}});return Ws?.length?Ws:[Gn]},ca=()=>({dashboards:ua(Ln().dashboards)});return(0,a.jsx)(Oc,{activeStep:tt.SelectDashboard,onSubmit:bt(xs),confirmRedirect:un,getFormData:ca,reportId:ye,children:(0,a.jsx)(le.n,{label:"1. Select dashboard",children:(0,a.jsxs)(a.Fragment,{children:[Hn.map((Ds,Ws)=>{const er=us[Ws].dashboard?.uid||"",hr=us[Ws]?.reportVariables,pa=er?(0,Dc.SS)(er):[],qs=js=>{_d(pa)&&Je(er,hr,js)};return(0,a.jsxs)("div",{className:(0,y.cx)(ps.section,us.length>1&&ps.sectionBorder),children:[(0,a.jsx)(zs,{field:Ds,dashboardUid:er,onDashboardChange:ds(Ws),variables:pa,control:Qt,index:Ws,setValue:an,selectedDashboards:us,onTimeRangeChange:qs,dataTestId:pi.components.reportForm.selectDashboard(Ws.toString())}),Hn.length>1&&(0,a.jsx)(ee.$n,{className:ps.removeBtn,variant:"secondary",fill:"outline",icon:"trash-alt",onClick:()=>es(Ws),children:"Remove dashboard"})]},Ds.fieldId)}),(0,a.jsx)(ee.$n,{type:"button",variant:"secondary",onClick:()=>Wn(Gn),children:"+ Add another dashboard"})]})})})},zs=({field:V,index:ye,onDashboardChange:Be,variables:Je,control:it,dashboardUid:bt,setValue:Qt,onTimeRangeChange:un,selectedDashboards:an=[],dataTestId:Ln})=>{const $n=au(V.timeRange),Hn=Je.filter(ds=>ds.hide!==Xl.zL.hideVariable),Wn=bt!==void 0&&!!Hn.length,es=an.filter(({dashboard:ds})=>ds?.uid===bt).length>1,us=an.findIndex(({dashboard:ds})=>ds?.uid===bt),ps=es&&us!==ye;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Source dashboard",required:!0,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(te.xI,{name:`dashboards.${ye}.dashboard`,control:it,render:({field:{onChange:ds,ref:xs,value:ua,...ca}})=>(0,a.jsx)(rs.b,{...ca,id:`dashboard-${ye}`,"data-testid":Ln,"aria-label":"Source dashboard",isClearable:!0,value:ua?.uid,disabled:!Ji,onChange:Ds=>{ds({...Ds,name:Ds?.title}),Be(Ds,bt)}})}),(0,a.jsx)(Kl,{uid:bt})]})}),Wn&&(0,a.jsx)(_.D,{label:"Template variables",description:ps&&`When adding the same dashboard multiple times in one report, template variables that you selected first
are applied to all instances of that dashboard in the report.`,children:ps?(0,a.jsx)(a.Fragment,{}):(0,a.jsx)(a.Fragment,{children:Hn.map(ds=>{const{picker:xs,setValue:ua}=Gc.B.get(ds.type);return(0,a.jsx)(Ie.I,{label:ds.name,labelWidth:16,disabled:!Ji,children:(0,a.jsx)(xs,{variable:ds,readOnly:!1,onVariableChange:ca=>{(0,Qc.SP)(ca)&&!(0,Hc.R)(ca.current)&&(ua(ca,ca.current),Qt(`dashboards.${ye}.reportVariables`,zd([ca]),{shouldDirty:!0}))}})},ds.name)})})}),(0,a.jsx)(_.D,{label:"Time range",description:"Generate report with the data from specified time range. If custom time range is empty the time range from the report's dashboard is used.",disabled:!Ji,children:(0,a.jsx)(te.xI,{control:it,name:`dashboards.${ye}.timeRange`,defaultValue:$n,render:({field:{ref:ds,value:xs,onChange:ua,...ca}})=>(0,a.jsx)(ms.b,{...ca,value:ys(xs,$n),onChange:Ds=>{ua(Ds),un(Ds.raw)},clearable:!0})})})]})},sa=Fn(ba),ys=(V,ye)=>V?V.raw?V:{...V,raw:V}:ye,is=V=>({removeBtn:(0,y.css)`
      margin-bottom: ${V.spacing(2)};
    `,section:(0,y.css)`
      padding-bottom: ${V.spacing(2)};
    `,sectionBorder:(0,y.css)`
      &:not(:last-of-type) {
        border-bottom: 1px solid ${V.colors.border.weak};
        margin-bottom: ${V.spacing(3)};
      }
    `,infoText:(0,y.css)`
      color: ${V.colors.text.secondary};
      font-size: ${V.typography.size.sm};
      font-weight: ${V.typography.fontWeightRegular};
    `});var Ls=e(71678),Cs=e(79924);const Gs=V=>V?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(V):!1,xa=/[,;\n]/,ka=(V,ye=xa)=>V?V.split(ye).filter(Boolean).every(Be=>Gs(Be)):!0,Ja=(V="",ye=["png","jpg","gif"])=>{if(!V)return!0;const Be=V.split(".");return ye.includes(Be[Be.length-1])},Wr=({onDismiss:V,onSendTestEmail:ye,emails:Be})=>{const Je=(0,D.DP)(),it=Ua(Je),[bt,Qt]=(0,I.useState)(""),[un,an]=(0,I.useState)(""),[Ln,$n]=(0,I.useState)(!1),[Hn,Wn]=(0,I.useState)(!1),es=ua=>{const{checked:ca}=ua.target;Wn(ca),ca?(Qt(Be),ps(Be)):(ds(),Qt(""))},us=ua=>{Qt(ua.currentTarget.value),$n(!1)},ps=ua=>ka(ua)?(ds(),!0):($n(!0),an("Invalid email"),!1),ds=()=>{$n(!1),an("")},xs=()=>{ps(bt),ps(bt)&&(ye(bt,Hn),V())};return(0,a.jsx)(re.a,{className:it.modal,isOpen:!0,title:"Send test email",icon:"share-alt",onDismiss:V,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:it.content,children:[(0,a.jsx)(_.D,{label:"Email",disabled:Hn,invalid:Ln,error:un,children:(0,a.jsx)(De.p,{disabled:Hn,name:"email",placeholder:"your.address@company.com",type:"email",value:bt,onChange:us})}),(0,a.jsx)(Jl.S,{value:Hn,label:"Use emails from report",onChange:es,"data-testid":pi.components.reportForm.useRecipientsCheckbox})]}),(0,a.jsxs)(re.a.ButtonRow,{children:[(0,a.jsx)(ee.$n,{variant:"secondary",onClick:V,fill:"outline",children:"Cancel"}),(0,a.jsx)(ee.$n,{variant:"primary",onClick:xs,"data-testid":pi.components.reportForm.sendTestEmailConfirmButton,children:"Send"})]})]})})},Ua=(0,Cn.N)(V=>({modal:(0,y.css)`
      width: 500px;
    `,content:(0,y.css)`
      margin-bottom: ${V.spacing.lg};
    `})),ra=V=>{const{testEmailIsSending:ye,report:Be}=V.reports;return{report:Be,testEmailIsSending:ye}},la={updateReportProp:ql,sendTestEmail:Th},lr=(0,he.connect)(ra,la),Kr=({report:V,reportId:ye,updateReportProp:Be,sendTestEmail:Je,testEmailIsSending:it})=>{const{message:bt,name:Qt,recipients:un,replyTo:an,enableDashboardUrl:Ln,dashboards:$n}=V,{handleSubmit:Hn,control:Wn,register:es,setError:us,clearErrors:ps,watch:ds,getValues:xs,formState:{errors:ua,isDirty:ca}}=(0,te.mN)({mode:"onBlur"}),Ds=(0,D.of)(Ca),Ws=r.contextSrv.hasPermission(fe.ReportingSend),er=ds("name",Qt),hr=ds("recipients",un),pa=!Ws||!(0,n.a)("reports.email")||!er||!hr||pd($n),qs=(Ia,fr)=>{const Va={...V,...xs()},Sr=fr?Va.recipients:Ia;return Je({...Va,recipients:Sr})},js=Ia=>{if(ca){const{name:fr}=Ia;Be({...V,...Ia,name:fr.trim()})}},$a=()=>{const Ia=xs(),{name:fr}=Ia;return{...Ia,name:fr.trim()}};return(0,a.jsxs)(Oc,{activeStep:tt.Share,onSubmit:Hn(js),confirmRedirect:ca,getFormData:$a,reportId:ye,pageActions:[(0,a.jsx)(Ls.$s,{children:({showModal:Ia,hideModal:fr})=>(0,a.jsx)(ee.$n,{disabled:pa,size:"xs",variant:"secondary","data-testid":pi.components.reportForm.sendTestEmailButton,onClick:Va=>{Va.preventDefault(),Ia(Wr,{onDismiss:fr,onSendTestEmail:qs,emails:hr})},children:"Send test email"})},"send-test-email")],children:[it&&(0,a.jsx)("div",{className:"page-alert-list",children:(0,a.jsx)($t.F,{title:"Sending test email...",severity:"info",elevated:!0})}),(0,a.jsxs)(le.n,{label:"4. Share",disabled:!Ji,children:[(0,a.jsx)(_.D,{label:"Report name",required:!0,invalid:!!ua.name,error:"Name is required",children:(0,a.jsx)(De.p,{...es("name"),type:"text",id:"name",defaultValue:Qt,placeholder:"System status report","data-testid":pi.components.reportForm.nameInput})}),(0,a.jsx)(_.D,{className:Ds.field,label:"Recipients",required:!0,invalid:!!ua.recipients,error:ua.recipients?.message,description:"Separate multiple emails with a comma or semicolon.",children:(0,a.jsx)(te.xI,{name:"recipients",control:Wn,defaultValue:un,render:({field:{ref:Ia,value:fr,onChange:Va,...Sr}})=>(0,a.jsx)(Cs.u,{...Sr,id:"recipients",disabled:!Ji,invalid:!!ua.recipients,onChange:Ir=>{const rl=Ir.join(";").split(xa).filter(Boolean).map(uo=>uo.trim()),dl=rl.filter(uo=>!Gs(uo));dl.length?us("recipients",{type:"manual",message:`Invalid email${dl.length>1?"s":""}: ${dl.join("; ")}`}):ps("recipients"),Va(rl.filter(uo=>Gs(uo)).join(";"))},placeholder:"Type in the recipients email addresses and press Enter",tags:fr?fr.split(xa):[],className:Ds.tagsInput,addOnBlur:!0}),rules:{validate:Ia=>ka(Ia)||"Invalid email"}})}),(0,a.jsx)(_.D,{invalid:!!ua.replyTo,error:ua.replyTo?.message,className:Ds.field,label:"Reply-to email address",description:"The address that will appear in the Reply to field of the email",children:(0,a.jsx)(De.p,{...es("replyTo",{validate:Ia=>ka(Ia)||"Invalid email"}),id:"replyTo",placeholder:"your.address@company.com - optional",type:"email",defaultValue:an})}),(0,a.jsx)(_.D,{className:Ds.field,label:"Message",children:(0,a.jsx)(Aa.f,{...es("message"),id:"message",placeholder:bt,rows:10,defaultValue:bt})}),(0,a.jsx)(_.D,{className:Ds.field,children:(0,a.jsx)(Jl.S,{...es("enableDashboardUrl"),defaultChecked:Ln,label:"Include a dashboard link"})})]})]})},Ca=V=>({field:(0,y.css)`
      &:not(:last-of-type) {
        margin-bottom: ${V.spacing(3)};
      }
    `,tagsInput:(0,y.css)`
      li {
        margin-bottom: ${V.spacing(1)};
        background-color: ${V.colors.background.secondary} !important;
        border-color: ${V.components.input.borderColor} !important;
        color: ${V.colors.text.primary};
      }
    `}),va=lr(Kr);var Ga=e(95246);const cr=()=>(0,a.jsx)(de.x6,{i18nKey:"reporting.errors.action-message",children:"Please contact your Grafana administrator to install the plugin."}),sr=()=>(0,a.jsxs)(de.x6,{i18nKey:"reporting.errors.no-renderer-description",children:["To generate PDF reports, you must install the"," ",(0,a.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana Image Renderer"})," ","plugin."]}),vr=({variant:V="info"})=>(0,a.jsxs)($t.F,{title:(0,de.t)("reporting.errors.no-renderer-title","Image renderer plugin not installed"),severity:V,children:[(0,a.jsx)(sr,{})," ",(0,a.jsx)("br",{}),(0,a.jsx)(cr,{})]}),kr=()=>(0,a.jsxs)(de.x6,{i18nKey:"reporting.errors.old-renderer-description",children:["To generate CSV files, you must update the"," ",(0,a.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana Image Renderer"})," ","plugin."]}),dr=()=>(0,a.jsxs)($t.F,{title:(0,de.t)("reporting.errors.old-renderer-title","You are using an old version of the image renderer plugin"),severity:"warning",children:[(0,a.jsx)(kr,{})," ",(0,a.jsx)("br",{}),(0,a.jsx)(cr,{})]}),Gr=({message:V})=>(0,a.jsx)(jr.w,{title:"Feature not available with an expired license",url:"https://grafana.com/docs/grafana/latest/enterprise/license-expiration/",urlTitle:"Read more on license expiration",children:(0,a.jsx)("span",{children:V})}),Xr=(V=window.location.origin)=>{let ye=V+s.$.appSubUrl;return ye.endsWith("/")&&ye.slice(0,-1),ye},So=(V,ye,Be,Je,it)=>{let bt=`${Xr()}/api/reports/render/pdfs`;const Qt={orientation:V,layout:ye,scaleFactor:Be},un={dashboard:{uid:Je}};Object.keys(it).length!==0&&(un.reportVariables=it);const an=qg();return an&&(un.timeRange=an),Qt.dashboards=JSON.stringify([un]),bt=Pc.kM.appendQueryToUrl(bt,Pc.kM.toUrlParams(Qt)),bt},Qs=({displayQueryVariablesAlert:V,onDismiss:ye,isSnapshot:Be,variables:Je,dashboardUid:it})=>{const[bt,Qt]=(0,I.useState)("landscape"),[un,an]=(0,I.useState)("grid"),[Ln,$n]=(0,I.useState)(Cc),Hn=So(bt,un,Ln,it,Je);function Wn(){(0,l.rR)("dashboards_sharing_pdf_save_clicked",{orientation:bt,layout:un,scaleFactor:Ln})}return s.$.rendererAvailable?(0,n.a)("reports.pdf")?Be?(0,a.jsx)("p",{className:"share-modal-info-text",children:"Sharing a PDF from a snapshot is not supported."}):(0,a.jsxs)(Ga.O,{icon:"file-alt",children:[V&&(0,a.jsx)(jh,{}),(0,a.jsx)("p",{className:"share-modal-info-text",children:"Save the dashboard as a PDF document."}),(0,a.jsx)(_.D,{label:"Orientation",children:(0,a.jsx)(J.z,{options:Ct,value:bt,onChange:Qt})}),(0,a.jsx)(_.D,{label:"Layout",children:(0,a.jsx)(J.z,{options:Dt,value:un,onChange:an})}),(0,a.jsx)(_.D,{label:"Zoom",description:"Increase the number of rows and columns in table panels.",className:(0,y.css)`
          max-width: 350px;
          // Hide Slider input
          input {
            display: none;
          }
        `,children:(0,a.jsx)(gd.A,{value:Ln,min:1,max:3,step:1,marks:Wd,onChange:$n,included:!1})}),(0,a.jsxs)(re.a.ButtonRow,{children:[(0,a.jsx)(ee.$n,{variant:"secondary",onClick:ye,children:"Cancel"}),(0,a.jsx)(ee.z9,{variant:"primary",href:Hn,target:"_blank",rel:"noreferrer noopener",onClick:Wn,children:"Save as PDF"})]})]}):(0,a.jsx)(Gr,{message:`Rendering a dashboard as a PDF document is not available with your current license.
            To enable this feature, update your license.`}):(0,a.jsx)(vr,{})},hs=({dashboard:V,onDismiss:ye})=>{const Be=(0,I.useMemo)(()=>{const it=od(V.panels),bt=(0,Dc.SS)(V.uid),Qt=tc(Rh.To,"query",bt);return Qt&&it.has(Qt.name)},[V]),Je=(0,I.useMemo)(()=>{const it=(0,Dc.SS)(V.uid);return zd(it)},[V.uid]);return(0,a.jsx)(Qs,{displayQueryVariablesAlert:Be,isSnapshot:V.isSnapshot(),onDismiss:ye,variables:Je,dashboardUid:V.uid})};var Ms=e(80943),Na=e(74730);class Oa extends Ms.Bs{constructor(){super(...arguments),this.tabId=Jc.wr.report}static{this.Component=Qa}getTabLabel(){return"Report"}}function Qa({model:V}){const{modalRef:ye}=V.useState(),Be=(0,Na.YQ)(V);return(0,a.jsx)(sd,{dashboard:Be,onDismiss:()=>{ye?.resolve()?.onDismiss()}})}class xr extends Ms.Bs{constructor(){super(...arguments),this.tabId=Jc.wr.pdf}static{this.Component=Io}getTabLabel(){return"PDF"}}function Io({model:V}){const{modalRef:ye}=V.useState(),Be=(0,Na.YQ)(V),Je=(0,I.useMemo)(()=>{const it=Ms.jh.getVariables(Be).state.variables;return bl(it)},[Be]);return(0,a.jsx)(Qs,{onDismiss:ye?.resolve().onDismiss,displayQueryVariablesAlert:!1,isSnapshot:!!Be.state.meta.isSnapshot,variables:Je,dashboardUid:Be.state.uid})}const Ci=Ll.config.featureToggles.featureHighlights,$l={label:"PDF",value:Jc.wr.pdf,component:hs},Bi={label:"Report",value:Jc.wr.report,tabSuffix:Ci&&!(0,n.a)("reports.creation")||(0,Ye.z5)()?()=>(0,Hp.J)({experimentId:Uc("reporting-tab-badge")}):void 0,component:sd};function Vl(){if(!Ll.config.reporting?.enabled)return;const V=Be=>{if((0,n.a)("reports.creation")&&!(0,Ye.z5)()){(0,l.rR)("dashboards_sharing_report_create_clicked");const it=$g.I.stripBaseFromUrl(`${Ll.config.appUrl}${Hd(Be)}`);Nt.Ny.push(it)}else{const it=new Vg.j({title:(0,de.t)("share-dashboard.menu.schedule-report-title","Schedule report"),body:new Oa({})});Be.showModal(it)}},ye={shareId:Jc.wr.report,testId:"data-testid new share button schedule report",icon:"clock-nine",label:(0,de.t)("share-dashboard.menu.schedule-report-title","Schedule report"),renderCondition:!0,onClick:V};(0,n.a)("reports.creation")?((0,ph.addDashboardShareTab)($l),(0,mh.m)(xr),Ni.TP.hasPermission(fe.ReportingCreate)&&((0,ph.addDashboardShareTab)(Bi),(0,mh.m)(Oa),(0,Zc.H)(ye))):Ci&&((0,ph.addDashboardShareTab)(Bi),(0,mh.m)(Oa),(0,Zc.H)(ye))}const Ko=[{id:tt.SelectDashboard,name:"Select dashboard",component:sa},{id:tt.FormatReport,name:"Format report",component:me},{id:tt.Schedule,name:"Schedule",component:rn},{id:tt.Share,name:"Share",component:va},{id:tt.Confirm,name:"Confirm",component:Ah}];var md=e(4213),Zi=e(72436),zl=e(55087),_l=e(20470);const mi=V=>({dashboard:V.dashboard.getModel()}),Ac={initDashboard:_l.vR},vd=(0,he.connect)(mi,Ac);class Xp extends I.Component{constructor(){super(...arguments),this.state={panel:null,notFound:!1}}static{this.contextType=hl.YE}componentDidMount(){const{match:ye,route:Be}=this.props;this.props.initDashboard({urlSlug:ye.params.slug,urlUid:ye.params.uid,urlType:ye.params.type,routeName:Be.routeName,fixUrl:!1,keybindingSrv:this.context.keybindings})}getPanelId(){return parseInt(this.props.queryParams.panelId??"0",10)}componentDidUpdate(ye){const{dashboard:Be}=this.props;if(Be&&(!ye.dashboard||ye.dashboard.uid!==Be.uid)){const Je=Be.getPanelByUrlId(this.props.queryParams.panelId);if(!Je){this.setState({notFound:!0});return}this.setState({panel:Je}),Je.getQueryRunner().getData({withTransforms:!0,withFieldConfig:!0}).subscribe({next:it=>this.onDataUpdate(it)})}}onDataUpdate(ye){const{panel:Be}=this.state;if(!ye||ye.state!==As.Gu.Done&&ye.state!==As.Gu.Streaming)return;const{dashboard:Je}=this.props,it=ye.series,bt=this.props.queryParams.timezone||Je?.timezone;let Qt={defaults:{},overrides:[]};const un=(0,Nu.we)({data:it,theme:s.$.theme2,fieldConfig:Be?.fieldConfig||Qt,replaceVariables:Hn=>Hn,timeZone:bt}),an=(0,Zi._O)([un[0]],{}),Ln=new Blob(["\uFEFF",an],{type:"text/csv;charset=utf-8"}),$n=`${Be?.getDisplayTitle()}-data-${(0,Il.LE)(new Date)}.csv`;(0,md.saveAs)(Ln,$n)}render(){return(0,a.jsx)(zl.SoloPanel,{dashboard:this.props.dashboard,notFound:this.state.notFound,panel:this.state.panel,panelId:this.getPanelId(),timezone:this.props.queryParams.timezone})}}const qp=vd(Xp),em=({report:V,editMode:ye})=>{const{name:Be,dashboardName:Je=""}=V;return{text:!V.id&&!ye?"New report":Be||Je}},tm=({children:V,editMode:ye,isLoading:Be,className:Je,report:it,...bt})=>{(0,I.useEffect)(()=>{document.title=`Reporting: ${ye?"Edit report":"New report"}`},[ye]);const Qt=em({report:it,editMode:ye});return(0,a.jsx)(G.Y,{navId:"reports-list",pageNav:Qt,children:(0,a.jsx)(G.Y.Contents,{children:(0,a.jsx)("div",{...bt,children:Be?(0,a.jsx)(wd.A,{}):s.$.rendererAvailable?V:(0,a.jsx)(vr,{variant:"error"})})})})},nm=(V,ye)=>{const{report:Be,isLoading:Je}=V.reports,{id:it,step:bt}=ye.match.params;return{activeStep:bt,existingReport:!!Be.id,isLoading:!!(it&&Je),report:Be,reportId:it}},sm={loadReport:Gd},Yp=(0,he.connect)(nm,sm)(({existingReport:V,isLoading:ye,loadReport:Be,report:Je,reportId:it,activeStep:bt=tt.SelectDashboard})=>{(0,I.useEffect)(()=>{it&&Be(parseInt(it,10))},[it,Be]);const Qt=(0,I.useCallback)(()=>{const un=Ko.find(({id:an})=>an===bt)?.component;return un?(0,a.jsx)(un,{reportId:it}):null},[bt,it]);return(0,a.jsx)(tm,{isLoading:ye,editMode:V,report:Je,children:ye?(0,a.jsx)(ki.a,{}):Qt()})});var am=e(82702);const rm=(V,ye)=>{const Be=["name","recipients"],Je=it=>it.dashboards.some(({dashboard:bt})=>bt?.name.toLowerCase().includes(ye.toLowerCase()));return V.filter(it=>Be.some(bt=>it[bt]?.toLowerCase().includes(ye.toLowerCase()))||Je(it))},om=V=>new Map([[Fe.Scheduled,V.colors.success.text],[Fe.Expired,V.colors.warning.text],[Fe.Draft,V.colors.text.primary],[Fe.Never,V.colors.text.primary],[Fe.Paused,V.colors.text.disabled]]),vp=({deleteReport:V,updateReport:ye,reports:Be,filter:Je})=>{const it=(0,D.$j)(),bt=(0,D.of)(im),Qt=Ln=>{const $n=ap(Ln.state);ye({...Ln,state:$n},!0)},un=r.contextSrv.hasPermission(fe.ReportingWrite),an=r.contextSrv.hasPermission(fe.ReportingDelete);return(0,a.jsx)("div",{children:rm(Be,Je).map(Ln=>{const $n=Ln.recipients.split(";"),Hn=$n.length,Wn=dd(Ln.schedule),{isNever:es,showPlay:us,disableEdit:ps,reportState:ds}=Li(Ln),xs=om(it).get(Ln.state);return(0,a.jsxs)(Cd.Q,{href:`reports/confirm/${Ln.id}`,className:bt.container,children:[(0,a.jsxs)("div",{className:bt.info,children:[(0,a.jsx)("span",{className:bt.title,children:Ln.name}),(0,a.jsx)("span",{className:bt.dashboards,children:[...new Set(Ln.dashboards.map(({dashboard:ua})=>ua?.name))].join(", ")})]}),(0,a.jsx)("div",{className:bt.recipients,children:(0,a.jsx)(be.m,{content:$n.join(", "),placement:"top",children:(0,a.jsx)("div",{children:`${Hn} recipient${Hn>1?"s":""}`})})}),(0,a.jsxs)("div",{className:bt.schedule,children:[(0,a.jsx)("span",{className:(0,y.cx)(bt.scheduleStatus,(0,y.css)`
                    color: ${xs};
                  `),children:ds.toUpperCase()}),!es&&(0,a.jsx)("span",{className:bt.text,children:Wn})]}),(0,a.jsxs)("div",{className:bt.buttonWrapper,children:[(0,a.jsx)(be.m,{content:`${us?ds===Fe.Draft?eu(Ln.schedule):"Resume":"Pause"} report`,placement:"top",children:(0,a.jsx)(ee.$n,{type:"button",variant:"secondary",fill:"text",icon:us?"play":"pause",size:"md",onClick:ua=>{ua.preventDefault(),Qt(Ln)},disabled:ps||!un||Zd(Ln)})}),(0,a.jsx)(am.Z,{confirmText:"Delete",confirmVariant:"destructive",size:"md",disabled:!an,onConfirm:()=>V(Ln),children:(0,a.jsx)(ee.$n,{type:"button",className:bt.deleteButton,"aria-label":`Delete report ${Ln.name}`,variant:"secondary",icon:"trash-alt",size:"md",fill:"text"})})]})]},Ln.id)})})},im=V=>({container:(0,y.css)`
    & > a {
        align-items: center;
      },
    `,info:(0,y.css)`
      display: flex;
      flex-direction: column;
      width: 30%;
    `,title:(0,y.css)`
      font-size: ${V.typography.h5.fontSize};
      font-weight: ${V.typography.fontWeightBold};
    `,dashboards:(0,y.css)`
      font-size: ${V.typography.bodySmall.fontSize};
      color: ${V.colors.text.secondary};
    `,recipients:(0,y.css)`
      display: flex;
      width: 25%;
      cursor: pointer;

      &:hover {
        text-decoration: underline;
      },
    `,schedule:(0,y.css)`
      display: flex;
      flex-direction: column;
      width: 40%;
    `,scheduleStatus:(0,y.css)`
      text-transform: uppercase;
    `,buttonWrapper:(0,y.css)`
      display: flex;
      align-items: center;
      width: 5%;
      & > button {
        &[disabled] {
          pointer-events: all;
        },
      },
    `,deleteButton:(0,y.css)`
      &:hover {
        color: ${V.colors.error.text};
    `,text:(0,y.css)`
      color: ${V.colors.text.secondary};
    `}),lm=()=>{const V=(0,D.of)(cm);return(0,a.jsxs)(G.Y,{navId:"reports",subTitle:"Manage automatically generated PDF reports from any dashboards and have Grafana email them to interested parties.",children:[(0,a.jsx)("div",{className:V.box,children:(0,a.jsx)($e.Iz,{featureName:"reporting",featureId:"reporting"})}),(0,a.jsx)(G.Y.Contents,{className:V.contents,children:(0,a.jsx)(Jp,{})}),(0,a.jsx)("div",{className:V.spacer})]})},Jp=({action:V})=>(0,a.jsx)($e.El,{featureName:"reporting",description:"Reporting allows you to automatically generate PDFs from any of your dashboards and have Grafana email them to interested parties on a schedule.",listItems:["Customize your exact layout and orientation","Personalize with your unique branding","Specify permissions for users across your company","Choose to send a report at custom intervals"],featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/reporting/",image:"reporting-email.png",caption:"Create reports to share your SLO performance, business metrics, cost and utilization metrics or anything else you can express in a Grafana dashboard.",action:V}),cm=V=>({contents:(0,y.css)`
      &.page-body {
        flex: 0;
      }
    `,spacer:(0,y.css)`
      flex: 1;
    `,box:(0,y.css)`
      ${V.breakpoints.up("sm")} {
        padding: ${V.spacing(0,1)};
      }

      ${V.breakpoints.up("md")} {
        padding: ${V.spacing(0,2)};
      }
    `}),dm=lm;function um(V){return{reports:V.reports.reports,hasFetched:V.reports.hasFetchedList,searchQuery:V.reports.searchQuery,reportCount:V.reports.reportCount}}const Zp={getReports:kd,deleteReport:cl,updateReport:ld},hm=(0,he.connect)(um,Zp)(({getReports:V,deleteReport:ye,updateReport:Be,reports:Je,reportCount:it,hasFetched:bt})=>{const[Qt,un]=(0,I.useState)("");(0,I.useEffect)(()=>{V()},[V]);const an=$n=>{ye($n.id)},Ln=()=>{const{rendererAvailable:$n}=s.$,Hn=sl(),Wn=r.contextSrv.hasPermission(fe.ReportingCreate),es=$n&&Wn;return(0,n.a)("reports.creation")?(0,a.jsxs)(a.Fragment,{children:[!$n&&(0,a.jsx)(vr,{variant:"error"}),$n&&Hn!==null&&Hn<3&&(0,a.jsx)(dr,{}),(0,Ye.z5)()&&(0,a.jsx)($e.Iz,{featureId:"reporting",eventVariant:"trial",featureName:"reporting",text:"Create unlimited reports during your trial of Grafana Pro."}),it>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"page-action-bar",children:(0,a.jsxs)("div",{className:"gf-form gf-form--grow",children:[(0,a.jsx)(De.p,{placeholder:"Search reports by report name, dashboard name or recipients",prefix:(0,a.jsx)(u.I,{name:"search"}),width:56,onChange:us=>un(us.target.value)}),(0,a.jsx)("div",{className:"page-action-bar__spacer"}),(0,a.jsx)(ee.z9,{variant:"primary",href:"reports/new",disabled:!es,icon:"plus",children:"Create a new report"})]})}),(0,a.jsx)(vp,{reports:Je,deleteReport:an,updateReport:Be,filter:Qt})]}):$n&&((0,Ye.z5)()?(0,a.jsx)(Jp,{action:{text:"Create report",link:"reports/new"}}):(0,a.jsx)(xt.A,{title:"You haven't created any reports yet.",buttonIcon:"envelope",buttonLink:"reports/new",buttonTitle:"Create a new report",buttonDisabled:!es,proTip:"",proTipLink:"",proTipLinkTitle:"",proTipTarget:"_blank"}))]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Gr,{message:`Creating new reports is not available with an expired license.
              Existing reports continue to be processed but you need to update your license to create a new one.`}),it>0&&(0,a.jsx)(vp,{reports:Je,deleteReport:an,updateReport:Be,filter:Qt})]})};return(0,a.jsx)(G.Y,{navId:"reports-list",subTitle:"Manage automatically generated PDF reports from any dashboards and have Grafana email them to interested parties.",children:(0,a.jsx)(G.Y.Contents,{isLoading:!bt,children:Ln()})})});var fm=e(16817),gm=e(37270),iu=e(73569),pm=e(99128);const ce=V=>V?ie(V)?"file":V.startsWith("http")||V.startsWith("data:")?"url":V.startsWith("#")||V.startsWith("rgb(")||V.startsWith("rgba(")?"color":"file":"url",ie=V=>V instanceof File,ve=V=>ie(V)?URL.createObjectURL(V):ce(V)==="file"?`${zg}${V}`:V,Re=V=>!V||V instanceof File?!0:typeof V=="string"&&V.startsWith("http"),He=[{label:"Paste URL",value:"url"},{label:"Upload file",value:"file"},{label:"Custom color",value:"color"}];function st({name:V,disabled:ye,allowedTypes:Be=["url","file"]}){const{control:Je,register:it,getValues:bt,setValue:Qt,watch:un,formState:{errors:an}}=(0,te.xW)(),[Ln]=(0,I.useState)(bt()[V]),$n=un(V,Ln),[Hn,Wn]=(0,I.useState)(ce(bt()[V])),es=(0,D.of)(ot);return(0,a.jsxs)(ne.B,{gap:2,direction:"column","data-testid":`resource-picker-${V}`,children:[(0,a.jsx)("div",{children:(0,a.jsx)(J.z,{options:He.filter(us=>Be.includes(us.value)),onChange:us=>{Wn(us),ce(Ln)===us?Qt(V,Ln):Qt(V,"")},disabled:ye,className:es.buttonGroup,value:Hn})}),Hn==="file"&&(0,a.jsx)(te.xI,{control:Je,name:V,render:({field:{onChange:us,ref:ps,...ds}})=>(0,a.jsxs)("div",{className:(0,y.cx)(es.dropzone,ye&&es.disabled),children:[(0,a.jsx)(gm.gH,{...ds,readAs:"readAsBinaryString",onFileRemove:ye?void 0:()=>Qt(V,""),options:{disabled:ye,multiple:!1,accept:{"image/*":[".jpeg",".jpg",".png"]},onDrop:xs=>{us(xs[0])}}}),!ie($n)&&$n!==""&&(0,a.jsx)(iu.I,{removeFile:ye?void 0:()=>Qt(V,""),file:{file:new File([$n],$n),error:null,id:""}})]})}),Hn==="url"&&(0,a.jsx)(_.D,{invalid:!!an[V],error:an[V]&&String(an[V]?.message),className:es.customField,children:(0,a.jsx)(De.p,{...it(V,{validate:us=>Re(us)||"Invalid URL"}),id:V,placeholder:"https://your.site/image.png",disabled:ye})}),Hn==="color"&&(0,a.jsx)(te.xI,{control:Je,name:V,render:({field:us})=>(0,a.jsx)("div",{className:es.pickerContainer,children:(0,a.jsx)(pm.i,{...us,id:V,placeholder:"Select color",disabled:ye})})})]})}const ot=V=>({pickerContainer:(0,y.css)`
      display: flex;
      position: relative;
    `,dropzone:(0,y.css)`
      & > div {
        & > small:first-of-type {
          display: none;
        }
      }
      // FileListItem
      & > div:nth-of-type(2) {
        & > span {
          & > span:nth-of-type(2) {
            display: none;
          }
        }
      }
    `,colorValue:(0,y.css)`
      margin-left: ${V.spacing(1)};
    `,buttonGroup:(0,y.css)`
      margin-bottom: ${V.spacing(2)};
    `,disabled:(0,y.css)`
      div {
        cursor: not-allowed;
      }
    `,customField:(0,y.css)`
      margin-top: -${V.spacing(2)};
    `}),yt=V=>V.startsWith("http")?Ja(V):!0,Et=({url:V,altText:ye,width:Be="200px"})=>{const Je=(0,D.IS)(Wt);return V?(0,a.jsx)("div",{className:(0,y.cx)(Je.wrapper,(0,y.css)`
          width: ${Be};
        `),children:yt(V)?(0,a.jsx)("img",{src:V,className:Je.img,alt:ye}):"Invalid image"}):null},Wt=V=>({wrapper:(0,y.css)`
      padding: ${V.spacing.sm};
      border: 1px solid ${V.colors.border3};
      border-radius: ${V.border.radius.sm};
      margin-bottom: ${V.spacing.md};
    `,img:(0,y.css)`
      width: 100%;
    `}),Zt=[{label:"Sent By",value:_e.SentBy},{label:"None",value:_e.None}],In=()=>{const{register:V,control:ye,watch:Be}=(0,te.xW)(),Je=Be("reportLogoUrl")||Fd,it=Be("emailLogoUrl")||qc,bt=Be("emailFooterMode"),Qt=r.contextSrv.hasPermission(fe.ReportingSettingsWrite);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(le.n,{label:"Report branding",disabled:!Qt,children:[(0,a.jsx)(_.D,{htmlFor:"reportLogoUrl",label:"Company logo URL",description:"The logo will be displayed in the document footer. Supported formats: png, jpg, gif.",children:(0,a.jsx)(st,{name:"reportLogoUrl"})}),(0,a.jsx)(Et,{url:Je===Fd?Fd:ve(Je),width:"60px",altText:"Company logo preview"})]}),(0,a.jsxs)(le.n,{label:"Email branding",disabled:!Qt,children:[(0,a.jsx)(_.D,{htmlFor:"emailLogoUrl",label:"Company logo URL",description:"The logo will be displayed in the email header. Supported formats: png, jpg, gif.",children:(0,a.jsx)(st,{name:"emailLogoUrl"})}),(0,a.jsx)(Et,{url:it===qc?qc:ve(it),altText:"Company logo preview"}),(0,a.jsx)(_.D,{label:"Email footer",children:(0,a.jsx)(te.xI,{name:"emailFooterMode",render:({field:{ref:un,...an}})=>(0,a.jsx)(J.z,{...an,options:Zt}),control:ye})}),bt===_e.SentBy&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.D,{label:"Footer link text",children:(0,a.jsx)(De.p,{...V("emailFooterText"),id:"emailFooterText",placeholder:"Grafana",type:"text"})}),(0,a.jsx)(_.D,{label:"Footer link URL",children:(0,a.jsx)(De.p,{...V("emailFooterLink"),id:"emailFooterLink",placeholder:"https://your.site",type:"url"})})]})]})]})},Sn=()=>{const{value:V,loading:ye,error:Be}=(0,fm.A)(async()=>{const an=await(0,S.AI)().get("/api/reports/settings");return it(an.branding),an}),{handleSubmit:Je,reset:it,...bt}=(0,te.mN)({mode:"onBlur",defaultValues:V?.branding}),Qt=an=>{const Ln=new FormData;for(const[$n,Hn]of Object.entries(an))Hn instanceof File&&(an={...an,[$n]:Hn.name},Ln.append("files",Hn));return Ln.append("config",JSON.stringify({branding:an})),fetch(`${s.$.appUrl}api/reports/settings`,{method:"POST",body:Ln}).then($n=>{$n.ok?(r.lE.emit(H.r1.alertSuccess,["Successfully saved configuration"]),Nt.Ny.push("/reports")):r.lE.emit(H.r1.alertError,["Error saving configuration",$n.statusText])})};if(Be)return(0,a.jsx)(G.Y,{navId:"reports-settings",subTitle:"Manage report template settings.",children:(0,a.jsx)($t.F,{title:"Error loading settings",severity:"error"})});const un=r.contextSrv.hasPermission(fe.ReportingSettingsWrite);return(0,a.jsx)(G.Y,{navId:"reports-settings",subTitle:"Manage report template settings.",children:(0,a.jsx)(G.Y.Contents,{isLoading:ye,children:s.$.rendererAvailable?(0,a.jsx)(te.Op,{...bt,reset:it,handleSubmit:Je,children:(0,a.jsxs)("form",{onSubmit:Je(Qt),style:{maxWidth:"500px"},children:[(0,a.jsx)(In,{}),(0,a.jsx)(ee.$n,{type:"submit",size:"md",variant:"primary",disabled:!un,children:"Save"})]})}):(0,a.jsx)(vr,{variant:"error"})})})};var gn=e(72255),En=e(15054);function Ss({scaleFactor:V}){const ye=(0,D.$j)(),Be=Cr(ye,V);return(0,a.jsx)("div",{className:Be.footer,children:(0,a.jsx)("div",{className:Be.logo,children:(0,a.jsx)("img",{className:Be.logoImg,src:"public/app/extensions/reports/img/grafana-logo.png",alt:"Report logo"})})})}function Cr(V,ye){return{footer:(0,y.css)({position:"fixed",bottom:0,height:V.spacing(4*ye),width:"100%"}),pageCount:(0,y.css)({height:"100%",display:"flex",fontWeight:V.typography.fontWeightMedium,fontSize:V.typography.bodySmall.fontSize,justifyContent:"center",alignItems:"center"}),logo:(0,y.css)({position:"absolute",top:V.spacing(.5*ye),right:V.spacing(2+.5*ye)}),logoImg:(0,y.css)({maxWidth:V.spacing(3*ye),maxHeight:V.spacing(3*ye)})}}const Ur=Ss;function Nr({reportTitle:V,dashboardTitle:ye,timeRange:Be,scaleFactor:Je}){const it=(0,D.$j)(),bt=ur(it,Je),Qt="YYYY-MM-DD HH:mm:ss Z";return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:bt.subHeader,children:[(0,a.jsxs)("div",{children:[V," - Generated on ",Ic.parse((0,h.KQ)(Date.now()))?.format("dddd, MMM DD YYYY")]}),(0,a.jsx)("div",{className:bt.timeRangeBlock,children:(0,a.jsxs)("div",{children:["Data time range:"," ",Ic.parse(Be.from,!0,Be.timeZone,Be.fiscalYearStartMonth)?.format(Qt),(0,a.jsx)("br",{}),Ic.parse(Be.to,!0,Be.timeZone,Be.fiscalYearStartMonth)?.format(Qt)]})})]}),(0,a.jsx)("div",{className:bt.dashboardTitle,children:ye}),(0,a.jsx)("hr",{className:bt.divider})]})}function ur(V,ye){return{subHeader:(0,y.css)({label:"subheader",display:"flex",fontWeight:V.typography.fontWeightMedium,fontSize:`${.85*ye}rem`,paddingTop:V.spacing(2)}),timeRangeBlock:(0,y.css)({label:"time-range-block",display:"flex",justifyContent:"flex-end",textAlign:"right",flexGrow:1}),dashboardTitle:(0,y.css)({label:"dashboard-title",fontSize:`${1.7*ye}rem`,fontWeight:V.typography.fontWeightMedium}),divider:(0,y.css)({marginTop:0,marginBottom:V.spacing(2*ye)})}}const Cl=Nr;var ic=e(41507);function mm(V,ye,Be,Je){const it=V.slice(),bt=[],Qt=Math.floor(Be/(En.sD+En.dU));let un=Qt;Je||(un=Qt/3);let an=0,Ln={items:[],h:0};bt.push(Ln);let $n=0,Hn=!1;for(let Wn=0;Wn<it.length;Wn++){const es=it[Wn],us=es instanceof Ms.tI,ps={x:0,y:an,w:En.cV,h:us?ye:Hn?un-ye:un,render:()=>(0,a.jsx)(es.Component,{model:es},es.state.key)};if(us&&(it.splice(Wn+1,0,...es.state.children),$n++),es instanceof ic.U&&es.state.repeatedPanels&&es.state.repeatedPanels.length>0){it.splice(Wn+1,0,...es.state.repeatedPanels);continue}an>=Qt&&(Ln.pageBreakAfter=!0,an=0,ps.y=0,Ln={items:[],h:0},bt.push(Ln)),an+=ps.h,Ln.items.push(ps),Ln.h=ps.y+ps.h,Hn=us}return bt}function Mm(V,ye,Be){const Je=V.slice(),it=[],bt=Math.floor(Be/(En.sD+En.dU));let Qt=0,un=!1,an={items:[],h:0};it.push(an);const Ln=Om(Je);for(let $n=0;$n<Ln.length;$n++){const Hn=Ln[$n],Wn=Hn.isRow||!1,es=Dm(Hn,Qt,bt,ye,un),us=$n<Ln.length-1?Dm(Ln[$n+1],Qt,bt,ye,Wn):null;let ps=Math.max(an.h,es.y+es.h),ds=0;Wn&&us!=null&&(ds=Math.max(an.h,us.y-ye+1+us.h)),(ps>bt||Wn&&ds>bt)&&(an.pageBreakAfter=!0,Qt=Hn.y*ye,es.y=0,an={items:[],h:0},it.push(an)),an.items.push(es),an.h=Math.max(an.h,es.y+es.h),Wn?(un=!0,Qt+=ye-1):us!=null&&us.y!==es.y&&(un=!1)}return it}function Om(V){const ye=V.slice(),Be=[];for(let Je=0;Je<ye.length;Je++){const it=ye[Je];if(it instanceof ic.U&&it.state.repeatedPanels&&it.state.repeatedPanels.length>0){const{repeatedPanels:bt,x:Qt,y:un,height:an,width:Ln}=it.state;let $n,Hn,Wn=an/bt.length,es=Ln;if(it.getRepeatDirection()==="h"){const us=Math.ceil(bt.length/it.getMaxPerRow());Wn=an/us,es=Ln/it.getMaxPerRow()}for(let us=0;us<bt.length;us++){const ps=bt[us];it.getRepeatDirection()==="h"?($n=us%it.getMaxPerRow()*es,Hn=un+Math.floor(us/it.getMaxPerRow())*Wn):($n=Qt,Hn=un+us*Wn),Be.push({x:$n,y:Hn,w:es,h:Wn,render:()=>(0,a.jsx)(ps.Component,{model:ps},ps.state.key)})}}else{let bt=!1;it instanceof Ms.tI&&(bt=!0,ye.splice(Je+1,0,...it.state.children)),Be.push({x:it.state.x,y:it.state.y,w:it.state.width,h:it.state.height,render:()=>(0,a.jsx)(it.Component,{model:it},it.state.key),isRow:bt})}}return Be.sort((Je,it)=>Je.y-it.y)}function Dm(V,ye,Be,Je,it){const bt={x:V.x,y:V.y*Je-ye,w:V.w,h:V.h*Je,render:V.render};return V.isRow&&(bt.h=1),it&&bt.h+1>Be?bt.h=Be-1:bt.h>Be&&(bt.h=Be),bt}function bm(V){return{margin:[En.dU,En.dU],containerWidth:V,containerPadding:[0,0],cols:En.cV,rowHeight:En.sD,maxRows:1e4}}function vm(V){const{margin:ye,containerPadding:Be,containerWidth:Je,cols:it}=V;return(Je-ye[0]*(it-1)-Be[0]*2)/it}function Pm(V,ye,Be){return Number.isFinite(V)?Math.round(ye*V+Math.max(0,V-1)*Be):V}function Cm(V,ye,Be,Je,it){const{margin:bt,containerPadding:Qt,rowHeight:un}=V,an=vm(V);return{width:Pm(Je,an,bt[0]),height:Pm(it,un,bt[1]),top:Math.round((un+bt[1])*Be+Qt[1]),left:Math.round((an+bt[0])*ye+Qt[0])}}function Jm(V,ye,Be,Je,it){const{margin:bt,cols:Qt,rowHeight:un,maxRows:an}=V,Ln=vm(V);let $n=Math.round((Be-bt[0])/(Ln+bt[0])),Hn=Math.round((ye-bt[1])/(un+bt[1]));return $n=Uh($n,0,Qt-Je),Hn=Uh(Hn,0,an-it),{x:$n,y:Hn}}function Zm(V,ye,Be,Je,it,bt){const{margin:Qt,maxRows:un,cols:an,rowHeight:Ln}=V,$n=vm(V);let Hn=Math.round((ye+Qt[0])/($n+Qt[0])),Wn=Math.round((Be+Qt[1])/(Ln+Qt[1])),es=Uh(Hn,0,an-Je),us=Uh(Wn,0,un-it);return["sw","w","nw"].indexOf(bt)!==-1&&(es=Uh(Hn,0,an)),["nw","n","ne"].indexOf(bt)!==-1&&(us=Uh(Wn,0,un)),{w:es,h:us}}function Uh(V,ye,Be){return Math.max(Math.min(V,Be),ye)}const Sm=794,Tm=1122,Im=130,Am=16;function Rm({grid:V,dashboardTitle:ye,timeRange:Be}){const[Je,it]=(0,I.useState)(!1),{scaleFactor:bt,isLandscape:Qt,isSimple:un,reportTitle:an}=Lm();jm(V.state.children);const{children:Ln}=V.useState();(0,I.useEffect)(()=>(it(!0),V.activate()),[V]);let $n=Sm,Hn=Tm;Qt&&($n=Tm,Hn=Sm);const Wn=(Hn-Im)*bt,es=$n*bt-2*Am;if(!Je)return null;let us;return un?us=mm(Ln,bt,Wn,Qt):us=Mm(Ln,bt,Wn),(0,a.jsx)("div",{style:{position:"relative"},children:us.map((ps,ds)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(Cl,{reportTitle:an||ye,dashboardTitle:ye,timeRange:Be,scaleFactor:bt}),(0,a.jsx)("div",{style:Um(ps,es),children:ps.items.map((xs,ua)=>(0,a.jsx)("div",{style:Bm(xs,es),children:xs.render()},ua))}),(0,a.jsx)(Ur,{scaleFactor:bt}),ps.pageBreakAfter&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{pageBreakAfter:"always",marginBottom:"16px"}}),(0,a.jsx)("div",{style:{marginBottom:"16px"}})]})]},ds))})}function Lm(){const V=(0,xe.zy)(),ye=new URLSearchParams(V.search),Be=parseFloat(ye.get("scale")??"");return{scaleFactor:isNaN(Be)?1:Be,isLandscape:ye.get("pdf.landscape")!=="false",isSimple:ye.get("pdf.layout")==="simple",reportTitle:ye.get("title")}}function jm(V){for(const ye of V)ye instanceof Ms.tI&&ye.state.isCollapsed&&ye.onCollapseToggle()}function Bm(V,ye){const Be=bm(ye),Je=Cm(Be,V.x,V.y,V.w,V.h);return{top:Je.top,left:Je.left,width:Je.width,height:Je.height,position:"absolute"}}function Um(V,ye){const Be=bm(ye),Je=Cm(Be,0,0,En.cV,V.h);return{width:Je.width,height:Je.height,position:"relative"}}function Nm({match:V,route:ye}){const Be=(0,gn.sP)(),{dashboard:Je,isLoading:it,loadError:bt}=Be.useState();return(0,I.useEffect)(()=>(Be.loadDashboard({uid:V.params.uid,route:d.DashboardRoutes.Report}),()=>{Be.clearState()}),[Be,V.params.uid,ye.routeName]),Je?(0,a.jsx)(wm,{model:Je}):(0,a.jsxs)("div",{children:[it&&(0,a.jsx)(wd.A,{}),bt&&(0,a.jsx)("h2",{children:bt})]})}function wm({model:V}){const[ye,Be]=(0,I.useState)(!1),Je=V.useState(),it=Je.$timeRange.useState(),bt=(0,D.of)(Fm);return(0,I.useEffect)(()=>(Be(!0),V.activate()),[V]),ye?(0,a.jsx)(Ms.$L,{scene:V,children:(0,a.jsx)("div",{className:bt.canvas,children:(0,a.jsx)("div",{className:bt.body,children:(0,a.jsx)(Rm,{grid:Je.body,dashboardTitle:Je.title,timeRange:it})})})}):null}function Fm(V){return{canvas:(0,y.css)({label:"canvas",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,padding:"0 "+V.spacing(2)}),body:(0,y.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",marginBottom:V.spacing(2)})}}const Wm=Nm;var Km=e(16797),al=e(19361),$m=e(38645),Vm=e(31771);function zm(){const V=s.$.whitelabeling;if(V){if(al.M.LoginTitle="Welcome to Grafana Enterprise",V.links.length>0&&(0,$m.DH)(()=>V.links.map(ye=>({...ye,target:"_blank"}))),(0,Vm.Q)(V.publicDashboard),V.appTitle&&(al.M.AppTitle=V.appTitle),V.loginLogo&&(al.M.LoginLogo=ye=>(0,a.jsx)("img",{className:(0,y.cx)(ye.className,(0,y.css)`
            max-width: 150px;
            max-height: 250px;
            width: auto;
            @media ${Km.mediaUp(s.$.theme.breakpoints.sm)} {
              max-width: 250px;
            }
          `),src:V.loginLogo,alt:"Login logo"}),al.M.LoginLogo.displayName="BrandingLoginLogo",al.M.LoginTitle="",al.M.GetLoginSubTitle=()=>""),V.loginTitle&&(al.M.LoginTitle=V.loginTitle),V.hideEdition&&(al.M.HideEdition=V.hideEdition),V.loginSubtitle&&(al.M.GetLoginSubTitle=()=>V.loginSubtitle),V.menuLogo&&(al.M.MenuLogo=ye=>(0,a.jsx)("img",{className:ye.className,src:V.menuLogo,alt:"Menu logo"}),al.M.MenuLogo.displayName="BrandingMenuLogo"),V.loginBackground){const ye=(0,y.css)`
      background: ${V.loginBackground};
      background-size: cover;
    `;al.M.LoginBackground=Be=>(0,a.jsx)("div",{className:(0,y.cx)(ye,Be.className),children:Be.children}),al.M.LoginBackground.displayName="BrandingLoginBackground"}if(V.loginBoxBackground){const ye=(0,y.css)`
      background: ${V.loginBoxBackground};
      background-size: cover;
    `;al.M.LoginBoxBackground=()=>ye}}}function _m(){(0,n.a)("caching")&&(0,o.Co)(to),(0,n.a)("reports")&&(0,o.Co)(Jg),(0,n.a)("analytics")&&(0,o.Co)(Nf),(0,n.a)("recordedqueries")&&(0,o.Co)(Rp),(0,n.a)("saml")&&(0,o.Co)(bo),s.$.featureToggles.teamHttpHeaders&&(0,o.Co)(Gh),s.$.featureToggles.notificationBanner&&(0,n.a)("announcementBanner")&&((0,o.Co)({[W.reducerPath]:W.reducer}),(0,o.C3)(W.middleware))}function Hm(){const V=s.$.featureToggles.featureHighlights;Cu(),Vl(),ku(),(0,n.a)("saml")&&Mo(),((0,n.a)("whitelabeling")||(0,n.a)("grafanacloud"))&&zm(),(0,n.a)("recordedqueries")&&s.$.publicDashboardAccessToken===""&&Fg(),(0,n.a)("admin")&&f(),(0,n.a)("publicDashboardsEmailSharing")&&g.jK.push({path:"/public-dashboards/:accessToken/request-access",component:mg,chromeless:!0},{path:"/public-dashboards/:accessToken/confirm-access",component:hg,chromeless:!0}),(0,n.a)("saml")&&g.jK.push({path:"/admin/authentication/saml/:step?",component:ul});const ye="/datasources/edit/:uid/cache",Be=`${i.b.DataSourcesEdit}/cache`;(0,n.a)("caching")?(g.jK.push({path:ye,component:Jr}),g.jK.push({path:Be,component:Oi})):V&&(g.jK.push({path:`${ye}/upgrade`,component:Ka}),g.jK.push({path:`${Be}/upgrade`,component:zo}));const Je="/datasources/edit/:uid/insights",it=`${i.b.DataSourcesEdit}/insights`;s.$.analytics?.enabled&&((0,n.a)("analytics")?(g.jK.push({path:Je,component:rg}),g.jK.push({path:it,component:Pr})):V&&(g.jK.push({path:`${Je}/upgrade`,component:og}),g.jK.push({path:`${it}/upgrade`,component:nr})));const bt="/datasources/edit/:uid/permissions",Qt=`${i.b.DataSourcesEdit}/permissions`;(0,n.a)("dspermissions.enforcement")?(g.jK.push({path:bt,component:Qu}),g.jK.push({path:Qt,component:sf})):V&&(g.jK.push({path:bt+"/upgrade",component:vc}),g.jK.push({path:`${Qt}/upgrade`,component:pu})),s.$.reporting?.enabled&&((0,n.a)("reports")?(g.jK.push({path:Yi,component:hm},{path:`${Yi}/settings`,component:Sn},{path:"/d-csv/:uid",pageClass:"dashboard-solo",routeName:d.DashboardRoutes.Normal,component:qp}),s.$.featureToggles.newPDFRendering&&g.jK.push({path:"/d-report/:uid/:slug?",component:Wm})):V&&g.jK.push({path:Yi,component:dm}),(0,n.a)("reports.creation")&&(g.jK.push({path:`${Yi}/new`,component:Yp}),g.jK.push({path:`${Yi}/:step?/:id?`,component:Yp})));const un=(0,n.a)("recordedqueries")&&s.$?.recordedQueries?.enabled;r.contextSrv.isEditor&&un&&g.jK.push({path:"/recorded-queries",component:Fp},{path:"/recorded-queries/write-target",component:_p}),s.$.featureToggles.notificationBanner&&(0,n.a)("announcementBanner")&&(g.jK.push({path:"/admin/banner-settings",component:we,roles:()=>r.contextSrv.evaluatePermission([fe.ActionBannersWrite])}),q())}function km(){Ml(),g.jK.push({path:"/admin/licensing",roles:()=>r.contextSrv.evaluatePermission([fe.LicensingRead,d.AccessControlAction.ActionServerStatsRead]),component:jf}),r.contextSrv.isSignedIn&&s.$.licenseInfo.stateInfo!=="Licensed"&&(0,l.Xp)(Uc(),s.$.featureToggles.featureHighlights?Yl.Test:Yl.Control,"")}function Gm(){km(),Hm()}},28036:(k,A,e)=>{"use strict";e.r(A),e.d(A,{ENTERPRISE_I18N_NAMESPACE:()=>s,LOCALE_EXTENSIONS:()=>l});var n=e(74513);const s="grafana-enterprise",l={[n.MB]:()=>e.e(9740).then(e.t.bind(e,29740,19)),[n.NY]:()=>e.e(7179).then(e.t.bind(e,87179,19)),[n.d_]:()=>e.e(6119).then(e.t.bind(e,16119,19)),[n.rT]:()=>e.e(3749).then(e.t.bind(e,23749,19)),[n.fY]:()=>e.e(8249).then(e.t.bind(e,18249,19)),[n.jQ]:()=>e.e(8591).then(e.t.bind(e,28591,19))}},82421:()=>{"use strict"},13280:()=>{"use strict"},40964:()=>{"use strict"},95273:()=>{"use strict"},5133:(k,A,e)=>{"use strict";e.d(A,{r:()=>g});var n=e(74848),s=e(62625),l=e(90182);const i=Object.values(s.X).filter(o=>o!==s.X.None).map(o=>({label:o,value:o}));function g({value:o,onChange:d,"aria-label":c,inputId:a,autoFocus:p,...u}){return(0,n.jsx)(l.l6,{inputId:a,value:o,options:i,onChange:m=>d(m.value??s.X.None),placeholder:"Choose role...","aria-label":c,autoFocus:p,...u})}},51372:(k,A,e)=>{"use strict";e.r(A),e.d(A,{ServerStats:()=>h});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(55852),o=e(31678),d=e(16233),c=e(70255),a=e(10860),p=e(67061),u=e(56034),m=e(14578);const v=({content:D,footer:P,isLoading:C})=>{const M=(0,i.of)(x);return(0,n.jsxs)(a.Z,{className:M.container,children:[D.map((I,R)=>(0,n.jsxs)(p.B,{justifyContent:"space-between",alignItems:"center",children:[(0,n.jsxs)(p.B,{alignItems:"center",children:[(0,n.jsx)("span",{className:(0,s.cx)({[M.indent]:!!I.indent}),children:I.name}),I.tooltip&&(0,n.jsx)(u.m,{content:String(I.tooltip),placement:"auto-start",children:(0,n.jsx)(m.I,{name:"info-circle",className:M.tooltip})})]}),C?(0,n.jsx)(c.A,{width:60}):(0,n.jsx)("span",{className:I.highlight?M.highlight:"",children:I.value})]},R)),P&&(0,n.jsx)("div",{children:P})]})},x=D=>({container:(0,s.css)({display:"flex",flexDirection:"column",gap:D.spacing(2),padding:D.spacing(2)}),indent:(0,s.css)({marginLeft:D.spacing(2)}),tooltip:(0,s.css)({color:D.colors.secondary.text}),highlight:(0,s.css)({color:D.colors.warning.text,padding:`${D.spacing(.5)} ${D.spacing(1)}`,marginRight:`-${D.spacing(1)}`})});var f=e(17172);const E=async()=>(0,f.AI)().get("api/admin/stats").catch(D=>(console.error(D),null)),h=()=>{const[D,P]=(0,l.useState)(null),[C,M]=(0,l.useState)(!0),I=(0,i.of)(b),R=d.TP.hasPermission(o.AccessControlAction.DataSourcesRead),T=d.TP.hasPermission(o.AccessControlAction.UsersRead);return(0,l.useEffect)(()=>{d.TP.hasPermission(o.AccessControlAction.ActionServerStatsRead)&&E().then(S=>{P(S),M(!1)})},[]),d.TP.hasPermission(o.AccessControlAction.ActionServerStatsRead)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:I.title,children:"Instance statistics"}),!C&&!D?(0,n.jsx)("p",{className:I.notFound,children:"No stats found."}):(0,n.jsxs)("div",{className:I.row,children:[(0,n.jsx)(v,{isLoading:C,content:[{name:"Dashboards (starred)",value:`${D?.dashboards} (${D?.stars})`},{name:"Tags",value:D?.tags},{name:"Playlists",value:D?.playlists},{name:"Snapshots",value:D?.snapshots}],footer:(0,n.jsx)(g.z9,{href:"/dashboards",variant:"secondary",children:"Manage dashboards"})}),(0,n.jsxs)("div",{className:I.doubleRow,children:[(0,n.jsx)(v,{isLoading:C,content:[{name:"Data sources",value:D?.datasources}],footer:R&&(0,n.jsx)(g.z9,{href:"/datasources",variant:"secondary",children:"Manage data sources"})}),(0,n.jsx)(v,{isLoading:C,content:[{name:"Alerts",value:D?.alerts}],footer:(0,n.jsx)(g.z9,{href:"/alerting/list",variant:"secondary",children:"Manage alerts"})})]}),(0,n.jsx)(v,{isLoading:C,content:[{name:"Organisations",value:D?.orgs},{name:"Users total",value:D?.users},{name:"Active sessions",value:D?.activeSessions},{name:"Active users in last 30 days",value:D?.activeUsers},...y(D,r.$)],footer:T&&(0,n.jsx)(g.z9,{href:"/admin/users",variant:"secondary",children:"Manage users"})})]})]}):null},y=(D,P)=>!P.anonymousEnabled||!D?.activeDevices?[]:P.anonymousDeviceLimit?[{name:"Active anonymous devices",value:`${D.activeDevices} / ${P.anonymousDeviceLimit}`,tooltip:"Detected devices that are not logged in, in last 30 days.",highlight:D.activeDevices>P.anonymousDeviceLimit}]:[{name:"Active anonymous devices",value:`${D.activeDevices}`,tooltip:"Detected devices that are not logged in, in last 30 days."}],b=D=>({title:(0,s.css)({marginBottom:D.spacing(4)}),row:(0,s.css)({display:"flex",justifyContent:"space-between",width:"100%","& > div:not(:last-of-type)":{marginRight:D.spacing(2)},"& > div":{width:"33.3%"}}),doubleRow:(0,s.css)({display:"flex",flexDirection:"column","& > div:first-of-type":{marginBottom:D.spacing(2)}}),notFound:(0,s.css)({fontSize:D.typography.h6.fontSize,textAlign:"center",height:"290px"})})},55356:(k,A,e)=>{"use strict";e.r(A),e.d(A,{UpgradeInfo:()=>x,UpgradePage:()=>m,default:()=>I});var n=e(74848),s=e(32196),l=e(71468),r=e(40845),i=e(55852),g=e(69444),o=e(17422);const d={fontWeight:500,fontSize:"26px",lineHeight:"123%"},c=R=>{const T=R.isDark?"public/img/licensing/header_dark.svg":"public/img/licensing/header_light.svg",S=R.isDark?R.v1.palette.dark9:R.v1.palette.gray6;return{container:(0,s.css)`
      padding: 36px 79px;
      background: ${R.components.panel.background};
    `,footer:(0,s.css)`
      text-align: center;
      padding: 16px;
      background: ${S};
    `,header:(0,s.css)`
      height: 137px;
      padding: 40px 0 0 79px;
      position: relative;
      background: url('${T}') right;
    `}};function a({header:R,editionNotice:T,subheader:S,children:L}){const O=(0,r.of)(c);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:O.header,children:[(0,n.jsx)("h2",{style:d,children:R}),S&&(0,n.jsx)("h3",{children:S}),(0,n.jsx)(p,{size:"128px",style:{boxShadow:"0px 0px 24px rgba(24, 58, 110, 0.45)",background:"#0A1C36",position:"absolute",top:"19px",left:"71%"},children:(0,n.jsx)("img",{src:"public/img/grafana_icon.svg",alt:"Grafana",width:"80px",style:{position:"absolute",left:"23px",top:"20px"}})})]}),(0,n.jsx)("div",{className:O.container,children:L}),T&&(0,n.jsx)("div",{className:O.footer,children:T})]})}const p=({size:R,style:T,children:S})=>{const L=(0,r.$j)();return(0,n.jsx)("div",{style:{width:R,height:R,position:"absolute",bottom:0,right:0,borderRadius:L.shape.radius.circle,...T},children:S})};var u=e(51372);function m({navModel:R}){return(0,n.jsx)(g.Y,{navModel:R,children:(0,n.jsxs)(g.Y.Contents,{children:[(0,n.jsx)(u.ServerStats,{}),(0,n.jsx)(x,{editionNotice:`You are running the open-source version of Grafana.
        You have to install the Enterprise edition in order enable Enterprise features.`})]})})}const v={fontWeight:500,fontSize:"26px",lineHeight:"123%"},x=({editionNotice:R})=>{const T=(0,r.of)(f);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:T.title,children:"Enterprise license"}),(0,n.jsx)(a,{header:"Grafana Enterprise",subheader:"Get your free trial",editionNotice:R,children:(0,n.jsxs)("div",{className:T.column,children:[(0,n.jsx)(b,{}),(0,n.jsx)(y,{})]})})]})},f=R=>({column:(0,s.css)`
      display: grid;
      grid-template-columns: 100%;
      column-gap: 20px;
      row-gap: 40px;

      @media (min-width: 1050px) {
        grid-template-columns: 50% 50%;
      }
    `,title:(0,s.css)`
      margin: ${R.spacing(4)} 0;
    `}),E=()=>(0,n.jsxs)("div",{style:{marginTop:"40px",marginBottom:"30px"},children:[(0,n.jsx)("h2",{style:v,children:"Get Grafana Enterprise"}),(0,n.jsx)(h,{}),(0,n.jsx)("p",{style:{paddingTop:"12px"},children:"You can use the trial version for free for 30 days. We will remind you about it five days before the trial period ends."})]}),h=()=>(0,n.jsx)(i.z9,{variant:"primary",size:"lg",href:"https://grafana.com/contact?about=grafana-enterprise&utm_source=grafana-upgrade-page",children:"Contact us and get a free trial"}),y=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{children:"At your service"}),(0,n.jsxs)(P,{children:[(0,n.jsx)(C,{title:"Enterprise Plugins",image:"public/img/licensing/plugin_enterprise.svg"}),(0,n.jsx)(C,{title:"Critical SLA: 2 hours",image:"public/img/licensing/sla.svg"}),(0,n.jsxs)(C,{title:"Unlimited Expert Support",image:"public/img/licensing/customer_support.svg",children:["24 x 7 x 365 support via",(0,n.jsxs)(P,{nested:!0,children:[(0,n.jsx)(C,{title:"Email"}),(0,n.jsx)(C,{title:"Private Slack channel"}),(0,n.jsx)(C,{title:"Phone"})]})]}),(0,n.jsx)(C,{title:"Hand-in-hand support",image:"public/img/licensing/handinhand_support.svg",children:"in the upgrade process"})]}),(0,n.jsxs)("div",{style:{marginTop:"20px"},children:[(0,n.jsx)("strong",{children:"Also included:"}),(0,n.jsx)("br",{}),"Indemnification, working with Grafana Labs on future prioritization, and training from the core Grafana team."]}),(0,n.jsx)(E,{})]}),b=()=>(0,n.jsxs)("div",{style:{paddingRight:"11px"},children:[(0,n.jsx)("h4",{children:"Enhanced functionality"}),(0,n.jsx)(D,{})]}),D=()=>(0,n.jsxs)(P,{children:[(0,n.jsx)(C,{title:"Data source permissions"}),(0,n.jsx)(C,{title:"Reporting"}),(0,n.jsx)(C,{title:"SAML authentication"}),(0,n.jsx)(C,{title:"Enhanced LDAP integration"}),(0,n.jsx)(C,{title:"Team Sync",children:"LDAP, GitHub OAuth, Auth Proxy, Okta"}),(0,n.jsx)(C,{title:"White labeling"}),(0,n.jsx)(C,{title:"Auditing"}),(0,n.jsx)(C,{title:"Settings updates at runtime"}),(0,n.jsx)(C,{title:"Grafana usage insights",children:(0,n.jsxs)(P,{nested:!0,children:[(0,n.jsx)(C,{title:"Sort dashboards by popularity in search"}),(0,n.jsx)(C,{title:"Find unused dashboards"}),(0,n.jsx)(C,{title:"Dashboard usage stats drawer"}),(0,n.jsx)(C,{title:"Dashboard presence indicators"})]})}),(0,n.jsx)(C,{title:"Enterprise plugins",children:(0,n.jsxs)(P,{nested:!0,children:[(0,n.jsx)(C,{title:"Oracle"}),(0,n.jsx)(C,{title:"Splunk"}),(0,n.jsx)(C,{title:"Service Now"}),(0,n.jsx)(C,{title:"Dynatrace"}),(0,n.jsx)(C,{title:"New Relic"}),(0,n.jsx)(C,{title:"DataDog"}),(0,n.jsx)(C,{title:"AppDynamics"}),(0,n.jsx)(C,{title:"SAP HANA\xAE"}),(0,n.jsx)(C,{title:"Gitlab"}),(0,n.jsx)(C,{title:"Honeycomb"}),(0,n.jsx)(C,{title:"Jira"}),(0,n.jsx)(C,{title:"MongoDB"}),(0,n.jsx)(C,{title:"Salesforce"}),(0,n.jsx)(C,{title:"Snowflake"}),(0,n.jsx)(C,{title:"Wavefront"})]})})]}),P=({children:R,nested:T})=>{const S=(0,s.css)`
    display: flex;
    flex-direction: column;
    padding-top: 8px;

    > div {
      margin-bottom: ${T?0:8}px;
    }
  `;return(0,n.jsx)("div",{className:S,children:R})},C=({children:R,title:T,image:S})=>{const L=S||"public/img/licensing/checkmark.svg",O=(0,s.css)`
    display: flex;

    > img {
      display: block;
      height: 22px;
      flex-grow: 0;
      padding-right: 12px;
    }
  `,j=(0,s.css)`
    font-weight: 500;
    line-height: 1.7;
  `;return(0,n.jsxs)("div",{className:O,children:[(0,n.jsx)("img",{src:L,alt:""}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:j,children:T}),R]})]})},M=R=>({navModel:(0,o.tc)(R.navIndex,"upgrading")}),I=(0,l.connect)(M)(m)},75192:(k,A,e)=>{"use strict";e.d(A,{PU:()=>K,jT:()=>j});var n=e(74848),s=e(32196),l=e(96540),r=e(71468),i=e(13544),g=e(40845),o=e(67647),d=e(94354),c=e(55852),a=e(69529),p=e(69444),u=e(10096),m=e(8484),v=e(31678),x=e(12942),f=e(72109),E=e(67061),h=e(56034),y=e(14578),b=e(94753),D=e(78369),P=e(48840),C=e(19384),M=e(46334),I=e(90613);const R=({units:X,icon:q})=>X?.length?X.length>1?(0,n.jsx)(h.m,{placement:"top",content:(0,n.jsx)(E.B,{direction:"column",children:X?.map(G=>(0,n.jsx)("span",{children:G.name},G.name))}),children:(0,n.jsx)(T,{icon:q,children:X.length})}):(0,n.jsx)(T,{icon:q,children:X[0].name}):null,T=(0,l.forwardRef)(({children:X,icon:q},G)=>(0,n.jsxs)(I.a,{ref:G,display:"flex",alignItems:"center",marginRight:1,children:[(0,n.jsx)(y.I,{name:q})," ",(0,n.jsx)(I.a,{marginLeft:1,children:X})]}));T.displayName="TooltipContent";const S=({users:X,showPaging:q,totalPages:G,onChangePage:te,currentPage:H,fetchData:se})=>{const ne=(0,l.useMemo)(()=>X.some(Q=>Q.licensedRole),[X]),le=(0,l.useMemo)(()=>X.some(Q=>Q.orgs),[X]),_=(0,l.useMemo)(()=>[{id:"avatarUrl",header:"",cell:({cell:{value:Q}})=>Q&&(0,n.jsx)(x.e,{src:Q,alt:"User avatar"})},{id:"login",header:"Login",cell:({row:{original:Q}})=>(0,n.jsx)(f.Y,{color:"primary",inline:!1,href:`/admin/users/edit/${Q.id}`,title:"Edit user",children:Q.login}),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:Q}})=>Q,sortType:"string"},{id:"name",header:"Name",cell:({cell:{value:Q}})=>Q,sortType:"string"},...le?[{id:"orgs",header:"Belongs to",cell:({cell:{value:Q,row:ae}})=>(0,n.jsxs)(E.B,{alignItems:"center",children:[(0,n.jsx)(R,{units:Q,icon:"building"}),ae.original.isAdmin&&(0,n.jsx)(h.m,{placement:"top",content:"Grafana Admin",children:(0,n.jsx)(y.I,{name:"shield"})})]})}]:[],...ne?[{id:"licensedRole",header:"Licensed role",cell:({cell:{value:Q}})=>Q==="None"?(0,n.jsxs)(b.E,{color:"disabled",children:["Not assigned"," ",(0,n.jsx)(h.m,{placement:"top",content:"A licensed role will be assigned when this user signs in",children:(0,n.jsx)(y.I,{name:"question-circle"})})]}):Q}]:[],{id:"lastSeenAtAge",header:"Last active",headerTooltip:{content:"Time since user was seen using Grafana",iconName:"question-circle"},cell:({cell:{value:Q}})=>(0,n.jsx)(n.Fragment,{children:Q&&(0,n.jsx)(n.Fragment,{children:Q==="10 years"?(0,n.jsx)(b.E,{color:"disabled",children:"Never"}):Q})}),sortType:(Q,ae)=>new Date(Q.original.lastSeenAt).getTime()-new Date(ae.original.lastSeenAt).getTime()},{id:"authLabels",header:"Origin",cell:({cell:{value:Q}})=>(0,n.jsx)(n.Fragment,{children:Array.isArray(Q)&&Q.length>0&&(0,n.jsx)(M.E,{label:Q[0],removeIcon:!1,count:0})})},{id:"isDisabled",header:"",cell:({cell:{value:Q}})=>(0,n.jsx)(n.Fragment,{children:Q&&(0,n.jsx)(D.v,{colorIndex:9,name:"Disabled"})})},{id:"edit",header:"",cell:({row:{original:Q}})=>(0,n.jsx)(c.z9,{variant:"secondary",size:"sm",icon:"pen",href:`admin/users/edit/${Q.id}`,"aria-label":`Edit user ${Q.name}`,tooltip:"Edit user"})}],[ne,le]);return(0,n.jsxs)(E.B,{direction:"column",gap:2,children:[(0,n.jsx)(P.j,{columns:_,data:X,getRowId:Q=>String(Q.id),fetchData:se}),q&&(0,n.jsx)(E.B,{justifyContent:"flex-end",children:(0,n.jsx)(C.d,{numberOfPages:G,currentPage:H,onNavigate:te})})]})};var L=e(57334);const O=[],j=X=>{O.push(X)},N=i.Tp.pages.UserListPage.UserListAdminPage,F={fetchUsers:L.hU,changeQuery:L.nM,changePage:L.yd,changeFilter:L.$u,changeSort:L.Vk},U=X=>({users:X.userListAdmin.users,query:X.userListAdmin.query,showPaging:X.userListAdmin.showPaging,totalPages:X.userListAdmin.totalPages,page:X.userListAdmin.page,filters:X.userListAdmin.filters,isLoading:X.userListAdmin.isLoading}),K=(0,r.connect)(U,F)(({fetchUsers:X,query:q,changeQuery:G,users:te,showPaging:H,changeFilter:se,filters:ne,totalPages:le,page:_,changePage:Q,changeSort:ae,isLoading:oe})=>{const J=(0,g.of)(z);return(0,l.useEffect)(()=>{X()},[X]),(0,n.jsxs)(p.Y.Contents,{children:[(0,n.jsx)("div",{className:J.actionBar,"data-testid":N.container,children:(0,n.jsxs)("div",{className:J.row,children:[(0,n.jsx)(o.Z,{placeholder:"Search user by login, email, or name.",autoFocus:!0,value:q,onChange:G}),(0,n.jsx)(d.z,{options:[{label:"All users",value:!1},{label:"Active last 30 days",value:!0}],onChange:ee=>se({name:"activeLast30Days",value:ee}),value:ne.find(ee=>ee.name==="activeLast30Days")?.value,className:J.filter}),O.map((ee,de)=>(0,n.jsx)(ee,{filters:ne,onChange:se,className:J.filter},de)),u.contextSrv.hasPermission(v.AccessControlAction.UsersCreate)&&(0,n.jsx)(c.z9,{href:"admin/users/create",variant:"primary",children:"New user"})]})}),!oe&&te.length===0?(0,n.jsx)(a.p,{message:(0,m.t)("users.empty-state.message","No users found"),variant:"not-found"}):(0,n.jsx)(S,{users:te,showPaging:H,totalPages:le,onChangePage:Q,currentPage:_,fetchData:ae})]})});function W(){return jsx(Page,{navId:"global-users",children:jsx(K,{})})}const z=X=>({filter:(0,s.css)({margin:X.spacing(0,1),[X.breakpoints.down("sm")]:{margin:0}}),actionBar:(0,s.css)({marginBottom:X.spacing(2),display:"flex",alignItems:"flex-start",gap:X.spacing(2),[X.breakpoints.down("sm")]:{flexWrap:"wrap"}}),row:(0,s.css)({display:"flex",alignItems:"flex-start",textAlign:"left",marginBottom:X.spacing(.5),flexGrow:1,[X.breakpoints.down("sm")]:{flexWrap:"wrap",gap:X.spacing(2),width:"100%"}})}),Y=null},57334:(k,A,e)=>{"use strict";e.d(A,{$u:()=>K,A5:()=>G,Bc:()=>te,DX:()=>j,JI:()=>L,Jc:()=>N,Kg:()=>O,MV:()=>f,N6:()=>y,P3:()=>P,Pi:()=>C,T$:()=>I,TK:()=>v,VR:()=>R,Vk:()=>z,hG:()=>h,hU:()=>U,is:()=>H,kz:()=>u,ly:()=>x,mI:()=>S,nM:()=>B,nh:()=>D,nr:()=>E,pm:()=>T,xq:()=>X,yd:()=>W});var n=e(2543),s=e.n(n),l=e(72724),r=e(33378),i=e(17172),g=e(39601),o=e(2913),d=e(10096),c=e(80714),a=e(31678),p=e(44672);function u(se){return async ne=>{try{ne((0,p.D1)(!1)),await ne(m(se)),await ne(b(se)),await ne(M(se)),o.Ay.ldapEnabled&&(0,r.a)("ldapsync")&&await ne(T()),ne((0,p.D1)(!0))}catch(le){if(console.error(le),(0,i.NF)(le)){const _={title:le.data.message,body:le.data.error};ne((0,p.PV)(_))}}}}function m(se){return async ne=>{const le=await(0,i.AI)().get(`/api/users/${se}`,(0,c.F)());ne((0,p.G_)(le))}}function v(se){return async ne=>{await(0,i.AI)().put(`/api/users/${se.id}`,se),ne(u(se.id))}}function x(se,ne){return async le=>{const _={password:ne};await(0,i.AI)().put(`/api/admin/users/${se}/password`,_),le(u(se))}}function f(se){return async ne=>{await(0,i.AI)().post(`/api/admin/users/${se}/disable`),g.Ny.push("/admin/users")}}function E(se){return async ne=>{await(0,i.AI)().post(`/api/admin/users/${se}/enable`),ne(u(se))}}function h(se){return async ne=>{await(0,i.AI)().delete(`/api/admin/users/${se}`),g.Ny.push("/admin/users")}}function y(se,ne){return async le=>{const _={isGrafanaAdmin:ne};await(0,i.AI)().put(`/api/admin/users/${se}/permissions`,_),le(u(se))}}function b(se){return async ne=>{const le=await(0,i.AI)().get(`/api/users/${se}/orgs`);ne((0,p.OF)(le))}}function D(se,ne,le){return async _=>{const Q={loginOrEmail:se.login,role:le};await(0,i.AI)().post(`/api/orgs/${ne}/users/`,Q),_(u(se.id))}}function P(se,ne,le){return async _=>{const Q={role:le};await(0,i.AI)().patch(`/api/orgs/${ne}/users/${se}`,Q),_(u(se))}}function C(se,ne){return async le=>{await(0,i.AI)().delete(`/api/orgs/${ne}/users/${se}`),le(u(se))}}function M(se){return async ne=>{if(!d.contextSrv.hasPermission(a.AccessControlAction.UsersAuthTokenList))return;const le=await(0,i.AI)().get(`/api/admin/users/${se}/auth-tokens`);le.reverse();const _=le.map(Q=>({id:Q.id,isActive:Q.isActive,seenAt:(0,l.fq)(Q.seenAt),createdAt:Q.createdAt,clientIp:Q.clientIp,browser:Q.browser,browserVersion:Q.browserVersion,os:Q.os,osVersion:Q.osVersion,device:Q.device}));ne((0,p.ag)(_))}}function I(se,ne){return async le=>{const _={authTokenId:se};await(0,i.AI)().post(`/api/admin/users/${ne}/revoke-auth-token`,_),le(M(ne))}}function R(se){return async ne=>{await(0,i.AI)().post(`/api/admin/users/${se}/logout`),ne(M(se))}}function T(){return async se=>{const ne=d.contextSrv.hasPermission(a.AccessControlAction.LDAPStatusRead);if((0,r.a)("ldapsync")&&ne){const le=await(0,i.AI)().get("/api/admin/ldap-sync-status");se((0,p.OR)(le))}}}function S(se){return async ne=>{await(0,i.AI)().post(`/api/admin/ldap/sync/${se}`),ne(u(se))}}function L(){return async se=>{if(d.contextSrv.hasPermission(a.AccessControlAction.LDAPStatusRead))try{const ne=await(0,i.AI)().get("/api/admin/ldap/status");se((0,p.pH)(ne))}catch(ne){if((0,i.NF)(ne)){ne.isHandled=!0;const le={title:ne.data.message,body:ne.data.error};se((0,p.V$)(le))}}}}function O(se){return async ne=>{try{const le=await(0,i.AI)().get(`/api/admin/ldap/${encodeURIComponent(se)}`),{name:_,surname:Q,email:ae,login:oe,isGrafanaAdmin:J,isDisabled:ee,roles:de,teams:xe}=le,re={info:{name:_,surname:Q,email:ae,login:oe},permissions:{isGrafanaAdmin:J,isDisabled:ee},roles:de,teams:xe};ne((0,p.TW)(re))}catch(le){if((0,i.NF)(le)){le.isHandled=!0;const _={title:le.data.message,body:le.data.error};ne((0,p.Vv)()),ne((0,p.Nf)(_))}}}}function j(){return se=>{se((0,p.zi)())}}function N(){return se=>{se((0,p.zi)()),se((0,p.Vv)())}}const F=se=>se.map(ne=>Array.isArray(ne.value)?ne.value.map(le=>`${ne.name}=${le.value}`).join("&"):`${ne.name}=${ne.value}`).join("&");function U(){return async(se,ne)=>{try{const{perPage:le,page:_,query:Q,filters:ae,sort:oe}=ne().userListAdmin;let J=`/api/users/search?perpage=${le}&page=${_}&query=${Q}&${F(ae)}`;oe&&(J+=`&sort=${oe}`);const ee=await(0,i.AI)().get(J);se((0,p.Mb)(ee))}catch(le){(0,p.g4)(),console.error(le)}}}const w=(0,n.debounce)(se=>se(U()),500);function B(se){return async ne=>{ne((0,p.Cj)()),ne((0,p.L5)(se)),w(ne)}}function K(se){return async ne=>{ne((0,p.Cj)()),ne((0,p.jX)(se)),w(ne)}}function W(se){return async ne=>{ne((0,p.Cj)()),ne((0,p.EC)(se)),ne(U())}}function z({sortBy:se}){const ne=se.length?`${se[0].id}-${se[0].desc?"desc":"asc"}`:void 0;return async(le,_)=>{_().userListAdmin.sort!==ne&&(le((0,p.Cj)()),le((0,p.$u)(ne)),le(U()))}}const Y=se=>se.map(ne=>Array.isArray(ne.value)?ne.value.map(le=>`${ne.name}=${le.value}`).join("&"):`${ne.name}=${ne.value}`).join("&");function X(){return async(se,ne)=>{try{const{perPage:le,page:_,query:Q,filters:ae,sort:oe}=ne().userListAnonymousDevices;let J=`/api/anonymous/search?perpage=${le}&page=${_}&query=${Q}&${Y(ae)}`;oe&&(J+=`&sort=${oe}`);const ee=await(0,i.AI)().get(J);se((0,p.o3)(ee))}catch(le){console.error(le)}}}const q=(0,n.debounce)(se=>se(X()),500);function G({sortBy:se}){const ne=se.length?`${se[0].id}-${se[0].desc?"desc":"asc"}`:void 0;return async(le,_)=>{_().userListAnonymousDevices.sort!==ne&&(le((0,p.kh)(ne)),le(X()))}}function te(se){return async ne=>{ne((0,p.xx)(se)),q(ne)}}function H(se){return async ne=>{ne((0,p.iK)(se)),ne(X())}}},44672:(k,A,e)=>{"use strict";e.d(A,{$u:()=>S,Ay:()=>K,Cj:()=>C,D1:()=>E,EC:()=>R,G_:()=>v,L5:()=>I,Mb:()=>P,Nf:()=>c,OF:()=>x,OR:()=>d,PV:()=>h,TW:()=>a,V$:()=>o,Vv:()=>i,ag:()=>f,g4:()=>M,iK:()=>U,jX:()=>T,kh:()=>F,o3:()=>N,pH:()=>g,xx:()=>w,zi:()=>r});var n=e(65307);const s={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},l=(0,n.Z0)({name:"ldap",initialState:s,reducers:{ldapConnectionInfoLoadedAction:(W,z)=>({...W,ldapError:void 0,connectionInfo:z.payload}),ldapFailedAction:(W,z)=>({...W,ldapError:z.payload}),ldapSyncStatusLoadedAction:(W,z)=>({...W,syncInfo:z.payload}),userMappingInfoLoadedAction:(W,z)=>({...W,user:z.payload,userError:void 0}),userMappingInfoFailedAction:(W,z)=>({...W,user:void 0,userError:z.payload}),clearUserMappingInfoAction:(W,z)=>({...W,user:void 0}),clearUserErrorAction:(W,z)=>({...W,userError:void 0})}}),{clearUserErrorAction:r,clearUserMappingInfoAction:i,ldapConnectionInfoLoadedAction:g,ldapFailedAction:o,ldapSyncStatusLoadedAction:d,userMappingInfoFailedAction:c,userMappingInfoLoadedAction:a}=l.actions,p=l.reducer,u={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},m=(0,n.Z0)({name:"userAdmin",initialState:u,reducers:{userProfileLoadedAction:(W,z)=>({...W,user:z.payload}),userOrgsLoadedAction:(W,z)=>({...W,orgs:z.payload}),userSessionsLoadedAction:(W,z)=>({...W,sessions:z.payload}),userAdminPageLoadedAction:(W,z)=>({...W,isLoading:!z.payload}),userAdminPageFailedAction:(W,z)=>({...W,error:z.payload,isLoading:!1})}}),{userProfileLoadedAction:v,userOrgsLoadedAction:x,userSessionsLoadedAction:f,userAdminPageLoadedAction:E,userAdminPageFailedAction:h}=m.actions,y=m.reducer,b={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},D=(0,n.Z0)({name:"userListAdmin",initialState:b,reducers:{usersFetched:(W,z)=>{const{totalCount:Y,perPage:X,...q}=z.payload,G=Math.ceil(Y/X);return{...W,...q,totalPages:G,perPage:X,showPaging:G>1,isLoading:!1}},usersFetchBegin:W=>({...W,isLoading:!0}),usersFetchEnd:W=>({...W,isLoading:!1}),queryChanged:(W,z)=>({...W,query:z.payload,page:0}),pageChanged:(W,z)=>({...W,page:z.payload}),sortChanged:(W,z)=>({...W,page:0,sort:z.payload}),filterChanged:(W,z)=>{const{name:Y,value:X}=z.payload;return W.filters.some(q=>q.name===Y)?{...W,page:0,filters:W.filters.map(q=>q.name===Y?{...q,value:X}:q)}:{...W,page:0,filters:[...W.filters,z.payload]}}}}),{usersFetched:P,usersFetchBegin:C,usersFetchEnd:M,queryChanged:I,pageChanged:R,filterChanged:T,sortChanged:S}=D.actions,L=D.reducer,O={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},j=(0,n.Z0)({name:"userListAnonymousDevices",initialState:O,reducers:{usersAnonymousDevicesFetched:(W,z)=>{const{totalCount:Y,perPage:X,...q}=z.payload,G=Math.ceil(Y/X);return{...W,...q,totalPages:G,perPage:X,showPaging:G>1}},anonQueryChanged:(W,z)=>({...W,query:z.payload,page:0}),anonPageChanged:(W,z)=>({...W,page:z.payload}),anonUserSortChanged:(W,z)=>({...W,page:0,sort:z.payload}),filterChanged:(W,z)=>{const{name:Y,value:X}=z.payload;return W.filters.some(q=>q.name===Y)?{...W,page:0,filters:W.filters.map(q=>q.name===Y?{...q,value:X}:q)}:{...W,page:0,filters:[...W.filters,z.payload]}}}}),{usersAnonymousDevicesFetched:N,anonUserSortChanged:F,anonPageChanged:U,anonQueryChanged:w}=j.actions,B=j.reducer,K={ldap:p,userAdmin:y,userListAdmin:L,userListAnonymousDevices:B}},35538:(k,A,e)=>{"use strict";e.d(A,{pL:()=>s,z5:()=>r});var n=e(32264);const s=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function l(){const i=n.$.licenseInfo?.trialExpiry;return!!(i&&i>0)}const r=()=>l()&&n.$.featureToggles.featureHighlights},55907:(k,A,e)=>{"use strict";e.d(A,{A:()=>y,p:()=>o});var n=e(2543),s=e.n(n),l=e(1062);const r=new l.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),i=[{text:"Query",value:"query"}],g={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var o=(b=>(b.IsAbove="gt",b.IsBelow="lt",b.IsOutsideRange="outside_range",b.IsWithinRange="within_range",b.HasNoValue="no_value",b))(o||{});const d=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],c=[{text:"OR",value:"or"},{text:"AND",value:"and"}],a=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],p=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],u=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function m(b){const D=new l.tI({type:b.type,defaultParams:[]});return new l.kW(b,D)}function v(b){return b.toLowerCase().replace(/_/g,"").split(" ")[0]}function x(b){switch(v(b)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function f(b,D){return(0,n.reduce)(b,(P,C)=>(C.metric!==void 0&&C.value!==void 0&&P.push(C.metric+"="+C.value),C.Metric!==void 0&&C.Value!==void 0&&P.push(C.Metric+"="+C.Value),P),[]).join(D)}function E(b){return(0,n.isArray)(b.data)?f(b.data,", "):(0,n.isArray)(b.data.evalMatches)?f(b.data.evalMatches,", "):b.data.error?"Error: "+b.data.error:""}function h(b){return(0,n.isArray)(b)?f(b,", "):(0,n.isArray)(b.evalMatches)?f(b.evalMatches,", "):b.error?"Error: "+b.error:""}const y={alertQueryDef:r,getStateDisplayModel:x,conditionTypes:i,evalFunctions:d,evalOperators:c,noDataModes:p,executionErrorModes:u,reducerTypes:a,createReducerPart:m,getAlertAnnotationInfo:E,getAlertAnnotationText:h,alertStateSortScore:g}},1062:(k,A,e)=>{"use strict";e.d(A,{Dw:()=>g,Wn:()=>i,kW:()=>r,tI:()=>l});var n=e(2543),s=e.n(n);class l{constructor(a){this.type=a.type,this.params=a.params,this.defaultParams=a.defaultParams,this.renderer=a.renderer,this.category=a.category,this.addStrategy=a.addStrategy}}class r{constructor(a,p){if(this.part=a,this.def=p,!this.def)throw{message:"Could not find query part "+a.type};a.params=a.params||(0,n.clone)(this.def.defaultParams),this.params=a.params,this.text="",this.updateText()}render(a){return this.def.renderer(this,a)}hasMultipleParamsInString(a,p){return a.indexOf(",")===-1?!1:this.def.params[p+1]&&this.def.params[p+1].optional}updateParam(a,p){if(this.hasMultipleParamsInString(a,p)){(0,n.each)(a.split(","),(u,m)=>{this.updateParam(u.trim(),m)});return}a===""&&this.def.params[p].optional?this.params.splice(p,1):this.params[p]=a,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let a=this.def.type+"(";a+=this.params.join(", "),a+=")",this.text=a}}function i(c,a){const p=c.def.type+"(",u=(0,n.map)(c.params,(m,v)=>{const x=c.def.params[v];return x.type==="time"&&m==="auto"&&(m="$__interval"),x.quote==="single"?"'"+m+"'":x.quote==="double"?'"'+m+'"':m});return a&&u.unshift(a),p+u.join(", ")+")"}function g(c,a){return a+" "+c.params[0]}function o(c,a){return c.params[0]}function d(c,a){return'"'+c.params[0]+'"'}},25027:(k,A,e)=>{"use strict";e.d(A,{AK:()=>R,Cl:()=>B,Fb:()=>N,Hs:()=>z,IR:()=>I,KF:()=>E,Ke:()=>y,P6:()=>K,QA:()=>x,Rk:()=>M,Sn:()=>O,Sq:()=>P,U6:()=>U,U7:()=>f,aL:()=>j,fH:()=>u,hJ:()=>F,iW:()=>W,l$:()=>v,le:()=>p,nf:()=>C,t6:()=>w,vV:()=>m,zs:()=>S});var n=e(2543),s=e.n(n),l=e(47232),r=e(34867),i=e(17172),g=e(32264),o=e(14110),d=e(10096),c=e(28475);const a=7,p={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history"},{logInfo:u,logError:m,logMeasurement:v}=(0,r.DW)("features.alerting",{module:"Alerting"});function x(Y,X,q){return async function(...G){const te=performance.now(),H=await X(...G),se=performance.now()-te;return v(Y,{loadTimesMs:se},q),H}}function f(Y,X,q){return async(...G)=>{const te=performance.now(),H=await X(...G),{namespacesCount:se,groupsCount:ne,rulesCount:le}=h(H);return v(Y,{loadTimeMs:performance.now()-te,namespacesCount:se,groupsCount:ne,rulesCount:le},q),H}}function E(Y){Object.entries(Y).forEach(([X,q])=>{const G=q.message??"unknown error",te=String(q.type)??"unknown",H=new Error(G);m(H,{field:X,type:te})})}function h(Y){const X=Y.length,q=Y.flatMap(H=>H.groups).length,G=Y.flatMap(H=>H.groups).flatMap(H=>H.rules).length;return{namespacesCount:X,groupsCount:q,rulesCount:G}}function y(Y,X,q){return async(...G)=>{const te=performance.now(),H=await X(...G),{namespacesCount:se,groupsCount:ne,rulesCount:le}=b(H);return v(Y,{namespacesCount:se,groupsCount:ne,rulesCount:le,loadTimeMs:performance.now()-te},q),H}}function b(Y){const X=Object.keys(Y),q=Object.values(Y).flatMap(te=>te),G=q.flatMap(te=>te.rules);return{namespacesCount:X.length,groupsCount:q.length,rulesCount:G.length}}async function D(){try{const{createdAt:Y}=await(0,i.AI)().get("/api/user"),X=(0,l.KQ)().subtract(a,"days"),q=(0,l.KQ)(Y);return X.isBefore(q)}catch{return!0}}const P=async(Y={grafana_version:g.$.buildInfo.version,org_id:d.contextSrv.user.orgId,user_id:d.contextSrv.user.id})=>{await D()||(0,o.rR)("grafana_alerting_navigation",Y)},C=Y=>{(0,o.rR)("grafana_alerting_rule_creation",Y)},M=Y=>{(0,o.rR)("grafana_alerting_rule_aborted",Y)},I=Y=>{(0,o.rR)("grafana_alerting_rule_form_error",Y)},R=async Y=>{const X={grafana_version:g.$.buildInfo.version,org_id:d.contextSrv.user.orgId,user_id:d.contextSrv.user.id};(0,o.rR)("grafana_alerting_insights",{...X,...Y})};function T(Y){(0,o.rR)("grafana_alerting_rules_search",{...Y})}function S({oldQuery:Y,newQuery:X}){try{const q=(0,c.XY)(Y),G=(0,c.XY)(X),te=L(q);L(G).filter(ne=>!te.includes(ne)).forEach(ne=>{T({filter:ne,triggeredBy:"typing"})})}catch(q){q instanceof Error&&m(q)}}function L(Y){return Object.entries(Y).filter(([X,q])=>!(0,n.isEmpty)(q)).map(([X])=>X)}function O(Y){T({filter:Y,triggeredBy:"component"})}function j(Y){(0,o.rR)("grafana_alerting_rules_list_mode",{...Y})}function N(){(0,o.rR)("grafana_alerting_switch_to_simplified_routing")}function F(){(0,o.rR)("grafana_alerting_switch_to_policies_routing")}function U(){(0,o.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function w(){(0,o.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function B(){(0,o.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function K(Y){(0,o.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",Y)}function W(){(0,o.rR)("grafana_alerting_central_alert_state_history_expand_row")}function z(Y){(0,o.rR)("grafana_alerting_central_alert_state_history_max_events_reached",Y)}},79741:(k,A,e)=>{"use strict";e.r(A),e.d(A,{default:()=>f,defaultPageNav:()=>v});var n=e(74848),s=e(96540),l=e(17172),r=e(42418),i=e(66602),g=e(7392),o=e(37959),d=e(5179),c=e(39890),a=e(730),p=e(56361),u=e(18461);const m=E=>{const h=(0,u.uE)(E.match.params),[y]=(0,c.P5)(),D=y===c.gQ.Instances?void 0:0,P=(0,s.useMemo)(()=>{if(!h)throw new Error("Rule ID is required");return(0,u.qg)(h,!0)},[h]),{loading:C,error:M,result:I}=(0,a.ZU)({ruleIdentifier:P,limitAlerts:D});return M?(0,n.jsx)(o.d,{pageNav:v,navId:"alert-list",children:(0,n.jsx)(x,{error:M})}):C?(0,n.jsx)(o.d,{pageNav:v,navId:"alert-list",isLoading:!0,children:(0,n.jsx)(n.Fragment,{})}):I?(0,n.jsx)(d.K,{identifier:P,rule:I,children:(0,n.jsx)(c.Ay,{})}):(0,n.jsx)(o.d,{pageNav:v,navId:"alert-list",children:(0,n.jsx)(g.L,{entity:"Rule"})})},v={id:"alert-rule-view",text:""};function x({error:E}){return(0,l.NF)(E)&&E.status===404?(0,n.jsx)(g.L,{entity:"Rule"}):(0,n.jsx)(r.F,{title:"Something went wrong loading the rule",children:(0,p.JZ)(E)})}const f=(0,i.Xc)(m,{style:"page"})},79938:(k,A,e)=>{"use strict";e.d(A,{hK:()=>m});var n=e(2543),s=e.n(n),l=e(8484),r=e(57220),i=e(75214),g=e(23662),o=e(49962),d=e(49498),c=e(28220);const a="/api/v1/rule/test/grafana",p="api/prometheus/grafana/api/v1/rules";var u=(v=>(v.RuleGroup="rule_group",v.Namespace="file",v.FolderUID="folder_uid",v.LimitAlerts="limit_alerts",v))(u||{});const m=o.Hr.injectEndpoints({endpoints:v=>({preview:v.mutation({query:({alertQueries:x,condition:f,customLabels:E,folder:h,alertName:y,alertUid:b})=>({url:a,data:{rule:{grafana_alert:{data:x,condition:f,no_data_state:"Alerting",title:y,uid:b??"N/A"},for:"0s",labels:(0,i.x4)(E),annotations:{}},folderUid:h.uid,folderTitle:h.title},method:"POST"})}),prometheusRulesByNamespace:v.query({query:({limitAlerts:x,identifier:f,filter:E,state:h,matcher:y})=>{const b=new URLSearchParams;x&&b.set("limit_alerts",String(x)),f&&((0,g.Mj)(f)||(0,g.X4)(f))&&(b.set("file",f.namespace),b.set("rule_group",f.groupName));const D=(0,d.bZ)(b,E);return{url:p,params:(0,d.Dj)(D,h,y)}},transformResponse:x=>(0,d.lH)(x.data.groups,r.hY)}),prometheusRuleNamespaces:v.query({query:({ruleSourceName:x,namespace:f,groupName:E,ruleName:h,dashboardUid:y,panelId:b,limitAlerts:D})=>{const P={rule_group:E,rule_name:h,dashboard_uid:y,panel_id:b?.toString()};return f&&((0,r.z2)(x)?(0,n.set)(P,"folder_uid",f):(0,n.set)(P,"file",f)),D!==void 0&&(0,n.set)(P,"limit_alerts",String(D)),{url:`api/prometheus/${(0,r.w5)(x)}/api/v1/rules`,params:P}},transformResponse:(x,f,E)=>(0,d.lH)(x.data.groups,E.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:v.query({query:({rulerConfig:x,filter:f})=>{const{path:E,params:h}=(0,c.$o)(x).rules(f);return{url:E,params:h}},providesTags:["CombinedAlertRule"]}),rulerNamespace:v.query({query:({rulerConfig:x,namespace:f})=>{const{path:E,params:h}=(0,c.$o)(x).namespace(f);return{url:E,params:h}}}),getRuleGroupForNamespace:v.query({query:({rulerConfig:x,namespace:f,group:E,requestOptions:h})=>{const{path:y,params:b}=(0,c.$o)(x).namespaceGroup(f,E);return(0,o.EB)({url:y,params:b},h)},providesTags:(x,f,{namespace:E,group:h})=>[{type:"RuleGroup",id:`${E}/${h}`},{type:"RuleNamespace",id:E}]}),deleteRuleGroupFromNamespace:v.mutation({query:({rulerConfig:x,namespace:f,group:E,requestOptions:h})=>{const y=(0,l.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:b,params:D}=(0,c.$o)(x).namespaceGroup(f,E);return(0,o.EB)({url:b,params:D,method:"DELETE"},h,{successMessage:y})},invalidatesTags:(x,f,{namespace:E,group:h})=>[{type:"RuleGroup",id:`${E}/${h}`},{type:"RuleNamespace",id:E}]}),upsertRuleGroupForNamespace:v.mutation({query:({payload:x,namespace:f,rulerConfig:E,requestOptions:h})=>{const{path:y,params:b}=(0,c.$o)(E).namespace(f),D=(0,l.t)("alerting.rule-groups.update.success","Successfully updated rule group");return(0,o.EB)({url:y,params:b,data:x,method:"POST"},h,{successMessage:D})},invalidatesTags:(x,f,{namespace:E})=>[{type:"RuleNamespace",id:E}]}),getAlertRule:v.query({query:({uid:x})=>({url:`/api/ruler/${r.hY}/api/v1/rule/${x}`}),providesTags:(x,f,{uid:E})=>[{type:"GrafanaRulerRule",id:E}]}),exportRules:v.query({query:({format:x,folderUid:f,group:E,ruleUid:h})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:x,folderUid:f,group:E,ruleUid:h},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:v.query({query:({receiverName:x,decrypt:f,format:E})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:E,decrypt:f,name:x},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:v.query({query:({decrypt:x,format:f})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:f,decrypt:x},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:v.query({query:({format:x})=>({url:"/api/v1/provisioning/policies/export/",params:{format:x},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:v.mutation({query:({payload:x,format:f,nameSpaceUID:E})=>({url:`/api/ruler/grafana/api/v1/rules/${E}/export/`,params:{format:f},responseType:"text",data:x,method:"POST"})}),exportMuteTimings:v.query({query:({format:x})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:x},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:v.query({query:({format:x,muteTiming:f})=>({url:`/api/v1/provisioning/mute-timings/${f}/export/`,params:{format:x},responseType:"text"}),keepUnusedDataFor:0})})})},91540:(k,A,e)=>{"use strict";e.d(A,{F:()=>r});var n=e(26272),s=e(28138),l=e(49962);const r=l.Hr.injectEndpoints({endpoints:i=>({getSilences:i.query({query:({datasourceUid:g,ruleMetadata:o,accessControl:d})=>({url:`/api/alertmanager/${g}/api/v2/silences`,params:{ruleMetadata:o,accesscontrol:d}}),providesTags:g=>g?g.map(({id:o})=>({type:"AlertmanagerSilences",id:o})):["AlertmanagerSilences"]}),getSilence:i.query({query:({datasourceUid:g,id:o,ruleMetadata:d,accessControl:c})=>({url:`/api/alertmanager/${g}/api/v2/silence/${o}`,showErrorAlert:!1,params:{ruleMetadata:d,accesscontrol:c}}),providesTags:(g,o,{id:d})=>g?[{type:"AlertmanagerSilences",id:d}]:["AlertmanagerSilences"]}),createSilence:i.mutation({query:({datasourceUid:g,payload:o})=>({url:`/api/alertmanager/${g}/api/v2/silences`,method:"POST",data:o}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(g,{queryFulfilled:o})=>{try{await o,s.A.emit(n.r1.alertSuccess,["Silence created"])}catch{s.A.emit(n.r1.alertError,["Could not create silence"])}}}),expireSilence:i.mutation({query:({datasourceUid:g,silenceId:o})=>({url:`/api/alertmanager/${g}/api/v2/silence/${o}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(k,A,e)=>{"use strict";e.d(A,{EB:()=>c,Hr:()=>p});var n=e(75816),s=e(2543),l=e.n(s),r=e(75505),i=e(26272),g=e(17172),o=e(28138),d=e(25027);function c(u,m={},v={}){return{...u,...(0,s.defaultsDeep)(m,v)}}const a=()=>async({successMessage:u,errorMessage:m,body:v,...x})=>{try{const f={...x,...v&&{data:v},...u&&{showSuccessAlert:!1},...m&&{showErrorAlert:!1}},E=performance.now(),{data:h,...y}=await(0,r.s)((0,g.AI)().fetch(f));return(0,d.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-E},{url:x.url,method:x.method??"GET",responseStatus:y.statusText}),u&&x.showSuccessAlert!==!1&&o.A.emit(i.r1.alertSuccess,[u]),{data:h,meta:y}}catch(f){return m&&x.showErrorAlert!==!1&&o.A.emit(i.r1.alertError,[m]),{error:f}}},p=(0,n.xP)({reducerPath:"alertingApi",baseQuery:a(),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaSlo","RuleGroup","RuleNamespace"],endpoints:()=>({})})},32415:(k,A,e)=>{"use strict";e.d(A,{By:()=>a,VO:()=>c,WS:()=>i,f4:()=>d,nd:()=>o,vk:()=>g});var n=e(75505),s=e(39070),l=e(17172),r=e(57220);async function i(x){try{const f=await(0,n.s)((0,l.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(x)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:f.data.template_files??{},template_file_provenances:f.data.template_file_provenances??{},alertmanager_config:f.data.alertmanager_config??{},last_applied:f.data.last_applied,id:f.data.id}}catch(f){if(x===r.hY&&(0,l.NF)(f)&&f.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw f}}async function g(x,f){await(0,n.s)((0,l.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,r.w5)(x)}/config/api/v1/alerts`,data:f,showErrorAlert:!1,showSuccessAlert:!1}))}async function o(x){await(0,n.s)((0,l.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,r.w5)(x)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function d(x){return(await(0,n.s)((0,l.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(x)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function c(x){return(await(0,n.s)((0,l.AI)().fetch({url:`/api/alertmanager/${(0,r.w5)(x)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function a(x,f,E){const h={receivers:f,alert:E};try{const y=await(0,n.s)((0,l.AI)().fetch({method:"POST",data:h,url:`/api/alertmanager/${(0,r.w5)(x)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(p(y.data))throw new Error(v(y.data))}catch(y){throw(0,l.NF)(y)&&u(y.data)&&p(y.data)?new Error(v(y.data)):y}}function p(x){return x.receivers.some(f=>f.grafana_managed_receiver_configs.some(E=>E.status==="failed"))}function u(x){return(0,s.Gv)(x)&&"receivers"in x&&Array.isArray(x.receivers)?x.receivers.every(m):!1}function m(x){return(0,s.Gv)(x)&&"name"in x&&typeof x.name=="string"&&"grafana_managed_receiver_configs"in x&&Array.isArray(x.grafana_managed_receiver_configs)}function v(x){return x.receivers.flatMap(f=>f.grafana_managed_receiver_configs.filter(E=>E.status==="failed").map(E=>E.error??"Unknown error.")).join("; ")}},82843:(k,A,e)=>{"use strict";e.d(A,{m:()=>v});var n=e(2543),s=e.n(n),l=e(99140),r=e(25027),i=e(98164),g=e(57220),o=e(56361),d=e(88467),c=e(49962),a=e(32415),p=e(77583);const u=30,m=30*1e3,v=c.Hr.injectEndpoints({endpoints:x=>({getAlertmanagerAlerts:x.query({query:({amSourceName:f,filter:E,showErrorAlert:h=!0})=>{const y=E?.matchers?.filter(R=>R.name&&R.value).map(R=>`${R.name}${(0,i.MN)(R)}${(0,o.Y9)(R.value)}`),{silenced:b,inhibited:D,unprocessed:P,active:C}=E||{},M=Object.fromEntries(Object.entries({silenced:b,active:C,inhibited:D,unprocessed:P}).filter(([R,T])=>T!==void 0)),I={filter:y};return M&&Object.keys(M).forEach(R=>{I[R]=M[R]}),{url:`/api/alertmanager/${(0,g.w5)(f)}/api/v2/alerts`,params:I,showErrorAlert:h}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:x.query({query:({amSourceName:f})=>({url:`/api/alertmanager/${(0,g.w5)(f)}/api/v2/alerts/groups`})}),grafanaNotifiers:x.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:x.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:x.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:x.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:f=>f.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:x.mutation({query:f=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:f,showSuccessAlert:!1}),invalidatesTags:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus"]}),getAlertmanagerConfigurationHistory:x.query({query:()=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/history`,params:{limit:u}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:x.mutation({query:f=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/history/${f.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:x.query({queryFn:async f=>{const E=f===g.hY;if((0,g.AL)(f))return(0,d.$I)((0,a.VO)(f).then(M=>({data:{alertmanager_config:M.config,template_files:{}}})));const{data:y}=await(0,l.JD)(p.L.endpoints.discoverAmFeatures.initiate({amSourceName:f})),b={alertmanager_config:{},template_files:{},template_file_provenances:{}},D=y?.lazyConfigInit??!1,P=(0,r.QA)("unifiedalerting/fetchAmConfig",a.WS,{dataSourceName:f,thunk:"unifiedalerting/fetchAmConfig"}),C=(0,o.i9)(()=>P(f),M=>!!(0,d.CZ)(M)?.includes("alertmanager storage object not found")&&!D,m).then(M=>E?M:(0,n.isEmpty)(M.alertmanager_config)&&(0,n.isEmpty)(M.template_files)?(0,a.VO)(f).then(R=>({alertmanager_config:R.config,template_files:{},template_file_provenances:M.template_file_provenances,last_applied:M.last_applied,id:M.id})):M).then(M=>M??b).then(M=>({data:M})).catch(M=>{if(D&&(0,d.CZ)(M)?.includes("alertmanager storage object not found"))return{data:b};throw M});return(0,d.$I)(C).catch(M=>({error:M,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:x.mutation({query:({selectedAlertmanager:f,config:E})=>({url:`/api/alertmanager/${(0,g.w5)(f)}/config/api/v1/alerts`,method:"POST",data:E,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration"]}),getContactPointsStatus:x.query({query:()=>({url:`/api/alertmanager/${(0,g.w5)(g.hY)}/config/api/v1/receivers`}),transformResponse:f=>{const E=h=>h.startsWith("0001-01-01");return f.map(h=>({...h,integrations:h.integrations.map(y=>{const b=E(y.lastNotifyAttempt);return{...y,lastNotifyAttempt:b?"":y.lastNotifyAttempt,lastNotifyAttemptDuration:b?"":y.lastNotifyAttemptDuration}})}))}}),getContactPointsList:x.query({query:()=>({url:"/api/v1/notifications/receivers"})}),getMuteTimingList:x.query({query:()=>({url:"/api/v1/notifications/time-intervals"})})})})},92240:(k,A,e)=>{"use strict";e.d(A,{O5:()=>p,_y:()=>a,nD:()=>d});var n=e(75505),s=e(17172),l=e(94822),r=e(55740),i=e(57220),g=e(49498),o=e(28220);async function d(E){if(E===i.hY)return{features:{rulerApiEnabled:!0}};const h=(0,i.oh)(E);if(!h)throw new Error(`Cannot find data source configuration for ${E}`);const{url:y,name:b,type:D}=h;if(!y)throw new Error("The data source url cannot be empty.");if(D!=="prometheus"&&D!=="loki")throw new Error(`The build info request is not available for ${D}. Only 'prometheus' and 'loki' are supported`);return c({name:b,url:y,type:D})}async function c(E){const{url:h,name:y,type:b}=E,D=b==="loki"?void 0:await m(h);if(!(D!==void 0)){if(!await v(y))throw new Error(`Unable to fetch alert rules. Is the ${y} data source properly configured?`);const I=await x(y);return{application:l.N1.Cortex,features:{rulerApiEnabled:I}}}const{features:C}=D.data;return C?{application:l.N1.Mimir,features:{rulerApiEnabled:C?.ruler_config_api==="true"}}:{application:l.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function a(E){if(E===i.hY)return{lazyConfigInit:!1};const h=u(E),{url:y,type:b}=h;if(!y)throw new Error("The data source url cannot be empty.");if(b!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${b}. Only 'alertmanager' type is supported`);return await p(y)}async function p(E){try{return{lazyConfigInit:(await m(E))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function u(E){const h=(0,i.oh)(E);if(!h)throw new Error(`Cannot find data source configuration for ${E}`);return h}async function m(E){return(await(0,n.s)((0,s.AI)().fetch({url:`${E}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(y=>{if(!("status"in y&&y.status===404))throw y}))?.data}async function v(E){try{return await(0,g.sA)(E),!0}catch{return!1}}async function x(E){try{return await(0,o.Zp)(E),!0}catch(h){if(f(h))return!1;throw h}}function f(E){return(0,s.NF)(E)?E.data.message?.includes("GetRuleGroup unsupported in rule local store")||E.data.message?.includes("page not found")||E.data.message?.includes(r.UU):E instanceof Error&&E.message?.includes("404 from rules config endpoint")}},77583:(k,A,e)=>{"use strict";e.d(A,{L:()=>g});var n=e(94822),s=e(25027),l=e(57220),r=e(49962),i=e(92240);const g=r.Hr.injectEndpoints({endpoints:o=>({discoverAmFeatures:o.query({queryFn:async({amSourceName:d})=>{try{return{data:await(0,i._y)(d)}}catch(c){return{error:c}}}}),discoverDsFeatures:o.query({queryFn:async({rulesSourceName:d})=>{const c=(0,l.Jz)(d);if(!c)return{error:new Error(`Missing data source configuration for ${d}`)};const p=await(0,s.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",i.nD,{dataSourceName:d,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(c.name);return{data:{rulerConfig:p.features.rulerApiEnabled?{dataSourceName:c.name,apiVersion:p.application===n.N1.Cortex?"legacy":"config"}:void 0}}}})})})},26423:(k,A,e)=>{"use strict";e.d(A,{Pc:()=>i,WG:()=>o,uz:()=>a});var n=e(17172),s=e(37534),l=e(99494),r=e(49962);const i="grafana_alerting_v2",g=p=>`/api/plugin-proxy/${l.W.OnCall}${p}`,o=r.Hr.injectEndpoints({endpoints:p=>({grafanaOnCallIntegrations:p.query({query:()=>({url:g("/api/internal/v1/alert_receive_channels/"),params:{filters:!0,integration:[s.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:u=>d(u)?u.results:u,providesTags:["OnCallIntegrations"]}),validateIntegrationName:p.query({query:u=>({url:g("/api/internal/v1/alert_receive_channels/validate_name/"),params:{verbal_name:u},showErrorAlert:!1})}),createIntegration:p.mutation({query:u=>({url:g("/api/internal/v1/alert_receive_channels/"),data:u,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:p.query({query:()=>({url:g("/api/internal/v1/features/"),showErrorAlert:!1})}),onCallConfigChecks:p.query({query:()=>({url:g("/api/internal/v1/organization/config-checks/"),showErrorAlert:!1})})})});function d(p){return"results"in p&&Array.isArray(p.results)}const{useGrafanaOnCallIntegrationsQuery:c}=o;function a(p){return(0,n.NF)(p)&&"detail"in p.data}},49498:(k,A,e)=>{"use strict";e.d(A,{Dj:()=>o,Kw:()=>c,bZ:()=>g,lH:()=>d,sA:()=>p});var n=e(75505),s=e(17172),l=e(57220),r=e(23662);function i(u){const{dataSourceName:m,limitAlerts:v,identifier:x}=u;return{rules:(f,E,h)=>{const y=new URLSearchParams;m===l.hY&&v&&y.set("limit_alerts",String(v)),x&&((0,r.Mj)(x)||(0,r.X4)(x))&&(y.set("file",x.namespace),y.set("rule_group",x.groupName));const b=g(y,f);return{url:`/api/prometheus/${(0,l.w5)(m)}/api/v1/rules`,params:o(b,E,h)}}}}function g(u,m){return m?.dashboardUID&&(u.set("dashboard_uid",m.dashboardUID),m?.panelId&&u.set("panel_id",String(m.panelId))),Object.fromEntries(u)}function o(u,m,v){let x={...u};if(m?.length&&(x={...x,state:m}),v?.length){const f=v.map(E=>JSON.stringify(E));x={...x,matcher:f}}return x}const d=(u,m)=>{const v={};return u.forEach(x=>{x.rules.forEach(f=>{f.query=f.query||""}),v[x.file]?v[x.file].groups.push(x):v[x.file]={dataSourceName:m,name:x.file,groups:[x]}}),Object.values(v)},c=(u=[])=>u?.flatMap(m=>m.groups.flatMap(v=>a(v,m.name)));function a(u,m){return{name:u.name,file:m,rules:u.rules,interval:u.interval}}async function p(u,m,v,x,f,E){if(m?.dashboardUID&&u!==l.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:h,params:y}=i({dataSourceName:u,limitAlerts:v,identifier:E}).rules(m,f,x),b=await(0,n.s)((0,s.AI)().fetch({url:h,params:y,showErrorAlert:!1,showSuccessAlert:!1})).catch(D=>{throw"status"in D&&D.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):D});return d(b.data.data.groups,u)}},28220:(k,A,e)=>{"use strict";e.d(A,{$o:()=>o,AJ:()=>m,E8:()=>d,HO:()=>u,Zp:()=>p,iy:()=>c});var n=e(75505),s=e(39070),l=e(17172),r=e(55740),i=e(57220),g=e(49498);function o(y){const D=`${`/api/ruler/${(0,i.w5)(y.dataSourceName)}`}/api/v1/rules`,P=new URLSearchParams;return P.set("subtype",y.apiVersion==="legacy"?"cortex":"mimir"),{rules:C=>{const M=(0,g.bZ)(P,C);return{path:`${D}`,params:M}},namespace:C=>({path:`${D}/${encodeURIComponent(C)}`,params:Object.fromEntries(P)}),namespaceGroup:(C,M)=>({path:`${D}/${encodeURIComponent(C)}/${encodeURIComponent(M)}`,params:Object.fromEntries(P)})}}async function d(y,b,D){const{path:P,params:C}=o(y).namespace(b);await(0,n.s)((0,l.AI)().fetch({method:"POST",url:P,data:D,showErrorAlert:!1,showSuccessAlert:!1,params:C}))}async function c(y,b){if(b?.dashboardUID&&y.dataSourceName!==i.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:D,params:P}=o(y).rules(b);return v(D,{},P)}async function a(y,b){const{path:D,params:P}=o(y).namespace(b);return(await v(D,{},P))[b]||[]}async function p(y){return v(`/api/ruler/${(0,i.w5)(y)}/api/v1/rules/test/test`,null)}async function u(y,b,D){const{path:P,params:C}=o(y).namespaceGroup(b,D);return v(P,null,C)}async function m(y,b,D){const{path:P,params:C}=o(y).namespaceGroup(b,D);await(0,n.s)((0,l.AI)().fetch({url:P,method:"DELETE",showSuccessAlert:!1,showErrorAlert:!1,params:C}))}async function v(y,b,D){try{return(await(0,n.s)((0,l.AI)().fetch({url:y,showErrorAlert:!1,showSuccessAlert:!1,params:D}))).data}catch(P){if(!x(P))throw P;if(E(P))return b;throw f(P)?{...P,data:{...P.data,message:r.UU}}:P}}function x(y){if(!(0,s.Gv)(y))return!1;const b="data"in y&&y.data!==null&&y.data!==void 0;return"status"in y&&Number.isFinite(y.status)&&b}function f(y){return y.status===404||y.status===500&&y.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function E(y){return y.status===404&&(y.data.message?.includes("group does not exist")||y.data.message?.includes("no rule groups found"))}async function h(y,b){const{path:D,params:P}=o(y).namespace(b);await lastValueFrom(getBackendSrv().fetch({method:"DELETE",url:D,showErrorAlert:!1,showSuccessAlert:!1,params:P}))}},15458:(k,A,e)=>{"use strict";e.d(A,{R:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(29158);const i=({labelKey:o,value:d,operator:c="=",onRemoveLabel:a})=>{const p=(0,l.of)(g);return(0,n.jsxs)("div",{className:p.wrapper,children:[o,c,d,!!a&&(0,n.jsx)(r.K,{name:"times",size:"xs",onClick:a,tooltip:"Remove label"})]})},g=o=>({wrapper:(0,s.css)({padding:o.spacing(.5,1),borderRadius:o.shape.radius.default,border:`solid 1px ${o.colors.border.medium}`,fontSize:o.typography.bodySmall.fontSize,backgroundColor:o.colors.background.secondary,fontWeight:o.typography.fontWeightBold,color:o.colors.text.primary,display:"inline-block",lineHeight:"1.2"})})},69087:(k,A,e)=>{"use strict";e.d(A,{m:()=>v});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(55127),g=e.n(i),o=e(96540),d=e(40845),c=e(55852),a=e(69613),p=e(8484),u=e(75214),m=e(8406);const v=({labels:E,commonLabels:h={},size:y,onClick:b})=>{const D=(0,d.of)(f,y),[P,C]=(0,o.useState)(!1),M=(0,l.chain)(E).toPairs().reject(u.w0).reject(([S])=>P?!1:S in h).value(),I=Object.keys(h).length,R=I>0,T=(0,p.t)("alert-labels.button.show.tooltip","Show common labels");return(0,n.jsxs)("div",{className:D.wrapper,role:"list","aria-label":"Labels",children:[M.map(([S,L])=>(0,n.jsx)(m.J,{size:y,label:S,value:L,color:x(S),onClick:b},S+L)),!P&&R&&(0,n.jsxs)(c.$n,{variant:"secondary",fill:"text",onClick:()=>C(!0),tooltip:T,tooltipPlacement:"top",size:"sm",children:["+",I," common ",g()("label",I)]}),P&&R&&(0,n.jsx)(c.$n,{variant:"secondary",fill:"text",onClick:()=>C(!1),tooltipPlacement:"top",size:"sm",children:(0,n.jsx)(p.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function x(E){return(0,a.MC)(E).color}const f=(E,h)=>({wrapper:(0,s.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:h==="md"?E.spacing():E.spacing(.5)})})},37959:(k,A,e)=>{"use strict";e.d(A,{d:()=>h,y:()=>y});var n=e(74848),s=e(87586),l=e(69444),r=e(70383),i=e(32196),g=e(96540),o=e(40845),d=e(14186),c=e(90182),a=e(57220);function p(P){return P.name===a.hY?"Grafana":P.name.slice(0,37)}const u=({disabled:P=!1})=>{const C=(0,o.of)(m),{selectedAlertmanager:M,availableAlertManagers:I,setSelectedAlertmanager:R}=(0,r.VI)(),T=(0,g.useMemo)(()=>I.map(O=>({label:p(O),value:O.name,imgUrl:O.imgUrl,meta:O.meta})),[I]),S=P||T.length===1,L=S?"Alertmanager":"Choose Alertmanager";return(0,n.jsx)(d.I,{className:C.field,label:L,disabled:S,"data-testid":"alertmanager-picker",children:(0,n.jsx)(c.l6,{"aria-label":L,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:O=>{O?.value&&R(O.value)},options:T,maxMenuHeight:500,noOptionsMessage:"No datasources found",value:M,getOptionLabel:O=>O.label})})},m=P=>({field:(0,i.css)({margin:0})});var v=e(42418);const x=()=>(0,n.jsx)(v.F,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."}),f=()=>(0,n.jsx)(v.F,{title:"Selected Alertmanager not found.",severity:"warning",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."}),E=({availableAlertManagers:P})=>{const C=P.length>0;return(0,n.jsx)("div",{children:C?(0,n.jsx)(f,{}):(0,n.jsx)(x,{})})},h=({children:P,isLoading:C,...M})=>(0,n.jsx)(l.Y,{...M,children:(0,n.jsx)(l.Y.Contents,{isLoading:C,children:P})}),y=({children:P,accessType:C,...M})=>{const I=b();return(0,n.jsx)(r.b9,{accessType:C,children:(0,n.jsx)(h,{...M,actions:(0,n.jsx)(u,{disabled:I}),children:(0,n.jsx)(D,{children:P})})})};function b(){const P=(0,s.A)();return["/edit","/new"].some(M=>P?.pathname?.includes(M))}const D=({children:P})=>{const{availableAlertManagers:C,selectedAlertmanager:M}=(0,r.VI)();return M?(0,n.jsx)(n.Fragment,{children:P}):(0,n.jsx)(E,{availableAlertManagers:C})}},71223:(k,A,e)=>{"use strict";e.d(A,{s:()=>p});var n=e(74848),s=e(32196),l=e(56034),r=e(40845),i=e(72109),g=e(55740),o=e(84396),d=e(16577),c=e(73750);const a=["message","description"],p=({annotationKey:v,value:x,valueLink:f})=>{const E=v,h=g.J3[E]?(0,n.jsx)(l.m,{content:v,placement:"top",theme:"info",children:(0,n.jsx)("span",{children:g.J3[E]})}):v;return(0,n.jsx)(o.X,{label:h,horizontal:!0,children:(0,n.jsx)(u,{annotationKey:v,value:x,valueLink:f})})},u=({annotationKey:v,value:x,valueLink:f})=>{const E=(0,r.of)(m),h=a.includes(v),y=x&&x.startsWith("http"),b=(0,n.jsx)(d.Y,{input:x,delimiter:["{{","}}"]});return f?(0,n.jsx)(i.Y,{href:f,external:!0,children:x}):h?(0,n.jsx)(c.L,{className:E.well,children:b}):y?(0,n.jsx)(i.Y,{href:x,external:!0,children:x}):(0,n.jsx)(n.Fragment,{children:b})},m=v=>({well:(0,s.css)({wordBreak:"break-word"})})},84396:(k,A,e)=>{"use strict";e.d(A,{X:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({className:g,label:o,horizontal:d,children:c,childrenWrapperClassName:a})=>{const p=(0,l.of)(i);return(0,n.jsxs)("div",{className:(0,s.cx)(p.field,d?p.fieldHorizontal:p.fieldVertical,g),children:[(0,n.jsx)("div",{children:o}),(0,n.jsx)("div",{className:a,children:c})]})},i=g=>({fieldHorizontal:(0,s.css)({flexDirection:"row",[g.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,s.css)({flexDirection:"column"}),field:(0,s.css)({display:"flex",margin:`${g.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:g.spacing(1),fontSize:g.typography.size.sm,fontWeight:g.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:g.colors.text.secondary}})})},75591:(k,A,e)=>{"use strict";e.d(A,{E:()=>a});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(29158),o=e(19384),d=e(98439),c=e(22620);const a=({cols:u,items:m,isExpandable:v=!1,onCollapse:x,onExpand:f,isExpanded:E,renderExpandedContent:h,testIdGenerator:y,pagination:b,paginationStyles:D,renderPrefixCell:P,renderPrefixHeader:C,footerRow:M,dataTestId:I})=>{const R=(0,i.of)(c.H);if((x||f||E)&&!(x&&f&&E))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((v||h)&&!(v&&h))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const T=(0,i.of)(p(u,v,!!C)),[S,L]=(0,l.useState)([]),O=B=>{E&&x&&f?E(B)?x(B):f(B):L(S.includes(B.id)?S.filter(K=>K!==B.id):[...S,B.id])},j=b?.itemsPerPage??m.length,{page:N,numberOfPages:F,onPageChange:U,pageItems:w}=(0,d.W)(m,1,j);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:T.container,"data-testid":I??"dynamic-table",children:[(0,n.jsxs)("div",{className:T.row,"data-testid":"header",children:[C&&C(),v&&(0,n.jsx)("div",{className:T.cell()}),u.map(B=>(0,n.jsx)("div",{className:T.cell(B.alignColumn),children:B.label},B.id))]}),w.map((B,K)=>{const W=E?E(B):S.includes(B.id);return(0,n.jsxs)("div",{className:T.row,"data-testid":y?.(B,K)??"row",children:[P&&P(B,K,m),v&&(0,n.jsx)("div",{className:(0,s.cx)(T.cell(),T.expandCell),children:(0,n.jsx)(g.K,{tooltip:`${W?"Collapse":"Expand"} row`,"data-testid":r.Tp.components.AlertRules.toggle,name:W?"angle-down":"angle-right",onClick:()=>O(B)})}),u.map(z=>(0,n.jsx)("div",{className:(0,s.cx)(T.cell(z.alignColumn),T.bodyCell,z.className),"data-column":z.label,children:z.renderCell(B,K)},`${B.id}-${z.id}`)),W&&h&&(0,n.jsx)("div",{className:T.expandedContentRow,"data-testid":r.Tp.components.AlertRules.expandedContent,children:h(B,K,m)})]},`${B.id}-${K}`)}),M&&(0,n.jsx)("div",{className:(0,s.cx)(T.row,T.footerRow),children:M})]}),b&&(0,n.jsx)(o.d,{className:(0,s.cx)(R,D),currentPage:N,numberOfPages:F,onNavigate:U,hideWhenSinglePage:!0})]})},p=(u,m,v)=>{const x=u.map(f=>f.size?typeof f.size=="number"?`${f.size}fr`:f.size:"auto");return m&&x.unshift("calc(1em + 16px)"),v&&x.unshift("0"),f=>({container:(0,s.css)({border:`1px solid ${f.colors.border.weak}`,borderRadius:f.shape.radius.default,color:f.colors.text.secondary}),row:(0,s.css)({display:"grid",gridTemplateColumns:x.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:f.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:f.colors.background.primary},[f.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${f.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:v?"none":void 0}}}),footerRow:(0,s.css)({display:"flex",padding:f.spacing(1)}),cell:E=>(0,s.css)({display:"flex",alignItems:"center",padding:f.spacing(1),justifyContent:E||"initial",[f.breakpoints.down("sm")]:{padding:`${f.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,s.css)({overflow:"hidden",[f.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:f.colors.text.primary}}}),expandCell:(0,s.css)({justifyContent:"center",[f.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,s.css)({gridColumnEnd:x.length+1,gridColumnStart:v?3:2,gridRow:2,padding:`0 ${f.spacing(3)} 0 ${f.spacing(1)}`,position:"relative",[f.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${f.colors.border.strong}`,gridRow:"auto",padding:`${f.spacing(1)} 0 0 0`}})})}},10562:(k,A,e)=>{"use strict";e.d(A,{B:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(75591);const i=({renderExpandedContent:o,...d})=>{const c=(0,l.of)(g);return(0,n.jsx)(r.E,{renderExpandedContent:o?(a,p,u)=>(0,n.jsxs)(n.Fragment,{children:[p!==u.length-1&&(0,n.jsx)("div",{className:(0,s.cx)(c.contentGuideline,c.guideline)}),o(a,p,u)]}):void 0,renderPrefixHeader:()=>(0,n.jsx)("div",{className:c.relative,children:(0,n.jsx)("div",{className:(0,s.cx)(c.headerGuideline,c.guideline)})}),renderPrefixCell:(a,p,u)=>(0,n.jsxs)("div",{className:c.relative,children:[(0,n.jsx)("div",{className:(0,s.cx)(c.topGuideline,c.guideline)}),p!==u.length-1&&(0,n.jsx)("div",{className:(0,s.cx)(c.bottomGuideline,c.guideline)})]}),...d})},g=o=>({relative:(0,s.css)({position:"relative",height:"100%"}),guideline:(0,s.css)({left:"-19px",borderLeft:`1px solid ${o.colors.border.weak}`,position:"absolute",[o.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,s.css)({width:"18px",borderBottom:`1px solid ${o.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,s.css)({top:"50%",bottom:0}),contentGuideline:(0,s.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,s.css)({top:"-17px",bottom:0})})},35108:(k,A,e)=>{"use strict";e.d(A,{j:()=>a});var n=e(74848),s=e(32196),l=e(46942),r=e.n(l),i=e(96540),g=e(40845),o=e(67061),d=e(95868),c=e(13840);const a=({children:u,header:m,content:v,footer:x,arrow:f,showAfter:E=300,wrapperClassName:h,disabled:y=!1,...b})=>{const D=(0,i.useRef)(null),P=(0,g.of)(p);if(y)return u;const C=(0,n.jsxs)(o.B,{direction:"column",gap:0,role:"tooltip",children:[m&&(0,n.jsx)("div",{className:P.card.header,children:m}),(0,n.jsx)("div",{className:P.card.body,children:v}),x&&(0,n.jsx)("div",{className:P.card.footer,children:x})]});return(0,n.jsx)(d.I,{content:C,hideAfter:100,children:(M,I,R)=>(0,n.jsxs)(n.Fragment,{children:[D.current&&(0,n.jsx)(c.A,{...R,...b,wrapperClassName:r()(P.popover,h),onMouseLeave:I,onMouseEnter:M,onFocus:M,onBlur:I,referenceElement:D.current,renderArrow:f}),(0,i.cloneElement)(u,{ref:D,onMouseEnter:M,onMouseLeave:I,onFocus:M,onBlur:I,tabIndex:0})]})})},p=u=>({popover:(0,s.css)({borderRadius:u.shape.radius.default,boxShadow:u.shadows.z3,background:u.colors.background.primary,border:`1px solid ${u.colors.border.medium}`}),card:{body:(0,s.css)({padding:u.spacing(1)}),header:(0,s.css)({padding:u.spacing(1),background:u.colors.background.secondary,borderBottom:`solid 1px ${u.colors.border.medium}`}),footer:(0,s.css)({padding:u.spacing(.5,1),background:u.colors.background.secondary,borderTop:`solid 1px ${u.colors.border.medium}`})}})},93810:(k,A,e)=>{"use strict";e.d(A,{A:()=>r});var n=e(74848),s=e(42418);const r=()=>(0,n.jsx)(s.F,{severity:"info",title:"Alert evaluation currently paused",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})},8406:(k,A,e)=>{"use strict";e.d(A,{J:()=>d});var n=e(74848),s=e(32196),l=e(96540),r=e(84140),i=e(40845),g=e(67061),o=e(14578);const d=({label:a,value:p,icon:u,color:m,size:v="md",onClick:x})=>{const f=(0,i.of)(c,m,v),E=`${a}: ${p}`,h=a?.toString()??"",y=p?.toString()??"",b=(0,l.useMemo)(()=>(0,n.jsxs)(g.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,n.jsx)("div",{className:f.label,children:(0,n.jsxs)(g.B,{direction:"row",gap:.5,alignItems:"center",children:[u&&(0,n.jsx)(o.I,{name:u}),a&&(0,n.jsx)("span",{className:f.labelText,title:a.toString(),children:a??""})]})}),(0,n.jsx)("div",{className:f.value,title:p?.toString(),children:p??"-"})]}),[u,a,p,f]);return(0,n.jsx)("div",{className:f.wrapper,role:"listitem","aria-label":E,"data-testid":"label-value",children:x?(0,n.jsx)("div",{className:f.clickable,role:"button",tabIndex:0,onClick:()=>x(h,y),onKeyDown:D=>{D.key==="Enter"&&(x(h,y),D.preventDefault())},children:b},h+y):b})},c=(a,p,u)=>{const m=p??a.colors.secondary.main,v=a.isDark?(0,r.A)(m).lighten(5).toString():(0,r.A)(m).darken(5).toString(),x=a.isDark?(0,r.A)(m).darken(5).toString():(0,r.A)(m).lighten(5).toString(),f=p?r.A.mostReadable(m,["#000","#fff"]).toString():a.colors.text.primary;let E=a.spacing(.33,1);switch(u){case"sm":E=a.spacing(.2,.6);break;case"xs":E=a.spacing(0,.5);break;default:break}return{wrapper:(0,s.css)({color:f,fontSize:a.typography.bodySmall.fontSize,borderRadius:a.shape.borderRadius(2)}),labelText:(0,s.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,s.css)({display:"flex",alignItems:"center",color:"inherit",padding:E,background:m,border:`solid 1px ${v}`,borderTopLeftRadius:a.shape.borderRadius(2),borderBottomLeftRadius:a.shape.borderRadius(2)}),clickable:(0,s.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,s.css)({color:"inherit",padding:E,background:x,border:`solid 1px ${v}`,borderLeft:"none",borderTopRightRadius:a.shape.borderRadius(2),borderBottomRightRadius:a.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(k,A,e)=>{"use strict";e.d(A,{P:()=>o});var n=e(74848),s=e(32196),l=e(40845),r=e(94753),i=e(67061),g=e(14578);const o=({children:c,icon:a,color:p="secondary",direction:u="row",...m})=>{const v=(0,l.of)(d),x=typeof m.onClick=="function",f=u==="row",E=f?"center":"flex-start",h=f?.5:0;return(0,n.jsx)("div",{className:(0,s.cx)({[v.interactive]:x}),...m,children:(0,n.jsx)(r.E,{variant:"bodySmall",color:p,children:(0,n.jsxs)(i.B,{direction:u,alignItems:E,gap:h,wrap:"wrap",children:[a&&(0,n.jsx)(g.I,{size:"xs",name:a}),c]})})})},d=()=>({interactive:(0,s.css)({cursor:"pointer"})})},90141:(k,A,e)=>{"use strict";e.d(A,{A:()=>o});var n=e(74848),s=e(96540),l=e(55852),r=e(67061),i=e(14578);const o=(0,s.forwardRef)(function(c,a){return(0,n.jsx)(l.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:a,...c,children:(0,n.jsxs)(r.B,{direction:"row",alignItems:"center",gap:0,children:["More ",(0,n.jsx)(i.I,{name:"angle-down"})]})})})},76156:(k,A,e)=>{"use strict";e.d(A,{h:()=>r});var n=e(74848),s=e(12210);const l=({children:i,plugin:g,loadingComponent:o,notInstalledFallback:d})=>{const{loading:c,installed:a}=usePluginBridge(g);return c?o??null:a?jsx(Fragment,{children:i}):d??null};function r(i,g,o){const d=new URLSearchParams(o).toString();return`/a/${i}${g}`+(d?"?"+d:"")}},48205:(k,A,e)=>{"use strict";e.d(A,{Yi:()=>o,hk:()=>g,rS:()=>d});var n=e(74848),s=e(42418),l=e(39938),r=e(56034),i=e(8484),g=(c=>(c.ContactPoint="contact point",c.Template="template",c.MuteTiming="mute timing",c.AlertRule="alert rule",c.RootNotificationPolicy="root notification policy",c))(g||{});const o=({resource:c,...a})=>(0,n.jsxs)(s.F,{title:`This ${c} cannot be edited through the UI`,severity:"info",...a,children:["This ",c," has been provisioned, that means it was created by config. Please contact your server admin to update this ",c,"."]}),d=({tooltip:c,provenance:a})=>{const p=(0,n.jsx)(l.E,{text:"Provisioned",color:"purple"});if(c){const u=(0,n.jsxs)(i.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:a},children:["This resource has been provisioned via ",{provenance:a}," and cannot be edited through the UI"]}),m=(0,n.jsx)(i.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),v=a?u:m;return(0,n.jsx)(r.m,{content:v,children:(0,n.jsx)("span",{children:p})})}return p}},82437:(k,A,e)=>{"use strict";e.d(A,{c:()=>r});var n=e(74848),s=e(94753),l=e(14578);const r=({namespace:i,group:g})=>g?(0,n.jsxs)(s.E,{element:"h3",variant:"body",children:[i," ",(0,n.jsx)(l.I,{name:"angle-right","aria-label":">"})," ",g]}):(0,n.jsx)(s.E,{element:"h3",variant:"body",children:i})},26058:(k,A,e)=>{"use strict";e.d(A,{h:()=>l});var n=e(74848),s=e(32196);const l=()=>(0,n.jsx)("span",{className:(0,s.css)({flex:1})})},65415:(k,A,e)=>{"use strict";e.d(A,{O:()=>i});var n=e(74848),s=e(32196),l=e(96540),r=e(40845);const i=(0,l.forwardRef)(({children:o,state:d,size:c="md",muted:a=!1},p)=>{const u=(0,r.of)(g);return(0,n.jsx)("span",{className:(0,s.cx)(u.common,u[d],u[c],{[u.muted]:a}),ref:p,children:o||d})});i.displayName="StateTag";const g=o=>({common:(0,s.css)({display:"inline-block",color:"white",borderRadius:o.shape.radius.default,fontSize:o.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:o.typography.fontWeightBold}),good:(0,s.css)({backgroundColor:o.colors.success.main,border:`solid 1px ${o.colors.success.main}`,color:o.colors.success.contrastText}),warning:(0,s.css)({backgroundColor:o.colors.warning.main,border:`solid 1px ${o.colors.warning.main}`,color:o.colors.warning.contrastText}),bad:(0,s.css)({backgroundColor:o.colors.error.main,border:`solid 1px ${o.colors.error.main}`,color:o.colors.error.contrastText}),neutral:(0,s.css)({backgroundColor:o.colors.secondary.main,border:`solid 1px ${o.colors.secondary.main}`,color:o.colors.secondary.contrastText}),info:(0,s.css)({backgroundColor:o.colors.primary.main,border:`solid 1px ${o.colors.primary.main}`,color:o.colors.primary.contrastText}),md:(0,s.css)({padding:o.spacing(.5,1),minWidth:o.spacing(8)}),sm:(0,s.css)({padding:o.spacing(.3,.5),minWidth:"52px"}),muted:(0,s.css)({opacity:"0.5"})})},16577:(k,A,e)=>{"use strict";e.d(A,{Y:()=>d});var n=e(74848),s=e(32196),l=e(40845),r=e(39938),i=e(35108),g=e(83225);const o=["$",".",'"'];function d({input:f,delimiter:E=["{{","}}"]}){const h=(0,l.of)(x),[y,b]=E,D=new RegExp(`(?<before>.*?)(${y}(?<token>.*?)${b}|$)`,"gm"),P=f.split(`
`),C=[];return P.forEach((M,I)=>{Array.from(M.matchAll(D)).forEach((T,S)=>{const L=T.groups?.before,O=T.groups?.token?.trim();if(L&&C.push((0,n.jsx)("span",{children:L},`${I}-${S}-before`)),O){const j=v(O),N=j==="variable"?O:"",F=`${y} ${O} ${b}`;C.push((0,n.jsx)(a,{content:F,type:j,description:N},`${I}-${S}-token`))}}),C.push((0,n.jsx)("br",{},`${I}-newline`))}),(0,n.jsx)("span",{className:h.wrapper,children:C})}var c=(f=>(f.Variable="variable",f.Function="function",f.Keyword="keyword",f.Unknown="unknown",f))(c||{});function a({content:f,description:E,type:h}){const y=(0,l.of)(x),b=!h;return(0,n.jsx)(i.j,{placement:"top-start",disabled:b,content:(0,n.jsxs)("div",{className:y.hoverTokenItem,children:[(0,n.jsx)(r.E,{tabIndex:0,text:(0,n.jsx)(n.Fragment,{children:h}),color:"blue"})," ",E&&(0,n.jsx)("code",{children:E})]}),children:(0,n.jsx)("span",{children:(0,n.jsx)(r.E,{tabIndex:0,className:y.token,text:f,color:"blue"})})})}function p(f){return o.some(E=>f.startsWith(E))}function u(f){return g.keywords.some(E=>f.startsWith(E))}function m(f){return g.builtinFunctions.some(E=>f.startsWith(E))}function v(f){let E;return p(f)?E="variable":u(f)?E="keyword":m(f)?E="function":E="unknown",E}const x=f=>({wrapper:(0,s.css)({whiteSpace:"pre-wrap"}),token:(0,s.css)({cursor:"default",fontFamily:f.typography.fontFamilyMonospace}),popover:(0,s.css)({borderRadius:f.shape.radius.default,boxShadow:f.shadows.z3,background:f.colors.background.primary,border:`1px solid ${f.colors.border.medium}`,padding:f.spacing(1)}),hoverTokenItem:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:f.spacing(1)})})},73750:(k,A,e)=>{"use strict";e.d(A,{L:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g,className:o})=>{const d=(0,l.of)(i);return(0,n.jsx)("div",{className:(0,s.cx)(d.wrapper,o),children:g})},i=g=>({wrapper:(0,s.css)({backgroundColor:g.components.panel.background,border:`solid 1px ${g.components.input.borderColor}`,borderRadius:g.shape.radius.default,padding:g.spacing(.5,1),fontFamily:g.typography.fontFamilyMonospace})})},96636:(k,A,e)=>{"use strict";e.d(A,{d:()=>l});var n=e(96540),s=e(14778);const l=({component:r,title:i="previous page"})=>{const g=(0,s.i)(),o=(0,n.useCallback)(()=>{g(i)},[g,i]);return(0,n.cloneElement)(r,{onClick:o})}},53876:(k,A,e)=>{"use strict";e.d(A,{X:()=>v});var n=e(74848),s=e(32196),l=e(96540),r=e(40996),i=e(40845),g=e(14578),o=e(88575),d=e(60029),c=e(67061),a=e(56034),p=e(10354),u=e(25027),m=e(32642);const v=({onFilterChange:f,defaultQueryString:E})=>{const h=(0,i.of)(x),[y,b]=(0,l.useState)(E??"");(0,r.A)(()=>{(0,u.fH)(u.le.filterByLabel),f(y)},600,[y]);const D=(0,n.jsx)(g.I,{name:"search"});let P=!!(E&&E.length>=3);try{E?(0,m.S6)(E):P=!0}catch{P=!1}return(0,n.jsx)(o.D,{className:h.fixMargin,invalid:!P,error:P?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,n.jsx)(d.J,{children:(0,n.jsxs)(c.B,{gap:.5,alignItems:"center",children:[(0,n.jsx)("span",{children:"Search by label"}),(0,n.jsx)(a.m,{content:(0,n.jsxs)("div",{children:["Filter alerts using label querying without spaces, ex:",(0,n.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),"Invalid use of spaces:",(0,n.jsx)("pre",{children:'{severity= "critical"}'}),(0,n.jsx)("pre",{children:'{severity ="critical"}'}),"Valid use of spaces:",(0,n.jsx)("pre",{children:'{severity=" critical"}'}),"Filter alerts using label querying without braces, ex:",(0,n.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,n.jsx)(g.I,{name:"info-circle",size:"sm"})})]})}),children:(0,n.jsx)(p.p,{placeholder:"Search",value:y,onChange:C=>b(C.currentTarget.value),"data-testid":"search-query-input",prefix:D,className:h.inputWidth})})},x=f=>({fixMargin:(0,s.css)({marginBottom:0}),inputWidth:(0,s.css)({width:340,flexGrow:0})})},56528:(k,A,e)=>{"use strict";e.d(A,{GX:()=>N,r4:()=>O});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(49785),o=e(39070),d=e(19845),c=e(72724),a=e(40845),p=e(42418),u=e(67061),m=e(55852),v=e(51440),x=e(29158),f=e(98808),E=e(71680),h=e(1712),y=e(34263),b=e(18225),D=e(76658),P=e(66718),C=e(94822),M=e(98439),I=e(35108),R=e(26058),T=e(30423),S=e(81875),L=e(99106);const O=({queries:z=[],query:Y,data:X,error:q,warning:G,isAlertCondition:te,onSetCondition:H,onUpdateRefId:se,onRemoveExpression:ne,onUpdateExpressionType:le,onChangeQuery:_})=>{const Q=(0,a.of)(W),ae=Y?.type,{setError:oe,clearErrors:J}=(0,g.xW)(),ee=(0,i.useCallback)(we=>{we?oe("queries",{type:"custom",message:we}):J("queries")},[oe,J]),de=X&&Object.values(X).some(we=>!!we&&we.state===o.Gu.Loading),xe=Array.isArray(X?.series)&&!de,re=X?.series??[],ue=te??!1,{seriesCount:Te,groupedByState:ge}=U(re),Oe=(0,i.useCallback)(we=>{const qe=z.filter(We=>we.refId!==We.refId).map(We=>({value:We.refId,label:We.refId}));switch(we.type){case P.Tz.math:return(0,n.jsx)(E.z,{onChange:_,query:we,labelWidth:"auto",onRunQuery:()=>{}});case P.Tz.reduce:return(0,n.jsx)(h.Z,{onChange:_,refIds:qe,labelWidth:"auto",query:we});case P.Tz.resample:return(0,n.jsx)(y.C,{onChange:_,query:we,labelWidth:"auto",refIds:qe});case P.Tz.classic:return(0,n.jsx)(f.z,{onChange:_,query:we,refIds:qe});case P.Tz.threshold:return(0,n.jsx)(D.O,{onChange:_,query:we,labelWidth:"auto",refIds:qe,onError:ee,useHysteresis:!0});case P.Tz.sql:return(0,n.jsx)(b.k,{onChange:_,query:we,refIds:qe});default:return(0,n.jsxs)(n.Fragment,{children:["Expression not supported: ",we.type]})}},[_,z,ee]),Xe=P.uQ.find(we=>we.value===ae)?.description??"";return(0,n.jsx)("div",{className:(0,s.cx)(Q.expression.wrapper,ue&&Q.expression.alertCondition,ae===P.Tz.classic&&Q.expression.classic,ae!==P.Tz.classic&&Q.expression.nonClassic),children:(0,n.jsxs)("div",{className:Q.expression.stack,children:[(0,n.jsx)(w,{refId:Y.refId,queryType:ae,onRemoveExpression:()=>ne(Y.refId),onUpdateRefId:we=>se(Y.refId,we),onSetCondition:H,query:Y,alertCondition:ue}),(0,n.jsxs)("div",{className:Q.expression.body,children:[q&&(0,n.jsx)(p.F,{title:"Expression failed",severity:"error",children:q.message}),G&&(0,n.jsx)(p.F,{title:"Expression warning",severity:"warning",children:G.message}),(0,n.jsx)("div",{className:Q.expression.description,children:Xe}),Oe(Y)]}),xe&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N,{series:re,isAlertCondition:te}),(0,n.jsx)("div",{className:Q.footer,children:(0,n.jsxs)(u.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)(R.h,{}),(0,n.jsx)(F,{isCondition:!!te,firing:ge[C.cF.Firing].length,normal:ge[C.cF.Inactive].length,seriesCount:Te})]})})]})]})})},j=20,N=({series:z,isAlertCondition:Y})=>{const{pageItems:X,previousPage:q,nextPage:G,numberOfPages:te,pageStart:H,pageEnd:se}=(0,M.W)(z,1,j),ne=(0,a.of)(W),le=(0,L.PI)(z),_=!le&&(0,d.jq)(z),Q=te>1;return(0,n.jsxs)("div",{className:ne.expression.results,children:[!le&&_&&(0,n.jsx)("div",{children:X.map((ae,oe)=>(0,n.jsx)(K,{frame:ae,index:H+oe,isAlertCondition:Y},(0,l.uniqueId)()))}),!le&&!_&&X.map((ae,oe)=>(0,n.jsx)(B,{frame:ae,index:H+oe,isAlertCondition:Y},(0,l.uniqueId)())),le&&(0,n.jsx)("div",{className:(0,s.cx)(ne.expression.noData,ne.mutedText),children:"No data"}),Q&&(0,n.jsx)("div",{className:ne.pagination.wrapper,"data-testid":"paginate-expression",children:(0,n.jsxs)(u.B,{children:[(0,n.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:q,icon:"angle-left",size:"sm","aria-label":"previous-page"}),(0,n.jsx)(R.h,{}),(0,n.jsxs)("span",{className:ne.mutedText,children:[H," - ",se," of ",z.length]}),(0,n.jsx)(R.h,{}),(0,n.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:G,icon:"angle-right",size:"sm","aria-label":"next-page"})]})})]})},F=({firing:z,normal:Y,isCondition:X,seriesCount:q})=>{const{mutedText:G}=(0,a.of)(W);return q===0?(0,n.jsx)("span",{className:G,children:"No series"}):X?(0,n.jsx)("span",{className:G,children:`${q} series: ${z} firing, ${Y} normal`}):(0,n.jsx)("span",{className:G,children:`${q} series`})};function U(z){const Y=z.filter(G=>(0,L.Lm)(G)===void 0).length,X={[C.cF.Firing]:z.filter(G=>(0,L.Lm)(G)!==void 0&&(0,L.Lm)(G)!==0),[C.cF.Inactive]:z.filter(G=>(0,L.Lm)(G)===0)},q=z.length-Y;return{groupedByState:X,seriesCount:q}}const w=({refId:z,queryType:Y,onUpdateRefId:X,onRemoveExpression:q,onSetCondition:G,alertCondition:te,query:H})=>{const se=(0,a.of)(W),ne=(0,a.of)(m.my),[le,_]=(0,i.useState)(!1),ae=le!==!1&&le==="refId";return(0,n.jsx)("header",{className:se.header.wrapper,children:(0,n.jsxs)(u.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,n.jsxs)(u.B,{direction:"row",gap:1,alignItems:"center",children:[!ae&&(0,n.jsx)("button",{type:"button",className:(0,s.cx)(ne,se.editable),onClick:()=>_("refId"),children:(0,n.jsx)("div",{className:se.expression.refId,children:z})}),ae&&(0,n.jsx)(v.D,{autoFocus:!0,defaultValue:z,minWidth:5,onChange:oe=>{X(oe.currentTarget.value),_(!1)},onFocus:oe=>oe.target.select(),onBlur:oe=>{X(oe.currentTarget.value),_(!1)}}),(0,n.jsx)("div",{children:(0,P.NI)(Y)})]}),(0,n.jsx)(R.h,{}),(0,n.jsx)(S.a,{onSetCondition:()=>G(H.refId),isCondition:te}),(0,n.jsx)(x.K,{name:"trash-alt",variant:"secondary",className:se.mutedIcon,onClick:q,tooltip:"Remove expression"})]})})},B=({frame:z,index:Y,isAlertCondition:X})=>{const q=(0,a.of)(W),G=(0,L.Jw)(z)||"Series "+Y,te=(0,L.Lm)(z),H=(0,L.JQ)(z),se=Object.entries(H),ne=se.length>0,le=X&&te!==0,_=X&&te===0,Q=`${ne?"":G}${ne?`{${(0,L.h6)(H)}}`:""}`;return(0,n.jsx)("div",{className:q.expression.resultsRow,children:(0,n.jsxs)(u.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsxs)("div",{className:q.expression.resultLabel,title:Q,children:[(0,n.jsx)("span",{children:ne?"":G}),ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"{"}),se.map(([ae,oe],J)=>(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:q.expression.labelKey,children:ae}),(0,n.jsx)("span",{children:"="}),(0,n.jsx)("span",{children:'"'}),(0,n.jsx)("span",{className:q.expression.labelValue,children:oe}),(0,n.jsx)("span",{children:'"'}),J<se.length-1&&(0,n.jsx)("span",{children:", "})]},(0,l.uniqueId)())),(0,n.jsx)("span",{children:"}"})]})]}),(0,n.jsx)("div",{className:q.expression.resultValue,children:te}),le&&(0,n.jsx)(T.C,{state:C.cF.Firing,size:"sm"}),_&&(0,n.jsx)(T.C,{state:C.cF.Inactive,size:"sm"})]})})},K=({frame:z,index:Y})=>{const X=(0,a.of)(W),q=z.fields[1],G=q.labels,H=q.config?.displayNameFromDS??(G?(0,L.h6)(q.labels??{}):"Series "+Y),se=z.fields[0].values,ne=_=>z.fields[0].values[_],le=_=>z.fields[1].values[_];return(0,n.jsx)("div",{className:X.expression.resultsRow,children:(0,n.jsxs)(u.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)("span",{className:(0,s.cx)(X.mutedText,X.expression.resultLabel),title:H,children:H}),(0,n.jsx)("div",{className:X.expression.resultValue,children:(0,n.jsx)(I.j,{placement:"right",wrapperClassName:X.timeseriesTableWrapper,content:(0,n.jsxs)("table",{className:X.timeseriesTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Timestamp"}),(0,n.jsx)("th",{children:"Value"})]})}),(0,n.jsx)("tbody",{children:se.map((_,Q)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:X.mutedText,children:(0,c.LE)(ne(Q))}),(0,n.jsx)("td",{className:X.expression.resultValue,children:le(Q)})]},Q))})]}),children:(0,n.jsx)("span",{children:"Time series data"})})})]})})},W=z=>({expression:{wrapper:(0,s.css)({display:"flex",border:`solid 1px ${z.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:z.shape.radius.default}),stack:(0,s.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,s.css)({maxWidth:"100%"}),nonClassic:(0,s.css)({maxWidth:"640px"}),alertCondition:(0,s.css)({}),body:(0,s.css)({padding:z.spacing(1),flex:1}),description:(0,s.css)({marginBottom:z.spacing(1),fontSize:z.typography.size.xs,color:z.colors.text.secondary}),refId:(0,s.css)({fontWeight:z.typography.fontWeightBold,color:z.colors.primary.text}),results:(0,s.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${z.colors.border.medium}`}),noResults:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,s.css)({padding:`${z.spacing(.75)} ${z.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:z.colors.background.secondary},"&:hover":{backgroundColor:z.colors.background.canvas}}),labelKey:(0,s.css)({color:z.isDark?"#73bf69":"#56a64b"}),labelValue:(0,s.css)({color:z.isDark?"#ce9178":"#a31515"}),resultValue:(0,s.css)({textAlign:"right"}),resultLabel:(0,s.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:z.spacing()})},mutedText:(0,s.css)({color:z.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,s.css)({background:z.colors.background.secondary,padding:`${z.spacing(.5)} ${z.spacing(1)}`,borderBottom:`solid 1px ${z.colors.border.weak}`})},footer:(0,s.css)({background:z.colors.background.secondary,padding:z.spacing(1),borderTop:`solid 1px ${z.colors.border.weak}`}),draggableIcon:(0,s.css)({cursor:"grab"}),mutedIcon:(0,s.css)({color:z.colors.text.secondary}),editable:(0,s.css)({padding:`${z.spacing(.5)} ${z.spacing(1)}`,border:`solid 1px ${z.colors.border.weak}`,borderRadius:z.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:z.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,s.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,s.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:z.spacing(1)},td:{background:z.colors.background.primary},th:{background:z.colors.background.secondary},tr:{borderBottom:`1px solid ${z.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,s.css)({borderTop:`1px solid ${z.colors.border.medium}`,padding:z.spacing()})}})},81875:(k,A,e)=>{"use strict";e.d(A,{a:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(39938),i=e(55852);const g=({isCondition:d,onSetCondition:c})=>{const a=(0,l.of)(o);return d?(0,n.jsx)(r.E,{color:"green",icon:"check",text:"Alert condition"},"condition"):(0,n.jsx)("button",{type:"button",className:a.actionLink,onClick:()=>c&&c(),children:"Set as alert condition"},"make-condition")},o=d=>{const c=(0,i.my)(d);return{actionLink:(0,s.css)(c,{color:d.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(k,A,e)=>{"use strict";e.d(A,{EL:()=>c,JQ:()=>o,Jw:()=>i,Lm:()=>g,PI:()=>p,h6:()=>d,wf:()=>a});var n=e(2543),s=e.n(n),l=e(97706),r=e(57220);const i=u=>{const m=u.fields[0];return m?.config?.displayNameFromDS??u.name??m?.labels?.__name__},g=u=>{const m=u.fields[0]?.values[0];return Number.isFinite(m)?(0,l.h)(m,5):m},o=u=>u.fields[0]?.labels??{},d=u=>Object.entries(u).map(([m,v])=>m+"="+v).join(", "),c=u=>{const m=u.name;if((0,r.Eb)(u.rulesSource))return{name:m,parents:[]};try{const v=JSON.parse(m);if(!Array.isArray(v))throw new Error("not a nested Grafana folder");const x=(0,n.last)(v)??m,f=(0,n.dropRight)(v,1);return{name:x,parents:f}}catch{return{name:u.name,parents:[]}}},a=(u,m=[])=>JSON.stringify(m.concat(u)),p=u=>u.every(v=>v.fields.every(x=>x.values.every(f=>f==null)))},83225:(k,A,e)=>{"use strict";e.r(A),e.d(A,{AlertmanagerTemplateFunction:()=>s,availableAlertManagerFunctions:()=>l,builtinFunctions:()=>i,conf:()=>d,keywords:()=>g,language:()=>o});var n=(c=>(c.Delimiter="delimiter",c.Keyword="keyword",c.Function="type.identifier",c.String="string",c.Variable="variable.name",c.Number="number",c.Comment="comment",c.Operator="operator",c.Identifier="idenfifier",c))(n||{}),s=(c=>(c.toUpper="toUpper",c.toLower="toLower",c.title="title",c.join="join",c.match="match",c.safeHtml="safeHtml",c.reReplaceAll="reReplaceAll",c.stringSlice="stringSlice",c))(s||{});const l=Object.values(s),i=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],g=["define","if","else","end","range","break","continue","template","block","with"],o={defaultToken:"",keywords:g,functions:[...i,...l],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},d={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(k,A,e)=>{"use strict";e.d(A,{FI:()=>n,J4:()=>s,p8:()=>r});const n="grafana_alerting";var s=(i=>(i.OnCall="oncall",i))(s||{});const l=(i,g)=>g.includes(i),r=(i,g)=>{if(!i.grafana_managed_receiver_configs)return!1;const o=i.grafana_managed_receiver_configs.length===1,d=l(i.grafana_managed_receiver_configs[0]?.settings?.url??"",g.map(c=>c.integration_url));return o&&d}},74685:(k,A,e)=>{"use strict";e.d(A,{j:()=>a});var n=e(74848),s=e(32196),l=e(70713),r=e(19845),i=e(40845),g=e(28138),o=e(72519),d=e(56528),c=e(7921);const a=({data:u,thresholds:m,thresholdsType:v})=>{const x=(0,i.of)(p),f=(0,r.jq)(u.series),E=(0,c.yW)(u),h=v?{mode:v}:void 0;return(0,n.jsx)("div",{className:x.wrapper,children:(0,n.jsx)(l.Ay,{disableHeight:!0,children:({width:y})=>(0,n.jsx)("div",{style:{width:y},children:f?(0,n.jsx)(o.y,{statusMessage:E,data:u.series,eventBus:g.A,height:300,width:y,timeRange:u.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:u.state,thresholdsConfig:m,thresholdsStyle:h}):(0,n.jsxs)("div",{className:x.instantVectorResultWrapper,children:[(0,n.jsx)("header",{className:x.title,children:"Table"}),(0,n.jsx)(d.GX,{series:u.series})]})})})})},p=u=>({wrapper:(0,s.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,s.css)({border:`solid 1px ${u.colors.border.medium}`,borderRadius:u.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,s.css)({label:"panel-title",padding:u.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:u.typography.h6.fontSize,fontWeight:u.typography.h6.fontWeight})})},7921:(k,A,e)=>{"use strict";e.d(A,{G0:()=>C,zy:()=>M,lb:()=>I,YG:()=>j,yW:()=>L,an:()=>T,I3:()=>b,xb:()=>P,_u:()=>O,yr:()=>R});var n=e(2543),s=e(19845),l=e(50082),r=e(39070),i=e(52622),g=e(2913),o=e(55907),d=e(69437),c=e(66718),a=e(86590),p=e(41811),u=e(34525);const m=(0,p.A)(v,(N,F)=>y(N[0])===y(F[0]));function v(N){const F=new u.TS,U=N.map(w=>w.refId);return F.createNodes(U),N.forEach(w=>{const B=w.refId;((0,d.f)(w.model)&&w.model.type==="math"?x(w.model.expression??""):[w.model.expression]).forEach(z=>{B&&z&&!(B===z)&&F.link(z,B)})}),F}function x(N){const F=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),U=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),w=Array.from(N.matchAll(F)).map(K=>K.groups?.var),B=Array.from(N.matchAll(U)).map(K=>K.groups?.var);return(0,n.compact)((0,n.uniq)([...w,...B]))}const f=(0,n.memoize)(E,(N,F)=>N+h(F));function E(N,F){const U=F.getNode(N),w=[];function B(K){const W=K.inputEdges;W.length>0?W.forEach(z=>{z.inputNode&&B(z.inputNode)}):w?.push(K)}return B(U),w.map(K=>K.name)}function h(N){return Object.keys(N.nodes).map(F=>{const U=N.nodes[F],w=U.outputEdges.map(K=>K.outputNode?.name).join(", "),B=U.inputEdges.map(K=>K.inputNode?.name).join(", ");return`${U.name}:${w}:${B}`}).join(" ")}function y(N){return N.map(F=>{const U=(0,d.f)(F.model)?F.model.type:F.queryType;return F.refId+(F.model.expression??"")+U}).join()}function b(N,F,U){return N.map(w=>{if(F===U||!(0,d.f)(w.model))return w;const B=w.model.type==="math",K=w.model.type==="reduce",W=w.model.type==="resample",z=w.model.type==="classic_conditions",Y=w.model.type==="threshold";if(B)return{...w,model:{...w.model,expression:D(w.model.expression??"",F,U)}};if(W||K||Y){const X=w.model.expression===F;return{...w,model:{...w.model,expression:X?U:w.model.expression}}}if(z){const X=w.model.conditions?.map(q=>({...q,query:{...q.query,params:q.query.params.map(G=>G===F?U:G)}}));return{...w,model:{...w.model,conditions:X}}}return w})}function D(N,F,U){const w=new RegExp("(\\$"+F+"\\b)|(\\${"+F+"})","gm"),B="${"+U+"}";return N.replace(w,B)}function P(N,F){return N.find(U=>U.refId===F)!==void 0}function C(N){return N.includes("/")||N.includes("\\")?'Cannot contain "/" or "\\" characters':!0}function M(N){if(N.series.length===0)return;const F=(0,s.jq)(N.series);let U;return F&&(U=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),U}function I(N){if(N.errors?.length)return new Error(N.errors[0].message)}function R(N){const U=(N[0]?.meta?.notices??[]).find(w=>w.severity==="warning")?.text;return U?new Error(U):void 0}function T(N,F){const U={},w=[c.Tz.threshold,c.Tz.classic];if(!F)return U;for(const W of N){if(!(0,d.f)(W.model)||!w.includes(W.model.type)||!Array.isArray(W.model.conditions)||W.model.refId!==F)continue;const z=W.model.conditions.some(S);W.model.conditions.forEach(Y=>{const X=Y.evaluator.params,q=Y.query?.params[0]??W.model.expression;if(!q)return;const G=S(Y);try{const te=m(N),H=f(q,te);N.filter(ne=>H.includes(ne.refId)).forEach(ne=>{const le=ne.refId,Q=!!(!(0,d.f)(ne?.model)&&le);le&&!U[le]&&(U[le]={config:{mode:l.O.Absolute,steps:[]},mode:i.Ly.Line}),le&&Q&&!G&&!z?B(le,X[0]):le&&Q&&G&&(K(le,X,Y.evaluator.type),U[le].mode=i.Ly.LineAndArea)})}catch(te){console.error("Failed to parse thresholds",te);return}})}function B(W,z){U[W].config.steps.push({value:-1/0,color:"transparent"},{value:z,color:g.config.theme2.colors.error.main})}function K(W,z,Y){Y===o.p.IsWithinRange&&U[W].config.steps.push({value:-1/0,color:"transparent"},{value:z[0],color:g.config.theme2.colors.error.main},{value:z[1],color:g.config.theme2.colors.error.main},{value:z[1],color:"transparent"}),Y===o.p.IsOutsideRange&&U[W].config.steps.push({value:-1/0,color:g.config.theme2.colors.error.main},{value:z[0],color:g.config.theme2.colors.error.main},{value:z[0],color:"transparent"},{value:z[1],color:g.config.theme2.colors.error.main}),U[W].config.steps.sort((X,q)=>X.value-q.value),U[W].config.steps=U[W].config.steps.filter(X=>X.value!==void 0)}return U}function S(N){return N.evaluator.type===o.p.IsWithinRange||N.evaluator.type===o.p.IsOutsideRange}function L(N){const F="Failed to fetch data";if(N.state!==r.Gu.Error)return;const U=N.errors;return U?.length?U.map(w=>w.message??F).join(", "):N.error?.message??F}function O(N=""){return N==="recording"?a.Z.cloudRecording:N==="grafana-recording"?a.Z.grafanaRecording:a.Z.grafana}function j(N,F){const U=F.filter(W=>!(0,d.f)(W.model)).map(W=>W.refId),w=N.filter(W=>!(0,d.f)(W.model)).map(W=>W.refId),[B,K]=(0,n.xor)(w,U);return[B,K]}},13064:(k,A,e)=>{"use strict";e.d(A,{C:()=>o});var n=e(87836),s=e(72880),l=e(70416),r=e(47232),i=e(72724),g=e(25968);function o(c,a){if(!c||!a||!(0,l.vd)(c))return;let p;try{p=(0,g.M9)(a)}catch{return}if((0,g.mo)(c))return;const u=Date.parse(c||""),m=(0,n.A)(u,p);return(0,s.Y)(m,new Date)?{humanized:`within ${a}`,fullDate:`within ${a}`}:{humanized:`in ${(0,r.KQ)(m).locale("en").fromNow(!0)}`,fullDate:(0,i.LE)(m,{format:"YYYY-MM-DD HH:mm:ss"})}}function d(c){if(!c)return null;if(!isNullDate(c))return formatDistanceToNowStrict(new Date(c))}},5179:(k,A,e)=>{"use strict";e.d(A,{K:()=>r,k:()=>i});var n=e(74848),s=e(96540);const l=s.createContext(void 0),r=({children:g,rule:o,identifier:d})=>{const c={rule:o,identifier:d};return(0,n.jsx)(l.Provider,{value:c,children:g})},i=()=>{const g=s.useContext(l);if(g===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return g}},39890:(k,A,e)=>{"use strict";e.d(A,{gQ:()=>At,Ay:()=>It,lf:()=>Xn,P5:()=>Tn});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(67061),g=e(42418),o=e(40980),d=e(72109),c=e(94753),a=e(40845),p=e(55852),u=e(83277),m=e(93810),v=e(35896),x=e(54317),f=e(94822),E=e(79741),h=e(85244),y=e(55740),b=e(56361),D=e(23662),P=e(3704),C=e(69087),M=e(37959),I=e(48205),R=e(96636),T=e(99106),S=e(51921);function L(){return(0,n.jsx)(g.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2,children:(0,n.jsxs)(i.B,{direction:"column",children:["Federated rule groups are currently an experimental feature.",(0,n.jsx)(p.$n,{fill:"text",icon:"book",children:(0,n.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})})}var O=e(14578);function j(){return(0,n.jsx)(c.E,{variant:"bodySmall",color:"warning",children:(0,n.jsxs)(i.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,n.jsx)(O.I,{name:"pause",size:"xs"})," Paused"]})})}var N=e(5179);const F=({color:Qe,includeState:vt})=>{const Ot=(0,a.of)(U,{color:Qe,includeState:vt});return(0,n.jsx)(i.B,{direction:"row",gap:.5,children:(0,n.jsx)("div",{className:Ot.dot})})},U=(Qe,vt)=>{const Ot=Qe.spacing(1.25),zt=`calc(${Ot} / 2.5)`,vn=vt.color==="error",ln=vt.color==="success",On=vt.color==="warning";return{dot:(0,s.css)({width:Ot,height:Ot,borderRadius:"100%",backgroundColor:Qe.colors.secondary.main,outline:`solid ${zt} ${Qe.colors.secondary.transparent}`,margin:zt},ln&&(0,s.css)({backgroundColor:Qe.colors.success.main,outlineColor:Qe.colors.success.transparent}),On&&(0,s.css)({backgroundColor:Qe.colors.warning.main,outlineColor:Qe.colors.warning.transparent}),vn&&(0,s.css)({backgroundColor:Qe.colors.error.main,outlineColor:Qe.colors.error.transparent}))}},w=({health:Qe})=>{const vt=Xn(Qe),Ot=vt?"error":"success",zt=vt?"Recording error":"Recording";return(0,n.jsx)(K,{color:Ot,text:zt})},B=({state:Qe,health:vt})=>{let Ot,zt;switch(Qe){case f.cF.Inactive:zt="success",Ot="Normal";break;case f.cF.Firing:zt="error",Ot="Firing";break;case f.cF.Pending:zt="warning",Ot="Pending";break}return Xn(vt)&&(zt="error",Ot="Error"),vt==="nodata"&&(zt="warning",Ot="No data"),(0,n.jsx)(K,{color:zt,text:Ot})};function K({color:Qe,text:vt}){return(0,n.jsxs)(i.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,n.jsx)(F,{color:Qe}),(0,n.jsx)(c.E,{variant:"bodySmall",color:Qe,children:vt})]})}var W=e(50509),z=e(32264),Y=e(46013);const X=(0,r.lazy)(()=>e.e(7409).then(e.bind(e,87409))),q=(0,r.lazy)(()=>e.e(285).then(e.bind(e,285))),G=({rule:Qe})=>{const vt=z.$.unifiedAlerting.alertStateHistoryBackend,Ot=z.$.unifiedAlerting.alertStateHistoryPrimary,vn=[vt,Ot].some(wn=>wn===Y.Q.Loki)?Y.Q.Loki:Y.Q.Annotations,ln=Qe.grafana_alert.id??"",On=Qe.grafana_alert.uid;return(0,n.jsxs)(r.Suspense,{fallback:"Loading...",children:[vn===Y.Q.Loki&&(0,n.jsx)(q,{ruleUID:On}),vn===Y.Q.Annotations&&(0,n.jsx)(X,{alertId:ln})]})};var te=e(15054),H=e(99938);const se=({rule:Qe})=>(0,n.jsx)(H.s,{rule:Qe,pagination:{itemsPerPage:te.FG},enableFiltering:!0});var ne=e(24120),le=e(39070),_=e(76885),Q=e(65879),ae=e(11807),oe=e(66602),J=e(39938),ee=e(69437),de=e(66718),xe=e(55907),re=e(26058),ue=e(56528),Te=e(7921),ge=e(74685);function Oe({data:Qe,thresholds:vt}){return Qe?(0,n.jsx)(ge.j,{data:Qe,thresholds:vt?.config,thresholdsType:vt?.mode}):null}var Ue=e(20382),Xe=e(57220),we=e(63066),qe=e(85828);const We=({expression:Qe})=>(0,n.jsx)(qe.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:Qe,width:"100%"});function Ce(Qe){return"rawSql"in Qe}const je=null,Ke=r.lazy(()=>e.e(8468).then(e.bind(e,58468))),_e=r.lazy(()=>e.e(7011).then(e.bind(e,67011)));function Fe({model:Qe,dataSource:vt}){return vt.type===Xe.ol.Prometheus&&(0,we.Bu)(Qe)?(0,n.jsx)(Ke,{query:Qe.expr}):vt.type===Xe.ol.Loki&&(0,we.Bu)(Qe)?(0,n.jsx)(_e,{query:Qe.expr??""}):Ce(Qe)?(0,n.jsx)(We,{expression:Qe.rawSql}):(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:(0,Ue.Bh)(Qe)})})}var at=e(19073);function Ct({rule:Qe,queries:vt,condition:Ot,evalDataByQuery:zt={}}){const vn=(0,l.keyBy)(Object.values(z.$.datasources),cs=>cs.uid),ln=vt.filter(cs=>!(0,ee.f)(cs.model)),On=vt.filter(cs=>(0,ee.f)(cs.model)),wn=(0,a.of)(dt),Un=(0,Te.an)(vt,Ot);return(0,n.jsxs)(i.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,n.jsx)("div",{className:wn.maxWidthContainer,children:(0,n.jsx)(i.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:ln.map(({model:cs,relativeTimeRange:Zn,refId:wt,datasourceUid:Ft},Ht)=>{const ut=vn[Ft];return(0,n.jsx)(Dt,{rule:Qe,refId:wt,model:cs,relativeTimeRange:Zn,dataSource:ut,thresholds:Un[wt],queryData:zt[wt]},Ht)})})}),(0,n.jsx)("div",{className:wn.maxWidthContainer,children:(0,n.jsx)(i.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:On.map(({model:cs,refId:Zn,datasourceUid:wt},Ft)=>(0,ee.f)(cs)&&(0,n.jsx)(Se,{refId:Zn,isAlertCondition:Ot===Zn,model:cs,evalData:zt[Zn]},Ft))})})]})}function Dt({refId:Qe,rule:vt,thresholds:Ot,model:zt,dataSource:vn,queryData:ln,relativeTimeRange:On}){const wn=(0,a.of)(pe),Un=(0,ee.f)(zt),[cs,Zn]=(0,at.mh)(vt,at.j5.Explore),wt=cs&&Zn,Ft=[];if(vn){const ut=vn.name??"[[Data source not found]]",pn=vn.meta.info.logos.small;Ft.push((0,n.jsx)(ze,{name:ut,imgUrl:pn},"datasource"))}On&&Ft.push((0,n.jsxs)(c.E,{color:"secondary",children:[(0,Q.secondsToHms)(On.from)," to now"]},"timerange"));let Ht;return!Un&&wt&&(Ht=vn&&tt(vn,zt)),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(fe,{refId:Qe,headerItems:Ft,exploreLink:Ht,children:(0,n.jsx)("div",{className:wn.queryPreviewWrapper,children:(0,n.jsx)(oe.Xw,{children:zt&&vn&&(0,n.jsx)(Fe,{model:zt,dataSource:vn})})})}),vn&&(0,n.jsx)(Oe,{data:ln,thresholds:Ot})]})}function tt(Qe,vt){const{uid:Ot,type:zt}=Qe,{refId:vn,...ln}=vt;return _.kM.renderUrl(`${z.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:Qe.uid,queries:[{refId:"A",...ln,datasource:{type:zt,uid:Ot}}],range:{from:"now-1h",to:"now"}})})}function ze({name:Qe,imgUrl:vt}){const Ot=(0,a.of)(pe);return(0,n.jsxs)("div",{className:Ot.dataSource,children:[(0,n.jsx)("img",{src:vt,width:16,alt:Qe}),Qe]},"datasource")}const pe=Qe=>({queryPreviewWrapper:(0,s.css)({margin:Qe.spacing(1)}),contentBox:(0,s.css)({flex:"1 0 100%"}),visualization:(0,s.css)({padding:Qe.spacing(1)}),dataSource:(0,s.css)({border:`1px solid ${Qe.colors.border.weak}`,borderRadius:Qe.shape.radius.default,padding:Qe.spacing(.5,1),display:"flex",alignItems:"center",gap:Qe.spacing(1)})});function Se({refId:Qe,model:vt,evalData:Ot,isAlertCondition:zt}){function vn(){switch(vt.type){case de.Tz.math:return(0,n.jsx)(Pt,{model:vt});case de.Tz.reduce:return(0,n.jsx)(be,{model:vt});case de.Tz.resample:return(0,n.jsx)(De,{model:vt});case de.Tz.classic:return(0,n.jsx)(Pe,{model:vt});case de.Tz.threshold:return(0,n.jsx)(ke,{model:vt});case de.Tz.sql:return(0,n.jsx)(ae.l,{rawSql:vt.expression||"",datasourceType:vt.datasource?.type});default:return(0,n.jsxs)(n.Fragment,{children:["Expression not supported: ",vt.type]})}}return(0,n.jsxs)(fe,{refId:Qe,headerItems:[(0,n.jsx)(c.E,{color:"secondary",children:(0,l.startCase)(vt.type)},"expression-type")],isAlertCondition:zt,children:[vn(),(0,n.jsx)(re.h,{}),Ot&&(0,n.jsx)(ue.GX,{series:Ot.series,isAlertCondition:zt})]})}function fe({refId:Qe,headerItems:vt=[],children:Ot,isAlertCondition:zt,exploreLink:vn}){const ln=(0,a.of)(Ee);return(0,n.jsxs)("div",{className:(0,s.cx)(ln.container),children:[(0,n.jsxs)("header",{className:ln.header,children:[(0,n.jsx)("span",{className:ln.refId,children:Qe}),vt,(0,n.jsx)(re.h,{}),zt&&(0,n.jsx)(J.E,{color:"green",icon:"check",text:"Alert condition"}),vn&&(0,n.jsx)(R.d,{component:(0,n.jsx)(p.z9,{size:"md",variant:"secondary",icon:"compass",href:vn,children:"View in Explore"})})]}),Ot]})}const Ee=Qe=>({container:(0,s.css)({flex:"1 0 25%",border:`1px solid ${Qe.colors.border.weak}`,maxWidth:"100%",borderRadius:Qe.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,s.css)({display:"flex",alignItems:"center",gap:Qe.spacing(1),padding:Qe.spacing(1),backgroundColor:Qe.colors.background.secondary}),textBlock:(0,s.css)({border:`1px solid ${Qe.colors.border.weak}`,padding:Qe.spacing(.5,1),backgroundColor:Qe.colors.background.primary,borderRadius:Qe.shape.radius.default}),refId:(0,s.css)({color:Qe.colors.text.link,padding:Qe.spacing(.5,1),border:`1px solid ${Qe.colors.border.weak}`,borderRadius:Qe.shape.radius.default})});function Pe({model:Qe}){const vt=(0,a.of)(he),Ot=(0,l.keyBy)(xe.A.reducerTypes,ln=>ln.value),zt=(0,l.keyBy)(xe.A.evalOperators,ln=>ln.value),vn=(0,l.keyBy)(xe.A.evalFunctions,ln=>ln.value);return(0,n.jsx)("div",{className:vt.container,children:Qe.conditions?.map(({query:ln,operator:On,reducer:wn,evaluator:Un},cs)=>{const Zn=Tt(Un);return(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)("div",{className:vt.blue,children:cs===0?"WHEN":!!On?.type&&zt[On?.type]?.text}),(0,n.jsx)("div",{className:vt.bold,children:wn?.type&&Ot[wn.type]?.text}),(0,n.jsx)("div",{className:vt.blue,children:"OF"}),(0,n.jsx)("div",{className:vt.bold,children:ln.params[0]}),(0,n.jsx)("div",{className:vt.blue,children:vn[Un.type].text}),(0,n.jsx)("div",{className:vt.bold,children:Zn?`(${Un.params[0]}; ${Un.params[1]})`:Un.params[0]})]},cs)})})}const he=Qe=>({container:(0,s.css)({padding:Qe.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:Qe.spacing(0,1)}),...pt(Qe)});function be({model:Qe}){const vt=(0,a.of)(Ae),{reducer:Ot,expression:zt,settings:vn}=Qe,ln=de.Cu.find(Un=>Un.value===Ot),On=vn?.mode??de.Mt.Strict,wn=de.HZ.find(Un=>Un.value===On);return(0,n.jsxs)("div",{className:vt.container,children:[(0,n.jsx)("div",{className:vt.label,children:"Function"}),(0,n.jsx)("div",{className:vt.value,children:ln?.label}),(0,n.jsx)("div",{className:vt.label,children:"Input"}),(0,n.jsx)("div",{className:vt.value,children:zt}),(0,n.jsx)("div",{className:vt.label,children:"Mode"}),(0,n.jsx)("div",{className:vt.value,children:wn?.label})]})}const Ae=Qe=>({container:(0,s.css)({padding:Qe.spacing(1),display:"grid",gap:Qe.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...pt(Qe)});function De({model:Qe}){const vt=(0,a.of)(Ie),{expression:Ot,window:zt,downsampler:vn,upsampler:ln}=Qe,On=de.PN.find(Un=>Un.value===vn),wn=de.iX.find(Un=>Un.value===ln);return(0,n.jsxs)("div",{className:vt.container,children:[(0,n.jsx)("div",{className:vt.label,children:"Input"}),(0,n.jsx)("div",{className:vt.value,children:Ot}),(0,n.jsx)("div",{className:vt.label,children:"Resample to"}),(0,n.jsx)("div",{className:vt.value,children:zt}),(0,n.jsx)("div",{className:vt.label,children:"Downsample"}),(0,n.jsx)("div",{className:vt.value,children:On?.label}),(0,n.jsx)("div",{className:vt.label,children:"Upsample"}),(0,n.jsx)("div",{className:vt.value,children:wn?.label})]})}const Ie=Qe=>({container:(0,s.css)({padding:Qe.spacing(1),display:"grid",gap:Qe.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...pt(Qe)});function ke({model:Qe}){const vt=(0,a.of)(dt),{expression:Ot,conditions:zt}=Qe,vn=zt&&zt[0]?.evaluator,ln=de.zd.find(Zn=>Zn.value===vn?.type),On=vn?Tt(vn):!1,wn=zt&&zt[0]?.unloadEvaluator,Un=de.zd.find(Zn=>Zn.value===wn?.type),cs=wn?Tt(wn):!1;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:vt.container,children:[(0,n.jsx)("div",{className:vt.label,children:"Input"}),(0,n.jsx)("div",{className:vt.value,children:Ot}),vn&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:vt.blue,children:ln?.label}),(0,n.jsx)("div",{className:vt.bold,children:On?`(${vn.params[0]}; ${vn.params[1]})`:vn.params[0]})]})]}),(0,n.jsx)("div",{className:vt.container,children:wn&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:vt.label,children:"Stop alerting when "}),(0,n.jsx)("div",{className:vt.value,children:Ot}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:vt.blue,children:Un?.label}),(0,n.jsx)("div",{className:vt.bold,children:cs?`(${wn.params[0]}; ${wn.params[1]})`:wn.params[0]})]})]})})]})}const dt=Qe=>{const{blue:vt,bold:Ot,...zt}=pt(Qe);return{...zt,maxWidthContainer:(0,s.css)({maxWidth:"100%"}),container:(0,s.css)({padding:Qe.spacing(1),display:"flex",gap:Qe.spacing(.5)}),blue:(0,s.css)(vt,{margin:"auto 0"}),bold:(0,s.css)(Ot,{margin:"auto 0"})}};function Pt({model:Qe}){const vt=(0,a.of)(dt),{expression:Ot}=Qe;return(0,n.jsxs)("div",{className:vt.container,children:[(0,n.jsx)("div",{className:vt.label,children:"Input"}),(0,n.jsx)("div",{className:vt.value,children:Ot})]})}const pt=Qe=>({blue:(0,s.css)({color:Qe.colors.text.link}),bold:(0,s.css)({fontWeight:Qe.typography.fontWeightBold}),label:(0,s.css)({display:"flex",alignItems:"center",padding:Qe.spacing(.5,1),backgroundColor:Qe.colors.background.secondary,fontSize:Qe.typography.bodySmall.fontSize,lineHeight:Qe.typography.bodySmall.lineHeight,fontWeight:Qe.typography.fontWeightBold,borderRadius:Qe.shape.radius.default}),value:(0,s.css)({padding:Qe.spacing(.5,1),border:`1px solid ${Qe.colors.border.weak}`,borderRadius:Qe.shape.radius.default})});function Tt(Qe){return Qe.type===xe.p.IsWithinRange||Qe.type===xe.p.IsOutsideRange}var jt=e(36135),$t=e(28318),sn=e(1932),Yt=e(25968);function qt(Qe){if(!Qe)return[];const{namespace:vt,rulerRule:Ot}=Qe,{rulesSource:zt}=vt;if((0,D.lT)(Ot)){const vn=Ot.grafana_alert.data;return bn(vn,Ot.for??"",Qe.group.interval)}if((0,Xe.Eb)(zt)){const vn=Jt(zt,Qe);return[Mt(vn,zt.uid)]}return[]}function bn(Qe,vt,Ot){const zt=(0,Yt.P8)(vt)??(0,Yt.P8)(Ot??"1m"),vn=Math.floor(zt/1e3);return Qe.map(ln=>(0,sn.jM)(ln,On=>{const wn=On.relativeTimeRange?.from??0,Un=Math.max(vn*3,wn+vn*2);On.relativeTimeRange={from:Un,to:0}}))}function Mt(Qe,vt){return{refId:Qe.refId,datasourceUid:vt,queryType:"",model:Qe,relativeTimeRange:{from:360,to:0}}}function Jt(Qe,vt){const Ot="A";switch(Qe.type){case"prometheus":return{refId:Ot,expr:vt.query};case"loki":return{refId:Ot,expr:vt.query};default:throw new Error(`Query for datasource type ${Qe.type} is currently not supported by cloud alert rules.`)}}const Ut=({rule:Qe})=>{const vt=(0,r.useMemo)(()=>new $t.t,[]),Ot=(0,ne.A)(vt.get()),zt=Gt(Ot),vn=(0,r.useMemo)(()=>qt(Qe),[Qe]),{allDataSourcesAvailable:ln}=(0,jt.g)(vn),On=(0,r.useCallback)(()=>{if(vn.length>0&&ln){let Un;Qe&&(0,D.lT)(Qe.rulerRule)&&(Un=Qe.rulerRule.grafana_alert.condition),vt.run(vn,Un??"A")}},[vn,ln,Qe,vt]);(0,r.useEffect)(()=>{ln&&On()},[ln,On]),(0,r.useEffect)(()=>()=>vt.destroy(),[vt]);const wn=(0,D.YN)(Qe.group);return(0,n.jsx)(n.Fragment,{children:zt?"Loading...":(0,n.jsxs)(n.Fragment,{children:[(0,D.lT)(Qe.rulerRule)&&!wn&&(0,n.jsx)(Ct,{rule:Qe,condition:Qe.rulerRule.grafana_alert.condition,queries:vn,evalDataByQuery:Ot}),!(0,D.lT)(Qe.rulerRule)&&!wn&&Ot&&Object.keys(Ot).length>0&&(0,n.jsx)(i.B,{direction:"column",gap:1,children:vn.map(Un=>(0,n.jsx)(Dt,{rule:Qe,refId:Un.refId,model:Un.model,dataSource:Object.values(z.$.datasources).find(cs=>cs.uid===Un.datasourceUid),queryData:Ot[Un.refId],relativeTimeRange:Un.relativeTimeRange},Un.refId))}),!wn&&!ln&&(0,n.jsx)(g.F,{title:"Query not available",severity:"warning",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})]})})};function Gt(Qe){return Qe?!!Object.values(Qe).find(vt=>vt.state===le.Gu.Loading):!0}const Lt=()=>(0,n.jsx)(n.Fragment,{children:"Routing"});var At=(Qe=>(Qe.Query="query",Qe.Instances="instances",Qe.History="history",Qe.Routing="routing",Qe.Details="details",Qe))(At||{});const Nt=()=>{const{rule:Qe}=(0,N.k)(),{pageNav:vt,activeTab:Ot}=St(Qe),[zt,vn]=(0,r.useState)(),{annotations:ln,promRule:On}=Qe,wn=Xn(Qe.promRule?.health),Un=(0,D.Z8)(On),cs=(0,D.YN)(Qe.group),Zn=(0,D.lT)(Qe.rulerRule)&&!!Qe.rulerRule.grafana_alert.provenance,wt=(0,D.lT)(Qe.rulerRule)&&(0,D.HH)(Qe.rulerRule),Ft=wn&&!wt,Ht=(0,D.uo)(Qe),ut=ln[y.YH.summary];return(0,n.jsxs)(M.d,{pageNav:vt,navId:"alert-list",isLoading:!1,renderTitle:pn=>(0,n.jsx)(Pn,{name:pn,paused:wt,state:Un?On.state:void 0,health:Qe.promRule?.health,ruleType:Qe.promRule?.type,ruleOrigin:Ht}),actions:(0,n.jsx)(v.l,{rule:Qe,showCopyLinkButton:!0,rulesSource:Qe.namespace.rulesSource}),info:Dn(Qe),subTitle:(0,n.jsxs)(i.B,{direction:"column",children:[wt&&(0,n.jsx)(m.A,{}),ut,cs&&(0,n.jsx)(L,{}),Zn&&(0,n.jsx)(I.Yi,{resource:I.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Ft&&(0,n.jsx)(g.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2,children:(0,n.jsx)("pre",{style:{marginBottom:0},children:(0,n.jsx)("code",{children:Qe.promRule?.lastError??"No error message"})})})]}),children:[(0,n.jsx)(i.B,{direction:"column",gap:2,children:(0,n.jsxs)(o.J,{children:[Ot==="query"&&(0,n.jsx)(Ut,{rule:Qe}),Ot==="instances"&&(0,n.jsx)(se,{rule:Qe}),Ot==="history"&&(0,D.lT)(Qe.rulerRule)&&(0,n.jsx)(G,{rule:Qe.rulerRule}),Ot==="routing"&&(0,n.jsx)(Lt,{}),Ot==="details"&&(0,n.jsx)(W.B,{rule:Qe})]})}),zt&&(0,n.jsx)(S.Z,{redirectTo:!0,identifier:zt,isProvisioned:Zn,onDismiss:()=>vn(void 0)})]})},Dn=Qe=>{const{labels:vt,annotations:Ot,group:zt}=Qe,vn=[],ln=Ot[y.YH.runbookURL],On=Ot[y.YH.dashboardUID],wn=Ot[y.YH.panelID],Un=On&&wn,cs=On,Zn=!(0,l.isEmpty)(vt),wt=zt.interval;if(ln){const Ft=(0,l.truncate)(ln,{length:42}),Ht=lt(ln)?(0,n.jsx)(d.Y,{variant:"bodySmall",href:ln,external:!0,children:Ft}):(0,n.jsx)(c.E,{variant:"bodySmall",children:Ft});vn.push({label:"Runbook URL",value:Ht})}if(Un?vn.push({label:"Dashboard and panel",value:(0,n.jsx)(R.d,{title:Qe.name,component:(0,n.jsx)(d.Y,{variant:"bodySmall",href:(0,b.D2)(On,wn),children:"View panel"})})}):cs&&vn.push({label:"Dashboard",value:(0,n.jsx)(R.d,{title:Qe.name,component:(0,n.jsx)(d.Y,{title:Qe.name,variant:"bodySmall",href:(0,b.JM)(On),children:"View dashboard"})})}),(0,D.Gy)(Qe.rulerRule)){const Ft=Qe.rulerRule?.grafana_alert.record?.metric??"";vn.push({label:"Metric name",value:(0,n.jsx)(c.E,{color:"primary",children:Ft})})}return wt&&vn.push({label:"Evaluation interval",value:(0,n.jsxs)(c.E,{color:"primary",children:["Every ",wt]})}),Zn&&vn.push({label:"Labels",value:(0,n.jsx)(C.m,{labels:vt,size:"sm"})}),vn},An=Qe=>{const vt=new URLSearchParams([["search",Qe.map(([Ot,zt])=>`${Ot}:"${zt}"`).join(" ")]]);return(0,P.G)("/alerting/list",vt)},Pn=({name:Qe,paused:vt=!1,state:Ot,health:zt,ruleType:vn,ruleOrigin:ln})=>{const On=(0,a.of)(Ve),[wn]=(0,u.s)(),Un=vn===f.JS.Recording,cs=wn.returnTo?String(wn.returnTo):"/alerting/list";return(0,n.jsxs)("div",{className:On.title,children:[(0,n.jsx)(p.z9,{variant:"secondary",icon:"angle-left",href:cs}),ln&&(0,n.jsx)(h.T,{pluginId:ln.pluginId}),(0,n.jsx)(c.E,{variant:"h1",truncate:!0,children:Qe}),vt?(0,n.jsx)(j,{}):(0,n.jsxs)(n.Fragment,{children:[Ot&&(0,n.jsx)(B,{state:Ot,health:zt}),Un&&(0,n.jsx)(w,{health:zt})]})]})},Xn=Qe=>Qe==="error"||Qe==="err";function Tn(){const[Qe,vt]=(0,u.s)(),Ot=Qe.tab;return[ht(Ot)?Ot:"query",ln=>{vt({tab:ln})}]}function ht(Qe){return typeof Qe=="string"&&Object.values(At).includes(Qe)}function St(Qe){const[vt,Ot]=Tn(),{annotations:zt,promRule:vn}=Qe,ln=zt[y.YH.summary],On=(0,D.Z8)(vn),wn=On?Ge(Qe.instanceTotals):void 0,Un=(0,T.EL)(Qe.namespace).name,cs=Qe.group.name,Zn=(0,D.lT)(Qe.rulerRule)&&On,wt=(0,D.KB)(Qe.promRule);return{pageNav:{...E.defaultPageNav,text:Qe.name,subTitle:ln,children:[{text:"Query and conditions",active:vt==="query",onClick:()=>{Ot("query")}},{text:"Instances",active:vt==="instances",onClick:()=>{Ot("instances")},tabCounter:wn,hideFromTabs:wt},{text:"History",active:vt==="history",onClick:()=>{Ot("history")},hideFromTabs:!Zn},{text:"Details",active:vt==="details",onClick:()=>{Ot("details")}}],parentItem:{text:cs,url:An([["namespace",Un],["group",cs]]),parentItem:{text:Un,url:An([["namespace",Un]])}}},activeTab:vt}}const Ge=Qe=>(0,l.chain)(Qe).pick([x.$.Alerting,x.$.Pending,x.$.Normal]).values().sum().value(),Ve=()=>({title:(0,s.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})});function lt(Qe){const vt=Qe.startsWith("/");let Ot=!1;try{new URL(Qe),Ot=!0}catch{return!1}return vt||Ot}const It=Nt},50509:(k,A,e)=>{"use strict";e.d(A,{$:()=>x,B:()=>v});var n=e(74848),s=e(32196),l=e(72095),r=e(96540),i=e(40845),g=e(67061),o=e(94753),d=e(10534),c=e(72109),a=e(23662),p=e(55196),u=e(16577),m=(E=>(E.GrafanaManagedAlertRule="Grafana-managed alert rule",E.CloudAlertRule="Cloud alert rule",E.CloudRecordingRule="Cloud recording rule",E))(m||{});const v=({rule:E})=>{const h=(0,i.of)(f);let y;(0,a.lT)(E.rulerRule)?y="Grafana-managed alert rule":(0,a.i7)(E.rulerRule)?y="Cloud recording rule":y="Cloud alert rule";const b=E.promRule?.evaluationTime,D=E.promRule?.lastEvaluation,P=(0,r.useCallback)(()=>(0,a.lT)(E.rulerRule)?E.rulerRule.grafana_alert.uid:"",[E.rulerRule]),C=(0,a.i7)(E.rulerRule)?void 0:E.annotations??[],M=Number.isFinite(b);return(0,n.jsxs)(g.B,{direction:"column",gap:3,children:[(0,n.jsxs)("div",{className:h.metadataWrapper,children:[(0,n.jsxs)(p.P,{direction:"column",children:["Rule type",(0,n.jsx)(o.E,{color:"primary",children:y})]}),(0,n.jsx)(p.P,{direction:"column",children:(0,a.lT)(E.rulerRule)&&(0,n.jsxs)(n.Fragment,{children:["Rule Identifier",(0,n.jsx)(g.B,{direction:"row",alignItems:"center",gap:.5,children:(0,n.jsxs)(o.E,{color:"primary",children:[E.rulerRule.grafana_alert.uid,(0,n.jsx)(d.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:P})]})})]})}),(0,n.jsx)(p.P,{direction:"column",children:M&&(0,n.jsxs)(n.Fragment,{children:["Last evaluation",D&&b?(0,n.jsxs)("span",{children:[(0,n.jsxs)(o.E,{color:"primary",children:[(0,l.B)(new Date(D))," ago"]}),", took"," ",(0,n.jsxs)(o.E,{color:"primary",children:[b,"ms"]})]}):null]})}),(0,n.jsx)(p.P,{direction:"column",children:!(0,a.i7)(E.rulerRule)&&(0,n.jsxs)(n.Fragment,{children:["Pending period",(0,n.jsx)(o.E,{color:"primary",children:E.rulerRule?.for??"0s"})]})}),(0,a.lT)(E.rulerRule)&&E.rulerRule.grafana_alert.no_data_state&&E.rulerRule.grafana_alert.exec_err_state&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.P,{direction:"column",children:["Alert state if no data or all values are null",(0,n.jsx)(o.E,{color:"primary",children:E.rulerRule.grafana_alert.no_data_state})]}),(0,n.jsxs)(p.P,{direction:"column",children:["Alert state if execution error or timeout",(0,n.jsx)(o.E,{color:"primary",children:E.rulerRule.grafana_alert.exec_err_state})]})]})]}),C&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.E,{variant:"h4",children:"Annotations"}),Object.keys(C).length===0?(0,n.jsx)(o.E,{variant:"bodySmall",color:"secondary",italic:!0,children:"No annotations"}):(0,n.jsx)("div",{className:h.metadataWrapper,children:Object.entries(C).map(([I,R])=>(0,n.jsxs)(p.P,{direction:"column",children:[I,(0,n.jsx)(x,{value:R})]},I))})]})]})};function x({value:E}){const h=E&&E.startsWith("http"),y=(0,n.jsx)(u.Y,{input:E,delimiter:["{{","}}"]});return h?(0,n.jsx)(c.Y,{variant:"bodySmall",href:E,external:!0,children:E}):(0,n.jsx)(o.E,{color:"primary",children:y})}const f=E=>({metadataWrapper:(0,s.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:E.spacing(3),columnGap:E.spacing(12)})})},2426:(k,A,e)=>{"use strict";e.d(A,{D:()=>b});var n=e(74848),s=e(96540),l=e(8249),r=e(47232),i=e(74135),g=e(23662),o=e(69087),d=e(75591),c=e(3197),a=e(83122),p=e(29158),u=e(24401),m=e(30973);const v=({rule:P,instance:C,extensionPointId:M})=>{const[I,R]=(0,s.useState)(),T=(0,s.useMemo)(()=>({instance:C,rule:P}),[C,P]),{extensions:S}=(0,c.vl)({context:T,extensionPointId:M,limitPerPlugin:3});if(S.length===0)return null;const L=(0,n.jsx)(m.w,{extensions:S,onSelect:R});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.m,{placement:"bottom-start",overlay:L,children:(0,n.jsx)(p.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})}),!!I&&!!I.path&&(0,n.jsx)(u.s,{path:I.path,title:I.title,onDismiss:()=>R(void 0)})]})};var x=e(33225),f=e(71223),E=e(84396);const h=({instance:P})=>{const C=(0,x.Hx)(P.annotations),M=(0,x.gO)(C);return(0,n.jsxs)("div",{children:[P.value&&(0,n.jsx)(E.X,{label:"Value",horizontal:!0,children:P.value}),C.map(([I,R])=>(0,n.jsx)(f.s,{annotationKey:I,value:R,valueLink:M.get(I)},I))]})};var y=e(30423);const b=({rule:P,instances:C,pagination:M,footerRow:I})=>{const R=(0,s.useMemo)(()=>C.length>1?(0,l.yO)(C.map(S=>S.labels)):{},[C]),T=(0,s.useMemo)(()=>C.map(S=>({data:{rule:P,alert:{...S,commonLabels:R}},id:(0,g.RI)(S)})),[R,C,P]);return(0,n.jsx)(d.E,{cols:D,isExpandable:!0,items:T,renderExpandedContent:({data:S})=>(0,n.jsx)(h,{instance:S.alert}),pagination:M,footerRow:I})},D=[{id:"state",label:"State",renderCell:({data:{alert:{state:P}}})=>(0,n.jsx)(y.C,{state:P}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:P,commonLabels:C}}})=>(0,n.jsx)(o.m,{labels:P,commonLabels:C,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:P}}})=>(0,n.jsx)(n.Fragment,{children:P.startsWith("0001")?"-":(0,r.KQ)(P).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:P,rule:C}})=>(0,n.jsx)(v,{rule:C,instance:P,extensionPointId:i.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},30423:(k,A,e)=>{"use strict";e.d(A,{C:()=>o});var n=e(74848),s=e(96540),l=e(56034),r=e(14578),i=e(23662),g=e(65415);const o=(0,s.memo)(({state:d,isPaused:c=!1,size:a="md",muted:p=!1})=>c?(0,n.jsx)(l.m,{content:"Alert evaluation is currently paused",placement:"top",children:(0,n.jsxs)(g.O,{state:"warning",size:a,muted:p,children:[(0,n.jsx)(r.I,{name:"pause",size:"xs"})," Paused"]})}):(0,n.jsx)(g.O,{state:(0,i.Wy)(d),size:a,muted:p,children:(0,i.XI)(d)}));o.displayName="AlertStateTag"},51921:(k,A,e)=>{"use strict";e.d(A,{Z:()=>o});var n=e(74848),s=e(96540),l=e(24180),r=e(96374),i=e(55852),g=e(18461);function o({identifier:c,isProvisioned:a,redirectTo:p=!1,onDismiss:u}){const m=(0,l.zy)(),[v,x]=(0,s.useState)(a?"confirm":"redirect");if(v==="redirect"){const f=g.$9(c),E=m.pathname+m.search,h=new URLSearchParams({copyFrom:f,returnTo:p?E:""});return(0,n.jsx)(l.rd,{to:"/alerting/new?"+h.toString(),push:!0})}return(0,n.jsx)(r.u,{isOpen:v==="confirm",title:"Copy provisioned alert rule",body:(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["The new rule will ",(0,n.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]}),(0,n.jsx)("p",{children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})]}),confirmText:"Copy",onConfirm:()=>x("redirect"),onDismiss:u})}const d=(0,s.forwardRef)(({text:c,ruleIdentifier:a,isProvisioned:p,className:u},m)=>{const[v,x]=(0,s.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.$n,{title:"Copy",className:u,size:"sm",variant:"secondary",icon:"copy",onClick:()=>x(!0),ref:m,children:c},"clone"),v&&(0,n.jsx)(o,{identifier:a,isProvisioned:p,onDismiss:()=>x(!1)})]})});d.displayName="CloneRuleButton"},35896:(k,A,e)=>{"use strict";e.d(A,{l:()=>ge});var n=e(74848),s=e(32196),l=e(96540),r=e(24180),i=e(40845),g=e(55852),o=e(67061),d=e(26272),c=e(38138),a=e(83122),p=e(28138),u=e(3169),m=e(23662),v=e(72635),x=e(79938),f=e(48070),E=e(6833),h=e(43482);function y(){const[Ue]=(0,h.D)(),[Xe]=x.hK.endpoints.upsertRuleGroupForNamespace.useMutation();return(0,E.Yb)(async(we,qe,We)=>{const{namespaceName:Ce}=we,je=(0,f.LH)({uid:qe,pause:We}),{newRuleGroupDefinition:Ke,rulerConfig:_e}=await Ue(we,je),Fe=(0,v.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),at=(0,v.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return Xe({rulerConfig:_e,namespace:Ce,payload:Ke,requestOptions:{successMessage:We?Fe:at}}).unwrap()})}var b=e(56361);const P=({rule:Ue,onPauseChange:Xe})=>{const we=(0,u._2)(),[qe,We]=y(),Ce=(0,m.lT)(Ue.rulerRule)&&(0,m.HH)(Ue.rulerRule),je=Ce?"play":"pause",Ke=Ce?"Resume evaluation":"Pause evaluation",_e=async Fe=>{if((0,m.lT)(Ue.rulerRule)){try{const at=(0,m.Uw)(Ue),Ct=Ue.rulerRule.grafana_alert.uid;await qe.execute(at,Ct,Fe)}catch(at){we.error(`Failed to ${Fe?"pause":"resume"} the rule: ${(0,b.JZ)(at)}`);return}Xe?.()}};return(0,n.jsx)(c.W.Item,{label:Ke,icon:je,disabled:(0,E.VP)(We),onClick:()=>{_e(!Ce)}})};var C=e(90141),M=e(74135),I=e(3197),R=e(94822);function T(Ue){const Xe=S(Ue),{extensions:we}=(0,I.vl)(Xe),qe=(0,m.uo)(Ue),We=Ue.promRule?.type;if(!qe||!We)return[];const{pluginId:Ce}=qe;return we.filter(je=>je.pluginId===Ce)}function S(Ue){return(0,l.useMemo)(()=>{switch(Ue.promRule?.type){case R.JS.Alerting:return{extensionPointId:M.S.AlertingAlertingRuleAction,context:{name:Ue.name,namespace:Ue.namespace.name,group:Ue.group.name,expression:Ue.query,labels:Ue.labels,annotations:Ue.annotations}};case R.JS.Recording:return{extensionPointId:M.S.AlertingRecordingRuleAction,context:{name:Ue.name,namespace:Ue.namespace.name,group:Ue.group.name,expression:Ue.query,labels:Ue.labels}};default:return{extensionPointId:""}}},[Ue])}var L=e(19073),O=e(18461),j=e(3704),N=e(56034),F=e(12210),U=e(99494),w=e(76156);const B=({title:Ue="",severity:Xe="",url:we=""})=>{const qe=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:Ue,severity:Xe,url:we}),{loading:We,installed:Ce,settings:je}=usePluginBridge(SupportedPlugin.Incident);return jsxs(Fragment,{children:[We===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"}),Ce===!1&&jsx(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly",children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"})}),je&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:qe,children:"Declare Incident"})]})},K=({title:Ue="",severity:Xe="",url:we=""})=>{const qe=(0,w.h)(U.W.Incident,"/incidents/declare",{title:Ue,severity:Xe,url:we}),{loading:We,installed:Ce,settings:je}=(0,F._)(U.W.Incident);return(0,n.jsxs)(n.Fragment,{children:[We===!0&&(0,n.jsx)(c.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),Ce===!1&&(0,n.jsx)(N.m,{content:"Grafana Incident is not installed or is not configured correctly",children:(0,n.jsx)(c.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})}),je&&(0,n.jsx)(c.W.Item,{label:"Declare incident",url:qe,icon:"fire"})]})},W=({rule:Ue,identifier:Xe,showCopyLinkButton:we,handleSilence:qe,handleDelete:We,handleDuplicateRule:Ce,onPauseChange:je,buttonSize:Ke})=>{const[_e,Fe]=(0,L.mh)(Ue,L.j5.Pause),at=_e&&Fe,[Ct,Dt]=(0,L.mh)(Ue,L.j5.Delete),tt=Ct&&Dt,[ze,pe]=(0,L.mh)(Ue,L.j5.Duplicate),Se=ze&&pe,[fe,Ee]=(0,L.mh)(Ue,L.j5.Silence),Pe=fe&&Ee,[he,be]=(0,L.mh)(Ue,L.j5.ModifyExport),Ae=he&&be,De=T(Ue),Ie=De.length>0,ke=(!(0,b.y$)()||(0,b.ES)())&&(0,m.Z8)(Ue.promRule)&&Ue.promRule.state===R.cF.Firing,dt=(0,b.S2)(Ue.namespace.rulesSource,Ue),Pt=[at,Pe,ke,Se].some(Boolean)&&[we,Ae].some(Boolean),pt=(0,n.jsxs)(n.Fragment,{children:[at&&(0,n.jsx)(P,{rule:Ue,onPauseChange:je}),Pe&&(0,n.jsx)(c.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:qe}),ke&&(0,n.jsx)(K,{title:Ue.name,url:""}),Se&&(0,n.jsx)(c.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>Ce(Xe)}),Pt&&(0,n.jsx)(c.W.Divider,{}),dt&&(0,n.jsx)(c.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>z(dt)}),Ae&&(0,n.jsx)(c.W.Item,{label:"Export",icon:"download-alt",childItems:[(0,n.jsx)(Y,{identifier:Xe},"export-with-modifications")]}),Ie&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.W.Divider,{}),De.map(Tt=>(0,n.jsx)(c.W.Item,{label:Tt.title,icon:Tt.icon,onClick:Tt.onClick},Tt.id))]}),tt&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.W.Divider,{}),(0,n.jsx)(c.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>We(Ue)})]})]});return(0,n.jsx)(a.m,{overlay:(0,n.jsx)(c.W,{children:pt}),children:(0,n.jsx)(C.A,{size:Ke})})};function z(Ue){navigator.clipboard?.writeText(Ue).then(()=>{p.A.emit(d.r1.alertSuccess,["URL copied to clipboard"])})}const Y=({identifier:Ue})=>{const Xe=location.pathname+location.search,we=(0,j.G)(`/alerting/${encodeURIComponent(O.$9(Ue))}/modify-export`,{returnTo:Xe});return(0,n.jsx)(c.W.Item,{label:"With modifications",icon:"file-edit-alt",url:we},"with-modifications")},X=W;var q=e(39601),G=e(96374),te=e(99140),H=e(96065),se=e(23770);const ne=(Ue=!1)=>{const[Xe,we]=(0,l.useState)(),[qe]=(0,H.Y)(),We=(0,l.useCallback)(()=>{we(void 0)},[]),Ce=(0,l.useCallback)(_e=>{we(_e)},[]),je=(0,l.useCallback)(async _e=>{if(!_e?.rulerRule)return;const Fe=(0,m.Uw)(_e);await qe.execute(Fe,_e.rulerRule),(0,te.JD)((0,se.Lc)({rulesSourceName:Fe.dataSourceName})),We(),Ue&&q.Ny.replace("/alerting/list")},[qe,We,Ue]);return[(0,l.useMemo)(()=>(0,n.jsx)(G.u,{isOpen:!!Xe,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>je(Xe),onDismiss:We}),[je,We,Xe]),Ce,We]};var le=e(75648),_=e(87978),Q=e(98569),ae=e(17272),oe=e(57220);const ee=({rulerRule:Ue,onClose:Xe})=>{const{uid:we}=Ue.grafana_alert,qe=(0,ae.Di)();return(0,n.jsx)(_._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:Xe,size:"md",children:(0,n.jsx)(o.B,{direction:"column",children:(0,n.jsx)(Q.G,{ruleUid:we,formValues:qe,alertManagerSourceName:oe.hY,onSilenceCreated:Xe,onCancel:Xe})})})};var de=e(14285),xe=e(70383),re=e(31678),ue=e(51921);const Te=Ue=>window.matchMedia(`(max-width: ${Ue}px)`).matches,ge=({compact:Ue,showViewButton:Xe,showCopyLinkButton:we,rule:qe,rulesSource:We})=>{const Ce=(0,re.useDispatch)(),je=(0,r.zy)(),Ke=(0,i.of)(Oe),_e=!Ue,[Fe,at]=ne(_e),[Ct,Dt]=(0,l.useState)(!1),[tt,ze]=(0,l.useState)(void 0),{namespace:pe,group:Se,rulerRule:fe}=qe,{hasActiveFilters:Ee}=(0,de.dI)(),Pe=je.pathname+je.search,he=(0,m.lT)(qe.rulerRule)&&!!qe.rulerRule.grafana_alert.provenance,[be,Ae]=(0,L.mh)(qe,L.j5.Update),De=be&&Ae,Ie=[],ke=(0,s.cx)({[Ke.compactButton]:Ue}),dt=Ue?"sm":"md",Pt=(0,oe.EV)(We),pt=O.UP(Pt,qe);if(Xe&&Ie.push((0,n.jsx)(g.z9,{tooltip:Ue?"View":void 0,tooltipPlacement:"top",className:ke,title:"View",size:dt,variant:"secondary",icon:"eye",href:(0,b.w$)(We,qe,Pe),children:!Ue&&"View"},"view")),fe&&De){const Tt=O.P1(Pt,pe.name,Se.name,fe),jt=(0,j.G)(`/alerting/${encodeURIComponent(O.$9(Tt))}/edit`,{returnTo:Pe});Ie.push((0,n.jsx)(g.z9,{tooltip:Ue?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:ke,size:dt,variant:"secondary",icon:"pen",href:jt,children:!Ue&&"Edit"},"edit"))}return(0,n.jsxs)(o.B,{gap:1,children:[Ie,(0,n.jsx)(X,{buttonSize:dt,rule:qe,identifier:pt,showCopyLinkButton:we,handleDelete:()=>at(qe),handleSilence:()=>Dt(!0),handleDuplicateRule:()=>ze({identifier:pt,isProvisioned:he}),onPauseChange:()=>{const Tt=Ee?void 0:le.Ys+1;Ce((0,se.Lc)({rulesSourceName:oe.hY,limitAlerts:Tt}))}}),Fe,(0,m.pv)(qe.rulerRule)&&Ct&&(0,n.jsx)(xe.b9,{accessType:"instance",children:(0,n.jsx)(ee,{rulerRule:qe.rulerRule,onClose:()=>Dt(!1)})}),tt?.identifier&&(0,n.jsx)(ue.Z,{identifier:tt.identifier,isProvisioned:tt.isProvisioned,onDismiss:()=>ze(void 0)})]})},Oe=Ue=>({compactButton:(0,s.css)({padding:`0 ${Ue.spacing(2)}`})})},75648:(k,A,e)=>{"use strict";e.d(A,{Ys:()=>H,DI:()=>se});var n=e(74848),s=e(32196),l=e(72724),r=e(47232),i=e(40845),g=e(56034),o=e(97814),d=e(33225),c=e(23662),a=e(25968),p=e(69087),u=e(84396),m=e(71223);function v(_){const Q=(0,i.of)(x),{annotations:ae}=_,oe=(0,d.gO)(ae);return ae.length===0?null:(0,n.jsx)("div",{className:Q.annotations,children:ae.map(([J,ee])=>(0,n.jsx)(m.s,{annotationKey:J,value:ee,valueLink:oe.get(J)},J))})}const x=()=>({annotations:(0,s.css)({marginTop:"46px"})});var f=e(96540),E=e(80997),h=e(14778),y=e(55852),b=e(67061),D=e(19073),P=e(46013),C=e(55740),M=e(57220),I=e(56361);const T=({rule:_,rulesSource:Q})=>{const{group:ae}=_,{StateHistoryModal:oe,showStateHistoryModal:J}=(0,P.G)(),ee=(0,h.i)(),[de,xe]=(0,D.mh)(_,D.j5.Explore),re=[],ue=(0,c.YN)(ae);if((0,M.Eb)(Q)&&de&&xe&&!ue&&re.push((0,n.jsx)(y.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,I.Yp)(Q,_.query),children:"See graph"},"explore")),_.annotations[C.YH.runbookURL]&&re.push((0,n.jsx)(y.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:E.sQ.sanitizeUrl(_.annotations[C.YH.runbookURL]),children:"View runbook"},"runbook")),_.annotations[C.YH.dashboardUID]){const Te=_.annotations[C.YH.dashboardUID];if(Te){re.push((0,n.jsx)(y.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Te)}`,onClick:()=>{ee(_.name)},children:"Go to dashboard"},"dashboard"));const ge=_.annotations[C.YH.panelID];ge&&re.push((0,n.jsx)(y.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Te)}?viewPanel=${encodeURIComponent(ge)}`,onClick:()=>{ee(_.name)},children:"Go to panel"},"panel"))}}return(0,c.pv)(_.rulerRule)&&re.push((0,n.jsxs)(f.Fragment,{children:[(0,n.jsx)(y.$n,{size:"sm",icon:"history",onClick:()=>(0,c.lT)(_.rulerRule)&&J(_.rulerRule),children:"Show state history"}),oe]},"history")),re.length?(0,n.jsx)(b.B,{children:re}):null};var S=e(19347),L=e(66718);function O(_){const{rulesSource:Q,rule:ae}=_,oe=(0,i.of)(j),J=(0,f.useMemo)(()=>{if((0,M.Eb)(Q))return[{name:Q.name,icon:Q.meta.info.logos.small}];if((0,c.lT)(ae.rulerRule)){const{data:ee}=ae.rulerRule.grafana_alert,de=ee.reduce((xe,re)=>{const ue=(0,S.l)().getInstanceSettings(re.datasourceUid);return!ue||ue.uid===L.Uj||(xe[ue.name]={name:ue.name,icon:ue.meta.info.logos.small}),xe},{});return Object.values(de)}return[]},[ae,Q]);return J.length===0?null:(0,n.jsx)(u.X,{label:"Data source",children:J.map(({name:ee,icon:de},xe)=>(0,n.jsxs)("div",{children:[de&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{alt:`${ee} datasource logo`,className:oe.dataSourceIcon,src:de})," "]}),ee]},ee))})}function j(_){const Q=_.spacing(2);return{dataSourceIcon:(0,s.css)({width:Q,height:Q})}}var N=e(28848),F=e(29317),U=e(20719),w=e(41781),B=e(72307),K=e(71713),W=e(73750);const z=({language:_,expr:Q})=>{const ae=(0,f.useMemo)(()=>[(0,w.D)({onlyIn:J=>"type"in J&&J.type==="code_block",getSyntax:()=>_},{...N.languages,[_]:_==="logql"?K.Ay:U.n6})],[_]),oe=(0,f.useMemo)(()=>(0,B.mO)(Q),[Q]);return(0,n.jsx)(F.KE,{"data-testid":"expression-editor",plugins:ae,value:oe})},Y=({expression:_,rulesSource:Q})=>{const ae=(0,i.of)(X);return(0,n.jsx)(W.L,{className:(0,s.cx)(ae.well,"slate-query-field"),children:(0,M.Eb)(Q)?(0,n.jsx)(z,{expr:_,language:Q.type===M.ol.Loki?"logql":"promql"}):_})},X=_=>({well:(0,s.css)({fontFamily:_.typography.fontFamilyMonospace})});function q(_){const{annotations:Q,rulesSource:ae,rule:oe}=_,J=G();return(0,M.Eb)(ae)?(0,n.jsx)(u.X,{label:"Expression",horizontal:!0,className:(0,s.cx)({[J.exprRow]:!!Q.length}),children:(0,n.jsx)(Y,{expression:oe.query,rulesSource:ae})}):null}const G=()=>({exprRow:(0,s.css)({marginBottom:"46px"})});var te=e(99938);const H=15,se=({rule:_})=>{const Q=(0,i.of)(le),{namespace:{rulesSource:ae}}=_,oe=(0,d.Hx)(_.annotations);return(0,n.jsxs)("div",{children:[(0,n.jsx)(T,{rule:_,rulesSource:ae}),(0,n.jsxs)("div",{className:Q.wrapper,children:[(0,n.jsxs)("div",{className:Q.leftSide,children:[(0,n.jsx)(ne,{rule:_}),!!_.labels&&!!Object.keys(_.labels).length&&(0,n.jsx)(u.X,{label:"Labels",horizontal:!0,children:(0,n.jsx)(p.m,{labels:_.labels})}),(0,n.jsx)(q,{rulesSource:ae,rule:_,annotations:oe}),(0,n.jsx)(v,{annotations:oe})]}),(0,n.jsx)("div",{className:Q.rightSide,children:(0,n.jsx)(O,{rulesSource:ae,rule:_})})]}),(0,n.jsx)(u.X,{label:"Instances",horizontal:!0,children:(0,n.jsx)(te.s,{rule:_,itemsDisplayLimit:H})})]})},ne=({rule:_})=>{let Q;const ae=_.group.interval,oe=_.promRule?.lastEvaluation,J=_.promRule?.evaluationTime,ee=(0,c.Gy)(_.rulerRule)?_.rulerRule?.grafana_alert.record?.metric:void 0;return(0,c.i7)(_.rulerRule)||(Q=_.rulerRule?.for??"0s"),(0,n.jsxs)(n.Fragment,{children:[ee&&(0,n.jsx)(u.X,{label:"Metric",horizontal:!0,children:ee}),ae&&(0,n.jsxs)(u.X,{label:"Evaluate",horizontal:!0,children:["Every ",ae]}),(0,n.jsx)(u.X,{label:"Pending period",horizontal:!0,children:Q}),oe&&!(0,a.mo)(oe)&&(0,n.jsx)(u.X,{label:"Last evaluation",horizontal:!0,children:(0,n.jsx)(g.m,{placement:"top",content:`${(0,l.LE)(oe,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,n.jsx)("span",{children:`${(0,r.KQ)(oe).locale("en").fromNow(!0)} ago`})})}),oe&&!(0,a.mo)(oe)&&J!==void 0&&(0,n.jsx)(u.X,{label:"Evaluation time",horizontal:!0,children:(0,n.jsx)(g.m,{placement:"top",content:`${J}s`,theme:"info",children:(0,n.jsx)("span",{children:(0,o.g)({timeInMs:J*1e3,humanize:!0})})})})]})},le=_=>({wrapper:(0,s.css)({display:"flex",flexDirection:"row",[_.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,s.css)({flex:1}),rightSide:(0,s.css)({[_.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(k,A,e)=>{"use strict";e.d(A,{s:()=>C});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(40845),g=e(55852),o=e(53876),d=e(78369),c=e(60029),a=e(94354),p=e(94822);const u=({className:R,onStateFilterChange:T,stateFilter:S,filterType:L,itemPerStateStats:O})=>{const j=(0,i.of)(m),N=K=>function(){return O&&O[K]?(0,n.jsx)(d.v,{name:O[K].toFixed(0),colorIndex:9,className:j.tag}):null},F=Object.values(p.Gi).map(K=>({label:K,value:K,component:N(K)})),w=[p.cF.Firing,p.cF.Pending].map(K=>({label:(0,l.capitalize)(K),value:K,component:N(K)})),B=L==="grafana"?F:w;return(0,n.jsxs)("div",{className:R,"data-testid":"alert-instance-state-filter",children:[(0,n.jsx)(c.J,{children:"State"}),(0,n.jsx)(a.z,{options:B,value:S,onChange:T,onClick:K=>{K===S&&T(void 0)}})]})};function m(R){return{tag:(0,s.css)({fontSize:"11px",fontWeight:"normal",padding:R.spacing(.25,.5),verticalAlign:"middle",marginLeft:R.spacing(.5)})}}var v=e(98164),x=e(56361),f=e(64861),E=e(57220),h=e(32642),y=e(23662),b=e(2426),D=e(92467);function P({stats:R,onClick:T,href:S}){const L=(0,i.of)(I);return(0,n.jsxs)("div",{className:L.footerRow,children:[(0,n.jsxs)("div",{children:["Showing ",R.visibleItemsCount," out of ",R.totalItemsCount," instances"]}),(0,n.jsxs)(g.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:T,href:S,children:["Show all ",R.totalItemsCount," alert instances"]})]})}function C(R){const{rule:T,itemsDisplayLimit:S=Number.POSITIVE_INFINITY,pagination:L,enableFiltering:O=!1}=R,{promRule:j,namespace:N,instanceTotals:F}=T,[U,w]=(0,r.useState)(),[B,K]=(0,r.useState)(),[W]=(0,r.useState)(Math.floor(Math.random()*100)),z=`queryString-${W}`,Y=(0,i.of)(I),X=(0,E.z2)(N.rulesSource)?E.hY:"prometheus",q=(0,r.useMemo)(()=>(0,y.Z8)(j)&&j.alerts?.length?M(U,B,(0,x.Cp)(f.xB.Importance,j.alerts)):[],[j,B,U]);if(!(0,y.Z8)(j))return null;const G=q.slice(0,S),te=(0,l.countBy)(j.alerts,oe=>(0,p.lh)(oe.state)),H=(0,l.sum)([F.alerting,F.inactive,F.pending,F.nodata]),se=H-G.length,ne={totalItemsCount:H,visibleItemsCount:G.length},le=(0,x.w$)(N.rulesSource,R.rule,location.pathname+location.search),_=(0,D.kc)(F),Q=()=>K(void 0),ae=se?(0,n.jsx)(P,{stats:ne,onClick:O?Q:void 0,href:O?void 0:le}):void 0;return(0,n.jsxs)(n.Fragment,{children:[O&&(0,n.jsx)("div",{className:(0,s.cx)(Y.flexRow,Y.spaceBetween),children:(0,n.jsxs)("div",{className:Y.flexRow,children:[(0,n.jsx)(o.X,{defaultQueryString:U,onFilterChange:oe=>w(oe)},z),(0,n.jsx)(u,{filterType:X,stateFilter:B,onStateFilterChange:K,itemPerStateStats:te})]})}),!O&&(0,n.jsx)("div",{className:Y.stats,children:_}),(0,n.jsx)(b.D,{rule:T,instances:G,pagination:L,footerRow:ae})]})}function M(R,T,S){let L=[...S];if(R){const O=R?(0,h.Zc)(R):[];L=L.filter(({labels:j})=>(0,v.Av)(j,O))}return T&&(L=L.filter(O=>(0,p.lh)(O.state)===T)),L}const I=R=>({flexRow:(0,s.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:R.spacing(1),gap:R.spacing(1)}),spaceBetween:(0,s.css)({justifyContent:"space-between"}),footerRow:(0,s.css)({display:"flex",flexDirection:"column",gap:R.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,s.css)({marginBottom:R.spacing(2)}),stats:(0,s.css)({display:"flex",gap:R.spacing(1),padding:R.spacing(1,0)})})},92467:(k,A,e)=>{"use strict";e.d(A,{M_:()=>u,j7:()=>x,kc:()=>f});var n=e(74848),s=e(2543),l=e.n(s),r=e(55127),i=e.n(r),g=e(96540),o=e(67061),d=e(39938),c=e(54317),a=e(94822);const p={recording:0,alerting:0,[a.cF.Pending]:0,[a.cF.Inactive]:0,paused:0,error:0,nodata:0},u=({namespaces:E})=>{const h=m(E),y=v(h),b=f(h),D=!!b.length;return b.unshift((0,n.jsxs)(g.Fragment,{children:[y," ",i()("rule",y)]},"total")),(0,n.jsx)(o.B,{direction:"row",children:D&&(0,n.jsx)("div",{children:(0,n.jsx)(o.B,{gap:.5,children:b})})})};function m(E){const h={...p};return E.forEach(({groups:y})=>{y.forEach(b=>{const D=(0,s.omitBy)(b.totals,s.isUndefined);for(const P in D)h[P]+=D[P]})}),h}function v(E){const h=(0,s.pick)(E,["alerting","pending","inactive","recording"]);return(0,s.sum)(Object.values(h))}const x=({group:E})=>{const h=E.totals,y=E?.interval,b=f(h),D=!!b.length;return(0,n.jsxs)(o.B,{direction:"row",children:[D&&(0,n.jsx)("div",{children:(0,n.jsx)(o.B,{gap:.5,children:b})}),y&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"|"}),(0,n.jsx)(d.E,{text:y,icon:"clock-nine",color:"blue"})]})]})};function f(E){const h=[];return E[c.$.Alerting]&&h.push((0,n.jsx)(d.E,{color:"red",text:`${E[c.$.Alerting]} firing`},"firing")),E.error&&h.push((0,n.jsx)(d.E,{color:"red",text:`${E.error} errors`},"errors")),E.nodata&&h.push((0,n.jsx)(d.E,{color:"blue",text:`${E.nodata} no data`},"nodata")),E[c.$.Pending]&&h.push((0,n.jsx)(d.E,{color:"orange",text:`${E[c.$.Pending]} pending`},"pending")),E[c.$.Normal]&&E.paused&&h.push((0,n.jsx)(d.E,{color:"green",text:`${E[c.$.Normal]} normal (${E.paused} paused)`},"paused")),E[c.$.Normal]&&!E.paused&&h.push((0,n.jsx)(d.E,{color:"green",text:`${E[c.$.Normal]} normal`},"inactive")),E.recording&&h.push((0,n.jsx)(d.E,{color:"purple",text:`${E.recording} recording`},"recording")),h}},80215:(k,A,e)=>{"use strict";e.d(A,{s:()=>B});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(56034),g=e(15054),o=e(83903),d=e(85244),c=e(55740),a=e(23662),p=e(75591),u=e(10562),m=e(48205),v=e(82437),x=e(16577),f=e(13064),E=e(35896),h=e(32264),y=e(14578),b=e(82775);function D({rule:z}){const Y=(0,r.of)(P),X=(0,a.lT)(z.rulerRule);return(0,l.useMemo)(()=>X?(0,b.q)(z.group.interval).exceedsLimit:!1,[z.group.interval,X])?(0,n.jsx)(i.m,{theme:"error",content:(0,n.jsxs)("div",{children:["A minimum evaluation interval of"," ",(0,n.jsx)("span",{className:Y.globalLimitValue,children:h.$.unifiedAlerting.minInterval})," has been configured in Grafana and will be used instead of the ",z.group.interval," interval configured for the Rule Group."]}),children:(0,n.jsx)(y.I,{name:"stopwatch-slash",className:Y.icon})}):null}function P(z){return{globalLimitValue:(0,s.css)({fontWeight:z.typography.fontWeightBold}),icon:(0,s.css)({fill:z.colors.warning.text})}}var C=e(75648),M=e(39890);const I=({rule:z})=>{const Y=(0,r.of)(R);return(0,M.lf)(z.health)?(0,n.jsx)(i.m,{theme:"error",content:z.lastError||"No error message provided.",children:(0,n.jsxs)("div",{className:Y.warn,children:[(0,n.jsx)(y.I,{name:"exclamation-triangle"}),(0,n.jsx)("span",{children:"error"})]})}):(0,n.jsx)(n.Fragment,{children:z.health})},R=z=>({warn:(0,s.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:z.spacing(1),color:z.colors.warning.text})});var T=e(70416),S=e(67061),L=e(62930),O=e(8484),j=e(94822),N=e(65415),F=e(30423);const U=({rule:z,isDeleting:Y,isCreating:X,isPaused:q})=>{const G=(0,r.of)(w),{promRule:te,rulerRule:H}=z,se=()=>q&&(0,a.Gy)(H)?(0,n.jsx)(i.m,{content:"Recording rule evaluation is currently paused",placement:"top",children:(0,n.jsxs)(N.O,{state:"warning",children:[(0,n.jsx)(y.I,{name:"pause",size:"xs"}),(0,n.jsx)(O.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,n.jsx)(O.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),ne=(0,l.useMemo)(()=>{if(te&&(0,a.Z8)(te)&&te.alerts?.length&&te.state!==j.cF.Inactive){const le=te.activeAt?new Date(te.activeAt):(0,a.Om)(te);if(le)return(0,n.jsxs)("span",{title:String(le),className:G.for,children:["for"," ",(0,T.dU)({start:le,end:new Date},!1)]})}return null},[te,G]);return Y?(0,n.jsxs)(S.B,{gap:1,children:[(0,n.jsx)(L.y,{}),(0,n.jsx)(O.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):X?(0,n.jsxs)(S.B,{gap:1,children:[(0,n.jsx)(L.y,{}),(0,n.jsx)(O.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):te&&(0,a.Z8)(te)?(0,n.jsxs)(S.B,{gap:1,children:[(0,n.jsx)(F.C,{state:te.state,isPaused:q}),!q&&ne]}):te&&(0,a.KB)(te)?(0,n.jsx)(se,{}):(0,n.jsx)(n.Fragment,{children:"n/a"})},w=z=>({for:(0,s.css)({fontSize:z.typography.bodySmall.fontSize,color:z.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),B=({rules:z,className:Y,showGuidelines:X=!1,emptyMessage:q="No rules found.",showGroupColumn:G=!1,showSummaryColumn:te=!1,showNextEvaluationColumn:H=!1})=>{const se=(0,r.of)(K),ne=(0,s.cx)(se.wrapper,Y,{[se.wrapperMargin]:X}),le=(0,l.useMemo)(()=>z.map((ae,oe)=>({id:`${ae.namespace.name}-${ae.group.name}-${ae.name}-${oe}`,data:ae})),[z]),_=W(te,G,H);if(!z.length)return(0,n.jsx)("div",{className:(0,s.cx)(ne,se.emptyMessage),children:q});const Q=X?u.B:p.E;return(0,n.jsx)("div",{className:ne,"data-testid":"rules-table",children:(0,n.jsx)(Q,{cols:_,isExpandable:!0,items:le,renderExpandedContent:({data:ae})=>(0,n.jsx)(C.DI,{rule:ae}),pagination:{itemsPerPage:g.FG},paginationStyles:se.pagination})})},K=z=>({wrapperMargin:(0,s.css)({[z.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,s.css)({padding:z.spacing(1)}),wrapper:(0,s.css)({width:"auto",borderRadius:z.shape.radius.default}),pagination:(0,s.css)({display:"flex",margin:0,paddingTop:z.spacing(1),paddingBottom:z.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${z.colors.border.medium}`,borderRight:`1px solid ${z.colors.border.medium}`,borderBottom:`1px solid ${z.colors.border.medium}`})});function W(z,Y,X){const{hasRuler:q,rulerRulesLoaded:G}=(0,o.y)();return(0,l.useMemo)(()=>{const te=ne=>{const{namespace:le,promRule:_,rulerRule:Q}=ne,{rulesSource:ae}=le;return!!(q(ae)&&G(ae)&&_&&!Q)},H=ne=>{const{namespace:le,promRule:_,rulerRule:Q}=ne,{rulesSource:ae}=le;return!!(q(ae)&&G(ae)&&Q&&!_)},se=[{id:"state",label:"State",renderCell:({data:ne})=>{const le=te(ne),_=H(ne),Q=(0,a.lT)(ne.rulerRule)&&(0,a.HH)(ne.rulerRule);return(0,n.jsx)(U,{rule:ne,isDeleting:le,isCreating:_,isPaused:Q})},size:"165px"},{id:"name",label:"Name",renderCell:({data:ne})=>ne.name,size:X?4:5},{id:"metadata",label:"",renderCell:({data:ne})=>{const le=ne.rulerRule,_=(0,a.uo)(ne);return _?(0,n.jsx)(d.T,{pluginId:_.pluginId}):(0,a.lT)(le)&&le.grafana_alert.provenance?(0,n.jsx)(m.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:ne})=>(0,n.jsx)(D,{rule:ne}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:ne,group:le}})=>ne?(0,n.jsx)(I,{rule:ne}):null,size:"75px"}];return z&&se.push({id:"summary",label:"Summary",renderCell:({data:ne})=>(0,n.jsx)(x.Y,{input:ne.annotations[c.YH.summary]??""}),size:X?4:5}),X&&se.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:ne})=>{const le=(0,f.C)(ne.promRule?.lastEvaluation,ne.group.interval);return le&&(0,n.jsx)(i.m,{placement:"top",content:`${le?.fullDate}`,theme:"info",children:(0,n.jsx)("span",{children:le?.humanized})})},size:2}),Y&&se.push({id:"group",label:"Group",renderCell:({data:ne})=>{const{namespace:le,group:_}=ne;return _.name==="default"?(0,n.jsx)(v.c,{namespace:le.name}):(0,n.jsx)(v.c,{namespace:le.name,group:_.name})},size:5}),se.push({id:"actions",label:"Actions",renderCell:({data:ne})=>{const le=te(ne),_=H(ne);return(0,n.jsx)(E.l,{compact:!0,showViewButton:!le&&!_,rule:ne,rulesSource:ne.namespace.rulesSource})},size:"200px"}),se},[z,Y,X,q,G])}},97754:(k,A,e)=>{"use strict";e.d(A,{y:()=>i});var n=e(74848),s=e(60021),l=e(65415);const r={[s.Or.Active]:"bad",[s.Or.Unprocessed]:"neutral",[s.Or.Suppressed]:"info"},i=({state:g})=>(0,n.jsx)(l.O,{state:r[g],children:g})},98569:(k,A,e)=>{"use strict";e.d(A,{G:()=>ae,A:()=>J});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(49785),g=e(40996),o=e(70416),d=e(47232),c=e(17172),a=e(39601),p=e(32264),u=e(39558),m=e(42418),v=e(40845),x=e(84167),f=e(88575),E=e(10354),h=e(21744),y=e(67061),b=e(55852),D=e(91540),P=e(55740),C=e(57220),M=e(60021),I=e(19073),R=e(98164),T=e(56361),S=e(25994),L=e(90182),O=e(29158),j=e(79938);const N=({className:ee,required:de,ruleUid:xe})=>{const re=(0,v.of)(F),ue=(0,i.xW)(),{control:Te,register:ge,formState:{errors:Oe}}=ue,{fields:Ue=[],append:Xe,remove:we}=(0,i.jz)({name:"matchers"}),[qe,{data:We}]=j.hK.endpoints.getAlertRule.useLazyQuery();return(0,r.useEffect)(()=>{xe&&qe({uid:xe})},[qe,xe]),(0,n.jsx)("div",{className:ee,children:(0,n.jsx)(f.D,{label:"Refine affected alerts",required:de,children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:(0,s.cx)(re.matchers,re.indent),children:[We&&(0,n.jsxs)("div",{children:[(0,n.jsx)(f.D,{label:"Alert rule",disabled:!0,children:(0,n.jsx)(E.p,{id:"alert-rule-name",defaultValue:We.grafana_alert.title,disabled:!0})}),(0,n.jsx)(S.c,{})]}),Ue.map((Ce,je)=>(0,n.jsxs)("div",{className:re.row,"data-testid":"matcher",children:[(0,n.jsx)(f.D,{label:"Label",invalid:!!Oe?.matchers?.[je]?.name,error:Oe?.matchers?.[je]?.name?.message,children:(0,n.jsx)(E.p,{...ge(`matchers.${je}.name`,{required:{value:de,message:"Required."}}),defaultValue:Ce.name,placeholder:"label",id:`matcher-${je}-label`})}),(0,n.jsx)(f.D,{label:"Operator",children:(0,n.jsx)(i.xI,{control:Te,render:({field:{onChange:Ke,ref:_e,...Fe}})=>(0,n.jsx)(L.l6,{...Fe,onChange:at=>Ke(at.value),className:re.matcherOptions,options:R.xH,"aria-label":"operator",id:`matcher-${je}-operator`}),defaultValue:Ce.operator||R.xH[0].value,name:`matchers.${je}.operator`,rules:{required:{value:de,message:"Required."}}})}),(0,n.jsx)(f.D,{label:"Value",invalid:!!Oe?.matchers?.[je]?.value,error:Oe?.matchers?.[je]?.value?.message,children:(0,n.jsx)(E.p,{...ge(`matchers.${je}.value`,{required:{value:de,message:"Required."}}),defaultValue:Ce.value,placeholder:"value",id:`matcher-${je}-value`})}),(Ue.length>1||!de)&&(0,n.jsx)(O.K,{"aria-label":"Remove matcher",className:re.removeButton,name:"trash-alt",onClick:()=>we(je),children:"Remove"})]},`${Ce.id}`))]}),(0,n.jsx)(b.$n,{className:re.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const Ce={name:"",value:"",operator:M.ho.equal};Xe(Ce)},children:"Add matcher"})]})})})},F=ee=>({wrapper:(0,s.css)({marginTop:ee.spacing(2)}),row:(0,s.css)({marginTop:ee.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:ee.colors.background.secondary,padding:`${ee.spacing(1)} ${ee.spacing(1)} 0 ${ee.spacing(1)}`,"& > * + *":{marginLeft:ee.spacing(2)}}),removeButton:(0,s.css)({marginLeft:ee.spacing(1),marginTop:ee.spacing(2.5)}),matcherOptions:(0,s.css)({minWidth:"140px"}),matchers:(0,s.css)({maxWidth:`${ee.breakpoints.values.sm}px`,margin:`${ee.spacing(1)} 0`,paddingTop:ee.spacing(.5)}),indent:(0,s.css)({marginLeft:ee.spacing(2)})}),U=N;var w=e(54230);const B=()=>{const{control:ee,getValues:de}=(0,i.xW)(),{field:{onChange:xe,value:re},fieldState:{invalid:ue}}=(0,i.as)({name:"startsAt",control:ee,rules:{validate:Ce=>de().endsAt>Ce}}),{field:{onChange:Te,value:ge},fieldState:{invalid:Oe}}=(0,i.as)({name:"endsAt",control:ee,rules:{validate:Ce=>de().startsAt<Ce}}),{field:{onChange:Ue,value:Xe}}=(0,i.as)({name:"timeZone",control:ee}),we=ue||Oe,qe=(0,d.KQ)(re),We=(0,d.KQ)(ge);return(0,n.jsx)(f.D,{className:K.timeRange,label:"Silence start and end",error:we?"To is before or the same as from":"",invalid:we,children:(0,n.jsx)(w.b,{value:{from:qe,to:We,raw:{from:qe,to:We}},timeZone:Xe,onChange:Ce=>{xe((0,d.KQ)(Ce.from)),Te((0,d.KQ)(Ce.to))},onChangeTimeZone:Ce=>Ue(Ce),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},K={timeRange:(0,s.css)({width:"400px"})};var W=e(45214),z=e(39938),Y=e(82843),X=e(25968),q=e(69087),G=e(75591),te=e(97754);const H=(ee,de,xe)=>{const[re,ue]=(0,r.useState)();(0,g.A)(ee,de,[re]),(0,W.A)(()=>{ue(xe)},[xe])},se=({amSourceName:ee,matchers:de,ruleUid:xe})=>{const re=[...xe?[{name:P.kW,value:xe,operator:M.ho.equal}]:[],...de].map(R.Wc),ue=Y.m.endpoints.getAlertmanagerAlerts.useLazyQuery,Te=(0,v.of)(le),ge=ne(),Oe=xe||de.some(Ce=>Ce.value&&Ce.name),[Ue,{currentData:Xe=[],isFetching:we,isError:qe}]=ue();if(H(()=>{Oe&&Ue({amSourceName:ee,filter:{matchers:re}})},500,[ee,re]),qe)return(0,n.jsx)(m.F,{title:"Preview not available",severity:"error",children:"Error occured when generating preview of affected alerts. Are your matchers valid?"});const We=Xe.map(Ce=>({id:Ce.fingerprint,data:Ce}));return(0,n.jsxs)("div",{children:[(0,n.jsxs)("h4",{className:Te.title,children:["Affected alert rule instances",We.length>0?(0,n.jsx)(z.E,{className:Te.badge,color:"blue",text:We.length}):null]}),!Oe&&(0,n.jsx)("span",{children:"Add a valid matcher to see affected alerts"}),we&&(0,n.jsx)(u._,{text:"Loading affected alert rule instances..."}),!we&&!qe&&Oe&&(0,n.jsx)("div",{className:Te.table,children:We.length>0?(0,n.jsx)(G.E,{items:We,isExpandable:!1,cols:ge,pagination:{itemsPerPage:10}}):(0,n.jsx)("span",{children:"No firing alert instances found"})})]})};function ne(){const ee=(0,v.of)(le);return[{id:"state",label:"State",renderCell:function({data:xe}){return(0,n.jsx)(te.y,{state:xe.status.state})},size:"120px",className:ee.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:xe}){return(0,n.jsx)(q.m,{labels:xe.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:xe}){return(0,n.jsx)(n.Fragment,{children:(0,X.mo)(xe.startsAt)?"-":(0,d.KQ)(xe.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const le=ee=>({table:(0,s.css)({maxWidth:`${ee.breakpoints.values.lg}px`}),moreMatches:(0,s.css)({marginTop:ee.spacing(1)}),title:(0,s.css)({display:"flex",alignItems:"center"}),badge:(0,s.css)({marginLeft:ee.spacing(1)}),stateColumn:(0,s.css)({display:"flex",alignItems:"center"})});var _=e(17272);const Q=({silenceId:ee,alertManagerSourceName:de})=>{const{data:xe,isLoading:re,error:ue}=D.F.endpoints.getSilence.useQuery({id:ee,datasourceUid:(0,C.w5)(de),ruleMetadata:!0,accessControl:!0}),Te=xe?.matchers?.find(we=>we.name===P.kW)?.value,ge=de===C.hY,Oe=(0,r.useMemo)(()=>{if(!xe)return;const we=xe.matchers?.filter(qe=>qe.name!==P.kW);return(0,_.Ee)({...xe,matchers:we})},[xe]);return ee&&re?(0,n.jsx)(u._,{text:"Loading existing silence information..."}):(0,c.NF)(ue)&&ue.status===404?(0,n.jsx)(m.F,{title:`Existing silence "${ee}" not found`,severity:"warning"}):(ge?xe?.accessControl?.write:!0)?(0,n.jsx)(ae,{ruleUid:Te,formValues:Oe,alertManagerSourceName:de}):(0,n.jsx)(m.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},ae=({formValues:ee=(0,_.Di)(),alertManagerSourceName:de,onSilenceCreated:xe,onCancel:re,ruleUid:ue})=>{const[Te,ge]=(0,I.L7)(I.QI.PreviewSilencedInstances),Oe=Te&&ge,[Ue,{isLoading:Xe}]=D.F.endpoints.createSilence.useMutation(),we=(0,i.mN)({defaultValues:ee}),qe=(0,v.of)(oe),{register:We,handleSubmit:Ce,formState:je,watch:Ke,setValue:_e,clearErrors:Fe}=we,[at,Ct,Dt,tt]=Ke(["duration","startsAt","endsAt","matchers"]),ze=()=>{a.Ny.push((0,T.nL)("/alerting/silences",de))},pe=xe||ze,Se=re||ze,fe=async be=>{const{id:Ae,startsAt:De,endsAt:Ie,comment:ke,createdBy:dt,matchers:Pt}=be;ue&&Pt.push({name:P.kW,value:ue,operator:M.ho.equal});const pt=Pt.map(R.Wc).filter(jt=>jt.name&&jt.value),Tt=(0,l.pickBy)({id:Ae,startsAt:De,endsAt:Ie,comment:ke,createdBy:dt,matchers:pt},jt=>!!jt);await Ue({datasourceUid:(0,C.w5)(de),payload:Tt}).unwrap().then(jt=>{pe?.(jt)})},[Ee,Pe]=(0,r.useState)(at);(0,g.A)(()=>{if((0,o.vd)(Ct)&&(0,o.vd)(Dt))if(at!==Ee)_e("endsAt",(0,d.KQ)((0,o.Ri)(new Date(Ct),(0,o.E9)(at))).toISOString()),Pe(at);else{const be=new Date(Ct).valueOf();if(new Date(Dt).valueOf()>be){const De=(0,o.dU)({start:new Date(Ct),end:new Date(Dt)});_e("duration",De),Pe(De)}}},700,[Fe,at,Dt,Ee,_e,Ct]);const he=!!(p.$.bootData.user.isSignedIn&&p.$.bootData.user.name);return(0,n.jsx)(i.Op,{...we,children:(0,n.jsxs)("form",{onSubmit:Ce(fe),children:[(0,n.jsxs)(x.n,{className:qe.formContainer,children:[(0,n.jsxs)("div",{className:qe.silencePeriod,children:[(0,n.jsx)(B,{}),(0,n.jsx)(f.D,{label:"Duration",invalid:!!je.errors.duration,error:je.errors.duration&&(je.errors.duration.type==="required"?"Required field":je.errors.duration.message),children:(0,n.jsx)(E.p,{...We("duration",{validate:be=>Object.keys((0,o.E9)(be)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,n.jsx)(U,{required:!ue,ruleUid:ue}),(0,n.jsx)(f.D,{label:"Comment",required:!0,error:je.errors.comment?.message,invalid:!!je.errors.comment,children:(0,n.jsx)(h.f,{...We("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})}),!he&&(0,n.jsx)(f.D,{label:"Created By",required:!0,error:je.errors.createdBy?.message,invalid:!!je.errors.createdBy,children:(0,n.jsx)(E.p,{...We("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})}),Oe&&(0,n.jsx)(se,{amSourceName:de,matchers:tt,ruleUid:ue})]}),(0,n.jsxs)(y.B,{gap:1,children:[Xe&&(0,n.jsx)(b.$n,{disabled:!0,icon:"spinner",variant:"primary",children:"Saving..."}),!Xe&&(0,n.jsx)(b.$n,{type:"submit",children:"Save silence"}),(0,n.jsx)(b.z9,{onClick:Se,variant:"secondary",children:"Cancel"})]})]})})},oe=ee=>({formContainer:(0,s.css)({maxWidth:ee.breakpoints.values.md}),alertRule:(0,s.css)({paddingBottom:ee.spacing(2)}),silencePeriod:(0,s.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:ee.spacing(1),maxWidth:ee.breakpoints.values.sm,paddingTop:ee.spacing(2)})}),J=Q},17272:(k,A,e)=>{"use strict";e.d(A,{Di:()=>a,Ee:()=>c,LP:()=>d});var n=e(70416),s=e(43127),l=e(47232),r=e(32264),i=e(98164),g=e(32642),o=e(60021);const d=p=>{const u={},m=p.get("comment"),v=p.getAll("matcher"),x=(0,g.ou)(v);return x.length&&(u.matchers=x.map(i.MU)),m&&(u.comment=m),u},c=p=>{const u=new Date,v=Date.parse(p.endsAt)<Date.now()?{start:u,end:(0,n.Ri)(u,{hours:2})}:{start:new Date(p.startsAt),end:new Date(p.endsAt)};return{id:p.id,startsAt:v.start.toISOString(),endsAt:v.end.toISOString(),comment:p.comment,createdBy:p.createdBy,duration:(0,n.dU)(v),isRegex:!1,matchers:p.matchers?.map(i.MU)||[],matcherName:"",matcherValue:"",timeZone:s.lE}},a=p=>{const u=new Date,m=(0,n.Ri)(u,{hours:2});return{id:"",startsAt:u.toISOString(),endsAt:m.toISOString(),comment:`created ${(0,l.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:r.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:s.lE,matchers:[{name:"",value:"",operator:o.ho.equal}],...p}}},96065:(k,A,e)=>{"use strict";e.d(A,{Y:()=>g});var n=e(72635),s=e(79938),l=e(48070),r=e(6833),i=e(43482);function g(){const[o]=(0,i.D)(),[d]=s.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[c]=s.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,r.Yb)(async(a,p)=>{const{groupName:u,namespaceName:m}=a,v=(0,l.KH)({rule:p}),{newRuleGroupDefinition:x,rulerConfig:f}=await o(a,v),E=(0,n.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return x.rules.length===0?c({rulerConfig:f,namespace:m,group:u,requestOptions:{successMessage:E}}).unwrap():d({rulerConfig:f,namespace:m,payload:x,requestOptions:{successMessage:E}}).unwrap()})}},43482:(k,A,e)=>{"use strict";e.d(A,{D:()=>i});var n=e(99140),s=e(79938),l=e(48070),r=e(23770);function i(){const[g,o]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();return[async(c,a)=>{const{dataSourceName:p,groupName:u,namespaceName:m}=c;await(0,n.JD)((0,r.DC)({rulesSourceName:p}));const v=(0,r.Qt)(n.Gu,p),x=await g({rulerConfig:v,namespace:m,group:u}).unwrap();return{newRuleGroupDefinition:(0,l.i3)(x,a),rulerConfig:v}},o]}},19073:(k,A,e)=>{"use strict";e.d(A,{Ej:()=>y,Hl:()=>I,L7:()=>M,QI:()=>m,RY:()=>x,e2:()=>h,iI:()=>C,j5:()=>v,mh:()=>b});var n=e(96540),s=e(16233),l=e(11167),r=e(60021),i=e(31678),g=e(82843),o=e(70383),d=e(75471),c=e(57220),a=e(56361),p=e(23662),u=e(97009),m=(S=>(S.ViewExternalConfiguration="view-external-configuration",S.UpdateExternalConfiguration="update-external-configuration",S.CreateContactPoint="create-contact-point",S.ViewContactPoint="view-contact-point",S.UpdateContactPoint="edit-contact-points",S.DeleteContactPoint="delete-contact-point",S.ExportContactPoint="export-contact-point",S.CreateNotificationTemplate="create-notification-template",S.ViewNotificationTemplate="view-notification-template",S.UpdateNotificationTemplate="edit-notification-template",S.DeleteNotificationTemplate="delete-notification-template",S.DecryptSecrets="decrypt-secrets",S.CreateNotificationPolicy="create-notification-policy",S.ViewNotificationPolicyTree="view-notification-policy-tree",S.UpdateNotificationPolicyTree="update-notification-policy-tree",S.DeleteNotificationPolicy="delete-notification-policy",S.ExportNotificationPolicies="export-notification-policies",S.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",S.CreateSilence="create-silence",S.ViewSilence="view-silence",S.UpdateSilence="update-silence",S.PreviewSilencedInstances="preview-silenced-alerts",S.ViewMuteTiming="view-mute-timing",S.CreateMuteTiming="create-mute-timing",S.UpdateMuteTiming="update-mute-timing",S.DeleteMuteTiming="delete-mute-timing",S.ExportMuteTimings="export-mute-timings",S))(m||{}),v=(S=>(S.Duplicate="duplicate-alert-rule",S.View="view-alert-rule",S.Update="update-alert-rule",S.Delete="delete-alert-rule",S.Explore="explore-alert-rule",S.Silence="silence-alert-rule",S.ModifyExport="modify-export-rule",S.Pause="pause-alert-rule",S))(v||{}),x=(S=>(S.CreateAlertRule="create-alert-rule",S.ViewAlertRule="view-alert-rule",S.UpdateAlertRule="update-alert-rule",S.DeleteAlertRule="delete-alert-rule",S.ExportGrafanaManagedRules="export-grafana-managed-rules",S.ReadConfigurationStatus="read-configuration-status",S.CreateExternalAlertRule="create-external-alert-rule",S.ViewExternalAlertRule="view-external-alert-rule",S.UpdateExternalAlertRule="update-external-alert-rule",S.DeleteExternalAlertRule="delete-external-alert-rule",S))(x||{});const f=!0,E=!1,h=()=>({"create-alert-rule":T(f,i.AccessControlAction.AlertingRuleCreate),"view-alert-rule":T(f,i.AccessControlAction.AlertingRuleRead),"update-alert-rule":T(f,i.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":T(f,i.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":T(f,i.AccessControlAction.AlertingRuleRead),"read-configuration-status":[f,s.TP.hasPermission(i.AccessControlAction.AlertingInstanceRead)||s.TP.hasPermission(i.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":T(f,i.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":T(f,i.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":T(f,i.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":T(f,i.AccessControlAction.AlertingRuleExternalWrite)}),y=S=>h()[S];function b(S,L){const O=P(S);return(0,n.useMemo)(()=>O[L],[O,L])}function D(S,L){const O=P(S);return useMemo(()=>L.map(j=>O[j]),[O,L])}function P(S){const L=S.namespace.rulesSource,O=typeof L=="string"?L:L.name,j=(0,p.lT)(S.rulerRule)&&!!S.rulerRule.grafana_alert.provenance,N=(0,p.YN)(S.group),F=(0,p.lT)(S.rulerRule),U=(0,p.Tm)(S),w=j||N||U,{isEditable:B,isRemovable:K,isRulerAvailable:W=!1,loading:z}=(0,u.g)(O,S.rulerRule),[Y,X]=y("export-grafana-managed-rules"),q=z?E:W,G=w?E:q,te=U?E:q,H=(0,d.Wd)(O),se=R(S);return{"duplicate-alert-rule":T(te,H.create),"view-alert-rule":T(f,H.read),"update-alert-rule":[G,B??!1],"delete-alert-rule":[G,K??!1],"explore-alert-rule":T(f,i.AccessControlAction.DataSourcesExplore),"silence-alert-rule":se,"modify-export-rule":[F,X],"pause-alert-rule":[G&&F,B??!1]}}function C(){const{selectedAlertmanager:S,hasConfigurationAPI:L,isGrafanaAlertmanager:O}=(0,o.VI)(),j=(0,d.lV)(S),N=(0,d.jy)(S);return{"view-external-configuration":T(f,i.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":T(L,i.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":T(L,j.create),"view-contact-point":T(f,j.read),"edit-contact-points":T(L,j.update),"delete-contact-point":T(L,j.delete),"export-contact-point":T(O,j.read),"create-notification-template":T(L,j.create),"view-notification-template":T(f,j.read),"edit-notification-template":T(L,j.update),"delete-notification-template":T(L,j.delete),"create-notification-policy":T(L,j.create),"view-notification-policy-tree":T(f,j.read),"update-notification-policy-tree":T(L,j.update),"delete-notification-policy":T(L,j.delete),"export-notification-policies":T(O,j.read),"decrypt-secrets":T(O,j.provisioning.readSecrets),"view-autogenerated-policy-tree":[O,(0,a.qc)()],"create-silence":T(f,N.create),"view-silence":T(f,N.read),"update-silence":T(f,N.update),"preview-silenced-alerts":T(f,N.read),"create-mute-timing":T(L,j.create),"view-mute-timing":T(f,j.read),"update-mute-timing":T(L,j.update),"delete-mute-timing":T(L,j.delete),"export-mute-timings":T(O,j.read)}}function M(S){const L=C();return(0,n.useMemo)(()=>L[S],[L,S])}function I(S){const L=C();return(0,n.useMemo)(()=>S.map(O=>L[O]),[L,S])}function R(S){const O=S.namespace.rulesSource===c.hY,j=(0,p.Gy)(S.rulerRule),{currentData:N,isLoading:F}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!O}),U=(0,p.lT)(S.rulerRule)?S.rulerRule.grafana_alert.namespace_uid:void 0,{loading:w,folder:B}=(0,l.a)(U);if(!O||j||F||w||!B)return[!1,!1];const K=N?.alertmanagersChoice===r.nA.External,W=N?.alertmanagersChoice===r.nA.All,z=!K||W,{accessControl:Y={}}=B,X=!!(s.TP.hasPermission(i.AccessControlAction.AlertingInstanceCreate)||Y[i.AccessControlAction.AlertingSilenceCreate]);return[z,X]}const T=(S,L)=>[S,s.TP.hasPermission(L)]},62190:(k,A,e)=>{"use strict";e.d(A,{W:()=>l});var n=e(96540),s=e(57220);function l(r){return(0,n.useMemo)(()=>(0,s.sq)(r),[r])}},36135:(k,A,e)=>{"use strict";e.d(A,{g:()=>r});var n=e(96540),s=e(19347),l=e(26657);function r(i){return{allDataSourcesAvailable:(0,n.useMemo)(()=>i.filter(o=>!(0,l.s9)(o.datasourceUid)).every(o=>!!(0,s.l)().getInstanceSettings(o.datasourceUid)),[i])}}},6833:(k,A,e)=>{"use strict";e.d(A,{Gz:()=>a,VP:()=>c,Yb:()=>r});var n=e(74848),s=e(96540),l=e(56361);function r(u,m){const[v,x]=(0,s.useState)({status:"not-executed",error:void 0,result:m}),f=(0,s.useRef)(),E=(0,s.useRef)(),h=i({execute(...y){E.current=y;const b=u(...y);return f.current=b,x(D=>({...D,status:"loading"})),b.then(D=>{b===f.current&&x(P=>({...P,status:"success",error:void 0,result:D}))},D=>{b===f.current&&x(P=>({...P,status:"error",error:D}))}),b},reset(){x({status:"not-executed",error:void 0,result:m}),f.current=void 0,E.current=void 0}});return[(0,s.useMemo)(()=>({reset(){h.current.reset()},execute:(...y)=>h.current.execute(...y)}),[]),v,{promise:f.current,lastArgs:E.current}]}function i(u){const m=(0,s.useRef)(u);return m.current=u,(0,s.useMemo)(()=>Object.freeze({get current(){return m.current}}),[])}function g(u){return u.status==="error"}function o(u){return u.status==="success"}function d(u){return u.status==="not-executed"}function c(u){return u.status==="loading"}function a(...u){return{uninitialized:u.every(d),loading:u.some(c),error:u.find(g)?.error,success:u.some(o)}}function p({state:u}){return jsxs(Fragment,{children:[d(u)&&"uninitialized",c(u)&&"loading",o(u)&&"success",o(u)&&`result: ${JSON.stringify(u.result,null,2)}`,g(u)&&`error: ${stringifyErrorLike(u.error)}`]})}},730:(k,A,e)=>{"use strict";e.d(A,{$q:()=>D,Ll:()=>b,O3:()=>C,ZU:()=>E,we:()=>v});var n=e(96540),s=e(16817),l=e(31678),r=e(79938),i=e(77583),g=e(23770),o=e(57220),d=e(88467),c=e(18461),a=e(23662),p=e(9518),u=e(61410);function m(M,I){const R=x(I),T=useCombinedRuleNamespaces(I),S=useMemo(()=>{if(!M||!I||T.length===0)return[];const L=[];for(const O of T)for(const j of O.groups)for(const N of j.rules)N.name===M&&L.push(N);return L},[M,I,T]);return{...R,result:S}}function v(M,I,R){const T=(0,o.oh)(I),{dsFeatures:S,isLoadingDsFeatures:L}=C(I),{currentData:O,isLoading:j,error:N}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:I,ruleName:M,namespace:R?.namespace,groupName:R?.groupName}),[F]=r.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:U,error:w,value:B}=(0,s.A)(async()=>{if(!T)throw new Error("Unable to obtain data source settings");if(N)throw new Error("Unable to obtain Prometheus rules");const K=O||[],W=[];if(S?.rulerConfig){const X=S.rulerConfig,q=K.map(G=>G.groups.map(te=>({namespace:G,group:te}))).flat();await Promise.allSettled(q.map(async G=>{const te=await F({rulerConfig:X,namespace:G.namespace.name,group:G.group.name}).unwrap();W.push(te)}))}return K.map(X=>(0,p.O6)(T,X,W)).flatMap(X=>X.groups.flatMap(q=>q.rules))},[T,S,j,N,O,F]);return{loading:L||U,error:w,rules:B}}function x(M,I){const R=useDispatch(),T=useUnifiedAlertingSelector(N=>N.promRules),S=f(M,T),L=useUnifiedAlertingSelector(N=>N.rulerRules),O=f(M,L),{loading:j}=useAsync(async()=>{M&&await R(fetchPromAndRulerRulesAction({rulesSourceName:M,identifier:I}))},[R,M]);return{loading:j,error:S.error??isRulerNotSupportedResponse(O)?void 0:O.error,dispatched:S.dispatched&&O.dispatched}}function f(M,I){if(!M)return initialAsyncRequestState;const R=I[M];return R||initialAsyncRequestState}function E({ruleIdentifier:M,limitAlerts:I}){const{ruleSourceName:R}=M,T=y(M),{dsFeatures:S,isLoadingDsFeatures:L}=C(R),{loading:O,error:j,result:N}=h(M),{currentData:F,isLoading:U,error:w}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:M.ruleSourceName,namespace:N?.namespace,groupName:N?.group,ruleName:N?.ruleName,limitAlerts:I},{skip:!N||O,refetchOnMountOrArgChange:!0}),[B,{currentData:K,isLoading:W,error:z,isUninitialized:Y}]=r.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,n.useEffect)(()=>{!S?.rulerConfig||!N||B({rulerConfig:S.rulerConfig,namespace:N.namespace,group:N.group})},[S,B,N]);const X=(0,n.useMemo)(()=>{if(!(!F||!T)&&F.length>0){const q=F.map(G=>(0,p.O6)(T,G,K?[K]:[]));for(const G of q)for(const te of G.groups)for(const H of te.rules){const se=c.UP(R,H);if(c.LC(se,M))return H}}},[M,R,F,K,T]);return{loading:L||U||W||Y,error:j??w??z,result:X}}function h(M){const{isLoading:I,currentData:R,error:T,isUninitialized:S}=r.hK.endpoints.getAlertRule.useQuery({uid:(0,a.A4)(M)?M.uid:""},{skip:!(0,a.A4)(M),refetchOnMountOrArgChange:!0});return(0,n.useMemo)(()=>(0,a.Mj)(M)||(0,a.X4)(M)?{result:{namespace:M.namespace,group:M.groupName,ruleName:M.ruleName},loading:!1}:(0,a.A4)(M)?I||S?{loading:!0}:T?{loading:!1,error:T}:R?{result:{namespace:R.grafana_alert.namespace_uid,group:R.grafana_alert.rule_group,ruleName:R.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${M.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[M,I,S,T,R])}function y(M){return(0,a.A4)(M)?"grafana":(0,o.oh)(M.ruleSourceName)}function b({ruleIdentifier:M}){const I=y(M),{dsFeatures:R,isLoadingDsFeatures:T}=C(M.ruleSourceName),{loading:S,error:L,result:O}=h(M),[j,{currentData:N,isLoading:F,isUninitialized:U,error:w}]=r.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,n.useEffect)(()=>{!R?.rulerConfig||!O||j({rulerConfig:R.rulerConfig,namespace:O.namespace,group:O.group})},[R,j,O]);const B=(0,n.useMemo)(()=>{const{ruleSourceName:K}=M;if(!N||!I||!O)return;const W=N.rules.find(z=>{const Y=c.P1(K,O.namespace,O.group,z);return c.LC(Y,M)});if(W)return{ruleSourceName:K,group:N,namespace:O.namespace,rule:W}},[M,N,I,O]);return{loading:S||T||F||U,error:L??w,result:B}}const D={dataSourceName:o.hY,apiVersion:"legacy"},P={rulerConfig:D};function C(M){const I=(0,o.z2)(M),{currentData:R,isLoading:T}=i.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:M},{skip:I});return I?{isLoadingDsFeatures:!1,dsFeatures:P}:{isLoadingDsFeatures:T,dsFeatures:R}}},9518:(k,A,e)=>{"use strict";e.d(A,{Jr:()=>f,NW:()=>D,O6:()=>v,Tj:()=>P,Ug:()=>b,dy:()=>u,kU:()=>L});var n=e(2543),s=e.n(n),l=e(96540),r=e(54317),i=e(94822),g=e(79938),o=e(55740),d=e(57220),c=e(23662),a=e(730),p=e(61410);function u(O,j){const N=(0,p.$)(B=>B.promRules),F=(0,p.$)(B=>B.rulerRules),U=(0,l.useRef)({}),w=(0,l.useMemo)(()=>{if(O){const B=(0,d.Zw)(O);if(!B)throw new Error(`Unknown rules source: ${O}`);return[B]}return(0,d.lS)()},[O]);return(0,l.useMemo)(()=>w.map(B=>{const K=(0,d.Eb)(B)?B.name:B,W=F[K]?.result;let z=N[K]?.result;K===d.hY&&j&&(z=j);const Y=U.current[K];if(Y&&Y.promRules===z&&Y.rulerRules===W)return Y.result;const X={};Object.entries(W||{}).forEach(([G,te])=>{const H={rulesSource:B,name:G,groups:[]};(0,c.lT)(te[0].rules[0])&&(H.uid=te[0].rules[0].grafana_alert.namespace_uid),X[G]=H,h(H,te)}),z?.forEach(({name:G,groups:te})=>{const H=X[G]=X[G]||{rulesSource:B,name:G,groups:[]};y(H,te)});const q=Object.values(X);return U.current[K]={promRules:z,rulerRules:W,result:q},q}).flat(),[N,F,w,j])}function m(O,j,N){const F={};return Object.entries(N||{}).forEach(([U,w])=>{const B={rulesSource:O,name:U,groups:[]};F[U]=B,h(B,w)}),j?.forEach(({name:U,groups:w})=>{const B=F[U]=F[U]||{rulesSource:O,name:U,groups:[]};y(B,w)}),Object.values(F)}function v(O,j,N){const F={rulesSource:O,name:j.name,groups:[]};return h(F,N),y(F,j.groups),F.groups.forEach(U=>{U.rules=U.rules.filter(w=>w.promRule)}),F}function x(O,j,N){return h(O,N),y(O,j),O}function f(O){return O.map(j=>{const N={...j,groups:[]};return N.groups.push({name:"default",rules:E(j.groups.flatMap(F=>F.rules)),totals:C(j.groups)}),N})}function E(O){return O.sort((j,N)=>j.name.localeCompare(N.name))}function h(O,j=[]){O.groups=j.map(N=>{const F=N.rules.filter(B=>(0,c.i7)(B)).length,U=N.rules.filter(B=>(0,c.lT)(B)&&B.grafana_alert.is_paused).length,w={name:N.name,interval:N.interval,source_tenants:N.source_tenants,rules:[],totals:{paused:U,recording:F}};return w.rules=N.rules.map(B=>I(B,O,w)),w})}function y(O,j){const N=new Map;O.groups.forEach(F=>N.set(F.name,F)),j.forEach(F=>{let U=N.get(F.name);U||(U={name:F.name,rules:[],totals:P(F)},O.groups.push(U),N.set(F.name,U)),U.totals={...U.totals,...P(F)};const w=new Map;U.rules.forEach(B=>{const K=w.get(B.name);K?K.push(B):w.set(B.name,[B])}),(F.rules??[]).forEach(B=>{const K=R(B,w,O.rulesSource);K?(K.promRule=B,K.instanceTotals=(0,c.Z8)(B)?b(B):{},K.filteredInstanceTotals=(0,c.Z8)(B)?D(B):{}):U.rules.push(M(B,O,U))})})}function b(O){const j=(0,n.countBy)(O.alerts,"state");if(O.totals){const{normal:N,...F}=O.totals;return{...F,inactive:N}}return{alerting:j[r.$.Alerting]||j.firing,pending:j[r.$.Pending],inactive:j[r.$.Normal],nodata:j[r.$.NoData],error:j[r.$.Error]||j.err||void 0}}function D(O){if(O.totalsFiltered){const{normal:j,...N}=O.totalsFiltered;return{...N,inactive:j}}return{}}function P(O){if(O.totals){const{firing:U,...w}=O.totals;return{...w,alerting:U}}const j=(0,n.countBy)(O.rules,U=>(0,c.Z8)(U)&&U.state),N=(0,n.countBy)(O.rules,U=>U.health),F=O.rules.filter(U=>(0,c.KB)(U)).length;return{alerting:j[i.cF.Firing],error:N.error,nodata:N.nodata,inactive:j[i.cF.Inactive],pending:j[i.cF.Pending],recording:F}}function C(O){const j={};return O.forEach(N=>{const F=N.totals;Object.entries(F).forEach(([U,w])=>{j[U]||(j[U]=0),j[U]+=w})}),j}function M(O,j,N){return{name:O.name,query:O.query,labels:O.labels||{},annotations:(0,c.Z8)(O)?O.annotations||{}:{},promRule:O,namespace:j,group:N,instanceTotals:(0,c.Z8)(O)?b(O):{},filteredInstanceTotals:(0,c.Z8)(O)?D(O):{}}}function I(O,j,N){return(0,c.$y)(O)?{name:O.alert,query:O.expr,labels:O.labels||{},annotations:O.annotations||{},rulerRule:O,namespace:j,group:N,instanceTotals:{},filteredInstanceTotals:{}}:(0,c.i7)(O)?{name:O.record,query:O.expr,labels:O.labels||{},annotations:{},rulerRule:O,namespace:j,group:N,instanceTotals:{},filteredInstanceTotals:{}}:{name:O.grafana_alert.title,query:"",labels:O.labels||{},annotations:O.annotations||{},rulerRule:O,namespace:j,group:N,instanceTotals:{},filteredInstanceTotals:{}}}function R(O,j,N){const F=j.get(O.name);if(!F)return;if((0,d.z2)(N))return F[0];const U=F.find(B=>!B.promRule&&T(B,O,!0));if(U)return U;const w=F.find(B=>!B.promRule&&T(B,O,!1));if(w)return w}function T(O,j,N=!0){return O.name===j.name?(0,n.isEqual)([N?S(O.query):"",O.labels,O.annotations],[N?S(j.query):"",j.labels||{},(0,c.Z8)(j)?j.annotations||{}:{}]):!1}function S(O){return O.length>1&&O[0]==="("&&O[O.length-1]===")"&&(O=O.slice(1,-1)),O=O.replace(/\s|\n/g,""),O.split("").sort().join("")}function L(O,j,N){const{currentData:F,isLoading:U,error:w}=g.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:d.hY,dashboardUid:O??void 0,panelId:j},{skip:O===null,pollingInterval:N?o.HH:void 0}),{currentData:B,isLoading:K,error:W}=g.hK.endpoints.rulerRules.useQuery({rulerConfig:a.$q,filter:{dashboardUID:O??void 0,panelId:j}},{pollingInterval:N?o.HH:void 0,skip:O===null}),z=(0,l.useRef)({}),Y=(0,d.Zw)(d.hY),X=(0,l.useMemo)(()=>{if(!Y)return[];const q=z.current[d.hY];if(q&&q.promRules===F&&q.rulerRules===B)return q.result;const G={};Object.entries(B||{}).forEach(([H,se])=>{const ne={rulesSource:Y,name:H,groups:[]};(0,c.lT)(se[0].rules[0])&&(ne.uid=se[0].rules[0].grafana_alert.namespace_uid),G[H]=ne,h(ne,se)}),F?.forEach(({name:H,groups:se})=>{const ne=G[H]=G[H]||{rulesSource:Y,name:H,groups:[]};y(ne,se)});const te=Object.values(G);return z.current[d.hY]={promRules:F,rulerRules:B,result:te},te},[F,B,Y]);return{loading:U||K,error:w??W,result:X}}},14285:(k,A,e)=>{"use strict";e.d(A,{dI:()=>y,i7:()=>b});var n=e(53076),s=e(1932),l=e(2543),r=e.n(l),i=e(96540),g=e(19347),o=e(94822),d=e(28475),c=e(98164),a=e(55740),p=e(57220),u=e(32642),m=e(23662),v=e(9518),x=e(39964);const f=25,E=1/0,h=S=>S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function y(){const[S,L]=(0,x.l)(),O=S.get("search")??"",j=(0,i.useMemo)(()=>(0,d.XY)(O),[O]),N=(0,i.useMemo)(()=>Object.values(j).some(w=>!(0,l.isEmpty)(w)),[j]),F=(0,i.useCallback)(w=>{const B=(0,d.kL)(O,w);L({search:B})},[O,L]),U=(0,i.useCallback)(w=>{L({search:w})},[L]);return(0,i.useEffect)(()=>{const w={dataSource:S.get("dataSource")??void 0,alertState:S.get("alertState")??void 0,ruleType:S.get("ruleType")??void 0,labels:(0,u.S6)(S.get("queryString")??"").map(c.MU)};Object.values(w).some(K=>!(0,l.isEmpty)(K))&&(L({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),F((0,s.jM)(j,K=>{if(K.dataSourceNames??=w.dataSource?[w.dataSource]:[],w.alertState&&(0,o.Si)(w.alertState)&&(K.ruleState??=w.alertState),w.ruleType&&(0,m.nf)(w.ruleType)&&(K.ruleType??=w.ruleType),K.labels.length===0&&w.labels.length>0){const W=w.labels.map(({name:z,operator:Y,value:X})=>`${z}${Y}${X}`);K.labels.push(...W)}})))},[S,F,j,L]),{filterState:j,hasActiveFilters:N,searchQuery:O,setSearchQuery:U,updateFilters:F}}const b=(S,L)=>(0,i.useMemo)(()=>{const O=D(S,L);return O.forEach(j=>{j.groups.forEach(N=>{N.rules.forEach(F=>{(0,m.Z8)(F.promRule)&&(F.instanceTotals=(0,v.Ug)(F.promRule),F.filteredInstanceTotals=(0,v.NW)(F.promRule))}),N.totals=(0,v.Tj)({rules:N.rules.map(F=>F.promRule).filter(F=>!!F)})})}),O},[S,L]),D=(S,L={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let O=S;const j=L.dataSourceNames;j.length&&(O=O.filter(({rulesSource:F})=>(0,p.Eb)(F)?j.includes(F.name):!0));const N=L.namespace;if(N){const F=O.map(z=>z.name),U=h(N),w=R(N),[B,K,W]=w.search(F,U,M(N),E);K&&W?O=W.map(z=>O[K.idx[z]]):B&&(O=B.map(z=>O[z]))}return O.reduce(P(L),[])},P=S=>(L,O)=>{const j=S.groupName;let N=O.groups;if(j){const F=N.map(z=>z.name),U=R(j),w=h(j),[B,K,W]=U.search(F,w,M(j),E);K&&W?N=W.map(z=>N[K.idx[z]]):B&&(N=B.map(z=>N[z]))}return N=N.reduce(C(S),[]),N.length&&L.push({...O,groups:N}),L},C=S=>{const L=S.ruleName??S.freeFormWords.join(" ");return(O,j)=>{let N=j.rules;if(L){const F=N.map(z=>z.name),U=R(L),w=h(L),[B,K,W]=U.search(F,w,M(L),E);K&&W?N=W.map(z=>N[K.idx[z]]):B&&(N=B.map(z=>N[z]))}return N=N.filter(F=>{const U=F.promRule,w=(0,l.chain)(S).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins"]).omitBy(l.isEmpty).mapValues(()=>!1).value();if("ruleType"in w&&S.ruleType===U?.type&&(w.ruleType=!0),"plugins"in w&&S.plugins==="hide"&&(w.plugins=!(0,m.Tm)(F)),"dataSourceNames"in w&&((0,m.lT)(F.rulerRule)?T(F.rulerRule,S)&&(w.dataSourceNames=!0):w.dataSourceNames=!0),"ruleHealth"in S&&U){const B=(0,m.f6)(U.health);S.ruleHealth===B&&(w.ruleHealth=!0)}if("labels"in w){const B=(0,l.compact)(S.labels.map(I)),K=B.length>0&&(0,c.Av)(F.labels,B),W=B.length>0&&U&&U.type===o.JS.Alerting&&U.alerts&&U.alerts.some(z=>(0,c.Av)(z.labels,B));(K||W)&&(w.labels=!0)}if("ruleState"in w){const B=F.promRule;B&&(0,m.Z8)(B)&&B.state===S.ruleState&&(w.ruleState=!0)}return"dashboardUid"in w&&F.annotations[a.YH.dashboardUID]===S.dashboardUid&&(w.dashboardUid=!0),Object.values(w).every(B=>B===!0)}),N.length&&O.push({...j,rules:N}),O}};function M(S){return R(S).split(S).length<5?4:0}function I(S){try{return(0,u.qR)(S)}catch{return{name:S,value:"",isRegex:!0,isEqual:!0}}}function R(S){const L=S.length>f;return new n.A({intraMode:L?0:1,interSplit:"\\s+"})}const T=(S,L)=>L.dataSourceNames?.length?!!S.grafana_alert.data.find(O=>{if(!O.datasourceUid)return!1;const j=(0,g.l)().getInstanceSettings(O.datasourceUid);return j?.name&&L?.dataSourceNames?.includes(j.name)}):!0},11167:(k,A,e)=>{"use strict";e.d(A,{a:()=>g});var n=e(96540),s=e(31678),l=e(23770),r=e(88467),i=e(61410);function g(o){const d=(0,s.useDispatch)(),c=(0,i.$)(a=>a.folders);if((0,n.useEffect)(()=>{o&&d((0,l.Om)(o))},[d,o]),o){const a=c[o]||r.jA;return{folder:a.result,loading:a.loading}}return{loading:!1}}},83903:(k,A,e)=>{"use strict";e.d(A,{y:()=>r});var n=e(96540),s=e(57220),l=e(61410);function r(){const i=(0,l.$)(d=>d.rulerRules),g=(0,n.useCallback)(d=>{const c=typeof d=="string"?d:d.name;return c===s.hY||!!i[c]?.result},[i]),o=(0,n.useCallback)(d=>{const c=(0,s.EV)(d);return!!i[c]?.result},[i]);return{hasRuler:g,rulerRulesLoaded:o}}},97009:(k,A,e)=>{"use strict";e.d(A,{g:()=>o});var n=e(16233),s=e(77583),l=e(75471),r=e(23662),i=e(11167),g=e(61410);function o(d,c){const a=(0,g.$)(b=>b.dataSources),{currentData:p,isLoading:u}=s.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:d}),m=c&&(0,r.lT)(c)?c.grafana_alert.namespace_uid:void 0,v=(0,l.Wd)(d),{folder:x,loading:f}=(0,i.a)(m);if(!c)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,r.lT)(c)){if(!m)throw new Error(`Rule ${c.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!x)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:f};const b=n.TP.hasPermissionInMetadata(v.update,x),D=n.TP.hasPermissionInMetadata(v.delete,x);return{isRulerAvailable:!0,isEditable:b,isRemovable:D,loading:f||u}}const E=!!a[d]?.result?.rulerConfig||!!p?.rulerConfig,h=n.TP.hasPermission(v.update),y=n.TP.hasPermission(v.delete);return{isRulerAvailable:E,isEditable:h&&E,isRemovable:y&&E,loading:u||a[d]?.loading}}},98439:(k,A,e)=>{"use strict";e.d(A,{W:()=>r});var n=e(2543),s=e.n(n),l=e(96540);function r(i,g=1,o){const[d,c]=(0,l.useState)(g),a=(0,l.useMemo)(()=>(0,n.chunk)(i,o),[i,o]),p=a.length,u=a[d-1]??[],m=(d-1)*o+1,v=(0,n.clamp)(d*o,i.length),x=(0,l.useCallback)(h=>{c((0,n.clamp)(h,1,a.length))},[c,a]),f=(0,l.useCallback)(()=>x(d+1),[d,x]),E=(0,l.useCallback)(()=>x(d-1),[d,x]);return(0,l.useEffect)(()=>c(1),[p]),{page:d,onPageChange:x,numberOfPages:p,pageItems:u,pageStart:m,pageEnd:v,nextPage:f,previousPage:E}}},27747:(k,A,e)=>{"use strict";e.d(A,{S:()=>s});var n=e(9518);function s({dashboardUID:l,panelId:r,poll:i=!1}){const{result:g,loading:o,error:d}=(0,n.kU)(l,r,i);return{rules:g?g.flatMap(a=>a.groups).flatMap(a=>a.rules):[],errors:d?[d]:[],loading:o}}},12210:(k,A,e)=>{"use strict";e.d(A,{_:()=>l});var n=e(16817),s=e(27716);function l(r){const{loading:i,error:g,value:o}=(0,n.A)(()=>(0,s.x)(r,{showErrorAlert:!1})),d=o&&!g&&!i,c=o?.enabled;return i&&!o?{loading:!0}:!d||!c?{loading:!1,installed:!1}:{loading:i,installed:!0,settings:o}}},46013:(k,A,e)=>{"use strict";e.d(A,{G:()=>a,Q:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(37390);const o=(0,l.lazy)(()=>e.e(7409).then(e.bind(e,87409))),d=(0,l.lazy)(()=>e.e(285).then(e.bind(e,285)));var c=(u=>(u.Loki="loki",u.Annotations="annotations",u))(c||{});function a(){const[u,m]=(0,l.useState)(!1),[v,x]=(0,l.useState)(),f=(0,i.of)(p),E=r.$.unifiedAlerting.alertStateHistoryBackend,h=r.$.unifiedAlerting.alertStateHistoryPrimary,b=[E,h].some(M=>M==="loki")?"loki":"annotations",D=(0,l.useCallback)(()=>{x(void 0),m(!1)},[]),P=(0,l.useCallback)(M=>{x(M),m(!0)},[]);return{StateHistoryModal:(0,l.useMemo)(()=>v?(0,n.jsx)(g.a,{isOpen:u,onDismiss:D,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:f.modal,contentClassName:f.modalContent,children:(0,n.jsxs)(l.Suspense,{fallback:"Loading...",children:[b==="loki"&&(0,n.jsx)(d,{ruleUID:v.grafana_alert.uid}),b==="annotations"&&(0,n.jsx)(o,{alertId:v.grafana_alert.id??""})]})}):null,[v,u,D,b,f]),showStateHistoryModal:P,hideStateHistoryModal:D}}const p=u=>({modal:(0,s.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,s.css)({height:"100%",width:"100%",padding:u.spacing(2)})})},39964:(k,A,e)=>{"use strict";e.d(A,{l:()=>r});var n=e(96540),s=e(24180),l=e(39601);function r(){const{search:i}=(0,s.zy)(),g=(0,n.useMemo)(()=>new URLSearchParams(i),[i]),o=(0,n.useCallback)((d,c)=>{l.Ny.partial(d,c)},[]);return[g,o]}},61410:(k,A,e)=>{"use strict";e.d(A,{$:()=>l});var n=e(25508),s=e(31678);function l(r,i){return(0,s.useSelector)((0,n.Mz)(g=>g.unifiedAlerting,g=>r(g)),i)}},85244:(k,A,e)=>{"use strict";e.d(A,{T:()=>g});var n=e(74848),s=e(16817),l=e(39938),r=e(56034),i=e(27716);function g({pluginId:o}){const{value:d}=(0,s.A)(()=>(0,i.x)(o)),c=d?.info.logos?.small,a=c?(0,n.jsx)("img",{src:c,alt:d?.name,style:{width:"20px",height:"20px"}}):(0,n.jsx)(l.E,{text:o,color:"orange"}),p=d?`This rule is managed by the ${d?.name} plugin`:"This rule is managed by a plugin";return(0,n.jsx)(r.m,{content:p,children:(0,n.jsx)("div",{children:a})})}},48070:(k,A,e)=>{"use strict";e.d(A,{KH:()=>c,KL:()=>u,LH:()=>d,fO:()=>p,i3:()=>x,lF:()=>a});var n=e(65307),s=e(2543),l=e.n(s),r=e(18461),i=e(23662);const g=(0,n.VP)("ruleGroup/rules/add"),o=(0,n.VP)("ruleGroup/rules/update"),d=(0,n.VP)("ruleGroup/rules/pause"),c=(0,n.VP)("ruleGroup/rules/delete"),a=(0,n.VP)("ruleGroup/update"),p=(0,n.VP)("ruleGroup/move"),u=(0,n.VP)("ruleGroup/rename"),m=(0,n.VP)("ruleGroup/rules/reorder"),v={name:"initial",rules:[]},x=(0,n.vy)(v,f=>{f.addCase(g,()=>{throw new Error("not yet implemented")}).addCase(o,()=>{throw new Error("not yet implemented")}).addCase(c,(E,{payload:h})=>{const{rule:y}=h;if((0,i.lT)(y)){const b=y.grafana_alert.uid;(0,s.remove)(E.rules,D=>(0,i.lT)(D)&&D.grafana_alert.uid===b)}if((0,i.Mt)(y)){const b=(0,r.Ns)(y);(0,s.remove)(E.rules,D=>(0,i.Mt)(D)&&(0,r.Ns)(D)===b)}}).addCase(d,(E,{payload:h})=>{const{uid:y,pause:b}=h;let D=!1;for(const P of E.rules)if((0,i.lT)(P)&&P.grafana_alert.uid===y){D=!0,P.grafana_alert.is_paused=b;break}if(!D)throw new Error(`No rule with UID ${y} found in group ${E.name}`)}).addCase(m,()=>{throw new Error("not yet implemented")}).addMatcher((0,n.i0)(u,p),(E,{payload:h})=>{const{groupName:y}=h;y&&(E.name=y)}).addMatcher((0,n.i0)(a,u,p),(E,{payload:h})=>{const{interval:y}=h;y&&(E.interval=y)}).addDefaultCase((E,h)=>{throw new Error(`Unknown action for rule group reducer: ${h.type}`)})})},28475:(k,A,e)=>{"use strict";e.d(A,{Jc:()=>z,kL:()=>X,XY:()=>Y});var n=e(94822),s=e(23662);const l=1,r=2,i=3,g=4,o=5,d=6,c=7,a=8,p=9,u=10,m=11,v=12,x=13,f=14,E=0,h=1,y=2,b=3,D=4,P=5,C=6,M=7,I=8,R=9;var T=e(2543),S=e(48820);const L=S.U1.deserialize({version:14,states:"!vOQOPOOOxOPO'#CjOOOO'#Cj'#CjOQOPO'#CnOOOO'#Ck'#CkQQOPOOO!sOQO'#C^O!xOPO'#ClO!}OPO,59UOOOO,59Y,59YOOOO-E6i-E6iOOOO,58x,58xOOOO,59W,59WOOOO-E6j-E6j",stateData:"$h~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UOcPOeQO~OdVOR^XT^XU^XV^XW^XX^XY^XZ^X[^X]^Xc^Xe^X~OSZO~Oc[O~OdVOR^aT^aU^aV^aW^aX^aY^aZ^a[^a]^ac^ae^a~OR~T~U~V~W~Y~Z~[~]~R][ZYXWVUTc~",goto:"|cPPdPPPPPPPPPPPdioPuVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken FreeFormExpression",maxTerm:21,skippedNodes:[0],repeatNodeCount:2,tokenData:"#<RRRsqr#`rs&lst#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]+n!]#W#`#W#X-Q#X#Z#`#Z#[Ig#[#]!$a#]#`#`#`#a!.s#a#b#`#b#c!7m#c#d#`#d#e!Fk#e#f#`#f#g#$g#g#h#+w#h#i#4q#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#gcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`Q$wcSQqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rQ&VP;=`<%l$rQ&]P;=`;NQ$rR&cP;=`<%l#`R&iP;=`;NQ#`R&orX^(ypq(yqr(yst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR(|sX^(ypq(yqr(yrs+Zst(ytu(yuv(yvw(ywx(yxy(yyz(yz{(y{|(y|!P(y!P!Q(y!Q![(y![!](y!]#y(y#y#z(y#z$f(y$f$g(y$g#BY(y#BY#BZ(y#BZ$Ch(y$IS$I_(y$I|$JO(y$JT$JU(y$JU$KV(y$KV$KW(y$KW&FU(y&FU&FV(y&FV;'S(y;'S;(d+b;(d;(e+h<%lO(yR+bOSQePR+eP;=`<%l(yR+kP;=`;NQ(yR+ucSQdPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR-XeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U.j#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R.qfSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h0V#h#i<R#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R0^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]1o#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R1veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V3X#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R3`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d4q#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U6Z#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#g7s#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#W#`#W#X9]#X$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R:vcSQ[Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR<YeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U=k#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R=reSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h?T#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R?[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#d@m#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R@teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jBV#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RB^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gCo#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RCveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#WEX#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RE`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#YFq#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RFxcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]HT!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RH[cSQRPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rRIneSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#f#`#f#gKP#g$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RKWeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#c#`#c#dLi#d$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RLpeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#jNR#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`RNYeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e! k#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R! rcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!!}!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!#UcSQVPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!$heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!%y#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!&QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!'c#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!'jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!({#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!)SeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i!*e#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!*leSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#[#`#[#]!+}#]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!,UcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!-a!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!-hcSQZPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!.zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!0]#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!0deSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#U#`#U#V!1u#V$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!1|eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!3_#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!3feSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!4w#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!5OcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!6Z!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!6bcSQUPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!7teSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!9V#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!9^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#a#`#a#b!:o#b$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!:veSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!<X#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!<`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h!=q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!=xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e!?Z#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!?beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U!@s#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!@zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#V#`#V#W!B]#W$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!BdeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y!Cu#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!C|cSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]!EX!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!E`cSQTPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR!FreSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a!HT#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!H[eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j!Im#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!IteSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#Z#`#Z#[!KV#[$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!K^eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#]#`#]#^!Lo#^$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!LveSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#b#`#b#c!NX#c$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R!N`eSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#g#`#g#h# q#h$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R# xcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]##T!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R##[cSQ]Pqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#$neSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#i#`#i#j#&P#j$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#&WeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#`#`#`#a#'i#a$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#'peSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#)R#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#)YcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#*e!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#*lcSQWPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#,OeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#-a#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#-heSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#T#`#T#U#.y#U$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#/QeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#h#`#h#i#0c#i$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#0jeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#1{#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#2ScSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#3_!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#3fcSQXPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$rR#4xeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#m#`#m#n#6Z#n$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#6beSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#d#`#d#e#7s#e$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#7zeSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]$r!]#X#`#X#Y#9]#Y$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#9dcSQcPqr#`st#`tu#`uv#`vw#`wx#`xy#`yz#`z{#`{|#`|!P#`!P!Q#`!Q![#`![!]#:o!]$Ch#`$JU;'S#`;'S;(d&`;(d;(e&f<%lO#`R#:vcSQYPqr$rst$rtu$ruv$rvw$rwx$rxy$ryz$rz{$r{|$r|!P$r!P!Q$r!Q![$r![!]$r!]$Ch$r$JU;'S$r;'S;(d&S;(d;(e&Y<%lO$r",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:132,nameSpaceFilter:134,labelFilter:136,groupFilter:138,ruleFilter:140,stateFilter:78,typeFilter:142,healthFilter:144,dashboardFilter:146,pluginsFilter:148},tokenPrec:150}),O={[i]:"datasource",[o]:"namespace",[d]:"label",[a]:"rule",[c]:"group",[p]:"state",[u]:"type",[m]:"health",[v]:"dashboard",[x]:"plugins"};var j=(G=>(G.dataSource="dataSourceFilter",G.nameSpace="nameSpaceFilter",G.label="labelFilter",G.group="groupFilter",G.rule="ruleFilter",G.state="stateFilter",G.type="typeFilter",G.health="healthFilter",G.dashboard="dashboardFilter",G.plugins="pluginsFilter",G))(j||{});function N(G,te,H){B(G,te,se=>{if(se.type.id===r){const ne=F(G,se);if(ne.type&&ne.value){const le=H[ne.type];le&&le(ne.value)}}else if(se.type.id===f){const ne=H[f];ne&&ne(U(G,se))}})}function F(G,te){if(te.type.id!==r)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const H=te.firstChild;if(!H)return{type:void 0,value:void 0};const se=te.getChild(g),ne=se?(0,T.trim)(U(G,se),'"'):void 0;return{type:H.type.id,value:ne}}function U(G,te){return G.slice(te.from,te.to).trim().replace(/\"/g,"")}function w(G,te,H){const se=[];B(G,te,le=>{le.type.id===r&&le.firstChild&&se.push(le.firstChild),le.type.id===f&&se.push(le)});const ne=[];return se.forEach(le=>{const _=H.findIndex(Q=>Q.type===le.type.id);if(_!==-1){if(le.parent?.type.is(r)){const Q=O[le.type.id],ae=H.splice(_,1)[0];ne.push(`${Q}:${K(ae.value)}`)}if(le.type.is(f)){const Q=H.splice(_,1)[0];ne.push(Q.value)}}}),H.forEach(le=>{le.type===f?ne.push(le.value):ne.push(`${O[le.type]}:${K(le.value)}`)}),ne.join(" ")}function B(G,te,H){const se=te.join(" "),le=L.configure({dialect:se}).parse(G).cursor();do H(le.node);while(le.next())}function K(G){return/\s/.test(G)?`"${G}"`:G}const W=[j.dataSource,j.nameSpace,j.label,j.group,j.rule,j.state,j.type,j.health,j.dashboard,j.plugins];var z=(G=>(G.Ok="ok",G.Error="error",G.NoData="nodata",G.Unknown="unknown",G))(z||{});function Y(G){const te={labels:[],freeFormWords:[],dataSourceNames:[]},H={[i]:se=>te.dataSourceNames.push(se),[o]:se=>te.namespace=se,[c]:se=>te.groupName=se,[a]:se=>te.ruleName=se,[d]:se=>te.labels.push(se),[p]:se=>te.ruleState=q(se),[u]:se=>(0,s.nf)(se)?te.ruleType=se:void 0,[m]:se=>te.ruleHealth=(0,s.f6)(se),[v]:se=>te.dashboardUid=se,[x]:se=>te.plugins=se==="hide"?se:void 0,[f]:se=>te.freeFormWords.push(se)};return N(G,W,H),te}function X(G,te){const H=[];return te.dataSourceNames&&H.push(...te.dataSourceNames.map(se=>({type:i,value:se}))),te.namespace&&H.push({type:o,value:te.namespace}),te.groupName&&H.push({type:c,value:te.groupName}),te.ruleName&&H.push({type:a,value:te.ruleName}),te.ruleState&&H.push({type:p,value:te.ruleState}),te.ruleType&&H.push({type:u,value:te.ruleType}),te.ruleHealth&&H.push({type:m,value:te.ruleHealth}),te.labels&&H.push(...te.labels.map(se=>({type:d,value:se}))),te.dashboardUid&&H.push({type:v,value:te.dashboardUid}),te.plugins&&H.push({type:x,value:te.plugins}),te.freeFormWords&&H.push(...te.freeFormWords.map(se=>({type:f,value:se}))),w(G,W,H)}function q(G){if(G==="normal")return n.cF.Inactive;if((0,n.Si)(G))return G}},28318:(k,A,e)=>{"use strict";e.d(A,{t:()=>L});var n=e(2543),s=e(39741),l=e(62467),r=e(66847),i=e(1005),g=e(81160),o=e(62938),d=e(39070),c=e(14236),a=e(72495),p=e(65879),u=e(43127),m=e(89667),v=e(19347),x=e(26657),f=e(12091),E=e(27677),h=e(69437),y=e(81583),b=e(72955),D=e(66718);const P={from:21600,to:0},C=(B,K)=>{const W=M(B,K);if(!W)return P;const{from:z,to:Y}=R(W,K);return!z.length&&!Y.length?P:{from:Math.max(...z),to:Math.min(...Y)}},M=(B,K)=>{switch(B.type){case D.Tz.classic:return I(B);case D.Tz.math:case D.Tz.sql:return T(B,K);case D.Tz.resample:case D.Tz.reduce:case D.Tz.threshold:return S(B)}},I=B=>B.conditions?.map(K=>K.query.params[0]),R=(B,K)=>{const W=[],z=[P.to];for(const Y of B){const X=K.find(q=>q.refId===Y);!X||!X.relativeTimeRange||(W.push(X.relativeTimeRange.from),z.push(X.relativeTimeRange.to))}return{from:W,to:z}},T=(B,K)=>K.filter(W=>W.queryType==="query"&&B.expression?.includes(W.refId)).map(W=>W.refId),S=B=>B.expression?[B.expression]:void 0;class L{constructor(K=(0,E.AI)(),W=(0,v.l)()){this.backendSrv=K,this.dataSourceSrv=W,this.subject=new s.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(K,W){const z=j(K,d.Gu.Done),Y=[];for(const q of K){const G=q.model.refId;if((0,h.f)(q.model))continue;const te=await this.dataSourceSrv.get(q.datasourceUid);te instanceof x.iy&&te.filterQuery&&!te.filterQuery(q.model)&&Y.push(G)}const X=(0,n.reject)(K,q=>Y.includes(q.model.refId));if(X.length===0)return this.subject.next(z);this.subscription=O(this.backendSrv,X,W).subscribe({next:q=>{const G=w(q,(te,H)=>{const se=this.lastResult[te],ne=(0,c.N$)(H,se);return(0,b.B)(ne,se)});this.lastResult=G,this.subject.next(this.lastResult)},error:q=>{this.lastResult=U(this.lastResult,q),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let K=!1;const W=w(this.lastResult,(z,Y)=>(Y.state===d.Gu.Loading&&(K=!0),{...Y,state:d.Gu.Done}));K&&this.subject.next(W)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const O=(B,K,W)=>{const z=j(K,d.Gu.Loading),Y={data:{data:K,condition:W},url:"/api/v1/eval",method:"POST",requestId:(0,o.A)()};return(0,a.k)({whileLoading:z,source:B.fetch(Y).pipe(F(z),(0,r.W)(X=>(0,l.of)(U(z,X))),(0,y.N)(B,Y.requestId),(0,i.u)())})},j=(B,K)=>B.reduce((W,z)=>(W[z.refId]={state:K,series:[],timeRange:N(z,B)},W),{}),N=(B,K)=>{if((0,h.f)(B.model)){const W=C(B.model,K);return p.relativeToTimeRange(W)}return B.relativeTimeRange?p.relativeToTimeRange(B.relativeTimeRange):(console.warn(`Query with refId: ${B.refId} did not have any relative time range, using default.`),(0,u.E2)())},F=B=>(0,g.T)(K=>{const{data:W}=K,z={};for(const[Y,X]of Object.entries(W.results)){const{error:q,status:G,frames:te=[]}=X,H=q?[{message:q,refId:Y,status:G}]:[];z[Y]={errors:H,timeRange:B[Y].timeRange,state:d.Gu.Done,series:te.map(m.or)}}return z}),U=(B,K)=>{const W=(0,f.u)(K);return w(B,(z,Y)=>({...Y,state:d.Gu.Error,error:W}))},w=(B,K)=>{const W={};for(const[z,Y]of Object.entries(B))W[z]=K(z,Y);return W}},70383:(k,A,e)=>{"use strict";e.d(A,{Kh:()=>v,VI:()=>p,b9:()=>a});var n=e(74848),s=e(96540),l=e(33390),r=e(60021),i=e(62190),g=e(39964),o=e(55740),d=e(57220);const c=s.createContext(void 0),a=({children:x,accessType:f,alertmanagerSourceName:E})=>{const[h,y]=(0,g.l)(),b=(0,i.W)(f),D=b.availableInternalDataSources.concat(b.availableExternalDataSources),P=s.useCallback(F=>{u(D,F)&&(F===d.hY?(l.A.delete(o.Oq),y({[o.DD]:void 0})):(l.A.set(o.Oq,F),y({[o.DD]:F})))},[D,y]),C=h.get(o.DD),M=l.A.get(o.Oq),I=d.hY;s.useEffect(()=>{C&&C!==M&&l.A.set(o.Oq,C)},[C,M]);const R=E??C??M??I,T=u(D,R)?R:void 0,S=(0,d.r3)(T)?.jsonData,L=T===d.hY,O=S?v(S):!1,N={selectedAlertmanager:T,hasConfigurationAPI:L||O,isGrafanaAlertmanager:L,selectedAlertmanagerConfig:S,availableAlertManagers:D,setSelectedAlertmanager:P};return(0,n.jsx)(c.Provider,{value:N,children:x})};function p(){const x=s.useContext(c);if(x===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return x}function u(x,f){return x.map(h=>h.name).includes(f)}const m=[r.Oz.mimir,r.Oz.cortex,void 0];function v(x){return m.includes(x.implementation)}},23770:(k,A,e)=>{"use strict";e.d(A,{nO:()=>se,$8:()=>ne,g6:()=>K,D3:()=>H,yo:()=>w,wE:()=>F,nV:()=>B,Tp:()=>G,Om:()=>te,JH:()=>Y,Lc:()=>j,mB:()=>L,eB:()=>O,HB:()=>N,DC:()=>U,Qt:()=>S,uQ:()=>_,_$:()=>W,bO:()=>le,RW:()=>X,DN:()=>Q});var n=e(65307),s=e(2543),l=e(39601),r=e(34867),i=e(94822),g=e(27677),o=e(25027),d=e(79938),c=e(32415),a=e(82843),p=e(17172);function u(ae){return(0,p.AI)().get("/api/annotations",{alertId:ae}).then(oe=>oe?.sort(m))}function m(ae,oe){const J=(xe,re)=>xe>re?-1:re>xe?1:0,ee=J(ae.timeEnd,oe.timeEnd);if(ee)return ee;const de=J(ae.time,oe.time);return de||J(ae.id,oe.id)}var v=e(92240),x=e(49498),f=e(28220),E=e(98164),h=e(57220),y=e(56361),b=e(88467),D=e(18461),P=e(63066),C=e(23662);function M(ae){const oe=async Te=>{if((0,C.A4)(Te)){const ge=await(0,f.iy)(ae);for(const[Oe,Ue]of Object.entries(ge))for(const Xe of Ue){const we=Xe.rules.find(qe=>(0,C.lT)(qe)&&qe.grafana_alert?.uid===Te.uid);if(we)return{group:Xe,ruleSourceName:h.hY,namespace:Oe,namespace_uid:(0,C.lT)(we)&&we.grafana_alert.namespace_uid||void 0,rule:we}}}if((0,C.X4)(Te)){const{ruleSourceName:ge,namespace:Oe,groupName:Ue}=Te,Xe=await(0,f.HO)(ae,Oe,Ue);if(!Xe)return null;const we=Xe.rules.find(qe=>{const We=D.P1(ge,Oe,Xe.name,qe);return D.LC(We,Te)});return we?{group:Xe,ruleSourceName:ge,namespace:Oe,rule:we}:null}if((0,C.Mj)(Te))throw new Error("Native prometheus rules can not be edited in grafana.");return null},J=async Te=>{const{namespace:ge,group:Oe,rule:Ue,namespace_uid:Xe}=Te;if(Oe.rules.length===1){await(0,f.AJ)(ae,Xe||ge,Oe.name);return}await(0,f.E8)(ae,Xe||ge,{...Oe,rules:Oe.rules.filter(we=>we!==Ue)})},ee=async(Te,ge,Oe)=>{const{dataSourceName:Ue,group:Xe,namespace:we}=Te,qe=(0,P.l1)(Te);if(Ue&&Xe&&we){if(Oe){const je=await oe(D.Yd(Oe));if(!je)throw new Error("Rule not found.");if(je.namespace!==we||je.group.name!==Xe)await J(je);else{const Ke={...je.group,rules:je.group.rules.map(_e=>_e===je.rule?qe:_e),evaluateEvery:ge};return await(0,f.E8)(ae,we,Ke),D.P1(Ue,we,Xe,qe)}}const We=await(0,f.HO)(ae,we,Xe),Ce=We?{...We,rules:[...We.rules,qe]}:{name:Xe,rules:[qe]};return await(0,f.E8)(ae,we,Ce),D.P1(Ue,we,Xe,qe)}else throw new Error("Data source and location must be specified")},de=async(Te,ge,Oe)=>{const{folder:Ue,group:Xe}=Te;if(!Ue)throw new Error("Folder must be specified");const we=(0,P.Z9)(Te),qe=Ue.uid,We={name:Xe,interval:ge};if(!Oe)return xe(qe,We,we);const Ce=await oe(D.Yd(Oe));if(!Ce)throw new Error("Rule not found.");const je=Ce.namespace_uid===qe,Ke=Ce.group.name===Te.group;return je&&Ke?ue(Ce,we,ge):re(qe,We,Ce,we)},xe=async(Te,ge,Oe)=>{const Ue=await(0,f.HO)(ae,Te,ge.name);if(!Ue)throw new Error(`No group found with name "${ge.name}"`);const Xe={name:ge.name,interval:ge.interval,rules:(Ue.rules??[]).concat(Oe)};return await(0,f.E8)(ae,Te,Xe),{uid:Oe.grafana_alert.uid??"",ruleSourceName:h.hY}},re=async(Te,ge,Oe,Ue)=>(I(Oe,Ue),await xe(Te,ge,Ue)),ue=async(Te,ge,Oe)=>{I(Te,ge);const Ue=Te.group.rules.map(Xe=>(0,C.lT)(Xe)&&Xe.grafana_alert.uid===Te.rule.grafana_alert.uid?ge:Xe);return await(0,f.E8)(ae,Te.namespace_uid??"",{name:Te.group.name,interval:Oe,rules:Ue}),{uid:Te.rule.grafana_alert.uid,ruleSourceName:h.hY}};return{findEditableRule:oe,deleteRule:J,saveLotexRule:ee,saveGrafanaRule:de}}function I(ae,oe){if(!(0,C.lT)(ae.rule))throw new Error("The rule is not a Grafana managed rule");const J=ae.rule.grafana_alert.uid;oe.grafana_alert.uid=J}var R=e(25968);function T(ae,oe){const J=ae().unifiedAlerting.dataSources,ee=J[oe]?.result,de=J[oe]?.error;if(!ee){const xe=new Error(`Data source configuration is not available for "${oe}" data source`);throw de&&(xe.cause=de),xe}return ee}function S(ae,oe){const J=T(ae,oe);if(!J.rulerConfig)throw new Error(`Ruler API is not available for ${oe}`);return J.rulerConfig}const L=(0,n.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:ae,filter:oe,limitAlerts:J,matcher:ee,state:de,identifier:xe},re)=>{await re.dispatch(U({rulesSourceName:ae}));const ue=(0,o.U7)("unifiedalerting/fetchPromRules",x.sA,{dataSourceName:ae,thunk:"unifiedalerting/fetchPromRules"});return await(0,b.$I)(ue(ae,oe,J,ee,de,xe))}),O=(0,n.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:ae,filter:oe},{dispatch:J,getState:ee})=>{await J(U({rulesSourceName:ae}));const de=S(ee,ae),xe=(0,o.Ke)("unifiedalerting/fetchRulerRules",f.iy,{dataSourceName:ae,thunk:"unifiedalerting/fetchRulerRules"});return await(0,b.$I)(xe(de,oe))});function j({rulesSourceName:ae,identifier:oe,filter:J,limitAlerts:ee,matcher:de,state:xe}){return async(re,ue)=>{await re(U({rulesSourceName:ae}));const Te=T(ue,ae);await re(L({rulesSourceName:ae,identifier:oe,filter:J,limitAlerts:ee,matcher:de,state:xe})),Te.rulerConfig&&await re(O({rulesSourceName:ae}))}}function N(ae){return(oe,J)=>{const{rulerRules:ee}=J().unifiedAlerting,de=ee[ae];(0,s.isEmpty)(de?.result)&&!(de&&(0,C.$7)(de))&&!de?.loading&&oe(O({rulesSourceName:ae}))}}function F(){return async ae=>{const oe=(0,h.gR)().map(J=>ae(U({rulesSourceName:J})));await Promise.allSettled(oe)}}const U=(0,n.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:ae})=>(0,b.$I)((async()=>{if(ae===h.hY)return{name:h.hY,id:h.hY,rulerConfig:{dataSourceName:h.hY,apiVersion:"legacy"}};const oe=(0,h.Jz)(ae);if(!oe)throw new Error(`Missing data source configuration for ${ae}`);const{id:J,name:ee}=oe,xe=await(0,o.QA)("unifiedalerting/fetchPromBuildinfo",v.nD,{dataSourceName:ae,thunk:"unifiedalerting/fetchPromBuildinfo"})(ee),re=xe.features.rulerApiEnabled?{dataSourceName:ee,apiVersion:xe.application===i.N1.Cortex?"legacy":"config"}:void 0;return{name:ee,id:J,rulerConfig:re}})()),{condition:({rulesSourceName:ae},{getState:oe})=>{const J=oe().unifiedAlerting.dataSources,ee=!!J[ae]?.result,de=!!J[ae]?.error;return!(ee||de)}});function w(ae=!1,oe={}){return async(J,ee)=>{const de=performance.now();await Promise.allSettled((0,h.gR)().map(async xe=>{await J(U({rulesSourceName:xe}));const{promRules:re,rulerRules:ue,dataSources:Te}=ee().unifiedAlerting,ge=Te[xe].result;if(!ge)return;const Oe=ae||!re[xe]?.loading,Ue=(ae||!ue[xe]?.loading)&&!!ge.rulerConfig;await Promise.allSettled([Oe&&J(L({rulesSourceName:xe,...oe})),Ue&&J(O({rulesSourceName:xe}))])})),(0,r.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-de})}}function B(ae=!1){return async(oe,J)=>{const{promRules:ee}=J().unifiedAlerting;(0,h.gR)().map(de=>{(ae||!ee[de]?.loading)&&oe(L({rulesSourceName:de}))})}}function K(ae,oe){return async(J,ee)=>{(0,b.v5)((async()=>{const de=(0,h.EV)(ae.rulesSource),xe=S(ee,de);await(0,f.AJ)(xe,ae.name,oe.name),await J(j({rulesSourceName:de}))})(),{successMessage:"Group deleted"})}}const W=(0,n.zD)("unifiedalerting/saveRuleForm",({values:ae,existing:oe,redirectOnSave:J,evaluateEvery:ee},de)=>(0,b.v5)((0,b.$I)((async()=>{const{type:xe}=ae;if(!xe)return;let re;if((0,C.s_)(xe)){if(!ae.dataSourceName)throw new Error("The Data source has not been defined.");const ue=S(de.getState,ae.dataSourceName);re=await M(ue).saveLotexRule(ae,ee,oe),await de.dispatch(O({rulesSourceName:ae.dataSourceName}))}else if((0,C.H2)(xe)){const ue=S(de.getState,h.hY);re=await M(ue).saveGrafanaRule(ae,ee,oe),z(ae,oe),de.dispatch(d.hK.util.invalidateTags([{type:"GrafanaRulerRule",id:re.uid}]))}else throw new Error("Unexpected rule form type");if((0,o.fH)(o.le.successSavingAlertRule,{type:xe,isNew:(!oe).toString()}),J)l.Ny.push(J);else{const ue=D.$9(re);if(!ue){l.Ny.push("/alerting/list");return}const Te=`/alerting/${encodeURIComponent(ue)}/edit`;l.Ny.getLocation().pathname!==Te&&l.Ny.replace(Te)}})()),{successMessage:oe?`Rule "${ae.name}" updated.`:`Rule "${ae.name}" saved.`,errorMessage:"Failed to save rule"}));function z(ae,oe){if((0,C.lT)(oe?.rule)){const ee=!!oe?.rule.grafana_alert?.notification_settings?.receiver,de=ae.manualRouting,xe=!ee&&de,re=ee&&!de;xe&&(0,o.Fb)(),re&&(0,o.hJ)()}}const Y=(0,n.zD)("unifiedalerting/fetchGrafanaAnnotations",ae=>(0,b.$I)(u(ae))),X=(0,n.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:ae,oldConfig:oe,newConfig:J,successMessage:ee,redirectPath:de,redirectSearch:xe},re)=>(0,b.v5)((0,b.$I)((async()=>{const ue=await re.dispatch(a.m.endpoints.getAlertmanagerConfiguration.initiate(ae,{forceRefetch:!0})).unwrap(),Te=(0,s.isEmpty)(ue.alertmanager_config)&&(0,s.isEmpty)(ue.template_files),ge=JSON.stringify(ue)!==JSON.stringify(oe);if(!Te&&ge)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,c.vk)(ae,(0,E.MZ)(J)),re.dispatch(a.m.util.invalidateTags(["AlertmanagerConfiguration"])),de){const Oe=new URLSearchParams(xe??"");l.Ny.push((0,y.nL)(de,ae,Oe))}})()),{successMessage:ee})),q=(ae,oe)=>async J=>{const ee=await J(alertmanagerApi.endpoints.getAlertmanagerConfiguration.initiate(oe)).unwrap();if(!ee)throw new Error(`Config for ${oe} not found`);if(!ee.alertmanager_config.receivers?.find(xe=>xe.name===ae))throw new Error(`Cannot delete receiver ${ae}: not found in config.`);const de={...ee,alertmanager_config:{...ee.alertmanager_config,receivers:ee.alertmanager_config.receivers.filter(xe=>xe.name!==ae)}};return J(X({newConfig:de,oldConfig:ee,alertManagerSourceName:oe,successMessage:"Contact point deleted."}))},G=(0,n.zD)("unifiedalerting/fetchFolder",ae=>(0,b.$I)(g.IB.getFolderByUid(ae,{withAccessControl:!0}))),te=ae=>(oe,J)=>{J().unifiedAlerting.folders[ae]?.dispatched||oe(G(ae))},H=(0,n.zD)("unifiedalerting/fetchAlertGroups",ae=>(0,b.$I)((0,c.f4)(ae))),se=(0,n.zD)("unifiedalerting/deleteAlertManagerConfig",async(ae,oe)=>(0,b.v5)((0,b.$I)((async()=>{await(0,c.nd)(ae),await oe.dispatch(a.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),ne=(ae,oe)=>async J=>{const ee=await J(a.m.endpoints.getAlertmanagerConfiguration.initiate(ae)).unwrap(),de=ae===h.hY,xe=(ee?.alertmanager_config?.mute_time_intervals??[])?.filter(({name:Oe})=>Oe!==oe)??[],re=(ee?.alertmanager_config?.time_intervals??[])?.filter(({name:Oe})=>Oe!==oe)??[],ue=de?{mute_time_intervals:[...xe,...re]}:{time_intervals:re,mute_time_intervals:xe},{mute_time_intervals:Te,...ge}=ee?.alertmanager_config??{};return(0,b.v5)(J(X({alertManagerSourceName:ae,oldConfig:ee,newConfig:{...ee,alertmanager_config:{...ge,route:ee.alertmanager_config.route?(0,E.Dk)(oe,ee.alertmanager_config?.route):void 0,...ue}}})),{successMessage:`Deleted "${oe}" from Alertmanager configuration`,errorMessage:"Failed to delete mute timing"})},le=(0,n.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:ae,receivers:oe,alert:J})=>(0,b.v5)((0,b.$I)((0,c.By)(ae,oe,J)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),_=(ae,oe)=>ae.filter(J=>{const{forDuration:ee}=(0,C.jg)(J,oe),de=ee?(0,R.P8)(ee):null,xe=(0,R.P8)(oe);return de?de!==0&&de<xe:!1}),Q=(0,n.zD)("unifiedalerting/updateRulesOrderForGroup",async(ae,oe)=>(0,b.v5)((0,b.$I)((async()=>{const{rulesSourceName:J,namespaceName:ee,groupName:de,newRules:xe,folderUid:re}=ae,ue=S(oe.getState,J),ge=(await(0,f.iy)(ue))[ee].find(Ue=>Ue.name===de);if(!ge)throw new Error(`Group "${de}" not found.`);if(ge.rules.length!==xe.length){const Ue=new Error("Rules count mismatch. Please refresh the page and try again.");throw(0,o.vV)(Ue,{namespaceName:ee,groupName:de}),Ue}const Oe={name:ge.name,interval:ge.interval,rules:xe};await(0,f.E8)(ue,re??ee,Oe),await oe.dispatch(O({rulesSourceName:J}))})()),{errorMessage:"Failed to update namespace / group",successMessage:"Update successful"}))},22620:(k,A,e)=>{"use strict";e.d(A,{H:()=>s});var n=e(32196);const s=l=>(0,n.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:l.spacing(2,0)})},99494:(k,A,e)=>{"use strict";e.d(A,{W:()=>n});var n=(s=>(s.Incident="grafana-incident-app",s.OnCall="grafana-oncall-app",s.MachineLearning="grafana-ml-app",s.Labels="grafana-labels-app",s.Slo="grafana-slo-app",s))(n||{})},86590:(k,A,e)=>{"use strict";e.d(A,{Z:()=>n});var n=(s=>(s.grafana="grafana-alerting",s.grafanaRecording="grafana-recording",s.cloudAlerting="cloud-alerting",s.cloudRecording="cloud-recording",s))(n||{})},41068:(k,A,e)=>{"use strict";e.d(A,{y:()=>n});var n=(s=>(s.seconds="s",s.minutes="m",s.hours="h",s.days="d",s.weeks="w",s))(n||{})},75471:(k,A,e)=>{"use strict";e.d(A,{C0:()=>v,HL:()=>g,Q9:()=>x,VQ:()=>o,Wd:()=>m,jy:()=>p,lV:()=>u,nU:()=>d,q0:()=>f});var n=e(2913),s=e(16233),l=e(31678),r=e(57220);function i(E){return(0,r.z2)(E)?"grafana":"external"}const g={read:{grafana:l.AccessControlAction.AlertingInstanceRead,external:l.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:l.AccessControlAction.AlertingInstanceCreate,external:l.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:l.AccessControlAction.AlertingInstanceUpdate,external:l.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:l.AccessControlAction.AlertingInstanceUpdate,external:l.AccessControlAction.AlertingInstancesExternalWrite}},o={read:{grafana:l.AccessControlAction.AlertingNotificationsRead,external:l.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:l.AccessControlAction.AlertingNotificationsWrite,external:l.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:l.AccessControlAction.AlertingNotificationsWrite,external:l.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:l.AccessControlAction.AlertingNotificationsWrite,external:l.AccessControlAction.AlertingNotificationsExternalWrite}},d={read:{grafana:l.AccessControlAction.AlertingSilenceRead,external:l.AccessControlAction.AlertingInstanceRead},create:{grafana:l.AccessControlAction.AlertingSilenceCreate,external:l.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:l.AccessControlAction.AlertingSilenceUpdate,external:l.AccessControlAction.AlertingInstancesExternalWrite}},c={read:l.AccessControlAction.AlertingProvisioningRead,readSecrets:l.AccessControlAction.AlertingProvisioningReadSecrets,write:l.AccessControlAction.AlertingProvisioningWrite},a={read:{grafana:l.AccessControlAction.AlertingRuleRead,external:l.AccessControlAction.AlertingRuleExternalRead},create:{grafana:l.AccessControlAction.AlertingRuleCreate,external:l.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:l.AccessControlAction.AlertingRuleUpdate,external:l.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:l.AccessControlAction.AlertingRuleDelete,external:l.AccessControlAction.AlertingRuleExternalWrite}};function p(E){const h=i(E);return{read:g.read[h],create:g.create[h],update:g.update[h],delete:g.delete[h]}}function u(E){const h=i(E);return{read:o.read[h],create:o.create[h],update:o.update[h],delete:o.delete[h],provisioning:c}}function m(E){const h=i(E);return{read:a.read[h],create:a.create[h],update:a.update[h],delete:a.delete[h]}}function v(E){return()=>s.TP.evaluatePermission(E)}function x(){return{canCreateGrafanaRules:s.TP.hasPermission(l.AccessControlAction.FoldersRead)&&s.TP.hasPermission(a.create.grafana),canCreateCloudRules:s.TP.hasPermission(l.AccessControlAction.DataSourcesRead)&&s.TP.hasPermission(a.create.external),canEditRules:E=>s.TP.hasPermission(m(E).update)}}function f(){const{unifiedAlertingEnabled:E}=(0,n.zj)(),h=s.TP.hasPermission(m(r.hY).read),y=s.TP.hasPermission(m(r.hY).update);return E&&h&&y}},98164:(k,A,e)=>{"use strict";e.d(A,{$P:()=>T,Av:()=>h,Dk:()=>d,Dm:()=>M,EU:()=>y,LF:()=>C,Lt:()=>c,MN:()=>p,MU:()=>m,MZ:()=>o,NL:()=>E,UL:()=>R,VE:()=>b,Wc:()=>v,mP:()=>S,uH:()=>I,xH:()=>f});var n=e(2543),s=e.n(n),l=e(60021),r=e(82775),i=e(57220),g=e(32642);function o(L){return L.alertmanager_config.receivers||(L.alertmanager_config.receivers=[{name:"default "}]),L.alertmanager_config.route||(L.alertmanager_config.route={receiver:L.alertmanager_config.receivers[0].name}),L.template_files||(L.template_files={}),L}function d(L,O){return{...O,mute_time_intervals:O.mute_time_intervals?.filter(N=>N!==L)??[],routes:O.routes?.map(N=>d(L,N))}}function c(L,O,j){return{...j,mute_time_intervals:j.mute_time_intervals?.map(N=>N===O?L:N),routes:j.routes?.map(N=>c(L,O,N))}}function a(L){return L.map(([O,j,N])=>[O,j,unquoteWithUnescape(N)])}function p(L){return L.isEqual?L.isRegex?l.ho.regex:l.ho.equal:L.isRegex?l.ho.notRegex:l.ho.notEqual}function u(L){switch(L){case l.ho.equal:return{isEqual:!0,isRegex:!1};case l.ho.notEqual:return{isEqual:!1,isRegex:!1};case l.ho.regex:return{isEqual:!0,isRegex:!0};case l.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function m(L){return{name:L.name,value:L.value,operator:p(L)}}function v(L){return{name:L.name,value:L.value,...u(L.operator)}}function x(L){return`{ ${L.map(m).reduce((N,F)=>{const U=`${F.name}${F.operator}"${F.value}"`;return N?`${N}, ${U}`:U},"")} }`}const f=[{label:l.ho.equal,description:"Equals",value:l.ho.equal},{label:l.ho.notEqual,description:"Does not equal",value:l.ho.notEqual},{label:l.ho.regex,description:"Matches regex",value:l.ho.regex},{label:l.ho.notRegex,description:"Does not match regex",value:l.ho.notRegex}];function E(L){const O=p(L);return[L.name,O,L.value]}function h(L,O){return O.every(({name:j,value:N,isRegex:F,isEqual:U})=>Object.entries(L).some(([w,B])=>{const K=j===w;let W;return U&&!F&&(W=N===B),!U&&!F&&(W=N!==B),U&&F&&(W=new RegExp(N).test(B)),!U&&F&&(W=!new RegExp(N).test(B)),K&&W}))}function y(...L){const O=L.map(g.Zc).flat(),j=(0,n.uniqWith)(O,n.isEqual);return x(j)}function b(L){return L===i.hY?"default":"unquote"}function D(){return getAllDataSources().filter(L=>L.type===DataSourceType.Alertmanager)}function P(L){return D().find(O=>L===O.uid)}function C(L){const{times:O,weekdays:j,days_of_month:N,months:F,years:U,location:w}=L,B=M(O,w),K=I(j),W=R(N),z=T(F),Y=S(U);return[B,K,W,z,Y].join(", ")}function M(L,O){return"Times: "+(L?L?.map(({start_time:j,end_time:N})=>`${j} - ${N} [${O??"UTC"}]`).join(" and "):"All")}function I(L){return"Weekdays: "+(L?.map(O=>{if(O.includes(":"))return O.split(":").map(j=>{const N=j.slice(0,3);return N[0].toLocaleUpperCase()+N.slice(1)}).join("-");{const j=O.slice(0,3);return j[0].toLocaleUpperCase()+j.slice(1)}}).join(", ")??"All")}function R(L){return"Days of the month: "+(L?.join(", ")??"All")}function T(L){return"Months: "+(L?.join(", ")??"All")}function S(L){return"Years: "+(L?.join(", ")??"All")}},33225:(k,A,e)=>{"use strict";e.d(A,{Hx:()=>i,gO:()=>g});var n=e(96540),s=e(55740),l=e(56361);function r(o){return{dashboardUID:o.find(([d])=>d===s.YH.dashboardUID)?.[1],panelId:o.find(([d])=>d===s.YH.panelID)?.[1]}}function i(o){return(0,n.useMemo)(()=>Object.entries(o||{}).filter(([d,c])=>!!c.trim()),[o])}function g(o){const d=new Map,{panelId:c,dashboardUID:a}=r(o);return a&&d.set(s.YH.dashboardUID,(0,l.JM)(a)),a&&c&&d.set(s.YH.panelID,(0,l.D2)(a,c)),d}},82775:(k,A,e)=>{"use strict";e.d(A,{k:()=>l,q:()=>r});var n=e(32264),s=e(25968);function l(){return Object.values(n.$.datasources)}function r(i){if(!(0,s.TN)(n.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const g=(0,s.P8)(n.$.unifiedAlerting.minInterval);if(!i||!(0,s.TN)(i))return{globalLimit:g,exceedsLimit:!1};const o=(0,s.P8)(i),d=g>o&&o>0;return{globalLimit:g,exceedsLimit:d}}},55740:(k,A,e)=>{"use strict";e.d(A,{DD:()=>l,H8:()=>m,HH:()=>s,J3:()=>u,Oq:()=>r,U3:()=>g,UU:()=>n,YH:()=>p,cB:()=>o,kW:()=>x,kl:()=>v,wG:()=>i});const n="ruler not supported",s=2e4,l="alertmanager",r="alerting-alertmanager",i=2e4,g=2e4,o=2e4,d="timeseries",c="table",a="stat";var p=(f=>(f.description="description",f.summary="summary",f.runbookURL="runbook_url",f.alertId="__alertId__",f.dashboardUID="__dashboardUid__",f.panelID="__panelId__",f))(p||{});const u={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},m={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},v=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],x="__alert_rule_uid__"},57220:(k,A,e)=>{"use strict";e.d(A,{AL:()=>F,EV:()=>O,Eb:()=>N,Jz:()=>E,Vr:()=>te,Zw:()=>W,bD:()=>b,cy:()=>I,gR:()=>S,hP:()=>G,hY:()=>p,iV:()=>P,k5:()=>X,lS:()=>L,oh:()=>B,ol:()=>m,qi:()=>x,r3:()=>K,sq:()=>R,v0:()=>j,v8:()=>f,vv:()=>u,w5:()=>Y,y9:()=>q,yc:()=>U,z2:()=>w});var n=e(19347),s=e(16233),l=e(60021),r=e(31678),i=e(94822),g=e(82843),o=e(62190),d=e(70383),c=e(75471),a=e(82775);const p="grafana",u="-- Grafana --";var m=(H=>(H.Alertmanager="alertmanager",H.Loki="loki",H.Prometheus="prometheus",H))(m||{});const v=["loki","prometheus"];function x(){return s.TP.hasPermission(r.AccessControlAction.AlertingRuleExternalRead)?(0,a.k)().filter(H=>v.includes(H.type)&&H.jsonData.manageAlerts!==!1).sort((H,se)=>H.name.localeCompare(se.name)):[]}function f(H){return w(H)?"grafana":H.uid??H.id}function E(H){return x().find(se=>se.name===H)}function h(){return(0,a.k)().filter(y).sort((H,se)=>H.name.localeCompare(se.name))}function y(H){return H.type==="alertmanager"}function b(H){return H.type==="alertmanager"}function D(){return h().filter(H=>H.jsonData.handleGrafanaManagedAlerts)}function P(H){return H.jsonData.handleGrafanaManagedAlerts===!0}const C={name:p,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function M(){return[C,...h().map(H=>({name:H.name,displayName:H.name,imgUrl:H.meta.info.logos.small,meta:H.meta}))]}function I(H){const se=(0,o.W)(H),ne=se.availableExternalDataSources.filter(ae=>ae.handleGrafanaManagedAlerts),le=se.availableInternalDataSources,{currentData:_}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(_?.alertmanagersChoice){case l.nA.Internal:return le;case l.nA.External:return ne;default:return[...le,...ne]}}function R(H){const se=[],ne=[],le={instance:c.HL.read,notification:c.VQ.read,silence:c.nU.read};if(Object.values(le).flatMap(ae=>ae.grafana).some(ae=>s.TP.hasPermission(ae))&&se.push(C),s.TP.hasPermission(le[H].external)){const ae=h().map(oe=>({name:oe.name,displayName:oe.name,imgUrl:oe.meta.info.logos.small,meta:oe.meta,hasConfigurationAPI:(0,d.Kh)(oe.jsonData),handleGrafanaManagedAlerts:oe.jsonData.handleGrafanaManagedAlerts}));ne.push(...ae)}return{availableInternalDataSources:se,availableExternalDataSources:ne}}function T(H){const se=B(H);if(!se)throw new Error(`Data source ${H} not found`);if(se.type!=="loki"&&se.type!=="prometheus")throw new Error(`Unexpected data source type ${se.type}`);return se}function S(){const H=x().map(se=>se.name);return s.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&H.push(p),H}function L(){const H=x();return s.TP.hasPermission(r.AccessControlAction.AlertingRuleRead)&&H.push(p),H}function O(H){return N(H)?H.name:H}function j(H){return N(H)?H.uid:p}function N(H){return H!==p}function F(H){return H!==p&&K(H)?.jsonData?.implementation===l.Oz.prometheus}function U(H){return H.readOnly===!0}function w(H){return H===p}function B(H){return(0,a.k)().find(se=>se.name===H)}function K(H){return(0,a.k)().filter(y).find(se=>se.name===H)}function W(H){return H===p?p:B(H)}function z(H){if(H===p)return p;const se=B(H);if(!se)throw new Error(`Datasource "${H}" not found`);return String(se.id)}function Y(H){if(H===p)return p;const se=B(H);if(!se)throw new Error(`Datasource "${H}" not found`);return se.uid}function X(){return(0,n.l)().getList({alerting:!0})[0]}function q(){const H=(0,n.l)().getInstanceSettings("default");return H?.meta.alerting??!1?H:X()}function G(H){return H.jsonData.manageAlerts!==!1}function te(H){return w(H)?"grafana":"prometheusType"in H.jsonData?H.jsonData?.prometheusType??i.N1.Prometheus:H.type==="loki"?"loki":i.N1.Prometheus}},75214:(k,A,e)=>{"use strict";e.d(A,{Dd:()=>s,F2:()=>o,M4:()=>n,lL:()=>i,rm:()=>g,w0:()=>d,x4:()=>r,zm:()=>l});function n(c){return Object.entries(c).map(([a,p])=>`${a}=${p}`).sort()}function s(c){return Object.entries(c).map(([a,p])=>[a,p])}function l(c){const a={};return c.forEach(p=>{a[p[0]]=p[1]}),a}function r(c){const a={};return c.forEach(p=>{p.key&&(a[p.key]=p.value)}),a}const i="__grafana_origin";function g(c){return Object.keys(c).filter(a=>!o(a)).length}function o(c){return c.startsWith("__")&&c.endsWith("__")||c===i}const d=([c,a])=>o(c)},32642:(k,A,e)=>{"use strict";e.d(A,{Ig:()=>h,J$:()=>m,J9:()=>u,S6:()=>c,So:()=>o,Zc:()=>a,b2:()=>E,ou:()=>p,qR:()=>g,t8:()=>y});var n=e(2543),s=e.n(n),l=e(60021),r=e(75214);const i=[l.ho.regex,l.ho.notRegex,l.ho.notEqual,l.ho.equal];function g(C){if(C.startsWith("{")&&C.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const M=i.map(L=>[L,C.indexOf(L)]).filter(([L,O])=>O>-1).sort((L,O)=>L[1]-O[1]);if(!M.length)throw new Error(`Invalid matcher: ${C}`);const[I,R]=M[0],T=C.slice(0,R).trim(),S=C.slice(R+I.length);if(!T)throw new Error(`Invalid matcher: ${C}`);return{name:T,value:S,isRegex:I===l.ho.regex||I===l.ho.notRegex,isEqual:I===l.ho.equal||I===l.ho.regex}}function o(C){return b(C)?d(C):[g(C)]}function d(C){if(!b(C))throw new Error("not a PromQL style matcher");return c(C)}function c(C){const M=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,I=C.replace(/^\{/,"").replace(/\}$/,"").trim().split(M);return(0,n.compact)(I).flatMap(g).map(R=>({...R,name:h(R.name),value:h(R.value)}))}function a(C){try{return c(C)}catch{return[]}}function p(C){const M=C.filter(I=>!!I.trim()).map(I=>g(I));return(0,n.uniqBy)(M,I=>I.name)}const u=C=>{const M=Object.entries(C).filter(([R])=>!(0,r.F2)(R)),I=new URLSearchParams;return M.forEach(([R,T])=>I.append("matcher",`${R}=${T}`)),I},m=C=>{let M=[];return C.matchers&&C.matchers.forEach(I=>{const R=o(I).map(D);M=M.concat(R)}),C.object_matchers&&M.push(...C.object_matchers),C.match_re&&Object.entries(C.match_re).forEach(([I,R])=>{M.push([I,l.ho.regex,R])}),C.match&&Object.entries(C.match).forEach(([I,R])=>{M.push([I,l.ho.equal,R])}),M};function v(C){return`"${C.replace(/[\\"]/g,I=>`\\${I}`)}"`}const x=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function f(C){return x.test(C)?v(C):C}const E=({name:C,operator:M,value:I})=>{const R=f(C),T=v(I);return`${R}${M}${T}`};function h(C){return/^"(.*)"$/.test(C)?C.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):C}const y={default:([C,M,I])=>`${C} ${M} ${I||""}`,unquote:([C,M,I])=>{const R=h(C),T=h(I)||'""';return`${R} ${M} ${T}`}};function b(C){return C.startsWith("{")&&C.endsWith("}")}function D(C){const M=P(C);return[C.name,M,C.value]}function P(C){return C.isEqual?C.isRegex?l.ho.regex:l.ho.equal:C.isRegex?l.ho.notRegex:l.ho.notEqual}},56361:(k,A,e)=>{"use strict";e.d(A,{BK:()=>S,Cp:()=>K,D2:()=>U,ES:()=>Y,GD:()=>L,Ht:()=>D,JM:()=>F,JZ:()=>q,KT:()=>M,NH:()=>O,S2:()=>y,Sl:()=>b,Y9:()=>T,Yp:()=>f,bg:()=>E,c$:()=>j,i7:()=>h,i9:()=>w,nL:()=>I,qN:()=>N,qc:()=>z,qy:()=>C,u7:()=>X,w$:()=>x,y$:()=>W});var n=e(2543),s=e.n(n),l=e(61268),r=e(32264),i=e(17172),g=e(16233),o=e(18461),d=e(23662),c=e(64861),a=e(94822),p=e(55740),u=e(57220),m=e(32642),v=e(3704);function x(G,te,H){const se=(0,u.EV)(G),ne=o.UP(se,te),le=encodeURIComponent(o.$9(ne)),_=encodeURIComponent(se);return(0,v.G)(`/alerting/${_}/${le}/view`,H?{returnTo:H}:{})}function f(G,te){const{uid:H,type:se}=G;return(0,v.G)("/explore",{left:JSON.stringify({datasource:G.uid,queries:[{refId:"A",datasource:{uid:H,type:se},expr:te}],range:{from:"now-1h",to:"now"}})})}function E(G,te=""){return(0,v.G)(`/alerting/notifications/receivers/${encodeURIComponent(G)}/edit`,{alertmanager:te})}function h(G,te=""){return(0,v.G)("/alerting/routes/mute-timing/edit",{muteName:G,alertmanager:te})}function y(G,te){if((0,u.Eb)(G))return(0,v.z)(`/alerting/${encodeURIComponent(G.name)}/${encodeURIComponent((0,o.PH)(te.name))}/find`);if((0,d.lT)(te.rulerRule))return(0,v.z)(`/alerting/grafana/${te.rulerRule.grafana_alert.uid}/view`)}function b(G){return G.reduce((te,{key:H,value:se})=>(te[H]=se,te),{})}const D=G=>{const te=G.queryString===void 0?void 0:String(G.queryString),H=G.alertState===void 0?void 0:String(G.alertState),se=G.dataSource===void 0?void 0:String(G.dataSource),ne=G.ruleType===void 0?void 0:String(G.ruleType),le=G.groupBy===void 0?void 0:String(G.groupBy).split(",");return{queryString:te,alertState:H,dataSource:se,groupBy:le,ruleType:ne}},P=G=>({queryString:G.get("queryString")??void 0,contactPoint:G.get("contactPoint")??void 0}),C=G=>{const te=G.queryString===void 0?void 0:String(G.queryString),H=G.silenceState===void 0?void 0:String(G.silenceState);return{queryString:te,silenceState:H}};function M(G){return Object.entries(G).map(([te,H])=>({key:te,value:H}))}function I(G,te,H){const se=new URLSearchParams(H);return te&&se.set(p.DD,te),`${G}?${se.toString()}`}const R=G=>G.replace(/\"/g,'\\"');function T(G){return G.startsWith('"')&&G.endsWith('"')?R(G):`"${R(G)}"`}function S(G,te){const H=new URLSearchParams;return H.append("alertmanager",G),(0,m.J9)(te).forEach((ne,le)=>H.append(le,ne)),(0,v.G)("/alerting/silence/new",H)}function L(G){return(0,v.G)(`/datasources/edit/${G}`)}function O(G){return(0,v.G)(`/dashboards/f/${G}`)}function j(G,te){return(0,v.G)(`/dashboards/f/${G}/${te}/alerting`)}function N(G){return(0,v.G)(`/dashboards/f/${G}/settings`)}function F(G){return(0,v.G)(`/d/${encodeURIComponent(G)}`)}function U(G,te){const H=new URLSearchParams({viewPanel:te});return(0,v.G)(`/d/${encodeURIComponent(G)}`,H)}function w(G,te,H,se=1e3){const ne=new Date().getTime(),le=()=>G().catch(_=>{if(te(_)&&new Date().getTime()-ne<H)return new Promise(Q=>setTimeout(Q,se)).then(le);throw _});return le()}const B={[a.Gi.Alerting]:1,[a.cF.Firing]:1,[a.Gi.Error]:1,[a.Gi.Pending]:2,[a.cF.Pending]:2,[a.cF.Inactive]:2,[a.Gi.NoData]:3,[a.Gi.Normal]:4};function K(G,te){if(G===c.xB.Importance)return(0,n.sortBy)(te,se=>[B[(0,a.lh)(se.state)],(0,d.RI)(se).toLocaleLowerCase()]);if(G===c.xB.TimeAsc)return(0,n.sortBy)(te,se=>[new Date(se.activeAt)||new Date,(0,d.RI)(se).toLocaleLowerCase()]);if(G===c.xB.TimeDesc)return(0,n.sortBy)(te,se=>[new Date(se.activeAt)||new Date,(0,d.RI)(se).toLocaleLowerCase()]).reverse();const H=(0,n.sortBy)(te,se=>(0,d.RI)(se).toLocaleLowerCase());return G===c.xB.AlphaDesc&&H.reverse(),H}function W(){return r.$.buildInfo.edition===l.r.OpenSource}function z(){return g.TP.hasRole("Admin")||g.TP.isGrafanaAdmin}function Y(){return r.$.buildInfo.env==="development"}function X(G){return!!(G&&typeof G=="object"&&"message"in G)}function q(G){return(0,i.NF)(G)?G.message?G.message:"message"in G.data&&typeof G.data.message=="string"?G.data.message:G.statusText?G.statusText:String(G.status)||"Unknown error":X(G)?G.cause?`${G.message}, cause: ${q(G.cause)}`:G.message:String(G)}},88467:(k,A,e)=>{"use strict";e.d(A,{$I:()=>p,BU:()=>D,CZ:()=>v,J7:()=>c,ML:()=>P,Vf:()=>y,Xw:()=>a,jA:()=>o,p0:()=>x,t4:()=>b,v5:()=>u});var n=e(65307),s=e(26272),l=e(17172),r=e(10096),i=e(25027),g=e(56361);const o=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function d(C,M=o,I){if(C.pending.match(I))return{result:M.result,loading:!0,error:M.error,dispatched:!0,requestId:I.meta.requestId};if(C.fulfilled.match(I)){if(M.requestId===void 0||M.requestId===I.meta.requestId)return{...M,result:I.payload,loading:!1,error:void 0}}else if(C.rejected.match(I)&&M.requestId===I.meta.requestId)return{...M,loading:!1,error:I.error};return M}function c(C,M){return(0,n.Z0)({name:C,initialState:o,reducers:{},extraReducers:I=>I.addDefaultCase((R,T)=>d(M,R,T))})}function a(C,M,I){return(0,n.Z0)({name:C,initialState:{},reducers:{},extraReducers:R=>R.addDefaultCase((T,S)=>{if((0,n.$S)(M)(S)){const L=S,O=I(L.meta.arg);return{...T,[O]:d(M,T[O],L)}}return T})})}function p(C){return C.catch(M=>{throw{message:v(M),code:M.statusCode}})}function u(C,M){return C.then(I=>(M.successMessage&&r.lE.emit(s.r1.alertSuccess,[M.successMessage]),I)).catch(I=>{const R=v(I);throw r.lE.emit(s.r1.alertError,[`${M.errorMessage??"Error"}: ${R}`]),I})}const m="Unknown Error";function v(C){if((0,l.NF)(C))if(C.data?.message){let M=C.data?.message;return typeof C.data?.error=="string"&&(M+=`; ${C.data.error}`),M}else{if(Array.isArray(C.data)&&C.data.length&&C.data[0]?.message)return C.data.map(M=>M?.message).filter(M=>!!M).join(" ");if(C.statusText)return C.statusText}return(0,g.u7)(C)?C.message:((0,i.fH)(i.le.unknownMessageFromError,{error:JSON.stringify(C)}),m)}function x(C){return Object.values(C).every(f)}function f(C){return C.dispatched&&!C.loading}function E(C){return Object.values(C).every(h)}function h(C){return C.dispatched&&!C.loading&&!C.error}function y(C){return Object.values(C).some(P)}function b(C){return Object.values(C).some(M=>M.dispatched)}function D(C){return Object.values(C).some(h)}function P(C){return C?C.dispatched&&C.loading:!1}},63066:(k,A,e)=>{"use strict";e.d(A,{Bu:()=>se,IJ:()=>R,J6:()=>q,JE:()=>O,Q8:()=>D,QX:()=>U,Qk:()=>w,Rk:()=>ne,T6:()=>I,XI:()=>B,Z9:()=>N,ir:()=>le,l1:()=>S,mp:()=>X,qO:()=>K});var n=e(2543),s=e.n(n),l=e(43127),r=e(65879),i=e(77789),g=e(32264),o=e(19347),d=e(26657),c=e(80943),a=e(74730),p=e(66718),u=e(94822),m=e(55907),v=e(86590),x=e(75471),f=e(55740),E=e(57220),h=e(56361),y=e(23662),b=e(25968);const D="grafana.alerting.manualRouting",P=(0,b.P8)(g.$.unifiedAlerting?.minInterval??"10s"),C=(0,b.P8)("1m"),I=(0,b.an)((0,n.clamp)(P,C,1/0)),R=()=>{const{canCreateGrafanaRules:_,canCreateCloudRules:Q}=(0,x.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:f.kl,dataSourceName:null,type:_?v.Z.grafana:Q?v.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:u.Q8.NoData,execErrState:u.Q8.Error,evaluateFor:I,evaluateEvery:I,manualRouting:T(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},T=()=>g.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(D)!=="false":!1;function S(_){const{name:Q,expression:ae,forTime:oe,forTimeUnit:J,keepFiringForTime:ee,keepFiringForTimeUnit:de,type:xe}=_;if(xe===v.Z.cloudAlerting){let re;return ee&&de&&(re=`${ee}${de}`),{alert:Q,for:`${oe}${J}`,keep_firing_for:re,annotations:(0,h.Sl)(_.annotations||[]),labels:(0,h.Sl)(_.labels||[]),expr:ae}}else if(xe===v.Z.cloudRecording)return{record:Q,labels:(0,h.Sl)(_.labels||[]),expr:ae};throw new Error(`unexpected rule type: ${xe}`)}function L(_,Q){const ae=[...(0,h.KT)(_||{})];return Q&&ae.push({key:"",value:""}),ae}function O(_){const Q=[..._];return f.kl.map(oe=>oe.key).forEach((oe,J)=>{const ee=Q.findIndex(de=>de.key===oe);if(ee===-1){const de={key:oe,value:""};Q.splice(J,0,de)}else ee!==J&&Q.splice(J,0,Q.splice(ee,1)[0])}),Q}function j(_,Q){if(Q?.grafana?.selectedContactPoint&&_)return{receiver:Q?.grafana?.selectedContactPoint,mute_time_intervals:Q?.grafana?.muteTimeIntervals,group_by:Q?.grafana?.overrideGrouping?Q?.grafana?.groupBy:void 0,group_wait:Q?.grafana?.overrideTimings&&Q?.grafana?.groupWaitValue?Q?.grafana?.groupWaitValue:void 0,group_interval:Q?.grafana?.overrideTimings&&Q?.grafana?.groupIntervalValue?Q?.grafana?.groupIntervalValue:void 0,repeat_interval:Q?.grafana?.overrideTimings&&Q?.grafana?.repeatIntervalValue?Q?.grafana?.repeatIntervalValue:void 0}}function N(_){const{name:Q,condition:ae,noDataState:oe,execErrState:J,evaluateFor:ee,queries:de,isPaused:xe,contactPoints:re,manualRouting:ue,type:Te,metric:ge}=_;if(ae){const Oe=j(ue,re);return(0,y.Mu)(Te)?{grafana_alert:{title:Q,condition:ae,data:de.map(te),is_paused:!!xe,no_data_state:oe,exec_err_state:J,notification_settings:Oe},annotations:(0,h.Sl)(_.annotations||[]),labels:(0,h.Sl)(_.labels||[]),for:ee}:{grafana_alert:{title:Q,condition:ae,data:de.map(te),is_paused:!!xe,record:{metric:ge??Q,from:ae}},annotations:(0,h.Sl)(_.annotations||[]),labels:(0,h.Sl)(_.labels||[])}}throw new Error("Cannot create rule without specifying alert condition")}function F(_){const Q=_.notification_settings?{selectedContactPoint:_.notification_settings.receiver,muteTimeIntervals:_.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(_.notification_settings.group_by)&&_.notification_settings.group_by.length>0,overrideTimings:[_.notification_settings.group_wait,_.notification_settings.group_interval,_.notification_settings.repeat_interval].some(Boolean),groupBy:_.notification_settings.group_by||[],groupWaitValue:_.notification_settings.group_wait||"",groupIntervalValue:_.notification_settings.group_interval||"",repeatIntervalValue:_.notification_settings.repeat_interval||""}:void 0;return Q?{[E.hY]:Q}:void 0}function U(_){const{ruleSourceName:Q,namespace:ae,group:oe,rule:J}=_,ee=R();if((0,E.z2)(Q))if((0,y.Gy)(J)){const de=J.grafana_alert;return{...ee,name:de.title,type:v.Z.grafanaRecording,group:oe.name,evaluateEvery:oe.interval||ee.evaluateEvery,queries:de.data,condition:de.condition,annotations:O(L(J.annotations,!1)),labels:L(J.labels,!0),folder:{title:ae,uid:de.namespace_uid},isPaused:de.is_paused,metric:de.record?.metric}}else if((0,y.lT)(J)){const de=J.grafana_alert,xe=F(de);if(de.no_data_state!==void 0&&de.exec_err_state!==void 0)return{...ee,name:de.title,type:v.Z.grafana,group:oe.name,evaluateEvery:oe.interval||ee.evaluateEvery,evaluateFor:J.for||"0",noDataState:de.no_data_state,execErrState:de.exec_err_state,queries:de.data,condition:de.condition,annotations:O(L(J.annotations,!1)),labels:L(J.labels,!0),folder:{title:ae,uid:de.namespace_uid},isPaused:de.is_paused,contactPoints:xe,manualRouting:!!xe};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,y.$y)(J)){const xe={refId:"A",datasourceUid:(0,o.l)().getInstanceSettings(Q)?.uid??"",queryType:"",relativeTimeRange:(0,l.Cn)(),expr:J.expr,model:{refId:"A",hide:!1,expr:J.expr}},re=w(J);return{...ee,...re,queries:[xe],annotations:O(L(J.annotations,!1)),type:v.Z.cloudAlerting,dataSourceName:Q,namespace:ae,group:oe.name}}else if((0,y.i7)(J)){const de=B(J);return{...ee,...de,type:v.Z.cloudRecording,dataSourceName:Q,namespace:ae,group:oe.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function w(_){const Q=R(),[ae,oe]=_.for?(0,b.P1)(_.for):[0,"s"],[J,ee]=_.keep_firing_for?(0,b.P1)(_.keep_firing_for):[Q.keepFiringForTime,Q.keepFiringForTimeUnit];return{name:_.alert,expression:_.expr,forTime:ae,forTimeUnit:oe,keepFiringForTime:J,keepFiringForTimeUnit:ee,annotations:L(_.annotations,!1),labels:L(_.labels,!0)}}function B(_){return{name:_.record,expression:_.expr,labels:L(_.labels,!0)}}const K=()=>{const _=(0,E.y9)();if(!_)return[...z("A","B")];const Q=(0,l.Cn)();return[{refId:"A",datasourceUid:_.uid,queryType:"",relativeTimeRange:Q,model:{refId:"A"}},...z("B","C")]},W=_=>{const Q=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:_[0]?.uid||"",queryType:"",relativeTimeRange:Q,model:{refId:"A"}}]},z=(..._)=>{const Q=_[0],ae=_[1],oe={refId:_[0],type:p.Tz.reduce,datasource:{uid:p.Uj,type:d.dR.type},conditions:[{type:"query",evaluator:{params:[],type:m.p.IsAbove},operator:{type:"and"},query:{params:[Q]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},J={refId:ae,type:p.Tz.threshold,datasource:{uid:p.Uj,type:d.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:m.p.IsAbove},operator:{type:"and"},query:{params:[ae]},reducer:{params:[],type:"last"}}],expression:Q};return[{refId:Q,datasourceUid:p.Uj,queryType:"",model:oe},{refId:ae,datasourceUid:p.Uj,queryType:"",model:J}]},Y=async(_,Q,ae,oe,J,ee)=>{const de=[];for(const xe of _){const re=await(0,o.l)().get(xe.datasource?.uid?xe.datasource:oe),ue={uid:re.uid,type:re.type},Te=r.relativeToTimeRange(Q),{interval:ge,intervalMs:Oe}=G(Te,ee??re.interval,J),Ue={__interval:{text:ge,value:ge},__interval_ms:{text:Oe,value:Oe},...ae},Xe=re.interpolateVariablesInQueries?re.interpolateVariablesInQueries([xe],Ue)[0]:xe;if(ue.uid===p.Uj){const we={refId:Xe.refId,queryType:"",relativeTimeRange:Q,datasourceUid:p.Uj,model:Xe};de.push(we)}else{const we=(0,o.l)().getInstanceSettings(ue);if(we&&we.meta.alerting){const qe={refId:Xe.refId,queryType:Xe.queryType??"",relativeTimeRange:Q,datasourceUid:we.uid,model:{...Xe,maxDataPoints:J,intervalMs:Oe}};de.push(qe)}}}return de},X=async(_,Q)=>{const{targets:ae}=_;if(!_.id||!Q.uid)return;const oe=r.timeRangeToRelative(r.convertRawToRange(Q.time)),J=await Y(ae,oe,_.scopedVars||{},_.datasource??void 0,_.maxDataPoints??void 0,_.interval??void 0);if(!J.length||!J.find(re=>re.datasourceUid!==p.Uj))return;if(!J.find(re=>re.datasourceUid===p.Uj)){const[re,ue]=z((0,i.M)(J),"-");J.push(re);const[Te,ge]=z(re.refId,(0,i.M)(J));J.push(ge)}const{folderTitle:ee,folderUid:de}=Q.meta;return{type:v.Z.grafana,folder:de&&ee?{uid:de,title:ee}:void 0,queries:J,name:_.title,condition:J[J.length-1].refId,annotations:[{key:f.YH.dashboardUID,value:Q.uid},{key:f.YH.panelID,value:String(_.id)}]}},q=async _=>{if(!_.state.key)return;const Q=c.jh.getTimeRange(_),ae=(0,a.un)(_);if(!ae)return;const{queries:oe,datasource:J,maxDataPoints:ee,minInterval:de}=ae.state,xe=(0,a.YQ)(_);if(!xe||!xe.state.uid)return;const re=await Y(oe,r.timeRangeToRelative(r.convertRawToRange(Q.state.value.raw)),{__sceneObject:{value:_}},J,ee,de);if(!re.length||!re.find(Oe=>Oe.datasourceUid!==p.Uj))return;if(!re.find(Oe=>Oe.datasourceUid===p.Uj)){const[Oe,Ue]=z((0,i.M)(re),"-");re.push(Oe);const[Xe,we]=z(Oe.refId,(0,i.M)(re));re.push(we)}const{folderTitle:ue,folderUid:Te}=xe.state.meta;return{type:v.Z.grafana,folder:Te&&ue?{uid:Te,title:ue}:void 0,queries:re,name:_.state.title,condition:re[re.length-1].refId,annotations:[{key:f.YH.dashboardUID,value:xe.state.uid},{key:f.YH.panelID,value:String((0,a.Cs)(_))}]}};function G(_,Q,ae){return ae?r.calculateInterval(_,ae,Q):Q&&r.intervalToMs(Q)>1e3?{interval:Q,intervalMs:r.intervalToMs(Q)}:{interval:"1s",intervalMs:1e3}}function te(_){const Q=_.model;return H(Q)&&Q.instant&&Q.range?{..._,model:{...Q,range:!0,instant:!1}}:_}function H(_){return"expr"in _&&"instant"in _&&"range"in _}function se(_){return"expr"in _}const ne=_=>({..._,queries:_.queries?.map(Q=>(0,n.omit)(Q,"model.hide"))});function le(_){return ne(U(_))}},18461:(k,A,e)=>{"use strict";e.d(A,{$9:()=>y,LC:()=>a,Ns:()=>D,P1:()=>g,PH:()=>x,UP:()=>d,VY:()=>M,Yd:()=>c,c:()=>f,qg:()=>E,uE:()=>I,x6:()=>h});var n=e(2543),s=e.n(n),l=e(39601),r=e(57220),i=e(23662);function g(R,T,S,L){return(0,i.lT)(L)?{uid:L.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:R,namespace:T,groupName:S,ruleName:(0,i.$y)(L)?L.alert:L.record,rulerRuleHash:D(L)}}function o(R,T,S,L){return{ruleSourceName:R,namespace:T,groupName:S,ruleName:L.name,ruleHash:P(L)}}function d(R,T){const S=T.namespace.name,L=T.group.name;if(T.rulerRule)return g(R,S,L,T.rulerRule);if(T.promRule)return o(R,S,L,T.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function c(R){return g(R.ruleSourceName,R.namespace,R.group.name,R.rule)}function a(R,T){return(0,i.A4)(R)&&(0,i.A4)(T)?R.uid===T.uid:(0,i.X4)(R)&&(0,i.X4)(T)?R.groupName===T.groupName&&R.namespace===T.namespace&&R.ruleName===T.ruleName&&R.rulerRuleHash===T.rulerRuleHash&&R.ruleSourceName===T.ruleSourceName:(0,i.Mj)(R)&&(0,i.Mj)(T)?R.groupName===T.groupName&&R.namespace===T.namespace&&R.ruleName===T.ruleName&&R.ruleHash===T.ruleHash&&R.ruleSourceName===T.ruleSourceName:!1}const p="cri",u="pri";function m(R){return R.replace(/\$/g,"_DOLLAR_")}function v(R){return R.replace(/\_DOLLAR\_/g,"$")}function x(R){return R.replace(/\//g,"").replace(/\\/g,"")}function f(R){return R.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function E(R,T=!1){const L=(T?decodeURIComponent(R):R).split("$");if(L.length===1)return{uid:R,ruleSourceName:"grafana"};if(L.length===6){const[O,j,N,F,U,w]=L.map(v).map(f);if(O===p)return{ruleSourceName:j,namespace:N,groupName:F,ruleName:U,rulerRuleHash:w};if(O===u)return{ruleSourceName:j,namespace:N,groupName:F,ruleName:U,ruleHash:w}}throw new Error(`Failed to parse rule location: ${R}`)}function h(R,T=!1){if(R)try{return E(R,T)}catch{return}}function y(R){return(0,i.A4)(R)?R.uid:(0,i.X4)(R)?[p,R.ruleSourceName,R.namespace,R.groupName,R.ruleName,R.rulerRuleHash].map(String).map(m).map(x).join("$"):[u,R.ruleSourceName,R.namespace,R.groupName,R.ruleName,R.ruleHash].map(String).map(m).map(x).join("$")}function b(R){let T=0;if(R.length===0)return T;for(let S=0;S<R.length;S++){const L=R.charCodeAt(S);T=(T<<5)-T+L,T=T&T}return T}function D(R){if((0,i.i7)(R))return b(JSON.stringify([R.record,R.expr,C(R.labels)])).toString();if((0,i.$y)(R))return b(JSON.stringify([R.alert,R.expr,C(R.annotations),C(R.labels)])).toString();if((0,i.lT)(R))return R.grafana_alert.uid;throw new Error("only recording and alerting ruler rules can be hashed")}function P(R){if((0,i.KB)(R))return b(JSON.stringify([R.type,R.query,C(R.labels)])).toString();if((0,i.Z8)(R))return b(JSON.stringify([R.type,R.query,C(R.annotations),C(R.labels)])).toString();throw new Error("only recording and alerting rules can be hashed")}function C(R){return JSON.stringify(Object.entries(R||{}).sort((T,S)=>T[0].localeCompare(S[0])))}function M(R){return(0,i.A4)(R)?r.hY:R.ruleSourceName}function I(R){const{pathname:T=""}=l.Ny.getLocation(),{id:S}=R;return S?(0,n.nth)(T.split("/"),-2):void 0}},23662:(k,A,e)=>{"use strict";e.d(A,{$7:()=>M,$y:()=>v,A4:()=>I,BL:()=>le,Gy:()=>E,H2:()=>Q,HH:()=>P,I2:()=>H,KB:()=>m,Mj:()=>S,Mt:()=>D,Mu:()=>se,OF:()=>_,Om:()=>z,RI:()=>C,TU:()=>w,Tm:()=>N,UL:()=>f,Uw:()=>te,Wy:()=>K,X4:()=>R,XI:()=>F,YN:()=>Y,Z8:()=>u,dS:()=>B,f6:()=>L,i7:()=>x,jg:()=>q,lT:()=>y,nf:()=>T,pq:()=>ne,pv:()=>h,qz:()=>X,s_:()=>oe,uo:()=>O,vE:()=>ae});var n=e(2543),s=e.n(n),l=e(43585),r=e(32264),i=e(94822),g=e(28475),o=e(86590),d=e(55740),c=e(57220),a=e(75214),p=e(25968);function u(J){return typeof J=="object"&&J.type===i.JS.Alerting}function m(J){return typeof J=="object"&&J.type===i.JS.Recording}function v(J){return typeof J=="object"&&"alert"in J}function x(J){return typeof J=="object"&&"record"in J}function f(J){return typeof J=="object"&&x(J)||y(J)&&"record"in J.grafana_alert}function E(J){return typeof J=="object"&&f(J)&&y(J)}function h(J){return typeof J=="object"&&y(J)&&!f(J)}function y(J){return typeof J=="object"&&"grafana_alert"in J}function b(J){return typeof J=="object"&&"grafana_alert"in J&&"record"in J.grafana_alert}function D(J){return typeof J=="object"&&!y(J)}function P(J){return J&&y(J)&&!!J.grafana_alert.is_paused}function C(J){return JSON.stringify(J.labels)}function M(J){return J.error&&J.error?.message?.includes(d.UU)}function I(J){return"uid"in J}function R(J){return"rulerRuleHash"in J}function T(J){return Object.values(i.JS).includes(J)}function S(J){return"ruleHash"in J}function L(J){switch(J){case"ok":return g.Jc.Ok;case"nodata":return g.Jc.NoData;case"error":case"err":return g.Jc.Error;case"unknown":return g.Jc.Unknown;default:return}}function O(J){const ee=J.labels[a.lL];if(!ee)return;const de=ee.match(/^plugin\/(?<pluginId>.+)$/);if(!de?.groups)return;const xe=de.groups.pluginId;if(j(xe))return{pluginId:xe}}function j(J){return!!r.$.apps[J]}function N(J){return!!O(J)}function F(J){return J===i.cF.Inactive?"Normal":(0,n.capitalize)(J)}const U=J=>J.reduce((ee,{dataSourceName:de,name:xe,groups:re})=>(re.forEach(({name:ue,rules:Te})=>{Te.forEach(ge=>{u(ge)&&ee.push({dataSourceName:de,namespaceName:xe,groupName:ue,rule:ge})})}),ee),[]),w=J=>u(J.promRule)?J.promRule:null,B=J=>J.reduce((ee,{rulesSource:de,name:xe,groups:re})=>(re.forEach(({name:ue,rules:Te})=>{Te.forEach(ge=>{ge.promRule&&u(ge.promRule)&&ee.push({dataSourceName:(0,c.EV)(de),namespaceName:xe,groupName:ue,...ge})})}),ee),[]);function K(J){let ee;return Object.values(l.O).includes(J)?ee=J:ee=(0,i.lh)(J),W[ee]}const W={[i.cF.Inactive]:"good",[i.cF.Firing]:"bad",[i.cF.Pending]:"warning",[i.Gi.Alerting]:"bad",[i.Gi.Error]:"bad",[i.Gi.NoData]:"info",[i.Gi.Normal]:"good",[i.Gi.Pending]:"warning",[l.O.NoData]:"info",[l.O.Paused]:"warning",[l.O.Alerting]:"bad",[l.O.OK]:"good",[l.O.Unknown]:"info"};function z(J){return J?.alerts?J.alerts.reduce((ee,de)=>{const xe=(0,i.lh)(de.state)!==i.Gi.Normal;if(de.activeAt&&xe){const re=new Date(de.activeAt);if(ee===null||ee.getTime()>re.getTime())return re}return ee},null):null}function Y(J){return Array.isArray(J.source_tenants)}function X(J){return y(J)?J.grafana_alert.title:v(J)?J.alert:x(J)?J.record:""}const q=(J,ee)=>{const de={alertName:"",forDuration:"0s",evaluationsToFire:0};return y(J)?{alertName:J.grafana_alert.title,forDuration:J.for,evaluationsToFire:J.for?G(J.for,ee):null}:v(J)?{alertName:J.alert,forDuration:J.for??"0s",evaluationsToFire:G(J.for??"0s",ee)}:de},G=(J,ee)=>{const de=(0,p.P8)(ee),xe=(0,p.P8)(J);return xe===0&&de!==0?1:de===0||xe/de<1?0:Math.ceil(xe/de)+1};function te(J){const ee=(0,c.z2)(J.namespace.rulesSource)?J.namespace.rulesSource:J.namespace.rulesSource.name,de=y(J.rulerRule)?J.rulerRule.grafana_alert.namespace_uid:J.namespace.name;return{dataSourceName:ee,namespaceName:de,groupName:J.group.name}}function H(J){const ee=J.ruleSourceName,de=y(J.rule)?J.rule.grafana_alert.namespace_uid:J.namespace,xe=J.group.name;return{dataSourceName:ee,namespaceName:de,groupName:xe}}function se(J){return J===o.Z.grafana}function ne(J){return J===o.Z.grafanaRecording}function le(J){return J===o.Z.cloudAlerting}function _(J){return J===o.Z.cloudRecording}function Q(J){return se(J)||ne(J)}function ae(J){return ne(J)||_(J)}function oe(J){return le(J)||_(J)}},25968:(k,A,e)=>{"use strict";e.d(A,{M9:()=>c,P1:()=>s,P8:()=>p,TN:()=>i,an:()=>a,mo:()=>u,sc:()=>r,yl:()=>m});var n=e(41068);function s(v){const x=v.match(/(\d+)(\w+)/);if(x)return[Number(x[1]),x[2]];throw new Error(`Invalid interval description: ${v}`)}function l(v){const{sec:x,count:f}=describeInterval(v);return x*f}const r=Object.entries(n.y).map(([v,x])=>({label:v[0].toUpperCase()+v.slice(1),value:x}));function i(v){try{return c(v),!0}catch{return!1}}const g={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},o=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),d=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(n.y).join(", ")}`);function c(v){let x=v;const f=[];function E(y){const b=o.exec(y),D=b?.groups?.value&&b?.groups?.type;if(!b||!D)throw d;b&&b.groups?.value&&b.groups?.type&&(x=x.replace(b[0],""),f.push([Number(b.groups.value),b.groups.type])),x&&E(x)}if(E(v),!f.length)throw d;return f.reduce((y,[b,D])=>{const P=b*g[D];return y+P},0)}function a(v){const x=Math.floor(v/1e3),f=Math.floor(x/60),E=Math.floor(f/60),h=Math.floor(E/24),y=Math.floor(h/7),b=Math.floor(h/365);return v===0?"0s":[[b,"y"],[y%52,"w"],[h%365-7*(y%52),"d"],[E%24,"h"],[f%60,"m"],[x%60,"s"],[v%1e3,"ms"]].filter(([P])=>P>0).map(([P,C])=>P+C).join("")}const p=v=>{try{return c(v)}catch{return 0}},u=v=>v.includes("0001-01-01T00");function m(v){return v%(1e3*60*60)===0?v/(1e3*60*60)+"h":v%(1e3*60)===0?v/(1e3*60)+"m":v%1e3===0?v/1e3+"s":v.toFixed()+"ms"}},3704:(k,A,e)=>{"use strict";e.d(A,{G:()=>s,z:()=>l});var n=e(32264);function s(r,i){const o=new URLSearchParams(i).toString();return`${n.$.appSubUrl}${r}${o?`?${o}`:""}`}function l(r,i){const o=new URLSearchParams(i).toString();try{return`${new URL(n.$.appSubUrl+r,n.$.appUrl).href}${o?`?${o}`:""}`}catch{return s(r,i)}}},10154:(k,A,e)=>{"use strict";e.d(A,{Xm:()=>r,rJ:()=>l,vJ:()=>s,vy:()=>i});var n=e(17172);function s(g){return(0,n.AI)().post("/api/annotations",g)}function l(g){return(0,n.AI)().put(`/api/annotations/${g.id}`,g)}function r(g){return(0,n.AI)().delete(`/api/annotations/${g.id}`)}async function i(){return(await(0,n.AI)().get("/api/annotations/tags")).result.tags.map(({tag:o,count:d})=>({term:o,count:d}))}},82241:(k,A,e)=>{"use strict";e.d(A,{A:()=>C});var n=e(74848),s=e(96540),l=e(75505),r=e(39070),i=e(76287),g=e(13544),o=e(68402),d=e(62930),c=e(55852),a=e(42418),p=e(14792),u=e(74856),m=e(34214),v=e(27302),x=e(42493),f=e(28240),E=e(8790),h=e(83195),y=e(56034),b=e(14578),D=e(90182);class P extends s.PureComponent{constructor(I){super(I),this.updateFields=()=>{const R=this.props.response?.panelData,T=R?.series?.[0]??R?.annotations?.[0];if(T&&T.fields){const S=T.fields.map(L=>{const O=(0,f.Ct)(L,T);let j="";for(let N=0;N<T.length;N++){if(N>0&&(j+=", "),N>2){j+="...";break}j+=L.values[N]}return j.length>50&&(j=j.substring(0,50)+"..."),{label:`${O} (${L.type})`,value:O,description:j}});this.setState({fieldNames:S})}},this.onFieldSourceChange=(R,T)=>{const S=this.props.mappings||{},L=S[R]||{};this.props.change({...S,[R]:{...L,source:T.value||E.V.Field}})},this.onFieldNameChange=(R,T)=>{const S=this.props.mappings||{};if(!T){const O={...this.props.mappings};delete O[R],this.props.change(O);return}const L=S[R]||{};this.props.change({...S,[R]:{...L,value:T.value,source:E.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(I){I.response!==this.props.response&&this.updateFields()}renderRow(I,R,T){const{fieldNames:S}=this.state;let L=[...S];const O=R.value;let j=S.find(F=>O===F.value);O&&!j&&L.push({label:O,value:O});let N=T?T[I.key]:"";if(N&&I.key.startsWith("time")){const F=(0,h.j_)("dateTimeAsIso");N=(0,h.cN)(F(N))}return N==null&&(N=""),(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[I.label||I.key," ",I.help&&(0,n.jsx)(y.m,{content:I.help,children:(0,n.jsx)(b.I,{name:"info-circle"})})]}),(0,n.jsx)("td",{children:(0,n.jsx)(D.l6,{value:j,options:L,placeholder:I.placeholder||I.key,onChange:F=>{this.onFieldNameChange(I.key,F)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})}),(0,n.jsx)("td",{children:`${N}`})]},I.key)}render(){const I=this.props.response?.events?.[0],R=this.props.mappings||{};return(0,n.jsxs)("table",{className:"filter-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Annotation"}),(0,n.jsx)("th",{children:"From"}),(0,n.jsx)("th",{children:"First Value"})]})}),(0,n.jsx)("tbody",{children:x.kj.map(T=>this.renderRow(T,R[T.key]||{},I))})]})}}class C extends s.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:I,annotation:R}=this.props;if((0,x.E7)(I))return;const T=(0,p.UA)().getCurrent();if(!T)return;this.setState({running:!0});const S=await(0,l.s)((0,v.b)({range:(0,u.jG)().timeRange(),panel:new m.a({}),dashboard:T},I,R));this.setState({running:!1,response:S})},this.onQueryChange=I=>{this.props.onChange({...this.props.annotation,target:I})},this.onMappingChange=I=>{this.props.onChange({...this.props.annotation,mappings:I})},this.onAnnotationChange=I=>{this.props.onChange(I)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(I){this.props.annotation!==I.annotation&&!(0,x.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:I,annotation:R}=this.props,S={...x.CU,...I.annotations}.prepareAnnotation(R);S!==R?this.props.onChange(S):this.onRunQuery()}getStatusSeverity(I){const{events:R,panelData:T}=I;return T?.errors||T?.error?"error":R?.length?"success":"warning"}renderStatusText(I,R){const{events:T,panelData:S}=I;if(R||I?.panelData?.state===r.Gu.Loading||!I)return(0,n.jsx)("p",{children:"loading..."});if(S?.errors)return(0,n.jsx)(n.Fragment,{children:S.errors.map((O,j)=>(0,n.jsx)("p",{children:O.message},j))});if(S?.error)return(0,n.jsx)("p",{children:S.error.message??"There was an error fetching data"});if(!T?.length)return(0,n.jsx)("p",{children:"No events found"});const L=S?.series?.[0]??S?.annotations?.[0];return(0,n.jsxs)("p",{children:[T.length," events (from ",L?.fields.length," fields)"]})}renderStatus(){const{response:I,running:R}=this.state;return I?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.$,{v:2}),(0,n.jsx)("div",{children:R?(0,n.jsx)(d.y,{}):(0,n.jsx)(c.$n,{"data-testid":g.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:"Test annotation query"})}),(0,n.jsx)(o.$,{v:2,layout:"block"}),(0,n.jsx)(a.F,{"data-testid":g.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(I),title:"Query result",children:this.renderStatusText(I,R)})]}):null}render(){const{datasource:I,annotation:R,datasourceInstanceSettings:T}=this.props,{response:S}=this.state;let L=I.annotations?.QueryEditor||I.components?.QueryEditor;if(!L)return(0,n.jsx)("div",{children:"Annotations are not supported. This datasource needs to export a QueryEditor"});const O={...I.annotations?.getDefaultQuery?.(),...R.target??{refId:"Anno"}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.p,{instanceSettings:T,children:(0,n.jsx)(L,{query:O,datasource:I,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:S?.panelData,range:(0,u.jG)().timeRange(),annotation:R,onAnnotationChange:this.onAnnotationChange},I?.name)}),(0,x.JX)(I)&&(0,n.jsxs)(n.Fragment,{children:[this.renderStatus(),(0,n.jsx)(P,{response:S,mappings:R.mappings,change:this.onMappingChange})]})]})}}},27302:(k,A,e)=>{"use strict";e.d(A,{b:()=>a});var n=e(62467),s=e(69862),l=e(81160),r=e(65879),i=e(41987),g=e(39374),o=e(42493);let d=100;function c(){return"AQ"+d++}function a(p,u,m){const v={...o.CU,...u.annotations},x={...v.getDefaultQuery?.(),...m},f=v.prepareAnnotation(x);if(!f)return(0,n.of)({});const E=v.prepareQuery(f);if(!E)return(0,n.of)({});const h=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,y=r.calculateInterval(p.range,h,u.interval),b={__interval:{text:y.interval,value:y.interval},__interval_ms:{text:y.intervalMs.toString(),value:y.intervalMs},__annotation:{text:f.name,value:f}},D={startTime:Date.now(),requestId:c(),range:p.range,maxDataPoints:h,scopedVars:b,...y,app:i.Jk.Dashboard,timezone:p.dashboard.timezone,targets:[{...E,refId:"Anno"}]};return(0,g.BN)(u,D).pipe((0,s.Z)(P=>{const C=P?.series.length?P.series:P.annotations;return C?.length?v.processEvents(f,C).pipe((0,l.T)(M=>({panelData:P,events:M}))):(0,n.of)({panelData:P,events:[]})}))}},42493:(k,A,e)=>{"use strict";e.d(A,{CU:()=>p,E7:()=>y,JX:()=>h,kj:()=>m});var n=e(2543),s=e.n(n),l=e(62467),r=e(69862),i=e(81160),g=e(57934),o=e(11261),d=e(28240),c=e(8790),a=e(2913);const p={prepareAnnotation:b=>{if((0,n.isString)(b?.query)){const{query:D,...P}=b;return{...P,target:{refId:"annotation_query",query:D},mappings:{}}}return b},prepareQuery:b=>b.target,processEvents:(b,D)=>f(D,b.mappings)};function u(){return b=>b.pipe((0,r.Z)(D=>{if(!D?.length)return(0,l.of)(void 0);if(D.length===1)return(0,l.of)(D[0]);const P={interpolate:C=>C};return(0,l.of)(D).pipe(g.c.mergeTransformer.operator({},P),(0,i.T)(C=>C[0]))}))}const m=[{key:"time",field:b=>b.fields.find(D=>D.type===o.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:b=>b.fields.find(D=>D.type===o.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],v=[{key:"color"},{key:"isRegion"},{key:"source"}],x=[...a.config.publicDashboardAccessToken?v:[],...m,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function f(b,D){return(0,l.of)(b).pipe(u(),(0,i.T)(P=>{if(!P?.length)return[];let C=!1,M=!1;const I={};for(const S of P.fields){const L=(0,d.Ct)(S,P);I[L.toLowerCase()]=S}D||(D={});const R=[];for(const S of x){const L=D[S.key]||{};if(L.source===c.V.Skip)continue;const O={key:S.key,split:S.split};if(L.source===c.V.Text)O.text=L.value;else{const j=(L.value||S.key).toLowerCase();O.field=I[j],!O.field&&S.field&&(O.field=S.field(P))}(O.field||O.text)&&(R.push(O),O.key==="time"?C=!0:O.key==="text"&&(M=!0))}if(!C||!M)return console.error("Cannot process annotation fields. No time or text present."),[];const T=[];for(let S=0;S<P.length;S++){const L={type:"default",color:"red"};for(const O of R){let j;if(O.text)j=O.text;else if(O.field&&(j=O.field.values[S],j!==void 0&&O.regex)){const N=O.regex.exec(j);N&&(j=N[1]?N[1]:N[0])}j!=null&&(O.split&&typeof j=="string"&&(j=j.split(",")),L[O.key]=j)}T.push(L)}return T}))}const E=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function h(b){const{type:D}=b;return!(D==="datasource"||E.includes(D))}function y(b){const{type:D}=b;return E.includes(D)}},93584:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>a,QB:()=>d,Ri:()=>o,Sf:()=>r,cV:()=>i,h8:()=>g});var n=e(65307);const s={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},l=(0,n.Z0)({name:"apiKeys",initialState:s,reducers:{apiKeysLoaded:(p,u)=>{const{keys:m,keysIncludingExpired:v}=u.payload,x=u.payload.keys.length===0&&u.payload.keysIncludingExpired.length>0?!0:p.includeExpired;return{...p,hasFetched:!0,keys:m,keysIncludingExpired:v,includeExpired:x}},setSearchQuery:(p,u)=>({...p,searchQuery:u.payload}),includeExpiredToggled:p=>({...p,includeExpired:!p.includeExpired}),isFetching:p=>({...p,hasFetched:!1}),setMigrationResult:(p,u)=>({...p,migrationResult:u.payload})}}),{apiKeysLoaded:r,includeExpiredToggled:i,isFetching:g,setSearchQuery:o,setMigrationResult:d}=l.actions,a={apiKeys:l.reducer}},2468:(k,A,e)=>{"use strict";e.d(A,{H:()=>o,w:()=>i});var n=e(32264),s=e(17172),l=e(10096),r=e(48814);class i{constructor(c,a=!0){const p=a?`namespaces/${n.$.namespace}/`:"";this.url=`/apis/${c.group}/${c.version}/${p}${c.resource}`}async get(c){return(0,s.AI)().get(`${this.url}/${c}`)}async subresource(c,a){return(0,s.AI)().get(`${this.url}/${c}/${a}`)}async list(c){const a=c||{};return a.labelSelector=this.parseListOptionsSelector(a?.labelSelector),a.fieldSelector=this.parseListOptionsSelector(a?.fieldSelector),(0,s.AI)().get(this.url,c)}async create(c){if(!c.metadata.name&&!c.metadata.generateName){const a=l.contextSrv.user.login;c.metadata.generateName=a?a.slice(0,2):"g"}return g(c.metadata),(0,s.AI)().post(this.url,c)}async update(c){return g(c.metadata),(0,s.AI)().put(`${this.url}/${c.metadata.name}`,c)}async delete(c){return(0,s.AI)().delete(`${this.url}/${c}`)}parseListOptionsSelector(c){return Array.isArray(c)?c.map(a=>{const p=String(a.key),u=a.operator;switch(u){case"=":case"!=":return`${p}${u}${a.value}`;case"in":case"notin":return`${p} ${u} (${a.value.join(",")})`;case"":case"!":return`${u}${p}`;default:return null}}).filter(Boolean).join(","):c}}function g(d){d.annotations||(d.annotations={}),d.annotations[r.dc]="UI",d.annotations[r.zv]=window.location.pathname,d.annotations[r.M8]=n.$.buildInfo.versionString}class o{async get(c){if(this.apiVersions)return this.apiVersions[c];const a=await(0,s.AI)().get("/apis"),p={};return a.groups.forEach(u=>{if(u.name.includes("datasource.grafana.app")){const m=u.name.split(".")[0];p[m]=u.preferredVersion.version,m.endsWith("-datasource")||(m.includes("-")?p[`${m}-datasource`]=u.preferredVersion.version:p[`grafana-${m}-datasource`]=u.preferredVersion.version)}}),this.apiVersions=p,p[c]}}},48814:(k,A,e)=>{"use strict";e.d(A,{M8:()=>c,dc:()=>o,ew:()=>r,fY:()=>i,zv:()=>d});const n="grafana.app/createdBy",s="grafana.app/updatedTimestamp",l="grafana.app/updatedBy",r="grafana.app/folder",i="grafana.app/message",g="grafana.app/slug",o="grafana.app/originName",d="grafana.app/originPath",c="grafana.app/originHash",a="grafana.app/originTimestamp"},73399:(k,A,e)=>{"use strict";e.d(A,{getAuthProviderStatus:()=>a,getRegisteredAuthProviders:()=>o,initAuthConfig:()=>p,registerAuthProvider:()=>g});var n=e(10096),s=e(27677),l=e(31678);const r=[],i={};function g(m,v){r.find(x=>x.id===m.id)||(r.push(m),v&&(i[m.id]=v))}function o(){return r}function d(m){return r.find(v=>v.id===m)}function c(m){const v=[];for(const[x,f]of Object.entries(m)){const E=r.find(h=>`auth.${h.id}`===x);if(E){const h={...f,providerId:E.id,displayName:f.name||E.displayName};v.push(h)}}return v}async function a(m){if(i[m]){const v=i[m];return v()}return{configured:!1,enabled:!1}}function p(){g({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},u)}async function u(){if(n.contextSrv.hasPermission(l.AccessControlAction.SettingsRead)){const v=(await(0,s.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:v.enabled==="true",enabled:v.enabled==="true",hide:v.enabled!=="true"}}return{configured:!1,enabled:!1}}},60610:(k,A,e)=>{"use strict";e.d(A,{DZ:()=>p,M5:()=>d,TD:()=>c});var n=e(75505),s=e(17172),l=e(32264),r=e(10096),i=e(31678),g=e(73399),o=e(20604);function d(u=!0){return async m=>{if(r.contextSrv.hasPermission(i.AccessControlAction.SettingsRead)){u&&m((0,o.sr)()),m(c());const v=await(0,s.AI)().get("/api/admin/settings");return m((0,o.jA)(v)),await m(a()),u&&m((0,o.MH)()),v}}}function c(u=""){return async m=>{if(!l.$.featureToggles.ssoSettingsApi)return[];const v=await(0,s.AI)().get(`/api/v1/sso-settings${u?`/${u}`:""}`);return m((0,o.Oy)(u?[v]:v)),v}}function a(){return async u=>{const m=(0,g.getRegisteredAuthProviders)(),v={},x=[];for(const E of m)x.push((0,g.getAuthProviderStatus)(E.id));const f=await Promise.all(x);for(let E=0;E<m.length;E++){const h=m[E];v[h.id]=f[E]}u((0,o.TO)(v))}}function p(u){return async m=>{if(r.contextSrv.hasPermission(i.AccessControlAction.SettingsWrite))try{return await(0,n.s)((0,s.AI)().fetch({url:"/api/admin/settings",method:"PUT",data:u,showSuccessAlert:!1,showErrorAlert:!1})),m((0,o.SH)()),!0}catch(v){if(console.log(v),(0,s.NF)(v)){v.isHandled=!0;const x={message:v.data?.message,errors:v.data?.errors};return m((0,o.Nh)(x)),!1}}return!1}}},20604:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>v,MH:()=>o,Nh:()=>d,Oy:()=>u,SH:()=>c,TO:()=>i,jA:()=>r,sr:()=>g,yk:()=>p});var n=e(65307);const s={settings:{},providerStatuses:{},isLoading:!1,providers:[]},l=(0,n.Z0)({name:"authConfig",initialState:s,reducers:{settingsUpdated:(x,f)=>({...x,settings:f.payload}),providerStatusesLoaded:(x,f)=>({...x,providerStatuses:f.payload}),loadingBegin:x=>({...x,isLoading:!0}),loadingEnd:x=>({...x,isLoading:!1}),setError:(x,f)=>({...x,updateError:f.payload}),resetError:x=>({...x,updateError:void 0}),setWarning:(x,f)=>({...x,warning:f.payload}),resetWarning:x=>({...x,warning:void 0}),providersLoaded:(x,f)=>({...x,providers:f.payload})}}),{settingsUpdated:r,providerStatusesLoaded:i,loadingBegin:g,loadingEnd:o,setError:d,resetError:c,setWarning:a,resetWarning:p,providersLoaded:u}=l.actions,v={authConfig:l.reducer}},55314:(k,A,e)=>{"use strict";e.d(A,{D$:()=>j,G2:()=>C,Ko:()=>D,Vc:()=>T,aF:()=>I,cU:()=>y,e8:()=>S,hT:()=>E.hT,iB:()=>L,kH:()=>M,uz:()=>P,vR:()=>O,vZ:()=>b,wt:()=>R});var n=e(75816),s=e(75505),l=e(71733),r=e(39070),i=e(26272),g=e(17172),o=e(39601),d=e(82467),c=e(28138),a=e(3169),p=e(10096),u=e(28676),m=e(6473),v=e(8484),x=e(37690),f=e(92955),E=e(10378);function h({baseURL:N}){async function F(U){try{const{data:w,...B}=await(0,s.s)((0,g.AI)().fetch({...U,url:N+U.url,showErrorAlert:U.showErrorAlert}));return{data:w,meta:B}}catch(w){return U.manageError?U.manageError(w):{error:w}}}return F}const y=(0,n.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:h({baseURL:"/api"}),endpoints:N=>({listFolders:N.query({providesTags:F=>F?.map(U=>({type:"getFolder",id:U.uid}))??[],query:({parentUid:F,limit:U,page:w,permission:B})=>({url:"/folders",params:{parentUid:F,limit:U,page:w,permission:B}})}),getFolder:N.query({providesTags:(F,U,w)=>[{type:"getFolder",id:w}],query:F=>({url:`/folders/${F}`,params:{accesscontrol:!0}})}),newFolder:N.mutation({query:({title:F,parentUid:U})=>({method:"POST",url:"/folders",data:{title:F,parentUid:U}}),onQueryStarted:({parentUid:F},{queryFulfilled:U,dispatch:w})=>{U.then(async({data:B})=>{await p.contextSrv.fetchUserPermissions(),w((0,d.dx)((0,a.tZ)("Folder created"))),w((0,x.bw)({parentUID:F,pageSize:f.md})),o.Ny.push(l.I.stripBaseFromUrl(B.url))})}}),saveFolder:N.mutation({invalidatesTags:["getFolder"],query:({uid:F,title:U,version:w})=>({method:"PUT",url:`/folders/${F}`,data:{title:U,version:w}}),onQueryStarted:({parentUid:F},{queryFulfilled:U,dispatch:w})=>{U.then(()=>{w((0,x.bw)({parentUID:F,pageSize:f.md}))})}}),moveFolder:N.mutation({invalidatesTags:["getFolder"],query:({folder:F,destinationUID:U})=>({url:`/folders/${F.uid}/move`,method:"POST",data:{parentUID:U}}),onQueryStarted:({folder:F,destinationUID:U},{queryFulfilled:w,dispatch:B})=>{const{parentUid:K}=F;w.then(()=>{B((0,x.bw)({parentUID:K,pageSize:f.md})),B((0,x.bw)({parentUID:U,pageSize:f.md}))})}}),deleteFolder:N.mutation({query:({uid:F})=>({url:`/folders/${F}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:F},{queryFulfilled:U,dispatch:w})=>{U.then(()=>{w((0,x.bw)({parentUID:F,pageSize:f.md}))})}}),getAffectedItems:N.query({keepUnusedDataFor:0,queryFn:async F=>{const w=Object.keys(F.folder).filter(W=>F.folder[W]).map(W=>(0,g.AI)().get(`/api/folders/${W}/counts`)),B=await Promise.all(w),K={folder:Object.values(F.folder).filter(r.zz).length,dashboard:Object.values(F.dashboard).filter(r.zz).length,libraryPanel:0,alertRule:0};for(const W of B)K.folder+=W.folder??0,K.dashboard+=W.dashboard,K.alertRule+=W.alertrule,K.libraryPanel+=W.librarypanel;return{data:K}}}),moveItems:N.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:F,destinationUID:U},w,B,K)=>{const W=Object.keys(F.dashboard).filter(Y=>F.dashboard[Y]),z=Object.keys(F.folder).filter(Y=>F.folder[Y]);for(const Y of z)await K({url:`/folders/${Y}/move`,method:"POST",data:{parentUID:U}});for(const Y of W){const q={dashboard:(await(0,u.n)().getDashboardDTO(Y)).dashboard,folderUid:U,overwrite:!1,message:""};await K({url:"/dashboards/db",method:"POST",data:q})}return{data:void 0}},onQueryStarted:({destinationUID:F,selectedItems:U},{queryFulfilled:w,dispatch:B})=>{const K=Object.keys(U.dashboard).filter(z=>U.dashboard[z]),W=Object.keys(U.folder).filter(z=>U.folder[z]);w.then(()=>{B((0,x.bw)({parentUID:F,pageSize:f.md})),B((0,x.Zw)([...W,...K]))})}}),deleteItems:N.mutation({queryFn:async({selectedItems:F},U,w,B)=>{const K=Object.keys(F.dashboard).filter(z=>F.dashboard[z]),W=Object.keys(F.folder).filter(z=>F.folder[z]);for(const z of W)await B({url:`/folders/${z}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const z of K){const X=(await B({url:`/dashboards/uid/${z}`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;X&&c.A.publish({type:i.r1.alertSuccess.name,payload:[(0,v.t)("browse-dashboards.soft-delete.success","Dashboard {{name}} moved to Recently deleted",{name:X})]})}return{data:void 0}},onQueryStarted:({selectedItems:F},{queryFulfilled:U,dispatch:w})=>{const B=Object.keys(F.dashboard).filter(W=>F.dashboard[W]),K=Object.keys(F.folder).filter(W=>F.folder[W]);U.then(()=>{w((0,x.Zw)([...K,...B]))})}}),saveDashboard:N.mutation({queryFn:async F=>{try{return{data:await(0,u.n)().saveDashboard(F)}}catch(U){return{error:U}}},onQueryStarted:({folderUid:F},{queryFulfilled:U,dispatch:w})=>{m.t.ignoreNextSave(),U.then(async()=>{await p.contextSrv.fetchUserPermissions(),w((0,x.bw)({parentUID:F,pageSize:f.md}))})}}),importDashboard:N.mutation({query:({dashboard:F,overwrite:U,inputs:w,folderUid:B})=>({method:"POST",url:"/dashboards/import",data:{dashboard:F,overwrite:U,inputs:w,folderUid:B}}),onQueryStarted:({folderUid:F},{queryFulfilled:U,dispatch:w})=>{U.then(async B=>{w((0,x.bw)({parentUID:F,pageSize:f.md}));const K=l.I.stripBaseFromUrl(B.data.importedUrl);o.Ny.push(K)})}}),restoreDashboard:N.mutation({query:({dashboardUID:F})=>({url:`/dashboards/uid/${F}/trash`,method:"PATCH"})}),hardDeleteDashboard:N.mutation({queryFn:async({dashboardUID:F},U,w,B)=>{const W=(await B({url:`/dashboards/uid/${F}/trash`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;return W&&c.A.publish({type:i.r1.alertSuccess.name,payload:[(0,v.t)("browse-dashboards.hard-delete.success","Dashboard {{name}} deleted",{name:W})]}),{data:void 0}},onQueryStarted:({dashboardUID:F},{queryFulfilled:U,dispatch:w})=>{U.then(()=>{w((0,x.Zw)([F]))})}})})}),{endpoints:b,useDeleteFolderMutation:D,useDeleteItemsMutation:P,useGetAffectedItemsQuery:C,useGetFolderQuery:M,useMoveFolderMutation:I,useMoveItemsMutation:R,useNewFolderMutation:T,useSaveDashboardMutation:S,useSaveFolderMutation:L,useRestoreDashboardMutation:O,useHardDeleteDashboardMutation:j}=y},92955:(k,A,e)=>{"use strict";e.d(A,{aw:()=>p,md:()=>c,uT:()=>a});var n=e(32264),s=e(17172),l=e(53477),r=e(24439),i=e(40957),g=e(10096),o=e(31678),d=e(49952);const c=50;async function a(u,m,v=1,x=c){if(u&&!n.$.featureToggles.nestedFolders)return[];const f=(0,s.AI)();let E=[];g.contextSrv.hasPermission(o.AccessControlAction.FoldersRead)&&(E=await f.get("/api/folders",{parentUid:u,page:v,limit:x}));const h=n.$.appSubUrl??"";return E.map(y=>({kind:"folder",uid:y.uid,title:y.title,parentTitle:m,parentUID:u,url:(0,d.I)(y.uid)?void 0:`${h}/dashboards/f/${y.uid}/`}))}async function p(u,m=1,v=c){const f=await(0,r.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:u||"general",from:(m-1)*v,limit:v});return f.view.map(E=>{const h=(0,i.hI)(E,f.view);return h.parentUID===l.TF&&(h.parentUID=void 0),h})}},43907:(k,A,e)=>{"use strict";e.d(A,{x:()=>d});var n=e(74848),s=e(70255),l=e(94753),r=e(42418),i=e(55314),g=e(8484);function o(c,a,p,u){const m=c+a+p+u,v=[];c&&v.push((0,g.t)("browse-dashboards.counts.folder","{{count}} folder",{count:c})),a&&v.push((0,g.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:a})),p&&v.push((0,g.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:p})),u&&v.push((0,g.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:u}));let x=(0,g.t)("browse-dashboards.counts.total","{{count}} item",{count:m});return v.length>0&&(x+=`: ${v.join(", ")}`),x}const d=({selectedItems:c})=>{const{data:a,isFetching:p,isLoading:u,error:m}=(0,i.G2)(c);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.E,{element:"p",color:"secondary",children:[a&&o(a.folder,a.dashboard,a.libraryPanel,a.alertRule),(p||u)&&(0,n.jsx)(s.A,{width:200})]}),m&&(0,n.jsx)(r.F,{severity:"error",title:"Unable to retrieve descendant information"})]})}},49952:(k,A,e)=>{"use strict";e.d(A,{I:()=>l,e:()=>s});var n=e(32264);function s(r,i){return r+i.uid}function l(r){return r===n.$.sharedWithMeFolderUID}},36141:(k,A,e)=>{"use strict";e.d(A,{Ii:()=>o,Zw:()=>i,bw:()=>g});var n=e(53477),s=e(31678),l=e(92955),r=e(93519);const i=(0,s.createAsyncThunk)("browseDashboards/refreshParents",async(d,{getState:c,dispatch:a})=>{const{browseDashboards:p}=c(),{rootItems:u,childrenByParentUID:m}=p,v=new Set;for(const x of d){const f=(0,r.R)(u?.items??[],m,x);v.add(f?.parentUID)}for(const x of v)a(g({parentUID:x,pageSize:l.md}))}),g=(0,s.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:d,pageSize:c})=>{const a=d===n.TF?void 0:d;let p=1,u="folder",m=await(0,l.uT)(a,void 0,p,c),v=m.length<c;if(u==="folder"&&v){u="dashboard",p=1;const x=await(0,l.aw)(a,p,c);v=x.length<c,m=m.concat(x)}return{children:m,lastPageOfKind:v,page:p,kind:u}}),o=(0,s.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:d,excludeKinds:c=[],pageSize:a},p)=>{const u=!c.includes("dashboard"),m=d===n.TF?void 0:d,v=p.getState().browseDashboards,x=m?v.childrenByParentUID[m]:v.rootItems;let f=1,E;if(x?x.lastFetchedKind==="dashboard"&&!x.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${m} but that collection is fully loaded`):x.lastFetchedKind==="folder"&&x.lastKindHasMoreItems?(f=x.lastFetchedPage+1,E="folder"):u&&(f=x.lastFetchedKind==="folder"?1:x.lastFetchedPage+1,E="dashboard"):(f=1,E="folder"),!E)return;let h=E==="folder"?await(0,l.uT)(m,void 0,f,a):await(0,l.aw)(m,f,a),y=h.length<a;if(E==="folder"&&y&&u){E="dashboard",f=1;const b=await(0,l.aw)(m,f,a);y=b.length<a,h=h.concat(b)}return{children:h,lastPageOfKind:y,page:f,kind:E}})},37690:(k,A,e)=>{"use strict";e.d(A,{Am:()=>a,xN:()=>n.xN,Ii:()=>s.Ii,bw:()=>s.bw,Zw:()=>s.Zw,ku:()=>c,cT:()=>n.cT,wn:()=>n.wn,t$:()=>n.t$,xK:()=>D,eC:()=>f,Ms:()=>y,V6:()=>b,q0:()=>E,QE:()=>h,Zg:()=>P});var n=e(79763),s=e(36141),l=e(96540),r=e(25508),i=e(31678),g=e(92955),o=e(49952),d=e(93519);const c=M=>M.browseDashboards.rootItems,a=M=>M.browseDashboards.childrenByParentUID,p=M=>M.browseDashboards.openFolders,u=M=>M.browseDashboards.selectedItems,m=(0,r.Mz)(c,a,p,(M,I)=>I,(M,I,R,T)=>C(T,M,I,R)),v=(0,r.Mz)(u,M=>Object.values(M).some(I=>Object.values(I).some(R=>R))),x=(0,r.Mz)(u,a,(M,I)=>{const R={dashboard:{...M.dashboard},folder:{...M.folder}};for(const T of Object.keys(M.folder))if(M.folder[T]){const L=I[T];if(L)for(const O of L.items)O.kind==="dashboard"&&(R.dashboard[O.uid]=!1),O.kind==="folder"&&(R.folder[O.uid]=!1)}return R});function f(M){return(0,i.useSelector)(I=>(M?I.browseDashboards.childrenByParentUID[M]:I.browseDashboards.rootItems)?"fulfilled":"pending")}function E(M){return(0,i.useSelector)(I=>m(I,M))}function h(){return(0,i.useSelector)(M=>v(M))}function y(){return(0,i.useSelector)(u)}function b(){return(0,i.useSelector)(M=>M.browseDashboards.childrenByParentUID)}function D(){return(0,i.useSelector)(M=>x(M))}function P(M=[]){const I=(0,i.useDispatch)(),R=(0,l.useRef)(!1);return(0,l.useCallback)(S=>{if(R.current)return Promise.resolve();R.current=!0;const L=I((0,s.Ii)({parentUID:S,excludeKinds:M,pageSize:g.md}));return L.finally(()=>R.current=!1),L},[I,M])}function C(M,I,R,T,S=0,L=[],O=[]){function j(W,z,Y){if(L.includes(W.kind)||O.includes(W.uid))return[];const X=C(W.uid,I,R,T,Y+1,L,O),q=!!T[W.uid],G=R[W.uid]?.items.length===0;q&&G&&!L.includes("empty-folder")&&X.push({isOpen:!1,level:Y+1,item:{kind:"ui",uiKind:"empty-folder",uid:W.uid+"empty-folder"},parentUID:z});const te={item:W,parentUID:z,level:Y,isOpen:q},H=[te,...X];return(0,o.I)(te.item.uid)&&H.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:z,level:Y+1,isOpen:!1}),H}const N=M&&T[M]||S===0,F=M?R[M]:I;let w=((M?N&&F?.items:F?.items)||[]).flatMap(W=>j(W,M,S));const B=L.includes("dashboard")&&F?.lastFetchedKind==="dashboard";return(S===0&&!F||N&&F&&!(F.isFullyLoaded||B))&&(w=w.concat((0,d.T)(g.md,M,S))),w}},79763:(k,A,e)=>{"use strict";e.d(A,{xN:()=>D,Ay:()=>P,cT:()=>b,wn:()=>h,t$:()=>y});var n={};e.r(n),e.d(n,{clearFolders:()=>p,fetchNextChildrenPageFulfilled:()=>o,refetchChildrenFulfilled:()=>g,setAllSelection:()=>a,setFolderOpenState:()=>d,setItemSelectionState:()=>c});var s=e(65307),l=e(36141),r=e(49952),i=e(93519);function g(C,M){const{children:I,page:R,kind:T,lastPageOfKind:S}=M.payload,{parentUID:L}=M.meta.arg,O={items:I,lastFetchedKind:T,lastFetchedPage:R,lastKindHasMoreItems:!S,isFullyLoaded:T==="dashboard"&&S};L?C.childrenByParentUID[L]=O:C.rootItems=O}function o(C,M){const I=M.payload;if(!I)return;const{children:R,page:T,kind:S,lastPageOfKind:L}=I,{parentUID:O,excludeKinds:j=[]}=M.meta.arg,U={items:((O?C.childrenByParentUID[O]:C.rootItems)?.items??[]).concat(R),lastFetchedKind:S,lastFetchedPage:T,lastKindHasMoreItems:!L,isFullyLoaded:(j.includes("dashboard")||S==="dashboard")&&L};if(!O){C.rootItems=U;return}if(C.childrenByParentUID[O]=U,C.selectedItems.folder[O])for(const B of R)C.selectedItems[B.kind][B.uid]=!0}function d(C,M){const{folderUID:I,isOpen:R}=M.payload;C.openFolders[I]=R}function c(C,M){const{item:I,isSelected:R}=M.payload;if((0,r.I)(I.uid))return;function T(S,L){if(C.selectedItems[S][L]=R,S!=="folder")return;let O=C.childrenByParentUID[L];for(const j of O?.items??[])T(j.kind,j.uid)}if(T(I.kind,I.uid),!R){let S=I.parentUID;for(;S;){const L=(0,i.R)(C.rootItems?.items??[],C.childrenByParentUID,S);if(!L)break;C.selectedItems[L.kind][L.uid]=!1,S=L.parentUID}}C.selectedItems.$all=C.rootItems?.items?.every(S=>C.selectedItems[S.kind][S.uid])??!1}function a(C,M){const{isSelected:I,folderUID:R}=M.payload;if(!(R&&(0,r.I)(R)))if(C.selectedItems.$all=I,I){let S=function(L){if(L&&(0,r.I)(L))return;const O=L?C.childrenByParentUID[L]:C.rootItems;if(O)for(const j of O.items)(0,r.I)(j.uid)||(C.selectedItems[j.kind][j.uid]=I,j.kind==="folder"&&S(j.uid))};var T=S;S(R)}else for(const S in C.selectedItems){if(!(S==="dashboard"||S==="panel"||S==="folder"))continue;const L=C.selectedItems[S];for(const O in L)L[O]=I}}function p(C,M){const I=Array.isArray(M.payload)?M.payload:[M.payload];for(const R of I)R?(C.childrenByParentUID[R]=void 0,C.openFolders[R]=!1):C.rootItems=void 0}const{fetchNextChildrenPageFulfilled:u,refetchChildrenFulfilled:m,...v}=n,x={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},f=(0,s.Z0)({name:"browseDashboards",initialState:x,reducers:v,extraReducers:C=>{C.addCase(l.Ii.fulfilled,u),C.addCase(l.bw.fulfilled,m)}}),E=f.reducer,{setFolderOpenState:h,setItemSelectionState:y,setAllSelection:b,clearFolders:D}=f.actions,P={browseDashboards:E}},93519:(k,A,e)=>{"use strict";e.d(A,{R:()=>n,T:()=>s});function n(l,r,i){for(const g of l)if(g.uid===i)return g;for(const g in r){const o=r[g];if(o){for(const d of o.items)if(d.uid===i)return d}}}function s(l,r,i){return new Array(l).fill(null).map((g,o)=>({parentUID:r,level:i,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${r}-pagination-${o}`}}))}},6320:(k,A,e)=>{"use strict";e.d(A,{b:()=>s,q:()=>n});const n="connections",s={Base:`/${n}`,DataSources:`/${n}/datasources`,DataSourcesNew:`/${n}/datasources/new`,DataSourcesEdit:`/${n}/datasources/edit/:uid`,DataSourcesDashboards:`/${n}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${n}/add-new-connection`,DataSourcesDetails:`/${n}/datasources/:id`,ConnectDataOutdated:`/${n}/connect-data`,YourConnectionsOutdated:`/${n}/your-connections`}},31152:(k,A,e)=>{"use strict";e.d(A,{n:()=>d});var n=e(24180),s=e(19347),l=e(17422),r=e(11084),i=e(74984),g=e(83391),o=e(31678);function d(c){const{uid:a}=(0,n.g)(),p=(0,n.zy)(),u=(0,r.xw)(a),m=(0,r.S4)(u.type),v=(0,g.ob)(u.type),x=new URLSearchParams(p.search),f=c||x.get("page"),{plugin:E,loadError:h,loading:y}=(0,r._e)(),b=(0,s.l)()?.getInstanceSettings(a),D=!!(b?.meta?.alerting??!1),P=b?.type==="alertmanager",C=D||P,M=(0,o.useSelector)(S=>S.navIndex),I=f?`datasource-${f}-${a}`:`datasource-settings-${a}`;let R={node:{text:"Data Source Nav Node"},main:{text:"Data Source Nav Node"}};if(h){const S={text:h,subTitle:"Data Source Error",icon:"exclamation-triangle"};R={node:S,main:S}}return(y||!E)&&(R=(0,l.tc)(M,I,(0,i.$m)("settings"))),E&&(R=(0,l.tc)(M,I,(0,i.Vh)((0,i.R4)(u,E),f||"settings"))),{navId:"connections-datasources",pageNav:{...R.main,dataSourcePluginName:v?.name||E?.meta.name||"",active:!0,text:u.name,subTitle:`Type: ${m.name}`,children:(R.main.children||[]).map(S=>({...S,url:S.url?.replace("datasources/edit/","/connections/datasources/edit/")}))},dataSourceHeader:{alertingSupported:C}}}},67023:(k,A,e)=>{"use strict";e.d(A,{k:()=>i});var n=e(60455),s=e.n(n),l=e(91890),r=e(87490);const i=(g,o,d)=>{let c={},a={};if(g.type===l.CC.Regex&&g.expression){const p=new RegExp(g.expression,"gi"),m=(typeof o=="string"?o:(0,r.MA)(o)).matchAll(p);for(const v of m)v.groups?a=v.groups:a[g.mapValue||d]=v[1]||v[0]}else g.type===l.CC.Logfmt&&(a=s().parse(o));return Object.keys(a).forEach(p=>{const u=typeof a[p]=="string"?a[p]:(0,r.MA)(a[p]);c[p]={value:u}}),c}},40511:(k,A,e)=>{"use strict";e.d(A,{F0:()=>d,bQ:()=>c,lW:()=>a});var n=e(41053),s=e(75505),l=e(19347),r=e(76888),i=e(18380);const g=({sourceUID:p,targetUID:u,...m})=>{const v=(0,l.l)().getInstanceSettings(p),x=(0,l.l)().getInstanceSettings(u);if((m?.orgId===void 0||m?.orgId===null||m?.orgId===0)&&i.kb.logWarning("Invalid correlation config: Missing org id."),v&&v?.uid!==void 0&&x&&x.uid!==void 0)return{...m,source:v,target:x};i.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(v),target:JSON.stringify(x)})},o=p=>!!p,d=p=>({...p,correlations:p.correlations.map(g).filter(o)});function c(p){return p.data}const a=()=>{const{backend:p}=(0,r.Il)(),[u,m]=(0,n.A)(b=>(0,s.s)(p.fetch({url:"/api/datasources/correlations",params:{page:b.page},method:"GET",showErrorAlert:!1})).then(c).then(d),[p]),[v,x]=(0,n.A)(({sourceUID:b,...D})=>p.post(`/api/datasources/uid/${b}/correlations`,D).then(P=>{const C=g(P.result);if(C!==void 0)return C;throw new Error("invalid sourceUID")}),[p]),[f,E]=(0,n.A)(({sourceUID:b,uid:D})=>p.delete(`/api/datasources/uid/${b}/correlations/${D}`),[p]),[h,y]=(0,n.A)(({sourceUID:b,uid:D,...P})=>p.patch(`/api/datasources/uid/${b}/correlations/${D}`,P).then(C=>{const M=g(C.result);if(M!==void 0)return M;throw new Error("invalid sourceUID")}),[p]);return{create:{execute:x,...v},update:{execute:y,...h},get:{execute:m,...u},remove:{execute:E,...f}}}},18380:(k,A,e)=>{"use strict";e.d(A,{$q:()=>p,J6:()=>a,cA:()=>d,kb:()=>v,tZ:()=>m});var n=e(75505),s=e(91890),l=e(17172),r=e(19347),i=e(34867),g=e(9651),o=e(40511);const d=(x,f,E)=>(x.forEach(h=>{const y=h.refId;if(!y)return;let b=E[y];if(b===void 0&&h.meta?.preferredVisualisationType==="rawPrometheus"){const P=(0,g.a)(y);b=E[P]}const D=f.filter(P=>P.source.uid===b);c(h,D)}),x),c=(x,f)=>{x.fields.forEach(E=>{E.config.links=E.config.links?.filter(h=>h.origin!==s.x0.Correlations)||[],f.map(h=>{if(h.config?.field===E.name){const y=h.config?.target||{};E.config.links.push({internal:{query:{...y,datasource:{uid:h.target.uid}},datasourceUid:h.target.uid,datasourceName:h.target.name,transformations:h.config?.transformations},url:"",title:h.label||h.target.name,origin:s.x0.Correlations})}})})},a=async x=>(0,n.s)((0,l.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:x}})).then(o.bQ).then(o.F0),p=async(x,f)=>(0,l.AI)().post(`/api/datasources/uid/${x}/correlations`,f),u=async x=>x.datasourceInstance?.meta.mixed?await(0,r.l)().get(x.queries[0].datasource):x.datasourceInstance,m=async(x,f)=>Promise.all([u(x),u(f)]).then(E=>E[0]?.name!==void 0&&E[1]?.name!==void 0?`${E[0]?.name} to ${E[1]?.name}`:""),v=(0,i.DW)("features.correlations")},41524:(k,A,e)=>{"use strict";e.d(A,{W:()=>l});var n=e(11261);function s(){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="abcdefghijklmnopqrstuvwxyz",g=r.length,o=new Map;return d=>{const c=o.get(d);if(c!=null)return c;const a=[...d].map(p=>p.toLowerCase()&&p!==p.toUpperCase()?i.charAt(Math.floor(Math.random()*g)):p.toUpperCase()&&p!==p.toUpperCase()?r.charAt(Math.floor(Math.random()*g)):p).join("");return o.set(d,a),a}}function l(r,i){if(!(i.labels||i.names||i.values))return r;const g=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),o=s();return r.map(d=>{let{schema:c,data:a}=d;if(c&&a){if(i.labels){for(const p of c.fields)if(p.labels){const u={};for(const[m,v]of Object.entries(p.labels))u[m]=o(v);p.labels=u}}if(i.names)for(const p of c.fields)p.name?.length&&!g.has(p.name.toLowerCase())&&(p.name=o(p.name));i.values&&c.fields.forEach((p,u)=>{if(p.type===n.PU.string&&a){const m=a.values[u].map(v=>o(String(v)));a.values[u]=m}})}return{schema:c,data:a}})}},72255:(k,A,e)=>{"use strict";e.d(A,{m6:()=>M,sP:()=>T});var n=e(71733),s=e(17172),l=e(39601),r=e(32264),i=e(79422),g=e(2619),o=e(33390),d=e(94954),c=e(78160),a=e(17493),p=e(14792),u=e(34214),m=e(41176),v=e(20470),x=e(16833),f=e(31678),E=e(61642),h=e(71176),y=e(85445),b=e(27734),D=e(77431);const P=500,C="loadDashboardScene",M="__grafana_home_uid__";class I extends g.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:O,route:j,urlFolderUid:N,keepDashboardFromExploreInLocalStorage:F}){const U=o.A.getObject(v.us);if(U)return F||(0,v.yZ)(),U;const w=j===f.DashboardRoutes.Home?M:O,B=this.getDashboardFromCache(w);if(B)return B;let K;try{switch(j){case f.DashboardRoutes.New:K=await(0,h.X)(N);break;case f.DashboardRoutes.Home:if(K=await(0,s.AI)().get("/api/dashboards/home"),K.redirectUri)return K;K?.meta&&(K.meta.canSave=!1,K.meta.canShare=!1,K.meta.canStar=!1);break;case f.DashboardRoutes.Public:return await a.np.loadDashboard("public","",O);default:K=await a.np.loadDashboard("db","",O),j===f.DashboardRoutes.Embedded&&(K.meta.isEmbedded=!0)}if(K.meta.url&&j===f.DashboardRoutes.Normal){const W=n.I.stripBaseFromUrl(K.meta.url),z=l.Ny.getLocation().pathname;W!==z&&(l.Ny.replace({...l.Ny.getLocation(),pathname:W}),console.log("not correct url correcting",W,z))}K.meta.folderUid&&await(0,D.Q)(K.meta.folderUid),this.setDashboardCache(w,K)}catch(W){if((0,s.NF)(W)&&W.cancelled)return null;throw W}return K}async loadSnapshot(O){try{const j=await this.loadSnapshotScene(O);this.setState({dashboard:j,isLoading:!1})}catch(j){this.setState({isLoading:!1,loadError:String(j)})}}async loadSnapshotScene(O){const j=await a.np.loadDashboard("snapshot",O,"");if(j?.dashboard)return(0,y.wM)(j);throw new Error("Snapshot not found")}async loadDashboard(O){try{(0,c.j)(C);const j=await this.loadScene(O);if(!j)return;r.$.featureToggles.preserveDashboardStateWhenNavigating&&O.uid&&(0,b.Gq)(j),this.setState({dashboard:j,isLoading:!1});const N=(0,c.z)(C);(0,x.D)(j,N?.duration),O.route!==f.DashboardRoutes.New&&(0,m.B)({meta:j.state.meta,uid:j.state.uid,title:j.state.title,id:j.state.id})}catch(j){const N=(0,d.q)(j);this.setState({isLoading:!1,loadError:N,dashboard:S(N)})}}async loadScene(O){const j=!!(o.A.getObject(v.us)&&O.keepDashboardFromExploreInLocalStorage===!1);this.setState({isLoading:!0});const N=await this.fetchDashboard(O),F=this.getSceneFromCache(O.uid);if(!j&&F&&F.state.version===N?.dashboard.version)return F;if(N?.dashboard){const U=(0,y.wM)(N);return O.uid&&!j&&this.setSceneCache(O.uid,U),U}if(N?.redirectUri){const U=n.I.stripBaseFromUrl(N.redirectUri);return l.Ny.replace(U),null}throw new Error("Dashboard not found")}getDashboardFromCache(O){const j=this.dashboardCache;return O=this.getCacheKey(O),j&&j.cacheKey===O&&Date.now()-j?.ts<P?j.dashboard:null}clearState(){(0,p.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(O,j){O=this.getCacheKey(O),this.dashboardCache={dashboard:j,ts:Date.now(),cacheKey:O}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(O){return O=this.getCacheKey(O),this.cache[O]}setSceneCache(O,j){O=this.getCacheKey(O),this.cache[O]=j}getCacheKey(O){const j=(0,E.X)();return j?.has("scopes")?(j.sort(),`${O}__scp__${j.toString()}`):O}}let R=null;function T(){return R||(R=new I({})),R}function S(L){const O={dashboard:{...i.Ye,uid:"error-dash",title:L,annotations:{list:[{builtIn:1,datasource:{type:"grafana",uid:"-- Grafana --"},enable:!1,hide:!0,iconColor:"rgba(0, 211, 255, 1)",name:"Annotations & Alerts",type:"dashboard"}]},panels:[{fieldConfig:{defaults:{},overrides:[]},gridPos:{h:6,w:12,x:7,y:0},id:1,options:{code:{language:"plaintext",showLineNumbers:!1,showMiniMap:!1},content:`<br/><br/><center><h1>${L}</h1></center>`,mode:"html"},title:"",transparent:!0,type:"text"}]},meta:{canSave:!1,canEdit:!1}};return(0,y.EH)(new u.G(O.dashboard,O.meta),O.dashboard)}},77431:(k,A,e)=>{"use strict";e.d(A,{Q:()=>i});var n=e(82467),s=e(27677),l=e(71101),r=e(99140);async function i(g){try{const o=await s.IB.getFolderByUid(g);r.M_.dispatch((0,n.Vz)((0,l.R4)(o)))}catch(o){console.warn("Error fetching parent folder",g,"for dashboard",o)}}},79280:(k,A,e)=>{"use strict";e.d(A,{p:()=>d});var n=e(74848),s=e(13544),l=e(90613),r=e(67061),i=e(94753),g=e(55852),o=e(8484);function d(c){return(0,n.jsx)(l.a,{alignItems:"center",padding:4,children:(0,n.jsxs)(r.B,{direction:"column",alignItems:"center",gap:2,children:[(0,n.jsx)(i.E,{element:"h3",textAlignment:"center",children:(0,n.jsx)(o.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,n.jsx)(i.E,{element:"p",textAlignment:"center","data-testid":s.Tp.components.Transforms.noTransformationsMessage,children:(0,n.jsxs)(o.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,n.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,n.jsx)(g.$n,{icon:"plus",variant:"primary",size:"md",onClick:c.onShowPicker,"data-testid":s.Tp.components.Transforms.addTransformationButton,children:"Add transformation"})]})})}},19293:(k,A,e)=>{"use strict";e.d(A,{i:()=>cs,L:()=>Zn});var n=e(39601),s=e(32264),l=e(80943),r=e(41507),i=e(60656),g=e(74730),o=e(74848),d=e(32196),c=e(13544),a=e(40845),p=e(63021),u=e(40276),m=e(40980),v=e(66864),x=e(2913),f=e(10096),E=e(75471),h=e(57220),y=e(42418),b=e(39558),D=e(40675),P=e(80215),C=e(27747),M=e(56361),I=e(24180),R=e(16817),T=e(76885),S=e(34867),L=e(55852),O=e(25027),j=e(63066);const N=({panel:wt,className:Ft})=>{const Ht=(0,I.zy)(),{loading:ut,value:pn}=(0,R.A)(()=>(0,j.J6)(wt),[wt]);if(ut)return(0,o.jsx)(L.$n,{disabled:!0,children:"New alert rule"});if(!pn)return(0,o.jsx)(y.F,{severity:"info",title:"No alerting capable query found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."});const Jn=async()=>{(0,S.fH)(O.le.alertRuleFromPanel);const Qn=await(0,j.J6)(wt),fs=T.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Qn),returnTo:Ht.pathname+Ht.search});n.Ny.push(fs)};return(0,o.jsx)(L.$n,{icon:"bell",onClick:Jn,className:Ft,"data-testid":"create-alert-rule-button",children:"New alert rule"})};var F=(wt=>(wt.Queries="queries",wt.Transformations="transformations",wt.Alert="alert",wt))(F||{});class U extends l.Bs{constructor(Ft){super({}),this.tabId=F.Alert,this.TabComponent=Ht=>K({...Ht,model:this}),this._panelManager=Ft}static{this.Component=w}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,g.YQ)(this._panelManager)}getLegacyPanelId(){return(0,g.Cs)(this._panelManager.state.panel)}getCanCreateRules(){const Ft=(0,E.Wd)("grafana");return this.getDashboard().state.meta.canSave&&f.contextSrv.hasPermission(Ft.create)}get panelManager(){return this._panelManager}get panel(){return this._panelManager.state.panel}}function w(wt){const{model:Ft}=wt,Ht=(0,a.of)(B),{errors:ut,loading:pn,rules:Jn}=(0,C.S)({dashboardUID:Ft.getDashboardUID(),panelId:Ft.getLegacyPanelId()}),Qn=ut.length?(0,o.jsx)(y.F,{title:"Errors loading rules",severity:"error",children:ut.map((vs,ea)=>(0,o.jsxs)("div",{children:["Failed to load Grafana rules state: ",(0,M.JZ)(vs)]},ea))}):null;if(pn&&!Jn.length)return(0,o.jsxs)(o.Fragment,{children:[Qn,(0,o.jsx)(b._,{text:"Loading rules..."})]});const{panel:fs}=Ft,ls=Ft.getCanCreateRules();return Jn.length?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(P.s,{rules:Jn}),ls&&(0,o.jsx)(N,{className:Ht.newButton,panel:fs})]}):(0,o.jsxs)("div",{className:Ht.noRulesWrapper,children:[(0,o.jsx)("p",{children:"There are no alert rules linked to this panel."}),ls&&(0,o.jsx)(N,{panel:fs})]})}const B=wt=>({newButton:(0,d.css)({marginTop:wt.spacing(3)}),noRulesWrapper:(0,d.css)({margin:wt.spacing(2),backgroundColor:wt.colors.background.secondary,padding:wt.spacing(3)})});function K(wt){const{model:Ft}=wt,{rules:Ht}=(0,C.S)({dashboardUID:Ft.getDashboardUID(),panelId:Ft.getLegacyPanelId(),poll:!1});return(0,o.jsx)(D.o,{label:Ft.getTabLabel(),icon:"bell",counter:Ht.length,active:wt.active,onChangeTab:wt.onChangeTab},wt.key)}var W=e(22391),z=e(41987),Y=e(19347),X=e(67061),q=e(21969),G=e(53478),te=e(64152),H=e(44932),se=e(37464),ne=e(14348),le=e(7928);class _ extends l.Bs{constructor(Ft){super({}),this.tabId=F.Queries,this.icon="database",this.onOpenInspector=()=>{this._panelManager.inspectPanel()},this.onChangeDataSource=async(Ht,ut)=>{this._panelManager.changePanelDataSource(Ht,ut)},this.onQueryOptionsChange=Ht=>{this._panelManager.changeQueryOptions(Ht)},this.onQueriesChange=Ht=>{this._panelManager.changeQueries(Ht)},this.onRunQueries=()=>{this._panelManager.queryRunner.runQueries()},this.addQueryClick=()=>{const Ht=this.getQueries();this.onQueriesChange((0,q.U7)(Ht,this.newQuery()))},this.onAddQuery=Ht=>{const ut=this.getQueries(),pn=this._panelManager.state.dsSettings;this.onQueriesChange((0,q.U7)(ut,Ht,pn?(0,W.p$)(pn):{type:void 0,uid:void 0}))},this.onAddExpressionClick=()=>{const Ht=this.getQueries();this.onQueriesChange((0,q.U7)(Ht,G.Ex.newQuery()))},this.TabComponent=Ht=>ae({...Ht,model:this}),this._panelManager=Ft}static{this.Component=Q}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}buildQueryOptions(){const Ft=this._panelManager,Ht=this._panelManager.state.panel,ut=this._panelManager.queryRunner,pn=l.jh.getTimeRange(Ht);let Jn={from:void 0,shift:void 0,hide:void 0};pn instanceof le.v&&(Jn={from:pn.state.timeFrom,shift:pn.state.timeShift,hide:pn.state.hideTimeOverride});let Qn=ut.state.queries;return{cacheTimeout:Ft.state.dsSettings?.meta.queryOptions?.cacheTimeout?ut.state.cacheTimeout:void 0,queryCachingTTL:Ft.state.dsSettings?.cachingConfig?.enabled?ut.state.queryCachingTTL:void 0,dataSource:{default:Ft.state.dsSettings?.isDefault,...Ft.state.dsSettings?(0,W.p$)(Ft.state.dsSettings):{type:void 0,uid:void 0}},queries:Qn,maxDataPoints:ut.state.maxDataPoints,minInterval:ut.state.minInterval,timeRange:Jn}}getQueries(){return this._panelManager.queryRunner.state.queries}newQuery(){const{dsSettings:Ft,datasource:Ht}=this._panelManager.state;let ut;return Ft?.meta.mixed?Ht?.meta.mixed?ut=(0,Y.l)().getInstanceSettings(s.$.defaultDatasource):ut=Ht:ut=Ft,{...Ht?.getDefaultQuery?.(z.Jk.PanelEditor),datasource:{uid:ut?.uid,type:ut?.type}}}isExpressionsSupported(Ft){return(Ft.meta.alerting||Ft.meta.mixed)===!0}renderExtraActions(){return te.m.getAllExtraRenderAction().map((Ft,Ht)=>Ft({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:Ht})).filter(Boolean)}get queryRunner(){return this._panelManager.queryRunner}get panelManager(){return this._panelManager}}function Q({model:wt}){const{datasource:Ft,dsSettings:Ht}=wt.panelManager.useState(),{data:ut,queries:pn}=wt.panelManager.queryRunner.useState();if(!Ft||!Ht||!ut)return null;const Jn=!(0,ne.kN)(Ht.name);return(0,o.jsxs)("div",{"data-testid":c.Tp.components.QueryTab.content,children:[(0,o.jsx)(se.K,{data:ut,dsSettings:Ht,dataSource:Ft,options:wt.buildQueryOptions(),onDataSourceChange:wt.onChangeDataSource,onOptionsChange:wt.onQueryOptionsChange,onOpenQueryInspector:wt.onOpenInspector}),(0,o.jsx)(H.L,{data:ut,queries:pn,dsSettings:Ht,onAddQuery:wt.onAddQuery,onQueriesChange:wt.onQueriesChange,onRunQueries:wt.onRunQueries}),(0,o.jsxs)(X.B,{gap:2,children:[Jn&&(0,o.jsx)(L.$n,{icon:"plus",onClick:wt.addQueryClick,variant:"secondary","data-testid":c.Tp.components.QueryTab.addQuery,children:"Add query"}),s.$.expressionsEnabled&&wt.isExpressionsSupported(Ht)&&(0,o.jsx)(L.$n,{icon:"plus",onClick:wt.onAddExpressionClick,variant:"secondary","data-testid":c.Tp.components.QueryTab.addExpression,children:(0,o.jsx)("span",{children:"Expression\xA0"})}),wt.renderExtraActions()]})]})}function ae(wt){const{model:Ft}=wt,Ht=Ft.queryRunner.useState();return(0,o.jsx)(D.o,{label:Ft.getTabLabel(),icon:"database",counter:Ht.queries.length,active:wt.active,onChangeTab:wt.onChangeTab},wt.key)}var oe=e(91076),J=e(96540),ee=e(19727),de=e(96374),xe=e(57650),re=e(79280),ue=e(97497),Te=e(29158),ge=e(21427),Oe=e(66879);function Ue(wt){const{isOpen:Ft,series:Ht,onClose:ut,onTransformationAdd:pn}=wt,[Jn,Qn]=(0,J.useState)({search:"",showIllustrations:!0}),fs=bs=>Qn({...Jn,search:bs.currentTarget.value}),ls=bs=>Qn({...Jn,showIllustrations:bs}),vs=bs=>Qn({...Jn,selectedFilter:bs}),ea=(0,J.useMemo)(()=>ue.h.list().sort((bs,Ys)=>bs.name>Ys.name?1:Ys.name>bs.name?-1:0),[]),Ks=ea.filter(bs=>Jn.selectedFilter&&Jn.selectedFilter!==Oe.e&&!bs.categories?.has(Jn.selectedFilter)?!1:bs.name.toLocaleLowerCase().includes(Jn.search.toLocaleLowerCase())),Hs=(0,o.jsxs)(o.Fragment,{children:[Ks.length," / ",ea.length," \xA0\xA0",(0,o.jsx)(Te.K,{name:"times",onClick:()=>{Qn({...Jn,search:""})},tooltip:"Clear search"})]});if(Ft)return(0,o.jsx)(ge.R,{data:Ht,onTransformationAdd:pn,xforms:Ks,search:Jn.search,noTransforms:!1,suffix:Jn.search!==""?Hs:(0,o.jsx)(o.Fragment,{}),selectedFilter:Jn.selectedFilter,onSearchChange:fs,onSearchKeyDown:()=>{},showIllustrations:Jn.showIllustrations,onShowIllustrationsChange:ls,onSelectedFilterChange:vs,onClose:ut})}class Xe extends l.Bs{constructor(Ft){super({}),this.tabId=F.Transformations,this.icon="process",this.TabComponent=Ht=>Ce({...Ht,model:this}),this._panelManager=Ft}static{this.Component=we}getTabLabel(){return"Transformations"}getQueryRunner(){return this._panelManager.queryRunner}getDataTransformer(){return this._panelManager.dataTransformer}onChangeTransformations(Ft){this._panelManager.changeTransformations(Ft)}get panelManager(){return this._panelManager}}function we({model:wt}){const Ft=(0,a.of)(We),Ht=wt.getQueryRunner().useState(),{data:ut,transformations:pn}=wt.getDataTransformer().useState(),Jn=pn,[Qn,fs]=(0,J.useState)(!1),[ls,vs]=(0,J.useState)(!1),ea=()=>fs(!0),Ks=()=>fs(!1);if(!ut||!Ht.data)return;const Hs=(0,o.jsx)(Ue,{onClose:Ks,onTransformationAdd:bs=>{bs.value!==void 0&&(wt.onChangeTransformations([...Jn,{id:bs.value,options:{}}]),Ks())},isOpen:Qn,series:ut.series});return Jn.length<1?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(re.p,{onShowPicker:ea}),Hs]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(qe,{data:Ht.data,transformations:Jn,model:wt}),(0,o.jsxs)(ee.e,{children:[(0,o.jsx)(L.$n,{icon:"plus",variant:"secondary",onClick:ea,"data-testid":c.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),(0,o.jsx)(L.$n,{"data-testid":c.Tp.components.Transforms.removeAllTransformationsButton,className:Ft.removeAll,icon:"times",variant:"secondary",onClick:()=>vs(!0),children:"Delete all transformations"})]}),(0,o.jsx)(de.u,{isOpen:ls,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{wt.onChangeTransformations([]),vs(!1)},onDismiss:()=>vs(!1)}),Hs]})}function qe({transformations:wt,model:Ft,data:Ht}){const ut=wt.map((Jn,Qn)=>({id:`${Qn} - ${Jn.id}`,transformation:Jn})),pn=Jn=>{if(!Jn||!Jn.destination)return;const Qn=Jn.source.index,fs=Jn.destination.index;if(Qn===fs)return;const ls=Array.from(ut),[vs]=ls.splice(Qn,1);ls.splice(fs,0,vs),Ft.onChangeTransformations(ls.map(ea=>ea.transformation))};return(0,o.jsx)(oe.JY,{onDragEnd:pn,children:(0,o.jsx)(oe.gL,{droppableId:"transformations-list",direction:"vertical",children:Jn=>(0,o.jsxs)("div",{ref:Jn.innerRef,...Jn.droppableProps,children:[(0,o.jsx)(xe.A,{onChange:(Qn,fs)=>{const ls=wt.slice();ls[Qn]=fs,Ft.onChangeTransformations(ls)},onRemove:Qn=>{const fs=wt.slice();fs.splice(Qn,1),Ft.onChangeTransformations(fs)},configs:ut,data:Ht}),Jn.placeholder]})})})}const We=wt=>({removeAll:(0,d.css)({marginLeft:wt.spacing(2)})});function Ce(wt){const{model:Ft}=wt,Ht=Ft.getDataTransformer().useState();return(0,o.jsx)(D.o,{label:Ft.getTabLabel(),icon:"process",counter:Ht.transformations.length,active:wt.active,onChangeTab:wt.onChangeTab},wt.key)}class je extends l.Bs{constructor(Ft){super({tab:F.Queries,tabs:[]}),this._urlSync=new l.So(this,{keys:["tab"]}),this.onChangeTab=Ht=>{this.setState({tab:Ht.tabId})},this.panelManager=Ft,this.addActivationHandler(()=>this.onActivate())}static{this.Component=Ke}getUrlState(){return{tab:this.state.tab}}updateFromUrl(Ft){Ft.tab&&typeof Ft.tab=="string"&&this.setState({tab:Ft.tab})}onActivate(){return this.buildTabs(),this._subs.add(this.panelManager.subscribeToState((Ft,Ht)=>{Ft.pluginId!==Ht.pluginId&&this.buildTabs()})),()=>{this.panelSubscription&&(this.panelSubscription.unsubscribe(),this.panelSubscription=void 0)}}buildTabs(){const Ft=this.panelManager,Ht=Ft.state.panel,ut=Ft.state.pluginId,pn=this.panelManager.queryRunner,Jn=[];if(Ht)if(x.config.panels[ut]?.skipDataQuery){this.setState({tabs:Jn});return}else pn&&Jn.push(new _(this.panelManager)),Jn.push(new Xe(this.panelManager)),_e(Ft.state.pluginId)&&Jn.push(new U(this.panelManager));this.setState({tabs:Jn})}}function Ke({model:wt}){const{tab:Ft,tabs:Ht}=wt.useState(),ut=(0,a.of)(Fe);if(!Ht||!Ht.length)return;const pn=Ht.find(Jn=>Jn.tabId===Ft);return(0,o.jsxs)("div",{className:ut.dataPane,"data-testid":c.Tp.components.PanelEditor.DataPane.content,children:[(0,o.jsx)(p.U,{hideBorder:!0,className:ut.tabsBar,children:Ht.map((Jn,Qn)=>(0,o.jsx)(Jn.TabComponent,{active:Jn.tabId===Ft,onChangeTab:()=>wt.onChangeTab(Jn)},`${Jn.getTabLabel()}-${Qn}`))}),(0,o.jsx)(u.E,{className:ut.scroll,children:(0,o.jsx)(m.J,{className:ut.tabContent,children:(0,o.jsx)(v.mc,{children:pn&&(0,o.jsx)(pn.Component,{model:pn})})})})]})}function _e(wt){const{unifiedAlertingEnabled:Ft=!1}=(0,x.zj)(),Ht=f.contextSrv.hasPermission((0,E.Wd)(h.hY).read);return Ft&&Ht?wt==="graph"||wt==="timeseries":!1}function Fe(wt){return{dataPane:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,d.css)({padding:wt.spacing(2),border:`1px solid ${wt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:wt.shape.radius.default,flexGrow:1}),tabsBar:(0,d.css)({flexShrink:0,paddingLeft:wt.spacing(2)}),scroll:(0,d.css)({background:wt.colors.background.primary})}}var at=e(27746),Ct=e(73667),Dt=e(54174),tt=e(40996),ze=e(37390),pe=e(10354),Se=e(14578),fe=e(57767),Ee=e(43535);const Pe=({libraryPanel:wt,isUnsavedPrompt:Ft,onDismiss:Ht,onConfirm:ut,onDiscard:pn})=>{const[Jn,Qn]=(0,J.useState)(""),fs=(0,R.A)(async()=>{const bs=await(0,fe.xV)(wt.state.uid);return bs.length>0?bs.map(Ys=>Ys.title):[]},[wt.state.uid]),[ls,vs]=(0,J.useState)([]);(0,tt.A)(()=>fs.value?vs(fs.value.filter(bs=>bs.toLowerCase().includes(Jn.toLowerCase()))):vs([]),300,[fs.value,Jn]);const ea=(0,a.of)(Ee.o),Ks=(0,J.useCallback)(()=>{pn()},[pn]),Hs=Ft?"Unsaved library panel changes":"Save library panel";return(0,o.jsx)(ze.a,{title:Hs,icon:"save",onDismiss:Ht,isOpen:!0,children:(0,o.jsxs)("div",{children:[(0,o.jsxs)("p",{className:ea.textInfo,children:["This update will affect ",(0,o.jsxs)("strong",{children:[wt.state._loadedPanel?.meta?.connectedDashboards," ",wt.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."]}),"The following dashboards using the panel will be affected:"]}),(0,o.jsx)(pe.p,{className:ea.dashboardSearch,prefix:(0,o.jsx)(Se.I,{name:"search"}),placeholder:"Search affected dashboards",value:Jn,onChange:bs=>Qn(bs.currentTarget.value)}),fs.loading?(0,o.jsx)("p",{children:"Loading connected dashboards..."}):(0,o.jsxs)("table",{className:ea.myTable,children:[(0,o.jsx)("thead",{children:(0,o.jsx)("tr",{children:(0,o.jsx)("th",{children:"Dashboard name"})})}),(0,o.jsx)("tbody",{children:ls.map((bs,Ys)=>(0,o.jsx)("tr",{children:(0,o.jsx)("td",{children:bs})},`dashrow-${Ys}`))})]}),(0,o.jsxs)(ze.a.ButtonRow,{children:[(0,o.jsx)(L.$n,{variant:"secondary",onClick:Ht,fill:"outline",children:"Cancel"}),Ft&&(0,o.jsx)(L.$n,{variant:"destructive",onClick:Ks,children:"Discard"}),(0,o.jsx)(L.$n,{onClick:()=>{ut()},children:"Update all"})]})]})})};var he=e(21633);function be(wt){const{paneOptions:Ft}=wt,[Ht,ut]=(0,J.useState)({collapsed:!1}),pn=(0,J.useCallback)((Ks,Hs)=>{if(Ks<=0&&Hs<=0)return;const bs=Hs/Ks*(1-Ks);Ht.collapsed&&bs>Ft.collapseBelowPixels&&ut({collapsed:!1}),!Ht.collapsed&&bs<Ft.collapseBelowPixels&&ut({collapsed:!0})},[Ht,Ft.collapseBelowPixels]),Jn=(0,J.useCallback)((Ks,Hs)=>{if(Ks<=0&&Hs<=0)return;const bs=1-Ks,Ys=Ht.snapSize===0,La=Hs/Ks,Ta=(Ft.snapOpenToPixels??La/2)/La;Ht.collapsed?ut(Ys?{snapSize:Math.max(bs,Ta),collapsed:!1}:{snapSize:0,collapsed:!0}):Ys&&ut({snapSize:bs,collapsed:!1})},[Ht,Ft.snapOpenToPixels]),Qn=(0,J.useCallback)(()=>{ut({collapsed:!Ht.collapsed})},[Ht.collapsed]),{containerProps:fs,primaryProps:ls,secondaryProps:vs,splitterProps:ea}=(0,he.h)({...wt,onResizing:pn,onSizeChanged:Jn});return vs.style.overflow="hidden",vs.style.minWidth="unset",vs.style.minHeight="unset",Ht.snapSize?(ls.style={...ls.style,flexGrow:1-Ht.snapSize},vs.style.flexGrow=Ht.snapSize):Ht.snapSize===0&&(ls.style.flexGrow=1,vs.style.flexGrow=0,vs.style.minWidth="unset",vs.style.minHeight="unset",vs.style.overflow="unset"),{containerProps:fs,primaryProps:ls,secondaryProps:vs,splitterProps:ea,splitterState:Ht,onToggleCollapse:Qn}}function Ae({model:wt}){const Ft=(0,g.YQ)(wt),{optionsPane:Ht}=wt.useState(),ut=(0,a.of)(Ie),{containerProps:pn,primaryProps:Jn,secondaryProps:Qn,splitterProps:fs,splitterState:ls,onToggleCollapse:vs}=be({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Ct.c,{dashboard:Ft}),(0,o.jsxs)("div",{...pn,className:(0,d.cx)(pn.className,{[ut.content]:s.$.featureToggles.bodyScrolling}),"data-testid":c.Tp.components.PanelEditor.General.content,children:[(0,o.jsx)("div",{...Jn,className:(0,d.cx)(Jn.className,ut.body),children:(0,o.jsx)(De,{model:wt})}),(0,o.jsx)("div",{...fs}),(0,o.jsxs)("div",{...Qn,className:(0,d.cx)(Qn.className,ut.optionsPane),children:[ls.collapsed&&(0,o.jsx)("div",{className:ut.expandOptionsWrapper,children:(0,o.jsx)(at.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:vs,variant:"canvas",className:ut.rotate180,"aria-label":"Open options pane"})}),!ls.collapsed&&(0,o.jsx)(Ht.Component,{model:Ht})]})]})]})}function De({model:wt}){const Ft=(0,g.YQ)(wt),{vizManager:Ht,dataPane:ut,showLibraryPanelSaveModal:pn,showLibraryPanelUnlinkModal:Jn}=wt.useState(),{sourcePanel:Qn}=Ht.useState(),fs=(0,g.Yr)(Qn.resolve()),{controls:ls,scopes:vs}=Ft.useState(),ea=(0,a.of)(Ie),{containerProps:Ks,primaryProps:Hs,secondaryProps:bs,splitterProps:Ys,splitterState:La,onToggleCollapse:Xs}=be({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return Ks.className=(0,d.cx)(Ks.className,ea.container),ut||(Hs.style.flexGrow=1),(0,o.jsxs)("div",{className:(0,d.cx)(ea.pageContainer,ls&&!vs&&ea.pageContainerWithControls,vs&&ea.pageContainerWithScopes),children:[vs&&(0,o.jsx)(vs.Component,{model:vs}),ls&&(0,o.jsx)("div",{className:(0,d.cx)(ea.controlsWrapper,vs&&ea.controlsWrapperWithScopes),children:(0,o.jsx)(ls.Component,{model:ls})}),(0,o.jsxs)("div",{...Ks,children:[(0,o.jsx)("div",{...Hs,children:(0,o.jsx)(Ht.Component,{model:Ht})}),pn&&fs&&(0,o.jsx)(Pe,{libraryPanel:fs,onDismiss:wt.onDismissLibraryPanelSaveModal,onConfirm:wt.onConfirmSaveLibraryPanel,onDiscard:wt.onDiscard}),Jn&&fs&&(0,o.jsx)(Dt.l,{onDismiss:wt.onDismissUnlinkLibraryPanelModal,onConfirm:wt.onConfirmUnlinkLibraryPanel,isOpen:!0}),ut&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{...Ys}),(0,o.jsxs)("div",{...bs,children:[La.collapsed&&(0,o.jsx)("div",{className:ea.expandDataPane,children:(0,o.jsx)(L.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Xs,variant:"secondary",size:"sm",className:ea.openDataPaneButton,"aria-label":"Open query pane"})}),!La.collapsed&&(0,o.jsx)(ut.Component,{model:ut})]})]})]})]})}function Ie(wt){return{pageContainer:(0,d.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,d.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,d.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${wt.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),container:(0,d.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,d.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,d.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,d.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,d.css)({flexDirection:"column",borderLeft:`1px solid ${wt.colors.border.weak}`,background:wt.colors.background.primary}),expandOptionsWrapper:(0,d.css)({display:"flex",flexDirection:"column",padding:wt.spacing(2,1)}),expandDataPane:(0,d.css)({display:"flex",flexDirection:"row",padding:wt.spacing(1),borderTop:`1px solid ${wt.colors.border.weak}`,borderRight:`1px solid ${wt.colors.border.weak}`,background:wt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,d.css)({rotate:"180deg"}),controlsWrapper:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:wt.spacing(2,0,2,2)}),controlsWrapperWithScopes:(0,d.css)({padding:wt.spacing(2,0)}),openDataPaneButton:(0,d.css)({width:wt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}})}}var ke=e(67647),dt=e(26443),Pt=e(41394),pt=e(17706),Tt=e(22290),jt=e(66211),$t=e(15292),sn=e(94354),Yt=e(90182),qt=e(64919),bn=e(21744),Mt=e(20214),Jt=e(74410),Ut=e(48192),Gt=e(74097),Lt=e(92378),At=e(6923),Nt=e(20455),Dn=e(32023);function An(wt,Ft,Ht){const ut=new Ut.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),pn=Dn.b4.getPanelLinks(Ft),Jn=pn?.state.rawLinks??[],Qn=(0,g.YQ)(Ft);return ut.addItem(new Gt.v({title:"Title",value:Ft.state.title,popularRank:1,render:function(){return(0,o.jsx)(Xn,{vizManager:wt})},addon:s.$.featureToggles.dashgpt&&(0,o.jsx)(Jt.h,{onGenerate:fs=>wt.setPanelTitle(fs),panel:(0,Nt.Z6)(Ft),dashboard:(0,Nt.Uy)(Qn)})})).addItem(new Gt.v({title:"Description",value:Ft.state.description,render:function(){return(0,o.jsx)(Tn,{panel:Ft})},addon:s.$.featureToggles.dashgpt&&(0,o.jsx)(Mt.t,{onGenerate:fs=>Ft.setState({description:fs}),panel:(0,Nt.Z6)(Ft)})})).addItem(new Gt.v({title:"Transparent background",render:function(){return(0,o.jsx)($t.d,{value:Ft.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{Ft.setState({displayMode:Ft.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new Ut.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:Jn?.length}).addItem(new Gt.v({title:"Panel links",render:()=>(0,o.jsx)(Pn,{panelLinks:pn??void 0})}))).addCategory(new Ut.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new Gt.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,o.jsx)(Lt.U,{id:"repeat-by-variable-select",parent:Ft,repeat:Ht,onChange:ls=>{const vs={repeat:ls};ls&&!wt.state.repeatDirection&&(vs.repeatDirection="h"),wt.setState(vs)}})}})).addItem(new Gt.v({title:"Repeat direction",showIf:()=>!!wt.state.repeat,render:function(){const ls=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,o.jsx)(sn.z,{options:ls,value:wt.state.repeatDirection??"h",onChange:vs=>wt.setState({repeatDirection:vs})})}})).addItem(new Gt.v({title:"Max per row",showIf:()=>!!(wt.state.repeat&&wt.state.repeatDirection==="h"),render:function(){const ls=[2,3,4,6,8,12].map(vs=>({label:vs.toString(),value:vs}));return(0,o.jsx)(Yt.l6,{options:ls,value:wt.state.maxPerRow,onChange:vs=>wt.setState({maxPerRow:vs.value})})}})))}function Pn({panelLinks:wt}){const{rawLinks:Ft}=wt?wt.useState():{rawLinks:[]};return(0,o.jsx)(qt.e,{links:Ft,onChange:Ht=>wt?.setState({rawLinks:Ht}),getSuggestions:At.Fq,data:[]})}function Xn({vizManager:wt}){const{title:Ft}=wt.state.panel.useState();return(0,o.jsx)(pe.p,{"data-testid":c.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),value:Ft,onChange:Ht=>wt.setPanelTitle(Ht.currentTarget.value)})}function Tn({panel:wt}){const{description:Ft}=wt.useState();return(0,o.jsx)(bn.f,{id:"description-text-area",value:Ft,onChange:Ht=>wt.setState({description:Ht.currentTarget.value})})}const ht=J.memo(({vizManager:wt,searchQuery:Ft,listMode:Ht,data:ut})=>{const{panel:pn,sourcePanel:Jn,repeat:Qn}=wt.useState(),fs=Jn.resolve().parent,{options:ls,fieldConfig:vs,_pluginInstanceState:ea}=pn.useState(),Ks=(0,J.useMemo)(()=>An(wt,pn,Qn),[wt,pn,Qn]),Hs=(0,J.useMemo)(()=>{const Ta=pn.getPlugin();if(Ta)return(0,jt.Z4)({panel:pn,data:ut,plugin:Ta,eventBus:pn.getPanelContext().eventBus,instanceState:ea})},[pn,ls,vs,ea]),bs=(0,J.useMemo)(()=>{if(fs instanceof i.F)return(0,jt.tN)(fs)},[fs]),Ys=(0,J.useMemo)(()=>(0,Tt.v)(vs,pn.getPlugin()?.fieldConfigRegistry,ut?.series??[],Ft,Ta=>{pn.onFieldConfigChange(Ta,!0)}),[Ft,pn,vs]),La=Ft.length>0,Xs=[];if(La)Xs.push((0,dt.Po)([Ks,...bs?[bs]:[],...Hs??[]],Ys,Ft));else switch(Ht){case dt.gs.All:bs&&Xs.push(bs.render()),Xs.push(Ks.render());for(const Ta of Hs??[])Xs.push(Ta.render());for(const Ta of Ys)Xs.push(Ta.render());break;case dt.gs.Overrides:for(const Ta of Ys)Xs.push(Ta.render());default:break}return Xs});ht.displayName="PanelOptions";var St=e(78685),Ge=e(88575),Ve=e(15054),lt=e(32696),It=e(56707),Qe=e(86292),vt=e(53543);function Ot({vizManager:wt,data:Ft,onChange:Ht}){const{panel:ut}=wt.useState(),pn=(0,a.of)(zt),[Jn,Qn]=(0,J.useState)(""),fs=!1,ls=fs?Ve.MM:Ve.wV,vs=fs?lt.__.Widgets:lt.__.Visualizations,ea=(0,J.useMemo)(()=>new vt.R(ut),[ut]),Ks=(0,J.useMemo)(()=>new Set([lt.__.Widgets,lt.__.Visualizations,lt.__.Suggestions]),[]),[Hs,bs]=(0,St.A)(ls,vs);(0,J.useEffect)(()=>{Hs&&!Ks.has(Hs)&&bs(vs)},[vs,Hs,bs,Ks]);const Ys=[{label:"Visualizations",value:lt.__.Visualizations},{label:"Suggestions",value:lt.__.Suggestions}],La=Xs=>{wt.changePluginType(Xs.pluginId),Ht()};return(0,o.jsxs)("div",{className:pn.wrapper,children:[(0,o.jsx)(ke.Z,{className:pn.filter,value:Jn,onChange:Qn,autoFocus:!0,placeholder:"Search for..."}),(0,o.jsx)(Ge.D,{className:pn.customFieldMargin,children:(0,o.jsx)(sn.z,{options:Ys,value:Hs,onChange:bs,fullWidth:!0})}),(0,o.jsxs)(u.E,{children:[Hs===lt.__.Visualizations&&(0,o.jsx)(Qe.G,{pluginId:ut.state.pluginId,searchQuery:Jn,onChange:La}),Hs===lt.__.Suggestions&&(0,o.jsx)(It.a,{onChange:La,searchQuery:Jn,panel:ea,data:Ft})]})]})}const zt=wt=>({wrapper:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:wt.spacing(2,1),height:"100%",gap:wt.spacing(2),border:`1px solid ${wt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:wt.shape.radius.default}),customFieldMargin:(0,d.css)({marginBottom:wt.spacing(1)}),filter:(0,d.css)({minHeight:wt.spacing(4)})});class vn extends l.Bs{constructor(Ft){super({searchQuery:"",listMode:dt.gs.All,...Ft}),this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onSetSearchQuery=Ht=>{this.setState({searchQuery:Ht})},this.onSetListMode=Ht=>{this.setState({listMode:Ht})}}static{this.Component=({model:Ft})=>{const{isVizPickerOpen:Ht,searchQuery:ut,listMode:pn}=Ft.useState(),Jn=l.jh.getAncestor(Ft,cs).state.vizManager,{pluginId:Qn}=Jn.useState(),{data:fs}=l.jh.getData(Jn.state.panel).useState(),ls=(0,a.of)(ln);return(0,o.jsxs)(o.Fragment,{children:[!Ht&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:ls.top,children:[(0,o.jsx)(On,{pluginId:Qn,onOpen:Ft.onToggleVizPicker}),(0,o.jsx)(ke.Z,{className:ls.searchOptions,value:ut,placeholder:"Search options",onChange:Ft.onSetSearchQuery})]}),(0,o.jsx)("div",{className:ls.listOfOptions,children:(0,o.jsx)(ht,{vizManager:Jn,searchQuery:ut,listMode:pn,data:fs})})]}),Ht&&(0,o.jsx)(Ot,{vizManager:Jn,onChange:Ft.onToggleVizPicker,data:fs})]})}}}function ln(wt){return{top:(0,d.css)({display:"flex",flexDirection:"column",padding:wt.spacing(2,1),gap:wt.spacing(2)}),listOfOptions:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,d.css)({minHeight:wt.spacing(4)}),searchWrapper:(0,d.css)({padding:wt.spacing(2,2,2,0)}),vizField:(0,d.css)({marginBottom:wt.spacing(1)}),rotateIcon:(0,d.css)({rotate:"180deg"})}}function On({pluginId:wt,onOpen:Ft}){const Ht=(0,a.of)(wn);let ut=(0,J.useMemo)(()=>(0,pt.A4)().filter(pn=>pn.id===wt)[0],[wt]);return ut||(ut=(0,Pt.$)(`Panel plugin not found (${wt})`,!0).meta),(0,o.jsx)(X.B,{gap:1,children:(0,o.jsx)(at.I,{className:Ht.vizButton,tooltip:"Click to change visualization",imgSrc:ut.info.logos.small,onClick:Ft,"data-testid":c.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0,children:ut.name})})}function wn(wt){return{vizButton:(0,d.css)({textAlign:"left"})}}var Un=e(89681);class cs extends l.Bs{constructor(Ft){super(Ft),this._initialRepeatOptions={},this._discardChanges=!1,this.onDiscard=()=>{this._discardChanges=!0,n.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{this.state.vizManager.commitChanges(),n.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{this.state.vizManager.unlinkLibraryPanel(),this.setState({showLibraryPanelUnlinkModal:!1})};const{repeat:Ht,repeatDirection:ut,maxPerRow:pn}=Ft.vizManager.state;this._initialRepeatOptions={repeat:Ht,repeatDirection:ut,maxPerRow:pn},this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=Ae}_activationHandler(){const Ft=this.state.vizManager,Ht=Ft.state.panel;return this._subs.add(Ft.subscribeToState((ut,pn)=>{ut.pluginId!==pn.pluginId&&this._initDataPane(ut.pluginId)})),this._initDataPane(Ht.state.pluginId),()=>{this._discardChanges?this.state.isNewPanel&&(0,g.YQ)(this).removePanel(Ft.state.sourcePanel.resolve()):this.commitChanges()}}_initDataPane(Ft){const Ht=s.$.panels[Ft]?.skipDataQuery;Ht&&this.state.dataPane&&(n.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),!Ht&&!this.state.dataPane&&this.setState({dataPane:new je(this.state.vizManager)})}getUrlKey(){return this.state.panelId.toString()}getPageNav(Ft,Ht){return{text:"Edit panel",parentItem:(0,g.YQ)(this).getPageNav(Ft,Ht)}}commitChanges(){const Ft=(0,g.YQ)(this);Ft.state.isEditing||Ft.onEnterEditMode();const pn=this.state.vizManager.state.sourcePanel.resolve().parent,Jn=pn instanceof i.F,Qn=Jn?pn.parent:pn;if(!Jn){if(!(Qn instanceof r.U)){console.error("Unsupported scene object type");return}this.commitChangesToSource(Qn)}}commitChangesToSource(Ft){let Ht=Ft.state.width??1,ut=Ft.state.height;const pn=this.state.vizManager,Jn=this._initialRepeatOptions.repeatDirection==="h"&&pn.state.repeatDirection==="v",Qn=this._initialRepeatOptions.repeatDirection==="v"&&pn.state.repeatDirection==="h";Jn?Ht=Math.floor(Ht/(Ft.state.maxPerRow??1)):Qn&&(Ht=24),Ft.setState({body:pn.state.panel.clone(),repeatDirection:pn.state.repeatDirection,variableName:pn.state.repeat,maxPerRow:pn.state.maxPerRow,width:Ht,height:ut})}}function Zn(wt,Ft=!1){return new cs({panelId:(0,g.Cs)(wt),optionsPane:new vn({}),vizManager:Un.j.createFor(wt),isNewPanel:Ft})}},89681:(k,A,e)=>{"use strict";e.d(A,{j:()=>I});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(22391),o=e(581),d=e(19347),c=e(32264),a=e(39601),p=e(80943),u=e(40845),m=e(36974),v=e(47311),x=e(57767),f=e(93117),E=e(13530),h=e(45429),y=e(41507),b=e(60656),D=e(7928),P=e(20455),C=e(74730),M=(T=>(T[T.Fill=0]="Fill",T[T.Fit=1]="Fit",T[T.Exact=2]="Exact",T))(M||{});class I extends p.Bs{constructor(S){super(S),this._cachedPluginOptions={},this._detectPanelModelChanges=(0,l.debounce)(()=>{const{hasChanges:L}=(0,h.yO)((0,P.Z6)(this.state.sourcePanel.resolve()),(0,P.Z6)(this.state.panel));this.setState({isDirty:L})},250),this._handleStateChange=L=>{E.l.isUpdatingPersistedState(L)&&this._detectPanelModelChanges()},this.addActivationHandler(()=>this._onActivate())}static createFor(S){let L={};const O=S.parent instanceof b.F?S.parent.parent:S.parent;if(!(O instanceof y.U))throw console.error("VizPanel is not a child of a dashboard grid item"),new Error("VizPanel is not a child of a dashboard grid item");const{variableName:j,repeatDirection:N,maxPerRow:F}=O.state;L={repeat:j,repeatDirection:N,maxPerRow:F};let U;return O.parent?.state.$variables&&(U=O.parent.state.$variables.clone()),new I({$variables:U,panel:S.clone(),sourcePanel:S.getRef(),pluginId:S.state.pluginId,...L})}_onActivate(){this.loadDataSource();const S=this.subscribeToEvent(p.bZ,this._handleStateChange);return()=>{S.unsubscribe()}}async loadDataSource(){if(!this.state.panel.state.$data)return;let L=this.queryRunner.state.datasource;try{let O,j;if(L)O=await(0,d.l)().get(L),j=(0,d.l)().getInstanceSettings(L);else{const F=(0,C.YQ)(this).state.uid??"",U=(0,m.CW)(F);U?.datasourceUid!==null&&(j=(0,d.l)().getInstanceSettings({uid:U?.datasourceUid}),j&&(O=await(0,d.l)().get({uid:U?.datasourceUid,type:j.type}),this.queryRunner.setState({datasource:{...(0,g.p$)(j),uid:U?.datasourceUid}})))}O&&j&&(this.setState({datasource:O,dsSettings:j}),(0,v.tw)((0,g.p$)(j)||{default:!0}))}catch(O){const j=await(0,d.l)().get(c.$.defaultDatasource),N=(0,d.l)().getInstanceSettings(c.$.defaultDatasource);j&&N&&(this.setState({datasource:j,dsSettings:N}),this.queryRunner.setState({datasource:(0,g.p$)(N)})),console.error(O)}}changePluginType(S){const{options:L,fieldConfig:O,pluginId:j}=this.state.panel.state;let N={defaults:{...O.defaults,custom:{}},overrides:(0,o.aW)(O.overrides,o.nx)};this._cachedPluginOptions[j]={options:L,fieldConfig:O};const F=this._cachedPluginOptions[S]?.options,U=this._cachedPluginOptions[S]?.fieldConfig;if(U&&(N=(0,o.H9)(N,U)),!this.state.panel.state.$data&&!c.$.panels[S].skipDataQuery){let w=(0,m.CW)((0,C.YQ)(this).state.uid)?.datasourceUid;w||(w=c.$.defaultDatasource),this.state.panel.setState({$data:new p.Es({$data:new p.dt({datasource:{uid:w},queries:[{refId:"A"}]}),transformations:[]})})}this.setState({pluginId:S}),this.state.panel.changePluginType(S,F,N),this.loadDataSource()}async changePanelDataSource(S,L){const{dsSettings:O}=this.state,j=this.queryRunner,N=O?await(0,d.l)().get({uid:O.uid}):void 0,F=await(0,d.l)().get({uid:S.uid}),U=j.state.queries,w=L||await(0,f.y)(F,S.uid,U,N);j.setState({datasource:(0,g.p$)(S),queries:w}),L&&j.runQueries(),this.loadDataSource()}changeQueryOptions(S){const L=this.state.panel,O=this.queryRunner,j=L.state.$timeRange,N={},F={};S.maxDataPoints!==O.state.maxDataPoints&&(N.maxDataPoints=S.maxDataPoints??void 0),S.minInterval!==O.state.minInterval&&S.minInterval!==null&&(N.minInterval=S.minInterval),S.timeRange&&(F.timeFrom=S.timeRange.from??void 0,F.timeShift=S.timeRange.shift??void 0,F.hideTimeOverride=S.timeRange.hide),j instanceof D.v?F.timeFrom!==void 0||F.timeShift!==void 0?j.setState(F):L.setState({$timeRange:void 0}):L.setState({$timeRange:new D.v(F)}),S.cacheTimeout!==O?.state.cacheTimeout&&(N.cacheTimeout=S.cacheTimeout),S.queryCachingTTL!==O?.state.queryCachingTTL&&(N.queryCachingTTL=S.queryCachingTTL),O.setState(N),O.runQueries()}changeQueries(S){this.queryRunner.setState({queries:S})}changeTransformations(S){const L=this.dataTransformer;L.setState({transformations:S}),L.reprocessTransformations()}inspectPanel(){const S=this.state.panel,L=(0,C.Cs)(S);a.Ny.partial({inspect:L,inspectTab:"query"})}get queryRunner(){const S=(0,C.un)(this.state.panel);if(!S)throw new Error("Query runner not found");return S}get dataTransformer(){const S=this.state.panel.state.$data;if(!S||!(S instanceof p.Es))throw new Error("Could not find SceneDataTransformer for panel");return S}toggleTableView(){if(this.state.tableView){this.setState({tableView:void 0});return}this.setState({tableView:p.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(this.dataTransformer).build()})}unlinkLibraryPanel(){const S=this.state.sourcePanel.resolve();if(!(S.parent instanceof b.F))throw new Error("VizPanel is not a child of a library panel");const L=S.parent.parent;if(!(L instanceof y.U))throw new Error("Library panel not a child of a grid item");const O=this.state.panel.clone({$data:this.state.$data?.clone()});L.setState({body:O}),this.setState({sourcePanel:O.getRef()})}commitChanges(){const S=this.state.sourcePanel.resolve();this.commitChangesTo(S)}commitChangesTo(S){const L={variableName:this.state.repeat,repeatDirection:this.state.repeatDirection,maxPerRow:this.state.maxPerRow};if(S.parent instanceof y.U&&S.parent.setState({...L,body:this.state.panel.clone()}),S.parent instanceof b.F&&S.parent.parent instanceof y.U){const O=S.parent.clone({panel:this.state.panel.clone()});S.parent.parent.setState({body:O,...L}),(0,x.GX)(O).then(j=>{S.parent instanceof b.F&&O.setPanelFromLibPanel(j)})}}getPanelSaveModel(){const S=this.state.sourcePanel.resolve(),O=S.parent instanceof b.F?S.parent.parent:S.parent;if(!(O instanceof y.U))return{error:"Unsupported panel parent"};const j=O.clone({body:this.state.panel.clone()});return(0,P.ZB)(j)}setPanelTitle(S){this.state.panel.setState({title:S,hoverHeader:S===""})}static{this.Component=({model:S})=>{const{panel:L,tableView:O}=S.useState(),j=(0,u.of)(R),N=O??L,F=N.state.$data;return(0,i.useEffect)(()=>F?.activate(),[F]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:j.wrapper,children:(0,n.jsx)(N.Component,{model:N})})})}}}function R(T){return{wrapper:(0,s.css)({height:"100%",width:"100%",paddingLeft:T.spacing(2)})}}},13530:(k,A,e)=>{"use strict";e.d(A,{l:()=>v});var n=e(80943),s=e(67278);const l=()=>new s.c(new URL(e.p+e.u(9666),e.b));var r=e(89681),i=e(38477),g=e(33278),o=e(41507),d=e(34842),c=e(60656),a=e(42397),p=e(7928),u=e(20455),m=e(17663);class v{constructor(f){this._dashboard=f}static isUpdatingPersistedState({payload:f}){return Object.keys(f.partialUpdate).length===0?!1:!!(f.changedObject instanceof n.Eb||f.changedObject instanceof o.U||f.changedObject instanceof p.v||f.changedObject instanceof r.j&&(Object.prototype.hasOwnProperty.call(f.partialUpdate,"repeat")||Object.prototype.hasOwnProperty.call(f.partialUpdate,"repeatDirection")||Object.prototype.hasOwnProperty.call(f.partialUpdate,"maxPerRow"))||f.changedObject instanceof n.dt&&!Object.prototype.hasOwnProperty.call(f.partialUpdate,"data")||f.changedObject instanceof n.Es&&!Object.prototype.hasOwnProperty.call(f.partialUpdate,"data")||f.changedObject instanceof a.$||f.changedObject instanceof c.F&&Object.prototype.hasOwnProperty.call(f.partialUpdate,"name")||f.changedObject instanceof n.WM&&(Object.prototype.hasOwnProperty.call(f.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(f.partialUpdate,"refresh"))||f.changedObject instanceof n.Gg.K2||f.changedObject instanceof n.kh||f.changedObject instanceof o.U||f.changedObject instanceof n.hy||f.changedObject instanceof d.H$&&Object.keys(f.partialUpdate).some(E=>d.vk.includes(E))||f.changedObject instanceof n.JZ||f.changedObject instanceof g.x&&Object.prototype.hasOwnProperty.call(f.partialUpdate,"hideTimeControls")||f.changedObject instanceof n.Pj||f.changedObject instanceof i.g&&!Object.prototype.hasOwnProperty.call(f.partialUpdate,"data")||f.changedObject instanceof n.Gg.en||(0,m.c7)(f.changedObject))}onStateChanged(f){v.isUpdatingPersistedState(f)&&this.detectSaveModelChanges()}detectSaveModelChanges(){this._changesWorker?.postMessage({changed:(0,u.Uy)(this._dashboard),initial:this._dashboard.getInitialSaveModel()})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(f){const{hasChanges:E}=f;E||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=l()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=f=>{this.updateIsDirty(f.data)},this._changeTrackerSub=this._dashboard.subscribeToEvent(n.bZ,this.onStateChanged.bind(this))}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}},45429:(k,A,e)=>{"use strict";e.d(A,{Yy:()=>i,yO:()=>c});var n=e(56596);function s(a,p){try{let u=a;for(const m of p)u=u[m];return u}catch{return}}function l(a,p){return typeof a==typeof p&&(typeof a=="string"&&a===p||Array.isArray(a)&&a.length===p.length&&a.every((u,m)=>u===p[m]))}function r(a,p){return a===p||a&&p&&a.selected===p.selected&&l(a.text,p.text)&&l(a.value,p.value)}function i(a,p,u,m,v){const x=a,f=p,E=g(f,x),h=d(f,x,m),y=f.refresh!==x.refresh;u||(f.time=x.time),v||(f.refresh=x.refresh);const b=(0,n.G4)(x,f),D=Object.values(b).reduce((P,C)=>P+C.length,0);return{changedSaveModel:f,initialSaveModel:x,diffs:b,diffCount:D,hasChanges:D>0,hasTimeChanges:E,isNew:f.version===0,hasVariableValueChanges:h,hasRefreshChange:y}}function g(a,p){return a.time?.from!==p.time?.from||a.time?.to!==p.time?.to}function o(a,p){if(a.filters===void 0&&p.filters===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(a.filters===void 0&&p.filters!==void 0||p.filters===void 0&&a.filters!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(a.filters.length!==p.filters.length)return!1;for(let u=0;u<a.filters.length;u++){const m=a.filters[u],v=p.filters[u];if(m.key!==v.key||m.operator!==v.operator||m.value!==v.value)return!1}return!0}function d(a,p,u){const m=p.templating?.list??[],v=a.templating?.list??[];let x=!1;for(const f of v){const E=m.find(({name:h,type:y})=>h===f.name&&y===f.type);if(E&&(E.current&&delete E.current.selected,r(f.current,E.current)?f.type==="adhoc"&&!o(f,E)&&(x=!0):x=!0,!u)){const h=f;h.type==="adhoc"?h.filters=E.filters:(f.current=E.current,f.options=E.options)}}return x}function c(a,p){const u=(0,n.G4)(p,a),m=Object.values(u).reduce((v,x)=>v+x.length,0);return{changedSaveModel:a,initialSaveModel:p,diffs:u,diffCount:m,hasChanges:m>0}}},57109:(k,A,e)=>{"use strict";e.d(A,{o:()=>a});var n=e(74848),s=e(80943),l=e(87978),r=e(8484),i=e(16678),g=e(32023),o=e(74730),d=e(41507),c=e(60656);class a extends s.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,o.YQ)(this).closeModal()},this.onAddLibraryPanel=u=>{const m=(0,o.YQ)(this),v=m.state.body;if(!(v instanceof s.hy))throw new Error("Trying to add a library panel in a layout that is not SceneGridLayout");const x=g.b4.getNextPanelId(m),f=new c.F({title:"Panel Title",uid:u.uid,name:u.name,panelKey:(0,o.XA)(x)}),E=this.state.panelToReplaceRef?.resolve();if(E){const h=E.parent;if(!(h instanceof d.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");h.setState({body:f})}else{const h=new d.U({height:o.sw,width:o.vm,x:0,y:0,body:f,key:`grid-item-${x}`});v.setState({children:[h,...v.state.children]})}this.onClose()}}static{this.Component=({model:u})=>{const m=(0,r.t)("library-panel.add-widget.title","Add panel from panel library");return(0,n.jsx)(l._,{title:m,onClose:u.onClose,children:(0,n.jsx)(i.j,{onClick:u.onAddLibraryPanel,variant:i.s.Tight,showPanelFilter:!0})})}}}},91309:(k,A,e)=>{"use strict";e.d(A,{C:()=>P,S:()=>C});var n=e(65474),s=e(81160),l=e(52622),r=e(43585),i=e(14236),g=e(39070),o=e(32264),d=e(80943),c=e(82467),a=e(3169),p=e(10096),u=e(94954),m=e(79938),v=e(49498),x=e(55740),f=e(57220),E=e(23662),h=e(99140),y=e(31678),b=e(94822),D=e(74730);class P extends d.VE{constructor(I){super({isEnabled:!0,...I,isHidden:!0}),this.hasAlertRules=!0,this.topic=l.QR.AlertStates,this.handleError=R=>{const T=(0,a.gi)("AlertStatesDataLayer",(0,u.q)(R));(0,h.JD)((0,c.dx)(T))}}onEnable(){const I=d.jh.getTimeRange(this);this._timeRangeSub=I.subscribeToState(()=>{this.runWithTimeRange(I)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const I=d.jh.getTimeRange(this);this.runWithTimeRange(I)}async runWithTimeRange(I){const R=(0,D.YQ)(this),{uid:T,id:S}=R.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(I))return;const L=async()=>{const N=await(0,h.JD)(m.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:f.hY,dashboardUid:T}));if(N.error)throw new Error("Unexpected alert rules response.");return N.data},j=(0,n.H)(L()).pipe((0,s.T)(N=>(0,v.Kw)(N))).pipe((0,s.T)(N=>{this.hasAlertRules=!1;const F={};return N.forEach(U=>U.rules.forEach(w=>{if((0,E.Z8)(w)&&w.annotations&&w.annotations[x.YH.panelID]){this.hasAlertRules=!0;const B=Number(w.annotations[x.YH.panelID]),K=C(w.state);F[B]?K===r.O.Alerting&&F[B].state!==r.O.Alerting?F[B].state=r.O.Alerting:K===r.O.Pending&&F[B].state!==r.O.Alerting&&F[B].state!==r.O.Pending&&(F[B].state=r.O.Pending):F[B]={state:K,id:Object.keys(F).length,panelId:B,dashboardId:S}}})),Object.values(F)}));this.querySub=j.subscribe({next:N=>{const F=(0,i.Vc)(N);this.publishResults({state:g.Gu.Done,series:[{...F,meta:{...F.meta,dataTopic:l.QR.AlertStates}}],timeRange:I.state.value})},error:N=>{this.handleError(N),this.publishResults({state:g.Gu.Error,series:[],errors:[{message:(0,u.q)(N)}],timeRange:I.state.value})}})}canWork(I){const R=(0,D.YQ)(this),{uid:T}=R.state;return!(!T||o.$.publicDashboardAccessToken||I.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(p.contextSrv.hasPermission(y.AccessControlAction.AlertingRuleRead)&&p.contextSrv.hasPermission(y.AccessControlAction.AlertingRuleExternalRead)))}}function C(M){return M===b.cF.Firing?r.O.Alerting:M===b.cF.Pending?r.O.Pending:r.O.OK}},38477:(k,A,e)=>{"use strict";e.d(A,{g:()=>o});var n=e(43127),s=e(33948),l=e(52622),r=e(32264),i=e(80943),g=e(90569);class o extends i.tV.g{async resolveDataSource(c){return r.$.publicDashboardAccessToken?new g.X:super.resolveDataSource(c)}processEvents(c,a){if(r.$.publicDashboardAccessToken){const p={series:[],timeRange:(0,n.E2)(),state:a.state},u=(0,s.I)(a.events);return u.meta={...u.meta,dataTopic:l.QR.Annotations},p.annotations=[u],p}else return super.processEvents(c,a)}}},33278:(k,A,e)=>{"use strict";e.d(A,{x:()=>y});var n=e(74848),s=e(32196),l=e(12470),r=e(13544),i=e(80943),g=e(40845),o=e(67061),d=e(90613),c=e(32264),a=e(15292);function p({panelEditor:P}){const C=P.state.vizManager,{panel:M,tableView:I}=C.useState(),R=c.$.panels[M.state.pluginId]?.skipDataQuery;return(0,n.jsx)(n.Fragment,{children:!R&&(0,n.jsx)(a.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!I,onClick:()=>C.toggleTableView(),"aria-label":"toggle-table-view","data-testid":r.Tp.components.PanelEditor.toggleTableView})})}var u=e(74730),m=e(80997),v=e(56034),x=e(52424),f=e(6923),E=e(4588);function h({links:P,uid:C}){return!P||!C?null:(0,n.jsx)(n.Fragment,{children:P.map((M,I)=>{const R=(0,f.mQ)().getAnchorInfo(M),T=`${M.title}-$${I}`;if(M.type==="dashboards")return(0,n.jsx)(x.aK,{link:M,linkInfo:R,dashboardUID:C},T);const S=E.G[M.icon],L=(0,n.jsx)(x.Zx,{icon:S,href:(0,m.Jf)(R.href),target:M.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":r.Tp.components.DashboardLinks.link,children:R.title});return(0,n.jsx)("div",{"data-testid":r.Tp.components.DashboardLinks.container,children:M.tooltip?(0,n.jsx)(v.m,{content:R.tooltip,children:L}):L},T)})})}class y extends i.Bs{constructor(C){super({variableControls:[],timePicker:C.timePicker??new i.KE({}),refreshPicker:C.refreshPicker??new i.WM({}),...C}),this._variableDependency=new i.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new i.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let M;return this.state.hideTimeControls&&(M=this.state.refreshPicker.activate()),()=>{M&&M()}})}static{this.Component=b}getUrlState(){return{"_dash.hideTimePicker":this.state.hideTimeControls?"true":void 0,"_dash.hideVariables":this.state.hideVariableControls?"true":void 0,"_dash.hideLinks":this.state.hideLinksControls?"true":void 0}}updateFromUrl(C){const M={};M.hideTimeControls=C["_dash.hideTimePicker"]==="true"||C["_dash.hideTimePicker"]===""||this.state.hideTimeControls,M.hideVariableControls=C["_dash.hideVariables"]==="true"||C["_dash.hideVariables"]===""||this.state.hideVariableControls,M.hideLinksControls=C["_dash.hideLinks"]==="true"||C["_dash.hideLinks"]===""||this.state.hideLinksControls,Object.entries(M).some(([I,R])=>R!==this.state[I])&&this.setState(M)}_onAnyVariableChanged(){(0,u.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const C=i.jh.getVariables(this)?.state.variables.some(L=>L.state.hide!==l.zL.hideVariable),M=i.jh.getDataLayers(this).some(L=>L.state.isEnabled&&!L.state.isHidden),I=(0,u.YQ)(this).state.links?.length>0,R=this.state.hideLinksControls||!I,T=this.state.hideVariableControls||!M&&!C,S=this.state.hideTimeControls;return!(T&&R&&S)}}function b({model:P}){const{variableControls:C,refreshPicker:M,timePicker:I,hideTimeControls:R,hideVariableControls:T,hideLinksControls:S}=P.useState(),L=(0,u.YQ)(P),{links:O,meta:j,editPanel:N}=L.useState(),F=(0,g.of)(D),U=location.search.includes("scene-debugger");return P.hasControls()?(0,n.jsxs)("div",{"data-testid":r.Tp.pages.Dashboard.Controls,className:(0,s.cx)(F.controls,j.isEmbedded&&F.embedded),children:[(0,n.jsxs)(o.B,{grow:1,wrap:"wrap",children:[!T&&C.map(w=>(0,n.jsx)(w.Component,{model:w},w.state.key)),(0,n.jsx)(d.a,{grow:1}),!S&&!N&&(0,n.jsx)(h,{links:O,uid:L.state.uid}),N&&(0,n.jsx)(p,{panelEditor:N})]}),!R&&(0,n.jsxs)(o.B,{justifyContent:"flex-end",children:[(0,n.jsx)(I.Component,{model:I}),(0,n.jsx)(M.Component,{model:M})]}),U&&(0,n.jsx)(i.or,{scene:P},"scene-debugger")]}):null}function D(P){return{controls:(0,s.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:P.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"relative",background:P.colors.background.canvas,zIndex:P.zIndex.activePanel,width:"100%",marginLeft:"auto",[P.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"},[P.breakpoints.up("sm")]:{position:"sticky",top:0}}),embedded:(0,s.css)({background:"unset",position:"unset"})}}},16279:(k,A,e)=>{"use strict";e.d(A,{s:()=>l});var n=e(74848),s=e(80943);class l extends s.ps{constructor(i){super({...i,name:i.name??"Data layers",annotationLayers:i.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((i,g)=>{i.annotationLayers!==g.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(i){this.setState({annotationLayers:[...this.state.annotationLayers,i]})}getAllLayers(){const i=[...this.state.annotationLayers];return this.state.alertStatesLayer&&i.push(this.state.alertStatesLayer),i}static{this.Component=({model:i})=>{const{annotationLayers:g}=i.useState();return(0,n.jsx)(n.Fragment,{children:g.map(o=>(0,n.jsx)(o.Component,{model:o},o.state.key))})}}}},39820:(k,A,e)=>{"use strict";e.d(A,{L:()=>i});var n=e(80943),s=e(14348),l=e(74730),r=e(60656);class i extends n.Bs{constructor(o){super(o),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const o=this.parent;let d,c;if(!(o instanceof n.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(o.state.datasource?.uid!==s.K)return;try{d=(0,l.YQ)(o)}catch{return}const a=o.state.queries.find(f=>f.panelId!==void 0);if(!a)return;const p=a.panelId,u=(0,l.XA)(p),m=(0,l.vL)(d,u);if(!(m instanceof n.Eb))return;const v=(0,l.un)(m);let x;if(v)this.prevRequestId&&this.prevRequestId!==v.state.data?.request?.requestId&&o.runQueries();else if(m.parent instanceof r.F)m.parent.isActive||(x=m.parent.activate()),c=m.parent.subscribeToState((f,E)=>{this.handleLibPanelStateUpdates(f,E,o)});else throw new Error("Could not find SceneQueryRunner for panel");return()=>{this.prevRequestId=v?.state.data?.request?.requestId,c&&c.unsubscribe(),x&&x()}}handleLibPanelStateUpdates(o,d,c){if(o.panel&&o.panel!==d.panel){if(!((0,l.un)(o.panel)instanceof n.dt))throw new Error("Could not find SceneQueryRunner for panel");c.runQueries()}}}},41507:(k,A,e)=>{"use strict";e.d(A,{U:()=>v});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(96540),g=e(32264),o=e(80943),d=e(15054),c=e(74730),a=e(57109),p=e(60656),u=e(7196),m=e(30195);class v extends o.Bs{constructor(h){super(h),this._variableDependency=new o.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:this._onVariableUpdateCompleted.bind(this)}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return this.state.variableName&&(this._subs.add(this.subscribeToState((h,y)=>this._handleGridResize(h,y))),this._performRepeat()),this._subs.add(this.subscribeToState((h,y)=>{h.body!==y.body&&h.body instanceof p.F&&this.setupLibraryPanelChangeSubscription(h.body)})),this.state.body instanceof p.F&&this.setupLibraryPanelChangeSubscription(this.state.body),()=>{this._libPanelSubscription?.unsubscribe(),this._libPanelSubscription=void 0}}setupLibraryPanelChangeSubscription(h){this._libPanelSubscription&&(this._libPanelSubscription.unsubscribe(),this._libPanelSubscription=void 0),this._libPanelSubscription=h.subscribeToState(y=>{y._loadedPanel?.model.repeat&&(this._variableDependency.setVariableNames([y._loadedPanel.model.repeat]),this.setState({variableName:y._loadedPanel.model.repeat,repeatDirection:y._loadedPanel.model.repeatDirection,maxPerRow:y._loadedPanel.model.maxPerRow}),this._performRepeat())})}_onVariableUpdateCompleted(){this.state.variableName&&this._performRepeat()}_handleGridResize(h,y){const b=this.state.repeatedPanels?.length??1,D={};if(h.height!==y.height){if(this.getRepeatDirection()==="v"){const P=Math.ceil(h.height/b);D.itemHeight=P}else{const P=Math.ceil(b/this.getMaxPerRow());D.itemHeight=Math.ceil(h.height/P)}D.itemHeight!==this.state.itemHeight&&this.setState(D)}}_performRepeat(){if(this.state.body instanceof a.o||!this.state.variableName||this._variableDependency.hasDependencyInLoadingState())return;const h=o.jh.lookupVariable(this.state.variableName,this)??new o.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(h instanceof o.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:y,texts:b}=(0,c.a7)(h);if((0,l.isEqual)(this._prevRepeatValues,y))return;this._prevRepeatValues=y;const D=this.state.body instanceof p.F?this.state.body.state.panel:this.state.body,P=[],C={values:[""],texts:h.hasAllValue()?["All"]:["None"]},M=y.length?y:C.values,I=b.length?b:C.texts;for(let j=0;j<M.length;j++){const N={$variables:new o.Pj({variables:[new o.xc({name:h.state.name,value:M[j],text:String(I[j])})]}),key:`${D.state.key}-clone-${j}`};j>0&&(N.menu=new o.Lw({$behaviors:[u.t0]}));const F=D.clone(N);P.push(F)}const R=this.getRepeatDirection(),T={repeatedPanels:P},S=this.state.itemHeight??10,L=this.state.height,O=this.getMaxPerRow();if(R==="h"){const j=Math.ceil(P.length/O);T.height=j*S}else T.height=P.length*S;if(this.setState(T),L!==this.state.height){const j=o.jh.getLayout(this);j instanceof o.hy&&j.forceRender()}this.publishEvent(new m.d({source:this}),!0)}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:h})=>{const{repeatedPanels:y,itemHeight:b,variableName:D,body:P}=h.useState(),C=y?.length??0,M=x(h.getRepeatDirection(),C,h.getMaxPerRow(),b??10);if(!D){if(P instanceof o.Eb)return(0,n.jsx)(P.Component,{model:P},P.state.key);if(P instanceof p.F)return(0,n.jsx)(P.Component,{model:P},P.state.key);if(P instanceof a.o)return(0,n.jsx)(P.Component,{model:P},P.state.key)}return y?(0,n.jsx)("div",{className:M,children:y.map(I=>(0,n.jsx)("div",{className:f,children:(0,n.jsx)(I.Component,{model:I},I.state.key)},I.state.key))}):null}}}function x(E,h,y,b){return(0,i.useMemo)(()=>{const D=g.$.theme2,P=b*d.sD*h+(h-1)*d.dU;if(E==="h"){const C=Math.ceil(h/y),M=Math.min(h,y);return(0,s.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${M}, 1fr)`,gridTemplateRows:`repeat(${C}, 1fr)`,gridColumnGap:D.spacing(1),gridRowGap:D.spacing(1),[D.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:P}})}return(0,s.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:D.spacing(1),[D.breakpoints.down("md")]:{height:P}})},[E,h,y,b])}const f=(0,s.css)({display:"flex",flexGrow:1,position:"relative"})},34842:(k,A,e)=>{"use strict";e.d(A,{H$:()=>jr,vk:()=>Da});var n=e(71733),s=e(26272),l=e(41987),r=e(32264),i=e(39601),g=e(80943),o=e(28138),d=e(15054),c=e(17422),a=e(33390),p=e(14792),u=e(34214),m=e(6473),v=e(11230),x=e(80484),f=e(28444),E=e(13530),h=e(74848),y=e(63021),b=e(40675),D=e(87978),P=e(54943),C=e(76459),M=e.n(C),I=e(49785),R=e(13544),T=e(55852),S=e(42418),L=e(67061),O=e(88575),j=e(10354),N=e(21744),F=e(15292),U=e(90613),w=e(60029),B=e(36607),K=e(71500),W=e(17172);function z(nt){return(0,W.NF)(nt)&&nt.data&&nt.data.status==="version-mismatch"}function Y(nt){return(0,W.NF)(nt)&&nt.data&&nt.data.status==="name-exists"}function X(nt){return(0,W.NF)(nt)&&nt.data&&nt.data.status==="plugin-dashboard"}function q({cancelButton:nt,saveButton:Le}){return(0,h.jsxs)(S.F,{title:"Name already exists",severity:"error",children:[(0,h.jsx)("p",{children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"}),(0,h.jsx)(U.a,{paddingTop:2,children:(0,h.jsxs)(L.B,{alignItems:"center",children:[nt,Le(!0)]})})]})}function G({overwrite:nt,isLoading:Le,isValid:et,onSave:mt}){return(0,h.jsx)(T.$n,{disabled:!et||Le,icon:Le?"spinner":void 0,onClick:()=>mt(nt),variant:nt?"destructive":"primary","data-testid":R.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:Le?"Saving...":nt?"Save and overwrite":"Save"})}var te=e(41053),H=e(14110),se=e(3169),ne=e(91219),le=e(55314),_=e(31678),Q=e(36974);function ae(nt=!1){const Le=(0,_.useDispatch)(),et=(0,se._2)(),[mt]=(0,le.e8)(),[kt,yn]=(0,te.A)(async(fn,Cn,as)=>{{const ts=await mt({dashboard:Cn,folderUid:as.folderUid,message:as.message,overwrite:as.overwrite,showErrorAlert:!1,k8s:void 0});if("error"in ts)throw ts.error;const _s=ts.data;fn.saveCompleted(Cn,_s,as.folderUid),o.A.publish(new f.Eu),et.success("Dashboard saved"),(0,Q.ko)(_s.uid),nt?(0,H.rR)("grafana_dashboard_copied",{name:Cn.title,url:_s.url}):(0,H.rR)(`grafana_dashboard_${_s.uid?"saved":"created"}`,{name:Cn.title,url:_s.url});const Fs=i.Ny.getLocation(),Ha=n.I.stripBaseFromUrl(_s.url);return Ha!==Fs.pathname&&setTimeout(()=>{i.Ny.push({pathname:Ha,search:Fs.search})}),fn.state.meta.isStarred&&Le((0,ne.TU)({id:_s.uid,title:fn.state.title,url:Ha})),ts.data}},[Le,et]);return{state:kt,onSaveDashboard:yn}}function oe({dashboard:nt,changeInfo:Le}){const{changedSaveModel:et}=Le,{register:mt,handleSubmit:kt,setValue:yn,formState:fn,getValues:Cn,watch:as}=(0,I.mN)({mode:"onBlur",defaultValues:{title:Le.isNew?et.title:`${et.title} Copy`,description:et.description??"",folder:{uid:nt.state.meta.folderUid,title:nt.state.meta.folderTitle},copyTags:!1}}),{errors:ts,isValid:_s,defaultValues:Fs}=fn,Ha=as(),{state:Zs,onSaveDashboard:Pr}=ae(!1),Or=async no=>{const ir=Cn(),Br=xe(et,ir,Le.isNew);(await Pr(nt,Br,{overwrite:no,folderUid:ir.folder.uid})).status==="success"&&nt.closeModal()},nr=(0,h.jsx)(T.$n,{variant:"secondary",onClick:()=>nt.closeModal(),fill:"outline",children:"Cancel"}),Xa=no=>(0,h.jsx)(G,{isValid:_s,isLoading:Zs.loading,onSave:Or,overwrite:no});function mr(no){return Y(no)?(0,h.jsx)(q,{cancelButton:nr,saveButton:Xa}):(0,h.jsxs)(h.Fragment,{children:[no&&(0,h.jsx)(S.F,{title:"Failed to save dashboard",severity:"error",children:(0,h.jsx)("p",{children:no.message})}),(0,h.jsxs)(L.B,{alignItems:"center",children:[nr,Xa(!1)]})]})}return(0,h.jsxs)("form",{onSubmit:kt(()=>Or(!1)),children:[(0,h.jsx)(O.D,{label:(0,h.jsx)(J,{dashboard:et,onChange:yn}),invalid:!!ts.title,error:ts.title?.message,children:(0,h.jsx)(j.p,{...mt("title",{required:"Required",validate:de}),"aria-label":"Save dashboard title field","data-testid":R.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:M()(async no=>{yn("title",no.target.value,{shouldValidate:!0})},400)})}),(0,h.jsx)(O.D,{label:(0,h.jsx)(ee,{dashboard:et,onChange:yn}),invalid:!!ts.description,error:ts.description?.message,children:(0,h.jsx)(N.f,{...mt("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})}),(0,h.jsx)(O.D,{label:"Folder",children:(0,h.jsx)(B.d,{onChange:(no,ir)=>yn("folder",{uid:no,title:ir}),value:Ha.folder?.uid,initialTitle:Fs.folder.title,dashboardId:et.id??void 0,enableCreateNew:!0})}),!Le.isNew&&(0,h.jsx)(O.D,{label:"Copy tags",children:(0,h.jsx)(F.d,{...mt("copyTags")})}),(0,h.jsx)(U.a,{paddingTop:2,children:mr(Zs.error)})]})}function J(nt){return(0,h.jsx)(L.B,{justifyContent:"space-between",children:(0,h.jsx)(w.J,{htmlFor:"description",children:"Title"})})}function ee(nt){return(0,h.jsx)(L.B,{justifyContent:"space-between",children:(0,h.jsx)(w.J,{htmlFor:"description",children:"Description"})})}async function de(nt,Le){if(nt===Le.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await K.P.validateNewDashboardName(Le.folder.uid??"general",nt),!0}catch(et){return et instanceof Error?et.message:"Dashboard name is invalid"}}function xe(nt,Le,et){return{...nt,id:null,uid:"",title:Le.title,description:Le.description,tags:et||Le.copyTags?nt.tags:[]}}var re=e(96540),ue=e(10880);function Te({dashboard:nt,drawer:Le,changeInfo:et}){const{changedSaveModel:mt,hasChanges:kt}=et,{state:yn,onSaveDashboard:fn}=ae(!1),[Cn,as]=(0,re.useState)({folderUid:nt.state.meta.folderUid}),ts=async Zs=>{(await fn(nt,mt,{...Cn,overwrite:Zs})).status==="success"&&(nt.closeModal(),Le.state.onSaveSuccess?.())},_s=(0,h.jsx)(T.$n,{variant:"secondary",onClick:()=>nt.closeModal(),fill:"outline",children:"Cancel"}),Fs=Zs=>(0,h.jsx)(G,{isValid:kt,isLoading:yn.loading,onSave:ts,overwrite:Zs});function Ha(Zs){return z(Zs)?(0,h.jsxs)(S.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,h.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,h.jsx)(U.a,{paddingTop:2,children:(0,h.jsxs)(L.B,{alignItems:"center",children:[_s,Fs(!0)]})})]}):Y(Zs)?(0,h.jsx)(q,{cancelButton:_s,saveButton:Fs}):X(Zs)?(0,h.jsxs)(S.F,{title:"Plugin dashboard",severity:"error",children:[(0,h.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,h.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,h.jsx)(U.a,{paddingTop:2,children:(0,h.jsxs)(L.B,{alignItems:"center",children:[_s,Fs(!0)]})})]}):(0,h.jsxs)(h.Fragment,{children:[Zs&&(0,h.jsx)(S.F,{title:"Failed to save dashboard",severity:"error",children:(0,h.jsx)("p",{children:Zs.message})}),(0,h.jsxs)(L.B,{alignItems:"center",children:[_s,Fs(!1),!kt&&(0,h.jsx)("div",{children:"No changes to save"})]})]})}return(0,h.jsxs)(L.B,{gap:2,direction:"column",children:[(0,h.jsx)(ge,{drawer:Le,changeInfo:et}),(0,h.jsx)(O.D,{label:"Message",children:(0,h.jsx)(N.f,{"aria-label":"message",value:Cn.message??"",onChange:Zs=>{as({...Cn,message:Zs.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})}),Ha(yn.error)]})}function ge({drawer:nt,changeInfo:Le}){const{saveVariables:et=!1,saveTimeRange:mt=!1,saveRefresh:kt=!1}=nt.useState(),{hasTimeChanges:yn,hasVariableValueChanges:fn,hasRefreshChange:Cn}=Le;return(0,h.jsxs)(L.B,{direction:"column",alignItems:"flex-start",children:[yn&&(0,h.jsx)(ue.S,{id:"save-timerange",checked:mt,onChange:nt.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":R.Tp.pages.SaveDashboardModal.saveTimerange}),Cn&&(0,h.jsx)(ue.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:kt,onChange:nt.onToggleSaveRefresh,"data-testid":R.Tp.pages.SaveDashboardModal.saveRefresh}),fn&&(0,h.jsx)(ue.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:et,onChange:nt.onToggleSaveVariables,"data-testid":R.Tp.pages.SaveDashboardModal.saveVariables})]})}var Oe=e(32196),Ue=e(4213),Xe=e.n(Ue),we=e(70713),qe=e(32372),We=e(10534);function Ce({dashboard:nt,drawer:Le,changeInfo:et}){const mt=(0,re.useMemo)(()=>JSON.stringify(et.changedSaveModel,null,2),[et]),kt=(0,re.useCallback)(()=>{const yn=new Blob([mt],{type:"application/json;charset=utf-8"});(0,Ue.saveAs)(yn,et.changedSaveModel.title+"-"+new Date().getTime()+".json")},[et.changedSaveModel,mt]);return(0,h.jsx)("div",{className:je.container,children:(0,h.jsxs)(L.B,{direction:"column",gap:2,grow:1,children:[(0,h.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,h.jsx)("br",{}),(0,h.jsxs)("i",{children:["See"," ",(0,h.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,h.jsx)("br",{})," ",(0,h.jsx)("br",{}),(0,h.jsx)("strong",{children:"File path: "})," ",nt.state.meta.provisionedExternalId]}),(0,h.jsx)(ge,{drawer:Le,changeInfo:et}),(0,h.jsx)("div",{className:je.json,children:(0,h.jsx)(we.Ay,{disableWidth:!0,children:({height:yn})=>(0,h.jsx)(qe.B,{width:"100%",height:yn,language:"json",showLineNumbers:!0,showMiniMap:mt.length>100,value:mt,readOnly:!0})})}),(0,h.jsx)(U.a,{paddingTop:2,children:(0,h.jsxs)(L.B,{gap:2,children:[(0,h.jsx)(T.$n,{variant:"secondary",onClick:Le.onClose,fill:"outline",children:"Cancel"}),(0,h.jsx)(We.b,{icon:"copy",getText:()=>mt,children:"Copy JSON to clipboard"}),(0,h.jsx)(T.$n,{type:"submit",onClick:kt,children:"Save JSON to file"})]})})]})})}const je={container:(0,Oe.css)({height:"100%",display:"flex"}),json:(0,Oe.css)({flexGrow:1,maxHeight:"800px"})};var Ke=e(20455),_e=e(45429);function Fe(nt,Le,et,mt){const kt=(0,_e.Yy)(nt.getInitialSaveModel(),(0,Ke.Uy)(nt),Le,et,mt),yn=nt.getInitialState()?.meta.folderUid!==nt.state.meta.folderUid;return{...kt,hasFolderChanges:yn,hasChanges:kt.hasChanges||yn}}class at extends g.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:Le})=>{const{showDiff:et,saveAsCopy:mt,saveTimeRange:kt,saveVariables:yn,saveRefresh:fn}=Le.useState(),Cn=Fe(Le.state.dashboardRef.resolve(),kt,yn,fn),{changedSaveModel:as,initialSaveModel:ts,diffs:_s,diffCount:Fs,hasFolderChanges:Ha}=Cn,Zs=Fs+(Ha?1:0),Pr=Le.state.dashboardRef.resolve(),{meta:Or}=Pr.useState(),{provisioned:nr,folderTitle:Xa}=Or,mr=(0,h.jsxs)(y.U,{children:[(0,h.jsx)(b.o,{label:"Details",active:!et,onChangeTab:()=>Le.setState({showDiff:!1})}),Zs>0&&(0,h.jsx)(b.o,{label:"Changes",active:et,onChangeTab:()=>Le.setState({showDiff:!0}),counter:Zs})]});let no="Save dashboard";mt?no="Save dashboard copy":nr&&(no="Provisioned dashboard");const ir=()=>et?(0,h.jsx)(P.l,{diff:_s,oldValue:ts,newValue:as,hasFolderChanges:Ha,oldFolder:Pr.getInitialState()?.meta.folderTitle,newFolder:Xa}):mt||Cn.isNew?(0,h.jsx)(oe,{dashboard:Pr,changeInfo:Cn}):nr?(0,h.jsx)(Ce,{dashboard:Pr,changeInfo:Cn,drawer:Le}):(0,h.jsx)(Te,{dashboard:Pr,changeInfo:Cn,drawer:Le});return(0,h.jsx)(D._,{title:no,subtitle:Pr.state.title,onClose:Le.onClose,tabs:mr,children:ir()})}}}var Ct=e(85445),Dt=e(57714),tt=e(64423),ze=e(18226),pe=e(94624),Se=e(72724),fe=e(3591),Ee=e(41507),Pe=e(13989),he=e(53543),be=e(74730);class Ae{constructor(Le){this._scene=Le,this.events=new ze.o,this._subs=new tt.yU;const et=g.jh.getTimeRange(Le);this.formatDate=this.formatDate.bind(this),this._subs.add(et.subscribeToState((mt,kt)=>{mt.value!==kt.value&&this.events.publish(new fe.sR(mt.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return g.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const Le=g.jh.getTimeRange(this._scene);return{from:Le.state.from,to:Le.state.to}}get panels(){return De(this._scene,et=>et instanceof g.Eb).map(et=>new he.R(et))}get annotations(){const Le={list:[]};return this._scene.state.$data instanceof g.kh&&(Le.list=(0,Pe.O)(this._scene.state.$data.state.layers)),Le}getTimezone(){return g.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const Le of this._scene.state.$behaviors)if(Le instanceof g.Gg.K2)return Le.state.sync}return pe.y.Off}otherPanelInFullscreen(Le){return!1}formatDate(Le,et){return(0,Se.LE)(Le,{format:et,timeZone:this.getTimezone()})}getPanelById(Le){const et=(0,be.vL)(this._scene,(0,be.XA)(Le));return et?new he.R(et):null}removePanel(Le){const et=(0,be.vL)(this._scene,(0,be.XA)(Le.id));if(!et){console.error("Trying to remove a panel that was not found in scene",Le);return}const mt=et.parent;if(!(mt instanceof Ee.U)){console.error("Trying to remove a panel that is not wrapped in DashboardGridItem");return}const kt=g.jh.getLayout(et);if(!(kt instanceof g.hy)){console.error("Trying to remove a panel in a layout that is not SceneGridLayout ");return}if(kt===mt.parent&&kt.setState({children:kt.state.children.filter(yn=>yn!==mt)}),mt.parent instanceof g.tI){const yn=kt.clone({children:kt.state.children.filter(fn=>fn!==mt)});kt.parent instanceof g.hy&&kt.parent.setState({children:kt.parent.state.children.map(fn=>fn===kt?yn:fn)})}}canEditAnnotations(Le){return this._scene.canEditDashboard()?Le?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function De(nt,Le){let et=[];return nt.forEachChild(mt=>{Le(mt)?et.push(mt):et=et.concat(De(mt,Le))}),et}var Ie=e(32023);function ke(nt){let Le=5381;for(let et=0;et<nt.length;et++)Le=Le*33^nt.charCodeAt(et);return Le>>>0}var dt=e(11982),Pt=e(57109),pt=e(24180),Tt=e(49045),jt=e(64388),$t=e(40845),sn=e(40276),Yt=e(69444),qt=e(7392),bn=e(68064),Mt=e(73667);function Jt({model:nt}){const{controls:Le,overlay:et,editview:mt,editPanel:kt,isEmpty:yn,scopes:fn,meta:Cn}=nt.useState(),{isExpanded:as}=fn?.useState()??{},ts=(0,$t.of)(Ut),_s=(0,pt.zy)(),Fs=(0,_.useSelector)(ir=>ir.navIndex),Ha=nt.getPageNav(_s,Fs),Zs=nt.getBodyToRender(),Pr=(0,c.tc)(Fs,"dashboards/browse"),Or=Le?.hasControls();if(mt)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(mt.Component,{model:mt}),et&&(0,h.jsx)(et.Component,{model:et})]});const nr=(0,h.jsx)(bn.A,{dashboard:nt,canCreate:!!nt.state.meta.canEdit},"dashboard-empty-state"),Xa=(0,h.jsx)("div",{className:(0,Oe.cx)(ts.body,!Or&&ts.bodyWithoutControls),children:(0,h.jsx)(Zs.Component,{model:Zs})},"dashboard-panels"),mr=Cn.dashboardNotFound&&(0,h.jsx)(qt.L,{entity:"Dashboard"},"dashboard-not-found");let no=[Xa];return mr?no=[mr]:yn&&(no=[nr,Xa]),(0,h.jsxs)(Yt.Y,{navModel:Pr,pageNav:Ha,layout:jt.k.Custom,children:[kt&&(0,h.jsx)(kt.Component,{model:kt}),!kt&&(0,h.jsxs)("div",{className:(0,Oe.cx)(ts.pageContainer,Or&&!fn&&ts.pageContainerWithControls,fn&&ts.pageContainerWithScopes,fn&&as&&ts.pageContainerWithScopesExpanded),children:[fn&&!Cn.dashboardNotFound&&(0,h.jsx)(fn.Component,{model:fn}),(0,h.jsx)(Mt.c,{dashboard:nt}),Le&&(0,h.jsx)("div",{className:(0,Oe.cx)(ts.controlsWrapper,fn&&!as&&ts.controlsWrapperWithScopes),children:(0,h.jsx)(Le.Component,{model:Le})}),(0,h.jsx)(Gt,{id:"page-scrollbar",className:ts.panelsContainer,testId:R.Tp.pages.Dashboard.DashNav.scrollContainer,children:(0,h.jsx)("div",{className:(0,Oe.cx)(ts.canvasContent),children:no})})]}),et&&(0,h.jsx)(et.Component,{model:et})]})}function Ut(nt){return{pageContainer:(0,Oe.css)({display:"grid",gridTemplateAreas:`
  "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%",[nt.breakpoints.down("sm")]:{display:"flex",flexDirection:"column"}},r.$.featureToggles.bodyScrolling&&{position:"absolute",width:"100%"}),pageContainerWithControls:(0,Oe.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopes:(0,Oe.css)({gridTemplateAreas:`
        "scopes controls"
        "panels panels"`,gridTemplateColumns:`${nt.spacing(32)} 1fr`,gridTemplateRows:"auto 1fr"}),pageContainerWithScopesExpanded:(0,Oe.css)({gridTemplateAreas:`
        "scopes controls"
        "scopes panels"`}),panelsContainer:(0,Oe.css)({gridArea:"panels"}),controlsWrapper:(0,Oe.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:nt.spacing(2),":empty":{display:"none"}}),controlsWrapperWithScopes:(0,Oe.css)({padding:nt.spacing(2,2,2,0)}),canvasContent:(0,Oe.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:nt.spacing(0,2),flexBasis:"100%",flexGrow:1}),body:(0,Oe.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",paddingBottom:nt.spacing(2),boxSizing:"border-box"}),bodyWithoutControls:(0,Oe.css)({paddingTop:nt.spacing(2)})}}const Gt=({id:nt,children:Le,className:et,testId:mt})=>{const kt=(0,$t.$j)(),yn=(0,Tt.A)(`(max-width: ${kt.breakpoints.values.sm}px)`),fn=(0,$t.of)(()=>({nonScrollable:(0,Oe.css)({height:"100%",display:"flex",flexDirection:"column"})}));return yn?(0,h.jsx)("div",{id:nt,className:(0,Oe.cx)(et,fn.nonScrollable),"data-testid":mt,children:Le}):(0,h.jsx)(sn.E,{divId:nt,autoHeightMin:"100%",className:et,testId:mt,children:Le})};var Lt=e(65123),At=e(54612),Nt=e(16560),Dn=e(29678),An=e(14578),Pn=e(62930),Xn=e(90182),Tn=e(16233),ht=e(83195),St=e(2619),Ge=e(2543),Ve=e(89667),lt=e(52622),It=e(39070),Qe=e(68706),vt=e(60656),Ot=e(41524);function zt(nt){const Le=[];if(nt?.series)for(const et of nt.series)Le.push((0,Ve.Nw)(et));if(nt?.annotations)for(const et of nt.annotations){const mt=(0,Ve.Nw)(et);mt.schema?.meta||(mt.schema.meta={}),mt.schema.meta.dataTopic=lt.QR.Annotations,Le.push(mt)}return Le}function vn(nt,Le){const et={panelType:nt.state.pluginId,datasource:"??"},mt=r.$.buildInfo.versionString;let kt=`| Key | Value |
|--|--|
| Panel | ${et.panelType} @ ${nt.state.pluginVersion??mt} |
| Grafana | ${mt} // ${r.$.buildInfo.edition} |
`;return Le&&(kt+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+Le+"\n```\n</details>"),kt}async function ln(nt,Le,et){let mt={type:""};const kt=nt.parent instanceof vt.F,yn=kt?nt.parent.parent:nt.parent,fn=nt.getRoot();if(kt)mt={...(0,Ke.ZB)(yn),...(0,Ke.Z6)(nt)};else if(fn.state.editPanel){const Xa=fn.state.editPanel.state.vizManager.state.sourcePanel.resolve(),mr=Xa.parent instanceof vt.F?Xa.parent.parent:Xa.parent;mr instanceof Ee.U&&(mt={...(0,Ke.ZB)(mr),...(0,Ke.Z6)(fn.state.editPanel.state.vizManager.state.panel.clone())})}else mt=(0,Ke.ZB)(yn);const Cn=(0,Ge.cloneDeep)(cs),as={panelType:nt.state.pluginId,datasource:"??"},ts=(0,be.un)(nt);if(!ts.state.data)return;const _s=ts.state.data,Fs=ts?.state.datasource,Ha=(0,Ot.W)(zt(_s),Le),Zs=r.$.buildInfo.versionString,Pr=ts.state.queries??[],Or=_s.annotations?_s.annotations.reduce((Xa,mr)=>mr.length+Xa,0):0,nr=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${as.panelType} @ ${mt.pluginVersion??Zs}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Pr.map(Xa=>{const mr=Xa.datasource??Fs;return`${Xa.refId}[${mr?.type}]`}).join(", ")}</td>
    </tr>
    ${On(mt)}
    ${wn(_s,Ha)}
    ${Un(_s)}
    <tr>
      <th>Grafana</th>
      <td>${Zs} // ${r.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(Cn.panels[0]={...mt,...Cn.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:Qe.nj.Snapshot,snapshot:Ha}]},delete Cn.panels[0].libraryPanel,mt.transformations?.length){const Xa=Cn.panels[Cn.panels.length-1];Xa.title=Xa.title+" (after transformations)";const mr=(0,Ge.cloneDeep)(Xa);mr.id=100,mr.title="Data (before transformations)",mr.gridPos.w=24,mr.targets[0].withTransforms=!1,Cn.panels.push(mr)}return Or>0&&Cn.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:lt.QR.Annotations,refId:"A"}]}),Cn.panels[1].options.content=nr,Cn.panels[2].options.content=JSON.stringify(mt,null,2),Cn.title=`Debug: ${mt.title} // ${(0,Se.LE)(new Date)}`,Cn.tags=["debug",`debug-${as.panelType}`],Cn.time={from:et.from.toISOString(),to:et.to.toISOString()},Cn}function On(nt){return nt.transformations?`<tr>
      <th>Transform</th>
      <td>${nt.transformations.map(Le=>Le.id).join(", ")}</td>
  </tr>`:""}function wn(nt,Le){let et=nt.series.length??0,mt=0,kt=0;for(const yn of nt.series)mt+=yn.fields.length,kt+=yn.length;return`<tr><th>Data</th><td>${nt.state!==It.Gu.Done?nt.state:""} ${et} frames, ${mt} fields, ${kt} rows </td></tr>`}function Un(nt){return nt.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${nt.annotations.reduce((Le,et)=>et.length+Le,0)}</td>
</tr>`:""}const cs={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Zn=(nt=>(nt[nt.Support=0]="Support",nt[nt.Data=1]="Data",nt))(Zn||{}),wt=(nt=>(nt[nt.PanelSnapshot=0]="PanelSnapshot",nt[nt.GithubComment=1]="GithubComment",nt))(wt||{});class Ft extends St.Q{constructor(Le){super({panel:Le,panelTitle:g.jh.interpolate(Le,Le.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=et=>{this.setState({currentTab:et})},this.onShowMessageChange=et=>{this.setState({showMessage:et.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:et}=this.state,mt=Math.pow(1024,2)*1.5;return et.length>mt?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):et},this.onDownloadDashboard=()=>{const{snapshotText:et,panelTitle:mt}=this.state,kt=new Blob([et],{type:"text/plain"}),yn=`debug-${mt}-${(0,Se.LE)(new Date)}.json.txt`;Xe()(kt,yn)},this.onSetSnapshotText=et=>{this.setState({snapshotText:et})},this.onToggleRandomize=et=>{const{randomize:mt}=this.state;this.setState({randomize:{...mt,[et]:!mt[et]}})}}async buildDebugDashboard(){const{panel:Le,randomize:et,snapshotUpdate:mt}=this.state,kt=await ln(Le,et,g.jh.getTimeRange(Le).state.value),yn=JSON.stringify(kt,null,2),fn=vn(Le,yn),Cn=(0,ht.cN)((0,ht.j_)("bytes")(yn?.length??0));let as;if(kt)try{as=(0,Ct.wM)({dashboard:kt,meta:{isEmbedded:!0}}).state.body}catch(ts){console.log("Error creating scene:",ts)}this.setState({snapshot:kt,snapshotText:yn,markdownText:fn,snapshotSize:Cn,snapshotUpdate:mt+1,scene:as})}}function Ht({panel:nt,onClose:Le}){const et=(0,$t.of)(ut),mt=(0,re.useMemo)(()=>new Ft(nt),[nt]),kt=nt.getPlugin(),{currentTab:yn,loading:fn,error:Cn,options:as,showMessage:ts,snapshotSize:_s,markdownText:Fs,snapshotText:Ha,randomize:Zs,panelTitle:Pr,scene:Or}=mt.useState();if((0,re.useEffect)(()=>{mt.buildDebugDashboard()},[mt,kt,Zs]),!kt)return null;const nr=[{label:"Snapshot",value:Zn.Support},{label:"Data",value:Zn.Data}],Xa=r.$.supportBundlesEnabled&&Tn.TP.hasPermission(_.AccessControlAction.ActionSupportBundlesCreate);return(0,h.jsxs)(D._,{title:"Get help with this panel",size:"lg",onClose:Le,subtitle:(0,h.jsxs)(L.B,{direction:"column",gap:1,children:[(0,h.jsxs)(L.B,{direction:"row",gap:1,children:[(0,h.jsx)(Dn.y,{featureState:l.Ay.beta}),(0,h.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer",children:["Troubleshooting docs ",(0,h.jsx)(An.I,{name:"external-link-alt"})]})]}),(0,h.jsx)("span",{className:"muted",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."}),Xa&&(0,h.jsxs)("span",{className:"muted",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,h.jsx)("a",{href:"/support-bundles",children:"support bundles section"}),"."]})]}),tabs:(0,h.jsx)(y.U,{children:nr.map((mr,no)=>(0,h.jsx)(b.o,{label:mr.label,active:mr.value===yn,onChangeTab:()=>mt.onCurrentTabChange(mr.value)},`${mr.value}-${no}`))}),children:[fn&&(0,h.jsx)(Pn.y,{}),Cn&&(0,h.jsx)(S.F,{title:Cn.title,children:Cn.message}),yn===Zn.Data&&(0,h.jsxs)("div",{className:et.code,children:[(0,h.jsxs)("div",{className:et.opts,children:[(0,h.jsx)(O.D,{label:"Template",className:et.field,children:(0,h.jsx)(Xn.l6,{options:as,value:ts,onChange:mt.onShowMessageChange})}),ts===wt.GithubComment?(0,h.jsx)(We.b,{icon:"copy",getText:mt.onGetMarkdownForClipboard,children:"Copy to clipboard"}):(0,h.jsxs)(T.$n,{icon:"download-alt",onClick:mt.onDownloadDashboard,children:["Download (",_s,")"]})]}),(0,h.jsx)(we.Ay,{disableWidth:!0,children:({height:mr})=>(0,h.jsx)(qe.B,{width:"100%",height:mr,language:ts===wt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:ts===wt.GithubComment?Fs:Ha,readOnly:!1,onBlur:mt.onSetSnapshotText})})]}),yn===Zn.Support&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(O.D,{label:"Randomize data",description:"Modify the original data to hide sensitve information.  Note the lengths will stay the same, and duplicate values will be equal.",children:(0,h.jsxs)(L.B,{children:[(0,h.jsx)(F.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!Zs.labels,onChange:()=>mt.onToggleRandomize("labels")}),(0,h.jsx)(F.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!Zs.names,onChange:()=>mt.onToggleRandomize("names")}),(0,h.jsx)(F.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!Zs.values,onChange:()=>mt.onToggleRandomize("values")})]})}),(0,h.jsx)(O.D,{label:"Support snapshot",description:`Panel: ${Pr}`,children:(0,h.jsxs)(L.B,{children:[(0,h.jsxs)(T.$n,{icon:"download-alt",onClick:mt.onDownloadDashboard,children:["Dashboard (",_s,")"]}),(0,h.jsx)(We.b,{icon:"github",getText:mt.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard",children:"Copy to clipboard"})]})}),(0,h.jsx)(we.Ay,{disableWidth:!0,children:({height:mr})=>(0,h.jsx)("div",{style:{height:mr,overflow:"auto"},children:Or&&(0,h.jsx)(Or.Component,{model:Or})})})]})]})}const ut=nt=>({code:(0,Oe.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,Oe.css)({width:"100%"}),opts:(0,Oe.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:nt.spacing(1)}})});var pn=e(8484),Jn=e(61453);class Qn extends g.Bs{constructor(Le){super({...Le,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=et=>{this.setState({options:et})}}getTabLabel(){return(0,pn.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return Nt.q.Data}static{this.Component=({model:Le})=>{const{options:et}=Le.useState(),mt=Le.state.panelRef.resolve(),kt=g.jh.getData(mt),{data:yn}=ls(kt,et.withTransforms).useState(),fn=g.jh.getTimeRange(mt);return(0,h.jsx)(Jn.q,{isLoading:yn?.state===It.Gu.Loading,data:yn?.series,options:et,hasTransformations:fs(kt),timeZone:fn.getTimeZone(),panelPluginId:mt.state.pluginId,dataName:mt.state.title,fieldConfig:mt.state.fieldConfig,onOptionsChange:Le.onOptionsChange})}}}function fs(nt){return nt instanceof g.Es?nt.state.transformations.length>0:!1}function ls(nt,Le){return!Le&&nt instanceof g.Es&&nt.state.$data?nt.state.$data:nt}var vs=e(18803),ea=e(26323),Ks=e(77938),Hs=e(6204),bs=e(89681);class Ys extends g.Bs{constructor(Le){super({...Le,source:"panel-json",jsonText:La("panel-json",Le.panelRef.resolve())}),this.onChangeSource=et=>{this.setState({source:et.value,jsonText:La(et.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const et=this.state.panelRef.resolve(),mt=(0,be.YQ)(et),kt=JSON.parse(this.state.jsonText),yn=new u.a(kt),fn=(0,Ct.tt)(yn),Cn=g.Go.cloneSceneObjectState(fn.state);if(!(et.parent instanceof Ee.U)){console.error("Cannot update state of panel",et,fn);return}this.state.onClose(),mt.state.isEditing||mt.onEnterEditMode(),et.parent.setState(Cn),(0,Hs.B9)(Nt.q.JSON,"apply",{panel_type_changed:et.state.pluginId!==yn.type,panel_id_changed:(0,be.Cs)(et)!==yn.id,panel_grid_pos_changed:Lr(et.parent.state,Cn),panel_targets_changed:$r((0,be.un)(et),(0,be.un)(Cn.$data))})},this.onCodeEditorBlur=et=>{this.setState({jsonText:et})}}getTabLabel(){return(0,pn.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return Nt.q.JSON}getOptions(){const Le=this.state.panelRef.resolve(),et=Le.state.$data??Le.parent?.state.$data,mt=[{label:(0,pn.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,pn.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return et&&(mt.push({label:(0,pn.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,pn.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),mt.push({label:(0,pn.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,pn.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),mt}isEditable(){if(this.state.source!=="panel-json")return!1;const Le=this.state.panelRef.resolve();return Le.parent instanceof vt.F||Le.parent instanceof Ee.U&&Le.parent.isRepeated()?!1:(0,be.YQ)(Le).state.meta.canEdit}static{this.Component=({model:Le})=>{const{source:et,jsonText:mt}=Le.useState(),kt=(0,$t.of)(ea.A),yn=Le.getOptions();return(0,h.jsxs)("div",{className:kt.wrap,children:[(0,h.jsxs)("div",{className:kt.toolbar,"data-testid":R.Tp.components.PanelInspector.Json.content,children:[(0,h.jsx)(O.D,{label:(0,pn.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,h.jsx)(Xn.l6,{inputId:"select-source-dropdown",options:yn,value:yn.find(fn=>fn.value===et)??yn[0].value,onChange:Le.onChangeSource})}),Le.isEditable()&&(0,h.jsx)(T.$n,{className:kt.toolbarItem,onClick:Le.onApplyChange,children:"Apply"})]}),(0,h.jsx)("div",{className:kt.content,children:(0,h.jsx)(we.Ay,{disableWidth:!0,children:({height:fn})=>(0,h.jsx)(qe.B,{width:"100%",height:fn,language:"json",showLineNumbers:!0,showMiniMap:mt.length>100,value:mt,readOnly:!Le.isEditable(),onBlur:Le.onCodeEditorBlur})})})]})}}}function La(nt,Le){let et={};switch(nt){case"panel-json":{(0,Hs.B9)(Nt.q.JSON,"panelData");const mt=Le.parent instanceof vt.F,kt=mt?Le.parent.parent:Le.parent;if(mt){et=Xs(Le);break}if(Le.parent instanceof bs.j){et=Le.parent.getPanelSaveModel();break}kt instanceof Ee.U&&(et=(0,Ke.ZB)(kt));break}case"panel-data":{(0,Hs.B9)(Nt.q.JSON,"panelJSON");const mt=g.jh.getData(Le);mt.state.data&&(et=Le.applyFieldConfig(mt.state.data));break}case"data-frames":{(0,Hs.B9)(Nt.q.JSON,"dataFrame");const mt=g.jh.getData(Le);mt.state.data&&(mt instanceof g.Es&&mt.state.$data?.state.data?et=(0,vs.B6)(mt.state.$data.state.data):et=(0,vs.B6)(mt.state.data))}}return(0,Ks.p)(et)}function Xs(nt){if(!(nt.parent instanceof vt.F))throw"Panel not child of LibraryVizPanel";if(!(nt.parent.parent instanceof Ee.U))throw"LibraryPanel not child of DashboardGridItem";const Le=nt.parent.parent,et={x:Le.state.x||0,y:Le.state.y||0,h:Le.state.height||0,w:Le.state.width||0},mt=Ta(nt),kt=(0,Ke.Z6)(nt,et,!1,Le);return{libraryPanel:{...mt},...kt}}function Ta(nt){if(!(nt.parent instanceof vt.F))throw new Error("Panel not a child of LibraryVizPanel");if(!nt.parent.state._loadedPanel)throw new Error("Library panel not loaded");return nt.parent.state._loadedPanel}function Lr(nt,Le){return nt.x!==Le.x||nt.y!==Le.y||nt.width!==Le.width||nt.height!==Le.height}function $r(nt,Le){return nt===void 0||Le===void 0?!1:!(0,Ge.isEqual)(nt.state.queries,Le.state.queries)}class Za extends g.Bs{getTabLabel(){return(0,pn.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return Nt.q.Meta}static{this.Component=({model:Le})=>{const{panelRef:et,dataSource:mt}=Le.state,kt=g.jh.getData(et.resolve()),yn=mt.components?.MetadataInspector;return!kt.state.data||!yn?null:(0,h.jsx)(yn,{datasource:mt,data:kt.state.data.series})}}}var Er=e(90820);class Ar extends g.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const Le=(0,be.un)(this.state.panelRef.resolve());Le&&Le.runQueries()}}getTabLabel(){return(0,pn.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return Nt.q.Query}static{this.Component=({model:Le})=>{const et=g.jh.getData(Le.state.panelRef.resolve()).useState();return et.data?(0,h.jsx)(Er.e,{data:et.data,onRefreshQuery:Le.onRefreshQuery}):null}}}var ho=e(32067);class Fr extends g.Bs{getTabLabel(){return(0,pn.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return Nt.q.Stats}static{this.Component=({model:Le})=>{const et=g.jh.getData(Le.state.panelRef.resolve()).useState(),mt=g.jh.getTimeRange(Le.state.panelRef.resolve());return et.data?(0,h.jsx)(ho.N,{data:et.data,timeZone:mt.getTimeZone()}):null}}}class rr extends g.Bs{constructor(Le){super(Le),this.onClose=()=>{const et=(0,be.YQ)(this);i.Ny.push((0,dt.uZ)({uid:et.state.uid,slug:et.state.meta.slug,currentQueryParams:i.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=fo}_activationHandler(){this.buildTabs(0)}async buildTabs(Le){const et=this.state.panelRef,mt=et?.resolve()?.getPlugin(),kt=[];if(mt||(Le<2e3?setTimeout(()=>this.buildTabs(Le+100),100):this.setState({pluginNotLoaded:!0})),et){if((0,At.$)(mt)){const yn=g.jh.getData(et.resolve());kt.push(new Qn({panelRef:et})),kt.push(new Fr({panelRef:et})),kt.push(new Ar({panelRef:et}));const fn=await(0,Lt.BN)(yn.state.data);fn&&kt.push(new Za({panelRef:et,dataSource:fn}))}kt.push(new Ys({panelRef:et,onClose:this.onClose}))}this.setState({tabs:kt})}getDrawerTitle(){const Le=this.state.panelRef?.resolve();return Le?g.jh.interpolate(Le,`Inspect: ${Le.state.title}`):"Inspect panel"}}function fo({model:nt}){const{tabs:Le,pluginNotLoaded:et,panelRef:mt}=nt.useState(),kt=(0,pt.zy)(),yn=new URLSearchParams(kt.search);if(!Le)return null;const fn=yn.get("inspectTab"),Cn=Le.find(ts=>ts.getTabValue()===fn)??Le[0],as=mt.resolve();return fn===Nt.q.Help?(0,h.jsx)(Ht,{panel:as,onClose:nt.onClose}):(0,h.jsxs)(D._,{title:nt.getDrawerTitle(),onClose:nt.onClose,size:"md",tabs:(0,h.jsx)(y.U,{children:Le.map(ts=>(0,h.jsx)(b.o,{label:ts.getTabLabel(),active:ts===Cn,href:n.I.getUrlForPartial(kt,{inspectTab:ts.getTabValue()})},ts.state.key))}),children:[et&&(0,h.jsx)(S.F,{title:"Panel plugin not loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."}),Cn&&Cn.Component&&(0,h.jsx)(Cn.Component,{model:Cn})]})}var _o=e(19293),gr=e(10096),ci=e(22391),Qo=e(19347),eo=e(38477);class Do{constructor(Le){this._scene=Le}getKeys(){return["editIndex"]}getUrlState(){const Le=this._scene.state;return{editIndex:Le.editIndex!==void 0?String(Le.editIndex):void 0}}updateFromUrl(Le){let et={};typeof Le.editIndex=="string"?et={editIndex:Number(Le.editIndex)}:et={editIndex:void 0},Object.keys(et).length>0&&this._scene.setState(et)}}var di=e(16817),bo=e(84167),Oo=e(77268),To=e(82241),jo=e(51612),$o=e(46502);const Yo="New annotation",Si=({annotation:nt,editIndex:Le,panels:et,onUpdate:mt,onBackToList:kt,onDelete:yn})=>{const fn=(0,$t.of)(vi),Cn=(0,re.useMemo)(()=>nt.filter?nt.filter.exclude?2:1:0,[nt.filter]),{value:as}=(0,di.A)(()=>(0,Qo.l)().get(nt.datasource),[nt.datasource]),ts=(0,Qo.l)().getInstanceSettings(nt.datasource),_s=ir=>{mt({...nt,name:ir.currentTarget.value},Le)},Fs=ir=>{const Br=(0,ci.p$)(ir);nt.datasource?.type!==Br.type?mt({datasource:Br,builtIn:nt.builtIn,enable:nt.enable,iconColor:nt.iconColor,name:nt.name,hide:nt.hide,filter:nt.filter,mappings:nt.mappings,type:nt.type},Le):mt({...nt,datasource:Br},Le)},Ha=ir=>{const Br=ir.currentTarget;mt({...nt,[Br.name]:Br.type==="checkbox"?Br.checked:Br.value},Le)},Zs=ir=>{mt({...nt,iconColor:ir},Le)},Pr=ir=>{let Br=ir.value===0?void 0:{exclude:ir.value===2,ids:nt.filter?.ids??[]};mt({...nt,filter:Br},Le)},Or=ir=>{if(!Array.isArray(ir))return;const Br={exclude:Cn===2,ids:[]};ir.forEach(il=>il.value&&Br.ids.push(il.value)),mt({...nt,filter:Br},Le)},nr=()=>{yn(Le),kt()},Xa=nt.name===Yo,mr=(ir,Br)=>ir.label&&Br.label?ir.label.toLowerCase().localeCompare(Br.label.toLowerCase()):-1,no=(0,re.useMemo)(()=>et.filter(ir=>r.$.panels[ir.state.pluginId]).map(ir=>({value:(0,be.Cs)(ir),label:ir.state.title??`Panel ${(0,be.Cs)(ir)}`,description:ir.state.description,imgUrl:r.$.panels[ir.state.pluginId].info.logos.small})).sort(mr)??[],[et]);return(0,h.jsxs)("div",{children:[(0,h.jsxs)(bo.n,{className:fn.settingsForm,children:[(0,h.jsx)(O.D,{label:"Name",children:(0,h.jsx)(j.p,{"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:Xa,value:nt.name,onChange:_s})}),(0,h.jsx)(O.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,h.jsx)(jo.s,{annotations:!0,variables:!0,current:nt.datasource,onChange:Fs})}),(0,h.jsx)(O.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,h.jsx)(ue.S,{name:"enable",id:"enable",value:nt.enable,onChange:Ha,"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,h.jsx)(O.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,h.jsx)(ue.S,{name:"hide",id:"hide",value:nt.hide,onChange:Ha,"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,h.jsx)(O.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,h.jsx)(L.B,{children:(0,h.jsx)(Oo.a,{value:nt?.iconColor,onChange:Zs})})}),(0,h.jsx)(O.D,{label:"Show in","data-testid":R.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Xn.l6,{options:yi,value:Cn,onChange:Pr,"data-testid":R.Tp.components.Annotations.annotationsTypeInput}),Cn!==0&&(0,h.jsx)(Xn.KF,{options:no,value:no.filter(ir=>nt.filter?.ids.includes(ir.value)),onChange:Or,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:fn.select,"data-testid":R.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,h.jsxs)(bo.n,{children:[(0,h.jsx)("h3",{className:"page-heading",children:"Query"}),as?.annotations&&ts&&(0,h.jsx)(To.A,{datasource:as,datasourceInstanceSettings:ts,annotation:nt,onChange:ir=>mt(ir,Le)}),as&&!as.annotations&&(0,h.jsx)($o.F,{datasource:as,annotation:nt,onChange:ir=>mt(ir,Le)})]}),(0,h.jsxs)(L.B,{children:[!nt.builtIn&&(0,h.jsx)(T.$n,{variant:"destructive",onClick:nr,"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:"Delete"}),(0,h.jsx)(T.$n,{variant:"secondary",onClick:kt,"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:"Back to list"})]})]})},vi=nt=>({settingsForm:(0,Oe.css)({maxWidth:nt.spacing(60),marginBottom:nt.spacing(2)}),select:(0,Oe.css)({marginTop:"8px"})});var ai=(nt=>(nt[nt.AllPanels=0]="AllPanels",nt[nt.IncludePanels=1]="IncludePanels",nt[nt.ExcludePanels=2]="ExcludePanels",nt))(ai||{});const yi=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Bo=e(29158),Ai=e(91605),Ho=e(69529),ui=e(72109),Jo=e(46991);const Ri="Add annotation query",xi=({annotations:nt,onNew:Le,onEdit:et,onMove:mt,onDelete:kt})=>{const yn=(0,$t.of)(Po),fn=nt.length===0||nt.length===1&&nt[0].builtIn,Cn=ts=>ts.enable===!1?(0,h.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",ts.name]}):ts.builtIn?(0,h.jsxs)("em",{className:"muted",children:[ts.name," \xA0 (Built-in)"]}):(0,h.jsx)(h.Fragment,{children:ts.name}),as=(0,Qo.l)();return(0,h.jsxs)(L.B,{direction:"column",children:[nt.length>0&&(0,h.jsx)("div",{className:yn.table,children:(0,h.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Query name"}),(0,h.jsx)("th",{children:"Data source"}),(0,h.jsx)("th",{colSpan:3})]})}),(0,h.jsx)("tbody",{"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:nt.map((ts,_s)=>(0,h.jsxs)("tr",{children:[ts.builtIn?(0,h.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>et(_s),children:(0,h.jsx)(T.$n,{size:"sm",fill:"text",variant:"secondary",children:Cn(ts)})}):(0,h.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>et(_s),children:(0,h.jsx)(T.$n,{size:"sm",fill:"text",variant:"secondary",children:Cn(ts)})}),(0,h.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>et(_s),children:as.getInstanceSettings(ts.datasource)?.name||ts.datasource?.uid}),(0,h.jsx)("td",{role:"gridcell",style:{width:"1%"},children:_s!==0&&(0,h.jsx)(Bo.K,{name:"arrow-up",onClick:()=>mt(_s,ri.UP),tooltip:"Move up"})}),(0,h.jsx)("td",{role:"gridcell",style:{width:"1%"},children:nt.length>1&&_s!==nt.length-1?(0,h.jsx)(Bo.K,{name:"arrow-down",onClick:()=>mt(_s,ri.DOWN),tooltip:"Move down"}):null}),(0,h.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!ts.builtIn&&(0,h.jsx)(Ai.e,{size:"sm",onConfirm:()=>kt(_s),"aria-label":`Delete query with title "${ts.name}"`})})]},`${ts.name}-${_s}`))})]})}),fn&&(0,h.jsx)(L.B,{direction:"column",children:(0,h.jsxs)(Ho.p,{variant:"call-to-action",button:(0,h.jsx)(T.$n,{"data-testid":R.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Le,size:"lg",children:(0,h.jsx)(pn.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,pn.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,h.jsx)(pn.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,h.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,h.jsxs)(pn.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,h.jsx)(ui.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!fn&&(0,h.jsx)(Jo.d,{"data-testid":R.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Le,children:"New query"})]})},Po=()=>({table:(0,Oe.css)({width:"100%",overflowX:"auto"})});var ri=(nt=>(nt[nt.UP=-1]="UP",nt[nt.DOWN=1]="DOWN",nt))(ri||{});class Ei extends g.Bs{constructor(){super(...arguments),this._urlSync=new Do(this),this.onNew=()=>{const Le={name:Yo,enable:!0,datasource:(0,ci.p$)((0,Qo.l)().getInstanceSettings(null)),iconColor:"red"},et=new eo.g({query:Le,name:Le.name,isEnabled:!!Le.enable,isHidden:!!Le.hide}),mt=Ie.b4.getDataLayers(this._dashboard);mt.addAnnotationLayer(et),this.setState({editIndex:mt.state.annotationLayers.length-1})},this.onEdit=Le=>{this.setState({editIndex:Le})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(Le,et)=>{const mt=Ie.b4.getDataLayers(this._dashboard),kt=[...mt.state.annotationLayers],[yn]=kt.splice(Le,1);kt.splice(Le+et,0,yn),mt.setState({annotationLayers:kt})},this.onDelete=Le=>{const et=Ie.b4.getDataLayers(this._dashboard),mt=[...et.state.annotationLayers];mt.splice(Le,1),et.setState({annotationLayers:mt})},this.onUpdate=(Le,et)=>{const mt=this.getDataLayer(et);mt.setState({name:Le.name,isEnabled:!!Le.enable,isHidden:!!Le.hide,query:Le}),mt.runLayer()}}static{this.Component=Zo}getUrlKey(){return"annotations"}get _dashboard(){return(0,be.YQ)(this)}getDataLayer(Le){const mt=Ie.b4.getDataLayers(this._dashboard).state.annotationLayers[Le];if(!(mt instanceof g.tV.g))throw new Error("AnnotationsDataLayer not found at index "+Le);return mt}getDashboard(){return this._dashboard}}function Zo({model:nt}){const Le=nt.getDashboard(),{annotationLayers:et}=Ie.b4.getDataLayers(Le).useState(),{navModel:mt,pageNav:kt}=fa(Le,nt.getUrlKey()),{editIndex:yn}=nt.useState(),fn=Ie.b4.getVizPanels(Le),Cn=(0,Pe.O)(et);return yn!=null&&yn<et.length?(0,h.jsx)(_t,{annotationLayer:nt.getDataLayer(yn),pageNav:kt,panels:fn,editIndex:yn,navModel:mt,dashboard:Le,onUpdate:nt.onUpdate,onBackToList:nt.onBackToList,onDelete:nt.onDelete}):(0,h.jsxs)(Yt.Y,{navModel:mt,pageNav:kt,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:Le}),(0,h.jsx)(xi,{annotations:Cn,onNew:nt.onNew,onEdit:nt.onEdit,onDelete:nt.onDelete,onMove:nt.onMove})]})}function _t({annotationLayer:nt,pageNav:Le,navModel:et,panels:mt,editIndex:kt,dashboard:yn,onUpdate:fn,onBackToList:Cn,onDelete:as}){const{name:ts,query:_s}=nt.useState(),Fs={text:ts,parentItem:Le};return(0,h.jsxs)(Yt.Y,{navModel:et,pageNav:Fs,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:yn}),(0,h.jsx)(Si,{annotation:_s,editIndex:kt,panels:mt,onUpdate:fn,onBackToList:Cn,onDelete:as})]})}var cn=e(14588),kn=e(65857),Kn=e(6199),ns=e(4588);class Rs extends g.Bs{constructor(){super(...arguments),this._urlSync=new Do(this),this.onNewLink=()=>{this.links=[...this.links,ns.q],this.setState({editIndex:this.links.length-1})},this.onDelete=Le=>{this.links=[...this.links.slice(0,Le),...this.links.slice(Le+1)],this.setState({editIndex:void 0})},this.onDuplicate=Le=>{this.links=[...this.links,{...Le}]},this.onOrderChange=(Le,et)=>{this.links=cn.moveItemImmutably(this.links,Le,Le+et)},this.onEdit=Le=>{this.setState({editIndex:Le})},this.onUpdateLink=Le=>{const et=this.state.editIndex;et!==void 0&&(this.links=[...this.links.slice(0,et),Le,...this.links.slice(et+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=Os}getUrlKey(){return"links"}get dashboard(){return(0,be.YQ)(this)}get links(){return this.dashboard.state.links}set links(Le){this.dashboard.setState({links:Le})}}function Os({model:nt}){const{editIndex:Le}=nt.useState(),et=(0,be.YQ)(nt),{links:mt}=et.useState(),{navModel:kt,pageNav:yn}=fa(et,nt.getUrlKey()),fn=Le!==void 0?mt[Le]:void 0;return fn?(0,h.jsx)(ha,{pageNav:yn,navModel:kt,link:fn,dashboard:et,onChange:nt.onUpdateLink,onGoBack:nt.onGoBack}):(0,h.jsxs)(Yt.Y,{navModel:kt,pageNav:yn,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:et}),(0,h.jsx)(Kn.X,{links:mt,onNew:nt.onNewLink,onEdit:nt.onEdit,onDelete:nt.onDelete,onDuplicate:nt.onDuplicate,onOrderChange:nt.onOrderChange})]})}function ha({pageNav:nt,link:Le,navModel:et,dashboard:mt,onChange:kt,onGoBack:yn}){const fn={text:"Edit link",parentItem:nt};return(0,h.jsxs)(Yt.Y,{navModel:et,pageNav:fn,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:mt}),(0,h.jsx)(kn.d,{link:Le,onUpdate:kt,onGoBack:yn})]})}var na=e(79924),wa=e(94354),pr=e(57418),Ma=e(75590),ks=e(81394),oo=e(27966),go=e(77431),qr=e(42941),po=e(96374),yo=e(37390);function hi({dashboard:nt}){const[Le,et]=(0,qr.A)(!1);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(T.$n,{variant:"destructive",onClick:et,"data-testid":R.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,h.jsx)(pn.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),Le&&(0,h.jsx)(Di,{dashboard:nt,onClose:et})]})}function Di({dashboard:nt,onClose:Le}){const[,et]=(0,te.A)(async()=>{(0,H.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:r.$.featureToggles.dashboardRestoreUI}),Le(),await nt.deleteDashboard()},[nt,Le]);return nt.state.meta.provisioned?(0,h.jsx)(Rr,{dashboard:nt,onClose:Le}):(0,h.jsx)(po.u,{isOpen:!0,body:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{children:"Do you want to delete this dashboard?"}),(0,h.jsx)("p",{children:nt.state.title})]}),onConfirm:et,onDismiss:Le,title:"Delete",icon:"trash-alt",confirmText:"Delete"})}function Rr({dashboard:nt,onClose:Le}){return(0,h.jsxs)(yo.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:Le,children:[(0,h.jsx)("p",{children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."}),(0,h.jsxs)("p",{children:[(0,h.jsxs)("i",{children:["See"," ",(0,h.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,h.jsx)("br",{}),"File path: ",nt.state.meta.provisionedExternalId]}),(0,h.jsx)(yo.a.ButtonRow,{children:(0,h.jsx)(T.$n,{variant:"primary",onClick:Le,children:"OK"})})]})}const tr=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],Vr=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class io extends g.Bs{constructor(){super(...arguments),this.onTitleChange=Le=>{this._dashboard.setState({title:Le})},this.onDescriptionChange=Le=>{this._dashboard.setState({description:Le})},this.onTagsChange=Le=>{this._dashboard.setState({tags:Le})},this.onFolderChange=async(Le,et)=>{const mt={...this._dashboard.state.meta,folderUid:Le||this._dashboard.state.meta.folderUid,folderTitle:et||this._dashboard.state.meta.folderTitle};mt.folderUid&&await(0,go.Q)(mt.folderUid),this._dashboard.setState({meta:mt})},this.onEditableChange=Le=>{this._dashboard.setState({editable:Le})},this.onTimeZoneChange=Le=>{this.getTimeRange().setState({timeZone:Le})},this.onWeekStartChange=Le=>{this.getTimeRange().setState({weekStart:Le})},this.onRefreshIntervalChange=Le=>{this.getRefreshPicker()?.setState({intervals:Le})},this.onNowDelayChange=Le=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:Le})},this.onHideTimePickerChange=Le=>{this.getDashboardControls()?.setState({hideTimeControls:Le})},this.onLiveNowChange=Le=>{try{const et=this.getLiveNowTimer();Le?et.enable():et.disable()}catch(et){console.error(et)}},this.onTooltipChange=Le=>{this.getCursorSync()?.setState({sync:Le})},this.onPreloadChange=Le=>{this._dashboard.setState({preload:Le})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,be.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return g.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Ie.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const Le=g.jh.findObject(this._dashboard,et=>et instanceof g.Gg.en);if(Le instanceof g.Gg.en)return Le;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:Le})=>{const et=Le.getDashboard(),{navModel:mt,pageNav:kt}=fa(et,Le.getUrlKey()),{title:yn,description:fn,tags:Cn,meta:as,editable:ts}=et.useState(),{sync:_s}=Le.getCursorSync()?.useState()||{},{timeZone:Fs,weekStart:Ha,UNSAFE_nowDelay:Zs}=Le.getTimeRange().useState(),{intervals:Pr}=Le.getRefreshPicker().useState(),{hideTimeControls:Or}=Le.getDashboardControls().useState(),{enabled:nr}=Le.getLiveNowTimer().useState();return(0,h.jsxs)(Yt.Y,{navModel:mt,pageNav:kt,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:et}),(0,h.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,h.jsxs)(U.a,{marginBottom:5,children:[(0,h.jsx)(O.D,{label:(0,h.jsxs)(L.B,{justifyContent:"space-between",children:[(0,h.jsx)(w.J,{htmlFor:"title-input",children:(0,h.jsx)(pn.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),r.$.featureToggles.dashgpt&&(0,h.jsx)(oo.Z,{onGenerate:Xa=>Le.onTitleChange(Xa)})]}),children:(0,h.jsx)(j.p,{id:"title-input",name:"title",value:yn,onChange:Xa=>Le.onTitleChange(Xa.target.value)})}),(0,h.jsx)(O.D,{label:(0,h.jsxs)(L.B,{justifyContent:"space-between",children:[(0,h.jsx)(w.J,{htmlFor:"description-input",children:(0,pn.t)("dashboard-settings.general.description-label","Description")}),r.$.featureToggles.dashgpt&&(0,h.jsx)(ks.V,{onGenerate:Xa=>Le.onDescriptionChange(Xa)})]}),children:(0,h.jsx)(N.f,{id:"description-input",name:"description",value:fn,onChange:Xa=>Le.onDescriptionChange(Xa.target.value)})}),(0,h.jsx)(O.D,{label:(0,pn.t)("dashboard-settings.general.tags-label","Tags"),children:(0,h.jsx)(na.u,{id:"tags-input",tags:Cn,onChange:Le.onTagsChange,width:40})}),(0,h.jsx)(O.D,{label:(0,pn.t)("dashboard-settings.general.folder-label","Folder"),children:(0,h.jsx)(B.d,{value:as.folderUid,onChange:Le.onFolderChange,initialTitle:as.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})}),(0,h.jsx)(O.D,{label:(0,pn.t)("dashboard-settings.general.editable-label","Editable"),description:(0,pn.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,h.jsx)(wa.z,{value:ts,options:tr,onChange:Le.onEditableChange})})]}),(0,h.jsx)(Ma.p,{onTimeZoneChange:Le.onTimeZoneChange,onWeekStartChange:Le.onWeekStartChange,onRefreshIntervalChange:Le.onRefreshIntervalChange,onNowDelayChange:Le.onNowDelayChange,onHideTimePickerChange:Le.onHideTimePickerChange,onLiveNowChange:Le.onLiveNowChange,refreshIntervals:Pr,timePickerHidden:Or,nowDelay:Zs||"",liveNow:nr,timezone:Fs||"",weekStart:Ha||""}),(0,h.jsxs)(pr.M,{label:(0,pn.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:[(0,h.jsx)(O.D,{label:(0,pn.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,pn.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,h.jsx)(wa.z,{onChange:Le.onTooltipChange,options:Vr,value:_s})}),(0,h.jsx)(O.D,{label:(0,pn.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,pn.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,h.jsx)(F.d,{id:"preload-panels-dashboards-toggle",value:et.state.preload,onChange:Xa=>Le.onPreloadChange(Xa.currentTarget.checked)})})]}),(0,h.jsx)(U.a,{marginTop:3,children:as.canDelete&&(0,h.jsx)(hi,{dashboard:et})})]})]})}}}class ja extends g.Bs{constructor(Le){super({...Le,jsonText:""}),this.onCodeEditorBlur=et=>{this.setState({jsonText:et})},this.onSaveSuccess=et=>{const mt=JSON.parse(this.state.jsonText),kt=this.getDashboard();mt.version=et.version;const yn={dashboard:mt,meta:kt.state.meta},fn=(0,Ct.wM)(yn),Cn=g.Go.cloneSceneObjectState(fn.state);kt.pauseTrackingChanges(),kt.setInitialSaveModel(yn.dashboard),kt.setState(Cn),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,be.YQ)(this)}getSaveModel(){const Le=this.getDashboard();return(0,Ke.Uy)(Le)}getJsonText(){const Le=this.getSaveModel();return(0,Ks.p)(Le)}static{this.Component=({model:Le})=>{const{state:et,onSaveDashboard:mt}=ae(!1),[kt,yn]=(0,re.useState)(!1),fn=Le.getDashboard(),{navModel:Cn,pageNav:as}=fa(fn,Le.getUrlKey()),ts=fn.useState().meta.canSave,{jsonText:_s}=Le.useState(),Fs=async nr=>{const Xa=await mt(fn,JSON.parse(Le.state.jsonText),{folderUid:fn.state.meta.folderUid,overwrite:nr});yn(!0),Xa.status==="success"?(Le.onSaveSuccess(Xa),yn(!1)):yn(!0)},Ha=nr=>(0,h.jsx)(T.$n,{type:"submit",onClick:()=>{Fs(nr)},variant:nr?"destructive":"primary",children:nr?"Save and overwrite":(0,h.jsx)(pn.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Zs=(0,h.jsx)(T.$n,{variant:"secondary",onClick:()=>yn(!1),fill:"outline",children:"Cancel"}),Pr=(0,$t.of)(Xo);function Or(nr){if(nr&&kt){if(z(nr))return(0,h.jsxs)(S.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,h.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,h.jsx)(U.a,{paddingTop:2,children:(0,h.jsxs)(L.B,{alignItems:"center",children:[Zs,Ha(!0)]})})]});if(Y(nr))return(0,h.jsx)(q,{saveButton:Ha,cancelButton:Zs});if(X(nr))return(0,h.jsxs)(S.F,{title:"Plugin dashboard",severity:"error",children:[(0,h.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,h.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,h.jsx)(U.a,{paddingTop:2,children:(0,h.jsx)(L.B,{alignItems:"center",children:Ha(!0)})})]})}return(0,h.jsxs)(h.Fragment,{children:[nr&&kt&&(0,h.jsx)(S.F,{title:"Failed to save dashboard",severity:"error",children:(0,h.jsx)("p",{children:nr.message})}),(0,h.jsx)(L.B,{alignItems:"center",children:Ha(!1)})]})}return(0,h.jsxs)(Yt.Y,{navModel:Cn,pageNav:as,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:fn}),(0,h.jsxs)("div",{className:Pr.wrapper,children:[(0,h.jsx)(pn.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,h.jsx)(qe.B,{width:"100%",value:_s,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:Pr.codeEditor,onBlur:Le.onCodeEditorBlur}),ts&&(0,h.jsx)(U.a,{paddingTop:2,children:Or(et.error)})]})]})}}}const Xo=nt=>({wrapper:(0,Oe.css)({display:"flex",height:"100%",flexDirection:"column",gap:nt.spacing(2)}),codeEditor:(0,Oe.css)({flexGrow:1})});var Ti=e(52487);class Rt extends g.Bs{static{this.Component=tn}get _dashboard(){return(0,be.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function tn({model:nt}){const Le=nt.getDashboard(),{uid:et}=Le.useState(),{navModel:mt,pageNav:kt}=fa(Le,nt.getUrlKey()),yn=gr.contextSrv.hasPermission(_.AccessControlAction.DashboardsPermissionsWrite);return(0,h.jsxs)(Yt.Y,{navModel:mt,pageNav:kt,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:Le}),(0,h.jsx)(Ti.x,{resource:"dashboards",resourceId:et??"",canSetPermissions:yn})]})}var Mn=e(75505),zn=e(79422),Es=e(71678),Ts=e(39558),qa=e(8964),aa=e(58975),ar=e(85140),Aa=e(14329),yr=e(41820),Dr=e(85830),ao=e(89458),Qr=e(17663);function Uo({onChange:nt,type:Le}){const et=(0,re.useMemo)(()=>(0,Qr.B$)(),[]),mt=(0,re.useMemo)(()=>et.find(kt=>kt.value===Le)??et[0],[et,Le]);return(0,h.jsx)(ao.v,{name:"Select variable type",value:mt,options:et,onChange:nt,testId:R.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function Co({variable:nt,onTypeChange:Le,onGoBack:et,onDelete:mt,onValidateVariableName:kt}){const yn=(0,$t.of)(lo),[fn,Cn]=(0,re.useState)(null),{name:as,type:ts,label:_s,description:Fs,hide:Ha,key:Zs}=nt.useState(),Pr=(0,Qr.bZ)(ts)?(0,Qr.CD)(ts):void 0,[Or,nr]=(0,te.A)(async()=>{await(0,Mn.s)(nt.validateAndUpdate())},[nt]),Xa=Ro=>{Ro.value&&Le(Ro.value)},mr=(0,re.useCallback)(Ro=>{const[,pl]=kt(Ro.currentTarget.value,Zs);fn!==pl&&Cn(pl)},[Zs,fn,kt]),no=Ro=>{fn||nt.setState({name:Ro.currentTarget.value})},ir=Ro=>nt.setState({label:Ro.currentTarget.value}),Br=Ro=>nt.setState({description:Ro.currentTarget.value}),il=Ro=>nt.setState({hide:Ro}),Gl=(0,Qr.n_)(nt),yd=Ro=>()=>{(0,H.rR)("Delete variable"),mt(as),Ro()};return(0,h.jsxs)("form",{"aria-label":"Variable editor Form",children:[(0,h.jsx)(Uo,{onChange:Xa,type:ts}),(0,h.jsx)(aa.Y,{children:"General"}),(0,h.jsx)(Aa._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:as??"",onChange:mr,onBlur:no,testId:R.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:Dr.M.MaxSize,required:!0,invalid:!!fn,error:fn}),(0,h.jsx)(Aa._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:_s??"",onBlur:ir,testId:R.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,h.jsx)(ar.Z,{name:"Description",defaultValue:Fs??"",placeholder:"Descriptive text",onBlur:Br,width:52}),(0,h.jsx)(qa.D,{onChange:il,hide:Ha||zn.rw.hide,type:ts}),Pr&&(0,h.jsx)(Pr,{variable:nt,onRunQuery:nr}),Gl&&(0,h.jsx)(yr.j,{options:nt.getOptionsForSelect()}),(0,h.jsx)("div",{className:yn.buttonContainer,children:(0,h.jsxs)(L.B,{gap:2,children:[(0,h.jsx)(Es.$s,{children:({showModal:Ro,hideModal:pl})=>(0,h.jsx)(T.$n,{variant:"destructive",fill:"outline",onClick:()=>{Ro(po.u,{title:"Delete variable",body:`Are you sure you want to delete: ${as}?`,confirmText:"Delete variable",onConfirm:yd(pl),onDismiss:pl,isOpen:!0})},children:"Delete"})}),(0,h.jsx)(T.$n,{variant:"secondary","data-testid":R.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:et,children:"Back to list"}),Gl&&(0,h.jsx)(T.$n,{disabled:Or.loading,variant:"secondary","data-testid":R.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:nr,children:Or.loading?(0,h.jsx)(Ts._,{className:yn.loadingPlaceHolder,text:"Running query..."}):"Run query"})]})})]})}const lo=nt=>({buttonContainer:(0,Oe.css)({marginTop:nt.spacing(2)}),loadingPlaceHolder:(0,Oe.css)({marginBottom:0})});var xo=e(91076),Yr=e(2223);function zr(nt){return nt.map(Le=>({id:Le.state.name,label:`${Le.state.name}`}))}function qo(nt,Le){return nt.filter(et=>Le.some(mt=>mt.from===et.id||mt.to===et.id))}const Mi=nt=>{const Le=[];for(const et of nt)for(const mt of nt){if(et===mt)continue;et.variableDependency?.hasDependencyOn(mt.state.name)&&Le.push({from:et.state.name,to:mt.state.name})}return Le},_i=({variables:nt})=>{const Le=(0,re.useMemo)(()=>zr(nt),[nt]),et=(0,re.useMemo)(()=>Mi(nt),[nt]);return et.length?(0,h.jsx)(Yr.i,{show:!1,title:(0,pn.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:qo(Le,et),edges:et,children:({showModal:mt})=>(0,h.jsx)(T.$n,{onClick:()=>{(0,H.rR)("Show variable dependencies"),mt()},icon:"channel-add",variant:"secondary",children:(0,h.jsx)(pn.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};function Hi({index:nt,variable:Le,onEdit:et,onDuplicate:mt,onDelete:kt}){const yn=(0,$t.$j)(),fn=(0,$t.of)(ft),Cn=(0,Qr.Ao)(Le),as=Le.state,ts=as.name,[_s,Fs]=(0,re.useState)(!1),Ha=Pr=>()=>{Fs(Pr)},Zs=()=>{(0,H.rR)("Delete variable"),kt(ts)};return(0,h.jsx)(xo.sx,{draggableId:JSON.stringify(ts),index:nt,children:(Pr,Or)=>(0,h.jsxs)("tr",{ref:Pr.innerRef,...Pr.draggableProps,style:{userSelect:Or.isDragging?"none":"auto",background:Or.isDragging?yn.colors.background.secondary:void 0,...Pr.draggableProps.style},children:[(0,h.jsx)("td",{role:"gridcell",className:fn.column,children:(0,h.jsx)(T.$n,{size:"xs",fill:"text",onClick:nr=>{nr.preventDefault(),et(ts)},className:fn.nameLink,"data-testid":R.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(as.name),children:as.name})}),(0,h.jsx)("td",{role:"gridcell",className:fn.definitionColumn,onClick:nr=>{nr.preventDefault(),et(ts)},"data-testid":R.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(as.name),children:Cn}),(0,h.jsx)("td",{role:"gridcell",className:fn.column,children:(0,h.jsxs)("div",{className:fn.icons,children:[(0,h.jsx)(Bo.K,{onClick:nr=>{nr.preventDefault(),(0,H.rR)("Duplicate variable"),mt(ts)},name:"copy",tooltip:"Duplicate variable","data-testid":R.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(as.name)}),(0,h.jsx)(Bo.K,{onClick:nr=>{nr.preventDefault(),Fs(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":R.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(as.name)}),(0,h.jsx)(po.u,{isOpen:_s,title:"Delete variable",body:`Are you sure you want to delete: ${as.name}?`,confirmText:"Delete variable",onConfirm:Zs,onDismiss:Ha(!1)}),(0,h.jsx)("div",{...Pr.dragHandleProps,className:fn.dragHandle,children:(0,h.jsx)(An.I,{name:"draggabledots",size:"lg"})})]})})]})})}function ft(nt){return{dragHandle:(0,Oe.css)({cursor:"grab",marginLeft:nt.spacing(1)}),column:(0,Oe.css)({width:"1%"}),nameLink:(0,Oe.css)({cursor:"pointer",color:nt.colors.primary.text}),definitionColumn:(0,Oe.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,Oe.css)({color:nt.v1.palette.greenBase,marginRight:nt.spacing(2)}),iconFailed:(0,Oe.css)({color:nt.v1.palette.orange,marginRight:nt.spacing(2)}),icons:(0,Oe.css)({display:"flex",gap:nt.spacing(2),alignItems:"center"})}}function hn({variables:nt,onChangeOrder:Le,onDelete:et,onDuplicate:mt,onAdd:kt,onEdit:yn}){const fn=(0,$t.of)(_n),Cn=as=>{!as.destination||!as.source||((0,H.rR)("Variable drag and drop"),Le(as.source.index,as.destination.index))};return(0,h.jsx)("div",{children:(0,h.jsxs)("div",{children:[nt.length===0&&(0,h.jsx)(dn,{onAdd:kt}),nt.length>0&&(0,h.jsxs)(L.B,{direction:"column",gap:3,children:[(0,h.jsx)("div",{className:fn.tableContainer,children:(0,h.jsxs)("table",{className:"filter-table filter-table--hover","data-testid":R.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Variable"}),(0,h.jsx)("th",{children:"Definition"}),(0,h.jsx)("th",{colSpan:5})]})}),(0,h.jsx)(xo.JY,{onDragEnd:Cn,children:(0,h.jsx)(xo.gL,{droppableId:"variables-list",direction:"vertical",children:as=>(0,h.jsxs)("tbody",{ref:as.innerRef,...as.droppableProps,children:[nt.map((ts,_s)=>{const Fs=ts.state;return(0,h.jsx)(Hi,{index:_s,variable:ts,onDelete:et,onDuplicate:mt,onEdit:yn},`${Fs.name}-${_s}`)}),as.placeholder]})})})]})}),(0,h.jsxs)(L.B,{children:[(0,h.jsx)(_i,{variables:nt}),(0,h.jsx)(T.$n,{"data-testid":R.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:kt,icon:"plus",children:"New variable"})]})]})]})})}function dn({onAdd:nt}){return(0,h.jsx)(L.B,{direction:"column",children:(0,h.jsxs)(Ho.p,{variant:"call-to-action",button:(0,h.jsx)(T.$n,{"data-testid":R.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:nt,size:"lg",children:(0,h.jsx)(pn.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,pn.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,h.jsx)("p",{children:(0,h.jsx)(pn.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,h.jsxs)(pn.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,h.jsx)(ui.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const _n=()=>({tableContainer:(0,Oe.css)({overflow:"scroll",width:"100%"})});class ss extends g.Bs{constructor(){super(...arguments),this._urlSync=new Do(this),this.getVariableIndex=Le=>this.getVariables().findIndex(mt=>mt.state.name===Le),this.replaceEditVariable=Le=>{const et=this.state.editIndex??-1,{variables:mt}=this.getVariableSet().state;if(!mt[et]){console.error("Variable not found");return}const yn=[...mt.slice(0,et),Le,...mt.slice(et+1)];this.getVariableSet().setState({variables:yn})},this.onDelete=Le=>{const et=this.getVariableIndex(Le),{variables:mt}=this.getVariableSet().state;if(et===-1){console.error("Variable not found");return}const kt=[...mt.slice(0,et),...mt.slice(et+1)];this.getVariableSet().setState({variables:kt}),this.setState({editIndex:void 0})},this.onDuplicated=Le=>{const et=this.getVariableIndex(Le),mt=this.getVariableSet().state.variables;if(et===-1){console.error("Variable not found");return}const kt=mt[et];let yn=0,fn=`copy_of_${kt.state.name}`;for(;mt.some(ts=>ts.state.name===fn);)yn++,fn=`copy_of_${kt.state.name}_${yn}`;const Cn=kt.clone(kt.state);Cn.setState({name:fn});const as=[...mt.slice(0,et+1),Cn,...mt.slice(et+1)];this.getVariableSet().setState({variables:as})},this.onOrderChanged=(Le,et)=>{const mt=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(Le<0||Le>=mt.length||et<0||et>=mt.length){console.error("Invalid index");return}const kt=[...mt],yn=kt.splice(Le,1);kt.splice(et,0,yn[0]),this.getVariableSet().setState({variables:kt})},this.onEdit=Le=>{const et=this.getVariableIndex(Le);if(et===-1){console.error("Variable not found");return}this.setState({editIndex:et})},this.onAdd=()=>{const Le=this.getVariables(),et=Le.length,mt=(0,Qr.kh)(Le);this.getVariableSet().setState({variables:[...this.getVariables(),mt]}),this.setState({editIndex:et})},this.onTypeChange=Le=>{const et=this.state.editIndex??-1,{variables:mt}=this.getVariableSet().state,kt=mt[et];if(!kt){console.error("Variable not found");return}const{name:yn,label:fn}=kt.state,Cn=(0,Qr.No)(Le,{name:yn,label:fn});this.replaceEditVariable(Cn)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(Le,et)=>{let mt=null;Qr.cH.test(Le)||(mt="Template names cannot begin with '__', that's reserved for Grafana's global variables"),Qr.mJ.test(Le)||(mt="Only word characters are allowed in variable names");const kt=this.getVariableSet().getByName(Le)?.state;return kt&&kt.key!==et&&(mt="Variable with the same name already exists"),mt?[!0,mt]:[!1,null]}}static{this.Component=Yn}getUrlKey(){return"variables"}getDashboard(){return(0,be.YQ)(this)}getVariableSet(){return g.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function Yn({model:nt}){const Le=nt.getDashboard(),{navModel:et,pageNav:mt}=fa(Le,nt.getUrlKey()),{onDelete:kt,onDuplicated:yn,onOrderChanged:fn,onEdit:Cn,onTypeChange:as,onGoBack:ts,onAdd:_s}=nt,{variables:Fs}=nt.getVariableSet().useState(),{editIndex:Ha}=nt.useState();if(Ha!==void 0&&Fs[Ha]){const Zs=Fs[Ha];if(Zs)return(0,h.jsx)(Bs,{variable:Zs,onTypeChange:as,onGoBack:ts,pageNav:mt,navModel:et,dashboard:Le,onDelete:kt,onValidateVariableName:nt.onValidateVariableName})}return(0,h.jsxs)(Yt.Y,{navModel:et,pageNav:mt,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:Le}),(0,h.jsx)(hn,{variables:Fs,onDelete:kt,onDuplicate:yn,onChangeOrder:fn,onAdd:_s,onEdit:Cn})]})}function Bs({variable:nt,pageNav:Le,navModel:et,dashboard:mt,onTypeChange:kt,onGoBack:yn,onDelete:fn,onValidateVariableName:Cn}){const{name:as}=nt.useState(),ts={text:as,parentItem:Le};return(0,h.jsxs)(Yt.Y,{navModel:et,pageNav:ts,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:mt}),(0,h.jsx)(Co,{variable:nt,onTypeChange:kt,onGoBack:yn,onDelete:fn,onValidateVariableName:Cn},nt.state.key)]})}const Ns=10;class Ps extends g.Bs{constructor(Le){super({...Le,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=Ns,this._start=0,this.fetchVersions=(et=!1)=>{const mt=this._dashboard.state.uid;mt&&(this.setState({isAppending:et}),Dt.wL.getHistoryList(mt,{limit:this._limit,start:this._start}).then(kt=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(kt)]}),this._start+=this._limit}).catch(kt=>console.log(kt)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const et=this.versions.filter(as=>as.checked),[mt,kt]=et,yn=mt.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const fn=await Dt.wL.getDashboardVersion(this._dashboard.state.uid,kt.version),Cn=await Dt.wL.getDashboardVersion(this._dashboard.state.uid,mt.version);this.setState({baseInfo:kt,isLoading:!1,isNewLatest:yn,newInfo:mt,viewMode:"compare",diffData:{lhs:fn.data,rhs:Cn.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(et=>({...et,checked:!1})),viewMode:"list"})},this.onCheck=(et,mt)=>{this.setState({versions:this.versions.map(kt=>kt.id===mt?{...kt,checked:et.currentTarget.checked}:kt)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=za}get _dashboard(){return(0,be.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return g.jh.getTimeRange(this._dashboard)}decorateVersions(Le){const et=this.getTimeRange().getTimeZone();return Le.map(mt=>({...mt,createdDateString:(0,Se.LE)(mt.created,{timeZone:et}),ageString:(0,Se.fq)(mt.created,{timeZone:et}),checked:!1}))}}function za({model:nt}){const Le=nt.getDashboard(),{isLoading:et,isAppending:mt,viewMode:kt,baseInfo:yn,newInfo:fn,isNewLatest:Cn}=nt.useState(),{navModel:as,pageNav:ts}=fa(Le,nt.getUrlKey()),_s=nt.versions.filter(nr=>nr.checked).length===2,Fs=nt.versions.length>1,Ha=nt.versions.length>=nt.limit,Zs=nt.versions.find(nr=>nr.version===1),Pr=(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Dt.me,{onClick:nt.reset,baseVersion:yn?.version,newVersion:fn?.version,isNewLatest:Cn}),et?(0,h.jsx)(Pa,{msg:"Fetching changes\u2026"}):(0,h.jsx)(Dt.Cc,{newInfo:fn,baseInfo:yn,isNewLatest:Cn,diffData:nt.diffData,onRestore:Le.onRestore})]}),Or=(0,h.jsxs)(h.Fragment,{children:[et?(0,h.jsx)(Pa,{msg:"Fetching history list\u2026"}):(0,h.jsx)(Dt.bS,{versions:nt.versions,onCheck:nt.onCheck,canCompare:_s,onRestore:Le.onRestore}),mt&&(0,h.jsx)(Pa,{msg:"Fetching more entries\u2026"}),Fs&&(0,h.jsx)(Dt.rJ,{hasMore:Ha,canCompare:_s,getVersions:nt.fetchVersions,getDiff:nt.getDiff,isLastPage:!!Zs})]});return(0,h.jsxs)(Yt.Y,{navModel:as,pageNav:ts,layout:jt.k.Standard,children:[(0,h.jsx)(Mt.c,{dashboard:Le}),kt==="compare"?Pr:Or]})}const Pa=({msg:nt})=>(0,h.jsxs)(L.B,{children:[(0,h.jsx)(Pn.y,{}),(0,h.jsx)("em",{children:nt})]});function fa(nt,Le){const et=(0,pt.zy)(),mt=(0,_.useSelector)(Cn=>Cn.navIndex),kt=(0,c.tc)(mt,"dashboards/browse"),yn=nt.getPageNav(et,mt),fn={text:"Settings",url:n.I.getUrlForPartial(et,{editview:"settings",editIndex:null}),children:[],parentItem:yn};return nt.state.meta.canEdit&&(fn.children.push({text:(0,pn.t)("dashboard-settings.general.title","General"),url:n.I.getUrlForPartial(et,{editview:"settings",editIndex:null}),active:Le==="settings"}),fn.children.push({text:(0,pn.t)("dashboard-settings.annotations.title","Annotations"),url:n.I.getUrlForPartial(et,{editview:"annotations",editIndex:null}),active:Le==="annotations"}),fn.children.push({text:(0,pn.t)("dashboard-settings.variables.title","Variables"),url:n.I.getUrlForPartial(et,{editview:"variables",editIndex:null}),active:Le==="variables"}),fn.children.push({text:(0,pn.t)("dashboard-settings.links.title","Links"),url:n.I.getUrlForPartial(et,{editview:"links",editIndex:null}),active:Le==="links"})),nt.state.id&&nt.state.meta.canSave&&fn.children.push({text:(0,pn.t)("dashboard-settings.versions.title","Versions"),url:n.I.getUrlForPartial(et,{editview:"versions",editIndex:null}),active:Le==="versions"}),nt.state.id&&nt.state.meta.canAdmin&&gr.contextSrv.hasPermission(_.AccessControlAction.DashboardsPermissionsRead)&&fn.children.push({text:(0,pn.t)("dashboard-settings.permissions.title","Permissions"),url:n.I.getUrlForPartial(et,{editview:"permissions",editIndex:null}),active:Le==="permissions"}),fn.children.push({text:(0,pn.t)("dashboard-settings.json-editor.title","JSON Model"),url:n.I.getUrlForPartial(et,{editview:"json-model",editIndex:null}),active:Le==="json-model"}),{navModel:kt,pageNav:fn}}function _a(nt){switch(nt){case"annotations":return new Ei({});case"variables":return new ss({});case"links":return new Rs({});case"versions":return new Ps({});case"json-model":return new ja({});case"permissions":return new Rt({});case"settings":default:return new io({})}}class da extends g.Bs{constructor(Le){super(Le),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const Le=this.state.panelRef.resolve(),et=g.Go.cloneSceneObjectState(Le.state,{key:Le.state.key+"-view",$variables:this.getScopedVariables(Le)}),mt=new g.Eb(et);return this.setState({body:mt}),()=>{mt.state.$data&&Le.setState({$data:mt.state.$data.clone()})}}getScopedVariables(Le){const et=ta(Le),mt=[];if(et&&et.state.$variables)for(const kt of et.state.$variables.state.variables)mt.push(kt.clone());if(Le.state.$variables)for(const kt of Le.state.$variables.state.variables)mt.push(kt.clone());if(mt.length>0)return new g.Pj({variables:mt})}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:Le})=>{const{body:et}=Le.useState();return et?(0,h.jsx)(et.Component,{model:et}):null}}}function ta(nt){try{return g.jh.getAncestor(nt,g.tI)}catch{return}}var Ba=e(30195);class Ea{constructor(Le){this._scene=Le}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk"]}getUrlState(){const Le=this._scene.state;return{inspect:Le.inspectPanelKey,autofitpanels:Le.body instanceof g.hy&&Le.body.state.UNSAFE_fitPanels?"true":void 0,viewPanel:Le.viewPanelScene?.getUrlKey(),editview:Le.editview?.getUrlKey(),editPanel:Le.editPanel?.getUrlKey()||void 0,kiosk:Le.kioskMode===_.KioskMode.Full?"":Le.kioskMode===_.KioskMode.TV?"tv":void 0}}updateFromUrl(Le){const{inspectPanelKey:et,viewPanelScene:mt,isEditing:kt,editPanel:yn}=this._scene.state,fn={};if(typeof Le.editview=="string"&&this._scene.canEditDashboard()?(fn.editview=_a(Le.editview),kt||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):fn.editview=void 0)):Le.hasOwnProperty("editview")&&(fn.editview=void 0),typeof Le.inspect=="string"){let Cn=(0,be.vL)(this._scene,Le.inspect);if(!Cn){o.A.emit(s.r1.alertError,["Panel not found"]),i.Ny.partial({inspect:null});return}if((0,be.Yr)(Cn)){this._handleLibraryPanel(Cn,as=>{if(as.state.key===void 0)throw new Error("library panel key is undefined");const ts=new rr({$behaviors:[new or({panelKey:as.state.key})]});this._scene.setState({overlay:ts,inspectPanelKey:as.state.key})});return}fn.inspectPanelKey=Le.inspect,fn.overlay=new rr({$behaviors:[new or({panelKey:Le.inspect})]})}else et&&(fn.inspectPanelKey=void 0,fn.overlay=void 0);if(typeof Le.viewPanel=="string"){const Cn=(0,be.vL)(this._scene,Le.viewPanel);if(!Cn){if((0,be.SN)(Le.viewPanel)){this._handleViewRepeatClone(Le.viewPanel);return}o.A.emit(s.r1.alertError,["Panel not found"]),i.Ny.partial({viewPanel:null});return}if((0,be.Yr)(Cn)){this._handleLibraryPanel(Cn,as=>this._buildLibraryPanelViewScene(as));return}fn.viewPanelScene=new da({panelRef:Cn.getRef()})}else mt&&Le.viewPanel===null&&(fn.viewPanelScene=void 0);if(typeof Le.editPanel=="string"){const Cn=(0,be.vL)(this._scene,Le.editPanel);if(!Cn){console.warn(`Panel ${Le.editPanel} not found`);return}if(this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),kt||this._scene.onEnterEditMode(),(0,be.Yr)(Cn)){this._handleLibraryPanel(Cn,as=>{this._scene.setState({editPanel:(0,_o.L)(as)})});return}fn.editPanel=(0,_o.L)(Cn)}else yn&&Le.editPanel===null&&(fn.editPanel=void 0);if(this._scene.state.body instanceof g.hy){const Cn=typeof Le.autofitpanels=="string";!!this._scene.state.body.state.UNSAFE_fitPanels!==Cn&&this._scene.state.body.setState({UNSAFE_fitPanels:Cn})}typeof Le.kiosk=="string"&&(Le.kiosk==="true"||Le.kiosk===""?fn.kioskMode=_.KioskMode.Full:Le.kiosk==="tv"&&(fn.kioskMode=_.KioskMode.TV)),Object.keys(fn).length>0&&this._scene.setState(fn)}_buildLibraryPanelViewScene(Le){this._scene.setState({viewPanelScene:new da({panelRef:Le.getRef()})})}_handleLibraryPanel(Le,et){if(!(Le.parent instanceof vt.F))throw new Error("Panel is not a child of a LibraryVizPanel");const mt=Le.parent;mt.state.isLoaded?et(Le):(mt.subscribeToState(kt=>{et(kt.panel)}),mt.activate())}_handleViewRepeatClone(Le){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(Ba.d,()=>{const et=(0,be.vL)(this._scene,Le);et&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new da({panelRef:et.getRef()})}))}))}}class or extends g.Bs{constructor(Le){super(Le),this._onActivate=()=>{const et=this.parent;if(!et||!(et instanceof rr))throw new Error("ResolveInspectPanelByKey must be attached to a PanelInspectDrawer");const mt=(0,be.YQ)(et);if(!mt)return;const kt=this.state.panelKey;let yn=(0,be.vL)(mt,kt);mt.state.editPanel&&(yn=mt.state.editPanel.state.vizManager.state.panel),mt.state.viewPanelScene&&mt.state.viewPanelScene.state.body&&(yn=mt.state.viewPanelScene.state.body),yn&&et.setState({panelRef:yn.getRef()})},this.addActivationHandler(this._onActivate)}}var co=e(79284),Mo=e(54625),No=e(76885),ro=e(67647),ki=e(83277),Hl=e(2468),Gi=(nt=>(nt[nt.Persisted=0]="Persisted",nt[nt.Result=1]="Result",nt))(Gi||{});function bi(nt){return{metadata:{name:nt},spec:{filters:[],title:nt,type:"",category:"",description:""}}}function Ui(nt,Le){return{...nt,metadata:{...nt.metadata,...Le.metadata},spec:{...nt.spec,...Le.spec}}}const wo="scope.grafana.app",ul="v0alpha1",hl=r.$.namespace??"default",lc=`/apis/${wo}/${ul}/namespaces/${hl}/find/scope_node_children`,fl=`/apis/${wo}/${ul}/namespaces/${hl}/find/scope_dashboard_bindings`,ol=new Hl.w({group:wo,version:ul,resource:"scopes"}),Sl=new Map;async function Tl(nt,Le){try{return(await(0,W.AI)().get(lc,{parent:nt,query:Le}))?.items??[]}catch{return[]}}async function kl(nt,Le){return(await Tl(nt,Le)).reduce((et,{metadata:{name:mt},spec:kt})=>(et[mt]={name:mt,...kt,isExpandable:kt.nodeType==="container",isSelectable:kt.linkType==="scope",isExpanded:!1,query:"",reason:Gi.Result,nodes:{}},et),{})}async function Ml(nt){if(Sl.has(nt))return Sl.get(nt);const Le=new Promise(async et=>{const mt=bi(nt);try{const kt=await ol.get(nt),yn=Ui(mt,kt);et(yn)}catch{Sl.delete(nt),et(mt)}});return Sl.set(nt,Le),Le}async function fi(nt){return await Promise.all(nt.map(Ml))}async function gl(nt){return(await fi(nt.map(({scopeName:et})=>et))).reduce((et,mt,kt)=>(et.push({scope:mt,path:nt[kt].path}),et),[])}async function $e(nt){try{return(await(0,W.AI)().get(fl,{scope:nt.map(({metadata:{name:et}})=>et)}))?.items??[]}catch{return[]}}async function Ye(nt){const Le=await $e(nt);return Object.values(Le.reduce((et,mt)=>(et[mt.spec.dashboard]||(et[mt.spec.dashboard]={dashboard:mt.spec.dashboard,dashboardTitle:mt.spec.dashboardTitle,items:[]}),et[mt.spec.dashboard].items.push(mt),et),{}))}class rt extends g.Bs{static{this.Component=xt}constructor(){super({dashboards:[],filteredDashboards:[],isLoading:!1,scopesSelected:!1,searchQuery:""})}async fetchDashboards(Le){if(Le.length===0)return this.setState({dashboards:[],filteredDashboards:[],isLoading:!1,scopesSelected:!1});this.setState({isLoading:!0});const et=await Ye(Le);this.setState({dashboards:et,filteredDashboards:this.filterDashboards(et,this.state.searchQuery),isLoading:!1,scopesSelected:Le.length>0})}changeSearchQuery(Le){this.setState({filteredDashboards:Le?this.filterDashboards(this.state.dashboards,Le):this.state.dashboards,searchQuery:Le??""})}filterDashboards(Le,et){const mt=et.toLowerCase();return Le.filter(({dashboardTitle:kt})=>kt.toLowerCase().includes(mt))}}function xt({model:nt}){const{dashboards:Le,filteredDashboards:et,isLoading:mt,searchQuery:kt,scopesSelected:yn}=nt.useState(),fn=(0,$t.of)(Kt),[Cn]=(0,ki.s)();if(!mt)if(yn){if(Le.length===0)return(0,h.jsx)("p",{className:fn.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForScope",children:(0,h.jsx)(pn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForScopes",children:"No dashboards found for the selected scopes"})})}else return(0,h.jsx)("p",{className:fn.noResultsContainer,"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,h.jsx)(pn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsNoScopes",children:"No scopes selected"})});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:fn.searchInputContainer,children:(0,h.jsx)(ro.Z,{disabled:mt,placeholder:(0,pn.t)("scopes.suggestedDashboards.search","Search"),value:kt,"data-testid":"scopes-dashboards-search",onChange:as=>nt.changeSearchQuery(as)})}),mt?(0,h.jsx)(Ts._,{className:fn.loadingIndicator,text:(0,pn.t)("scopes.suggestedDashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):et.length>0?(0,h.jsx)(sn.E,{children:et.map(({dashboard:as,dashboardTitle:ts})=>(0,h.jsx)(Mo.Link,{to:No.kM.renderUrl(`/d/${as}/`,Cn),className:fn.dashboardItem,"data-testid":`scopes-dashboards-${as}`,children:ts},as))}):(0,h.jsxs)("p",{className:fn.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,h.jsx)(pn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForFilter",children:"No results found for your query"}),(0,h.jsx)(T.$n,{variant:"secondary",onClick:()=>nt.changeSearchQuery(""),"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,h.jsx)(pn.x6,{i18nKey:"scopes.suggestedDashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const Kt=nt=>({noResultsContainer:(0,Oe.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:nt.spacing(1),justifyContent:"center",textAlign:"center"}),searchInputContainer:(0,Oe.css)({flex:"0 1 auto"}),loadingIndicator:(0,Oe.css)({alignSelf:"center"}),dashboardItem:(0,Oe.css)({padding:nt.spacing(1,0),borderBottom:`1px solid ${nt.colors.border.weak}`,"& :is(:first-child)":{paddingTop:0}})});var en=e(65474),mn=e(69850),jn=e(56034);function Vn({nodes:nt,scopes:Le,isDisabled:et,isLoading:mt,onInputClick:kt,onRemoveAllClick:yn}){const fn=(0,$t.of)(qn),[Cn,as]=(0,re.useState)(!1);(0,re.useEffect)(()=>{as(!1)},[Le]);const ts=(0,re.useMemo)(()=>{const Ha=Le.map(({scope:Or,path:nr})=>{let Xa=nt,mr;nr.length>0?(mr=nr.map(ir=>{const Br=Xa[ir];if(!Br)return null;const{title:il,nodes:Gl}=Br;return Xa=Gl,il}).filter(ir=>ir!==null),mr[0]===""&&mr.splice(0,1)):mr=[Or.spec.title];const no=mr.pop();return[mr.join(" > "),no]}),Zs=(0,Ge.groupBy)(Ha,([Or])=>Or),Pr=Object.entries(Zs).map(([Or,nr])=>{const Xa=nr.map(([,mr])=>mr).join(", ");return(Or?[Or,Xa]:[Xa]).join(" > ")}).map(Or=>(0,h.jsx)("p",{className:fn.scopePath,children:Or},Or));return(0,h.jsx)(h.Fragment,{children:Pr})},[nt,Le,fn]),_s=(0,re.useMemo)(()=>Le.map(({scope:Ha})=>Ha.spec.title).join(", "),[Le]),Fs=(0,re.useMemo)(()=>(0,h.jsx)(j.p,{readOnly:!0,placeholder:(0,pn.t)("scopes.filters.input.placeholder","Select scopes..."),loading:mt,value:_s,"aria-label":(0,pn.t)("scopes.filters.input.placeholder","Select scopes..."),"data-testid":"scopes-filters-input",suffix:Le.length>0&&!et?(0,h.jsx)(Bo.K,{"aria-label":(0,pn.t)("scopes.filters.input.removeAll","Remove all scopes"),name:"times",onClick:()=>yn()}):void 0,onMouseOver:()=>as(!0),onMouseOut:()=>as(!1),onClick:()=>{et||kt()}}),[et,mt,kt,yn,Le,_s]);return(0,h.jsx)(jn.m,{content:ts,show:Le.length===0?!1:Cn,children:Fs})}const qn=nt=>({scopePath:(0,Oe.css)({color:nt.colors.text.primary,fontSize:nt.typography.pxToRem(14),margin:nt.spacing(1,0)})});function Us({anyChildExpanded:nt,query:Le,resultsNodes:et}){const mt=(0,$t.of)(Is);return nt?null:(0,h.jsx)("h6",{className:mt.container,"data-testid":"scopes-tree-headline",children:Le?et.length===0?(0,h.jsx)(pn.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,h.jsx)(pn.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,h.jsx)(pn.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const Is=nt=>({container:(0,Oe.css)({color:nt.colors.text.secondary,margin:nt.spacing(1,0)})});var $s=e(79569);function Vs({anyChildExpanded:nt,loadingNodeName:Le,node:et,nodePath:mt,nodes:kt,scopeNames:yn,scopes:fn,type:Cn,onNodeSelectToggle:as,onNodeUpdate:ts}){const _s=(0,$t.of)(Ra);return(0,h.jsx)("div",{role:"tree",children:kt.map(Fs=>{const Ha=Fs.isSelectable&&yn.includes(Fs.linkId);if(nt&&!Fs.isExpanded)return null;const Zs=[...mt,Fs.name],Pr=Zs.join(".");return(0,h.jsxs)("div",{role:"treeitem","aria-selected":Fs.isExpanded,children:[(0,h.jsxs)("div",{className:_s.title,children:[Fs.isSelectable&&!Fs.isExpanded?et.disableMultiSelect?(0,h.jsx)($s.J,{id:Pr,name:Pr,checked:Ha,label:"","data-testid":`scopes-tree-${Cn}-${Fs.name}-radio`,onClick:()=>{as(Zs)}}):(0,h.jsx)(ue.S,{checked:Ha,"data-testid":`scopes-tree-${Cn}-${Fs.name}-checkbox`,onChange:()=>{as(Zs)}}):null,Fs.isExpandable?(0,h.jsxs)("button",{className:_s.expand,"data-testid":`scopes-tree-${Cn}-${Fs.name}-expand`,"aria-label":Fs.isExpanded?(0,pn.t)("scopes.tree.collapse","Collapse"):(0,pn.t)("scopes.tree.expand","Expand"),onClick:()=>{ts(Zs,!Fs.isExpanded,Fs.query)},children:[(0,h.jsx)(An.I,{name:Fs.isExpanded?"angle-down":"angle-right"}),Fs.title]}):(0,h.jsx)("span",{"data-testid":`scopes-tree-${Cn}-${Fs.name}-title`,children:Fs.title})]}),(0,h.jsx)("div",{className:_s.children,children:Fs.isExpanded&&(0,h.jsx)(Wa,{nodes:et.nodes,nodePath:Zs,loadingNodeName:Le,scopes:fn,onNodeUpdate:ts,onNodeSelectToggle:as})})]},Fs.name)})})}const Ra=nt=>({title:(0,Oe.css)({alignItems:"center",display:"flex",gap:nt.spacing(1),fontSize:nt.typography.pxToRem(14),lineHeight:nt.typography.pxToRem(22),padding:nt.spacing(.5,0),"& > label":(0,Oe.css)({gap:0})}),expand:(0,Oe.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:nt.spacing(1),margin:0,padding:0}),children:(0,Oe.css)({paddingLeft:nt.spacing(4)})});var ga=e(70255);function Js({children:nt,isNodeLoading:Le}){const et=(0,$t.of)(ia);return Le?(0,h.jsx)(ga.A,{count:5,className:et.loader}):nt}const ia=nt=>({loader:(0,Oe.css)({margin:nt.spacing(.5,0)})});var Fa=e(40996);function Ya({anyChildExpanded:nt,nodePath:Le,query:et,onNodeUpdate:mt}){const kt=(0,$t.of)(ma),[yn,fn]=(0,re.useState)({value:et,isDirty:!1});return(0,re.useEffect)(()=>{!yn.isDirty&&yn.value!==et&&fn({value:et,isDirty:!1})},[yn,et]),(0,Fa.A)(()=>{yn.isDirty&&mt(Le,!0,yn.value)},500,[yn.isDirty,yn.value]),nt?null:(0,h.jsx)(ro.Z,{placeholder:(0,pn.t)("scopes.tree.search","Search"),value:yn.value,className:kt.input,"data-testid":"scopes-tree-search",onChange:Cn=>{fn({value:Cn,isDirty:!0})}})}const ma=nt=>({input:(0,Oe.css)({margin:nt.spacing(1,0)})});function Wa({nodes:nt,nodePath:Le,loadingNodeName:et,scopes:mt,onNodeUpdate:kt,onNodeSelectToggle:yn}){const fn=Le[Le.length-1],Cn=nt[fn],as=Object.values(Cn.nodes),ts=et===fn,_s=mt.map(({scopeName:Zs})=>Zs),Fs=as.some(({isExpanded:Zs})=>Zs),Ha=(0,re.useMemo)(()=>(0,Ge.groupBy)(as,"reason"),[as]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ya,{anyChildExpanded:Fs,nodePath:Le,query:Cn.query,onNodeUpdate:kt}),(0,h.jsxs)(Js,{isNodeLoading:ts,children:[(0,h.jsx)(Vs,{anyChildExpanded:Fs,isNodeLoading:ts,loadingNodeName:et,node:Cn,nodePath:Le,nodes:Ha[Gi.Persisted]??[],scopes:mt,scopeNames:_s,type:"persisted",onNodeSelectToggle:yn,onNodeUpdate:kt}),(0,h.jsx)(Us,{anyChildExpanded:Fs,query:Cn.query,resultsNodes:Ha[Gi.Result]??[]}),(0,h.jsx)(Vs,{anyChildExpanded:Fs,isNodeLoading:ts,loadingNodeName:et,node:Cn,nodePath:Le,nodes:Ha[Gi.Result]??[],scopes:mt,scopeNames:_s,type:"result",onNodeSelectToggle:yn,onNodeUpdate:kt})]})]})}class Tr extends g.Bs{constructor(){super({nodes:{"":{name:"",reason:Gi.Result,nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],treeScopes:[],isLoadingScopes:!1,isOpened:!1}),this._urlSync=new g.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>(this.fetchBaseNodes(),()=>{this.nodesFetchingSub?.unsubscribe()}))}static{this.Component=Jr}get scopesParent(){return g.jh.getAncestor(this,Mr)}getUrlState(){return{scopes:this.state.scopes.map(({scope:Le})=>Le.metadata.name)}}updateFromUrl(Le){let et=Le.scopes??[];et=Array.isArray(et)?et:[et],this.updateScopes(et.map(mt=>({scopeName:mt,path:[]})))}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(Le,et,mt){this.nodesFetchingSub?.unsubscribe();let kt={...this.state.nodes},yn=kt;for(let ts=0;ts<Le.length-1;ts++)yn=yn[Le[ts]].nodes;const fn=Le[Le.length-1],Cn=yn[fn],as=Cn.query!==mt;Cn.isExpanded=et,Cn.query=mt,et||as?(this.setState({nodes:kt,loadingNodeName:fn}),this.nodesFetchingSub=(0,en.H)(kl(fn,mt)).pipe((0,mn.j)(()=>{this.setState({loadingNodeName:void 0})})).subscribe(ts=>{const _s=this.state.treeScopes.map(({path:Fs})=>Fs[Fs.length-1]).filter(Fs=>Fs in Cn.nodes&&!(Fs in ts)).reduce((Fs,Ha)=>(Fs[Ha]={...Cn.nodes[Ha],reason:Gi.Persisted},Fs),{});Cn.nodes={..._s,...ts},this.setState({nodes:kt}),this.nodesFetchingSub?.unsubscribe()})):this.setState({nodes:kt,loadingNodeName:void 0})}toggleNodeSelect(Le){let et=[...this.state.treeScopes],mt=this.state.nodes[""];for(let Cn=1;Cn<Le.length-1;Cn++)mt=mt.nodes[Le[Cn]];const kt=Le[Le.length-1],{linkId:yn}=mt.nodes[kt],fn=et.findIndex(({scopeName:Cn})=>Cn===yn);if(fn===-1){Ml(yn);const Cn=et.length===0||Object.values(mt.nodes).some(({linkId:ts})=>ts===et[0].scopeName),as={scopeName:yn,path:Le};this.setState({treeScopes:mt?.disableMultiSelect||!Cn?[as]:[...et,as]})}else et.splice(fn,1),this.setState({treeScopes:et})}open(){if(!this.scopesParent.state.isViewing){let Le={...this.state.nodes};Le=this.closeNodes(Le);let et=[...this.state.scopes[0]?.path??["",""]];et.splice(et.length-1,1),Le=this.expandNodes(Le,et),this.setState({isOpened:!0,nodes:Le})}}close(){this.setState({isOpened:!1})}getSelectedScopes(){return this.state.scopes.map(({scope:Le})=>Le)}async updateScopes(Le=this.state.treeScopes){if((0,Ge.isEqual)(Le,this.getTreeScopes()))return;this.setState({scopes:Le.map(({scopeName:mt,path:kt})=>({scope:bi(mt),path:kt})),treeScopes:Le,isLoadingScopes:!0});const et=await gl(Le);this.setState({scopes:et,isLoadingScopes:!1})}resetDirtyScopeNames(){this.setState({treeScopes:this.getTreeScopes()})}removeAllScopes(){this.setState({scopes:[],treeScopes:[],isLoadingScopes:!1})}enterViewMode(){this.setState({isOpened:!1})}closeNodes(Le){return Object.entries(Le).reduce((et,[mt,kt])=>(et[mt]={...kt,isExpanded:!1,nodes:this.closeNodes(kt.nodes)},et),{})}expandNodes(Le,et){Le={...Le};let mt=Le;for(let kt=0;kt<et.length;kt++){const yn=et[kt];mt[yn]={...mt[yn],isExpanded:!0},mt=mt[yn].nodes}return Le}getTreeScopes(){return this.state.scopes.map(({scope:Le,path:et})=>({scopeName:Le.metadata.name,path:et}))}}function Jr({model:nt}){const Le=(0,$t.of)(_r),{nodes:et,loadingNodeName:mt,treeScopes:kt,isLoadingScopes:yn,isOpened:fn,scopes:Cn}=nt.useState(),{isViewing:as}=nt.scopesParent.useState();return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Vn,{nodes:et,scopes:Cn,isDisabled:as,isLoading:yn,onInputClick:()=>nt.open(),onRemoveAllClick:()=>nt.removeAllScopes()}),fn&&(0,h.jsxs)(D._,{title:(0,pn.t)("scopes.filters.title","Select scopes"),size:"sm",onClose:()=>{nt.close(),nt.resetDirtyScopeNames()},children:[yn?(0,h.jsx)(Pn.y,{"data-testid":"scopes-filters-loading"}):(0,h.jsx)(Wa,{nodes:et,nodePath:[""],loadingNodeName:mt,scopes:kt,onNodeUpdate:(ts,_s,Fs)=>nt.updateNode(ts,_s,Fs),onNodeSelectToggle:ts=>nt.toggleNodeSelect(ts)}),(0,h.jsxs)("div",{className:Le.buttonGroup,children:[(0,h.jsx)(T.$n,{variant:"primary","data-testid":"scopes-filters-apply",onClick:()=>{nt.close(),nt.updateScopes()},children:(0,h.jsx)(pn.x6,{i18nKey:"scopes.filters.apply",children:"Apply"})}),(0,h.jsx)(T.$n,{variant:"secondary","data-testid":"scopes-filters-cancel",onClick:()=>{nt.close(),nt.resetDirtyScopeNames()},children:(0,h.jsx)(pn.x6,{i18nKey:"scopes.filters.cancel",children:"Cancel"})})]})]})]})}const _r=nt=>({buttonGroup:(0,Oe.css)({display:"flex",gap:nt.spacing(1),marginTop:nt.spacing(8)})});class Mr extends g.Bs{static{this.Component=Ka}constructor(){super({dashboards:new rt,filters:new Tr,isExpanded:!1,isViewing:!1}),this.addActivationHandler(()=>{this._subs.add(this.state.filters.subscribeToState((Le,et)=>{!Le.isLoadingScopes&&Le.scopes!==et.scopes&&(this.state.isExpanded&&this.state.dashboards.fetchDashboards(this.state.filters.getSelectedScopes()),g.jh.getTimeRange(this.parent).onRefresh())})),this._subs.add(this.parent?.subscribeToState(Le=>{const et="isEditing"in Le?!!Le.isEditing:!1;et!==this.state.isViewing&&(et?this.enterViewMode():this.exitViewMode())}))})}getSelectedScopes(){return this.state.filters.getSelectedScopes()}toggleIsExpanded(){const Le=!this.state.isExpanded;Le&&this.state.dashboards.fetchDashboards(this.getSelectedScopes()),this.setState({isExpanded:Le})}enterViewMode(){this.setState({isExpanded:!1,isViewing:!0}),this.state.filters.enterViewMode()}exitViewMode(){this.setState({isViewing:!1})}}function Ka({model:nt}){const{filters:Le,dashboards:et,isExpanded:mt,isViewing:kt}=nt.useState(),yn=(0,$t.of)(Vo);return(0,h.jsxs)("div",{className:(0,Oe.cx)(yn.container,mt&&yn.containerExpanded),children:[(0,h.jsxs)("div",{className:(0,Oe.cx)(yn.filtersContainer,mt&&yn.filtersContainerExpanded),children:[!kt&&(0,h.jsx)(Bo.K,{name:"arrow-to-right",className:(0,Oe.cx)(!mt&&yn.iconNotExpanded),"aria-label":mt?(0,pn.t)("scopes.suggestedDashboards.toggle.collapse","Collapse scope filters"):(0,pn.t)("scopes.suggestedDashboards.toggle..expand","Expand scope filters"),"data-testid":"scopes-dashboards-expand",onClick:()=>nt.toggleIsExpanded()}),(0,h.jsx)(Le.Component,{model:Le})]}),mt&&!kt&&(0,h.jsx)("div",{className:yn.dashboardsContainer,"data-testid":"scopes-dashboards-container",children:(0,h.jsx)(et.Component,{model:et})})]})}const Vo=nt=>({container:(0,Oe.css)({display:"flex",flexDirection:"column",gridArea:"scopes"}),containerExpanded:(0,Oe.css)({backgroundColor:nt.colors.background.primary,height:"100%"}),filtersContainer:(0,Oe.css)({display:"flex",flex:"0 1 auto",flexDirection:"row",padding:nt.spacing(2,2,2,2)}),filtersContainerExpanded:(0,Oe.css)({borderBottom:`1px solid ${nt.colors.border.weak}`,padding:nt.spacing(2)}),iconNotExpanded:(0,Oe.css)({transform:"scaleX(-1)"}),dashboardsContainer:(0,Oe.css)({display:"flex",flex:"1 1 auto",flexDirection:"column",gap:nt.spacing(3),overflow:"hidden",padding:nt.spacing(2)})});var ei=e(69129),to=e(4898);class Ao{constructor(){this._binds=[]}addBinding(Le){to.R.bind(Le.key,et=>{et.preventDefault(),et.stopPropagation(),et.returnValue=!1,Le.onTrigger()},"keydown"),this._binds.push(Le)}removeAll(){this._binds.forEach(Le=>{to.R.unbind(Le.key,Le.type)}),this._binds=[]}}var Oi=e(91119),zo=e(85174),ti=e(30160),br=e(7196);function As(nt){const Le=new Ao;let et=null;const mt=nt.canEditDashboard(),kt=o.A.subscribe(ei.Tp,fn=>{typeof fn.payload.panelId=="string"&&(et=fn.payload.panelId)});function yn(fn,Cn){return()=>{const as=g.jh.findObject(fn,ts=>ts.state.key===et);if(as&&as instanceof g.Eb){Cn(as);return}}}return Le.addBinding({key:"v",onTrigger:yn(nt,fn=>{nt.state.viewPanelScene||i.Ny.push((0,dt.r7)(fn))})}),r.$.featureToggles.newDashboardSharingComponent?Le.addBinding({key:"p u",onTrigger:yn(nt,async fn=>{const Cn=new Oi.j({title:(0,pn.t)("share-panel.drawer.share-link-title","Link settings"),body:new ti.S({panelRef:fn.getRef()})});nt.showModal(Cn)})}):Le.addBinding({key:"p s",onTrigger:yn(nt,async fn=>{nt.showModal(new zo.Z({panelRef:fn.getRef()}))})}),Le.addBinding({key:"i",onTrigger:yn(nt,async fn=>{i.Ny.push((0,dt.Uu)(fn))})}),Le.addBinding({key:"p x",onTrigger:yn(nt,async fn=>{const Cn=await(0,dt.Lp)(fn);Cn&&i.Ny.push(Cn)})}),Le.addBinding({key:"p l",onTrigger:yn(nt,br.vR)}),Le.addBinding({key:"d r",onTrigger:()=>g.jh.getTimeRange(nt).onRefresh()}),Le.addBinding({key:"t z",onTrigger:()=>{ya(nt)}}),Le.addBinding({key:"ctrl+z",onTrigger:()=>{ya(nt)}}),Le.addBinding({key:"t a",onTrigger:()=>{Ie.b4.getTimePicker(nt)?.toAbsolute()}}),Le.addBinding({key:"t left",onTrigger:()=>{ws(nt,"left")}}),Le.addBinding({key:"t right",onTrigger:()=>{ws(nt,"right")}}),mt&&(Le.addBinding({key:"e",onTrigger:yn(nt,async fn=>{if(fn.getRoot()instanceof jr){const as=(0,be.Cs)(fn);nt.state.editPanel||i.Ny.push((0,dt.e0)(as))}})}),Le.addBinding({key:"d s",onTrigger:nt.onOpenSettings}),Le.addBinding({key:"mod+s",onTrigger:()=>nt.openSaveDrawer({})}),Le.addBinding({key:"p r",onTrigger:yn(nt,fn=>{nt.state.isEditing&&(0,br.MI)(nt,fn)})}),Le.addBinding({key:"p d",onTrigger:yn(nt,fn=>{nt.state.isEditing&&nt.duplicatePanel(fn)})}),Le.addBinding({key:"d shift+c",onTrigger:()=>{nt.collapseAllRows()}}),Le.addBinding({key:"d shift+e",onTrigger:()=>{nt.expandAllRows()}})),()=>{Le.removeAll(),kt.unsubscribe()}}function ya(nt){Ie.b4.getTimePicker(nt)?.onZoom()}function ws(nt,Le){const et=Ie.b4.getTimePicker(nt);et&&(Le==="left"&&et.onMoveBackward(),Le==="right"&&et.onMoveForward())}const Da=["title","description","tags","editable","graphTooltip","links","meta","preload"];class jr extends g.Bs{constructor(Le){super({title:"Dashboard",meta:{},editable:!0,body:Le.body??new g.G1({children:[]}),links:Le.links??[],scopes:Le.uid&&r.$.featureToggles.scopeFilters?new Mr:void 0,...Le}),this._urlSync=new Ea(this),this._variableDependency=new Zr(this),this._fromExplore=!1,this.onEnterEditMode=(et=!1)=>{this._fromExplore=et,this._initialState=g.Go.cloneSceneObjectState(this.state),this._initialUrlState=i.Ny.getLocation(),this.setState({isEditing:!0}),this.propagateEditModeChange(),this._changeTracker.startTrackingChanges()},this.onRestore=async et=>{const mt=await Dt.wL.restoreDashboard(et.uid,et.version);if(!Number.isInteger(mt.version))return!1;const kt={dashboard:new u.G(et.data),meta:this.state.meta},yn=(0,Ct.wM)(kt),fn=g.Go.cloneSceneObjectState(yn.state);return fn.version=mt.version,this.setState(fn),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{i.Ny.partial({editview:"settings"})},this._changeTracker=new E.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Jt}_activationHandler(){let Le=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this.state.isEditing&&(this._initialUrlState=i.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&m.t.watch(this.state.uid);let et=()=>{};r.$.publicDashboardAccessToken||(et=As(this));const mt=new Ae(this);return(0,p.UA)().setCurrent(mt),()=>{window.__grafanaSceneContext=Le,et(),this._changeTracker.terminate(),mt.destroy(),m.t.leave()}}saveCompleted(Le,et,mt){this._initialSaveModel={...Le,id:et.id,uid:et.uid,version:et.version},this._changeTracker.stopTrackingChanges(),this.setState({version:et.version,isDirty:!1,uid:et.uid,id:et.id,meta:{...this.state.meta,uid:et.uid,url:et.url,slug:et.slug,folderUid:mt,isNew:!1}}),this._changeTracker.startTrackingChanges()}propagateEditModeChange(){this.state.body instanceof g.hy&&(this.state.body.setState({isDraggable:this.state.isEditing,isResizable:this.state.isEditing}),(0,be.X0)(this.state.body,!0))}exitEditMode({skipConfirm:Le,restoreInitialState:et}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||Le){this.exitEditModeConfirmed(et||this.state.isDirty);return}o.A.publish(new f.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:this.exitEditModeConfirmed.bind(this)}))}exitEditModeConfirmed(Le=!0){this._changeTracker.stopTrackingChanges(),i.Ny.replace(n.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null})),this._fromExplore&&this.cleanupStateFromExplore(),Le?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.propagateEditModeChange()}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body instanceof g.hy&&this._initialState.body.setState({children:this._initialState.body.state.children.slice(1)})}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:Le,onSaveSuccess:et}){this.state.isEditing&&this.setState({overlay:new at({dashboardRef:this.getRef(),saveAsCopy:Le,onSaveSuccess:et})})}getPageNav(Le,et){const{meta:mt,viewPanelScene:kt,editPanel:yn}=this.state;if(mt.dashboardNotFound)return{text:"Not found"};let fn={text:this.state.title,url:(0,dt.uZ)({uid:this.state.uid,slug:mt.slug,currentQueryParams:Le.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null},isHomeDashboard:!mt.url&&!mt.slug&&!mt.isNew})};const{folderUid:Cn}=mt;if(Cn){const as=(0,c.tc)(et,`folder-dashboards-${Cn}`).main;as.id!=="not-found"&&(fn={...fn,parentItem:as})}return kt&&(fn={text:"View panel",parentItem:fn,url:(0,dt.r7)(kt.state.panelRef.resolve())}),yn&&(fn={text:"Edit panel",parentItem:fn}),fn}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addRow(Le){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const et=this.state.body,mt=et.state.children.findIndex(yn=>yn instanceof g.tI),kt=et.state.children.splice(0,mt===-1?et.state.children.length:mt).map(yn=>yn.clone());kt&&Le.setState({children:kt}),et.setState({children:[Le,...et.state.children]})}removeRow(Le,et=!1){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const mt=this.state.body,kt=mt.state.children.filter(yn=>yn.state.key!==Le.state.key);if(!et){const yn=Le.state.children.map(Cn=>Cn.clone()),fn=mt.state.children.findIndex(Cn=>Cn.state.key===Le.state.key);kt.splice(fn,0,...yn)}mt.setState({children:kt})}addPanel(Le){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const et=this.state.body,mt=(0,be.Cs)(Le),kt=new Ee.U({height:be.sw,width:be.vm,x:0,y:0,body:Le,key:`grid-item-${mt}`});et.setState({children:[kt,...et.state.children]})}createLibraryPanel(Le,et){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const kt=Le.state.key,yn=new vt.F({title:et.model?.title??"Panel",uid:et.uid,name:et.name,panelKey:kt??(0,be.XA)(Ie.b4.getNextPanelId(this))}),fn=Le.parent;if(!(fn instanceof Ee.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");fn.setState({body:yn})}duplicatePanel(Le){if(!Le.parent)return;const et=(0,Ie.WZ)(Le),mt=et?et.parent:Le.parent;if(!(mt instanceof Ee.U)){console.error("Trying to duplicate a panel in a layout that is not DashboardGridItem");return}let kt,yn,fn;const Cn=Ie.b4.getNextPanelId(this);if(et){const ts=g.Go.cloneSceneObjectState(mt.state);fn=new Ee.U({x:ts.x,y:ts.y,width:ts.width,height:ts.height,body:new vt.F({title:et.state.title,uid:et.state.uid,name:et.state.name,panelKey:(0,be.XA)(Cn)})})}else mt instanceof Ee.U?(kt=g.Go.cloneSceneObjectState(mt.state.body.state),yn=g.jh.getData(mt.state.body).clone()):(kt=g.Go.cloneSceneObjectState(Le.state),yn=g.jh.getData(Le).clone()),delete yn.state.data?.alertState,fn=new Ee.U({x:mt.state.x,y:mt.state.y,height:mt.state.height,width:mt.state.width,body:new g.Eb({...kt,$data:yn,key:(0,be.XA)(Cn)})});if(!(this.state.body instanceof g.hy)){console.error("Trying to duplicate a panel in a layout that is not SceneGridLayout ");return}const as=this.state.body;if(mt.parent instanceof g.tI){const ts=mt.parent;ts.setState({children:[...ts.state.children,fn]}),as.forceRender();return}as.setState({children:[...as.state.children,fn]})}copyPanel(Le){if(!Le.parent)return;let et=Le.parent;if(Le.parent instanceof vt.F){const kt=Le.parent;if(!kt.parent)return;et=kt.parent}if(!(et instanceof Ee.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const mt=(0,Ke.ZB)(et);a.A.set(d.tH,JSON.stringify(mt)),o.A.emit(s.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){if(!(this.state.body instanceof g.hy))throw new Error("Trying to add a panel in a layout that is not SceneGridLayout");const Le=a.A.get(d.tH),et=JSON.parse(Le),mt=new u.a(et),kt=mt.libraryPanel?(0,Ct.Al)(mt):(0,Ct.tt)(mt),yn=this.state.body;if(!(kt instanceof Ee.U))throw new Error("Cannot paste invalid grid item");const fn=Ie.b4.getNextPanelId(this);if(kt instanceof Ee.U&&kt.state.body instanceof vt.F){const Cn=(0,be.XA)(fn);kt.state.body.setState({panelKey:Cn});const as=kt.state.body.state.panel;as instanceof g.Eb&&as.setState({key:Cn})}else kt instanceof Ee.U&&kt.state.body?kt.state.body.setState({key:(0,be.XA)(fn)}):kt instanceof Ee.U&&kt.state.body.setState({key:(0,be.XA)(fn)});kt.setState({height:be.sw,width:be.vm,x:0,y:0,key:`grid-item-${fn}`}),yn.setState({children:[kt,...yn.state.children]}),a.A.delete(d.tH)}removePanel(Le){const et=[],mt=Le.parent instanceof vt.F?Le.parent.parent?.state.key:Le.parent?.state.key;if(!mt)return;let kt;try{kt=g.jh.getAncestor(Le,g.tI)}catch{kt=void 0}if(kt){kt.state.children.forEach(fn=>{fn.state.key!==mt&&et.push(fn)}),kt.setState({children:et}),this.state.body.forceRender();return}this.state.body.forEachChild(fn=>{fn.state.key!==mt&&et.push(fn)});const yn=this.state.body;(yn instanceof g.hy||yn instanceof g.G1)&&yn.setState({children:et})}unlinkLibraryPanel(Le){if(!Le.parent)return;const et=Le.parent;if(!(et instanceof Ee.U)){console.error("Trying to unlinka a lib panel in a layout that is not DashboardGridItem");return}et?.setState({body:Le.state.panel?.clone()})}showModal(Le){this.setState({overlay:Le})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:Le,uid:et}=this.state;if(et)try{const mt=await(0,p.UA)().starDashboard(et,!!Le.isStarred);this.setState({meta:{...Le,isStarred:mt}})}catch(mt){console.error("Failed to star dashboard",mt)}}onShowAddLibraryPanelDrawer(Le){this.setState({overlay:new Pt.o({panelToReplaceRef:Le})})}onCreateNewRow(){const Le=(0,be.Ws)(this);return this.addRow(Le),(0,be.Cs)(Le)}onCreateNewPanel(){this.state.isEditing||this.onEnterEditMode();const Le=(0,be.O8)(this);return this.addPanel(Le),Le}enrichDataRequest(Le){const et=(0,be.YQ)(Le);let mt=(0,be.xz)(Le);et.state.isEditing&&et.state.editPanel&&(mt=et.state.editPanel.state.vizManager.state.panel);let kt=0;return mt&&mt.state.key&&((0,be.SN)(mt.state.key)?kt=ke(mt?.state.key):kt=(0,be.Cs)(mt)),{app:l.Jk.Dashboard,dashboardUID:this.state.uid,panelId:kt,panelPluginId:mt?.state.pluginId,scopes:this.state.scopes?.getSelectedScopes()}}enrichFiltersRequest(){return{scopes:this.state.scopes?.getSelectedScopes()}}canEditDashboard(){const{meta:Le}=this.state;return!!(Le.canEdit||Le.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(Le){this._initialSaveModel=Le}async deleteDashboard(){await(0,v.A_)(this.state.uid,!0),this.setState({isDirty:!1}),i.Ny.replace("/")}collapseAllRows(){if(!(this.state.body instanceof g.hy))throw new Error("Dashboard scene layout is not SceneGridLayout");const Le=this.state.body;Le.state.children.forEach(et=>{et instanceof g.tI&&(et.state.isCollapsed||Le.toggleRow(et))})}expandAllRows(){if(!(this.state.body instanceof g.hy))throw new Error("Dashboard scene layout is not SceneGridLayout");const Le=this.state.body;Le.state.children.forEach(et=>{et instanceof g.tI&&et.state.isCollapsed&&Le.toggleRow(et)})}}class Zr{constructor(Le){this._dashboard=Le,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(Le,et){et&&o.A.publish(new x.og({refreshAll:!0,panelIds:[]}));const mt=this._dashboard.state.body;if(mt instanceof g.hy){for(const kt of mt.state.children)if(!(!(kt instanceof g.tI)||!kt.state.$behaviors))for(const yn of kt.state.$behaviors)yn instanceof co.L&&(yn.isWaitingForVariables||yn.state.variableName===Le.state.name&&et)&&yn.performRepeat()}}}},60656:(k,A,e)=>{"use strict";e.d(A,{F:()=>a});var n=e(74848),s=e(80943),l=e(34214),r=e(57767),i=e(96556),g=e(41507),o=e(42397),d=e(7196),c=e(99589);class a extends s.Bs{constructor(v){super({panel:v.panel??p(v.title,v.panelKey),isLoaded:v.isLoaded??!1,...v}),this._onActivate=()=>{this.state.isLoaded||this.loadLibraryPanelFromPanelModel()},this.addActivationHandler(this._onActivate)}static{this.Component=u}setPanelFromLibPanel(v){if(this.state._loadedPanel?.version===v.version)return;const x=new l.a(v.model),f={title:x.title,key:this.state.panelKey,options:x.options??{},fieldConfig:x.fieldConfig,pluginId:x.type,pluginVersion:x.pluginVersion,displayMode:x.transparent?"transparent":void 0,description:x.description,hoverHeader:!x.title&&!x.timeFrom&&!x.timeShift,hoverHeaderOffset:0,$data:(0,i.w)(x),menu:new s.Lw({$behaviors:[d._i]}),titleItems:[new o.$({rawLinks:x.links,menu:new o.m({$behaviors:[d.oV]})}),new c.W]},E=new s.Eb(f);this.setState({panel:E,_loadedPanel:v,isLoaded:!0,name:v.name})}async loadLibraryPanelFromPanelModel(){let v=this.state.panel;try{const x=await(0,r.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(x),this.parent instanceof g.U&&this.parent.setState({variableName:x.model.repeat,repeatDirection:x.model.repeatDirection==="h"?"h":"v",maxPerRow:x.model.maxPerRow})}catch{v.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}function p(m,v){return new s.Eb({key:v,title:m,menu:new s.Lw({$behaviors:[d._i]})})}function u({model:m}){const{panel:v}=m.useState();return v?(0,n.jsx)(v.Component,{model:v}):null}},73667:(k,A,e)=>{"use strict";e.d(A,{c:()=>qe});var n=e(74848),s=e(96540),l=e(32196),r=e(68941),i=e(13544),g=e(32264),o=e(39601),d=e(40845),c=e(27746),a=e(14578),p=e(39938),u=e(83122),m=e(38138),v=e(55852),x=e(19727),f=e(15068),E=e(75269),h=e(10804),y=e(15054),b=e(10096),D=e(8484),P=e(14792),C=e(2609),M=e(19293),I=e(22699),R=e(7758),T=e(91119),S=e(16817),L=e(70713),O=e(67061),j=e(15292),N=e(60029),F=e(32372),U=e(62930),w=e(10534),B=e(82467),K=e(3169),W=e(99140),z=e(74730),Y=e(50056);const X=i.Tp.pages.ExportDashboardDrawer.ExportAsJson;class q extends Y.N{static{this.Component=G}}function G({model:Fe}){const at=(0,z.YQ)(Fe),Ct=(0,d.of)(te),{isSharingExternally:Dt}=Fe.useState(),tt=(0,S.A)(async()=>{const Se=await Fe.getExportableDashboardJson();return JSON.stringify(Se,null,2)},[Dt]),ze=async()=>{await Fe.onSaveAsFile();const Se=(0,D.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,W.JD)((0,B.dx)((0,K.tZ)(Se)))},pe=(0,D.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(D.x6,{i18nKey:"export.json.info-text",children:"Copy or download a JSON file containing the JSON of your dashboard"})}),(0,n.jsxs)(O.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(j.d,{label:pe,"data-testid":X.exportExternallyToggle,id:"export-externally-toggle",value:Dt,onChange:Fe.onShareExternallyChange}),(0,n.jsx)(N.J,{children:pe})]}),(0,n.jsx)(L.Ay,{disableHeight:!0,className:Ct.codeEditorBox,"data-testid":X.codeEditor,children:({width:Se})=>tt.value?(0,n.jsx)(F.B,{value:tt.value,language:"json",showMiniMap:!1,height:"500px",width:Se,readOnly:!0}):tt.loading&&(0,n.jsx)(U.y,{})}),(0,n.jsx)("div",{className:Ct.container,children:(0,n.jsxs)(O.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(v.$n,{"data-testid":X.saveToFileButton,variant:"primary",icon:"download-alt",onClick:ze,children:(0,n.jsx)(D.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,n.jsx)(w.b,{"data-testid":X.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:tt.loading,getText:()=>tt.value??"",children:(0,n.jsx)(D.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,n.jsx)(v.$n,{"data-testid":X.cancelButton,variant:"secondary",onClick:()=>at.closeModal(),fill:"outline",children:(0,n.jsx)(D.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function te(Fe){return{codeEditorBox:(0,l.css)({margin:`${Fe.spacing(2)} 0`}),container:(0,l.css)({paddingBottom:Fe.spacing(2)})}}const H=i.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,se=[];function ne(Fe){se.push(Fe)}function le({dashboard:Fe}){const at=(0,s.useCallback)((tt,ze)=>{const pe=new T.j({title:tt,body:new ze});Fe.showModal(pe)},[Fe]),Ct=(0,s.useCallback)(()=>{const tt=[];return se.forEach(ze=>tt.push(ze)),tt.push({shareId:I.wr.export,testId:H.exportAsJson,icon:"arrow",label:(0,D.t)("share-dashboard.menu.export-json-title","Export as JSON"),renderCondition:!0,onClick:()=>at((0,D.t)("export.json.title","Save dashboard JSON"),q)}),tt.filter(ze=>ze.renderCondition)},[at]),Dt=tt=>{R.c.sharingCategoryClicked({item:tt.shareId,shareResource:(0,I.hD)()}),tt.onClick(Fe)};return(0,n.jsx)(m.W,{"data-testid":H.container,children:Ct().map(tt=>(0,n.jsx)(m.W.Item,{testId:tt.testId,label:tt.label,icon:tt.icon,description:tt.description,onClick:()=>Dt(tt)},tt.label))})}const _=i.Tp.pages.Dashboard.DashNav.NewExportButton;function Q({dashboard:Fe}){const[at,Ct]=(0,s.useState)(!1),Dt=(0,s.useCallback)(ze=>{Ct(ze)},[]),tt=()=>(0,n.jsx)(le,{dashboard:Fe});return(0,n.jsx)(x.e,{"data-testid":_.container,children:(0,n.jsx)(u.m,{overlay:tt,placement:"bottom-end",onVisibleChange:Dt,children:(0,n.jsxs)(v.$n,{"data-testid":_.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,D.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,n.jsx)(D.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,n.jsx)(a.I,{name:at?"angle-up":"angle-down",size:"lg"})]})})})}var ae=e(41053),oe=e(65163),J=e(70439);const ee=i.Tp.pages.Dashboard.DashNav.newShareButton;function de({dashboard:Fe,panel:at}){const[Ct,Dt]=(0,s.useState)(!1),[tt,ze]=(0,ae.A)(async()=>await(0,J.Xe)(Fe,at),[Fe]),pe=(0,s.useCallback)(fe=>{fe&&R.c.toolbarShareClick(),Dt(fe)},[]),Se=()=>(0,n.jsx)(oe.A,{dashboard:Fe});return(0,n.jsxs)(x.e,{"data-testid":ee.container,children:[(0,n.jsx)(v.$n,{"data-testid":ee.shareLink,size:"sm",tooltip:(0,D.t)("share-dashboard.share-button-tooltip","Copy shortened link"),onClick:ze,children:(0,n.jsx)(D.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,n.jsx)(u.m,{overlay:Se,placement:"bottom-end",onVisibleChange:pe,children:(0,n.jsx)(v.$n,{"data-testid":ee.arrowMenu,size:"sm",icon:Ct?"angle-up":"angle-down"})})]})}var xe=e(85174),re=e(99246),ue=e(80997),Te=e(96374),ge=e(28138),Oe=e(28444);function Ue(Fe){return(0,n.jsx)(c.I,{"data-testid":"button-snapshot",tooltip:(0,D.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>Xe(Fe.originalURL)},"button-snapshot")}const Xe=Fe=>{const at=Fe??"",Ct=ue.sQ.sanitizeUrl(at);try{const Dt=new URL(Ct,g.$.appUrl),tt=new URL(g.$.appUrl);Dt.host!==tt.host?ge.A.publish(new Oe.S8({component:Te.u,props:{title:"Proceed to external site?",modalClass:(0,l.css)({width:"max-content",maxWidth:"80vw"}),body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["This link connects to an external website at"," ",(0,n.jsx)("code",{children:at})]}),(0,n.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=Dt.href}}})):o.Ny.push(Ct)}catch(Dt){console.error("Failed to open original dashboard",Dt)}};var we=e(60656);const qe=s.memo(({dashboard:Fe})=>{const at=(0,s.useId)(),Ct=(0,n.jsx)(We,{dashboard:Fe},at);return(0,n.jsx)(E.H,{actions:Ct})});qe.displayName="NavToolbarActions";function We({dashboard:Fe}){const{isEditing:at,viewPanelScene:Ct,isDirty:Dt,uid:tt,meta:ze,editview:pe,editPanel:Se,editable:fe}=Fe.useState(),{isPlaying:Ee}=C._o.useState(),[Pe,he]=(0,s.useState)(!1),be=b.contextSrv.hasEditPermissionInFolders,Ae=[],De=(0,d.of)(_e),Ie=!!Se,ke=!!Ct,dt=Ke(Se),Pt=je(Se),pt=r.M.exists(y.tH),Tt=!pe&&!ke&&!Ie,jt=at&&Tt;Ie||Ce(Ae,re.C.left,"left-actions"),Ae.push({group:"icon-actions",condition:tt&&!!ze.canStar&&Tt&&!at,render:()=>{let bn=ze.isStarred?(0,D.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,D.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,n.jsx)(c.I,{tooltip:bn,icon:(0,n.jsx)(a.I,{name:ze.isStarred?"favorite":"star",size:"lg",type:ze.isStarred?"mono":"default"}),"data-testid":i.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{R.c.toolbarFavoritesClick(),Fe.onStarDashboard()}},"star-dashboard-button")}}),ze.publicDashboardEnabled&&Ae.push({group:"icon-actions",condition:tt&&!!ze.canStar&&Tt&&!at,render:()=>(0,n.jsx)(p.E,{color:"blue",text:"Public",className:De.publicBadge,"data-testid":i.Tp.pages.Dashboard.DashNav.publicDashboardTag},"public-dashboard-button-badge")});const $t=g.$.buildInfo.env==="development";Ae.push({group:"icon-actions",condition:$t&&tt&&Tt&&!at,render:()=>(0,n.jsx)(c.I,{tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{o.Ny.partial({scenes:!1})}},"view-in-old-dashboard-button")}),Ae.push({group:"icon-actions",condition:ze.isSnapshot&&!ze.dashboardNotFound&&!at,render:()=>(0,n.jsx)(Ue,{originalURL:Fe.getInitialSaveModel()?.snapshot?.originalUrl??""},"go-to-snapshot-origin")}),!Ie&&!at&&Ce(Ae,re.C.right,"icon-actions"),Ae.push({group:"add-panel",condition:jt,render:()=>(0,n.jsx)(u.m,{onVisibleChange:bn=>{he(bn),R.c.toolbarAddClick()},overlay:()=>(0,n.jsxs)(m.W,{children:[(0,n.jsx)(m.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,D.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const bn=Fe.onCreateNewPanel();R.c.toolbarAddButtonClicked({item:"add_visualization"}),Fe.setState({editPanel:(0,M.L)(bn,!0)})}},"add-visualization"),(0,n.jsx)(m.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,D.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{Fe.onShowAddLibraryPanelDrawer(),R.c.toolbarAddButtonClicked({item:"add_library_panel"})}},"add-panel-lib"),(0,n.jsx)(m.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,D.t)("dashboard.add-menu.row","Row"),onClick:()=>{Fe.onCreateNewRow(),R.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,n.jsx)(m.W.Item,{disabled:!pt,testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,D.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{Fe.pastePanel(),R.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,n.jsxs)(v.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":i.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,n.jsx)(D.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,n.jsx)(a.I,{name:Pe?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),Ae.push({group:"playlist-actions",condition:Ee&&Tt&&!at,render:()=>(0,n.jsx)(c.I,{"data-testid":i.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,D.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>C._o.prev()},"play-list-prev")}),Ae.push({group:"playlist-actions",condition:Ee&&Tt&&!at,render:()=>(0,n.jsx)(c.I,{onClick:()=>C._o.stop(),"data-testid":i.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,n.jsx)(D.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),Ae.push({group:"playlist-actions",condition:Ee&&Tt&&!at,render:()=>(0,n.jsx)(c.I,{"data-testid":i.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,D.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>C._o.next(),narrow:!0},"play-list-next")}),Ae.push({group:"back-button",condition:(ke||Ie)&&!Pt,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{o.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":i.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")}),Ae.push({group:"back-button",condition:!!pe,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{o.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":i.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")});const sn=tt&&!at&&!ze.isSnapshot&&!Ee;Ae.push({group:"main-buttons",condition:!g.$.featureToggles.newDashboardSharingComponent&&sn,render:()=>(0,n.jsx)(v.$n,{tooltip:(0,D.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:De.buttonWithExtraMargin,fill:"outline",onClick:()=>{R.c.toolbarShareClick(),Fe.showModal(new xe.Z({}))},"data-testid":i.Tp.components.NavToolbar.shareDashboard,children:"Share"},"share-dashboard-button")}),Ae.push({group:"main-buttons",condition:!at&&Fe.canEditDashboard()&&!ke&&!Ee&&fe,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{Fe.onEnterEditMode()},tooltip:"Enter edit mode",className:De.buttonWithExtraMargin,variant:g.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":i.Tp.components.NavToolbar.editDashboard.editButton,children:"Edit"},"edit")}),Ae.push({group:"main-buttons",condition:!at&&Fe.canEditDashboard()&&!ke&&!Ee&&!fe,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{Fe.onEnterEditMode(),Fe.setState({editable:!0,meta:{...ze,canEdit:!0}})},tooltip:"This dashboard was marked as read only",className:De.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":i.Tp.components.NavToolbar.editDashboard.editButton,children:"Make editable"},"edit")}),Ae.push({group:"new-share-dashboard-buttons",condition:g.$.featureToggles.newDashboardSharingComponent&&sn,render:()=>(0,n.jsx)(Q,{dashboard:Fe},"new-export-dashboard-button")}),Ae.push({group:"new-share-dashboard-buttons",condition:g.$.featureToggles.newDashboardSharingComponent&&sn,render:()=>(0,n.jsx)(de,{dashboard:Fe},"new-share-dashboard-button")}),Ae.push({group:"settings",condition:at&&Fe.canEditDashboard()&&Tt,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{Fe.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",variant:"secondary","data-testid":i.Tp.components.NavToolbar.editDashboard.settingsButton,children:"Settings"},"settings")}),Ae.push({group:"main-buttons",condition:at&&!ze.isNew&&Tt,render:()=>(0,n.jsx)(v.$n,{onClick:()=>Fe.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",fill:"text",variant:"primary","data-testid":i.Tp.components.NavToolbar.editDashboard.exitButton,children:"Exit edit"},"discard")}),Ae.push({group:"main-buttons",condition:Ie&&!Pt&&!pe&&!ke,render:()=>(0,n.jsx)(v.$n,{onClick:Se?.onDiscard,tooltip:Se?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!dt||!Dt,fill:"outline",variant:"destructive","data-testid":i.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:Se?.state.isNewPanel?"Discard panel":"Discard panel changes"},"discard")}),Ae.push({group:"main-buttons",condition:Ie&&Pt&&!pe&&!ke,render:()=>(0,n.jsx)(v.$n,{onClick:Se?.onDiscard,tooltip:"Discard library panel changes",size:"sm",fill:"outline",variant:"destructive","data-testid":i.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:"Discard library panel changes"},"discardLibraryPanel")}),Ae.push({group:"main-buttons",condition:Ie&&Pt&&!pe&&!ke,render:()=>(0,n.jsx)(v.$n,{onClick:Se?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",fill:"outline",variant:"secondary","data-testid":i.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:"Unlink library panel"},"unlinkLibraryPanel")}),Ae.push({group:"main-buttons",condition:Ie&&Pt&&!pe&&!ke,render:()=>(0,n.jsx)(v.$n,{onClick:Se?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",fill:"outline",variant:"primary","data-testid":i.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:"Save library panel"},"saveLibraryPanel")}),Ae.push({group:"main-buttons",condition:at&&!Pt&&(ze.canSave||be),render:()=>{if(ze.isNew)return(0,n.jsx)(v.$n,{onClick:()=>{Fe.openSaveDrawer({})},className:De.buttonWithExtraMargin,tooltip:"Save changes",size:"sm",variant:"primary","data-testid":i.Tp.components.NavToolbar.editDashboard.saveButton,children:"Save dashboard"},"save");if(be&&!ze.canSave&&!ze.canMakeEditable)return(0,n.jsx)(v.$n,{onClick:()=>{Fe.openSaveDrawer({saveAsCopy:!0})},className:De.buttonWithExtraMargin,tooltip:"Save as copy",size:"sm",variant:Dt?"primary":"secondary",children:"Save as copy"},"save");const bn=(0,n.jsxs)(m.W,{children:[(0,n.jsx)(m.W.Item,{label:"Save",icon:"save",onClick:()=>{Fe.openSaveDrawer({})}}),(0,n.jsx)(m.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{Fe.openSaveDrawer({saveAsCopy:!0})}})]});return(0,n.jsxs)(x.e,{className:De.buttonWithExtraMargin,children:[(0,n.jsx)(v.$n,{onClick:()=>{Fe.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":i.Tp.components.NavToolbar.editDashboard.saveButton,variant:Dt?"primary":"secondary",children:"Save dashboard"}),(0,n.jsx)(u.m,{overlay:bn,children:(0,n.jsx)(v.$n,{"aria-label":"More save options",icon:"angle-down",variant:Dt?"primary":"secondary",size:"sm"})})]},"save")}});const Yt=[];let qt="";for(const bn of Ae)bn.condition&&(qt&&qt!==bn.group&&qt&&Yt.push((0,n.jsx)(h.K,{},`${bn.group}-separator`)),Yt.push(bn.render()),qt=bn.group);return(0,n.jsx)(f.U,{alignment:"right",children:Yt})}function Ce(Fe,at,Ct){if(at.length>0)for(const Dt of at){const tt={dashboard:(0,P.UA)().getCurrent()};if(Dt.show(tt)){const ze=Dt.component;Fe.push({group:Ct,condition:!0,render:()=>(0,s.createElement)(ze,{...tt,key:Fe.length})})}}}function je(Fe){const[at,Ct]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(Fe){const Dt=Fe.state.vizManager.subscribeToState(tt=>Ct(tt.sourcePanel.resolve().parent instanceof we.F));return()=>{Dt.unsubscribe()}}Ct(!1)},[Fe]),at}function Ke(Fe){const[at,Ct]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(Fe){const Dt=Fe.state.vizManager.subscribeToState(tt=>Ct(tt.isDirty||!1));return()=>{Dt.unsubscribe()}}Ct(!1)},[Fe]),at}function _e(Fe){return{buttonWithExtraMargin:(0,l.css)({margin:Fe.spacing(0,.5)}),publicBadge:(0,l.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(k,A,e)=>{"use strict";e.d(A,{$:()=>c,m:()=>p});var n=e(74848),s=e(80943),l=e(91052),r=e(14578),i=e(83122),g=e(27746),o=e(38138),d=e(7196);class c extends s.Bs{static{this.Component=a}}function a({model:m}){const{menu:v,rawLinks:x}=m.useState();if(!(m.parent instanceof s.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!x||x.length===0)return null;if(x.length===1){const f=(0,d.eQ)(m.parent)[0];return(0,n.jsx)(l.NR.TitleItem,{href:f.href,onClick:f.onClick,target:f.target,title:f.title,children:(0,n.jsx)(r.I,{name:"external-link-alt",size:"md"})})}return(0,n.jsx)(i.m,{overlay:()=>(0,n.jsx)(v.Component,{model:v},v.state.key),children:(0,n.jsx)(g.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"})})}class p extends s.Bs{static{this.Component=u}}function u({model:m}){const{links:v}=m.useState();return v?(0,n.jsx)(o.W,{children:v?.map((x,f)=>(0,n.jsx)(o.W.Item,{label:x.title,url:x.href,target:x.target,onClick:x.onClick},f))}):null}},7196:(k,A,e)=>{"use strict";e.d(A,{eQ:()=>ge,MI:()=>Ue,oV:()=>Te,_i:()=>de,t0:()=>xe,vR:()=>we});var n=e(74135),s=e(1933),l=e(76885),r=e(32264),i=e(4402),g=e(39601),o=e(80943),d=e(28138),c=e(8484),a=e(63066),p=e(22699),u=e(16560),m=e(32349),v=e(75462),x=e(19347),f=e(74730),E=e(94383),h=e(40588),y=e(74848),b=e(56833);class D extends o.Bs{static{this.Component=P}constructor(je){super(je),this.trail=C(je)}}function P({model:Ce}){return(0,y.jsx)(Ce.trail.Component,{model:Ce.trail})}function C({metric:Ce,filters:je,dataSourceUid:Ke,timeRange:_e}){return new b.b({$timeRange:_e,metric:Ce,initialDS:Ke,initialFilters:je,embedded:!0})}var M=e(32196),I=e(40845),R=e(87978),T=e(28444);function S(Ce){const{scene:je,title:Ke,onDismiss:_e}=Ce,Fe=(0,I.of)(j);return(0,y.jsx)(R._,{title:Ke,onClose:_e,size:"lg",children:(0,y.jsx)("div",{className:Fe.drawerInnerWrapper,children:(0,y.jsx)(je.Component,{model:je})})})}class L extends o.Bs{constructor(je){super(je)}static Component({model:je}){const Ke=je.useState();return(0,y.jsx)(S,{...Ke})}}function O(Ce){const je={component:S,props:Ce};appEvents.publish(new ShowModalReactEvent(je))}function j(Ce){return{drawerInnerWrapper:(0,M.css)({display:"flex",padding:Ce.spacing(2),background:Ce.isDark?Ce.colors.background.canvas:Ce.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var N=e(76040);function F(Ce){return Ce.op==="="}function U(Ce){return Ce.state.$timeRange.clone()}function w({metric:Ce,labelFilters:je}){if(je.length===0)return Ce;const Ke=`{${je.map(({label:_e,op:Fe,value:at})=>`${_e}${Fe}"${at}"`)}}`;return`${Ce}${Ke}`}function B(Ce){return Ce?.map(je=>({key:je.label,value:je.value,operator:je.op}))}function K(Ce){const je=[];return Ce.forEach(Ke=>{const _e=(0,N.u)(Ke);if(_e.errors.length>0)return;const{metric:Fe,labels:at}=_e.query;je.push({metric:Fe,labelFilters:at.filter(F),query:Ke}),_e.query.binaryQueries?.forEach(({query:{metric:Ct,labels:Dt}})=>{je.push({metric:Ct,labelFilters:Dt.filter(F),query:Ke})})}),je}async function W(Ce,je,Ke){if(je.state.pluginId!=="timeseries")return;const _e=(0,f.un)(je);if(_e==null)return;const{queries:Fe,datasource:at,data:Ct}=_e.state;if(at==null||at.type!=="prometheus")return;const Dt=await(0,x.l)().get(at);if(Dt.interpolateVariablesInQueries==null)return;const tt=Dt.interpolateVariablesInQueries(Fe,{__sceneObject:{value:je}},Ct?.request?.filters).filter(G),pe=K(tt.map(Se=>Se.expr)).map(Se=>({text:w(Se),onClick:q(Se,Ce,Dt)}));pe.length>0&&Ke.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:z(pe)})}function z(Ce){const je=new Set;function Ke({text:_e}){const Fe=je.size;return je.add(_e),je.size>Fe}return Ce.filter(Ke)}function Y({metric:Ce,labelFilters:je,query:Ke},_e,Fe){return{metric:Ce,filters:B(je),dataSourceUid:Fe,timeRange:_e}}function X(Ce,je,Ke){const _e=U(je),Fe=Y(Ce,_e,Ke.uid),at=new D(Fe);return at.trail.addActivationHandler(()=>{at.trail.state.topScene instanceof E.R&&at.trail.state.topScene.setActionView("breakdown")}),{scene:at,title:"Explore metrics"}}function q(Ce,je,Ke){return()=>{const _e=X(Ce,je,Ke),Fe=new L({..._e,onDismiss:()=>je.closeModal()});(0,h.z)("exploration_started",{cause:"dashboard_panel"}),je.showModal(Fe)}}function G(Ce){return"expr"in Ce}var te=e(91119),H=e(85174),se=e(30160),ne=e(7758),le=e(11982),_=e(34842),Q=e(60656),ae=e(42397),oe=e(54174);class J extends o.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,f.YQ)(this).closeModal()},this.onConfirm=()=>{const je=(0,f.YQ)(this);je.unlinkLibraryPanel(this.state.panelRef.resolve()),je.closeModal()}}static{this.Component=ee}}function ee({model:Ce}){return(0,y.jsx)(oe.l,{isOpen:!0,onConfirm:()=>{Ce.onConfirm(),Ce.onDismiss()},onDismiss:Ce.onDismiss})}function de(Ce,je=!1){(async()=>{const _e=Ce.parent,Fe=_e.parent,at=_e.getPlugin(),Ct=[],Dt=[],tt=(0,f.YQ)(_e),{isEmbedded:ze}=tt.state.meta,pe=await re(_e);if(ze){pe&&Ce.setState({items:[pe]});return}const Se=!!tt.state.editPanel;if(Se||Ct.push({text:(0,c.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,le.r7)(_e)}),tt.canEditDashboard()&&tt.state.editable&&!je&&!Se&&Ct.push({text:(0,c.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,le.e0)((0,f.Cs)(_e))}),r.$.featureToggles.newDashboardSharingComponent){const Ee=[];Ee.push({text:(0,c.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{const Pe=new te.j({title:(0,c.t)("share-panel.drawer.share-link-title","Link settings"),body:new se.S({panelRef:_e.getRef()})});tt.showModal(Pe)}}),Ct.push({type:"submenu",text:(0,c.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:Ee,onClick:Pe=>{Pe.preventDefault()}})}else Ct.push({text:(0,c.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{tt.showModal(new H.Z({panelRef:_e.getRef()}))},shortcut:"p s"});tt.state.isEditing&&!je&&!Se&&Dt.push({text:(0,c.t)("panel.header-menu.duplicate","Duplicate"),onClick:()=>{tt.duplicatePanel(_e)},shortcut:"p d"}),Se||Dt.push({text:(0,c.t)("panel.header-menu.copy","Copy"),onClick:()=>{tt.copyPanel(_e)}}),tt.state.isEditing&&!je&&!Se&&(Fe instanceof Q.F?(Dt.push({text:(0,c.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:()=>{tt.showModal(new J({panelRef:Fe.getRef()}))}}),Dt.push({text:(0,c.t)("panel.header-menu.replace-library-panel","Replace library panel"),onClick:()=>{tt.onShowAddLibraryPanelDrawer(Fe.getRef())}})):Dt.push({text:(0,c.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{tt.showModal(new H.Z({panelRef:_e.getRef(),activeTab:p.wr.libraryPanel}))}})),Dt.push({text:(0,c.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:Ee=>Xe(_e)}),qe(_e.state.options)&&!Se&&Dt.push({text:_e.state.options.legend.showLegend?(0,c.t)("panel.header-menu.hide-legend","Hide legend"):(0,c.t)("panel.header-menu.show-legend","Show legend"),onClick:Ee=>{Ee.preventDefault(),we(_e)},shortcut:"p l"}),tt.canEditDashboard()&&at&&!at.meta.skipDataQuery&&!je&&Dt.push({text:(0,c.t)("panel.header-menu.get-help","Get help"),onClick:Ee=>{Ee.preventDefault(),We(_e,u.q.Help)}}),r.$.featureToggles.exploreMetrics&&await W(tt,_e,Ct),pe&&Ct.push(pe),Ct.push(ue(at,_e,tt));const{extensions:fe}=(0,i.Kf)({extensionPointId:n.S.DashboardPanelMenu,context:Oe(_e,tt),limitPerPlugin:3});fe.length>0&&!tt.state.isEditing&&Ct.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,v.N9)(fe)}),Dt.length&&Ct.push({type:"submenu",text:(0,c.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:Dt,onClick:Ee=>{Ee.preventDefault()}}),tt.state.isEditing&&!je&&!Se&&(Ct.push({text:"",type:"divider"}),Ct.push({text:(0,c.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{Ue(tt,_e)},shortcut:"p r"})),Ce.setState({items:Ct})})()}const xe=Ce=>de(Ce,!0);async function re(Ce){const je=await(0,le.Lp)(Ce);if(je)return{text:(0,c.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:je}}function ue(Ce,je,Ke){const _e=[];return Ce&&!Ce.meta.skipDataQuery&&(_e.push({text:(0,c.t)("panel.header-menu.inspect-data","Data"),href:(0,le.Uu)(je,u.q.Data),onClick:Fe=>{Fe.preventDefault(),g.Ny.partial({inspect:je.state.key,inspectTab:u.q.Data})}}),Ke instanceof _.H$&&Ke.state.meta.canEdit&&_e.push({text:(0,c.t)("panel.header-menu.query","Query"),href:(0,le.Uu)(je,u.q.Query),onClick:Fe=>{Fe.preventDefault(),g.Ny.partial({inspect:je.state.key,inspectTab:u.q.Query})}})),_e.push({text:(0,c.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,le.Uu)(je,u.q.JSON),onClick:Fe=>{Fe.preventDefault(),g.Ny.partial({inspect:je.state.key,inspectTab:u.q.JSON})}}),{text:(0,c.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,le.Uu)(je),onClick:Fe=>{Fe.isDefaultPrevented()||g.Ny.partial({inspect:je.state.key,inspectTab:u.q.Data})},subMenu:_e.length>0?_e:void 0}}function Te(Ce){if(!(Ce.parent instanceof ae.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const je=Ce.parent.parent;if(!(je instanceof o.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");Ce.setState({links:ge(je)})}function ge(Ce){const je=(Fe,at)=>o.jh.interpolate(Ce,Fe,at),Ke=(0,m.CH)(Ce,je);if(!Ke)return[];const _e=Ke.getLinks(je);return _e.map(Fe=>({...Fe,onClick:(Ct,Dt)=>{ne.c.panelLinkClicked({has_multiple_links:_e.length>1}),Fe.onClick?.(Ct,Dt)}}))}function Oe(Ce,je){const Ke=o.jh.getTimeRange(Ce);let _e=(0,f.un)(Ce);const Fe=_e?.state.queries,at=(0,f.Cs)(Ce);let Ct={};if(Ce.state.$variables&&Ce.state.$variables.state.variables.forEach(Dt=>{Dt instanceof o.xc&&(Ct={...Ct,[Dt.state.name]:{value:Dt.getValue(),text:Dt.getValueText()}})}),Ce.parent?.parent instanceof o.tI){const Dt=Ce.parent.parent;Dt.state.$variables&&Dt.state.$variables.state.variables.forEach(tt=>{tt instanceof o.xc&&(Ct={...Ct,[tt.state.name]:{value:tt.getValue(),text:tt.getValueText()}})})}return{id:at,pluginId:Ce.state.pluginId,title:Ce.state.title,timeRange:Ke.state.value.raw,timeZone:(0,s.O)({timeZone:Ke.getTimeZone()}),dashboard:{uid:je.state.uid,title:je.state.title,tags:je.state.tags||[]},targets:Fe,scopedVars:Ct,data:_e?.state.data}}function Ue(Ce,je){d.A.publish(new T.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>Ce.removePanel(je)}))}const Xe=async Ce=>{const je=await(0,a.J6)(Ce),Ke=l.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(je),returnTo:location.pathname+location.search});g.Ny.push(Ke)};function we(Ce){const je=Ce.state.options;qe(je)&&typeof je.legend.showLegend=="boolean"&&Ce.onOptionsChange({legend:{showLegend:!je.legend.showLegend}})}function qe(Ce){return Ce!=null&&typeof Ce=="object"&&"legend"in Ce}const We=(Ce,je)=>{g.Ny.partial({inspect:Ce.state.key,inspectTab:je})}},99589:(k,A,e)=>{"use strict";e.d(A,{W:()=>i});var n=e(74848),s=e(80943),l=e(2038),r=e(74730);class i extends s.Bs{constructor(){super({}),this.onActivate=()=>{const d=this.parent;if(!d||!(d instanceof s.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=g}getPanel(){const d=this.parent;return d&&d instanceof s.Eb?d:null}}function g({model:o}){const d=o.getPanel(),a=s.jh.getData(o).useState();if(!d)return null;const p=(0,r.Cs)(d);return a.data?.series?(0,n.jsx)(l.Z,{frames:a.data?.series,panelId:p}):null}},7928:(k,A,e)=>{"use strict";e.d(A,{v:()=>u});var n=e(74848),s=e(32196),l=e(43127),r=e(65879),i=e(85858),g=e(80943),o=e(40845),d=e(56034),c=e(15666),a=e(91052),p=e(14578);class u extends g.XQ{static{this.Component=m}constructor(f={}){super({...f,from:"now-6h",to:"now",value:(0,l.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((f,E)=>{if(f.timeFrom!==E.timeFrom||f.timeShift!==E.timeShift){const{timeInfo:h,timeRange:y}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:h,value:y})}}))}ancestorTimeRangeChanged(f){const E=this.getTimeOverride(f.value);this.setState({value:E.timeRange,timeInfo:E.timeInfo})}getTimeOverride(f){const{timeFrom:E,timeShift:h}=this.state,y={timeInfo:"",timeRange:f};if(E){const b=g.jh.interpolate(this,this.state.timeFrom),D=r.describeTextRange(b);if(D.invalid)return y.timeInfo="invalid time override",y;r.isRelativeTimeRange(f.raw)&&(y.timeInfo=D.display,y.timeRange={from:i.parse(D.from),to:i.parse(D.to),raw:{from:D.from,to:D.to}})}if(h){const b=g.jh.interpolate(this,this.state.timeShift);if(r.describeTextRange(b).invalid)return y.timeInfo="invalid timeshift",y;const P="-"+b;y.timeInfo+=" timeshift "+P;const C=i.parseDateMath(P,y.timeRange.from,!1),M=i.parseDateMath(P,y.timeRange.to,!0);y.timeRange={from:C,to:M,raw:{from:C,to:M}}}return y}}function m({model:x}){const{timeInfo:f,hideTimeOverride:E}=x.useState(),h=(0,o.of)(v);return!f||E?null:(0,n.jsx)(d.m,{content:(0,n.jsx)(c.xS,{timeRange:x.state.value,timeZone:x.getTimeZone()}),children:(0,n.jsxs)(a.NR.TitleItem,{className:h.timeshift,children:[(0,n.jsx)(p.I,{name:"clock-nine",size:"sm"})," ",f]})})}const v=x=>({timeshift:(0,s.css)({color:x.colors.text.link,gap:x.spacing(.5),whiteSpace:"nowrap"})})},79284:(k,A,e)=>{"use strict";e.d(A,{L:()=>d});var n=e(2543),s=e.n(n),l=e(80943),r=e(74730),i=e(41507),g=e(7196),o=e(30195);class d extends l.Bs{constructor(v){super(v),this._variableDependency=new l.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getRow(){if(!(this.parent instanceof l.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const v=l.jh.getLayout(this);if(!(v instanceof l.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return v}performRepeat(){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const v=l.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!v){console.error("RepeatedRowBehavior: Variable not found");return}if(v instanceof l.n8){if(!v.state.isMulti)return}else{console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const x=this._getRow(),f=this._getLayout(),{values:E,texts:h}=(0,r.a7)(v);if((0,n.isEqual)(this._prevRepeatValues,E))return;this._prevRepeatValues=E;const y=[],b=x.state.children,D=c(b);let P=0;const C={values:[""],texts:v.hasAllValue()?["All"]:["None"]},M=E.length?E:C.values,I=h.length?h:C.texts;for(let R=0;R<M.length;R++){const T=[],S=M[R];for(const O of b){const N=(O.state.y??0)+(D+1)*R,F=R>0?`${O.state.key}-clone-${S}`:O.state.key,U=O.clone({key:F,y:N});R>0&&(u(U,S),U instanceof i.U&&U.state.body.setState({menu:new l.Lw({$behaviors:[g.t0]})})),T.push(U),P<N+U.state.height&&(P=N+U.state.height)}const L=this.getRowClone(x,R,S,I[R],D,T);y.push(L)}a(f,y,P,x),this.publishEvent(new o.d({source:this}),!0)}getRowClone(v,x,f,E,h,y){if(x===0)return v.setState({$variables:new l.Pj({variables:[new l.xc({name:this.state.variableName,value:f,text:String(E)})]}),children:y}),v;const b=v.state.y??0;return v.clone({key:`${v.state.key}-clone-${f}`,$variables:new l.Pj({variables:[new l.xc({name:this.state.variableName,value:f,text:String(E)})]}),$behaviors:[],children:y,y:b+h*x+x,actions:void 0})}removeBehavior(){const v=this._getRow(),x=this._getLayout(),f=p(this._getLayout(),this._getRow());x.setState({children:f}),v.setState({$behaviors:v.state.$behaviors.filter(E=>E!==this),$variables:void 0})}}function c(m){let v=0,x=Number.MAX_VALUE;if(m.length===0)return 0;for(const f of m)f.state.y+f.state.height>v&&(v=f.state.y+f.state.height),f.state.y<x&&(x=f.state.y);return v-x}function a(m,v,x,f){const E=p(m,f),h=E.indexOf(f);if(h===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const y=[...E.slice(0,h),...v,...E.slice(h+1)];if(E.length>h+1){const b=E.slice(h+1),D=b[0].state.y,P=x-D;for(const C of b)if(C.setState({y:C.state.y+P}),C instanceof l.tI)for(const M of C.state.children)M.setState({y:M.state.y+P})}m.setState({children:y})}function p(m,v){return m.state.children.filter(x=>!x.state.key?.startsWith(`${v.state.key}-clone-`))}function u(m,v){m.forEachChild(x=>{x.setState({key:`${x.state.key}-clone-${v}`}),u(x,v)})}},54174:(k,A,e)=>{"use strict";e.d(A,{l:()=>l});var n=e(74848),s=e(96374);const l=({isOpen:r,onConfirm:i,onDismiss:g})=>(0,n.jsx)(s.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{i(),g()},onDismiss:g,isOpen:r})},58029:(k,A,e)=>{"use strict";e.d(A,{u:()=>T});var n=e(74848),s=e(32196),l=e(80943),r=e(72109),i=e(40845),g=e(14578),o=e(28138),d=e(14348),c=e(28444),a=e(74730),p=e(41507),u=e(79284),m=e(71678),v=e(37390),x=e(96540),f=e(49785),E=e(13544),h=e(88575),y=e(10354),b=e(42418),D=e(55852),P=e(92378);const C=({repeat:L,title:O,parent:j,warning:N,onUpdate:F,onCancel:U})=>{const[w,B]=(0,x.useState)(L),K=(0,x.useCallback)(X=>B(X),[B]),{handleSubmit:W,register:z}=(0,f.mN)({defaultValues:{title:O}}),Y=X=>{F(X.title,w)};return(0,n.jsxs)("form",{onSubmit:W(Y),children:[(0,n.jsx)(h.D,{label:"Title",children:(0,n.jsx)(y.p,{...z("title"),type:"text"})}),(0,n.jsx)(h.D,{label:"Repeat for",children:(0,n.jsx)(P.U,{parent:j,repeat:w,onChange:K})}),N&&(0,n.jsx)(b.F,{"data-testid":E.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:N}),(0,n.jsxs)(v.a.ButtonRow,{children:[(0,n.jsx)(D.$n,{type:"button",variant:"secondary",onClick:U,fill:"outline",children:"Cancel"}),(0,n.jsx)(D.$n,{type:"submit",children:"Update"})]})]})},M=({repeat:L,title:O,parent:j,onDismiss:N,onUpdate:F,warning:U})=>{const w=(0,i.of)(I);return(0,n.jsx)(v.a,{isOpen:!0,title:"Row options",onDismiss:N,className:w.modal,children:(0,n.jsx)(C,{parent:j,repeat:L,title:O,onCancel:N,onUpdate:F,warning:U})})},I=()=>({modal:(0,s.css)({label:"RowOptionsModal",width:"500px"})}),R=({repeat:L,title:O,parent:j,onUpdate:N,warning:F})=>{const U=w=>(B,K)=>{N(B,K),w()};return(0,n.jsx)(m.$s,{children:({showModal:w,hideModal:B})=>(0,n.jsx)("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{w(M,{title:O,repeat:L,parent:j,onDismiss:B,onUpdate:U(B),warning:F})},children:(0,n.jsx)(g.I,{name:"cog"})})})};R.displayName="RowOptionsButton";class T extends l.Bs{constructor(){super(...arguments),this.onUpdate=(O,j)=>{const N=this.getParent();let F;if(N.state.$behaviors)for(let U of N.state.$behaviors)U instanceof u.L&&(F=U);if(j&&!F){const U=new u.L({variableName:j});N.setState({$behaviors:[...N.state.$behaviors??[],U]})}else F&&F.removeBehavior();O!==N.state.title&&N.setState({title:O})},this.onDelete=()=>{o.A.publish(new c.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>{this.getDashboard().removeRow(this.getParent(),!0)},onAltAction:()=>{this.getDashboard().removeRow(this.getParent())}}))},this.getWarning=()=>{if(this.getParent().state.children.some(F=>{if(!(F instanceof p.U))return!1;const U=F.state.body;return U instanceof l.Eb?(0,a.un)(U)?.state.datasource?.uid===d.K:!1}))return(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["Panels in this row use the ",d.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]}),(0,n.jsx)(r.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:"Learn more"})]})}}getParent(){if(!(this.parent instanceof l.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,a.YQ)(this)}static{this.Component=({model:O})=>{const j=O.getDashboard(),N=O.getParent(),{title:F}=N.useState(),{meta:U,isEditing:w}=j.useState(),B=(0,i.of)(S),K=N.state.$behaviors?.find(W=>W instanceof u.L);return(0,n.jsx)(n.Fragment,{children:U.canEdit&&w&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:B.rowActions,children:[(0,n.jsx)(R,{title:F,repeat:K instanceof u.L?K.state.variableName:void 0,parent:j,onUpdate:O.onUpdate,warning:O.getWarning()}),(0,n.jsx)("button",{type:"button",onClick:O.onDelete,"aria-label":"Delete row",children:(0,n.jsx)(g.I,{name:"trash-alt"})})]})})})}}}const S=L=>({rowActions:(0,s.css)({color:L.colors.text.secondary,lineHeight:"27px",button:{color:L.colors.text.secondary,paddingLeft:L.spacing(2),background:"transparent",border:"none","&:hover":{color:L.colors.text.maxContrast}}})})},30195:(k,A,e)=>{"use strict";e.d(A,{d:()=>s});var n=e(65463);class s extends n.x{static{this.type="dashboard-repeats-processed"}}},71176:(k,A,e)=>{"use strict";e.d(A,{X:()=>r});var n=e(32264),s=e(79422),l=e(31193);async function r(i){let g=s.Ye.templating?.list;if(n.$.featureToggles.newDashboardWithFiltersAndGroupBy){const d=await(0,l.tR)().get();if(d.getTagKeys){const c={type:d.meta.id,uid:d.uid},a={datasource:c,filters:[],name:"Filter",type:"adhoc"},p={datasource:c,name:"Group by",type:"groupby"};g=(g||[]).concat([a,p])}}const o={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...s.Ye,uid:"",title:"New dashboard",panels:[],timezone:n.$.bootData.user?.timezone||s.Ye.timezone}};return g&&(o.dashboard.templating={list:g}),i&&(o.meta.folderUid=i),o}},70665:(k,A,e)=>{"use strict";e.d(A,{x:()=>n});const n={name:"grafana",uid:"grafana"}},13989:(k,A,e)=>{"use strict";e.d(A,{O:()=>s});var n=e(80943);function s(l){const r=[];for(const i of l){if(!(i instanceof n.tV.g))continue;const g={...i.state.query,enable:!!i.state.isEnabled,hide:!!i.state.isHidden};r.push(g)}return r}},53287:(k,A,e)=>{"use strict";e.d(A,{C:()=>g});var n=e(32264),s=e(80943),l=e(79422),r=e(73134),i=e(74730);function g(d){const c=[];for(const a of d.state.variables){const p={name:a.state.name,label:a.state.label,description:a.state.description??void 0,skipUrlSync:!!a.state.skipUrlSync,hide:a.state.hide||l.zL.dontHide,type:a.state.type};if(s.Go.isQueryVariable(a)){let u=[];a.state.refresh===r.CO.never&&(u=o(a.state)),c.push({...p,current:{value:a.state.value,text:a.state.text},options:u,query:a.state.query,definition:a.state.definition,datasource:a.state.datasource,sort:a.state.sort,refresh:a.state.refresh,regex:a.state.regex,allValue:a.state.allValue,includeAll:a.state.includeAll,multi:a.state.isMulti,skipUrlSync:a.state.skipUrlSync})}else if(s.Go.isCustomVariable(a))c.push({...p,current:{text:a.state.value,value:a.state.value},options:o(a.state),query:a.state.query,multi:a.state.isMulti,allValue:a.state.allValue,includeAll:a.state.includeAll});else if(s.Go.isDataSourceVariable(a))c.push({...p,current:{value:a.state.value,text:a.state.text},options:[],regex:a.state.regex,refresh:r.CO.onDashboardLoad,query:a.state.pluginId,multi:a.state.isMulti,allValue:a.state.allValue,includeAll:a.state.includeAll});else if(s.Go.isConstantVariable(a))c.push({...p,current:{value:a.state.value,text:a.state.value},query:a.state.value,hide:l.zL.hideVariable});else if(s.Go.isIntervalVariable(a)){const u=(0,i.bx)(a.state.intervals);c.push({...p,current:{text:a.state.value,value:a.state.value},query:u,refresh:a.state.refresh,options:a.state.intervals.map(m=>({value:m,text:m,selected:m===a.state.value})),auto:a.state.autoEnabled,auto_min:a.state.autoMinInterval,auto_count:a.state.autoStepCount})}else if(s.Go.isTextBoxVariable(a)){const u={text:a.state.value,value:a.state.value};c.push({...p,current:u,options:[{...u,selected:!0}],query:a.state.value})}else if(s.Go.isGroupByVariable(a)&&n.$.featureToggles.groupByVariable)c.push({...p,datasource:a.state.datasource,options:a.state.defaultOptions?.map(u=>({text:u.text,value:String(u.value)})),current:{text:a.state.text,value:a.state.value}});else if(s.Go.isAdHocVariable(a))c.push({...p,name:a.state.name,type:"adhoc",datasource:a.state.datasource,baseFilters:a.state.baseFilters,filters:a.state.filters,defaultKeys:a.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const a of c)a.hide===l.zL.dontHide&&delete a.hide,a.skipUrlSync||delete a.skipUrlSync,a.label===""&&delete a.label,a.multi||delete a.multi,a.sort===r.ZG.disabled&&delete a.sort;return c}function o(d){return d.options.map(c=>({value:String(c.value),text:c.label,selected:Array.isArray(d.value)?d.value.includes(c.value):d.value===c.value}))}},85445:(k,A,e)=>{"use strict";e.d(A,{Al:()=>X,tt:()=>q,EH:()=>z,wM:()=>B});var n=e(2543),s=e(32264),l=e(80943),r=e(34214),i=e(91309),g=e(38477),o=e(33278),d=e(16279),c=e(41507),a=e(74730);class p{constructor(le,_){this._sceneObject=_,this.state={name:le,type:"dashboard_macro"}}getValue(le){const _=(0,a.YQ)(this._sceneObject);switch(le){case"uid":return _.state.uid||"";case"title":case"name":case"id":default:return _.state.title}}getValueText(){return""}}function u(){const ne=l.Go.registerVariableMacro("__dashboard",p);return()=>ne()}var m=e(34842),v=e(60656),x=e(42397),f=e(7196),E=e(99589),h=e(7928),y=e(79284),b=e(58029),D=e(41987),P=e(69129),C=e(10154),M=e(32023);function I(ne,le){le.app=D.Jk.Dashboard,le.canAddAnnotations=()=>{const _=(0,a.YQ)(ne);return!R(_)||!_.canEditDashboard()?!1:!!_.state.meta.annotationsPermissions?.dashboard.canAdd},le.canEditAnnotations=_=>{const Q=(0,a.YQ)(ne);return Q.canEditDashboard()?_?!!Q.state.meta.annotationsPermissions?.dashboard.canEdit:!!Q.state.meta.annotationsPermissions?.organization.canEdit:!1},le.canDeleteAnnotations=_=>{const Q=(0,a.YQ)(ne);return Q.canEditDashboard()?_?!!Q.state.meta.annotationsPermissions?.dashboard.canDelete:!!Q.state.meta.annotationsPermissions?.organization.canDelete:!1},le.onAnnotationCreate=async _=>{const Q=(0,a.YQ)(ne),ae=_.from!==_.to,oe={dashboardUID:Q.state.uid,panelId:(0,a.Cs)(ne),isRegion:ae,time:_.from,timeEnd:ae?_.to:0,tags:_.tags,text:_.description};await(0,C.vJ)(oe),T(Q),le.eventBus.publish(new P.We(oe))},le.onAnnotationUpdate=async _=>{const Q=(0,a.YQ)(ne),ae=_.from!==_.to,oe={id:_.id,dashboardUID:Q.state.uid,panelId:(0,a.Cs)(ne),isRegion:ae,time:_.from,timeEnd:ae?_.to:0,tags:_.tags,text:_.description};await(0,C.rJ)(oe),T(Q),le.eventBus.publish(new P.We(oe))},le.onAnnotationDelete=async _=>{await(0,C.Xm)({id:_}),T((0,a.YQ)(ne)),le.eventBus.publish(new P.We({id:_}))},le.onAddAdHocFilter=_=>{const Q=(0,a.YQ)(ne),ae=(0,a.un)(ne);if(!ae)return;const oe=S(Q,ae.state.datasource);L(oe,_)},le.onUpdateData=_=>Promise.resolve(!0)}function R(ne){const le=M.b4.getDataLayers(ne);for(const _ of le.state.annotationLayers)if(_ instanceof l.tV.g&&_.state.isEnabled&&_.state.query.builtIn)return _}function T(ne){const le=R(ne);le&&le.runLayer()}function S(ne,le){const _=l.jh.getVariables(ne);for(const ae of _.state.variables)if(l.Go.isAdHocVariable(ae)){const oe=ae.state.datasource;if(oe===le||oe?.uid===le?.uid)return ae}const Q=new l.H9({name:"Filters",datasource:le,useQueriesAsFilterForOptions:!0});return _.setState({variables:[..._.state.variables,Q]}),Q}function L(ne,le){for(const _ of ne.state.filters)if(_.key===le.key){ne.setState({filters:ne.state.filters.map(Q=>Q.key===le.key?le:Q)});return}ne.setState({filters:[...ne.state.filters,le]})}var O=e(96556),j=e(27734),N=e(7758),F=e(84423);function U(ne){return function(_,Q){if(Q.angularPanelCtrl){_.options={angularOptions:ne.getOptionsToRemember()};return}if((!ne.options||Object.keys(ne.options).length===0)&&(0,n.defaults)(_,ne.getOptionsToRemember()),ne.autoMigrateFrom){const ae=F.NB[ne.autoMigrateFrom]!=null,oe=ne.getOptionsToRemember(),J=ne.autoMigrateFrom;if(Q.onPanelTypeChanged){const ee=ae?{angular:oe}:oe.options;Object.assign(_.options,Q.onPanelTypeChanged(_,J,ee,_.fieldConfig))}}}}var w=e(70665);function B(ne){const le=new r.G(ne.dashboard,ne.meta),_=z(le,ne.dashboard);return _.setInitialSaveModel(ne.dashboard),_}function K(ne){const le=[];let _=null,Q=[];for(const ae of ne)if(ae.type==="row")_?_.id!==ae.id&&(le.push(W(_,Q)),_=ae,Q=[]):ae.collapsed?le.push(W(ae,[])):_=ae;else if(ae.libraryPanel?.uid&&!("model"in ae.libraryPanel)){const oe=X(ae);if(!oe)continue;_?Q.push(oe):le.push(oe)}else{ae.snapshotData&&H(ae);const oe=q(ae);_?Q.push(oe):le.push(oe)}return _&&le.push(W(_,Q)),le}function W(ne,le){ne.collapsed&&ne.panels&&(le=ne.panels.map(ae=>{if(ae instanceof r.a||(ae=new r.a(ae)),ae.libraryPanel?.uid&&!("model"in ae.libraryPanel)){const oe=X(ae);if(!oe)throw new Error("Failed to build grid item for library panel");return oe}return q(ae)}));let _,Q=le;return ne.repeat&&(_=[new y.L({variableName:ne.repeat})]),new l.tI({key:(0,a.XA)(ne.id),title:ne.title,y:ne.gridPos.y,isCollapsed:ne.collapsed,children:Q,$behaviors:_,actions:new b.u({})})}function z(ne,le){let _,Q=[],ae;if(ne.templating?.list?.length){const ee=ne.templating.list.map(de=>{try{return Y(de)}catch(xe){return console.error(xe),null}}).filter(de=>!!de);_=new l.Pj({variables:ee})}else _=new l.Pj({variables:[]});ne.annotations?.list?.length&&!ne.isSnapshot()&&(Q=ne.annotations?.list.map(ee=>new g.g({key:(0,n.uniqueId)("annotations-"),query:ee,name:ee.name,isEnabled:!!ee.enable,isHidden:!!ee.hide})));let oe=s.$.unifiedAlertingEnabled;return oe||ne.panels.find(ee=>!!ee.alert)&&(oe=!0),oe&&(ae=new i.C({key:"alert-states",name:"Alert States"})),new m.H$({description:ne.description,editable:ne.editable,preload:le.preload??!1,id:ne.id,isDirty:!1,links:ne.links||[],meta:ne.meta,tags:ne.tags||[],title:ne.title,uid:ne.uid,version:ne.version,body:new l.hy({isLazy:!le.preload,children:K(ne.panels),$behaviors:[se]}),$timeRange:new l.JZ({from:ne.time.from,to:ne.time.to,fiscalYearStartMonth:ne.fiscalYearStartMonth,timeZone:ne.timezone,weekStart:ne.weekStart,UNSAFE_nowDelay:ne.timepicker?.nowDelay}),$variables:_,$behaviors:[new l.Gg.K2({sync:ne.graphTooltip}),new l.Gg.Hf,u,G,new l.Gg.en({enabled:ne.liveNow}),j.zf],$data:new d.s({annotationLayers:Q,alertStatesLayer:ae}),controls:new o.x({variableControls:[new l.K8({}),new l.i7],timePicker:new l.KE({}),refreshPicker:new l.WM({refresh:ne.refresh,intervals:ne.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ne.timepicker.hidden})})}function Y(ne){const le={name:ne.name,label:ne.label,description:ne.description};if(ne.type==="adhoc")return new l.H9({...le,description:ne.description,skipUrlSync:ne.skipUrlSync,hide:ne.hide,datasource:ne.datasource,applyMode:"auto",filters:ne.filters??[],baseFilters:ne.baseFilters??[],defaultKeys:ne.defaultKeys,useQueriesAsFilterForOptions:!0});if(ne.type==="custom")return new l.yP({...le,value:ne.current?.value??"",text:ne.current?.text??"",query:ne.query,isMulti:ne.multi,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,skipUrlSync:ne.skipUrlSync,hide:ne.hide});if(ne.type==="query")return new l.fS({...le,value:ne.current?.value??"",text:ne.current?.text??"",query:ne.query,datasource:ne.datasource,sort:ne.sort,refresh:ne.refresh,regex:ne.regex,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,isMulti:ne.multi,skipUrlSync:ne.skipUrlSync,hide:ne.hide,definition:ne.definition});if(ne.type==="datasource")return new l.mI({...le,value:ne.current?.value??"",text:ne.current?.text??"",regex:ne.regex,pluginId:ne.query,allValue:ne.allValue||void 0,includeAll:ne.includeAll,defaultToAll:!!ne.includeAll,skipUrlSync:ne.skipUrlSync,isMulti:ne.multi,hide:ne.hide});if(ne.type==="interval"){const _=(0,a.Sm)(ne.query),Q=(0,a.pk)(ne,_);return new l.Yj({...le,value:Q,intervals:_,autoEnabled:ne.auto,autoStepCount:ne.auto_count,autoMinInterval:ne.auto_min,refresh:ne.refresh,skipUrlSync:ne.skipUrlSync,hide:ne.hide})}else{if(ne.type==="constant")return new l.x0({...le,value:ne.query,skipUrlSync:ne.skipUrlSync,hide:ne.hide});if(ne.type==="textbox"){let _;return ne?.current?.value?typeof ne.current.value=="string"?_=ne.current.value:_=ne.current.value[0]:_=ne.query,new l.TS({...le,value:_,skipUrlSync:ne.skipUrlSync,hide:ne.hide})}else{if(s.$.featureToggles.groupByVariable&&ne.type==="groupby")return new l.ZG({...le,datasource:ne.datasource,value:ne.current?.value||[],text:ne.current?.text||[],skipUrlSync:ne.skipUrlSync,hide:ne.hide,defaultOptions:ne.options});throw new Error(`Scenes: Unsupported variable type ${ne.type}`)}}}function X(ne){if(!ne.libraryPanel)return null;const le=new v.F({title:ne.title,uid:ne.libraryPanel.uid,name:ne.libraryPanel.name,panelKey:(0,a.XA)(ne.id)});return new c.U({key:`grid-item-${ne.id}`,y:ne.gridPos.y,x:ne.gridPos.x,width:ne.gridPos.w,height:ne.gridPos.h,itemHeight:ne.gridPos.h,body:le})}function q(ne){const le=ne.repeat?{variableName:ne.repeat,repeatDirection:ne.repeatDirection==="h"?"h":"v"}:{},_=[];_.push(new x.$({rawLinks:ne.links,menu:new x.m({$behaviors:[f.oV]})})),_.push(new E.W);const Q={key:(0,a.XA)(ne.id),title:ne.title,description:ne.description,pluginId:ne.type,options:ne.options??{},fieldConfig:ne.fieldConfig,pluginVersion:ne.pluginVersion,displayMode:ne.transparent?"transparent":void 0,hoverHeader:!ne.title&&!ne.timeFrom&&!ne.timeShift,hoverHeaderOffset:0,$data:(0,O.w)(ne),titleItems:_,extendPanelContext:I,_UNSAFE_customMigrationHandler:U(ne)};s.$.publicDashboardAccessToken||(Q.menu=new l.Lw({$behaviors:[f._i]})),(ne.timeFrom||ne.timeShift)&&(Q.$timeRange=new h.v({timeFrom:ne.timeFrom,timeShift:ne.timeShift,hideTimeOverride:ne.hideTimeOverride}));const ae=new l.Eb(Q);return new c.U({key:`grid-item-${ne.id}`,x:ne.gridPos.x,y:ne.gridPos.y,width:le.repeatDirection==="h"?24:ne.gridPos.w,height:ne.gridPos.h,itemHeight:ne.gridPos.h,body:ae,maxPerRow:ne.maxPerRow,...le})}function G(ne){ne.subscribeToEvent(l.Kw,le=>{const{interaction:_}=le.payload;switch(_){case"panel-status-message-clicked":N.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":N.c.panelCancelQueryClicked();break}})}const te=ne=>ne.map(le=>({data:{values:le.fields.map(_=>_.values).filter(_=>_!==void 0)},schema:{fields:le.fields.map(_=>({name:_.name,type:_.type,config:_.config}))}})),H=ne=>{ne.snapshotData&&(ne.datasource=w.x,ne.targets=[{refId:ne.snapshotData[0]?.refId??"",datasource:ne.datasource,queryType:"snapshot",snapshot:te(ne.snapshotData)}],ne.snapshotData=[])};function se(ne){(0,a.YQ)(ne).setState({isEmpty:ne.state.children.length===0});const le=ne.subscribeToState((_,Q)=>{(_.children.length!==Q.children.length||_.children!==Q.children)&&(0,a.YQ)(ne).setState({isEmpty:_.children.length===0})});return()=>{le.unsubscribe()}}},20455:(k,A,e)=>{"use strict";e.d(A,{Uy:()=>D,Z6:()=>M,ZB:()=>C,c:()=>S});var n=e(2543),s=e.n(n),l=e(92041),r=e(80943),i=e(79422),g=e(73134),o=e(28874),d=e(18803),c=e(79056),a=e(68706),p=e(16279),u=e(41507),m=e(60656),v=e(7928),x=e(79284),f=e(32023),E=e(74730),h=e(70665),y=e(13989),b=e(53287);function D(O,j=!1){const N=O.state,F=N.$timeRange.state,U=N.$data,w=N.$variables,B=N.body;let K=[],W=[];if(B instanceof r.hy){for(const se of B.state.children)if(se instanceof u.U&&(se.state.variableName?K=K.concat(R(se,N,j)):K.push(C(se,N,j))),se instanceof r.tI){if(se.state.key.indexOf("-clone-")>0&&!j)continue;T(se,K,N,j)}}let z=[];U instanceof p.s&&(z=(0,y.O)(U.state.annotationLayers)),w instanceof r.Pj&&(W=(0,b.C)(w));const Y=N.controls?.state,X=Y?.refreshPicker,q=L({refresh_intervals:X?.state.intervals,hidden:Y?.hideTimeControls,nowDelay:F.UNSAFE_nowDelay},i.lt),G=N.$behaviors?.find(se=>se instanceof r.Gg.K2)?.state.sync??i.Ye.graphTooltip,te=N.$behaviors?.find(se=>se instanceof r.Gg.en)?.isEnabled||void 0,H={...i.Ye,title:N.title,description:N.description||void 0,uid:N.uid,id:N.id,editable:N.editable,preload:N.preload,time:{from:F.from,to:F.to},timepicker:q,panels:K,annotations:{list:z},templating:{list:W},version:N.version,timezone:F.timeZone,fiscalYearStartMonth:F.fiscalYearStartMonth,weekStart:F.weekStart,tags:N.tags,links:N.links,graphTooltip:G,liveNow:te,schemaVersion:c.O2,refresh:X?.state.refresh};return(0,o.v)(H)}function P(O,j){if(!O.state.panel)throw new Error("Library panel has no panel");return{id:(0,E.Cs)(O.state.panel),title:O.state.title,gridPos:j,libraryPanel:{name:O.state.name,uid:O.state.uid}}}function C(O,j,N=!1){let F,U=0,w=0,B=0,K=0;if(O.state.body instanceof m.F)return U=O.state.x??0,w=O.state.y??0,B=O.state.width??0,K=O.state.itemHeight??O.state.height??0,P(O.state.body,{x:U,y:w,w:B,h:K});let W=O;if(j&&j.editPanel?.state.vizManager&&j.editPanel.state.vizManager.state.sourcePanel.resolve()===O.state.body){const Y=O.clone();Y.state.body instanceof r.Eb&&(j.editPanel.state.vizManager.commitChangesTo(Y.state.body),W=Y)}if(!(W.state.body instanceof r.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(F=W.state.body,U=W.state.x??0,w=W.state.y??0,B=W.state.width??0,K=(W.state.variableName?W.state.itemHeight:W.state.height)??0,!F)throw new Error("Unsupported grid item type");return M(F,{x:U,y:w,h:K,w:B},N,W)}function M(O,j,N=!1,F){const U={id:(0,E.Cs)(O),type:O.state.pluginId,title:O.state.title,description:O.state.description??void 0,gridPos:j,fieldConfig:O.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:O.state.displayMode==="transparent",pluginVersion:O.state.pluginVersion,...I(O,N)};if(O.state.options){const{angularOptions:K,...W}=O.state.options;U.options=W,K&&(0,n.defaults)(U,K)}const w=O.state.$timeRange;w instanceof v.v&&(U.timeFrom=w.state.timeFrom,U.timeShift=w.state.timeShift,U.hideTimeOverride=w.state.hideTimeOverride),F instanceof u.U&&(F.state.variableName&&(U.repeat=F.state.variableName),F.state.maxPerRow&&(U.maxPerRow=F.state.maxPerRow),F.state.repeatDirection&&(U.repeatDirection=F.getRepeatDirection()));const B=f.b4.getPanelLinks(O);return U.links=B?.state.rawLinks??[],U.links.length===0&&delete U.links,U.transformations?.length===0&&delete U.transformations,U.transparent||delete U.transparent,U}function I(O,j=!1){const N=O.state.$data,F={},U=(0,E.un)(O);if(U&&(F.targets=U.state.queries,F.maxDataPoints=U.state.maxDataPoints,F.datasource=U.state.datasource,U.state.cacheTimeout&&(F.cacheTimeout=U.state.cacheTimeout),U.state.queryCachingTTL&&(F.queryCachingTTL=U.state.queryCachingTTL),U.state.minInterval&&(F.interval=U.state.minInterval)),N instanceof r.Es&&(F.transformations=N.state.transformations),N&&j){F.datasource=h.x;let w=(0,d.B6)(N.state.data);N instanceof r.Es&&(w=(0,d.B6)(N.state.$data.state.data)),F.targets=[{refId:"A",datasource:F.datasource,queryType:a.nj.Snapshot,snapshot:w}]}return F}function R(O,j,N=!1){if(N){if(O.state.body instanceof m.F){const{x:F=0,y:U=0,width:w=0,height:B=0}=O.state;return[P(O.state.body,{x:F,y:U,w,h:B})]}if(O.state.repeatedPanels){const F=O.state.itemHeight??10,U=Math.ceil(O.state.repeatedPanels.length/O.getMaxPerRow()),w=Math.ceil(O.state.repeatedPanels.length/U),B=24/w,K=F;return O.state.repeatedPanels.map((z,Y)=>{let X=0,q=0;O.state.repeatDirection==="v"?(X=O.state.x,q=Y*K):(X=Y%w*B,q=O.state.y+Math.floor(Y/w)*K);const G={x:X,y:q,w:B,h:K},te=z.state.$variables.getByName(O.state.variableName);return{id:(0,E.Cs)(z),type:z.state.pluginId,title:z.state.title,gridPos:G,options:z.state.options,fieldConfig:z.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:z.state.displayMode==="transparent",scopedVars:{[O.state.variableName]:{text:te?.state.text,value:te?.state.value}},...I(z,N)}})}return[]}else return[C(O,j)]}function T(O,j,N,F=!1){const U=!!O.state.isCollapsed,w={type:"row",id:(0,E.Cs)(O),title:O.state.title,gridPos:{x:O.state.x??0,y:O.state.y??0,w:O.state.width??24,h:O.state.height??1},collapsed:U,panels:[]};if(O.state.$behaviors?.length){const K=O.state.$behaviors[0];K instanceof x.L&&(w.repeat=K.state.variableName)}if(F&&O.state.$variables){const W=O.state.$variables.state.variables.reduce((z,Y)=>({...z,[Y.state.name]:{text:Y.state.text,value:Y.state.value}}),{});w.scopedVars=W}j.push(w);let B=[];F?O.state.children.forEach(K=>{K instanceof u.U&&(K.state.variableName?B=B.concat(R(K,N,!U)):B.push(C(K,N,!U)))}):B=O.state.children.map(K=>{if(!(K instanceof u.U))throw new Error("Row child expected to be DashboardGridItem");return C(K,N)}),O.state.isCollapsed?w.panels=B:j.push(...B)}function S(O,j,N,F){let U={...N,title:O,time:{from:j.from.toISOString(),to:j.to.toISOString()},links:[]};if(F){const w=N.panels?.find(B=>B.id===(0,E.Cs)(F));w&&(w.gridPos={w:24,x:0,y:0,h:20},U={...U,panels:[w]})}if(U.panels?.forEach(w=>{"links"in w&&(w.links=[])}),U.annotations){const B=(U.annotations.list?.filter(K=>K.enable)||[]).map(K=>({name:K.name,enable:K.enable,iconColor:K.iconColor,type:K.type,builtIn:K.builtIn,hide:K.hide,snapshotData:[]}));U.annotations.list=B}return U.templating&&U.templating.list?.forEach(w=>{"query"in w&&(w.query=""),"options"in w&&(w.options=w.current&&!(0,l.R)(w.current)?[w.current]:[]),"refresh"in w&&(w.refresh=g.CO.never)}),U}function L(O,j){const N={...O};for(const F in j)(0,n.isEqual)(N[F],j[F])&&delete N[F];return N}},46502:(k,A,e)=>{"use strict";e.d(A,{F:()=>r});var n=e(74848),s=e(96540),l=e(7376);class r extends s.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){this.ref&&this.loadAngular()}componentDidUpdate(g){g.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const g=(0,l.E)(),o='<plugin-component type="annotations-query-ctrl"> </plugin-component>',d={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=g.load(this.ref,d,o),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(d.ctrl.ignoreNextWatcherFiring){d.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(d.ctrl.currentAnnotation)}),this.scopeProps=d}render(){return(0,n.jsx)("div",{ref:g=>this.ref=g})}}},65857:(k,A,e)=>{"use strict";e.d(A,{d:()=>u});var n=e(74848),s=e(88575),l=e(10354),r=e(90182),i=e(79924),g=e(57418),o=e(10880),d=e(55852),c=e(4588);const a=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],p=Object.keys(c.G).map(m=>({label:m,value:m}));function u({link:m,onUpdate:v,onGoBack:x}){const f=D=>{v({...m,tags:D})},E=D=>{const P={...m,type:D.value};P.type==="dashboards"?(P.url="",P.tooltip=""):P.tags=[],v(P)},h=D=>{v({...m,icon:D.value})},y=D=>{const P=D.currentTarget;v({...m,[P.name]:P.type==="checkbox"?P.checked:P.value})},b=m.title===c.q.title;return(0,n.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,n.jsx)(s.D,{label:"Title",children:(0,n.jsx)(l.p,{name:"title",id:"title",value:m.title,onChange:y,autoFocus:b})}),(0,n.jsx)(s.D,{label:"Type",children:(0,n.jsx)(r.l6,{inputId:"link-type-input",value:m.type,options:a,onChange:E})}),m.type==="dashboards"&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.D,{label:"With tags",children:(0,n.jsx)(i.u,{tags:m.tags,onChange:f})})}),m.type==="link"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.D,{label:"URL",children:(0,n.jsx)(l.p,{name:"url",value:m.url,onChange:y})}),(0,n.jsx)(s.D,{label:"Tooltip",children:(0,n.jsx)(l.p,{name:"tooltip",value:m.tooltip,onChange:y,placeholder:"Open dashboard"})}),(0,n.jsx)(s.D,{label:"Icon",children:(0,n.jsx)(r.l6,{value:m.icon,options:p,onChange:h})})]}),(0,n.jsxs)(g.M,{label:"Options",isOpen:!0,children:[m.type==="dashboards"&&(0,n.jsx)(s.D,{children:(0,n.jsx)(o.S,{label:"Show as dropdown",name:"asDropdown",value:m.asDropdown,onChange:y})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(o.S,{label:"Include current time range",name:"keepTime",value:m.keepTime,onChange:y})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(o.S,{label:"Include current template variable values",name:"includeVars",value:m.includeVars,onChange:y})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(o.S,{label:"Open link in new tab",name:"targetBlank",value:m.targetBlank,onChange:y})})]}),(0,n.jsx)(d.$n,{variant:"secondary",onClick:x,children:"Back to list"})]})}},6199:(k,A,e)=>{"use strict";e.d(A,{X:()=>m});var n=e(74848),s=e(32196),l=e(40845),r=e(67061),i=e(69529),g=e(55852),o=e(72109),d=e(14578),c=e(64149),a=e(29158),p=e(91605),u=e(8484);function m({links:x,onNew:f,onOrderChange:E,onEdit:h,onDuplicate:y,onDelete:b}){const D=(0,l.of)(v);return x.length===0?(0,n.jsx)(r.B,{direction:"column",children:(0,n.jsx)(i.p,{variant:"call-to-action",button:(0,n.jsx)(g.$n,{onClick:f,size:"lg",children:(0,n.jsx)(u.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,u.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,n.jsxs)(u.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,n.jsx)(o.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Type"}),(0,n.jsx)("th",{children:"Info"}),(0,n.jsx)("th",{colSpan:3})]})}),(0,n.jsx)("tbody",{children:x.map((C,M)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>h(M),children:[(0,n.jsx)(d.I,{name:"external-link-alt"})," \xA0 ",C.type]}),(0,n.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>h(M),children:(0,n.jsxs)(r.B,{children:[C.title&&(0,n.jsx)("span",{className:D.titleWrapper,children:C.title}),C.type==="link"&&(0,n.jsx)("span",{className:D.urlWrapper,children:C.url}),C.type==="dashboards"&&(0,n.jsx)(c.L,{tags:C.tags??[]})]})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:M!==0&&(0,n.jsx)(a.K,{name:"arrow-up",onClick:()=>E(M,-1),tooltip:"Move link up"})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:x.length>1&&M!==x.length-1?(0,n.jsx)(a.K,{name:"arrow-down",onClick:()=>E(M,1),tooltip:"Move link down"}):null}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,n.jsx)(a.K,{name:"copy",onClick:()=>y(C),tooltip:"Copy link"})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,n.jsx)(p.e,{"aria-label":`Delete link with title "${C.title}"`,size:"sm",onConfirm:()=>b(M)})})]},`${C.title}-${M}`))})]}),(0,n.jsx)(g.$n,{className:D.newLinkButton,icon:"plus",onClick:f,children:"New link"})]})}const v=x=>({titleWrapper:(0,s.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,s.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,s.css)({marginTop:x.spacing(3)})})},4588:(k,A,e)=>{"use strict";e.d(A,{G:()=>s,q:()=>n});const n={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},s={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(k,A,e)=>{"use strict";e.d(A,{Q:()=>p});var n=e(74848),s=e(96540),l=e(72436),r=e(13544),i=e(88575),g=e(42418),o=e(15292),d=e(32372),c=e(51612),a=e(58975);function p({datasource:u,infoText:m,onDataSourceChange:v,onDefaultKeysChange:x,defaultKeys:f}){const E=(0,s.useCallback)(h=>{const y=(0,l.Jh)(`key,value
`+h)[0],b=[];for(let D=0;D<y.length;D++)b.push({text:y.fields[0].values[D],value:y.fields[1].values[D]});x?.(b)},[x]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Y,{children:"Ad-hoc options"}),(0,n.jsx)(i.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,n.jsx)(c.s,{current:u,onChange:v,width:30,variables:!0,noDefault:!0})}),m?(0,n.jsx)(g.F,{title:m,severity:"info","data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,x&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,n.jsx)(o.d,{"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:f!==void 0,onChange:h=>{x(f===void 0?[]:void 0)}})}),f!==void 0&&(0,n.jsx)(d.B,{height:300,language:"csv",value:f.map(h=>`${h.text},${h.value}`).join(`
`),onBlur:E,onSave:E,showMiniMap:!1,showLineNumbers:!0})]})]})}},95802:(k,A,e)=>{"use strict";e.d(A,{d:()=>i});var n=e(74848),s=e(13544),l=e(58975),r=e(14329);function i({onChange:g,constantValue:o}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Y,{children:"Constant options"}),(0,n.jsx)(r._,{defaultValue:o,name:"Value",placeholder:"your metric prefix",onBlur:g,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},58711:(k,A,e)=>{"use strict";e.d(A,{w:()=>g});var n=e(74848),s=e(13544),l=e(58975),r=e(85140),i=e(94618);function g({query:o,multi:d,allValue:c,includeAll:a,onQueryChange:p,onMultiChange:u,onIncludeAllChange:m,onAllValueChange:v}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Y,{children:"Custom options"}),(0,n.jsx)(r.Z,{name:"Values separated by comma",defaultValue:o,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:p,required:!0,width:52,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,n.jsx)(l.Y,{children:"Selection options"}),(0,n.jsx)(i.B,{multi:d,includeAll:a,allValue:c,onMultiChange:u,onIncludeAllChange:m,onAllValueChange:v})]})}},98917:(k,A,e)=>{"use strict";e.d(A,{y:()=>o});var n=e(74848),s=e(13544),l=e(94618),r=e(58975),i=e(89458),g=e(14329);function o({query:d,regex:c,optionTypes:a,onChange:p,onRegExBlur:u,multi:m,includeAll:v,allValue:x,onMultiChange:f,onIncludeAllChange:E,onAllValueChange:h}){const y=a.find(b=>b.value===d)??a[0];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Y,{children:"Data source options"}),(0,n.jsx)(i.v,{name:"Type",value:y,options:a,onChange:p,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,n.jsx)(g._,{defaultValue:c,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:u,description:(0,n.jsxs)("div",{children:["Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)("code",{children:"/^prod/"})]})}),(0,n.jsx)(r.Y,{children:"Selection options"}),(0,n.jsx)(l.B,{multi:m,includeAll:v,allValue:x,onMultiChange:f,onIncludeAllChange:E,onAllValueChange:h})]})}},49317:(k,A,e)=>{"use strict";e.d(A,{s:()=>c});var n=e(74848),s=e(32196),l=e(13544),r=e(40845),i=e(99615),g=e(58975),o=e(89458),d=e(14329);function c({intervals:p,onIntervalsChange:u,onAutoEnabledChange:m,onAutoMinIntervalChanged:v,onAutoCountChanged:x,autoEnabled:f,autoMinInterval:E,autoStepCount:h}){const y=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(P=>({label:`${P}`,value:P})),b=(0,r.of)(a),D=y.find(P=>P.value===h)??y[0];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Y,{children:"Interval options"}),(0,n.jsx)(d._,{defaultValue:p,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:u,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,n.jsx)(i.c,{value:f,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:m,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),f&&(0,n.jsxs)("div",{className:b.autoFields,children:[(0,n.jsx)(o.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:D,options:y,onChange:x,width:9,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,n.jsx)(d._,{value:E,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:v,width:11,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const a=p=>({autoFields:(0,s.css)({marginTop:p.spacing(2),display:"flex",flexDirection:"column"})})},44890:(k,A,e)=>{"use strict";e.d(A,{u:()=>T});var n=e(74848),s=e(16817),l=e(13544),r=e(19347),i=e(88575),g=e(39070),o=e(72574),d=e(90613),c=e(94753),a=e(24240);function p({query:S,datasource:L,VariableQueryEditor:O,onLegacyQueryChange:j,onQueryChange:N,timeRange:F}){let U;return typeof S=="string"?U=S||(L.variables?.getDefaultQuery?.()??""):U={...L.variables?.getDefaultQuery?.(),...S},O&&(0,a.VN)(O,L)?(0,n.jsxs)(d.a,{marginBottom:2,children:[(0,n.jsx)(c.E,{element:"h4",children:"Query"}),(0,n.jsx)(d.a,{marginTop:1,children:(0,n.jsx)(O,{datasource:L,query:U,templateSrv:(0,o.w)(),onChange:j},L.uid)})]}):O&&(0,a.CH)(O,L)?(0,n.jsxs)(d.a,{marginBottom:2,children:[(0,n.jsx)(c.E,{element:"h4",children:"Query"}),(0,n.jsx)(d.a,{marginTop:1,children:(0,n.jsx)(O,{datasource:L,query:U,onChange:N,onRunQuery:()=>{},data:{series:[],state:g.Gu.Done,timeRange:F},range:F,onBlur:()=>{},history:[]},L.uid)})]}):null}var u=e(94618),m=e(51612),v=e(70766),x=e(96540),f=e(12470),E=e(40845),h=e(94354),y=e(60619);const b=[{label:"On dashboard load",value:f.CO.onDashboardLoad},{label:"On time range change",value:f.CO.onTimeRangeChanged}];function D({onChange:S,refresh:L,testId:O}){const j=(0,E.$j)(),[N,F]=(0,x.useState)(!1);(0,y.Y)({breakpoint:j.breakpoints.values.sm,onChange:w=>{F(!w.matches)}});const U=(0,x.useMemo)(()=>b.find(w=>w.value===L)?.value??b[0].value,[L]);return(0,n.jsx)(i.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":O,children:(0,n.jsx)(h.z,{options:b,onChange:S,value:U,size:N?"sm":"md"})})}var P=e(89458);const C=[{label:"Disabled",value:f.ZG.disabled},{label:"Alphabetical (asc)",value:f.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:f.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:f.ZG.numericalAsc},{label:"Numerical (desc)",value:f.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:f.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:f.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:f.ZG.naturalAsc},{label:"Natural (desc)",value:f.ZG.naturalDesc}];function M({onChange:S,sort:L,testId:O}){const j=(0,x.useMemo)(()=>C.find(N=>N.value===L)??C[0],[L]);return(0,n.jsx)(P.v,{name:"Sort",description:"How to sort the values of this variable",value:j,options:C,onChange:S,testId:O,width:25})}var I=e(58975),R=e(85140);function T({datasource:S,onDataSourceChange:L,query:O,onQueryChange:j,onLegacyQueryChange:N,timeRange:F,regex:U,onRegExChange:w,sort:B,onSortChange:K,refresh:W,onRefreshChange:z,isMulti:Y,onMultiChange:X,includeAll:q,onIncludeAllChange:G,allValue:te,onAllValueChange:H}){const{value:se}=(0,s.A)(async()=>{const _=await(0,r.l)().get(S??""),Q=await(0,v.y)(_);return{datasource:_,VariableQueryEditor:Q}},[S]),{datasource:ne,VariableQueryEditor:le}=se??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I.Y,{children:"Query options"}),(0,n.jsx)(i.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,n.jsx)(m.s,{current:S,onChange:L,variables:!0,width:30})}),ne&&le&&(0,n.jsx)(p,{onQueryChange:j,onLegacyQueryChange:N,datasource:ne,query:O,VariableQueryEditor:le,timeRange:F}),(0,n.jsx)(R.Z,{defaultValue:U??"",name:"Regex",description:(0,n.jsxs)("div",{children:["Optional, if you want to extract part of a series name or metric node segment.",(0,n.jsx)("br",{}),"Named capture groups can be used to separate the display text and value (",(0,n.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank",children:"see examples"}),")."]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:w,testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,n.jsx)(M,{testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:K,sort:B}),(0,n.jsx)(D,{testId:l.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:z,refresh:W}),(0,n.jsx)(I.Y,{children:"Selection options"}),(0,n.jsx)(u.B,{multi:!!Y,includeAll:!!q,allValue:te,onMultiChange:X,onIncludeAllChange:G,onAllValueChange:H})]})}},94618:(k,A,e)=>{"use strict";e.d(A,{B:()=>g});var n=e(74848),s=e(13544),l=e(67061),r=e(99615),i=e(14329);function g({multi:o,includeAll:d,allValue:c,onMultiChange:a,onIncludeAllChange:p,onAllValueChange:u}){return(0,n.jsxs)(l.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,n.jsx)(r.c,{value:o,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:a,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),(0,n.jsx)(r.c,{value:d,name:"Include All option",description:"Enables an option to include all variables",onChange:p,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),d&&(0,n.jsx)(i._,{defaultValue:c??"",onBlur:u,name:"Custom all value",placeholder:"blank = auto",testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},99615:(k,A,e)=>{"use strict";e.d(A,{c:()=>r});var n=e(74848),s=e(92145),l=e(10880);function r({value:i,name:g,description:o,onChange:d,ariaLabel:c,testId:a}){const p=(0,s.Bi)();return(0,n.jsx)(l.S,{id:p,label:g,description:o,value:i,onChange:d,"aria-label":c,"data-testid":a})}},8964:(k,A,e)=>{"use strict";e.d(A,{D:()=>o});var n=e(74848),s=e(96540),l=e(12470),r=e(88575),i=e(94354);const g=[{label:"Label and value",value:l.zL.dontHide},{label:"Value",value:l.zL.hideLabel},{label:"Nothing",value:l.zL.hideVariable}];function o({onChange:d,hide:c,type:a}){const p=(0,s.useMemo)(()=>g.find(u=>u.value===c)?.value??g[0].value,[c]);return a==="constant"?null:(0,n.jsx)(r.D,{label:"Show on dashboard",children:(0,n.jsx)(i.z,{options:g,onChange:d,value:p})})}},58975:(k,A,e)=>{"use strict";e.d(A,{Y:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(17408);function i({className:o,...d}){const c=(0,l.of)(g);return(0,n.jsx)(r.s,{...d,className:(0,s.cx)(c.legend,o)})}function g(o){return{legend:(0,s.css)({marginTop:o.spacing(3),marginBottom:o.spacing(1)})}}},89458:(k,A,e)=>{"use strict";e.d(A,{v:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(88575),g=e(90182);function o({name:c,description:a,value:p,options:u,onChange:m,testId:v,width:x}){const f=(0,r.of)(d),E=(0,l.useId)(),h=`variable-select-input-${c}-${E}`;return(0,n.jsx)(i.D,{label:c,description:a,htmlFor:h,children:(0,n.jsx)(g.l6,{"data-testid":v,inputId:h,onChange:m,value:p,width:x??30,options:u,className:f.selectContainer})})}function d(c){return{selectContainer:(0,s.css)({marginRight:c.spacing(.5)})}}},85140:(k,A,e)=>{"use strict";e.d(A,{$:()=>d,Z:()=>o});var n=e(74848),s=e(32196),l=e(92145),r=e(40845),i=e(88575),g=e(21744);function o({value:c,defaultValue:a,name:p,description:u,placeholder:m,onChange:v,onBlur:x,ariaLabel:f,required:E,width:h,testId:y}){const b=(0,r.of)(d),D=(0,l.Bi)();return(0,n.jsx)(i.D,{label:p,description:u,htmlFor:D,children:(0,n.jsx)(g.f,{id:D,rows:2,value:c,defaultValue:a,onChange:v,onBlur:x,placeholder:m,required:E,"aria-label":f,cols:h,className:b.textarea,"data-testid":y})})}function d(c){return{textarea:(0,s.css)({whiteSpace:"pre-wrap",minHeight:c.spacing(4),height:"auto",overflow:"auto",padding:`${c.spacing(.75)} ${c.spacing(1)}`,width:"inherit",[c.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(k,A,e)=>{"use strict";e.d(A,{_:()=>i});var n=e(74848),s=e(92145),l=e(88575),r=e(10354);function i({value:g,defaultValue:o,name:d,placeholder:c="",onChange:a,testId:p,width:u,required:m,onBlur:v,grow:x,description:f,invalid:E,error:h,maxLength:y}){const b=(0,s.Bi)(d);return(0,n.jsx)(l.D,{label:d,description:f,invalid:E,error:h,htmlFor:b,children:(0,n.jsx)(r.p,{type:"text",id:b,placeholder:c,value:g,defaultValue:o,onChange:a,onBlur:v,width:x?void 0:u??30,"data-testid":p,maxLength:y,required:m})})}},41820:(k,A,e)=>{"use strict";e.d(A,{j:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(40845),g=e(39268),o=e(76892),d=e(55852);const c=({options:p})=>{const[u,m]=(0,l.useState)(20),[v,x]=(0,l.useState)([]),f=(0,l.useCallback)(h=>{h.preventDefault(),m(u+20)},[u,m]),E=(0,i.of)(a);return(0,l.useEffect)(()=>x(p.slice(0,u)),[u,p]),v.length?(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,n.jsx)("h5",{children:"Preview of values"}),(0,n.jsx)(g.C,{children:v.map((h,y)=>(0,n.jsx)(g.C,{className:E.optionContainer,children:(0,n.jsx)(o.c,{"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,n.jsx)("div",{className:E.label,children:h.label})})},`${h.value}-${y}`))}),p.length>u&&(0,n.jsx)(g.C,{className:E.optionContainer,children:(0,n.jsx)(d.$n,{onClick:f,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link",children:"Show more"})})]}):null};c.displayName="VariableValuesPreview";function a(p){return{wrapper:(0,s.css)({display:"flex",flexDirection:"column",marginTop:p.spacing(2)}),optionContainer:(0,s.css)({marginLeft:p.spacing(.5),marginBottom:p.spacing(.5)}),label:(0,s.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(k,A,e)=>{"use strict";e.d(A,{cH:()=>_,mJ:()=>Q,Ao:()=>H,e4:()=>se,kh:()=>q,CD:()=>Y,No:()=>X,B$:()=>z,n_:()=>te,bZ:()=>B,c7:()=>le});var n=e(2543),s=e(32264),l=e(19347),r=e(80943),i=e(79422),g=e(74730),o=e(74848),d=e(16817),c=e(22391),a=e(27803);function p(ae){const{variable:oe}=ae,{datasource:J,defaultKeys:ee}=oe.useState(),{value:de}=(0,d.A)(async()=>await(0,l.l)().get(J),[J]),xe=de?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",re=Te=>{const ge=(0,c.p$)(Te);oe.setState({datasource:ge})},ue=Te=>{oe.setState({defaultKeys:Te})};return(0,o.jsx)(a.Q,{datasource:J??void 0,infoText:xe,onDataSourceChange:re,defaultKeys:ee,onDefaultKeysChange:ue})}var u=e(95802);function m({variable:ae}){const{value:oe}=ae.useState(),J=ee=>{ae.setState({value:ee.currentTarget.value})};return(0,o.jsx)(u.d,{constantValue:String(oe),onChange:J})}var v=e(58711);function x({variable:ae,onRunQuery:oe}){const{query:J,isMulti:ee,allValue:de,includeAll:xe}=ae.useState(),re=Oe=>{ae.setState({isMulti:Oe.currentTarget.checked})},ue=Oe=>{ae.setState({includeAll:Oe.currentTarget.checked})},Te=Oe=>{ae.setState({query:Oe.currentTarget.value}),oe()},ge=Oe=>{ae.setState({allValue:Oe.currentTarget.value})};return(0,o.jsx)(v.w,{query:J??"",multi:!!ee,allValue:de??"",includeAll:!!xe,onMultiChange:re,onIncludeAllChange:ue,onQueryChange:Te,onAllValueChange:ge})}var f=e(98917);function E({variable:ae,onRunQuery:oe}){const{pluginId:J,regex:ee,isMulti:de,allValue:xe,includeAll:re}=ae.useState(),ue=se(),Te=we=>{ae.setState({pluginId:we.value}),oe()},ge=we=>{ae.setState({regex:we.currentTarget.value}),oe()},Oe=we=>{ae.setState({isMulti:we.currentTarget.checked})},Ue=we=>{ae.setState({includeAll:we.currentTarget.checked})},Xe=we=>{ae.setState({allValue:we.currentTarget.value})};return(0,o.jsx)(f.y,{query:J,regex:ee,multi:de||!1,allValue:xe,includeAll:re||!1,optionTypes:ue,onChange:Te,onRegExBlur:ge,onMultiChange:Oe,onIncludeAllChange:Ue,onAllValueChange:Xe})}var h=e(96540),y=e(72436),b=e(13544),D=e(88575),P=e(42418),C=e(15292),M=e(32372),I=e(51612),R=e(58975);function T({datasource:ae,defaultOptions:oe,infoText:J,onDataSourceChange:ee,onDefaultOptionsChange:de}){const xe=(0,h.useCallback)(re=>{const ue=(0,y.Jh)(`key,value
`+re)[0],Te=[];for(let ge=0;ge<ue.length;ge++)Te.push({text:ue.fields[0].values[ge],value:ue.fields[1].values[ge]});de(Te)},[de]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(R.Y,{children:"Group by options"}),(0,o.jsx)(D.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,o.jsx)(I.s,{current:ae,onChange:ee,width:30,variables:!0,noDefault:!0})}),J?(0,o.jsx)(P.F,{title:J,severity:"info","data-testid":b.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,(0,o.jsx)(D.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,o.jsx)(C.d,{"data-testid":b.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:oe!==void 0,onChange:re=>{de(oe===void 0?[]:void 0)}})}),oe!==void 0&&(0,o.jsx)(M.B,{height:300,language:"csv",value:oe.map(re=>`${re.text},${re.value}`).join(`
`),onBlur:xe,onSave:xe,showMiniMap:!1,showLineNumbers:!0})]})}function S(ae){const{variable:oe,onRunQuery:J}=ae,{datasource:ee,defaultOptions:de}=oe.useState(),{value:xe}=(0,d.A)(async()=>await(0,l.l)().get(ee),[oe.state]),re=xe?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",ue=async ge=>{const Oe=(0,c.p$)(ge);oe.setState({datasource:Oe}),J()},Te=async ge=>{oe.setState({defaultOptions:ge}),J()};return(0,o.jsx)(T,{defaultOptions:de,datasource:ee??void 0,infoText:ee?re:void 0,onDataSourceChange:ue,onDefaultOptionsChange:Te})}var L=e(49317);function O({variable:ae,onRunQuery:oe}){const{intervals:J,autoStepCount:ee,autoEnabled:de,autoMinInterval:xe,value:re}=ae.useState(),ue=(0,g.bx)(J),Te=Xe=>{const we=(0,g.Sm)(Xe.currentTarget.value),qe=we.includes(re)?re:we[0];ae.setState({intervals:we,value:qe}),oe()},ge=Xe=>{ae.setState({autoStepCount:Xe.value})},Oe=Xe=>{ae.setState({autoEnabled:Xe.target.checked})},Ue=Xe=>{ae.setState({autoMinInterval:Xe.currentTarget.value})};return(0,o.jsx)(L.s,{intervals:ue,autoStepCount:ee,autoEnabled:de,onAutoCountChanged:ge,onIntervalsChange:Te,onAutoEnabledChange:Oe,onAutoMinIntervalChanged:Ue,autoMinInterval:xe})}var j=e(44890);function N({variable:ae,onRunQuery:oe}){const{datasource:J,regex:ee,sort:de,refresh:xe,isMulti:re,includeAll:ue,allValue:Te,query:ge}=ae.useState(),{value:Oe}=r.jh.getTimeRange(ae).useState(),Ue=_e=>{ae.setState({regex:_e.currentTarget.value})},Xe=_e=>{ae.setState({sort:_e.value})},we=_e=>{ae.setState({refresh:_e})},qe=_e=>{ae.setState({isMulti:_e.currentTarget.checked})},We=_e=>{ae.setState({includeAll:_e.currentTarget.checked})},Ce=_e=>{ae.setState({allValue:_e.currentTarget.value})},je=_e=>{const Fe=(0,c.p$)(_e);if(ae.state.datasource&&ae.state.datasource.type!==Fe.type){ae.setState({datasource:Fe,query:"",definition:""});return}ae.setState({datasource:Fe})},Ke=_e=>{let Fe;typeof _e=="string"?Fe=_e:_e.hasOwnProperty("query")&&typeof _e.query=="string"?Fe=_e.query:Fe="",ae.setState({query:_e,definition:Fe}),oe()};return(0,o.jsx)(j.u,{datasource:J??void 0,onDataSourceChange:je,query:ge,onQueryChange:Ke,onLegacyQueryChange:Ke,timeRange:Oe,regex:ee,onRegExChange:Ue,sort:de,onSortChange:Xe,refresh:xe,onRefreshChange:we,isMulti:!!re,onMultiChange:qe,includeAll:!!ue,onIncludeAllChange:We,allValue:Te??"",onAllValueChange:Ce})}var F=e(14329);function U({defaultValue:ae,value:oe,onChange:J,onBlur:ee}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(R.Y,{children:"Text options"}),(0,o.jsx)(F._,{value:oe,defaultValue:ae,name:"Default value",placeholder:"default value, if any",onChange:J,onBlur:ee,width:30,testId:b.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function w({variable:ae}){const{value:oe}=ae.useState(),J=ee=>{ae.setState({value:ee.currentTarget.value})};return(0,o.jsx)(U,{defaultValue:oe,onBlur:J})}function B(ae){return ae!=="system"}const K={custom:{name:"Custom",description:"Define variable values manually",editor:x},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:N},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:m},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:O},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:E},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:p},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:S},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:w}},W=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function z(){const ae=W.map(oe=>({label:K[oe].name,value:oe,description:K[oe].description}));return s.$.featureToggles.groupByVariable?ae:ae.filter(oe=>oe.value!=="groupby")}function Y(ae){return K[ae].editor}function X(ae,oe){switch(ae){case"custom":return new r.yP(oe);case"query":return new r.fS(oe);case"constant":return new r.x0({...oe,hide:i.zL.hideVariable});case"interval":return new r.Yj(oe);case"datasource":return new r.mI(oe);case"adhoc":return new r.H9(oe);case"groupby":return new r.ZG(oe);case"textbox":return new r.TS(oe)}}function q(ae){const J=G("query",ae);return new r.fS({name:J})}function G(ae,oe){let J=0,ee=`${ae}${J}`;for(;oe.find(de=>de.state.name===ee);)ee=`${ae}${++J}`;return ee}function te(ae){return"options"in ae.state||"intervals"in ae.state}function H(ae){let oe="";return ae instanceof r.fS?oe=ae.state.definition||(typeof ae.state.query=="string"?ae.state.query:""):ae instanceof r.mI?oe=String(ae.state.pluginId):ae instanceof r.yP?oe=ae.state.query:ae instanceof r.Yj?oe=(0,g.bx)(ae.state.intervals):(ae instanceof r.TS||ae instanceof r.x0)&&(oe=String(ae.state.value)),oe}function se(){const ae=(0,l.l)().getList({metrics:!0,variables:!0}),oe=(0,n.chain)(ae).uniqBy("meta.id").map(J=>({label:J.meta.name,value:J.meta.id})).value();return oe.unshift({label:"",value:""}),oe}function ne(ae){return"type"in ae.state&&"getValue"in ae}function le(ae){return ne(ae)?r.Go.isAdHocVariable(ae)||r.Go.isConstantVariable(ae)||r.Go.isCustomVariable(ae)||r.Go.isDataSourceVariable(ae)||r.Go.isIntervalVariable(ae)||r.Go.isQueryVariable(ae)||r.Go.isTextBoxVariable(ae)||r.Go.isGroupByVariable(ae):!1}const _=/^(?!__).*$/,Q=/^\w+$/},19626:(k,A,e)=>{"use strict";e.d(A,{D:()=>u});var n=e(74848),s=e(32196),l=e(2543),r=e(40845),i=e(14578);const g=({diff:v})=>{const x=(0,r.of)(o),f=!(0,l.isUndefined)(v.originalValue)&&!(0,l.isArray)(v.originalValue)&&!(0,l.isObject)(v.originalValue),E=!(0,l.isUndefined)(v.value)&&!(0,l.isArray)(v.value)&&!(0,l.isObject)(v.value);return(0,n.jsxs)(n.Fragment,{children:[f&&(0,n.jsx)("span",{className:x,children:String(v.originalValue)}),f&&E?(0,n.jsx)(i.I,{name:"arrow-right"}):null,E&&(0,n.jsx)("span",{className:x,children:String(v.value)})]})},o=v=>(0,s.css)({backgroundColor:v.colors.action.hover,borderRadius:v.shape.radius.default,color:v.colors.text.primary,fontSize:v.typography.body.fontSize,margin:v.spacing(0,.5),padding:v.spacing(.25,.5)});var d=e(56596);const c={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},a=({diff:v,title:x})=>{const f=(0,r.of)(p);return v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.I,{type:"mono",name:"circle",className:f[v.op],size:"xs"})," ",(0,n.jsx)("span",{className:f.embolden,children:x})," ",(0,n.jsx)("span",{children:(0,d.Fl)(v,v.path.length>1)})," ",(0,n.jsx)(g,{diff:v})]}):(0,n.jsxs)("div",{className:f.withoutDiff,children:[(0,n.jsx)(i.I,{type:"mono",name:"circle",className:f.replace,size:"xs"})," ",(0,n.jsx)("span",{className:f.embolden,children:x})," ",(0,n.jsx)("span",{children:(0,d.Fl)(c,!1)})]})},p=v=>({embolden:(0,s.css)({fontWeight:v.typography.fontWeightBold}),add:(0,s.css)({color:v.colors.success.main}),replace:(0,s.css)({color:v.colors.success.main}),move:(0,s.css)({color:v.colors.success.main}),copy:(0,s.css)({color:v.colors.success.main}),_get:(0,s.css)({color:v.colors.success.main}),test:(0,s.css)({color:v.colors.success.main}),remove:(0,s.css)({color:v.colors.success.main}),withoutDiff:(0,s.css)({marginBottom:v.spacing(1)})}),u=({diffs:v,title:x})=>{const f=(0,r.of)(m);return v.length===1?(0,n.jsx)("div",{className:f.container,"data-testid":"diffGroup",children:(0,n.jsx)(a,{title:x,diff:v[0]})}):(0,n.jsxs)("div",{className:f.container,"data-testid":"diffGroup",children:[(0,n.jsx)(a,{title:x}),(0,n.jsx)("ul",{className:f.list,children:v.map((E,h)=>(0,n.jsxs)("li",{className:f.listItem,children:[(0,n.jsx)("span",{children:(0,d.Fl)(E)})," ",(0,n.jsx)(g,{diff:E})]},`${(0,l.last)(E.path)}__${h}`))})]})},m=v=>({container:(0,s.css)({}),list:(0,s.css)({marginLeft:v.spacing(4)}),listItem:(0,s.css)({marginBottom:v.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(k,A,e)=>{"use strict";e.d(A,{M:()=>o});var n=e(74848),s=e(32196),l=e(24773),r=e.n(l),i=e(84140),g=e(40845);const o=({oldValue:d,newValue:c,...a})=>{const p=(0,g.$j)(),u={variables:{dark:{diffViewerBackground:p.colors.background.canvas,diffViewerColor:p.colors.text.primary,addedBackground:(0,i.A)(p.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,i.A)(p.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,i.A)(p.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,i.A)(p.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,i.A)(p.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,i.A)(p.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:p.colors.background.primary,gutterBackgroundDark:p.colors.background.primary,highlightBackground:(0,i.A)(p.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,i.A)(p.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:p.colors.background.secondary,codeFoldBackground:p.colors.background.secondary,emptyLineBackground:p.colors.background.secondary,gutterColor:p.colors.text.disabled,addedGutterColor:p.colors.text.primary,removedGutterColor:p.colors.text.primary,codeFoldContentColor:p.colors.text.disabled,diffViewerTitleBackground:p.colors.background.secondary,diffViewerTitleColor:p.colors.text.disabled,diffViewerTitleBorderColor:p.colors.border.strong}},codeFold:{fontSize:p.typography.bodySmall.fontSize},gutter:{pre:{color:(0,i.A)(p.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,n.jsx)("div",{className:(0,s.css)({fontSize:p.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,n.jsx)(r(),{styles:u,oldValue:d,newValue:c,splitView:!1,compareMethod:l.DiffMethod.CSS,useDarkTheme:p.isDark,...a})})}},57714:(k,A,e)=>{"use strict";e.d(A,{Cc:()=>L,me:()=>y,bS:()=>v,rJ:()=>C,wL:()=>l});var n=e(17172);class s{getHistoryList(N,F){return typeof N!="string"?Promise.resolve([]):(0,n.AI)().get(`api/dashboards/uid/${N}/versions`,F)}getDashboardVersion(N,F){return typeof N!="string"?Promise.resolve({}):(0,n.AI)().get(`api/dashboards/uid/${N}/versions/${F}`)}restoreDashboard(N,F){if(typeof N!="string")return Promise.resolve({});const U=`api/dashboards/uid/${N}/restore`;return(0,n.AI)().post(U,{version:F})}}const l=new s;var r=e(74848),i=e(32196),g=e(40845),o=e(10880),d=e(78369),c=e(71678),a=e(55852),p=e(96374),u=e(3169);const m=({hideModal:j,onRestore:N,version:F})=>{const U=(0,u._2)(),w=async()=>{await N(F)?U.success("Dashboard restored",`Restored from version ${F.version}`):U.error("Dashboard restore failed",`Failed to restore from version ${F.version}`),j()};return(0,r.jsx)(p.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:j,onConfirm:w,body:(0,r.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",F.version,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${F.version}`})},v=({versions:j,canCompare:N,onCheck:F,onRestore:U})=>{const w=(0,g.of)(x);return(0,r.jsx)("div",{className:w.margin,children:(0,r.jsxs)("table",{className:"filter-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"width-4"}),(0,r.jsx)("th",{className:"width-4",children:"Version"}),(0,r.jsx)("th",{className:"width-14",children:"Date"}),(0,r.jsx)("th",{className:"width-10",children:"Updated by"}),(0,r.jsx)("th",{children:"Notes"}),(0,r.jsx)("th",{})]})}),(0,r.jsx)("tbody",{children:j.map((B,K)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)(o.S,{"aria-label":`Toggle selection of version ${B.version}`,className:(0,i.css)({display:"inline"}),checked:B.checked,onChange:W=>F(W,B.id),disabled:!B.checked&&N})}),(0,r.jsx)("td",{children:B.version}),(0,r.jsx)("td",{children:B.createdDateString}),(0,r.jsx)("td",{children:B.createdBy}),(0,r.jsx)("td",{children:B.message}),(0,r.jsx)("td",{className:"text-right",children:K===0?(0,r.jsx)(d.v,{name:"Latest",colorIndex:17}):(0,r.jsx)(c.$s,{children:({showModal:W,hideModal:z})=>(0,r.jsx)(a.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{W(m,{version:B,hideModal:z,onRestore:U})},children:"Restore"})})})]},B.id))})]})})};function x(j){return{margin:(0,i.css)({marginBottom:j.spacing(4)})}}var f=e(2543),E=e(29158),h=e(14578);const y=({onClick:j=f.noop,baseVersion:N=0,newVersion:F=0,isNewLatest:U=!1})=>{const w=(0,g.of)(b);return(0,r.jsxs)("h3",{className:w.header,children:[(0,r.jsx)(E.K,{name:"arrow-left",size:"xl",onClick:j,tooltip:"Reset version"}),(0,r.jsxs)("span",{children:["Comparing ",N," ",(0,r.jsx)(h.I,{name:"arrows-h"})," ",F," ",U&&(0,r.jsx)("cite",{className:"muted",children:"(Latest)"})]})]})},b=j=>({header:(0,i.css)({fontSize:j.typography.h3.fontSize,display:"flex",gap:j.spacing(2),marginBottom:j.spacing(2)})});var D=e(67061),P=e(56034);const C=({hasMore:j,canCompare:N,getVersions:F,getDiff:U,isLastPage:w})=>(0,r.jsxs)(D.B,{children:[j&&(0,r.jsx)(a.$n,{type:"button",onClick:()=>F(!0),variant:"secondary",disabled:w,children:"Show more versions"}),(0,r.jsx)(P.m,{content:"Select two versions to start comparing",placement:"bottom",children:(0,r.jsx)(a.$n,{type:"button",disabled:!N,onClick:U,icon:"code-branch",children:"Compare versions"})})]});var M=e(90613),I=e(57418),R=e(19626),T=e(22764),S=e(56596);const L=({baseInfo:j,newInfo:N,diffData:F,isNewLatest:U,onRestore:w})=>{const B=(0,S.G4)(F.lhs,F.rhs),K=(0,g.of)(O);return(0,r.jsxs)(D.B,{direction:"column",gap:1,children:[(0,r.jsxs)(D.B,{justifyContent:"space-between",alignItems:"center",children:[(0,r.jsxs)(D.B,{alignItems:"center",children:[(0,r.jsxs)("span",{className:(0,i.cx)(K.versionInfo,K.noMarginBottom),children:[(0,r.jsxs)("strong",{children:["Version ",j.version]})," updated by ",j.createdBy," ",j.ageString,j.message]}),(0,r.jsx)(h.I,{name:"arrow-right",size:"sm"}),(0,r.jsxs)("span",{className:K.versionInfo,children:[(0,r.jsxs)("strong",{children:["Version ",N.version]})," updated by ",N.createdBy," ",N.ageString,N.message]})]}),U&&(0,r.jsx)(c.$s,{children:({showModal:W,hideModal:z})=>(0,r.jsxs)(a.$n,{variant:"destructive",icon:"history",onClick:()=>{W(m,{version:j,onRestore:w,hideModal:z})},children:["Restore to version ",j.version]})})]}),Object.entries(B).map(([W,z])=>(0,r.jsx)(R.D,{diffs:z,title:W},W)),(0,r.jsx)(M.a,{paddingTop:2,children:(0,r.jsx)(I.M,{isOpen:!1,label:"View JSON Diff",children:(0,r.jsx)(T.M,{oldValue:JSON.stringify(F.lhs,null,2),newValue:JSON.stringify(F.rhs,null,2)})})})]})},O=j=>({versionInfo:(0,i.css)({color:j.colors.text.secondary,fontSize:j.typography.bodySmall.fontSize}),noMarginBottom:(0,i.css)({marginBottom:0})})},56596:(k,A,e)=>{"use strict";e.d(A,{Fl:()=>g,G4:()=>i});var n=e(16111),s=e(25504),l=e(2543),r=e.n(l);const i=(c,a)=>{const p=(0,n.UD)(c,a),u=s.stringify(c,null,2),m=s.stringify(a,null,2),v=E=>E.map(h=>{let y,b,D=0,P=0;const C=(0,l.tail)(h.path.split("/"));return h.op==="replace"&&m.pointers[h.path]&&(y=(0,l.get)(c,C),b=h.value,D=m.pointers[h.path].value.line,P=m.pointers[h.path].valueEnd.line),h.op==="add"&&m.pointers[h.path]&&(b=h.value,D=m.pointers[h.path].value.line,P=m.pointers[h.path].valueEnd.line),h.op==="remove"&&u.pointers[h.path]&&(y=(0,l.get)(c,C),D=u.pointers[h.path].value.line,P=u.pointers[h.path].valueEnd.line),{op:h.op,value:b,path:C,originalValue:y,startLineNumber:D,endLineNumber:P}}),x=E=>(0,l.sortBy)(E,"startLineNumber"),f=E=>E.reduce((h,y)=>{const b=y.path[0];return h[b]||(h[b]=[]),h[b].push(y),h},{});return(0,l.flow)([v,x,f])(p)},g=(c,a=!0)=>{const p=(0,l.last)(c.path),u=o(p),m=c.op==="remove"?c.originalValue:c.value;let v=d(c.op);return a&&(u?v+=` item ${p}`:(0,l.isArray)(m)&&!(0,l.isEmpty)(m)?v+=` ${m.length} ${p}`:v+=` ${p}`),v},o=c=>!(0,l.isNaN)((0,l.toNumber)(c)),d=c=>c==="add"?"added":c==="remove"?"deleted":"changed"},65163:(k,A,e)=>{"use strict";e.d(A,{H:()=>Ut,A:()=>Gt});var n=e(74848),s=e(96540),l=e(13544),r=e(32264),i=e(38138),g=e(10096),o=e(8484),d=e(72254),c=e(22699),a=e(7758),p=e(91119),u=e(32196),m=e(80943),v=e(40845),x=e(67061),f=e(25994),E=e(10534),h=e(55852),y=e(62930),b=e(72686),D=e(4785),P=e(31678),C=e(74730),M=e(94753),I=e(29158),R=e(45014);function T({onConfirm:Lt,onDismiss:At,description:Nt,confirmButtonLabel:Dn,title:An,isActionLoading:Pn}){const Xn=(0,v.of)(S),Tn=()=>(0,n.jsx)("div",{className:Xn.bodyContainer,children:(0,n.jsxs)(x.B,{justifyContent:"space-between",children:[(0,n.jsxs)(x.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(I.K,{size:"xl",name:"angle-left","aria-label":(0,o.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:At}),(0,n.jsx)(M.E,{variant:"h4",children:An})]}),Pn&&(0,n.jsx)(y.y,{})]})});return(0,n.jsx)(R.k,{body:(0,n.jsx)(Tn,{}),description:Nt,confirmButtonLabel:Dn,confirmButtonVariant:"destructive",dismissButtonLabel:(0,o.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:Lt,onDismiss:At})}const S=Lt=>({bodyContainer:(0,u.css)({marginBottom:Lt.spacing(2)})});var L=e(62522),O=e(49785),j=e(84167),N=e(88575),F=e(56034),U=e(14578),w=e(10354),B=e(60029),K=e(54230),W=e(15292);const z=l.Tp.pages.ShareDashboardModal.PublicDashboard;function Y(){const{dashboard:Lt}=(0,L.X)(),[At,{isLoading:Nt}]=(0,b.T2)(),{data:Dn}=b.Sm.endpoints?.getPublicDashboard.useQueryState(Lt.state.uid),An=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite),Pn=Nt||!An,Tn=m.jh.getTimeRange(Lt).useState(),{handleSubmit:ht,setValue:St,control:Ge}=(0,O.mN)({defaultValues:{isAnnotationsEnabled:Dn?.annotationsEnabled,isTimeSelectionEnabled:Dn?.timeSelectionEnabled}}),Ve=async(It,Qe)=>{St(It,Qe),await ht(vt=>lt({...vt,[It]:Qe}))()},lt=It=>{const{isAnnotationsEnabled:Qe,isTimeSelectionEnabled:vt}=It;At({dashboard:Lt,payload:{...Dn,annotationsEnabled:Qe,timeSelectionEnabled:vt}})};return(0,n.jsxs)(x.B,{direction:"column",gap:2,children:[(0,n.jsx)(M.E,{element:"p",children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,n.jsxs)(x.B,{justifyContent:"space-between",children:[(0,n.jsx)("form",{onSubmit:ht(lt),children:(0,n.jsx)(j.n,{disabled:Pn,children:(0,n.jsxs)(x.B,{direction:"column",gap:2,children:[(0,n.jsxs)(x.B,{gap:1,children:[(0,n.jsx)(O.xI,{render:({field:{ref:It,...Qe}})=>(0,n.jsx)(W.d,{...Qe,"data-testid":z.EnableTimeRangeSwitch,onChange:vt=>{a.c.publicDashboardTimeSelectionChanged({enabled:vt.currentTarget.checked}),Ve("isTimeSelectionEnabled",vt.currentTarget.checked)},label:(0,o.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:Ge,name:"isTimeSelectionEnabled"}),(0,n.jsx)(B.J,{description:(0,o.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,n.jsxs)(x.B,{gap:1,children:[(0,n.jsx)(O.xI,{render:({field:{ref:It,...Qe}})=>(0,n.jsx)(W.d,{...Qe,"data-testid":z.EnableAnnotationsSwitch,onChange:vt=>{a.c.publicDashboardAnnotationsSelectionChanged({enabled:vt.currentTarget.checked}),Ve("isAnnotationsEnabled",vt.currentTarget.checked)},label:(0,o.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:Ge,name:"isAnnotationsEnabled"}),(0,n.jsx)(B.J,{style:{flex:1},description:(0,o.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this Dashboard"),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,n.jsxs)(x.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(K.b,{value:Tn.value,showIcon:!0,disabled:!0,onChange:()=>{}}),(0,n.jsx)(F.m,{placement:"right",content:(0,o.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,n.jsx)(U.I,{name:"info-circle",size:"sm"})})]})]})})}),Nt&&(0,n.jsx)(y.y,{})]})]})}var X=e(83122);const q=l.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,G=({onDelete:Lt,onReshare:At})=>(0,n.jsxs)(i.W,{children:[(0,n.jsx)(i.W.Item,{label:(0,o.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:At}),(0,n.jsx)(i.W.Item,{label:(0,o.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:Lt})]}),te=({recipients:Lt,dashboardUid:At,publicDashboard:Nt})=>{const Dn=(0,v.of)(se),[An,{isLoading:Pn}]=(0,b.$L)(),[Xn,{isLoading:Tn}]=(0,b.NA)(),ht=Pn||Tn,St=(Ve,lt)=>{a.c.revokePublicDashboardEmailClicked(),An({recipientUid:Ve,recipientEmail:lt,dashboardUid:At,uid:Nt.uid})},Ge=Ve=>{a.c.resendPublicDashboardEmailClicked(),Xn({recipientUid:Ve,uid:Nt.uid})};return(0,n.jsx)("table",{"data-testid":q.EmailSharingList,className:Dn.table,children:(0,n.jsx)("tbody",{children:Lt.map((Ve,lt)=>(0,n.jsxs)("tr",{className:Dn.listItem,children:[(0,n.jsx)("td",{className:Dn.user,children:(0,n.jsxs)(x.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{className:Dn.icon,children:(0,n.jsx)(U.I,{name:"user"})}),(0,n.jsx)(M.E,{children:Ve.recipient})]})}),(0,n.jsx)("td",{children:ht&&(0,n.jsx)(y.y,{})}),(0,n.jsx)("td",{children:(0,n.jsx)(X.m,{overlay:(0,n.jsx)(G,{onDelete:()=>St(Ve.uid,Ve.recipient),onReshare:()=>Ge(Ve.uid)}),children:(0,n.jsx)(I.K,{name:"ellipsis-v","aria-label":"email-menu",variant:"secondary",size:"lg"})})})]},Ve.uid))})})},H=({dashboard:Lt})=>{const At=(0,v.of)(se),{data:Nt}=b.Sm.endpoints?.getPublicDashboard.useQueryState(Lt.state.uid);return(0,n.jsx)(N.D,{label:(0,o.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,o.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:At.listField,children:Nt?.recipients?.length?(0,n.jsx)("div",{className:At.listContainer,children:(0,n.jsx)(te,{recipients:Nt.recipients,dashboardUid:Lt.state.uid,publicDashboard:Nt})}):(0,n.jsx)(n.Fragment,{})})},se=Lt=>({listField:(0,u.css)({marginBottom:0}),listContainer:(0,u.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,u.css)({width:"100%"}),listItem:(0,u.css)({display:"flex",alignItems:"center",gap:Lt.spacing(.5),padding:Lt.spacing(.75,1),color:Lt.colors.text.secondary}),user:(0,u.css)({flex:1}),icon:(0,u.css)({border:`${Lt.spacing(.25)} solid ${Lt.colors.text.secondary}`,padding:Lt.spacing(.125,.5),borderRadius:Lt.shape.radius.circle,color:Lt.colors.text.secondary})}),ne=l.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,le=()=>{const{dashboard:Lt}=(0,L.X)(),{data:At,isError:Nt}=b.Sm.endpoints?.getPublicDashboard.useQueryState(Lt.state.uid),[Dn,{isLoading:An}]=(0,b.NY)(),Pn=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite),{register:Xn,handleSubmit:Tn,formState:{errors:ht,isValid:St},reset:Ge}=(0,O.mN)({defaultValues:{email:""},mode:"onSubmit"}),Ve=async lt=>{a.c.publicDashboardEmailInviteClicked(),await Dn({recipient:lt.email,uid:At.uid,dashboardUid:Lt.state.uid}).unwrap(),Ge({email:""})};return(0,n.jsxs)("div",{children:[(0,n.jsx)("form",{onSubmit:Tn(Ve),children:(0,n.jsx)(j.n,{disabled:!Pn||Nt,children:(0,n.jsx)(N.D,{label:(0,n.jsxs)(x.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,n.jsx)(F.m,{placement:"right",content:(0,o.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,n.jsx)(U.I,{name:"info-circle",size:"sm"})})]}),description:(0,o.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:ht.email?.message,invalid:!!ht.email?.message,children:(0,n.jsxs)(x.B,{direction:"row",children:[(0,n.jsx)(w.p,{placeholder:(0,o.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:An,...Xn("email",{required:(0,o.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:d._l,message:(0,o.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":ne.EmailSharingInput}),(0,n.jsx)(h.$n,{type:"submit",variant:"primary",disabled:An||!St,"data-testid":ne.EmailSharingInviteButton,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,n.jsx)(H,{dashboard:Lt}),(0,n.jsx)(f.c,{}),(0,n.jsx)(Y,{})]})};var _=e(10880),Q=e(42418);const ae="https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/#email-sharing";function oe(){return(0,n.jsx)(Q.F,{title:"",severity:"info",bottomSpacing:0,children:(0,n.jsxs)(x.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:()=>window.open(ae,"_blank"),type:"button",children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const J=({hasError:Lt})=>{const{dashboard:At}=(0,L.X)(),Nt=(0,v.of)(ee),[Dn,{isLoading:An,isError:Pn}]=(0,b.U9)(),Xn=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite),Tn=!Xn||An||Pn||Lt,{handleSubmit:ht,register:St,formState:{isValid:Ge}}=(0,O.mN)({mode:"onChange"}),Ve=()=>{a.c.generatePublicDashboardUrlClicked({share:d.Xo.EMAIL}),Dn({dashboard:At,payload:{share:d.Xo.EMAIL,isEnabled:!0}})};return(0,n.jsxs)(n.Fragment,{children:[Xn&&(0,n.jsx)(oe,{}),(0,n.jsx)("form",{onSubmit:ht(Ve),children:(0,n.jsxs)(j.n,{disabled:Tn,children:[(0,n.jsx)("div",{className:Nt.checkbox,children:(0,n.jsx)(_.S,{...St("billAcknowledgment",{required:!0}),label:(0,o.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,n.jsxs)(x.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(h.$n,{type:"submit",disabled:!Ge,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:()=>At.closeModal(),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),An&&(0,n.jsx)(y.y,{})]})]})})]})},ee=Lt=>({checkbox:(0,u.css)({marginBottom:Lt.spacing(2)})}),de=()=>{const{dashboard:Lt}=(0,L.X)(),{data:At,isError:Nt}=b.Sm.endpoints?.getPublicDashboard.useQueryState(Lt.state.uid);return(0,n.jsx)(n.Fragment,{children:At?(0,n.jsx)(le,{}):(0,n.jsx)(J,{hasError:Nt})})},xe="https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",re=()=>(0,n.jsx)(Q.F,{title:"",severity:"info",bottomSpacing:0,children:(0,n.jsxs)(x.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:()=>window.open(xe,"_blank"),type:"button",children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})});function ue({hasError:Lt}){const{dashboard:At}=(0,L.X)(),Nt=(0,v.of)(Te),Dn=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite),{handleSubmit:An,register:Pn,formState:{isValid:Xn}}=(0,O.mN)({mode:"onChange"}),[Tn,{isLoading:ht,isError:St}]=(0,b.U9)(),Ge=()=>{a.c.generatePublicDashboardUrlClicked({share:d.Xo.PUBLIC}),Tn({dashboard:At,payload:{share:d.Xo.PUBLIC,isEnabled:!0}})},Ve=!Dn||ht||St||Lt;return(0,n.jsxs)(n.Fragment,{children:[Dn&&(0,n.jsx)(re,{}),(0,n.jsx)("form",{onSubmit:An(Ge),children:(0,n.jsxs)(j.n,{disabled:Ve,children:[(0,n.jsx)("div",{className:Nt.checkbox,children:(0,n.jsx)(_.S,{...Pn("publicAcknowledgment",{required:!0}),label:(0,o.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*")})}),(0,n.jsxs)(x.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(h.$n,{type:"submit",disabled:!Xn,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:()=>At.closeModal(),children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),ht&&(0,n.jsx)(y.y,{})]})]})})]})}const Te=Lt=>({checkbox:(0,u.css)({marginBottom:Lt.spacing(2)})});function ge(){const{dashboard:Lt}=(0,L.X)(),{data:At,isError:Nt}=b.Sm.endpoints?.getPublicDashboard.useQueryState(Lt.state.uid);return(0,n.jsx)(n.Fragment,{children:At?(0,n.jsx)(Y,{}):(0,n.jsx)(ue,{hasError:Nt})})}var Oe=e(12257),Ue=e(10872),Xe=e(29304),we=e(59995);function qe({publicDashboard:Lt}){const{dashboard:At}=(0,L.X)(),Nt=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite),Dn=(0,we.b)(At),An=(At.state.$variables?.state.variables.length??0)>0;return(0,n.jsxs)(n.Fragment,{children:[Nt&&An&&(0,n.jsx)(Ue.D,{showDescription:!1}),!Nt&&(0,n.jsx)(Xe.t,{mode:Lt?"edit":"create"}),Nt&&!!Dn?.length&&(0,n.jsx)(Oe.s,{unsupportedDataSources:Dn.join(", ")}),Lt?.share===d.Xo.EMAIL&&(0,d.AY)()&&(0,n.jsx)(oe,{})]})}var We=e(8887),Ce=e(90182);const je=l.Tp.pages.ShareDashboardDrawer.ShareExternally;function Ke({setShareType:Lt,options:At,value:Nt}){const{dashboard:Dn}=(0,L.X)(),An=(0,v.of)(_e),{data:Pn}=b.Sm.endpoints?.getPublicDashboard.useQueryState(Dn.state.uid),[Xn,{isLoading:Tn}]=(0,b.ft)(),ht=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite),St=at(),Ge=Ve=>{if(!Pn)return;a.c.publicDashboardShareTypeChange({shareType:Ve===d.Xo.EMAIL?"email":"public"});const lt={dashboard:Dn,payload:{...Pn,share:Ve}};Xn(lt)};return(0,n.jsxs)("div",{children:[(0,n.jsxs)(x.B,{justifyContent:"space-between",children:[(0,n.jsx)(B.J,{description:Nt.description,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),Tn&&(0,n.jsx)(y.y,{})]}),(0,d.AY)()?(0,n.jsx)(Ce.l6,{"data-testid":je.shareTypeSelect,options:At,value:Nt,disabled:!ht,onChange:Ve=>{Lt(Ve),Ge(Ve.value)},className:An.select}):(0,n.jsxs)(n.Fragment,{children:[(0,We.Uo)(St.icon)&&(0,n.jsx)(U.I,{name:(0,We.Uo)(St.icon)}),(0,n.jsx)(M.E,{children:St.label})]})]})}const _e=()=>({select:(0,u.css)({flex:1})}),Fe=l.Tp.pages.ShareDashboardDrawer.ShareExternally,at=()=>({label:(0,o.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,o.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:d.Xo.PUBLIC,icon:"globe"}),Ct=()=>({label:(0,o.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,o.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:d.Xo.EMAIL,icon:"users-alt"}),Dt=()=>(0,d.AY)()?[Ct(),at()]:[at()];class tt extends m.Bs{static{this.Component=ze}}function ze({model:Lt}){const[At,Nt]=(0,s.useState)(!1),Dn=(0,v.of)(fe),An=(0,C.YQ)(Lt),{data:Pn,isLoading:Xn}=(0,b.Bs)(An.state.uid),[Tn,{isLoading:ht}]=(0,b.bN)(),St=()=>{Nt(!0)},Ge=async()=>{a.c.revokePublicDashboardClicked(),await Tn({dashboard:An,uid:Pn.uid,dashboardUid:An.state.uid}).unwrap(),Nt(!1)};return Xn?(0,n.jsx)(D.a,{}):At?(0,n.jsx)(T,{title:(0,o.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,o.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:Ge,onDismiss:()=>Nt(!1),description:(0,o.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:ht}):(0,n.jsx)("div",{className:Dn.container,children:(0,n.jsx)(pe,{publicDashboard:Pn,onRevokeClick:St})})}function pe({publicDashboard:Lt,onRevokeClick:At}){const Nt=Dt(),Dn=(0,s.useMemo)(()=>Lt&&(0,d.AY)()?Nt.find(ht=>ht.value===Lt?.share)??Nt[0]:Nt[0],[Lt,Nt]),[An,Pn]=(0,s.useState)(Dn),Xn=(0,s.useMemo)(()=>An.value===d.Xo.EMAIL&&(0,d.AY)()?(0,n.jsx)(de,{}):(0,n.jsx)(ge,{}),[An]);return(0,n.jsxs)(x.B,{direction:"column",gap:2,"data-testid":Fe.container,children:[(0,n.jsx)(qe,{publicDashboard:Lt}),(0,n.jsx)(Ke,{setShareType:Pn,value:An,options:Nt}),Xn,Lt&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.c,{spacing:0}),(0,n.jsx)(Se,{publicDashboard:Lt,onRevokeClick:At})]})]})}function Se({publicDashboard:Lt,onRevokeClick:At}){const{dashboard:Nt}=(0,L.X)(),[Dn,{isLoading:An}]=(0,b.eq)(),Pn=(0,v.of)(fe),Xn=g.contextSrv.hasPermission(P.AccessControlAction.DashboardsPublicWrite);function Tn(){a.c.publicDashboardUrlCopied()}const ht=async()=>{a.c.publicDashboardPauseSharingClicked({paused:!Lt.isEnabled}),Dn({dashboard:Nt,payload:{...Lt,isEnabled:!Lt.isEnabled}})};return(0,n.jsxs)(x.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,n.jsx)("div",{className:Pn.actionsContainer,children:(0,n.jsxs)(x.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(E.b,{"data-testid":Fe.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,d.mL)(Lt.accessToken),onClipboardCopy:Tn,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,n.jsx)(h.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:An||!Xn,onClick:At,children:(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,n.jsx)(h.$n,{icon:Lt.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:Lt.isEnabled?(0,o.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:ht,disabled:An||!Xn,children:Lt.isEnabled?(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,n.jsx)(o.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),An&&(0,n.jsx)(y.y,{})]})}const fe=Lt=>({container:(0,u.css)({paddingBottom:Lt.spacing(2)}),actionsContainer:(0,u.css)({width:"100%"})});var Ee=e(95007),Pe=e(58398),he=e(70439);class be extends Pe.R{static{this.Component=Ae}constructor(At){const{useAbsoluteTimeRange:Nt,useShortUrl:Dn,theme:An}=(0,he.yk)();super({...At,useLockedTime:Nt,useShortUrl:Dn,selectedTheme:An}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}async onToggleLockedTime(){const At=!this.state.useLockedTime;(0,he.F7)({useAbsoluteTimeRange:At,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const At=!this.state.useShortUrl;(0,he.F7)({useShortUrl:At,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(At){(0,he.F7)({theme:At,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(At)}}function Ae({model:Lt}){const At=(0,v.of)(De),{useLockedTime:Nt,useShortUrl:Dn,selectedTheme:An,isBuildUrlLoading:Pn}=Lt.useState();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q.F,{severity:"info",title:(0,o.t)("link.share.config-alert-title","Link configuration"),children:(0,n.jsx)(o.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes."})}),(0,n.jsx)("div",{className:At.configDescription,children:(0,n.jsx)(M.E,{variant:"body",children:(0,n.jsx)(o.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,n.jsx)(Ee.A,{useLockedTime:Nt,onToggleLockedTime:Lt.onToggleLockedTime,useShortUrl:Dn,onUrlShorten:Lt.onUrlShorten,selectedTheme:An,onChangeTheme:Lt.onThemeChange,isLoading:Pn}),(0,n.jsx)(f.c,{spacing:1}),(0,n.jsx)(E.b,{icon:"link",variant:"primary",fill:"outline",disabled:Pn,getText:Lt.getShareUrl,onClipboardCopy:Lt.onCopy,className:At.copyButtonContainer,children:(0,n.jsx)(o.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})]})}const De=Lt=>({configDescription:(0,u.css)({marginBottom:Lt.spacing(2)}),copyButtonContainer:(0,u.css)({marginTop:Lt.spacing(2)})});var Ie=e(5805),ke=e(12962),dt=e(94354),Pt=e(72109),pt=e(76412);const Tt="https://grafana.com/docs/grafana/latest/dashboards/share-dashboards-panels/#publish-a-snapshot";function jt({name:Lt,onNameChange:At,onExpireChange:Nt,selectedExpireOption:Dn,sharingOptions:An,onCancelClick:Pn,onCreateClick:Xn,isLoading:Tn}){const ht=(0,v.of)($t);return(0,n.jsxs)("div",{className:ht.container,children:[(0,n.jsx)(Q.F,{severity:"info",title:"",children:(0,n.jsxs)(x.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(M.E,{children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:()=>window.open(Tt,"_blank"),type:"button",children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,n.jsx)(N.D,{label:(0,pt.t)("snapshot.share.name-label","Snapshot name*"),children:(0,n.jsx)(w.p,{id:"snapshot-name-input",defaultValue:Lt,onBlur:St=>At(St.target.value)})}),(0,n.jsx)(N.D,{label:(0,pt.t)("snapshot.share.expiration-label","Expires in"),children:(0,n.jsx)(dt.z,{id:"expire-select-input",options:(0,ke.u)(),value:Dn?.value,onChange:Nt})}),(0,n.jsx)(f.c,{}),(0,n.jsxs)(x.B,{justifyContent:"space-between",direction:{xs:"column",xl:"row"},children:[(0,n.jsxs)(x.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(h.$n,{variant:"primary",disabled:Tn,onClick:()=>Xn(),children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),An?.externalEnabled&&(0,n.jsx)(h.$n,{variant:"secondary",disabled:Tn,onClick:()=>Xn(!0),children:An?.externalSnapshotName}),(0,n.jsx)(h.$n,{variant:"secondary",fill:"outline",onClick:Pn,children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),Tn&&(0,n.jsx)(y.y,{})]}),(0,n.jsx)(Pt.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",children:(0,pt.t)("snapshot.share.view-all-button","View all snapshots")})]})]})}const $t=Lt=>({container:(0,u.css)({paddingBottom:Lt.spacing(2)})}),sn=({url:Lt,onDeleteClick:At,onNewSnapshotClick:Nt})=>(0,n.jsxs)(x.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(E.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>Lt,children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,n.jsx)(h.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:At,children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,n.jsx)(h.$n,{variant:"secondary",fill:"solid",onClick:Nt,children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]}),Yt=l.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class qt extends ke.l{static{this.Component=bn}}function bn({model:Lt}){const[At,Nt]=(0,s.useState)(!1),[Dn,An]=(0,s.useState)(!1),[Pn,Xn]=(0,s.useState)(1),{snapshotName:Tn,snapshotSharingOptions:ht,selectedExpireOption:St,dashboardRef:Ge}=Lt.useState(),[Ve,lt]=(0,Ie.default)(async(Ot=!1)=>{const zt=await Lt.onSnapshotCreate(Ot);return Xn(2),zt}),[It,Qe]=(0,Ie.default)(async Ot=>{const zt=await Lt.onSnapshotDelete(Ot);return Xn(1),Nt(!1),An(!0),zt}),vt=()=>{Ge.resolve().closeModal()};return At?(0,n.jsx)(T,{title:(0,o.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,o.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:()=>Qe(Ve.value?.deleteUrl),onDismiss:()=>Nt(!1),description:(0,o.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:It.loading}):(0,n.jsxs)("div",{"data-testid":Yt.container,children:[Pn===1&&(0,n.jsxs)(n.Fragment,{children:[Dn&&(0,n.jsx)(Q.F,{severity:"info",title:"",onRemove:()=>An(!1),children:(0,n.jsx)(o.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Your snapshot has been deleted. It might take up to an hour before the snapshot is cleared from any CDN caches."})}),(0,n.jsx)(jt,{name:Tn??"",selectedExpireOption:St,sharingOptions:ht,onNameChange:Lt.onSnasphotNameChange,onCancelClick:vt,onExpireChange:Lt.onExpireChange,onCreateClick:lt,isLoading:Ve.loading})]}),Pn===2&&(0,n.jsx)(sn,{url:Ve.value.url,onDeleteClick:()=>Nt(!0),onNewSnapshotClick:()=>Xn(1)})]})}const Mt=l.Tp.pages.Dashboard.DashNav.newShareButton.menu,Jt=[];function Ut(Lt){Jt.push(Lt)}function Gt({dashboard:Lt,panel:At}){const Nt=(0,s.useCallback)((Pn,Xn)=>{const Tn=new p.j({title:Pn,body:new Xn({dashboardRef:Lt.getRef(),panelRef:At?.getRef()})});Lt.showModal(Tn)},[Lt,At]),Dn=(0,s.useCallback)(()=>{const Pn=[];return Pn.push({shareId:c.wr.link,testId:Mt.shareInternally,icon:"building",label:(0,o.t)("share-dashboard.menu.share-internally-title","Share internally"),description:(0,o.t)("share-dashboard.menu.share-internally-description","Advanced settings"),renderCondition:!0,onClick:()=>Nt((0,o.t)("share-dashboard.menu.share-internally-title","Share internally"),be)}),Pn.push({shareId:c.wr.publicDashboard,testId:Mt.shareExternally,icon:"share-alt",label:(0,o.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!At&&(0,d.iR)(),onClick:()=>{Nt((0,o.t)("share-dashboard.menu.share-externally-title","Share externally"),tt)}}),Jt.forEach(Xn=>Pn.push(Xn)),Pn.push({shareId:c.wr.snapshot,testId:Mt.shareSnapshot,icon:"camera",label:(0,o.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:g.contextSrv.isSignedIn&&r.$.snapshotEnabled&&Lt.canEditDashboard(),onClick:()=>{Nt((0,o.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),qt)}}),Pn.filter(Xn=>Xn.renderCondition)},[Nt,Lt,At]),An=Pn=>{a.c.sharingCategoryClicked({item:Pn.shareId,shareResource:(0,c.hD)(At?.getRef())}),Pn.onClick(Lt)};return(0,n.jsx)(i.W,{"data-testid":Mt.container,children:Dn().map(Pn=>(0,n.jsx)(i.W.Item,{testId:Pn.testId,label:Pn.label,icon:Pn.icon,description:Pn.description,onClick:()=>An(Pn)},Pn.label))})}},70439:(k,A,e)=>{"use strict";e.d(A,{F7:()=>c,Xe:()=>g,yk:()=>d});var n=e(7030),s=e(22699),l=e(33390),r=e(7758);const i={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},g=async(a,p)=>{const{useAbsoluteTimeRange:u,useShortUrl:m,theme:v}=d();return r.c.shareLinkCopied({currentTimeRange:u,theme:v,shortenURL:m,shareResource:(0,s.hD)(p?.getRef())}),await(0,n.Sp)(a,{useAbsoluteTimeRange:u,theme:v,useShortUrl:m})},o="grafana.dashboard.link.shareConfiguration";function d(){return l.A.exists(o)&&l.A.getObject(o)||i}function c(a){l.A.setObject(o,a)}},91119:(k,A,e)=>{"use strict";e.d(A,{j:()=>g});var n=e(74848),s=e(80943),l=e(87978),r=e(74730),i=e(62522);class g extends s.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,r.YQ)(this).closeModal()}}static{this.Component=o}}function o({model:d}){const{title:c,body:a}=d.useState(),p=(0,r.YQ)(d);return(0,n.jsx)(l._,{title:c,onClose:d.onDismiss,size:"md",children:(0,n.jsx)(i.A.Provider,{value:{dashboard:p},children:(0,n.jsx)(a.Component,{model:a})})})}},62522:(k,A,e)=>{"use strict";e.d(A,{A:()=>s,X:()=>l});var n=e(96540);const s=(0,n.createContext)(void 0),l=()=>{const r=(0,n.useContext)(s);if(r===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return r}},50056:(k,A,e)=>{"use strict";e.d(A,{N:()=>P});var n=e(74848),s=e(4213),l=e.n(s),r=e(16817),i=e(70713),g=e(80943),o=e(67061),d=e(88575),c=e(15292),a=e(37390),p=e(55852),u=e(32372),m=e(10534),v=e(8484),x=e(15858),f=e(22699),E=e(34214),h=e(20455),y=e(73788),b=e(7758),D=e(74730);class P extends g.Bs{constructor(I){super({isSharingExternally:!1,isViewingJSON:!1,...I}),this.tabId=f.wr.export,this._exporter=new x.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:R}=this.state,T=(0,h.Uy)((0,D.YQ)(this));return R?await this._exporter.makeExportable(new E.G(T,void 0,{getVariablesFromState:()=>(0,y.E)(window.__grafanaSceneContext)})):T},this.onSaveAsFile=async()=>{const R=await this.getExportableDashboardJson(),T=JSON.stringify(R,null,2),{isSharingExternally:S}=this.state,L=new Blob([T],{type:"application/json;charset=utf-8"}),O=new Date().getTime();let j="dashboard";"title"in R&&R.title&&(j=R.title),l()(L,`${j}-${O}.json`),b.c.exportDownloadJsonClicked({externally:S})}}static{this.Component=C}getTabLabel(){return(0,v.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function C({model:M}){const{isSharingExternally:I,isViewingJSON:R,modalRef:T}=M.useState(),S=(0,r.A)(async()=>{if(R){const O=await M.getExportableDashboardJson();return JSON.stringify(O,null,2)}return""},[R]),L=(0,v.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,n.jsxs)(n.Fragment,{children:[!R&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,n.jsx)(o.B,{gap:2,direction:"column",children:(0,n.jsx)(d.D,{label:L,children:(0,n.jsx)(c.d,{id:"share-externally-toggle",value:I,onChange:M.onShareExternallyChange})})}),(0,n.jsxs)(a.a.ButtonRow,{children:[(0,n.jsx)(p.$n,{variant:"secondary",onClick:()=>{T?.resolve().onDismiss()},fill:"outline",children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,n.jsx)(p.$n,{variant:"secondary",icon:"brackets-curly",onClick:M.onViewJSON,children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,n.jsx)(p.$n,{variant:"primary",icon:"save",onClick:()=>M.onSaveAsFile(),children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),R&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Ay,{disableHeight:!0,children:({width:O})=>S.value?(0,n.jsx)(u.B,{value:S.value??"",language:"json",showMiniMap:!1,height:"500px",width:O}):S.loading?(0,n.jsx)("div",{children:"Loading..."}):null}),(0,n.jsxs)(a.a.ButtonRow,{children:[(0,n.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:M.onViewJSON,icon:"arrow-left",children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,n.jsx)(m.b,{variant:"secondary",icon:"copy",disabled:S.loading,getText:()=>S.value??"",children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,n.jsx)(p.$n,{variant:"primary",icon:"save",disabled:S.loading,onClick:()=>M.onSaveAsFile(),children:(0,n.jsx)(v.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},95007:(k,A,e)=>{"use strict";e.d(A,{A:()=>d});var n=e(74848),s=e(67061),l=e(15292),r=e(60029),i=e(62930),g=e(8484),o=e(87895);function d({useLockedTime:c,onToggleLockedTime:a,useShortUrl:p,onUrlShorten:u,onChangeTheme:m,selectedTheme:v,isLoading:x}){return(0,n.jsxs)(s.B,{justifyContent:"space-between",children:[(0,n.jsxs)(s.B,{gap:2,direction:"column",children:[(0,n.jsxs)(s.B,{gap:1,direction:"column",children:[(0,n.jsxs)(s.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(l.d,{label:(0,g.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:c,onChange:a}),(0,n.jsx)(r.J,{description:(0,g.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,n.jsx)(g.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,n.jsxs)(s.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(l.d,{id:"share-short-url",value:p,label:(0,g.t)("link.share.short-url-label","Shorten link"),onChange:u}),(0,n.jsx)(r.J,{children:(0,n.jsx)(g.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,n.jsx)(o.w,{selectedTheme:v,onChange:m})]}),x&&(0,n.jsx)(i.y,{})]})}},58398:(k,A,e)=>{"use strict";e.d(A,{R:()=>b});var n=e(74848),s=e(47232),l=e(13544),r=e(32264),i=e(80943),g=e(84167),o=e(88575),d=e(15292),c=e(10354),a=e(10534),p=e(14578),u=e(42418),m=e(8484),v=e(7030),x=e(87895),f=e(22699),E=e(7758),h=e(11982),y=e(74730);class b extends i.Bs{constructor(M){super({...M,useLockedTime:M.useLockedTime??!0,useShortUrl:M.useShortUrl??!1,selectedTheme:M.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=f.wr.link,this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{E.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,f.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=D}async buildUrl(){this.setState({isBuildUrlLoading:!0});const{panelRef:M,useLockedTime:I,useShortUrl:R,selectedTheme:T}=this.state,S=(0,y.YQ)(this),L=M?.resolve(),O={useAbsoluteTimeRange:I,theme:T,useShortUrl:R};let j=(0,v.VN)(S,O,L);R&&(j=await(0,v.fn)(j));const N=i.jh.getTimeRange(L??S),F=(0,v.$l)(O,N,L);let U=F;L&&(delete U.viewPanel,U.panelId=L.state.key,U["__feature.dashboardSceneSolo"]=!0);const w=(0,h.uZ)({uid:S.state.uid,currentQueryParams:location.search,updateQuery:{...F,panelId:L?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:P(N.getTimeZone())});this.setState({shareUrl:j,imageUrl:w,isBuildUrlLoading:!1})}getTabLabel(){return(0,m.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const M=!this.state.useLockedTime;this.setState({useLockedTime:M}),await this.buildUrl()}async onUrlShorten(){const M=!this.state.useShortUrl;this.setState({useShortUrl:M}),await this.buildUrl()}async onThemeChange(M){this.setState({selectedTheme:M}),await this.buildUrl()}}function D({model:C}){const M=C.useState(),{panelRef:I}=M,R=(0,y.YQ)(C),T=I?.resolve(),L=i.jh.getTimeRange(T??R).state.to==="now",{useLockedTime:O,useShortUrl:j,selectedTheme:N,shareUrl:F,imageUrl:U}=M,w=l.Tp.pages.SharePanelModal,B=!!R.state.uid,K=(0,m.t)("share-modal.link.time-range-label","Lock time range"),W=(0,m.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),z=(0,m.t)("share-modal.link.shorten-url","Shorten URL"),Y=(0,m.t)("share-modal.link.link-url","Link URL");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,n.jsxs)(g.n,{children:[(0,n.jsx)(o.D,{label:K,description:L?W:"",children:(0,n.jsx)(d.d,{id:"share-current-time-range",value:O,onChange:C.onToggleLockedTime})}),(0,n.jsx)(x.w,{selectedTheme:N,onChange:C.onThemeChange}),(0,n.jsx)(o.D,{label:z,children:(0,n.jsx)(d.d,{id:"share-shorten-url",value:j,onChange:C.onUrlShorten})}),(0,n.jsx)(o.D,{label:Y,children:(0,n.jsx)(c.p,{id:"link-url-input",value:F,readOnly:!0,addonAfter:(0,n.jsx)(a.b,{icon:"copy",variant:"primary",getText:C.getShareUrl,onClipboardCopy:C.onCopy,children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),T&&r.$.rendererAvailable&&(0,n.jsxs)(n.Fragment,{children:[B&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsxs)("a",{href:U,target:"_blank",rel:"noreferrer","aria-label":w.linkToRenderedImage,children:[(0,n.jsx)(p.I,{name:"camera"}),"\xA0",(0,n.jsx)(m.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!B&&(0,n.jsx)(u.F,{severity:"info",title:(0,m.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(m.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),T&&!r.$.rendererAvailable&&(0,n.jsx)(u.F,{severity:"info",title:(0,m.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(m.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function P(C){const M="UTC"+encodeURIComponent((0,s.KQ)().format("Z"));if(C==="utc")return"UTC";if(C==="browser"){if(!window.Intl)return M;const R=window.Intl.DateTimeFormat().resolvedOptions();return R.timeZone?R.timeZone:M}return C}},85174:(k,A,e)=>{"use strict";e.d(A,{Z:()=>ne,m:()=>se});var n=e(74848),s=e(32264),l=e(80943),r=e(25897),i=e(37390),g=e(40980),o=e(10096),d=e(8484),c=e(72254),a=e(22699),p=e(60656),u=e(7758),m=e(74730),v=e(50056),x=e(86394),f=e(34214),E=e(41507),h=e(20455);class y extends l.Bs{constructor(){super(...arguments),this.tabId=a.wr.libraryPanel}static{this.Component=b}getTabLabel(){return(0,d.t)("share-modal.tab-title.library-panel","Library panel")}}function b({model:_}){const{panelRef:Q,modalRef:ae}=_.useState();if(!Q)return null;const oe=Q.resolve(),J=oe.parent;if(J instanceof E.U){const ee=(0,m.YQ)(_),de=(0,h.ZB)(J),xe=new f.a(de),re=(0,h.Uy)(ee),ue=new f.G(re);return(0,n.jsx)(x.j,{initialFolderUid:ee.state.meta.folderUid,dashboard:ue,panel:xe,onDismiss:()=>{ae?.resolve().onDismiss()},onCreateLibraryPanel:Te=>ee.createLibraryPanel(oe,Te)})}return null}var D=e(58398),P=e(35280),C=e(7928),M=e(11982);class I extends l.Bs{constructor(Q){super(Q),this.tabId=a.wr.embed}static{this.Component=R}getTabLabel(){return(0,d.t)("share-modal.tab-title.panel-embed","Embed")}}function R({model:_}){const{panelRef:Q}=_.useState(),ae=Q.resolve(),oe=(0,m.YQ)(_),{uid:J}=oe.useState(),ee=(0,m.Cs)(ae),de=l.jh.getTimeRange(ae),xe=de instanceof C.v?de.state.timeFrom:void 0;return(0,n.jsx)(P.D,{panel:{id:ee,timeFrom:xe},range:de.state.value,dashboard:{uid:J??"",time:de.state.value},buildIframe:T(oe)})}const T=_=>(Q,ae,oe,J,ee)=>{const de=(0,a.XV)({useCurrentTimeRange:Q,selectedTheme:oe,panel:J,range:ee}),xe=de.get("editPanel")??de.get("viewPanel")??"";return de.set("panelId",xe),de.delete("editPanel"),de.delete("viewPanel"),de.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,M.uZ)({absolute:!0,soloRoute:!0,uid:_.state.uid,slug:_.state.meta.slug,currentQueryParams:de.toString()})}" width="450" height="200" frameborder="0"></iframe>`};var S=e(12962),L=e(72686),O=e(4785),j=e(32196),N=e(40845),F=e(59037),U=e(31678),w=e(96374);class B extends l.Bs{static{this.Component=K}constructor(Q){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...Q})}onDismiss(){}}function K({model:_}){const Q=_.useState();return(0,n.jsx)(w.u,{...Q})}var W=e(59995);function z({model:_,publicDashboard:Q,isGetLoading:ae}){const oe=(0,N.of)(Y),J=o.contextSrv.hasPermission(U.AccessControlAction.DashboardsPublicWrite),ee=(0,m.YQ)(_),{isDirty:de}=ee.useState(),[xe]=(0,L.bN)(),re=(ee.state.$variables?.state.variables.length??0)>0,ue=(0,W.b)(ee),ge=l.jh.getTimeRange(_).useState();return(0,n.jsx)(F.b,{dashboard:ee,publicDashboard:Q,unsupportedDatasources:ue,onRevoke:()=>{ee.showModal(new B({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:(0,n.jsx)("p",{className:oe.description,children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."}),onDismiss:()=>{ee.showModal(new ne({activeTab:a.wr.publicDashboard}))},onConfirm:()=>{xe({dashboard:ee,dashboardUid:ee.state.uid,uid:Q.uid}),ee.closeModal()}}))},timeRange:ge.value,showSaveChangesAlert:J&&de,hasTemplateVariables:re})}const Y=_=>({description:(0,j.css)({fontSize:_.typography.body.fontSize})});var X=e(22234);function q({model:_}){const Q=(0,m.YQ)(_),ae=(0,W.b)(Q),oe=(Q.state.$variables?.state.variables.length??0)>0;return(0,n.jsx)(X.D,{dashboard:Q,unsupportedDatasources:ae,unsupportedTemplateVariables:oe})}class G extends l.Bs{constructor(){super(...arguments),this.tabId=a.wr.publicDashboard}static{this.Component=te}getTabLabel(){return(0,d.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function te({model:_}){const{data:Q,isLoading:ae}=(0,L.Bs)((0,m.YQ)(_).state.uid);return(0,n.jsx)(n.Fragment,{children:ae?(0,n.jsx)(O.a,{}):(0,c.lI)(Q)?(0,n.jsx)(z,{model:_,publicDashboard:Q,isGetLoading:ae}):(0,n.jsx)(q,{model:_})})}const H=[];function se(_){H.push(_)}class ne extends l.Bs{constructor(Q){super({activeTab:"link",...Q}),this.onDismiss=()=>{(0,m.YQ)(this).closeModal()},this.onChangeTab=ae=>{u.c.sharingCategoryClicked({item:ae.value,shareResource:(0,a.hD)(this.state.panelRef)}),this.setState({activeTab:ae.value})},this.addActivationHandler(()=>this.buildTabs())}static{this.Component=le}buildTabs(){const{panelRef:Q}=this.state,ae=this.getRef(),oe=[new D.R({panelRef:Q,modalRef:ae})],J=(0,m.YQ)(this);if(Q||oe.push(new v.N({modalRef:ae})),o.contextSrv.isSignedIn&&s.$.snapshotEnabled&&J.canEditDashboard()&&oe.push(new S.l({panelRef:Q,dashboardRef:J.getRef(),modalRef:ae})),Q){oe.push(new I({panelRef:Q}));const ee=Q.resolve(),de=ee.parent instanceof p.F;ee instanceof l.Eb&&(de||oe.push(new y({panelRef:Q,modalRef:ae})))}Q||(oe.push(...H.map(ee=>new ee({modalRef:ae}))),(0,c.iR)()&&oe.push(new G({modalRef:ae}))),this.setState({tabs:oe})}}function le({model:_}){const{panelRef:Q,tabs:ae,activeTab:oe}=_.useState(),J=Q?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share");if(!ae)return;const ee=ae?.map(re=>({label:re.getTabLabel(),value:re.tabId})),de=(0,n.jsx)(r.J,{title:J,icon:"share-alt",tabs:ee,activeTab:oe,onChangeTab:_.onChangeTab}),xe=ae.find(re=>re.tabId===oe);return(0,n.jsx)(i.a,{isOpen:!0,title:de,onDismiss:_.onDismiss,children:(0,n.jsx)(g.J,{children:xe&&(0,n.jsx)(xe.Component,{model:xe})})})}},12962:(k,A,e)=>{"use strict";e.d(A,{l:()=>M,u:()=>P});var n=e(74848),s=e(5805),l=e(13544),r=e(17172),i=e(80943),g=e(88575),o=e(10354),d=e(94354),c=e(37390),a=e(55852),p=e(67061),u=e(10534),m=e(82467),v=e(3169),x=e(8484),f=e(22699),E=e(69064),h=e(99140),y=e(20455),b=e(7758);const D=l.Tp.pages.ShareDashboardModal.SnapshotScene,P=()=>{const R={label:(0,x.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,x.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,x.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},R,{label:(0,x.t)("share-modal.snapshot.expire-never","Never"),value:0}]},C=()=>P()[2];class M extends i.Bs{constructor(T){super({...T,snapshotName:T.dashboardRef.resolve().state.title,selectedExpireOption:C()}),this.tabId=f.wr.snapshot,this.onSnasphotNameChange=S=>{this.setState({snapshotName:S.trim()})},this.onExpireChange=S=>{this.setState({selectedExpireOption:P().find(L=>L.value===S)})},this.onSnapshotCreate=async(S=!1)=>{const{selectedExpireOption:L}=this.state,O=this.prepareSnapshot(),j={dashboard:O,name:O.title,expires:L?.value,external:S};try{const N=await(0,E.s)().create(j);return(0,h.JD)((0,m.dx)((0,v.tZ)((0,x.t)("snapshot.share.success-creation","Your snapshot has been created")))),N}finally{S?b.c.publishSnapshotClicked({expires:j.expires,shareResource:(0,f.hD)(this.state.panelRef)}):b.c.publishSnapshotLocalClicked({expires:j.expires,shareResource:(0,f.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async S=>{const L=await(0,r.AI)().get(S);return(0,h.JD)((0,m.dx)((0,v.tZ)((0,x.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),L},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=I}_onActivate(){(0,E.s)().getSharingOptions().then(T=>{this.isActive&&this.setState({snapshotSharingOptions:T})})}getTabLabel(){return(0,x.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const T=i.jh.getTimeRange(this),{dashboardRef:S,panelRef:L}=this.state,O=(0,y.Uy)(S.resolve(),!0);return(0,y.c)(this.state.snapshotName||"",T.state.value,O,L?.resolve())}}function I({model:R}){const{snapshotName:T,selectedExpireOption:S,modalRef:L,snapshotSharingOptions:O}=R.useState(),[j,N]=(0,s.default)(async(w=!1)=>R.onSnapshotCreate(w)),[F,U]=(0,s.default)(async w=>await(0,r.AI)().get(w));return F.value?(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,n.jsxs)(n.Fragment,{children:[!j.value&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsxs)(x.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,n.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,n.jsx)(g.D,{label:(0,x.t)("share-modal.snapshot.name","Snapshot name"),children:(0,n.jsx)(o.p,{id:"snapshot-name-input",width:30,defaultValue:T,onBlur:w=>R.onSnasphotNameChange(w.target.value)})}),(0,n.jsx)(g.D,{label:(0,x.t)("share-modal.snapshot.expire","Expire"),children:(0,n.jsx)(d.z,{id:"expire-select-input",options:P(),value:S?.value,onChange:R.onExpireChange})}),(0,n.jsxs)(c.a.ButtonRow,{children:[(0,n.jsx)(a.$n,{variant:"secondary",onClick:()=>{L?.resolve().onDismiss()},fill:"outline",children:(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),O?.externalEnabled&&(0,n.jsx)(a.$n,{variant:"secondary",disabled:j.loading,onClick:()=>N(!0),children:O?.externalSnapshotName}),(0,n.jsx)(a.$n,{variant:"primary",disabled:j.loading,onClick:()=>N(),"data-testid":D.PublishSnapshot,children:(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),j.value&&(0,n.jsxs)(p.B,{direction:"column",gap:0,children:[(0,n.jsx)(g.D,{label:(0,x.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,n.jsx)(o.p,{"data-testid":D.CopyUrlInput,id:"snapshot-url-input",value:j.value.url,readOnly:!0,addonAfter:(0,n.jsx)(u.b,{"data-testid":D.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>j.value.url,children:(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,n.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,n.jsx)(a.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{U(j.value.deleteUrl)},children:(0,n.jsx)(x.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},30160:(k,A,e)=>{"use strict";e.d(A,{S:()=>x});var n=e(74848),s=e(32196),l=e(32264),r=e(40845),i=e(94753),g=e(25994),o=e(67061),d=e(10534),c=e(55852),a=e(42418),p=e(8484),u=e(74730),m=e(95007),v=e(58398);class x extends v.R{static{this.Component=f}constructor({panelRef:y}){super({panelRef:y})}}function f({model:h}){const y=(0,r.of)(E),{useLockedTime:b,useShortUrl:D,selectedTheme:P,isBuildUrlLoading:C,imageUrl:M}=h.useState(),R=!!(0,u.YQ)(h).state.uid;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:y.configDescription,children:(0,n.jsx)(i.E,{variant:"body",children:(0,n.jsx)(p.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})})}),(0,n.jsx)(m.A,{useLockedTime:b,onToggleLockedTime:()=>h.onToggleLockedTime(),useShortUrl:D,onUrlShorten:()=>h.onUrlShorten(),selectedTheme:P,onChangeTheme:T=>h.onThemeChange(T),isLoading:C}),(0,n.jsx)(g.c,{spacing:1}),(0,n.jsxs)(o.B,{gap:2,direction:"column",children:[(0,n.jsx)("div",{className:y.buttonsContainer,children:(0,n.jsxs)(o.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(d.b,{icon:"link",variant:"primary",fill:"outline",disabled:C,getText:h.getShareUrl,onClipboardCopy:h.onCopy,children:(0,n.jsx)(p.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})}),(0,n.jsx)(c.z9,{href:M,icon:"external-link-alt",target:"_blank",variant:"secondary",fill:"solid",disabled:!l.$.rendererAvailable||!R,children:(0,n.jsx)(p.x6,{i18nKey:"link.share-panel.render-image",children:"Render image"})})]})}),!R&&(0,n.jsx)(a.F,{severity:"info",title:(0,p.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(p.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!l.$.rendererAvailable&&(0,n.jsx)(a.F,{severity:"info",title:(0,p.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(p.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})]})}const E=h=>({configDescription:(0,s.css)({marginBottom:h.spacing(2)}),buttonsContainer:(0,s.css)({marginTop:h.spacing(2)})})},59995:(k,A,e)=>{"use strict";e.d(A,{b:()=>u});var n=e(16817),s=e(26657),l=e(80943),r=e(31204),i=e(31193),g=e(41507),o=e(60656);const d=async m=>{let v=new Set;for(const x of m)r.z.has(x)&&await(0,i.tR)().get(x)instanceof s.iy||v.add(x);return Array.from(v)};function c(m){const v=new Set,x=m.state.body;if(!(x instanceof l.hy))return[];for(const f of x.state.children){if(f instanceof g.U){const E=p(f);for(const h of E)v.add(h)}if(f instanceof l.tI){const E=a(f);for(const h of E)v.add(h)}}return Array.from(v).sort()}function a(m){return new Set(m.state.children.map(x=>p(x)).flat())}function p(m){let v;if(m instanceof g.U)if(m.state.body instanceof o.F)v=m.state.body.state.panel;else if(m.state.body instanceof l.Eb)v=m.state.body;else throw new Error("DashboardGridItem body expected to be VizPanel");if(!v)throw new Error("Unsupported grid item type");const x=v.state.$data,f=new Set;if(x instanceof l.dt)for(const E of x.state.queries)f.add(E.datasource?.type??"");if(x instanceof l.Es){const E=x.state.$data;if(E instanceof l.dt)for(const h of E.state.queries)f.add(h.datasource?.type??"")}return Array.from(f)}function u(m){const{value:v}=(0,n.A)(async()=>{const x=c(m);return d(x)},[]);return v}},53543:(k,A,e)=>{"use strict";e.d(A,{R:()=>l});var n=e(80943),s=e(74730);class l{constructor(i){this._vizPanel=i}get id(){const i=(0,s.Cs)(this._vizPanel);return isNaN(i)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):i}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof n.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const i=(0,s.un)(this._vizPanel);return i?i.state.queries:[]}get datasource(){return(0,s.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(k,A,e)=>{"use strict";e.d(A,{w:()=>r});var n=e(32264),s=e(80943),l=e(39820);function r(i){if(!i.targets?.length||n.$.panels[i.type]?.skipDataQuery)return;let g;return g=new s.dt({datasource:i.datasource??void 0,queries:i.targets,maxDataPoints:i.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:i.cacheTimeout,queryCachingTTL:i.queryCachingTTL,minInterval:i.interval??void 0,dataLayerFilter:{panelId:i.id},$behaviors:[new l.L({})]}),new s.Es({$data:g,transformations:i.transformations||[]})}},32023:(k,A,e)=>{"use strict";e.d(A,{WZ:()=>v,b4:()=>x});var n=e(80943),s=e(16279),l=e(41507),r=e(60656),i=e(42397),g=e(74730);function o(f){return f.state.controls?.state.timePicker}function d(f){return f.state.controls?.state.refreshPicker}function c(f){return f.state.titleItems&&Array.isArray(f.state.titleItems)&&f.state.titleItems[0]instanceof i.$?f.state.titleItems[0]:null}function a(f){const E=[];return f.state.body.forEachChild(h=>{if(!(h instanceof l.U)&&!(h instanceof n.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");h instanceof l.U?h.state.body instanceof n.Eb&&E.push(h.state.body):h instanceof n.tI&&h.forEachChild(y=>{y instanceof l.U&&y.state.body instanceof n.Eb&&E.push(y.state.body)})}),E}function p(f){const E=n.jh.getData(f);if(!(E instanceof s.s))throw new Error("DashboardDataLayerSet not found");return E}function u(f){const E=f.state.$behaviors?.find(h=>h instanceof n.Gg.K2);if(E instanceof n.Gg.K2)return E}function m(f){let E=0;const h=f.state.body;if(!(h instanceof n.hy))throw new Error("Dashboard body is not a SceneGridLayout");for(const y of h.state.children){if(y instanceof l.U){const b=y.state.body;if(b){const D=b instanceof r.F?(0,g.RQ)(b):(0,g.Cs)(b);D>E&&(E=D)}}if(y instanceof n.tI){const b=(0,g.Cs)(y);b>E&&(E=b);for(const D of y.state.children)if(D instanceof l.U){const P=D.state.body;if(P){const C=P instanceof r.F?(0,g.RQ)(P):(0,g.Cs)(P);C>E&&(E=C)}}}}return E+1}const v=f=>f.parent instanceof r.F?f.parent:f.parent instanceof l.U&&f.parent.state.body instanceof r.F?f.parent.state.body:null,x={getTimePicker:o,getRefreshPicker:d,getPanelLinks:c,getVizPanels:a,getDataLayers:p,getNextPanelId:m,getCursorSync:u}},27734:(k,A,e)=>{"use strict";e.d(A,{Gq:()=>g,zf:()=>o});var n=e(76885),s=e(39601),l=e(32264),r=e(80943);const i="grafana.dashboard.preservedUrlFiltersState";function g(d){const c=window.sessionStorage.getItem(i);if(c){const a=new URLSearchParams(c),p=s.Ny.getSearch();a.forEach((m,v)=>{p.has(v)||p.append(v,m)});for(const m of Array.from(p.keys()))m.startsWith("var-")&&(d.state.$variables?.getByName(m.replace("var-",""))||p.delete(m));const u=p.toString();u&&s.Ny.replace({search:u})}}function o(d){if(l.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!d.state.uid)return;const c=Object.fromEntries(Object.entries(new r.g5().getUrlState(d)).filter(([p])=>p.startsWith("var-")||p==="from"||p==="to"||p==="timezone")),a=Object.fromEntries(Object.entries(c).filter(([p,u])=>!(Array.isArray(u)&&u.length===0)));Object.keys(a).length>0?window.sessionStorage.setItem(i,n.kM.renderUrl("",a)):window.sessionStorage.removeItem(i)}}},73788:(k,A,e)=>{"use strict";e.d(A,{E:()=>l});var n=e(80943),s=e(53287);function l(r){const i=n.jh.getVariables(r);return(0,s.C)(i)}},7758:(k,A,e)=>{"use strict";e.d(A,{c:()=>l});var n=e(14110);let s=!1;const l={dashboardInitialized:i=>{r("init_dashboard_completed",{...i})},panelLinkClicked:i=>{r("panelheader_datalink_clicked",i)},panelStatusMessageClicked:i=>{r("panelheader_statusmessage_clicked",i)},panelCancelQueryClicked:i=>{r("panelheader_cancelquery_clicked",i)},toolbarFavoritesClick:()=>{r("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{r("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{r("toolbar_actions_clicked",{item:"share"})},toolbarAddClick:()=>{r("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:i=>{r("sharing_category_clicked",i)},shareLinkCopied:i=>{r("sharing_link_copy_clicked",i)},embedSnippetCopy:i=>{r("sharing_embed_copy_clicked",i)},publishSnapshotClicked:i=>{r("sharing_snapshot_publish_clicked",i)},publishSnapshotLocalClicked:i=>{r("sharing_snapshot_local_clicked",i)},exportDownloadJsonClicked:i=>{r("sharing_export_download_json_clicked",i)},exportCopyJsonClicked:i=>{r("sharing_export_copy_json_clicked",i)},exportSaveJsonClicked:i=>{r("sharing_export_save_json_clicked",i)},exportViewJsonClicked:i=>{r("sharing_export_view_json_clicked",i)},generatePublicDashboardUrlClicked:i=>{r("sharing_public_generate_url_clicked",i)},revokePublicDashboardEmailClicked:i=>{r("sharing_public_email_revoke_clicked",i)},resendPublicDashboardEmailClicked:i=>{r("sharing_public_email_resend_clicked",i)},publicDashboardEmailInviteClicked:i=>{r("sharing_public_email_invite_clicked",i)},publicDashboardShareTypeChange:i=>{r("sharing_public_can_view_clicked",i)},publicDashboardTimeSelectionChanged:i=>{r("sharing_public_time_picker_clicked",i)},publicDashboardAnnotationsSelectionChanged:i=>{r("sharing_public_annotations_clicked",i)},publicDashboardUrlCopied:i=>{r("sharing_public_copy_url_clicked",i)},publicDashboardPauseSharingClicked:i=>{r("sharing_public_pause_clicked",i)},revokePublicDashboardClicked:i=>{r("sharing_public_revoke_clicked",i)},emptyDashboardButtonClicked:i=>{r("emptydashboard_clicked",i)},toolbarAddButtonClicked:i=>{r("toolbar_add_clicked",i)},setScenesContext:()=>(s=!0,()=>{s=!1})},r=(i,g)=>{const o=s?{scenesView:!0}:{};g?(0,n.rR)(`dashboards_${i}`,{...g,...o}):(0,n.rR)(`dashboards_${i}`)}},99246:(k,A,e)=>{"use strict";e.d(A,{C:()=>n,Y:()=>s});const n={left:[],right:[]};function s(l,r){n[l].push(r)}},11982:(k,A,e)=>{"use strict";e.d(A,{Lp:()=>m,Uu:()=>u,e0:()=>p,r7:()=>a,uZ:()=>c});var n=e(76885),s=e(71733),l=e(39601),r=e(32264),i=e(80943),g=e(10096),o=e(87490),d=e(74730);function c(v){let x=`/d/${v.uid}`;v.uid||(x="/dashboard/new"),v.soloRoute&&(x=`/d-solo/${v.uid}`),v.slug&&(x+=`/${v.slug}`),v.subPath&&(x+=v.subPath),v.render&&(x="/render"+x,v.updateQuery={...v.updateQuery,width:1e3,height:500,tz:v.timeZone}),v.isHomeDashboard&&(x="/");const f=v.currentQueryParams?(0,l.SE)(v.currentQueryParams):{};if(v.updateQuery)for(const h in v.updateQuery)v.updateQuery[h]===null||v.updateQuery[h]===void 0?delete f[h]:f[h]=v.updateQuery[h];const E=n.kM.renderUrl(x,f);return v.absolute?r.$.appUrl+E.slice(1):E}function a(v){return s.I.getUrlForPartial(l.Ny.getLocation(),{viewPanel:v.state.key,editPanel:void 0})}function p(v){return s.I.getUrlForPartial(l.Ny.getLocation(),{editPanel:v,viewPanel:void 0})}function u(v,x){const f=v.state.key?.replace("-view","");return s.I.getUrlForPartial(l.Ny.getLocation(),{inspect:f,inspectTab:x})}function m(v){const x=v.getPlugin(),f=(0,d.un)(v);if(!g.contextSrv.hasAccessToExplore()||x?.meta.skipDataQuery||!f)return Promise.resolve(void 0);const E=i.jh.getTimeRange(v);return(0,o.Xe)({queries:f.state.queries,dsRef:f.state.datasource,timeRange:E.state.value,scopedVars:{__sceneObject:{value:v}},adhocFilters:f.state.data?.request?.filters})}},74730:(k,A,e)=>{"use strict";e.d(A,{Cs:()=>x,O8:()=>S,RQ:()=>f,SN:()=>T,Sm:()=>D,Ws:()=>L,X0:()=>y,XA:()=>v,YQ:()=>I,Yr:()=>O,a7:()=>b,bx:()=>P,pk:()=>C,sw:()=>u,un:()=>M,vL:()=>E,vm:()=>m,xz:()=>R});var n=e(22391),s=e(19347),l=e(80943),r=e(81515),i=e(39820),g=e(34842),o=e(60656),d=e(42397),c=e(7196),a=e(58029),p=e(32023);const u=8,m=12;function v(j){return`panel-${j}`}function x(j){return parseInt(j.state.key.replace("panel-",""),10)}function f(j){return parseInt(j.state.panelKey.replace("panel-",""),10)}function E(j,N){if(!N)return null;const F=h(j,N);if(F)return F;const U=parseInt(N,10);return isNaN(U)?null:h(j,v(U))}function h(j,N){if(!N)return null;const F=l.jh.findObject(j,U=>U.state.key===N?!0:(U instanceof l.Eb,!1));if(F){if(F instanceof l.Eb)return F;throw new Error(`Found panel with key ${N} but it was not a VizPanel`)}return null}function y(j,N){j.forEachChild(F=>{F.isActive&&(F.forceRender(),y(F,N))})}function b(j){const{value:N,text:F,options:U}=j.state;return j.hasAllValue()?{values:U.map(w=>w.value),texts:U.map(w=>w.label)}:{values:Array.isArray(N)?N:[N],texts:Array.isArray(F)?F:[F]}}function D(j){const N=j.match(/(["'])(.*?)\1|\w+/g);if(!N)return r.Ez.query?.split(",")??[];const F=new Set,U=N.reduce((w,B)=>{const K=B.replace(/["']+/g,"");return K.startsWith("$__auto_interval_")||w.add(K),w},F);return Array.from(U)}function P(j){return Array.isArray(j)?j.join(","):""}function C(j,N){const F=Array.isArray(j.current.value)?j.current.value[0]:j.current.value;return F.startsWith("$__auto_interval_")?"$__auto":N.includes(F)?F:N[0]}function M(j){if(!j)return;const N=j.state.$data??j.parent?.state.$data;if(N instanceof l.dt)return N;if(N instanceof l.Es)return M(N)}function I(j){const N=j.getRoot();if(N instanceof g.H$)return N;throw new Error("SceneObject root is not a DashboardScene")}function R(j){return j instanceof l.Eb?j:j.parent?R(j.parent):null}function T(j){return j.includes("clone")}function S(j){const N=p.b4.getNextPanelId(j);return new l.Eb({title:"Panel Title",key:v(N),pluginId:"timeseries",titleItems:[new d.$({menu:new d.m({})})],hoverHeaderOffset:0,menu:new l.Lw({$behaviors:[c._i]}),$data:new l.Es({$data:new l.dt({queries:[{refId:"A"}],datasource:(0,n.p$)((0,s.l)().getInstanceSettings(null)),$behaviors:[new i.L({})]}),transformations:[]})})}function L(j){const N=p.b4.getNextPanelId(j);return new l.tI({key:v(N),title:"Row title",actions:new a.u({}),y:0})}function O(j){if(j.parent instanceof o.F)return j.parent}},28676:(k,A,e)=>{"use strict";e.d(A,{n:()=>a});var n=e(17172),s=e(32264),l=e(2468),r=e(48814),i=e(6473),g=e(61642);class o{constructor(){}saveDashboard(m){return i.t.ignoreNextSave(),(0,n.AI)().post("/api/dashboards/db/",{dashboard:m.dashboard,message:m.message??"",overwrite:m.overwrite??!1,folderUid:m.folderUid})}deleteDashboard(m,v){return(0,n.AI)().delete(`/api/dashboards/uid/${m}`,{showSuccessAlert:v})}getDashboardDTO(m){const x=(0,g.X)()?.getAll("scopes")??[],f=x.length>0?{scopes:x}:void 0;return(0,n.AI)().get(`/api/dashboards/uid/${m}`,f)}}class d{constructor(){this.client=new l.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(m){const v=m.dashboard,x={metadata:{...m?.k8s},spec:{...v}};return m.message?x.metadata.annotations={...x.metadata.annotations,[r.fY]:m.message}:x.metadata.annotations&&delete x.metadata.annotations[r.fY],m.folderUid&&(x.metadata.annotations={...x.metadata.annotations,[r.ew]:m.folderUid}),v.uid?(x.metadata.name=v.uid,this.client.update(x).then(f=>this.asSaveDashboardResponseDTO(f))):this.client.create(x).then(f=>this.asSaveDashboardResponseDTO(f))}asSaveDashboardResponseDTO(m){return{uid:m.metadata.name,version:m.spec.version??0,id:m.spec.id??0,status:"success",slug:"",url:""}}deleteDashboard(m,v){return this.client.delete(m).then(x=>({id:0,message:x.message,title:"deleted"}))}async getDashboardDTO(m){const v=await this.client.subresource(m,"dto");return{meta:{...v.access,isNew:!1,isFolder:!1,uid:v.metadata.name,k8s:v.metadata},dashboard:v.spec}}}let c;function a(){return c||(c=s.$.featureToggles.kubernetesDashboards?new d:new o),c}function p(u){throw new Error("dashboardAPI can be only overridden in test environment")}},72686:(k,A,e)=>{"use strict";e.d(A,{$L:()=>b,AK:()=>P,Bs:()=>v,NA:()=>D,NY:()=>y,Sm:()=>m,T2:()=>f,U9:()=>x,_e:()=>h,bN:()=>E,eq:()=>I,ft:()=>R,g9:()=>M,kd:()=>C});var n=e(75816),s=e(75505),l=e(17172),r=e(32264),i=e(82467),g=e(3169),o=e(8484),d=e(72254),c=e(34842);function a(T){return typeof T=="object"&&T!=null&&"error"in T}const p=({baseUrl:T})=>async S=>{try{const{data:L,...O}=await(0,s.s)((0,l.AI)().fetch({...S,url:T+S.url,showErrorAlert:S.showErrorAlert}));return{data:L,meta:O}}catch(L){return S.manageError?S.manageError(L):{error:L}}},u=T=>({error:(0,l.NF)(T)&&T.data.messageId!=="publicdashboards.notFound"?T:null}),m=(0,n.xP)({reducerPath:"publicDashboardApi",baseQuery:p({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:T=>({getPublicDashboard:T.query({query:S=>({url:`/dashboards/uid/${S}/public-dashboards`,manageError:u,showErrorAlert:!1}),async onQueryStarted(S,{dispatch:L,queryFulfilled:O}){try{await O}catch(j){a(j)&&(0,l.NF)(j.error)&&L((0,i.dx)((0,g.gi)(j.error.data.message)))}},providesTags:(S,L,O)=>[{type:"PublicDashboard",id:O}]}),createPublicDashboard:T.mutation({query:S=>({url:`/dashboards/uid/${S.dashboard instanceof c.H$?S.dashboard.state.uid:S.dashboard.uid}/public-dashboards`,method:"POST",data:S.payload}),async onQueryStarted({dashboard:S,payload:{share:L}},{dispatch:O,queryFulfilled:j}){const{data:N}=await j;let F=(0,o.t)("public-dashboard.sharing.success-creation","Dashboard is public!");r.$.featureToggles.newDashboardSharingComponent&&(F=L===d.Xo.PUBLIC?(0,o.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,o.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),O((0,i.dx)((0,g.tZ)(F))),S instanceof c.H$?S.setState({meta:{...S.state.meta,publicDashboardEnabled:N.isEnabled}}):S.updateMeta({publicDashboardEnabled:N.isEnabled})},invalidatesTags:(S,L,{dashboard:O})=>[{type:"PublicDashboard",id:O instanceof c.H$?O.state.uid:O.uid}]}),updatePublicDashboard:T.mutation({query:({payload:S,dashboard:L})=>({url:`/dashboards/uid/${L instanceof c.H$?L.state.uid:L.uid}/public-dashboards/${S.uid}`,method:"PATCH",data:S}),async onQueryStarted({dashboard:S},{dispatch:L,queryFulfilled:O}){await O,L((0,i.dx)((0,g.tZ)(r.$.featureToggles.newDashboardSharingComponent?(0,o.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,o.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(S,L,{payload:O})=>[{type:"PublicDashboard",id:O.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:T.mutation({query:({payload:S,dashboard:L})=>({url:`/dashboards/uid/${L instanceof c.H$?L.state.uid:L.uid}/public-dashboards/${S.uid}`,method:"PATCH",data:S}),async onQueryStarted({dashboard:S,payload:{isEnabled:L}},{dispatch:O,queryFulfilled:j}){const{data:N}=await j;let F=(0,o.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");r.$.featureToggles.newDashboardSharingComponent&&(F=L?(0,o.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,o.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),O((0,i.dx)((0,g.tZ)(F))),S instanceof c.H$?S.setState({meta:{...S.state.meta,publicDashboardEnabled:N.isEnabled}}):S.updateMeta?.({publicDashboardEnabled:N.isEnabled})},invalidatesTags:(S,L,{payload:O})=>[{type:"PublicDashboard",id:O.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:T.mutation({query:({payload:S,dashboard:L})=>({url:`/dashboards/uid/${L instanceof c.H$?L.state.uid:L.uid}/public-dashboards/${S.uid}`,method:"PATCH",data:S}),async onQueryStarted({dashboard:S,payload:{share:L}},{dispatch:O,queryFulfilled:j}){await j;let N=(0,o.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");r.$.featureToggles.newDashboardSharingComponent&&(N=L===d.Xo.PUBLIC?(0,o.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,o.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access restricted: Only specific people can now access with the link")),O((0,i.dx)((0,g.tZ)(N)))},invalidatesTags:(S,L,{payload:O})=>[{type:"PublicDashboard",id:O.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:T.mutation({query:()=>({url:""})}),deleteRecipient:T.mutation({query:()=>({url:""})}),reshareAccessToRecipient:T.mutation({query:()=>({url:""})}),getActiveUsers:T.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:T.query({query:()=>({url:""}),providesTags:(S,L,O)=>[{type:"ActiveUserDashboards",id:O}]}),listPublicDashboards:T.query({query:(S=1)=>({url:`/dashboards/public-dashboards?page=${S}&perpage=8`}),transformResponse:S=>({...S,totalPages:Math.ceil(S.totalCount/S.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:T.mutation({query:S=>({url:`/dashboards/uid/${S.dashboardUid}/public-dashboards/${S.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:S},{dispatch:L,queryFulfilled:O}){await O,L((0,i.dx)((0,g.tZ)(r.$.featureToggles.newDashboardSharingComponent?(0,o.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,o.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),L(m.util?.resetApiState()),S instanceof c.H$?S.setState({meta:{...S.state.meta,publicDashboardEnabled:!1}}):S?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(S,L,{dashboardUid:O})=>[{type:"PublicDashboard",id:O},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:T.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:v,useCreatePublicDashboardMutation:x,useUpdatePublicDashboardMutation:f,useDeletePublicDashboardMutation:E,useListPublicDashboardsQuery:h,useAddRecipientMutation:y,useDeleteRecipientMutation:b,useReshareAccessToRecipientMutation:D,useGetActiveUsersQuery:P,useGetActiveUserDashboardsQuery:C,useRevokeAllAccessMutation:M,usePauseOrResumePublicDashboardMutation:I,useUpdatePublicDashboardAccessMutation:R}=m},15858:(k,A,e)=>{"use strict";e.d(A,{M:()=>p});var n=e(2543),s=e(12470),l=e(19347),r=e(2913),i=e(57767),g=e(75096),o=e(82792),d=e(98796),c=e(24240);function a(u){return!!(u.libraryPanel?.name&&u.libraryPanel?.uid)}class p{async makeExportable(m){m.cleanUpRepeats();const v=m.getSaveModelCloneOld();v.id=null,m.processRepeats();const x=[],f={},E={},h={},y=new Map;for(const C of v.getVariables())h[C.name]=C;const b=(C,M)=>{if(C.datasource===void 0){C.datasource=M;return}let I=C.datasource,R=null;const T=I?.uid,S=T&&g.SY.exec(T);if(S){const L=S[1]||S[2]||S[4];R=h[L],R&&R.current&&(I=R.current.value)}return(0,l.l)().get(I).then(L=>{if(L.meta?.builtIn||(f["datasource"+L.meta?.id]={type:"datasource",id:L.meta.id,name:L.meta.name,version:L.meta.info.version||"1.0.0"},R))return;const O=C.libraryPanel,j=O?"-for-library-panel":"";let N="DS_"+L.name.replace(" ","_").toUpperCase()+j.toUpperCase();if(E[N]={name:N,label:L.name,description:"",type:"datasource",pluginId:L.meta?.id,pluginName:L.meta?.name,usage:E[N]?.usage},O){const F=E[N]?.usage?.libraryPanels||[];F.push({name:O.name,uid:O.uid}),E[N].usage={libraryPanels:F}}C.datasource={type:L.meta.id,uid:"${"+N+"}"}})},D=async C=>{if(C.type!=="row"){if(await b(C),C.targets)for(const I of C.targets)await b(I,C.datasource);const M=r.Ay.panels[C.type];M&&(f["panel"+M.id]={type:"panel",id:M.id,name:M.name,version:M.info.version})}},P=async C=>{if((0,o.X)(C)){const{name:M,uid:I}=C.libraryPanel;let R=C.libraryPanel.model;R||(R=(await(0,i.Yr)(I,!0)).model),await b(R);const{gridPos:T,id:S,...L}=R;y.has(I)||y.set(I,{name:M,uid:I,kind:d.i.Panel,model:L})}};try{for(const I of v.panels)if(await D(I),I.collapsed!==void 0&&I.collapsed===!0&&I.panels)for(const R of I.panels)await D(R);for(const I of v.getVariables())I.type==="query"?(await b(I),I.options=[],I.current={},I.refresh=I.refresh!==s.CO.never?I.refresh:s.CO.onDashboardLoad):I.type==="datasource"&&(I.current={});for(const I of v.annotations.list)await b(I);f.grafana={type:"grafana",id:"grafana",name:"Grafana",version:r.Ay.buildInfo.version};for(const I of v.panels)if(await P(I),I.collapsed!==void 0&&I.collapsed===!0&&I.panels)for(const R of I.panels)await P(R);(0,n.each)(E,I=>{x.push(I)});for(const I of v.getVariables())if((0,c.VO)(I)){const R="VAR_"+I.name.replace(" ","_").toUpperCase();x.push({name:R,type:"constant",label:I.label||I.name,value:I.query,description:""}),I.query="${"+R+"}",I.current={value:I.query,text:I.query,selected:!1},I.options=[I.current]}const C=[...y.entries()].reduce((I,[R,T])=>(I[R]=T,I),{}),M=(0,n.defaults)({__inputs:x,__elements:C,__requires:(0,n.sortBy)(f,["id"])},v);for(let I=0;I<M.panels.length;I++){const R=M.panels[I];a(R)&&(M.panels[I]={gridPos:R.gridPos,id:R.id,libraryPanel:{uid:R.libraryPanel.uid,name:R.libraryPanel.name}})}return M}catch(C){return console.error("Export failed:",C),{error:C}}}}},20120:(k,A,e)=>{"use strict";e.d(A,{UP:()=>oe,fP:()=>J,Ay:()=>de});var n=e(74848),s=e(96540),l=e(32196),r=e(71468),i=e(24180),g=e(80997),o=e(13544),d=e(39601),c=e(69731),a=e(96374),p=e(39938),u=e(19727),m=e(27746),v=e(71678),x=e(15068),f=e(82467),E=e(75269),h=e(10804),y=e(2913),b=e(3169),D=e(10096),P=e(16021),C=e(8484),M=e(91219),I=e(28215),R=e(83122),T=e(55852),S=e(14578),L=e(32264),O=e(38138),j=e(36974),N=e(7758),F=e(31678),U=e(28601);const B=({dashboard:ue})=>{const Te=(0,s.useMemo)(()=>(0,j._u)(),[]),ge=(0,F.useDispatch)(),Oe=(0,F.useSelector)(Ue=>Ue.dashboard.initialDatasource);return(0,n.jsxs)(O.W,{children:[(0,n.jsx)(O.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,C.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Ue=(0,j.OK)(ue,Oe);N.c.toolbarAddButtonClicked({item:"add_visualization"}),d.Ny.partial({editPanel:Ue}),ge((0,U.Ub)(void 0))}},"add-visualisation"),L.$.featureToggles.vizAndWidgetSplit&&(0,n.jsx)(O.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,C.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"add_widget"}),d.Ny.partial({addWidget:!0})}},"add-widget"),(0,n.jsx)(O.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,C.t)("dashboard.add-menu.row","Row"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"add_row"}),(0,j.SD)(ue)}},"add-row"),(0,n.jsx)(O.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,C.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,j.s3)(ue)}},"add-panel-lib"),(0,n.jsx)(O.W.Item,{testId:o.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,C.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{N.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,j.no)(ue,Te)},disabled:!Te},"add-panel-clipboard")]})},W=({dashboard:ue,onToolbarAddMenuOpen:Te})=>{const[ge,Oe]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{ge&&Te&&Te()},[ge,Te]),(0,n.jsx)(R.m,{overlay:()=>(0,n.jsx)(B,{dashboard:ue}),placement:"bottom",offset:[0,6],onVisibleChange:Oe,children:(0,n.jsxs)(T.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":o.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,n.jsx)(C.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,n.jsx)(S.I,{name:ge?"angle-up":"angle-down",size:"lg"})]})})};var z=e(70497),Y=e(14792),X=e(2609),q=e(81862),G=e(28444),te=e(99246),H=e(93030),se=e(62367);const ne=({dashboard:ue})=>(0,n.jsx)(T.$n,{"data-testid":o.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{N.c.toolbarShareClick(),d.Ny.partial({shareView:"link"})},children:(0,n.jsx)(C.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),le={removeNavIndex:I.Im,setStarred:M.ci,updateTimeZoneForSession:q.Cj,updateNavIndex:f.Vz},_=ue=>({navIndex:ue.navIndex}),Q=(0,r.connect)(_,le),ae=o.Tp.pages.Dashboard.DashNav;function oe(ue){(0,te.Y)("left",ue)}function J(ue){(0,te.Y)("right",ue)}const ee=(0,s.memo)(ue=>{(0,i.zy)();const Te=(0,c.C)();(0,P.u)(ue.dashboard.events,G.Cf);const ge=ue.dashboard.snapshot?.originalUrl??"",Oe=()=>{window.location.href=g.sQ.sanitizeUrl(ue.dashboard.snapshot.originalUrl)},Ue=(0,b._2)(),Xe=()=>{try{const tt=new URL(g.sQ.sanitizeUrl(ge),y.Ay.appUrl),ze=new URL(y.Ay.appUrl);tt.host!==ze.host?D.lE.publish(new G.S8({component:a.u,props:{title:"Proceed to external site?",modalClass:xe,body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["This link connects to an external website at"," ",(0,n.jsx)("code",{children:ge})]}),(0,n.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:Oe}})):Oe()}catch(tt){Ue.error("Invalid URL",tt instanceof Error?tt.message:void 0)}},we=()=>{N.c.toolbarFavoritesClick();const tt=(0,Y.UA)(),{dashboard:ze,navIndex:pe,removeNavIndex:Se,setStarred:fe,updateNavIndex:Ee}=ue;tt.starDashboard(ze.uid,!!ze.meta.isStarred).then(Pe=>{fe({id:ze.uid,title:ze.title,url:ze.meta.url??"",isStarred:Pe});const he=pe.starred;if(Pe)he.children?.push({id:M.L1+ze.uid,text:ze.title,url:ze.meta.url??"",parentItem:he});else{Se(M.L1+ze.uid);const be=he.children?.findIndex(Ae=>Ae.id===M.L1+ze.uid);be&&he.children?.splice(be,1)}Ee(he),ze.meta.isStarred=Pe,Te()})},qe=()=>{N.c.toolbarSettingsClick(),d.Ny.partial({editview:"settings"})},We=()=>{X._o.prev()},Ce=()=>{X._o.next()},je=()=>{X._o.stop(),Te()},Ke=(tt,ze)=>{tt.map((pe,Se)=>{const fe=pe.component,Ee=(0,s.createElement)(fe,{...ue,key:`button-custom-${Se}`});typeof pe.index=="number"?ze.splice(pe.index,0,Ee):ze.push(Ee)})},_e=()=>X._o.state.isPlaying,Fe=()=>{const tt=y.Ay.buildInfo.env==="development",{dashboard:ze,kioskMode:pe}=ue,{canStar:Se,isStarred:fe}=ze.meta,Ee=[];if(pe||_e())return[];if(Se){let Pe=fe?(0,C.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,C.t)("dashboard.toolbar.mark-favorite","Mark as favorite");Ee.push((0,n.jsx)(H._,{tooltip:Pe,icon:fe?"favorite":"star",iconType:fe?"mono":"default",iconSize:"lg",onClick:we},"button-star"))}return ze.meta.publicDashboardEnabled&&Ee.push((0,n.jsx)(p.E,{color:"blue",text:"Public",className:re,"data-testid":ae.publicDashboardTag},"public-dashboard-button-badge")),tt&&y.Ay.featureToggles.dashboardScene&&Ee.push((0,n.jsx)(H._,{tooltip:"View as Scene",icon:"apps",onClick:()=>{d.Ny.partial({scenes:!0})}},"button-scenes")),Ke(te.C.left,Ee),Ee},at=()=>(0,n.jsxs)(u.e,{children:[(0,n.jsx)(m.I,{tooltip:(0,C.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:We,narrow:!0}),(0,n.jsx)(m.I,{onClick:je,children:(0,n.jsx)(C.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,n.jsx)(m.I,{tooltip:(0,C.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:Ce,narrow:!0})]},"playlist-buttons"),Ct=()=>{const{dashboard:tt,updateTimeZoneForSession:ze,hideTimePicker:pe}=ue;return pe?null:(0,n.jsx)(se.$,{dashboard:tt,onChangeTimeZone:ze},"time-controls")},Dt=()=>{const{dashboard:tt,isFullscreen:ze,kioskMode:pe,hideTimePicker:Se}=ue,{canSave:fe,canEdit:Ee,showSettings:Pe,canShare:he}=tt.meta,{snapshot:be}=tt,Ae=be&&be.originalUrl,De=[];return _e()?[at(),Ct()]:pe===F.KioskMode.TV?[Ct()]:(Ae&&De.push((0,n.jsx)(m.I,{tooltip:(0,C.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Xe,icon:"link"},"button-snapshot")),fe&&!ze&&De.push((0,n.jsx)(v.$s,{children:({showModal:Ie,hideModal:ke})=>(0,n.jsx)(m.I,{tooltip:(0,C.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{Ie(z.$,{dashboard:tt,onDismiss:ke})}})},"button-save")),Ke(te.C.right,De),Pe&&De.push((0,n.jsx)(m.I,{tooltip:(0,C.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:qe},"button-settings")),Ee&&!ze&&De.push((0,n.jsx)(W,{onToolbarAddMenuOpen:N.c.toolbarAddClick,dashboard:tt},"panel-add-dropdown")),he&&De.push((0,n.jsx)(ne,{dashboard:tt},"button-share")),Se||De.push((0,n.jsx)(h.K,{},"toolbar-separator")),De.push(Ct()),De)};return(0,n.jsx)(E.H,{actions:(0,n.jsxs)(n.Fragment,{children:[Fe(),(0,n.jsx)(h.K,{leftActionsSeparator:!0}),(0,n.jsx)(x.U,{alignment:"right",children:Dt()})]})})});ee.displayName="DashNav";const de=Q(ee),xe=(0,l.css)({width:"max-content",maxWidth:"80vw"}),re=(0,l.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(k,A,e)=>{"use strict";e.d(A,{_:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(29158);const i=({icon:o,iconType:d,iconSize:c,tooltip:a,onClick:p,children:u})=>{const m=(0,l.of)(g);return(0,n.jsxs)("div",{className:m.noBorderContainer,children:[o&&(0,n.jsx)(r.K,{name:o,size:c,iconType:d,tooltip:a,tooltipPlacement:"bottom",onClick:p}),u]})},g=o=>({noBorderContainer:(0,s.css)({padding:`0 ${o.spacing(.5)}`,display:"flex"})})},62367:(k,A,e)=>{"use strict";e.d(A,{$:()=>v});var n=e(74848),s=e(96540),l=e(85858),r=e(3591),i=e(32264),g=e(11134),o=e(15648),d=e(25573),c=e(10096),a=e(8484),p=e(16233),u=e(74856),m=e(28444);class v extends s.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=f=>{(0,u.jG)().setAutoRefresh(f),this.forceUpdate()},this.onRefresh=()=>((0,u.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{c.lE.publish(new m.Io({direction:m.xL.Left}))},this.onMoveForward=()=>{c.lE.publish(new m.Io({direction:m.xL.Right}))},this.onChangeTimePicker=f=>{const{dashboard:E}=this.props,h=E.timepicker,y=h.nowDelay&&f.raw.to==="now",b=l.isMathString(f.raw.from)?f.raw.from:f.from,D=l.isMathString(f.raw.to)?f.raw.to:f.to,P={from:b,to:y?"now-"+h.nowDelay:D};(0,u.jG)().setTime(P)},this.onChangeTimeZone=f=>{this.props.dashboard.timezone=f,this.props.onChangeTimeZone(f),this.onRefresh()},this.onChangeFiscalYearStartMonth=f=>{this.props.dashboard.fiscalYearStartMonth=f,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),c.lE.publish(new m.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(r.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:f,isOnCanvas:E}=this.props,{refresh_intervals:h}=f.timepicker,y=(0,u.jG)().getValidIntervals(h||g.cb),b=(0,u.jG)().timeRange(),D=f.getTimezone(),P=f.fiscalYearStartMonth,C=f.panelInEdit?.isEditing,M=f.weekStart||(0,o.r)(i.$.bootData.user.weekStart);let I;return f.refresh===p.SM&&(I=(0,u.jG)().getAutoRefreshInteval().interval),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.m,{value:b,onChange:this.onChangeTimePicker,timeZone:D,fiscalYearStartMonth:P,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:E,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:M}),(0,n.jsx)(g.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:f.refresh,intervals:y,isOnCanvas:E,tooltip:(0,a.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:C,showAutoInterval:!0,text:I})]})}}},16495:(k,A,e)=>{"use strict";e.d(A,{U:()=>n.Ay});var n=e(20120)},46991:(k,A,e)=>{"use strict";e.d(A,{d:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(55852);const i=({children:o,...d})=>{const c=(0,l.of)(g);return(0,n.jsx)("div",{className:c.buttonWrapper,children:(0,n.jsx)(r.$n,{icon:"plus",...d,children:o})})},g=o=>({buttonWrapper:(0,s.css)({padding:`${o.spacing(3)} 0`})})},75590:(k,A,e)=>{"use strict";e.d(A,{p:()=>h});var n=e(74848),s=e(2543),l=e(96540),r=e(65879),i=e(13544),g=e(57418),o=e(88575),d=e(20333),c=e(15648),a=e(10354),p=e(15292),u=e(8484),m=e(11134),v=e(74856);const x=({refreshIntervals:y,onRefreshIntervalChange:b,getIntervalsFunc:D=E,validateIntervalsFunc:P=f})=>{const[C,M]=(0,l.useState)(D(y??m.cb)),[I,R]=(0,l.useState)(null);(0,l.useEffect)(()=>{const O=D(y??m.cb);M(O)},[D,y]);const T=(0,l.useMemo)(()=>Array.isArray(C)?C.join(","):"",[C]),S=(0,l.useCallback)(O=>{const j=O.currentTarget.value?O.currentTarget.value.split(","):[];M(j)},[M]),L=(0,l.useCallback)(O=>{const j=P(C);j===null&&b(D(C)),R(j)},[D,C,b,P]);return(0,n.jsx)(o.D,{label:(0,u.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,u.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:I,invalid:!!I,children:(0,n.jsx)(a.p,{id:"auto-refresh-input",invalid:!!I,value:T,onChange:S,onBlur:L})})},f=(y,b={getTimeSrv:v.jG})=>{try{return E(y,b),null}catch(D){return D instanceof Error?D.message:"Invalid intervals"}},E=(y,b={getTimeSrv:v.jG})=>{const D=y.filter(P=>P.trim()!=="").map(P=>P.replace(/\s+/g,""));return[...new Set(b.getTimeSrv().getValidIntervals(D))]};class h extends l.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=b=>{const D=b.currentTarget.value;if((0,s.isEmpty)(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);if(r.isValidTimeSpan(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=b=>{typeof b=="string"&&this.props.onTimeZoneChange(b)},this.onWeekStartChange=b=>{this.props.onWeekStartChange(b)}}render(){return(0,n.jsxs)(g.M,{label:(0,u.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,n.jsx)(o.D,{label:(0,u.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":i.Tp.components.TimeZonePicker.containerV2,children:(0,n.jsx)(d.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,n.jsx)(o.D,{label:(0,u.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":i.Tp.components.WeekStartPicker.containerV2,children:(0,n.jsx)(c.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,n.jsx)(x,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,n.jsx)(o.D,{label:(0,u.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,u.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,n.jsx)(a.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,n.jsx)(o.D,{label:(0,u.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,n.jsx)(p.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,n.jsx)(o.D,{label:(0,u.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,u.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'"),children:(0,n.jsx)(p.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},62639:(k,A,e)=>{"use strict";e.d(A,{s:()=>Ri});var n=e(74848),s=e(96540),l=e(24180),r=e(71733),i=e(13544),g=e(39601),o=e(55852),d=e(15068),c=e(67061),a=e(94753),p=e(75269),u=e(69444),m=e(8484),v=e(16233),x=e(31678),f=e(28444),E=e(71468),h=e(14644),y=e(32196),b=e(16817),D=e(14110),P=e(40845),C=e(57418),M=e(66864),I=e(62930),R=e(56034),T=e(14578),S=e(29158),L=e(2223);const O=({id:_t,usages:cn})=>{const kn=(0,s.useMemo)(()=>cn.find(ns=>ns.variable.id===_t),[_t,cn]);if(!kn)return null;const Kn=kn.nodes.map(ns=>ns.label.includes(`$${_t}`)?{...ns,color:"#FB7E81"}:ns);return(0,n.jsx)(L.i,{show:!1,title:`Showing usages for: $${_t}`,nodes:Kn,edges:kn.edges,children:({showModal:ns})=>(0,n.jsx)(S.K,{onClick:()=>ns(),name:"code-branch",tooltip:"Show usages","data-testid":"VariablesUnknownButton"})})};var j=e(12846);const N=1e3;function F({variables:_t,dashboard:cn}){const[kn,Kn]=(0,s.useState)(!1),[ns,Rs]=(0,s.useState)(0),[Os,ha]=(0,s.useState)([]),na=(0,P.of)(K);(0,s.useEffect)(()=>Rs(Ma=>Ma+1),[_t,cn]);const{loading:wa}=(0,b.A)(async()=>{if(kn&&ns>0){const Ma=Date.now(),ks=await(0,j.g0)(_t,cn),go=Date.now()-Ma;return go>=N&&(0,D.rR)("Slow unknown variables expansion",{elapsed:go}),Rs(0),ha(ks),ks}return[]},[_t,cn,kn,ns]),pr=Ma=>{Ma&&(0,D.rR)("Unknown variables section expanded"),Kn(Ma)};return(0,n.jsx)("div",{className:na.container,children:(0,n.jsxs)(C.M,{label:(0,n.jsx)(U,{}),isOpen:kn,onToggle:pr,children:[wa&&(0,n.jsx)(M.gW,{justify:"center",children:(0,n.jsxs)(M.Gy,{justify:"center",children:[(0,n.jsx)("span",{children:"Loading..."}),(0,n.jsx)(I.y,{})]})}),!wa&&Os&&(0,n.jsxs)(n.Fragment,{children:[Os.length===0&&(0,n.jsx)(w,{}),Os.length>0&&(0,n.jsx)(B,{usages:Os})]})]})})}function U(){const _t=(0,P.of)(K);return(0,n.jsxs)("h5",{children:["Renamed or missing variables",(0,n.jsx)(R.m,{content:"Click to expand a list with all variable references that have been renamed or are missing from the dashboard.",children:(0,n.jsx)(T.I,{name:"info-circle",className:_t.infoIcon})})]})}function w(){return(0,n.jsx)("span",{children:"No renamed or missing variables found."})}function B({usages:_t}){const cn=(0,P.of)(K);return(0,n.jsxs)("table",{className:"filter-table filter-table--hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Variable"}),(0,n.jsx)("th",{colSpan:5})]})}),(0,n.jsx)("tbody",{children:_t.map(kn=>{const{variable:Kn}=kn,{id:ns,name:Rs}=Kn;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:cn.firstColumn,children:(0,n.jsx)("span",{children:Rs})}),(0,n.jsx)("td",{className:cn.defaultColumn}),(0,n.jsx)("td",{className:cn.defaultColumn}),(0,n.jsx)("td",{className:cn.defaultColumn}),(0,n.jsx)("td",{className:cn.lastColumn,children:(0,n.jsx)(O,{id:Kn.id,usages:_t})})]},ns)})})]})}const K=_t=>({container:(0,y.css)`
    margin-top: ${_t.spacing(4)};
    padding-top: ${_t.spacing(4)};
  `,infoIcon:(0,y.css)`
    margin-left: ${_t.spacing(1)};
  `,defaultColumn:(0,y.css)`
    width: 1%;
  `,firstColumn:(0,y.css)`
    width: 1%;
    vertical-align: top;
    color: ${_t.colors.text.maxContrast};
  `,lastColumn:(0,y.css)`
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
    text-align: right;
  `});var W=e(48594),z=e(87421),Y=e(56968),X=e(75096),q=e(96374);function G({varName:_t,isOpen:cn=!1,onConfirm:kn,onDismiss:Kn}){return(0,n.jsx)(q.u,{title:"Delete variable",isOpen:cn,onConfirm:kn,onDismiss:Kn,body:`
      Are you sure you want to delete variable "${_t}"?
    `,modalClass:te.modal,confirmText:"Delete"})}const te={modal:(0,y.css)({width:"max-content",maxWidth:"80vw"})};var H=e(39070),se=e(8964),ne=e(58975),le=e(85140),_=e(14329),Q=e(41820),ae=e(20601),oe=e(24240),J=e(72401),ee=e(89458);function de({onChange:_t,type:cn}){const kn=(0,s.useMemo)(()=>(0,X.AX)(),[]),Kn=(0,s.useMemo)(()=>kn.find(ns=>ns.value===cn)??kn[0],[kn,cn]);return(0,n.jsx)(ee.v,{name:"Select variable type",value:Kn,options:kn,onChange:_t,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}var xe=e(2543),re=e(27238),ue=e(3843);const Te=_t=>async cn=>{const{rootStateKey:kn}=_t;cn((0,W.kb)(kn,(0,ue.sJ)({name:(0,z.dn)(_t).name,id:_t.id})))},ge=_t=>async(cn,kn)=>{const{rootStateKey:Kn}=_t;cn((0,W.kb)(Kn,(0,ue.T7)((0,X.qD)(_t))))},Oe=(_t,cn)=>(kn,Kn)=>{const{id:ns,rootStateKey:Rs}=_t;let Os=null;if(cn.match(/^(?!__).*$/)||(Os="Template names cannot begin with '__', that's reserved for Grafana's global variables"),cn.match(/^\w+$/)||(Os="Only word characters are allowed in variable names"),(0,z.SS)(Rs,Kn()).filter(wa=>wa.name===cn&&wa.id!==ns).length&&(Os="Variable with the same name already exists"),Os){kn((0,W.kb)(Rs,(0,ue.DW)({newName:cn,errorText:Os})));return}kn(Ue(_t,cn))},Ue=(_t,cn)=>(kn,Kn)=>{const{rootStateKey:ns}=_t,Rs=(0,z.dn)(_t,Kn());if(Rs.name===cn){kn((0,W.kb)(ns,(0,ue.FN)((0,X.qD)(_t,{newName:cn}))));return}const Os={...(0,xe.cloneDeep)(Rs),name:cn,id:cn},ha=Rs.global,na=Rs.index,wa=(0,X.jX)(Os);kn((0,W.kb)(ns,(0,Y.QV)((0,X.qD)(wa,{global:ha,index:na,model:Os})))),kn((0,W.kb)(ns,(0,ue.FN)((0,X.qD)(wa,{newName:cn})))),kn((0,W.kb)(ns,(0,Y.Hr)((0,X.qD)(_t,{reIndex:!1}))))},Xe=(_t,cn="query")=>(kn,Kn)=>{const ns=(0,X.q4)(_t),Rs=(0,z.SS)(ns,Kn()),Os=qe(cn,Rs),ha={type:cn,id:Os},na=!1,wa=(0,z.hk)(ns,Kn()),pr=(0,xe.cloneDeep)(ae.B.get(cn).initialState);pr.id=Os,pr.name=Os,pr.rootStateKey=ns,kn((0,W.kb)(ns,(0,Y.QV)((0,X.qD)(ha,{global:na,model:pr,index:wa})))),g.Ny.partial({editIndex:Rs.length})},we=_t=>(cn,kn)=>{const Kn=(0,X.q4)(_t),ns=kn(),Rs=(0,z.nS)(Kn,ns),Os=ns.dashboard.getModel(),{usages:ha}=(0,j.hM)(Rs,Os),na=(0,j.Ow)(ha);cn((0,W.kb)(Kn,(0,re.bX)({usages:ha,usagesNetwork:na})))};function qe(_t,cn){let kn=0,Kn=`${_t}${kn}`;for(;cn.find(ns=>ns.id===Kn);)Kn=`${_t}${++kn}`;return Kn}var We=e(85830);const Ce=(_t,cn)=>({editor:(0,z.nx)(cn.identifier.rootStateKey,_t).editor,variable:(0,z.dn)(cn.identifier,_t)}),je=_t=>({...(0,h.bindActionCreators)({variableEditorMount:Te,variableEditorUnMount:ge,changeVariableName:Oe,updateOptions:J.mZ},_t),changeVariableProp:(cn,kn,Kn)=>_t((0,W.kb)(cn.rootStateKey,(0,Y.QP)((0,X.qD)(cn,{propName:kn,propValue:Kn})))),changeVariableType:(cn,kn)=>_t((0,W.kb)(cn.rootStateKey,(0,Y.l_)((0,X.qD)(cn,{newType:kn})))),removeVariable:cn=>{_t((0,W.kb)(cn.rootStateKey,(0,Y.Hr)((0,X.qD)(cn,{reIndex:!0}))))}}),Ke=(0,E.connect)(Ce,je);class _e extends s.PureComponent{constructor(){super(...arguments),this.state={showDeleteModal:!1},this.onNameChange=cn=>{cn.preventDefault(),this.props.changeVariableName(this.props.identifier,cn.currentTarget.value)},this.onTypeChange=cn=>{cn.value&&this.props.changeVariableType(this.props.identifier,cn.value)},this.onLabelChange=cn=>{cn.preventDefault(),this.props.changeVariableProp(this.props.identifier,"label",cn.currentTarget.value)},this.onDescriptionChange=cn=>{this.props.changeVariableProp(this.props.identifier,"description",cn.currentTarget.value)},this.onHideChange=cn=>{this.props.changeVariableProp(this.props.identifier,"hide",cn)},this.onPropChanged=({propName:cn,propValue:kn,updateOptions:Kn=!1})=>{this.props.changeVariableProp(this.props.identifier,cn,kn),Kn&&this.props.updateOptions((0,X.jX)(this.props.variable))},this.onHandleSubmit=async cn=>{cn.preventDefault(),this.props.editor.isValid&&this.props.updateOptions((0,X.jX)(this.props.variable))},this.onModalOpen=()=>{this.setState({showDeleteModal:!0})},this.onModalClose=()=>{this.setState({showDeleteModal:!1})},this.onDelete=()=>{this.props.removeVariable(this.props.identifier),this.onModalClose(),g.Ny.partial({editIndex:null})},this.onApply=()=>{g.Ny.partial({editIndex:null})},this.getVariableOptions=()=>{const{variable:cn}=this.props;return(0,oe.SP)(cn)?cn.options.map(kn=>({label:String(kn.text),value:String(kn.value)})):[]}}componentDidMount(){this.props.variableEditorMount(this.props.identifier)}componentWillUnmount(){this.props.variableEditorUnMount(this.props.identifier)}render(){const{theme:cn,variable:kn}=this.props,Kn=ae.B.get(this.props.variable.type).editor;if(!Kn)return null;const ns=kn.state===H.Gu.Loading,Rs=window.matchMedia("(prefers-reduced-motion: reduce)").matches,Os=Ct(cn);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("form",{"aria-label":"Variable editor Form",onSubmit:this.onHandleSubmit,children:[(0,n.jsx)(de,{onChange:this.onTypeChange,type:this.props.variable.type}),(0,n.jsx)(ne.Y,{children:"General"}),(0,n.jsx)(_._,{value:this.props.editor.name,onChange:this.onNameChange,name:"Name",placeholder:"Variable name",description:"The name of the template variable. (Max. 50 characters)",invalid:!!this.props.editor.errors.name,error:this.props.editor.errors.name,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:We.M.MaxSize,required:!0}),(0,n.jsx)(_._,{name:"Label",description:"Optional display name",value:this.props.variable.label??"",placeholder:"Label name",onChange:this.onLabelChange,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,n.jsx)(le.Z,{name:"Description",value:kn.description??"",placeholder:"Descriptive text",onChange:this.onDescriptionChange,width:52}),(0,n.jsx)(se.D,{onChange:this.onHideChange,hide:this.props.variable.hide,type:this.props.variable.type}),Kn&&(0,n.jsx)(Kn,{variable:this.props.variable,onPropChange:this.onPropChanged}),(0,oe.SP)(this.props.variable)?(0,n.jsx)(Q.j,{options:this.getVariableOptions()}):null,(0,n.jsx)("div",{style:{marginTop:"16px"},children:(0,n.jsxs)(M.Gy,{spacing:"md",height:"inherit",children:[(0,n.jsx)(o.$n,{variant:"destructive",fill:"outline",onClick:this.onModalOpen,children:"Delete"}),(0,n.jsxs)(o.$n,{type:"submit","data-testid":i.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,disabled:ns,variant:"secondary",children:["Run query",ns&&(0,n.jsx)(T.I,{className:Os.spin,name:Rs?"hourglass":"sync",size:"sm",style:{marginLeft:"2px"}})]}),(0,n.jsx)(o.$n,{variant:"primary",onClick:this.onApply,"data-testid":i.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,children:"Apply"})]})})]}),(0,n.jsx)(G,{isOpen:this.state.showDeleteModal,varName:this.props.editor.name,onConfirm:this.onDelete,onDismiss:this.onModalClose})]})}}const Fe=(0,P.cV)(Ke(_e)),at=(0,y.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),Ct=_t=>({spin:(0,y.css)({[_t.transitions.handleMotion("no-preference")]:{animation:`${at} 3s linear infinite`}})});var Dt=e(91076),tt=e(69529),ze=e(72109);const pe=({variables:_t})=>{const cn=(0,s.useMemo)(()=>(0,j.hI)(_t),[_t]),kn=(0,s.useMemo)(()=>(0,j.qJ)(_t),[_t]);return kn.length?(0,n.jsx)(L.i,{show:!1,title:"Dependencies",nodes:(0,j.H7)(cn,kn),edges:kn,children:({showModal:Kn})=>(0,n.jsx)(o.$n,{onClick:()=>{(0,D.rR)("Show variable dependencies"),Kn()},icon:"channel-add",variant:"secondary",children:"Show dependencies"})}):null},Se=({id:_t,usages:cn,isAdhoc:kn})=>{const Kn=(0,s.useMemo)(()=>cn.find(Rs=>Rs.variable.id===_t),[cn,_t]);if(cn.length===0||kn||!Kn)return null;const ns=Kn.nodes.map(Rs=>Rs.label.includes(`$${_t}`)?{...Rs,color:"#FB7E81"}:Rs);return(0,n.jsx)(L.i,{show:!1,title:`Showing usages for: $${_t}`,nodes:ns,edges:Kn.edges,children:({showModal:Rs})=>(0,n.jsx)(S.K,{onClick:()=>{(0,D.rR)("Show variable usages"),Rs()},name:"code-branch",tooltip:"Show usages"})})};function fe({index:_t,variable:cn,usageTree:kn,usagesNetwork:Kn,onEdit:ns,onDuplicate:Rs,onDelete:Os}){const ha=(0,P.$j)(),na=(0,P.of)(he),wa=Ee(cn),Ma=(0,j.PK)(cn.id,kn)>0||cn.type==="adhoc",ks=(0,X.jX)(cn);return(0,n.jsx)(Dt.sx,{draggableId:JSON.stringify(ks),index:_t,children:(oo,go)=>(0,n.jsxs)("tr",{ref:oo.innerRef,...oo.draggableProps,style:{userSelect:go.isDragging?"none":"auto",background:go.isDragging?ha.colors.background.secondary:void 0,...oo.draggableProps.style},children:[(0,n.jsx)("td",{role:"gridcell",className:na.column,children:(0,n.jsx)(o.$n,{size:"xs",fill:"text",onClick:qr=>{qr.preventDefault(),ns(ks)},className:na.nameLink,"aria-label":i.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(cn.name),children:cn.name})}),(0,n.jsx)("td",{role:"gridcell",className:na.definitionColumn,onClick:qr=>{qr.preventDefault(),ns(ks)},"aria-label":i.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(cn.name),children:wa}),(0,n.jsx)("td",{role:"gridcell",className:na.column,children:(0,n.jsxs)("div",{className:na.icons,children:[(0,n.jsx)(Pe,{passed:Ma}),(0,n.jsx)(Se,{id:cn.id,isAdhoc:cn.type==="adhoc",usages:Kn}),(0,n.jsx)(S.K,{onClick:qr=>{qr.preventDefault(),(0,D.rR)("Duplicate variable"),Rs(ks)},name:"copy",tooltip:"Duplicate variable","aria-label":i.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(cn.name)}),(0,n.jsx)(S.K,{onClick:qr=>{qr.preventDefault(),(0,D.rR)("Delete variable"),Os(ks)},name:"trash-alt",tooltip:"Remove variable","aria-label":i.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(cn.name)}),(0,n.jsx)("div",{...oo.dragHandleProps,className:na.dragHandle,children:(0,n.jsx)(T.I,{name:"draggabledots",size:"lg"})})]})})]})})}function Ee(_t){let cn="";return _t.type==="query"?_t.definition?cn=_t.definition:typeof _t.query=="string"&&(cn=_t.query):(0,oe.SP)(_t)&&(cn=_t.query),cn}function Pe({passed:_t}){const cn=(0,P.of)(he);return _t?(0,n.jsx)(T.I,{name:"check",className:cn.iconPassed,title:"This variable is referenced by other variables or dashboard."}):(0,n.jsx)(T.I,{name:"exclamation-triangle",className:cn.iconFailed,title:"This variable is not referenced by any variable or dashboard."})}function he(_t){return{dragHandle:(0,y.css)`
      cursor: grab;
      margin-left: ${_t.spacing(1)};
    `,column:(0,y.css)`
      width: 1%;
    `,nameLink:(0,y.css)`
      cursor: pointer;
      color: ${_t.colors.primary.text};
    `,definitionColumn:(0,y.css)`
      width: 100%;
      max-width: 200px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      -o-text-overflow: ellipsis;
      white-space: nowrap;
    `,iconPassed:(0,y.css)`
      color: ${_t.v1.palette.greenBase};
      margin-right: ${_t.spacing(2)};
    `,iconFailed:(0,y.css)`
      color: ${_t.v1.palette.orange};
      margin-right: ${_t.spacing(2)};
    `,icons:(0,y.css)`
      display: flex;
      gap: ${_t.spacing(2)};
      align-items: center;
    `}}function be({variables:_t,usages:cn,usagesNetwork:kn,onChangeOrder:Kn,onAdd:ns,onEdit:Rs,onDelete:Os,onDuplicate:ha}){const na=(0,P.of)(De),wa=pr=>{if(!pr.destination||!pr.source)return;(0,D.rR)("Variable drag and drop");const Ma=JSON.parse(pr.draggableId);Kn(Ma,_t[pr.source.index].index,_t[pr.destination.index].index)};return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:[_t.length===0&&(0,n.jsx)(Ae,{onAdd:ns}),_t.length>0&&(0,n.jsxs)(c.B,{direction:"column",gap:4,children:[(0,n.jsx)("div",{className:na.tableContainer,children:(0,n.jsxs)("table",{className:"filter-table filter-table--hover","aria-label":i.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Variable"}),(0,n.jsx)("th",{children:"Definition"}),(0,n.jsx)("th",{colSpan:5})]})}),(0,n.jsx)(Dt.JY,{onDragEnd:wa,children:(0,n.jsx)(Dt.gL,{droppableId:"variables-list",direction:"vertical",children:pr=>(0,n.jsxs)("tbody",{ref:pr.innerRef,...pr.droppableProps,children:[_t.map((Ma,ks)=>(0,n.jsx)(fe,{index:ks,variable:Ma,usageTree:cn,usagesNetwork:kn,onDelete:Os,onDuplicate:ha,onEdit:Rs},`${Ma.name}-${ks}`)),pr.placeholder]})})})]})}),(0,n.jsxs)(c.B,{children:[(0,n.jsx)(pe,{variables:_t}),(0,n.jsx)(o.$n,{"aria-label":i.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:ns,icon:"plus",children:"New variable"})]})]})]})})}function Ae({onAdd:_t}){return(0,n.jsx)(c.B,{direction:"column",children:(0,n.jsxs)(tt.p,{variant:"call-to-action",button:(0,n.jsx)(o.$n,{"data-testid":i.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:_t,size:"lg",children:(0,n.jsx)(m.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,m.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(m.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,n.jsxs)(m.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,n.jsx)(ze.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const De=()=>({tableContainer:(0,y.css)`
    overflow: scroll;
    width: 100%;
  `}),Ie=(_t,cn)=>{const{uid:kn}=cn.dashboard,Kn=(0,z.nx)(kn,_t);return{variables:(0,z.nS)(kn,_t),idInEditor:Kn.editor.id,usagesNetwork:Kn.inspect.usagesNetwork,usages:Kn.inspect.usages}},ke=_t=>({...(0,h.bindActionCreators)({createNewVariable:Xe,initListMode:we},_t),changeVariableOrder:(cn,kn,Kn)=>_t((0,W.kb)(cn.rootStateKey,(0,Y.hj)((0,X.qD)(cn,{fromIndex:kn,toIndex:Kn})))),duplicateVariable:cn=>_t((0,W.kb)(cn.rootStateKey,(0,Y.ut)((0,X.qD)(cn,{newId:void 0})))),removeVariable:cn=>{_t((0,W.kb)(cn.rootStateKey,(0,Y.Hr)((0,X.qD)(cn,{reIndex:!0}))))}}),dt=(0,E.connect)(Ie,ke);class Pt extends s.PureComponent{constructor(){super(...arguments),this.state={variableId:void 0},this.onEditVariable=cn=>{const kn=this.props.variables.findIndex(Kn=>Kn.id===cn.id);g.Ny.partial({editIndex:kn})},this.onNewVariable=()=>{this.props.createNewVariable(this.props.dashboard.uid)},this.onChangeVariableOrder=(cn,kn,Kn)=>{this.props.changeVariableOrder(cn,kn,Kn)},this.onDuplicateVariable=cn=>{this.props.duplicateVariable(cn)},this.onModalOpen=cn=>{this.setState({variableId:cn})},this.onModalClose=()=>{this.setState({variableId:void 0})},this.onRemoveVariable=()=>{this.props.removeVariable(this.state.variableId),this.onModalClose()}}componentDidMount(){this.props.initListMode(this.props.dashboard.uid)}render(){const{editIndex:cn,variables:kn,sectionNav:Kn}=this.props,ns=cn!=null?kn[cn]:void 0,Os=Kn.node.parentItem,ha=ns?{text:ns.name,parentItem:Os}:Os;return(0,n.jsxs)(u.Y,{navModel:this.props.sectionNav,pageNav:ha,children:[!ns&&(0,n.jsx)(be,{variables:this.props.variables,onAdd:this.onNewVariable,onEdit:this.onEditVariable,onChangeOrder:this.onChangeVariableOrder,onDuplicate:this.onDuplicateVariable,onDelete:this.onModalOpen,usages:this.props.usages,usagesNetwork:this.props.usagesNetwork}),!ns&&this.props.variables.length>0&&(0,n.jsx)(F,{variables:this.props.variables,dashboard:this.props.dashboard}),ns&&(0,n.jsx)(Fe,{identifier:(0,X.jX)(ns)}),(0,n.jsx)(G,{isOpen:this.state.variableId!==void 0,varName:this.state.variableId?.id??"",onConfirm:this.onRemoveVariable,onDismiss:this.onModalClose})]})}}const pt=dt(Pt);var Tt=e(52487),jt=e(10096);const $t=({dashboard:_t,sectionNav:cn})=>{const kn=jt.contextSrv.hasPermission(x.AccessControlAction.DashboardsPermissionsWrite),Kn=cn.node.parentItem;return(0,n.jsx)(u.Y,{navModel:cn,pageNav:Kn,children:(0,n.jsx)(Tt.x,{resource:"dashboards",resourceId:_t.uid,canSetPermissions:kn})})};var sn=e(78050),Yt=e(22391),qt=e(19347),bn=e(84167),Mt=e(88575),Jt=e(10354),Ut=e(10880),Gt=e(90182),Lt=e(77268),At=e(2913),Nt=e(82241),Dn=e(46502),An=e(51612);const Pn="New annotation",Xn=({editIdx:_t,dashboard:cn})=>{const kn=(0,P.of)(Tn),[Kn,ns]=(0,s.useState)(cn.annotations.list[_t]),Rs=(0,s.useMemo)(()=>Kn.filter?Kn.filter.exclude?2:1:0,[Kn.filter]),{value:Os}=(0,b.A)(()=>(0,qt.l)().get(Kn.datasource),[Kn.datasource]),ha=(0,qt.l)().getInstanceSettings(Kn.datasource),na=tr=>{const Vr=[...cn.annotations.list];Vr.splice(_t,1,tr),ns(tr),cn.annotations.list=Vr},wa=tr=>{na({...Kn,name:tr.currentTarget.value})},pr=tr=>{const Vr=(0,Yt.p$)(tr);Kn.datasource?.type!==Vr.type?na({datasource:Vr,builtIn:Kn.builtIn,enable:Kn.enable,iconColor:Kn.iconColor,name:Kn.name,hide:Kn.hide,filter:Kn.filter,mappings:Kn.mappings,type:Kn.type}):na({...Kn,datasource:Vr})},Ma=tr=>{const Vr=tr.currentTarget;na({...Kn,[Vr.name]:Vr.type==="checkbox"?Vr.checked:Vr.value})},ks=tr=>{na({...Kn,iconColor:tr})},oo=tr=>{let Vr=tr.value===0?void 0:{exclude:tr.value===2,ids:Kn.filter?.ids??[]};na({...Kn,filter:Vr})},go=tr=>{if(!Array.isArray(tr))return;const Vr={exclude:Rs===2,ids:[]};tr.forEach(io=>io.value&&Vr.ids.push(io.value)),na({...Kn,filter:Vr})},qr=ht,po=()=>{g.Ny.partial({editview:null,editIndex:null})},yo=()=>{const tr=cn.annotations.list;cn.annotations.list=[...tr.slice(0,_t),...tr.slice(_t+1)],ht()},hi=Kn.name===Pn,Di=(tr,Vr)=>tr.label&&Vr.label?tr.label.toLowerCase().localeCompare(Vr.label.toLowerCase()):-1,Rr=(0,s.useMemo)(()=>cn?.panels.filter(tr=>At.Ay.panels[tr.type]).map(tr=>({value:tr.id,label:tr.title??`Panel ${tr.id}`,description:tr.description,imgUrl:At.Ay.panels[tr.type].info.logos.small})).sort(Di)??[],[cn]);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(bn.n,{className:kn.settingsForm,children:[(0,n.jsx)(Mt.D,{label:"Name",children:(0,n.jsx)(Jt.p,{"data-testid":i.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:hi,value:Kn.name,onChange:wa})}),(0,n.jsx)(Mt.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,n.jsx)(An.s,{annotations:!0,variables:!0,current:Kn.datasource,onChange:pr})}),(0,n.jsx)(Mt.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,n.jsx)(Ut.S,{name:"enable",id:"enable",value:Kn.enable,onChange:Ma})}),(0,n.jsx)(Mt.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,n.jsx)(Ut.S,{name:"hide",id:"hide",value:Kn.hide,onChange:Ma})}),(0,n.jsx)(Mt.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,n.jsx)(M.Gy,{children:(0,n.jsx)(Lt.a,{value:Kn?.iconColor,onChange:ks})})}),(0,n.jsx)(Mt.D,{label:"Show in","data-testid":i.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Gt.l6,{options:Ge,value:Rs,onChange:oo,"data-testid":i.Tp.components.Annotations.annotationsTypeInput}),Rs!==0&&(0,n.jsx)(Gt.KF,{options:Rr,value:Rr.filter(tr=>Kn.filter?.ids.includes(tr.value)),onChange:go,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:kn.select,"data-testid":i.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,n.jsxs)(bn.n,{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Query"}),Os?.annotations&&ha&&(0,n.jsx)(Nt.A,{datasource:Os,datasourceInstanceSettings:ha,annotation:Kn,onChange:na}),Os&&!Os.annotations&&(0,n.jsx)(Dn.F,{datasource:Os,annotation:Kn,onChange:na})]}),(0,n.jsxs)(c.B,{children:[!Kn.builtIn&&(0,n.jsx)(o.$n,{variant:"destructive",onClick:yo,children:"Delete"}),(0,n.jsx)(o.$n,{variant:"secondary",onClick:po,"data-testid":i.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.previewInDashboard,children:"Preview in dashboard"}),(0,n.jsx)(o.$n,{variant:"primary",onClick:qr,children:"Apply"})]})]})},Tn=_t=>({settingsForm:(0,y.css)({maxWidth:_t.spacing(60),marginBottom:_t.spacing(2)}),select:(0,y.css)({marginTop:"8px"})});function ht(){g.Ny.partial({editIndex:null})}var St=(_t=>(_t[_t.AllPanels=0]="AllPanels",_t[_t.IncludePanels=1]="IncludePanels",_t[_t.ExcludePanels=2]="ExcludePanels",_t))(St||{});const Ge=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Ve=e(14588),lt=e(91605),It=e(46991);const Qe=({dashboard:_t,onNew:cn,onEdit:kn})=>{const Kn=(0,P.of)(vt),[ns,Rs]=(0,s.useState)(_t.annotations.list),Os=(Ma,ks)=>{_t.annotations.list=Ve.moveItemImmutably(ns,Ma,Ma+ks),Rs(_t.annotations.list)},ha=Ma=>{_t.annotations.list=[...ns.slice(0,Ma),...ns.slice(Ma+1)],Rs(_t.annotations.list)},na=ns.length===0||ns.length===1&&ns[0].builtIn,wa=Ma=>Ma.enable===!1?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",Ma.name]})}):Ma.builtIn?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("em",{className:"muted",children:[Ma.name," \xA0 (Built-in)"]})}):(0,n.jsx)(n.Fragment,{children:Ma.name}),pr=(0,qt.l)();return(0,n.jsxs)(c.B,{direction:"column",children:[ns.length>0&&(0,n.jsx)("div",{className:Kn.table,children:(0,n.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Query name"}),(0,n.jsx)("th",{children:"Data source"}),(0,n.jsx)("th",{colSpan:3})]})}),(0,n.jsx)("tbody",{children:_t.annotations.list.map((Ma,ks)=>(0,n.jsxs)("tr",{children:[Ma.builtIn?(0,n.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>kn(ks),children:(0,n.jsx)(o.$n,{size:"sm",fill:"text",variant:"secondary",children:wa(Ma)})}):(0,n.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>kn(ks),children:(0,n.jsx)(o.$n,{size:"sm",fill:"text",variant:"secondary",children:wa(Ma)})}),(0,n.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>kn(ks),children:pr.getInstanceSettings(Ma.datasource)?.name||Ma.datasource?.uid}),(0,n.jsx)("td",{role:"gridcell",style:{width:"1%"},children:ks!==0&&(0,n.jsx)(S.K,{name:"arrow-up",onClick:()=>Os(ks,-1),tooltip:"Move up"})}),(0,n.jsx)("td",{role:"gridcell",style:{width:"1%"},children:_t.annotations.list.length>1&&ks!==_t.annotations.list.length-1?(0,n.jsx)(S.K,{name:"arrow-down",onClick:()=>Os(ks,1),tooltip:"Move down"}):null}),(0,n.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!Ma.builtIn&&(0,n.jsx)(lt.e,{size:"sm",onConfirm:()=>ha(ks),"aria-label":`Delete query with title "${Ma.name}"`})})]},`${Ma.name}-${ks}`))})]})}),na&&(0,n.jsx)(c.B,{direction:"column",children:(0,n.jsxs)(tt.p,{variant:"call-to-action",button:(0,n.jsx)(o.$n,{"data-testid":i.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:cn,size:"lg",children:(0,n.jsx)(m.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,m.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,n.jsx)(m.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,n.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,n.jsxs)(m.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,n.jsx)(ze.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!na&&(0,n.jsx)(It.d,{"data-testid":i.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:cn,children:"New query"})]})},vt=()=>({table:(0,y.css)({width:"100%",overflowX:"scroll"})});function Ot({dashboard:_t,editIndex:cn,sectionNav:kn}){const Kn=()=>{const Os={name:Pn,enable:!0,datasource:(0,Yt.p$)((0,qt.l)().getInstanceSettings(null)),iconColor:"red"};_t.annotations.list=[..._t.annotations.list,{...Os}],g.Ny.partial({editIndex:_t.annotations.list.length-1})},ns=Os=>{g.Ny.partial({editIndex:Os})},Rs=cn!=null&&cn<_t.annotations.list.length;return(0,n.jsxs)(u.Y,{navModel:kn,pageNav:zt(_t,cn,kn.node),children:[!Rs&&(0,n.jsx)(Qe,{dashboard:_t,onNew:Kn,onEdit:ns}),Rs&&(0,n.jsx)(Xn,{dashboard:_t,editIdx:cn})]})}function zt(_t,cn,kn){const Kn=kn.parentItem;if(cn==null)return Kn;const ns=_t.annotations.list[cn];if(ns)return{text:ns.name,parentItem:Kn}}var vn=e(32264),ln=e(90613),On=e(60029),wn=e(21744),Un=e(79924),cs=e(94354),Zn=e(36607),wt=e(3673),Ft=e(71678),Ht=e(14792),ut=e(5805),pn=e(68402),Jn=e(37390),Qn=e(11230);const fs={cleanUpDashboardAndVariables:wt.Bz},ls=(0,E.connect)(null,fs),vs=({hideModal:_t,cleanUpDashboardAndVariables:cn,dashboard:kn})=>{const Kn=kn.meta.provisioned,[,ns]=(0,ut.default)(async()=>{(0,D.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_settings",restore_enabled:vn.$.featureToggles.dashboardRestoreUI}),await(0,Qn.A_)(kn.uid,!0),cn(),_t(),g.Ny.replace("/")},[_t]);return Kn?(0,n.jsx)(ea,{hideModal:_t,provisionedId:kn.meta.provisionedExternalId}):(0,n.jsx)(q.u,{isOpen:!0,body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.E,{element:"p",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.dashboard-delete-modal.text",children:"Do you want to delete this dashboard?"})}),(0,n.jsx)(pn.$,{v:1}),(0,n.jsx)(a.E,{element:"p",children:kn.title}),(0,n.jsx)(pn.$,{v:2})]}),onConfirm:ns,onDismiss:_t,title:(0,m.t)("dashboard-settings.dashboard-delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,m.t)("dashboard-settings.dashboard-delete-modal.delete-button","Delete"),confirmationText:(0,m.t)("dashboard-settings.dashboard-delete-modal.confirmation-text","Delete")})},ea=({hideModal:_t,provisionedId:cn})=>(0,n.jsxs)(Jn.a,{isOpen:!0,title:(0,m.t)("dashboard-settings.provisioned-delete-modal.title","Cannot delete provisioned dashboard"),icon:"trash-alt",onDismiss:_t,className:(0,y.css)({width:"500px"}),children:[(0,n.jsx)(a.E,{element:"p",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-1",children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."})}),(0,n.jsx)(pn.$,{v:1}),(0,n.jsxs)(a.E,{element:"p",children:[(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-2",children:"See grafana documentation for more information about provisioning.\xA0"}),(0,n.jsx)(ze.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:(0,m.t)("dashboard-settings.provisioned-delete-modal.text-link","Go to docs page")})]}),(0,n.jsx)(pn.$,{v:2}),(0,n.jsx)(a.E,{element:"p",children:(0,n.jsxs)(m.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.text-3",children:["File path: ",{provisionedId:cn}]})}),(0,n.jsx)(Jn.a.ButtonRow,{children:(0,n.jsx)(o.$n,{variant:"primary",onClick:_t,children:(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.provisioned-delete-modal.confirm-button",children:"OK"})})})]}),Ks=ls(vs),Hs=()=>{const _t=(0,Ht.UA)().getCurrent();return(0,n.jsx)(Ft.$s,{children:({showModal:cn,hideModal:kn})=>(0,n.jsx)(o.$n,{variant:"destructive",onClick:()=>{cn(Ks,{dashboard:_t,hideModal:kn})},"data-testid":i.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})})})};var bs=e(81394),Ys=e(27966),La=e(75590);const Xs=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];function Ta({dashboard:_t,updateTimeZone:cn,updateWeekStart:kn,sectionNav:Kn}){const[ns,Rs]=(0,s.useState)(0),[Os,ha]=(0,s.useState)(_t.title),[na,wa]=(0,s.useState)(_t.description),pr=Kn.node.parentItem,Ma=(ja,Xo)=>{_t.meta.folderUid=ja,_t.meta.folderTitle=Xo,_t.meta.hasUnsavedFolderChange=!0,Rs(ns+1)},ks=(0,s.useCallback)(ja=>{_t.title=ja,ha(ja)},[ha,_t]),oo=(0,s.useCallback)(ja=>{_t.description=ja,wa(ja)},[wa,_t]),go=ja=>{_t.graphTooltip=ja,Rs(ns+1)},qr=ja=>{_t.timepicker.refresh_intervals=ja.filter(Xo=>Xo.trim()!=="")},po=ja=>{_t.timepicker.nowDelay=ja},yo=ja=>{_t.timepicker.hidden=ja,Rs(ns+1)},hi=ja=>{_t.liveNow=ja,Rs(ns+1)},Di=ja=>{_t.timezone=ja,Rs(ns+1),cn(ja)},Rr=ja=>{_t.weekStart=ja,Rs(ns+1),kn(ja)},tr=ja=>{_t.tags=ja,Rs(ns+1)},Vr=ja=>{_t.editable=ja,Rs(ns+1)},io=[{label:"Editable",value:!0},{label:"Read-only",value:!1}];return(0,n.jsx)(u.Y,{navModel:Kn,pageNav:pr,children:(0,n.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,n.jsxs)(ln.a,{marginBottom:5,children:[(0,n.jsx)(Mt.D,{label:(0,n.jsxs)(c.B,{justifyContent:"space-between",children:[(0,n.jsx)(On.J,{htmlFor:"title-input",children:(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),vn.$.featureToggles.dashgpt&&(0,n.jsx)(Ys.Z,{onGenerate:ks})]}),children:(0,n.jsx)(Jt.p,{id:"title-input",name:"title",value:Os,onChange:ja=>ks(ja.target.value)})}),(0,n.jsx)(Mt.D,{label:(0,n.jsxs)(c.B,{justifyContent:"space-between",children:[(0,n.jsx)(On.J,{htmlFor:"description-input",children:(0,m.t)("dashboard-settings.general.description-label","Description")}),vn.$.featureToggles.dashgpt&&(0,n.jsx)(bs.V,{onGenerate:oo})]}),children:(0,n.jsx)(wn.f,{id:"description-input",name:"description",value:na,onChange:ja=>oo(ja.target.value)})}),(0,n.jsx)(Mt.D,{label:(0,m.t)("dashboard-settings.general.tags-label","Tags"),children:(0,n.jsx)(Un.u,{id:"tags-input",tags:_t.tags,onChange:tr,width:40})}),(0,n.jsx)(Mt.D,{label:(0,m.t)("dashboard-settings.general.folder-label","Folder"),children:(0,n.jsx)(Zn.d,{value:_t.meta.folderUid,onChange:Ma,initialTitle:_t.meta.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,dashboardId:_t.id,skipInitialLoad:!0})}),(0,n.jsx)(Mt.D,{label:(0,m.t)("dashboard-settings.general.editable-label","Editable"),description:(0,m.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,n.jsx)(cs.z,{value:_t.editable,options:io,onChange:Vr})})]}),(0,n.jsx)(La.p,{onTimeZoneChange:Di,onWeekStartChange:Rr,onRefreshIntervalChange:qr,onNowDelayChange:po,onHideTimePickerChange:yo,onLiveNowChange:hi,refreshIntervals:_t.timepicker.refresh_intervals,timePickerHidden:_t.timepicker.hidden,nowDelay:_t.timepicker.nowDelay,timezone:_t.timezone,weekStart:_t.weekStart,liveNow:_t.liveNow}),(0,n.jsx)(C.M,{label:(0,m.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:(0,n.jsx)(Mt.D,{label:(0,m.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,m.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,n.jsx)(cs.z,{onChange:go,options:Xs,value:_t.graphTooltip})})}),(0,n.jsx)(ln.a,{marginTop:3,children:_t.meta.canDelete&&(0,n.jsx)(Hs,{})})]})})}const Lr={updateTimeZone:wt.lC,updateWeekStart:wt.Ss},Za=(0,E.connect)(null,Lr)(Ta);var Er=e(32372),Ar=e(6473);function ho({dashboard:_t,sectionNav:cn}){const kn=_t.getSaveModelClone(),[Kn,ns]=(0,s.useState)(JSON.stringify(kn,null,2)),Rs=cn.node.parentItem,Os=async()=>{await(0,Ht.UA)().saveJSONDashboard(Kn),Ar.t.reloadPage()},ha=(0,P.of)(Fr);return(0,n.jsx)(u.Y,{navModel:cn,pageNav:Rs,children:(0,n.jsxs)("div",{className:ha.wrapper,children:[(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,n.jsx)(Er.B,{value:Kn,language:"json",showMiniMap:!0,showLineNumbers:!0,onBlur:ns,containerStyles:ha.codeEditor}),_t.meta.canSave&&(0,n.jsx)("div",{children:(0,n.jsx)(o.$n,{type:"submit",onClick:Os,children:(0,n.jsx)(m.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})})})]})})}const Fr=_t=>({wrapper:(0,y.css)({display:"flex",height:"100%",flexDirection:"column",gap:_t.spacing(2)}),codeEditor:(0,y.css)({flexGrow:1})});var rr=e(4588),fo=e(65857);const _o=({editLinkIdx:_t,dashboard:cn,onGoBack:kn})=>{const[Kn,ns]=(0,s.useState)(_t!==null?cn.links[_t]:rr.q),Rs=Os=>{const ha=[...cn.links];ha.splice(_t,1,Os),cn.links=ha,ns(Os)};return(0,n.jsx)(fo.d,{link:Kn,onUpdate:Rs,onGoBack:kn})};var gr=e(6199);const ci=({dashboard:_t,onNew:cn,onEdit:kn})=>{const[Kn,ns]=(0,s.useState)(_t.links),Rs=(na,wa)=>{_t.links=Ve.moveItemImmutably(Kn,na,na+wa),ns(_t.links)},Os=na=>{_t.links=[...Kn,{...na}],ns(_t.links)},ha=na=>{_t.links=[...Kn.slice(0,na),...Kn.slice(na+1)],ns(_t.links)};return(0,n.jsx)(gr.X,{links:Kn,onNew:cn,onEdit:kn,onDuplicate:Os,onDelete:ha,onOrderChange:Rs})};function Qo({dashboard:_t,sectionNav:cn,editIndex:kn}){const[Kn,ns]=(0,s.useState)(!1),Rs=()=>{ns(!1),g.Ny.partial({editIndex:void 0})},Os=()=>{_t.links=[..._t.links,{...rr.q}],ns(!0),g.Ny.partial({editIndex:_t.links.length-1})},ha=pr=>{ns(!1),g.Ny.partial({editIndex:pr})},na=kn!==void 0;let wa=cn.node.parentItem;return na&&(wa={text:Kn?"New link":"Edit link",subTitle:Kn?"Create a new link on your dashboard":"Edit a specific link of your dashboard",parentItem:cn.node.parentItem}),(0,n.jsxs)(u.Y,{navModel:cn,pageNav:wa,children:[!na&&(0,n.jsx)(ci,{dashboard:_t,onNew:Os,onEdit:ha}),na&&(0,n.jsx)(_o,{dashboard:_t,editLinkIdx:kn,onGoBack:Rs})]})}var eo=e(57714),Do=e(19626),di=e(22764),bo=e(56596),Oo=e(41053),To=e(3169);const jo=async(_t,cn)=>(Ar.t.ignoreNextSave(),await eo.wL.restoreDashboard(cn.uid,_t)),$o=_t=>{const cn=(0,x.useSelector)(Rs=>Rs.dashboard.getModel()),[kn,Kn]=(0,Oo.A)(async()=>await jo(_t,cn),[]),ns=(0,To._2)();return(0,s.useEffect)(()=>{if(kn.value){const Rs=g.Ny.getLocation(),Os=r.I.stripBaseFromUrl(kn.value.url),ha=Rs.state?.routeReloadCounter;g.Ny.replace({...Rs,pathname:Os,state:{routeReloadCounter:ha?ha+1:1}}),ns.success("Dashboard restored",`Restored from version ${_t}`)}},[kn,_t,ns]),{state:kn,onRestoreDashboard:Kn}},Yo=({hideModal:_t,version:cn})=>{const{state:kn,onRestoreDashboard:Kn}=$o(cn);return(0,s.useEffect)(()=>{!kn.loading&&kn.value&&_t()},[kn,_t]),(0,n.jsx)(q.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:_t,onConfirm:Kn,body:(0,n.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",cn,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${cn}`})},Si=({baseInfo:_t,newInfo:cn,diffData:kn,isNewLatest:Kn})=>{const ns=(0,bo.G4)(kn.lhs,kn.rhs),Rs=(0,P.of)(vi);return(0,n.jsxs)(c.B,{direction:"column",gap:1,children:[(0,n.jsxs)(c.B,{justifyContent:"space-between",alignItems:"center",children:[(0,n.jsxs)(c.B,{alignItems:"center",children:[(0,n.jsxs)("span",{className:(0,y.cx)(Rs.versionInfo,Rs.noMarginBottom),children:[(0,n.jsxs)("strong",{children:["Version ",_t.version]})," updated by ",_t.createdBy," ",_t.ageString,_t.message]}),(0,n.jsx)(T.I,{name:"arrow-right",size:"sm"}),(0,n.jsxs)("span",{className:Rs.versionInfo,children:[(0,n.jsxs)("strong",{children:["Version ",cn.version]})," updated by ",cn.createdBy," ",cn.ageString,cn.message]})]}),Kn&&(0,n.jsx)(Ft.$s,{children:({showModal:Os,hideModal:ha})=>(0,n.jsxs)(o.$n,{variant:"destructive",icon:"history",onClick:()=>{Os(Yo,{version:_t.version,hideModal:ha})},children:["Restore to version ",_t.version]})})]}),Object.entries(ns).map(([Os,ha])=>(0,n.jsx)(Do.D,{diffs:ha,title:Os},Os)),(0,n.jsx)(ln.a,{paddingTop:2,children:(0,n.jsx)(C.M,{isOpen:!1,label:"View JSON Diff",children:(0,n.jsx)(di.M,{oldValue:JSON.stringify(kn.lhs,null,2),newValue:JSON.stringify(kn.rhs,null,2)})})})]})},vi=_t=>({versionInfo:(0,y.css)({color:_t.colors.text.secondary,fontSize:_t.typography.bodySmall.fontSize}),noMarginBottom:(0,y.css)({marginBottom:0})});var ai=e(78369);const yi=({versions:_t,canCompare:cn,onCheck:kn})=>{const Kn=(0,P.of)(Bo);return(0,n.jsx)("div",{className:Kn.margin,children:(0,n.jsxs)("table",{className:"filter-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"width-4"}),(0,n.jsx)("th",{className:"width-4",children:"Version"}),(0,n.jsx)("th",{className:"width-14",children:"Date"}),(0,n.jsx)("th",{className:"width-10",children:"Updated by"}),(0,n.jsx)("th",{children:"Notes"}),(0,n.jsx)("th",{})]})}),(0,n.jsx)("tbody",{children:_t.map((ns,Rs)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(Ut.S,{"aria-label":`Toggle selection of version ${ns.version}`,className:(0,y.css)({display:"inline"}),checked:ns.checked,onChange:Os=>kn(Os,ns.id),disabled:!ns.checked&&cn})}),(0,n.jsx)("td",{children:ns.version}),(0,n.jsx)("td",{children:ns.createdDateString}),(0,n.jsx)("td",{children:ns.createdBy}),(0,n.jsx)("td",{children:ns.message}),(0,n.jsx)("td",{className:"text-right",children:Rs===0?(0,n.jsx)(ai.v,{name:"Latest",colorIndex:17}):(0,n.jsx)(Ft.$s,{children:({showModal:Os,hideModal:ha})=>(0,n.jsx)(o.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{Os(Yo,{version:ns.version,hideModal:ha})},children:"Restore"})})})]},ns.id))})]})})};function Bo(_t){return{margin:(0,y.css)({marginBottom:_t.spacing(4)})}}const Ai=10;class Ho extends s.PureComponent{constructor(cn){super(cn),this.getVersions=(kn=!1)=>{this.setState({isAppending:kn}),eo.wL.getHistoryList(this.props.dashboard.uid,{limit:this.limit,start:this.start}).then(Kn=>{this.setState({isLoading:!1,versions:[...this.state.versions,...this.decorateVersions(Kn)]}),this.start+=this.limit}).catch(Kn=>console.log(Kn)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const kn=this.state.versions.filter(na=>na.checked),[Kn,ns]=kn,Rs=Kn.version===this.props.dashboard.version;this.setState({isLoading:!0});const Os=await eo.wL.getDashboardVersion(this.props.dashboard.uid,ns.version),ha=await eo.wL.getDashboardVersion(this.props.dashboard.uid,Kn.version);this.setState({baseInfo:ns,isLoading:!1,isNewLatest:Rs,newInfo:Kn,viewMode:"compare",diffData:{lhs:Os.data,rhs:ha.data}})},this.decorateVersions=kn=>kn.map(Kn=>({...Kn,createdDateString:this.props.dashboard.formatDate(Kn.created),ageString:this.props.dashboard.getRelativeTime(Kn.created),checked:!1})),this.onCheck=(kn,Kn)=>{this.setState({versions:this.state.versions.map(ns=>ns.id===Kn?{...ns,checked:kn.currentTarget.checked}:ns)})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.state.versions.map(kn=>({...kn,checked:!1})),viewMode:"list"})},this.limit=Ai,this.start=0,this.state={isAppending:!0,isLoading:!0,versions:[],viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}}componentDidMount(){this.getVersions()}isLastPage(){return this.state.versions.find(cn=>cn.version===1)}render(){const{versions:cn,viewMode:kn,baseInfo:Kn,newInfo:ns,isNewLatest:Rs,isLoading:Os,diffData:ha}=this.state,na=cn.filter(ks=>ks.checked).length===2,wa=cn.length>1,pr=cn.length>=this.limit,Ma=this.props.sectionNav.node.parentItem;return kn==="compare"?(0,n.jsxs)(u.Y,{navModel:this.props.sectionNav,pageNav:Ma,children:[(0,n.jsx)(eo.me,{onClick:this.reset,baseVersion:Kn?.version,newVersion:ns?.version,isNewLatest:Rs}),Os?(0,n.jsx)(ui,{msg:"Fetching changes\u2026"}):(0,n.jsx)(Si,{newInfo:ns,baseInfo:Kn,isNewLatest:Rs,diffData:ha})]}):(0,n.jsxs)(u.Y,{navModel:this.props.sectionNav,pageNav:Ma,children:[Os?(0,n.jsx)(ui,{msg:"Fetching history list\u2026"}):(0,n.jsx)(yi,{versions:cn,onCheck:this.onCheck,canCompare:na}),this.state.isAppending&&(0,n.jsx)(ui,{msg:"Fetching more entries\u2026"}),wa&&(0,n.jsx)(eo.rJ,{hasMore:pr,canCompare:na,getVersions:this.getVersions,getDiff:this.getDiff,isLastPage:!!this.isLastPage()})]})}}const ui=({msg:_t})=>(0,n.jsxs)(M.Gy,{children:[(0,n.jsx)(I.y,{}),(0,n.jsx)("em",{children:_t})]}),Jo=()=>g.Ny.partial({editview:null,editIndex:null});function Ri({dashboard:_t,editview:cn,pageNav:kn,sectionNav:Kn}){const[ns,Rs]=(0,s.useState)(0);(0,s.useEffect)(()=>{_t.events.subscribe(f.Cf,()=>Rs(po=>po+1))},[_t]);const Os=(0,s.useMemo)(()=>xi(_t),[_t,ns]),ha=()=>{_t.meta.hasUnsavedFolderChange=!1},na=Os.find(po=>po.id===cn)??Os[0],wa=v.TP.hasEditPermissionInFolders,pr=_t.meta.canSave,Ma=(0,l.zy)(),ks=Zo(Ma),oo=ri(kn,Kn,Os,na,Ma,_t.uid),go="sm",qr=[(0,n.jsx)(o.$n,{"data-testid":i.Tp.pages.Dashboard.Settings.Actions.close,variant:"secondary",fill:"outline",size:go,onClick:Jo,children:"Close"},"close"),wa&&(0,n.jsx)(sn.m,{dashboard:_t,onSaveSuccess:ha,variant:"secondary",size:go},"save as"),pr&&(0,n.jsx)(sn.C,{dashboard:_t,onSaveSuccess:ha,size:go},"Save")];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.H,{actions:(0,n.jsx)(d.U,{alignment:"right",children:qr})}),(0,n.jsx)(na.component,{sectionNav:oo,dashboard:_t,editIndex:ks})]})}function xi(_t){const cn=[],kn=(0,m.t)("dashboard-settings.general.title","General");_t.meta.canEdit&&(cn.push({title:kn,id:"settings",icon:"sliders-v-alt",component:Za}),cn.push({title:(0,m.t)("dashboard-settings.annotations.title","Annotations"),id:"annotations",icon:"comment-alt",component:Ot,subTitle:"Annotation queries return events that can be visualized as event markers in graphs across the dashboard."}),cn.push({title:(0,m.t)("dashboard-settings.variables.title","Variables"),id:"templating",icon:"calculator-alt",component:pt,subTitle:"Variables can make your dashboard more dynamic and act as global filters."}),cn.push({title:(0,m.t)("dashboard-settings.links.title","Links"),id:"links",icon:"link",component:Qo})),_t.meta.canMakeEditable&&cn.push({title:kn,icon:"sliders-v-alt",id:"settings",component:Ei}),_t.id&&_t.meta.canSave&&cn.push({title:(0,m.t)("dashboard-settings.versions.title","Versions"),id:"versions",icon:"history",component:Ho});const Kn=(0,m.t)("dashboard-settings.permissions.title","Permissions");return _t.id&&_t.meta.canAdmin&&v.TP.hasPermission(x.AccessControlAction.DashboardsPermissionsRead)&&cn.push({title:Kn,id:"permissions",icon:"lock",component:$t}),cn.push({title:(0,m.t)("dashboard-settings.json-editor.title","JSON Model"),id:"dashboard_json",icon:"arrow",component:ho}),cn}function Po(_t,cn){return{..._t,parentItem:_t.parentItem?Po(_t.parentItem,cn):cn}}function ri(_t,cn,kn,Kn,ns,Rs){const Os={text:(0,m.t)("dashboard-settings.settings.title","Settings"),children:[],icon:"apps",hideFromBreadcrumbs:!1,url:r.I.getUrlForPartial(ns,{editview:"settings",editIndex:null})};Os.children=kn.map(na=>({text:na.title,icon:na.icon,id:`${Rs}/${na.id}`,url:r.I.getUrlForPartial(ns,{editview:na.id,editIndex:null}),active:na===Kn,parentItem:Os,subTitle:na.subTitle}));const ha=Po(_t,cn.main);return Os.parentItem=ha,{main:Os,node:Os.children.find(na=>na.active)}}function Ei({dashboard:_t,sectionNav:cn}){return(0,n.jsx)(u.Y,{navModel:cn,children:(0,n.jsxs)(c.B,{direction:"column",gap:2,alignItems:"flex-start",children:[(0,n.jsx)(a.E,{variant:"h3",children:"Dashboard not editable"}),(0,n.jsx)(o.$n,{type:"submit",onClick:()=>_t.makeEditable(),children:"Make editable"})]})})}function Zo(_t){const cn=new URLSearchParams(_t.search).get("editIndex");if(cn!=null)return parseInt(cn,10)}},10740:(k,A,e)=>{"use strict";e.d(A,{n:()=>B,C:()=>w});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(55852),g=e(94753),o=e(60782),d=e(62930),c=e(56034),a=e(42418),p=e(67061),u=e(10354),m=e(14578),v=e(72109),x=e(29158);const f=({currentPage:W,numberOfPages:z,onNavigate:Y,hideWhenSinglePage:X,className:q})=>{const G=(0,r.of)(E);return X&&z<=1?null:(0,n.jsxs)("div",{className:(0,s.cx)(G.wrapper,q),children:[(0,n.jsx)(x.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>Y(W-1),disabled:W===1}),W," of ",z,(0,n.jsx)(x.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>Y(W+1),disabled:W===z})]})},E=W=>({wrapper:(0,s.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})});var h=e(16817),y=e(65418),b=e(34867),D=e(3169),P=e(3363);const C=(0,b.DW)("features.dashboards.genai");var M=(W=>(W.IDLE="idle",W.GENERATING="generating",W.COMPLETED="completed",W))(M||{});const I=1e4;function R(W=P.C4,z=1){const[Y,X]=(0,l.useState)([]),[q,G]=(0,l.useState)(!1),[te,H]=(0,l.useState)(""),[se,ne]=(0,l.useState)("idle"),[le,_]=(0,l.useState)(),{error:Q}=(0,D._2)();let ae="";const oe=(0,l.useCallback)(re=>{ne("idle"),X([]),G(!1),_(re),Q("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(re),C.logError(re,{messages:JSON.stringify(Y),model:W,temperature:String(z)})},[Y,W,z,Q]);(0,l.useEffect)(()=>{Y.length>0&&H("")},[Y]);const{error:J,value:ee}=(0,h.A)(async()=>await(0,P.QX)(),[P.QX]),{error:de,value:xe}=(0,h.A)(async()=>{if(!ee||!Y.length)return{enabled:ee};ne("generating"),_(void 0);const re=y.qH({model:W,temperature:z,messages:Y}).pipe(y.qA());return{enabled:ee,stream:re.subscribe({next:ue=>{ae=ue},error:oe,complete:()=>{H(ae),ne("completed"),setTimeout(()=>{ne("idle")}),X([]),G(!1),_(void 0)}})}},[Y,ee]);return(0,l.useEffect)(()=>()=>{xe?.stream&&xe.stream.unsubscribe()},[xe]),(0,l.useEffect)(()=>{q&&(xe?.stream?.unsubscribe(),ne("idle"),G(!1),_(void 0),X([]))},[q,xe?.stream]),(0,l.useEffect)(()=>{let re;return se==="generating"&&te===""&&(re=setTimeout(()=>{oe(new Error(`OpenAI stream timed out after ${I}ms`))},I)),()=>{re&&clearTimeout(re)}},[se,te,oe]),(de||J)&&_(de||J),{setMessages:X,setStopGeneration:G,messages:Y,reply:te,streamStatus:se,error:le,value:xe}}const T=({history:W,index:z,reply:Y,streamStatus:X,onNavigate:q})=>{const G=(0,r.of)(S),te=W.length,H=()=>Y&&X!==M.IDLE?Y:W[z-1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:G.contentWrapper,children:(0,n.jsx)(g.E,{element:"p",color:"secondary",children:H()})}),(0,n.jsx)(f,{currentPage:z,numberOfPages:te,onNavigate:q,hideWhenSinglePage:!1,className:G.paginationWrapper})]})},S=W=>({paginationWrapper:(0,s.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,s.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:W.colors.background.secondary,border:`1px solid ${W.colors.border.weak}`,padding:W.spacing(1),minHeight:60})}),L=({onSuggestionClick:W,isGenerating:z})=>{const Y=(0,r.of)(O);return(0,n.jsxs)("div",{className:Y.quickSuggestionsWrapper,children:[(0,n.jsx)(i.$n,{onClick:()=>W(P.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:z,children:P.HG.Shorter}),(0,n.jsx)(i.$n,{onClick:()=>W(P.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:z,children:P.HG.MoreDescriptive}),(0,n.jsx)(i.$n,{onClick:()=>W(P.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:z,children:P.HG.Regenerate})]})},O=W=>({quickSuggestionsWrapper:(0,s.css)({display:"flex",flexDirection:"row",gap:8})});var j=e(57725);const N=.5,F=({eventTrackingSrc:W,history:z,messages:Y,onApplySuggestion:X,updateHistory:q})=>{const G=(0,r.of)(U),[te,H]=(0,l.useState)(1),[se,ne]=(0,l.useState)(!1),[le,_]=(0,l.useState)(""),{setMessages:Q,setStopGeneration:ae,reply:oe,streamStatus:J,error:ee}=R(P.C4,N),de=J===M.GENERATING,xe=(qe,We)=>(0,j.XX)(W,qe,We);(0,l.useEffect)(()=>{!de&&oe!==""&&H(1)},[de,oe]),(0,l.useEffect)(()=>{J===M.COMPLETED&&q((0,P.Kb)(oe))},[J,oe,q]),(0,l.useEffect)(()=>{ee&&ne(!0),J===M.GENERATING&&ne(!1)},[ee,J]);const re=qe=>{ge(qe),xe(j.KR.customFeedback,{customFeedback:qe})},ue=()=>{de?(ae(!0),oe!==""&&q((0,P.Kb)(oe))):X(z[te-1])},Te=qe=>{H(qe),xe(qe>te?j.KR.backHistoryItem:j.KR.forwardHistoryItem)},ge=qe=>{qe!==P.HG.Regenerate?Y=[...Y,...(0,P.To)(z[te-1],qe)]:Y=[...Y,...(0,P.To)(z[te-1],"Please, regenerate")],Q(Y),qe in P.HG&&xe(j.KR.quickFeedback,{quickFeedbackItem:qe})},Oe=qe=>qe.key==="Enter"&&re(le),Ue=qe=>_(qe.currentTarget.value),Xe=()=>re(le),we=()=>xe(j.KR.linkToDocs);return(0,n.jsxs)("div",{className:G.container,children:[se&&(0,n.jsx)(a.F,{title:"",children:(0,n.jsx)(p.B,{direction:"column",children:(0,n.jsx)("p",{children:"Sorry, I was unable to complete your request. Please try again."})})}),(0,n.jsx)(T,{history:z,index:te,onNavigate:Te,reply:(0,P.Kb)(oe),streamStatus:J}),(0,n.jsx)("div",{className:G.actionButtons,children:(0,n.jsx)(L,{onSuggestionClick:ge,isGenerating:de})}),(0,n.jsx)(u.p,{placeholder:"Tell AI what to do next...",suffix:(0,n.jsx)(i.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:Xe,disabled:le==="",children:"Send"}),value:le,onChange:Ue,onKeyDown:Oe}),(0,n.jsx)("div",{className:G.applySuggestion,children:(0,n.jsx)(p.B,{justifyContent:"flex-end",direction:"row",children:(0,n.jsx)(i.$n,{icon:de?"fa fa-spinner":"check",onClick:ue,children:de?w:"Apply"})})}),(0,n.jsxs)("div",{className:G.footer,children:[(0,n.jsx)(m.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:G.infoColor}),(0,n.jsxs)(g.E,{variant:"bodySmall",color:"secondary",children:["This content is AI-generated using the"," ",(0,n.jsx)(v.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:we,children:"Grafana LLM plugin"})]})]})]})},U=W=>({container:(0,s.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,s.css)({paddingTop:W.spacing(2)}),actions:(0,s.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,s.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:W.spacing(1),paddingLeft:W.spacing(2),alignItems:"center",gap:W.spacing(1),borderTop:`1px solid ${W.colors.border.weak}`,marginTop:W.spacing(2)}),infoColor:(0,s.css)({color:W.colors.info.main}),actionButtons:(0,s.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),w="Stop generating",B=({text:W="Auto-generate",toggleTipTitle:z="",onClick:Y,model:X=P.C4,messages:q,onGenerate:G,temperature:te=1,eventTrackingSrc:H,disabled:se,tooltip:ne})=>{const le=(0,r.of)(K),{setMessages:_,setStopGeneration:Q,reply:ae,value:oe,error:J,streamStatus:ee}=R(X,te),[de,xe]=(0,l.useState)([]),[re,ue]=(0,l.useState)(!1),Te=de.length>0,ge=ee===M.GENERATING,Oe=!Te,Ue=se||oe&&!oe.enabled&&!J,Xe=Dt=>(0,j.XX)(H,Dt),we=J||ne?void 0:!1,qe=J?"Failed to generate content using OpenAI. Please try again or if the problem persists, contact your organization admin.":ne||"",We=Dt=>{ee===M.GENERATING?Q(!0):Te?ue(!0):(Y?.(Dt),_(at()));const tt=J?j.KR.erroredRetryButton:ge?j.KR.stopGenerationButton:Oe?j.KR.autoGenerateButton:j.KR.improveButton;Xe(tt)},Ce=(0,l.useCallback)(Dt=>{de.indexOf(Dt)===-1&&xe([Dt,...de])},[de]);if((0,l.useEffect)(()=>{ee===M.COMPLETED&&ae&&G((0,P.Kb)(ae))},[ee,ae,G]),(0,l.useEffect)(()=>{ee===M.COMPLETED&&Ce((0,P.Kb)(ae))},[de,ee,ae,Ce]),!oe?.enabled)return null;const je=Dt=>{Xe(j.KR.applySuggestion),G(Dt),ue(!1)},Ke=()=>{if(!ge)return J||oe&&!oe?.enabled?"exclamation-circle":"ai"},_e=()=>{let Dt=W;return J&&(Dt="Retry"),ge&&(Dt=w),Te&&(Dt="Improve"),Dt},Fe=(0,n.jsx)(i.$n,{icon:Ke(),onClick:We,fill:"text",size:"sm",disabled:Ue,variant:J?"destructive":"primary",children:_e()}),at=()=>typeof q=="function"?q():q,Ct=()=>{if(Te){const Dt=(0,n.jsx)(g.E,{element:"p",children:z});return(0,n.jsx)(o.G,{title:Dt,content:(0,n.jsx)(F,{history:de,messages:at(),onApplySuggestion:je,updateHistory:Ce,eventTrackingSrc:H}),placement:"left-start",fitContent:!0,show:re,onClose:()=>ue(!1),onOpen:()=>ue(!0),children:Fe})}return Fe};return(0,n.jsxs)("div",{className:le.wrapper,children:[ge&&(0,n.jsx)(d.y,{size:"sm",className:le.spinner}),Oe?(0,n.jsx)(c.m,{show:we,interactive:!0,content:qe,children:Fe}):Ct()]})},K=W=>({wrapper:(0,s.css)({display:"flex"}),spinner:(0,s.css)({color:W.colors.text.link})})},81394:(k,A,e)=>{"use strict";e.d(A,{V:()=>d});var n=e(74848),s=e(14792),l=e(10740),r=e(57725),i=e(3363);const o=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,d=({onGenerate:a})=>{const p=(0,s.UA)().getCurrent(),u=(0,i.N3)(p);return(0,n.jsx)(l.n,{messages:c(p),onGenerate:a,eventTrackingSrc:r.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:u.length===0,tooltip:u.length===0?i.ZN:void 0})};function c(a){return[{content:o,role:i.Xh.system},{content:`The title of the dashboard is "${a.title}"
${(0,i.BB)(a)}`,role:i.Xh.user}]}},27966:(k,A,e)=>{"use strict";e.d(A,{Z:()=>d});var n=e(74848),s=e(14792),l=e(10740),r=e(57725),i=e(3363);const o=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,d=({onGenerate:a})=>{const p=(0,s.UA)().getCurrent(),u=(0,i.N3)(p);return(0,n.jsx)(l.n,{messages:c(p),onGenerate:a,eventTrackingSrc:r.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:u.length===0,tooltip:u.length===0?i.ZN:void 0})};function c(a){return[{content:o,role:i.Xh.system},{content:`The panels in the dashboard are: ${(0,i.BB)(a)}`,role:i.Xh.user}]}},20214:(k,A,e)=>{"use strict";e.d(A,{t:()=>d});var n=e(74848),s=e(14792),l=e(10740),r=e(57725),i=e(3363);const o=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,d=({onGenerate:a,panel:p})=>(0,n.jsx)(l.n,{messages:()=>c(p),onGenerate:a,eventTrackingSrc:r.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function c(a){const p=(0,s.UA)().getCurrent(),u=(0,i.hn)(a);return[{content:o,role:i.Xh.system},{content:`The panel is part of a dashboard with the title: ${p.title}
The panel is part of a dashboard with the description: ${p.description}
This is the JSON which defines the panel: ${u}`,role:i.Xh.user}]}},74410:(k,A,e)=>{"use strict";e.d(A,{h:()=>o});var n=e(74848),s=e(10740),l=e(57725),r=e(3363);const g="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",o=({onGenerate:c,panel:a,dashboard:p})=>(0,n.jsx)(s.n,{messages:()=>d(a,p),onGenerate:c,eventTrackingSrc:l.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function d(c,a){const p=(0,r.hn)(c);return[{content:g,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${a.title}
The panel is part of a dashboard with the description: ${a.description}
Use this JSON object which defines the panel: ${p}`,role:r.Xh.user}]}},57725:(k,A,e)=>{"use strict";e.d(A,{KR:()=>r,XX:()=>i,ec:()=>l});var n=e(14110);const s="dashboards_autogenerate_clicked";var l=(g=>(g.panelDescription="panel-description",g.panelTitle="panel-title",g.dashboardChanges="dashboard-changes",g.dashboardTitle="dashboard-title",g.dashboardDescription="dashboard-description",g.unknown="unknown",g))(l||{}),r=(g=>(g.autoGenerateButton="auto-generate-button",g.erroredRetryButton="errored-retry-button",g.stopGenerationButton="stop-generating-button",g.improveButton="improve-button",g.backHistoryItem="back-history-item",g.forwardHistoryItem="forward-history-item",g.quickFeedback="quick-feedback",g.linkToDocs="link-to-docs",g.customFeedback="custom-feedback",g.applySuggestion="apply-suggestion",g))(r||{});function i(g,o,d){(0,n.rR)(s,{src:g,item:o,...d})}},3363:(k,A,e)=>{"use strict";e.d(A,{ZN:()=>R,C4:()=>h,HG:()=>E,Xh:()=>f,Yy:()=>b,BB:()=>M,To:()=>C,hn:()=>I,N3:()=>T,QX:()=>P,Kb:()=>y});var n=e(2543),s=e(65418),l=e(32264),r=e(36974),i=e(90254),g=e(34214);function o(L,O){return L===O?O:Array.isArray(L)&&Array.isArray(O)?a(L,O):d(L)&&d(O)?c(L,O):O}function d(L){return typeof L=="object"&&!Array.isArray(L)&&L!==null}function c(L,O){const j=Object.keys(L),N={};for(const F of j)O.hasOwnProperty(F)&&(Array.isArray(L[F])&&Array.isArray(O[F])||typeof L[F]=="object"&&typeof O[F]=="object"?N[F]=o(L[F],O[F]):N[F]=O[F]);return N}function a(L,O){const j=new Array(L.length).fill(void 0),N=new Set([...Array(L.length).keys()]),F=new Set([...Array(O.length).keys()]);for(let U=0;U<L.length&&F.size!==0;U++){let w=L[U];for(let B=0;B<O.length;B++){if(!F.has(B))continue;let K=O[B];K=o(w,K),JSON.stringify(w)===JSON.stringify(K)&&(N.delete(U),F.delete(B),j[U]=K)}}return p(L,O,j,N,F),j.filter(U=>U!==void 0)}function p(L,O,j,N,F){let U={};F.forEach(B=>{let K=O[B];if(typeof K!="object"||Array.isArray(K)){j.push(K),F.delete(B);return}N.forEach(W=>{let z=L[W];if(typeof z!="object"||Array.isArray(z)){N.delete(W);return}let Y=0;for(const X in z){let q=z[X];if(!K.hasOwnProperty(X))continue;let G=K[X];typeof q!="string"&&typeof q!="number"||typeof q!=typeof G||q===G&&(X==="id"&&(Y+=1e3),Y++)}Y!==0&&(U[Y]===void 0&&(U[Y]=[]),U[Y].push([W,B]))})});const w=Object.keys(U).map(Number);w.sort((B,K)=>K-B);for(const B of w){let K=U[B];for(const W of K){const[z,Y]=W;N.has(z)&&F.has(Y)&&(j[z]=O[Y],N.delete(z),F.delete(Y))}}for(const B of F)j.push(O[B])}function u(L){const O=L.split(`
`);let j=L[0].startsWith("Index")?4:3,N=O.slice(0,j);const F=/("title"|Title|\{|\}|\[|\])/i;for(let U=j;U<O.length;U++){let w=O[U];(F.test(w)||w.startsWith("+")||w.startsWith("-"))&&N.push(w)}return N.join(`
`)+`
`}function m(L){if(L===null||L==="")return null;if(Array.isArray(L)){const j=L.map(N=>m(N)).filter(N=>N!==null);return j.length>0?j:null}if(typeof L!="object")return L;const O={};for(const j in L){const N=m(L[j]);if(N!==null){if(Array.isArray(N)&&N.length===0||typeof N=="object"&&Object.keys(N).length===0)continue;O[j]=N}}return Object.keys(O).length>0?O:null}function v(L){return JSON.parse(JSON.stringify(L,null,2))}function x(L){let O=v(L.getOriginalDashboard()),j=v(new g.G(O).getSaveModelClone()),N=v(L.getSaveModelClone());j=m(o(O,j)),N=m(o(j,N)),O=m(O);let F=(0,i.ss)("Before migration changes","After migration changes",JSON.stringify(O,null,2),JSON.stringify(j,null,2),"","",{context:20}),U=(0,i.ss)("Before user changes","After user changes",JSON.stringify(j,null,2),JSON.stringify(N,null,2),"","",{context:20});return F=u(F),U=u(U),{migrationDiff:F,userDiff:U}}var f=(L=>(L.system="system",L.user="user",L))(f||{}),E=(L=>(L.Shorter="Even shorter",L.MoreDescriptive="More descriptive",L.Regenerate="Regenerate",L))(E||{});const h="gpt-4",y=L=>L.replace(/^"|"$/g,"");function b(L){const{migrationDiff:O,userDiff:j}=x(L);return{userChanges:j,migrationChanges:O}}let D;async function P(){return l.$.apps["grafana-llm-app"]?D||(D=new Promise(L=>{s.vK().then(O=>{O.ok||(D=void 0),L(O.ok)})}),D):!1}const C=(L,O)=>[{role:"system",content:`Your previous response was: ${L}. The user has provided the following feedback: ${O}. Re-generate your response according to the provided feedback.`}];function M(L){const O=T(L);let j;if(O.length<=10)j=`The panels in the dashboard are:
${O.join(`
`)}`;else{const N=L.panels.filter(w=>w.description),F=L.panels.filter(w=>!w.description);let U;N.length>=10?U=N.slice(10).map(S).join(`
`):(U=N.map(S).join(`
`),U+=`
`,U+=F.slice(10-N.length).map(S).join("n")),j=`There are ${O.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${U}`}return j}function I(L){const O=["datasource","title","description","targets","type"],j={...(0,n.pick)(L,O),options:(0,n.pick)(L.options,["content"])};return JSON.stringify(j,null,2)}const R="To generate this content your dashboard must contain at least one panel with a valid title or description.";function T(L){return L.panels.filter(j=>j.title.length>0&&j.title!==r.LH||j.description&&j.description.length>0).map(S)}const S=(L,O)=>`- Panel ${O}
- Title: ${L.title}${L.description?`
- Description: ${L.description}`:""}`},18803:(k,A,e)=>{"use strict";e.d(A,{B6:()=>p,E_:()=>m,jD:()=>u});var n=e(2543),s=e.n(n),l=e(72985),r=e(89667),i=e(52622),g=e(72724),o=e(39070),d=e(32264),c=e(41524),a=e(68706);function p(h){const y=[];if(h?.series)for(const b of h.series)y.push((0,r.Nw)(b));if(h?.annotations)for(const b of h.annotations){const D=(0,r.Nw)(b);D.schema?.meta||(D.schema.meta={}),D.schema.meta.dataTopic=i.QR.Annotations,y.push(D)}return y}function u(h,y){const b=h.getSaveModel(),D={panelType:b.type,datasource:"??"},P=d.$.buildInfo.versionString;let C=`| Key | Value |
|--|--|
| Panel | ${D.panelType} @ ${b.pluginVersion??P} |
| Grafana | ${P} // ${d.$.buildInfo.edition} |
`;return y&&(C+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+y+"\n```\n</details>"),C}async function m(h,y,b){const D=h.getSaveModel(),P=(0,n.cloneDeep)(E),C={panelType:D.type,datasource:"??"},M=await(0,l._)(h.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),I=h.datasource,R=(0,c.W)(p(M),y),T=d.$.buildInfo.versionString,S=D?.targets??[],L=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${C.panelType} @ ${D.pluginVersion??T}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${S.map(O=>{const j=O.datasource??I;return`${O.refId}[${j?.type}]`}).join(", ")}</td>
    </tr>
    ${v(D)}
    ${x(M,R)}
    ${f(M)}
    <tr>
      <th>Grafana</th>
      <td>${T} // ${d.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(P.panels[0]={...D,...P.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:a.nj.Snapshot,snapshot:R}]},D.transformations?.length){const O=P.panels[P.panels.length-1];O.title=O.title+" (after transformations)";const j=(0,n.cloneDeep)(O);j.id=100,j.title="Data (before transformations)",j.gridPos.w=24,j.targets[0].withTransforms=!1,P.panels.push(j)}return M.annotations?.length&&P.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:i.QR.Annotations,refId:"A"}]}),P.panels[1].options.content=L,P.panels[2].options.content=JSON.stringify(D,null,2),P.title=`Debug: ${D.title} // ${(0,g.LE)(new Date)}`,P.tags=["debug",`debug-${C.panelType}`],P.time={from:b.from.toISOString(),to:b.to.toISOString()},P}function v(h){return h.transformations?`<tr>
      <th>Transform</th>
      <td>${h.transformations.map(y=>y.id).join(", ")}</td>
  </tr>`:""}function x(h,y){let b=h.series.length??0,D=0,P=0;for(const C of h.series)D+=C.fields.length,P+=C.length;return`<tr><th>Data</th><td>${h.state!==o.Gu.Done?h.state:""} ${b} frames, ${D} fields, ${P} rows </td></tr>`}function f(h){return h.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${h.annotations.map((y,b)=>`<span>${y.length}</span>`)}</td>
</tr>`:""}const E={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(k,A,e)=>{"use strict";e.d(A,{BN:()=>d,kx:()=>c,sd:()=>o});var n=e(96540),s=e(24705),l=e(19347),r=e(8484),i=e(16560),g=e(54612);const o=a=>(0,s.A)(async()=>d(a),[a]).value;async function d(a){const p=a?.request?.targets||[];if(a&&a.series&&p.length){for(const u of a.series)if(u.meta&&u.meta.custom){const m=await(0,l.l)().get(p[0].datasource);if(m&&m.components?.MetadataInspector)return m}}}const c=(a,p,u,m,v)=>(0,n.useMemo)(()=>{const x=[];return(0,g.$)(u)&&(x.push({label:(0,r.t)("dashboard.inspect.data-tab","Data"),value:i.q.Data}),x.push({label:(0,r.t)("dashboard.inspect.stats-tab","Stats"),value:i.q.Stats})),v&&x.push({label:(0,r.t)("dashboard.inspect.meta-tab","Meta data"),value:i.q.Meta}),x.push({label:(0,r.t)("dashboard.inspect.json-tab","JSON"),value:i.q.JSON}),m&&x.push({label:(0,r.t)("dashboard.inspect.error-tab","Error"),value:i.q.Error}),p.meta.canEdit&&(0,g.$)(u)&&x.push({label:(0,r.t)("dashboard.inspect.query-tab","Query"),value:i.q.Query}),x},[u,v,p,m])},57755:(k,A,e)=>{"use strict";e.d(A,{D:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(78685),i=e(13544),g=e(53402),o=e(40845),d=e(55852),c=e(83277),a=e(53466);const p="showCategory",u=l.memo(({id:x,title:f,children:E,forceOpen:h,isOpenDefault:y=!0,renderTitle:b,className:D,itemsCount:P,isNested:C=!1,sandboxId:M})=>{const[I,R]=(0,r.A)(v(x),{isExpanded:y}),[T,S]=(0,l.useState)(I?.isExpanded??y),L=(0,l.useRef)(0),O=(0,l.useRef)(null),[j,N]=(0,c.s)(),F=j[p]===x;(0,l.useEffect)(()=>{L.current&&Date.now()-L.current<200||(F||h)&&(T||S(!0),F&&O.current?.scrollIntoView())},[h,T,F]);const U=(0,l.useCallback)(()=>{L.current=Date.now(),N({[p]:T?void 0:x},!0),R({isExpanded:!T}),S(!T)},[R,S,N,T,x]);b||(b=function(Y){return Y||P===void 0||P===0?f:(0,n.jsxs)("span",{children:[f," ",(0,n.jsx)(g.p,{value:P})]})});const w=(0,o.of)(m),B=(0,s.cx)({[w.box]:!0,[w.boxNestedExpanded]:C&&T},D),K=(0,s.cx)(w.header,{[w.headerExpanded]:T,[w.headerNested]:C}),W=(0,s.cx)(w.body,{[w.bodyNested]:C});return(0,n.jsxs)("div",{className:B,"data-plugin-sandbox":M,"data-testid":i.Tp.components.OptionsGroup.group(x),ref:O,children:[(0,n.jsxs)("div",{className:K,onClick:U,children:[(0,n.jsx)(d.$n,{"data-testid":i.Tp.components.OptionsGroup.toggle(x),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":T,className:w.toggleButton,icon:T?"angle-down":"angle-right",onClick:U}),(0,n.jsx)("h6",{id:`button-${x}`,className:w.title,children:b(T)})]}),T&&(0,n.jsx)("div",{className:W,id:x,"aria-labelledby":`button-${x}`,children:E})]})});u.displayName="OptionsPaneCategory";const m=x=>({box:(0,s.css)({borderTop:`1px solid ${x.colors.border.weak}`}),boxNestedExpanded:(0,s.css)({marginBottom:x.spacing(2)}),title:(0,s.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:x.typography.fontWeightMedium,margin:0}),header:(0,s.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:x.spacing(.5),color:x.colors.text.primary,fontWeight:x.typography.fontWeightMedium,"&:hover":{background:x.colors.emphasize(x.colors.background.primary,.03)}}),toggleButton:(0,s.css)({alignSelf:"baseline"}),headerExpanded:(0,s.css)({color:x.colors.text.primary}),headerNested:(0,s.css)({padding:x.spacing(.5,0,.5,0)}),body:(0,s.css)({padding:x.spacing(1,2,1,4)}),bodyNested:(0,s.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:x.colors.border.weak}})}),v=x=>`${a.wi}.optionGroup[${x}]`},48192:(k,A,e)=>{"use strict";e.d(A,{C:()=>l});var n=e(74848),s=e(57755);class l{constructor(i){this.props=i,this.items=[],this.categories=[]}addItem(i){return i.parent=this,this.items.push(i),this}addCategory(i){return i.props.isNested=!0,i.parent=this,this.categories.push(i),this}getCategory(i){let g=this.categories.find(o=>o.props.id===i);return g||(g=new l({title:i,id:i}),this.addCategory(g)),g}render(i){return this.props.customRender?this.props.customRender():(0,n.jsxs)(s.D,{...this.props,children:[this.items.map(g=>g.render(i)),this.categories.map(g=>g.render(i))]},this.props.title)}}},74097:(k,A,e)=>{"use strict";e.d(A,{v:()=>u});var n=e(74848),s=e(32196),l=e(23257),r=e.n(l),i=e(13544),g=e(60029),o=e(88575),d=e(40845),c=e(56034);function a({overrides:x}){const f=(0,d.of)(p);return(0,n.jsx)("div",{className:f.wrapper,children:x.map((E,h)=>(0,n.jsx)(c.m,{content:E.tooltip,placement:"top",children:(0,n.jsx)("div",{"aria-label":E.description,className:f[E.type]})},h.toString()))})}const p=x=>{const f={width:8,height:8,borderRadius:x.shape.radius.circle,marginLeft:x.spacing(1),top:"-1px"};return{wrapper:(0,s.css)({display:"flex"}),rule:(0,s.css)({...f,position:"relative",backgroundColor:x.colors.primary.main}),data:(0,s.css)({...f,position:"relative",backgroundColor:x.colors.warning.main})}};class u{constructor(f){this.props=f}getLabel(f){const{title:E,description:h,overrides:y,addon:b}=this.props;if(!f)return this.parent.props.title===E&&!y?.length?null:(0,n.jsx)(m,{title:E,description:h,overrides:y,addon:b});const D=[];return this.parent.parent&&D.push(this.highlightWord(this.parent.parent.props.title,f)),this.parent.props.title!==E&&D.push(this.highlightWord(this.parent.props.title,f)),(0,n.jsxs)(g.J,{description:h&&this.highlightWord(h,f),category:D,children:[this.highlightWord(E,f),y&&y.length>0&&(0,n.jsx)(a,{overrides:y})]})}highlightWord(f,E){return(0,n.jsx)(r(),{textToHighlight:f,searchWords:[E],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:f}=this.props;!f||f.length}render(f){const{title:E,description:h,render:y,showIf:b,skipField:D}=this.props,P=`${this.parent.props.id} ${E}`;return b&&!b()?null:D?y():(0,n.jsx)(o.D,{label:this.getLabel(f),description:h,"aria-label":i.Tp.components.PanelEditor.OptionsPane.fieldLabel(P),children:y()},P)}}function m({title:x,description:f,overrides:E,addon:h}){const y=(0,d.of)(v);return(0,n.jsxs)("div",{className:y.container,children:[(0,n.jsxs)(g.J,{description:f,children:[x,E&&E.length>0&&(0,n.jsx)(a,{overrides:E})]}),h]})}function v(x){return{container:(0,s.css)({display:"flex",justifyContent:"space-between"})}}},26443:(k,A,e)=>{"use strict";e.d(A,{gs:()=>ne,Ff:()=>H,Po:()=>le});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(67647),o=e(94354),d=e(40276),c=e(74106),a=e(82792),p=e(71468),u=e(7376),m=e(79971),v=e(40334),x=e(33390);function f(Q,ae){x.A.set(`panel-edit-section-${Q}`,ae?"true":"false")}function E(Q,ae){return x.A.getBool(`panel-edit-section-${Q}`,ae)}const h=(Q,ae)=>({angularPanelComponent:(0,v.U)(Q,ae.panel)?.angularComponent}),y={changePanelPlugin:m.gW},b=(0,p.connect)(h,y);class D extends l.PureComponent{constructor(ae){super(ae)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(ae){(this.props.plugin!==ae.plugin||this.props.angularPanelComponent!==ae.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:ae,angularPanelComponent:oe,changePanelPlugin:J}=this.props;if(!this.element||!oe||this.angularOptions)return;const ee=oe.getScope();if(!ee.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const de=ee.$$childHead.ctrl;de.initEditMode(),de.onPluginTypeChange=Te=>{J({panel:ae,pluginId:Te.id})};let xe="";for(let Te=0;Te<de.editorTabs.length;Te++){const ge=de.editorTabs[Te];ge.isOpen=E(ge.title,Te===0),xe+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${Te})" aria-label="${ge.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${Te}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${ge.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${Te}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${Te}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const re=(0,u.E)(),ue={ctrl:de,toggleOptionGroup:Te=>{const ge=de.editorTabs[Te];ge.isOpen=!ge.isOpen,f(ge.title,!!ge.isOpen)}};this.angularOptions=re.load(this.element,ue,xe),this.angularOptions.digest()}render(){return(0,n.jsx)("div",{ref:ae=>this.element=ae})}}const P=(0,p.connect)(h,y)(D);var C=e(57755),M=e(22290),I=e(10354);const R=({panel:Q,formatDate:ae})=>{const oe=(0,i.of)(T),J=Q.libraryPanel?.meta;return J?(0,n.jsxs)("div",{className:oe.info,children:[(0,n.jsxs)("div",{className:oe.libraryPanelInfo,children:[`Used on ${J.connectedDashboards} `,J.connectedDashboards===1?"dashboard":"dashboards"]}),(0,n.jsxs)("div",{className:oe.libraryPanelInfo,children:["Last edited on ",ae?.(J.updated,"L")??J.updated," by",J.updatedBy.avatarUrl&&(0,n.jsx)("img",{width:"22",height:"22",className:oe.userAvatar,src:J.updatedBy.avatarUrl,alt:`Avatar for ${J.updatedBy.name}`}),J.updatedBy.name]})]}):null},T=Q=>({info:(0,s.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,s.css)`
      color: ${Q.colors.text.secondary};
      font-size: ${Q.typography.bodySmall.fontSize};
    `,userAvatar:(0,s.css)`
      border-radius: ${Q.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${Q.spacing(1)};
      padding-right: ${Q.spacing(1)};
    `});var S=e(48192),L=e(74097);function O(Q){const{panel:ae,onPanelConfigChange:oe,dashboard:J}=Q,ee=new S.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,a.X)(ae)&&ee.addItem(new L.v({title:"Name",value:ae.libraryPanel.name,popularRank:1,render:function(){return(0,n.jsx)(I.p,{id:"LibraryPanelFrameName",defaultValue:ae.libraryPanel.name,onBlur:xe=>oe("libraryPanel",{...ae.libraryPanel,name:xe.currentTarget.value})})}})).addItem(new L.v({title:"Information",render:function(){return(0,n.jsx)(R,{panel:ae,formatDate:J.formatDate})}})),ee}var j=e(13544),N=e(21744),F=e(15292),U=e(64919),w=e(90182),B=e(6923),K=e(20214),W=e(74410),z=e(92378);function Y(Q){const{dashboard:ae,panel:oe,onPanelConfigChange:J}=Q,ee=new S.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),de=re=>{const ue=document.getElementById("PanelFrameTitle");ue instanceof HTMLInputElement&&(ue.value=re,J("title",re))},xe=re=>{const ue=document.getElementById("description-text-area");ue instanceof HTMLTextAreaElement&&(ue.value=re,J("description",re))};return ee.addItem(new L.v({title:"Title",value:oe.title,popularRank:1,render:function(){return(0,n.jsx)(I.p,{"data-testid":j.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:oe.title,onBlur:ue=>J("title",ue.currentTarget.value)})},addon:r.$.featureToggles.dashgpt&&(0,n.jsx)(W.h,{onGenerate:de,panel:oe.getSaveModel(),dashboard:ae.getSaveModelClone()})})).addItem(new L.v({title:"Description",description:oe.description,value:oe.description,render:function(){return(0,n.jsx)(N.f,{"data-testid":j.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:oe.description,onBlur:ue=>J("description",ue.currentTarget.value)})},addon:r.$.featureToggles.dashgpt&&(0,n.jsx)(K.t,{onGenerate:xe,panel:oe.getSaveModel()})})).addItem(new L.v({title:"Transparent background",render:function(){return(0,n.jsx)(F.d,{"data-testid":j.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:oe.transparent,id:"transparent-background",onChange:ue=>J("transparent",ue.currentTarget.checked)})}})).addCategory(new S.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:oe.links?.length}).addItem(new L.v({title:"Panel links",render:function(){return(0,n.jsx)(U.e,{links:oe.links,onChange:ue=>J("links",ue),getSuggestions:B.Fq,data:[]})}}))).addCategory(new S.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new L.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,n.jsx)(z.G,{id:"repeat-by-variable-select",repeat:oe.repeat,onChange:ue=>{J("repeat",ue)}})}})).addItem(new L.v({title:"Repeat direction",showIf:()=>!!oe.repeat,render:function(){const ue=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,n.jsx)(o.z,{options:ue,value:oe.repeatDirection||"h",onChange:Te=>J("repeatDirection",Te)})}})).addItem(new L.v({title:"Max per row",showIf:()=>!!(oe.repeat&&oe.repeatDirection==="h"),render:function(){const ue=[2,3,4,6,8,12].map(Te=>({label:Te.toString(),value:Te}));return(0,n.jsx)(w.l6,{options:ue,value:oe.maxPerRow,onChange:Te=>J("maxPerRow",Te.value)})}})))}var X=e(66211);class q{constructor(ae,oe){this.categories=ae,this.overrides=oe}search(ae){const oe=new RegExp(ae,"i"),ee=this.collectHits(this.categories,oe,[]).sort(G).map(re=>re.item),xe=this.collectHits(this.overrides,oe,[]).sort(G).map(re=>re.item);return{optionHits:ee,overrideHits:this.buildOverrideHitCategories(xe),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(ae,oe,J){for(const ee of ae){const de=oe.test(ee.props.title);for(const xe of ee.items){if(oe.test(xe.props.title)){J.push({item:xe,rank:1});continue}if(xe.props.description&&oe.test(xe.props.description)){J.push({item:xe,rank:2});continue}de&&J.push({item:xe,rank:3})}ee.categories.length>0&&this.collectHits(ee.categories,oe,J)}return J}getAllOptionsCount(ae){let oe=0;for(const J of ae)oe+=J.items.length,J.categories.length>0&&(oe+=this.getAllOptionsCount(J.categories));return oe}buildOverrideHitCategories(ae){const oe={};for(const J of ae){let ee=oe[J.parent.props.title];ee||(ee=oe[J.parent.props.title]=new S.C(J.parent.props),ee.addItem(J.parent.items[0])),ee.items[0].props.title!==J.props.title&&ee.addItem(J)}return Object.values(oe)}}function G(Q,ae){return Q.rank-ae.rank}function te(Q){const ae=[];for(const oe of Q)for(const J of oe.items)J.props.title==="Unit"&&(J.props.popularRank=2),J.props.title==="Min"&&(J.props.popularRank=3),J.props.title==="Max"&&(J.props.popularRank=4),J.props.title==="Display name"&&(J.props.popularRank=5),J.props.popularRank&&ae.push(J);return ae.sort((oe,J)=>oe.props.popularRank-J.props.popularRank)}const H=Q=>{const{plugin:ae,dashboard:oe,panel:J}=Q,[ee,de]=(0,l.useState)(""),[xe,re]=(0,l.useState)("All"),ue=(0,i.of)(_),[Te,ge,Oe]=(0,l.useMemo)(()=>[Y(Q),(0,X.Zm)(Q),O(Q)],[J.configRev,Q.data,Q.instanceState,ee]),Ue=(0,l.useMemo)(()=>(0,M.v)(Q.panel.fieldConfig,Q.plugin.fieldConfigRegistry,Q.data?.series??[],ee,Q.onFieldConfigsChange),[J.configRev,Q.data,Q.instanceState,ee]),Xe=[],we=ee.length>0,qe=(0,l.useMemo)(se,[]),We=(0,a.X)(J)?[Oe,Te,...ge]:[Te,...ge];if(we)Xe.push(le(We,Ue,ee)),Q.plugin.angularPanelCtrl&&Xe.push((0,n.jsx)("div",{className:ue.searchNotice,children:"This is an old visualization type that does not support searching all options."},"Search notice"));else switch(xe){case"All":(0,a.X)(J)&&Xe.push(Oe.render()),Xe.push(Te.render()),Q.plugin.angularPanelCtrl&&Xe.push((0,n.jsx)(P,{plugin:ae,dashboard:oe,panel:J},"AngularOptions"));for(const je of ge)Xe.push(je.render());for(const je of Ue)Xe.push(je.render());break;case"Overrides":for(const je of Ue)Xe.push(je.render());break;case"Recent":Xe.push((0,n.jsx)(C.D,{id:"Recent options",title:"Recent options",forceOpen:1,children:te(We).map(je=>je.render())},"Recent options"));break}const Ce=!we&&!ae.fieldConfigRegistry.isEmpty();return(0,n.jsxs)("div",{className:ue.wrapper,children:[(0,n.jsxs)("div",{className:ue.formBox,children:[J.isAngularPlugin()&&!ae.meta.angular?.hideDeprecation&&(0,n.jsx)(c.c,{className:ue.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:ae.meta.id,pluginType:ae.meta.type,angularSupportEnabled:r.$?.angularSupportEnabled,interactionElementId:"panel-options"}),(0,n.jsx)("div",{className:ue.formRow,children:(0,n.jsx)(g.Z,{width:0,value:ee,onChange:de,placeholder:"Search options"})}),Ce&&(0,n.jsx)("div",{className:ue.formRow,children:(0,n.jsx)(o.z,{options:qe,value:xe,fullWidth:!0,onChange:re})})]}),(0,n.jsx)("div",{className:ue.scrollWrapper,children:(0,n.jsx)(d.E,{autoHeightMin:"100%",children:(0,n.jsx)("div",{className:ue.mainBox,children:Xe})})})]})};function se(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ne=(Q=>(Q.All="All",Q.Overrides="Overrides",Q.Recent="Recent",Q))(ne||{});function le(Q,ae,oe){const J=new q(Q,ae),{optionHits:ee,totalCount:de,overrideHits:xe}=J.search(oe);return(0,n.jsxs)("div",{children:[(0,n.jsx)(C.D,{id:"Found options",title:`Matched ${ee.length}/${de} options`,forceOpen:1,children:ee.map(re=>re.render(oe))},"Normal options"),xe.map(re=>re.render(oe))]},"search results")}const _=Q=>({wrapper:(0,s.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:Q.colors.warning.text,background:"transparent"}}),searchBox:(0,s.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,s.css)({marginBottom:Q.spacing(1)}),formBox:(0,s.css)({padding:Q.spacing(1),background:Q.colors.background.primary,border:`1px solid ${Q.components.panel.borderColor}`,borderTopLeftRadius:Q.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,s.css)({marginLeft:Q.spacing(1)}),searchHits:(0,s.css)({padding:Q.spacing(1,1,0,1)}),scrollWrapper:(0,s.css)({flexGrow:1,minHeight:0}),searchNotice:(0,s.css)({fontSize:Q.typography.size.sm,color:Q.colors.text.secondary,padding:Q.spacing(1),textAlign:"center"}),mainBox:(0,s.css)({background:Q.colors.background.primary,border:`1px solid ${Q.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,s.css)({padding:Q.spacing(1)})})},22290:(k,A,e)=>{"use strict";e.d(A,{v:()=>R});var n=e(74848),s=e(32196),l=e(2543),r=e(85200),i=e(37055),g=e(84349),o=e(51986),d=e(40845),c=e(6923),a=e(96540),p=e(23257),u=e.n(p),m=e(66864),v=e(60029),x=e(53402),f=e(29158),E=e(88575),h=e(57755);const y=({property:O,context:j,registry:N,onChange:F,onRemove:U,isSystemOverride:w,searchQuery:B})=>{const K=(0,d.of)(b),W=N?.getIfExists(O.id),z=(0,a.useId)();if(!W)return null;const Y=Array.isArray(O.value)||O.id===i.uo.Thresholds||O.id===i.uo.Links||O.id===i.uo.Mappings,X=W.category?.filter(te=>te!==W.name);let q;const G=(te=!0,H=!1)=>(se=!1)=>(0,n.jsxs)(m.Gy,{justify:"space-between",children:[(0,n.jsxs)(v.J,{category:X,description:te?W.description:void 0,htmlFor:z,children:[(0,n.jsx)(u(),{textToHighlight:W.name,searchWords:[B],highlightClassName:"search-fragment-highlight"}),!se&&H&&W.getItemsCount&&(0,n.jsx)(x.p,{value:W.getItemsCount(O.value)})]}),!w&&(0,n.jsx)("div",{children:(0,n.jsx)(f.K,{name:"times",onClick:U,tooltip:"Remove label"})})]});return Y?q=(0,n.jsx)(h.D,{id:W.name,renderTitle:G(!1,!0),className:(0,s.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:O.value!==void 0,children:(0,n.jsx)(W.override,{value:O.value,onChange:te=>{F(te)},item:W,context:j})}):q=(0,n.jsx)("div",{children:(0,n.jsx)(E.D,{label:G()(),description:W.description,children:(0,n.jsx)(W.override,{value:O.value,onChange:te=>{F(te)},item:W,context:j,id:z})})}),(0,n.jsx)("div",{className:(0,s.cx)(Y&&K.collapsibleOverrideEditor,!Y&&"dynamicConfigValueEditor--nonCollapsible"),children:q})},b=O=>({collapsibleOverrideEditor:(0,s.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:O.spacing(1)}})});var D=e(48192),P=e(74097),C=e(14578);const M=({isExpanded:O,registry:j,matcherUi:N,overrideName:F,override:U,onOverrideRemove:w})=>{const B=(0,d.of)(I),W=U.properties.map(Y=>j.getIfExists(Y.id)).filter(Y=>!!Y).map(Y=>Y?.name).join(", "),z=N.optionsToLabel(U.matcher.options);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(m.Gy,{justify:"space-between",children:[(0,n.jsx)("div",{children:F}),(0,n.jsx)(f.K,{name:"trash-alt",onClick:w,tooltip:"Remove override"})]}),!O&&(0,n.jsx)("div",{className:B.overrideDetails,children:(0,n.jsxs)("div",{className:B.options,title:z,children:[z," ",(0,n.jsx)(C.I,{name:"angle-right"})," ",W]})})]})};M.displayName="OverrideTitle";const I=O=>({matcherUi:(0,s.css)({padding:O.spacing(1)}),propertyPickerWrapper:(0,s.css)({marginTop:O.spacing(2)}),overrideDetails:(0,s.css)({fontSize:O.typography.bodySmall.fontSize,color:O.colors.text.secondary,fontWeight:O.typography.fontWeightRegular}),options:(0,s.css)({overflow:"hidden",paddingRight:O.spacing(4)}),unknownLabel:(0,s.css)({marginBottom:0})});function R(O,j,N,F,U){const w=[],B=O;if(!j||j.isEmpty())return[];const K=(X,q)=>{let G=(0,l.cloneDeep)(B.overrides);G[X]=q,U({...B,overrides:G})},W=X=>{let q=(0,l.cloneDeep)(B.overrides);q.splice(X,1),U({...B,overrides:q})},z=X=>{const q=r.sJ.get(X.value);q&&U({...B,overrides:[...B.overrides,{matcher:{id:q.id,options:q.defaultOptions},properties:[]}]})},Y={data:N,getSuggestions:X=>(0,c.Hf)(N,X),isOverride:!0};for(let X=0;X<B.overrides.length;X++){const q=B.overrides[X],G=`Override ${X+1}`,te=g.g.get(q.matcher.id),H=T(j),se=(0,i.Ow)(q),ne=q.properties.length===0?1:0,le=new D.C({title:G,id:G,forceOpen:ne,renderTitle:function(oe){return(0,n.jsx)(M,{override:q,isExpanded:oe,registry:j,overrideName:G,matcherUi:te,onOverrideRemove:()=>W(X)})}}),_=ae=>{q.matcher.options=ae,K(X,q)},Q=(ae,oe)=>{const J=j.get(oe.value),ee={id:J.id,value:J.defaultValue};q.properties?ae.properties.push(ee):ae.properties=[ee],K(X,ae)};le.addItem(new P.v({title:te.name,render:function(){return(0,n.jsx)(te.component,{id:`${te.matcher.id}-${X}`,matcher:te.matcher,data:N??[],options:q.matcher.options,onChange:_})}}));for(let ae=0;ae<q.properties.length;ae++){const oe=q.properties[ae],J=j.getIfExists(oe.id);if(!J)continue;const ee=xe=>{q.properties[ae].value=xe,K(X,q)},de=()=>{q.properties.splice(ae,1),K(X,q)};le.addItem(new P.v({title:J.name,skipField:!0,render:function(){return(0,n.jsx)(y,{isSystemOverride:se,onChange:ee,onRemove:de,property:oe,registry:j,context:Y,searchQuery:F},`${oe.id}/${ae}`)}}))}!se&&q.matcher.options&&le.addItem(new P.v({title:"----------",skipField:!0,render:function(){return(0,n.jsx)(o.i,{label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:H,onChange:oe=>Q(q,oe)},"Add override property")}})),w.push(le)}return w.push(new D.C({title:"add button",id:"add button",customRender:function(){return(0,n.jsx)(S,{children:(0,n.jsx)(o.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:g.g.list().filter(q=>!q.excludeFromPicker).map(q=>({label:q.name,value:q.id,description:q.description})),onChange:q=>z(q)})},"Add override")}})),w}function T(O){return O.list().filter(j=>!j.hideFromOverrides).map(j=>{let N=j.name;return j.category&&(N=[...j.category,j.name].join(" > ")),{label:N,value:j.id,description:j.description}})}function S({children:O}){const j=(0,d.of)(L);return(0,n.jsx)("div",{className:j,children:O})}function L(O){return(0,s.css)({borderTop:`1px solid ${O.colors.border.weak}`,padding:`${O.spacing(2)}`,display:"flex"})}},66211:(k,A,e)=>{"use strict";e.d(A,{g5:()=>D,tN:()=>y,Zm:()=>h,Z4:()=>b});var n=e(74848),s=e(2543),l=e(60264),r=e(10354),i=e(32196),g=e(72724),o=e(40845);const d=({libraryPanel:P})=>{const C=(0,o.of)(c),M=P.useState(),I=M.$timeRange?.getTimeZone(),R=M._loadedPanel?.meta;return R?(0,n.jsxs)("div",{className:C.info,children:[(0,n.jsxs)("div",{className:C.libraryPanelInfo,children:[`Used on ${R.connectedDashboards} `,R.connectedDashboards===1?"dashboard":"dashboards"]}),(0,n.jsxs)("div",{className:C.libraryPanelInfo,children:[(0,g.LE)(R.updated,{format:"L",timeZone:I})," by",R.updatedBy.avatarUrl&&(0,n.jsx)("img",{className:C.userAvatar,src:R.updatedBy.avatarUrl,alt:`Avatar for ${R.updatedBy.name}`}),R.updatedBy.name]})]}):null},c=P=>({info:(0,i.css)({lineHeight:1}),libraryPanelInfo:(0,i.css)({color:P.colors.text.secondary,fontSize:P.typography.bodySmall.fontSize}),userAvatar:(0,i.css)({borderRadius:P.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})});var a=e(6923),p=e(48192),u=e(74097);const m="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",v="An override rule exists for this property";function x(P,C,M){const I=[];if(M){for(const T of M)for(const S of T.fields)if((0,s.get)(S.config,P.path)!=null){I.push({type:"data",description:m,tooltip:m});break}}return C.overrides.some(T=>T.properties.some(S=>S.id===P.id))&&I.push({type:"rule",description:v,tooltip:v}),I}var f=e(54612);function E({data:P,replaceVariables:C,options:M,eventBus:I,instanceState:R}){const T=P?.series??[];return{data:T,replaceVariables:C,options:M,eventBus:I,getSuggestions:L=>(0,a.Hf)(T,L),instanceState:R}}function h(P){const{plugin:C,panel:M,onPanelOptionsChanged:I,onFieldConfigsChange:R,data:T,dashboard:S,instanceState:L}=P,O=M.getOptions(),j=M.fieldConfig,N={},F=E({data:T,replaceVariables:M.replaceVariables,options:O,eventBus:S.events,instanceState:L}),U=B=>{const K=(B&&B[0])??`${C.meta.name}`,W=N[K];return W||(N[K]=new p.C({title:K,id:K,sandboxId:C.meta.id}))},w={getValue:B=>(0,s.get)(O,B),onChange:(B,K)=>{const W=(0,f.Sf)(O,B,K);I(W)}};D(C.getPanelOptionsSupplier(),w,U,F);for(const B of C.fieldConfigRegistry.list()){if(B.isCustom){if(B.showIf&&!B.showIf(j.defaults.custom,T?.series))continue}else if(B.showIf&&!B.showIf(j.defaults,T?.series))continue;if(B.hideFromDefaults)continue;const K=U(B.category),W=B.editor,z=j.defaults,Y=B.isCustom?z.custom?(0,s.get)(z.custom,B.path):void 0:(0,s.get)(z,B.path);B.getItemsCount&&(K.props.itemsCount=B.getItemsCount(Y)),K.addItem(new u.v({title:B.name,description:B.description,overrides:x(B,j,T?.series),render:function(){const q=G=>{R((0,f.EQ)(j,B.path,G,B.isCustom))};return(0,n.jsx)(W,{value:Y,onChange:q,item:B,context:F,id:B.id})}}))}return Object.values(N)}function y(P){const C=new p.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return C.addItem(new u.v({title:"Name",value:P,popularRank:1,render:function(){return(0,n.jsx)(r.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:P.state.name,onBlur:I=>P.setState({name:I.currentTarget.value})})}})).addItem(new u.v({title:"Information",render:function(){return(0,n.jsx)(d,{libraryPanel:P})}})),C}function b(P){const{plugin:C,panel:M,data:I,eventBus:R,instanceState:T}=P,S={},L=U=>{const w=U?.[0]??C.meta.name,B=S[w];return B||(S[w]=new p.C({title:w,id:w,sandboxId:C.meta.id}))},O=M.state.options,j={getValue:U=>(0,s.get)(O,U),onChange:(U,w)=>{const B=(0,f.Sf)(O,U,w);M.onOptionsChange(B)}},N=E({data:I,replaceVariables:M.interpolate,options:O,eventBus:R,instanceState:T});D(C.getPanelOptionsSupplier(),j,L,N);const F=M.state.fieldConfig;for(const U of C.fieldConfigRegistry.list()){const w=U.showIf&&(U.isCustom?!U.showIf(F.defaults.custom,I?.series):!U.showIf(F.defaults,I?.series));if(U.hideFromDefaults||w)continue;const B=L(U.category),K=U.editor,W=F.defaults,z=U.isCustom?W.custom?(0,s.get)(W.custom,U.path):void 0:(0,s.get)(W,U.path);U.getItemsCount&&(B.props.itemsCount=U.getItemsCount(z)),B.addItem(new u.v({title:U.name,description:U.description,overrides:x(U,F,I?.series),render:function(){const X=q=>{M.onFieldConfigChange((0,f.EQ)(F,U.path,q,U.isCustom),!0)};return(0,n.jsx)(K,{value:z,onChange:X,item:U,context:N,id:U.id})}}))}return Object.values(S)}function D(P,C,M,I,R){const T=new l.pv;P(T,I);for(const S of T.getItems()){if(S.showIf&&!S.showIf(I.options,I.data))continue;let L=R;if(L?S.category?.[0]?.length&&(L=L.getCategory(S.category[0])):L=M(S.category),(0,l.iF)(S)){const j=S.getNestedValueAccess(C),N=j.getContext?j.getContext(I):{...I,options:C.getValue(S.path)};D(S.getBuilder(),j,M,N,L);continue}const O=S.editor;L.addItem(new u.v({title:S.name,description:S.description,render:function(){return(0,n.jsx)(O,{value:C.getValue(S.path),onChange:N=>{C.onChange(S.path,N)},item:S,context:I,id:S.id})}}))}}},53466:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>y,GU:()=>p,MJ:()=>m,Ox:()=>v,eK:()=>f,fR:()=>x,kw:()=>E,wi:()=>o});var n=e(65307),s=e(39070),l=e(43127),r=e(33390),i=e(84423),g=e(32696);const o="grafana.dashboard.editor.ui",d={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:g.q5.Fill},c=()=>{const b=r.A.getObject(o,d);let D={...b};return typeof b.topPaneSize=="string"&&(D={...b,topPaneSize:parseFloat(b.topPaneSize)/100}),{getPanel:()=>new i.a9({}),getSourcePanel:()=>new i.a9({}),getData:()=>({state:s.Gu.NotStarted,series:[],timeRange:(0,l.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...d,...D}}},a=(0,n.Z0)({name:"panelEditor",initialState:c(),reducers:{updateEditorInitState:(b,D)=>{b.getPanel=()=>D.payload.panel,b.getSourcePanel=()=>D.payload.sourcePanel,b.initDone=!0,b.isOpen=!0,b.shouldDiscardChanges=!1},setEditorPanelData:(b,D)=>{b.getData=()=>D.payload},setDiscardChanges:(b,D)=>{b.shouldDiscardChanges=D.payload},setPanelEditorUIState:(b,D)=>{b.ui={...b.ui,...D.payload},!b.ui.isPanelOptionsVisible&&b.isVizPickerOpen&&(b.isVizPickerOpen=!1)},toggleVizPicker:(b,D)=>{b.isVizPickerOpen=D.payload,b.isVizPickerOpen&&(b.ui.isPanelOptionsVisible=!0)},toggleTableView(b){b.tableViewEnabled=!b.tableViewEnabled},closeEditor:b=>{b.getPanel=()=>new i.a9({}),b.getSourcePanel=()=>new i.a9({}),b.isOpen=!1,b.initDone=!1,b.isVizPickerOpen=!1,b.tableViewEnabled=!1}}}),{updateEditorInitState:p,setEditorPanelData:u,setDiscardChanges:m,closeEditor:v,setPanelEditorUIState:x,toggleVizPicker:f,toggleTableView:E}=a.actions,y={panelEditor:a.reducer}},32696:(k,A,e)=>{"use strict";e.d(A,{M8:()=>n,Nt:()=>r,__:()=>g,q5:()=>s});var n=(o=>(o.Query="query",o.Transform="transform",o.Visualize="visualize",o.Alert="alert",o))(n||{}),s=(o=>(o[o.Fill=0]="Fill",o[o.Fit=1]="Fit",o[o.Exact=2]="Exact",o))(s||{}),l=(o=>(o[o.Off=0]="Off",o[o.Table=1]="Table",o))(l||{});const r=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],i=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var g=(o=>(o[o.Visualizations=0]="Visualizations",o[o.LibraryPanels=1]="LibraryPanels",o[o.Suggestions=2]="Suggestions",o[o.Widgets=3]="Widgets",o))(g||{})},54612:(k,A,e)=>{"use strict";e.d(A,{$:()=>g,A:()=>i,EQ:()=>o,Sf:()=>d});var n=e(2543),s=e.n(n),l=e(15054),r=e(32696);function i(c,a,p,u){if(c===r.q5.Fill)return{width:a,height:p};const m=8*6,f=(window.innerWidth-60-l.dU*4)/l.cV*u.gridPos.w,E=l.sD*u.gridPos.h+m,h=Math.min(a/f,p/E);return f<=a&&E<=p?{width:f,height:E}:{width:f*h,height:E*h}}function g(c){return c?.meta.skipDataQuery===!1}const o=(c,a,p,u)=>{let m={...c.defaults};const v=p==null||p==="";return u?m.custom?v?m.custom=(0,n.omit)(m.custom,a):m.custom=d(m.custom,a,p):v||(m.custom=d(m.custom,a,p)):v?m=(0,n.omit)(m,a):m=d(m,a,p),{...c,defaults:m}};function d(c,a,p){const u=Array.isArray(a)?a:a.split("."),m=u.shift();if(m.endsWith("]")){const x=m.lastIndexOf("["),f=+m.substring(x+1,m.length-1),E=m.substring(0,x);let h=c[E];const y=Array.isArray(h)?[...h]:[];return u.length&&(h=y[f],(h==null||typeof h!="object")&&(h={}),p=d(h,u,p)),y[f]=p,{...c,[E]:y}}if(!u.length)return{...c,[m]:p};let v=c[m];return(v==null||typeof v!="object")&&(v={}),{...c,[m]:d(v,u,p)}}},31771:(k,A,e)=>{"use strict";e.d(A,{P:()=>c,Q:()=>a});var n=e(74848),s=e(32196),l=e(40845);const r="https://grafana.com/?src=grafananet&cnt=public-dashboards",i="public/img/grafana_text_logo_light.svg",g="public/img/grafana_text_logo_dark.svg",o="grafana-logo",d=u=>{const m=(0,l.$j)(),v=(0,l.of)(p),{footerHide:x,footerText:f,footerLink:E,footerLogo:h,headerLogoHide:y}=u||{footerHide:!1,footerText:"Powered by",footerLogo:o,footerLink:r,headerLogoHide:!1};return{footerHide:x,footerText:(0,n.jsx)("span",{className:v.text,children:f}),footerLogo:h===o?m.isDark?i:g:h,footerLink:E,headerLogoHide:y}};let c=()=>d();function a(u){c=()=>d(u)}const p=u=>({text:(0,s.css)({color:u.colors.text.secondary,fontSize:u.typography.body.fontSize})})},92378:(k,A,e)=>{"use strict";e.d(A,{G:()=>o,U:()=>d});var n=e(74848),s=e(96540),l=e(80943),r=e(90182),i=e(31678),g=e(87421);const o=({repeat:c,onChange:a,id:p})=>{const u=(0,i.useSelector)(x=>(0,g.SS)((0,g.y7)(x),x)),m=(0,s.useMemo)(()=>{const x=u.map(f=>({label:f.name,value:f.name}));return x.length===0&&x.unshift({label:"No template variables found",value:null}),x.unshift({label:"Disable repeating",value:null}),x},[u]),v=(0,s.useCallback)(x=>a(x.value),[a]);return(0,n.jsx)(r.l6,{inputId:p,value:c,onChange:v,options:m})},d=({parent:c,repeat:a,id:p,onChange:u})=>{const v=(0,s.useMemo)(()=>l.jh.getVariables(c),[c]).useState().variables,x=(0,s.useMemo)(()=>{const E=v.map(h=>({label:h.state.name,value:h.state.name}));return E.length===0&&E.unshift({label:"No template variables found",value:null}),E.unshift({label:"Disable repeating",value:null}),E},[v]),f=(0,s.useCallback)(E=>u(E.value),[u]);return(0,n.jsx)(r.l6,{inputId:p,value:a,onChange:f,options:x})}},78050:(k,A,e)=>{"use strict";e.d(A,{C:()=>o,m:()=>d});var n=e(74848),s=e(13544),l=e(14110),r=e(71678),i=e(55852),g=e(70497);const o=({dashboard:c,onSaveSuccess:a,size:p})=>(0,n.jsx)(r.$s,{children:({showModal:u,hideModal:m})=>(0,n.jsx)(i.$n,{size:p,onClick:()=>{u(g.$,{dashboard:c,onSaveSuccess:a,onDismiss:m})},"aria-label":s.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:"Save dashboard"})}),d=({dashboard:c,onClick:a,onSaveSuccess:p,variant:u,size:m})=>(0,n.jsx)(r.$s,{children:({showModal:v,hideModal:x})=>(0,n.jsx)(i.$n,{size:m,onClick:()=>{(0,l.rR)("grafana_dashboard_save_as_clicked"),a?.(),v(g.$,{dashboard:c,onSaveSuccess:p,onDismiss:x,isCopy:!0})},variant:u,"aria-label":s.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:"Save as"})})},54943:(k,A,e)=>{"use strict";e.d(A,{l:()=>d});var n=e(74848),s=e(16817),l=e(67061),r=e(62930),i=e(90613),g=e(19626),o=e(22764);const d=({diff:c,oldValue:a,newValue:p,hasFolderChanges:u,oldFolder:m,newFolder:v})=>{const x=(0,s.A)(async()=>{const E=JSON.stringify(a??{},null,2),h=JSON.stringify(p??{},null,2);let y;const b=[];let D=0;if(c)for(const[P,C]of Object.entries(c)){const M=(0,n.jsx)(g.D,{diffs:C,title:P},P);P==="schemaVersion"?y=M:b.push(M),D+=C.length}return{schemaChange:y,diffs:b,count:D,showDiffs:D<15,jsonView:(0,n.jsx)(o.M,{oldValue:E,newValue:h})}},[c,a,p]),{value:f}=x;return(0,n.jsxs)(l.B,{direction:"column",gap:1,children:[u&&(0,n.jsx)(g.D,{diffs:[{op:"replace",value:v,originalValue:m,path:[],startLineNumber:0,endLineNumber:0}],title:"folder"},"folder"),(!f||!a)&&(0,n.jsx)(r.y,{}),f&&f.count>=1?(0,n.jsxs)(n.Fragment,{children:[f&&f.schemaChange&&f.schemaChange,f&&f.showDiffs&&f.diffs,(0,n.jsxs)(i.a,{paddingTop:1,children:[(0,n.jsx)("h4",{children:"Full JSON diff"}),f.jsonView]})]}):(0,n.jsx)(i.a,{paddingTop:1,children:"No changes in the dashboard JSON"})]})}},70497:(k,A,e)=>{"use strict";e.d(A,{$:()=>Ke});var n=e(74848),s=e(96540),l=e(17172),r=e(32264),i=e(87978),g=e(63021),o=e(40675),d=e(56596),c=e(32196),a=e(16817),p=e(40845),u=e(42418),m=e(27677);function v({dashboard:_e}){const Fe=(0,p.of)(x),{loading:at,value:Ct,error:Dt}=(0,a.A)(async()=>{const ze=_e.getSaveModelCloneOld();return m.IB.validateDashboard(ze).catch(Se=>{if(Se.status>=500)throw Se;return Se.data})},[_e]);let tt;if(at)tt=(0,n.jsx)(u.F,{severity:"info",title:"Checking dashboard validity"});else if(Ct)Ct.isValid||(tt=(0,n.jsxs)(u.F,{severity:"warning",title:"Dashboard failed schema validation",children:[(0,n.jsx)("p",{children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"}),(0,n.jsx)("div",{className:Fe.error,children:Ct.message})]}));else{const ze=Dt?.message??"Unknown error";tt=(0,n.jsx)(u.F,{severity:"info",title:"Error checking dashboard validity",children:(0,n.jsx)("p",{className:Fe.error,children:ze})})}return tt?(0,n.jsx)("div",{className:Fe.root,children:tt}):null}const x=_e=>({root:(0,c.css)({marginTop:_e.spacing(1)}),error:(0,c.css)({fontFamily:_e.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),f=v;var E=e(54943),h=e(96374),y=e(37390),b=e(55852),D=e(78050),P=e(41053),C=e(71733),M=e(14110),I=e(39601),R=e(28138),T=e(3169),S=e(91219),L=e(55314),O=e(31678),j=e(28444),N=e(36974);const F=async(_e,Fe,at,Ct)=>{const Dt=await Ct({dashboard:_e,folderUid:Fe.folderUid??at.meta.folderUid??_e.meta?.folderUid,message:Fe.message,overwrite:Fe.overwrite,k8s:at.meta.k8s});if("error"in Dt)throw Dt.error;return Dt.data},U=(_e=!1)=>{const Fe=(0,O.useDispatch)(),at=(0,T._2)(),[Ct]=(0,L.e8)(),[Dt,tt]=(0,P.A)(async(ze,pe,Se)=>{try{const fe=await F(ze,pe,Se,Ct);Se.version=fe.version,ze.version=fe.version,Se.clearUnsavedChanges(ze,pe),R.A.publish(new j.Eu),at.success("Dashboard saved"),(0,N.ko)(fe.uid),_e?(0,M.rR)("grafana_dashboard_copied",{name:Se.title,url:fe.url}):(0,M.rR)(`grafana_dashboard_${Se.id?"saved":"created"}`,{name:Se.title,url:fe.url});const Ee=I.Ny.getLocation().pathname,Pe=C.I.stripBaseFromUrl(fe.url);return Pe!==Ee&&fe.url&&setTimeout(()=>I.Ny.replace(Pe)),Se.meta.isStarred&&Fe((0,S.TU)({id:Se.uid,title:Se.title,url:Pe})),fe}catch(fe){throw fe instanceof Error&&at.error(fe.message??"Error saving dashboard"),fe}},[Fe,at]);return{state:Dt,onDashboardSave:tt}},w=({dashboard:_e,dashboardSaveModel:Fe,error:at,onDismiss:Ct,setErrorIsHandled:Dt})=>{const{onDashboardSave:tt}=U();return(0,n.jsxs)(n.Fragment,{children:[at.data&&at.data.status==="version-mismatch"&&(0,n.jsx)(h.u,{isOpen:!0,title:"Conflict",body:(0,n.jsxs)("div",{children:["Someone else has updated this dashboard ",(0,n.jsx)("br",{})," ",(0,n.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await tt(Fe,{overwrite:!0},_e),Ct()},onDismiss:Ct}),at.data&&at.data.status==="name-exists"&&(0,n.jsx)(h.u,{isOpen:!0,title:"Conflict",body:(0,n.jsxs)("div",{children:["A dashboard with the same name in selected folder already exists. ",(0,n.jsx)("br",{}),(0,n.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await tt(Fe,{overwrite:!0},_e),Ct()},onDismiss:Ct}),at.data&&at.data.status==="plugin-dashboard"&&(0,n.jsx)(B,{dashboard:_e,onDismiss:()=>{Dt(!0),Ct()}})]})},B=({onDismiss:_e,dashboard:Fe})=>{const{onDashboardSave:at}=U(),Ct=(0,p.of)(W);return(0,n.jsxs)(y.a,{className:Ct.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:_e,children:[(0,n.jsxs)("div",{className:Ct.modalText,children:["Your changes will be lost when you update the plugin.",(0,n.jsx)("br",{}),(0,n.jsxs)("small",{children:["Use ",(0,n.jsx)("strong",{children:"Save As"})," to create custom version."]})]}),(0,n.jsxs)(y.a.ButtonRow,{children:[(0,n.jsx)(b.$n,{variant:"secondary",onClick:_e,fill:"outline",children:"Cancel"}),(0,n.jsx)(D.m,{onClick:_e,dashboard:Fe,onSaveSuccess:_e}),(0,n.jsx)(b.$n,{variant:"destructive",onClick:async()=>{await at(Fe.getSaveModelClone(),{overwrite:!0},Fe),_e()},children:"Overwrite"})]})]})},K=_e=>{switch(_e){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},W=_e=>({modal:(0,c.css)({width:"500px"}),modalText:(0,c.css)({fontSize:_e.typography.h4.fontSize,color:_e.colors.text.primary,marginBottom:_e.spacing(4),paddingTop:_e.spacing(2)}),modalButtonRow:(0,c.css)({marginBottom:"14px","a, button":{marginRight:_e.spacing(2)}})});var z=e(51253),Y=e(16504),X=e(88575),q=e(67061),G=e(60029),te=e(10354),H=e(21744),se=e(15292),ne=e(36607),le=e(71500),_=e(81394),Q=e(27966);const ae=_e=>{const Fe=_e.getSaveModelClone();return Fe.id=null,Fe.uid="",Fe.title+=" Copy",Fe.editable=!0,_e.id>0&&Fe.panels&&Fe.panels.forEach(at=>{at.type==="graph"&&at.alert&&delete at.thresholds,delete at.alert}),Fe},oe=({dashboard:_e,isLoading:Fe,isNew:at,onSubmit:Ct,onCancel:Dt,onSuccess:tt})=>{const ze={title:at?_e.title:`${_e.title} Copy`,description:_e.description,$folder:{uid:_e.meta.folderUid,title:_e.meta.folderTitle},copyTags:!1},pe=Se=>async fe=>{if(fe&&fe===Se().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await le.P.validateNewDashboardName(Se().$folder.uid??"general",fe),!0}catch(Ee){return Ee instanceof Error?Ee.message:"Dashboard name is invalid"}};return(0,n.jsx)(z.l,{defaultValues:ze,onSubmit:async Se=>{if(!Ct)return;const fe=ae(_e);fe.title=Se.title,fe.description=Se.description,!at&&!Se.copyTags&&(fe.tags=[]),(await Ct(fe,{folderUid:Se.$folder.uid},_e)).status==="success"&&tt()},children:({register:Se,control:fe,errors:Ee,getValues:Pe})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y.e,{render:({field:{ref:he,...be}})=>(0,n.jsx)(X.D,{label:(0,n.jsxs)(q.B,{justifyContent:"space-between",children:[(0,n.jsx)(G.J,{htmlFor:"title",children:"Title"}),r.$.featureToggles.dashgpt&&at&&(0,n.jsx)(Q.Z,{onGenerate:Ae=>be.onChange(Ae)})]}),invalid:!!Ee.title,error:Ee.title?.message,children:(0,n.jsx)(te.p,{...be,onChange:Ae=>be.onChange(Ae.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})}),control:fe,name:"title",rules:{validate:pe(Pe)}}),(0,n.jsx)(Y.e,{render:({field:{ref:he,...be}})=>(0,n.jsx)(X.D,{label:(0,n.jsxs)(q.B,{justifyContent:"space-between",children:[(0,n.jsx)(G.J,{htmlFor:"description",children:"Description"}),r.$.featureToggles.dashgpt&&at&&(0,n.jsx)(_.V,{onGenerate:Ae=>be.onChange(Ae)})]}),invalid:!!Ee.description,error:Ee.description?.message,children:(0,n.jsx)(H.f,{...be,onChange:Ae=>be.onChange(Ae.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})}),control:fe,name:"description"}),(0,n.jsx)(X.D,{label:"Folder",children:(0,n.jsx)(Y.e,{render:({field:{ref:he,...be}})=>(0,n.jsx)(ne.d,{...be,onChange:(Ae,De)=>be.onChange({uid:Ae,title:De}),value:be.value?.uid,initialTitle:_e.meta.folderTitle,dashboardId:_e.id,enableCreateNew:!0}),control:fe,name:"$folder"})}),!at&&(0,n.jsx)(X.D,{label:"Copy tags",children:(0,n.jsx)(se.d,{...Se("copyTags")})}),(0,n.jsxs)(q.B,{children:[(0,n.jsx)(b.$n,{type:"button",variant:"secondary",onClick:Dt,fill:"outline",children:"Cancel"}),(0,n.jsx)(b.$n,{disabled:Fe,type:"submit","aria-label":"Save dashboard button",children:Fe?"Saving...":"Save"})]})]})})};var J=e(13544),ee=e(10880),de=e(10740),xe=e(57725),re=e(3363);const ue=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),Te=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),ge=({dashboard:_e,onGenerate:Fe,disabled:at})=>{const Ct=(0,s.useCallback)(()=>Oe(_e),[_e]);return(0,n.jsx)(de.n,{messages:Ct,onGenerate:Fe,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:xe.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:at})};function Oe(_e){let{userChanges:Fe,migrationChanges:at}=(0,re.Yy)(_e);return Fe.length>8e3&&(Fe="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),at.split(`
`).length<10?at="No significant migration changes":at.length>8e3&&(at="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:ue,role:re.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${Fe}`,role:re.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:re.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${at}`,role:re.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:re.Xh.system},{content:Te,role:re.Xh.system}]}const Ue=({dashboard:_e,isLoading:Fe,saveModel:at,options:Ct,onSubmit:Dt,onCancel:tt,onSuccess:ze,onOptionsChange:pe})=>{const Se=(0,s.useMemo)(()=>_e.hasTimeChanged(),[_e]),fe=(0,s.useMemo)(()=>_e.hasVariablesChanged(),[_e]),[Ee,Pe]=(0,s.useState)(!1),[he,be]=(0,s.useState)(Ct.message),Ae=(0,p.of)(Xe);return(0,n.jsx)("form",{onSubmit:async De=>{if(De.preventDefault(),!Dt)return;Pe(!0),Ct={...Ct,message:he},(await Dt(at.clone,Ct,_e)).status==="success"?ze():Pe(!1)},style:{maxWidth:600},children:(0,n.jsxs)(q.B,{gap:2,direction:"column",alignItems:"flex-start",children:[Se&&(0,n.jsx)(ee.S,{checked:!!Ct.saveTimerange,onChange:()=>pe({...Ct,saveTimerange:!Ct.saveTimerange}),label:"Save current time range as dashboard default","aria-label":J.Tp.pages.SaveDashboardModal.saveTimerange}),fe&&(0,n.jsx)(ee.S,{checked:!!Ct.saveVariables,onChange:()=>pe({...Ct,saveVariables:!Ct.saveVariables}),label:"Save current variable values as dashboard default","aria-label":J.Tp.pages.SaveDashboardModal.saveVariables}),(0,n.jsxs)("div",{className:Ae.message,children:[r.$.featureToggles.aiGeneratedDashboardChanges&&(0,n.jsx)(ge,{dashboard:_e,onGenerate:De=>{pe({...Ct,message:De}),be(De)},disabled:!at.hasChanges}),(0,n.jsx)(H.f,{"aria-label":"message",value:he,onChange:De=>{pe({...Ct,message:De.currentTarget.value}),be(De.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})]}),(0,n.jsxs)(q.B,{alignItems:"center",children:[(0,n.jsx)(b.$n,{variant:"secondary",onClick:tt,fill:"outline",children:"Cancel"}),(0,n.jsx)(b.$n,{type:"submit",disabled:!at.hasChanges||Fe,icon:Ee?"spinner":void 0,"aria-label":J.Tp.pages.SaveDashboardModal.save,children:Fe?"Saving...":"Save"}),!at.hasChanges&&(0,n.jsx)("div",{children:"No changes to save"})]})]})})};function Xe(_e){return{message:(0,c.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var we=e(4213),qe=e(66864),We=e(10534);const Ce=({dashboard:_e,onCancel:Fe})=>{const[at,Ct]=(0,s.useState)(()=>{const tt=_e.getSaveModelClone();return delete tt.id,JSON.stringify(tt,null,2)}),Dt=(0,s.useCallback)(()=>{const tt=new Blob([at],{type:"application/json;charset=utf-8"});(0,we.saveAs)(tt,_e.title+"-"+new Date().getTime()+".json")},[_e.title,at]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(q.B,{direction:"column",gap:2,children:[(0,n.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,n.jsx)("br",{}),(0,n.jsxs)("i",{children:["See"," ",(0,n.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,n.jsx)("br",{})," ",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"File path: "})," ",_e.meta.provisionedExternalId]}),(0,n.jsx)(H.f,{spellCheck:!1,value:at,onChange:tt=>{Ct(tt.currentTarget.value)},className:je.json}),(0,n.jsxs)(qe.Gy,{children:[(0,n.jsx)(b.$n,{variant:"secondary",onClick:Fe,fill:"outline",children:"Cancel"}),(0,n.jsx)(We.b,{icon:"copy",getText:()=>at,children:"Copy JSON to clipboard"}),(0,n.jsx)(b.$n,{type:"submit",onClick:Dt,children:"Save JSON to file"})]})]})})},je={json:(0,c.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},Ke=({dashboard:_e,onDismiss:Fe,onSaveSuccess:at,isCopy:Ct})=>{const[Dt,tt]=(0,s.useState)({}),ze=_e.getOriginalDashboard(),pe=_e.meta.provisioned,Se=_e.version===0,fe=!!_e.meta.hasUnsavedFolderChange,[Ee,Pe]=(0,s.useState)(!1),he=(0,s.useMemo)(()=>{const pt=_e.getSaveModelClone({saveTimerange:!!Dt.saveTimerange,saveVariables:!!Dt.saveVariables});if(!ze)return{clone:pt,diff:{},diffCount:0,hasChanges:!1};const Tt=(0,d.G4)(ze,pt);let jt=0;for(const $t of Object.values(Tt))jt+=$t.length;return{clone:pt,diff:Tt,diffCount:jt,hasChanges:(jt>0||fe)&&!Se}},[_e,ze,Dt,Se,fe]),[be,Ae]=(0,s.useState)(!1),{state:De,onDashboardSave:Ie}=U(Ct),ke=at?()=>{Fe(),at()}:Fe,dt=()=>be?(0,n.jsx)(E.l,{diff:he.diff,oldValue:ze,newValue:he.clone}):Se||Ct?(0,n.jsx)(oe,{dashboard:_e,isLoading:De.loading,onCancel:Fe,onSuccess:ke,onSubmit:Ie,isNew:Se}):pe?(0,n.jsx)(Ce,{dashboard:_e,onCancel:Fe,onSuccess:ke}):(0,n.jsx)(Ue,{dashboard:_e,isLoading:De.loading,saveModel:he,onCancel:Fe,onSuccess:ke,onSubmit:Ie,options:Dt,onOptionsChange:tt});if(De.error&&!Ee&&(0,l.NF)(De.error)&&K(De.error.data.status))return(0,n.jsx)(w,{error:De.error,dashboard:_e,dashboardSaveModel:he.clone,onDismiss:Fe,setErrorIsHandled:Pe});let Pt="Save dashboard";return Ct?Pt="Save dashboard copy":pe&&(Pt="Provisioned dashboard"),(0,n.jsxs)(i._,{title:Pt,onClose:Fe,subtitle:_e.title,tabs:(0,n.jsxs)(g.U,{children:[(0,n.jsx)(o.o,{label:"Details",active:!be,onChangeTab:()=>Ae(!1)}),he.hasChanges&&(0,n.jsx)(o.o,{label:"Changes",active:be,onChangeTab:()=>Ae(!0),counter:he.diffCount})]}),children:[dt(),r.$.featureToggles.showDashboardValidationWarnings&&(0,n.jsx)(f,{dashboard:_e})]})}},35280:(k,A,e)=>{"use strict";e.d(A,{D:()=>v});var n=e(74848),s=e(96540),l=e(94701),r=e(14110),i=e(88575),g=e(15292),o=e(21744),d=e(37390),c=e(10534),a=e(8484),p=e(7758),u=e(87895),m=e(22699);function v({panel:x,dashboard:f,range:E,buildIframe:h=m.CF}){const[y,b]=(0,s.useState)(!0),[D,P]=(0,s.useState)("current"),[C,M]=(0,s.useState)("");(0,l.A)(()=>{(0,r.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,m.hD)(x)})}),(0,s.useEffect)(()=>{const O=h(y,f.uid,D,x,E);M(O)},[D,y,f,x,E,h]);const I=O=>{M(O.currentTarget.value)},R=()=>{b(O=>!O)},T=O=>{P(O)},L=f.time.to==="now"?(0,a.t)("share-modal.embed.time-range-description","Transforms the current relative time range to an absolute time range"):"";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(a.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel."})}),(0,n.jsx)(i.D,{label:(0,a.t)("share-modal.embed.time-range","Current time range"),description:L,children:(0,n.jsx)(g.d,{id:"share-current-time-range",value:y,onChange:R})}),(0,n.jsx)(u.w,{selectedTheme:D,onChange:T}),(0,n.jsx)(i.D,{label:(0,a.t)("share-modal.embed.html","Embed HTML"),description:(0,a.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the user viewing that page need to be signed into Grafana for the graph to load."),children:(0,n.jsx)(o.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:C,onChange:I})}),(0,n.jsx)(d.a.ButtonRow,{children:(0,n.jsx)(c.b,{icon:"copy",variant:"primary",getText:()=>C,onClipboardCopy:()=>{p.c.embedSnippetCopy({currentTimeRange:y,theme:D,shareResource:(0,m.hD)(x)})},children:(0,n.jsx)(a.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})})})]})}},86394:(k,A,e)=>{"use strict";e.d(A,{j:()=>o});var n=e(74848),s=e(96540),l=e(14110),r=e(8484),i=e(96227),g=e(22699);const o=({panel:d,initialFolderUid:c,onCreateLibraryPanel:a,onDismiss:p})=>((0,s.useEffect)(()=>{(0,l.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,g.hD)(d)})},[d]),d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(r.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,n.jsx)(i.b,{panel:d,initialFolderUid:c,onCreateLibraryPanel:a,onDismiss:p})]}):null)},7686:(k,A,e)=>{"use strict";e.d(A,{Zy:()=>ae,mJ:()=>se});var n=e(74848),s=e(96540),l=e(25897),r=e(37390),i=e(40980),g=e(40845),o=e(2913),d=e(10096),c=e(8484),a=e(4785),p=e(72254),u=e(7758),m=e(82792),v=e(35280),x=e(4213),f=e(88575),E=e(15292),h=e(55852),y=e(15858),b=e(28444),D=e(70713),P=e(32372),C=e(10534);function M({json:oe,onDismiss:J}){const ee=(0,s.useCallback)(()=>oe,[oe]);return(0,n.jsxs)(r.a,{title:"JSON",onDismiss:J,onClickBackdrop:J,isOpen:!0,children:[(0,n.jsx)(D.Ay,{disableHeight:!0,children:({width:de})=>(0,n.jsx)(P.B,{value:oe,language:"json",showMiniMap:!1,height:"500px",width:de})}),(0,n.jsx)(r.a.ButtonRow,{children:(0,n.jsx)(C.b,{icon:"copy",getText:ee,onClipboardCopy:()=>{u.c.exportCopyJsonClicked()},children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var I=e(22699);class R extends s.PureComponent{constructor(J){super(J),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:ee}=this.props,{shareExternally:de}=this.state;u.c.exportSaveJsonClicked({externally:de,shareResource:(0,I.hD)(this.props.panel)}),de?this.exporter.makeExportable(ee).then(xe=>{this.openSaveAsDialog(xe)}):this.openSaveAsDialog(ee.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:ee}=this.props,{shareExternally:de}=this.state;u.c.exportViewJsonClicked({externally:de,shareResource:(0,I.hD)(this.props.panel)}),de?this.exporter.makeExportable(ee).then(xe=>{this.openJsonModal(xe)}):this.openJsonModal(ee.getSaveModelClone())},this.openSaveAsDialog=ee=>{const de=JSON.stringify(ee,null,2),xe=new Blob([de],{type:"application/json;charset=utf-8"}),re=new Date().getTime();(0,x.saveAs)(xe,`${ee.title}-${re}.json`)},this.openJsonModal=ee=>{d.lE.publish(new b.S8({props:{json:JSON.stringify(ee,null,2)},component:M})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new y.M}render(){const{onDismiss:J}=this.props,{shareExternally:ee}=this.state,de=(0,c.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,n.jsx)(f.D,{label:de,children:(0,n.jsx)(E.d,{id:"share-externally-toggle",value:ee,onChange:this.onShareExternallyChange})}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(h.$n,{variant:"secondary",onClick:J,fill:"outline",children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,n.jsx)(h.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,n.jsx)(h.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var T=e(86394),S=e(13544),L=e(84167),O=e(10354),j=e(72109),N=e(42418),F=e(87895);class U extends s.PureComponent{constructor(J){super(J),this.buildUrl=async()=>{const{panel:ee,dashboard:de}=this.props,{useCurrentTimeRange:xe,useShortUrl:re,selectedTheme:ue}=this.state,Te=await(0,I.Xe)(xe,ue,ee,re),ge=(0,I.Lb)(xe,de.uid,ue,ee);this.setState({shareUrl:Te,imageUrl:ge})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=ee=>{this.setState({selectedTheme:ee})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{u.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,I.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(J,ee){const{useCurrentTimeRange:de,useShortUrl:xe,selectedTheme:re}=this.state;(ee.useCurrentTimeRange!==de||ee.selectedTheme!==re||ee.useShortUrl!==xe)&&this.buildUrl()}render(){const{panel:J,dashboard:ee}=this.props,de=ee?ee.time.to==="now":!1,{useCurrentTimeRange:xe,useShortUrl:re,selectedTheme:ue,shareUrl:Te,imageUrl:ge}=this.state,Oe=S.Tp.pages.SharePanelModal,Ue=!!ee.id,Xe=(0,c.t)("share-modal.link.time-range-label","Lock time range"),we=(0,c.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),qe=(0,c.t)("share-modal.link.shorten-url","Shorten URL"),We=(0,c.t)("share-modal.link.link-url","Link URL");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,n.jsxs)(L.n,{children:[(0,n.jsx)(f.D,{label:Xe,description:de?we:"",children:(0,n.jsx)(E.d,{id:"share-current-time-range",value:xe,onChange:this.onUseCurrentTimeRangeChange})}),(0,n.jsx)(F.w,{selectedTheme:ue,onChange:this.onThemeChange}),(0,n.jsx)(f.D,{label:qe,children:(0,n.jsx)(E.d,{id:"share-shorten-url",value:re,onChange:this.onUrlShorten})}),(0,n.jsx)(f.D,{label:We,children:(0,n.jsx)(O.p,{id:"link-url-input",value:Te,readOnly:!0,addonAfter:(0,n.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),J&&o.Ay.rendererAvailable&&(0,n.jsxs)(n.Fragment,{children:[Ue&&(0,n.jsx)(j.Y,{href:ge,external:!0,icon:"camera","aria-label":Oe.linkToRenderedImage,children:(0,c.t)("share-modal.link.rendered-image","Direct link rendered image")}),!Ue&&(0,n.jsx)(N.F,{severity:"info",title:(0,c.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),J&&!o.Ay.rendererAvailable&&(0,n.jsx)(N.F,{severity:"info",title:(0,c.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(c.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)(j.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var w=e(92041),B=e(12470),K=e(17172),W=e(90182),z=e(67061),Y=e(62930),X=e(74856),q=e(69064);class G extends s.PureComponent{constructor(J){super(J),this.createSnapshot=ee=>()=>{const{timeoutSeconds:de}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,ee)},de*1e3)},this.saveSnapshot=async(ee,de)=>{const{snapshotExpires:xe,timeoutSeconds:re}=this.state,ue=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(ue);const Te={dashboard:ue,name:ue.title,expires:xe,external:de};try{const ge=await(0,q.s)().create(Te);this.setState({deleteUrl:ge.deleteUrl,snapshotUrl:ge.url,step:2})}finally{de?u.c.publishSnapshotClicked({expires:xe,timeout:re,shareResource:(0,I.hD)(this.props.panel)}):u.c.publishSnapshotLocalClicked({expires:xe,timeout:re,shareResource:(0,I.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=ee=>{const{panel:de}=this.props,{snapshotName:xe}=this.state;ee.title=xe,ee.time=(0,X.jG)().timeRange(),ee.links=[],ee.panels.forEach(ue=>{ue.targets=[],ue.links=[],ue.datasource=null});const re=ee.annotations.list.filter(ue=>ue.enable);if(ee.annotations.list=re.map(ue=>({name:ue.name,enable:ue.enable,iconColor:ue.iconColor,snapshotData:ue.snapshotData,type:ue.type,builtIn:ue.builtIn,hide:ue.hide})),ee.getVariables().forEach(ue=>{"query"in ue&&(ue.query=""),"options"in ue&&(ue.options=ue.current&&!(0,w.R)(ue.current)?[ue.current]:[]),"refresh"in ue&&(ue.refresh=B.CO.never)}),de){const ue=de.getSaveModel();ue.gridPos.w=24,ue.gridPos.x=0,ue.gridPos.y=0,ue.gridPos.h=20,ee.panels=[ue]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(ue=>{delete ue.snapshotData}),this.dashboard.annotations.list.forEach(ue=>{delete ue.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:ee}=this.state;await(0,K.AI)().get(ee),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=ee=>{this.setState({snapshotName:ee.target.value})},this.onTimeoutChange=ee=>{this.setState({timeoutSeconds:Number(ee.target.value)})},this.onExpireChange=ee=>{this.setState({selectedExpireOption:ee,snapshotExpires:ee.value})},this.dashboard=J.dashboard,this.expireOptions=[{label:(0,c.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,c.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,c.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,c.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:J.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const J=await(0,q.s)().getSharingOptions();this.setState({sharingButtonText:J.externalSnapshotName,externalEnabled:J.externalEnabled})}renderStep1(){const{onDismiss:J}=this.props,{snapshotName:ee,selectedExpireOption:de,timeoutSeconds:xe,isLoading:re,sharingButtonText:ue,externalEnabled:Te}=this.state,ge=(0,c.t)("share-modal.snapshot.name","Snapshot name"),Oe=(0,c.t)("share-modal.snapshot.expire","Expire"),Ue=(0,c.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Xe=(0,c.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsxs)(c.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,n.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,n.jsx)(f.D,{label:ge,children:(0,n.jsx)(O.p,{id:"snapshot-name-input",width:30,value:ee,onChange:this.onSnapshotNameChange})}),(0,n.jsx)(f.D,{label:Oe,children:(0,n.jsx)(W.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:de,onChange:this.onExpireChange})}),(0,n.jsx)(f.D,{label:Ue,description:Xe,children:(0,n.jsx)(O.p,{id:"timeout-input",type:"number",width:21,value:xe,onChange:this.onTimeoutChange})}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(h.$n,{variant:"secondary",onClick:J,fill:"outline",children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),Te&&(0,n.jsx)(h.$n,{variant:"secondary",disabled:re,onClick:this.createSnapshot(!0),children:ue}),(0,n.jsx)(h.$n,{variant:"primary",disabled:re,onClick:this.createSnapshot(),children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:J}=this.state;return(0,n.jsxs)(z.B,{direction:"column",gap:0,children:[(0,n.jsx)(f.D,{label:(0,c.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,n.jsx)(O.p,{id:"snapshot-url-input",value:J,readOnly:!0,addonAfter:(0,n.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,n.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,n.jsx)(h.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,n.jsx)("div",{className:"share-modal-header",children:(0,n.jsx)("p",{className:"share-modal-info-text",children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})})}render(){const{isLoading:J,step:ee}=this.state;return(0,n.jsxs)(n.Fragment,{children:[ee===1&&this.renderStep1(),ee===2&&this.renderStep2(),ee===3&&this.renderStep3(),J&&(0,n.jsx)(Y.y,{inline:!0})]})}}const te=[],H=[];function se(oe){te.push(oe)}function ne(oe){H.push(oe)}function le(oe,J,ee){const xe=[{label:(0,c.t)("share-modal.tab-title.link","Link"),value:I.wr.link,component:U}];if(d.contextSrv.isSignedIn&&o.config.snapshotEnabled&&oe){const ue=(0,c.t)("share-modal.tab-title.snapshot","Snapshot");xe.push({label:ue,value:I.wr.snapshot,component:G})}if(J){const ue=(0,c.t)("share-modal.tab-title.embed","Embed");if(xe.push({label:ue,value:I.wr.embed,component:v.D}),!(0,m.X)(J)){const Te=(0,c.t)("share-modal.tab-title.library-panel","Library panel");xe.push({label:Te,value:I.wr.libraryPanel,component:T.j})}xe.push(...H)}else{const ue=(0,c.t)("share-modal.tab-title.export","Export");xe.push({label:ue,value:I.wr.export,component:R}),xe.push(...te),(0,p.iR)()&&xe.push({label:(0,c.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:I.wr.publicDashboard,component:a.b})}const re=xe.find(ue=>ue.value===ee);return{tabs:xe,activeTab:re?.value??xe[0].value}}function _(oe){const{tabs:J,activeTab:ee}=le(oe.dashboard.canEditDashboard(),oe.panel,oe.activeTab);return{tabs:J,activeTab:ee}}class Q extends s.Component{constructor(J){super(J),this.onSelectTab=ee=>{this.setState(de=>({...de,activeTab:ee.value})),u.c.sharingCategoryClicked({item:ee.value,shareResource:(0,I.hD)(this.props.panel)})},this.state=_(J)}getActiveTab(){const{tabs:J,activeTab:ee}=this.state;return J.find(de=>de.value===ee)}renderTitle(){const{panel:J}=this.props,{activeTab:ee}=this.state,de=J?(0,c.t)("share-modal.panel.title","Share Panel"):(0,c.t)("share-modal.dashboard.title","Share"),xe=this.props.dashboard.canEditDashboard(),re=le(xe,this.props.panel,this.state.activeTab).tabs;return(0,n.jsx)(l.J,{title:de,icon:"share-alt",tabs:re,activeTab:ee,onChangeTab:this.onSelectTab})}render(){const{dashboard:J,panel:ee}=this.props,xe=this.getActiveTab().component;return(0,n.jsx)(r.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,n.jsx)(i.J,{children:(0,n.jsx)(xe,{dashboard:J,panel:ee,onDismiss:this.props.onDismiss})})})}}const ae=(0,g.cV)(Q)},59037:(k,A,e)=>{"use strict";e.d(A,{K:()=>de,b:()=>ee});var n=e(74848),s=e(32196),l=e(49785),r=e(13544),i=e(40845),g=e(88575),o=e(10354),d=e(10534),c=e(15292),a=e(60029),p=e(66864),u=e(55852),m=e(71678),v=e(8484),x=e(72686),f=e(21380),E=e(7758),h=e(90591),y=e(16233),b=e(31678),D=e(52908);const P=()=>{const{width:re}=(0,D.A)();return re>1024};var C=e(7686),M=e(22699),I=e(29304),R=e(42418);const T=()=>(0,n.jsx)(R.F,{title:(0,v.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var S=e(12257),L=e(10872),O=e(72254),j=e(84167),N=e(54230);const F=r.Tp.pages.ShareDashboardModal.PublicDashboard,U=({disabled:re,onChange:ue,register:Te,timeRange:ge})=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(j.n,{disabled:re,children:(0,n.jsxs)(p.gW,{spacing:"md",children:[(0,n.jsxs)(p.PE,{orientation:1,spacing:"xs",justify:"space-between",children:[(0,n.jsx)(a.J,{description:(0,v.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,n.jsx)(N.b,{value:ge,disabled:!0,onChange:()=>{}})]}),(0,n.jsxs)(p.PE,{orientation:0,spacing:"sm",children:[(0,n.jsx)(c.d,{...Te("isTimeSelectionEnabled"),"data-testid":F.EnableTimeRangeSwitch,onChange:Oe=>{ue("isTimeSelectionEnabled",Oe.currentTarget.checked),E.c.publicDashboardTimeSelectionChanged({enabled:Oe.currentTarget.checked})}}),(0,n.jsx)(a.J,{description:(0,v.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,n.jsxs)(p.PE,{orientation:0,spacing:"sm",children:[(0,n.jsx)(c.d,{...Te("isAnnotationsEnabled"),onChange:Oe=>{ue("isAnnotationsEnabled",Oe.currentTarget.checked),E.c.publicDashboardAnnotationsSelectionChanged({enabled:Oe.currentTarget.checked})},"data-testid":F.EnableAnnotationsSwitch}),(0,n.jsx)(a.J,{description:(0,v.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var w=e(19727),B=e(94354),K=e(62930),W=e(34842);const z=r.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Y=({recipients:re,dashboardUid:ue,publicDashboardUid:Te})=>{const ge=(0,i.of)(q),[Oe,{isLoading:Ue}]=(0,x.$L)(),[Xe,{isLoading:we}]=(0,x.NA)(),qe=Ue||we,We=(je,Ke)=>{E.c.revokePublicDashboardEmailClicked(),Oe({recipientUid:je,recipientEmail:Ke,dashboardUid:ue,uid:Te})},Ce=je=>{E.c.resendPublicDashboardEmailClicked(),Xe({recipientUid:je,uid:Te})};return(0,n.jsx)("table",{className:ge.table,"data-testid":z.EmailSharingList,children:(0,n.jsx)("tbody",{children:re.map((je,Ke)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:je.recipient}),(0,n.jsx)("td",{children:(0,n.jsxs)(w.e,{className:ge.tableButtonsContainer,children:[(0,n.jsx)(u.$n,{type:"button",variant:"destructive",fill:"text",title:(0,v.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:qe,onClick:()=>We(je.uid,je.recipient),"data-testid":`${z.DeleteEmail}-${Ke}`,children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,n.jsx)(u.$n,{type:"button",variant:"primary",fill:"text",title:(0,v.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:qe,onClick:()=>Ce(je.uid),"data-testid":`${z.ReshareLink}-${Ke}`,children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},je.uid))})})},X=({dashboard:re})=>{const{width:ue}=(0,D.A)(),Te=(0,i.of)(q),ge=re instanceof W.H$?re.state.uid:re.uid,{data:Oe}=(0,x.Bs)(ge),[Ue]=(0,x.ft)(),[Xe,{isLoading:we}]=(0,x.NY)(),qe=y.TP.hasPermission(b.AccessControlAction.DashboardsPublicWrite),{register:We,setValue:Ce,control:je,watch:Ke,handleSubmit:_e,formState:{errors:Fe},reset:at}=(0,l.mN)({defaultValues:{shareType:Oe?.share||O.Xo.PUBLIC,email:""},mode:"onSubmit"}),Ct=tt=>{const ze={dashboard:re,payload:{...Oe,share:tt}};Ue(ze)},Dt=async tt=>{E.c.publicDashboardEmailInviteClicked(),await Xe({recipient:tt.email,uid:Oe.uid,dashboardUid:ge}).unwrap(),at({email:"",shareType:O.Xo.EMAIL})};return(0,n.jsx)("form",{onSubmit:_e(Dt),children:(0,n.jsxs)(j.n,{disabled:!qe,"data-testid":z.Container,className:Te.container,children:[(0,n.jsx)(g.D,{label:(0,v.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:Te.field,children:(0,n.jsx)(l.xI,{name:"shareType",control:je,render:({field:tt})=>{const{ref:ze,...pe}=tt,Se=[{label:(0,v.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:O.Xo.PUBLIC},{label:(0,v.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:O.Xo.EMAIL}];return(0,n.jsx)(B.z,{...pe,size:ue<480?"sm":"md",options:Se,onChange:fe=>{E.c.publicDashboardShareTypeChange({shareType:fe===O.Xo.EMAIL?"email":"public"}),Ce("shareType",fe),Ct(fe)}})}})}),Ke("shareType")===O.Xo.EMAIL&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{label:(0,v.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,v.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:Fe.email?.message,invalid:!!Fe.email?.message||void 0,className:Te.field,children:(0,n.jsxs)("div",{className:Te.emailContainer,children:[(0,n.jsx)(o.p,{className:Te.emailInput,placeholder:"email",autoCapitalize:"none",...We("email",{required:(0,v.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:O._l,message:(0,v.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":z.EmailSharingInput}),(0,n.jsxs)(u.$n,{type:"submit",variant:"primary",disabled:we,"data-testid":z.EmailSharingInviteButton,children:[(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),we&&(0,n.jsx)(K.y,{})]})]})}),!!Oe?.recipients?.length&&(0,n.jsx)(Y,{recipients:Oe.recipients,dashboardUid:ge,publicDashboardUid:Oe.uid})]})]})})},q=re=>({container:(0,s.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:re.spacing(3)}),field:(0,s.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,s.css)({label:"emailContainer",display:"flex",gap:re.spacing(1)}),emailInput:(0,s.css)({label:"emailInput",flexGrow:1}),table:(0,s.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:re.spacing(.5,1),":nth-child(odd)":{background:re.colors.background.secondary}}}),tableButtonsContainer:(0,s.css)({display:"flex",justifyContent:"end"})});var G=e(96540),te=e(67892),H=e(29158);function se({headerElement:re,isContentVisible:ue=!1,onRowToggle:Te,title:ge,...Oe}){const Ue=(0,i.of)(ne),Xe=re&&te.renderOrCallToRender(re,{className:Ue.summaryWrapper});return(0,n.jsx)("div",{className:Ue.wrapper,children:(0,n.jsxs)("div",{className:Ue.header,children:[(0,n.jsx)(H.K,{name:ue?"angle-down":"angle-right",tooltip:ue?(0,v.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,v.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:Ue.collapseIcon,onClick:Te,"aria-expanded":ue,...Oe}),ge&&(0,n.jsx)("div",{className:Ue.titleWrapper,onClick:Te,children:(0,n.jsx)("span",{className:Ue.title,children:ge})}),Xe]})})}se.displayName="SettingsBarHeader";function ne(re){return{wrapper:(0,s.css)({label:"header",padding:re.spacing(.5,.5),borderRadius:re.shape.radius.default,background:re.colors.background.secondary,minHeight:re.spacing(4),"&:focus":{outline:"none"}}),header:(0,s.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,s.css)({marginLeft:re.spacing(.5),color:re.colors.text.disabled}),titleWrapper:(0,s.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${re.spacing(.5)}`,[re.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,s.css)({fontWeight:re.typography.fontWeightBold,marginLeft:re.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,s.css)({display:"flex",flexWrap:"wrap",[re.breakpoints.down("sm")]:{flex:"2 2"}})}}function le({children:re,title:ue,headerElement:Te,...ge}){const Oe=(0,i.of)(_),[Ue,Xe]=(0,G.useState)(!1);function we(){Xe(qe=>!qe)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(se,{onRowToggle:we,isContentVisible:Ue,title:ue,headerElement:Te,...ge}),Ue&&(0,n.jsx)("div",{className:Oe.content,children:re})]})}le.displayName="SettingsBar";const _=re=>({content:(0,s.css)({marginTop:re.spacing(1),marginLeft:re.spacing(4)})});var Q=e(3799);function ae({className:re,isDataLoading:ue=!1,timeRange:Te,timeSelectionEnabled:ge,annotationsEnabled:Oe}){const Ue=(0,i.of)(oe),Xe=(0,v.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),we=(0,v.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),qe=(0,v.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),We=(0,v.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return ue?(0,n.jsx)("div",{className:(0,s.cx)(Ue.summaryWrapper,re),children:(0,n.jsx)(K.y,{className:Ue.summary,inline:!0,size:"sm"})}):(0,n.jsxs)("div",{className:(0,s.cx)(Ue.summaryWrapper,re),children:[(0,n.jsxs)("span",{className:Ue.summary,children:[(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,n.jsx)(Q.f,{className:Ue.timeRange,value:Te})]}),(0,n.jsx)("span",{className:Ue.summary,children:ge?Xe:we}),(0,n.jsx)("span",{className:Ue.summary,children:Oe?qe:We})]})}ae.displayName="SettingsSummary";const oe=re=>({summaryWrapper:(0,s.css)({display:"flex"}),summary:(0,s.css)({label:"collapsedText",marginLeft:`${re.spacing.gridSize*2}px`,fontSize:re.typography.bodySmall.fontSize,color:re.colors.text.secondary}),timeRange:(0,s.css)({display:"inline-block"})}),J=r.Tp.pages.ShareDashboardModal.PublicDashboard;function ee({onRevoke:re,timeRange:ue,hasTemplateVariables:Te=!1,showSaveChangesAlert:ge=!1,unsupportedDatasources:Oe=[],publicDashboard:Ue,dashboard:Xe}){const we=(0,i.of)(xe),qe=P(),[We,{isLoading:Ce}]=(0,x.T2)(),[je,{isLoading:Ke}]=(0,x.eq)(),_e=y.TP.hasPermission(b.AccessControlAction.DashboardsPublicWrite),Fe=!_e||Ce||Ke,{handleSubmit:at,setValue:Ct,register:Dt}=(0,l.mN)({defaultValues:{isAnnotationsEnabled:Ue?.annotationsEnabled,isTimeSelectionEnabled:Ue?.timeSelectionEnabled,isPaused:!Ue?.isEnabled}}),tt=async Ee=>{const{isAnnotationsEnabled:Pe,isTimeSelectionEnabled:he,isPaused:be}=Ee;We({dashboard:Xe,payload:{...Ue,annotationsEnabled:Pe,timeSelectionEnabled:he,isEnabled:!be}})},ze=async Ee=>{const{isAnnotationsEnabled:Pe,isTimeSelectionEnabled:he,isPaused:be}=Ee;je({dashboard:Xe,payload:{...Ue,annotationsEnabled:Pe,timeSelectionEnabled:he,isEnabled:!be}})},pe=async(Ee,Pe)=>{Ct(Ee,Pe),await at(he=>tt(he))()},Se=async Ee=>{Ct("isPaused",Ee),await at(Pe=>ze(Pe))()};function fe(){E.c.publicDashboardUrlCopied()}return(0,n.jsxs)("div",{className:we.configContainer,children:[ge&&(0,n.jsx)(T,{}),!_e&&(0,n.jsx)(I.t,{mode:"edit"}),Te&&(0,n.jsx)(L.D,{}),Oe.length>0&&(0,n.jsx)(S.s,{unsupportedDataSources:Oe.join(", ")}),(0,O.AY)()&&(0,n.jsx)(X,{dashboard:Xe}),(0,n.jsx)(g.D,{label:(0,v.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:we.fieldSpace,children:(0,n.jsx)(o.p,{value:(0,O.mL)(Ue.accessToken),readOnly:!0,disabled:!Ue?.isEnabled,"data-testid":J.CopyUrlInput,addonAfter:(0,n.jsx)(d.b,{"data-testid":J.CopyUrlButton,variant:"primary",disabled:!Ue?.isEnabled,getText:()=>(0,O.mL)(Ue.accessToken),onClipboardCopy:fe,children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,n.jsx)(g.D,{className:we.fieldSpace,children:(0,n.jsxs)(p.PE,{children:[(0,n.jsx)(c.d,{...Dt("isPaused"),disabled:Fe,onChange:Ee=>{E.c.publicDashboardPauseSharingClicked({paused:Ee.currentTarget.checked}),Se(Ee.currentTarget.checked)},"data-testid":J.PauseSwitch}),(0,n.jsx)(a.J,{className:(0,s.css)({marginBottom:0}),children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,n.jsx)(g.D,{className:we.fieldSpace,children:(0,n.jsx)(le,{title:(0,v.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:Ee})=>(0,n.jsx)(ae,{className:Ee,isDataLoading:Ce,timeRange:ue,timeSelectionEnabled:Ue?.timeSelectionEnabled,annotationsEnabled:Ue?.annotationsEnabled}),"data-testid":J.SettingsDropdown,children:(0,n.jsx)(U,{disabled:Fe,onChange:pe,register:Dt,timeRange:ue})})}),(0,n.jsx)(p.PE,{orientation:qe?0:1,justify:qe?"flex-end":"flex-start",align:qe?"center":"normal",children:(0,n.jsx)(p.Gy,{justify:"flex-end",children:(0,n.jsx)(u.$n,{title:(0,v.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:re,type:"button",disabled:Fe,"data-testid":J.DeleteButton,variant:"destructive",fill:"outline",children:(0,n.jsx)(v.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function de({publicDashboard:re,unsupportedDatasources:ue}){const ge=(0,b.useSelector)(We=>We.dashboard).getModel(),Oe=(0,f.z)(ge.getDefaultTime(),ge),Ue=y.TP.hasPermission(b.AccessControlAction.DashboardsPublicWrite),Xe=(0,O.kD)(ge.getVariables()),[we]=(0,x.bN)(),qe=We=>{we({dashboard:ge,uid:re.uid,dashboardUid:ge.uid}),We()};return(0,n.jsx)(m.$s,{children:({showModal:We,hideModal:Ce})=>(0,n.jsx)(ee,{publicDashboard:re,dashboard:ge,unsupportedDatasources:ue,timeRange:Oe,showSaveChangesAlert:Ue&&ge.hasUnsavedChanges(),hasTemplateVariables:Xe,onRevoke:()=>{E.c.revokePublicDashboardClicked(),We(h.m,{dashboardTitle:ge.title,onConfirm:()=>qe(Ce),onDismiss:()=>{We(C.Zy,{dashboard:ge,onDismiss:Ce,activeTab:M.wr.publicDashboard})}})}})})}const xe=re=>({configContainer:(0,s.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:re.spacing(3)}),fieldSpace:(0,s.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,s.css)({display:"inline-block"})})},22234:(k,A,e)=>{"use strict";e.d(A,{M:()=>R,D:()=>I});var n=e(74848),s=e(32196),l=e(49785),r=e(13544),i=e(40845),g=e(55852),o=e(62930),d=e(8484),c=e(16233),a=e(72686),p=e(7758),u=e(31678),m=e(29304),v=e(12257),x=e(10872),f=e(72254),E=e(71415),h=e(84167),y=e(66864),b=e(10880);const D=r.Tp.pages.ShareDashboardModal.PublicDashboard,P=({disabled:S,register:L})=>{const O=(0,i.of)(C),j=[{type:"publicAcknowledgment",description:(0,d.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:D.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,d.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,d.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:D.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,d.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,d.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:D.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,d.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:O.title,children:(0,n.jsx)(d.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,n.jsx)(h.n,{disabled:S,children:(0,n.jsx)(y.gW,{spacing:"md",children:j.map(N=>(0,n.jsxs)(y.Gy,{spacing:"none",align:"center",children:[(0,n.jsx)(b.S,{...L(N.type,{required:!0}),label:N.description,"data-testid":N.testId}),(0,n.jsx)(g.z9,{variant:"primary",href:N.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:N.info.tooltip})]},N.type))})})]})},C=S=>({title:(0,s.css)({fontWeight:S.typography.fontWeightBold})}),M=r.Tp.pages.ShareDashboardModal.PublicDashboard,I=({unsupportedDatasources:S=[],unsupportedTemplateVariables:L=!1,dashboard:O,hasError:j=!1})=>{const N=(0,i.of)(T),F=c.TP.hasPermission(u.AccessControlAction.DashboardsPublicWrite),[U,{isLoading:w,isError:B}]=(0,a.U9)(),K=()=>{U({dashboard:O,payload:{isEnabled:!0}}),p.c.generatePublicDashboardUrlClicked({})},{handleSubmit:W,register:z,formState:{isValid:Y}}=(0,l.mN)({mode:"onChange"}),X=!F||w||B||j;return(0,n.jsxs)("div",{className:N.container,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:N.title,children:(0,n.jsx)(d.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,n.jsx)("p",{className:N.description,children:(0,n.jsx)(d.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!F&&(0,n.jsx)(m.t,{mode:"create"}),L&&(0,n.jsx)(x.D,{}),S.length>0&&(0,n.jsx)(v.s,{unsupportedDataSources:S.join(", ")}),(0,n.jsxs)("form",{onSubmit:W(K),children:[(0,n.jsx)("div",{className:N.checkboxes,children:(0,n.jsx)(P,{disabled:X,register:z})}),(0,n.jsx)("div",{className:N.buttonContainer,children:(0,n.jsxs)(g.$n,{type:"submit",disabled:X||!Y,"data-testid":M.CreateButton,children:[(0,n.jsx)(d.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),w&&(0,n.jsx)(o.y,{className:N.loadingSpinner})]})})]})]})};function R({hasError:S}){const O=(0,u.useSelector)(F=>F.dashboard).getModel(),{unsupportedDataSources:j}=(0,E.Z)(O),N=(0,f.kD)(O.getVariables());return(0,n.jsx)(I,{dashboard:O,unsupportedDatasources:j,unsupportedTemplateVariables:N,hasError:S})}const T=S=>({container:(0,s.css)({display:"flex",flexDirection:"column",gap:S.spacing(4)}),title:(0,s.css)({fontSize:S.typography.h4.fontSize,margin:S.spacing(0,0,2)}),description:(0,s.css)({color:S.colors.text.secondary,marginBottom:S.spacing(0)}),checkboxes:(0,s.css)({margin:S.spacing(0,0,4)}),buttonContainer:(0,s.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,s.css)({marginLeft:S.spacing(1)})})},29304:(k,A,e)=>{"use strict";e.d(A,{t:()=>g});var n=e(74848),s=e(13544),l=e(42418),r=e(8484);const i=s.Tp.pages.ShareDashboardModal.PublicDashboard,g=({mode:o})=>(0,n.jsx)(l.F,{severity:"warning",title:(0,r.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:o}),"data-testid":i.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:(0,n.jsxs)(r.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:o}," public dashboards"]})})},12257:(k,A,e)=>{"use strict";e.d(A,{s:()=>a});var n=e(74848),s=e(32196),l=e(46942),r=e.n(l),i=e(13544),g=e(40845),o=e(42418),d=e(8484);const c=i.Tp.pages.ShareDashboardModal.PublicDashboard,a=({unsupportedDataSources:u})=>{const m=(0,g.of)(p);return(0,n.jsxs)(o.F,{severity:"warning",title:(0,d.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":c.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,n.jsx)("p",{className:m.unsupportedDataSourceDescription,children:(0,n.jsxs)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:u},"."]})}),(0,n.jsx)("a",{href:"https://grafana.com/docs/grafana/next/dashboards/dashboard-public/",target:"blank",className:r()("text-link",m.unsupportedDataSourceDescription),children:(0,n.jsx)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},p=u=>({unsupportedDataSourceDescription:(0,s.css)({color:u.colors.text.secondary,marginBottom:u.spacing(1)})})},10872:(k,A,e)=>{"use strict";e.d(A,{D:()=>g});var n=e(74848),s=e(13544),l=e(42418),r=e(8484);const i=s.Tp.pages.ShareDashboardModal.PublicDashboard,g=({showDescription:o=!0})=>(0,n.jsx)(l.F,{severity:"warning",title:(0,r.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":i.TemplateVariablesWarningAlert,bottomSpacing:0,children:o&&(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},4785:(k,A,e)=>{"use strict";e.d(A,{a:()=>u,b:()=>m});var n=e(74848),s=e(32196),l=e(40845),r=e(62930),i=e(72686),g=e(72254),o=e(31678),d=e(42930),c=e(59037),a=e(22234),p=e(71415);const u=()=>{const x=(0,l.of)(v);return(0,n.jsx)(d.G,{className:x.loadingContainer,children:(0,n.jsxs)(n.Fragment,{children:["Loading configuration",(0,n.jsx)(r.y,{size:"lg",className:x.spinner})]})})},m=x=>{const{data:f,isLoading:E,isError:h}=(0,i.Bs)(x.dashboard.uid),b=(0,o.useSelector)(P=>P.dashboard).getModel(),{unsupportedDataSources:D}=(0,p.Z)(b);return(0,n.jsx)(n.Fragment,{children:E?(0,n.jsx)(u,{}):(0,g.lI)(f)?(0,n.jsx)(c.K,{publicDashboard:f,unsupportedDatasources:D}):(0,n.jsx)(a.M,{hasError:h})})},v=x=>({loadingContainer:(0,s.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:x.spacing(1)}),spinner:(0,s.css)({marginBottom:x.spacing(0)})})},72254:(k,A,e)=>{"use strict";e.d(A,{AY:()=>f,Xo:()=>d,_A:()=>p,_l:()=>v,gN:()=>m,iR:()=>x,kD:()=>c,lI:()=>a,mL:()=>u});var n=e(26657),s=e(32264),l=e(33378),r=e(2913),i=e(31193),g=e(22699),o=e(31204),d=(E=>(E.PUBLIC="public",E.EMAIL="email",E))(d||{});const c=E=>E.length>0,a=E=>E?.uid!==""&&E?.uid!==void 0,p=async E=>{let h=new Set;for(const y of E)for(const b of y.targets){const D=b?.datasource?.type;D&&(o.z.has(D)&&await(0,i.tR)().get(b.datasource)instanceof n.iy||h.add(D))}return Array.from(h).sort()},u=E=>`${(0,r.zj)().appUrl}public-dashboards/${E}`,m=(E,h)=>`/d/${E}/${h}?shareView=${g.wr.publicDashboard}`,v=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,x=()=>!!s.$.featureToggles.publicDashboards&&s.$.publicDashboardsEnabled,f=()=>x()&&!!s.$.featureToggles.publicDashboardsEmailSharing&&(0,l.a)("publicDashboardsEmailSharing")},31204:(k,A,e)=>{"use strict";e.d(A,{z:()=>n});const n=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-pagerduty-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","highlightinc-highlight-datasource","ibm-aql-datasource","ibm-kql-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","postgres","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","timeplus-proton-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(k,A,e)=>{"use strict";e.d(A,{Z:()=>l});var n=e(96540),s=e(72254);const l=r=>{const[i,g]=(0,n.useState)([]);return(0,n.useEffect)(()=>{(async()=>await(0,s._A)(r.panels))().then(d=>{g(d)})},[r.panels]),{unsupportedDataSources:i}}},87895:(k,A,e)=>{"use strict";e.d(A,{w:()=>i});var n=e(74848),s=e(88575),l=e(94354),r=e(8484);const i=({selectedTheme:g="current",onChange:o})=>{const d=[{label:(0,r.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,r.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,r.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,n.jsx)(s.D,{label:(0,r.t)("share-modal.theme-picker.field-name","Theme"),children:(0,n.jsx)(l.z,{options:d,value:g,onChange:o})})}},1702:(k,A,e)=>{"use strict";e.d(A,{ShareModal:()=>n.Zy,addDashboardShareTab:()=>n.mJ});var n=e(7686)},22699:(k,A,e)=>{"use strict";e.d(A,{CF:()=>m,Lb:()=>u,P_:()=>c,XV:()=>d,Xe:()=>a,hD:()=>x,wr:()=>f});var n=e(65879),s=e(76885),l=e(71733),r=e(47232),i=e(32264),g=e(7030),o=e(74856);function d({useCurrentTimeRange:E,selectedTheme:h,panel:y,search:b=window.location.search,range:D=(0,o.jG)().timeRange(),orgId:P=i.$.bootData.user.orgId}){const C=new URLSearchParams(b),M=y?.timeFrom;if(M){const{from:I,to:R}=n.describeTextRange(M);C.set("from",I),C.set("to",R)}else C.set("from",String(D.from.valueOf())),C.set("to",String(D.to.valueOf()));return C.set("orgId",String(P)),E||(C.delete("from"),C.delete("to")),h!=="current"&&C.set("theme",h),y&&!C.has("editPanel")&&C.set("viewPanel",String(y.id)),C.delete("auth_token"),C.delete("shareView"),C}function c(){let E=window.location.href;const h=E.indexOf("?");return h!==-1&&(E=E.substring(0,h)),E}async function a(E,h,y,b){const D=c(),P=d({useCurrentTimeRange:E,selectedTheme:h,panel:y}),C=s.kM.appendQueryToUrl(D,P.toString());return b?await(0,g.fn)(C):C}function p(E,h,y,b,D){const P=c(),C=d({useCurrentTimeRange:E,selectedTheme:y,panel:b,range:D});let M=P.replace(i.$.appSubUrl+"/dashboard/",i.$.appSubUrl+"/dashboard-solo/");M=M.replace(i.$.appSubUrl+"/d/",i.$.appSubUrl+"/d-solo/"),l.I.stripBaseFromUrl(P)==="/"&&(M=`${i.$.appUrl}d-solo/${h}`);const R=C.get("editPanel")??C.get("viewPanel")??"";return C.set("panelId",R),C.delete("editPanel"),C.delete("viewPanel"),s.kM.appendQueryToUrl(M,C.toString())}function u(E,h,y,b){let P=p(E,h,y,b).replace(i.$.appSubUrl+"/dashboard-solo/",i.$.appSubUrl+"/render/dashboard-solo/");return P=P.replace(i.$.appSubUrl+"/d-solo/",i.$.appSubUrl+"/render/d-solo/"),P+=`&width=${i.$.rendererDefaultImageWidth}&height=${i.$.rendererDefaultImageHeight}&scale=${i.$.rendererDefaultImageScale}`+v(),P}function m(E,h,y,b,D){return`<iframe src="${p(E,h,y,b,D)}" width="450" height="200" frameborder="0"></iframe>`}function v(){const E="&tz=UTC"+encodeURIComponent((0,r.KQ)().format("Z"));if(!window.Intl)return E;const h=window.Intl.DateTimeFormat();if(!h.resolvedOptions)return E;const y=h.resolvedOptions();return y.timeZone?"&tz="+encodeURIComponent(y.timeZone):E}const x=E=>E?"panel":"dashboard",f={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(k,A,e)=>{"use strict";e.d(A,{Zx:()=>D,aK:()=>f});var n=e(74848),s=e(32196),l=e(96540),r=e(16817),i=e(80997),g=e(13544),o=e(40845),d=e(38138),c=e(40276),a=e(83122),p=e(14578),u=e(55852),m=e(27677),v=e(6923);function x({dashboardUID:P,link:C}){const M=(0,o.of)(b),I=E({dashboardUID:P,link:C});return!I||y.length===0?null:(0,n.jsx)(d.W,{children:(0,n.jsx)("div",{className:M.dropdown,children:(0,n.jsx)(c.E,{children:I.map((R,T)=>(0,n.jsx)(d.W.Item,{url:R.url,target:C.targetBlank?"_blank":void 0,label:R.title,testId:g.Tp.components.DashboardLinks.link,"aria-label":`${R.title} dashboard`},`dashlinks-dropdown-item-${R.uid}-${T}`))})})})}const f=P=>{const{link:C,linkInfo:M,dashboardUID:I}=P,R=E(P),T=(0,o.of)(b);return C.asDropdown?(0,n.jsx)(a.m,{overlay:(0,n.jsx)(x,{link:C,dashboardUID:I}),children:(0,n.jsxs)(D,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":g.Tp.components.DashboardLinks.dropDown,children:[(0,n.jsx)(p.I,{"aria-hidden":!0,name:"bars",className:T.iconMargin}),(0,n.jsx)("span",{children:M.title})]})}):(0,n.jsx)(n.Fragment,{children:R.length>0&&R.map((S,L)=>(0,n.jsx)(D,{icon:"apps",variant:"secondary",fill:"outline",href:S.url,target:C.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":g.Tp.components.DashboardLinks.link,children:S.title},`dashlinks-list-item-${S.uid}-${L}`))})},E=({link:P,dashboardUID:C})=>{const{tags:M}=P,I=(0,r.A)(()=>h(M),[M]);return I.value?y(C,P,I.value):[]};async function h(P,C={getBackendSrv:m.AI}){return await C.getBackendSrv().search({tag:P,limit:100})}function y(P,C,M,I={getLinkSrv:v.mQ,sanitize:i.aj,sanitizeUrl:i.Jf}){return M.filter(R=>R.uid!==P).map(R=>{const T=R.uid,S=I.sanitize(R.title),L=I.getLinkSrv().getLinkUrl({...C,url:R.url}),O=I.sanitizeUrl(L);return{uid:T,title:S,url:O}})}function b(P){return{iconMargin:(0,s.css)({marginRight:P.spacing(.5)}),dropdown:(0,s.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,s.css)({color:P.colors.text.primary}),dashButton:(0,s.css)({fontSize:P.typography.bodySmall.fontSize,paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})}}const D=(0,l.forwardRef)(({className:P,...C},M)=>{const I=(0,o.of)(b),R=C.href?u.z9:u.$n;return(0,n.jsx)(R,{...C,variant:"secondary",fill:"outline",className:(0,s.cx)(P,I.dashButton),ref:M})});D.displayName="DashboardLinkButton"},57650:(k,A,e)=>{"use strict";e.d(A,{A:()=>U});var n=e(74848),s=e(97497),l=e(96540),r=e(42941),i=e(1173),g=e(52622),o=e(13544),d=e(14110),c=e(96374),a=e(10343),p=e(7788),u=e(2913),m=e(10803),v=e(32196),x=e(69862),f=e(85200),E=e(2514),h=e(72574),y=e(40845),b=e(87978),D=e(24022),P=e(14578);const C=({debugMode:w,index:B,data:K,uiConfig:W,configs:z,onChange:Y,toggleShowDebug:X})=>{const q=(0,y.of)(M),[G,te]=(0,l.useState)([]),[H,se]=(0,l.useState)([]),ne=(0,l.useMemo)(()=>z[B],[z,B]);(0,l.useEffect)(()=>{const _=z[B].transformation,Q=_.filter?.options?(0,f.Dq)(_.filter):void 0,ae=z.slice(0,B).map(xe=>xe.transformation),oe=z.slice(B,B+1).map(xe=>xe.transformation),J={interpolate:xe=>(0,h.w)().replace(xe)},ee=(0,E.m)(ae,K,J).subscribe(xe=>{Q&&(xe=K.filter(re=>Q(re))),te(xe)}),de=(0,E.m)(ae,K,J).pipe((0,x.Z)(xe=>(0,E.m)(oe,xe,J))).subscribe(se);return function(){ee.unsubscribe(),de.unsubscribe()}},[B,K,z]);const le=(0,l.useMemo)(()=>(0,l.createElement)(W.editor,{options:{...W.transformation.defaultOptions,...ne.transformation.options},input:G,onChange:_=>{Y(B,{...ne.transformation,options:_})}}),[W.editor,W.transformation.defaultOptions,ne.transformation,G,Y,B]);return(0,n.jsxs)("div",{"data-testid":o.Tp.components.TransformTab.transformationEditor(W.name),children:[le,w&&(0,n.jsx)(b._,{title:"Debug transformation",subtitle:W.name,onClose:X,children:(0,n.jsxs)("div",{className:q.debugWrapper,"data-testid":o.Tp.components.TransformTab.transformationEditorDebugger(W.name),children:[(0,n.jsxs)("div",{className:q.debug,children:[(0,n.jsx)("div",{className:q.debugTitle,children:"Input data"}),(0,n.jsx)("div",{className:q.debugJson,children:(0,n.jsx)(D.B,{json:G})})]}),(0,n.jsx)("div",{className:q.debugSeparator,children:(0,n.jsx)(P.I,{name:"arrow-right"})}),(0,n.jsxs)("div",{className:q.debug,children:[(0,n.jsx)("div",{className:q.debugTitle,children:"Output data"}),(0,n.jsx)("div",{className:q.debugJson,children:H&&(0,n.jsx)(D.B,{json:H})})]})]})})]})},M=w=>({title:(0,v.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,v.css)({fontWeight:w.typography.fontWeightMedium,color:w.colors.primary.text}),iconRow:(0,v.css)({display:"flex"}),icon:(0,v.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:w.colors.text.secondary,marginLeft:w.spacing(1),"&:hover":{color:w.colors.text.primary}}),debugWrapper:(0,v.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,v.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${w.spacing(.5)}`,color:w.colors.primary.text}),debugTitle:(0,v.css)({padding:`${w.spacing(1)} ${w.spacing(.25)}`,fontFamily:w.typography.fontFamilyMonospace,fontSize:w.typography.bodySmall.fontSize,color:w.colors.text.primary,borderBottom:`1px solid ${w.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,v.css)({marginTop:w.spacing(1),padding:`0 ${w.spacing(1,1,1)}`,border:`1px solid ${w.colors.border.weak}`,background:`${w.isLight?w.v1.palette.white:w.v1.palette.gray05}`,borderRadius:w.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,v.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:w.spacing(.5)})});var I=e(22214),R=e(91847);const T=({isOpen:w,onCloseClick:B,transformer:K})=>{const{transformation:{name:W},help:z}=K,Y=z||(0,R.$n)(),X=(0,n.jsx)(b._,{title:W,subtitle:"Transformation help",onClose:()=>B(!1),children:(0,n.jsx)(I.j,{markdown:Y,styleOverrides:{borderTop:"2px solid"}})});return w?X:null};var S=e(88575),L=e(90182),O=e(19743);const j=({index:w,data:B,config:K,onChange:W})=>{const z=(0,y.of)(N),Y=(0,l.useMemo)(()=>({context:{data:B.series},showTopic:!0,showFilter:K.topic!==g.QR.Annotations,source:[{value:g.QR.Series,label:"Query results"},{value:g.QR.Annotations,label:"Annotation data"}]}),[B,K.topic]);return(0,n.jsx)("div",{className:z.wrapper,children:(0,n.jsx)(S.D,{label:"Apply transformation to",children:(0,n.jsxs)(n.Fragment,{children:[Y.showTopic&&(0,n.jsx)(L.l6,{isClearable:!0,options:Y.source,value:Y.source.find(X=>X.value===K.topic),placeholder:Y.source[0].label,className:z.padded,onChange:X=>{W(w,{...K,topic:X?.value})}}),Y.showFilter&&(0,n.jsx)(O.x,{value:K.filter,context:Y.context,item:{},onChange:X=>W(w,{...K,filter:X})})]})})})},N=w=>{const B=w.shape.radius.default;return{wrapper:(0,v.css)({padding:w.spacing(2),border:`2px solid ${w.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${B} ${B}`,position:"relative",top:"-4px"}),padded:(0,v.css)({marginBottom:w.spacing(1)})}},F=({onRemove:w,index:B,id:K,data:W,configs:z,uiConfig:Y,onChange:X})=>{const[q,G]=(0,r.A)(!1),[te,H]=(0,r.A)(!1),[se,ne]=(0,r.A)(!1),le=!!z[B].transformation.disabled,_=z[B].transformation.topic,Q=z[B].transformation.filter!=null||_!=null,ae=Q||W.series.length>1||(W.annotations?.length??0)>0,oe=(0,l.useCallback)(xe=>{const re=z[xe].transformation;X(xe,{...re,disabled:re.disabled?void 0:!0})},[X,z]),J=(0,l.useCallback)(()=>{let xe={...z[B].transformation};xe.filter?delete xe.filter:xe.filter={id:i.jR.byRefId,options:""},X(B,xe)},[X,B,z]),ee=(0,l.useCallback)((xe,re,ue)=>Te=>{let ge="panel_editor_tabs_transformations_toggle";u.Ay.featureToggles.transformationsRedesign&&(ge="transformations_redesign_"+ge),(0,d.rR)(ge,{action:ue?"off":"on",toggleId:re,transformationId:z[B].transformation.id}),xe(Te)},[z,B]),de=()=>(0,n.jsxs)(n.Fragment,{children:[Y.state&&(0,n.jsx)(m.p,{state:Y.state}),(0,n.jsx)(a.A,{title:"Show transform help",icon:"info-circle",onClick:ee(ne,"help",se),active:se}),ae&&(0,n.jsx)(a.A,{title:"Filter",icon:"filter",onClick:ee(J,"filter",Q),active:Q}),(0,n.jsx)(a.A,{title:"Debug",icon:"bug",onClick:ee(H,"debug",te),active:te}),(0,n.jsx)(a.A,{title:"Disable transformation",icon:le?"eye-slash":"eye",onClick:ee(()=>oe(B),"disabled",le),active:le,dataTestId:o.Tp.components.Transforms.disableTransformationButton}),(0,n.jsx)(a.q,{title:"Remove",icon:"trash-alt",onClick:()=>u.Ay.featureToggles.transformationsRedesign?G(!0):w(B)}),u.Ay.featureToggles.transformationsRedesign&&(0,n.jsx)(c.u,{isOpen:q,title:`Delete ${Y.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{G(!1),w(B)},onDismiss:()=>G(!1)})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.u,{id:K,index:B,title:`${B+1} - ${Y.name}`,draggable:!0,actions:de,disabled:le,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[Q&&(0,n.jsx)(j,{index:B,config:z[B].transformation,data:W,onChange:X}),(0,n.jsx)(C,{debugMode:te,index:B,data:_===g.QR.Annotations?W.annotations??[]:W.series,configs:z,uiConfig:Y,onChange:X,toggleShowDebug:H})]}),(0,n.jsx)(T,{transformer:Y,isOpen:se,onCloseClick:ne})]})},U=({data:w,onChange:B,onRemove:K,configs:W})=>(0,n.jsx)(n.Fragment,{children:W.map((z,Y)=>{const X=s.h.getIfExists(z.transformation.id);return X?(0,n.jsx)(F,{index:Y,id:`${z.id}`,data:w,configs:W,uiConfig:X,onRemove:K,onChange:B},`${z.id}`):null})})},21427:(k,A,e)=>{"use strict";e.d(A,{R:()=>D});var n=e(74848),s=e(32196),l=e(96540),r=e(81010),i=e(18282),g=e(97497),o=e(13544),d=e(40845),c=e(87978),a=e(10354),p=e(15292),u=e(92174),m=e(10860),v=e(29158),x=e(2913),f=e(10803),E=e(94397);const b=[["viewAll","View all"],...Object.entries(E.eJ)];function D(S){const L=(0,d.of)(P),{suffix:O,xforms:j,search:N,onSearchChange:F,onSearchKeyDown:U,showIllustrations:w,onTransformationAdd:B,selectedFilter:K,data:W,onClose:z,onShowIllustrationsChange:Y,onSelectedFilterChange:X}=S,q=(0,l.useCallback)(G=>{G?.click()},[]);return(0,n.jsxs)(c._,{size:"md",onClose:()=>{z&&z()},title:"Add another transformation",children:[(0,n.jsxs)("div",{className:L.searchWrapper,children:[(0,n.jsx)(a.p,{"data-testid":o.Tp.components.Transforms.searchInput,className:L.searchInput,value:N??"",placeholder:"Search for transformation",onChange:F,onKeyDown:U,suffix:O,ref:q}),(0,n.jsxs)("div",{className:L.showImages,children:[(0,n.jsx)("span",{className:L.illustationSwitchLabel,children:"Show images"})," ",(0,n.jsx)(p.d,{value:w,onChange:()=>Y&&Y(!w)})]})]}),(0,n.jsx)("div",{className:L.filterWrapper,children:b.map(([G,te])=>(0,n.jsx)(u.m,{onClick:()=>X&&X(G),label:te,selected:K===G},G))}),(0,n.jsx)(C,{showIllustrations:w,transformations:j,data:W,onClick:G=>{B({value:G})}})]})}function P(S){return{showImages:(0,s.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,s.css)({fontSize:"16px",marginBottom:`${S.spacing(2)}`}),pickerInformationLineHighlight:(0,s.css)({verticalAlign:"middle"}),searchWrapper:(0,s.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,s.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,s.css)({whiteSpace:"nowrap"}),filterWrapper:(0,s.css)({padding:`${S.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${S.spacing(1)}`,columnGap:`${S.spacing(.5)}`})}}function C({showIllustrations:S,transformations:L,onClick:O,data:j}){const N=(0,d.of)(M);return(0,n.jsx)("div",{className:N.grid,children:L.map(F=>{let U=r.M.Applicable;F.transformation.isApplicable!==void 0&&(U=F.transformation.isApplicable(j));const w=U>0;let B=null;F.transformation.isApplicableDescription!==void 0&&(typeof F.transformation.isApplicableDescription=="function"?B=F.transformation.isApplicableDescription(j):B=F.transformation.isApplicableDescription);let K=N.newCard;return w||(K=(0,s.cx)(N.newCard,N.cardDisabled)),(0,n.jsxs)(m.Z,{className:K,"data-testid":o.Tp.components.TransformTab.newTransform(F.name),onClick:()=>O(F.id),children:[(0,n.jsxs)(m.Z.Heading,{className:N.heading,children:[(0,n.jsx)("span",{children:F.name}),(0,n.jsx)("span",{className:N.pluginStateInfoWrapper,children:(0,n.jsx)(f.p,{state:F.state})})]}),(0,n.jsxs)(m.Z.Description,{className:N.description,children:[(0,n.jsx)("span",{children:T(F.id)}),S&&(0,n.jsx)("span",{children:(0,n.jsx)("img",{className:N.image,src:I(F.id,!w),alt:F.name})}),!w&&B!==null&&(0,n.jsx)(v.K,{className:N.cardApplicableInfo,name:"info-circle",tooltip:B})]})]},F.id)})})}function M(S){return{heading:(0,s.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,s.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,s.css)({display:"block",maxEidth:"100%`",marginTop:`${S.spacing(2)}`}),grid:(0,s.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${S.spacing(2)} ${S.spacing(1)}`,width:"100%"}),cardDisabled:(0,s.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${S.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,s.css)({position:"absolute",bottom:`${S.spacing(1)}`,right:`${S.spacing(1)}`}),newCard:(0,s.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,s.css)({marginLeft:"5px"})}}const I=(S,L)=>`public/img/transformations/${x.Ay.theme2.isDark?"dark":"light"}/${S}.svg`,R={[i.F.concatenate]:"Combine all fields into a single frame.",[i.F.configFromData]:"Set unit, min, max and more.",[i.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[i.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[i.F.filterByRefId]:"Remove rows from the data based on origin query",[i.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[i.F.groupBy]:"Group data by a field value and create aggregate data.",[i.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[i.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[i.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[i.F.merge]:"Merge multiple series. Values will be combined into one row.",[i.F.organize]:"Re-order, hide, or rename fields.",[i.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[i.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[i.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[i.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[i.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},T=S=>R[S]||g.h.getIfExists(S)?.description||""},66879:(k,A,e)=>{"use strict";e.d(A,{o:()=>B,e:()=>U});var n=e(74848),s=e(91076),l=e(96540),r=e(97497),i=e(13544),g=e(14110),o=e(29158),d=e(55852),c=e(96374),a=e(19727),p=e(40276),u=e(66864),m=e(40845),v=e(2913),x=e(79280),f=e(39601),E=e(32696);function h({message:K}){const W=(0,l.useCallback)(()=>{f.Ny.partial({tab:E.M8.Query})},[]);return(0,n.jsx)(u.PE,{justify:"center",style:{marginTop:"100px"},children:(0,n.jsxs)(u.gW,{spacing:"md",children:[(0,n.jsx)("h2",{children:K}),(0,n.jsx)("div",{children:(0,n.jsx)(d.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:W,children:"Go back to Queries"})})]})})}var y=e(57650),b=e(32196),D=e(87885),P=e(42418),C=e(10354),M=e(10860),I=e(61680);const R={[D.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[D.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[D.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},T=K=>R[K];var S=e(10803);const L="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function O(K){const{noTransforms:W,search:z,xforms:Y,onSearchChange:X,onSearchKeyDown:q,onTransformationAdd:G,suffix:te}=K;return(0,n.jsxs)(u.gW,{children:[W&&(0,n.jsx)(u.mc,{grow:1,children:(0,n.jsx)(I.b,{storageKey:L,defaultValue:!1,children:(H,se)=>H?null:(0,n.jsxs)(P.F,{title:"Transformations",severity:"info",onRemove:()=>{se(!0)},children:[(0,n.jsxs)("p",{children:["Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",(0,n.jsx)("br",{}),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",(0,n.jsx)("br",{}),"It can help to switch to the Table visualization to understand what a transformation is doing."," "]}),(0,n.jsx)("a",{href:T(D.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:"Read more"})]})})}),(0,n.jsx)(C.p,{"data-testid":i.Tp.components.Transforms.searchInput,value:z??"",autoFocus:!W,placeholder:"Search for transformation",onChange:X,onKeyDown:q,suffix:te}),Y.map(H=>(0,n.jsx)(j,{transform:H,onClick:()=>{G({value:H.id})}},H.name))]})}function j({transform:K,onClick:W}){const z=(0,m.of)(N);return(0,n.jsxs)(M.Z,{className:z.card,"data-testid":i.Tp.components.TransformTab.newTransform(K.name),onClick:W,children:[(0,n.jsx)(M.Z.Heading,{children:K.name}),(0,n.jsx)(M.Z.Description,{children:K.description}),K.state&&(0,n.jsx)(M.Z.Tags,{children:(0,n.jsx)(S.p,{state:K.state})})]})}function N(K){return{card:(0,b.css)({margin:"0",padding:`${K.spacing(1)}`})}}var F=e(21427);const U="viewAll";class w extends l.PureComponent{constructor(W){super(W),this.onSearchChange=X=>{this.setState({search:X.target.value})},this.onSearchKeyDown=X=>{if(X.key==="Enter"){const{search:q}=this.state;if(q){const G=q.toLowerCase(),te=r.h.list().filter(H=>(H.name+H.description).toLowerCase().indexOf(G)>=0);te.length>0&&this.onTransformationAdd({value:te[0].id})}}else X.keyCode===27&&(this.setState({search:"",showPicker:!1}),X.stopPropagation())},this.getTransformationNextId=X=>{const{transformations:q}=this.state;let G=0;const te=q.filter(H=>H.id.startsWith(X)).map(H=>H.id);return te.length!==0&&(G=Math.max(...te.map(H=>parseInt(H.match(/\d+/)[0],10)))+1),`${X}-${G}`},this.onTransformationAdd=X=>{let q="panel_editor_tabs_transformations_management";v.Ay.featureToggles.transformationsRedesign&&(q="transformations_redesign_"+q),(0,g.rR)(q,{action:"add",transformationId:X.value});const{transformations:G}=this.state,te=this.getTransformationNextId(X.value);this.setState({search:"",showPicker:!1}),this.onChange([...G,{id:te,transformation:{id:X.value,options:{}}}])},this.onTransformationChange=(X,q)=>{const{transformations:G}=this.state,te=Array.from(G);let H="panel_editor_tabs_transformations_management";v.Ay.featureToggles.transformationsRedesign&&(H="transformations_redesign_"+H),(0,g.rR)(H,{action:"change",transformationId:te[X].transformation.id}),te[X].transformation=q,this.onChange(te)},this.onTransformationRemove=X=>{const{transformations:q}=this.state,G=Array.from(q);let te="panel_editor_tabs_transformations_management";v.Ay.featureToggles.transformationsRedesign&&(te="transformations_redesign_"+te),(0,g.rR)(te,{action:"remove",transformationId:G[X].transformation.id}),G.splice(X,1),this.onChange(G)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=X=>{const{transformations:q}=this.state;if(!X||!X.destination)return;const G=X.source.index,te=X.destination.index;if(G===te)return;const H=Array.from(q),[se]=H.splice(G,1);H.splice(te,0,se),this.onChange(H)},this.renderEmptyMessage=()=>(0,n.jsx)(x.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:X,transformations:q}=this.state;return(0,n.jsx)(s.JY,{onDragEnd:this.onDragEnd,children:(0,n.jsx)(s.gL,{droppableId:"transformations-list",direction:"vertical",children:G=>(0,n.jsxs)("div",{ref:G.innerRef,...G.droppableProps,children:[(0,n.jsx)(y.A,{configs:q,data:X,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),G.placeholder]})})})};const z=W.panel.transformations||[],Y=this.buildTransformationIds(z);this.state={transformations:z.map((X,q)=>({transformation:X,id:Y[q]})),data:{series:[]},search:"",selectedFilter:U,showIllustrations:!0}}buildTransformationIds(W){const z={},Y=[];for(let X=0;X<W.length;X++){const q=W[X];z[q.id]===void 0?z[q.id]=0:z[q.id]+=1,Y.push(`${W[X].id}-${z[W[X].id]}`)}return Y}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:W=>this.setState({data:W})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(W,z){if(v.Ay.featureToggles.transformationsRedesign){const X=!(z.transformations.length>0)||z.showPicker,G=!(this.state.transformations.length>0)||this.state.showPicker;if(X!==G){const te=Math.random()/2;this.setState({scrollTop:G?te:Number.MAX_SAFE_INTEGER})}}}onChange(W){this.setState({transformations:W}),this.props.panel.setTransformations(W.map(z=>z.transformation))}renderTransformsPicker(){let{showPicker:W}=this.state;const{transformations:z,search:Y}=this.state,{transformationsRedesign:X}=v.Ay.featureToggles,q=!z?.length,G=z.length>0;let te=null,H=r.h.list().sort((_,Q)=>_.name>Q.name?1:Q.name>_.name?-1:0);if(!X&&q&&(W=!0),this.state.selectedFilter!==U&&(H=H.filter(_=>_.categories&&this.state.selectedFilter&&_.categories.has(this.state.selectedFilter))),Y){const _=Y.toLowerCase(),Q=H.filter(ae=>(ae.name+ae.description).toLowerCase().indexOf(_)>=0);te=(0,n.jsxs)(n.Fragment,{children:[Q.length," / ",H.length," \xA0\xA0",(0,n.jsx)(o.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})]}),H=Q}!te&&W&&!q&&(te=(0,n.jsx)(o.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let se=null,ne=null;X?(se=(0,n.jsx)(F.R,{noTransforms:q,search:Y,suffix:te,xforms:H,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:_=>this.setState({selectedFilter:_}),onShowIllustrationsChange:_=>this.setState({showIllustrations:_}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ne=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:"Delete all transformations"}),(0,n.jsx)(c.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):se=(0,n.jsx)(O,{noTransforms:q,search:Y,suffix:te,xforms:H,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const le=(0,n.jsxs)(a.e,{children:[(0,n.jsx)(d.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":i.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),ne]});return(0,n.jsxs)(n.Fragment,{children:[W&&se,X&&G&&le||!X&&!W&&G&&le]})}render(){const{panel:{alert:W}}=this.props,{transformations:z}=this.state,Y=z.length>0;if(W){const X=Y?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,n.jsx)(h,{message:X})}return(0,n.jsx)(p.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%",children:(0,n.jsx)(u.mc,{padding:"lg",children:(0,n.jsxs)("div",{"data-testid":i.Tp.components.TransformTab.content,children:[!Y&&v.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),Y&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const B=(0,m.SL)(w)},55087:(k,A,e)=>{"use strict";e.r(A),e.d(A,{SoloPanel:()=>x,SoloPanelPage:()=>v,default:()=>f});var n=e(74848),s=e(32196),l=e(96540),r=e(71468),i=e(70713),g=e(40845),o=e(42418),d=e(76888),c=e(39569),a=e(20470);const p=h=>({dashboard:h.dashboard.getModel()}),u={initDashboard:a.vR},m=(0,r.connect)(p,u);class v extends l.Component{constructor(){super(...arguments),this.state={panel:null,notFound:!1}}static{this.contextType=d.YE}componentDidMount(){const{match:y,route:b}=this.props;this.props.initDashboard({urlSlug:y.params.slug,urlUid:y.params.uid,urlType:y.params.type,routeName:b.routeName,fixUrl:!1,keybindingSrv:this.context.keybindings})}getPanelId(){return parseInt(this.props.queryParams.panelId??"0",10)}componentDidUpdate(y){const{dashboard:b}=this.props;if(b&&(!y.dashboard||y.dashboard.uid!==b.uid)){const D=b.getPanelByUrlId(this.props.queryParams.panelId);if(!D){this.setState({notFound:!0});return}D&&b.exitViewPanel(D),this.setState({panel:D}),b.initViewPanel(D)}}render(){return(0,n.jsx)(x,{dashboard:this.props.dashboard,notFound:this.state.notFound,panel:this.state.panel,panelId:this.getPanelId(),timezone:this.props.queryParams.timezone})}}const x=({dashboard:h,notFound:y,panel:b,panelId:D,timezone:P})=>{const C=(0,g.of)(E);return y?(0,n.jsx)(o.F,{severity:"error",title:`Panel with id ${D} not found`}):!b||!h?(0,n.jsx)("div",{children:"Loading & initializing dashboard"}):(0,n.jsx)("div",{className:C.container,children:(0,n.jsx)(i.Ay,{children:({width:M,height:I})=>M===0?null:(0,n.jsx)(c.L,{stateKey:b.key,width:M,height:I,dashboard:h,panel:b,isEditing:!1,isViewing:!0,lazy:!1,timezone:P,hideMenu:!0})})})},f=m(v),E=h=>({container:(0,s.css)({position:"fixed",bottom:0,right:0,margin:0,left:0,top:0,width:"100%",height:"100%"})})},68064:(k,A,e)=>{"use strict";e.d(A,{A:()=>y});var n=e(74848),s=e(32196),l=e(13544),r=e(39601),i=e(32264),g=e(40845),o=e(67061),d=e(90613),c=e(94753),a=e(55852),p=e(8484),u=e(36974),m=e(19293),v=e(34842),x=e(7758),f=e(31678),E=e(28601);const y=({dashboard:D,canCreate:P})=>{const C=(0,g.of)(b),M=(0,f.useDispatch)(),I=(0,f.useSelector)(S=>S.dashboard.initialDatasource),R=()=>{let S;if(D instanceof v.H$){const L=D.onCreateNewPanel();D.setState({editPanel:(0,m.L)(L,!0)}),r.Ny.partial({firstPanel:!0})}else S=(0,u.OK)(D,I),M((0,E.Ub)(void 0)),r.Ny.partial({editPanel:S,firstPanel:!0});x.c.emptyDashboardButtonClicked({item:"add_visualization"})},T=()=>{x.c.emptyDashboardButtonClicked({item:"import_from_library"}),D instanceof v.H$?D.onShowAddLibraryPanelDrawer():(0,u.s3)(D)};return(0,n.jsx)(o.B,{alignItems:"center",justifyContent:"center",children:(0,n.jsx)("div",{className:C.wrapper,children:(0,n.jsxs)(o.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,n.jsx)(d.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:2,children:[(0,n.jsx)(c.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,n.jsx)(d.a,{marginBottom:2,paddingX:4,children:(0,n.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,n.jsx)(a.$n,{size:"lg",icon:"plus","data-testid":l.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:R,disabled:!P,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,n.jsxs)(o.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[i.$.featureToggles.vizAndWidgetSplit&&(0,n.jsx)(d.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(c.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-widget-header",children:"Add a widget"})}),(0,n.jsx)(d.a,{marginBottom:2,children:(0,n.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-widget-body",children:"Create lists, markdowns and other widgets"})})}),(0,n.jsx)(a.$n,{icon:"plus",fill:"outline","data-testid":l.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{x.c.emptyDashboardButtonClicked({item:"add_widget"}),r.Ny.partial({addWidget:!0})},disabled:!P,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-widget-button",children:"Add widget"})})]})}),(0,n.jsx)(d.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(c.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,n.jsx)(d.a,{marginBottom:2,children:(0,n.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,n.jsx)(a.$n,{icon:"plus",fill:"outline","data-testid":l.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:T,disabled:!P,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,n.jsx)(d.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(c.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,n.jsx)(d.a,{marginBottom:2,children:(0,n.jsx)(c.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsxs)(p.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,n.jsx)(a.$n,{icon:"upload",fill:"outline","data-testid":l.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{x.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,u.VF)()},disabled:!P,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function b(D){return{wrapper:(0,s.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:D.spacing.gridSize*4,paddingTop:D.spacing(2),[D.breakpoints.up("sm")]:{paddingTop:D.spacing(12)}})}}},39569:(k,A,e)=>{"use strict";e.d(A,{L:()=>Tn});var n=e(74848),s=e(96540),l=e(71468),r=e(79971),i=e(80095),g=e(94701);function o({children:ht,width:St,height:Ge,onLoad:Ve,onChange:lt}){const It=(0,s.useId)(),[Qe,vt]=(0,s.useState)(!1),[Ot,zt]=(0,s.useState)(!1),vn=(0,s.useRef)(null);return(0,g.A)(()=>{o.addCallback(It,On=>{!Qe&&On.isIntersecting&&(vt(!0),Ve?.()),zt(On.isIntersecting),lt?.(On.isIntersecting)});const ln=vn.current;return ln&&o.observer.observe(ln),()=>{delete o.callbacks[It],ln&&o.observer.unobserve(ln),Object.keys(o.callbacks).length===0&&o.observer.disconnect()}}),(0,n.jsx)("div",{id:It,ref:vn,style:{width:St,height:Ge},children:Qe&&(typeof ht=="function"?ht({isInView:Ot}):ht)})}const d={};o.callbacks=d,o.addCallback=(ht,St)=>o.callbacks[ht]=St,o.observer=new IntersectionObserver(ht=>{for(const St of ht)o.callbacks[St.target.id]&&o.callbacks[St.target.id](St)},{rootMargin:"100px"});var c=e(64423),a=e(39070),p=e(43127),u=e(7376),m=e(91052),v=e(2913),x=e(15054),f=e(40334),E=e(74856),h=e(36663),y=e(72574),b=e(39601),D=e(32264),P=e(7758),C=e(16560),M=e(32349),I=e(8480),R=e(32196),T=e(43585),S=e(40845),L=e(56034),O=e(14578),j=e(15666),N=e(38138),F=e(83122),U=e(27746);function w({panelLinks:ht,onShowPanelLinks:St}){const Ge=(0,S.of)(B),Ve=()=>{const lt=St();return(0,n.jsx)(N.W,{children:lt?.map((It,Qe)=>(0,n.jsx)(N.W.Item,{label:It.title,url:It.href,target:It.target,onClick:It.onClick},Qe))})};if(ht.length===1){const lt=St()[0];return(0,n.jsx)(m.NR.TitleItem,{href:lt.href,onClick:lt.onClick,target:lt.target,title:lt.title,children:(0,n.jsx)(O.I,{name:"external-link-alt",size:"md"})})}else return(0,n.jsx)(F.m,{overlay:Ve,children:(0,n.jsx)(U.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links",className:Ge.menuTrigger})})}const B=ht=>({menuTrigger:(0,R.css)({height:"100%",background:"inherit",border:"none",borderRadius:`${ht.shape.radius.default}`,cursor:"context-menu"})});var K=e(2038);function W(ht){const{alertState:St,data:Ge,panelId:Ve,onShowPanelLinks:lt,panelLinks:It,angularNotice:Qe}=ht,vt=(0,S.of)(Y),Ot=(0,n.jsx)(L.m,{content:St??"unknown",children:(0,n.jsx)(m.NR.TitleItem,{className:(0,R.cx)({[vt.ok]:St===T.O.OK,[vt.pending]:St===T.O.Pending,[vt.alerting]:St===T.O.Alerting}),children:(0,n.jsx)(O.I,{name:St==="alerting"?"heart-break":"heart",size:"md"})})}),zt=(0,n.jsx)(n.Fragment,{children:Ge.request&&Ge.request.timeInfo&&(0,n.jsx)(L.m,{content:(0,n.jsx)(j.xS,{timeRange:Ge.request?.range,timeZone:Ge.request?.timezone}),children:(0,n.jsxs)(m.NR.TitleItem,{className:vt.timeshift,children:[(0,n.jsx)(O.I,{name:"clock-nine",size:"md"})," ",Ge.request?.timeInfo]})})}),vn=`This ${z(Qe)} requires Angular (deprecated).`,ln=(0,n.jsx)(L.m,{content:vn,children:(0,n.jsx)(m.NR.TitleItem,{className:vt.angularNotice,"data-testid":"angular-deprecation-icon",children:(0,n.jsx)(O.I,{name:"exclamation-triangle",size:"md"})})});return(0,n.jsxs)(n.Fragment,{children:[It&&It.length>0&&lt&&(0,n.jsx)(w,{onShowPanelLinks:lt,panelLinks:It}),(0,n.jsx)(K.Z,{panelId:Ve,frames:Ge.series}),zt,St&&Ot,Qe?.show&&ln]})}const z=ht=>ht?.isAngularPanel?"panel":ht?.isAngularDatasource?"data source":"panel or data source",Y=ht=>({ok:(0,R.css)({color:ht.colors.success.text,"&:hover":{color:ht.colors.emphasize(ht.colors.success.text,.03)}}),pending:(0,R.css)({color:ht.colors.warning.text,"&:hover":{color:ht.colors.emphasize(ht.colors.warning.text,.03)}}),alerting:(0,R.css)({color:ht.colors.error.text,"&:hover":{color:ht.colors.emphasize(ht.colors.error.text,.03)}}),timeshift:(0,R.css)({color:ht.colors.text.link,gap:ht.spacing(.5),whiteSpace:"nowrap","&:hover":{color:ht.colors.emphasize(ht.colors.text.link,.03)}}),angularNotice:(0,R.css)({color:ht.colors.warning.text})});function X(ht){function St(){return ht.data.request&&ht.data.request.timeInfo?!1:!ht.panel.hasTitle()}const Ge=()=>{const wt=(0,y.w)().replace(ht.panel.description,ht.panel.scopedVars);return(0,h.G)(wt)},Ve=()=>{const wt=(0,M.E7)(ht.panel);if(!wt)return[];const Ft=wt&&wt.getLinks(ht.panel.replaceVariables);return Ft.map(Ht=>({...Ht,onClick:(...ut)=>{P.c.panelLinkClicked({has_multiple_links:Ft.length>1}),Ht.onClick?.(...ut)}}))},lt=(wt,Ft)=>{wt.stopPropagation(),b.Ny.partial({inspect:ht.panel.id,inspectTab:Ft})},It=wt=>{wt.stopPropagation(),b.Ny.partial({inspect:ht.panel.id,inspectTab:C.q.Error}),P.c.panelStatusMessageClicked()},Qe=()=>{ht.panel.getQueryRunner().cancelQuery(),P.c.panelCancelQueryClicked({data_state:ht.data.state})},vt=ht.plugin.noPadding?"none":"md",Ot=ht.data.alertState?.state,zt=ht.panel.datasource?.uid?(0,I.Hv)(ht.panel.datasource?.uid):!1,vn=ht.panel.isAngularPlugin()&&!ht.plugin.meta.angular?.hideDeprecation,ln=(D.$.featureToggles.angularDeprecationUI??!1)&&(zt||vn),wn=(ht.panel.links&&ht.panel.links.length>0&&Ve||ht.data.series.length>0&&ht.data.series.some(wt=>(wt.meta?.notices?.length??0)>0)||ht.data.request&&ht.data.request.timeInfo||ln||Ot)&&(0,n.jsx)(W,{alertState:Ot,data:ht.data,panelId:ht.panel.id,panelLinks:ht.panel.links,angularNotice:{show:ln,isAngularDatasource:zt,isAngularPanel:vn},onShowPanelLinks:Ve}),Un=ht.panel.description?Ge:void 0,cs=!(ht.isViewing||ht.isEditing)&&(ht.isDraggable??!0)?"grid-drag-handle":"",Zn=ht.panel.getDisplayTitle();return{hasOverlayHeader:St,onShowPanelDescription:Ge,onShowPanelLinks:Ve,onOpenInspector:lt,onOpenErrorInspect:It,onCancelQuery:Qe,padding:vt,description:Un,dragClass:cs,title:Zn,titleItems:wn}}var q=e(13544);function G({items:ht}){const St=Ge=>Ge.map(Ve=>{switch(Ve.type){case"divider":return(0,n.jsx)(N.W.Divider,{},Ve.text);case"group":return(0,n.jsx)(N.W.Group,{label:Ve.text,children:Ve.subMenu?St(Ve.subMenu):void 0},Ve.text);default:return(0,n.jsx)(N.W.Item,{label:Ve.text,icon:Ve.iconClassName,childItems:Ve.subMenu?St(Ve.subMenu):void 0,url:Ve.href,onClick:Ve.onClick,shortcut:Ve.shortcut,testId:q.Tp.components.Panels.Panel.menuItems(Ve.text)},Ve.text)}});return(0,n.jsx)(N.W,{children:St(ht)})}var te=e(74135),H=e(1933),se=e(3197),ne=e(31678),le=e(76885),_=e(3169),Q=e(8484),ae=e(16001),oe=e(16233),J=e(94954),ee=e(87490),de=e(63066),xe=e(19752),re=e(82792),ue=e(75462),Te=e(14348),ge=e(99140),Oe=e(75471),Ue=e(29436);function Xe(ht,St,Ge,Ve){const lt=Qn=>{Qn.preventDefault(),b.Ny.partial({viewPanel:St.id})},It=Qn=>{Qn.preventDefault(),b.Ny.partial({editPanel:St.id})},Qe=Qn=>{Qn.preventDefault(),(0,xe.Mc)(ht,St)},vt=Qn=>{Qn.preventDefault(),(0,xe.d7)(ht,St)},Ot=Qn=>{Qn.preventDefault(),(0,xe.ZY)(St)},zt=Qn=>{b.Ny.partial({inspect:St.id,inspectTab:Qn})},vn=Qn=>{Qn.preventDefault()},ln=Qn=>{Qn.preventDefault(),(0,xe.iU)(ht,St)},On=Qn=>{Qn.preventDefault(),(0,xe.KJ)(St)},wn=Qn=>{Qn.preventDefault(),(0,xe.FC)(ht,St,!0)},Un=Qn=>{Qn.preventDefault();const fs=Qn.ctrlKey||Qn.metaKey?ls=>window.open(`${v.Ay.appSubUrl}${ls}`):void 0;ge.M_.dispatch((0,Ue.ow)(St,{timeRange:(0,E.jG)().timeRange(),getExploreUrl:ee.Xe,openInNewWindow:fs}))},cs=Qn=>{Qn.preventDefault(),(0,xe.ET)(St)},Zn=[];St.isEditing||Zn.push({text:(0,Q.t)("panel.header-menu.view","View"),iconClassName:"eye",onClick:lt,shortcut:"v"}),ht.canEditPanel(St)&&!St.isEditing&&Zn.push({text:(0,Q.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",onClick:It,shortcut:"e"}),Zn.push({text:(0,Q.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:Qe,shortcut:"p s"}),oe.TP.hasAccessToExplore()&&!(St.plugin&&St.plugin.meta.skipDataQuery)&&St.datasource?.uid!==Te.K&&Zn.push({text:(0,Q.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",onClick:Un,shortcut:"p x"});const wt=[];St.plugin&&!St.plugin.meta.skipDataQuery&&(wt.push({text:(0,Q.t)("panel.header-menu.inspect-data","Data"),onClick:Qn=>zt(C.q.Data)}),ht.meta.canEdit&&wt.push({text:(0,Q.t)("panel.header-menu.query","Query"),onClick:Qn=>zt(C.q.Query)})),wt.push({text:(0,Q.t)("panel.header-menu.inspect-json","Panel JSON"),onClick:Qn=>zt(C.q.JSON)}),Zn.push({type:"submenu",text:(0,Q.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",onClick:Qn=>{const fs=Qn.currentTarget,ls=Qn.target;(ls===fs||ls instanceof HTMLElement&&ls.closest('[role="menuitem"]')===fs)&&zt()},shortcut:"i",subMenu:wt});const Ft=async()=>{let Qn;try{Qn=await(0,de.mp)(St,ht)}catch(ls){const vs=`Error getting rule values from the panel: ${(0,J.q)(ls)}`;(0,ge.JD)((0,ae.dx)((0,_.gi)(vs)));return}const fs=le.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Qn),returnTo:location.pathname+location.search});b.Ny.push(fs)},Ht=Qn=>{Qn.preventDefault(),Ft()},ut=[],pn=ht.canEditPanel(St),Jn=(0,Oe.q0)();if(St.isViewing||St.isEditing||(pn?(ut.push({text:(0,Q.t)("panel.header-menu.duplicate","Duplicate"),onClick:ln,shortcut:"p d"}),ut.push({text:(0,Q.t)("panel.header-menu.copy","Copy"),onClick:On}),(0,re.X)(St)?ut.push({text:(0,Q.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:Ot}):ut.push({text:(0,Q.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:vt})):oe.TP.isEditor&&ut.push({text:(0,Q.t)("panel.header-menu.copy","Copy"),onClick:On})),Jn&&ut.push({text:(0,Q.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:Ht}),Ve){const Qn=Ve.getScope(),fs=Qn.$$childHead.ctrl,ls=fs.getExtendedMenu();for(const vs of ls){const ea={text:vs.text,href:vs.href,shortcut:vs.shortcut};vs.click&&(ea.onClick=()=>{Qn.$eval(vs.click,{ctrl:fs})}),ut.push(ea)}}return St.options.legend&&ut.push({text:St.options.legend.showLegend?(0,Q.t)("panel.header-menu.hide-legend","Hide legend"):(0,Q.t)("panel.header-menu.show-legend","Show legend"),onClick:cs,shortcut:"p l"}),St.isEditing&&(ut.length=0,Jn&&ut.push({text:(0,Q.t)("panel.header-menu.new-alert-rule","New alert rule"),onClick:Ht})),pn&&St.plugin&&!St.plugin.meta.skipDataQuery&&ut.push({text:(0,Q.t)("panel.header-menu.get-help","Get help"),onClick:Qn=>zt(C.q.Help)}),Ge.length>0&&!St.isEditing&&Zn.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,ue.N9)(Ge)}),ut.length&&Zn.push({type:"submenu",text:(0,Q.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:ut,onClick:vn}),ht.canEditPanel(St)&&!St.isEditing&&!St.isViewing&&(Zn.push({type:"divider",text:""}),Zn.push({text:(0,Q.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:wn,shortcut:"p r"})),Zn}function we({panel:ht,dashboard:St,loadingState:Ge,children:Ve}){const[lt,It]=(0,s.useState)([]),Qe=(0,ne.useSelector)(zt=>(0,f.U)(zt,ht)?.angularComponent),vt=(0,s.useMemo)(()=>qe(ht,St),[ht,St]),{extensions:Ot}=(0,se.vl)({extensionPointId:te.S.DashboardPanelMenu,context:vt,limitPerPlugin:3});return(0,s.useEffect)(()=>{It(Xe(St,ht,Ot,Qe))},[St,ht,Qe,Ge,It,Ot]),Ve({items:lt})}function qe(ht,St){return{id:ht.id,pluginId:ht.type,title:ht.title,timeRange:St.time,timeZone:(0,H.O)({timeZone:St.timezone}),dashboard:{uid:St.uid,title:St.title,tags:Array.from(St.tags)},targets:ht.targets,scopedVars:ht.scopedVars,data:ht.getQueryRunner().getLastResult()}}function We({style:ht,panel:St,dashboard:Ge,loadingState:Ve}){return(0,n.jsx)(we,{panel:St,dashboard:Ge,loadingState:Ve,children:({items:lt})=>(0,n.jsx)(G,{style:ht,items:lt})})}class Ce extends s.PureComponent{constructor(St){super(St),this.element=null,this.timeSrv=(0,E.jG)(),this.subs=new c.yU,this.state={data:{state:a.Gu.NotStarted,series:[],timeRange:(0,p.E2)()}}}componentDidMount(){const{panel:St}=this.props;this.loadAngularPanel();const Ge=St.getQueryRunner();this.subs.add(Ge.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:Ve=>this.onPanelDataUpdate(Ve)}))}onPanelDataUpdate(St){let Ge;if(St.state===a.Gu.Error){const{error:Ve}=St;Ve&&Ge!==Ve.message&&(Ge=Ve.message)}this.setState({data:St,errorMessage:Ge})}componentWillUnmount(){this.subs.unsubscribe(),this.props.angularComponent&&this.props.angularComponent?.destroy()}componentDidUpdate(St,Ge){const{plugin:Ve,height:lt,width:It,panel:Qe}=this.props;St.plugin!==Ve&&this.loadAngularPanel(),(St.width!==It||St.height!==lt)&&this.scopeProps&&(this.scopeProps.size.height=this.getInnerPanelHeight(),this.scopeProps.size.width=this.getInnerPanelWidth(),Qe.render())}getInnerPanelHeight(){const{plugin:St,height:Ge}=this.props,{theme:Ve}=v.Ay,lt=this.hasOverlayHeader()?0:Ve.panelHeaderHeight,It=St.noPadding?0:Ve.panelPadding;return Ge-lt-It*2-x.IZ}getInnerPanelWidth(){const{plugin:St,width:Ge}=this.props,{theme:Ve}=v.Ay,lt=St.noPadding?0:Ve.panelPadding;return Ge-lt*2-x.IZ}loadAngularPanel(){const{panel:St,dashboard:Ge,setPanelAngularComponent:Ve}=this.props;if(!this.element)return;const lt=(0,u.E)(),It='<plugin-component type="panel" class="panel-height-helper"></plugin-component>';this.scopeProps={panel:St,dashboard:Ge,size:{width:this.getInnerPanelWidth(),height:this.getInnerPanelHeight()}},Ve({key:St.key,angularComponent:lt.load(this.element,this.scopeProps,It)})}hasOverlayHeader(){const{panel:St}=this.props,{data:Ge}=this.state;return Ge.request&&Ge.request.timeInfo?!1:!St.hasTitle()}render(){const{dashboard:St,panel:Ge}=this.props,{errorMessage:Ve,data:lt}=this.state,{transparent:It}=Ge,Qe=X({...this.props,data:lt}),vt=(Ge.gridPos?.y??0)===0?-16:void 0,Ot=(0,n.jsx)("div",{"data-testid":"panel-dropdown",children:(0,n.jsx)(We,{panel:Ge,dashboard:St,loadingState:lt.state})});return(0,n.jsx)(m.NR,{width:this.props.width,height:this.props.height,title:Qe.title,loadingState:lt.state,statusMessage:Ve,statusMessageOnClick:Qe.onOpenErrorInspect,description:Qe.description,titleItems:Qe.titleItems,menu:this.props.hideMenu?void 0:Ot,dragClass:Qe.dragClass,dragClassCancel:"grid-drag-cancel",padding:Qe.padding,hoverHeaderOffset:vt,hoverHeader:Qe.hasOverlayHeader(),displayMode:It?"transparent":"default",onCancelQuery:Qe.onCancelQuery,children:()=>(0,n.jsx)("div",{ref:zt=>this.element=zt,className:"panel-height-helper"})})}}const je=(ht,St)=>({angularComponent:(0,f.U)(ht,St.panel)?.angularComponent}),Ke={setPanelAngularComponent:i.S3},_e=(0,l.connect)(je,Ke)(Ce);var Fe=e(2543),at=e(94624),Ct=e(41987),Dt=e(69129),tt=e(47232),ze=e(22391),pe=e(14236),Se=e(3591),fe=e(79041),Ee=e(66602),Pe=e(28138),he=e(18898),be=e(31193),Ae=e(26260),De=e(90478),Ie=e(1173),ke=e(24293);const dt=(ht,St,Ge)=>{const{overrides:Ve}=Ge,lt=Ge.overrides.findIndex(zt=>zt.matcher.id===Ie.Ct.byName&&zt.matcher.options===ht);if(lt<0)return{...Ge,overrides:[...Ge.overrides,Pt(ht,St)]};const It=Array.from(Ve),Qe=It[lt],vt=Qe.properties.findIndex(zt=>zt.id==="color");if(vt<0)return It[lt]={...Qe,properties:[...Qe.properties,pt(St)]},{...Ge,overrides:It};const Ot=Array.from(Qe.properties);return Ot[vt]=pt(St),It[lt]={...Qe,properties:Ot},{...Ge,overrides:It}},Pt=(ht,St)=>({matcher:{id:Ie.Ct.byName,options:ht},properties:[pt(St)]}),pt=ht=>({id:"color",value:{mode:ke.Y.Fixed,fixedColor:ht}});var Tt=e(28444),jt=e(10154),$t=e(42972),sn=e(60444),Yt=e(32631),qt=(ht=>(ht.FIELD_CONFIG_OVERRIDES_CHANGED_EVENT="field config overrides changed",ht.NEW_PANEL_OPTION_EVENT="new panel option",ht.PANEL_OPTION_CHANGED_EVENT="panel option changed",ht.NEW_DEFAULT_FIELD_CONFIG_EVENT="new default field config",ht.DEFAULT_FIELD_CONFIG_CHANGED_EVENT="default field config changed",ht.NEW_CUSTOM_FIELD_CONFIG_EVENT="new custom field config",ht.CUSTOM_FIELD_CONFIG_CHANGED_EVENT="custom field config changed",ht.MEASURE_PANEL_LOAD_TIME_EVENT="measure panel load time",ht.THRESHOLDS_COUNT_CHANGED_EVENT="thresholds count changed",ht.THRESHOLDS_MODE_CHANGED_EVENT="thresholds mode changed",ht.MAPPINGS_COUNT_CHANGED_EVENT="mappings count changed",ht.LINKS_COUNT_CHANGED_EVENT="links count changed",ht.PANEL_ERROR="panel error",ht))(qt||{});const bn="overrides",Mt="custom",Jt=ht=>{const St=performance.now();return(0,s.useEffect)(()=>{v.config.grafanaJavascriptAgent.enabled&&requestAnimationFrame(()=>{setTimeout(()=>{Yt.P.api.pushMeasurement({type:qt.MEASURE_PANEL_LOAD_TIME_EVENT,values:{start_loading_time_ms:St,load_time_ms:performance.now()-St}},{context:{panel_type:ht.panelType,panel_id:String(ht.panelId),panel_title:ht.panelTitle}})},0)})},[]),null};var Ut=e(91126),Gt=e(61582);class Lt{constructor(St,Ge,Ve){this.logChanges=(lt,It)=>{this.logPanelOptionChanges(lt,this.initialPanelOptions),this.logFieldConfigChanges(It,this.initialFieldConfig),this.initialPanelOptions=lt,this.initialFieldConfig=It},this.logPanelEvent=(lt,It,Qe,vt)=>{const Ot={key:It,newValue:Qe,oldValue:vt??"",panelTitle:this.panelLogInfo.panelTitle,panelId:this.panelLogInfo.panelId,panelType:this.panelLogInfo.panelType};Yt.P.api.pushEvent(lt,Ot)},this.logPanelOptionChanges=(lt,It)=>{if(typeof lt!="object"||lt===null||typeof It!="object"||It===null)return;const Qe={...It};for(const[vt,Ot]of Object.entries(lt)){const zt=typeof Ot!="string"?JSON.stringify(Ot):Ot,vn=typeof Ot!="string"?JSON.stringify(Qe[vt]):String(Qe[vt]);Qe[vt]===void 0?this.logPanelEvent(qt.NEW_PANEL_OPTION_EVENT,vt,zt):vn!==zt&&this.logPanelEvent(qt.PANEL_OPTION_CHANGED_EVENT,vt,zt,vn)}},this.logFieldConfigChanges=(lt,It)=>{const Qe=JSON.stringify(It.overrides),vt=JSON.stringify(lt.overrides);Qe!==vt&&this.logPanelEvent(qt.FIELD_CONFIG_OVERRIDES_CHANGED_EVENT,bn,vt,Qe);const Ot={...It.defaults};for(const[vn,ln]of Object.entries(lt.defaults)){if(vn===Mt)continue;const On=typeof ln!="string"?JSON.stringify(ln):ln,wn=typeof ln!="string"?JSON.stringify(Ot[vn]):String(Ot[vn]);Ot[vn]===void 0?this.logPanelEvent(qt.NEW_DEFAULT_FIELD_CONFIG_EVENT,vn,On):wn!==On&&this.logPanelEvent(qt.DEFAULT_FIELD_CONFIG_CHANGED_EVENT,vn,On,wn)}if(!lt.defaults.custom||Ot.custom===void 0)return;const zt={...Ot.custom};for(const[vn,ln]of Object.entries(lt.defaults.custom)){if(Ot.custom===null||zt[vn]===null)continue;const On=typeof ln!="string"?JSON.stringify(ln):ln,wn=typeof ln!="string"?JSON.stringify(zt[vn]):String(zt[vn]);zt[vn]===void 0?this.logPanelEvent(qt.NEW_CUSTOM_FIELD_CONFIG_EVENT,vn,On):wn!==On&&this.logPanelEvent(qt.CUSTOM_FIELD_CONFIG_CHANGED_EVENT,vn,On,wn)}},this.initialPanelOptions=St,this.initialFieldConfig=Ge,this.panelLogInfo=Ve}}const At="Error in plugin";class Nt extends s.PureComponent{constructor(St){super(St),this.timeSrv=(0,E.jG)(),this.subs=new c.yU,this.eventFilter={onlyLocal:!0},this.panelOptionsLogger=void 0,this.getSync=()=>this.props.isEditing?at.y.Off:this.props.dashboard.graphTooltip,this.onInstanceStateChange=Ve=>{this.props.onInstanceStateChange(Ve),this.setState({context:{...this.state.context,instanceState:Ve}})},this.onUpdateData=Ve=>(0,De.H)(this.props.panel,Ve),this.onSeriesColorChange=(Ve,lt)=>{this.onFieldConfigChange(dt(Ve,lt,this.props.panel.fieldConfig))},this.onSeriesVisibilityChange=(Ve,lt)=>{this.onFieldConfigChange((0,Ut.M)(Ve,lt,this.props.panel.fieldConfig,this.state.data.series))},this.onToggleLegendSort=Ve=>{const lt=this.props.panel.options.legend;if(!lt)return;let It=lt.sortDesc,Qe=lt.sortBy;Ve!==Qe&&(It=void 0),It===!1?(Qe=void 0,It=void 0):(It=!It,Qe=Ve),this.onOptionsChange({...this.props.panel.options,legend:{...lt,sortBy:Qe,sortDesc:It}})},this.onRefresh=()=>{const{dashboard:Ve,panel:lt,isInView:It,width:Qe}=this.props;if(!Ve.snapshot&&!It){lt.refreshWhenInView=!0;return}const vt=(0,xe.nk)(lt,this.timeSrv.timeRange());if(this.wantsQueryExecution){if(Qe<0)return;lt.refreshWhenInView=!1,lt.runAllPanelQueries({dashboardUID:Ve.uid,dashboardTimezone:Ve.getTimezone(),timeData:vt,width:Qe})}else this.setState({data:{...this.state.data,timeRange:this.timeSrv.timeRange()},renderCounter:this.state.renderCounter+1,liveTime:void 0})},this.onRender=()=>{const Ve={renderCounter:this.state.renderCounter+1};this.setState(Ve)},this.onOptionsChange=Ve=>{this.props.panel.updateOptions(Ve)},this.onFieldConfigChange=Ve=>{this.props.panel.updateFieldConfig(Ve)},this.onPanelError=Ve=>{v.Ay.featureToggles.panelMonitoring&&this.getPanelContextApp()===Ct.Jk.PanelEditor&&this.logPanelChangesOnError();const lt=Ve.message||At;this.state.errorMessage!==lt&&this.setState({errorMessage:lt})},this.onPanelErrorRecover=()=>{this.setState({errorMessage:void 0})},this.onAnnotationCreate=async Ve=>{const lt=Ve.from!==Ve.to,It={dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:lt,time:Ve.from,timeEnd:lt?Ve.to:0,tags:Ve.tags,text:Ve.description};await(0,jt.vJ)(It),(0,$t.Dh)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Dt.We(It))},this.onAnnotationDelete=async Ve=>{await(0,jt.Xm)({id:Ve}),(0,$t.Dh)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Dt.We({id:Ve}))},this.onAnnotationUpdate=async Ve=>{const lt=Ve.from!==Ve.to,It={id:Ve.id,dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:lt,time:Ve.from,timeEnd:lt?Ve.to:0,tags:Ve.tags,text:Ve.description};await(0,jt.rJ)(It),(0,$t.Dh)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Dt.We(It))},this.onChangeTimeRange=Ve=>{this.timeSrv.setTime({from:(0,tt.yT)(Ve.from),to:(0,tt.yT)(Ve.to)})},this.onAddAdHocFilter=Ve=>{const{key:lt,value:It,operator:Qe}=Ve,vt=(0,be.tR)().getInstanceSettings(this.props.panel.datasource),Ot=vt&&(0,ze.p$)(vt);Ot&&(0,ge.JD)((0,Ae.z_)({datasource:Ot,key:lt,operator:Qe,value:It}))};const Ge=St.dashboard.events.newScopedBus(`panel:${St.panel.id}`,this.eventFilter);if(this.debouncedSetPanelAttention=(0,Fe.debounce)(this.setPanelAttention.bind(this),100),this.state={isFirstLoad:!0,renderCounter:0,context:{eventsScope:"__global_",eventBus:Ge,app:this.getPanelContextApp(),sync:this.getSync,onSeriesColorChange:this.onSeriesColorChange,onToggleSeriesVisibility:this.onSeriesVisibilityChange,onAnnotationCreate:this.onAnnotationCreate,onAnnotationUpdate:this.onAnnotationUpdate,onAnnotationDelete:this.onAnnotationDelete,onInstanceStateChange:this.onInstanceStateChange,onToggleLegendSort:this.onToggleLegendSort,canAddAnnotations:St.dashboard.canAddAnnotations.bind(St.dashboard),canEditAnnotations:St.dashboard.canEditAnnotations.bind(St.dashboard),canDeleteAnnotations:St.dashboard.canDeleteAnnotations.bind(St.dashboard),onAddAdHocFilter:this.onAddAdHocFilter,onUpdateData:this.onUpdateData},data:this.getInitialPanelDataState()},v.Ay.featureToggles.panelMonitoring&&this.getPanelContextApp()===Ct.Jk.PanelEditor){const Ve={panelId:String(St.panel.id),panelType:St.panel.type,panelTitle:St.panel.title};this.panelOptionsLogger=new Lt(St.panel.getOptions(),St.panel.fieldConfig,Ve)}}getPanelContextApp(){return this.props.isEditing?Ct.Jk.PanelEditor:this.props.isViewing?Ct.Jk.PanelViewer:Ct.Jk.Dashboard}getInitialPanelDataState(){return{state:a.Gu.NotStarted,series:[],timeRange:(0,p.E2)()}}componentDidMount(){const{panel:St,dashboard:Ge}=this.props;if(this.subs.add(St.events.subscribe(Se._,this.onRefresh)),this.subs.add(St.events.subscribe(Tt.XM,this.onRender)),Ge.panelInitialized(this.props.panel),this.hasPanelSnapshot){this.setState({data:(0,sn.d)(St,Ge),isFirstLoad:!1});return}this.wantsQueryExecution||this.setState({isFirstLoad:!1}),this.subs.add(St.getQueryRunner().getData({withTransforms:!0,withFieldConfig:!0}).subscribe({next:Ve=>this.onDataUpdate(Ve)})),Gt.a.listen(this)}componentWillUnmount(){this.subs.unsubscribe(),Gt.a.remove(this)}liveTimeChanged(St){const{data:Ge}=this.state;if(Ge.timeRange){const Ve=St.to.valueOf()-Ge.timeRange.to.valueOf();if(Ve<100){console.log("Skip tick render",this.props.panel.title,Ve);return}}this.setState({liveTime:St})}componentDidUpdate(St){const{isInView:Ge,width:Ve,panel:lt}=this.props,{context:It}=this.state,Qe=this.getPanelContextApp();It.app!==Qe&&this.setState({context:{...It,app:Qe}}),Ge!==St.isInView&&Ge&&lt.refreshWhenInView&&this.onRefresh(),Ve!==St.width&&Gt.a.updateInterval(this)}onDataUpdate(St){const{dashboard:Ge,panel:Ve,plugin:lt}=this.props;if(lt.meta.skipDataQuery){this.setState({data:this.getInitialPanelDataState()});return}let{isFirstLoad:It}=this.state,Qe;switch(St.state){case a.Gu.Loading:if(this.state.data.state===a.Gu.Loading)return;break;case a.Gu.Error:const{error:vt,errors:Ot}=St;Ot?.length?Ot.length===1?Qe=Ot[0].message:Qe="Multiple errors found. Click for more details":vt&&Qe!==vt.message&&(Qe=vt.message);break;case a.Gu.Done:Ge.snapshot&&(Ve.snapshotData=St.series.map(zt=>(0,pe.Kl)(zt))),It&&(It=!1);break}this.setState({isFirstLoad:It,errorMessage:Qe,data:St,liveTime:void 0})}logPanelChangesOnError(){this.panelOptionsLogger.logChanges(this.props.panel.getOptions(),this.props.panel.fieldConfig)}get hasPanelSnapshot(){const{panel:St}=this.props;return St.snapshotData&&St.snapshotData.length}get wantsQueryExecution(){return!(this.props.plugin.meta.skipDataQuery||this.hasPanelSnapshot)}shouldSignalRenderingCompleted(St,Ge){return St===a.Gu.Done||St===a.Gu.Streaming||St===a.Gu.Error||Ge.skipDataQuery}skipFirstRender(St){const{isFirstLoad:Ge}=this.state;return this.wantsQueryExecution&&Ge&&(St===a.Gu.Loading||St===a.Gu.NotStarted)}renderPanelContent(St,Ge){const{panel:Ve,plugin:lt,dashboard:It}=this.props,{renderCounter:Qe,data:vt}=this.state,{state:Ot}=vt;if(this.skipFirstRender(Ot))return null;this.shouldSignalRenderingCompleted(Ot,lt.meta)&&he.E.renderingCompleted();const zt=lt.panel,vn=this.state.liveTime??vt.timeRange??this.timeSrv.timeRange(),ln=Ve.getOptions();return this.eventFilter.onlyLocal=It.graphTooltip===0,(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(fe.XF,{value:this.state.context,children:[(0,n.jsx)(zt,{id:Ve.id,data:vt,title:Ve.title,timeRange:vn,timeZone:this.props.dashboard.getTimezone(),options:ln,fieldConfig:Ve.fieldConfig,transparent:Ve.transparent,width:St,height:Ge,renderCounter:Qe,replaceVariables:Ve.replaceVariables,onOptionsChange:this.onOptionsChange,onFieldConfigChange:this.onFieldConfigChange,onChangeTimeRange:this.onChangeTimeRange,eventBus:It.events}),v.Ay.featureToggles.panelMonitoring&&this.state.errorMessage===void 0&&(0,n.jsx)(Jt,{panelType:lt.meta.id,panelId:Ve.id,panelTitle:Ve.title})]})})}setPanelAttention(){Pe.A.publish(new Dt.Tp({panelId:this.props.panel.id}))}debouncedSetPanelAttention(){}render(){const{dashboard:St,panel:Ge,width:Ve,height:lt,plugin:It}=this.props,{errorMessage:Qe,data:vt}=this.state,{transparent:Ot}=Ge,zt=X({...this.props,data:vt}),vn=(Ge.gridPos?.y??0)===0?-16:void 0,ln=(0,n.jsx)("div",{"data-testid":"panel-dropdown",children:(0,n.jsx)(We,{panel:Ge,dashboard:St,loadingState:vt.state})});return(0,n.jsx)(m.NR,{width:Ve,height:lt,title:zt.title,loadingState:vt.state,statusMessage:Qe,statusMessageOnClick:zt.onOpenErrorInspect,description:zt.description,titleItems:zt.titleItems,menu:this.props.hideMenu?void 0:ln,dragClass:zt.dragClass,dragClassCancel:"grid-drag-cancel",padding:zt.padding,hoverHeaderOffset:vn,hoverHeader:zt.hasOverlayHeader(),displayMode:Ot?"transparent":"default",onCancelQuery:zt.onCancelQuery,onFocus:()=>this.setPanelAttention(),onMouseEnter:()=>this.setPanelAttention(),onMouseMove:()=>this.debouncedSetPanelAttention(),children:(On,wn)=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(Ee.tH,{dependencies:[vt,It,Ge.getOptions()],onError:this.onPanelError,onRecover:this.onPanelErrorRecover,children:({error:Un})=>Un?null:this.renderPanelContent(On,wn)})})})}}const Dn=(ht,St)=>{const Ge=ht.panels[St.stateKey];return Ge?{plugin:Ge.plugin,instanceState:Ge.instanceState}:{plugin:void 0}},An={initPanelState:r.Ap,setPanelInstanceState:i.nF},Pn=(0,l.connect)(Dn,An);class Xn extends s.PureComponent{constructor(){super(...arguments),this.onInstanceStateChange=St=>{this.props.setPanelInstanceState({key:this.props.stateKey,value:St})},this.onVisibilityChange=St=>{this.props.panel.isInView=St},this.onPanelLoad=()=>{this.props.plugin||this.props.initPanelState(this.props.panel)},this.renderPanel=({isInView:St})=>{const{dashboard:Ge,panel:Ve,isViewing:lt,isEditing:It,width:Qe,height:vt,plugin:Ot,timezone:zt,hideMenu:vn,isDraggable:ln=!0}=this.props;return Ot?Ot&&Ot.angularPanelCtrl?(0,n.jsx)(_e,{plugin:Ot,panel:Ve,dashboard:Ge,isViewing:lt,isEditing:It,isInView:St,isDraggable:ln,width:Qe,height:vt}):(0,n.jsx)(Nt,{plugin:Ot,panel:Ve,dashboard:Ge,isViewing:lt,isEditing:It,isInView:St,isDraggable:ln,width:Qe,height:vt,onInstanceStateChange:this.onInstanceStateChange,timezone:zt,hideMenu:vn}):null}}static{this.defaultProps={lazy:!0}}componentDidMount(){this.props.panel.isInView=!this.props.lazy,this.props.lazy||this.onPanelLoad()}render(){const{width:St,height:Ge,lazy:Ve}=this.props;return Ve?(0,n.jsx)(o,{width:St,height:Ge,onChange:this.onVisibilityChange,onLoad:this.onPanelLoad,children:this.renderPanel}):this.renderPanel({isInView:!0})}}const Tn=Pn(Xn)},2038:(k,A,e)=>{"use strict";e.d(A,{Z:()=>u});var n=e(74848),s=e(96540),l=e(39601),r=e(32196),i=e(40845),g=e(27746),o=e(14578),d=e(56034),c=e(16797);const a=({notice:m,onClick:v})=>{const x=(0,i.of)(p),f=m.severity==="error"||m.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return m.inspect&&v?(0,n.jsx)(g.I,{className:x.notice,icon:f,iconSize:"md",tooltip:m.text,onClick:E=>v(E,m.inspect)},m.severity):m.link?(0,n.jsx)("a",{className:x.notice,"aria-label":m.text,href:m.link,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(o.I,{name:f,style:{marginRight:"8px"},size:"md"})}):(0,n.jsx)(d.m,{content:m.text,children:(0,n.jsx)("span",{className:x.iconTooltip,children:(0,n.jsx)(o.I,{name:f,size:"md"})})},m.severity)},p=m=>({notice:(0,r.css)({background:"inherit",border:"none",borderRadius:m.shape.radius.default}),iconTooltip:(0,r.css)({color:`${m.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${m.shape.radius.default}`,padding:`${m.spacing(0,1)}`,height:` ${m.spacing(m.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,c.getFocusStyles)(m),zIndex:1},"&: focus:not(:focus-visible)":(0,c.getMouseFocusStyles)(m),"&:hover ":{boxShadow:`${m.shadows.z1}`,color:`${m.colors.text.primary}`,background:`${m.colors.background.secondary}`}})}),u=({frames:m,panelId:v})=>{const x=(0,s.useCallback)((E,h)=>{E.stopPropagation(),l.Ny.partial({inspect:v,inspectTab:h})},[v]),f={};for(const E of m)if(!(!E.meta||!E.meta.notices))for(const h of E.meta.notices)f[h.severity]=h;return(0,n.jsx)(n.Fragment,{children:Object.values(f).map(E=>(0,n.jsx)(a,{notice:E,onClick:x},E.severity))})}},91126:(k,A,e)=>{"use strict";e.d(A,{M:()=>a});var n=e(37055),s=e(58972),l=e(1173),r=e(11261),i=e(28240),g=e(85200),o=e(88895);const d="hideSeriesFrom",c=(0,n.ZW)(d);function a(E,h,y,b){const{overrides:D}=y,P=E,C=D.findIndex(c);if(C<0){if(h===o.B.ToggleSelection){const L=p([P,...f(D,b)]);return{...y,overrides:[...y.overrides,L]}}const T=x(b,P),S=p(T);return{...y,overrides:[...y.overrides,S]}}const M=Array.from(D),[I]=M.splice(C,1);if(h===o.B.ToggleSelection){let T=m(I);const S=f(M,b);if(S.length>0&&(T=T.filter(O=>S.indexOf(O)<0)),T[0]===P&&T.length===1)return{...y,overrides:M};const L=p([P,...S]);return{...y,overrides:[...M,L]}}const R=u(I,P);return v(R,b)?{...y,overrides:M}:{...y,overrides:[...M,R]}}function p(E,h=s.PP.exclude,y){return y=y??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:d,matcher:{id:l.Ct.byNames,options:{mode:h,names:E,prefix:h===s.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...y,value:{viz:!0,legend:!1,tooltip:!1}}]}}const u=(E,h,y=s.PP.exclude)=>{const b=E.properties.find(C=>C.id==="custom.hideFrom"),D=m(E),P=D.findIndex(C=>C===h);return P<0?D.push(h):D.splice(P,1),p(D,y,b)},m=E=>{const h=E.matcher.options?.names;return Array.isArray(h)?[...h]:[]},v=(E,h)=>m(E).length===x(h).length,x=(E,h)=>{const y=new Set;for(const b of E)for(const D of b.fields){if(D.type!==r.PU.number)continue;const P=(0,i.Ct)(D,b,E);P!==h&&y.add(P)}return Array.from(y)},f=(E,h)=>{let y=[];for(const b of E){const D=b.properties.find(P=>P.id==="custom.hideFrom");if(D!==void 0&&D.value?.legend===!0){const C=g.sJ.get(b.matcher.id).get(b.matcher.options);for(const M of h)for(const I of M.fields){if(I.type!==r.PU.number)continue;const R=(0,i.Ct)(I,M,h);C(I,M,h)&&y.push(R)}}}return y}},61582:(k,A,e)=>{"use strict";e.d(A,{a:()=>d});var n=e(49426),s=e(47232),l=e(85858);const r=100;class i{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new n.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const a=Date.now();this.budget=(a-this.lastUpdate)/r;const p=this.ok.getValue(),u=this.budget<=this.threshold;if(p!==u&&this.ok.next(u),this.lastUpdate=a,this.isLive&&this.ok.getValue()&&this.timeRange){let m;for(const v of this.listeners){if(!v.panel.props.isInView)continue;if(a-v.last>=v.intervalMs){if(!m){const{raw:f}=this.timeRange;m={raw:f,from:(0,s.KQ)(a-this.liveTimeOffset),to:(0,s.KQ)(a)}}v.panel.liveTimeChanged(m),v.last=a}}}}}setLiveTimeRange(a){if(this.timeRange=a,this.isLive=a?.raw?.to==="now",this.isLive){const p=l.parse(a.raw.from,!1)?.valueOf(),u=l.parse(a.raw.to,!0)?.valueOf();this.liveTimeOffset=u-p;for(const m of this.listeners)m.intervalMs=o(this.liveTimeOffset,m.panel.props.width)}}listen(a){this.listeners.push({last:this.lastUpdate,panel:a,intervalMs:o(6e4,a.props.width)})}remove(a){this.listeners=this.listeners.filter(p=>p.panel!==a)}updateInterval(a){if(!(!this.timeRange||!this.isLive)){for(const p of this.listeners)if(p.panel===a){p.intervalMs=o(this.liveTimeOffset,p.panel.props.width);return}}}}const g=5*60*1e3;function o(c,a){const p=Math.ceil(c/a/100)*100;return p>g?g:p}const d=new i;setInterval(d.measure,r)},17493:(k,A,e)=>{"use strict";e.d(A,{Fu:()=>b,np:()=>D});var n=e(34796),s=e.n(n),l=e(2543),r=e.n(l),i=e(95093),g=e.n(i),o=e(26272),d=e(85858),c=e(17172),a=e(39601),p=e(27677),u=e(62301),m=e(68576),v=e(72255),x=e(31193),f=e(10096),E=e(28676),h=e(14792),y=e(69064);class b{constructor(){}_dashboardLoadFailed(M,I){return I=I||!1,{meta:{canStar:!1,isSnapshot:I,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:M,uid:M,schemaVersion:0}}}loadDashboard(M,I,R){const T=(0,v.sP)();let S;if(M==="script"&&I)S=this._loadScriptedDashboard(I);else if(M==="snapshot"&&I)S=(0,y.s)().getSnapshot(I).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(M==="ds"&&I)S=this._loadFromDatasource(I);else if(M==="public"&&R)S=p.IB.getPublicDashboardByUid(R).then(L=>L).catch(L=>{const O=L.data.statusCode===403&&L.data.messageId==="publicdashboards.notEnabled",j=L.data.statusCode===404&&L.data.messageId==="publicdashboards.notFound",N=L.data.statusCode===404&&L.data.messageId==="publicdashboards.dashboardNotFound",F=this._dashboardLoadFailed(O?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...F,meta:{...F.meta,publicDashboardEnabled:j?void 0:!O,dashboardNotFound:j||N}}});else if(R){const L=T.getDashboardFromCache(R);if(L)return Promise.resolve(L);S=(0,E.n)().getDashboardDTO(R).then(O=>{if(O.meta.isFolder)throw f.lE.emit(o.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return O}).catch(()=>{const O=this._dashboardLoadFailed("Not found",!0);return O.dashboard.uid=R,O})}else throw new Error("Dashboard uid or slug required");return S.then(L=>(L.meta.dashboardNotFound!==!0&&u.A.addDashboardImpression(L.dashboard.uid),L)),S}_loadScriptedDashboard(M){const I="public/dashboards/"+M.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,c.AI)().get(I).then(this._executeScript.bind(this)).then(R=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:R.data}),R=>(console.error("Script dashboard error "+R),f.lE.emit(o.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(M){const I=await(0,x.tR)().get(M);if(!I)return Promise.reject("can not find datasource: "+M);const R=new URLSearchParams(window.location.search),T=R.get("path");if(!T)return Promise.reject("expecting path parameter");const S={};return R.forEach((L,O)=>{S[O]=L}),(0,c.AI)().get(`/api/datasources/uid/${I.uid}/resources/${T}`,S).then(L=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:L}))}_executeScript(M){const I={dashboardSrv:(0,h.UA)(),datasourceSrv:(0,x.tR)()},T=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",M)(a.Ny.getSearchObject(),m.A,d,r(),g(),window,document,s(),s(),I);return(0,l.isFunction)(T)?new Promise(S=>{T(L=>{S({data:L})})}):{data:T}}}let D=new b;const P=C=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(k,A,e)=>{"use strict";e.d(A,{UA:()=>u});var n=e(26272),s=e(28138),l=e(8484),r=e(27677),i=e(28676),g=e(28444),o=e(98365),d=e(19752);class c{constructor(){this.onRemovePanel=v=>{const x=this.getCurrent();x&&(0,d.FC)(x,x.getPanelById(v),!0)},s.l.subscribe(g.Vz,v=>this.onRemovePanel(v.payload))}create(v,x){return new o.G(v,x)}setCurrent(v){this.dashboard=v}getCurrent(){return this.dashboard}saveJSONDashboard(v){const x=JSON.parse(v);return(0,i.n)().saveDashboard({dashboard:x,folderUid:this.dashboard?.meta.folderUid||x.folderUid})}saveDashboard(v,x){return(0,i.n)().saveDashboard({message:v.message,folderUid:v.folderUid,dashboard:v.dashboard.getSaveModelClone(),showErrorAlert:x?.showErrorAlert})}starDashboard(v,x){const f=(0,r.AI)(),E={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+v,method:x?"DELETE":"POST"};return f.request(E).then(()=>{const h=!x;this.dashboard?.uid===v&&(this.dashboard.meta.isStarred=h);const y=h?(0,l.t)("notifications.starred-dashboard","Dashboard starred"):(0,l.t)("notifications.unstarred-dashboard","Dashboard unstarred");return s.l.emit(n.r1.alertSuccess,[y]),h})}}let a;function p(m){a=m}function u(){return a||(a=new c),a}},69064:(k,A,e)=>{"use strict";e.d(A,{s:()=>d});var n=e(75505),s=e(81160),l=e(17172),r=e(32264),i=e(10096);const g={create:c=>(0,l.AI)().post("/api/snapshots",c),getSnapshots:()=>(0,l.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,l.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:c=>(0,l.AI)().delete("/api/snapshots/"+c),getSnapshot:async c=>{const a=await(0,l.AI)().get("/api/snapshots/"+c);return a.meta.canShare=!1,a}};class o{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${r.$.namespace}/dashboardsnapshots`}async create(a){return(0,l.AI)().post(this.url+"/create",a)}async getSnapshots(){return(await(0,l.AI)().get(this.url)).items.map(p=>({key:p.metadata.name,name:p.spec.title,external:p.spec.externalUrl!=null,externalUrl:p.spec.externalUrl}))}deleteSnapshot(a){return(0,l.AI)().delete(this.url+"/"+a)}async getSharingOptions(){return(0,l.AI)().get("/api/snapshot/shared-options")}async getSnapshot(a){const p={};if(!i.contextSrv.isSignedIn){alert("TODO... need a barer token for anonymous use case");const u=`??? TODO, get anon token for snapshots (${i.contextSrv.user?.name}) ???`;p.Authorization=`Bearer ${u}`}return(0,n.s)((0,l.AI)().fetch({url:this.url+"/"+a+"/body",method:"GET",headers:p}).pipe((0,s.T)(u=>({dashboard:u.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function d(){return r.$.featureToggles.kubernetesSnapshots?new o:g}},74856:(k,A,e)=>{"use strict";e.d(A,{jG:()=>D});var n=e(2543),s=e(47232),l=e(43127),r=e(65879),i=e(26272),g=e(85858),o=e(39601),d=e(80943),c=e(76412),a=e(28138),p=e(2913),u=e(16233),m=e(80582),v=e(21380),x=e(28444),f=e(11134);function E({urlRefresh:P,currentRefresh:C,isAllowedIntervalFn:M,minRefreshInterval:I,refreshIntervals:R=f.cb}){if(!P)return C;const T=M(P),S=R.find(L=>L===P);if(!T||!S){const L=I?R.find(j=>j===I):void 0,O=R?.length?R[0]:void 0;return L??O??C}return P||C}class h{constructor(C){this.contextSrv=C,this.timeRangeForUrl=()=>{const M=this.timeRange().raw;return(0,s.Ar)(M.from)&&(M.from=M.from.valueOf().toString()),(0,s.Ar)(M.to)&&(M.to=M.to.valueOf().toString()),M},this.time=(0,l.E2)().raw,this.timeAtLoad=(0,l.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),a.A.subscribe(x.U0,M=>{this.zoomOut(M.payload.scale,M.payload.updateUrl)}),a.A.subscribe(x.Io,M=>{this.shiftTime(M.payload.direction,M.payload.updateUrl)}),a.A.subscribe(x.Rh,M=>{this.makeAbsoluteTime(M.payload.updateUrl)}),a.A.subscribe(x.Bt,()=>{this.copyTimeRangeToClipboard()}),a.A.subscribe(x.VZ,M=>{this.pasteTimeRangeFromClipboard(M.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(C){this.timeModel=C,this.time=C.time,this.refresh=C.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,n.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(C){return this.contextSrv.getValidIntervals(C)}parseTime(){(0,n.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,s.KQ)(this.time.from).utc()),(0,n.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,s.KQ)(this.time.to).utc())}parseUrlParam(C,M){if(C.indexOf("now")!==-1)return C;if(C.length===8){const I=(0,s.yT)(C,"YYYYMMDD");if(I.isValid())return I}else if(C.length===15){const I=(0,s.yT)(C,"YYYYMMDDTHHmmss");if(I.isValid())return I}if(!isNaN(Number(C))){const I=parseInt(C,10);return M?(0,s.oZ)(M,I):(0,s.yT)(I)}return null}getTimeWindow(C,M){const I=parseInt(C,10);let R;return M.match(/^\d+$/)&&parseInt(M,10)?R=parseInt(M,10):R=r.intervalToMs(M),{from:(0,s.yT)(I-R/2),to:(0,s.yT)(I+R/2)}}initTimeFromUrl(){if(p.config.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const C=o.Ny.getSearch();C.get("time")&&C.get("time.window")&&(this.time=this.getTimeWindow(C.get("time"),C.get("time.window")));const M=this.timeModel?.getTimezone();C.get("from")&&(this.time.from=this.parseUrlParam(C.get("from"),M)||this.time.from),C.get("to")&&(this.time.to=this.parseUrlParam(C.get("to"),M)||this.time.to),C.get("to")&&C.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=E({urlRefresh:C.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:p.config.minRefreshInterval})}updateTimeRangeFromUrl(){const C=o.Ny.getSearch();if(C.get("left"))return;const M=this.timeRangeForUrl(),I=C.get("from"),R=C.get("to");I&&R?(I!==M.from||R!==M.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(C){this.timeModel&&(this.timeModel.refresh=C),this.stopAutoRefresh();const M=o.Ny.getSearchObject();if(!C){M.refresh&&o.Ny.partial({refresh:null},!0);return}let I=C,R=60*1e3;C===u.SM?R=this.getAutoRefreshInteval().intervalMs:(I=this.contextSrv.getValidInterval(C),R=r.intervalToMs(I)),this.refreshMS=R,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(R),this.refreshTimeModel()},R),M.refresh!==I&&o.Ny.partial({refresh:I},!0)}getAutoRefreshInteval(){const C=window?.innerWidth??2e3;return r.calculateInterval(this.timeRange(),C,p.config.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(C){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(C),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},C)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(C,M=!0){if((0,n.extend)(this.time,C),(0,s.Ar)(C.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),M===!0){const I=this.timeRangeForUrl(),R=o.Ny.getSearchObject();if(R.from===I.from.toString()&&R.to===I.to.toString())return;R.from=I.from.toString(),R.to=I.to.toString(),o.Ny.partial(R)}this.timeModel?.refresh===u.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(u.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?d.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,v.z)(this.time,this.timeModel)}zoomOut(C,M=!0){const I=this.timeRange(),{from:R,to:T}=(0,m.Zk)(I,C);this.setTime({from:(0,s.yT)(R),to:(0,s.yT)(T)},M)}shiftTime(C,M=!0){const I=this.timeRange(),{from:R,to:T}=(0,m.Wb)(C,I);this.setTime({from:(0,s.yT)(R),to:(0,s.yT)(T)},M)}makeAbsoluteTime(C){const{from:M,to:I}=this.timeRange();this.setTime({from:M,to:I},C)}copyTimeRangeToClipboard(){const{raw:C}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:C.from,to:C.to})),a.A.emit(i.r1.alertSuccess,[(0,c.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(C=!0){const{range:M,isError:I}=await(0,m.zG)();if(I===!0){a.A.emit(i.r1.alertError,[(0,c.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,c.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:M})]);return}const{from:R,to:T}=M;this.setTime({from:R,to:T},C)}isRefreshOutsideThreshold(C,M=.05){const I=this.timeRange();if(g.isMathString(I.raw.from)){const R=I.to.diff(I.from),T=Date.now()-C,S=R*M;return T>=S}return!1}}let y;function b(P){y=P}function D(){return y||(y=new h(u.TP)),y}},79056:(k,A,e)=>{"use strict";e.d(A,{O2:()=>U,SW:()=>w,og:()=>X});var n=e(2543),s=e(69550),l=e(92041),r=e(12470),i=e(22391),g=e(76885),o=e(6709),d=e(25019),c=e(47737),a=e(1173),p=e(11261),u=e(6829),m=e(58140),v=e(19347),x=e(52622),f=e(57021),E=e(33919),h=e(2913),y=e(15054);function b(_){return Array.from(new Array(_+1),(Q,ae)=>ae).filter(Q=>_%Q===0)}var D=e(68576),P=e(31193),C=e(24240),M=e(86886),I=e(14678),R=e(14738),T=e(36373),S=e(77789),L=e(25640);function O(_,Q){const ae=[];if(_?.statistics&&_?.statistics.length){_.statistic=_.statistics[0];for(const oe of _.statistics.splice(1))ae.push({..._,statistic:oe})}for(const oe of ae)oe.refId=(0,S.M)(Q),delete oe.statistics,Q.push(oe);return delete _.statistics,ae}function j(_){const Q=[];if(_&&"statistics"in _&&_?.statistics?.length){for(const ae of _.statistics.splice(1)){const{statistics:oe,name:J,...ee}=_;Q.push({...ee,statistic:ae,name:`${J} - ${ae}`})}_.statistic=_.statistics[0],Q.length!==0&&(_.name=`${_.name} - ${_.statistic}`),delete _.statistics}return Q}function N(_){_.hasOwnProperty("metricQueryType")||(_.metricQueryType=L.d$.Search),_.hasOwnProperty("metricEditorMode")||(_.metricQueryType===L.d$.Insights?_.metricEditorMode=L.Rx.Code:_.metricEditorMode=_.expression?L.Rx.Code:L.Rx.Builder)}var F=e(84423);s.D.setInit(E.H),s.G.setInit(E.u);const U=39;class w{constructor(Q){this.dashboard=Q,(0,v.l)()||(0,v.h)(new P.xq)}updateSchema(Q){let ae,oe,J,ee;const de=this.dashboard.schemaVersion,xe=[];if(this.dashboard.schemaVersion=U,de!==this.dashboard.schemaVersion){if(de<2&&(Q.services&&Q.services.filter&&(this.dashboard.time=Q.services.filter.time,this.dashboard.templating.list=Q.services.filter.list||[]),xe.push(re=>(re.type==="graphite"&&(re.type="graph"),re.type!=="graph"||((0,n.isBoolean)(re.legend)&&(re.legend={show:re.legend}),re.grid&&(re.grid.min&&(re.grid.leftMin=re.grid.min,delete re.grid.min),re.grid.max&&(re.grid.leftMax=re.grid.max,delete re.grid.max)),re.y_format&&(re.y_formats||(re.y_formats=[]),re.y_formats[0]=re.y_format,delete re.y_format),re.y2_format&&(re.y_formats||(re.y_formats=[]),re.y_formats[1]=re.y2_format,delete re.y2_format)),re))),de<3){let re=this.dashboard.getNextPanelId();xe.push(ue=>(ue.id||(ue.id=re,re+=1),ue))}if(de<4&&xe.push(re=>(re.type!=="graph"||((0,n.each)(re.aliasYAxis,(ue,Te)=>{re.seriesOverrides=[{alias:Te,yaxis:ue}]}),delete re.aliasYAxis),re)),de<6){const re=(0,n.find)(Q.pulldowns,{type:"annotations"});for(re&&(this.dashboard.annotations={list:re.annotations||[]}),ae=0;ae<this.dashboard.templating.list.length;ae++){const ue=this.dashboard.templating.list[ae];ue.datasource===void 0&&(ue.datasource=null),ue.type==="filter"&&(ue.type="query"),ue.type===void 0&&(ue.type="query"),ue.allFormat===void 0&&delete ue.allFormat}}if(de<7&&(Q.nav&&Q.nav.length&&(this.dashboard.timepicker=Q.nav[0]),xe.push(re=>((0,n.each)(re.targets,ue=>{ue.refId||(ue.refId=re.getNextQueryLetter&&re.getNextQueryLetter())}),re))),de<8&&xe.push(re=>((0,n.each)(re.targets,ue=>{ue.fields&&ue.tags&&ue.groupBy&&(ue.rawQuery?(delete ue.fields,delete ue.fill):(ue.select=(0,n.map)(ue.fields,Te=>{const ge=[];return ge.push({type:"field",params:[Te.name]}),ge.push({type:Te.func,params:[]}),Te.mathExpr&&ge.push({type:"math",params:[Te.mathExpr]}),Te.asExpr&&ge.push({type:"alias",params:[Te.asExpr]}),ge}),delete ue.fields,(0,n.each)(ue.groupBy,Te=>{Te.type==="time"&&Te.interval&&(Te.params=[Te.interval],delete Te.interval),Te.type==="tag"&&Te.key&&(Te.params=[Te.key],delete Te.key)}),ue.fill&&(ue.groupBy.push({type:"fill",params:[ue.fill]}),delete ue.fill)))}),re)),de<9&&xe.push(re=>{if(re.type!=="singlestat"&&re.thresholds!=="")return re;if(re.thresholds){const ue=re.thresholds.split(",");ue.length>=3&&(ue.shift(),re.thresholds=ue.join(","))}return re}),de<10&&xe.push(re=>(re.type!=="table"||(0,n.each)(re.styles,ue=>{if(ue.thresholds&&ue.thresholds.length>=3){const Te=ue.thresholds;Te.shift(),ue.thresholds=Te}}),re)),de<12&&(0,n.each)(this.dashboard.getVariables(),re=>{"refresh"in re&&(re.refresh&&(re.refresh=1),re.refresh||(re.refresh=0)),"hideVariable"in re&&re.hideVariable?re.hide=2:"hideLabel"in re&&re.hideLabel&&(re.hide=1)}),de<12&&xe.push(re=>(re.type!=="graph"||!re.grid||re.yaxes||(re.yaxes=[{show:re["y-axis"],min:re.grid.leftMin,max:re.grid.leftMax,logBase:re.grid.leftLogBase,format:re.y_formats[0],label:re.leftYAxisLabel},{show:re["y-axis"],min:re.grid.rightMin,max:re.grid.rightMax,logBase:re.grid.rightLogBase,format:re.y_formats[1],label:re.rightYAxisLabel}],re.xaxis={show:re["x-axis"]},delete re.grid.leftMin,delete re.grid.leftMax,delete re.grid.leftLogBase,delete re.grid.rightMin,delete re.grid.rightMax,delete re.grid.rightLogBase,delete re.y_formats,delete re.leftYAxisLabel,delete re.rightYAxisLabel,delete re["y-axis"],delete re["x-axis"]),re)),de<13&&xe.push(re=>{if(re.type!=="graph"||!re.grid)return re;re.thresholds||(re.thresholds=[]);const ue={},Te={};return re.grid.threshold1!==null&&(ue.value=re.grid.threshold1,re.grid.thresholdLine?(ue.line=!0,ue.lineColor=re.grid.threshold1Color,ue.colorMode="custom"):(ue.fill=!0,ue.fillColor=re.grid.threshold1Color,ue.colorMode="custom")),re.grid.threshold2!==null&&(Te.value=re.grid.threshold2,re.grid.thresholdLine?(Te.line=!0,Te.lineColor=re.grid.threshold2Color,Te.colorMode="custom"):(Te.fill=!0,Te.fillColor=re.grid.threshold2Color,Te.colorMode="custom")),(0,n.isNumber)(ue.value)&&((0,n.isNumber)(Te.value)?ue.value>Te.value?(ue.op=Te.op="lt",re.thresholds.push(ue),re.thresholds.push(Te)):(ue.op=Te.op="gt",re.thresholds.push(ue),re.thresholds.push(Te)):(ue.op="gt",re.thresholds.push(ue))),delete re.grid.threshold1,delete re.grid.threshold1Color,delete re.grid.threshold2,delete re.grid.threshold2Color,delete re.grid.thresholdLine,re}),de<14&&(this.dashboard.graphTooltip=Q.sharedCrosshair?1:0),de<16&&this.upgradeToGridLayout(Q),de<17&&xe.push(re=>{if(re.minSpan){const ue=y.cV/re.minSpan,Te=b(y.cV);re.maxPerRow=Te[(0,n.findIndex)(Te,ge=>ge>ue)-1]}return delete re.minSpan,re}),de<18&&xe.push(re=>(re["options-gauge"]&&(re.options=re["options-gauge"],re.options.valueOptions={unit:re.options.unit,stat:re.options.stat,decimals:re.options.decimals,prefix:re.options.prefix,suffix:re.options.suffix},re.options.thresholds&&re.options.thresholds.reverse(),delete re.options.options,delete re.options.unit,delete re.options.stat,delete re.options.decimals,delete re.options.prefix,delete re.options.suffix,delete re["options-gauge"]),re)),de<19&&xe.push(re=>(re.links&&(0,n.isArray)(re.links)&&(re.links=re.links.map(W)),re)),de<20){const re=ue=>({...ue,url:z(ue.url)});xe.push(ue=>(ue.options&&ue.options.dataLinks&&(0,n.isArray)(ue.options.dataLinks)&&(ue.options.dataLinks=ue.options.dataLinks.map(re)),ue.options&&ue.options.fieldOptions&&ue.options.fieldOptions.defaults&&(ue.options.fieldOptions.defaults.links&&(0,n.isArray)(ue.options.fieldOptions.defaults.links)&&(ue.options.fieldOptions.defaults.links=ue.options.fieldOptions.defaults.links.map(re)),ue.options.fieldOptions.defaults.title&&(ue.options.fieldOptions.defaults.title=z(ue.options.fieldOptions.defaults.title))),ue))}if(de<21){const re=ue=>({...ue,url:ue.url.replace(/__series.labels/g,"__field.labels")});xe.push(ue=>(ue.options&&ue.options.dataLinks&&(0,n.isArray)(ue.options.dataLinks)&&(ue.options.dataLinks=ue.options.dataLinks.map(re)),ue.options&&ue.options.fieldOptions&&ue.options.fieldOptions.defaults&&ue.options.fieldOptions.defaults.links&&(0,n.isArray)(ue.options.fieldOptions.defaults.links)&&(ue.options.fieldOptions.defaults.links=ue.options.fieldOptions.defaults.links.map(re)),ue))}if(de<22&&xe.push(re=>(re.type!=="table"||(0,n.each)(re.styles,ue=>{ue.align="auto"}),re)),de<23)for(const re of this.dashboard.templating.list){if(!(0,C.iv)(re))continue;const{multi:ue,current:Te}=re;(0,l.R)(Te)||(re.current=(0,M.C)(Te,ue))}if(de<24&&xe.push(re=>{const ue=re.type==="table";if(ue&&!re.styles)return re;const Te=re.table==="table2";return!ue||Te||(re.type=ue?"table-old":"table"),re}),de<25,de<26&&xe.push(re=>(re.type==="text2"&&(re.type="text",delete re.options.angular),re)),de<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(re=>{if(!(0,C.VO)(re))return re;const ue={...re};return ue.current={selected:!0,text:ue.query??"",value:ue.query??""},ue.options=[ue.current],ue.hide===r.zL.dontHide||ue.hide===r.zL.hideLabel?{...ue,type:"textbox"}:ue})),de<28){xe.push(re=>re.type==="singlestat"?Y(re):re);for(const re of this.dashboard.templating.list)re.tags&&delete re.tags,re.tagsQuery&&delete re.tagsQuery,re.tagValuesQuery&&delete re.tagValuesQuery,re.useTags&&delete re.useTags}if(de<29)for(const re of this.dashboard.templating.list)re.type==="query"&&(re.refresh!==1&&re.refresh!==2&&(re.refresh=1),re.options?.length&&(re.options=[]));if(de<30&&(xe.push(G),xe.push(ne)),de<31&&xe.push(re=>{if(re.transformations){for(const ue of re.transformations)if(ue.id===u.V.id)return q(re,u.V.id,{id:m.o.id,options:{}})}return re}),de<32,de<33&&xe.push(re=>{if(re.datasource=X(re.datasource,{returnDefaultAsNull:!0}),!re.targets)return re;for(const ue of re.targets){const Te=X(ue.datasource,{returnDefaultAsNull:!0});Te!=null&&(ue.datasource=Te)}return re}),de<34&&(xe.push(re=>(this.migrateCloudWatchQueries(re),re)),this.migrateCloudWatchAnnotationQuery()),de<35&&xe.push(le),de<36){for(const ue of this.dashboard.annotations.list)ue.datasource=X(ue.datasource,{returnDefaultAsNull:!1});const re=(0,v.l)().getInstanceSettings(null);if(re){for(const ue of this.dashboard.templating.list)ue.type==="query"&&ue.datasource===null&&(ue.datasource=(0,i.p$)(re));xe.push(ue=>{if(ue.targets){let Te=!1;ue.datasource==null&&ue.targets.length>0&&(ue.datasource=(0,i.p$)(re),Te=!0);for(const ge of ue.targets)(ge.datasource==null||ge.datasource.uid==null)&&(ue.datasource?.uid!==I.uv?ge.datasource={...ue.datasource}:ge.datasource=X(ge.datasource,{returnDefaultAsNull:!1})),Te&&ge.datasource?.uid!=="__expr__"&&(ue.datasource=ge.datasource)}return ue})}}if(de<37&&xe.push(re=>(re.options?.legend&&(re.options.legend.displayMode==="hidden"||re.options.legend.showLegend===!1)?(re.options.legend.displayMode="list",re.options.legend.showLegend=!1):re.options?.legend&&(re.options.legend={...re.options?.legend,showLegend:!0}),re)),de<38&&xe.push(re=>{if(re.type==="table"&&re.fieldConfig!==void 0){const ue=re.fieldConfig.defaults?.custom?.displayMode;if(ue!==void 0&&(re.fieldConfig.defaults.custom.cellOptions=(0,f.o7)(ue),delete re.fieldConfig.defaults.custom.displayMode),re.fieldConfig?.overrides)for(const Te of re.fieldConfig.overrides)for(let ge=0;ge<Te.properties?.length;ge++){let Oe=Te.properties[ge].value;Te.properties[ge].id==="custom.displayMode"&&(Te.properties[ge].id="custom.cellOptions",Te.properties[ge].value=(0,f.o7)(Oe))}}return re}),de<39&&xe.push(re=>(re.transformations?.forEach(ue=>{if(ue.id==="timeSeriesTable"&&ue.options!==void 0&&ue.options.refIdToStat!==void 0){let Te={};for(const[ge,Oe]of Object.entries(ue.options.refIdToStat)){let Ue={};Ue.stat=Oe,Te[ge]=Ue}ue.options=Te}}),re)),xe.length!==0)for(oe=0;oe<this.dashboard.panels.length;oe++)for(J=0;J<xe.length;J++){this.dashboard.panels[oe]=xe[J].call(this,this.dashboard.panels[oe]);const re=this.dashboard.panels[oe].panels;if(re)for(ee=0;ee<re.length;ee++)re[ee]=xe[J].call(this,re[ee])}}}removeRepeatedPanels(){const Q=[];for(const ae of this.dashboard.panels)ae.repeatPanelId||ae.repeatByRow||(ae.type==="row"&&Array.isArray(ae.panels)&&(ae.panels=ae.panels.filter(oe=>!oe.repeatPanelId)),Q.push(ae));this.dashboard.panels=Q}migrateCloudWatchQueries(Q){for(const ae of Q.targets||[])if(te(ae)&&(N(ae),ae.hasOwnProperty("statistics"))){const oe=O(ae,[...Q.targets]);for(const J of oe)Q.targets.push(J)}}migrateCloudWatchAnnotationQuery(){for(const Q of this.dashboard.annotations.list)if(H(Q)){const ae=j(Q);for(const oe of ae)this.dashboard.annotations.list.push(oe)}}upgradeToGridLayout(Q){let ae=0;const oe=y.cV/12;let ee=(0,n.max)((0,n.flattenDeep)((0,n.map)(Q.rows,xe=>(0,n.map)(xe.panels,"id"))))+1;if(!Q.rows)return;const de=(0,n.some)(Q.rows,xe=>xe.collapse||xe.showTitle||xe.repeat);for(const xe of Q.rows){if(xe.repeatIteration)continue;const re=xe.height||y.bJ,ue=B(re),Te={};let ge;de&&(Te.id=ee,Te.type="row",Te.title=xe.title,Te.collapsed=xe.collapse,Te.repeat=xe.repeat,Te.panels=[],Te.gridPos={x:0,y:ae,w:y.cV,h:ue},ge=new F.a9(Te),ee++,ae++);const Oe=new K(ue,y.cV,ae);for(const Ue of xe.panels){Ue.span=Ue.span||y.o9,Ue.minSpan&&(Ue.minSpan=Math.min(y.cV,y.cV/12*Ue.minSpan));const Xe=Math.floor(Ue.span)*oe,we=Ue.height?B(Ue.height):ue,qe=Oe.getPanelPosition(we,Xe);ae=Oe.yPos,Ue.gridPos={x:qe.x,y:ae+qe.y,w:Xe,h:we},Oe.addPanel(Ue.gridPos),delete Ue.span,ge&&Te.collapsed?ge.panels?.push(Ue):this.dashboard.panels.push(new F.a9(Ue))}ge&&this.dashboard.panels.push(ge),ge&&Te.collapsed||(ae+=ue)}}}function B(_){return(0,n.isString)(_)&&(_=parseInt(_.replace("px",""),10)),_<y.cx&&(_=y.cx),Math.ceil(_/(y.sD+y.dU))}class K{constructor(Q,ae=y.cV,oe=0){this.area=new Array(ae).fill(0),this.yPos=oe,this.height=Q}reset(){this.area.fill(0)}addPanel(Q){for(let ae=Q.x;ae<Q.x+Q.w;ae++)(!this.area[ae]||Q.y+Q.h-this.yPos>this.area[ae])&&(this.area[ae]=Q.y+Q.h-this.yPos);return this.area}getPanelPosition(Q,ae,oe=!1){let J,ee,de;for(let xe=this.area.length-1;xe>=0&&this.height-this.area[xe]>0;xe--)if(ee===void 0)ee=xe;else if(xe<this.area.length-1&&this.area[xe]<=this.area[xe+1])J=xe;else break;if(J!==void 0&&ee!==void 0&&ee-J>=ae-1){const xe=(0,n.max)(this.area.slice(J));de={x:J,y:xe}}else return oe?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(Q,ae,!0));return de}}function W(_){let Q=_.url;return!Q&&_.dashboard&&(Q=`dashboard/db/${D.A.slugifyForUrl(_.dashboard)}`),!Q&&_.dashUri&&(Q=`dashboard/${_.dashUri}`),Q||(Q="/"),_.keepTime&&(Q=g.kM.appendQueryToUrl(Q,`$${o.c.keepTime}`)),_.includeVars&&(Q=g.kM.appendQueryToUrl(Q,`$${o.c.includeVars}`)),_.params&&(Q=g.kM.appendQueryToUrl(Q,_.params)),{url:Q,title:_.title,targetBlank:_.targetBlank}}function z(_){const Q=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return _.replace(Q,(ae,oe,J,ee,de,xe)=>oe?"__series.name":J?"${__series.name}":ee?"__value.time":de?"__field.name":xe?"${__field.name}":ae)}function Y(_){if(h.config.panels["grafana-singlestat-panel"])return _.type="grafana-singlestat-panel",_;let Q=!1;return _.changePlugin||(Q=!0,_=new F.a9(_)),_.plugin={angularPanelCtrl:{}},_.gauge?.show?(R.plugin.meta=h.config.panels.gauge,_.changePlugin(R.plugin)):(T.plugin.meta=h.config.panels.stat,_.changePlugin(T.plugin)),Q?_.getSaveModel():_}function X(_,Q){if(Q.returnDefaultAsNull&&(_==null||_==="default"))return null;if((0,i.fN)(_))return _;const ae=(0,v.l)().getInstanceSettings(_);return ae?(0,i.p$)(ae):{uid:_||void 0}}function q(_,Q,ae){if(_.transformations){const oe=[];for(const J of _.transformations)oe.push(J),J.id===Q&&oe.push({...ae});_.transformations=oe}return _}function G(_){const Q=_.fieldConfig;if(!Q)return _;if(Q.defaults&&Q.defaults.mappings&&(Q.defaults.mappings=se(Q.defaults.mappings,Q.defaults.thresholds)),Array.isArray(Q.overrides))for(const ae of Q.overrides)for(const oe of ae.properties)oe.id==="mappings"&&(oe.value=se(oe.value));return _}function te(_){return _.hasOwnProperty("dimensions")&&_.hasOwnProperty("namespace")&&_.hasOwnProperty("region")&&_.hasOwnProperty("metricName")}function H(_){return _.hasOwnProperty("dimensions")&&_.hasOwnProperty("namespace")&&_.hasOwnProperty("region")&&_.hasOwnProperty("prefixMatching")&&_.hasOwnProperty("statistics")}function se(_,Q){if(!_)return;const ae={type:d.d.ValueToText,options:{}},oe=[];for(const J of _){if(J.type&&J.options){J.type===d.d.ValueToText?ae.options={...ae.options,...J.options}:oe.push(J);continue}let ee;const de=parseFloat(J.text);if(Q&&!isNaN(de)){const xe=(0,c.yQ)(de,Q.steps);xe&&xe.color&&(ee=xe.color)}switch(J.type){case 1:J.value!=null&&(J.value==="null"?oe.push({type:d.d.SpecialValue,options:{match:d.W.Null,result:{text:J.text,color:ee}}}):ae.options[String(J.value)]={text:J.text,color:ee});break;case 2:oe.push({type:d.d.RangeToText,options:{from:+J.from,to:+J.to,result:{text:J.text,color:ee}}});break}}return Object.keys(ae.options).length>0&&oe.unshift(ae),oe}function ne(_){return(_.type==="timeseries"||_.type==="xychart"||_.type==="xychart2")&&_.options.tooltipOptions&&(_.options={..._.options,tooltip:_.options.tooltipOptions},delete _.options.tooltipOptions),_}function le(_){return _.type==="timeseries"&&_.fieldConfig?.defaults.custom?.axisPlacement===x.vM.Hidden&&(_.fieldConfig={..._.fieldConfig,overrides:[..._.fieldConfig.overrides,{matcher:{id:a.Ct.byType,options:p.PU.time},properties:[{id:"custom.axisPlacement",value:x.vM.Auto}]}]}),_}},98365:(k,A,e)=>{"use strict";e.d(A,{G:()=>N});var n=e(2543),s=e(64423),l=e(18226),r=e(72724),i=e(47232),g=e(3591),o=e(32264),d=e(24284),c=e(15054),a=e(16233),p=e(28874),u=e(8480),m=e(20601),v=e(72401),x=e(87421),f=e(31678),E=e(28444),h=e(10096),y=e(99140),b=e(80484),D=e(75096),P=e(74856),C=e(34214);const M=new Set(["gridPos","title","description","transparent"]);function I(w,B){const K=[],W={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:K};let z=0;const Y=new Map;for(let X of B){let{id:q}=X;q||(z||(z=T([w,B])),q=z++,X={...X,id:q}),Y.set(q,X)}for(const X of w){const q=Y.get(X.id);if(!q){W.changed=!0,W.actions.remove.push(X.id),X.destroy();continue}if(Y.delete(X.id),q===X){K.push(X),W.actions.noop.push(X.id);continue}if(X.type===q.type){const te=X.getSaveModel();let H=!0,se=!1;for(const[ne,le]of Object.entries(q))if(!(0,n.isEqualWith)(le,te[ne],R))if(W.changed=!0,H=!1,M.has(ne))X[ne]=le,se=!0;else{se=!1;break}if(H){K.push(X),W.actions.noop.push(X.id);continue}if(se){K.push(X),W.actions.update.push(X.id);continue}}X.destroy();const G=new C.a(q);G.key=`${G.id}-update-${Date.now()}`,K.push(G),W.changed=!0,W.actions.replace.push(X.id)}for(const X of Y.values())K.push(new C.a(X)),W.changed=!0,W.actions.add.push(X.id);return W}function R(w,B){if(w==null&&(B===1/0||B===-1/0||B==null)||B==null&&(w===1/0||w===-1/0||w==null))return!0}function T(w){let B=0;for(const K of w)for(const W of K)W.id>B&&(B=W.id);return B+1}var S=e(79056),L=e(84423);function O(w,B){return w.repeatDirection===c.HG?!1:B.gridPos.x>=w.gridPos.x+w.gridPos.w&&B.gridPos.y===w.gridPos.y}function j(w){for(const B of w)if(delete B.scopedVars,B.panels?.length)for(const K of B.panels)delete K.scopedVars}class N{constructor(B,K,W){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=W?.getVariablesFromState??x.SS,this.events=new l.o,this.id=B.id||null,this.uid=B.uid||null,this.revision=B.revision??void 0,this.title=B.title??"No Title",this.description=B.description,this.tags=B.tags??[],this.timezone=B.timezone??"",this.weekStart=B.weekStart??"",this.editable=B.editable!==!1,this.graphTooltip=B.graphTooltip||0,this.time=B.time??{from:"now-6h",to:"now"},this.timepicker=B.timepicker??{},this.liveNow=B.liveNow,this.templating=this.ensureListExist(B.templating),this.annotations=this.ensureListExist(B.annotations),this.refresh=B.refresh,this.snapshot=B.snapshot,this.schemaVersion=B.schemaVersion??0,this.fiscalYearStartMonth=B.fiscalYearStartMonth??0,this.version=B.version??0,this.links=B.links??[],this.gnetId=B.gnetId||null,this.panels=(0,n.map)(B.panels??[],z=>new L.a9(z)),this.originalDashboard=(0,n.cloneDeep)(B),this.originalTemplating=(0,n.cloneDeep)(this.templating),this.originalTime=(0,n.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(K),this.updateSchema(B),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new s.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(h.lE.subscribe(b.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(h.lE.subscribe(b.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(h.lE.subscribe(b.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(K=>K.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:d.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(B){B=B||{},B.canShare=B.canShare!==!1,B.canSave=B.canSave!==!1,B.canStar=B.canStar!==!1,B.canEdit=B.canEdit!==!1,B.canDelete=B.canDelete!==!1,B.showSettings=B.canEdit,B.canMakeEditable=B.canSave&&!this.editable,B.hasUnsavedFolderChange=!1,this.editable||(B.canEdit=!1,B.canDelete=!1,B.canSave=!1),this.meta=B}getSaveModelCloneOld(B){const K=(0,n.defaults)(B||{},{saveVariables:!0,saveTimerange:!0});let W={};for(const z in this)N.nonPersistedProperties[z]||!this.hasOwnProperty(z)||(W[z]=(0,n.cloneDeep)(this[z]));return W.templating=this.getTemplatingSaveModel(K),K.saveTimerange||(W.time=this.originalTime),W.panels=this.getPanelSaveModels(),W=(0,p.v)(W),W.getVariables=()=>W.templating.list,W}getSaveModelClone(B){const K=this.getSaveModelCloneOld(B),W=JSON.stringify(K);return JSON.parse(W)}updatePanels(B){const K=I(this.panels,B??[]);return K.changed&&(this.panels=K.panels??[],this.sortPanelsByGridPos(),this.events.publish(new E.Q$)),K}getPanelSaveModels(){return this.panels.filter(B=>this.isSnapshotTruthy()||!(B.repeatPanelId||B.repeatedByRow)).map(B=>{if(B.libraryPanel){const{id:K,title:W,libraryPanel:z,gridPos:Y}=B;return{id:K,title:W,gridPos:Y,libraryPanel:{uid:z.uid,name:z.name}}}return this.panelInEdit&&this.panelInEdit.id===B.id?this.panelInEdit.getSaveModel():B.getSaveModel()}).map(B=>(this.isSnapshotTruthy()||(delete B.scopedVars,B.type==="row"&&B.panels&&B.panels.length>0&&(B.panels=B.panels.filter(K=>!K.repeatPanelId).map(K=>(delete K.scopedVars,K)))),B))}getTemplatingSaveModel(B){const K=this.originalTemplating?.list??[],z=this.getVariablesFromState(this.uid).map(X=>{const q=m.B.get(X.type).getSaveModel(X,B.saveVariables);if(!B.saveVariables){const G=K.find(({name:te,type:H})=>te===X.name&&H===X.type);if(!G)return q;X.type==="adhoc"?q.filters=G.filters:(q.current=G.current,q.options=G.options)}return q});return{list:(0,p.v)(z)}}timeRangeUpdated(B){this.events.publish(new g.sR(B)),(0,y.JD)((0,v.RK)(this.uid,B)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(B={refreshAll:!0,panelIds:[]}){if(this.events.publish(new g._),this.lastRefresh=Date.now(),this.panelInEdit&&(B.refreshAll||B.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const K=this.panels.filter(W=>!this.otherPanelInFullscreen(W)&&(B.refreshAll||B.panelIds.includes(W.id)));if(!this.isSnapshot())for(const W of K)W.refreshWhenInView=!0;for(const W of K)W.refresh()}render(){this.events.publish(new E.XM);for(const B of this.panels)B.render()}panelInitialized(B){const K=B.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(B)&&!K&&B.refresh()}otherPanelInFullscreen(B){return(this.panelInEdit||this.panelInView)&&!(B.isViewing||B.isEditing)}initEditPanel(B){return(0,P.jG)().stopAutoRefresh(),this.panelInEdit=B.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,P.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(B){this.panelInView=B,this.timeRangeUpdatedDuringEditOrView=!1,B.setIsViewing(!0)}exitViewPanel(B){this.panelInView=void 0,B.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const B=new Set;let K=this.getNextPanelId();for(const W of this.panelIterator())(!W.id||B.has(W.id))&&(W.id=K++),B.add(W.id)}ensureListExist(B={}){return B.list??=[],B}getNextPanelId(){let B=0;for(const K of this.panelIterator())K.id>B&&(B=K.id);return B+1}*panelIterator(){for(const B of this.panels){yield B;const K=B.panels??[];for(const W of K)yield W}}forEachPanel(B){for(let K=0;K<this.panels.length;K++)B(this.panels[K],K)}getPanelById(B,K=!1){if(this.panelInEdit&&this.panelInEdit.id===B)return this.panelInEdit;if(K){for(const W of this.panelIterator())if(W.id===B)return W;return null}else return this.panels.find(W=>W.id===B)??null}canEditPanel(B){return!!(this.meta.canEdit&&B&&!B.repeatPanelId&&B.type!=="row")}canEditPanelById(B){return this.canEditPanel(this.getPanelById(B))}addPanel(B){B.id=this.getNextPanelId(),this.panels.unshift(new L.a9(B)),this.sortPanelsByGridPos(),this.events.publish(new E.Q$)}updateMeta(B){this.meta={...this.meta,...B},this.events.publish(new E.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((B,K)=>B.gridPos.y===K.gridPos.y?B.gridPos.x-K.gridPos.x:B.gridPos.y-K.gridPos.y)}clearUnsavedChanges(B,K){for(const W of this.panels)W.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=B,this.originalTemplating=B.templating,K.saveTimerange&&(this.originalTime=B.time)}hasUnsavedChanges(){return!!this.panels.find(K=>K.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;j(this.panels);const B=this.panels.filter(K=>(!K.repeat||K.repeatedByRow)&&K.repeatPanelId);(0,n.pull)(this.panels,...B),B.map(K=>K.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let B=0;B<this.panels.length;B++){const K=this.panels[B];K.repeat&&this.repeatPanel(K,B)}this.sortPanelsByGridPos(),this.events.publish(new E.Q$)}}cleanUpRowRepeats(B){const K=B.map(z=>z.id),W=B.filter(z=>!z.repeat&&z.repeatPanelId&&K.includes(z.repeatPanelId));(0,n.pull)(B,...W),(0,n.pull)(this.panels,...W)}processRowRepeats(B){if(this.isSnapshotTruthy()||!this.hasVariables())return;let K=B.panels??[];if(!B.collapsed){const W=this.panels.findIndex(z=>z.id===B.id);K=this.getRowPanels(W)}this.cleanUpRowRepeats(K);for(const W of K)if(W.repeat){const z=this.panels.findIndex(Y=>Y.id===W.id);this.repeatPanel(W,z)}}getPanelRepeatClone(B,K,W){if(K===0)return B;const z=B.getSaveModel();z.id=this.getNextPanelId();const Y=new L.a9(z);return this.panels.splice(W+K,0,Y),Y.repeatPanelId=B.id,Y.repeat=void 0,this.panelInView?.id===Y.id&&(Y.setIsViewing(!0),this.panelInView=Y),Y}getRowRepeatClone(B,K,W){if(K===0){if(!B.collapsed){const q=this.getRowPanels(W);B.panels=q}return B}const z=new L.a9(B.getSaveModel());let Y,X;return B.collapsed?(Y=(0,n.cloneDeep)(B.panels)??[],z.panels=Y,X=W+K):(Y=this.getRowPanels(W),z.panels=Y.map(q=>q.getSaveModel()),X=W+(Y.length+1)*K),this.panels.splice(X,0,z),this.updateRepeatedPanelIds(z),z}repeatPanel(B,K){const W=this.getPanelRepeatVariable(B);if(!W)return;if(B.type==="row"){this.repeatRow(B,K,W);return}const z=this.getSelectedVariableOptions(W),Y=B.maxPerRow||4;let X=0,q=B.gridPos.y;for(let te=0;te<z.length;te++){const H=z[te];let se;se=this.getPanelRepeatClone(B,te,K),se.scopedVars??={},se.scopedVars[W.name]=H,B.repeatDirection===c.Pz?(te>0&&(q+=se.gridPos.h),se.gridPos.y=q):(se.gridPos.w=Math.max(c.cV/z.length,c.cV/Y),se.gridPos.x=X,se.gridPos.y=q,X+=se.gridPos.w,X+se.gridPos.w>c.cV&&(X=0,q+=se.gridPos.h))}const G=q-B.gridPos.y;if(G>0){const te=K+z.length;for(const H of this.panels.slice(te))O(B,H)||(H.gridPos.y+=G)}}repeatRow(B,K,W){const z=this.getSelectedVariableOptions(W);for(let Y=0;Y<z.length;Y++){const X=z[Y],q=this.getRowRepeatClone(B,Y,K);U(q,W,X);const G=this.getRowHeight(q),te=q.panels||[];let H;if(B.collapsed){for(const se of te)U(se,W,X),Y>0&&this.updateRepeatedPanelIds(se,!0);q.gridPos.y+=Y,H=K+Y+1}else{const se=K+(te.length+1)*Y+1;te.forEach((ne,le)=>{if(U(ne,W,X),Y>0){const _=new L.a9(ne);this.updateRepeatedPanelIds(_,!0),_.gridPos.y+=G*Y,this.panels.splice(se+le,0,_)}}),q.panels=[],q.gridPos.y+=G*Y,H=se+te.length}if(z.length>1)for(const se of this.panels.slice(H))se.gridPos.y+=G}}updateRepeatedPanelIds(B,K){return B.repeatPanelId=B.id,B.id=this.getNextPanelId(),K?B.repeatedByRow=!0:B.repeat=void 0,B}getSelectedVariableOptions(B){let K;return(0,D.ML)(B)?K=B.options.slice(1,B.options.length):K=(0,n.filter)(B.options,{selected:!0}),K}getRowHeight(B){if(!B.panels||B.panels.length===0)return 0;if(B.collapsed)return 1;const K=(0,n.maxBy)(B.panels,({gridPos:W})=>W.y+W.h).gridPos;return K.y+K.h-B.gridPos.y}removePanel(B){this.panels=this.panels.filter(K=>K!==B),B.destroy(),this.events.publish(new E.Q$)}removeRow(B,K){(!K&&B.collapsed||K&&!B.collapsed)&&this.toggleRow(B),this.removePanel(B)}expandRows(){const B=this.panels.filter(K=>K.type==="row"&&K.collapsed);for(const K of B)this.toggleRow(K)}collapseRows(){const B=this.panels.filter(K=>K.type==="row"&&!K.collapsed);for(const K of B)this.toggleRow(K)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(B=>B.hide!==2)||this.annotations.list.some(B=>!B.hide)}getPanelInfoById(B){const K=this.panels.findIndex(W=>W.id===B);return K>=0?{panel:this.panels[K],index:K}:null}duplicatePanel(B){const K=B.getSaveModel();return K.id=this.getNextPanelId(),delete K.repeat,delete K.repeatIteration,delete K.repeatPanelId,delete K.scopedVars,K.alert&&delete K.thresholds,delete K.alert,B.gridPos.x+B.gridPos.w*2<=c.cV?K.gridPos.x+=B.gridPos.w:K.gridPos.y+=B.gridPos.h,this.addPanel(K),K}formatDate(B,K){return(0,r.LE)(B,{format:K,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const B of this.panels)B.destroy()}toggleRow(B){const K=(0,n.indexOf)(this.panels,B);if(!B.collapsed){const X=this.getRowPanels(K);(0,n.pull)(this.panels,...X),B.panels=X.map(q=>q.getSaveModel()),B.collapsed=!0,X.some(q=>q.hasChanged)&&B.configRev++,this.events.publish(new E.Q$);return}B.collapsed=!1;const W=B.panels??[],z=W.some(X=>X.repeat),Y=B.repeat;if(W.length>0){const q=(W[0].gridPos.y??B.gridPos.y)-(B.gridPos.y+B.gridPos.h);let G=K+1,te=B.gridPos.y;for(const se of W){if(Y){const ne=this.getPanelRepeatVariable(B);if(se.scopedVars??={},ne){const le=this.getSelectedVariableOptions(ne);se.scopedVars={...se.scopedVars,[ne.name]:le[0]}}}se.gridPos.y??(se.gridPos.y=B.gridPos.y),se.gridPos.y-=q,this.panels.splice(G,0,new L.a9(se)),G+=1,te=Math.max(te,se.gridPos.y+se.gridPos.h)}const H=te-B.gridPos.y-1;for(const se of this.panels.slice(G))se.gridPos.y+=H;B.panels=[],z&&this.processRowRepeats(B)}this.sortPanelsByGridPos(),this.events.publish(new E.Q$)}getRowPanels(B){const K=this.panels.slice(B+1),W=K.findIndex(Y=>Y.type==="row");return K.slice(0,W>=0?W:this.panels.length)}on(B,K){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(B,K)}off(B,K){console.log("DashboardModel.off is deprecated"),this.events.off(B,K)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(B){return(0,r.fq)(B,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:a.TP?.user?.timezone}updateSchema(B){new S.SW(this).updateSchema(B)}hasTimeChanged(){const{time:B,originalTime:K}=this;return!((0,n.isEqual)(B,K)||(0,n.isEqual)((0,i.KQ)(B?.from),(0,i.KQ)(K?.from))&&(0,n.isEqual)((0,i.KQ)(B?.to),(0,i.KQ)(K?.to)))}autoFitPanels(B,K){const W=Math.max(...this.panels.map(te=>te.gridPos.h+te.gridPos.y)),z=55;let X=B-z-20;K&&K!==f.KioskMode.TV&&(X+=z);const q=Math.floor(X/(c.sD+c.dU)),G=W/q;for(const te of this.panels)te.gridPos.y=Math.round(te.gridPos.y/G)||1,te.gridPos.h=Math.round(te.gridPos.h/G)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(f.CoreEvents.bG)}getPanelByUrlId(B){const K=parseInt(B??"0",10),W=this.panels.filter(z=>z.collapsed);for(const z of W)z.panels?.some(X=>X.id===K)&&this.toggleRow(z);return this.getPanelById(K)}toggleLegendsForAll(){const B=this.panels.filter(F),K=B.filter(Y=>Y.legend.show).length,W=B.length-K,z=K>=W;for(const Y of B)Y.legend.show=!z,Y.render()}toggleExemplarsForAll(){for(const B of this.panels)for(const K of B.targets){if(!(K.datasource&&K.datasource.type==="prometheus"))continue;const W=K;W.exemplar=!W.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(B){let K=!0;return B?K=!!this.meta.annotationsPermissions?.dashboard.canEdit:K=!!this.meta.annotationsPermissions?.organization.canEdit,(o.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&K}canDeleteAnnotations(B){let K=!0;return B?K=!!this.meta.annotationsPermissions?.dashboard.canDelete:K=!!this.meta.annotationsPermissions?.organization.canDelete,o.$.featureToggles.annotationPermissionUpdate?K:K&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(K=>K.builtIn===1)?.enable===!1?!1:o.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(B,K){!(0,n.isEqual)(B?.gridPos,K?.gridPos)&&this.events.publish(new E.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(B){return this.getVariablesFromState(this.uid).find(K=>K.name===B.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const B=this.originalTemplating?.list??[],K=this.getTemplatingSaveModel({saveVariables:!0}).list;return B.length!==K.length?!1:!(0,n.isEqual)(K,B)}variablesTimeRangeProcessDoneHandler(B){const K=B.payload.variableIds.length>0;this.variablesChangedHandler(new b.og({panelIds:[],refreshAll:!0}),K)}variablesChangedHandler(B,K=!0){if(K&&this.processRepeats(),B.payload.refreshAll||(0,P.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=B.payload.panelIds.filter(W=>W!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(B.payload)}variablesChangedInUrlHandler(B){this.templateVariableValueUpdated(),this.startRefresh(B.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(B=>{const K=(o.$.panels[B.type]?.angular?.detected||L.vI.includes(B.type))&&!o.$.panels[B.type]?.angular?.hideDeprecation;let W=!1;return B.datasource?.uid&&(W=(0,u.Hv)(B.datasource?.uid)),K||W})}}function F(w){return!!w.legend}function U(w,B,K){w.scopedVars??={},w.scopedVars[B.name]=K}},84423:(k,A,e)=>{"use strict";e.d(A,{NB:()=>y,a9:()=>D,tD:()=>b,tw:()=>C,vI:()=>h});var n=e(2543),s=e.n(n),l=e(62938),r=e(18226),i=e(77789),g=e(41987),o=e(581),d=e(3591),c=e(72574),a=e(2913),p=e(87490),u=e(28444),m=e(80924),v=e(96382);const x={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},f={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},E={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},h=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],y={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},b={"heatmap-new":"heatmap"};class D{constructor(I){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new r.o,this.restoreModel(I),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,l.A)()}restoreModel(I){for(const T in this)x[T]||!this.hasOwnProperty(T)||I[T]||typeof this[T]!="function"&&typeof this[T]!="symbol"&&delete this[T];for(const T in I)this[T]=I[T];const R=(0,v.p)(this);R&&(this.autoMigrateFrom=this.type,this.type=R),(0,n.defaultsDeep)(this,(0,n.cloneDeep)(E)),this.ensureQueryIds()}generateNewKey(){this.key=(0,l.A)()}ensureQueryIds(){if(this.targets&&(0,n.isArray)(this.targets))for(const I of this.targets)I.refId||(I.refId=(0,i.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(I){this.options=I,this.configRev++,this.events.publish(new u.PR),this.render()}updateFieldConfig(I){this.fieldConfig=I,this.configRev++,this.events.publish(new u.PR),this.resendLastResult(),this.render()}getSaveModel(){const I={};for(const R in this)x[R]||!this.hasOwnProperty(R)||(0,n.isEqual)(this[R],E[R])||(I[R]=(0,n.cloneDeep)(this[R]));return this.type==="row"&&this.panels&&this.panels.length>0&&(I.panels=this.panels.map(R=>{if(R.libraryPanel){const{id:T,title:S,libraryPanel:L,gridPos:O}=R;return{id:T,title:S,gridPos:O,libraryPanel:{uid:L.uid,name:L.name}}}return R})),I}setIsViewing(I){this.isViewing=I}updateGridPos(I,R=!0){I.x===this.gridPos.x&&I.y===this.gridPos.y&&I.h===this.gridPos.h&&I.w===this.gridPos.w||(this.gridPos.x=I.x,this.gridPos.y=I.y,this.gridPos.w=I.w,this.gridPos.h=I.h,R&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:I,dashboardTimezone:R,timeData:T,width:S}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:I,timezone:R,timeRange:T.timeRange,timeInfo:T.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(S),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?g.Jk.PanelEditor:this.isViewing?g.Jk.PanelViewer:g.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new d._)}render(){this.hasRefreshed?this.events.publish(new u.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((I,R)=>x[R]||f[R]?I:{...I,[R]:this[R]},{})}restorePanelOptions(I){const R=this.cachedPluginOptions[I];R&&(Object.keys(R.properties).map(T=>{this[T]=R.properties[T]}),this.fieldConfig=(0,o.H9)(this.fieldConfig,R.fieldConfig))}applyPluginOptionDefaults(I,R){const T=(0,o.F)({plugin:I,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:R});this.fieldConfig=T.fieldConfig,this.options=T.options}async pluginLoaded(I){this.plugin=I;const R=P(I);if(this.autoMigrateFrom){const T=y[this.autoMigrateFrom]!=null,S=this.getOptionsToRemember(),L=this.autoMigrateFrom,O=this.type;this.clearPropertiesBeforePluginChange(),this.type=O,this.plugin=I,this.callPanelTypeChangeHandler(I,L,S,T)}if(I.onPanelMigration&&R!==this.pluginVersion){const T=I.onPanelMigration(this);this.options=await T,this.pluginVersion=R}this.applyPluginOptionDefaults(I,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const I in this)f[I]||delete this[I];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,o.aW)(this.fieldConfig.overrides,o.nx)}}callPanelTypeChangeHandler(I,R,T,S){if(I.onPanelTypeChanged){const L=S?{angular:T}:T.options;Object.assign(this.options,I.onPanelTypeChanged(this,R,L,this.fieldConfig))}}changePlugin(I){const R=I.meta.id,T=this.getOptionsToRemember(),S=this.fieldConfig,L=this.type,O=this.isAngularPlugin()||!!y[L];this.cachedPluginOptions[L]={properties:T,fieldConfig:S},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(R),this.callPanelTypeChangeHandler(I,L,T,O),this.type=R,this.plugin=I,this.configRev++,this.applyPluginOptionDefaults(I,!0),I.onPanelMigration&&(this.pluginVersion=P(I))}updateQueries(I){const{dataSource:R}=I;this.datasource=R,this.cacheTimeout=I.cacheTimeout,this.queryCachingTTL=I.queryCachingTTL,this.timeFrom=I.timeRange?.from,this.timeShift=I.timeRange?.shift,this.hideTimeOverride=I.timeRange?.hide,this.interval=I.minInterval,this.maxDataPoints=I.maxDataPoints,this.targets=I.queries,this.configRev++,this.events.publish(new u.zq)}addQuery(I){I=I||{refId:"A"},I.refId=(0,i.M)(this.targets),this.targets.push(I),this.configRev++}changeQuery(I,R){I.refId=this.targets[R].refId,this.configRev++,this.targets=this.targets.map((T,S)=>S===R?I:T)}getEditClone(){const I=this.getSaveModel(),R=new D(I);R.isEditing=!0,R.plugin=this.plugin;const T=this.getQueryRunner();return R.getQueryRunner().useLastResultFrom(T),R}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:a.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new m.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(I){this.transformations=I,this.resendLastResult(),this.configRev++,this.events.publish(new u.JI)}setProperty(I,R){this[I]=R,this.configRev++,I==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(I,R,T){const S=this.getQueryRunner().getLastRequest(),L=Object.assign({},this.scopedVars,S?.scopedVars,R);return(0,c.w)().replace(I,L,T)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(I){for(const[R,T]of Object.entries(I.model)){switch(R){case"id":case"gridPos":case"libraryPanel":continue}this[R]=T}this.libraryPanel=I}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function P(M){return M&&M.meta.info.version?M.meta.info.version:a.Ay.buildInfo.version}function C(M){const I={};return Object.entries(M).filter(([R,T])=>!x[R]&&M.hasOwnProperty(R)&&!(0,n.isEqual)(T,E[R])).forEach(([R,T])=>{I[R]=T}),(0,p.MA)(I)}},3673:(k,A,e)=>{"use strict";e.d(A,{Bz:()=>x,Q9:()=>m,Ss:()=>E,TA:()=>v,lC:()=>f});var n=e(17172),s=e(82467),l=e(3169),r=e(28676),i=e(6473),g=e(80095),o=e(81862),d=e(20701),c=e(72401),a=e(14792),p=e(74856),u=e(28601);function m(h,y){return async b=>{await(0,n.AI)().post("/api/dashboards/import",h),b((0,s.dx)((0,l.tZ)("Dashboard Imported",y))),b((0,d.h9)())}}function v(h){return async y=>{await(0,r.n)().deleteDashboard(h,!1),y((0,d.h9)())}}const x=()=>(h,y)=>{const D=y().dashboard.getModel();D&&(D.destroy(),h((0,c.Y7)(D.uid))),(0,p.jG)().stopAutoRefresh(),h((0,u.p0)()),h((0,g.rG)()),i.t.leave(),(0,a.UA)().setCurrent(void 0)},f=h=>y=>{y((0,o.Cj)(h)),(0,p.jG)().refreshTimeModel()},E=h=>y=>{y((0,o.xu)(h)),(0,p.jG)().refreshTimeModel()}},41176:(k,A,e)=>{"use strict";e.d(A,{B:()=>l});var n=e(61298),s=e(14110);function l(r){const i={dashboardId:r.id,dashboardName:r.title,dashboardUid:r.uid,folderName:r.meta.folderTitle,eventName:n.n_.DashboardView};(0,s.G$)(i)}},96382:(k,A,e)=>{"use strict";e.d(A,{p:()=>l});var n=e(2913),s=e(84423);function l(r,i){if(s.tD[r.type])return s.tD[r.type];const g=d=>{const c="__feature."+d,p=new URLSearchParams(window.location.search).get(c);return p==="true"||p===""},o=i||!n.Ay.angularSupportEnabled||n.Ay.featureToggles.autoMigrateOldPanels||g("autoMigrateOldPanels")||g("disableAngular");if(r.type==="graph"&&(o||n.Ay.featureToggles.autoMigrateGraphPanel||g("autoMigrateGraphPanel")))return r.xaxis?.mode==="series"?"barchart":r.xaxis?.mode==="histogram"?"histogram":"timeseries";if(o)return s.NB[r.type];if(r.type==="table-old"&&(n.Ay.featureToggles.autoMigrateTablePanel||g("autoMigrateTablePanel")))return"table";if(r.type==="grafana-piechart-panel"&&(n.Ay.featureToggles.autoMigratePiechartPanel||g("autoMigratePiechartPanel")))return"piechart";if(r.type==="grafana-worldmap-panel"&&(n.Ay.featureToggles.autoMigrateWorldmapPanel||g("autoMigrateWorldmapPanel")))return"geomap";if((r.type==="singlestat"||r.type==="grafana-singlestat-panel")&&n.Ay.featureToggles.autoMigrateStatPanel||g("autoMigrateStatPanel"))return"stat"}},34214:(k,A,e)=>{"use strict";e.d(A,{G:()=>n.G,a:()=>s.a9});var n=e(98365),s=e(84423)},20470:(k,A,e)=>{"use strict";e.d(A,{us:()=>B,vR:()=>w,yZ:()=>W,OI:()=>K});var n=e(71733),s=e(47232),l=e(69129),r=e(39601),i=e(17172),g=e(32264),o=e(82467),d=e(28138),c=e(3169),a=e(27677),p=e(33390),u=e(78160),m=e(17493),v=e(14792),x=e(74856),f=e(72255),E=e(71176),h=e(71101),y=e(54650);function b(z){return async Y=>{const X=await a.IB.getFolderByUid(z);return Y((0,y.jl)(X)),Y((0,o.Vz)((0,h.R4)(X))),X}}var D=e(6473),P=e(2609),C=e(75096),M=e(31678),I=e(42972),R=e(72401),T=e(87421),S=e(16833),L=e(98365),O=e(41176),j=e(28601);const N="initDashboard";async function F(z,Y,X){const q=p.A.getObject(B);if(q)return W(),q;try{switch(z.routeName){case M.DashboardRoutes.Home:{const te=(0,f.sP)().getDashboardFromCache(f.m6);if(te)return te;const H=await a.IB.get("/api/dashboards/home");if(H.redirectUri){const se=n.I.stripBaseFromUrl(H.redirectUri);return r.Ny.replace(se),null}return H.meta.canSave=!1,H.meta.canShare=!1,H.meta.canStar=!1,H}case M.DashboardRoutes.Public:return await m.np.loadDashboard("public",z.urlSlug,z.accessToken);case M.DashboardRoutes.Normal:{const G=await m.np.loadDashboard(z.urlType,z.urlSlug,z.urlUid);if(G.meta.folderUid)try{await Y(b(G.meta.folderUid))}catch(te){console.warn("Error fetching parent folder",G.meta.folderUid,"for dashboard",te)}if(z.fixUrl&&G.meta.url&&!P._o.state.isPlaying){const te=n.I.stripBaseFromUrl(G.meta.url),H=r.Ny.getLocation().pathname;te!==H&&(r.Ny.replace({...r.Ny.getLocation(),pathname:te}),console.log("not correct url correcting",te,H))}return G}case M.DashboardRoutes.New:return z.urlFolderUid&&await Y(b(z.urlFolderUid)),await(0,E.X)(z.urlFolderUid);case M.DashboardRoutes.Path:{const G=z.urlSlug??"";return await m.np.loadDashboard(M.DashboardRoutes.Path,G,G)}default:throw{message:"Unknown route "+z.routeName}}}catch(G){return(0,i.NF)(G)&&G.cancelled||(Y((0,j.ig)({message:"Failed to fetch dashboard",error:G})),console.error(G)),null}}const U=(z,Y={})=>(z.forEach(X=>{X.panels?U(X.panels,Y):X.targets&&X.targets.forEach(q=>{q.datasource?.type&&(Y[q.datasource.type]?Y[q.datasource.type].push(q):Y[q.datasource.type]=[q])})}),Y);function w(z){return async(Y,X)=>{(0,u.j)(N),Y((0,j.xS)());const q=await F(z,Y,X),G=q?.dashboard?.version;if(!q)return;Y((0,j.X1)());let te;try{te=new L.G(q.dashboard,q.meta)}catch(oe){Y((0,j.ig)({message:"Failed create dashboard model",error:oe})),console.error(oe);return}const H=X(),se=r.Ny.getSearchObject();se.orgId||r.Ny.partial({orgId:H.user.orgId},!0);const ne=(0,x.jG)();(0,v.UA)().setCurrent(te),ne.init(te);const _=(0,C.q4)(z.urlUid??te.uid);if(await Y((0,R._q)(_,te)),(0,I.nm)({dashboard:te,timeSrv:ne}).run({dashboard:te,range:ne.timeRange()}),(0,T.Tk)(X())!==_||X().dashboard.initPhase!==M.DashboardInitPhase.Services)return;try{te.processRepeats(),se.autofitpanels&&te.autoFitPanels(window.innerHeight,se.kiosk),g.$.publicDashboardAccessToken||z.keybindingSrv.setupDashboardBindings(te)}catch(oe){oe instanceof Error&&Y((0,o.dx)((0,c.gi)("Dashboard init failed",oe))),console.error(oe)}z.routeName!==M.DashboardRoutes.New?((0,O.B)(te),D.t.watch(te.uid)):D.t.leave(),te.weekStart!==""?(0,s.$D)(te.weekStart):(0,s.$D)(g.$.bootData.user.weekStart),d.A.publish(new l.gc({dashboardId:te.uid,orgId:H.user.orgId,userId:H.user.user?.id,grafanaVersion:g.$.buildInfo.version,queries:U(te.panels)}));const ae=(0,u.z)(N);(0,S.d)(te,ae?.duration,G),Y((0,j.O9)(te))}}const B="DASHBOARD_FROM_LS_KEY";function K(z){p.A.setObject(B,z)}function W(){p.A.delete(B)}},28601:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>x,O9:()=>c,Ub:()=>m,X1:()=>a,ig:()=>d,p0:()=>p,xS:()=>o});var n=e(65307),s=e(79422),l=e(31678),r=e(98365);const i={initPhase:l.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},g=(0,n.Z0)({name:"dashboard",initialState:i,reducers:{dashboardInitFetching:f=>{f.initPhase=l.DashboardInitPhase.Fetching},dashboardInitServices:f=>{f.initPhase=l.DashboardInitPhase.Services},dashboardInitCompleted:(f,E)=>{f.getModel=()=>E.payload,f.initPhase=l.DashboardInitPhase.Completed},dashboardInitFailed:(f,E)=>{f.initPhase=l.DashboardInitPhase.Failed,f.initError=E.payload,f.getModel=()=>new r.G({...s.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:f=>{f.initPhase=l.DashboardInitPhase.NotStarted,f.initError=null,f.getModel=()=>null},addPanel:(f,E)=>{},setInitialDatasource:(f,E)=>{f.initialDatasource=E.payload}}}),{dashboardInitFetching:o,dashboardInitFailed:d,dashboardInitCompleted:c,dashboardInitServices:a,cleanUpDashboard:p,addPanel:u,setInitialDatasource:m}=g.actions,x={dashboard:g.reducer}},36974:(k,A,e)=>{"use strict";e.d(A,{B1:()=>y,CW:()=>E,LH:()=>d,OK:()=>c,SD:()=>p,VF:()=>u,_u:()=>x,dH:()=>b,ko:()=>h,no:()=>v,ob:()=>a,s3:()=>m});var n=e(2543),s=e.n(n),l=e(39601),r=e(2913),i=e(15054),g=e(33390),o=e(19752);const d="Panel Title";function c(P,C){const M={type:"timeseries",title:d,gridPos:(0,o.Ft)(P),datasource:C?{uid:C}:null,isNew:!0};return P.addPanel(M),M.id}function a(P,C){const M={type:C,title:"Widget title",gridPos:(0,o.Ft)(P),datasource:null,isNew:!0};return P.addPanel(M),M.id}function p(P){const C={type:"row",title:"Row title",gridPos:{x:0,y:0}};P.addPanel(C)}function u(){l.Ny.push("/dashboard/import")}function m(P){const C={type:"add-library-panel",gridPos:(0,o.Ft)(P)};P.addPanel(C)}function v(P,C){if(!C)return;const M=(0,o.Ft)(P),I={type:C.id,title:d,gridPos:{x:M.x,y:M.y,w:C.defaults.gridPos.w,h:C.defaults.gridPos.h}};C.defaults&&((0,n.defaults)(I,C.defaults),I.title=C.defaults.title,g.A.delete(i.tH)),P.addPanel(I)}function x(){const P=(0,n.chain)(r.Ay.panels).filter({hideFromList:!1}).map(M=>M).value(),C=g.A.get(i.tH);if(C){const M=JSON.parse(C),I=(0,n.find)(P,{id:M.type});if(I){const R=(0,n.cloneDeep)(I);return R.name=M.title,R.sort=-1,{...R,defaults:{...M}}}}}const f="grafana.dashboards.panelEdit.lastUsedDatasource";function E(P){if(g.A.exists(f)){const C=g.A.getObject(f);if(C?.dashboardUid===P)return C}}function h(P){if(!g.A.exists(f))return;const M=g.A.getObject(f)?.datasourceUid??"";D(P,M)}function y(P){g.A.setObject(f,{dashboardUid:P,datasourceUid:""})}function b(P,C){const M=E(P);if(!M)D(P,C);else{const I=M?.dashboardUid??"";D(I,C)}}function D(P,C){g.A.setObject(f,{dashboardUid:P,datasourceUid:C})}},61642:(k,A,e)=>{"use strict";e.d(A,{X:()=>l});var n=e(32264),s=e(39601);function l(){if(!n.$.featureToggles.scopeFilters||!n.$.featureToggles.passScopeToDashboardApi)return;const i=s.Ny.getSearchObject().scopes??[],g=Array.isArray(i)?i:[i];return new URLSearchParams(g.map(o=>["scopes",String(o)]))}},60444:(k,A,e)=>{"use strict";e.d(A,{d:()=>a});var n=e(14236),s=e(43127),l=e(33948),r=e(39070),i=e(90708),g=e(2913),o=e(85595),d=e(74856),c=e(19752);function a(p,u){const m=(0,n.Bt)(p.snapshotData),v=new o.F,x={dashboard:u,range:(0,s.E2)()},f=v.canWork(x)?v.getAnnotationsInSnapshot(u,p.id):[],E=[(0,l.I)(f)];return{timeRange:(0,c.nk)(p,(0,d.jG)().timeRange()).timeRange,state:r.Gu.Done,series:(0,i.we)({data:m,fieldConfig:{defaults:{},overrides:[]},replaceVariables:p.replaceVariables,fieldConfigRegistry:p.plugin.fieldConfigRegistry,theme:g.config.theme2,timeZone:u.getTimezone()}),structureRev:1,annotations:E}}},19752:(k,A,e)=>{"use strict";e.d(A,{ET:()=>R,FC:()=>y,Ft:()=>O,KJ:()=>D,Mc:()=>P,ZY:()=>M,d7:()=>C,iU:()=>b,nk:()=>T});var n=e(2543),s=e.n(n),l=e(26272),r=e(65879),i=e(47232),g=e(85858),o=e(72574),d=e(28138),c=e(2913),a=e(15054),p=e(33390),u=e(1702),m=e(84423),v=e(54174),x=e(96227),f=e(79971),E=e(99140),h=e(28444);const y=(j,N,F)=>{if(F!==!1){const U=N.alert?"YES":void 0;d.A.publish(new h.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:U,yesText:"Remove",onConfirm:()=>y(j,N,!1)}));return}j.removePanel(N),(0,E.JD)((0,f.O6)(N.key))},b=(j,N)=>{j.duplicatePanel(N)},D=j=>{let N=j;j instanceof m.a9&&(N=j.getSaveModel()),p.A.set(a.tH,JSON.stringify(N)),d.A.emit(l.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},P=(j,N)=>{d.A.publish(new h.S8({component:u.ShareModal,props:{dashboard:j,panel:N}}))},C=(j,N)=>{d.A.publish(new h.S8({component:x.o,props:{panel:N,initialFolderUid:j.meta.folderUid,isOpen:!0}}))},M=j=>{d.A.publish(new h.S8({component:v.l,props:{onConfirm:()=>j.unlinkLibraryPanel(),isOpen:!0}}))},I=j=>{j.refresh()},R=j=>{const N={...j.options};N.legend.showLegend===!0?N.legend.showLegend=!1:N.legend.showLegend=!0,j.updateOptions(N)};function T(j,N){const F={timeInfo:"",timeRange:N};if(j.timeFrom){const U=(0,o.w)().replace(j.timeFrom,j.scopedVars),w=r.describeTextRange(U);if(w.invalid)return F.timeInfo="invalid time override",F;if((0,n.isString)(N.raw.from)){const B=(0,i.AN)(N.from).tz(),K=(0,i.AN)(N.to).tz(),W=g.parse(w.from,void 0,B);F.timeInfo=w.display,F.timeRange={from:W,to:g.parse(w.to,void 0,K),raw:{from:w.from,to:w.to}}}}if(j.timeShift){const U=(0,o.w)().replace(j.timeShift,j.scopedVars);if(r.describeTextRange(U).invalid)return F.timeInfo="invalid timeshift",F;const B="-"+U;F.timeInfo+=" timeshift "+B;const K=g.parseDateMath(B,F.timeRange.from,!1),W=g.parseDateMath(B,F.timeRange.to,!0);F.timeRange={from:K,to:W,raw:{from:K,to:W}}}return j.hideTimeOverride&&(F.timeInfo=""),F}function S(j){const F=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return j.maxDataPoints?j.maxDataPoints:Math.ceil(F*(j.gridPos.w/24))}function L(j,N){const F=j.plugin&&j.plugin.noPadding?0:config.theme.panelPadding*2,U=j.hasTitle()?config.theme.panelHeaderHeight:0;return N-U-F-PANEL_BORDER}function O(j){for(const F of j.panelIterator())F.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(k,A,e)=>{"use strict";e.d(A,{z:()=>l});var n=e(47232),s=e(85858);const l=(r,i)=>{const g={from:(0,n.Ar)(r.from)?(0,n.KQ)(r.from):r.from,to:(0,n.Ar)(r.to)?(0,n.KQ)(r.to):r.to},o=i?i.getTimezone():void 0;return{from:s.parse(g.from,!1,o,i?.fiscalYearStartMonth),to:s.parse(g.to,!0,o,i?.fiscalYearStartMonth),raw:g}}},16833:(k,A,e)=>{"use strict";e.d(A,{D:()=>l,d:()=>s});var n=e(7758);function s(d,c,a){const p=i(d.templating.list),u=r(d.panels);n.c.dashboardInitialized({uid:d.uid,title:d.title,theme:d.style,schemaVersion:d.schemaVersion,version_before_migration:a,panels_count:d.panels.length,...u,...p,settings_nowdelay:d.timepicker.nowDelay,settings_livenow:!!d.liveNow,duration:c,isScene:!1})}function l(d,c){const a=d.getInitialSaveModel();if(a){const p=r(a.panels||[]),u=i(a.templating?.list||[]);n.c.dashboardInitialized({uid:a.uid,title:a.title,theme:void 0,schemaVersion:a.schemaVersion,version_before_migration:a.version,panels_count:a.panels?.length||0,...p,...u,settings_nowdelay:void 0,settings_livenow:!!a.liveNow,duration:c,isScene:!0})}}function r(d){return d.map(c=>c.type).reduce((c,a)=>(c[o(a)]=1+c[o(a)]||1,c),{})}function i(d){return d.map(c=>c.type).reduce((c,a)=>(c[g(a)]=1+c[g(a)]||1,c),{})}const g=d=>`variable_type_${d}_count`,o=d=>`panel_type_${d}_count`},40489:(k,A,e)=>{"use strict";e.d(A,{ZF:()=>g,vI:()=>i,o2:()=>o});var n=e(88483),s=e(14236);function l(d){const c=new Set;return Object.keys(d).forEach(a=>{d[a].forEach(p=>{c.add(p)})}),c}function r(d){const c=Array.from(l(d));return c.length===1?c[0]:`${c.slice(0,-1).join(", ")} or ${c.slice(-1)}`}function i(d){return new n.c(c=>{let a=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(p=>{d.forEach(u=>{const m=new FileReader;m.readAsArrayBuffer(u),m.onload=()=>{const v=m.result;if(v&&v instanceof ArrayBuffer){if(u.type==="application/json"){const x=new TextDecoder("utf-8"),f=JSON.parse(x.decode(v));c.next({dataFrames:[(0,s.Vc)(f)],file:u})}else c.next({dataFrames:p.readSpreadsheet(v),file:u});++a>=d.length&&c.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const g={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},o=5e5},87455:(k,A,e)=>{"use strict";e.d(A,{r:()=>i});var n=e(74848),s=e(13544),l=e(42418);const r="This data source was added by config and cannot be modified using the UI. Please contact your server admin to update this data source.";function i(){return(0,n.jsx)(l.F,{"data-testid":s.Tp.pages.DataSource.readOnly,severity:"info",title:"Provisioned data source",children:r})}},32738:(k,A,e)=>{"use strict";e.d(A,{r:()=>d});var n=e(74848),s=e(71733),l=e(55852),r=e(10096),i=e(8484),g=e(6320),o=e(31678);function d({variant:c,onClick:a}){const p=r.contextSrv.hasPermission(o.AccessControlAction.DataSourcesCreate),u=s.I.assureBaseUrl(g.b.DataSourcesNew);return(0,n.jsx)(l.z9,{variant:c||"primary",href:u,disabled:!p,tooltip:p?void 0:"You do not have permission to configure new data sources",onClick:a,target:"_blank",children:(0,n.jsx)(i.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},2221:(k,A,e)=>{"use strict";e.d(A,{A:()=>g});var n=e(74848),s=e(32196),l=e(40845),r=e(10860),i=e(64149);function g({ds:d,onClick:c,selected:a,description:p,...u}){const m=(0,l.$j)(),v=o(m,d.meta.builtIn);return(0,n.jsxs)(r.Z,{onClick:c,className:(0,s.cx)(v.card,a?v.selected:void 0),...u,children:[(0,n.jsx)(r.Z.Heading,{className:v.heading,children:(0,n.jsxs)("div",{className:v.headingContent,children:[(0,n.jsxs)("span",{className:v.name,children:[d.name," ",d.isDefault?(0,n.jsx)(i.L,{tags:["default"]}):null]}),(0,n.jsx)("small",{className:v.type,children:p||d.meta.name})]})}),(0,n.jsx)(r.Z.Figure,{className:v.logo,children:(0,n.jsx)("img",{src:d.meta.info.logos.small,alt:`${d.meta.name} Logo`})})]},d.uid)}function o(d,c=!1){return{card:(0,s.css)`
      cursor: pointer;
      background-color: ${d.colors.background.primary};
      border-bottom: 1px solid ${d.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${d.spacing(1)};
    `,heading:(0,s.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,s.css)`
      color: ${d.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,s.css)`
      width: 32px;
      height: 32px;
      padding: ${d.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${c&&d.isLight?1:0});
      }
    `,name:(0,s.css)`
      color: ${d.colors.text.primary};
      display: flex;
      gap: ${d.spacing(2)};
    `,type:(0,s.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,s.css)`
      margin: 0 ${d.spacing(1)};
      color: ${d.colors.border.weak};
    `,selected:(0,s.css)`
      background-color: ${d.colors.background.secondary};
    `,meta:(0,s.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(k,A,e)=>{"use strict";e.d(A,{S:()=>u});var n=e(74848),s=e(32196),l=e(96540),r=e(13544),i=e(72574),g=e(40845),o=e(8484),d=e(87282),c=e(32738),a=e(2221),p=e(47311);function u(E){const h=(0,l.useRef)(null),[y,b]=(0,d.dR)({keyboardEvents:E.keyboardEvents,containerRef:h}),D=(0,g.$j)(),P=f(D,b),{className:C,current:M,onChange:I,enableKeyboardNavigation:R,onClickEmptyStateCTA:T}=E,S=(0,d.Kr)({alerting:E.alerting,annotations:E.annotations,dashboard:E.dashboard,logs:E.logs,metrics:E.metrics,mixed:E.mixed,pluginId:E.pluginId,tracing:E.tracing,type:E.type,variables:E.variables}),[L,O]=(0,d.TX)(),j=E.filter?S.filter(E.filter):S;return(0,n.jsxs)("div",{ref:h,className:(0,s.cx)(C,P.container),"data-testid":r.Tp.components.DataSourcePicker.dataSourceList,children:[j.length===0&&(0,n.jsx)(m,{className:P.emptyState,onClickCTA:T}),j.sort((0,p.Tj)(M,L,x())).map(N=>(0,n.jsx)(a.A,{"data-testid":"data-source-card",ds:N,onClick:()=>{O(N),I(N)},selected:(0,p.Df)(N,M),...R?y:{}},N.uid))]})}function m({className:E,onClickCTA:h}){const y=(0,g.of)(v);return(0,n.jsxs)("div",{className:(0,s.cx)(E,y.container),children:[(0,n.jsx)("p",{className:y.message,children:(0,n.jsx)(o.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,n.jsx)(c.r,{onClick:h})]})}function v(E){return{container:(0,s.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,s.css)`
      margin-bottom: ${E.spacing(3)};
    `}}function x(){return(0,i.w)().getVariables().filter(h=>h.type==="datasource").map(h=>`\${${h.id}}`)}function f(E,h){return{container:(0,s.css)`
      display: flex;
      flex-direction: column;
      ${h} {
        background-color: ${E.colors.background.secondary};
      }
    `,emptyState:(0,s.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(k,A,e)=>{"use strict";e.d(A,{p:()=>R});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(14110),g=e(32264),o=e(40845),d=e(37390),c=e(10354),a=e(14578),p=e(40276),u=e(37270),m=e(8484),v=e(40489),x=e(90478),f=e(87282),E=e(32738),h=e(13544),y=e(2221),b=e(47311);function D(S){switch(S){case"grafana":return(0,m.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,m.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,m.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function P({className:S,current:L,onChange:O,tracing:j,dashboard:N,mixed:F,metrics:U,type:w,annotations:B,variables:K,alerting:W,pluginId:z,logs:Y,filter:X}){const G=(0,f.Kr)({tracing:j,dashboard:N,mixed:F,metrics:U,type:w,annotations:B,variables:K,alerting:W,pluginId:z,logs:Y}).filter(te=>(X?X?.(te):!0)&&!!te.meta.builtIn);return(0,n.jsx)("div",{className:S,"data-testid":h.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:G.map(te=>(0,n.jsx)(y.A,{ds:te,description:D(te.uid),selected:(0,b.Df)(te,L),onClick:()=>O(te)},te.uid))})}var C=e(11219);const M="dashboards_dspickermodal_clicked",I={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function R({tracing:S,dashboard:L,mixed:O,metrics:j,type:N,annotations:F,variables:U,alerting:w,pluginId:B,logs:K,uploadFile:W,filter:z,onChange:Y,current:X,onDismiss:q,reportedInteractionFrom:G}){const te=(0,o.of)(T),[H,se]=(0,r.useState)(""),ne=G||"modal",le=()=>{q(),(0,i.rR)(M,{item:I.DISMISS,src:ne})},_=ee=>{Y(ee),(0,i.rR)(M,{item:I.SELECT_DS,ds_type:ee.type,src:ne})},Q=(0,r.useMemo)(()=>(0,l.once)(()=>{(0,i.rR)(M,{item:"search",src:ne})}),[ne]),ae=(0,f.ps)("-- Grafana --"),oe=(0,x.j)((ee,de)=>{ae&&(Y(ae,[ee]),(0,i.rR)(M,{item:I.UPLOAD_FILE,src:ne}),de.length<1&&q())}),J=({className:ee})=>(0,n.jsx)(P,{className:ee,onChange:_,current:X,filter:z,variables:U,tracing:S,metrics:j,type:N,annotations:F,alerting:w,pluginId:B,logs:K,dashboard:L,mixed:O});return(0,n.jsxs)(d.a,{title:(0,m.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:te.modal,contentClassName:te.modalContent,onClickBackdrop:le,onDismiss:le,children:[(0,n.jsxs)("div",{className:te.leftColumn,children:[(0,n.jsx)(c.p,{type:"search",autoFocus:!0,className:te.searchInput,value:H,prefix:(0,n.jsx)(a.I,{name:"search"}),placeholder:(0,m.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:ee=>{se(ee.currentTarget.value),Q()}}),(0,n.jsxs)(p.E,{children:[(0,n.jsx)(C.S,{onChange:_,current:X,onClickEmptyStateCTA:()=>(0,i.rR)(M,{item:I.CONFIG_NEW_DS_EMPTY_STATE,src:ne}),filter:ee=>(z?z?.(ee):!0)&&(0,b.Zn)(ee,H)&&!ee.meta.builtIn,variables:U,tracing:S,metrics:j,type:N,annotations:F,alerting:w,pluginId:B,logs:K,dashboard:L,mixed:O}),(0,n.jsx)(J,{className:te.appendBuiltInDataSourcesList})]})]}),(0,n.jsxs)("div",{className:te.rightColumn,children:[(0,n.jsxs)("div",{className:te.builtInDataSources,children:[(0,n.jsx)(p.E,{className:te.builtInDataSourcesList,children:(0,n.jsx)(J,{})}),W&&g.$.featureToggles.editPanelCSVDragAndDrop&&(0,n.jsx)(u.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:v.o2,multiple:!1,accept:v.ZF,onDrop:oe},children:(0,n.jsx)(u.wI,{})})]}),(0,n.jsxs)("div",{className:te.newDSSection,children:[(0,n.jsx)("span",{className:te.newDSDescription,children:(0,n.jsx)(m.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,n.jsx)(E.r,{variant:"secondary",onClick:()=>{(0,i.rR)(M,{item:I.CONFIG_NEW_DS,src:ne}),q()}})]})]})]})}function T(S){return{modal:(0,s.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${S.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,s.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${S.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,s.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${S.spacing(4)};
      border-right: 1px solid ${S.colors.border.weak};

      ${S.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,s.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${S.spacing(4)};

      ${S.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,s.css)`
      flex: 1 1;
      margin-bottom: ${S.spacing(4)};

      ${S.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,s.css)`
      ${S.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${S.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,s.css)`
      ${S.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,s.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,s.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${S.colors.text.secondary};
    `,searchInput:(0,s.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${S.spacing(1)};
    `}}},51612:(k,A,e)=>{"use strict";e.d(A,{s:()=>N});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(18828),o=e(85690),d=e(93225),c=e(96540),a=e(13544),p=e(14110),u=e(40845),m=e(10354),v=e(14578),x=e(17464),f=e(40276),E=e(71678),h=e(55852),y=e(2913),b=e(8484),D=e(97427),P=e(68706),C=e(87282),M=e(11219);function I(W){const{dataSource:z}=W,Y=(0,u.$j)(),X=T(Y,z?.meta.builtIn);return z?(0,n.jsx)("img",{className:X.pickerDSLogo,alt:`${z.meta.name} logo`,src:z.meta.info.logos.small}):R()}function R(){const W=(0,u.of)(T);return(0,n.jsx)("div",{className:W.pickerDSLogo})}function T(W,z=!1){return{pickerDSLogo:(0,s.css)`
      height: 20px;
      width: 20px;
      filter: invert(${z&&W.isLight?1:0});
    `}}var S=e(50481),L=e(47311);const O="dashboards_dspicker_clicked",j={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function N(W){const{current:z,onChange:Y,hideTextValue:X=!1,width:q,inputId:G,noDefault:te=!1,disabled:H=!1,placeholder:se="Select data source",...ne}=W,le=(0,u.of)(F,W),[_,Q]=(0,c.useState)(!1),[ae,oe]=(0,c.useState)(!1),[J,ee]=(0,c.useState)(""),{onKeyDown:de,keyboardEvents:xe}=(0,D.d)(),re=(0,c.useRef)(null),[ue,Te]=(0,c.useState)(),[ge,Oe]=(0,c.useState)(),Ue=(0,C.ps)(z),Xe=(0,C.ps)("-- Grafana --"),we=!z&&te?void 0:Ue,qe=J&&_?(0,n.jsx)(R,{}):(0,n.jsx)(I,{dataSource:we}),We=[(0,l.cY)(4),(0,l.Ej)({apply({availableHeight:Se,elements:fe}){fe.floating.style.maxHeight=`${Math.max(200,Se-20)}px`,fe.floating.style.minHeight="200px"}}),(0,l.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,l.BN)()],{refs:Ce,floatingStyles:je}=(0,r.we)({open:_,placement:"bottom-start",onOpenChange:Q,middleware:We,whileElementsMounted:i.ll,strategy:"fixed"}),Ke=(0,c.useCallback)(Se=>{Ce.setReference(Se),Te(Se)},[Ce]),_e=(0,c.useCallback)(()=>{ee(""),Q(!1),ue?.focus()},[Q,ue]),{overlayProps:Fe,underlayProps:at}=(0,d.e)({onClose:_e,isDismissable:!0,isOpen:_,shouldCloseOnInteractOutside:Se=>ue?!ue.isSameNode(Se):!1},re),{dialogProps:Ct}=(0,g.s)({"aria-label":"Opened data source picker list"},re);function Dt(){(0,p.rR)(O,{item:j.OPEN_DROPDOWN}),Q(!0),ue?.focus()}function tt(){Xe&&Y(Xe,[P.dx])}function ze(Se){Se.key==="Tab"&&!Se.shiftKey&&_&&(Se.preventDefault(),ge?.focus()),Se.key==="Tab"&&Se.shiftKey&&_&&_e(),de(Se)}function pe(Se){Se.shiftKey?(Se.preventDefault(),ue?.focus()):_e()}return(0,c.useEffect)(()=>{const Se=xe.subscribe({next:fe=>{switch(fe?.code){case"ArrowDown":Dt(),fe.preventDefault();break;case"ArrowUp":Dt(),fe.preventDefault();break;case"Escape":_e(),fe.preventDefault();break}}});return()=>Se.unsubscribe()}),(0,n.jsxs)("div",{className:le.container,"data-testid":a.Tp.components.DataSourcePicker.container,children:[(0,n.jsx)("div",{className:le.trigger,onClick:Dt,children:(0,n.jsx)(m.p,{id:G||"data-source-picker",className:ae?void 0:le.input,"data-testid":a.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:we?qe:void 0,suffix:(0,n.jsx)(v.I,{name:_?"search":"angle-down"}),placeholder:X?"":(0,L.q7)(we)||se,onFocus:()=>{oe(!0)},onBlur:()=>{oe(!1)},onKeyDown:ze,value:J,onChange:Se=>{Dt(),ee(Se.currentTarget.value)},ref:Ke,disabled:H})}),_?(0,n.jsxs)(x.ZL,{children:[(0,n.jsx)("div",{...at}),(0,n.jsx)("div",{ref:re,...Fe,...Ct,children:(0,n.jsx)(U,{...ne,style:je,ref:Ce.setFloating,footerRef:Oe,current:we,filterTerm:J,keyboardEvents:xe,onChange:(Se,fe)=>{_e(),Se.uid!==we?.uid&&(Y(Se,fe),(0,p.rR)(O,{item:j.SELECT_DS,ds_type:Se.type}))},onClose:_e,onClickAddCSV:tt,onDismiss:_e,onNavigateOutsiteFooter:pe})})]}):null]})}function F(W,z){return{container:(0,s.css)({position:"relative",cursor:z.disabled?"not-allowed":"pointer",width:W.spacing(z.width||"auto")}),trigger:(0,s.css)({cursor:"pointer",pointerEvents:z.disabled?"none":"auto"}),input:(0,s.css)({"input::placeholder":{color:z.disabled?W.colors.action.disabledText:W.colors.text.primary}})}}const U=c.forwardRef((W,z)=>{const{filterTerm:Y,onChange:X,onClose:q,onClickAddCSV:G,current:te,filter:H}=W,se=(0,c.useCallback)(_=>{X(_)},[X]),ne=(0,c.useCallback)(()=>{G?.(),q(),(0,p.rR)(O,{item:j.ADD_FILE})},[G,q]),le=(0,u.of)(w);return(0,n.jsxs)("div",{style:W.style,ref:z,className:le.container,children:[(0,n.jsx)(f.E,{children:(0,n.jsx)(M.S,{...W,enableKeyboardNavigation:!0,className:le.dataSourceList,current:te,onChange:se,filter:_=>(H?H?.(_):!0)&&(0,L.Zn)(_,Y),onClickEmptyStateCTA:()=>(0,p.rR)(O,{item:j.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,n.jsx)(o.n1,{children:(0,n.jsx)(B,{...W,onClickAddCSV:ne,onChange:se,onNavigateOutsiteFooter:W.onNavigateOutsiteFooter})})]})});U.displayName="PickerContent";function w(W){return{container:(0,s.css)({display:"flex",flexDirection:"column",background:W.colors.background.primary,boxShadow:W.shadows.z3}),picker:(0,s.css)({background:W.colors.background.secondary}),dataSourceList:(0,s.css)({flex:1}),footer:(0,s.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:W.spacing(1.5),borderTop:`1px solid ${W.colors.border.weak}`,backgroundColor:W.colors.background.secondary})}}function B({onClose:W,onChange:z,onClickAddCSV:Y,...X}){const q=(0,u.of)(K),G=X.uploadFile&&y.Ay.featureToggles.editPanelCSVDragAndDrop,te=se=>{se.key==="Tab"&&X.onNavigateOutsiteFooter(se)},H=se=>{se.key==="Tab"&&se.shiftKey&&X.onNavigateOutsiteFooter(se)};return(0,n.jsxs)("div",{className:q.footer,children:[(0,n.jsx)(E.$s,{children:({showModal:se,hideModal:ne})=>(0,n.jsxs)(h.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{W(),se(S.p,{reportedInteractionFrom:"ds_picker",tracing:X.tracing,dashboard:X.dashboard,mixed:X.mixed,metrics:X.metrics,type:X.type,annotations:X.annotations,variables:X.variables,alerting:X.alerting,pluginId:X.pluginId,logs:X.logs,filter:X.filter,uploadFile:X.uploadFile,current:X.current,onDismiss:ne,onChange:(le,_)=>{z(le,_),ne()}}),(0,p.rR)(O,{item:j.OPEN_ADVANCED_DS_PICKER})},ref:X.footerRef,onKeyDown:G?H:te,children:[(0,n.jsx)(b.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,n.jsx)(v.I,{name:"arrow-right"})]})}),G&&(0,n.jsx)(h.$n,{variant:"secondary",size:"sm",onClick:Y,onKeyDown:te,children:"Add csv or spreadsheet"})]})}function K(W){return{footer:(0,s.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:W.spacing(1.5),borderTop:`1px solid ${W.colors.border.weak}`,backgroundColor:W.colors.background.secondary})}}},47311:(k,A,e)=>{"use strict";e.d(A,{Df:()=>r,Tj:()=>g,Zn:()=>o,q7:()=>i,tw:()=>d});var n=e(14792),s=e(36974),l=e(14678);function r(c,a){return!c||!a?!1:typeof a=="string"?c.uid===a:c.uid===a.uid}function i(c){if(c){if(typeof c=="string")return`${c} - not found`;if("name"in c)return c.name;if(c.uid)return`${c.uid} - not found`}}function g(c,a,p){return(m,v)=>{const x=m.name.toUpperCase(),f=v.name.toUpperCase();if(c&&r(m,c))return-1;if(c&&r(v,c))return 1;const E=a.indexOf(m.uid),h=a.indexOf(v.uid);if(E>-1&&E>h)return-1;if(h>-1&&h>E)return 1;const y=p.includes(m.uid),b=p.includes(v.uid);return y&&!b?-1:b&&!y||m.meta.builtIn&&!v.meta.builtIn?1:v.meta.builtIn&&!m.meta.builtIn||x<f?-1:1}}function o(c,a=""){return c.name.toLowerCase().includes(a.toLowerCase())}function d(c){if(!c.uid)return;const a=(0,n.UA)().getCurrent()?.uid??"";if(c.uid===l.uv)return(0,s.B1)(a);(0,s.dH)(a,c.uid)}},83883:(k,A,e)=>{"use strict";e.d(A,{I:()=>n});const n={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(k,A,e)=>{"use strict";e.d(A,{Kr:()=>g,TX:()=>i,dR:()=>d,ps:()=>o});var n=e(96540),s=e(78685),l=e(19347);const r="grafana.features.datasources.components.picker.DataSourceDropDown.history";function i(){const[c=[],a]=(0,s.A)(r,[]),p=(0,n.useCallback)(u=>{u.meta.builtIn||(c.includes(u.uid)?(c.splice(c.findIndex(m=>u.uid===m),1),a([...c,u.uid])):a([...c,u.uid].slice(1,6)))},[c,a]);return[c,p]}function g(c){return(0,l.l)().getList(c)}function o(c){const a=(0,l.l)();return a.getInstanceSettings(c)}function d(c){const{keyboardEvents:a,containerRef:p}=c,u=(0,n.useRef)(0),m="data-role",v="keyboardSelectableItem",x={[m]:v},f=`[${m}="${v}"`,E="data-selectedItem",h=`[${E}="true"]`,y=(0,n.useCallback)(D=>{const P=p?.current?.querySelectorAll(f),C=P?.item(D%P?.length);P?.forEach(M=>M.setAttribute(E,"false")),C&&(C.scrollIntoView({block:"center"}),C.setAttribute(E,"true"))},[p,f]),b=(0,n.useCallback)(()=>{p?.current?.querySelector(h)?.querySelector("button")?.click()},[p,h]);return(0,n.useEffect)(()=>{if(!a)return;const D=a.subscribe({next:P=>{switch(P?.code){case"ArrowDown":{y(++u.current),P.preventDefault();break}case"ArrowUp":u.current=u.current>0?u.current-1:u.current,y(u.current),P.preventDefault();break;case"Enter":b();break}}});return()=>D.unsubscribe()},[a,y,b]),(0,n.useEffect)(()=>{const D=new MutationObserver(P=>{P.some(M=>M.addedNodes&&M.addedNodes.length>0||M.removedNodes&&M.removedNodes.length>0)&&y(0)});return p.current&&D.observe(p.current,{childList:!0}),()=>{D.disconnect()}},[p,f,y]),[x,h]}},34258:(k,A,e)=>{"use strict";e.d(A,{du:()=>H,Qq:()=>_,PK:()=>Y,ak:()=>G,xI:()=>te,G2:()=>se,bn:()=>q,Ge:()=>X,jB:()=>le});var n=e(69129),s=e(71733),l=e(26657),r=e(17172),i=e(32264),g=e(39601),o=e(82467),d=e(10096),c=e(27677),a=e(2468),p=e(6320),u=e(31193),m=e(27716),v=e(685),x=e(31678),f=e(75505),E=e(80714);const h=async()=>await(0,c.AI)().get("/api/datasources"),y=async Q=>{const ae=await(0,f.s)((0,c.AI)().fetch({method:"GET",url:`/api/datasources/${Q}`,params:(0,E.F)(),showErrorAlert:!1}));if(ae.ok)return ae.data;throw Error(`Could not find data source by ID: "${Q}"`)},b=async Q=>{const ae=await(0,f.s)((0,c.AI)().fetch({method:"GET",url:`/api/datasources/uid/${Q}`,params:(0,E.F)(),showErrorAlert:!1}));if(ae.ok)return ae.data;throw Error(`Could not find data source by UID: "${Q}"`)},D=async Q=>{try{return await b(Q)}catch{console.log(`Failed to lookup data source using UID "${Q}"`)}try{return await y(Q)}catch{console.log(`Failed to lookup data source using ID "${Q}"`)}throw Error("Could not find data source")},P=Q=>(0,c.AI)().post("/api/datasources",Q),C=()=>(0,c.AI)().get("/api/plugins",{enabled:1,type:"datasource"}),M=Q=>(0,c.AI)().put(`/api/datasources/uid/${Q.uid}`,Q,{showErrorAlert:!1,showSuccessAlert:!1}),I=Q=>(0,c.AI)().delete(`/api/datasources/uid/${Q}`);var R=e(83883),T=e(4589),S=e(43429),L=e(33378);function O(Q){const ae=[{id:"tsdb",title:"Time series databases",plugins:[]},{id:"logging",title:"Logging & document databases",plugins:[]},{id:"tracing",title:"Distributed tracing",plugins:[]},{id:"profiling",title:"Profiling",plugins:[]},{id:"sql",title:"SQL",plugins:[]},{id:"cloud",title:"Cloud",plugins:[]},{id:"enterprise",title:"Enterprise plugins",plugins:[]},{id:"iot",title:"Industrial & IoT",plugins:[]},{id:"other",title:"Others",plugins:[]}].filter(de=>de),oe={},J={},ee=N();for(const de of ae)oe[de.id]=de;for(const de of Q){const xe=ee.find(ue=>ue.id===de.id);if((de.enterprise||xe)&&(de.category="enterprise",de.unlicensed=!(0,L.a)("enterprise.plugins"),de.info.links=xe?.info?.links||de.info.links),de.info.links)for(const ue of de.info.links)ue.name="Learn more";(ae.find(ue=>ue.id===de.category)||oe.other).plugins.push(de),J[de.id]=de}for(const de of ae){if(de.id==="cloud"&&de.plugins.push(F()),de.id==="enterprise")for(const xe of ee)J[xe.id]||de.plugins.push(xe);j(de.plugins)}return ae.filter(de=>de.plugins.length>0)}function j(Q){const ae={prometheus:100,graphite:95,loki:90,mysql:80,jaeger:100,postgres:79,gcloud:-1};Q.sort((oe,J)=>{const ee=ae[oe.id]||0,de=ae[J.id]||0;return ee>de?-1:ee<de||oe.name>J.name?1:-1})}function N(){return[U({id:"grafana-splunk-datasource",name:"Splunk",description:"Visualize and explore Splunk logs",imgUrl:"public/img/plugins/splunk_logo_128.png"}),U({id:"grafana-oracle-datasource",name:"Oracle",description:"Visualize and explore Oracle SQL",imgUrl:"public/img/plugins/oracle.png"}),U({id:"grafana-dynatrace-datasource",name:"Dynatrace",description:"Visualize and explore Dynatrace data",imgUrl:"public/img/plugins/dynatrace.png"}),U({id:"grafana-servicenow-datasource",description:"ServiceNow integration and data source",name:"ServiceNow",imgUrl:"public/img/plugins/servicenow.svg"}),U({id:"grafana-datadog-datasource",description:"DataDog integration and data source",name:"DataDog",imgUrl:"public/img/plugins/datadog.png"}),U({id:"grafana-newrelic-datasource",description:"New Relic integration and data source",name:"New Relic",imgUrl:"public/img/plugins/newrelic.svg"}),U({id:"grafana-mongodb-datasource",description:"MongoDB integration and data source",name:"MongoDB",imgUrl:"public/img/plugins/mongodb.svg"}),U({id:"grafana-snowflake-datasource",description:"Snowflake integration and data source",name:"Snowflake",imgUrl:"public/img/plugins/snowflake.svg"}),U({id:"grafana-wavefront-datasource",description:"Wavefront integration and data source",name:"Wavefront",imgUrl:"public/img/plugins/wavefront.svg"}),U({id:"dlopes7-appdynamics-datasource",description:"AppDynamics integration and data source",name:"AppDynamics",imgUrl:"public/img/plugins/appdynamics.svg"}),U({id:"grafana-saphana-datasource",description:"SAP HANA\xAE integration and data source",name:"SAP HANA\xAE",imgUrl:"public/img/plugins/sap_hana.png"}),U({id:"grafana-honeycomb-datasource",description:"Honeycomb integration and datasource",name:"Honeycomb",imgUrl:"public/img/plugins/honeycomb.png"}),U({id:"grafana-salesforce-datasource",description:"Salesforce integration and datasource",name:"Salesforce",imgUrl:"public/img/plugins/salesforce.svg"}),U({id:"grafana-jira-datasource",description:"Jira integration and datasource",name:"Jira",imgUrl:"public/img/plugins/jira_logo.png"}),U({id:"grafana-gitlab-datasource",description:"GitLab integration and datasource",name:"GitLab",imgUrl:"public/img/plugins/gitlab.svg"}),U({id:"grafana-splunk-monitoring-datasource",description:"SignalFx integration and datasource",name:"Splunk Infrastructure Monitoring",imgUrl:"public/img/plugins/signalfx-logo.svg"}),U({id:"grafana-azuredevops-datasource",description:"Azure Devops datasource",name:"Azure Devops",imgUrl:"public/img/plugins/azure-devops.png"}),U({id:"grafana-sumologic-datasource",description:"SumoLogic integration and datasource",name:"SumoLogic",imgUrl:"public/img/plugins/sumo.svg"}),U({id:"grafana-pagerduty-datasource",description:"PagerDuty datasource",name:"PagerDuty",imgUrl:"public/img/plugins/pagerduty.svg"}),U({id:"grafana-catchpoint-datasource",description:"Catchpoint datasource",name:"Catchpoint",imgUrl:"public/img/plugins/catchpoint.svg"}),U({id:"grafana-azurecosmosdb-datasource",description:"Azure CosmosDB datasource",name:"Azure CosmosDB",imgUrl:"public/img/plugins/azure-cosmosdb.svg"}),U({id:"grafana-adobeanalytics-datasource",description:"Adobe Analytics datasource",name:"Adobe Analytics",imgUrl:"public/img/plugins/adobe-analytics.svg"}),U({id:"grafana-cloudflare-datasource",description:"Cloudflare datasource",name:"Cloudflare",imgUrl:"public/img/plugins/cloudflare.jpg"}),U({id:"grafana-cockroachdb-datasource",description:"CockroachDB datasource",name:"CockroachDB",imgUrl:"public/img/plugins/cockroachdb.jpg"}),U({id:"grafana-netlify-datasource",description:"Netlify datasource",name:"Netlify",imgUrl:"public/img/plugins/netlify.svg"}),U({id:"grafana-drone-datasource",description:"Drone datasource",name:"Drone",imgUrl:"public/img/plugins/drone.svg"}),U({id:"grafana-atlassianstatuspage-datasource",description:"Atlassian Statuspage datasource",name:"Atlassian Statuspage",imgUrl:"public/img/plugins/atlassian-statuspage.svg"})]}function F(){return{id:"gcloud",name:"Grafana Cloud",type:S.QE.datasource,module:"phantom",baseUrl:"",info:{description:"Hosted Graphite, Prometheus, and Loki",logos:{small:"public/img/grafana_icon.svg",large:"asd"},author:{name:"Grafana Labs"},links:[{url:"https://grafana.com/products/cloud/",name:"Learn more"}],screenshots:[],updated:"2019-05-10",version:"1.0.0"}}}function U(Q){return{id:Q.id,name:Q.name,type:S.QE.datasource,module:"phantom",baseUrl:"",info:{description:Q.description,logos:{small:Q.imgUrl,large:Q.imgUrl},author:{name:"Grafana Labs"},links:[{url:"/plugins/"+Q.id,name:"Install now",target:"_self"}],screenshots:[],updated:"2019-05-10",version:"1.0.0"}}}var w=e(74984),B=e(36227),K=e(54226);const W=Q=>{let ae,oe;return Q.error&&Q.error instanceof l.b1?(ae=Q.error.message,oe=Q.error.details):(0,r.NF)(Q)?ae=Q.data.message??`HTTP error ${Q.statusText}`:Q instanceof Error&&(ae=Q.message),{message:ae,details:oe}},z=Q=>{const{details:ae,message:oe,status:J}=Q;return{status:J,message:oe,details:ae}},Y=(Q,ae={loadDataSource:G,loadDataSourceMeta:te,getDataSource:K.U4,getDataSourceMeta:K.Fj,importDataSourcePlugin:v.cS})=>async(oe,J)=>{if(!Q){oe((0,B.qR)(new Error("Invalid UID")));return}try{const ee=await oe(ae.loadDataSource(Q));await oe(ae.loadDataSourceMeta(ee));const de=ae.getDataSource(J().dataSources,Q),xe=ae.getDataSourceMeta(J().dataSources,de.type),re=await ae.importDataSourcePlugin(xe);oe((0,B.Ks)(re))}catch(ee){ee instanceof Error&&oe((0,B.qR)(ee))}},X=(Q,ae=R.I.Edit,oe={getDatasourceSrv:u.tR,getBackendSrv:c.AI})=>async(J,ee)=>{const de=await oe.getDatasourceSrv().get(Q),xe=ae.replace(/:uid/gi,Q);de.testDatasource&&(J((0,B.QZ)()),oe.getBackendSrv().withNoBackendCache(async()=>{try{const re=await de.testDatasource(),ue=z({...re,details:{...re.details}});J((0,B.lg)(ue)),(0,T.Mh)({grafana_version:i.$.buildInfo.version,plugin_id:de.type,datasource_uid:de.uid,success:!0,path:xe}),d.lE.publish(new n.NI)}catch(re){const ue=W(re);J((0,B.UP)({...ue})),(0,T.Mh)({grafana_version:i.$.buildInfo.version,plugin_id:de.type,datasource_uid:de.uid,success:!1,path:xe}),d.lE.publish(new n.LL)}}))};function q(){return async Q=>{if(!d.contextSrv.hasPermission(x.AccessControlAction.DataSourcesRead))return;Q((0,B.TN)());const ae=await h();Q((0,B.E1)(ae))}}function G(Q){return async ae=>{let oe=await D(Q);return Q!==oe.uid&&(window.location.href=s.I.assureBaseUrl(`/datasources/edit/${oe.uid}`),oe={}),ae((0,B.jz)(oe)),oe}}function te(Q){return async ae=>{const oe=await(0,m.x)(Q.type),J=await(0,v.cS)(oe),ee=J.DataSourceClass.prototype instanceof l.iy,de={...oe,isBackend:oe.backend||ee};ae((0,B.gZ)(de)),J.meta=de,ae((0,o.Vz)((0,w.R4)(Q,J)))}}function H(Q,ae=R.I.Edit){return async()=>{const oe={type:Q.id,access:"proxy"},J=await P(oe),ee=ae.replace(/:uid/gi,J.datasource.uid);await(0,u.tR)().reload(),await d.contextSrv.fetchUserPermissions(),(0,T.V9)({grafana_version:i.$.buildInfo.version,plugin_id:Q.id,datasource_uid:J.datasource.uid,plugin_version:J.meta?.info?.version,path:ee}),g.Ny.push(ee)}}function se(){return async Q=>{Q((0,B.Gc)());const ae=await C(),oe=O(ae);Q((0,B.f$)({plugins:ae,categories:oe}))}}const ne=new a.H;function le(Q){return async ae=>{try{i.$.featureToggles.grafanaAPIServerWithExperimentalAPIs&&(Q.apiVersion=await ne.get(Q.type)),await M(Q)}catch(oe){const J=W(oe);ae((0,B.UP)(J));const ee=(0,r.NF)(oe)?oe.data:{message:"An unexpected error occurred.",traceID:""};return Promise.reject(ee)}return await(0,u.tR)().reload(),ae(G(Q.uid))}}function _(){return async(Q,ae)=>{const{uid:oe}=ae().dataSources.dataSource;try{await I(oe),await(0,u.tR)().reload();const J=p.b.DataSources;g.Ny.push(J)}catch(J){const ee=W(J);Q((0,B.UP)(ee))}}}},458:(k,A,e)=>{"use strict";e.d(A,{C:()=>l});var n=e(96540),s=e(83883);const l=(0,n.createContext)(s.I)},11084:(k,A,e)=>{"use strict";e.d(A,{$k:()=>y,BY:()=>m,S4:()=>P,Tn:()=>D,US:()=>v,Um:()=>E,_e:()=>C,aM:()=>I,hx:()=>f,k9:()=>h,oU:()=>u,u1:()=>M,xw:()=>b});var n=e(96540),s=e(97007),l=e(28138),r=e(10096),i=e(31678),g=e(28444),o=e(11959),d=e(34258),c=e(458),a=e(36227),p=e(54226);const u=R=>{const T=(0,i.useDispatch)();(0,n.useEffect)(()=>(T((0,d.PK)(R)),function(){T((0,s.N)({cleanupAction:L=>L.dataSourceSettings=a.IJ}))}),[R,T])},m=R=>{const T=(0,i.useDispatch)(),S=I();return()=>T((0,d.Ge)(R,S.Edit))},v=()=>{const R=(0,i.useDispatch)(),T=(0,i.useSelector)(L=>L.dataSources.isLoadingDataSources),S=(0,i.useSelector)(L=>L.dataSources.dataSources);return(0,n.useEffect)(()=>{R((0,d.bn)())},[R]),{isLoading:T,dataSources:S}},x=R=>{const T=useDispatch();useEffect(()=>{T(loadDataSource(R))},[T,R])},f=()=>{const R=(0,i.useDispatch)();(0,n.useEffect)(()=>{R((0,d.G2)())},[R])},E=()=>{const R=(0,i.useDispatch)(),T=I();return S=>{R((0,d.du)(S,T.Edit))}},h=()=>{const R=(0,i.useDispatch)();return async T=>R((0,d.jB)(T))},y=()=>{const R=(0,i.useDispatch)(),{name:T}=(0,i.useSelector)(S=>S.dataSources.dataSource);return()=>{l.A.publish(new g.bY({title:"Delete",text:`Are you sure you want to delete the "${T}" data source?`,yesText:"Delete",icon:"trash-alt",onConfirm:()=>R((0,d.Qq)())}))}},b=R=>(0,i.useSelector)(T=>(0,p.U4)(T.dataSources,R)),D=R=>{const T=b(R);return(0,o.h)(T)},P=R=>(0,i.useSelector)(T=>(0,p.Fj)(T.dataSources,R)),C=()=>(0,i.useSelector)(R=>R.dataSourceSettings),M=R=>{const T=b(R),S=T.readOnly===!0,L=r.contextSrv.hasPermissionInMetadata(i.AccessControlAction.DataSourcesWrite,T),O=r.contextSrv.hasPermissionInMetadata(i.AccessControlAction.DataSourcesDelete,T);return{readOnly:S,hasWriteRights:L,hasDeleteRights:O}},I=()=>(0,n.useContext)(c.C)},85464:(k,A,e)=>{"use strict";e.d(A,{$k:()=>l.$k,$m:()=>r.$m,BY:()=>l.BY,Bs:()=>i.Bs,CR:()=>s.C,C_:()=>i.C_,S4:()=>l.S4,Tk:()=>i.Tk,Tn:()=>l.Tn,US:()=>l.US,Um:()=>l.Um,_e:()=>l._e,aM:()=>l.aM,du:()=>n.du,eB:()=>i.eB,hp:()=>g.hp,hx:()=>l.hx,jz:()=>i.jz,k9:()=>l.k9,lv:()=>g.lv,oU:()=>l.oU,rb:()=>i.rb,u1:()=>l.u1,wC:()=>g.wC,xs:()=>g.xs,xw:()=>l.xw,zC:()=>g.zC});var n=e(34258),s=e(458),l=e(11084),r=e(74984),i=e(36227),g=e(54226)},74984:(k,A,e)=>{"use strict";e.d(A,{$m:()=>p,R4:()=>c,Vh:()=>a});var n=e(43429),s=e(33378),l=e(76323),r=e(2913),i=e(10096),g=e(35538),o=e(31678);const d="Loading";function c(m,v){const x=v.meta,f=r.Ay.featureToggles.featureHighlights,E={img:x.info.logos.large,id:"datasource-"+m.uid,url:"",text:m.name,children:[{active:!1,icon:"sliders-v-alt",id:`datasource-settings-${m.uid}`,text:"Settings",url:`datasources/edit/${m.uid}/`}]};if(v.configPages)for(const C of v.configPages)E.children.push({active:!1,text:C.title,icon:C.icon,url:`datasources/edit/${m.uid}/?page=${C.id}`,id:`datasource-page-${C.id}`});x.includes&&u(x.includes)&&i.contextSrv.hasRole("Admin")&&E.children.push({active:!1,icon:"apps",id:`datasource-dashboards-${m.uid}`,text:"Dashboards",url:`datasources/edit/${m.uid}/dashboards`});const h=m.type===d,y="feature-highlights-data-source-permissions-badge",b={active:!1,icon:"lock",id:`datasource-permissions-${m.uid}`,text:"Permissions",url:`datasources/edit/${m.uid}/permissions`};if((0,g.z5)()&&!h&&(b.tabSuffix=()=>(0,l.J)({experimentId:y,eventVariant:"trial"})),(0,s.a)("dspermissions.enforcement")?i.contextSrv.hasPermissionInMetadata(o.AccessControlAction.DataSourcesPermissionsRead,m)&&E.children.push(b):f&&!h&&E.children.push({...b,url:b.url+"/upgrade",tabSuffix:()=>(0,l.J)({experimentId:y})}),r.Ay.analytics?.enabled){const C="feature-highlights-data-source-insights-badge",M={active:!1,icon:"info-circle",id:`datasource-insights-${m.uid}`,text:"Insights",url:`datasources/edit/${m.uid}/insights`};(0,g.z5)()&&!h&&(M.tabSuffix=()=>(0,l.J)({experimentId:C,eventVariant:"trial"})),(0,s.a)("analytics")?i.contextSrv.hasPermission(o.AccessControlAction.DataSourcesInsightsRead)&&E.children.push(M):f&&!h&&E.children.push({...M,url:M.url+"/upgrade",tabSuffix:()=>(0,l.J)({experimentId:C})})}const D="feature-highlights-query-caching-badge",P={active:!1,icon:"database",id:`datasource-cache-${m.uid}`,text:"Cache",url:`datasources/edit/${m.uid}/cache`,hideFromTabs:!x.isBackend||!r.Ay.caching.enabled};return(0,g.z5)()&&!h&&(P.tabSuffix=()=>(0,l.J)({experimentId:D,eventVariant:"trial"})),(0,s.a)("caching")?i.contextSrv.hasPermissionInMetadata(o.AccessControlAction.DataSourcesCachingRead,m)&&E.children.push(P):f&&!h&&E.children.push({...P,url:P.url+"/upgrade",tabSuffix:()=>(0,l.J)({experimentId:D})}),E}function a(m,v){let x={text:""};for(const f of m.children)if(f.id.indexOf(v)>0){f.active=!0,x=f;break}return{main:m,node:x}}function p(m){const v=c({access:"",basicAuth:!1,basicAuthUser:"",withCredentials:!1,database:"",id:1,uid:"x",isDefault:!1,jsonData:{authType:"credentials",defaultRegion:"eu-west-2"},name:"Loading",orgId:1,readOnly:!1,type:d,typeName:d,typeLogoUrl:"public/img/icn-datasource.svg",url:"",user:"",secureJsonFields:{}},{meta:{id:"1",type:n.QE.datasource,name:"",info:{author:{name:"",url:""},description:"",links:[{name:"",url:""}],logos:{large:"",small:""},screenshots:[],updated:"",version:""},includes:[],module:"",baseUrl:""}});return a(v,m)}function u(m){return m.find(v=>v.type==="dashboard")!==void 0}},36227:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>M,Bs:()=>a,C_:()=>v,E1:()=>g,Gc:()=>d,IJ:()=>E,Ks:()=>h,QZ:()=>b,TN:()=>i,Tk:()=>x,UP:()=>P,eB:()=>u,f$:()=>c,gZ:()=>o,jz:()=>r,lg:()=>D,qR:()=>y,rb:()=>m});var n=e(65307),s=e(19484);const l={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:s.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},r=(0,n.VP)("dataSources/dataSourceLoaded"),i=(0,n.VP)("dataSources/dataSourcesLoad"),g=(0,n.VP)("dataSources/dataSourcesLoaded"),o=(0,n.VP)("dataSources/dataSourceMetaLoaded"),d=(0,n.VP)("dataSources/dataSourcePluginsLoad"),c=(0,n.VP)("dataSources/dataSourcePluginsLoaded"),a=(0,n.VP)("dataSources/setDataSourcesSearchQuery"),p=(0,n.VP)("dataSources/setDataSourcesLayoutMode"),u=(0,n.VP)("dataSources/setDataSourceTypeSearchQuery"),m=(0,n.VP)("dataSources/setDataSourceName"),v=(0,n.VP)("dataSources/setIsDefault"),x=(0,n.VP)("dataSources/setIsSortAscending"),f=(I=l,R)=>i.match(R)?{...I,isLoadingDataSources:!0}:g.match(R)?{...I,isLoadingDataSources:!1,dataSources:R.payload,dataSourcesCount:R.payload.length}:r.match(R)?{...I,dataSource:R.payload}:a.match(R)?{...I,searchQuery:R.payload}:p.match(R)?{...I,layoutMode:R.payload}:d.match(R)?{...I,plugins:[],isLoadingDataSourcePlugins:!0}:c.match(R)?{...I,plugins:R.payload.plugins,categories:R.payload.categories,isLoadingDataSourcePlugins:!1}:u.match(R)?{...I,dataSourceTypeSearchQuery:R.payload}:o.match(R)?{...I,dataSourceMeta:R.payload}:m.match(R)?{...I,dataSource:{...I.dataSource,name:R.payload}}:v.match(R)?{...I,dataSource:{...I.dataSource,isDefault:R.payload}}:x.match(R)?{...I,isSortAscending:R.payload}:I,E={testingStatus:{},loadError:null,loading:!0,plugin:null},h=(0,n.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),y=(0,n.VP)("dataSourceSettings/initDataSourceSettingsFailed"),b=(0,n.VP)("dataSourceSettings/testDataSourceStarting"),D=(0,n.VP)("dataSourceSettings/testDataSourceSucceeded"),P=(0,n.VP)("dataSourceSettings/testDataSourceFailed"),M={dataSources:f,dataSourceSettings:(I=E,R)=>h.match(R)?{...I,plugin:R.payload,loadError:null,loading:!1}:y.match(R)?{...I,plugin:null,loadError:R.payload.message,loading:!1}:b.match(R)?{...I,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:D.match(R)?{...I,testingStatus:{status:R.payload?.status,message:R.payload?.message,details:R.payload?.details}}:P.match(R)?{...I,testingStatus:{status:"error",message:R.payload?.message,details:R.payload?.details}}:I}},54226:(k,A,e)=>{"use strict";e.d(A,{Fj:()=>i,U4:()=>r,hp:()=>l,lv:()=>c,wC:()=>d,xs:()=>g,zC:()=>s});var n=e(41811);const s=(0,n.A)(a=>{const p=new RegExp(a.searchQuery,"i");return a.dataSources.filter(m=>p.test(m.name)||p.test(m.database)||p.test(m.type)).sort((m,v)=>a.isSortAscending?m.name.localeCompare(v.name):v.name.localeCompare(m.name))}),l=(0,n.A)(a=>{const p=new RegExp(a.dataSourceTypeSearchQuery,"i");return a.plugins.filter(u=>p.test(u.name))}),r=(a,p)=>a.dataSource.uid===p?a.dataSource:{},i=(a,p)=>a.dataSourceMeta.id===p?a.dataSourceMeta:{},g=a=>a.searchQuery,o=a=>a.layoutMode,d=a=>a.dataSourcesCount,c=a=>a.isSortAscending},4589:(k,A,e)=>{"use strict";e.d(A,{M1:()=>r,Mh:()=>l,TR:()=>i,V9:()=>s,_i:()=>o,kg:()=>g,m3:()=>d});var n=e(14110);const s=c=>{(0,n.rR)("grafana_ds_add_datasource_clicked",c)},l=c=>{(0,n.rR)("grafana_ds_test_datasource_clicked",c)},r=c=>{(0,n.rR)("grafana_ds_explore_datasource_clicked",c)},i=c=>{(0,n.rR)("grafana_ds_create_dashboard_clicked",c)},g=c=>{(0,n.rR)("grafana_ds_datasources_list_viewed",c)},o=c=>{(0,n.rR)("connections_datasources_settings_clicked",{item:c})},d=c=>{(0,n.rR)("connections_datasources_ds_configured",c)}},11959:(k,A,e)=>{"use strict";e.d(A,{h:()=>l});var n=e(76885),s=e(71733);const l=r=>{const i=JSON.stringify({datasource:r.name,context:"explore"});return n.kM.renderUrl(s.I.assureBaseUrl("/explore"),{left:i})}},38074:()=>{"use strict"},25148:(k,A,e)=>{"use strict";e.d(A,{n:()=>f});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(55852),g=e(39268),o=e(14186),d=e(10354),c=e(95868),a=e(13840),p=e(40321),u=e(47694),m=e(21813),v=e(80744),x=e(19448);const f=y=>{const{value:b,src:D,name:P,placeholder:C,onChange:M,onClear:I,mediaType:R,folderName:T,size:S,color:L,maxFiles:O}=y,j=(0,r.of)(h),N=(0,r.$j)(),F=(0,l.createRef)(),U=(0,n.jsx)(x.i,{onChange:M,value:b,mediaType:R,folderName:T,maxFiles:O});let w=D;!w&&b&&(w=(0,m.D)(b));const B=L&&{fill:N.visualization.getColorByName(L)},K=()=>b&&w?(0,n.jsx)(u.y,{src:w,className:j.icon,style:{...B}}):(0,n.jsx)(i.z9,{variant:"primary",fill:"text",size:"sm",children:"Set icon"}),W=()=>(0,n.jsx)(g.C,{children:(0,n.jsx)(o.I,{label:null,grow:!0,children:(0,n.jsx)(d.p,{value:E(D,P),placeholder:C,readOnly:!0,prefix:w&&(0,n.jsx)(u.y,{src:w,className:j.icon,style:{...B}}),suffix:(0,n.jsx)(i.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:I})})})});return(0,n.jsx)(c.I,{content:U,children:(z,Y,X)=>(0,n.jsxs)(n.Fragment,{children:[F.current&&(0,n.jsx)(a.A,{...X,referenceElement:F.current,onMouseEnter:z,onKeyDown:q=>{(0,p.Q)(q,Y)}}),(0,n.jsxs)("div",{ref:F,className:j.pointer,onClick:z,onKeyDown:q=>{q.key==="Enter"&&z()},role:"button",tabIndex:0,children:[S===v.Iy.SMALL&&K(),S===v.Iy.NORMAL&&W()]})]})})};function E(y,b){if(y?.startsWith("public/img/icons")){const D=b?.lastIndexOf(".svg")??0;if(D>0)return b.substring(0,D)}return b}const h=y=>({pointer:(0,s.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,s.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(k,A,e)=>{"use strict";e.d(A,{i:()=>w});var n=e(74848),s=e(32196),l=e(18828),r=e(85690),i=e(93225),g=e(96540),o=e(17172),d=e(40845),c=e(55852),a=e(2913),p=e(80744),u=e(88575),m=e(37270),v=e(47694);function x({secondaryText:K="Drag and drop here or browse"}){const W=(0,d.of)(E);return(0,n.jsxs)("div",{className:W.iconWrapper,children:[(0,n.jsx)("small",{className:W.small,children:K}),(0,n.jsx)(c.$n,{type:"button",icon:"upload",children:"Upload"})]})}const f=({mediaType:K,setFormData:W,setUpload:z,error:Y})=>{const X=(0,d.of)(E),[q,G]=(0,g.useState)(!1),[te,H]=(0,g.useState)(""),se=()=>(0,n.jsx)(u.D,{label:"Preview",children:(0,n.jsxs)("div",{className:X.iconPreview,children:[K===p.zu.Icon&&(0,n.jsx)(v.y,{src:te,className:X.img}),K===p.zu.Image&&(0,n.jsx)("img",{src:te,alt:"Preview of the uploaded file",className:X.img})]})}),ne=_=>{fetch(`/api/storage/delete/upload/${_.file.name}`,{method:"DELETE"}).catch(Q=>console.error("cannot delete file",Q))},le=K==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,n.jsx)(m.gH,{readAs:"readAsBinaryString",onFileRemove:ne,options:{accept:le,multiple:!1,onDrop:_=>{let Q=new FormData;Q.append("file",_[0]),H(URL.createObjectURL(_[0])),G(!0),W(Q),z(!0)}},children:Y.message!==""&&q?(0,n.jsx)("p",{children:Y.message}):q?(0,n.jsx)(se,{}):(0,n.jsx)(x,{})})};function E(K,W){return{container:(0,s.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,s.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${K.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${K.colors.border.medium};
      background-color: ${W?K.colors.background.secondary:K.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,s.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,s.css)`
      margin: ${K.spacing(2,0,1)};
    `,small:(0,s.css)`
      color: ${K.colors.text.secondary};
      margin-bottom: ${K.spacing(2)};
    `,iconContainer:(0,s.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,s.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${K.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,s.css)`
      width: 147px;
      height: 147px;
      fill: ${K.colors.text.primary};
    `}}var h=e(90182),y=e(67647),b=e(31193),D=e(70713),P=e(91793);const C=(0,g.memo)(function(W){const{columnIndex:z,rowIndex:Y,style:X,data:q}=W,{cards:G,columnCount:te,onChange:H,selected:se}=q,ne=z+Y*te,le=G[ne],_=(0,d.of)(I);return(0,n.jsx)("div",{style:X,children:le&&(0,n.jsxs)("div",{className:se===le.value?(0,s.cx)(_.card,_.selected):_.card,onClick:()=>H(le.value),onKeyDown:Q=>{Q.key==="Enter"&&H(le.value)},role:"button",tabIndex:0,children:[le.imgUrl.endsWith(".svg")?(0,n.jsx)(v.y,{src:le.imgUrl,className:_.img}):(0,n.jsx)("img",{src:le.imgUrl,alt:"",className:_.img}),(0,n.jsx)("h6",{className:_.text,children:le.label.slice(0,-4)})]},le.value)})},P.t7),M=K=>{const{onChange:W,cards:z,value:Y}=K,X=(0,d.of)(I);return(0,n.jsx)(D.Ay,{defaultWidth:680,children:({width:q,height:G})=>{const se=Math.floor(q/90),ne=Math.ceil(z.length/se);return(0,n.jsx)(P.yi,{width:q,height:G,columnCount:se,columnWidth:90,rowCount:ne,rowHeight:90,itemData:{cards:z,columnCount:se,onChange:W,selected:Y},className:X.grid,children:C})}})},I=K=>({card:(0,s.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${K.colors.action.hover};
      box-shadow: ${K.shadows.z2};
    }
  `,selected:(0,s.css)`
    border: 2px solid ${K.colors.primary.main};
    :hover {
      border-color: ${K.colors.primary.main};
    }
  `,img:(0,s.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${K.colors.text.primary};
  `,text:(0,s.css)`
    color: ${K.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,s.css)`
    border: 1px solid ${K.colors.border.medium};
  `}),R=K=>K===p.zu.Icon?[p.Iu.Icon,p.Iu.IOT,p.Iu.Marker]:[p.Iu.BG],T=(K,W)=>K.find(z=>W.startsWith(z.value))??K[0],S=K=>{const{value:W,mediaType:z,folderName:Y,newValue:X,setNewValue:q,maxFiles:G}=K,te=(0,d.of)(L),H=R(z).map(de=>({label:de,value:de})),[se,ne]=(0,g.useState)(),[le,_]=(0,g.useState)(T(H,W?.length?W:Y)),[Q,ae]=(0,g.useState)([]),[oe,J]=(0,g.useState)([]),ee=de=>{de?(de=de.toLowerCase(),J(Q.filter(xe=>xe.search.includes(de)))):J(Q)};return(0,g.useEffect)(()=>{const de=le?.value;if(de){const xe=z===p.zu.Icon?re=>re.name.endsWith(".svg"):re=>re.name.endsWith(".png")||re.name.endsWith(".gif");(0,b.tR)().get("-- Grafana --").then(re=>{re.listFiles(de,G).subscribe({next:ue=>{const Te=[];ue.forEach(ge=>{if(xe(ge)){const Oe=ge.name.lastIndexOf(".");Te.push({value:`${de}/${ge.name}`,label:ge.name,search:(Oe?ge.name.substring(0,Oe):ge.name).toLowerCase(),imgUrl:`public/${de}/${ge.name}`})}}),ae(Te),J(Te)}})})}},[z,le,G]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.D,{children:(0,n.jsx)(h.l6,{options:H,onChange:_,value:le,menuShouldPortal:!1})}),(0,n.jsx)(u.D,{children:(0,n.jsx)(y.Z,{value:se??"",placeholder:"Search",onChange:de=>{ee(de),ne(de)}})}),oe&&(0,n.jsx)("div",{className:te.cardsWrapper,children:(0,n.jsx)(M,{cards:oe,onChange:de=>q(de),value:X})})]})},L=K=>({cardsWrapper:(0,s.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var O=e(10354),j=e(60029),N=e(21813);const F=K=>{const{newValue:W,setNewValue:z,mediaType:Y}=K,X=(0,d.of)(U),q=(0,N.D)(W);let G=W?.substring(W.lastIndexOf("/")+1,W.lastIndexOf("."));return G.length>20&&(G=G.substring(0,20)+"..."),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.D,{children:(0,n.jsx)(O.p,{onChange:te=>z(te.currentTarget.value),value:W})}),(0,n.jsxs)("div",{className:X.iconContainer,children:[(0,n.jsx)(u.D,{label:"Preview",children:(0,n.jsxs)("div",{className:X.iconPreview,children:[Y===p.zu.Icon&&(0,n.jsx)(v.y,{src:q,className:X.img}),Y===p.zu.Image&&W&&(0,n.jsx)("img",{src:q,alt:"Preview of the selected URL",className:X.img})]})}),(0,n.jsx)(j.J,{children:G})]})]})},U=K=>({iconContainer:(0,s.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,s.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${K.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,s.css)`
    width: 147px;
    height: 147px;
    fill: ${K.colors.text.primary};
  `}),w=K=>{const{value:W,onChange:z,mediaType:Y,folderName:X,maxFiles:q}=K,G=(0,d.of)(B),te=()=>{z(W)},H=(0,g.createRef)(),{dialogProps:se}=(0,l.s)({},H),{overlayProps:ne}=(0,i.e)({onClose:te,isDismissable:!0,isOpen:!0},H),le=W&&W.includes("://"),[_,Q]=(0,g.useState)(W??""),[ae,oe]=(0,g.useState)(le?p.QC.URL:p.QC.Folder),[J,ee]=(0,g.useState)(new FormData),[de,xe]=(0,g.useState)(!1),[re,ue]=(0,g.useState)({message:""}),Te=we=>`${G.resourcePickerPopoverTab} ${ae===we&&G.resourcePickerPopoverActiveTab}`,ge=()=>(0,n.jsx)(S,{value:W,mediaType:Y,folderName:X,newValue:_,setNewValue:Q,maxFiles:q}),Oe=()=>(0,n.jsx)(F,{newValue:_,setNewValue:Q,mediaType:Y}),Ue=()=>(0,n.jsx)(f,{mediaType:Y,setFormData:ee,setUpload:xe,newValue:_,error:re}),Xe=()=>{switch(ae){case p.QC.Folder:return ge();case p.QC.URL:return Oe();case p.QC.Upload:return Ue();default:return ge()}};return(0,n.jsx)(r.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{ref:H,...ne,...se,children:(0,n.jsxs)("div",{className:G.resourcePickerPopover,children:[(0,n.jsxs)("div",{className:G.resourcePickerPopoverTabs,children:[(0,n.jsx)("button",{className:Te(p.QC.Folder),onClick:()=>oe(p.QC.Folder),children:"Folder"}),(0,n.jsx)("button",{className:Te(p.QC.URL),onClick:()=>oe(p.QC.URL),children:"URL"})]}),(0,n.jsxs)("div",{className:G.resourcePickerPopoverContent,children:[Xe(),(0,n.jsxs)("div",{className:G.buttonRow,children:[(0,n.jsx)(c.$n,{variant:"secondary",onClick:()=>te(),fill:"outline",children:"Cancel"}),(0,n.jsx)(c.$n,{variant:_&&_!==W?"primary":"secondary",onClick:()=>{de?fetch("/api/storage/upload",{method:"POST",body:J}).then(we=>{if(we.status>=400){we.json().then(qe=>ue(qe));return}else return we.json()}).then(we=>{(0,o.AI)().get(`api/storage/read/${we.path}`).then(()=>Q(`${a.config.appUrl}api/storage/read/${we.path}`)).then(()=>z(`${a.config.appUrl}api/storage/read/${we.path}`))}).catch(we=>console.error(we)):z(_)},children:"Select"})]})]})]})})})},B=K=>({resourcePickerPopover:(0,s.css)`
    border-radius: ${K.shape.radius.default};
    box-shadow: ${K.shadows.z3};
    background: ${K.colors.background.primary};
    border: 1px solid ${K.colors.border.weak};
  `,resourcePickerPopoverTab:(0,s.css)`
    width: 50%;
    text-align: center;
    padding: ${K.spacing(1,0)};
    background: ${K.colors.background.secondary};
    color: ${K.colors.text.secondary};
    font-size: ${K.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,s.css)`
    color: ${K.colors.text.primary};
    font-weight: ${K.typography.fontWeightMedium};
    background: ${K.colors.background.primary};
  `,resourcePickerPopoverContent:(0,s.css)`
    width: 315px;
    font-size: ${K.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${K.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,s.css)`
    display: flex;
    width: 100%;
    border-radius: ${K.shape.radius.default} ${K.shape.radius.default} 0 0;
  `,buttonRow:(0,s.css)({display:"flex",justifyContent:"center",gap:K.spacing(2),padding:K.spacing(1)})})},63577:(k,A,e)=>{"use strict";e.d(A,{MediaType:()=>n.zu,ResourceFolderName:()=>n.Iu,findField:()=>i.UI,findFieldIndex:()=>i.gG,getColorDimension:()=>g,getPublicOrAbsoluteUrl:()=>v.D,getResourceDimension:()=>v.$,getScalarDimension:()=>f.H,getScaledDimension:()=>d.hX,getScaledDimensionForField:()=>d.qx,getTextDimension:()=>u});var n=e(80744),s=e(8066),l=e(58563),r=e(57875),i=e(33924);function g(E,h,y){return o((0,i.UI)(E,h.field),h,y)}function o(E,h,y){if(!E){const P=y.visualization.getColorByName(h.fixed??"grey");return{isAssumed:!!h.field?.length||!h.fixed,fixed:P,value:()=>P,get:C=>P}}const b=(0,s.Qi)(E);if(b.isByValue||E.config.mappings?.length){const P=(0,l.xg)(E,!0);P!==E.config&&(E={...E,config:P},E.state=void 0);const C=(0,r.J)({field:E,theme:y}),M=I=>C(I).color??"#ccc";return{field:E,get:I=>M(E.values[I]),value:()=>M((0,i.sB)(E))}}const D=b.getCalculator(E,y)(0,0);return{fixed:D,value:()=>D,get:P=>D,field:E}}var d=e(18379),c=e(11261),a=e(83195),p=e(52622);function u(E,h){const y=h.field?(0,i.UI)(E,h.field):E?.fields.find(b=>b.type===c.PU.string);return m(y,h)}function m(E,h){let y=h.fixed;const b=h.mode??p.RU.Fixed;if(b===p.RU.Fixed)return{isAssumed:!y,fixed:y,value:()=>y,get:P=>y};if(b===p.RU.Template){const P=C=>`TEMPLATE[${h.fixed} // ${C}]`;return E?{field:E,get:C=>P(E.values[C]),value:()=>P((0,i.sB)(E))}:(y=P(""),{isAssumed:!0,fixed:y,value:()=>y,get:C=>y})}if(!E)return{isAssumed:!0,fixed:y,value:()=>y,get:P=>y};let D=P=>(0,a.cN)(E.display(P));return{field:E,get:P=>D(E.values[P]),value:()=>D((0,i.sB)(E))}}var v=e(21813),x=e(38074),f=e(26781)},21813:(k,A,e)=>{"use strict";e.d(A,{$:()=>r,D:()=>l});var n=e(52622),s=e(33924);function l(i){return i?i.indexOf(":/")>0?i:window.__grafana_public_path__+i:""}function r(i,g){const o=g.mode??n.q_.Fixed;if(o===n.q_.Fixed){const a=l(g.fixed);return{isAssumed:!a,fixed:a,value:()=>a,get:p=>a}}const d=(0,s.UI)(i,g.field);if(!d){const a="";return{isAssumed:!0,fixed:a,value:()=>a,get:p=>a}}if(o===n.q_.Mapping){const a=p=>l(`${p}`);return{field:d,get:p=>a(d.values[p]),value:()=>a((0,s.sB)(d))}}const c=a=>{if(d&&d.display){const p=d.display(a).icon;return l(p??"")}return""};return{field:d,get:a=>c(d.values[a]),value:()=>c((0,s.sB)(d))}}},26781:(k,A,e)=>{"use strict";e.d(A,{H:()=>l});var n=e(52622),s=e(33924);function l(i,g){return r((0,s.UI)(i,g?.field),g)}function r(i,g){if(!i){const c=g.fixed??0;return{isAssumed:!!g.field?.length||!g.fixed,fixed:c,value:()=>c,get:()=>c}}let o=c=>c%g.max;return g.mode===n.WQ.Clamped&&(o=c=>c<g.min?g.min:c>g.max?g.max:c),{field:i,get:c=>{const a=i.values[c];return a===null||typeof a!="number"?0:o(a)},value:()=>(0,s.sB)(i)}}},18379:(k,A,e)=>{"use strict";e.d(A,{Nn:()=>g,Ru:()=>o,hX:()=>r,qx:()=>i});var n=e(58563),s=e(52622),l=e(33924);function r(d,c){return i((0,l.UI)(d,c?.field),c)}function i(d,c,a){if(!d){const f=c.fixed??0;return{isAssumed:!!c.field?.length||!c.fixed,fixed:f,value:()=>f,get:()=>f}}const p=(0,n.AP)(d),u=c.max-c.min;if(d.values.length<1||u<=0||p.delta<=0)return{fixed:c.min,value:()=>c.min,get:()=>c.min};let v=f=>c.min+f*u;if(a===s.QH.Quad){const f=Math.PI*(c.max/2)**2,E=Math.PI*(c.min/2)**2,h=f-E;v=y=>{let b=E+h*y;return Math.sqrt(b/Math.PI)*2}}const x=f=>{const E=d.values[f];let h=0;return E!==-1/0&&(h=(E-p.min)/p.delta),h>1?h=1:h<0&&(h=0),v(h)};return{get:x,value:()=>x((0,l.sB)(d)),field:d}}function g(d){return d||(d={min:0,max:1}),d.min==null&&(d.min=0),d.max==null&&(d.max=1),d}function o(d,c){let{min:a,max:p}=g(c);if(d||(d={}),d.max==null&&(d.max=p),d.min==null&&(d.min=a),d.min>d.max){const u=d.max;d.max=d.min,d.min=u}return d.min<a&&(d.min=a),d.max>p&&(d.max=p),d.fixed==null&&(d.fixed=d.min+(d.max-d.min)/2),d.field||(d.fixed>p?d.fixed=p:d.fixed<a&&(d.fixed=a)),d}},80744:(k,A,e)=>{"use strict";e.d(A,{Iu:()=>l,Iy:()=>g,QC:()=>i,nG:()=>s,zu:()=>r});var n=e(52622);const s=Object.freeze({fixed:"",mode:n.RU.Field,field:""});var l=(o=>(o.Icon="img/icons/unicons",o.IOT="img/icons/iot",o.Marker="img/icons/marker",o.BG="img/bg",o))(l||{}),r=(o=>(o.Icon="icon",o.Image="image",o))(r||{}),i=(o=>(o.Folder="folder",o.URL="url",o.Upload="upload",o))(i||{}),g=(o=>(o.SMALL="small",o.NORMAL="normal",o))(g||{})},33924:(k,A,e)=>{"use strict";e.d(A,{B_:()=>c,UI:()=>p,Wb:()=>g,XV:()=>o,b5:()=>d,gG:()=>u,sB:()=>m,wv:()=>a});var n=e(28240),s=e(75059),l=e(32264),r=e(63577),i=e(26781);function g(v,x){if(v?.series&&x.field)for(const f of v.series){const E=(0,r.getColorDimension)(f,x,l.$.theme2);if(!E.isAssumed||v.series.length===1)return E}return(0,r.getColorDimension)(void 0,x,l.$.theme2)}function o(v,x){if(v?.series&&x.field)for(const f of v.series){const E=(0,r.getScaledDimension)(f,x);if(!E.isAssumed||v.series.length===1)return E}return(0,r.getScaledDimension)(void 0,x)}function d(v,x){if(v?.series&&x.field)for(const f of v.series){const E=(0,i.H)(f,x);if(!E.isAssumed||v.series.length===1)return E}return(0,i.H)(void 0,x)}function c(v,x){if(v?.series&&x.field)for(const f of v.series){const E=(0,r.getResourceDimension)(f,x);if(!E.isAssumed||v.series.length===1)return E}return(0,r.getResourceDimension)(void 0,x)}function a(v,x){if(v?.series&&x.field)for(const f of v.series){const E=(0,r.getTextDimension)(f,x);if(!E.isAssumed||v.series.length===1)return E}return(0,r.getTextDimension)(void 0,x)}function p(v,x){const f=u(x,v);return f==null?void 0:v.fields[f]}function u(v,x,f){if(!(!x||!v?.length))for(let E=0;E<x.fields.length;E++){const h=x.fields[E];if(v===h.name)return E;const y=(0,n.Ct)(h,x,f);if(v===y)return E}}function m(v){const x=v.state?.calcs;if(x){const h=x[s.gy.lastNotNull];if(h!=null)return h}const f=v.values;let E=f.length-1;for(;E>=0;){const h=f[E--];if(h!=null)return h}}},9791:(k,A,e)=>{"use strict";e.d(A,{k:()=>C});var n=e(74848),s=e(2543),l=e(96540),r=e(28528),i=e(24293),g=e(90708),o=e(28240),d=e(94624),c=e(24308),a=e(52622),p=e(40845),u=e(79041),m=e(41706),v=e(91126),x=e(33368),f=e(1932);function E(M,I,R){return(0,f.jM)(M,T=>{T.defaults.custom===void 0&&(T.defaults.custom={}),T.defaults.max=R;const{custom:S}=T.defaults;switch(S.stacking===void 0&&(S.stacking={group:"A"}),I){case"lines":S.drawStyle=a.GR.Line,S.stacking.mode=a.gs.None,S.fillOpacity=0;break;case"bars":S.drawStyle=a.GR.Bars,S.stacking.mode=a.gs.None,S.fillOpacity=100;break;case"points":S.drawStyle=a.GR.Points,S.stacking.mode=a.gs.None,S.fillOpacity=0;break;case"stacked_lines":S.drawStyle=a.GR.Line,S.stacking.mode=a.gs.Normal,S.fillOpacity=100,S.axisSoftMin=0;break;case"stacked_bars":S.drawStyle=a.GR.Bars,S.stacking.mode=a.gs.Normal,S.fillOpacity=100,S.axisSoftMin=0;break;default:{const L=I;throw new Error(`Invalid graph-style: ${L}`)}}})}function h(M,I,R){return(0,f.jM)(M,T=>{T.defaults.thresholds=R,T.defaults.custom=T.defaults.custom??{},T.defaults.custom.thresholdsStyle=I})}var y=e(56737),b=e(84596),D=e(21423);function P(M){const[I,{inc:R}]=(0,y.A)(1),T=(0,b.A)(M);return(0,l.useMemo)(()=>{T&&!(0,D.J3)(M,T,D.bW)&&R()},[M,T,R]),I}function C({data:M,height:I,width:R,timeZone:T,timeRange:S,onChangeTime:L,loadingState:O,annotations:j,onHiddenSeriesChanged:N,splitOpenFn:F,graphStyle:U,tooltipDisplayMode:w=a.$N.Single,anchorToZero:B=!1,yAxisMaximum:K,thresholdsConfig:W,thresholdsStyle:z,eventBus:Y,vizLegendOverrides:X,toggleLegendRef:q}){const G=(0,p.$j)(),te=(0,l.useMemo)(()=>(0,r.O)((0,m.V)(m.S),"Explore"),[]),[H,se]=(0,l.useState)({defaults:{min:B?0:void 0,max:K||void 0,unit:"short",color:{mode:i.Y.PaletteClassic},custom:{drawStyle:a.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ne=(0,l.useMemo)(()=>{const re=E(H,U,K);return h(re,z,W)},[H,U,K,W,z]),le=(0,x.h)(F,S),_=(0,l.useMemo)(()=>(0,g.we)({fieldConfig:ne,data:M,timeZone:T,replaceVariables:re=>re,theme:G,fieldConfigRegistry:te,dataLinkPostProcessor:le}),[te,M,T,G,ne,le]),Q=(0,l.useMemo)(()=>(0,g.we)({fieldConfig:{defaults:{},overrides:[]},data:j,timeZone:T,replaceVariables:re=>re,theme:G,dataLinkPostProcessor:le}),[j,T,G,le]),ae=P(_),oe=(0,l.useRef)(N),J=(0,l.useRef)(void 0);(0,l.useEffect)(()=>{if(oe.current){const re=[];_.forEach(ue=>{ue.fields.map(ge=>ge.config?.custom?.hideFrom?.viz).every(s.identity)&&re.push((0,o.Ri)(ue))}),(J.current===void 0||!(0,s.isEqual)((0,s.sortBy)(re),(0,s.sortBy)(J.current)))&&(J.current=re,oe.current(re))}},[_]);const ee={eventsScope:"explore",eventBus:Y,sync:()=>d.y.Off,onToggleSeriesVisibility(re,ue){se((0,v.M)(re,ue,H,M))},dataLinkPostProcessor:le};function de(re,ue){se((0,v.M)(re,ue,H,M))}q&&(q.current=de);const xe=(0,l.useMemo)(()=>({tooltip:{mode:w,sort:a.xB.None},legend:{displayMode:a.lm.List,showLegend:!0,placement:"bottom",calcs:[],...X}}),[w,X]);return(0,n.jsx)(u.XF,{value:ee,children:(0,n.jsx)(c.m,{data:{series:_,timeRange:S,state:O,annotations:Q,structureRev:ae},pluginId:"timeseries",title:"",width:R,height:I,onChangeTimeRange:L,timeZone:T,options:xe})})}},72519:(k,A,e)=>{"use strict";e.d(A,{y:()=>M});var n=e(74848),s=e(32196),l=e(96540),r=e(42941),i=e(40845),g=e(91052),o=e(14578),d=e(56034),c=e(55852),a=e(8484),p=e(34028),u=e(9791),m=e(94354),v=e(31678);const x=v.EXPLORE_GRAPH_STYLES.map(R=>({value:R,label:R[0].toUpperCase()+R.slice(1).replace(/_/," ")}));function f(R){const{graphStyle:T,onChangeGraphStyle:S}=R;return(0,n.jsx)(m.z,{size:"sm",options:x,value:T,onChange:S})}var E=e(33390);const h="grafana.explore.style.graph",y=R=>{store.set(h,R)},b=()=>P(E.A.get(h)),D="lines",P=R=>v.EXPLORE_GRAPH_STYLES.find(S=>S===R)??D,C=20,M=({data:R,eventBus:T,height:S,width:L,timeRange:O,timeZone:j,annotations:N,onChangeTime:F,splitOpenFn:U,thresholdsConfig:w,thresholdsStyle:B,loadingState:K,statusMessage:W})=>{const[z,Y]=(0,r.A)(!1),[X,q]=(0,l.useState)(b),G=(0,i.of)(I),te=(0,l.useCallback)(se=>{(0,p.ng)(se),q(se)},[]),H=(0,l.useMemo)(()=>z?R:R.slice(0,C),[R,z]);return(0,n.jsx)(g.NR,{title:(0,a.t)("graph.container.title","Graph"),titleItems:[!z&&C<R.length&&(0,n.jsxs)("div",{className:G.timeSeriesDisclaimer,children:[(0,n.jsxs)("span",{className:G.warningMessage,children:[(0,n.jsx)(o.I,{name:"exclamation-triangle","aria-hidden":"true"}),(0,n.jsxs)(a.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:C}," series"]})]}),(0,n.jsx)(d.m,{content:(0,a.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries."),children:(0,n.jsx)(c.$n,{variant:"secondary",size:"sm",onClick:Y,children:(0,n.jsxs)(a.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:R.length}]})})})]},"disclaimer")].filter(Boolean),width:L,height:S,loadingState:K,statusMessage:W,actions:(0,n.jsx)(f,{graphStyle:X,onChangeGraphStyle:te}),children:(se,ne)=>(0,n.jsx)(u.k,{graphStyle:X,data:H,height:ne,width:se,timeRange:O,onChangeTime:F,timeZone:j,annotations:N,splitOpenFn:U,loadingState:K,thresholdsConfig:w,thresholdsStyle:B,eventBus:T})})},I=R=>({timeSeriesDisclaimer:(0,s.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:R.spacing(1)}),warningMessage:(0,s.css)({display:"flex",alignItems:"center",gap:R.spacing(.5),color:R.colors.warning.main,fontSize:R.typography.bodySmall.fontSize})})},97186:(k,A,e)=>{"use strict";e.d(A,{$:()=>n,r:()=>s});const n={showLabels:"grafana.explore.logs.showLabels",showTime:"grafana.explore.logs.showTime",wrapLogMessage:"grafana.explore.logs.wrapLogMessage",prettifyLogMessage:"grafana.explore.logs.prettifyLogMessage",logsSortOrder:"grafana.explore.logs.sortOrder",logContextWrapLogMessage:"grafana.explore.logs.logContext.wrapLogMessage"},s="grafana.explore.logs.visualisationType"},9651:(k,A,e)=>{"use strict";e.d(A,{a:()=>o,d:()=>d});var n=e(74848),s=e(32196),l=e(75212),r=e(40845),i=e(9663);const g=(c,a)=>({valueNavigation:(0,s.css)`
      width: ${i.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,s.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,s.css)`
      ${a?"":`border-bottom: 1px solid ${c.colors.border.medium}`};
    `}),o=c=>c.includes(l.gs)?c.replace(l.gs,""):c,d=({valueLabels:c,expanded:a})=>{const p=(0,r.of)(g,a);return(0,n.jsx)("div",{className:p.itemLabelsWrap,children:(0,n.jsx)("div",{className:p.valueNavigationWrapper,children:c.map((u,m)=>(0,n.jsx)("span",{className:p.valueNavigation,children:o(u.name)},u.name))})})}},9663:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>b,QH:()=>x,Jd:()=>f});var n=e(74848),s=e(32196),l=e(73287),r=e(14110),i=e(40845),g=e(29158),o=e(9651),d=e(57408);const c=(D,P)=>({rowWrapper:(0,s.css)`
    position: relative;
    min-width: ${x};
    padding-right: 5px;
  `,rowValue:(0,s.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${D.colors.background.primary});
    }
  `,rowValuesWrap:(0,s.css)`
    padding-left: ${f};
    width: calc(${P} * ${x});
    display: flex;
  `}),a=({totalNumberOfValues:D,values:P,hideFieldsWithoutValues:C})=>{const M=(0,i.of)(c,D);return(0,n.jsx)("div",{role:"cell",className:M.rowValuesWrap,children:P?.map(I=>C&&(I.value===void 0||I.value===d.M)?null:(0,n.jsx)("span",{className:M.rowWrapper,children:(0,n.jsx)("span",{className:M.rowValue,children:I.value})},I.key))})},p=D=>{const P=D.isDark?"#ce9178":"#a31515",C=D.isDark?"#73bf69":"#56a64b";return{metricName:(0,s.css)`
      color: ${C};
    `,metricValue:(0,s.css)`
      color: ${P};
    `,expanded:(0,s.css)`
      display: block;
      text-indent: 1em;
    `}},m=({value:D,index:P,length:C,isExpandedView:M})=>{const I=(0,i.of)(p),R=D.key,T=D.value;return(0,n.jsxs)("span",{className:M?I.expanded:"",children:[(0,n.jsx)("span",{className:I.metricName,children:R}),(0,n.jsx)("span",{children:"="}),(0,n.jsx)("span",{children:'"'}),(0,n.jsx)("span",{className:I.metricValue,children:T}),(0,n.jsx)("span",{children:'"'}),P<C-1&&(0,n.jsx)("span",{children:", "})]},P)},v="20px",x="80px",f="25px",E=(D,P,C)=>({rowWrapper:(0,s.css)`
    border-bottom: 1px solid ${D.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${C?"":"align-items: center;"}
    ${C?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,s.css)`
    position: absolute;
    left: 0;
    ${C?"":"bottom: 0;"}
    ${C?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,s.css)`
    position: relative;
    width: calc(100% - (${P} * ${x}) - ${f});
  `,rowLabelWrap:(0,s.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${v};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${v}),
        ${D.colors.background.primary}
      );
    }
  `});function h(D){let P=[],C=[];for(const M in D)M in D&&D[M]&&!M.includes("Value")?P.push({key:M,value:D[M]}):M in D&&D[M]&&M.includes("Value")&&C.push({key:M,value:D[M]});return{values:C,attributeValues:P}}const b=({listItemData:D,listKey:P,totalNumberOfValues:C,valueLabels:M,isExpandedView:I})=>{const{__name__:R,...T}=D,[S,L]=(0,l.A)(),O=M?.length??C,j=(0,i.of)(E,O,I),{values:N,attributeValues:F}=h(T),U=K=>K==="\u221E"||K==="Infinity"?"+Inf":K,w=`${R}{${F.map(K=>`${K.key}="${U(K.value)}"`)}}`,B=!!(M&&M?.length);return(0,n.jsxs)(n.Fragment,{children:[M!==void 0&&I&&(0,n.jsx)(o.d,{valueLabels:M,expanded:I}),(0,n.jsxs)("div",{className:j.rowWrapper,children:[(0,n.jsx)("span",{className:j.copyToClipboardWrapper,children:(0,n.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,r.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),L(w)},name:"copy"})}),(0,n.jsx)("span",{role:"cell",className:j.rowLabelWrapWrap,children:(0,n.jsxs)("div",{className:j.rowLabelWrap,children:[(0,n.jsx)("span",{children:R}),(0,n.jsx)("span",{children:"{"}),(0,n.jsx)("span",{children:F.map((K,W)=>(0,n.jsx)(m,{isExpandedView:I,value:K,index:W,length:F.length},W))}),(0,n.jsx)("span",{children:"}"})]})}),(0,n.jsx)(a,{hideFieldsWithoutValues:B,totalNumberOfValues:O,values:N})]},P)]})}},57408:(k,A,e)=>{"use strict";e.d(A,{E:()=>l,M:()=>s});var n=e(83195);const s=" ",l=r=>{const i={},g=[],o=r.fields.filter(a=>!["Time"].includes(a.name));let d=o.find(a=>a.name==="__name__")?.values??[];!d.length&&o.length&&o[0].values.length&&(d=Array(o[0].values.length).fill(""));const c=r.fields.filter(a=>!["__name__"].includes(a.name));return d.forEach(function(a,p){i[a]={};const u=i[a][p]??{};for(const m of c){const v=m.name;if(v!=="Time")if(typeof m?.display=="function"){const x=m?.display(m.values[p]);if(!isNaN(x.numeric))u[v]=x.numeric.toString(10);else{const f=(0,n.cN)(x);f?u[v]=f:v.includes("Value #")&&(u[v]=s)}}else console.warn("Field display method is missing!")}g.push({...u,__name__:a})}),g}},97814:(k,A,e)=>{"use strict";e.d(A,{g:()=>l});var n=e(74848),s=e(47232);const l=({timeInMs:i,className:g,humanize:o})=>(0,n.jsx)("span",{className:g,children:r(i,o)}),r=(i,g=!1)=>{const o=i/1e3;if(!g)return`${o.toFixed(1)}s`;const d=(0,s.Ah)(o,"seconds"),c=d.hours(),a=d.minutes(),p=d.seconds();return c?`${c}h ${a}m ${p}s`:a?`${a}m ${p}s`:`${p}s`}},92599:(k,A,e)=>{"use strict";e.d(A,{V:()=>pe});var n=e(74848),s=e(32196),l=e(96540),r=e(42941),i=e(41987),g=e(6709);function o(fe){if(fe?.tracesToLogsV2)return fe.tracesToLogsV2;if(!fe?.tracesToLogs)return;const Ee={customQuery:!1};return Ee.datasourceUid=fe.tracesToLogs.datasourceUid,Ee.tags=fe.tracesToLogs.mapTagNamesEnabled?fe.tracesToLogs.mappedTags:fe.tracesToLogs.tags?.map(Pe=>({key:Pe})),Ee.filterByTraceID=fe.tracesToLogs.filterByTraceID,Ee.filterBySpanID=fe.tracesToLogs.filterBySpanID,Ee.spanStartTimeShift=fe.tracesToLogs.spanStartTimeShift,Ee.spanEndTimeShift=fe.tracesToLogs.spanEndTimeShift,Ee}function d({options:fe,onOptionsChange:Ee}){const Pe=["loki","elasticsearch","grafana-splunk-datasource","grafana-opensearch-datasource","grafana-falconlogscale-datasource","googlecloud-logging-datasource"],he=useMemo(()=>o(fe.jsonData)||{customQuery:!1},[fe.jsonData]),{query:be="",tags:Ae,customQuery:De}=he,Ie=useCallback(ke=>{Ee({...fe,jsonData:{...fe.jsonData,tracesToLogsV2:{...he,...ke},tracesToLogs:void 0}})},[Ee,fe,he]);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"The logs data source the trace is going to navigate to",label:"Data source",labelWidth:26,children:jsx(DataSourcePicker,{inputId:"trace-to-logs-data-source-picker",filter:ke=>Pe.includes(ke.type),current:he.datasourceUid,noDefault:!0,width:40,onChange:ke=>Ie({datasourceUid:ke.uid})})})}),jsx(InlineFieldRow,{children:jsx(IntervalInput,{label:a("start"),tooltip:p("start","0"),value:he.spanStartTimeShift||"",onChange:ke=>{Ie({spanStartTimeShift:ke})},isInvalidError:u})}),jsx(InlineFieldRow,{children:jsx(IntervalInput,{label:a("end"),tooltip:p("end","0"),value:he.spanEndTimeShift||"",onChange:ke=>{Ie({spanEndTimeShift:ke})},isInvalidError:u})}),jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'",label:"Tags",labelWidth:26,children:jsx(TagMappingInput,{values:Ae??[],onChange:ke=>Ie({tags:ke})})})}),jsx(c,{disabled:De,type:"trace",id:"filterByTraceID",value:!!he.filterByTraceID,onChange:ke=>Ie({filterByTraceID:ke})}),jsx(c,{disabled:De,type:"span",id:"filterBySpanID",value:!!he.filterBySpanID,onChange:ke=>Ie({filterBySpanID:ke})}),jsx(InlineFieldRow,{children:jsx(InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26,children:jsx(InlineSwitch,{id:"customQuerySwitch",value:De,onChange:ke=>Ie({customQuery:ke.currentTarget.checked})})})}),De&&jsx(InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword",grow:!0,children:jsx(Input,{label:"Query",type:"text",allowFullScreen:!0,value:be,onChange:ke=>Ie({query:ke.currentTarget.value})})})]})}function c(fe){return jsx(InlineFieldRow,{children:jsx(InlineField,{disabled:fe.disabled,label:`Filter by ${fe.type} ID`,labelWidth:26,grow:!0,tooltip:`Filters logs by ${fe.type} ID, where the ${fe.type} ID should be part of the log line`,children:jsx(InlineSwitch,{id:fe.id,value:fe.value,onChange:Ee=>fe.onChange(Ee.currentTarget.checked)})})})}const a=fe=>`Span ${fe} time shift`,p=(fe,Ee)=>`Shifts the ${fe} time of the span. Default: ${Ee} (Time units can be used here, for example: 5s, -1m, 3h)`,u="Invalid time shift. See tooltip for examples.",m=({options:fe,onOptionsChange:Ee})=>{let Pe=fe.type;return Pe+=fe.type==="tempo"?"/configure-tempo-data-source/#trace-to-logs":"/#trace-to-logs",jsx(ConfigSection,{title:"Trace to logs",description:jsx(ConfigDescriptionLink,{description:"Navigate from a trace span to the selected data source's logs.",suffix:Pe,feature:"trace to logs"}),isCollapsible:!0,isInitiallyOpen:!0,children:jsx(d,{options:fe,onOptionsChange:Ee})})};var v=e(72574),x=e(40845),f=e(31193),E=e(32901),h=e(31678),y=e(62256),b=e(56271),D=e(41811);const C=(fe,Ee,Pe)=>{let he;return Pe?he=Ee?.childSpanIds.find(be=>fe.has(be)&&fe.get(be).startTime+fe.get(be).duration<Pe):he=Ee.childSpanIds[0],he?fe.get(he):void 0},I=fe=>{const Ee=[],Pe=[];fe.forEach(Ae=>{if(Ae.references[0]?.refType==="FOLLOWS_FROM"){Ee.push(Ae.spanID);const De=fe.get(Ae.references[0].spanID);De.childSpanIds=De.childSpanIds.filter(Ie=>Ie!==Ae.spanID),fe.set(De.spanID,{...De})}});const he=Ae=>{Ae.forEach(De=>{const Ie=fe.get(De);Ie.hasChildren&&(Pe.push(...Ie.childSpanIds),he(Ie.childSpanIds))})};return he(Ee),[...Ee,...Pe].forEach(Ae=>fe.delete(Ae)),fe},T=fe=>{let Ee=[...fe.keys()];return Ee.forEach(Pe=>{const he=fe.get(Pe);if(!(he&&he.references.length&&he.depth))return;const be=fe.get(he.references[0].spanID);if(!be){fe.delete(he.spanID);return}const Ae=he.startTime+he.duration,De=be.startTime+be.duration;if(he.startTime>=be.startTime){if(he.startTime>=De){fe.delete(he.spanID),be.childSpanIds=be.childSpanIds.filter(Ie=>Ie!==he.spanID);return}if(Ae>De){fe.set(he.spanID,{...he,duration:De-he.startTime});return}return}Ae<=be.startTime?(fe.delete(he.spanID),be.childSpanIds=be.childSpanIds.filter(Ie=>Ie!==he.spanID)):Ae<=De?fe.set(he.spanID,{...he,startTime:be.startTime,duration:Ae-be.startTime}):fe.set(he.spanID,{...he,startTime:be.startTime,duration:De-be.startTime})}),Ee=[...fe.keys()],Ee.forEach(Pe=>{const he=fe.get(Pe);if(he.references.length){const be=fe.get(he.references[0].spanID);he.references[0].span=be,fe.set(Pe,{...he})}}),fe},S=(fe,Ee,Pe,he)=>{const be=fe.get(Ee);if(!be)return Pe;const Ae=C(fe,be,he);let De;if(Ae)De={spanId:be.spanID,section_start:Ae.startTime+Ae.duration,section_end:he||be.startTime+be.duration},De.section_start!==De.section_end&&Pe.push(De),S(fe,Ae.spanID,Pe);else if(De={spanId:be.spanID,section_start:be.startTime,section_end:he||be.startTime+be.duration},De.section_start!==De.section_end&&Pe.push(De),be.references.length){const Ie=be.references.filter(ke=>ke.refType==="CHILD_OF")[0].spanID;S(fe,Ie,Pe,be.startTime)}return Pe};function L(fe){let Ee=[];const Pe=fe?.spans[0].spanID;if(Pe){const he=fe.spans.reduce((be,Ae)=>(be.set(Ae.spanID,Ae),be),new Map);try{const be=I(he),Ae=T(be);Ee=S(Ae,Pe,Ee)}catch(be){console.log("error while computing critical path for a trace",be)}}return Ee}const j=(0,D.A)(L);var N=e(3911),F=e(71656),U=e(30700);const w=.8,B=2,K=200,W=10,z=60,Y=6;function X(fe,Ee,Pe,he,be){const Ae=new Map,De=Ee.length<z?z:Math.min(Ee.length,K),Ie=window.innerWidth*2;fe.width=Ie,fe.height=De;const ke=Math.min(Y,Math.max(B,De/Ee.length)),dt=De/Ee.length,Pt=fe.getContext("2d",{alpha:!1});if(Pt){Pt.fillStyle=be,Pt.fillRect(0,0,Ie,De);for(let pt=0;pt<Ee.length;pt++){const{valueWidth:Tt,valueOffset:jt,serviceName:$t}=Ee[pt],sn=jt/Pe*Ie;let Yt=Tt/Pe*Ie;Yt<W&&(Yt=W);let qt=Ae.get($t);qt||(qt=`rgba(${he($t).concat(w).join()})`,Ae.set($t,qt)),Pt.fillStyle=qt,Pt.fillRect(sn,pt*dt,Yt,ke)}}}const q=(0,N.N)(fe=>({CanvasSpanGraph:(0,s.css)`
      label: CanvasSpanGraph;
      background: ${(0,F.R)(fe,"#fafafa")};
      height: 60px;
      position: absolute;
      width: 100%;
    `}));class G extends l.PureComponent{constructor(Ee){super(Ee),this.getColor=Pe=>(0,U.rY)(Pe,this.props.theme),this._setCanvasRef=Pe=>{this._canvasElm=Pe},this._canvasElm=void 0}componentDidMount(){this._draw()}componentDidUpdate(){this._draw()}_draw(){if(this._canvasElm){const{valueWidth:Ee,items:Pe}=this.props;X(this._canvasElm,Pe,Ee,this.getColor,(0,F.R)(this.props.theme,"#fff"))}}render(){return(0,n.jsx)("canvas",{className:q(this.props.theme).CanvasSpanGraph,ref:this._setCanvasRef,"data-testid":"CanvasSpanGraph"})}}const te=(0,x.cV)(G);var H=e(6389);const se=()=>({TickLabels:(0,s.css)`
      label: TickLabels;
      height: 1rem;
      position: relative;
    `,TickLabelsLabel:(0,s.css)`
      label: TickLabelsLabel;
      color: #717171;
      font-size: 0.7rem;
      position: absolute;
      user-select: none;
    `});function ne(fe){const{numTicks:Ee,duration:Pe}=fe,he=(0,x.of)(se),be=[];for(let Ae=0;Ae<Ee+1;Ae++){const De=Ae/Ee,Ie=De===1?{right:"0%"}:{left:`${De*100}%`};be.push((0,n.jsx)("div",{className:he.TickLabelsLabel,style:Ie,"data-testid":"tick",children:(0,H.a3)(Pe*De)},De))}return(0,n.jsx)("div",{className:he.TickLabels,"data-testid":"TickLabels",children:be})}var le=e(46942),_=e.n(le),Q=e(55852),ae=e(92151);const oe=()=>({GraphTick:(0,s.css)`
      label: GraphTick;
      stroke: #aaa;
      stroke-width: 1px;
    `});function J(fe){const{numTicks:Ee}=fe,Pe=(0,x.of)(oe),he=[];for(let be=1;be<Ee;be++){const Ae=`${be/Ee*100}%`;he.push((0,n.jsx)("line",{className:Pe.GraphTick,x1:Ae,y1:"0%",x2:Ae,y2:"100%"},be/Ee))}return(0,n.jsx)("g",{"data-testid":"ticks","aria-hidden":"true",children:he})}const ee=()=>({ScrubberHandleExpansion:_()((0,s.css)`
        label: ScrubberHandleExpansion;
        cursor: col-resize;
        fill-opacity: 0;
        fill: #44f;
      `,"scrubber-handle-expansion"),ScrubberHandle:_()((0,s.css)`
        label: ScrubberHandle;
        cursor: col-resize;
        fill: #555;
      `,"scrubber-handle"),ScrubberLine:_()((0,s.css)`
        label: ScrubberLine;
        pointer-events: none;
        stroke: #555;
      `,"scrubber-line"),ScrubberDragging:(0,s.css)`
      label: ScrubberDragging;
      & .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      & .scrubber-handle {
        fill: #44f;
      }
      & > .scrubber-line {
        stroke: #44f;
      }
    `,ScrubberHandles:(0,s.css)`
      label: ScrubberHandles;
      &:hover > .scrubber-handle-expansion {
        fill-opacity: 1;
      }
      &:hover > .scrubber-handle {
        fill: #44f;
      }
      &:hover + .scrubber.line {
        stroke: #44f;
      }
    `});function de({isDragging:fe,onMouseDown:Ee,onMouseEnter:Pe,onMouseLeave:he,position:be}){const Ae=`${be*100}%`,De=(0,x.of)(ee),Ie=_()({[De.ScrubberDragging]:fe});return(0,n.jsxs)("g",{className:Ie,"data-testid":"scrubber-component",children:[(0,n.jsxs)("g",{"data-testid":"scrubber-component-g",className:De.ScrubberHandles,onMouseDown:Ee,onMouseEnter:Pe,onMouseLeave:he,children:[(0,n.jsx)("rect",{"data-testid":"scrubber-component-rect-1",x:Ae,className:De.ScrubberHandleExpansion,style:{transform:"translate(-4.5px)"},width:"9",height:"20"}),(0,n.jsx)("rect",{"data-testid":"scrubber-component-rect-2",x:Ae,className:De.ScrubberHandle,style:{transform:"translate(-1.5px)"},width:"3",height:"20"})]}),(0,n.jsx)("line",{className:De.ScrubberLine,y2:"100%",x1:Ae,x2:Ae,"data-testid":"scrubber-component-line"})]})}const xe=(0,N.N)(fe=>{const Ee="JaegerUiComponents__ViewingLayerResetZoomHoverClassName",Pe=(0,s.css)`
    label: ViewingLayerResetZoom;
    display: none;
    position: absolute;
    right: 1%;
    top: 10%;
    z-index: 1;
  `;return{ViewingLayer:(0,s.css)`
      label: ViewingLayer;
      cursor: vertical-text;
      position: relative;
      z-index: 1;
      &:hover > .${Ee} {
        display: unset;
      }
    `,ViewingLayerGraph:(0,s.css)`
      label: ViewingLayerGraph;
      border: 1px solid ${(0,F.R)(fe,"#999")};
      /* need !important here to overcome something from semantic UI */
      overflow: visible !important;
      position: relative;
      transform-origin: 0 0;
      width: 100%;
    `,ViewingLayerInactive:(0,s.css)`
      label: ViewingLayerInactive;
      fill: ${(0,F.R)(fe,"rgba(214, 214, 214, 0.5)")};
    `,ViewingLayerCursorGuide:(0,s.css)`
      label: ViewingLayerCursorGuide;
      stroke: ${(0,F.R)(fe,"#f44")};
      stroke-width: 1;
    `,ViewingLayerDraggedShift:(0,s.css)`
      label: ViewingLayerDraggedShift;
      fill-opacity: 0.2;
    `,ViewingLayerDrag:(0,s.css)`
      label: ViewingLayerDrag;
      fill: ${(0,F.R)(fe,"#44f")};
    `,ViewingLayerFullOverlay:(0,s.css)`
      label: ViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `,ViewingLayerResetZoom:Pe,ViewingLayerResetZoomHoverClassName:Ee}}),re={SHIFT_END:"SHIFT_END",SHIFT_START:"SHIFT_START",REFRAME:"REFRAME"};function ue(fe,Ee){const[Pe,he]=fe<Ee?[fe,Ee]:[Ee,fe];return{x:`${Pe*100}%`,width:`${(he-Pe)*100}%`,leadingX:`${Ee*100}%`}}class Te extends l.PureComponent{constructor(Ee){super(Ee),this._setRoot=Pe=>{this._root=Pe},this._getDraggingBounds=Pe=>{if(!this._root)throw new Error("invalid state");const{left:he,width:be}=this._root.getBoundingClientRect(),[Ae,De]=this.props.viewRange.time.current;let Ie=1,ke=0;return Pe===re.SHIFT_START?Ie=De:Pe===re.SHIFT_END&&(ke=Ae),{clientXLeft:he,maxValue:Ie,minValue:ke,width:be}},this._handleReframeMouseMove=({value:Pe})=>{this.props.updateNextViewRangeTime({cursor:Pe})},this._handleReframeMouseLeave=()=>{this._draggerReframe.resetBounds(),this.props.updateNextViewRangeTime({cursor:null})},this._handleReframeDragUpdate=({value:Pe})=>{const he=Pe,{time:be}=this.props.viewRange,De={reframe:{anchor:be.reframe?be.reframe.anchor:he,shift:he}};this.props.updateNextViewRangeTime(De)},this._handleReframeDragEnd=({manager:Pe,value:he})=>{const{time:be}=this.props.viewRange,Ae=be.reframe?be.reframe.anchor:he,[De,Ie]=he<Ae?[he,Ae]:[Ae,he];Pe.resetBounds(),this.props.updateViewRangeTime(De,Ie,"minimap")},this._handleScrubberEnterLeave=({type:Pe})=>{const he=Pe===ae.EUpdateTypes.MouseEnter;this.setState({preventCursorLine:he})},this._handleScrubberDragUpdate=({event:Pe,tag:he,type:be,value:Ae})=>{be===ae.EUpdateTypes.DragStart&&Pe.stopPropagation(),he===re.SHIFT_START?this.props.updateNextViewRangeTime({shiftStart:Ae}):he===re.SHIFT_END&&this.props.updateNextViewRangeTime({shiftEnd:Ae})},this._handleScrubberDragEnd=({manager:Pe,tag:he,value:be})=>{const[Ae,De]=this.props.viewRange.time.current;let Ie;if(he===re.SHIFT_START)Ie=[be,De];else if(he===re.SHIFT_END)Ie=[Ae,be];else throw new Error("bad state");Pe.resetBounds(),this.setState({preventCursorLine:!1}),this.props.updateViewRangeTime(Ie[0],Ie[1],"minimap")},this._resetTimeZoomClickHandler=()=>{this.props.updateViewRangeTime(0,1)},this._draggerReframe=new ae.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseMove:this._handleReframeMouseMove,onMouseLeave:this._handleReframeMouseLeave,tag:re.REFRAME}),this._draggerStart=new ae.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:re.SHIFT_START}),this._draggerEnd=new ae.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleScrubberDragEnd,onDragMove:this._handleScrubberDragUpdate,onDragStart:this._handleScrubberDragUpdate,onMouseEnter:this._handleScrubberEnterLeave,onMouseLeave:this._handleScrubberEnterLeave,tag:re.SHIFT_END}),this._root=void 0,this.state={preventCursorLine:!1}}componentWillUnmount(){this._draggerReframe.dispose(),this._draggerEnd.dispose(),this._draggerStart.dispose()}_getMarkers(Ee,Pe){const he=xe(this.props.theme),be=ue(Ee,Pe);return[(0,n.jsx)("rect",{className:_()(he.ViewingLayerDraggedShift,he.ViewingLayerDrag),x:be.x,y:"0",width:be.width,height:this.props.height-2},"fill"),(0,n.jsx)("rect",{className:_()(he.ViewingLayerDrag),x:be.leadingX,y:"0",width:"1",height:this.props.height-2},"edge")]}render(){const{height:Ee,viewRange:Pe,numTicks:he,theme:be}=this.props,{preventCursorLine:Ae}=this.state,{current:De,cursor:Ie,shiftStart:ke,shiftEnd:dt,reframe:Pt}=Pe.time,pt=ke!=null||dt!=null||Pt!=null,[Tt,jt]=De;let $t=0;Tt&&($t=Tt*100);let sn=100;jt&&(sn=100-jt*100);let Yt;!pt&&Ie!=null&&!Ae&&(Yt=`${Ie*100}%`);const qt=xe(be);return(0,n.jsxs)("div",{"aria-hidden":!0,className:qt.ViewingLayer,style:{height:Ee},children:[(Tt!==0||jt!==1)&&(0,n.jsx)(Q.$n,{onClick:this._resetTimeZoomClickHandler,className:_()(qt.ViewingLayerResetZoom,qt.ViewingLayerResetZoomHoverClassName),type:"button",variant:"secondary",children:"Reset Selection"}),(0,n.jsxs)("svg",{height:Ee,className:qt.ViewingLayerGraph,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,children:[$t>0&&(0,n.jsx)("rect",{x:0,y:0,height:"100%",width:`${$t}%`,className:qt.ViewingLayerInactive,"data-testid":"left-ViewingLayerInactive"}),sn>0&&(0,n.jsx)("rect",{x:`${100-sn}%`,y:0,height:"100%",width:`${sn}%`,className:qt.ViewingLayerInactive,"data-testid":"right-ViewingLayerInactive"}),(0,n.jsx)(J,{numTicks:he}),Yt&&(0,n.jsx)("line",{className:qt.ViewingLayerCursorGuide,x1:Yt,y1:"0",x2:Yt,y2:Ee-2,strokeWidth:"1","data-testid":"ViewingLayerCursorGuide"}),ke!=null&&this._getMarkers(Tt,ke),dt!=null&&this._getMarkers(jt,dt),(0,n.jsx)(de,{isDragging:ke!=null,onMouseDown:this._draggerStart.handleMouseDown,onMouseEnter:this._draggerStart.handleMouseEnter,onMouseLeave:this._draggerStart.handleMouseLeave,position:Tt||0}),(0,n.jsx)(de,{isDragging:dt!=null,position:jt||1,onMouseDown:this._draggerEnd.handleMouseDown,onMouseEnter:this._draggerEnd.handleMouseEnter,onMouseLeave:this._draggerEnd.handleMouseLeave}),Pt!=null&&this._getMarkers(Pt.anchor,Pt.shift)]}),pt&&(0,n.jsx)("div",{className:qt.ViewingLayerFullOverlay})]})}}const ge=(0,x.cV)(Te),Oe=()=>({container:(0,s.css)({padding:"0 0.5rem 0.5rem 0.5rem"}),canvasContainer:(0,s.css)({position:"relative"})}),Ue=60,Xe=4;function we(fe){return{valueOffset:fe.relativeStartTime,valueWidth:fe.duration,serviceName:fe.process.serviceName}}function qe(fe){return fe.spans.map(we)}const We=(0,D.A)(qe);class Ce extends l.PureComponent{static{this.defaultProps={height:Ue}}render(){const{height:Ee,trace:Pe,viewRange:he,updateNextViewRangeTime:be,updateViewRangeTime:Ae}=this.props,De=Oe();if(!Pe)return(0,n.jsx)("div",{});const Ie=We(Pe);return(0,n.jsxs)("div",{className:De.container,children:[(0,n.jsx)(ne,{numTicks:Xe,duration:Pe.duration}),(0,n.jsxs)("div",{className:De.canvasContainer,children:[(0,n.jsx)(te,{valueWidth:Pe.duration,items:Ie}),(0,n.jsx)(ge,{viewRange:he,numTicks:Xe,height:Ee||Ue,updateViewRangeTime:Ae,updateNextViewRangeTime:be})]})]})}}var je=e(28114);function Ke(){const[fe,Ee]=(0,l.useState)(new Set),Pe=(0,l.useCallback)(function(ke){if(fe.size===0)return;let dt=-1,Pt=!0;const pt=ke.reduce((Tt,jt)=>(jt.depth<=dt&&(Pt=!0),Pt&&Tt.has(jt.spanID)&&(Tt.delete(jt.spanID),Pt=!1,dt=jt.depth),Tt),new Set(fe));Ee(pt)},[fe]),he=(0,l.useCallback)(function(ke){if(_e(ke,fe))return;let dt;const Pt=ke.reduce((pt,Tt)=>(dt&&Tt.depth<=dt.depth?(pt.add(dt.spanID),Tt.hasChildren&&(dt=Tt)):Tt.hasChildren&&!pt.has(Tt.spanID)&&(dt=Tt),pt),new Set(fe));dt&&Pt.add(dt.spanID),Ee(Pt)},[fe]),be=(0,l.useCallback)(function(){Ee(new Set)},[]),Ae=(0,l.useCallback)(function(ke){if(_e(ke,fe))return;const dt=ke.reduce((Pt,pt)=>(pt.hasChildren&&Pt.add(pt.spanID),Pt),new Set);Ee(dt)},[fe]),De=(0,l.useCallback)(function(ke){const dt=new Set(fe);fe.has(ke)?dt.delete(ke):dt.add(ke),Ee(dt)},[fe]);return{childrenHiddenIDs:fe,expandOne:Pe,collapseOne:he,expandAll:be,collapseAll:Ae,childrenToggle:De}}function _e(fe,Ee){return fe.filter(he=>he.hasChildren).length===Ee.size}function Fe(fe){const[Ee,Pe]=(0,l.useState)(new Map);(0,l.useEffect)(()=>{Pe(new Map)},[fe,Pe]);const he=(0,l.useCallback)(function(Ie){const ke=new Map(Ee);ke.has(Ie)?ke.delete(Ie):ke.set(Ie,new b.DetailState),Pe(ke)},[Ee]),be=(0,l.useCallback)(function(Ie,ke){const dt=Ee.get(Ie);if(!dt)return;const Pt=dt.toggleLogItem(ke),pt=new Map(Ee);return pt.set(Ie,Pt),Pe(pt)},[Ee]),Ae=(0,l.useCallback)(function(Ie,ke){const dt=Ee.get(Ie);if(!dt)return;const Pt=dt.toggleReferenceItem(ke),pt=new Map(Ee);return pt.set(Ie,Pt),Pe(pt)},[Ee]);return{detailStates:Ee,toggleDetail:he,detailLogItemToggle:be,detailLogsToggle:(0,l.useCallback)(De=>at("logs",Ee,Pe)(De),[Ee]),detailWarningsToggle:(0,l.useCallback)(De=>at("warnings",Ee,Pe)(De),[Ee]),detailStackTracesToggle:(0,l.useCallback)(De=>at("stackTraces",Ee,Pe)(De),[Ee]),detailReferenceItemToggle:Ae,detailReferencesToggle:(0,l.useCallback)(De=>at("references",Ee,Pe)(De),[Ee]),detailProcessToggle:(0,l.useCallback)(De=>at("process",Ee,Pe)(De),[Ee]),detailTagsToggle:(0,l.useCallback)(De=>at("tags",Ee,Pe)(De),[Ee])}}function at(fe,Ee,Pe){return he=>{const be=Ee.get(he);if(!be)return;let Ae;fe==="tags"?Ae=be.toggleTags():fe==="process"?Ae=be.toggleProcess():fe==="warnings"?Ae=be.toggleWarnings():fe==="references"?Ae=be.toggleReferences():fe==="stackTraces"?Ae=be.toggleStackTraces():Ae=be.toggleLogs();const De=new Map(Ee);De.set(he,Ae),Pe(De)}}function Ct(){const[fe,Ee]=(0,l.useState)(new Set),Pe=(0,l.useCallback)(function(Ae){Ee(De=>{const Ie=new Set(De);return Ie.add(Ae),Ie})},[]),he=(0,l.useCallback)(function(Ae){Ee(De=>{const Ie=new Set(De);return Ie.delete(Ae),Ie})},[]);return{hoverIndentGuideIds:fe,addHoverIndentGuideId:Pe,removeHoverIndentGuideId:he}}var Dt=e(15583);function tt(){const[fe,Ee]=(0,l.useState)({time:{current:[0,1]}}),Pe=(0,l.useCallback)(function(Ae){Ee(De=>{const Ie={...De.time,...Ae};return{...De,time:Ie}})},[]),he=(0,l.useCallback)(function(Ae,De){const ke={current:[Ae,De]};Ee(dt=>({...dt,time:ke}))},[]);return{viewRange:fe,updateViewRangeTime:he,updateNextViewRangeTime:Pe}}const ze=fe=>({noDataMsg:(0,s.css)`
    height: 100%;
    width: 100%;
    display: grid;
    place-items: center;
    font-size: ${fe.typography.h4.fontSize};
    color: ${fe.colors.text.secondary};
  `});function pe(fe){const{traceProp:Ee,datasource:Pe,topOfViewRef:he,exploreId:be,createSpanLink:Ae,focusedSpanId:De,createFocusSpanLink:Ie}=fe,{detailStates:ke,toggleDetail:dt,detailLogItemToggle:Pt,detailLogsToggle:pt,detailProcessToggle:Tt,detailReferencesToggle:jt,detailReferenceItemToggle:$t,detailTagsToggle:sn,detailWarningsToggle:Yt,detailStackTracesToggle:qt}=Fe(fe.dataFrames[0]),{removeHoverIndentGuideId:bn,addHoverIndentGuideId:Mt,hoverIndentGuideIds:Jt}=Ct(),{viewRange:Ut,updateViewRangeTime:Gt,updateNextViewRangeTime:Lt}=tt(),{expandOne:At,collapseOne:Nt,childrenToggle:Dn,collapseAll:An,childrenHiddenIDs:Pn,expandAll:Xn}=Ke(),{search:Tn,setSearch:ht,spanFilterMatches:St}=(0,Dt.SQ)(Ee?.spans),[Ge,Ve]=(0,l.useState)(""),[lt,It]=(0,r.A)(!1),[Qe,vt]=(0,l.useState)(!1),[Ot,zt]=(0,l.useState)(!1),[vn,ln]=(0,l.useState)(100),[On,wn]=(0,l.useState)({}),[Un,cs]=(0,l.useState)({}),Zn=(0,x.of)(ze),[wt,Ft]=(0,l.useState)(.4),[Ht,ut]=Se({refId:fe.dataFrames[0]?.refId,exploreId:fe.exploreId,datasource:Pe,splitOpenFn:fe.splitOpenFn}),pn=De??Ht,Jn=Ie??ut,Qn=(0,l.useMemo)(()=>({childrenHiddenIDs:Pn,detailStates:ke,hoverIndentGuideIds:Jt,spanNameColumnWidth:wt,traceID:fe.traceProp?.traceID}),[Pn,ke,Jt,wt,fe.traceProp?.traceID]),fs=(0,f.tR)().getInstanceSettings(Pe?.name),ls=o(fs?.jsonData),ea=fs?.jsonData?.tracesToMetrics,Hs=fs?.jsonData?.tracesToProfiles,bs=fs?.jsonData,Ys=(0,l.useMemo)(()=>Ae??(0,je.lU)({splitOpenFn:fe.splitOpenFn,traceToLogsOptions:ls,traceToMetricsOptions:ea,traceToProfilesOptions:Hs,dataFrame:fe.dataFrames[0],createFocusSpanLink:Jn,trace:Ee}),[fe.splitOpenFn,ls,ea,Hs,fe.dataFrames,Jn,Ee,Ae]),La=(0,h.useSelector)($r=>(0,E.O)($r.user)),Xs=Pe?Pe?.type:"unknown",Ta=fe.scrollElement?fe.scrollElement:document.getElementsByClassName(fe.scrollElementClass??"")[0],Lr=j(Ee);return(0,n.jsx)(n.Fragment,{children:fe.dataFrames?.length&&Ee?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.TracePageHeader,{trace:Ee,data:fe.dataFrames[0],timeZone:La,search:Tn,setSearch:ht,showSpanFilters:lt,setShowSpanFilters:It,showSpanFilterMatchesOnly:Qe,setShowSpanFilterMatchesOnly:vt,showCriticalPathSpansOnly:Ot,setShowCriticalPathSpansOnly:zt,setFocusedSpanIdForSearch:Ve,spanFilterMatches:St,datasourceType:Xs,setHeaderHeight:ln,app:be?i.Jk.Explore:i.Jk.Unknown}),(0,n.jsx)(Ce,{trace:Ee,viewRange:Ut,updateNextViewRangeTime:Lt,updateViewRangeTime:Gt}),(0,n.jsx)(b.TraceTimelineViewer,{findMatchesIDs:St,trace:Ee,traceToProfilesOptions:Hs,datasourceType:Xs,spanBarOptions:bs?.spanBar,traceTimeline:Qn,updateNextViewRangeTime:Lt,updateViewRangeTime:Gt,viewRange:Ut,timeZone:La,setSpanNameColumnWidth:Ft,collapseAll:An,collapseOne:Nt,expandAll:Xn,expandOne:At,childrenToggle:Dn,detailLogItemToggle:Pt,detailLogsToggle:pt,detailWarningsToggle:Yt,detailStackTracesToggle:qt,detailReferencesToggle:jt,detailReferenceItemToggle:$t,detailProcessToggle:Tt,detailTagsToggle:sn,detailToggle:dt,addHoverIndentGuideId:Mt,removeHoverIndentGuideId:bn,linksGetter:()=>[],createSpanLink:Ys,scrollElement:Ta,focusedSpanId:pn,focusedSpanIdForSearch:Ge,showSpanFilterMatchesOnly:Qe,showCriticalPathSpansOnly:Ot,createFocusSpanLink:Jn,topOfViewRef:he,headerHeight:vn,criticalPath:Lr,traceFlameGraphs:On,setTraceFlameGraphs:wn,redrawListView:Un,setRedrawListView:cs})]}):(0,n.jsx)("div",{className:Zn.noDataMsg,children:"No data"})})}function Se(fe){const Ee=(0,h.useSelector)(Ie=>Ie.explore.panes[fe.exploreId]?.panelsState.trace),Pe=Ee?.spanId,he=(0,h.useDispatch)(),be=Ie=>he((0,y.EA)(fe.exploreId,"trace",{...Ee,spanId:Ie})),Ae=(0,h.useSelector)(Ie=>Ie.explore.panes[fe.exploreId]?.queries.find(ke=>ke.refId===fe.refId));return[Pe,(Ie,ke)=>{const dt={title:"Deep link to this span",url:"",internal:{datasourceUid:fe.datasource?.uid,datasourceName:fe.datasource?.name,query:{...Ae,query:Ie},panelsState:{trace:{spanId:ke}}}},Pt=Ae?.queryType==="traceql"&&Ae.query===Ie;return(0,g.u)({link:dt,internalLink:dt.internal,scopedVars:{},field:{},onClickFn:Pt?()=>be(Pe===ke?void 0:ke):fe.splitOpenFn?()=>fe.splitOpenFn({datasourceUid:fe.datasource?.uid,queries:[{...Ae,query:Ie}],panelsState:{trace:{spanId:ke}}}):void 0,replaceVariables:(0,v.w)().replace.bind((0,v.w)())})}]}},71656:(k,A,e)=>{"use strict";e.d(A,{R:()=>s});var n=e(84140);function s(l,r,i){if(l.isLight)return r;{if(i){const d=(0,n.A)(r);return n.A.mostReadable(i,[d.clone().lighten(25),d.clone().lighten(10),d,d.clone().darken(10),d.clone().darken(25)],{includeFallbackColors:!1}).toHex8String()}const g=(0,n.A)(r).toHsl();g.l=1-g.l;const o=(0,n.A)(g);return o.isLight()?o.darken(5).toHex8String():o.lighten(5).toHex8String()}}},56271:(k,A,e)=>{"use strict";e.d(A,{DetailState:()=>bi,TracePageHeader:()=>or,TraceTimelineViewer:()=>Po,filterSpans:()=>ft,transformTraceData:()=>gl});var n=e(74848),s=e(32196),l=e(96540),r=e(14110),i=e(32264),g=e(3911),o=e(40845),d=e(71656),c=e(75888),a=e.n(c);const u={scrollPageDown:{binding:"s",label:"Scroll down"},scrollPageUp:{binding:"w",label:"Scroll up"},scrollToNextVisibleSpan:{binding:"f",label:"Scroll to the next visible span"},scrollToPrevVisibleSpan:{binding:"b",label:"Scroll to the previous visible span"},panLeft:{binding:["a","left"],label:"Pan left"},panLeftFast:{binding:["shift+a","shift+left"],label:"Pan left \u2014 Large"},panRight:{binding:["d","right"],label:"Pan right"},panRightFast:{binding:["shift+d","shift+right"],label:"Pan right \u2014 Large"},zoomIn:{binding:"up",label:"Zoom in"},zoomInFast:{binding:"shift+up",label:"Zoom in \u2014 Large"},zoomOut:{binding:"down",label:"Zoom out"},zoomOutFast:{binding:"shift+down",label:"Zoom out \u2014 Large"},collapseAll:{binding:"]",label:"Collapse All"},expandAll:{binding:"[",label:"Expand All"},collapseOne:{binding:"p",label:"Collapse One Level"},expandOne:{binding:"o",label:"Expand One Level"},searchSpans:{binding:"ctrl+b",label:"Search Spans"},clearSearch:{binding:"escape",label:"Clear Search"}};let m;function v(){if(m)return m;const $e=new(a())(document.body);return m=$e,$e}function x($e){const Ye=v();Object.keys($e).forEach(rt=>{const xt=$e[rt];xt&&Ye.bind(u[rt].binding,xt)})}function f(){v().reset()}var E=e(46942),h=e.n(E),y=e(6389);function b($e){const{min:Ye,max:rt,viewStart:xt,viewEnd:Kt}=$e,en=rt-Ye,mn=Ye+xt*en,Vn=rt-(1-Kt)*en-mn;return(qn,Us)=>({start:(qn-mn)/Vn,end:(Us-mn)/Vn})}function D($e,Ye,rt){return!Array.isArray(rt.tags)||!rt.tags.length?!1:rt.tags.some(xt=>xt.key===$e&&xt.value===Ye)}const P=$e=>$e.kind==="client",C=D.bind(null,"span.kind","client"),M=$e=>P($e)||C($e),I=$e=>$e.kind==="server",R=D.bind(null,"span.kind","server"),T=$e=>I($e)||R($e),S=$e=>$e.statusCode===2,L=D.bind(null,"error",!0),O=D.bind(null,"error","true"),j=$e=>S($e)||L($e)||O($e);function N($e,Ye){const{depth:rt}=$e[Ye];let xt=Ye+1;for(;xt<$e.length&&$e[xt].depth>rt;xt++)if(j($e[xt]))return!0;return!1}function F($e){if($e.length<=1||!M($e[0]))return!1;const rt=$e[0].depth+1;let xt=1;for(;xt<$e.length&&$e[xt].depth===rt;){if(T($e[xt]))return $e[xt];xt++}return null}const U=$e=>$e.kind?$e.kind==="client":$e.tags.some(({key:Ye,value:rt})=>Ye==="span.kind"&&rt==="client"),w=$e=>({Ticks:(0,s.css)`
      label: Ticks;
      pointer-events: none;
    `,TicksTick:(0,s.css)`
      label: TicksTick;
      position: absolute;
      height: 100%;
      width: 1px;
      background: ${(0,d.R)($e,"#d8d8d8")};
      &:last-child {
        width: 0;
      }
    `,TicksTickLabel:(0,s.css)`
      label: TicksTickLabel;
      left: 0.25rem;
      position: absolute;
    `,TicksTickLabelEndAnchor:(0,s.css)`
      label: TicksTickLabelEndAnchor;
      left: initial;
      right: 0.25rem;
    `});function B({endTime:$e=null,numTicks:Ye,showLabels:rt=null,startTime:xt=null}){let Kt;if(rt){Kt=[];const jn=($e||0)-(xt||0);for(let Vn=0;Vn<Ye;Vn++){const qn=(xt||0)+Vn/(Ye-1)*jn;Kt.push((0,y.a3)(qn))}}const en=(0,o.of)(w),mn=[];for(let jn=0;jn<Ye;jn++){const Vn=jn/(Ye-1);mn.push((0,n.jsx)("div",{"data-testid":"TicksID",className:en.TicksTick,style:{left:`${Vn*100}%`},children:Kt&&(0,n.jsx)("span",{className:h()(en.TicksTickLabel,{[en.TicksTickLabelEndAnchor]:Vn>=1}),children:Kt[jn]})},Vn))}return(0,n.jsx)("div",{className:en.Ticks,children:mn})}const K=()=>({row:(0,s.css)({display:"flex",flex:"0 1 auto",flexDirection:"row"}),rowCell:(0,s.css)({position:"relative"})});function W({children:$e,className:Ye="",...rt}){const xt=(0,o.of)(K);return(0,n.jsx)("div",{className:h()(xt.row,Ye),...rt,children:$e})}function z({children:$e,className:Ye="",width:rt,style:xt={},...Kt}){const en=`${rt*100}%`,mn={...xt,flexBasis:en,maxWidth:en},jn=(0,o.of)(K);return(0,n.jsx)("div",{className:h()(jn.rowCell,Ye),style:mn,"data-testid":"TimelineRowCell",...Kt,children:$e})}W.Cell=z;var Y=e(29158);const X=()=>({TimelineCollapser:(0,s.css)`
      align-items: center;
      display: flex;
      flex: none;
      justify-content: center;
      margin-right: 0.5rem;
    `});function q($e){const{onExpandAll:Ye,onExpandOne:rt,onCollapseAll:xt,onCollapseOne:Kt}=$e,en=(0,o.of)(X);return(0,n.jsxs)("div",{className:en.TimelineCollapser,"data-testid":"TimelineCollapser",children:[(0,n.jsx)(Y.K,{tooltip:"Expand +1",size:"xl",tooltipPlacement:"top",name:"angle-down",onClick:rt}),(0,n.jsx)(Y.K,{tooltip:"Collapse +1",size:"xl",tooltipPlacement:"top",name:"angle-right",onClick:Kt}),(0,n.jsx)(Y.K,{tooltip:"Expand All",size:"xl",tooltipPlacement:"top",name:"angle-double-down",onClick:Ye}),(0,n.jsx)(Y.K,{tooltip:"Collapse All",size:"xl",tooltipPlacement:"top",name:"angle-double-right",onClick:xt})]})}var G=e(92151);const te=()=>({TimelineColumnResizer:(0,s.css)`
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,wrapper:(0,s.css)`
      bottom: 0;
      position: absolute;
      top: 0;
    `,dragger:(0,s.css)`
      border-left: 2px solid transparent;
      cursor: col-resize;
      height: 5000px;
      margin-left: -1px;
      position: absolute;
      top: 0;
      width: 1px;
      z-index: 10;
      &:hover {
        border-left: 2px solid rgba(0, 0, 0, 0.3);
      }
      &::before {
        position: absolute;
        top: 0;
        bottom: 0;
        left: -8px;
        right: 0;
        content: ' ';
      }
    `,draggerDragging:(0,s.css)`
      background: rgba(136, 0, 136, 0.05);
      width: unset;
      &::before {
        left: -2000px;
        right: -2000px;
      }
    `,draggerDraggingLeft:(0,s.css)`
      border-left: 2px solid #808;
      border-right: 1px solid #999;
    `,draggerDraggingRight:(0,s.css)`
      border-left: 1px solid #999;
      border-right: 2px solid #808;
    `,gripIcon:(0,s.css)`
      position: absolute;
      top: 0;
      bottom: 0;
      &::before,
      &::after {
        border-right: 1px solid #ccc;
        content: ' ';
        height: 9px;
        position: absolute;
        right: 9px;
        top: 25px;
      }
      &::after {
        right: 5px;
      }
    `,gripIconDragging:(0,s.css)`
      &::before,
      &::after {
        border-right: 1px solid rgba(136, 0, 136, 0.5);
      }
    `});class H extends l.PureComponent{constructor(Ye){super(Ye),this._setRootElm=rt=>{this._rootElm=rt},this._getDraggingBounds=()=>{if(!this._rootElm)throw new Error("invalid state");const{left:rt,width:xt}=this._rootElm.getBoundingClientRect(),{min:Kt,max:en}=this.props;return{clientXLeft:rt,width:xt,maxValue:en,minValue:Kt}},this._handleDragUpdate=({value:rt})=>{this.setState({dragPosition:rt})},this._handleDragEnd=({manager:rt,value:xt})=>{rt.resetBounds(),this.setState({dragPosition:null}),this.props.onChange(xt)},this._dragManager=new G.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleDragEnd,onDragMove:this._handleDragUpdate,onDragStart:this._handleDragUpdate}),this._rootElm=void 0,this.state={dragPosition:null}}componentWillUnmount(){this._dragManager.dispose()}render(){let Ye,rt;const{position:xt,columnResizeHandleHeight:Kt}=this.props,{dragPosition:en}=this.state;Ye=`${xt*100}%`;const mn={left:Ye};let jn=!1,Vn=!1;const qn=te();if(this._dragManager.isDragging()&&this._rootElm&&en!=null){jn=en<xt,Vn=en>xt;const Is=`${Math.min(xt,en)*100}%`,$s=`calc(${(1-Math.max(xt,en))*100}% - 1px)`;rt={left:Is,right:$s}}else rt=mn;rt.height=Kt;const Us=jn||Vn;return(0,n.jsxs)("div",{className:qn.TimelineColumnResizer,ref:this._setRootElm,"data-testid":"TimelineColumnResizer",children:[(0,n.jsx)("div",{className:h()(qn.gripIcon,Us&&qn.gripIconDragging),style:mn,"data-testid":"TimelineColumnResizer--gripIcon"}),(0,n.jsx)("div",{"aria-hidden":!0,className:h()(qn.dragger,Us&&qn.draggerDragging,Vn&&qn.draggerDraggingRight,jn&&qn.draggerDraggingLeft),onMouseDown:this._dragManager.handleMouseDown,style:rt,"data-testid":"TimelineColumnResizer--dragger"})]})}}const se=(0,g.N)(()=>({TimelineViewingLayer:(0,s.css)`
      label: TimelineViewingLayer;
      bottom: 0;
      cursor: vertical-text;
      left: 0;
      position: absolute;
      right: 0;
      top: 0;
    `,TimelineViewingLayerCursorGuide:(0,s.css)`
      label: TimelineViewingLayerCursorGuide;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      width: 1px;
      background-color: red;
    `,TimelineViewingLayerDragged:(0,s.css)`
      label: TimelineViewingLayerDragged;
      position: absolute;
      top: 0;
      bottom: 0;
    `,TimelineViewingLayerDraggedDraggingLeft:(0,s.css)`
      label: TimelineViewingLayerDraggedDraggingLeft;
      border-left: 1px solid;
    `,TimelineViewingLayerDraggedDraggingRight:(0,s.css)`
      label: TimelineViewingLayerDraggedDraggingRight;
      border-right: 1px solid;
    `,TimelineViewingLayerDraggedShiftDrag:(0,s.css)`
      label: TimelineViewingLayerDraggedShiftDrag;
      background-color: rgba(68, 68, 255, 0.2);
      border-color: #44f;
    `,TimelineViewingLayerDraggedReframeDrag:(0,s.css)`
      label: TimelineViewingLayerDraggedReframeDrag;
      background-color: rgba(255, 68, 68, 0.2);
      border-color: #f44;
    `,TimelineViewingLayerFullOverlay:(0,s.css)`
      label: TimelineViewingLayerFullOverlay;
      bottom: 0;
      cursor: col-resize;
      left: 0;
      position: fixed;
      right: 0;
      top: 0;
      user-select: none;
    `}));function ne($e){return Reflect.has($e,"isOutOfView")}function le($e,Ye,rt){return $e+rt*(Ye-$e)}function _($e,Ye,rt){return(rt-$e)/(Ye-$e)}function Q($e,Ye){let[rt,xt]=$e<Ye?[$e,Ye]:[Ye,$e];return rt>=1||xt<=0?{isOutOfView:!0}:(rt<0&&(rt=0),xt>1&&(xt=1),{isDraggingLeft:$e>Ye,left:`${rt*100}%`,width:`${(xt-rt)*100}%`})}function ae($e,Ye,rt,xt,Kt){const en=_($e,Ye,rt),mn=_($e,Ye,xt),jn=Q(en,mn);if(ne(jn))return null;const{isDraggingLeft:Vn,left:qn,width:Us}=jn,Is=se(),$s=(0,s.cx)({[Is.TimelineViewingLayerDraggedDraggingRight]:!Vn,[Is.TimelineViewingLayerDraggedReframeDrag]:!Kt,[Is.TimelineViewingLayerDraggedShiftDrag]:Kt});return(0,n.jsx)("div",{className:(0,s.cx)(Is.TimelineViewingLayerDragged,Is.TimelineViewingLayerDraggedDraggingLeft,$s),style:{left:qn,width:Us},"data-testid":"Dragged"})}class oe extends l.PureComponent{constructor(Ye){super(Ye),this._setRoot=rt=>{this._root=rt},this._getDraggingBounds=()=>{if(!this._root)throw new Error("invalid state");const{left:rt,width:xt}=this._root.getBoundingClientRect();return{clientXLeft:rt,width:xt}},this._handleReframeMouseMove=({value:rt})=>{const[xt,Kt]=this.props.viewRangeTime.current,en=le(xt,Kt,rt);this.props.updateNextViewRangeTime({cursor:en})},this._handleReframeMouseLeave=()=>{this.props.updateNextViewRangeTime({cursor:void 0})},this._handleReframeDragUpdate=({value:rt})=>{const{current:xt,reframe:Kt}=this.props.viewRangeTime,[en,mn]=xt,jn=le(en,mn,rt),qn={reframe:{anchor:Kt?Kt.anchor:jn,shift:jn}};this.props.updateNextViewRangeTime(qn)},this._handleReframeDragEnd=({manager:rt,value:xt})=>{const{current:Kt,reframe:en}=this.props.viewRangeTime,[mn,jn]=Kt,Vn=le(mn,jn,xt),qn=en?en.anchor:Vn,[Us,Is]=Vn<qn?[Vn,qn]:[qn,Vn];rt.resetBounds(),this.props.updateViewRangeTime(Us,Is,"timeline-header")},this._draggerReframe=new G.default({getBounds:this._getDraggingBounds,onDragEnd:this._handleReframeDragEnd,onDragMove:this._handleReframeDragUpdate,onDragStart:this._handleReframeDragUpdate,onMouseLeave:this._handleReframeMouseLeave,onMouseMove:this._handleReframeMouseMove}),this._root=void 0}UNSAFE_componentWillReceiveProps(Ye){const{boundsInvalidator:rt}=this.props;rt!==Ye.boundsInvalidator&&this._draggerReframe.resetBounds()}componentWillUnmount(){this._draggerReframe.dispose()}render(){const{viewRangeTime:Ye}=this.props,{current:rt,cursor:xt,reframe:Kt,shiftEnd:en,shiftStart:mn}=Ye,[jn,Vn]=rt,qn=Kt!=null||en!=null||mn!=null;let Us;!qn&&xt!=null&&xt>=jn&&xt<=Vn&&(Us=`${_(jn,Vn,xt)*100}%`);const Is=se();return(0,n.jsxs)("div",{"aria-hidden":!0,className:Is.TimelineViewingLayer,ref:this._setRoot,onMouseDown:this._draggerReframe.handleMouseDown,onMouseLeave:this._draggerReframe.handleMouseLeave,onMouseMove:this._draggerReframe.handleMouseMove,"data-testid":"TimelineViewingLayer",children:[Us!=null&&(0,n.jsx)("div",{className:Is.TimelineViewingLayerCursorGuide,style:{left:Us},"data-testid":"TimelineViewingLayer--cursorGuide"}),Kt!=null&&ae(jn,Vn,Kt.anchor,Kt.shift,!1),en!=null&&ae(jn,Vn,Vn,en,!0),mn!=null&&ae(jn,Vn,jn,mn,!0)]})}}const J=$e=>({TimelineHeaderRow:(0,s.css)`
      label: TimelineHeaderRow;
      background: ${(0,d.R)($e,"#ececec")};
      border-bottom: 1px solid ${(0,d.R)($e,"#ccc")};
      height: 38px;
      line-height: 38px;
      width: 100%;
      z-index: 4;
      position: relative;
    `,TimelineHeaderRowTitle:(0,s.css)`
      label: TimelineHeaderRowTitle;
      flex: 1;
      overflow: hidden;
      margin: 0;
      text-overflow: ellipsis;
      white-space: nowrap;
    `,TimelineHeaderWrapper:(0,s.css)`
      label: TimelineHeaderWrapper;
      align-items: center;
      display: flex;
      padding-left: ${$e.spacing(1)};
      padding-right: ${$e.spacing(1)};
    `});function ee($e){const{duration:Ye,nameColumnWidth:rt,numTicks:xt,onCollapseAll:Kt,onCollapseOne:en,onColummWidthChange:mn,onExpandAll:jn,onExpandOne:Vn,updateViewRangeTime:qn,updateNextViewRangeTime:Us,viewRangeTime:Is,columnResizeHandleHeight:$s}=$e,[Vs,Ra]=Is.current,ga=(0,o.of)(J);return(0,n.jsxs)(W,{className:ga.TimelineHeaderRow,"data-testid":"TimelineHeaderRow",children:[(0,n.jsxs)(W.Cell,{className:ga.TimelineHeaderWrapper,width:rt,children:[(0,n.jsx)("h4",{className:ga.TimelineHeaderRowTitle,children:"Service & Operation"}),(0,n.jsx)(q,{onCollapseAll:Kt,onExpandAll:jn,onCollapseOne:en,onExpandOne:Vn})]}),(0,n.jsxs)(W.Cell,{width:1-rt,children:[(0,n.jsx)(oe,{boundsInvalidator:rt,updateNextViewRangeTime:Us,updateViewRangeTime:qn,viewRangeTime:Is}),(0,n.jsx)(B,{numTicks:xt,startTime:Vs*Ye,endTime:Ra*Ye,showLabels:!0})]}),(0,n.jsx)(H,{columnResizeHandleHeight:$s,position:rt,onChange:mn,min:.2,max:.85})]})}var de=e(2543),xe=e(41811),re=e(27746);const ue="peer.service";var Te=e(30700);class ge{constructor(Ye){this.ys=[],this.heights=[],this.bufferLen=Ye,this.dataLen=-1,this.lastI=-1}profileData(Ye){Ye!==this.dataLen&&(this.dataLen=Ye,this.ys.length=Ye,this.heights.length=Ye,this.lastI>=Ye&&(this.lastI=Ye-1))}calcHeights(Ye,rt,xt){xt!=null&&(this.lastI=xt);let Kt=Ye+this.bufferLen;if(Kt<=this.lastI)return;Kt>=this.heights.length&&(Kt=this.heights.length-1);let en=this.lastI;for(this.lastI===-1&&(en=0,this.ys[0]=0);en<=Kt;){const mn=this.heights[en]=rt(en);this.ys[en+1]=this.ys[en]+mn,en++}this.lastI=Kt}calcYs(Ye,rt){for(;(this.ys[this.lastI]==null||Ye>this.ys[this.lastI])&&this.lastI<this.dataLen-1;)this.calcHeights(this.lastI,rt)}confirmHeight(Ye,rt){let xt=Ye;if(xt>this.lastI){this.calcHeights(xt,rt);return}const Kt=rt(xt);if(Kt===this.heights[xt])return;const en=Kt-this.heights[xt];for(this.heights[xt]=Kt;++xt<=this.lastI;)this.ys[xt]+=en;this.ys[this.lastI+1]!=null&&(this.ys[this.lastI+1]+=en)}findFloorIndex(Ye,rt){this.calcYs(Ye,rt);let xt=0,Kt=this.lastI;if(this.ys.length<2||Ye<this.ys[1])return 0;if(Ye>this.ys[Kt])return Kt;let en;for(;xt<Kt;)if(en=xt+.5*(Kt-xt)|0,Ye>this.ys[en]){if(Ye<=this.ys[en+1])return en;xt=en}else if(Ye<this.ys[en]){if(Ye>=this.ys[en-1])return en-1;Kt=en}else return en;throw new Error(`unable to find floor index for y=${Ye}`)}getRowPosition(Ye,rt){return this.confirmHeight(Ye,rt),{height:this.heights[Ye],y:this.ys[Ye]}}getEstimatedHeight(){const Ye=this.ys[this.lastI]+this.heights[this.lastI];return this.lastI>=this.dataLen-1?Ye|0:Ye/(this.lastI+1)*this.heights.length|0}}const Oe=100;class Ue extends l.Component{constructor(Ye){super(Ye),this.getViewHeight=()=>this._viewHeight,this.getBottomVisibleIndex=()=>{const rt=this._scrollTop+this._viewHeight;return this._yPositions.findFloorIndex(rt,this._getHeight)},this.getTopVisibleIndex=()=>this._yPositions.findFloorIndex(this._scrollTop,this._getHeight),this.getRowPosition=rt=>this._yPositions.getRowPosition(rt,this._getHeight),this.scrollToIndex=(rt,xt)=>{const{scrollElement:Kt}=this.props,en=Kt?.getBoundingClientRect().top||0,jn=(Kt?.scrollTop||0)+(this._itemHolderElm?.getBoundingClientRect().top||0)-en,Vn=this.getRowPosition(rt).y;this.props.scrollElement?.scrollTo({top:Vn+jn-xt-80})},this._onScroll=()=>{this._isScrolledOrResized||(this._isScrolledOrResized=!0,window.requestAnimationFrame(this._positionList))},this._positionList=()=>{if(this._isScrolledOrResized=!1,!this._wrapperElm)return;this._calcViewIndexes();const rt=this.props.viewBufferMin>this._startIndex?0:this._startIndex-this.props.viewBufferMin,xt=this.props.viewBufferMin<this.props.dataLength-this._endIndex?this._endIndex+this.props.viewBufferMin:this.props.dataLength-1;(rt<this._startIndexDrawn||xt>this._endIndexDrawn)&&this.forceUpdate()},this._initWrapper=rt=>{this.props.windowScroller&&(this._wrapperElm=rt,rt&&(this._viewHeight=rt.clientHeight))},this._initItemHolder=rt=>{this._itemHolderElm=rt,this._scanItemHeights()},this._scanItemHeights=()=>{const rt=this.props.getIndexFromKey;if(!this._itemHolderElm)return;let xt=null,Kt=null,en=!1;const mn=this._itemHolderElm.childNodes,jn=mn.length;for(let Vn=0;Vn<jn;Vn++){const qn=mn[Vn];if(qn instanceof HTMLElement){const Us=qn.getAttribute("data-item-key");if(!Us){console.warn("itemKey not found");continue}const $s=(qn.firstElementChild||qn).clientHeight,Vs=this._knownHeights.get(Us);$s!==Vs&&(this._knownHeights.set(Us,$s),en?Kt=Us:(en=!0,xt=Kt=Us))}}if(xt!=null&&Kt!=null){const Vn=rt(xt),qn=Kt===xt?Vn:rt(Kt);this._yPositions.calcHeights(qn,this._getHeight,Vn),this.forceUpdate()}},this._getHeight=rt=>{const xt=this.props.getKeyFromIndex(rt),Kt=this._knownHeights.get(xt);return Kt!=null&&Kt===Kt?Kt:this.props.itemHeightGetter(rt,xt)},this._yPositions=new ge(200),this._knownHeights=new Map,this._startIndexDrawn=2**20,this._endIndexDrawn=-(2**20),this._startIndex=0,this._endIndex=0,this._viewHeight=-1,this._scrollTop=-1,this._isScrolledOrResized=!1,this._htmlTopOffset=-1,this._windowScrollListenerAdded=!1,this._htmlElm=document.documentElement,this._wrapperElm=void 0,this._itemHolderElm=void 0}static{this.defaultProps={initialDraw:Oe,itemsWrapperClassName:"",windowScroller:!1}}componentDidMount(){if(this.props.windowScroller){if(this._wrapperElm){const{top:Ye}=this._wrapperElm.getBoundingClientRect();this._htmlTopOffset=Ye+this._htmlElm.scrollTop}window.addEventListener("scroll",this._onScroll),this._windowScrollListenerAdded=!0}else this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll)}componentDidUpdate(Ye){this._itemHolderElm&&this._scanItemHeights(),!this.props.windowScroller&&Ye.scrollElement!==this.props.scrollElement&&(Ye.scrollElement?.removeEventListener("scroll",this._onScroll),this._wrapperElm=this.props.scrollElement,this._wrapperElm?.addEventListener("scroll",this._onScroll))}componentWillUnmount(){this._windowScrollListenerAdded?window.removeEventListener("scroll",this._onScroll):this._wrapperElm?.removeEventListener("scroll",this._onScroll)}_isViewChanged(){if(!this._wrapperElm)return!1;const Ye=this.props.windowScroller,rt=Ye?this._htmlElm.clientHeight:this._wrapperElm.clientHeight,xt=Ye?this._htmlElm.scrollTop:this._wrapperElm.scrollTop;return rt!==this._viewHeight||xt!==this._scrollTop}_calcViewIndexes(){if(this.props.windowScroller)this._viewHeight=window.innerHeight-this._htmlTopOffset,this._scrollTop=window.scrollY;else{if(!this._wrapperElm){this._viewHeight=-1,this._startIndex=0,this._endIndex=0;return}this._viewHeight=this._wrapperElm.clientHeight,this._scrollTop=this._wrapperElm.scrollTop}const rt=this._scrollTop,xt=this._scrollTop+this._viewHeight;this._startIndex=this._yPositions.findFloorIndex(rt,this._getHeight),this._endIndex=this._yPositions.findFloorIndex(xt,this._getHeight)}render(){const{dataLength:Ye,getKeyFromIndex:rt,initialDraw:xt=Oe,itemRenderer:Kt,viewBuffer:en,viewBufferMin:mn}=this.props,jn=this._getHeight,Vn=[];let qn,Us;if(this._yPositions.profileData(Ye),!this._wrapperElm)qn=0,Us=(xt<Ye?xt:Ye)-1;else{this._isViewChanged()&&this._calcViewIndexes();const Vs=mn>this._startIndex?0:this._startIndex-mn,Ra=mn<Ye-this._endIndex?this._endIndex+mn:Ye-1;Vs<this._startIndexDrawn||Ra>this._endIndexDrawn?(qn=en>this._startIndex?0:this._startIndex-en,Us=this._endIndex+en,Us>=Ye&&(Us=Ye-1)):(qn=this._startIndexDrawn>Ye-1?0:this._startIndexDrawn,Us=this._endIndexDrawn>Ye-1?Ye-1:this._endIndexDrawn)}this._yPositions.calcHeights(Us,jn,qn||-1),this._startIndexDrawn=qn,this._endIndexDrawn=Us,Vn.length=Us-qn+1;for(let Vs=qn;Vs<=Us;Vs++){const{y:Ra,height:ga}=this._yPositions.getRowPosition(Vs,jn),Js={height:ga,top:Ra,position:"absolute"},ia=rt(Vs),Fa={"data-item-key":ia};Vn.push(Kt(ia,Js,Vs,Fa))}const Is={style:{position:"relative"},ref:this._initWrapper};this.props.windowScroller||(Is.onScroll=this._onScroll,Is.style.height="100%",Is.style.overflowY="auto");const $s={position:"relative",height:this._yPositions.getEstimatedHeight()};return(0,n.jsx)("div",{...Is,"data-testid":"ListView",children:(0,n.jsx)("div",{style:$s,children:(0,n.jsx)("div",{style:{position:"absolute",top:0,margin:0,padding:0},className:this.props.itemsWrapperClassName,ref:this._initItemHolder,children:Vn})})})}}const Xe="None",we="Duration",qe="Tag";function We({options:$e,onOptionsChange:Ye}){const rt=useStyles2(je),xt=[Xe,we,qe].map(toOption);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{className:rt.row,children:jsx(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:jsx(Select,{inputId:"label",options:xt,value:$e.jsonData.spanBar?.type||"",onChange:Kt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:$e},"spanBar",{...$e.jsonData.spanBar,type:Kt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),$e.jsonData.spanBar?.type===qe&&jsx(InlineFieldRow,{className:rt.row,children:jsx(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:jsx(Input,{type:"text",placeholder:"Enter tag key",onChange:Kt=>updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:$e},"spanBar",{...$e.jsonData.spanBar,tag:Kt.currentTarget.value}),value:$e.jsonData.spanBar?.tag||"",width:40})})})]})}const Ce=({options:$e,onOptionsChange:Ye})=>{let rt=$e.type;return rt+=$e.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",jsx(ConfigSubSection,{title:"Span bar",description:jsx(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:rt,feature:"the span bar"}),children:jsx(We,{options:$e,onOptionsChange:Ye})})},je=$e=>({infoText:css({label:"infoText",paddingBottom:$e.spacing(2),color:$e.colors.text.secondary}),row:css({label:"row",alignItems:"baseline"})});var Ke=e(14578),_e=e(13544),Fe=e(56034),at=e(95868),Ct=e(13840);function Dt({children:$e,content:Ye,overlayClassName:rt}){const xt=(0,l.useRef)(null);return(0,n.jsx)(at.I,{content:Ye,hideAfter:300,children:(Kt,en,mn)=>(0,n.jsxs)(n.Fragment,{children:[xt.current&&(0,n.jsx)(Ct.A,{...mn,referenceElement:xt.current,wrapperClassName:rt,onMouseLeave:en,onMouseEnter:Kt}),(0,l.cloneElement)($e,{ref:xt,onMouseEnter:Kt,onMouseLeave:en})]})})}const tt="label";var ze=e(55852);const pe=()=>({CopyIcon:(0,s.css)`
      background-color: transparent;
      border: none;
      color: inherit;
      height: 100%;
      overflow: hidden;
      &:focus {
        background-color: rgba(255, 255, 255, 0.25);
        color: inherit;
      }
    `});function Se({copyText:$e,icon:Ye="copy",tooltipTitle:rt}){const xt=(0,o.of)(pe),[Kt,en]=(0,l.useState)(!1),mn=()=>{navigator.clipboard.writeText($e),en(!0)};return(0,n.jsx)(Fe.m,{content:Kt?"Copied":rt,children:(0,n.jsx)(ze.$n,{className:h()(xt.CopyIcon),type:"button",icon:Ye,onClick:mn})})}var fe=e(72834),Ee=e.n(fe);const Pe="copyIcon",he=$e=>({KeyValueTable:(0,s.css)`
      label: KeyValueTable;
      background: ${(0,d.R)($e,"#fff")};
      border: 1px solid ${(0,d.R)($e,"#ddd")};
      margin-bottom: 0.5rem;
      max-height: 450px;
      overflow: auto;
    `,table:(0,s.css)({width:"100%"}),body:(0,s.css)`
      label: body;
      vertical-align: baseline;
    `,row:(0,s.css)`
      label: row;
      & > td {
        padding: 0rem 0.5rem;
        height: 30px;
      }
      &:nth-child(2n) > td {
        background: ${(0,d.R)($e,"#f5f5f5")};
      }
      &:not(:hover) .${Pe} {
        visibility: hidden;
      }
    `,keyColumn:(0,s.css)`
      label: keyColumn;
      color: ${(0,d.R)($e,"#888")};
      white-space: pre;
      width: 125px;
    `,copyColumn:(0,s.css)`
      label: copyColumn;
      text-align: right;
    `,linkIcon:(0,s.css)`
      label: linkIcon;
      vertical-align: middle;
      font-weight: bold;
    `,jsonTable:(0,s.css)({display:"inline-block"})}),be=/^(\[|\{)/;function Ae($e){if(typeof $e=="string"&&be.test($e))try{return JSON.parse($e)}catch{}return $e}const De=({href:$e,title:Ye="",children:rt})=>(0,n.jsxs)("a",{href:$e,title:Ye,target:"_blank",rel:"noopener noreferrer",children:[rt," ",(0,n.jsx)(Ke.I,{name:"external-link-alt"})]});function Ie($e){const{data:Ye,linksGetter:rt}=$e,xt=(0,o.of)(he);return(0,n.jsx)("div",{className:h()(xt.KeyValueTable),"data-testid":"KeyValueTable",children:(0,n.jsx)("table",{className:xt.table,children:(0,n.jsx)("tbody",{className:xt.body,children:Ye.map((Kt,en)=>{const mn={__html:Ee()(Ae(Kt.value))},jn=(0,n.jsx)("div",{className:xt.jsonTable,dangerouslySetInnerHTML:mn}),Vn=rt?rt(Ye,en):null;let qn;return Vn&&Vn.length?qn=(0,n.jsx)("div",{children:(0,n.jsx)(De,{href:Vn[0].url,title:Vn[0].text,children:jn})}):qn=jn,(0,n.jsxs)("tr",{className:xt.row,children:[(0,n.jsx)("td",{className:xt.keyColumn,"data-testid":"KeyValueTable--keyColumn",children:Kt.key}),(0,n.jsx)("td",{children:qn}),(0,n.jsx)("td",{className:xt.copyColumn,children:(0,n.jsx)(Se,{className:Pe,copyText:JSON.stringify(Kt,null,2),tooltipTitle:"Copy JSON"})})]},`${Kt.key}-${en}`)})})})})}var ke=e(11908),dt=e(72724),Pt=e(39601),pt=e(14689),Tt=e(25994),jt=e(21744),$t=e(19071),sn=e(28114);const Yt=$e=>Ye=>({LabeledList:(0,s.css)`
      label: LabeledList;
      list-style: none;
      margin: 0;
      padding: 0;
      ${$e&&`
        margin-right: -8px;
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
      `}
    `,LabeledListItem:(0,s.css)`
      label: LabeledListItem;
      display: inline-block;
      ${$e&&`
        border-right: 1px solid ${(0,d.R)(Ye,"#ddd")};
        padding: 0 8px;
      `}
    `,LabeledListLabel:(0,s.css)`
      label: LabeledListLabel;
      color: ${Ye.isLight?"#999":"#666"};
      margin-right: 0.25rem;
    `,LabeledListValue:(0,s.css)`
      label: LabeledListValue;
      ${!$e&&"margin-right: 0.55rem;"}
    `});function qt($e){const{className:Ye,divider:rt=!1,items:xt}=$e,Kt=(0,o.of)(Yt(rt));return(0,n.jsx)("ul",{className:h()(Kt.LabeledList,Ye),children:xt.map(({key:en,label:mn,value:jn})=>(0,n.jsxs)("li",{className:Kt.LabeledListItem,children:[(0,n.jsx)("span",{className:Kt.LabeledListLabel,children:mn}),(0,n.jsx)("strong",{className:Kt.LabeledListValue,children:jn})]},`${en}`))})}const bn="kind",Mt="status",Jt="status.message",Ut="library.name",Gt="library.version",Lt="trace.state",At="id";var Nt=e(92102);function Dn($e){const{reference:Ye,children:rt,createFocusSpanLink:xt}=$e,Kt=xt(Ye.traceID,Ye.spanID);return(0,n.jsx)("a",{href:Kt.href,target:Kt.target,rel:"noopener noreferrer",onClick:Kt.onClick?en=>{en.preventDefault(),Kt.onClick(en)}:void 0,children:rt})}const An=$e=>({AccordianReferenceItem:(0,s.css)`
      border-bottom: 1px solid ${(0,d.R)($e,"#d8d8d8")};
    `,AccordianKeyValues:(0,s.css)`
      margin-left: 10px;
    `,AccordianReferences:(0,s.css)`
      label: AccordianReferences;
      border: 1px solid ${(0,d.R)($e,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianReferencesHeader:(0,s.css)`
      label: AccordianReferencesHeader;
      background: ${(0,d.R)($e,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,d.R)($e,"#dadada")};
      }
    `,AccordianReferencesContent:(0,s.css)`
      label: AccordianReferencesContent;
      background: ${(0,d.R)($e,"#f0f0f0")};
      border-top: 1px solid ${(0,d.R)($e,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianReferencesFooter:(0,s.css)`
      label: AccordianReferencesFooter;
      color: ${(0,d.R)($e,"#999")};
    `,AccordianKeyValuesItem:(0,s.css)({marginBottom:$e.spacing(.5)}),ReferencesList:(0,s.css)`
      background: #fff;
      border: 1px solid #ddd;
      margin-bottom: 0.7em;
      max-height: 450px;
      overflow: auto;
    `,list:(0,s.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
      background: #fff;
    `,itemContent:(0,s.css)`
      padding: 0.25rem 0.5rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    `,item:(0,s.css)`
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `,debugInfo:(0,s.css)`
      letter-spacing: 0.25px;
      margin: 0.5em 0 0;
      flex-wrap: wrap;
      display: flex;
      justify-content: flex-end;
    `,debugLabel:(0,s.css)`
      margin: 0 5px 0 5px;
      &::before {
        color: #bbb;
        content: attr(data-label);
      }
    `,serviceName:(0,s.css)`
      margin-right: 8px;
    `,title:(0,s.css)`
      display: flex;
      align-items: center;
      gap: 4px;
    `});function Pn($e){const{data:Ye,createFocusSpanLink:rt,openedItems:xt,onItemToggle:Kt,interactive:en}=$e,mn=(0,o.of)(An);return(0,n.jsx)("div",{className:mn.AccordianReferencesContent,children:Ye.map((jn,Vn)=>(0,n.jsxs)("div",{className:Vn<Ye.length-1?mn.AccordianReferenceItem:void 0,children:[(0,n.jsx)("div",{className:mn.item,children:(0,n.jsx)(Dn,{reference:jn,createFocusSpanLink:rt,children:(0,n.jsxs)("span",{className:mn.itemContent,children:[jn.span?(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:(0,s.cx)("span-svc-name",mn.serviceName),children:jn.span.process.serviceName}),(0,n.jsx)("small",{className:"endpoint-name",children:jn.span.operationName})]}):(0,n.jsxs)("span",{className:(0,s.cx)("span-svc-name",mn.title),children:["View Linked Span ",(0,n.jsx)(Ke.I,{name:"external-link-alt"})]}),(0,n.jsxs)("small",{className:mn.debugInfo,children:[(0,n.jsx)("span",{className:mn.debugLabel,"data-label":"TraceID:",children:jn.traceID}),(0,n.jsx)("span",{className:mn.debugLabel,"data-label":"SpanID:",children:jn.spanID})]})]})})},`${jn.spanID}`),!!jn.tags?.length&&(0,n.jsx)("div",{className:mn.AccordianKeyValues,children:(0,n.jsx)(pn,{className:Vn<Ye.length-1?mn.AccordianKeyValuesItem:null,data:jn.tags||[],highContrast:!0,interactive:en,isOpen:xt?xt.has(jn):!1,label:"attributes",linksGetter:null,onToggle:en&&Kt?()=>Kt(jn):null})})]},Vn))})}const Xn=({data:$e,interactive:Ye=!0,isOpen:rt,onToggle:xt,onItemToggle:Kt,openedItems:en,createFocusSpanLink:mn})=>{const jn=!Array.isArray($e)||!$e.length;let Vn=null,qn="span",Us=null;Ye&&(Vn=rt?(0,n.jsx)(Ke.I,{name:"angle-down",className:Zn}):(0,n.jsx)(Ke.I,{name:"angle-right",className:Zn}),qn="a",Us={"aria-checked":rt,onClick:jn?null:xt,role:"switch"});const Is=(0,o.of)(An);return(0,n.jsxs)("div",{className:Is.AccordianReferences,children:[(0,n.jsxs)(qn,{className:Is.AccordianReferencesHeader,...Us,children:[Vn,(0,n.jsx)("strong",{children:(0,n.jsx)("span",{children:"References"})})," ","(",$e.length,")"]}),rt&&(0,n.jsx)(Pn,{data:$e,openedItems:en,createFocusSpanLink:mn,onItemToggle:Kt,interactive:Ye})]})},Tn=l.memo(Xn),ht=()=>({TextList:(0,s.css)`
      max-height: 450px;
      overflow: auto;
    `,List:(0,s.css)`
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
    `,item:(0,s.css)`
      padding: 0.25rem 0.5rem;
      vertical-align: top;
      &:nth-child(2n) {
        background: #f5f5f5;
      }
    `});function St($e){const{data:Ye}=$e,rt=(0,o.of)(ht);return(0,n.jsx)("div",{className:h()(rt.TextList),"data-testid":"TextList",children:(0,n.jsx)("ul",{className:rt.List,children:Ye.map((xt,Kt)=>(0,n.jsx)("li",{className:rt.item,children:xt},`${Kt}`))})})}const Ge=$e=>({header:(0,s.css)`
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,d.R)($e,"#e8e8e8")};
      }
    `});function Ve({data:$e}){return(0,n.jsx)(St,{data:$e})}function lt({className:$e=null,data:Ye,headerClassName:rt,highContrast:xt=!1,interactive:Kt=!0,isOpen:en,label:mn,onToggle:jn=null,TextComponent:Vn=Ve}){const qn=!Array.isArray(Ye)||!Ye.length,Us=(0,o.of)(Ht),Is=h()(Zn,{[Us.emptyIcon]:qn});let $s=null,Vs=null;Kt&&($s=en?(0,n.jsx)(Ke.I,{name:"angle-down",className:Is}):(0,n.jsx)(Ke.I,{name:"angle-right",className:Is}),Vs={"aria-checked":en,onClick:qn?null:jn,role:"switch"});const Ra=(0,o.of)(Ge);return(0,n.jsxs)("div",{className:$e||"",children:[(0,n.jsxs)("div",{className:h()(Ra.header,rt),...Vs,"data-testid":"AccordianText--header",children:[$s,(0,n.jsx)("strong",{children:mn})," (",Ye.length,")"]}),en&&(0,n.jsx)(Vn,{data:Ye})]})}var It=e(49185),Qe=e(75505),vt=e(47232),Ot=e(41987),zt=e(85194),vn=e(26657),ln=e(72574),On=e(31193);function wn($e){const{span:Ye,traceToProfilesOptions:rt,timeZone:xt,traceFlameGraphs:Kt,setTraceFlameGraphs:en,setRedrawListView:mn,traceDuration:jn,traceName:Vn}=$e,[qn,{height:Us}]=(0,It.A)(),Is=(0,o.of)(Un),$s=Ye.tags.filter(ia=>ia.key===sn.QW),Vs=$s.length>0?$s[0].value:void 0,Ra=(0,l.useCallback)(()=>{const ia=Math.floor(Ye.startTime/1e3)-3e4,Fa=(Ye.startTime+Ye.duration)/1e3+3e4,Ya=(0,vt.KQ)(Fa),ma=(0,vt.KQ)(ia);return{from:ma,to:Ya,raw:{from:ma,to:Ya}}},[Ye.duration,Ye.startTime]),ga=async(ia,Fa)=>{const Ya=await(0,On.tR)().get(Fa);if(Ya instanceof vn.iy){const Wa=(await(0,Qe.s)(Ya.query(ia))).data.find(Tr=>Tr.name==="response");if(Wa&&Wa.length>1)return Wa}},Js=(0,l.useCallback)(async(ia,Fa,Ya)=>{let ma="{}";if(Fa.customQuery&&Fa.query){const Jr={...(0,sn.gt)(jn,Vn,Ya.traceID),...(0,sn.hv)(Ya),...(0,sn.Cr)(Ya,Fa)};ma=(0,ln.w)().replace(Fa.query,Jr)}else{const Jr=Fa.tags&&Fa.tags.length>0?Fa.tags:sn.i0;ma=`{${(0,sn._o)(Ya,Jr)}}`}const Wa={requestId:"span-flamegraph-requestId",interval:"2s",intervalMs:2e3,range:Ra(),scopedVars:{},app:Ot.Jk.Unknown,timezone:xt,startTime:Ya.startTime,targets:[{labelSelector:ma,groupBy:[],profileTypeId:Fa.profileTypeId??"",queryType:"profile",spanSelector:[Vs],refId:"span-flamegraph-refId",datasource:{type:ia.type,uid:ia.uid}}]},Tr=await ga(Wa,ia.uid);Tr&&Tr.length>0&&en({...Kt,[Vs]:Tr})},[Ra,Vs,en,xt,jn,Kt,Vn]);return(0,l.useEffect)(()=>{if(!Object.keys(Kt).includes(Vs)){let ia;rt&&rt?.datasourceUid&&(ia=(0,On.tR)().getInstanceSettings(rt.datasourceUid)),rt&&ia&&Js(ia,rt,Ye)}},[en,Ye,Kt,rt,Ra,xt,Js,Vs]),(0,l.useEffect)(()=>{mn({})},[Us,mn]),Kt[Vs]?(0,n.jsxs)("div",{className:Is.flameGraph,ref:qn,children:[(0,n.jsx)("div",{className:Is.flameGraphTitle,children:"Flame graph"}),(0,n.jsx)(zt.A,{data:Kt[Vs],getTheme:()=>i.$.theme2,showFlameGraphOnly:!0,disableCollapsing:!0})]}):(0,n.jsx)(n.Fragment,{})}const Un=()=>({flameGraph:(0,s.css)({label:"flameGraphInSpan",margin:"5px"}),flameGraphTitle:(0,s.css)({label:"flameGraphTitleInSpan",marginBottom:"5px",fontWeight:"bold"})}),cs=$e=>({header:(0,s.css)`
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 0 1rem;
      margin-bottom: 0.25rem;
    `,listWrapper:(0,s.css)`
      overflow: hidden;
    `,list:(0,s.css)({textAlign:"right"}),operationName:(0,s.css)({margin:0}),debugInfo:(0,s.css)`
      label: debugInfo;
      display: block;
      letter-spacing: 0.25px;
      margin: 0.5em 0 -0.75em;
      text-align: right;
    `,debugLabel:(0,s.css)`
      label: debugLabel;
      &::before {
        color: ${(0,d.R)($e,"#bbb")};
        content: attr(data-label);
      }
    `,debugValue:(0,s.css)`
      label: debugValue;
      background-color: inherit;
      border: none;
      color: ${(0,d.R)($e,"#888")};
      cursor: pointer;
      &:hover {
        color: ${(0,d.R)($e,"#333")};
      }
    `,AccordianWarnings:(0,s.css)`
      label: AccordianWarnings;
      background: ${(0,d.R)($e,"#fafafa")};
      border: 1px solid ${(0,d.R)($e,"#e4e4e4")};
      margin-bottom: 0.25rem;
    `,AccordianWarningsHeader:(0,s.css)`
      label: AccordianWarningsHeader;
      background: ${(0,d.R)($e,"#fff7e6")};
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,d.R)($e,"#ffe7ba")};
      }
    `,AccordianWarningsHeaderOpen:(0,s.css)`
      label: AccordianWarningsHeaderOpen;
      border-bottom: 1px solid ${(0,d.R)($e,"#e8e8e8")};
    `,AccordianWarningsLabel:(0,s.css)`
      label: AccordianWarningsLabel;
      color: ${(0,d.R)($e,"#d36c08")};
    `,AccordianKeyValuesItem:(0,s.css)({marginBottom:$e.spacing(.5)}),Textarea:(0,s.css)`
      word-break: break-all;
      white-space: pre;
    `,LinkIcon:(0,s.css)`
      font-size: 1.5em;
    `,linkList:(0,s.css)({display:"flex",flexWrap:"wrap",gap:"10px"})}),Zn=(0,s.css)({margin:"-0.2rem 0.25rem 0 0"});function wt($e){const{detailState:Ye,linksGetter:rt,logItemToggle:xt,logsToggle:Kt,processToggle:en,span:mn,tagsToggle:jn,traceStartTime:Vn,traceDuration:qn,traceName:Us,warningsToggle:Is,stackTracesToggle:$s,referencesToggle:Vs,referenceItemToggle:Ra,createSpanLink:ga,createFocusSpanLink:Js,datasourceType:ia,traceFlameGraphs:Fa,setTraceFlameGraphs:Ya,traceToProfilesOptions:ma,setRedrawListView:Wa}=$e,{isTagsOpen:Tr,isProcessOpen:Jr,logs:_r,isWarningsOpen:Mr,references:Ka,isStackTracesOpen:Vo}=Ye,{operationName:ei,process:to,duration:Ao,relativeStartTime:Oi,startTime:zo,traceID:ti,spanID:br,logs:As,tags:ya,warnings:ws,references:Da,stackTraces:jr}=mn,{timeZone:Zr}=$e;let nt=[{key:"svc",label:"Service:",value:to.serviceName},{key:"duration",label:"Duration:",value:(0,y.a3)(Ao)},{key:"start",label:"Start Time:",value:(0,y.a3)(Oi)+Ft(zo,Zr)},...mn.childSpanCount>0?[{key:"child_count",label:"Child Count:",value:mn.childSpanCount}]:[]];const Le=(0,o.of)(cs);mn.kind&&nt.push({key:bn,label:"Kind:",value:mn.kind}),mn.statusCode!==void 0&&nt.push({key:Mt,label:"Status:",value:ke.s[mn.statusCode].toLowerCase()}),mn.statusMessage&&nt.push({key:Jt,label:"Status Message:",value:mn.statusMessage}),mn.instrumentationLibraryName&&nt.push({key:Ut,label:"Library Name:",value:mn.instrumentationLibraryName}),mn.instrumentationLibraryVersion&&nt.push({key:Gt,label:"Library Version:",value:mn.instrumentationLibraryVersion}),mn.traceState&&nt.push({key:Lt,label:"Trace State:",value:mn.traceState});const et=(Cn,as,ts,_s)=>(0,n.jsx)(pt.R,{link:{...Cn,title:ts,target:"_blank",origin:Cn.field,onClick:Fs=>{(0,r.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:ia,grafana_version:i.$.buildInfo.version,type:as,location:"spanDetails"}),Cn.onClick?Cn.onClick?.(Fs):Pt.Ny.push(Cn.href)}},buttonProps:{icon:_s}});let mt=null,kt=null,yn=null;if(ga){const Cn=ga(mn),as=Cn?.filter(Fs=>Fs.type===Nt.N.Logs);Cn&&as&&as.length>0&&(mt=et(as[0],Nt.N.Logs,"Logs for this span","gf-logs"));const ts=Cn?.filter(Fs=>Fs.type===Nt.N.Profiles&&Fs.title===$t.cd);Cn&&ts&&ts.length>0&&(kt=et(ts[0],Nt.N.Profiles,"Profiles for this span","link"));const _s=Cn?.filter(Fs=>Fs.type===Nt.N.Session);Cn&&_s&&_s.length>0&&(yn=et(_s[0],Nt.N.Session,"Session for this span","frontend-observability"))}const fn=Js(ti,br);return(0,n.jsxs)("div",{"data-testid":"span-detail-component",children:[(0,n.jsxs)("div",{className:Le.header,children:[(0,n.jsx)("h2",{className:Le.operationName,children:ei}),(0,n.jsx)("div",{className:Le.listWrapper,children:(0,n.jsx)(qt,{className:Le.list,divider:!0,items:nt})})]}),(0,n.jsxs)("div",{className:Le.linkList,children:[mt,kt,yn]}),(0,n.jsx)(Tt.c,{spacing:1}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(pn,{data:ya,label:"Span Attributes",linksGetter:rt,isOpen:Tr,onToggle:()=>jn(br)}),to.tags&&(0,n.jsx)(pn,{className:Le.AccordianKeyValuesItem,data:to.tags,label:"Resource Attributes",linksGetter:rt,isOpen:Jr,onToggle:()=>en(br)})]}),As&&As.length>0&&(0,n.jsx)(Qn,{linksGetter:rt,logs:As,isOpen:_r.isOpen,openedItems:_r.openedItems,onToggle:()=>Kt(br),onItemToggle:Cn=>xt(br,Cn),timestamp:Vn}),ws&&ws.length>0&&(0,n.jsx)(lt,{className:Le.AccordianWarnings,headerClassName:Le.AccordianWarningsHeader,label:(0,n.jsx)("span",{className:Le.AccordianWarningsLabel,children:"Warnings"}),data:ws,isOpen:Mr,onToggle:()=>Is(br)}),jr?.length?(0,n.jsx)(lt,{label:"Stack trace",data:jr,isOpen:Vo,TextComponent:Cn=>{let as;return Cn.data?.length>1?as=Cn.data.map((ts,_s)=>`StackTrace ${_s+1}:
${ts}`).join(`
`):as=Cn.data?.[0],(0,n.jsx)(jt.f,{className:Le.Textarea,style:{cursor:"unset"},readOnly:!0,cols:10,rows:10,value:as})},onToggle:()=>$s(br)}):null,Da&&Da.length>0&&(Da.length>1||Da[0].refType!=="CHILD_OF")&&(0,n.jsx)(Tn,{data:Da,isOpen:Ka.isOpen,openedItems:Ka.openedItems,onToggle:()=>Vs(br),onItemToggle:Cn=>Ra(br,Cn),createFocusSpanLink:Js}),mn.tags.some(Cn=>Cn.key===sn.QW)&&(0,n.jsx)(wn,{span:mn,timeZone:Zr,traceFlameGraphs:Fa,setTraceFlameGraphs:Ya,traceToProfilesOptions:ma,setRedrawListView:Wa,traceDuration:qn,traceName:Us}),(0,n.jsxs)("small",{className:Le.debugInfo,children:[(0,n.jsx)("a",{...fn,onClick:Cn=>{fn.onClick&&Cn.button===0&&(!Cn.currentTarget.target||Cn.currentTarget.target==="_self")&&!(Cn.metaKey||Cn.altKey||Cn.ctrlKey||Cn.shiftKey)&&(Cn.preventDefault(),fn.onClick(Cn))},children:(0,n.jsx)(Ke.I,{name:"link",className:h()(Zn,Le.LinkIcon)})}),(0,n.jsx)("span",{className:Le.debugLabel,"data-label":"SpanID:"})," ",br]})]})]})}const Ft=($e,Ye)=>{const rt=(0,dt.LE)($e/1e3,{timeZone:Ye,defaultWithMS:!0}),xt=rt.split(" ");return` (${xt[1]?xt[1]:rt})`},Ht=$e=>({container:(0,s.css)({textOverflow:"ellipsis"}),header:(0,s.css)`
      label: header;
      cursor: pointer;
      overflow: hidden;
      padding: 0.25em 0.1em;
      text-overflow: ellipsis;
      white-space: nowrap;
      &:hover {
        background: ${(0,d.R)($e,"#e8e8e8")};
      }
    `,headerEmpty:(0,s.css)`
      label: headerEmpty;
      background: none;
      cursor: initial;
    `,headerHighContrast:(0,s.css)`
      label: headerHighContrast;
      &:hover {
        background: ${(0,d.R)($e,"#ddd")};
      }
    `,emptyIcon:(0,s.css)`
      label: emptyIcon;
      color: ${(0,d.R)($e,"#aaa")};
    `,summary:(0,s.css)`
      label: summary;
      display: inline;
      list-style: none;
      padding: 0;
    `,summaryItem:(0,s.css)`
      label: summaryItem;
      display: inline;
      margin-left: 0.7em;
      padding-right: 0.5rem;
      border-right: 1px solid ${(0,d.R)($e,"#ddd")};
      &:last-child {
        padding-right: 0;
        border-right: none;
      }
    `,summaryLabel:(0,s.css)`
      label: summaryLabel;
      color: ${(0,d.R)($e,"#777")};
    `,summaryDelim:(0,s.css)`
      label: summaryDelim;
      color: ${(0,d.R)($e,"#bbb")};
      padding: 0 0.2em;
    `});function ut({data:$e=null}){const Ye=(0,o.of)(Ht);return!Array.isArray($e)||!$e.length?null:(0,n.jsx)("ul",{className:Ye.summary,children:$e.map((rt,xt)=>(0,n.jsxs)("li",{className:Ye.summaryItem,children:[(0,n.jsx)("span",{className:Ye.summaryLabel,children:rt.key}),(0,n.jsx)("span",{className:Ye.summaryDelim,children:"="}),String(rt.value)]},`${rt.key}-${xt}`))})}function pn({className:$e=null,data:Ye,highContrast:rt=!1,interactive:xt=!0,isOpen:Kt,label:en,linksGetter:mn,onToggle:jn=null}){const Vn=!Array.isArray(Ye)||!Ye.length,qn=(0,o.of)(Ht),Us=h()(Zn,{[qn.emptyIcon]:Vn});let Is=null,$s=null;return xt&&(Is=Kt?(0,n.jsx)(Ke.I,{name:"angle-down",className:Us}):(0,n.jsx)(Ke.I,{name:"angle-right",className:Us}),$s={"aria-checked":Kt,onClick:Vn?null:jn,role:"switch"}),(0,n.jsxs)("div",{className:h()($e,qn.container),children:[(0,n.jsxs)("div",{className:h()(qn.header,{[qn.headerEmpty]:Vn,[qn.headerHighContrast]:rt&&!Vn}),...$s,"data-testid":"AccordianKeyValues--header",children:[Is,(0,n.jsxs)("strong",{"data-test":tt,children:[en,Kt||":"]}),!Kt&&(0,n.jsx)(ut,{data:Ye})]}),Kt&&(0,n.jsx)(Ie,{data:Ye,linksGetter:mn})]})}const Jn=$e=>({AccordianLogs:(0,s.css)`
      label: AccordianLogs;
      border: 1px solid ${(0,d.R)($e,"#d8d8d8")};
      position: relative;
      margin-bottom: 0.25rem;
    `,AccordianLogsHeader:(0,s.css)`
      label: AccordianLogsHeader;
      background: ${(0,d.R)($e,"#e4e4e4")};
      color: inherit;
      display: block;
      padding: 0.25rem 0.5rem;
      &:hover {
        background: ${(0,d.R)($e,"#dadada")};
      }
    `,AccordianLogsContent:(0,s.css)`
      label: AccordianLogsContent;
      background: ${(0,d.R)($e,"#f0f0f0")};
      border-top: 1px solid ${(0,d.R)($e,"#d8d8d8")};
      padding: 0.5rem 0.5rem 0.25rem 0.5rem;
    `,AccordianLogsFooter:(0,s.css)`
      label: AccordianLogsFooter;
      color: ${(0,d.R)($e,"#999")};
    `,AccordianKeyValuesItem:(0,s.css)({marginBottom:$e.spacing(.5)})});function Qn({interactive:$e=!0,isOpen:Ye,linksGetter:rt,logs:xt,openedItems:Kt,onItemToggle:en,onToggle:mn,timestamp:jn}){let Vn=null,qn="span",Us=null;$e&&(Vn=Ye?(0,n.jsx)(Ke.I,{name:"angle-down",className:Zn}):(0,n.jsx)(Ke.I,{name:"angle-right",className:"u-align-icon"}),qn="a",Us={"aria-checked":Ye,onClick:mn,role:"switch"});const Is=(0,o.of)(Jn);return(0,n.jsxs)("div",{className:Is.AccordianLogs,children:[(0,n.jsxs)(qn,{className:Is.AccordianLogsHeader,...Us,children:[Vn," ",(0,n.jsx)("strong",{children:"Events"})," (",xt.length,")"]}),Ye&&(0,n.jsxs)("div",{className:Is.AccordianLogsContent,children:[(0,de.sortBy)(xt,"timestamp").map(($s,Vs)=>(0,n.jsx)(pn,{className:Vs<xt.length-1?Is.AccordianKeyValuesItem:null,data:$s.fields||[],highContrast:!0,interactive:$e,isOpen:Kt?Kt.has($s):!1,label:`${(0,y.a3)($s.timestamp-jn)}`,linksGetter:rt,onToggle:$e&&en?()=>en($s):null},`${$s.timestamp}-${Vs}`)),(0,n.jsx)("small",{className:Is.AccordianLogsFooter,children:"Log timestamps are relative to the start time of the full trace."})]})]})}const fs=$e=>({wrapper:(0,s.css)({label:"wrapper",bottom:0,left:0,position:"absolute",right:0,top:0,overflow:"hidden",zIndex:0}),bar:(0,s.css)({label:"bar",borderRadius:$e.shape.radius.default,minWidth:"2px",position:"absolute",height:"36%",top:"32%"}),rpc:(0,s.css)({label:"rpc",position:"absolute",top:"35%",bottom:"35%",zIndex:1}),label:(0,s.css)({label:"label",color:"#aaa",fontSize:"12px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans - serif",lineHeight:"1em",whiteSpace:"nowrap",padding:"0 0.5em",position:"absolute"}),logMarker:(0,s.css)({label:"logMarker",backgroundColor:(0,d.R)($e,"#2c3235"),cursor:"pointer",height:"60%",minWidth:"1px",position:"absolute",top:"20%","&:hover":{backgroundColor:(0,d.R)($e,"#464c54")},"&::before, &::after":{content:"''",position:"absolute",top:0,bottom:0,right:0,border:"1px solid transparent"},"&::after":{left:0}}),criticalPath:(0,s.css)({position:"absolute",top:"45%",height:"11%",zIndex:2,overflow:"hidden",background:(0,d.R)($e,"#f1f1f1"),borderLeft:`1px solid ${(0,d.R)($e,"#2c3235")}`,borderRight:`1px solid ${(0,d.R)($e,"#2c3235")}`})});function ls($e){return`${($e*100).toFixed(1)}%`}function vs($e){return`${$e*100}%`}function ea({criticalPath:$e,viewEnd:Ye,viewStart:rt,getViewedBounds:xt,color:Kt,shortLabel:en,longLabel:mn,onClick:jn,rpc:Vn,traceStartTime:qn,span:Us,className:Is,labelClassName:$s}){const[Vs,Ra]=(0,l.useState)(en),ga=()=>Ra(en),Js=()=>Ra(mn),ia=(0,de.groupBy)(Us.logs,Ya=>{const ma=xt(Ya.timestamp,Ya.timestamp).start;return ls(Math.round(ma*500)/500)}),Fa=(0,o.of)(fs);return(0,n.jsxs)("div",{className:h()(Fa.wrapper,Is),onBlur:ga,onClick:jn,onFocus:Js,onMouseOut:ga,onMouseOver:Js,"aria-hidden":!0,"data-testid":_e.Tp.components.TraceViewer.spanBar,children:[(0,n.jsx)("div",{"aria-label":Vs,className:h()(Fa.bar),style:{background:Kt,left:ls(rt),width:ls(Ye-rt)},children:(0,n.jsx)("div",{className:h()(Fa.label,$s),"data-testid":"SpanBar--label",children:Vs})}),(0,n.jsx)("div",{children:Object.keys(ia).map(Ya=>(0,n.jsx)(Dt,{content:(0,n.jsx)(Qn,{interactive:!1,isOpen:!0,logs:ia[Ya],timestamp:qn}),children:(0,n.jsx)("div",{"data-testid":"SpanBar--logMarker",className:h()(Fa.logMarker),style:{left:Ya}})},Ya))}),Vn&&(0,n.jsx)("div",{className:h()(Fa.rpc),style:{background:Vn.color,left:ls(Vn.viewStart),width:ls(Vn.viewEnd-Vn.viewStart)}}),$e?.map((Ya,ma)=>{const Wa=xt(Ya.section_start,Ya.section_end),Tr=Wa.start,Jr=Wa.end,_r=`${Ya.spanId}-${ma}`;return(0,n.jsx)(Fe.m,{placement:"top",content:(0,n.jsxs)("div",{children:["A segment on the ",(0,n.jsx)("em",{children:"critical path"})," of the overall trace / request / workflow."]}),children:(0,n.jsx)("div",{"data-testid":"SpanBar--criticalPath",className:Fa.criticalPath,style:{left:vs(Tr),width:vs(Jr-Tr)}})},_r)})]})}const Ks=l.memo(ea);var Hs=e(64539),bs=e(28122);const Ys=($e,Ye,rt,xt)=>($e.sort(function(Kt,en){return(Kt.title||"link").toLowerCase().localeCompare((en.title||"link").toLowerCase())}),$e.map((Kt,en)=>(0,n.jsx)(Hs.D,{label:Kt.title||"Link",onClick:Kt.onClick?mn=>{(0,r.rR)("grafana_traces_trace_view_span_link_clicked",{datasourceType:xt,grafana_version:i.$.buildInfo.version,type:Kt.type,location:"menu"}),mn?.preventDefault(),Kt.onClick(mn),rt()}:void 0,url:Kt.href,className:Ye.menuItem},en))),La=({links:$e,datasourceType:Ye,color:rt})=>{const xt=(0,o.of)(()=>Xs(rt)),[Kt,en]=(0,l.useState)(!1),[mn,jn]=(0,l.useState)({x:0,y:0}),Vn=()=>en(!1);return(0,n.jsxs)("div",{"data-testid":"SpanLinksMenu",className:xt.wrapper,children:[(0,n.jsx)("button",{onClick:qn=>{en(!0),jn({x:qn.pageX,y:qn.pageY})},className:xt.button,children:(0,n.jsx)(Ke.I,{name:"link",className:xt.icon})}),Kt?(0,n.jsx)(bs.t,{onClose:()=>en(!1),renderMenuItems:()=>Ys($e,xt,Vn,Ye),focusOnOpen:!1,x:mn.x,y:mn.y}):null]})},Xs=$e=>({wrapper:(0,s.css)`
      border: none;
      background: ${$e}10;
      border-bottom: 1px solid ${$e}CF;
      padding-right: 4px;
    `,button:(0,s.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,icon:(0,s.css)`
      background: transparent;
      border: none;
      padding: 0;
    `,menuItem:(0,s.css)`
      max-width: 60ch;
      overflow: hidden;
    `});function Ta($e){return(0,de.get)((0,de.find)($e.references,({span:Ye,refType:rt})=>Ye&&Ye.spanID&&(rt==="CHILD_OF"||rt==="FOLLOWS_FROM")),"span")}function Lr($e){const Ye=[];if(!$e)return Ye;let rt=Ta($e);for(;rt;)Ye.push(rt.spanID),rt=Ta(rt);return Ye}const $r=(0,g.N)($e=>({SpanTreeOffset:(0,s.css)`
      label: SpanTreeOffset;
      color: ${(0,d.R)($e,"#000")};
      position: relative;
    `,SpanTreeOffsetParent:(0,s.css)`
      label: SpanTreeOffsetParent;
      &:hover {
        cursor: pointer;
      }
    `,indentGuide:(0,s.css)`
      label: indentGuide;
      /* The size of the indentGuide is based off of the iconWrapper */
      padding-right: 1rem;
      height: 100%;
      display: inline-flex;
      transition: padding 300ms ease-out;
      &::before {
        content: '';
        padding-left: 1px;
        background-color: ${(0,d.R)($e,"lightgrey")};
      }
    `,indentGuideActive:(0,s.css)`
      label: indentGuideActive;
      &::before {
        background-color: ${(0,d.R)($e,"#777")};
      }
    `,indentGuideThin:(0,s.css)`
      padding-right: 0.3rem;
    `,iconWrapper:(0,s.css)`
      label: iconWrapper;
      position: absolute;
      right: 0;
    `}));class Za extends l.PureComponent{constructor(Ye){super(Ye),this.handleMouseLeave=(rt,xt)=>{(!(rt.relatedTarget instanceof HTMLSpanElement)||(0,de.get)(rt,"relatedTarget.dataset.ancestorId")!==xt)&&this.props.removeHoverIndentGuideId(xt)},this.handleMouseEnter=(rt,xt)=>{(!(rt.relatedTarget instanceof HTMLSpanElement)||(0,de.get)(rt,"relatedTarget.dataset.ancestorId")!==xt)&&this.props.addHoverIndentGuideId(xt)},this.ancestorIds=Lr(Ye.span),this.ancestorIds.push("root"),this.ancestorIds.reverse()}static{this.displayName="UnthemedSpanTreeOffset"}static{this.defaultProps={childrenVisible:!1,showChildrenIcon:!0}}render(){const{childrenVisible:Ye,onClick:rt,showChildrenIcon:xt,span:Kt,theme:en,visibleSpanIds:mn}=this.props,{hasChildren:jn,spanID:Vn}=Kt,qn=jn?{onClick:rt,role:"switch","aria-checked":Ye}:null,Us=xt&&jn&&(Ye?(0,n.jsx)(Ke.I,{name:"angle-down","data-testid":"icon-arrow-down",size:"sm"}):(0,n.jsx)(Ke.I,{name:"angle-right","data-testid":"icon-arrow-right",size:"sm"})),Is=$r(en);return(0,n.jsxs)("span",{className:h()(Is.SpanTreeOffset,{[Is.SpanTreeOffsetParent]:jn}),...qn,children:[this.ancestorIds.map(($s,Vs)=>(0,n.jsx)("span",{className:h()(Is.indentGuide,{[Is.indentGuideActive]:this.props.hoverIndentGuideIds.has($s),[Is.indentGuideThin]:Vs!==this.ancestorIds.length-1&&$s!=="root"&&!mn.includes($s)}),"data-ancestor-id":$s,"data-testid":"SpanTreeOffset--indentGuide",onMouseEnter:Ra=>this.handleMouseEnter(Ra,$s),onMouseLeave:Ra=>this.handleMouseLeave(Ra,$s)},$s)),Us&&(0,n.jsx)("span",{className:Is.iconWrapper,onMouseEnter:$s=>this.handleMouseEnter($s,Vn),onMouseLeave:$s=>this.handleMouseLeave($s,Vn),"data-testid":"icon-wrapper",children:Us})]})}}const Er=(0,o.cV)(Za),Ar="spanBar",ho="spanBarLabel",Fr="nameWrapper",rr="nameWrapperMatchingFilter",fo="jaegerView",_o="nameColumn",gr=(0,g.N)(($e,Ye)=>{const rt={label:"flash",flash:(0,s.keyframes)`
    from {
      background-color: ${(0,d.R)($e,"#68b9ff")};
    }
    to {
      background-color: 'default';
    }
  `},xt=Ye?"":(0,d.R)($e,"#fffce4");return{nameWrapper:(0,s.css)`
      label: nameWrapper;
      line-height: 27px;
      overflow: hidden;
      display: flex;
    `,nameWrapperMatchingFilter:(0,s.css)`
      label: nameWrapperMatchingFilter;
      background-color: ${xt};
    `,nameColumn:(0,s.css)`
      label: nameColumn;
      position: relative;
      white-space: nowrap;
      z-index: 1;
      &:hover {
        z-index: 1;
      }
    `,endpointName:(0,s.css)`
      label: endpointName;
      color: ${(0,d.R)($e,"#484848")};
      font-size: 0.9em;
    `,view:(0,s.css)`
      label: view;
      position: relative;
    `,viewExpanded:(0,s.css)`
      label: viewExpanded;
      background: ${(0,d.R)($e,"#f8f8f8")};
      outline: 1px solid ${(0,d.R)($e,"#ddd")};
    `,viewExpandedAndMatchingFilter:(0,s.css)`
      label: viewExpandedAndMatchingFilter;
      background: ${(0,d.R)($e,"#fff3d7")};
      outline: 1px solid ${(0,d.R)($e,"#ddd")};
    `,row:(0,s.css)`
      label: row;
      font-size: 0.9em;
      &:hover .${Ar} {
        opacity: 1;
      }
      &:hover .${ho} {
        color: ${(0,d.R)($e,"#000")};
      }
      &:hover .${Fr} {
        background: #f8f8f8;
        background: linear-gradient(
          90deg,
          ${(0,d.R)($e,"#fafafa")},
          ${(0,d.R)($e,"#f8f8f8")} 75%,
          ${(0,d.R)($e,"#eee")}
        );
      }
      &:hover .${fo} {
        background-color: ${(0,d.R)($e,"#f5f5f5")};
        outline: 1px solid ${(0,d.R)($e,"#ddd")};
      }
    `,rowClippingLeft:(0,s.css)`
      label: rowClippingLeft;
      & .${_o}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to right,
          ${(0,d.R)($e,"rgba(25, 25, 25, 0.25)")},
          ${(0,d.R)($e,"rgba(32, 32, 32, 0)")}
        );
        left: 100%;
        z-index: -1;
      }
    `,rowClippingRight:(0,s.css)`
      label: rowClippingRight;
      & .${fo}::before {
        content: ' ';
        height: 100%;
        position: absolute;
        width: 6px;
        background-image: linear-gradient(
          to left,
          ${(0,d.R)($e,"rgba(25, 25, 25, 0.25)")},
          ${(0,d.R)($e,"rgba(25, 25, 25, 0.25)")}
        );
        right: 0%;
        z-index: 1;
      }
    `,rowExpanded:(0,s.css)`
      label: rowExpanded;
      & .${Ar} {
        opacity: 1;
      }
      & .${ho} {
        color: ${(0,d.R)($e,"#000")};
      }
      & .${Fr}, &:hover .${Fr} {
        background: ${(0,d.R)($e,"#f0f0f0")};
        box-shadow: 0 1px 0 ${(0,d.R)($e,"#ddd")};
      }
      & .${rr} {
        background: ${(0,d.R)($e,"#fff3d7")};
      }
      &:hover .${fo} {
        background: ${(0,d.R)($e,"#eee")};
      }
    `,rowMatchingFilter:(0,s.css)`
      label: rowMatchingFilter;
      // background-color: ${(0,d.R)($e,"#fffbde")};
      &:hover .${Fr} {
        background: linear-gradient(
          90deg,
          ${(0,d.R)($e,"#fffbde")},
          ${(0,d.R)($e,"#fffbde")} 75%,
          ${(0,d.R)($e,"#f7f1c6")}
        );
      }
      &:hover .${fo} {
        background-color: ${(0,d.R)($e,"#f7f1c6")};
        outline: 1px solid ${(0,d.R)($e,"#ddd")};
      }
    `,rowFocused:(0,s.css)`
      label: rowFocused;
      background-color: ${(0,d.R)($e,"#cbe7ff")};
      animation: ${rt.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      & .${Fr}, .${fo}, .${rr} {
        background-color: ${(0,d.R)($e,"#cbe7ff")};
        animation: ${rt.flash} 1s cubic-bezier(0.12, 0, 0.39, 0);
      }
      & .${Ar} {
        opacity: 1;
      }
      & .${ho} {
        color: ${(0,d.R)($e,"#000")};
      }
      &:hover .${Fr}, :hover .${fo} {
        background: ${(0,d.R)($e,"#d5ebff")};
        box-shadow: 0 1px 0 ${(0,d.R)($e,"#ddd")};
      }
    `,rowExpandedAndMatchingFilter:(0,s.css)`
      label: rowExpandedAndMatchingFilter;
      &:hover .${fo} {
        background: ${(0,d.R)($e,"#ffeccf")};
      }
    `,name:(0,s.css)`
      label: name;
      color: ${(0,d.R)($e,"#000")};
      cursor: pointer;
      flex: 1 1 auto;
      outline: none;
      overflow-y: hidden;
      overflow-x: auto;
      padding-left: 4px;
      padding-right: 0.25em;
      position: relative;
      -ms-overflow-style: none;
      scrollbar-width: none;
      &::-webkit-scrollbar {
        display: none;
      }
      &:focus {
        text-decoration: none;
      }
      &:hover > span {
        color: ${(0,d.R)($e,"#000")};
      }
      text-align: left;
      background: transparent;
      border: none;
      border-bottom-width: 1px;
      border-bottom-style: solid;
    `,nameDetailExpanded:(0,s.css)`
      label: nameDetailExpanded;
      &::before {
        bottom: 0;
      }
    `,svcName:(0,s.css)`
      label: svcName;
      font-size: 0.9em;
      font-weight: bold;
      margin-right: 0.25rem;
    `,svcNameChildrenCollapsed:(0,s.css)`
      label: svcNameChildrenCollapsed;
      font-weight: bold;
      font-style: italic;
    `,errorIcon:(0,s.css)`
      label: errorIcon;
      border-radius: 6.5px;
      color: ${(0,d.R)($e,"#fff")};
      font-size: 0.85em;
      margin-right: 0.25rem;
      padding: 1px;
    `,rpcColorMarker:(0,s.css)`
      label: rpcColorMarker;
      border-radius: 6.5px;
      display: inline-block;
      font-size: 0.85em;
      height: 1em;
      margin-right: 0.25rem;
      padding: 1px;
      width: 1em;
      vertical-align: middle;
    `,labelRight:(0,s.css)`
      label: labelRight;
      left: 100%;
    `,labelLeft:(0,s.css)`
      label: labelLeft;
      right: 100%;
    `}});class ci extends l.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._childrenToggle=()=>{this.props.onChildrenToggled(this.props.span.spanID)},this.getSpanBarLabel=(Ye,rt,xt)=>{const Kt=rt?.type??"";if(Kt===Xe)return"";if(Kt===""||Kt===we)return`(${xt})`;if(Kt===qe){const en=rt?.tag?.trim()??"";if(en!==""&&Ye.tags){const mn=Ye.tags?.find(Vn=>Vn.key===en);if(mn)return`(${mn.value})`;const jn=Ye.process?.tags?.find(Vn=>Vn.key===en);if(jn)return`(${jn.value})`}}return""}}static{this.displayName="UnthemedSpanBarRow"}static{this.defaultProps={className:"",rpc:null}}render(){const{className:Ye,color:rt,spanBarOptions:xt,columnDivision:Kt,isChildrenExpanded:en,isDetailExpanded:mn,isMatchingFilter:jn,showSpanFilterMatchesOnly:Vn,isFocused:qn,numTicks:Us,rpc:Is,noInstrumentedServer:$s,showErrorIcon:Vs,getViewedBounds:Ra,traceStartTime:ga,span:Js,hoverIndentGuideIds:ia,addHoverIndentGuideId:Fa,removeHoverIndentGuideId:Ya,clippingLeft:ma,clippingRight:Wa,theme:Tr,createSpanLink:Jr,datasourceType:_r,showServiceName:Mr,visibleSpanIds:Ka,criticalPath:Vo}=this.props,{duration:ei,hasChildren:to,operationName:Ao,process:{serviceName:Oi}}=Js,zo=(0,y.a3)(ei),ti=Ra(Js.startTime,Js.startTime+Js.duration),br=ti.start,As=ti.end,ya=gr(Tr,Vn),ws=`${Oi}::${Ao}`;let Da,jr;return br>1-As?(Da=`${ws} | ${zo}`,jr=ya.labelLeft):(Da=`${zo} | ${ws}`,jr=ya.labelRight),(0,n.jsxs)(W,{className:h()(ya.row,{[ya.rowExpanded]:mn,[ya.rowMatchingFilter]:jn,[ya.rowExpandedAndMatchingFilter]:jn&&mn,[ya.rowFocused]:qn,[ya.rowClippingLeft]:ma,[ya.rowClippingRight]:Wa},Ye),children:[(0,n.jsx)(W.Cell,{className:h()(ya.nameColumn,_o),width:Kt,children:(0,n.jsxs)("div",{className:h()(ya.nameWrapper,Fr,{[ya.nameWrapperMatchingFilter]:jn,nameWrapperMatchingFilter:jn}),children:[(0,n.jsx)(Er,{onClick:to?this._childrenToggle:void 0,childrenVisible:en,span:Js,hoverIndentGuideIds:ia,addHoverIndentGuideId:Fa,removeHoverIndentGuideId:Ya,visibleSpanIds:Ka}),(0,n.jsxs)("button",{type:"button",className:h()(ya.name,{[ya.nameDetailExpanded]:mn}),"aria-checked":mn,title:ws,onClick:this._detailToggle,role:"switch",style:{background:`${rt}10`,borderBottomColor:`${rt}CF`},tabIndex:0,children:[Vs&&(0,n.jsx)(Ke.I,{name:"exclamation-circle",style:{backgroundColor:Js.errorIconColor?(0,d.R)(Tr,Js.errorIconColor):(0,d.R)(Tr,"#db2828")},className:ya.errorIcon}),Mr&&(0,n.jsx)("span",{className:h()(ya.svcName,{[ya.svcNameChildrenCollapsed]:to&&!en}),children:`${Oi} `}),Is&&(0,n.jsxs)("span",{children:[(0,n.jsx)(Ke.I,{name:"arrow-right"})," ",(0,n.jsx)("i",{className:ya.rpcColorMarker,style:{background:Is.color}}),Is.serviceName]}),$s&&(0,n.jsxs)("span",{children:[(0,n.jsx)(Ke.I,{name:"arrow-right"})," ",(0,n.jsx)("i",{className:ya.rpcColorMarker,style:{background:$s.color}}),$s.serviceName]}),(0,n.jsx)("span",{className:ya.endpointName,children:Is?Is.operationName:Ao}),(0,n.jsxs)("span",{className:ya.endpointName,children:[" ",this.getSpanBarLabel(Js,xt,zo)]})]}),Jr&&(()=>{const Zr=Jr(Js),nt=Zr?.length||0;return Zr&&nt===1?Zr[0]?(0,n.jsx)("a",{href:Zr[0].href,target:"_blank",style:{background:`${rt}10`,borderBottom:`1px solid ${rt}CF`,paddingRight:"4px"},rel:"noopener noreferrer",onClick:Zr[0].onClick?Le=>{!(Le.ctrlKey||Le.metaKey||Le.shiftKey)&&Zr[0].onClick&&(Le.preventDefault(),Zr[0].onClick(Le))}:void 0,children:Zr[0].content}):null:Zr&&nt>1?(0,n.jsx)(La,{links:Zr,datasourceType:_r,color:rt}):null})()]})}),(0,n.jsxs)(W.Cell,{className:h()(ya.view,fo,{[ya.viewExpanded]:mn,[ya.viewExpandedAndMatchingFilter]:jn&&mn}),"data-testid":"span-view",style:{cursor:"pointer"},width:1-Kt,onClick:this._detailToggle,children:[(0,n.jsx)(B,{numTicks:Us}),(0,n.jsx)(Ks,{criticalPath:Vo,rpc:Is,viewStart:br,viewEnd:As,getViewedBounds:Ra,color:rt,shortLabel:zo,longLabel:Da,traceStartTime:ga,span:Js,labelClassName:`${ho} ${jr}`,className:Ar})]})]})}}const Qo=(0,o.cV)(ci),eo=(0,g.N)($e=>({expandedAccent:(0,s.css)`
      cursor: pointer;
      height: 100%;
      overflow: hidden;
      position: absolute;
      width: 100%;
      &::before {
        border-left: 1px solid;
        pointer-events: none;
        width: 1000px;
      }
      &::after {
        border-right: 1000px solid;
        border-color: inherit;
        cursor: pointer;
        opacity: 0.2;
      }

      /* border-color inherit must come AFTER other border declarations for accent */
      &::before,
      &::after {
        border-color: inherit;
        content: ' ';
        position: absolute;
        height: 100%;
      }

      &:hover::after {
        opacity: 0.35;
      }
    `,infoWrapper:(0,s.css)`
      label: infoWrapper;
      border: 1px solid ${(0,d.R)($e,"#d3d3d3")};
      border-top: 3px solid;
      padding: 0.75rem;
    `}));class Do extends l.PureComponent{constructor(){super(...arguments),this._detailToggle=()=>{this.props.onDetailToggled(this.props.span.spanID)},this._linksGetter=(Ye,rt)=>{const{linksGetter:xt,span:Kt}=this.props;return xt(Kt,Ye,rt)}}render(){const{color:Ye,columnDivision:rt,detailState:xt,logItemToggle:Kt,logsToggle:en,processToggle:mn,referenceItemToggle:jn,referencesToggle:Vn,warningsToggle:qn,stackTracesToggle:Us,span:Is,traceToProfilesOptions:$s,timeZone:Vs,tagsToggle:Ra,traceStartTime:ga,traceDuration:Js,traceName:ia,hoverIndentGuideIds:Fa,addHoverIndentGuideId:Ya,removeHoverIndentGuideId:ma,theme:Wa,createSpanLink:Tr,focusedSpanId:Jr,createFocusSpanLink:_r,datasourceType:Mr,visibleSpanIds:Ka,traceFlameGraphs:Vo,setTraceFlameGraphs:ei,setRedrawListView:to}=this.props,Ao=eo(Wa);return(0,n.jsxs)(W,{children:[(0,n.jsxs)(W.Cell,{width:rt,style:{overflow:"hidden"},children:[(0,n.jsx)(Er,{span:Is,showChildrenIcon:!1,hoverIndentGuideIds:Fa,addHoverIndentGuideId:Ya,removeHoverIndentGuideId:ma,visibleSpanIds:Ka}),(0,n.jsx)(ze.$n,{fill:"text",onClick:this._detailToggle,className:h()(Ao.expandedAccent,(0,ze.my)(Wa)),style:{borderColor:Ye},"data-testid":"detail-row-expanded-accent"})]}),(0,n.jsx)(W.Cell,{width:1-rt,children:(0,n.jsx)("div",{className:Ao.infoWrapper,style:{borderTopColor:Ye},children:(0,n.jsx)(wt,{detailState:xt,linksGetter:this._linksGetter,logItemToggle:Kt,logsToggle:en,processToggle:mn,referenceItemToggle:jn,referencesToggle:Vn,warningsToggle:qn,stackTracesToggle:Us,span:Is,traceToProfilesOptions:$s,timeZone:Vs,tagsToggle:Ra,traceStartTime:ga,traceDuration:Js,traceName:ia,createSpanLink:Tr,focusedSpanId:Jr,createFocusSpanLink:_r,datasourceType:Mr,traceFlameGraphs:Vo,setTraceFlameGraphs:ei,setRedrawListView:to})})})]})}}const di=(0,o.cV)(Do),bo=(0,g.N)(()=>({rowsWrapper:(0,s.css)`
      width: 100%;
    `,row:(0,s.css)`
      width: 100%;
    `,scrollToTopButton:(0,s.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      position: absolute;
      bottom: 30px;
      right: 30px;
      z-index: 1;
    `})),Oo={bar:28,detail:161,detailWithLogs:197},To=5,jo=33;function $o($e,Ye,rt,xt,Kt,en,mn){if(!$e)return[];Kt&&xt&&($e=$e.filter(qn=>xt.has(qn.spanID))),en&&mn&&($e=$e.filter(qn=>mn.find(Us=>Us.spanId===qn.spanID)));let jn=null;const Vn=[];for(let qn=0;qn<$e.length;qn++){const Us=$e[qn],{spanID:Is,depth:$s}=Us;let Vs=!1;jn!=null&&($s>=jn?Vs=!0:jn=null),!Vs&&(Ye.has(Is)&&(jn=$s+1),Vn.push({span:Us,isDetail:!1,spanIndex:qn}),rt.has(Is)&&Vn.push({span:Us,isDetail:!0,spanIndex:qn}))}return Vn}function Yo($e){const[Ye,rt]=$e;return{left:Ye>0,right:rt<1}}function Si($e,Ye,rt,xt,Kt,en,mn){return $e?$o($e.spans,Ye,rt,xt,Kt,en,mn):[]}function vi($e){const Ye=new Map;return $e&&$e.spans.forEach(rt=>{rt.childSpanIds.length&&Ye.set(rt.spanID,rt.childSpanIds)}),Ye}const ai=(0,xe.A)(Si),yi=(0,xe.A)(b,de.isEqual),Bo=(0,xe.A)(Yo,de.isEqual),Ai=(0,xe.A)(vi);class Ho extends l.Component{constructor(){super(...arguments),this.hasScrolledToSpan=!1,this.getViewRange=()=>this.props.currentViewRangeTime,this.getSearchedSpanIDs=()=>this.props.findMatchesIDs,this.getCollapsedChildren=()=>this.props.childrenHiddenIDs,this.mapRowIndexToSpanIndex=Ye=>this.getRowStates()[Ye].spanIndex,this.mapSpanIndexToRowIndex=Ye=>{const rt=this.getRowStates().length;for(let xt=0;xt<rt;xt++){const{spanIndex:Kt}=this.getRowStates()[xt];if(Kt===Ye)return xt}throw new Error(`unable to find row for span index: ${Ye}`)},this.setListView=Ye=>{this.listView=Ye},this.getKeyFromIndex=Ye=>{const{isDetail:rt,span:xt}=this.getRowStates()[Ye];return`${xt.traceID}--${xt.spanID}--${rt?"detail":"bar"}`},this.getIndexFromKey=Ye=>{const rt=Ye.split("--"),xt=rt[0],Kt=rt[1],en=rt[2]==="detail",mn=this.getRowStates().length;for(let jn=0;jn<mn;jn++){const{span:Vn,isDetail:qn}=this.getRowStates()[jn];if(Vn.spanID===Kt&&Vn.traceID===xt&&qn===en)return jn}return-1},this.getRowHeight=Ye=>{const{span:rt,isDetail:xt}=this.getRowStates()[Ye];return xt?Array.isArray(rt.logs)&&rt.logs.length?Oo.detailWithLogs:Oo.detail:Oo.bar},this.renderRow=(Ye,rt,xt,Kt)=>{const{isDetail:en,span:mn,spanIndex:jn}=this.getRowStates()[xt],Vn=Math.max((this.listView?.getTopVisibleIndex()||0)-jo,0),qn=(this.listView?.getBottomVisibleIndex()||0)+jo,Us=this.getVisibleSpanIds(Vn,qn);return en?this.renderSpanDetailRow(mn,Ye,rt,Kt,Us):this.renderSpanBarRow(mn,jn,Ye,rt,Kt,Us)},this.scrollToSpan=(Ye,rt)=>{if(rt==null)return;const xt=this.getRowStates().findIndex(Kt=>Kt.span.spanID===rt);xt>=0&&this.listView?.scrollToIndex(xt,Ye)},this.scrollToTop=()=>{const{topOfViewRef:Ye,datasourceType:rt,trace:xt}=this.props;Ye?.current?.scrollIntoView({behavior:"smooth"}),(0,r.rR)("grafana_traces_trace_view_scroll_to_top_clicked",{datasourceType:rt,grafana_version:i.$.buildInfo.version,numServices:xt.services.length,numSpans:xt.spans.length})},this.getVisibleSpanIds=(0,xe.A)((Ye,rt)=>{const xt=[];for(let Kt=Ye;Kt<rt;Kt++){const en=this.getRowStates()[Kt];en?.span&&xt.push(en.span.spanID)}return xt})}componentDidMount(){this.scrollToSpan(this.props.headerHeight,this.props.focusedSpanId)}shouldComponentUpdate(Ye){let rt;for(rt in Ye)if(Ye[rt]!==this.props[rt])return!0;return!1}componentDidUpdate(Ye){const{headerHeight:rt,focusedSpanId:xt,focusedSpanIdForSearch:Kt}=this.props;this.hasScrolledToSpan||(this.scrollToSpan(rt,xt),this.hasScrolledToSpan=!0),xt!==Ye.focusedSpanId&&this.scrollToSpan(rt,xt),Kt!==Ye.focusedSpanIdForSearch&&this.scrollToSpan(rt,Kt)}getRowStates(){const{childrenHiddenIDs:Ye,detailStates:rt,trace:xt,findMatchesIDs:Kt,showSpanFilterMatchesOnly:en,showCriticalPathSpansOnly:mn,criticalPath:jn}=this.props;return ai(xt,Ye,rt,Kt,en,mn,jn)}getClipping(){const{currentViewRangeTime:Ye}=this.props;return Bo(Ye)}getViewedBounds(){const{currentViewRangeTime:Ye,trace:rt}=this.props,[xt,Kt]=Ye;return yi({min:rt.startTime,max:rt.endTime,viewStart:xt,viewEnd:Kt})}getChildSpansMap(){return Ai(this.props.trace)}getAccessors(){const Ye=this.listView;if(!Ye)throw new Error("ListView unavailable");return{getViewRange:this.getViewRange,getSearchedSpanIDs:this.getSearchedSpanIDs,getCollapsedChildren:this.getCollapsedChildren,getViewHeight:Ye.getViewHeight,getBottomRowIndexVisible:Ye.getBottomVisibleIndex,getTopRowIndexVisible:Ye.getTopVisibleIndex,getRowPosition:Ye.getRowPosition,mapRowIndexToSpanIndex:this.mapRowIndexToSpanIndex,mapSpanIndexToRowIndex:this.mapSpanIndexToRowIndex}}renderSpanBarRow(Ye,rt,xt,Kt,en,mn){const{spanID:jn,childSpanIds:Vn}=Ye,{serviceName:qn}=Ye.process,{childrenHiddenIDs:Us,childrenToggle:Is,detailStates:$s,detailToggle:Vs,findMatchesIDs:Ra,spanNameColumnWidth:ga,trace:Js,spanBarOptions:ia,hoverIndentGuideIds:Fa,addHoverIndentGuideId:Ya,removeHoverIndentGuideId:ma,createSpanLink:Wa,focusedSpanId:Tr,focusedSpanIdForSearch:Jr,showSpanFilterMatchesOnly:_r,theme:Mr,datasourceType:Ka,criticalPath:Vo}=this.props;if(!Js)return null;const ei=(0,Te.Kv)(qn,Mr),to=Us.has(jn),Ao=$s.has(jn),Oi=Ra?Ra.has(jn):!1,zo=jn===Tr||jn===Jr,ti=j(Ye)||to&&N(Js.spans,rt);let br=null;if(to){const Le=F(Js.spans.slice(rt));if(Le){const et=this.getViewedBounds()(Le.startTime,Le.startTime+Le.duration);br={color:(0,Te.Kv)(Le.process.serviceName,Mr),operationName:Le.operationName,serviceName:Le.process.serviceName,viewEnd:et.end,viewStart:et.start}}}const As=Ye.tags.find(Le=>Le.key===ue);let ya=null;!Ye.hasChildren&&As&&U(Ye)&&(ya={serviceName:As.value,color:(0,Te.Kv)(As.value,Mr)});const ws=rt>0?Js.spans[rt-1]:null,Da=[jn,...Vn],jr=Le=>{Le.forEach(et=>{const mt=this.getChildSpansMap().get(et);mt?.length&&(Da.push(...mt),jr(mt))})};jr(Vn);const Zr=Vo?.filter(Le=>to?Da.includes(Le.spanId):Le.spanId===jn),nt=bo();return(0,n.jsx)("div",{className:nt.row,style:Kt,...en,children:(0,n.jsx)(Qo,{clippingLeft:this.getClipping().left,clippingRight:this.getClipping().right,color:ei,spanBarOptions:ia,columnDivision:ga,isChildrenExpanded:!to,isDetailExpanded:Ao,isMatchingFilter:Oi,isFocused:zo,showSpanFilterMatchesOnly:_r,numTicks:To,onDetailToggled:Vs,onChildrenToggled:Is,rpc:br,noInstrumentedServer:ya,showErrorIcon:ti,getViewedBounds:this.getViewedBounds(),traceStartTime:Js.startTime,span:Ye,hoverIndentGuideIds:Fa,addHoverIndentGuideId:Ya,removeHoverIndentGuideId:ma,createSpanLink:Wa,datasourceType:Ka,showServiceName:ws===null||ws.process.serviceName!==Ye.process.serviceName,visibleSpanIds:mn,criticalPath:Zr})},xt)}renderSpanDetailRow(Ye,rt,xt,Kt,en){const{spanID:mn}=Ye,{serviceName:jn}=Ye.process,{detailLogItemToggle:Vn,detailLogsToggle:qn,detailProcessToggle:Us,detailReferencesToggle:Is,detailReferenceItemToggle:$s,detailWarningsToggle:Vs,detailStackTracesToggle:Ra,detailStates:ga,detailTagsToggle:Js,detailToggle:ia,spanNameColumnWidth:Fa,trace:Ya,traceToProfilesOptions:ma,timeZone:Wa,hoverIndentGuideIds:Tr,addHoverIndentGuideId:Jr,removeHoverIndentGuideId:_r,linksGetter:Mr,createSpanLink:Ka,focusedSpanId:Vo,createFocusSpanLink:ei,theme:to,datasourceType:Ao,traceFlameGraphs:Oi,setTraceFlameGraphs:zo,setRedrawListView:ti}=this.props,br=ga.get(mn);if(!Ya||!br)return null;const As=(0,Te.Kv)(jn,to),ya=bo();return(0,n.jsx)("div",{className:ya.row,style:{...xt,zIndex:1},...Kt,children:(0,n.jsx)(di,{color:As,columnDivision:Fa,onDetailToggled:ia,detailState:br,linksGetter:Mr,logItemToggle:Vn,logsToggle:qn,processToggle:Us,referenceItemToggle:$s,referencesToggle:Is,warningsToggle:Vs,stackTracesToggle:Ra,span:Ye,traceToProfilesOptions:ma,timeZone:Wa,tagsToggle:Js,traceStartTime:Ya.startTime,traceDuration:Ya.duration,traceName:Ya.traceName,hoverIndentGuideIds:Tr,addHoverIndentGuideId:Jr,removeHoverIndentGuideId:_r,createSpanLink:Ka,focusedSpanId:Vo,createFocusSpanLink:ei,datasourceType:Ao,visibleSpanIds:en,traceFlameGraphs:Oi,setTraceFlameGraphs:zo,setRedrawListView:ti})},rt)}render(){const Ye=bo(),{scrollElement:rt,redrawListView:xt}=this.props;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ue,{ref:this.setListView,dataLength:this.getRowStates().length,itemHeightGetter:this.getRowHeight,itemRenderer:this.renderRow,viewBuffer:jo,viewBufferMin:jo,itemsWrapperClassName:Ye.rowsWrapper,getKeyFromIndex:this.getKeyFromIndex,getIndexFromKey:this.getIndexFromKey,windowScroller:!1,scrollElement:rt,redraw:xt}),this.props.topOfViewRef&&(0,n.jsx)(re.I,{className:Ye.scrollToTopButton,onClick:this.scrollToTop,title:"Scroll to top",icon:"arrow-up"})]})}}const ui=(0,o.cV)(Ho),Jo=(0,g.N)($e=>({TraceTimelineViewer:(0,s.css)`
      label: TraceTimelineViewer;
      border-bottom: 1px solid ${(0,d.R)($e,"#bbb")};

      & .json-markup {
        line-height: 17px;
        font-size: 13px;
        font-family: monospace;
        white-space: pre-wrap;
      }

      & .json-markup-key {
        font-weight: bold;
      }

      & .json-markup-bool {
        color: ${(0,d.R)($e,"firebrick")};
      }

      & .json-markup-string {
        color: ${(0,d.R)($e,"teal")};
      }

      & .json-markup-null {
        color: ${(0,d.R)($e,"teal")};
      }

      & .json-markup-number {
        color: ${(0,d.R)($e,"blue","black")};
      }
    `})),Ri=5;class xi extends l.PureComponent{constructor(Ye){super(Ye),this.collapseAll=()=>{this.props.collapseAll(this.props.trace.spans),(0,r.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:i.$.buildInfo.version,type:"collapseAll"})},this.collapseOne=()=>{this.props.collapseOne(this.props.trace.spans),(0,r.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:i.$.buildInfo.version,type:"collapseOne"})},this.expandAll=()=>{this.props.expandAll(),(0,r.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:i.$.buildInfo.version,type:"expandAll"})},this.expandOne=()=>{this.props.expandOne(this.props.trace.spans),(0,r.rR)("grafana_traces_traceID_expand_collapse_clicked",{datasourceType:this.props.datasourceType,grafana_version:i.$.buildInfo.version,type:"expandOne"})},this.state={height:0}}componentDidMount(){x({collapseAll:this.collapseAll,expandAll:this.expandAll,collapseOne:this.collapseOne,expandOne:this.expandOne})}render(){const{setSpanNameColumnWidth:Ye,updateNextViewRangeTime:rt,updateViewRangeTime:xt,viewRange:Kt,traceTimeline:en,theme:mn,topOfViewRef:jn,focusedSpanIdForSearch:Vn,...qn}=this.props,{trace:Us}=qn,Is=Jo(mn);return(0,n.jsxs)("div",{className:Is.TraceTimelineViewer,ref:$s=>$s&&this.setState({height:$s.getBoundingClientRect().height}),children:[(0,n.jsx)(ee,{duration:Us.duration,nameColumnWidth:en.spanNameColumnWidth,numTicks:Ri,onCollapseAll:this.collapseAll,onCollapseOne:this.collapseOne,onColummWidthChange:Ye,onExpandAll:this.expandAll,onExpandOne:this.expandOne,viewRangeTime:Kt.time,updateNextViewRangeTime:rt,updateViewRangeTime:xt,columnResizeHandleHeight:this.state.height}),(0,n.jsx)(ui,{...qn,...en,setSpanNameColumnWidth:Ye,currentViewRangeTime:Kt.time.current,topOfViewRef:jn,focusedSpanIdForSearch:Vn,datasourceType:this.props.datasourceType})]})}}const Po=(0,o.cV)(xi);var ri=e(39938);const Ei=()=>({NewWindowIconLarge:(0,s.css)`
      label: NewWindowIconLarge;
      font-size: 1.5em;
    `});function Zo({isLarge:$e=!1,className:Ye}){const rt=(0,o.of)(Ei),xt=h()({[rt.NewWindowIconLarge]:$e},Ye);return(0,n.jsx)(Ke.I,{className:xt,name:"anchor"})}const _t=$e=>(0,n.jsxs)("a",{href:$e.href,title:$e.title,target:"_blank",rel:"noopener noreferrer",className:$e.className,children:[$e.children," ",(0,n.jsx)(Zo,{})]});function cn($e){const{links:Ye}=$e;return(0,n.jsx)(_t,{href:Ye[0].url,title:Ye[0].text,className:$e.className})}const kn=100,Kn="<trace-without-root-span>",ns=()=>({BreakableText:(0,s.css)`
      label: BreakableText;
      display: inline-block;
      white-space: pre;
    `}),Rs=/\W*\w+\W*/g;function Os({text:$e,className:Ye,wordRegexp:rt=Rs}){const xt=(0,o.of)(ns);if(!$e)return null;const Kt=[];rt.exec("");let en=rt.exec($e)||[$e];for(;en;)Kt.push((0,n.jsx)("span",{className:Ye||xt.BreakableText,children:en[0]},`${$e}-${Kt.length}`)),en=rt.exec($e);return(0,n.jsx)(n.Fragment,{children:Kt})}const ha=$e=>({TraceName:(0,s.css)`
      label: TraceName;
      font-size: ${$e.typography.size.lg};
    `});function na($e){const{className:Ye,traceName:rt}=$e,xt=(0,o.of)(ha),Kt=String(rt||Kn),en=(0,n.jsx)(Os,{text:Kt});return(0,n.jsx)("span",{className:h()(xt.TraceName,Ye),children:en})}var wa=e(40784);const pr=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:kn,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function Ma(){return pr}function ks($e){return(0,de.get)(Ma(),$e)}const oo=/#\{([^{}]*)\}/g;function go($e){const Ye=new Set;return $e.replace(oo,(rt,xt)=>(Ye.add(xt),rt)),Array.from(Ye)}function qr($e,Ye,rt){return $e.replace(oo,(xt,Kt)=>{const en=rt[Kt];return en==null?"":Ye(en)})}function po($e,Ye){if(typeof $e!="string")throw new Error("Invalid template");return{parameters:go($e),template:qr.bind(null,$e,Ye)}}function yo($e){if(typeof $e=="string")return Ye=>Ye===$e;if(Array.isArray($e))return Ye=>$e.indexOf(Ye)>-1;if($e==null)return()=>!0;throw new Error(`Invalid value: ${$e}`)}const hi=$e=>$e;function Di($e){try{const Ye=po($e.url,encodeURIComponent),rt=po($e.text,hi);return{object:$e,type:yo($e.type),key:yo($e.key),value:yo($e.value),url:Ye,text:rt,parameters:(0,de.uniq)(Ye.parameters.concat(rt.parameters))}}catch(Ye){return console.error(`Ignoring invalid link pattern: ${Ye}`,$e),null}}function Rr($e,Ye){return $e.template(Ye)}function tr($e,Ye){const rt=[],xt=Object.keys(Ye).filter(Kt=>typeof Ye[Kt]=="string"||Ye[Kt]==="number");return $e?.filter(Kt=>Kt?.type("traces")).forEach(Kt=>{const en={};Kt?.parameters.every(jn=>{const Vn=jn;return xt.includes(Vn)?(en[jn]=Ye[Vn],!0):!1})&&rt.push({url:Rr(Kt.url,en),text:Rr(Kt.text,en)})}),rt}const Vr=(ks("linkPatterns")||[]).map(Di).filter($e=>!!$e),io=(0,wa.A)(10)($e=>{const Ye=[];return $e?tr(Vr,$e):Ye});function ja($e){let Ye;const rt=new Set($e.map(({spanID:xt})=>xt));for(let xt=0;xt<$e.length;xt++){if($e[xt].references&&$e[xt].references.some(({traceID:jn,spanID:Vn})=>jn===$e[xt].traceID&&rt.has(Vn)))continue;if(!Ye){Ye=$e[xt];continue}const en=$e[xt].references&&$e[xt].references.length||0,mn=Ye.references&&Ye.references.length||0;(en<mn||en===mn&&$e[xt].startTime<Ye.startTime)&&(Ye=$e[xt])}return Ye?`${Ye.process.serviceName}: ${Ye.operationName}`:""}const Xo=(0,de.memoize)(ja,$e=>$e.length?$e[0].traceID:0);function Ti($e){for(let Ye=0;Ye<$e.length;Ye++){const rt=$e[Ye].tags.filter(en=>en.key==="http.request.method"),xt=$e[Ye].tags.filter(en=>en.key==="http.response.status_code"),Kt=$e[Ye].tags.filter(en=>en.key==="http.route");if(rt.length>0||xt.length>0||Kt.length>0)return{method:rt,status:xt,url:Kt}}for(let Ye=0;Ye<$e.length;Ye++){const rt=$e[Ye].tags.filter(en=>en.key==="http.method"),xt=$e[Ye].tags.filter(en=>en.key==="http.status_code"),Kt=$e[Ye].tags.filter(en=>en.key==="http.url"||en.key==="http.target"||en.key==="http.path");if(rt.length>0||xt.length>0||Kt.length>0)return{method:rt,status:xt,url:Kt}}return{}}const Rt=(0,de.memoize)(Ti,$e=>$e.length?$e[0].traceID:0);var tn=e(2913),Mn=e(18358);const zn=$e=>({ActionButton:(0,s.css)`
      label: ActionButton;
      overflow: hidden;
      position: relative;
      &:after {
        content: '';
        background: ${$e.colors.primary.main};
        display: block;
        position: absolute;
        right: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: all 0.8s;
      }
      &:active:after {
        margin: 0;
        opacity: 0.3;
        transition: 0s;
      }
    `});function Es($e){const{onClick:Ye,ariaLabel:rt,label:xt,icon:Kt}=$e,en=(0,o.of)(zn);return(0,n.jsx)(ze.$n,{className:en.ActionButton,size:"sm",variant:"secondary",fill:"outline",type:"button",icon:Kt,"aria-label":rt,onClick:Ye,children:xt})}const Ts=$e=>({TracePageActions:(0,s.css)({label:"TracePageActions",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",marginBottom:"10px"}),feedback:(0,s.css)({margin:"6px 6px 6px 0",color:$e.colors.text.secondary,fontSize:$e.typography.bodySmall.fontSize,"&:hover":{color:$e.colors.text.link}})});function qa($e){const{traceId:Ye,data:rt,app:xt}=$e,Kt=(0,o.$j)(),en=Ts(Kt),[mn,jn]=(0,l.useState)(!1),Vn=()=>{navigator.clipboard.writeText(Ye),jn(!0),setTimeout(()=>{jn(!1)},5e3)},qn=()=>{const Us=(0,Mn.ek)(rt,"Trace-"+Ye.substring(Ye.length-6));(0,r.rR)("grafana_traces_download_traces_clicked",{app:xt,grafana_version:tn.config.buildInfo.version,trace_format:Us,location:"trace-view"})};return(0,n.jsxs)("div",{className:en.TracePageActions,children:[(0,n.jsxs)("a",{href:"https://forms.gle/RZDEx8ScyZNguDoC8",className:en.feedback,title:"Share your thoughts about tracing in Grafana.",target:"_blank",rel:"noreferrer noopener",children:[(0,n.jsx)(Ke.I,{name:"comment-alt-message"})," Give feedback"]}),(0,n.jsx)(Es,{onClick:Vn,ariaLabel:"Copy Trace ID",label:mn?"Copied!":"Trace ID",icon:"copy"}),(0,n.jsx)(Es,{onClick:qn,ariaLabel:"Export Trace",label:"Export",icon:"save"})]})}var aa=e(50877),ar=e(3721),Aa=e(40996),yr=e(14186),Dr=e(10354);const ao=/^(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])$/,Qr=($e,Ye)=>!($e.match(Ye)||!$e),Uo=$e=>{const Ye=$e.validationRegex||ao,[rt,xt]=(0,l.useState)(()=>$e.value?Qr($e.value,Ye):!1);(0,Aa.A)(()=>{xt(Qr($e.value,Ye))},500,[$e.value]);const Kt={labelWidth:26,disabled:$e.disabled??!1,invalid:rt,error:$e.isInvalidError};return $e.label&&(Kt.label=$e.label,Kt.tooltip=$e.tooltip||""),(0,n.jsx)(yr.I,{...Kt,children:(0,n.jsx)(Dr.p,{type:"text",placeholder:$e.placeholder||"0",width:$e.width||40,onChange:en=>{$e.onChange(en.currentTarget.value)},value:$e.value,"aria-label":$e.ariaLabel||"interval input"})})};var Co=e(82762),lo=e(39268),xo=e(66864),Yr=e(90182),zr=e(15583);class qo extends l.PureComponent{constructor(){super(...arguments),this.clearUiFind=()=>{this.props.onChange("")}}static{this.defaultProps={value:void 0}}render(){const{value:Ye}=this.props,rt=(0,n.jsx)(n.Fragment,{children:Ye&&Ye.length&&(0,n.jsx)(Y.K,{name:"times",onClick:this.clearUiFind,tooltip:"Clear input"})});return(0,n.jsx)("div",{style:{width:"200px"},children:(0,n.jsx)(Dr.p,{placeholder:"Find...",onChange:xt=>this.props.onChange(xt.currentTarget.value),suffix:rt,value:Ye})})}}const Mi=(0,l.memo)(function(Ye){const{trace:rt,spanFilterMatches:xt,setFocusedSpanIdForSearch:Kt,focusedSpanIndexForSearch:en,setFocusedSpanIndexForSearch:mn,datasourceType:jn,showSpanFilters:Vn}=Ye,qn=_i((0,o.$j)(),Vn);(0,l.useEffect)(()=>{if(xt&&en!==-1){const ma=Array.from(xt);Kt(ma[en])}},[en,Kt,xt]);const Us=(ma,Wa)=>{if(ma.preventDefault(),ma.stopPropagation(),Wa){if((0,r.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:jn,grafana_version:i.$.buildInfo.version,direction:"next"}),en===-1||xt&&en===xt.size-1){mn(0);return}mn(en+1)}},Is=(ma,Wa)=>{if(ma.preventDefault(),ma.stopPropagation(),Wa){if((0,r.rR)("grafana_traces_trace_view_find_next_prev_clicked",{datasourceType:jn,grafana_version:i.$.buildInfo.version,direction:"prev"}),xt&&(en===-1||en===0)){mn(xt.size-1);return}mn(en-1)}},$s=(ma,Wa)=>{ma.key==="Enter"&&Us(ma,Wa)},Vs=(ma,Wa)=>{ma.key==="Enter"&&Is(ma,Wa)},Ra=(xt&&xt?.size>0)??!1,ga=Ra?qn.button:(0,s.cx)(qn.button,qn.buttonDisabled),Js=(0,l.useCallback)(ma=>(0,n.jsx)(Fe.m,{content:ma,placement:"top",children:(0,n.jsx)("span",{className:qn.tooltip,children:(0,n.jsx)(Ke.I,{name:"info-circle",size:"md"})})}),[qn.tooltip]),ia=(0,l.useCallback)((ma,Wa)=>{let Tr=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:`${rt.spans.length} spans`}),Js((0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["Services: ",Wa]}),(0,n.jsxs)("div",{children:["Depth: ",ma]})]}))]});if(xt)if(xt.size===0)Tr=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"0 matches"}),Js("There are 0 span matches for the filters selected. Please try removing some of the selected filters.")]});else{const Jr=xt.size===1?"match":"matches",_r=en!==-1?`${en+1}/${xt.size} ${Jr}`:`${xt.size} ${Jr}`,Mr=[];xt.forEach(Ka=>{rt.processes[Ka]&&Mr.push(rt.processes[Ka].serviceName)}),Tr=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:_r}),Js((0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:["Services: ",new Set(Mr).size,"/",Wa]}),(0,n.jsxs)("div",{children:["Depth: ",ma]})]}))]})}return Tr},[en,Js,xt,rt.processes,rt.spans]),Fa=new Set((0,de.values)(rt.processes).map(ma=>ma.serviceName)).size,Ya=(0,de.get)((0,de.maxBy)(rt.spans,"depth"),"depth",0)+1;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:qn.matches,children:ia(Ya,Fa)}),(0,n.jsxs)("div",{className:Ra?qn.buttons:(0,s.cx)(qn.buttons,qn.buttonsDisabled),children:[(0,n.jsx)("div",{"aria-label":"Prev result button",className:ga,onClick:ma=>Is(ma,Ra),onKeyDown:ma=>Vs(ma,Ra),role:"button",tabIndex:Ra?0:-1,children:"Prev"}),(0,n.jsx)("div",{"aria-label":"Next result button",className:ga,onClick:ma=>Us(ma,Ra),onKeyDown:ma=>$s(ma,Ra),role:"button",tabIndex:Ra?0:-1,children:"Next"})]})]})}),_i=($e,Ye)=>{const rt=(0,ze.hs)({theme:$e,variant:"secondary",size:Ye?"md":"sm",iconOnly:!1,fill:"outline"});return{buttons:(0,s.css)`
      display: inline-flex;
      gap: 4px;
    `,buttonsDisabled:(0,s.css)`
      cursor: not-allowed;
    `,button:(0,s.css)`
      ${rt.button};
    `,buttonDisabled:(0,s.css)`
      ${rt.disabled};
      pointer-events: none;
    `,matches:(0,s.css)`
      margin-right: ${$e.spacing(2)};
      text-wrap: nowrap;
    `,tooltip:(0,s.css)`
      color: #aaa;
      margin: 0 0 0 5px;
    `}};var Hi=e(15292);function ft($e,Ye){if(!Ye)return;let rt=!1;$e.serviceName&&(Ye=za(Ye,$e),rt=!0),$e.spanName&&(Ye=Pa(Ye,$e),rt=!0),($e.from||$e.to)&&(Ye=fa(Ye,$e),rt=!0);const xt=dn(Ye,$e.tags);if(xt&&(Ye=xt,rt=!0),$e.query){const Kt=hn($e.query,Ye);Kt&&(Ye=Kt,rt=!0)}return rt?new Set(Ye.map(Kt=>Kt.spanID)):void 0}function hn($e,Ye){if(!Ye)return;const rt=[];$e.split(/\s+/).filter(Boolean).forEach(mn=>{rt.push(mn.toLowerCase())});const xt=(mn,jn)=>mn.some(Vn=>jn.toLowerCase().includes(Vn)),Kt=mn=>mn?mn.some(jn=>xt(rt,jn.key)||xt(rt,jn.value.toString())):!1,en=mn=>xt(rt,mn.operationName)||xt(rt,mn.process.serviceName)||Kt(mn.tags)||mn.kind&&xt(rt,mn.kind)||mn.statusCode!==void 0&&xt(rt,ke.s[mn.statusCode])||mn.statusMessage&&xt(rt,mn.statusMessage)||mn.instrumentationLibraryName&&xt(rt,mn.instrumentationLibraryName)||mn.instrumentationLibraryVersion&&xt(rt,mn.instrumentationLibraryVersion)||mn.traceState&&xt(rt,mn.traceState)||mn.logs!==null&&mn.logs.some(jn=>Kt(jn.fields))||Kt(mn.process.tags)||rt.some(jn=>jn===mn.spanID);return Ye.filter(en)}const dn=($e,Ye)=>{if(Ye=Ye.filter(rt=>rt.key&&rt.key!==""||rt.value),Ye.length>0)return $e.filter(rt=>Ye.every(xt=>xt.key&&xt.value?xt.operator==="="&&ss(xt,rt)?Ps(xt.operator,!0):xt.operator==="=~"&&_n(xt,rt)||xt.operator==="!="&&!ss(xt,rt)||xt.operator==="!~"&&!_n(xt,rt)?Ps(xt.operator,!1):!1:xt.key&&(rt.tags.some(Kt=>Yn(xt.key,Kt.key))||rt.process.tags.some(Kt=>Yn(xt.key,Kt.key))||rt.logs&&rt.logs.some(Kt=>Kt.fields.some(en=>Yn(xt.key,en.key)))||rt.kind&&xt.key===bn||rt.statusCode!==void 0&&xt.key===Mt||rt.statusMessage&&xt.key===Jt||rt.instrumentationLibraryName&&xt.key===Ut||rt.instrumentationLibraryVersion&&xt.key===Gt||rt.traceState&&xt.key===Lt||xt.key===At)?Ps(xt.operator,!0):Ps(xt.operator,!1)))},_n=($e,Ye)=>Ye.tags.some(rt=>Ns($e,rt))||Ye.process.tags.some(rt=>Ns($e,rt))||Ye.logs&&Ye.logs.some(rt=>rt.fields.some(xt=>Ns($e,xt)))||Ye.kind&&$e.key===bn&&$e.value?.includes(Ye.kind)||Ye.statusCode!==void 0&&$e.key===Mt&&$e.value?.includes(ke.s[Ye.statusCode].toLowerCase())||Ye.statusMessage&&$e.key===Jt&&$e.value?.includes(Ye.statusMessage)||Ye.instrumentationLibraryName&&$e.key===Ut&&$e.value?.includes(Ye.instrumentationLibraryName)||Ye.instrumentationLibraryVersion&&$e.key===Gt&&$e.value?.includes(Ye.instrumentationLibraryVersion)||Ye.traceState&&$e.key===Lt&&$e.value?.includes(Ye.traceState)||$e.key===At&&$e.value?.includes(Ye.spanID),ss=($e,Ye)=>Ye.tags.some(rt=>Bs($e,rt))||Ye.process.tags.some(rt=>Bs($e,rt))||Ye.logs&&Ye.logs.some(rt=>rt.fields.some(xt=>Bs($e,xt)))||Ye.kind&&$e.key===bn&&$e.value===Ye.kind||Ye.statusCode!==void 0&&$e.key===Mt&&$e.value===ke.s[Ye.statusCode].toLowerCase()||Ye.statusMessage&&$e.key===Jt&&$e.value===Ye.statusMessage||Ye.instrumentationLibraryName&&$e.key===Ut&&$e.value===Ye.instrumentationLibraryName||Ye.instrumentationLibraryVersion&&$e.key===Gt&&$e.value===Ye.instrumentationLibraryVersion||Ye.traceState&&$e.key===Lt&&$e.value===Ye.traceState||$e.key===At&&$e.value===Ye.spanID,Yn=($e,Ye)=>$e===Ye.toString(),Bs=($e,Ye)=>$e.key===Ye.key.toString()&&$e.value===Ye.value.toString(),Ns=($e,Ye)=>!!(Ye.key.toString().includes($e.key||"")&&Ye.value.toString().includes($e.value||"")),Ps=($e,Ye)=>{switch($e){case"=":return Ye;case"!=":return!Ye;case"~=":return!Ye;case"!~":return!Ye;default:return!Ye}},za=($e,Ye)=>$e.filter(rt=>Ye.serviceNameOperator==="="?rt.process.serviceName===Ye.serviceName:rt.process.serviceName!==Ye.serviceName),Pa=($e,Ye)=>$e.filter(rt=>Ye.spanNameOperator==="="?rt.operationName===Ye.spanName:rt.operationName!==Ye.spanName),fa=($e,Ye)=>{const rt=_a(Ye?.from||""),xt=_a(Ye?.to||"");let Kt=[];if(rt&&(Kt=$e.filter(en=>Ye.fromOperator===">"?en.duration>rt:en.duration>=rt)),xt){const en=mn=>Ye.toOperator==="<"?mn.duration<xt:mn.duration<=xt;Kt=Kt.length>0?Kt.filter(mn=>en(mn)):$e.filter(mn=>en(mn))}return Kt},_a=$e=>{if($e.includes("ns"))return parseFloat($e.split("ns")[0])/1e3;if($e.includes("us"))return parseFloat($e.split("us")[0]);if($e.includes("\xB5s"))return parseFloat($e.split("\xB5s")[0]);if($e.includes("ms"))return parseFloat($e.split("ms")[0])*1e3;if($e.includes("s"))return parseFloat($e.split("s")[0])*1e3*1e3;if($e.includes("m"))return parseFloat($e.split("m")[0])*1e3*1e3*60;if($e.includes("h"))return parseFloat($e.split("h")[0])*1e3*1e3*60*60},da=(0,l.memo)(function(Ye){const{trace:rt,search:xt,spanFilterMatches:Kt,showSpanFilterMatchesOnly:en,setShowSpanFilterMatchesOnly:mn,showCriticalPathSpansOnly:jn,setShowCriticalPathSpansOnly:Vn,focusedSpanIndexForSearch:qn,setFocusedSpanIndexForSearch:Us,setFocusedSpanIdForSearch:Is,datasourceType:$s,clear:Vs,showSpanFilters:Ra}=Ye,ga=(0,o.of)(ta),Js=(0,l.useMemo)(()=>xt.serviceName&&xt.serviceName!==""||xt.spanName&&xt.spanName!==""||_a(xt.from||"")||_a(xt.to||"")||xt.tags.length>1||xt.tags.some(ia=>ia.key)||xt.query&&xt.query!==""||en,[xt.serviceName,xt.spanName,xt.from,xt.to,xt.tags,xt.query,en]);return(0,n.jsx)("div",{className:ga.container,children:(0,n.jsx)("div",{className:ga.controls,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(ze.$n,{variant:"destructive",disabled:!Js,type:"button",fill:"outline","aria-label":"Clear filters button",onClick:Vs,children:"Clear"}),(0,n.jsxs)("div",{className:ga.matchesOnly,children:[(0,n.jsx)(Hi.d,{value:en,onChange:ia=>mn(ia.currentTarget.checked??!1),label:"Show matches only switch",disabled:!Kt?.size}),(0,n.jsx)(ze.$n,{onClick:()=>mn(!en),className:ga.clearMatchesButton,variant:"secondary",fill:"text",disabled:!Kt?.size,children:"Show matches only"})]}),(0,n.jsxs)("div",{className:ga.matchesOnly,children:[(0,n.jsx)(Hi.d,{value:jn,onChange:ia=>Vn(ia.currentTarget.checked??!1),label:"Show critical path only switch"}),(0,n.jsx)(ze.$n,{onClick:()=>Vn(!jn),className:ga.clearMatchesButton,variant:"secondary",fill:"text",children:"Show critical path only"})]})]}),(0,n.jsx)("div",{className:ga.nextPrevResult,children:(0,n.jsx)(Mi,{trace:rt,spanFilterMatches:Kt,setFocusedSpanIdForSearch:Is,focusedSpanIndexForSearch:qn,setFocusedSpanIndexForSearch:Us,datasourceType:$s,showSpanFilters:Ra})})]})})})}),ta=$e=>{const Ye=(0,ze.hs)({theme:$e,variant:"secondary",size:"md",iconOnly:!1,fill:"outline"});return{button:(0,s.css)(Ye.button),buttonDisabled:(0,s.css)(Ye.disabled,{pointerEvents:"none",cursor:"not-allowed"}),container:(0,s.css)`
      display: inline;
    `,controls:(0,s.css)`
      display: flex;
      justify-content: flex-end;
      margin: 5px 0 0 0;
    `,matchesOnly:(0,s.css)`
      display: inline-flex;
      margin: 0 0 0 25px;
      vertical-align: middle;
      align-items: center;
    `,clearMatchesButton:(0,s.css)`
      color: ${$e.colors.text.primary};

      &:hover {
        background: inherit;
      }
    `,nextPrevResult:(0,s.css)`
      margin-left: auto;
      display: flex;
      align-items: center;
    `}},Ba=(0,l.memo)($e=>{const{trace:Ye,search:rt,setSearch:xt,showSpanFilters:Kt,setShowSpanFilters:en,showSpanFilterMatchesOnly:mn,setShowSpanFilterMatchesOnly:jn,showCriticalPathSpansOnly:Vn,setShowCriticalPathSpansOnly:qn,setFocusedSpanIdForSearch:Us,spanFilterMatches:Is,datasourceType:$s}=$e,Vs={...(0,o.of)(Ea)},[Ra,ga]=(0,l.useState)(),[Js,ia]=(0,l.useState)(),[Fa,Ya]=(0,l.useState)(),[ma,Wa]=(0,l.useState)({}),[Tr,Jr]=(0,l.useState)(-1),_r=/^\d+(?:\.\d)?\d*(?:ns|us|µs|ms|s|m|h)$/,Mr=(0,l.useCallback)(()=>{ga(void 0),ia(void 0),Ya(void 0),Wa({}),xt(zr.Ji),jn(!1)},[xt,jn]);if((0,l.useEffect)(()=>{Mr()},[Mr,Ye]),!Ye)return null;const Ka=As=>{Jr(-1),Us(""),xt(As)},Vo=()=>{if(!Ra){const As=Ye.spans.map(ya=>ya.process.serviceName);ga((0,de.uniq)(As).sort().map(aa.z))}},ei=()=>{if(!Js){const As=Ye.spans.map(ya=>ya.operationName);ia((0,de.uniq)(As).sort().map(aa.z))}},to=()=>{if(!Fa){let As=[],ya=[];Ye.spans.forEach(ws=>{ws.tags.forEach(Da=>{As.push(Da.key)}),ws.process.tags.forEach(Da=>{As.push(Da.key)}),ws.logs!==null&&ws.logs.forEach(Da=>{Da.fields.forEach(jr=>{ya.push(jr.key)})}),ws.kind&&As.push(bn),ws.statusCode!==void 0&&As.push(Mt),ws.statusMessage&&As.push(Jt),ws.instrumentationLibraryName&&As.push(Ut),ws.instrumentationLibraryVersion&&As.push(Gt),ws.traceState&&As.push(Lt),As.push(At)}),As=(0,de.uniq)(As).sort(),ya=(0,de.uniq)(ya).sort(),Ya([...As,...ya].map(aa.z))}},Ao=async As=>{const ya=[];return Ye.spans.forEach(ws=>{const Da=ws.tags.find(Zr=>Zr.key===As)?.value;Da&&ya.push(Da.toString());const jr=ws.process.tags.find(Zr=>Zr.key===As)?.value;switch(jr&&ya.push(jr.toString()),ws.logs!==null&&ws.logs.forEach(Zr=>{const nt=Zr.fields.find(Le=>Le.key===As)?.value;nt&&ya.push(nt.toString())}),As){case bn:ws.kind&&ya.push(ws.kind);break;case Mt:ws.statusCode!==void 0&&ya.push(ke.s[ws.statusCode].toLowerCase());break;case Jt:ws.statusMessage&&ya.push(ws.statusMessage);break;case Ut:ws.instrumentationLibraryName&&ya.push(ws.instrumentationLibraryName);break;case Gt:ws.instrumentationLibraryVersion&&ya.push(ws.instrumentationLibraryVersion);break;case Lt:ws.traceState&&ya.push(ws.traceState);break;case At:ya.push(ws.spanID);break;default:break}}),(0,de.uniq)(ya).sort().map(aa.z)},Oi=(As,ya)=>{xt({...rt,tags:rt.tags?.map(Da=>Da.id===As.id?{...Da,key:ya?.value||"",value:void 0}:Da)}),(async()=>{if(ya?.value)Wa({...ma,[As.id]:await Ao(ya.value)});else{const Da={...ma};Da[As.id]&&delete Da[As.id],Wa(Da)}})()},zo=()=>{const As={id:(0,zr.zE)(),operator:"="};xt({...rt,tags:[...rt.tags,As]})},ti=As=>{let ya=rt.tags.filter(ws=>ws.id!==As);ya.length===0&&(ya=[{id:(0,zr.zE)(),operator:"="}]),xt({...rt,tags:ya})},br=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Fe.m,{content:"Filter your spans below. You can continue to apply filters until you have narrowed down your resulting spans to the select few you are most interested in.",placement:"right",children:(0,n.jsxs)("span",{className:Vs.collapseLabel,children:["Span Filters",(0,n.jsx)(Ke.I,{size:"md",name:"info-circle"})]})}),!Kt&&(0,n.jsx)("div",{className:Vs.nextPrevResult,children:(0,n.jsx)(Mi,{trace:Ye,spanFilterMatches:Is,setFocusedSpanIdForSearch:Us,focusedSpanIndexForSearch:Tr,setFocusedSpanIndexForSearch:Jr,datasourceType:$s,showSpanFilters:Kt})})]});return(0,n.jsx)("div",{className:Vs.container,children:(0,n.jsxs)(Co.S,{label:br,collapsible:!0,isOpen:Kt,onToggle:en,children:[(0,n.jsxs)(lo.C,{className:Vs.flexContainer,children:[(0,n.jsx)(yr.I,{label:"Service Name",labelWidth:16,children:(0,n.jsxs)(xo.Gy,{spacing:"xs",children:[(0,n.jsx)(Yr.l6,{"aria-label":"Select service name operator",onChange:As=>Ka({...rt,serviceNameOperator:As.value}),options:[(0,aa.z)("="),(0,aa.z)("!=")],value:rt.serviceNameOperator}),(0,n.jsx)(Yr.l6,{"aria-label":"Select service name",isClearable:!0,onChange:As=>Ka({...rt,serviceName:As?.value||""}),onOpenMenu:Vo,options:Ra,placeholder:"All service names",value:rt.serviceName||null})]})}),(0,n.jsx)(qo,{onChange:As=>{Ka({...rt,query:As}),As===""&&jn(!1)},value:rt.query||""})]}),(0,n.jsx)(lo.C,{children:(0,n.jsx)(yr.I,{label:"Span Name",labelWidth:16,children:(0,n.jsxs)(xo.Gy,{spacing:"xs",children:[(0,n.jsx)(Yr.l6,{"aria-label":"Select span name operator",onChange:As=>Ka({...rt,spanNameOperator:As.value}),options:[(0,aa.z)("="),(0,aa.z)("!=")],value:rt.spanNameOperator}),(0,n.jsx)(Yr.l6,{"aria-label":"Select span name",isClearable:!0,onChange:As=>Ka({...rt,spanName:As?.value||""}),onOpenMenu:ei,options:Js,placeholder:"All span names",value:rt.spanName||null})]})})}),(0,n.jsx)(lo.C,{children:(0,n.jsx)(yr.I,{label:"Duration",labelWidth:16,tooltip:"Filter by duration. Accepted units are ns, us, ms, s, m, h",children:(0,n.jsxs)(xo.Gy,{spacing:"xs",align:"flex-start",children:[(0,n.jsx)(Yr.l6,{"aria-label":"Select min span operator",onChange:As=>Ka({...rt,fromOperator:As.value}),options:[(0,aa.z)(">"),(0,aa.z)(">=")],value:rt.fromOperator}),(0,n.jsx)("div",{className:Vs.intervalInput,children:(0,n.jsx)(Uo,{ariaLabel:"Select min span duration",onChange:As=>Ka({...rt,from:As}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:rt.from||"",validationRegex:_r})}),(0,n.jsx)(Yr.l6,{"aria-label":"Select max span operator",onChange:As=>Ka({...rt,toOperator:As.value}),options:[(0,aa.z)("<"),(0,aa.z)("<=")],value:rt.toOperator}),(0,n.jsx)(Uo,{ariaLabel:"Select max span duration",onChange:As=>Ka({...rt,to:As}),isInvalidError:"Invalid duration",placeholder:"e.g. 100ms, 1.2s",width:18,value:rt.to||"",validationRegex:_r})]})})}),(0,n.jsx)(lo.C,{className:Vs.tagsRow,children:(0,n.jsx)(yr.I,{label:"Tags",labelWidth:16,tooltip:"Filter by tags, process tags or log fields in your spans.",children:(0,n.jsx)("div",{children:rt.tags.map((As,ya)=>(0,n.jsx)("div",{children:(0,n.jsxs)(xo.Gy,{spacing:"xs",width:"auto",children:[(0,n.jsx)(Yr.l6,{"aria-label":"Select tag key",isClearable:!0,onChange:ws=>Oi(As,ws),onOpenMenu:to,options:Fa,placeholder:"Select tag",value:As.key||null},As.key),(0,n.jsx)(Yr.l6,{"aria-label":"Select tag operator",onChange:ws=>{Ka({...rt,tags:rt.tags?.map(Da=>Da.id===As.id?{...Da,operator:ws.value}:Da)})},options:[(0,aa.z)("="),(0,aa.z)("!="),(0,aa.z)("=~"),(0,aa.z)("!~")],value:As.operator}),(0,n.jsxs)("span",{className:Vs.tagValues,children:[(As.operator==="="||As.operator==="!=")&&(0,n.jsx)(Yr.l6,{"aria-label":"Select tag value",isClearable:!0,onChange:ws=>{Ka({...rt,tags:rt.tags?.map(Da=>Da.id===As.id?{...Da,value:ws?.value||""}:Da)})},options:ma[As.id]?ma[As.id]:[],placeholder:"Select value",value:As.value},As.value),(As.operator==="=~"||As.operator==="!~")&&(0,n.jsx)(Dr.p,{"aria-label":"Input tag value",onChange:ws=>{Ka({...rt,tags:rt.tags?.map(Da=>Da.id===As.id?{...Da,value:ws?.currentTarget?.value||""}:Da)})},placeholder:"Tag value",width:18,value:As.value||""})]}),(As.key||As.value||rt.tags.length>1)&&(0,n.jsx)(ar.Z,{"aria-label":"Remove tag",variant:"secondary",icon:"times",onClick:()=>ti(As.id),tooltip:"Remove tag"}),(As.key||As.value)&&ya===rt.tags.length-1&&(0,n.jsx)("span",{className:Vs.addTag,children:(0,n.jsx)(ar.Z,{"aria-label":"Add tag",variant:"secondary",icon:"plus",onClick:zo,tooltip:"Add tag"})})]})},ya))})})}),(0,n.jsx)(da,{trace:Ye,search:rt,spanFilterMatches:Is,showSpanFilterMatchesOnly:mn,setShowSpanFilterMatchesOnly:jn,showCriticalPathSpansOnly:Vn,setShowCriticalPathSpansOnly:qn,setFocusedSpanIdForSearch:Us,focusedSpanIndexForSearch:Tr,setFocusedSpanIndexForSearch:Jr,datasourceType:$s,clear:Mr,showSpanFilters:Kt})]})})});Ba.displayName="SpanFilters";const Ea=$e=>({container:(0,s.css)`
      label: SpanFilters;
      margin: 0.5em 0 -${$e.spacing(1)} 0;
      z-index: 5;

      & > div {
        border-left: none;
        border-right: none;
      }
    `,collapseLabel:(0,s.css)`
      svg {
        color: #aaa;
        margin: -2px 0 0 10px;
      }
    `,flexContainer:(0,s.css)({display:"flex",justifyContent:"space-between"}),addTag:(0,s.css)({marginLeft:$e.spacing(1)}),intervalInput:(0,s.css)`
      margin: 0 -4px 0 0;
    `,tagsRow:(0,s.css)`
      margin: -4px 0 0 0;
    `,tagValues:(0,s.css)`
      max-width: 200px;
    `,nextPrevResult:(0,s.css)`
      flex: 1;
      align-items: center;
      display: flex;
      justify-content: flex-end;
      margin-right: ${$e.spacing(1)};
    `}),or=(0,l.memo)($e=>{const{trace:Ye,data:rt,app:xt,timeZone:Kt,search:en,setSearch:mn,showSpanFilters:jn,setShowSpanFilters:Vn,showSpanFilterMatchesOnly:qn,setShowSpanFilterMatchesOnly:Us,showCriticalPathSpansOnly:Is,setShowCriticalPathSpansOnly:$s,setFocusedSpanIdForSearch:Vs,spanFilterMatches:Ra,datasourceType:ga,setHeaderHeight:Js}=$e,ia=(0,o.of)(co);(0,l.useEffect)(()=>{Js(document.querySelector("."+ia.header)?.scrollHeight??0)},[Js,jn,ia.header]);const Fa=(0,l.useMemo)(()=>Ye?io(Ye):[],[Ye]);if(!Ye)return null;const Ya=(Ka,Vo)=>{const ei=(0,dt.LE)(Ka.startTime/1e3,{timeZone:Vo,defaultWithMS:!0}),to=ei.match(/^(.+)(:\d\d\.\d+)$/);return to?(0,n.jsxs)("span",{className:ia.TracePageHeaderOverviewItemValue,children:[to[1],(0,n.jsx)("span",{className:ia.TracePageHeaderOverviewItemValueDetail,children:to[2]})]}):ei},ma=(0,n.jsxs)("h1",{className:h()(ia.title),children:[(0,n.jsx)(na,{traceName:Xo(Ye.spans)}),(0,n.jsx)("small",{className:ia.duration,children:(0,y.a3)(Ye.duration)})]}),{method:Wa,status:Tr,url:Jr}=Rt(Ye.spans);let _r="green";Tr&&Tr.length>0&&(Tr[0].value.toString().charAt(0)==="4"?_r="orange":Tr[0].value.toString().charAt(0)==="5"&&(_r="red"));const Mr=Ka=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"http.url or http.target or http.path"}),(0,n.jsxs)("div",{children:["(",Ka,")"]})]});return(0,n.jsxs)("header",{className:ia.header,children:[(0,n.jsxs)("div",{className:ia.titleRow,children:[Fa&&Fa.length>0&&(0,n.jsx)(cn,{links:Fa,className:ia.TracePageHeaderBack}),ma,(0,n.jsx)(qa,{traceId:Ye.traceID,data:rt,app:xt})]}),(0,n.jsxs)("div",{className:ia.subtitle,children:[(0,n.jsx)("span",{className:ia.timestamp,children:Ya(Ye,Kt)}),(0,n.jsxs)("span",{className:ia.tagMeta,children:[Wa&&Wa.length>0&&(0,n.jsx)(Fe.m,{content:"http.method",interactive:!0,children:(0,n.jsx)("span",{className:ia.tag,children:(0,n.jsx)(ri.E,{text:Wa[0].value,color:"blue"})})}),Tr&&Tr.length>0&&(0,n.jsx)(Fe.m,{content:"http.status_code",interactive:!0,children:(0,n.jsx)("span",{className:ia.tag,children:(0,n.jsx)(ri.E,{text:Tr[0].value,color:_r})})}),Jr&&Jr.length>0&&(0,n.jsx)(Fe.m,{content:Mr(Jr[0].value),interactive:!0,children:(0,n.jsx)("span",{className:ia.url,children:Jr[0].value})})]})]}),(0,n.jsx)(Ba,{trace:Ye,showSpanFilters:jn,setShowSpanFilters:Vn,showSpanFilterMatchesOnly:qn,setShowSpanFilterMatchesOnly:Us,showCriticalPathSpansOnly:Is,setShowCriticalPathSpansOnly:$s,search:en,setSearch:mn,spanFilterMatches:Ra,setFocusedSpanIdForSearch:Vs,datasourceType:ga})]})});or.displayName="TracePageHeader";const co=$e=>({TracePageHeaderBack:(0,s.css)`
      label: TracePageHeaderBack;
      align-items: center;
      align-self: stretch;
      background-color: #fafafa;
      border-bottom: 1px solid #ddd;
      border-right: 1px solid #ddd;
      color: inherit;
      display: flex;
      font-size: 1.4rem;
      padding: 0 1rem;
      margin-bottom: -1px;
      &:hover {
        background-color: #f0f0f0;
        border-color: #ccc;
      }
    `,TracePageHeaderOverviewItemValueDetail:h()((0,s.css)`
        label: TracePageHeaderOverviewItemValueDetail;
        color: #aaa;
      `,"trace-item-value-detail"),TracePageHeaderOverviewItemValue:(0,s.css)`
      label: TracePageHeaderOverviewItemValue;
      &:hover > .trace-item-value-detail {
        color: unset;
      }
    `,header:(0,s.css)({label:"TracePageHeader",backgroundColor:$e.colors.background.primary,padding:"0.5em 0 0 0",position:"sticky",top:0,zIndex:5,textAlign:"left"}),titleRow:(0,s.css)({alignItems:"flex-start",display:"flex",padding:"0 8px",flexWrap:"wrap"}),title:(0,s.css)({color:"inherit",flex:1,fontSize:"1.7em",lineHeight:"1em",marginBottom:0,minWidth:"200px"}),subtitle:(0,s.css)({flex:1,lineHeight:"1em",margin:"-0.5em 0.5em 0.75em 0.5em"}),tag:(0,s.css)({margin:"0 0.5em 0 0"}),duration:(0,s.css)({color:"#aaa",margin:"0 0.75em"}),timestamp:(0,s.css)({verticalAlign:"middle"}),tagMeta:(0,s.css)({margin:"0 0.75em",verticalAlign:"text-top"}),url:(0,s.css)({margin:"-2.5px 0.3em",height:"15px",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"700px",display:"inline-block"}),TracePageHeaderTraceId:(0,s.css)({label:"TracePageHeaderTraceId",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"30%",display:"inline-block"})}),Mo="None",No="Duration",ro="Tag";function ki({options:$e,onOptionsChange:Ye}){const rt=useStyles2(Gi),xt=[Mo,No,ro].map(toOption);return jsxs("div",{className:css({width:"100%"}),children:[jsx(InlineFieldRow,{className:rt.row,children:jsx(InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:jsx(Select,{inputId:"label",options:xt,value:$e.jsonData.spanBar?.type||"",onChange:Kt=>{updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:$e},"spanBar",{...$e.jsonData.spanBar,type:Kt?.value??""})},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),$e.jsonData.spanBar?.type===ro&&jsx(InlineFieldRow,{className:rt.row,children:jsx(InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:jsx(Input,{type:"text",placeholder:"Enter tag key",onChange:Kt=>updateDatasourcePluginJsonDataOption({onOptionsChange:Ye,options:$e},"spanBar",{...$e.jsonData.spanBar,tag:Kt.currentTarget.value}),value:$e.jsonData.spanBar?.tag||"",width:40})})})]})}const Hl=({options:$e,onOptionsChange:Ye})=>{let rt=$e.type;return rt+=$e.type==="tempo"?"/configure-tempo-data-source/#span-bar":"/#span-bar",jsx(ConfigSubSection,{title:"Span bar",description:jsx(ConfigDescriptionLink,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:rt,feature:"the span bar"}),children:jsx(ki,{options:$e,onOptionsChange:Ye})})},Gi=$e=>({infoText:css`
    label: infoText;
    padding-bottom: ${$e.spacing(2)};
    color: ${$e.colors.text.secondary};
  `,row:css`
    label: row;
    align-items: baseline;
  `});class bi{constructor(Ye){const{isTagsOpen:rt,isProcessOpen:xt,isReferencesOpen:Kt,isWarningsOpen:en,isStackTracesOpen:mn,logs:jn,references:Vn}=Ye||{};this.isTagsOpen=!!rt,this.isProcessOpen=!!xt,this.isReferencesOpen=!!Kt,this.isWarningsOpen=!!en,this.isStackTracesOpen=!!mn,this.logs={isOpen:!!(jn&&jn.isOpen),openedItems:jn&&jn.openedItems?new Set(jn.openedItems):new Set},this.references={isOpen:!!(Vn&&Vn.isOpen),openedItems:Vn&&Vn.openedItems?new Set(Vn.openedItems):new Set}}toggleTags(){const Ye=new bi(this);return Ye.isTagsOpen=!this.isTagsOpen,Ye}toggleProcess(){const Ye=new bi(this);return Ye.isProcessOpen=!this.isProcessOpen,Ye}toggleReferences(){const Ye=new bi(this);return Ye.references.isOpen=!this.references.isOpen,Ye}toggleReferenceItem(Ye){const rt=new bi(this);return rt.references.openedItems.has(Ye)?rt.references.openedItems.delete(Ye):rt.references.openedItems.add(Ye),rt}toggleWarnings(){const Ye=new bi(this);return Ye.isWarningsOpen=!this.isWarningsOpen,Ye}toggleStackTraces(){const Ye=new bi(this);return Ye.isStackTracesOpen=!this.isStackTracesOpen,Ye}toggleLogs(){const Ye=new bi(this);return Ye.logs.isOpen=!this.logs.isOpen,Ye}toggleLogItem(Ye){const rt=new bi(this);return rt.logs.openedItems.has(Ye)?rt.logs.openedItems.delete(Ye):rt.logs.openedItems.add(Ye),rt}}var Ui=e(25508);class wo{static iterFunction(Ye,rt=0){return xt=>Ye(xt.value,xt,rt)}static searchFunction(Ye){return typeof Ye=="function"?Ye:(rt,xt)=>Ye instanceof wo?xt===Ye:rt===Ye}constructor(Ye,rt=[]){this.value=Ye,this.children=rt}get depth(){return this.children.reduce((Ye,rt)=>Math.max(rt.depth+1,Ye),1)}get size(){let Ye=0;return this.walk(()=>Ye++),Ye}addChild(Ye){return this.children.push(Ye instanceof wo?Ye:new wo(Ye)),this}find(Ye){if(wo.iterFunction(wo.searchFunction(Ye))(this))return this;for(let xt=0;xt<this.children.length;xt++){const Kt=this.children[xt].find(Ye);if(Kt)return Kt}return null}getPath(Ye){const rt=wo.iterFunction(wo.searchFunction(Ye)),xt=(Kt,en)=>{const mn=en.concat([Kt]);if(rt(Kt))return mn;for(let jn=0;jn<Kt.children.length;jn++){const Vn=Kt.children[jn],qn=xt(Vn,mn);if(qn)return qn}return null};return xt(this,[])}walk(Ye,rt=0){const xt=[];let Kt=rt;for(xt.push({node:this,depth:Kt});xt.length;){const en=xt[xt.length-1];xt.pop();const{node:mn,depth:jn}=en;Ye(mn.value,mn,jn),Kt=jn+1;let Vn=mn.children.length-1;for(;Vn>=0;)xt.push({node:mn.children[Vn],depth:Kt}),Vn--}}paths(Ye){const rt=[];rt.push({node:this,childIndex:0});const xt=[];for(;rt.length;){const{node:Kt,childIndex:en}=rt[rt.length-1];if(Kt.children.length>=en+1)rt[rt.length-1].childIndex++,rt.push({node:Kt.children[en],childIndex:0});else{if(Kt.children.length===0){const mn=rt.map(jn=>jn.node.value);Ye(mn)}rt.pop()}}return xt}}const ul=$e=>$e.spanID,hl=$e=>$e.references||[],lc=(0,Ui.Mz)((0,Ui.Mz)(({span:$e})=>$e,hl),({type:$e})=>$e,($e,Ye)=>$e.find(rt=>rt.refType===Ye)),fl=(0,Ui.Mz)($e=>lc({span:$e,type:"CHILD_OF"}),$e=>$e?$e.spanID:null),ol=$e=>$e.spans,Sl=(0,Ui.Mz)(ol,$e=>$e.reduce((Ye,rt)=>Ye.set(ul(rt),rt),new Map)),Tl="__root__";function kl($e,Ye=null){const rt=new Map($e.spans.map(mn=>[mn.spanID,new wo(mn.spanID)])),xt=Ye??new Map($e.spans.map(mn=>[mn.spanID,mn])),Kt=new wo(Tl);$e.spans.forEach(mn=>{const jn=rt.get(mn.spanID);if(Array.isArray(mn.references)&&mn.references.length){const{refType:Vn,spanID:qn}=mn.references[0];if(Vn==="CHILD_OF"||Vn==="FOLLOWS_FROM")(rt.get(qn)||Kt).children?.push(jn);else throw new Error(`Unrecognized ref type: ${Vn}`)}else Kt.children.push(jn)});const en=(mn,jn)=>{const Vn=mn?.value?xt.get(mn.value.toString()):void 0,qn=jn?.value?xt.get(jn.value.toString()):void 0;return+(Vn?.startTime>qn?.startTime)||+(Vn?.startTime===qn?.startTime)-1};return $e.spans.forEach(mn=>{const jn=rt.get(mn.spanID);jn.children.length>1&&jn?.children.sort(en)}),Kt.children.sort(en),Kt}function Ml($e){const Ye=new Map,rt=$e.reduce((Kt,en)=>(Kt.some(mn=>mn.key===en.key&&mn.value===en.value)?Ye.set(`${en.key}:${en.value}`,`Duplicate tag "${en.key}:${en.value}"`):Kt.push(en),Kt),[]),xt=Array.from(Ye.values());return{dedupedTags:rt,warnings:xt}}function fi($e,Ye){const rt=$e?.slice()??[],xt=(Ye||[]).map(Kt=>Kt.toLowerCase());return rt.sort((Kt,en)=>{const mn=Kt.key.toLowerCase(),jn=en.key.toLowerCase();for(let Vn=0;Vn<xt.length;Vn++){const qn=xt[Vn];if(mn.startsWith(qn)&&!jn.startsWith(qn))return-1;if(!mn.startsWith(qn)&&jn.startsWith(qn))return 1}return mn>jn?1:mn<jn?-1:0}),rt}function gl($e){if(!$e?.traceID)return null;const Ye=$e.traceID.toLowerCase();let rt=0,xt=Number.MAX_SAFE_INTEGER;const Kt=new Map,en=new Map;$e.spans=$e.spans.filter($s=>!!$s.startTime),$e.processes=Object.entries($e.processes).reduce(($s,[Vs,Ra])=>($s[Vs]={...Ra,tags:fi(Ra.tags)},$s),{});const mn=$e.spans.length;for(let $s=0;$s<mn;$s++){const Vs=$e.spans[$s],{startTime:Ra,duration:ga,processID:Js}=Vs;let ia=Vs.spanID;Ra<xt&&(xt=Ra),Ra+ga>rt&&(rt=Ra+ga);const Fa=Kt.get(ia);Fa!=null?(console.warn(`Dupe spanID, ${Fa+1} x ${ia}`,Vs,en.get(ia)),(0,de.isEqual)(Vs,en.get(ia))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),Kt.set(ia,Fa+1),ia=`${ia}_${Fa}`,Vs.spanID=ia):Kt.set(ia,1),Vs.process=$e.processes[Js],en.set(ia,Vs)}const jn=kl($e,en),Vn=[],qn={};jn.walk(($s,Vs,Ra=0)=>{if($s==="__root__"||typeof $s!="string")return;const ga=en.get($s);if(!ga)return;const{serviceName:Js}=ga.process;qn[Js]=(qn[Js]||0)+1,ga.relativeStartTime=ga.startTime-xt,ga.depth=Ra-1,ga.hasChildren=Vs.children.length>0,ga.childSpanCount=Vs.children.length,ga.warnings=ga.warnings||[],ga.tags=ga.tags||[],ga.references=ga.references||[],ga.childSpanIds=Vs.children.slice().sort((Fa,Ya)=>{const ma=en.get(Fa.value),Wa=en.get(Ya.value);return Wa.startTime+Wa.duration-(ma.startTime+ma.duration)}).map(Fa=>Fa.value);const ia=Ml(ga.tags);ga.tags=fi(ia.dedupedTags,ks("topTagPrefixes")),ga.warnings=ga.warnings.concat(ia.warnings),ga.references.forEach((Fa,Ya)=>{const ma=en.get(Fa.spanID);ma&&(Fa.span=ma,Ya>0&&(ma.subsidiarilyReferencedBy=ma.subsidiarilyReferencedBy||[],ma.subsidiarilyReferencedBy.push({spanID:$s,traceID:Ye,span:ga,refType:Fa.refType})))}),Vn.push(ga)});const Us=Xo(Vn);return{services:Object.keys(qn).map($s=>({name:$s,numberOfSpans:qn[$s]})),spans:Vn,traceID:Ye,traceName:Us,processes:$e.processes,duration:rt-xt,startTime:xt,endTime:rt}}},92102:(k,A,e)=>{"use strict";e.d(A,{N:()=>n});var n=(s=>(s.Logs="log",s.Traces="trace",s.Metrics="metric",s.Profiles="profile",s.Session="session",s.Unknown="unknown",s))(n||{})},92151:(k,A,e)=>{"use strict";e.d(A,{EUpdateTypes:()=>s,default:()=>i});var n=(g=>(g.DragEnd="DragEnd",g.DragMove="DragMove",g.DragStart="DragStart",g.MouseEnter="MouseEnter",g.MouseLeave="MouseLeave",g.MouseMove="MouseMove",g))(n||{});const s=n;var l=e(2543);const r=0;class i{constructor({getBounds:o,tag:d,resetBoundsOnResize:c=!0,...a}){this.resetBounds=()=>{this._bounds=void 0},this._handleMinorMouseEvent=p=>{const{button:u,clientX:m,type:v}=p;if(this._isDragging||u!==r)return;let x=null,f;if(v==="mouseenter")x=s.MouseEnter,f=this._onMouseEnter;else if(v==="mouseleave")x=s.MouseLeave,f=this._onMouseLeave;else if(v==="mousemove")x=s.MouseMove,f=this._onMouseMove;else throw new Error(`invalid event type: ${v}`);if(!f)return;const{value:E,x:h}=this._getPosition(m);f({event:p,type:x,value:E,x:h,manager:this,tag:this.tag})},this._handleDragEvent=p=>{const{button:u,clientX:m,type:v}=p;let x=null,f;if(v==="mousedown"){if(this._isDragging||u!==r)return;window.addEventListener("mousemove",this._handleDragEvent),window.addEventListener("mouseup",this._handleDragEvent);const y=(0,l.get)(document,"body.style");y&&(y.userSelect="none"),this._isDragging=!0,x=s.DragStart,f=this._onDragStart}else if(v==="mousemove"){if(!this._isDragging)return;x=s.DragMove,f=this._onDragMove}else if(v==="mouseup"){if(!this._isDragging)return;this._stopDragging(),x=s.DragEnd,f=this._onDragEnd}else throw new Error(`invalid event type: ${v}`);if(!f)return;const{value:E,x:h}=this._getPosition(m);f({event:p,type:x,value:E,x:h,manager:this,tag:this.tag})},this.handleMouseDown=this._handleDragEvent,this.handleMouseEnter=this._handleMinorMouseEvent,this.handleMouseMove=this._handleMinorMouseEvent,this.handleMouseLeave=this._handleMinorMouseEvent,this.getBounds=o,this.tag=d,this._isDragging=!1,this._bounds=void 0,this._resetBoundsOnResize=!!c,this._resetBoundsOnResize&&window.addEventListener("resize",this.resetBounds),this._onMouseEnter=a.onMouseEnter,this._onMouseLeave=a.onMouseLeave,this._onMouseMove=a.onMouseMove,this._onDragStart=a.onDragStart,this._onDragMove=a.onDragMove,this._onDragEnd=a.onDragEnd}_getBounds(){return this._bounds||(this._bounds=this.getBounds(this.tag)),this._bounds}_getPosition(o){const{clientXLeft:d,maxValue:c,minValue:a,width:p}=this._getBounds();let u=o-d,m=u/p;return a!=null&&m<a?(m=a,u=a*p):c!=null&&m>c&&(m=c,u=c*p),{value:m,x:u}}_stopDragging(){window.removeEventListener("mousemove",this._handleDragEvent),window.removeEventListener("mouseup",this._handleDragEvent);const o=(0,l.get)(document,"body.style");o&&(o.userSelect="auto"),this._isDragging=!1}isDragging(){return this._isDragging}dispose(){this._isDragging&&this._stopDragging(),this._resetBoundsOnResize&&window.removeEventListener("resize",this.resetBounds),this._bounds=void 0,this._onMouseEnter=void 0,this._onMouseLeave=void 0,this._onMouseMove=void 0,this._onDragStart=void 0,this._onDragMove=void 0,this._onDragEnd=void 0}}},30700:(k,A,e)=>{"use strict";e.d(A,{Kv:()=>d,rY:()=>c});var n=e(41811),s=e(84140),l=e(24284);function r(p){if(p.length!==7)return[0,0,0];const u=p.slice(1,3),m=p.slice(3,5),v=p.slice(5);return[parseInt(u,16),parseInt(m,16),parseInt(v,16)]}class i{constructor(u,m){const v=a(u,m);this.colorsHex=v,this.colorsRgb=v.map(r),this.cache=new Map,this.prevColorIndex=void 0}_getColorIndex(u){let m=this.cache.get(u);if(m==null){const v=this.hashCode(u?u.toLowerCase():"");if(m=Math.abs(v%this.colorsHex.length),this.prevColorIndex!==void 0){this.prevColorIndex===m&&(m=this.getNextIndex(m));const x=this.colorsHex[this.prevColorIndex];if(s.A.readability(x,this.colorsHex[m])<1.5){let f=m;for(let E=0;E<this.colorsHex.length;E++)if(f=this.getNextIndex(f),s.A.readability(x,this.colorsHex[f])>1.5){m=f;break}}}this.cache.set(u,m),this.prevColorIndex=m}return m}getNextIndex(u){return u+1<this.colorsHex.length?u+1:0}hashCode(u){let m=0,v,x;for(v=0;v<u.length;v++)x=u.charCodeAt(v),m=(m<<5)-m+x;return m}getColorByKey(u){const m=this._getColorIndex(u);return this.colorsHex[m]}getRgbColorByKey(u){const m=this._getColorIndex(u);return this.colorsRgb[m]}clear(){this.cache.clear()}}const g=(0,n.A)((p,u)=>new i(p,u));function o(p){g([],p)}function d(p,u){return g(l.Tj,u).getColorByKey(p)}function c(p,u){return g(l.Tj,u).getRgbColorByKey(p)}function a(p,u){const m=[...p],v=m.indexOf("#E24D42");v>-1&&m.splice(v,1);const x=p.indexOf("#BF1B00");x>-1&&m.splice(x,1);let f=[];for(const E of m)s.A.readability(u.colors.background.primary,E)>=3&&f.push(E);return f}},6389:(k,A,e)=>{"use strict";e.d(A,{a3:()=>y});var n=e(2543),s=e.n(n),l=e(84743),r=e.n(l);const i="YYYY-MM-DD",g="HH:mm",o=1e3,d=1e3*o,c=60*d,a=60*c,p=24*a,u=Math.log10(o),m=[{unit:"d",microseconds:p,ofPrevious:24},{unit:"h",microseconds:a,ofPrevious:60},{unit:"m",microseconds:c,ofPrevious:60},{unit:"s",microseconds:d,ofPrevious:1e3},{unit:"ms",microseconds:o,ofPrevious:1e3},{unit:"\u03BCs",microseconds:1,ofPrevious:1e3}],v=(b,D,P)=>toFloatPrecision(b/P,D)*P;function x(b){return moment(b/o).format(i)}function f(b){return moment(b/o).format(g)}function E(b){const D=v(b,u,o);return`${moment.duration(D/o).asMilliseconds()}ms`}function h(b){const D=v(b,u,d);return`${moment.duration(D/o).asSeconds()}s`}function y(b){const[D,P]=(0,n.dropWhile)(m,({microseconds:T},S)=>S<m.length-1&&T>b);if(D.ofPrevious===1e3)return`${(0,n.round)(b/D.microseconds,2)}${D.unit}`;const M=`${Math.floor(b/D.microseconds)}${D.unit}`,I=Math.round(b/P.microseconds%D.ofPrevious),R=`${I}${P.unit}`;return I===0?M:`${M} ${R}`}},28114:(k,A,e)=>{"use strict";e.d(A,{Cr:()=>T,QW:()=>v,_o:()=>C,gt:()=>I,hv:()=>R,i0:()=>m,lU:()=>a});var n=e(74848),s=e(6709),l=e(65879),r=e(47232),i=e(72574),g=e(14578),o=e(31193),d=e(96192),c=e(92102);function a({splitOpenFn:S,traceToLogsOptions:L,traceToMetricsOptions:O,traceToProfilesOptions:j,dataFrame:N,createFocusSpanLink:F,trace:U}){if(!N)return;let w=I(U.duration,U.traceName,U.traceID);const B=N.fields.some(W=>!!W.config.links?.length),K=f(S,N.fields[0],L,O,F,w);return function(z){let Y=K(z);if(B){w={...w,...R(z),...T(z,j)};const X=N.fields.filter(q=>!!q.config.links?.length);try{let q;j?.datasourceUid&&(q=(0,o.tR)().getInstanceSettings(j.datasourceUid));const G=q?.type==="grafana-pyroscope-datasource",te=z.tags.some(le=>le.key===v),H=G&&te;let se=[];X.forEach(le=>{const _=(0,d.QL)({field:le,rowIndex:z.dataFrameRowIndex,splitOpenFn:S,range:M(z,void 0,void 0,H),dataFrame:N,vars:w});se=se.concat(_)});const ne=se.map(le=>({title:le.title,href:le.href,onClick:le.onClick,content:(0,n.jsx)(g.I,{name:"link",title:le.title||"Link"}),field:le.origin,type:H?c.N.Profiles:c.N.Unknown}));Y.push.apply(Y,ne)}catch(q){return console.error(q),Y}}return Y}}const p=S=>S.map(L=>({key:L,value:L.includes(".")?L.replace(".","_"):void 0})),u=p(["cluster","hostname","namespace","pod","service.name","service.namespace"]),m=p(["service.name","service.namespace"]),v="pyroscope.profile.id",x="gf.feo11y.app.id";function f(S,L,O,j,N,F){let U;O?.datasourceUid&&(U=(0,o.tR)().getInstanceSettings(O.datasourceUid));const w=U?.type==="grafana-splunk-datasource";let B;return j?.datasourceUid&&(B=(0,o.tR)().getInstanceSettings(j.datasourceUid)),function(W){F={...F,...R(W)};const z=[];let Y,X="";if(U&&O){const G=O.customQuery?O.query:void 0,te=O.tags&&O.tags.length>0?O.tags:u;switch(U?.type){case"loki":X=C(W,te),Y=E(W,O,X,G);break;case"grafana-splunk-datasource":X=C(W,te,{joinBy:" "}),Y=b(W,O,X,G);break;case"elasticsearch":case"grafana-opensearch-datasource":X=C(W,te,{labelValueSign:":",joinBy:" AND "}),Y=y(W,O,X,G);break;case"grafana-falconlogscale-datasource":X=C(W,te,{joinBy:" OR "}),Y=P(W,O,X,G);break;case"googlecloud-logging-datasource":X=C(W,te,{joinBy:" AND "}),Y=D(W,O,X,G)}if(Y){const H={title:U.name,url:"",internal:{datasourceUid:U.uid,datasourceName:U.name,query:Y}};if(F={...F,__tags:{text:"Tags",value:X}},(0,d.O1)(H.internal.query,F).allVariablesDefined){const se=(0,s.u)({link:H,internalLink:H.internal,scopedVars:F,range:M(W,{startMs:O.spanStartTimeShift?l.intervalToMs(O.spanStartTimeShift):0,endMs:O.spanEndTimeShift?l.intervalToMs(O.spanEndTimeShift):0},w),field:{},onClickFn:S,replaceVariables:(0,i.w)().replace.bind((0,i.w)())});z.push({href:se.href,title:"Related logs",onClick:se.onClick,content:(0,n.jsx)(g.I,{name:"gf-logs",title:"Explore the logs for this in split view"}),field:L,type:c.N.Logs})}}}if(B&&j?.queries)for(const G of j.queries){const te=G.query||`histogram_quantile(0.5, sum(rate(traces_spanmetrics_latency_bucket{service="${W.process.serviceName}"}[5m])) by (le))`,H={title:B.name,url:"",internal:{datasourceUid:B.uid,datasourceName:B.name,query:{expr:te,refId:"A"}}},se=j.tags&&j.tags.length>0?j.tags:u;F={...F,__tags:{text:"Tags",value:C(W,se)}};const ne=(0,s.u)({link:H,internalLink:H.internal,scopedVars:F,range:M(W,{startMs:j.spanStartTimeShift?l.intervalToMs(j.spanStartTimeShift):-12e4,endMs:j.spanEndTimeShift?l.intervalToMs(j.spanEndTimeShift):12e4}),field:{},onClickFn:S,replaceVariables:(0,i.w)().replace.bind((0,i.w)())});z.push({title:G?.name,href:ne.href,onClick:ne.onClick,content:(0,n.jsx)(g.I,{name:"chart-line",title:"Explore metrics for this span"}),field:L,type:c.N.Metrics})}if(W.references&&N)for(const G of W.references){if(G.refType==="CHILD_OF")continue;const te=N(G.traceID,G.spanID);z.push({href:te.href,title:G.span?G.span.operationName:"View linked span",content:(0,n.jsx)(g.I,{name:"link",title:"View linked span"}),onClick:te.onClick,field:te.origin,type:c.N.Traces})}if(W.subsidiarilyReferencedBy&&N)for(const G of W.subsidiarilyReferencedBy){const te=N(G.traceID,G.spanID);z.push({href:te.href,title:G.span?G.span.operationName:"View linked span",content:(0,n.jsx)(g.I,{name:"link",title:"View linked span"}),onClick:te.onClick,field:te.origin,type:c.N.Traces})}const q=h(W);return q&&z.push({title:"Session for this span",href:q,content:(0,n.jsx)(g.I,{name:"frontend-observability",title:"Session for this span"}),field:L,type:c.N.Session}),z}}function E(S,L,O,j){const{filterByTraceID:N,filterBySpanID:F}=L;if(j)return{expr:j,refId:""};if(!O)return;let U="{${__tags}}";return N&&S.traceID&&(U+=' |="${__span.traceId}"'),F&&S.spanID&&(U+=' |="${__span.spanId}"'),{expr:U,refId:""}}function h(S){const L=S.process.tags.find(j=>j.key===x)?.value,O=S.tags.find(j=>j.key==="session_id"||j.key==="session.id")?.value;return L&&O?`/a/grafana-kowalski-app/apps/${L}/sessions/${O}`:void 0}function y(S,L,O,j){const{filterByTraceID:N,filterBySpanID:F}=L;if(j)return{query:j,refId:"",metrics:[{id:"1",type:"logs"}]};let U=[];return F&&S.spanID&&U.push('"${__span.spanId}"'),N&&S.traceID&&U.push('"${__span.traceId}"'),O&&U.push("${__tags}"),{query:U.join(" AND "),refId:"",metrics:[{id:"1",type:"logs"}]}}function b(S,L,O,j){const{filterByTraceID:N,filterBySpanID:F}=L;if(j)return{query:j,refId:""};let U="";return O&&(U+="${__tags}"),N&&S.traceID&&(U+=' "${__span.traceId}"'),F&&S.spanID&&(U+=' "${__span.spanId}"'),{query:U,refId:""}}function D(S,L,O,j){const{filterByTraceID:N,filterBySpanID:F}=L;if(j)return{query:j,refId:""};let U=[];return F&&S.spanID&&U.push('"${__span.spanId}"'),N&&S.traceID&&U.push('"${__span.traceId}"'),O&&U.push("${__tags}"),{query:U.join(" AND "),refId:""}}function P(S,L,O,j){const{filterByTraceID:N,filterBySpanID:F}=L;if(j)return{lsql:j,refId:""};if(!O)return;let U="${__tags}";return N&&S.traceID&&(U+=' or "${__span.traceId}"'),F&&S.spanID&&(U+=' or "${__span.spanId}"'),{lsql:U,refId:""}}function C(S,L,{labelValueSign:O="=",joinBy:j=", "}={}){return[...S.process.tags,...S.tags,{key:"spanId",value:S.spanID},{key:"traceId",value:S.traceID},{key:"name",value:S.operationName},{key:"duration",value:S.duration}].map(N=>{const F=L.find(U=>U.key===N.key);if(F)return`${F.value?F.value:F.key}${O}"${N.value}"`}).filter(N=>!!N).join(j)}function M(S,L={startMs:0,endMs:0},O=!1,j=!1){let N=Math.floor(S.startTime/1e3+L.startMs);const F=(S.startTime+S.duration)/1e3;let U=Math.floor(F+L.endMs);O&&U-N<1e3?U=N+1e3:j?(N=N-6e4,U=U+6e4):N===U&&U++;const w=(0,r.KQ)(U),B=(0,r.KQ)(N);return{from:B,to:w,raw:{from:B,to:w}}}function I(S,L,O){return{__trace:{text:"Trace",value:{duration:S,name:L,traceId:O}}}}function R(S){const L={};for(const O of S.process.tags)L[O.key]=O.value;for(const O of S.tags)L[O.key]=O.value;return{__span:{text:"Span",value:{spanId:S.spanID,traceId:S.traceID,duration:S.duration,name:S.operationName,tags:L}}}}function T(S,L){let O={};if(L){const j=L.tags&&L.tags.length>0?L.tags:m;O={__tags:{text:"Tags",value:C(S,j)}}}return O}},15583:(k,A,e)=>{"use strict";e.d(A,{Ji:()=>g,SQ:()=>o,zE:()=>r});var n=e(96540),s=e(62938),l=e(56271);const r=()=>(0,s.A)().slice(0,12),g={spanNameOperator:"=",serviceNameOperator:"=",fromOperator:">",toOperator:"<",tags:[{id:r(),operator:"="}]};function o(d){const[c,a]=(0,n.useState)(g),p=(0,n.useMemo)(()=>d&&(0,l.filterSpans)(c,d),[c,d]);return{search:c,setSearch:a,spanFilterMatches:p}}},35090:(k,A,e)=>{"use strict";e.d(A,{L:()=>l});var n=e(78368),s=e(56271);function l(i){if(!i)return null;let g=i.fields.length===1?i.fields[0].values[0]:r(i);return g?(0,s.transformTraceData)(g):null}function r(i){const g=new n.R(i),o={};for(let d=0;d<g.length;d++){const c=g.get(d);if(!c.spanID)return null;o[c.spanID]||(o[c.spanID]={serviceName:c.serviceName,tags:c.serviceTags})}return{traceID:g.get(0).traceID,processes:o,spans:g.toArray().map((d,c)=>{const a=[];return d.parentSpanID&&a.push({refType:"CHILD_OF",spanID:d.parentSpanID,traceID:d.traceID}),d.references&&a.push(...d.references.map(p=>({refType:"FOLLOWS_FROM",...p}))),{...d,duration:d.duration*1e3,startTime:d.startTime*1e3,processID:d.spanID,flags:0,references:a,logs:d.logs?.map(p=>({...p,timestamp:p.timestamp*1e3}))||[],dataFrameRowIndex:c}})}}},11140:(k,A,e)=>{"use strict";e.d(A,{v:()=>j});var n=e(74848),s=e(2543),l=e(96540),r=e(49785),i=e(71733),g=e(14110),o=e(39601),d=e(32264),c=e(88575),a=e(94354),p=e(42418),u=e(37390),m=e(55852),v=e(59429),x=e(16233),f=e(20470),E=e(31678),h=e(9955),y=e(28676),b=e(71176),D=(N=>(N.FETCH_DASHBOARD="fetch-dashboard",N.SET_DASHBOARD_LS="set-dashboard-ls-error",N))(D||{});function P(N,F){let U=[];return N==="table"&&F.panelState?.logs?.columns&&(F.panelState.logs?.labelFieldName&&U.push({id:"extractFields",options:{source:F.panelState.logs.labelFieldName}}),U.push({id:"organize",options:{indexByName:Object.values(F.panelState.logs.columns).reduce((w,B,K)=>({...w,[B]:K}),{}),includeByName:Object.values(F.panelState.logs.columns).reduce((w,B)=>({...w,[B]:!0}),{})}})),U}async function C(N){const F=R(N.queries,N.queryResponse,N?.panelState),U={targets:N.queries,type:F,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:N.datasource,transformations:P(F,N)};let w;if(N.dashboardUid)try{w=await(0,y.n)().getDashboardDTO(N.dashboardUid)}catch{throw"fetch-dashboard"}else w=await(0,b.X)();w.dashboard.panels=[U,...w.dashboard.panels??[]],w.dashboard.time=N.time;try{(0,f.OI)(w)}catch{throw"set-dashboard-ls-error"}}const M=N=>!N.hide,I=N=>F=>F.refId===N;function R(N,F,U){for(const{refId:w}of N.filter(M)){const B=I(w);if(F.flameGraphFrames.some(B))return"flamegraph";if(F.graphFrames.some(B))return"timeseries";if(F.logsFrames.some(B))return U?.logs?.visualisationType?U.logs.visualisationType:"logs";if(F.nodeGraphFrames.some(B))return"nodeGraph";if(F.traceFrames.some(B))return"traces";if(F.customFrames.some(B))return F.customFrames.find(B)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var T=(N=>(N.NewDashboard="new-dashboard",N.ExistingDashboard="existing-dashboard",N))(T||{});function S(N){}function L(N){return N?`d/${N}`:"dashboard/new"}var O=(N=>(N.UNKNOWN="unknown-error",N.NAVIGATION="navigation-error",N))(O||{});function j(N){const{exploreId:F,onClose:U}=N,w=(0,E.useSelector)((0,h.qq)(F)),[B,K]=(0,l.useState)(),{handleSubmit:W,control:z,formState:{errors:Y},watch:X}=(0,r.mN)({defaultValues:{saveTarget:"new-dashboard"}}),q=x.TP.hasPermission(E.AccessControlAction.DashboardsCreate),G=x.TP.hasPermission(E.AccessControlAction.DashboardsWrite),te=[];q&&te.push({label:"New dashboard",value:"new-dashboard"}),G&&te.push({label:"Existing dashboard",value:"existing-dashboard"});const H=te.length>1?X("saveTarget"):te[0].value,se=async(ne,le)=>{K(void 0);const _=le.saveTarget==="existing-dashboard"?le.dashboardUid:void 0;(0,g.rR)("e_2_d_submit",{newTab:ne,saveTarget:le.saveTarget,queries:w.queries.length});const{from:Q,to:ae}=w.range.raw;try{await C({dashboardUid:_,datasource:w.datasourceInstance?.getRef(),queries:w.queries,queryResponse:w.queryResponse,panelState:w?.panelsState,time:{from:typeof Q=="string"?Q:Q.toISOString(),to:typeof ae=="string"?ae:ae.toISOString()}})}catch(ee){switch(ee){case D.FETCH_DASHBOARD:K({error:ee,message:"Could not fetch dashboard information. Please try again."});break;case D.SET_DASHBOARD_LS:K({error:ee,message:"Could not add panel to dashboard. Please try again."});break;default:K({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const oe=L(_);if(!ne){U(),o.Ny.push(i.I.stripBaseFromUrl(oe));return}if(!!!e.g.open(d.$.appUrl+oe,"_blank")){K({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,f.yZ)();return}U()};return(0,l.useEffect)(()=>{(0,g.rR)("e_2_d_open")},[]),(0,n.jsxs)("form",{children:[te.length>1&&(0,n.jsx)(r.xI,{control:z,render:({field:{ref:ne,...le}})=>(0,n.jsx)(c.D,{label:"Target dashboard",description:"Choose where to add the panel.",children:(0,n.jsx)(a.z,{options:te,...le,id:"e2d-save-target"})}),name:"saveTarget"}),H==="existing-dashboard"&&(0,n.jsx)(r.xI,{render:({field:{ref:ne,value:le,onChange:_,...Q}})=>(0,n.jsx)(c.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:Y.dashboardUid?.message,invalid:!!Y.dashboardUid,children:(0,n.jsx)(v.b,{...Q,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:ae=>_(ae?.uid)})}),control:z,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),B&&(0,n.jsx)(p.F,{severity:"error",title:"Error adding the panel",children:B.message}),(0,n.jsxs)(u.a.ButtonRow,{children:[(0,n.jsx)(m.$n,{type:"reset",onClick:U,fill:"outline",variant:"secondary",children:"Cancel"}),(0,n.jsx)(m.$n,{type:"submit",variant:"secondary",onClick:W((0,s.partial)(se,!0)),icon:"external-link-alt",children:"Open in new tab"}),(0,n.jsx)(m.$n,{type:"submit",variant:"primary",onClick:W((0,s.partial)(se,!1)),icon:"apps",children:"Open dashboard"})]})]})}},12881:(k,A,e)=>{"use strict";e.d(A,{t:()=>l});var n=e(16233),s=e(31678);function l(){const r=n.TP.hasPermission(s.AccessControlAction.DashboardsCreate),i=n.TP.hasPermission(s.AccessControlAction.DashboardsWrite);return r&&!i?"Add panel to new dashboard":i&&!r?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(k,A,e)=>{"use strict";e.d(A,{s:()=>o});var n=e(74848),s=e(71733),l=e(39601),r=e(37390),i=e(67061),g=e(55852);function o(d){const{onDismiss:c,path:a,title:p}=d,u=()=>{e.g.open(s.I.assureBaseUrl(a),"_blank"),c()},m=()=>l.Ny.push(a);return(0,n.jsxs)(r.a,{title:p,isOpen:!0,onDismiss:c,children:[(0,n.jsx)(i.B,{direction:"column",gap:1,children:(0,n.jsx)("p",{children:"Do you want to proceed in the current tab or open a new tab?"})}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(g.$n,{onClick:c,fill:"outline",variant:"secondary",children:"Cancel"}),(0,n.jsx)(g.$n,{type:"submit",variant:"secondary",onClick:u,icon:"external-link-alt",children:"Open in new tab"}),(0,n.jsx)(g.$n,{type:"submit",variant:"primary",onClick:m,icon:"apps",children:"Open"})]})]})}},30973:(k,A,e)=>{"use strict";e.d(A,{w:()=>i});var n=e(74848),s=e(96540),l=e(38138),r=e(75462);function i({extensions:d,onSelect:c}){const{categorised:a,uncategorised:p}=o(d),u=p.length>0&&Object.keys(a).length>0;return(0,n.jsx)(l.W,{children:(0,n.jsxs)(n.Fragment,{children:[Object.keys(a).map(m=>(0,n.jsx)(l.W.Group,{label:(0,r.pL)(m,25),children:g(a[m],c)},m)),u&&(0,n.jsx)(l.W.Divider,{},"divider"),g(p,c)]})})}function g(d,c){return d.map(a=>(0,n.jsx)(l.W.Item,{ariaLabel:a.title,icon:a?.icon||"plug",label:(0,r.pL)(a.title,25),onClick:p=>{if(a.path)return c(a);a.onClick?.(p)}},a.id))}function o(d){return(0,s.useMemo)(()=>{const c=[],a={};for(const p of d){if(!p.category){c.push(p);continue}Array.isArray(a[p.category])||(a[p.category]=[]),a[p.category].push(p)}return{uncategorised:c,categorised:a}},[d])}},33368:(k,A,e)=>{"use strict";e.d(A,{h:()=>l});var n=e(96540),s=e(96192);const l=(r,i)=>(0,n.useMemo)(()=>(0,s.YV)(r,i),[r,i])},39590:(k,A,e)=>{"use strict";e.d(A,{m:()=>te,s:()=>se});var n=e(96540),s=e(76888),l=e(3169),r=e(31678),i=e(9955),g=e(34028);const o={parse:ne=>{if(!ne.left&&!ne.right)return{to:{left:{datasource:null,queries:[],range:{from:g.kn.from,to:g.kn.to}},schemaVersion:0},error:!1};let le,_,Q,ae;return typeof ne.left=="string"&&([le,Q]=p(ne.left)),typeof ne.right=="string"?[_,ae]=p(ne.right):ne.right&&(_=a,ae=!0),le||(le=a),{to:{schemaVersion:0,left:le,..._&&{right:_}},error:!!Q||!!ae}}},d=(ne,...le)=>le.some(_=>ne.hasOwnProperty(_));var c=(ne=>(ne[ne.RangeFrom=0]="RangeFrom",ne[ne.RangeTo=1]="RangeTo",ne[ne.Datasource=2]="Datasource",ne[ne.SegmentsStart=3]="SegmentsStart",ne))(c||{});const a={datasource:null,queries:[],range:g.kn};function p(ne){let le;try{le=JSON.parse(ne)}catch{return[a,!0]}if(!Array.isArray(le))return[{queries:[],range:g.kn,...le},!1];if(le.length<=3)return[a,!0];const _={from:le[0],to:le[1]},Q=le[2],ae=le.slice(3),oe=ae.filter(ee=>!d(ee,"ui","mode","__panelsState")),J=ae.find(ee=>d(ee,"__panelsState"))?.__panelsState;return[{datasource:Q,queries:oe,range:_,panelsState:J},!1]}var u=e(87490),m=e(15961);const v={parse:ne=>{if(!ne||!ne.panes||typeof ne.panes!="string")return{to:{schemaVersion:1,panes:{[(0,u.o$)()]:x}},error:!1};let le;try{le=JSON.parse(ne.panes)}catch{}if(le==null||typeof le!="object")return{to:{schemaVersion:1,panes:{[(0,u.o$)()]:x}},error:!0};const _=Object.entries(le).map(([Q,ae])=>[Q,f(ae)]).reduce((Q,[ae,oe])=>{let J=ae;return(J.length!==3||/^\d+$/.test(J)||J.split("").some(ee=>u.WP.indexOf(ee)===-1))&&(J=(0,u.o$)()),{...Q,[J]:oe}},{});return Object.keys(_).length||(_[(0,u.o$)()]=x),{to:{schemaVersion:1,panes:_},error:!1}},migrate:ne=>({schemaVersion:1,panes:{[(0,u.o$)()]:ne.left,...ne.right&&{[(0,u.o$)()]:ne.right}}})},x={datasource:null,queries:[],range:g.kn};function f(ne){return!ne||typeof ne!="object"?x:{...x,...(0,m.C)("queries",ne)&&Array.isArray(ne.queries)&&{queries:ne.queries},...(0,m.C)("datasource",ne)&&typeof ne.datasource=="string"&&{datasource:ne.datasource},...(0,m.C)("panelsState",ne)&&!!ne.panelsState&&typeof ne.panelsState=="object"&&{panelsState:ne.panelsState},...(0,m.C)("range",ne)&&!!ne.range&&typeof ne.range=="object"&&(0,m.C)("from",ne.range)&&(0,m.C)("to",ne.range)&&typeof ne.range.from=="string"&&typeof ne.range.to=="string"&&{range:{from:ne.range.from,to:ne.range.to}}}}const E=ne=>y(ne),h=[o,v],y=ne=>{const le=b(ne),[_,...Q]=h.slice(le),{error:ae,to:oe}=_.parse(ne);return[Q.reduce((ee,de)=>de.migrate?de.migrate(ee):ee,oe),ae]};function b(ne){return!ne||!("schemaVersion"in ne)||!ne.schemaVersion?0:typeof ne.schemaVersion=="number"?ne.schemaVersion:typeof ne.schemaVersion=="string"?Number.parseInt(ne.schemaVersion,10):0}var D=e(2543),P=e(18226),C=e(62860),M=e(62256),I=e(29436),R=e(23994),T=e(89224),S=e(27649),L=e(39070),O=e(41987),j=e(31193),N=e(14678);const F=(ne,le)=>{const _=!(0,D.isEqual)(le?.datasource,ne?.datasource),Q=!(0,D.isEqual)(le?.queries,ne?.queries),ae=!(0,D.isEqual)(le?.range||g.kn,ne?.range||g.kn),oe=!(0,D.isEqual)(le?.panelsState,ne?.panelsState);return{datasource:_,queries:Q,range:ae,panelsState:oe}};async function U(ne,le,_){if(ne)try{return await(0,j.tR)().get(ne)}catch{}const Q=[...new Set(le.map(ae=>ae.datasource).filter(L.zz).map(ae=>typeof ae=="string"?ae:ae.uid))];try{if(Q.length>=1){const ae=(await Promise.allSettled(Q.map(oe=>(0,j.tR)().get(oe)))).filter(m.s);if(ae.length>1)return await(0,j.tR)().get(N.uv);if(ae.length===1)return await(0,j.tR)().get(Q[0])}}catch{}return(0,j.tR)().get((0,u.HQ)(_)).catch(()=>(0,j.tR)().get()).catch(()=>{})}function w(ne){return{...ne.getDefaultQuery?.(O.Jk.Explore),refId:"A",datasource:ne.getRef()}}function B(ne){return ne.name===N.uv}function K(ne){return ne&&B(ne)?le=>!!le.datasource:le=>le.datasource?typeof le.datasource=="string"?le.datasource===ne?.uid||le.datasource===ne?.name:le.datasource.uid===ne?.uid:!0}async function W(ne){return(await Promise.allSettled(ne.map(_=>(0,j.tR)().get(_.datasource).then(Q=>({query:_,ds:Q}))))).filter(m.s).map(({value:_})=>_.query)}function z(ne,le,_){const Q=Object.values(ne.panes);if(Q.length>1){const ae=Q.some(({range:oe},J,[{range:ee}])=>!(0,D.isEqual)(oe,ee));_((0,I.qz)({syncedTimes:!ae}))}Object.entries(ne.panes).forEach(async([ae,oe],J)=>{const{datasource:ee,queries:de,range:xe,panelsState:re}=oe,ue=le[ae];if(ue!==void 0){const Te=F(oe,te(ue));Promise.resolve().then(async()=>{Te.datasource&&ee&&await _((0,C.wh)({exploreId:ae,datasource:ee}))}).then(async()=>{Te.range&&_((0,T.JA)({exploreId:ae,rawRange:(0,g.Z9)(xe)})),Te.queries&&_((0,R.h9)({exploreId:ae,queries:(0,S.v)(de)})),(Te.queries||Te.range)&&(await _((0,R.hS)(ae)),_((0,R.Od)({exploreId:ae}))),Te.panelsState&&re&&_((0,M.fx)({exploreId:ae,panelsState:re}))})}else _((0,M.Gd)({exploreId:ae,datasource:ee||"",queries:(0,S.v)(de),range:(0,g.Z9)(xe),panelsState:re,position:J,eventBridge:new P.o}))}),Object.keys(le).filter(ae=>!Object.keys(ne.panes).includes(ae)).forEach(ae=>_((0,I.J8)(ae)))}function Y(ne,le,_,Q,ae){Q((0,I.Ve)()),Promise.all(Object.entries(ne.panes).map(([oe,{datasource:J,queries:ee,range:de,panelsState:xe}])=>U(J,ee,_).then(re=>Promise.resolve(re?ee.length?(0,S.v)(ee).filter(K(re)).map(B(re)?D.identity:ue=>({...ue,datasource:re.getRef()})):(0,j.tR)().get(B(re)?void 0:re.getRef()).then(ue=>[w(ue)]):[]).then(async ue=>{let Te=await W(ue);return!Te.length&&re&&(Te=[w(B(re)?await(0,j.tR)().get():re)]),{exploreId:oe,range:de,panelsState:xe,queries:Te,datasource:re}})))).then(async oe=>{const J=await Promise.all(oe.map(({exploreId:ue,range:Te,panelsState:ge,queries:Oe,datasource:Ue})=>Q((0,M.Gd)({exploreId:ue,datasource:Ue,queries:Oe,range:(0,g.Z9)(Te),panelsState:ge,eventBridge:new P.o})).unwrap()));if(J.length>1){const ue=J.some(({state:Te},ge,[{state:Oe}])=>!(0,D.isEqual)(Te.range.raw,Oe.range.raw));Q((0,I.qz)({syncedTimes:!ue}))}const ee=J.reduce((ue,{exploreId:Te,state:ge})=>({...ue,[Te]:te(ge)}),{}),de=ae.getSearchObject();let xe={};for(const[ue,Te]of Object.entries(de).filter(([ge])=>!["schemaVersion","panes","orgId","left","right"].includes(ge)))xe[ue]=Te;const re=new URLSearchParams({schemaVersion:`${ne.schemaVersion}`,panes:JSON.stringify(ee),orgId:`${_}`,...xe});ae.replace({pathname:ae.getLocation().pathname,search:re.toString()}),le.current="done"})}function X(ne,le){return ne.current=C.wh.pending.type===le.type,[I.J8.type,I.ve.fulfilled.type,R.Od.pending.type,T.eM.type,M.fx.type,C.wh.fulfilled.type].includes(le.type)&&!ne.current}function q(ne,le,_,Q){const ae=Object.entries(ne.panes).reduce((oe,[J,ee])=>ee?{...oe,[J]:te(ee)}:oe,{});if(!(0,D.isEqual)(le.current.panes,JSON.stringify(ae))){const oe=!!le.current.panes&&Object.values(le.current.panes).filter(Boolean).length===0||_.current==="pending";le.current={panes:JSON.stringify(ae)},Q.partial({panes:le.current.panes},oe)}}var G=e(76885);function te(ne){return{datasource:ne.datasourceInstance?.uid||"",queries:ne.queries.map(u.w4),range:(0,G.sQ)(ne.range.raw),panelsState:H(ne.panelsState)}}function H(ne){let le=(0,D.mapValues)(ne,_=>(0,D.isObject)(_)?H(_):_);if(le=(0,D.omitBy)(le,D.isEmpty),!(0,D.isEmpty)(le))return le}function se(ne){const{location:le}=(0,s.Il)(),_=(0,r.useDispatch)(),Q=(0,r.useSelector)(i.Qb),ae=(0,n.useRef)(Q),oe=(0,r.useSelector)(re=>re.user.orgId),J=(0,n.useRef)(ne),ee=(0,n.useRef)("notstarted"),de=(0,n.useRef)(!1),{warning:xe}=(0,l._2)();(0,n.useEffect)(()=>{ne.panes||(ee.current="notstarted",J.current=ne)},[ne]),(0,n.useEffect)(()=>{const re=_((0,r.addListener)({predicate:ue=>X(de,ue),effect:async(ue,{cancelActiveListeners:Te,delay:ge,getState:Oe})=>{Te(),await ge(200),q(Oe().explore,J,ee,le)}}));return()=>re()},[_,le]),(0,n.useEffect)(()=>{ae.current=Q},[Q]),(0,n.useEffect)(()=>{const re=J.current?.panes!==ne.panes,[ue,Te]=E(ne);Te&&xe("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!re&&ee.current==="notstarted"&&(ee.current="pending",Y(ue,ee,oe,_,le)),J.current=ne,re&&ee.current==="done"&&z(ue,ae.current,_)},[_,oe,le,ne,xe])}},15961:(k,A,e)=>{"use strict";e.d(A,{C:()=>s,s:()=>n});const n=l=>l.status==="fulfilled";function s(l,r){return l in r}},324:(k,A,e)=>{"use strict";e.d(A,{M:()=>p,v:()=>m});var n=e(88483),s=e(19347),l=e(14110),r=e(82467),i=e(3169),g=e(18380),o=e(99140),d=e(62256),c=e(29436),a=e(23994);const p=v=>new n.c(x=>{const f=o.M_.getState().explore.panes[v]?.correlations;if(f)x.next(f),x.complete();else{const E=o.M_.subscribe(()=>{const h=o.M_.getState().explore.panes[v]?.correlations;h&&(E(),x.next(h),x.complete())})}});function u(v){return async(x,f)=>{const E=f().explore.panes[v];if(E.datasourceInstance?.uid!==void 0){let h=E.datasourceInstance.meta.mixed?E.queries.map(b=>b.datasource?.uid).filter(b=>b!==null):[E.datasourceInstance.uid];const y=await(0,g.J6)(h);x((0,d.Fb)({exploreId:v,correlations:y.correlations||[]}))}}}function m(v,x,f){return async(E,h)=>{const y=Object.keys(h().explore?.panes),b=h().explore?.panes[y[0]],D=h().explore?.panes[y[1]];if(!b||!D)return;const P=b.datasourceInstance?.meta.mixed?b.queries[0].datasource:b.datasourceInstance?.getRef(),C=D.datasourceInstance?.meta.mixed?D.queries[0].datasource:D.datasourceInstance?.getRef(),[M,I]=await Promise.all([(0,s.l)().get(P),(0,s.l)().get(C)]);if(M?.uid&&I?.uid&&D.correlationEditorHelperData?.resultField){const R={sourceUID:M.uid,targetUID:I.uid,label:v||await(0,g.tZ)(b,D),description:x,config:{field:D.correlationEditorHelperData.resultField,target:D.queries[0],type:"query",transformations:f}};await(0,g.$q)(M.uid,R).then(async()=>{E((0,c.J8)(y[1])),await E(u(y[0])),await E((0,a.Od)({exploreId:y[0]})),(0,l.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:M.type,targetDataSourceType:I.type})}).catch(T=>{E((0,r.dx)((0,i.gi)("Error creating correlation",T))),console.error(T)})}}}},62860:(k,A,e)=>{"use strict";e.d(A,{YR:()=>v,wh:()=>m});var n=e(65307),s=e(14110),l=e(11134),r=e(87490),i=e(18380),g=e(31678),o=e(57288),d=e(62256),c=e(23994),a=e(89224),p=e(34028);const u=(0,n.VP)("explore/updateDatasourceInstance"),m=(0,g.createAsyncThunk)("explore/changeDatasource",async({datasource:x,exploreId:f,options:E},{getState:h,dispatch:y})=>{const b=h().user.orgId,{history:D,instance:P}=await(0,p.BE)(b,x),C=h().explore.panes[f].datasourceInstance;(0,s.rR)("explore_change_ds",{from:(C?.meta?.mixed?"mixed":C?.type)||"unknown",to:P.meta.mixed?"mixed":P.type,exploreId:f}),y(u({exploreId:f,datasourceInstance:P,history:D}));const M=h().explore.panes[f].queries,I=(0,p.dq)(P.uid,M),R=await(0,i.J6)(I);y((0,d.Fb)({exploreId:f,correlations:R.correlations||[]})),E?.importQueries&&await y((0,c.y2)(f,M,C,P)),h().explore.panes[f].isLive&&y((0,a.hO)({exploreId:f,refreshInterval:l.cC.offOption.value})),E?.importQueries&&y((0,c.Od)({exploreId:f}))}),v=(x,f)=>{if(u.match(f)){const{datasourceInstance:E,history:h}=f.payload;return(0,r._u)(x.querySubscription),{...x,datasourceInstance:E,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,o.Ez)(),queryResponse:(0,p.RA)(),queryKeys:[],history:h}}return x}},62256:(k,A,e)=>{"use strict";e.d(A,{EA:()=>u,Fb:()=>f,Gd:()=>h,LJ:()=>y,QZ:()=>E,fx:()=>p,nE:()=>m});var n=e(65307),s=e(87490),l=e(18380),r=e(32901),i=e(31678),g=e(62860),o=e(23994),d=e(89224),c=e(34028);const a=(0,n.VP)("explore/changeSize"),p=(0,n.VP)("explore/changePanels");function u(b,D,P){return async(C,M)=>{const I=M().explore.panes[b];if(I===void 0)return;const{panelsState:R}=I;C(p({exploreId:b,panelsState:{...R,[D]:P}}))}}const m=(0,n.VP)("explore/changeCorrelationHelperData"),v=(0,n.VP)("explore/initializeExploreAction"),x=(0,n.VP)("explore/setUrlReplaced"),f=(0,n.VP)("explore/saveCorrelationsAction");function E(b,{width:D}){return a({exploreId:b,width:D})}const h=(0,i.createAsyncThunk)("explore/initializeExplore",async({exploreId:b,datasource:D,queries:P,range:C,panelsState:M,correlationHelperData:I,eventBridge:R},{dispatch:T,getState:S,fulfillWithValue:L})=>{let O,j=[];if(D){const N=S().user.orgId,F=await(0,c.BE)(N,D);O=F.instance,j=F.history}if(T(v({exploreId:b,queries:P,range:(0,c.eO)(C,(0,r.O)(S().user)),datasourceInstance:O,history:j,eventBridge:R})),M!==void 0&&T(p({exploreId:b,panelsState:M})),T((0,d.JA)({exploreId:b})),O){const N=(0,c.dq)(O.uid,P),F=await(0,l.J6)(N);T(f({exploreId:b,correlations:F.correlations||[]})),T((0,o.Od)({exploreId:b}))}return I!==void 0&&S().explore.correlationEditorDetails?.editorMode&&T(m({exploreId:b,correlationEditorHelperData:I})),L({exploreId:b,state:S().explore.panes[b]})}),y=(b=(0,c.HZ)(),D)=>{if(b=(0,o.JQ)(b,D),b=(0,g.YR)(b,D),b=(0,d.QP)(b,D),a.match(D)){const P=D.payload.width;return{...b,containerWidth:P}}if(p.match(D)){const{panelsState:P}=D.payload;return{...b,panelsState:P}}if(m.match(D)){const{correlationEditorHelperData:P}=D.payload;return{...b,correlationEditorHelperData:P}}if(f.match(D))return{...b,correlations:D.payload.correlations};if(v.match(D)){const{queries:P,range:C,datasourceInstance:M,history:I,eventBridge:R}=D.payload;return{...b,range:C,queries:P,initialized:!0,eventBridge:R,queryKeys:(0,s.dY)(P),datasourceInstance:M,history:I,queryResponse:(0,c.RA)(),cache:[],correlations:[]}}return b}},72433:(k,A,e)=>{"use strict";e.d(A,{Bj:()=>E,H9:()=>c,PA:()=>x,Uu:()=>m,VM:()=>a,fP:()=>f,jX:()=>u,ri:()=>o,s1:()=>p,sh:()=>d,wk:()=>v});var n=e(65307),s=e(81523),l=e(11401),r=e(29436);const i=(0,n.VP)("explore/historyUpdated"),g=({updatedQuery:h,deletedId:y})=>async(b,D)=>{const P=D().explore.richHistory,C=P.map(I=>I.id===h?.id?h:I).filter(I=>I.id!==y),M=P.length-C.length;b((0,r.U2)({richHistoryResults:{richHistory:C,total:D().explore.richHistoryTotal-M}}))},o=(h,y,b,D,P)=>async(C,M)=>{const I=P?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!M().explore.richHistoryStorageFull,limitExceededWarning:!M().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:R,limitExceeded:T}=await(0,s.l0)({localOverride:h,datasource:{uid:y,name:b},queries:D,starred:!1,showNotif:I});P||(R&&C((0,r.fj)()),T&&C((0,r.D)()))},d=(h,y)=>async(b,D)=>{const P=await(0,s.oU)(h,y);b(g({updatedQuery:P}))},c=(h,y)=>async b=>{const D=await(0,s.cX)(h,y);b(g({updatedQuery:D}))},a=h=>async y=>{const b=await(0,s.NC)(h);y(g({deletedId:b}))},p=()=>async h=>{await(0,s.X1)(),h((0,r.U2)({richHistoryResults:{richHistory:[],total:0}})),h((0,r.U2)({richHistoryResults:{richHistory:[],total:0}}))},u=()=>async(h,y)=>{const b=y().explore.richHistorySearchFilters;if(b){const D=await(0,s.DI)(b);h((0,r.U2)({richHistoryResults:D}))}},m=()=>async(h,y)=>{const b=y().explore.richHistorySearchFilters,D=y().explore.richHistory;if(b&&D){const P={...b,page:(b?.page||1)+1},C=await(0,s.DI)(P),M=[...D,...C.richHistory];h((0,r.Ju)({filters:P})),h((0,r.U2)({richHistoryResults:{richHistory:M,total:C.total}}))}},v=()=>async h=>{h((0,r.Ju)({filters:void 0})),h((0,r.U2)({richHistoryResults:{richHistory:[],total:0}}))},x=()=>async(h,y)=>{let b=y().explore.richHistorySettings;b||(b=await(0,s.Gx)(),h((0,r.bZ)(b)))},f=h=>async y=>{y((0,r.bZ)(h)),await(0,s.rs)(h)},E=h=>async(y,b)=>{await y((0,r.Ju)({filters:{...h}}));const D=b().explore.richHistorySettings;(0,l.gQ)().lastUsedDataSourcesAvailable&&await y(f({...D,lastUsedDatasourceFilters:h.datasourceFilters}))}},29436:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>j,D:()=>x,J8:()=>D,JA:()=>b,Ju:()=>E,U2:()=>m,Ve:()=>C,am:()=>R,bZ:()=>f,fj:()=>v,nD:()=>h,ow:()=>T,qz:()=>u,tP:()=>y,ve:()=>M});var n=e(65307),s=e(2543),l=e.n(s),r=e(18226),i=e(39601),g=e(87490),o=e(23989),d=e(31678),c=e(27649),a=e(62256),p=e(34028);const u=(0,n.VP)("explore/syncTimes"),m=(0,n.VP)("explore/richHistoryUpdated"),v=(0,n.VP)("explore/richHistoryStorageFullAction"),x=(0,n.VP)("explore/richHistoryLimitExceededAction"),f=(0,n.VP)("explore/richHistorySettingsUpdated"),E=(0,n.VP)("explore/richHistorySearchFiltersUpdatedAction"),h=(0,n.VP)("explore/splitSizeUpdateAction"),y=(0,n.VP)("explore/maximizePaneAction"),b=(0,n.VP)("explore/evenPaneResizeAction"),D=(0,n.VP)("explore/splitClose"),P=(0,n.VP)("explore/setPaneState"),C=(0,n.VP)("explore/clearPanes"),M=(0,d.createAsyncThunk)("explore/splitOpen",async(N,{getState:F,dispatch:U})=>{const w=Object.values(F().explore.panes)[0],B=N?.queries??w?.queries??[];Object.keys(F().explore.panes).forEach((z,Y)=>{Y>=1&&U(D(z))});const K=N?.range||w?.range.raw||p.kn;let W=(0,g.o$)();for(;F().explore.panes[W];)W=(0,g.o$)();await U(I({exploreId:W,datasource:N?.datasourceUid||w?.datasourceInstance?.getRef(),queries:(0,c.v)(B),range:K,panelsState:N?.panelsState||w?.panelsState,correlationHelperData:N?.correlationHelperData,eventBridge:new r.o})),w?.range&&await U(u({syncedTimes:(0,s.isEqual)(w.range.raw,K)}))}),I=(0,d.createAsyncThunk)("explore/createNewSplitOpen",async(N,{dispatch:F})=>{await F((0,a.Gd)(N))}),R=(0,n.VP)("explore/changeCorrelationEditorDetails"),T=(N,F)=>async U=>{const{timeRange:w,getExploreUrl:B,openInNewWindow:K}=F,W=await B({queries:N.targets,dsRef:N.datasource,scopedVars:N.scopedVars,timeRange:w,adhocFilters:(0,o.w)().getAdhocFilters(N.datasource?.uid??"",!0)});if(K&&W){K(W);return}i.Ny.push(W)},S=(0,p.HZ)(),L={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},j={explore:(N=L,F)=>{if(D.match(F)){const{[F.payload]:w,...B}={...N.panes};return{...N,panes:B,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(h.match(F)){const{largerExploreId:w}=F.payload;return{...N,largerExploreId:w,maxedExploreId:void 0,evenSplitPanes:w===void 0}}if(y.match(F)){const{exploreId:w}=F.payload;return{...N,largerExploreId:w,maxedExploreId:w,evenSplitPanes:!1}}if(b.match(F))return{...N,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(u.match(F))return{...N,syncedTimes:F.payload.syncedTimes};if(v.match(F))return{...N,richHistoryStorageFull:!0};if(x.match(F))return{...N,richHistoryLimitExceededWarningShown:!0};if(f.match(F)){const w=F.payload;return{...N,richHistorySettings:w}}if(m.match(F)){const{richHistory:w,total:B}=F.payload.richHistoryResults;return{...N,richHistory:w,richHistoryTotal:B}}if(E.match(F)){const w=F.payload.filters;return{...N,richHistorySearchFilters:w}}if(I.pending.match(F))return{...N,panes:{...N.panes,[F.meta.arg.exploreId]:S}};if(a.Gd?.pending.match(F)){const w=Object.entries(N.panes),B=w.slice(0,F.meta.arg.position),K=w.slice(B.length),W=[...B,[F.meta.arg.exploreId,S],...K].reduce((z,[Y,X])=>({...z,[Y]:X}),{});return{...N,panes:W}}if(C.match(F))return{...N,panes:{}};if(R.match(F)){const{editorMode:w,label:B,description:K,canSave:W,correlationDirty:z,queryEditorDirty:Y,isExiting:X,postConfirmAction:q,transformations:G}=F.payload;return{...N,correlationEditorDetails:{editorMode:!!(w??N.correlationEditorDetails?.editorMode),canSave:!!(W??N.correlationEditorDetails?.canSave),label:B??N.correlationEditorDetails?.label,description:K??N.correlationEditorDetails?.description,transformations:G??N.correlationEditorDetails?.transformations,correlationDirty:!!(z??N.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(Y??N.correlationEditorDetails?.queryEditorDirty),isExiting:!!(X??N.correlationEditorDetails?.isExiting),postConfirmAction:q}}}const U=F.payload?.exploreId;return typeof U=="string"?{...N,panes:Object.entries(N.panes).reduce((w,[B,K])=>({...w,[B]:B===U?(0,a.LJ)(K,F):K}),{})}:N}}},23994:(k,A,e)=>{"use strict";e.d(A,{_0:()=>ze,He:()=>jt,hS:()=>pe,bO:()=>Ee,IL:()=>$t,rR:()=>Fe,y2:()=>Pe,Az:()=>sn,PD:()=>he,JQ:()=>qt,S6:()=>Ie,Od:()=>De,GI:()=>Tt,q9:()=>Ct,h1:()=>de,qk:()=>_e,Rk:()=>pt,h9:()=>je,TO:()=>Yt});var n=e(65307),s=e(32017),l=e.n(s),r=e(2543),i=e(49510),g=e(62467),o=e(58307),d=e(69862),c=e(99165),a=e(39070),p=e(73372),u=e(47232),m=e(9557),v=e(40187),x=e(26272),f=e(14236),E=e(80822),h=e(19347),y=e(32264),b=e(87490),D=e(80582),P=e(18380),C=e(31193),M=e(32901),I=e(13137),R=e(14678),T=e(31678),S=e(82467),L=e(3169),O=e(39374),j=e(81160),N=e(57875),F=e(91890),U=e(57934),w=e(11261),B=e(69147),K=e(91002),W=e(15162);const z=Mt=>{const Jt=[],Ut=[],Gt=[],Lt=[],At=[],Nt=[],Dn=[],An=[];for(const Pn of Mt.series){if(ne(Pn)){An.push(Pn);continue}switch(Pn.meta?.preferredVisualisationType){case"logs":Lt.push(Pn);break;case"graph":Jt.push(Pn);break;case"trace":At.push(Pn);break;case"table":Ut.push(Pn);break;case"rawPrometheus":Gt.push(Pn);break;case"nodeGraph":Nt.push(Pn);break;case"flamegraph":Dn.push(Pn);break;default:se(Pn)&&Jt.push(Pn),Ut.push(Pn)}}return{...Mt,graphFrames:Jt,tableFrames:Ut,logsFrames:Lt,traceFrames:At,nodeGraphFrames:Nt,customFrames:An,flameGraphFrames:Dn,rawPrometheusFrames:Gt,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},Y=({showCorrelationEditorLinks:Mt,queries:Jt,correlations:Ut,defaultTargetDatasource:Gt})=>Lt=>{if(Mt&&Gt)for(const At of Lt.series)for(const Nt of At.fields){Nt.config.links=[],Nt.display=Nt.display||(0,N.H)();const Dn={};At.fields.map(An=>{Dn[`${An.name}`]=`\${__data.fields.['${An.name}']}`}),Nt.config.links.push({url:"",origin:F.x0.ExploreCorrelationsEditor,title:`Correlate with ${Nt.name}`,internal:{datasourceUid:Gt.uid,datasourceName:Gt.name,query:{datasource:{uid:Gt.uid}},meta:{correlationData:{resultField:Nt.name,vars:Dn,origVars:Dn}}}})}else if(Jt?.length&&Ut?.length){const At=(0,r.mapValues)((0,r.groupBy)(Jt,"refId"),"0.datasource.uid");(0,P.cA)(Lt.series,Ut,At)}return Lt},X=Mt=>Mt.graphFrames.length?{...Mt,graphResult:Mt.graphFrames}:{...Mt,graphResult:null},q=Mt=>{if(Mt.tableFrames.length===0)return(0,g.of)({...Mt,tableResult:null});Mt.tableFrames.sort((Lt,At)=>{const Nt=Lt.refId,Dn=At.refId;return Nt>Dn?1:Nt<Dn?-1:0});const Jt=Mt.tableFrames.every(Lt=>se(Lt)),Ut={interpolate:Lt=>Lt};return(Jt?(0,g.of)(Mt.tableFrames).pipe(U.c.joinByFieldTransformer.operator({},Ut)):(0,g.of)(Mt.tableFrames).pipe(U.c.mergeTransformer.operator({},Ut))).pipe((0,j.T)(Lt=>{for(const At of Lt)for(const Nt of At.fields)Nt.display=Nt.display??(0,N.J)({field:Nt,theme:y.$.theme2,timeZone:Mt.request?.timezone??"browser"});return{...Mt,tableResult:Lt}}))},G=Mt=>{const Jt=Mt.rawPrometheusFrames;if(!Jt||Jt.length===0)return(0,g.of)({...Mt,tableResult:null});Jt.sort((At,Nt)=>{const Dn=At.refId,An=Nt.refId;return Dn>An?1:Dn<An?-1:0});const Ut=Jt.every(At=>se(At)),Gt={interpolate:At=>At};return(Ut?(0,g.of)(Jt).pipe(U.c.joinByFieldTransformer.operator({},Gt)):(0,g.of)(Jt).pipe(U.c.mergeTransformer.operator({},Gt))).pipe((0,j.T)(At=>{const Nt=At[0];for(const Dn of Nt.fields)Dn.display=Dn.display??(0,N.J)({field:Dn,theme:y.$.theme2,timeZone:Mt.request?.timezone??"browser"});return{...Mt,rawPrometheusResult:Nt}}))},te=(Mt={})=>Jt=>{if(Jt.logsFrames.length===0)return{...Jt,logsResult:null};const Ut=Jt.request?.intervalMs,Gt=(0,B.HT)(Jt.logsFrames,Ut,Mt.absoluteRange,Mt.queries,Mt.deduplicate),Lt=(0,b.uE)(Mt.refreshInterval),At=(0,K.zy)(Gt,Lt),Nt=At.rows,Dn=At.series,An={...At,rows:Nt,series:Dn};return{...Jt,logsResult:An}};function H(Mt,Jt,Ut,Gt,Lt,At,Nt){return(0,g.of)(Mt).pipe((0,j.T)(Dn=>(0,f.N$)(Dn,Jt)),(0,j.T)(Y({defaultTargetDatasource:Nt,showCorrelationEditorLinks:At,queries:Gt,correlations:Lt})),(0,j.T)(z),(0,j.T)(X),(0,j.T)(Ut),(0,d.Z)(G),(0,d.Z)(q))}function se(Mt){const Jt=(0,r.groupBy)(Mt.fields,Ut=>Ut.type);return!!(Object.keys(Jt).length===2&&Jt[w.PU.time]?.length===1&&Jt[w.PU.number])}function ne(Mt){return Mt.meta?.preferredVisualisationPluginId?(0,W.oZ)(Mt.meta?.preferredVisualisationPluginId):!1}var le=e(57288),_=e(324),Q=e(62256),ae=e(72433),oe=e(29436),J=e(89224),ee=e(34028);const de=Mt=>Jt=>{const Ut=Jt.explore.panes[Mt];return Ut&&Ut.queryResponse?Ut.queryResponse.state===a.Gu.Loading||Ut.queryResponse.state===a.Gu.Streaming:!1},xe=(0,n.VP)("explore/addQueryRow"),re=(0,n.VP)("explore/changeQueries"),ue=(0,n.VP)("explore/cancelQueries"),Te=(0,n.VP)("explore/queriesImported"),ge=(0,n.VP)("explore/queryStoreSubscription"),Oe=(0,n.VP)("explore/setSupplementaryQueryEnabledAction"),Ue=(0,n.VP)("explore/storeSupplementaryQueryDataProviderAction"),Xe=(0,n.VP)("explore/cleanSupplementaryQueryDataProviderAction"),we=(0,n.VP)("explore/cleanSupplementaryQueryAction"),qe=(0,n.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),We=(0,n.VP)("explore/updateSupplementaryQueryDataAction"),Ce=(0,n.VP)("explore/queryStreamUpdated"),je=(0,n.VP)("explore/setQueries"),Ke=(0,n.VP)("changeLoadingState"),_e=(0,n.VP)("explore/setPausedState"),Fe=(0,n.VP)("explore/clearLogs"),at=(0,n.VP)("explore/scanStart"),Ct=(0,n.VP)("explore/scanStop"),Dt=(0,n.VP)("explore/addResultsToCache"),tt=(0,n.VP)("explore/clearCache");function ze(Mt,Jt){return async(Ut,Gt)=>{const Lt=Gt().explore.panes[Mt];let At;Lt.datasourceInstance?.meta.mixed?At=(0,r.findLast)(Lt.queries,Dn=>!!Dn.datasource)?.datasource||void 0:At=Lt.datasourceInstance?.getRef();const Nt=await(0,b.Ll)(Lt.queries,Jt,At);Ut(xe({exploreId:Mt,index:Jt,query:Nt}))}}function pe(Mt){return(Jt,Ut)=>{Jt(Ct({exploreId:Mt})),Jt(ue({exploreId:Mt}));const Gt=Ut().explore.panes[Mt].supplementaryQueries;for(const Lt of le.VW)Jt(Xe({exploreId:Mt,type:Lt})),Gt[Lt]?.data?.state!==a.Gu.Done&&Jt(we({exploreId:Mt,type:Lt}))}}const Se=(Mt,Jt)=>{const Ut=Mt.getRef();return Jt.map(Gt=>({...Gt,datasource:Ut}))},fe=async(Mt,Jt,Ut)=>{let Gt=[];if(Jt.meta?.id===Mt.meta?.id)Gt=Ut;else if((0,p.Ee)(Jt)&&(0,p.FL)(Mt)){const Lt=await Jt.exportToAbstractQueries(Ut);Gt=await Mt.importFromAbstractQueries(Lt)}else Mt.importQueries&&(Gt=await Mt.importQueries(Ut,Jt));return Se(Mt,Gt)},Ee=(0,T.createAsyncThunk)("explore/changeQueries",async({queries:Mt,exploreId:Jt},{getState:Ut,dispatch:Gt})=>{let Lt=!1;const At=Ut().explore.panes[Jt].queries,Nt=Ut().explore.panes[Jt].datasourceInstance?.uid,Dn=Ut().explore.correlationEditorDetails,An=Dn?.editorMode||!1;!(Object.keys(Ut().explore.panes)[0]===Jt)&&An&&!Dn?.queryEditorDirty&&Gt((0,oe.am)({queryEditorDirty:!0}));for(const Xn of Mt)for(const Tn of At){if(Xn.refId===Tn.refId&&Xn.datasource?.type!==Tn.datasource?.type){const ht=await(0,h.l)().get(Tn.datasource),St=await(0,h.l)().get({uid:Xn.datasource?.uid});await Gt(Pe(Jt,At,ht,St,Xn.refId)),Lt=!0}if(Nt===R.uv&&Xn.refId===Tn.refId&&Xn.datasource?.uid!==Tn.datasource?.uid){const ht=(0,ee.dq)(R.uv,Mt),St=await(0,P.J6)(ht);Gt((0,Q.Fb)({exploreId:Jt,correlations:St.correlations||[]}))}}Lt||Gt(re({queries:Mt,exploreId:Jt})),Mt.length<At.length&&Gt(De({exploreId:Jt}))}),Pe=(Mt,Jt,Ut,Gt,Lt)=>async At=>{if(!Ut){At(Te({exploreId:Mt,queries:Jt}));return}let Nt=Jt;if(Gt.uid===R.uv)Nt=Jt.map(An=>({...An,datasource:Ut.getRef()}));else if(Ut.uid===R.uv){const An=(0,r.groupBy)(Jt,Xn=>Xn.datasource?.uid),Pn=await Promise.all(Object.keys(An).map(async Xn=>{const Tn=await(0,h.l)().get({uid:Xn});return await fe(Gt,Tn,An[Xn])}));Nt=(0,r.flatten)(Pn.filter(Xn=>Xn.length>0))}else{let An=Jt;if(Lt!==void 0){const Pn=Jt.find(Xn=>Xn.refId===Lt);Pn&&(An=[Pn])}Nt=await fe(Gt,Ut,An)}let Dn=await(0,b.di)(Nt,Gt.getRef());if(Lt!==void 0){Nt.length===0&&(Nt=[await(0,b.Ll)([],void 0,Gt.getRef())]);const An=Jt.findIndex(Xn=>Xn.refId===Lt),Pn={...Dn[0],refId:Jt[An].refId};Dn=[...Jt],Dn[An]=Pn}return At(Te({exploreId:Mt,queries:Dn})),Dn};function he(Mt,Jt,Ut){return async(Gt,Lt)=>{const At=Lt().explore.panes[Mt],{queries:Nt}=At,An=(await Promise.all(Nt.map(Pn=>Ut({...Pn},Jt)))).map((Pn,Xn)=>(0,b.eF)(Pn,Nt,Xn));Gt(je({exploreId:Mt,queries:An})),Jt.preventSubmit||Gt(De({exploreId:Mt}))}}function be(Mt,Jt){if(!(Mt.filterQuery&&!Mt.filterQuery(Jt)))return Jt}async function Ae(Mt,Jt,Ut,Gt){const At=(await Promise.all(Gt.map(async Nt=>{if(Nt.datasource?.uid===Ut.uid)return be(Ut,Nt);{const Dn=await(0,C.tR)().get(Nt.datasource);return be(Dn,Nt)}}))).filter(Nt=>!!Nt);At.length>0&&(Mt((0,ae.ri)(!0,Ut.uid,Ut.name,At,y.$.queryHistoryEnabled)),y.$.queryHistoryEnabled&&Mt((0,ae.ri)(!1,Ut.uid,Ut.name,At,!1)),await Mt((0,ae.jX)()))}const De=(0,T.createAsyncThunk)("explore/runQueries",async({exploreId:Mt,preserveCache:Jt},{dispatch:Ut,getState:Gt})=>{Ut(pe(Mt));const{defaultCorrelationEditorDatasource:Lt,scopedVars:At,showCorrelationEditorLinks:Nt}=await(0,ee.aj)(Gt(),Mt),Dn=(0,_.M)(Mt);Ut((0,J.JA)({exploreId:Mt})),Jt!==!0&&Ut($t(Mt));const Pn=Gt().explore.panes[Mt],{datasourceInstance:Xn,containerWidth:Tn,isLive:ht,range:St,scanning:Ge,queryResponse:Ve,querySubscription:lt,refreshInterval:It,absoluteRange:Qe,cache:vt,supplementaryQueries:Ot}=Pn;let zt,vn;const ln=Pn.queries.map(wn=>({...wn,datasource:wn.datasource||Xn?.getRef()}));Xn!=null&&Ae(Ut,Gt().explore,Xn,ln);const On=(0,ee.rk)(vt,Qe);if(On)zt=(0,i.z)([(0,g.of)(On),Dn]).pipe((0,d.Z)(([wn,Un])=>H(wn,Ve,te({absoluteRange:Qe,refreshInterval:It,queries:ln}),ln,Un,Nt,Lt))),vn=zt.subscribe(wn=>{Ut(Ce({exploreId:Mt,response:wn}))});else{if(!(0,b.zT)(ln)||!Xn)return;const wn=Xn?.interval;(0,b._u)(lt);const Un={minInterval:wn,maxDataPoints:Tn,liveStreaming:ht},cs=(0,M.O)(Gt().user),Zn=(0,b.bI)(Mt,ln,Un,St,Ge,cs,At);if(Ut(Ke({exploreId:Mt,loadingState:a.Gu.Loading})),zt=(0,i.z)([(0,O.BN)(Xn,Zn.request).pipe(ht?(0,c.c)(500):o.D),Dn]).pipe((0,d.Z)(([wt,Ft])=>H(wt,Ve,te({absoluteRange:Qe,refreshInterval:It,queries:ln}),ln,Ft,Nt,Lt))),vn=zt.subscribe({next(wt){const Ft=Gt().explore.panes[Mt];if(Ut(Ce({exploreId:Mt,response:wt})),Ft.scanning)if(wt.state===a.Gu.Done&&wt.series.length===0){const Ht=(0,D.Wb)(-1,Ft.range);Ut((0,J.JA)({exploreId:Mt,absoluteRange:Ht})),Ut(De({exploreId:Mt}))}else Ut(Ct({exploreId:Mt}))},error(wt){Ut((0,S.dx)((0,L.gi)("Query processing error",wt))),Ut(Ke({exploreId:Mt,loadingState:a.Gu.Error})),console.error(wt)},complete(){Gt().explore.panes[Mt].queryResponse.state===a.Gu.Loading&&Ut(Ke({exploreId:Mt,loadingState:a.Gu.Done}))}}),ht)for(const wt of le.VW)Ut(Xe({exploreId:Mt,type:wt})),Ut(we({exploreId:Mt,type:wt}));else Ut(dt({exploreId:Mt,datasourceInstance:Xn,transaction:Zn,newQuerySource:zt,supplementaryQueries:Ot,queries:ln,absoluteRange:Qe}))}Ut(ge({exploreId:Mt,querySubscription:vn}))}),Ie=(0,T.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:Mt,absoluteRange:Jt},{dispatch:Ut,getState:Gt})=>{Ut(pe(Mt));const{datasourceInstance:Lt,containerWidth:At,queryResponse:Nt}=Gt().explore.panes[Mt],{defaultCorrelationEditorDatasource:Dn,scopedVars:An,showCorrelationEditorLinks:Pn}=await(0,ee.aj)(Gt(),Mt),Xn=(0,_.M)(Mt);let Tn;const ht=Nt.logsResult?.queries||[],St=Nt.logsFrames.map(vt=>vt.refId),Ge=ht.filter(vt=>St.includes(vt.refId)).map(vt=>({...vt,datasource:vt.datasource||Lt?.getRef(),refId:vt.refId,supportingQueryType:I.Q$.InfiniteScroll}));if(!(0,b.zT)(Ge)||!Lt)return;const Ve={minInterval:Lt?.interval,maxDataPoints:At},lt=(0,M.O)(Gt().user),It=(0,b.zq)(lt,{from:(0,u.oZ)(lt,Jt.from),to:(0,u.oZ)(lt,Jt.to)},(0,M.q)(Gt().user)),Qe=(0,b.bI)(Mt,Ge,Ve,It,!1,lt,An);Ut(Ke({exploreId:Mt,loadingState:a.Gu.Loading})),Tn=(0,i.z)([(0,O.BN)(Lt,Qe.request),Xn]).pipe((0,d.Z)(([vt,Ot])=>vt.state!==a.Gu.Done?(0,g.of)({...Nt,state:a.Gu.Loading}):H((0,E._k)(Nt,vt),Nt,te({absoluteRange:Jt,queries:ht,deduplicate:!0}),Ge,Ot,Pn,Dn))),Tn.subscribe({next(vt){Ut(Ce({exploreId:Mt,response:vt}))},error(vt){Ut((0,S.dx)((0,L.gi)("Query processing error",vt))),Ut(Ke({exploreId:Mt,loadingState:a.Gu.Error})),console.error(vt)},complete(){Ut(Ke({exploreId:Mt,loadingState:a.Gu.Done}))}})}),ke=async(Mt,Jt)=>{const Ut=Mt.filter(Lt=>Lt.datasource?.uid!==R.uv),Gt=(0,r.groupBy)(Ut,"datasource.uid");return await Promise.all(Object.values(Gt).map(async Lt=>({datasource:await(0,h.l)().get(Lt[0].datasource,Jt),targets:Lt})))},dt=(0,T.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:Mt,exploreId:Jt,transaction:Ut,newQuerySource:Gt,supplementaryQueries:Lt,queries:At,absoluteRange:Nt},{dispatch:Dn})=>{let An;Mt.meta.mixed?An=await ke(Ut.request.targets,Ut.request.scopedVars):An=[{datasource:Mt,targets:Ut.request.targets}];for(const Pn of le.VW){const Xn=(0,le.Pm)(An,Pn,{...Ut.request,requestId:`${Ut.request.requestId}_${(0,r.snakeCase)(Pn)}`},Gt);Xn?(Dn(Ue({exploreId:Jt,type:Pn,dataProvider:Xn})),Pt(Lt[Pn].data,At,Nt)||(Dn(we({exploreId:Jt,type:Pn})),Lt[Pn].enabled&&Dn(sn(Jt,Pn)))):Dn(Xe({exploreId:Jt,type:Pn}))}});function Pt(Mt,Jt,Ut){if(!Mt)return!1;const Gt=(0,r.zipObject)((0,r.map)(Jt,"refId"),Jt),Lt=(0,r.mapValues)((0,r.groupBy)(Mt.data.map(An=>An.meta?.custom?.sourceQuery),"refId"),r.head),At=Mt.data.every(An=>An.meta?.custom?.logsVolumeType===m.Aj.FullRange),Nt=l()(Gt,Lt),Dn=Mt.data.every(An=>{const Pn=An.meta?.custom?.absoluteRange;return Pn?Pn&&Pn.from<=Ut.from&&Ut.to<=Pn.to:!0});return At&&Nt&&Dn}function pt(Mt,Jt){return(Ut,Gt)=>{const Lt=Gt().explore.panes[Mt].queries,At=Jt.map((Nt,Dn)=>(0,b.eF)(Nt,Lt,Dn));Ut(je({exploreId:Mt,queries:At})),Ut(De({exploreId:Mt}))}}function Tt(Mt){return(Jt,Ut)=>{Jt(at({exploreId:Mt}));const Gt=(0,D.Wb)(-1,Ut().explore.panes[Mt].range);Jt((0,J.JA)({exploreId:Mt,absoluteRange:Gt})),Jt(De({exploreId:Mt}))}}function jt(Mt){return(Jt,Ut)=>{const Gt=Ut().explore.panes[Mt].queryResponse,Lt=Ut().explore.panes[Mt].absoluteRange,At=(0,ee.O2)(Lt);Gt.state===a.Gu.Done&&Jt(Dt({exploreId:Mt,cacheKey:At,queryResponse:Gt}))}}function $t(Mt){return(Jt,Ut)=>{Jt(tt({exploreId:Mt}))}}function sn(Mt,Jt){return(Ut,Gt)=>{const{supplementaryQueries:Lt}=Gt().explore.panes[Mt],At=Lt[Jt].dataProvider;if(At){const Nt=At.subscribe({next:Dn=>{Ut(We({exploreId:Mt,type:Jt,data:Dn}))}});Ut(qe({exploreId:Mt,type:Jt,dataSubscription:Nt}))}}}function Yt(Mt,Jt,Ut){return(Gt,Lt)=>{Gt(Oe({exploreId:Mt,enabled:Jt,type:Ut})),(0,le.Oi)(Jt,Ut),Jt&&Gt(sn(Mt,Ut))}}const qt=(Mt,Jt)=>{if(xe.match(Jt)){const{queries:Ut}=Mt,{index:Gt,query:Lt}=Jt.payload,At=[...Ut.slice(0,Gt+1),{...Lt},...Ut.slice(Gt+1)];return{...Mt,queries:At,queryKeys:(0,b.dY)(At)}}if(re.match(Jt)){const{queries:Ut}=Jt.payload;return{...Mt,queries:Ut}}if(ue.match(Jt))return(0,b._u)(Mt.querySubscription),{...Mt,...Mt.queryResponse?{queryResponse:{...Mt.queryResponse,state:a.Gu.Done}}:{}};if(je.match(Jt)){const{queries:Ut}=Jt.payload;return{...Mt,queries:Ut.slice(),queryKeys:(0,b.dY)(Ut)}}if(ge.match(Jt)){const{querySubscription:Ut}=Jt.payload;return{...Mt,querySubscription:Ut}}if(Oe.match(Jt)){const{enabled:Ut,type:Gt}=Jt.payload,{supplementaryQueries:Lt}=Mt,At=Lt[Gt].dataSubscription;!Ut&&At&&At.unsubscribe();const Nt={...Lt,[Gt]:{...Lt[Gt],enabled:Ut,data:void 0}};return{...Mt,supplementaryQueries:Nt}}if(Ue.match(Jt)){const{dataProvider:Ut,type:Gt}=Jt.payload,{supplementaryQueries:Lt}=Mt,At=Lt[Gt];At?.dataSubscription&&At.dataSubscription.unsubscribe();const Nt={...Lt,[Gt]:{...At,dataProvider:Ut,dataSubscription:void 0}};return{...Mt,supplementaryQueries:Nt}}if(Xe.match(Jt)){const{type:Ut}=Jt.payload,{supplementaryQueries:Gt}=Mt,Lt=Gt[Ut];Lt?.dataSubscription&&Lt.dataSubscription.unsubscribe();const At={...Gt,[Ut]:{...Lt,dataProvider:void 0,dataSubscription:void 0}};return{...Mt,supplementaryQueries:At}}if(we.match(Jt)){const{type:Ut}=Jt.payload,{supplementaryQueries:Gt}=Mt,Lt={...Gt,[Ut]:{...Gt[Ut],data:void 0}};return{...Mt,supplementaryQueries:Lt}}if(qe.match(Jt)){const{dataSubscription:Ut,type:Gt}=Jt.payload,{supplementaryQueries:Lt}=Mt,At={...Lt,[Gt]:{...Lt[Gt],dataSubscription:Ut}};return{...Mt,supplementaryQueries:At}}if(We.match(Jt)){let{data:Ut,type:Gt}=Jt.payload;const{supplementaryQueries:Lt}=Mt,At={...Lt,[Gt]:{...Lt[Gt],data:Ut}};return{...Mt,supplementaryQueries:At}}if(Ce.match(Jt))return bn(Mt,Jt);if(Te.match(Jt)){const{queries:Ut}=Jt.payload;return{...Mt,queries:Ut,queryKeys:(0,b.dY)(Ut)}}if(Ke.match(Jt)){const{loadingState:Ut}=Jt.payload;return{...Mt,queryResponse:{...Mt.queryResponse,state:Ut}}}if(_e.match(Jt)){const{isPaused:Ut}=Jt.payload;return{...Mt,isPaused:Ut}}if(at.match(Jt))return{...Mt,scanning:!0};if(Ct.match(Jt))return{...Mt,scanning:!1,scanRange:void 0};if(Dt.match(Jt)){const{cache:Gt}=Mt,{queryResponse:Lt,cacheKey:At}=Jt.payload;let Nt=[...Gt];return Nt.some(An=>An.key===At)||(Nt=[{key:At,value:Lt},...Nt].slice(0,5)),{...Mt,cache:Nt}}if(tt.match(Jt))return{...Mt,cache:[]};if(Fe.match(Jt)){if(!Mt.logsResult)return{...Mt,clearedAtIndex:null};if(Mt.queryResponse.state===a.Gu.Loading)return{...Mt,clearedAtIndex:null,logsResult:{...Mt.logsResult,rows:[]}};const Ut=Mt.clearedAtIndex?Mt.clearedAtIndex+Mt.logsResult.rows.length:Mt.logsResult.rows.length-1;return{...Mt,clearedAtIndex:Ut,logsResult:{...Mt.logsResult,rows:[]}}}return Mt},bn=(Mt,Jt)=>{const{response:Ut}=Jt.payload,{request:Gt,series:Lt,error:At,graphResult:Nt,logsResult:Dn,tableResult:An,rawPrometheusResult:Pn,traceFrames:Xn,nodeGraphFrames:Tn,flameGraphFrames:ht,rawPrometheusFrames:St,customFrames:Ge}=Ut;if(At){if(At.type===v.v2.Timeout||At.type===v.v2.Cancelled)return{...Mt};y.$.angularSupportEnabled&&Mt.datasourceInstance?.components?.QueryCtrl&&Mt.eventBridge.emit(x.ee.dataError,At)}if(!Gt)return{...Mt};if(y.$.angularSupportEnabled&&Mt.datasourceInstance?.components?.QueryCtrl){const Ve=Lt.map(lt=>(0,f.w3)(lt));Mt.eventBridge.emit(x.ee.dataReceived,Ve)}return{...Mt,queryResponse:Ut,graphResult:Nt,tableResult:An,rawPrometheusResult:Pn,logsResult:Mt.isLive&&Dn?{...Dn,rows:(0,ee.pg)(Mt.clearedAtIndex,Dn.rows)}:Dn,showLogs:!!Dn,showMetrics:!!Nt,showTable:!!An?.length,showTrace:!!Xn.length,showNodeGraph:!!Tn.length,showRawPrometheus:!!St.length,showFlameGraph:!!ht.length,showCustom:!!Ge?.length,clearedAtIndex:Mt.isLive?Mt.clearedAtIndex:null}}},9955:(k,A,e)=>{"use strict";e.d(A,{Jr:()=>a,K6:()=>o,Kl:()=>m,Qb:()=>r,i6:()=>g,pF:()=>d,qq:()=>p,st:()=>c,vC:()=>u});var n=e(25508),s=e(2543),l=e.n(s);const r=v=>v.explore.panes,i=v=>v.explore,g=v=>v.explore.richHistorySettings,o=(0,n.Mz)(r,Object.entries),d=(0,n.Mz)(o,v=>v.length>1),c=(0,n.Mz)(o,v=>v.some(x=>x[1].correlationEditorHelperData!==void 0)),a=v=>(0,n.Mz)(r,x=>Object.keys(x)[0]===v),p=v=>(0,n.Mz)(r,x=>x[v]),u=(0,n.Mz)(i,v=>v.correlationEditorDetails),m=(0,n.Mz)(o,v=>{const x=v.map(([h,y])=>{const b=[y?.datasourceInstance?.getRef()],D=y?.queries.map(C=>C.datasource)||[],P=[...b,...D].filter(C=>!!C);if(!(P===void 0||P.length===0))return{exploreId:h,datasources:(0,s.uniqBy)(P,C=>C.uid)}}).filter(h=>!!h),E=(0,s.uniqBy)((0,s.flatten)(x.map(h=>h.datasources)),h=>h.uid).map(h=>{let y=[];return x.forEach(b=>{b.datasources.some(D=>D.uid===h.uid)&&y.push(b.exploreId)}),{datasource:h,exploreIds:y}});return{exploreToDS:x,dsToExplore:E}})},89224:(k,A,e)=>{"use strict";e.d(A,{$_:()=>C,GA:()=>T,GH:()=>h,Iy:()=>M,JA:()=>b,QP:()=>S,Xk:()=>R,eM:()=>f,hO:()=>E,iO:()=>D,ke:()=>I,zY:()=>y});var n=e(65307),s=e(47232),l=e(26272),r=e(39070),i=e(72574),g=e(11134),o=e(76412),d=e(28138),c=e(87490),a=e(80582),p=e(74856),u=e(91002),m=e(32901),v=e(29436),x=e(23994);const f=(0,n.VP)("explore/changeRange"),E=(0,n.VP)("explore/changeRefreshInterval"),h=L=>(O,j)=>{const{syncedTimes:N}=j().explore;N?Object.keys(j().explore.panes).forEach(F=>{O(b({...L,exploreId:F})),O((0,x.Od)({exploreId:F,preserveCache:!0}))}):(O(b({...L})),O((0,x.Od)({exploreId:L.exploreId,preserveCache:!0})))},y=L=>O=>{O((0,x.S6)({...L}))},b=L=>(O,j)=>{const{exploreId:N,absoluteRange:F,rawRange:U}=L,w=j().explore.panes[N],B=(0,m.O)(j().user),K=(0,m.q)(j().user),{range:W}=w;let z=W.raw;F&&(z={from:(0,s.oZ)(B,F.from),to:(0,s.oZ)(B,F.to)}),U&&(z=U);const Y=(0,c.zq)(B,z,K),X={from:Y.from.valueOf(),to:Y.to.valueOf()};(0,p.jG)().init({timepicker:{},getTimezone:()=>B,timeRangeUpdated(q){},time:Y.raw}),(0,i.w)().updateTimeRange(Y),O(f({exploreId:N,range:Y,absoluteRange:X}))};function D(L){return(O,j)=>{const N=j().explore.panes[L].range.raw;Object.keys(j().explore.panes).filter(U=>U!==L).forEach(U=>{O(h({exploreId:U,rawRange:N}))});const F=j().explore.syncedTimes;O((0,v.qz)({syncedTimes:!F}))}}function P(L){return(O,j)=>{const N=(0,m.O)(j().user),F=(0,m.q)(j().user);Object.entries(j().explore.panes).forEach(([U,w])=>{const B=(0,c.zq)(N,w.range.raw,F);L(U,w,B,O)})}}function C(){return P((L,O,j,N)=>{const F={from:j.from.valueOf(),to:j.to.valueOf()};N(h({exploreId:L,absoluteRange:F}))})}function M(L){return P((O,j,N,F)=>{const U=(0,a.Wb)(L,N);F(h({exploreId:O,absoluteRange:U}))})}function I(L){return P((O,j,N,F)=>{const U=(0,a.Zk)(N,L);F(h({exploreId:O,absoluteRange:U}))})}function R(){return(L,O)=>{const j=O().explore.panes[Object.keys(O().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(j)),d.A.emit(l.r1.alertSuccess,[(0,o.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function T(){return async(L,O)=>{const{range:j,isError:N}=await(0,a.zG)();if(N===!0){d.A.emit(l.r1.alertError,[(0,o.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,o.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:j})]);return}if(O().explore.syncedTimes){L(h({exploreId:Object.keys(O().explore.panes)[0],rawRange:j})),L(h({exploreId:Object.keys(O().explore.panes)[1],rawRange:j}));return}L(h({exploreId:Object.keys(O().explore.panes)[0],rawRange:j}))}}const S=(L,O)=>{if(E.match(O)){const{refreshInterval:j}=O.payload,N=g.cC.isLive(j),F=(0,c.uE)(j),U=(0,u.zy)(L.logsResult,F);return g.cC.isLive(L.refreshInterval)&&!N&&(0,c._u)(L.querySubscription),{...L,refreshInterval:j,queryResponse:{...L.queryResponse,state:N?r.Gu.Streaming:r.Gu.Done},isLive:N,isPaused:N?!1:L.isPaused,logsResult:U}}if(f.match(O)){const{range:j,absoluteRange:N}=O.payload;return{...L,range:j,absoluteRange:N}}return L}},34028:(k,A,e)=>{"use strict";e.d(A,{BE:()=>P,HZ:()=>b,O2:()=>C,RA:()=>D,Z9:()=>R,aj:()=>O,dq:()=>L,eO:()=>I,kn:()=>E,ng:()=>y,pg:()=>S,rk:()=>M});var n=e(2543),s=e.n(n),l=e(39070),r=e(43127),i=e(85858),g=e(47232),o=e(32264),d=e(19347),c=e(11401),a=e(81523),p=e(14678),u=e(33390),m=e(87490),v=e(31193),x=e(57288);const f=100,E={from:`now-${o.$.exploreDefaultTimeOffset}`,to:"now"},h="grafana.explore.style.graph",y=j=>{u.A.set(h,j)},b=j=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:E},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:D(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,x.Ez)(),panelsState:{},correlations:void 0,...j}),D=()=>({state:l.Gu.NotStarted,series:[],timeRange:(0,r.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function P(j,N){let F;try{F=await(0,v.tR)().get(N)}catch{F=await(0,v.tR)().get()}if(F.init)try{F.init()}catch(K){console.error(K)}let U=[];const w=(0,c.tU)(),B=await w.getRichHistory({search:"",sortOrder:a.xB.Ascending,datasourceFilters:[F.name],starred:!1});if((B.total||0)>0&&B.richHistory.forEach(K=>{K.queries.forEach(W=>{U.push({ts:parseInt(K.id,10),query:W})})}),U.length<f){const K=await w.getRichHistory({search:"",sortOrder:a.xB.Ascending,datasourceFilters:[p.uv],starred:!1});(K.total||0)>0&&K.richHistory.forEach(W=>{W.queries.forEach(z=>{z?.datasource?.uid===F.uid&&U.push({ts:parseInt(W.id,10),query:z})})})}if(U.length<f){const K=`grafana.explore.history.${F.meta?.id}`;U=[...U,...u.A.getObject(K,[])]}return U.length>f&&(U.length=f),(0,m.dr)(j,F.uid),{history:U,instance:F}}function C(j){const N={from:j.from,to:j.to};return Object.entries(N).map(([U,w])=>`${encodeURIComponent(U)}=${encodeURIComponent(w.toString())}`).join("&")}function M(j,N){const F=C(N),U=j.findIndex(B=>B.key===F);return U>=0?j[U].value:void 0}function I(j,N){return{from:i.parse(j.from,!1,N),to:i.parse(j.to,!0,N),raw:j}}function R(j){let N=E,F={from:T(j.from),to:T(j.to)};return F.from!==null&&F.to!==null&&(N={from:F.from,to:F.to}),N}function T(j){if(j===null)return null;if((0,g.Ar)(j))return j;if(typeof j!="string")return null;const N=j;if(N.indexOf("now")!==-1)return N;if(N.length===8)return(0,g.yT)(N,"YYYYMMDD");if(N.length===15)return(0,g.yT)(N,"YYYYMMDDTHHmmss");if(N.length===19)return(0,g.yT)(N,"YYYY-MM-DD HH:mm:ss");if(N.match(/^\d+$/)){const U=parseInt(N,10);return(0,g.yT)(U)}const F=(0,g.yT)(N);return F.isValid()?F:null}const S=(j,N)=>N?j?N.slice(j+1):N:[],L=(j,N)=>j===p.uv?(0,n.uniq)(N.map(F=>F.datasource?.uid).filter(F=>!!F)):[j];async function O(j,N){const F=j.explore.panes[N].correlationEditorHelperData,U=j.explore.correlationEditorDetails?.editorMode||!1,w=Object.keys(j.explore.panes)[0]===N,B=U&&w,K=B?await(0,d.l)().get():void 0,W=U&&!w&&F!==void 0;let z={};return W&&F!==void 0&&Object.entries(F?.vars).forEach(Y=>{z[Y[0]]={value:Y[1]}}),{defaultCorrelationEditorDatasource:K,scopedVars:z,showCorrelationEditorLinks:B}}},96192:(k,A,e)=>{"use strict";e.d(A,{JQ:()=>D,O1:()=>C,QL:()=>y,YV:()=>h,_O:()=>R});var n=e(2543),s=e.n(n),l=e(96540),r=e(92461),i=e(91890),g=e(41987),o=e(6709),d=e(76885),c=e(72574),a=e(14110),p=e(16233),u=e(67023),m=e(6923),v=e(39590);const f=[T=>!T.internal||p.TP.hasAccessToExplore()],E="grafana_data_link_clicked",h=(T,S)=>O=>{const{field:j,dataLinkScopedVars:N,frame:F,link:U,linkModel:w}=O,{valueRowIndex:B}=O.config;if(!U.internal||B===void 0)return w;const K=y({field:j,rowIndex:B,splitOpenFn:T,range:S,vars:N,dataFrame:F,linksToProcess:[U]});return K.length?(0,n.first)(K):void 0},y=T=>{const{field:S,vars:L,splitOpenFn:O,range:j,rowIndex:N,dataFrame:F}=T,U={...L||{}};U.__value={value:{raw:S.values[N]},text:"Raw value"};let w;F&&(w=(0,r.F)({frame:F,rowIndex:N}),U.__data={value:{name:F.name,refId:F.refId,fields:w},text:"Data"},F.fields.forEach(K=>{w&&w[K.name]&&(U[K.name]={value:w[K.name]})}),U.__targetField={value:w[S.name]});const B=T.linksToProcess||S.config.links;return B?B.filter(z=>f.every(Y=>Y(z,U))).map(z=>{if(z.internal){let Y={};z.internal?.transformations&&z.internal?.transformations.forEach(H=>{let se;H.field?se=F?.fields.find(le=>le.name===H.field)?.values[N]:se=S.values[N],Y={...Y,...(0,u.k)(H,se,S.name)}});const X={...U,...Y},q=C(z,X);let G=[];if(q.variables.length===0){const H=S.name.toString();G.push({variableName:H,value:"",match:""})}else G=q.variables;const te=H=>{(0,a.rR)(E,{origin:z.origin||i.x0.Datasource,app:g.Jk.Explore,internal:!0}),O?.(H)};return q.allVariablesDefined?{...(0,o.u)({link:z,internalLink:z.internal,scopedVars:X,range:j,field:S,onClickFn:T.splitOpenFn?se=>te(se):void 0,replaceVariables:(0,c.w)().replace.bind((0,c.w)())}),variables:G}:void 0}else{const Y=(q,G)=>(0,c.w)().replace(q,{...G,...U}),X=(0,m.mQ)().getDataLinkUIModel(z,Y,S);return X.title||(X.title=b(X.href)),X}}).filter(z=>!!z):[]};function b(T){T.indexOf("://")<0&&(T=`http://${T}`);let S;try{S=new URL(T).hostname}catch{S=T}return S}function D(T,S){return(0,l.useCallback)((L,O)=>L.fields.flatMap(j=>j.config?.links&&j.config?.links.length?y({field:j,rowIndex:O,range:T,dataFrame:L,splitOpenFn:S}):[]),[T,S])}const P=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function C(T,S){let L=[];return(0,c.w)().replace.bind((0,c.w)())(M(T),S,void 0,L),L=(0,n.uniqBy)(L,"variableName"),{variables:L,allVariablesDefined:L.filter(j=>!P.includes(j.variableName)).every(j=>j.found)}}function M(T){let S="",L;for(L in T)typeof T[L]=="string"?S+=" "+T[L]:typeof T[L]=="object"&&(S+=" "+M(T[L]));return S}const I=T=>T[1]!==void 0,R=T=>{const S=Object.entries(T).filter(I).map(([L,O])=>{const j=(0,v.m)(O);return j.range={to:O.range.to.valueOf().toString(),from:O.range.from.valueOf().toString()},[L,j]}).reduce((L,[O,j])=>({...L,[O]:j}),{});return d.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(S)})}},27649:(k,A,e)=>{"use strict";e.d(A,{v:()=>s});var n=e(77789);function s(l){const r=new Set(l.map(i=>i.refId).filter(Boolean));return r.size===l.length?l:(r.clear(),l.map(i=>{if(i.refId&&!r.has(i.refId))return r.add(i.refId),i;const g=(0,n.M)(l);return r.add(g),{...i,refId:g}}))}},57288:(k,A,e)=>{"use strict";e.d(A,{Ez:()=>v,Oi:()=>m,Pm:()=>E,VW:()=>p});var n=e(2543),s=e.n(n),l=e(88483),r=e(44240),i=e(6276),g=e(29405),o=e(9557),d=e(39070),c=e(33390),a=e(69147);const p=[o.cF.LogsVolume,o.cF.LogsSample],u=h=>`grafana.explore.logs.enable${h}`,m=(h,y)=>{c.A.set(u(y),h?"true":"false")},v=()=>{let h={[o.cF.LogsVolume]:{enabled:!0},[o.cF.LogsSample]:{enabled:!1}};for(const y of p){if(y===o.cF.LogsSample)continue;c.A.get(u(y))==="false"&&(h[y]={enabled:!1})}return h},x=(h,y,b)=>new l.c(D=>h.subscribe(P=>{if(P.logsResult&&P.logsResult.rows&&P.logsResult.visibleRange&&P.logsResult.bucketSize!==void 0&&P.state===d.Gu.Done){const C=P.logsResult.bucketSize,M=y.map(T=>T.refId),I=(0,n.groupBy)(P.logsResult.rows,"dataFrame.refId");let R=[];M.forEach(T=>{if(I[T]?.length){const S=(0,a.J9)(I[T],C);R=[...R,...S];const L={logsVolumeType:o.Aj.Limited,absoluteRange:P.logsResult?.visibleRange,datasourceName:b,sourceQuery:y.find(O=>O.refId===T)};D.next({data:R.map(O=>{const j=O.meta?.custom||{};return{...O,meta:{custom:{...j,...L}}}}),state:P.state})}}),D.complete()}})),f=(h,y,b,D)=>{if(h===o.cF.LogsVolume)return x(y,b,D)},E=(h,y,b,D)=>{const C=h.map(({datasource:M,targets:I},R)=>{const T=(0,n.cloneDeep)(b);if(T.requestId=`${T.requestId||""}_${R}`,T.targets=I,(0,o.Nc)(M,y)){if(M.getDataProvider)return M.getDataProvider(y,T);if(M.getSupplementaryRequest){const S=M.getSupplementaryRequest(y,T);return S?y===o.cF.LogsVolume?(0,a.sg)(M,S,{targets:T.targets}):(0,a.Wr)(M,S):void 0}else return}else return f(y,D,I,M.name)}).filter(d.zz);if(C.length!==0)return C.length===1?C[0]:(0,r.h)(...C).pipe((0,g.S)((M,I)=>M.errors&&M.errors.length||I.state===d.Gu.NotStarted?M:I.state===d.Gu.Loading&&M.state===d.Gu.NotStarted?{...M,state:d.Gu.Loading}:I.state&&I.state!==d.Gu.Done?M:{...M,data:[...M.data,...I.data],state:d.Gu.Done},{data:[],state:d.Gu.NotStarted}),(0,i.d)())}},53478:(k,A,e)=>{"use strict";e.d(A,{Ex:()=>M,$i:()=>C});var n=e(65474),s=e(69862),l=e(43429),r=e(26657),i=e(72574),g=e(19347),o=e(74848),d=e(96540),c=e(14186),a=e(90182),p=e(98808),u=e(71680),m=e(1712),v=e(34263),x=e(18225),f=e(76658),E=e(66718),h=e(76942);const y=15;function b(){const I=(0,d.useRef)({}),R=(0,d.useCallback)(S=>{switch(S){case E.Tz.math:case E.Tz.reduce:case E.Tz.resample:case E.Tz.threshold:case E.Tz.sql:return I.current[S];case E.Tz.classic:return}},[]),T=(0,d.useCallback)((S,L)=>{switch(S){case E.Tz.math:I.current.math=L;break;case E.Tz.reduce:case E.Tz.resample:case E.Tz.resample:I.current.reduce=L,I.current.resample=L,I.current.threshold=L;break;case E.Tz.sql:I.current.sql=L}},[]);return{getCachedExpression:R,setCachedExpression:T}}function D(I){const{query:R,queries:T,onRunQuery:S,onChange:L}=I,{getCachedExpression:O,setCachedExpression:j}=b();(0,d.useEffect)(()=>{j(R.type,R.expression)},[R.expression,R.type,j]);const N=(0,d.useCallback)(w=>{const B=O(w.value),K=(0,h.r)({...R,type:w.value});L({...K,expression:B??K.expression})},[R,L,O]),F=()=>{const w=T.filter(B=>R.refId!==B.refId).map(B=>({value:B.refId,label:B.refId}));switch(R.type){case E.Tz.math:return(0,o.jsx)(u.z,{onChange:L,query:R,labelWidth:y,onRunQuery:S});case E.Tz.reduce:return(0,o.jsx)(m.Z,{refIds:w,onChange:L,labelWidth:y,query:R});case E.Tz.resample:return(0,o.jsx)(v.C,{query:R,labelWidth:y,onChange:L,refIds:w});case E.Tz.classic:return(0,o.jsx)(p.z,{onChange:L,query:R,refIds:w});case E.Tz.threshold:return(0,o.jsx)(f.O,{onChange:L,query:R,labelWidth:y,refIds:w});case E.Tz.sql:return(0,o.jsx)(x.k,{onChange:L,query:R,refIds:w})}},U=E.uQ.find(w=>w.value===R.type);return(0,o.jsxs)("div",{children:[(0,o.jsx)(c.I,{label:"Operation",labelWidth:y,children:(0,o.jsx)(a.l6,{options:E.uQ,value:U,onChange:N,width:25})}),F()]})}class P extends r.iy{constructor(R){super(R),this.instanceSettings=R}applyTemplateVariables(R,T){const S=(0,i.w)();return{...R,expression:S.replace(R.expression,T),window:S.replace(R.window,T)}}getCollapsedText(R){return`Expression: ${R.type}`}query(R){let T=R.targets.map(async L=>{const O=await(0,g.l)().get(L.datasource);return O.interpolateVariablesInQueries?O?.interpolateVariablesInQueries([L],R.scopedVars,R.filters)[0]:L});return(0,n.H)(Promise.all(T)).pipe((0,s.Z)(L=>super.query({...R,targets:L})))}newQuery(R){return{refId:"--",datasource:r.dR,type:R?.type??E.Tz.math,...R}}}const C={id:-100,uid:E.Uj,name:r.dR.name,type:r.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:l.QE.datasource,name:r.dR.type,id:r.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},M=new P(C);M.meta={id:r.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},M.components={QueryEditor:D}},98808:(k,A,e)=>{"use strict";e.d(A,{z:()=>y});var n=e(74848),s=e(39268),l=e(14186),r=e(55852),i=e(14578),g=e(76942),o=e(32196),d=e(40845),c=e(67061),a=e(9261),p=e(90182),u=e(10354),m=e(55907);const v=m.A.reducerTypes.map(b=>({label:b.text,value:b.value})),x=m.A.evalOperators.map(b=>({label:b.text,value:b.value})),f=m.A.evalFunctions.map(b=>({label:b.text,value:b.value})),E=({condition:b,index:D,onChange:P,onRemoveCondition:C,refIds:M})=>{const I=(0,d.of)(h),R=F=>{P({...b,operator:{type:F.value}})},T=F=>{P({...b,reducer:{type:F.value,params:[]}})},S=F=>{P({...b,query:{params:[F.value]}})},L=F=>{P({...b,evaluator:{params:b.evaluator.params,type:F.value}})},O=(F,U)=>{const w=parseFloat(F.currentTarget.value),B=[...b.evaluator.params];B[U]=w,P({...b,evaluator:{...b.evaluator,params:B}})},j=(0,o.css)`
    width: 60px;
  `,N=b.evaluator.type===m.p.IsWithinRange||b.evaluator.type===m.p.IsOutsideRange;return(0,n.jsxs)(c.B,{children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsxs)(s.C,{children:[D===0?(0,n.jsx)("div",{className:(0,o.cx)(I.button,j),children:"WHEN"}):(0,n.jsx)(a.f,{className:(0,o.cx)(I.buttonSelectText,j),options:x,onChange:R,value:x.find(F=>F.value===b.operator.type)}),(0,n.jsx)(p.l6,{options:v,onChange:T,width:20,value:v.find(F=>F.value===b.reducer.type)}),(0,n.jsx)("div",{className:I.button,children:"OF"}),(0,n.jsx)(p.l6,{onChange:S,options:M,width:"auto",value:M.find(F=>F.value===b.query.params[0])})]}),(0,n.jsxs)(s.C,{children:[(0,n.jsx)(a.f,{className:I.buttonSelectText,options:f,onChange:L,value:f.find(F=>F.value===b.evaluator.type)}),N?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.p,{type:"number",width:10,onChange:F=>O(F,0),value:b.evaluator.params[0]}),(0,n.jsx)("div",{className:I.button,children:"TO"}),(0,n.jsx)(u.p,{type:"number",width:10,onChange:F=>O(F,1),value:b.evaluator.params[1]})]}):b.evaluator.type!==m.p.HasNoValue?(0,n.jsx)(u.p,{type:"number",width:10,onChange:F=>O(F,0),value:b.evaluator.params[0]}):null]})]}),(0,n.jsx)(r.$n,{variant:"secondary",type:"button",onClick:()=>C(D),children:(0,n.jsx)(i.I,{name:"trash-alt"})})]})},h=b=>{const D=(0,o.css)`
    color: ${b.colors.primary.text};
    font-size: ${b.typography.bodySmall.fontSize};
  `;return{buttonSelectText:D,button:(0,o.cx)((0,o.css)`
        display: flex;
        align-items: center;
        border-radius: ${b.shape.radius.default};
        font-weight: ${b.typography.fontWeightMedium};
        border: 1px solid ${b.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${b.spacing(1)};
        background-color: ${b.colors.background.canvas};
      `,D)}},y=({onChange:b,query:D,refIds:P})=>{const C=(R,T)=>{D.conditions&&b({...D,conditions:[...D.conditions.slice(0,T),R,...D.conditions.slice(T+1)]})},M=()=>{if(D.conditions){const R=D.conditions.at(-1)?.query?.params??[],T={...g.P,query:{params:R}};b({...D,conditions:D.conditions.length>0?[...D.conditions,T]:[T]})}},I=R=>{if(D.conditions){const T=D.conditions[R],S=D.conditions.filter(L=>L!==T).map((L,O)=>O===0?{...L,operator:{type:"when"}}:L);b({...D,conditions:S})}};return(0,n.jsxs)("div",{children:[(0,n.jsx)(s.C,{children:(0,n.jsx)(l.I,{label:"Conditions",labelWidth:14,children:(0,n.jsx)("div",{children:D.conditions?.map((R,T)=>{if(R)return(0,n.jsx)(E,{index:T,condition:R,onChange:S=>C(S,T),onRemoveCondition:I,refIds:P},T)})})})}),(0,n.jsx)(r.$n,{variant:"secondary",type:"button",onClick:M,children:(0,n.jsx)(i.I,{name:"plus-circle"})})]})}},71680:(k,A,e)=>{"use strict";e.d(A,{z:()=>p});var n=e(74848),s=e(32196),l=e(40845),r=e(67061),i=e(14186),g=e(76892),o=e(60782),d=e(14578),c=e(21744);const a="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",p=({labelWidth:x,onChange:f,query:E,onRunQuery:h})=>{const y=P=>{f({...E,expression:P.target.value})},b=(0,l.of)(m),D=()=>{E.expression&&h()};return(0,n.jsx)(r.B,{children:(0,n.jsx)(i.I,{label:(0,n.jsx)(g.c,{width:"auto",children:(0,n.jsx)(o.G,{fitContent:!0,content:(0,n.jsxs)("div",{className:b.documentationContainer,children:[(0,n.jsxs)("div",{children:["Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)("code",{children:"$A + $B"})]}),(0,n.jsx)("header",{className:b.documentationHeader,children:"Available Math functions"}),(0,n.jsxs)("div",{className:b.documentationFunctions,children:[(0,n.jsx)(u,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),(0,n.jsx)(u,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),(0,n.jsx)(u,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),(0,n.jsx)(u,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),(0,n.jsx)(u,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),(0,n.jsx)(u,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),(0,n.jsx)(u,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),(0,n.jsx)(u,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),(0,n.jsx)(u,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),(0,n.jsx)(u,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."})]})]}),title:(0,n.jsxs)(r.B,{gap:1,direction:"row",children:[(0,n.jsx)(d.I,{name:"book-open"})," Math operator"]}),footer:(0,n.jsxs)("div",{children:["See our additional documentation on"," ",(0,n.jsxs)("a",{className:b.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer",children:[(0,n.jsx)(d.I,{size:"xs",name:"external-link-alt"})," Math expressions"]}),"."]}),closeButton:!0,placement:"bottom-start",children:(0,n.jsxs)("div",{className:b.info,children:["Expression ",(0,n.jsx)(d.I,{name:"info-circle"})]})})}),labelWidth:x,grow:!0,shrink:!0,children:(0,n.jsx)(c.f,{value:E.expression,onChange:y,rows:1,placeholder:a,onBlur:D,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},u=({name:x,description:f})=>{const E=(0,l.of)(v);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:E.name,children:x}),(0,n.jsx)("span",{className:E.description,children:f})]})},m=x=>({documentationHeader:(0,s.css)`
    font-size: ${x.typography.h5.fontSize};
    font-weight: ${x.typography.h5.fontWeight};
  `,documentationLink:(0,s.css)`
    color: ${x.colors.text.link};
  `,documentationContainer:(0,s.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${x.spacing(2)};

    padding: ${x.spacing(1)} ${x.spacing(2)};
  `,documentationFunctions:(0,s.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${x.spacing(2)};
  `,info:(0,s.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${x.spacing(1)};
  `}),v=x=>({name:(0,s.css)`
    font-weight: ${x.typography.fontWeightBold};
  `,description:(0,s.css)`
    font-size: ${x.typography.bodySmall.fontSize};
    color: ${x.colors.text.disabled};
  `})},1712:(k,A,e)=>{"use strict";e.d(A,{Z:()=>o});var n=e(74848),s=e(14186),l=e(10354),r=e(39268),i=e(90182),g=e(66718);const o=({labelWidth:d="auto",onChange:c,refIds:a,query:p})=>{const u=g.Cu.find(b=>b.value===p.reducer),m=b=>{c({...p,expression:b.value})},v=b=>{c({...p,reducer:b.value})},x=b=>{c({...p,settings:b})},f=b=>{let D;switch(b.value){case g.Mt.ReplaceNonNumbers:let P=0;p.settings?.mode===g.Mt.ReplaceNonNumbers&&(P=p.settings?.replaceWithValue??0),D={mode:g.Mt.ReplaceNonNumbers,replaceWithValue:P};break;default:D={mode:b.value}}x(D)},E=b=>{const D=b.currentTarget.valueAsNumber;x({mode:g.Mt.ReplaceNonNumbers,replaceWithValue:D??0})},h=p.settings?.mode??g.Mt.Strict,y=()=>{if(h===g.Mt.ReplaceNonNumbers)return(0,n.jsx)(s.I,{label:"Replace With",labelWidth:d,children:(0,n.jsx)(l.p,{type:"number",width:10,onChange:E,value:p.settings?.replaceWithValue??0})})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.C,{children:(0,n.jsx)(s.I,{label:"Input",labelWidth:d,children:(0,n.jsx)(i.l6,{onChange:m,options:a,value:p.expression,width:"auto"})})}),(0,n.jsxs)(r.C,{children:[(0,n.jsx)(s.I,{label:"Function",labelWidth:d,children:(0,n.jsx)(i.l6,{options:g.Cu,value:u,onChange:v,width:20})}),(0,n.jsx)(s.I,{label:"Mode",labelWidth:d,children:(0,n.jsx)(i.l6,{onChange:f,options:g.HZ,value:h,width:25})}),y()]})]})}},34263:(k,A,e)=>{"use strict";e.d(A,{C:()=>o});var n=e(74848),s=e(39268),l=e(14186),r=e(90182),i=e(10354),g=e(66718);const o=({labelWidth:d="auto",onChange:c,refIds:a,query:p})=>{const u=g.PN.find(h=>h.value===p.downsampler),m=g.iX.find(h=>h.value===p.upsampler),v=h=>{c({...p,window:h.target.value})},x=h=>{c({...p,expression:h.value})},f=h=>{c({...p,downsampler:h.value})},E=h=>{c({...p,upsampler:h.value})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.C,{children:(0,n.jsx)(l.I,{label:"Input",labelWidth:d,children:(0,n.jsx)(r.l6,{onChange:x,options:a,value:p.expression,width:20})})}),(0,n.jsxs)(s.C,{children:[(0,n.jsx)(l.I,{label:"Resample to",labelWidth:d,tooltip:"10s, 1m, 30m, 1h",children:(0,n.jsx)(i.p,{onChange:v,value:p.window,width:15})}),(0,n.jsx)(l.I,{label:"Downsample",children:(0,n.jsx)(r.l6,{options:g.PN,value:u,onChange:f,width:25})}),(0,n.jsx)(l.I,{label:"Upsample",children:(0,n.jsx)(r.l6,{options:g.iX,value:m,onChange:E,width:25})})]})]})}},18225:(k,A,e)=>{"use strict";e.d(A,{k:()=>r});var n=e(74848),s=e(96540),l=e(6867);const r=({onChange:i,refIds:g,query:o})=>{const c=`select * from ${(0,s.useMemo)(()=>g.map(p=>p.value),[g])[0]} limit 1`,a=p=>{i({...o,expression:p})};return(0,n.jsx)(l.Y,{query:o.expression||c,onChange:a})}},76658:(k,A,e)=>{"use strict";e.d(A,{O:()=>R});var n=e(74848),s=e(32196),l=e(96540),r=e(46819),i=e(40845),g=e(39268),o=e(14186),d=e(90182),c=e(9261),a=e(10354),p=e(15292),u=e(2913),m=e(55907),v=e(66718),x=e(65307);const f=(0,x.VP)("thresold/updateRefId"),E=(0,x.VP)("thresold/updateThresholdType"),h=(0,x.VP)("thresold/updateThresholdParams"),y=(0,x.VP)("thresold/updateHysteresis"),b=(0,x.VP)("thresold/updateUnloadParams"),D=(0,x.vy)({type:v.Tz.threshold,refId:"",conditions:[]},L=>{L.addCase(f,(O,j)=>{O.expression=j.payload}),L.addCase(E,(O,j)=>{const N=j.payload.evalFunction,F=j.payload.onError;if(O.conditions[0].evaluator.type=N,!!O.conditions[0].unloadEvaluator){const w=P(O.conditions[0].evaluator.type);F&&F(void 0),O.conditions[0].evaluator.type=N;const B={type:w,params:O.conditions[0].evaluator?.params??[0,0]};O.conditions[0].unloadEvaluator=B}}),L.addCase(h,(O,j)=>{const{param:N,index:F}=j.payload;O.conditions[0].evaluator.params[F]=N}),L.addCase(y,(O,j)=>{const{hysteresisChecked:N,onError:F}=j.payload;N?O.conditions[0].unloadEvaluator={type:P(O.conditions[0].evaluator.type),params:O.conditions[0].evaluator?.params??[0,0]}:(O.conditions[0].unloadEvaluator=void 0,F&&F(void 0))}),L.addCase(b,(O,j)=>{const{param:N,index:F,onError:U}=j.payload;O.conditions[0].unloadEvaluator?O.conditions[0].unloadEvaluator.params[F]=N:O.conditions[0].unloadEvaluator={type:P(O.conditions[0].evaluator.type),params:O.conditions[0].evaluator?.params??[0,0]};const w=C(O.conditions[0]),{errorMsg:B,errorMsgFrom:K,errorMsgTo:W}=w??{};U&&U(B||K||W)})});function P(L){return L===m.p.IsAbove?m.p.IsBelow:L===m.p.IsBelow?m.p.IsAbove:L===m.p.IsWithinRange?m.p.IsOutsideRange:L===m.p.IsOutsideRange?m.p.IsWithinRange:m.p.IsBelow}function C(L){const{unloadEvaluator:O,evaluator:j}=L;if(!j)return;if(O?.params[0]===void 0||Number.isNaN(O?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:N,params:F}=j,{params:U}=O;if(N===m.p.IsWithinRange||N===m.p.IsOutsideRange){if(U[0]===void 0||Number.isNaN(U[0]))return{errorMsgFrom:"This value cannot be empty"};if(U[1]===void 0||Number.isNaN(U[1]))return{errorMsgTo:"This value cannot be empty"}}const[w,B]=O.params,[K,W]=F;switch(N){case m.p.IsAbove:if(w>K)return{errorMsg:`Enter a number less than or equal to ${K}`};break;case m.p.IsBelow:if(w<K)return{errorMsg:`Enter a number more than or equal to ${K}`};break;case m.p.IsOutsideRange:if(w<K)return{errorMsgFrom:`Enter a number more than or equal to ${K}`};if(B>W)return{errorMsgTo:`Enter a number less than or equal to ${W}`};break;case m.p.IsWithinRange:if(w>K)return{errorMsgFrom:`Enter a number less than or equal to ${K}`};if(B<W)return{errorMsgTo:`Enter a number be more than or equal to ${W}`};break;default:throw new Error(`evaluator function type ${N} not supported.`)}}const M=m.p.IsAbove,I={type:"query",evaluator:{type:M,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},R=({labelWidth:L,onChange:O,refIds:j,query:N,onError:F,useHysteresis:U=!1})=>{const w=(0,i.of)(S),B={...N,conditions:N.conditions?.length?N.conditions:[I]},[K,W]=(0,l.useReducer)(D,B),z=K.conditions[0],Y=v.zd.find(ne=>ne.value===K.conditions[0].evaluator?.type),X=ne=>{W(f(ne.value))};(0,l.useEffect)(()=>{K&&O(K)},[K]);const q=ne=>{W(E({evalFunction:ne.value??M,onError:F}))},G=(ne,le)=>{W(h({param:parseFloat(ne.currentTarget.value),index:le}))},te=z.evaluator.type===m.p.IsWithinRange||z.evaluator.type===m.p.IsOutsideRange,H=!!u.config.featureToggles?.recoveryThreshold&&U;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.C,{children:(0,n.jsx)(o.I,{label:"Input",labelWidth:L,children:(0,n.jsx)(d.l6,{onChange:X,options:j,value:N.expression,width:20})})}),(0,n.jsxs)(g.C,{children:[(0,n.jsx)(c.f,{className:w.buttonSelectText,options:v.zd,onChange:q,value:Y}),te?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.p,{type:"number",width:10,onChange:ne=>G(ne,0),defaultValue:z.evaluator.params[0]}),(0,n.jsx)("div",{className:w.button,children:"TO"}),(0,n.jsx)(a.p,{type:"number",width:10,onChange:ne=>G(ne,1),defaultValue:z.evaluator.params[1]})]}):(0,n.jsx)(a.p,{type:"number",width:10,onChange:ne=>G(ne,0),defaultValue:z.evaluator.params[0]||0})]}),H&&(0,n.jsx)(se,{isRange:te,onError:F})]});function se({isRange:ne,onError:le}){const _=!!z.unloadEvaluator,Q=J=>{W(y({hysteresisChecked:J.currentTarget.checked,onError:le})),ae.current=!0},ae=l.useRef(!0),oe=()=>{ae.current=!1};return(0,n.jsxs)("div",{className:w.hysteresis,children:[(0,n.jsx)("div",{onMouseDown:oe,children:(0,n.jsx)(p.K,{showLabel:!0,label:"Custom recovery threshold",value:_,onChange:Q,className:w.switch})}),_&&(0,n.jsx)(T,{isRange:ne,condition:z,onError:le,dispatch:W,allowOnblur:ae})]})}};function T({isRange:L,condition:O,onError:j,dispatch:N,allowOnblur:F}){const U=(0,i.of)(S),w=(q,G)=>{const te=parseFloat(q.currentTarget.value);N(b({param:te,index:G,onError:j}))},B=C(O),{errorMsg:K,errorMsgFrom:W,errorMsgTo:z}=B??{};if(L)return(0,n.jsx)(Y,{allowOnblur:F});return(0,n.jsx)(X,{allowOnblur:F});function Y({allowOnblur:q}){return O.evaluator.type===m.p.IsWithinRange?(0,n.jsx)(g.C,{className:U.hysteresis,children:(0,n.jsx)(o.I,{label:"Stop alerting when outside range",labelWidth:"auto",children:(0,n.jsxs)(r.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(o.I,{invalid:!!W,error:W,className:U.noMargin,children:(0,n.jsx)(a.p,{type:"number",width:10,onBlur:G=>q.current&&w(G,0),defaultValue:O.unloadEvaluator?.params[0]})})}),(0,n.jsx)("div",{className:U.button,children:"TO"}),(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(o.I,{invalid:!!z,error:z,children:(0,n.jsx)(a.p,{type:"number",width:10,onBlur:G=>q.current&&w(G,1),defaultValue:O.unloadEvaluator?.params[1]})})})]})})}):(0,n.jsx)(g.C,{className:U.hysteresis,children:(0,n.jsx)(o.I,{label:"Stop alerting when inside range",labelWidth:"auto",children:(0,n.jsxs)(r.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(o.I,{invalid:!!W,error:W,children:(0,n.jsx)(a.p,{type:"number",width:10,onBlur:G=>q.current&&w(G,0),defaultValue:O.unloadEvaluator?.params[0]})})}),(0,n.jsx)("div",{className:U.button,children:"TO"}),(0,n.jsx)("div",{className:U.range,children:(0,n.jsx)(o.I,{invalid:!!z,error:z,children:(0,n.jsx)(a.p,{type:"number",width:10,onBlur:G=>q.current&&w(G,1),defaultValue:O.unloadEvaluator?.params[1]})})})]})})})}function X({allowOnblur:q}){return O.evaluator.type===m.p.IsAbove?(0,n.jsx)(g.C,{className:U.hysteresis,children:(0,n.jsx)(o.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(a.p,{type:"number",width:10,onBlur:G=>{q.current&&w(G,0)},defaultValue:O.unloadEvaluator?.params[0]})})}):(0,n.jsx)(g.C,{className:U.hysteresis,children:(0,n.jsx)(o.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!K,error:K,children:(0,n.jsx)(a.p,{type:"number",width:10,onBlur:G=>{q.current&&w(G,0)},defaultValue:O.unloadEvaluator?.params[0]})})})}}const S=L=>({buttonSelectText:(0,s.css)({color:L.colors.primary.text,fontSize:L.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${L.spacing(1)}`}),button:(0,s.css)({height:"32px",color:L.colors.primary.text,fontSize:L.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:L.shape.radius.default,fontWeight:L.typography.fontWeightBold,border:`1px solid ${L.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${L.spacing(1)}`,backgroundColor:L.colors.background.primary}),range:(0,s.css)({width:"min-content"}),hysteresis:(0,s.css)({marginTop:L.spacing(2)}),switch:(0,s.css)({paddingLeft:L.spacing(1)}),noMargin:(0,s.css)({margin:0})})},69437:(k,A,e)=>{"use strict";e.d(A,{f:()=>l});var n=e(26657),s=e(66718);const l=r=>{if(!r)return!1;if((0,n.s9)(r.datasource))return!0;const i=r;return typeof i.type!="string"?!1:Object.values(s.Tz).includes(i.type)}},66718:(k,A,e)=>{"use strict";e.d(A,{Cu:()=>d,HZ:()=>a,Mt:()=>c,NI:()=>g,PN:()=>p,Tz:()=>i,Uj:()=>r,iX:()=>u,uQ:()=>o,zd:()=>m});var n=e(75059),s=e(2913),l=e(55907);const r="__expr__";var i=(v=>(v.math="math",v.reduce="reduce",v.resample="resample",v.classic="classic_conditions",v.threshold="threshold",v.sql="sql",v))(i||{});const g=v=>{switch(v){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},o=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(v=>v.value==="sql"?s.config.featureToggles?.sqlExpressions:!0),d=[{value:n.gy.min,label:"Min",description:"Get the minimum value"},{value:n.gy.max,label:"Max",description:"Get the maximum value"},{value:n.gy.mean,label:"Mean",description:"Get the average value"},{value:n.gy.median,label:"Median",description:"Get the median value"},{value:n.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:n.gy.count,label:"Count",description:"Get the number of values"},{value:n.gy.last,label:"Last",description:"Get the last value"}];var c=(v=>(v.Strict="",v.ReplaceNonNumbers="replaceNN",v.DropNonNumbers="dropNN",v))(c||{});const a=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],p=[{value:n.gy.last,label:"Last",description:"Fill with the last value"},{value:n.gy.min,label:"Min",description:"Fill with the minimum value"},{value:n.gy.max,label:"Max",description:"Fill with the maximum value"},{value:n.gy.mean,label:"Mean",description:"Fill with the average value"},{value:n.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],u=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],m=[{value:l.p.IsAbove,label:"Is above"},{value:l.p.IsBelow,label:"Is below"},{value:l.p.IsWithinRange,label:"Is within range"},{value:l.p.IsOutsideRange,label:"Is outside range"}]},76942:(k,A,e)=>{"use strict";e.d(A,{P:()=>i,r:()=>r});var n=e(75059),s=e(55907),l=e(66718);const r=g=>{switch(g.type){case l.Tz.reduce:g.reducer||(g.reducer=n.gy.mean);break;case l.Tz.resample:g.downsampler||(g.downsampler=n.gy.mean),g.upsampler||(g.upsampler="fillna"),g.reducer=void 0;break;case l.Tz.math:g.expression=void 0;break;case l.Tz.classic:g.conditions||(g.conditions=[i]);break;default:g.reducer=void 0}return g},i={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:s.p.IsAbove}}},71101:(k,A,e)=>{"use strict";e.d(A,{Cg:()=>o,Fk:()=>c,R4:()=>u,Rj:()=>g,pq:()=>d});var n=e(32264),s=e(8484),l=e(16233),r=e(36689),i=e(31678);const g="manage-folder",o=v=>`folder-dashboards-${v}`,d=v=>`folder-library-panels-${v}`,c=v=>`folder-alerting-${v}`,a=v=>`folder-permissions-${v}`,p=v=>`folder-settings-${v}`;function u(v,x=v.parents){const f={icon:"folder",id:g,subTitle:(0,r.o)("manage-folder"),url:v.url,text:v.title,children:[{active:!1,icon:"apps",id:o(v.uid),text:(0,s.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:v.url}]};if(x&&x.length>0){const E=x[x.length-1],h=x.slice(0,x.length-1);f.parentItem=u(E,h)}return f.children.push({active:!1,icon:"library-panel",id:d(v.uid),text:(0,s.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${v.url}/library-panels`}),l.TP.hasPermission(i.AccessControlAction.AlertingRuleRead)&&n.$.unifiedAlertingEnabled&&f.children.push({active:!1,icon:"bell",id:c(v.uid),text:(0,s.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${v.url}/alerting`}),f}function m(v){const x=u({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return x.children[v].active=!0,{main:x,node:x.children[v]}}},54650:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>c,jl:()=>g});var n=e(65307),s=e(55314);const l={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},r=(a,p)=>({...a,...p.payload,hasChanged:!1}),i=(0,n.Z0)({name:"folder",initialState:l,reducers:{loadFolder:r,setFolderTitle:(a,p)=>({...a,title:p.payload,hasChanged:p.payload.trim().length>0})},extraReducers:a=>{a.addMatcher(s.vZ.getFolder.matchFulfilled,r)}}),{loadFolder:g,setFolderTitle:o}=i.actions,c={folder:i.reducer}},84350:(k,A,e)=>{"use strict";e.d(A,{G:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(90182),g=e(42418),o=e(67140);const d=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:o.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],c=({value:p,onChange:u,context:m,item:v})=>{const x=(0,r.of)(a),[f,E]=(0,l.useState)(),h=v.settings;(0,l.useEffect)(()=>{async function D(){const P=await(0,o.q3)(p);E(P)}D()},[p,E]);const{current:y,options:b}=(0,l.useMemo)(()=>{let D=h?.options?[...h.options]:[...d],P=D?.find(C=>C.value===f?.path);return!P&&f&&(P={label:f.path,value:f.path},D.push(P)),{options:D,current:P}},[f,h?.options]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.l6,{value:y,options:b,onChange:D=>u(D.value),allowCustomValue:!0,formatCreateLabel:D=>`Load from URL: ${D}`}),f&&(0,n.jsxs)(n.Fragment,{children:[f.error&&(0,n.jsx)(g.F,{title:f.error,severity:"warning"}),f.count&&(0,n.jsxs)("div",{className:x.keys,children:[(0,n.jsxs)("b",{children:["(",f.count,")"]}),f.examples(10).map(D=>(0,n.jsxs)("span",{children:[D,","]},D)),f.count>10&&" ..."]})]})]})},a=()=>({keys:(0,s.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(k,A,e)=>{"use strict";e.d(A,{G:()=>h});var n=e(11261),s=e(52622),l=e(84350),r=e(74848),i=e(32196),g=e(96540),o=e(13544),d=e(40845),c=e(42418),a=e(14578),p=e(90182),u=e(66864),m=e(31484);const v=[{value:s.aG.Auto,label:"Auto",ariaLabel:o.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:s.aG.Coords,label:"Coords",ariaLabel:o.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:s.aG.Geohash,label:"Geohash",ariaLabel:o.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:s.aG.Lookup,label:"Lookup",ariaLabel:o.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],x="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",f=({value:y,onChange:b,context:D,item:P})=>{const[C,M]=(0,g.useState)();(0,g.useEffect)(()=>{P.settings?.source&&P.settings?.data?.length&&P.settings.data[0]&&(0,m.nE)(P.settings.source).then(T=>{P.settings&&P.settings.data&&M((0,m.FM)(P.settings.data[0],T))})},[P.settings]);const I=(0,d.of)(E),R=()=>{if(C){if(C.warning)return(0,r.jsx)(c.F,{title:C.warning,severity:"warning",buttonContent:(0,r.jsx)(a.I,{name:"question-circle",size:"xl"}),className:I.alert,onRemove:()=>{const T=window.open(x,"_blank","noopener,noreferrer");T&&(T.opener=null)}});if(y===s.aG.Auto&&C.description)return(0,r.jsx)("span",{children:C.description})}return null};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.l6,{options:v,value:y,onChange:T=>{b(T.value)}}),(0,r.jsx)(u.Gy,{className:I.hGroup,children:R()})]})},E=y=>({alert:(0,i.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,i.css)`
      & div {
        width: 100%;
      }
    `});function h(y,b,D,P,C){switch(D.addCustomEditor({id:"modeEditor",path:`${b}mode`,name:"Location Mode",editor:f,settings:{data:C,source:P}}),P?.mode){case s.aG.Coords:D.addFieldNamePicker({path:`${b}latitude`,name:"Latitude field",settings:{filter:M=>M.type===n.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${b}longitude`,name:"Longitude field",settings:{filter:M=>M.type===n.PU.number,noFieldsMessage:"No numeric fields found"}});break;case s.aG.Geohash:D.addFieldNamePicker({path:`${b}geohash`,name:"Geohash field",settings:{filter:M=>M.type===n.PU.string,noFieldsMessage:"No strings fields found"}});break;case s.aG.Lookup:D.addFieldNamePicker({path:`${b}lookup`,name:"Lookup field",settings:{filter:M=>M.type===n.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${b}gazetteer`,name:"Gazetteer",editor:l.G})}}},96606:(k,A,e)=>{"use strict";e.d(A,{RA:()=>u,XR:()=>m,Dc:()=>p,qy:()=>c,Pz:()=>a});var n=e(44294),s=e(34338),l=e(11217),r=e(22796),i=e(11261),g=e(78134);function o(x){if(!x?.length)return;const f=[16,8,4,2,1],E="0123456789bcdefghjkmnpqrstuvwxyz";let h=!0;const y=[],b=[];y[0]=-90,y[1]=90,b[0]=-180,b[1]=180;let D;x.split("").forEach(M=>{D=E.indexOf(M),f.forEach(I=>{d(h?b:y,D,I),h=!h})});const P=(y[0]+y[1])/2;return[(b[0]+b[1])/2,P]}function d(x,f,E){f&E?x[0]=(x[0]+x[1])/2:x[1]=(x[0]+x[1])/2}function c(x){return{name:x.name??"Point",type:i.PU.geo,values:x.values.map(f=>{const E=o(f);if(E)return new n.A((0,r.Rb)(E))}),config:v}}function a(x,f){const E=new Array(x.values.length);for(let h=0;h<x.values.length;h++){const y=x.values[h],b=f.values[h];y===null||b===null||(E[h]=new n.A((0,r.Rb)([y,b])))}return{name:"Point",type:i.PU.geo,values:E,config:v}}function p(x,f){const E=f.values.length,h=new Array(E);for(let y=0;y<E;y++)h[y]=x.find(f.values[y])?.geometry();return{name:"Geometry",type:i.PU.geo,values:h,config:v}}function u(x,f){const E=x.values,h=f.values;if(!E||!h)throw"missing src/dest";if(E.length!==h.length)throw"Source and destination field lengths do not match";const y=x.values.length,b=new Array(y);for(let D=0;D<y;D++){const P=E[D],C=h[D];P&&C?b[D]=new s.A([P,C]):P?b[D]=P:C&&(b[D]=C)}return{name:"Geometry",type:i.PU.geo,values:b,config:v}}function m(x,f){const E=x.values,h=f.values;if(!E||!h)throw"missing src/dest";if(E.length!==h.length)throw"Source and destination field lengths do not match";const y=x.values.length,b=new Array(y);for(let D=0;D<y;D++){const P=E[D],C=h[D];P&&C&&(b[D]=new l.A([(0,g.EX)(P),(0,g.EX)(C)]))}return{name:"Geometry",type:i.PU.geo,values:b,config:v}}const v=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(k,A,e)=>{"use strict";e.d(A,{fx:()=>x,q3:()=>f});var n=e(70915),s=e(44294),l=e(14236),r=e(11261),i=e(17172),g=e(11365);function o(E){const h=new g.A().readFeatures(E,{featureProjection:"EPSG:3857"}),y=h.length,b=new Array(y).fill(null),D=[],P=new Map,C=T=>{let S=P.get(T);return S||(S={types:new Set,values:new Array(y).fill(null),count:0},D.push(T),P.set(T,S)),S},M=(...T)=>{for(const S of T)if(!P.has(S))return S;return"___"+T[0]},I={types:new Set,values:new Array(y).fill(null),count:0};for(let T=0;T<y;T++){const S=h[T];b[T]=S.getGeometry();const L=S.getId();L!=null&&(I.values[T]=L,I.types.add((0,l.oE)(L)),I.count++);for(const O of S.getKeys()){const j=S.get(O);if(j===b[T]||j==null)continue;const N=C(O);N.values[T]=j,N.types.add((0,l.oE)(j)),N.count++}}const R=[];if(I.count>0){const T=d(I);R.push({name:M("id","_id","__id"),type:T,values:I.values,config:{}})}R.push({name:M("geo","geometry"),type:r.PU.geo,values:b,config:{}});for(const T of D){const S=P.get(T);if(!S)continue;const L=d(S);R.push({name:T,type:L,values:S.values,config:{}})}return{fields:R,length:y}}function d(E){return E.count<1?r.PU.other:E.types.size>1?(E.values=E.values.map(h=>h!=null?`${h}`:h),r.PU.string):E.types.values().next().value}var c=e(96606),a=e(22796);function p(E,h){let y=0;const b=new Map;for(const D of h){const P=new s.A((0,a.Rb)([D.longitude,D.latitude])),C={point:()=>P,geometry:()=>P};if(D.name&&(b.set(D.name,C),b.set(D.name.toUpperCase(),C)),D.key&&(b.set(D.key,C),b.set(D.key.toUpperCase(),C)),D.keys)for(const M of D.keys)b.set(M,C),b.set(M.toUpperCase(),C);y++}return{path:E,find:D=>{let P=b.get(D);return!P&&typeof D=="string"&&(P=b.get(D.toUpperCase())),P},count:y,examples:D=>{const P=[];if(b.size<1)P.push("no values found");else for(const C of b.keys())if(P.push(C),P.length>=D)break;return P}}}function u(E,h){let y;if(Array.isArray(h)){const b=h[0];if(b.latitude&&b.longitude&&(b.key||b.keys))return p(E,h)}else Array.isArray(h?.features)&&h?.type==="FeatureCollection"&&(y=o(h));if(!y)try{y=(0,l.Vc)(h)}catch(b){return{path:E,error:`${b}`,find:D=>{},examples:D=>[]}}return m(y,{path:E})}function m(E,h){const y=[];let b,D,P,C,M;for(const T of E.fields)if(T.type===r.PU.geo&&(b=T),!M&&T.type===r.PU.string&&(M=T),T.name){h.keys&&h.keys.includes(T.name)&&y.push(T);const S=T.name.toUpperCase();switch(S){case"LAT":case"LATITUTE":D=T;break;case"LON":case"LNG":case"LONG":case"LONGITUE":P=T;break;case"GEOHASH":C=T;break;case"ID":case"UID":case"KEY":case"CODE":h.keys||y.push(T);break;default:h.keys||(S.endsWith("_ID")||S.endsWith("_CODE"))&&y.push(T)}}!y.length&&M&&y.push(M);let I=!1;b?I=b.values[0]?.getType()==="Point":C?(b=(0,c.qy)(C),I=!0):D&&P&&(b=(0,c.Pz)(P,D),I=!0);const R=new Map;return y.forEach(T=>{T.values.forEach((S,L)=>{const O=`${S}`;R.set(O.toUpperCase(),L),R.set(O,L)})}),{path:h.path,find:T=>{const S=R.get(T);if(S!=null){const L=b?.values[S];return{frame:E,index:S,point:()=>!L||I?L:new s.A((0,n.q1)(L.getExtent())),geometry:()=>L}}},examples:T=>{const S=[];for(let L of R.keys())if(S.push(L),S.length>T)break;return S},frame:()=>E,count:E.length}}const v={},x="public/gazetteer/countries.json";async function f(E){E||(E=x);let h=v[E];if(!h){try{const y=await(0,i.AI)().get(E);h=u(E,y)}catch(y){console.warn("Error loading placename lookup",E,y),h={path:E,error:"Error loading URL",find:b=>{},examples:b=>[]}}v[E]=h}return h}},31484:(k,A,e)=>{"use strict";e.d(A,{FM:()=>m,nE:()=>p});var n=e(28240),s=e(11261),l=e(85200),r=e(1173),i=e(52622),g=e(96606),o=e(67140);function d(v){return x=>{for(const f of x.fields)if(v(f,x,[]))return f}}function c(v){return x=>{for(const f of x.fields){if(v.has(f.name.toLowerCase()))return f;const E=(0,n.Ct)(f,x);if(v.has(E))return f}}}const a={mode:i.aG.Auto,geohash:c(new Set(["geohash"])),latitude:c(new Set(["latitude","lat"])),longitude:c(new Set(["longitude","lon","lng"])),h3:c(new Set(["h3"])),wkt:c(new Set(["wkt"])),lookup:c(new Set(["lookup"])),geo:v=>v.fields.find(x=>x.type===s.PU.geo)};async function p(v){const x={...a,mode:v?.mode??i.aG.Auto};switch(x.gazetteer=await(0,o.q3)(v?.gazetteer),x.mode){case i.aG.Geohash:v?.geohash?x.geohash=d((0,l.NS)({id:r.Ct.byName,options:v.geohash})):x.geohash=()=>{};break;case i.aG.Lookup:const f=v?.lookup?.length?(0,l.NS)({id:r.Ct.byName,options:v.lookup}):(0,l.NS)({id:r.Ct.byType,options:s.PU.string});x.lookup=d(f);break;case i.aG.Coords:v?.latitude?x.latitude=d((0,l.NS)({id:r.Ct.byName,options:v.latitude})):x.latitude=()=>{},v?.longitude?x.longitude=d((0,l.NS)({id:r.Ct.byName,options:v.longitude})):x.longitude=()=>{};break}return x}function u(v,x){const f={mode:x.mode??i.aG.Auto};if(f.mode===i.aG.Auto){if(f.geo=x.geo(v),f.geo)return f;if(f.latitude=x.latitude(v),f.longitude=x.longitude(v),f.latitude&&f.longitude)return f.mode=i.aG.Coords,f;if(f.geohash=x.geohash(v),f.geohash)return f.mode=i.aG.Geohash,f;if(f.lookup=x.lookup(v),f.lookup)return f.mode=i.aG.Lookup,f}switch(f.mode){case i.aG.Coords:f.latitude=x.latitude(v),f.longitude=x.longitude(v);break;case i.aG.Geohash:f.geohash=x.geohash(v);break;case i.aG.Lookup:f.lookup=x.lookup(v);break}return f}function m(v,x){const f=u(v,x);switch(f.mode){case i.aG.Auto:return f.geo?{field:f.geo}:{warning:"Unable to find location fields"};case i.aG.Coords:return f.latitude&&f.longitude?{field:(0,g.Pz)(f.longitude,f.latitude),derived:!0,description:`${f.mode}: ${f.latitude.name}, ${f.longitude.name}`}:{warning:"Select latitude/longitude fields"};case i.aG.Geohash:return f.geohash?{field:(0,g.qy)(f.geohash),derived:!0,description:`${f.mode}`}:{warning:"Select geohash field"};case i.aG.Lookup:return f.lookup?x.gazetteer?{field:(0,g.Dc)(x.gazetteer,f.lookup),derived:!0,description:`${f.mode}: ${x.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(k,A,e)=>{"use strict";e.d(A,{q:()=>O});var n=e(74848),s=e(2543),l=e(96540),r=e(70713),i=e(18282),g=e(2514),o=e(90708),d=e(13544),c=e(14110),a=e(72574),p=e(55852),u=e(62930),m=e(77093),v=e(2913),x=e(8484),f=e(69147),E=e(28240),h=e(40845),y=e(66864),b=e(88575),D=e(90182),P=e(15292),C=e(7788),M=e(32196);const I=N=>(0,M.css)`
  padding: ${N.spacing(0,2)};
  font-size: ${N.typography.bodySmall.fontSize};
  color: ${N.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,R=({children:N})=>{const F=(0,h.of)(I);return(0,n.jsx)("div",{className:F,children:N})};var T=e(26323);const S=({options:N,actions:F,formattedDataDescription:U,onOptionsChange:w,hasTransformations:B,data:K,dataFrames:W,transformationOptions:z,selectedDataFrame:Y,onDataFrameChange:X,downloadForExcel:q,toggleDownloadForExcel:G})=>{const te=(0,h.of)(T.A);let H=W;Y===i.F.joinByField&&(H=K);const se=H.map((_,Q)=>({value:Q,label:`${(0,E.Ri)(_)} (${Q})`})),ne=[...z,...se];function le(){let _="";if(!K)return _;const Q=[];return Y===i.F.joinByField?Q.push((0,x.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):K.length>1&&Q.push((0,E.Ri)(K[Y])),(N.withTransforms||N.withFieldConfig)&&(N.withTransforms&&Q.push((0,x.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),N.withTransforms&&N.withFieldConfig,N.withFieldConfig&&Q.push((0,x.t)("dashboard.inspect-data.formatted","Formatted data"))),q&&Q.push((0,x.t)("dashboard.inspect-data.excel-header","Excel header")),Q.join(", ")}return(0,n.jsx)("div",{className:te.dataDisplayOptions,children:(0,n.jsx)(C.u,{id:"Data options",index:0,title:(0,x.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,n.jsx)(R,{children:le()}),isOpen:!1,actions:F,children:(0,n.jsx)("div",{className:te.options,"data-testid":"dataOptions",children:(0,n.jsxs)(y.gW,{spacing:"none",children:[K.length>1&&(0,n.jsx)(b.D,{label:(0,x.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,n.jsx)(D.l6,{options:ne,value:Y,onChange:X,width:30,"aria-label":(0,x.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,n.jsxs)(y.Gy,{children:[B&&w&&(0,n.jsx)(b.D,{label:(0,x.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,x.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,n.jsx)(P.d,{value:!!N.withTransforms,onChange:()=>w({...N,withTransforms:!N.withTransforms})})}),w&&(0,n.jsx)(b.D,{label:(0,x.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:U||(0,x.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,n.jsx)(P.d,{id:"formatted-data-toggle",value:!!N.withFieldConfig,onChange:()=>w({...N,withFieldConfig:!N.withFieldConfig})})}),(0,n.jsx)(b.D,{label:(0,x.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,x.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,n.jsx)(P.d,{id:"excel-toggle",value:q,onChange:G})})]})]})})})})};var L=e(18358);class O extends l.PureComponent{constructor(F){super(F),this.onExportLogsAsTxt=()=>{const{data:U,dataName:w,app:B}=this.props;(0,c.rR)("grafana_logs_download_logs_clicked",{app:B,format:"logs",area:"inspector"});const K=(0,f.HT)(U||[]);(0,L.Zy)(K,w)},this.onExportTracesAsJson=()=>{const{data:U,dataName:w,app:B}=this.props;if(U)for(const K of U){if(K.meta?.preferredVisualisationType!=="trace")continue;const W=(0,L.ek)(K,w+"-traces");(0,c.rR)("grafana_traces_download_traces_clicked",{app:B,grafana_version:v.config.buildInfo.version,trace_format:W,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:U,dataName:w,app:B}=this.props;(0,c.rR)("grafana_traces_download_service_graph_clicked",{app:B,grafana_version:v.config.buildInfo.version,location:"inspector"}),U&&(0,L.ny)(U,w)},this.onDataFrameChange=U=>{this.setState({transformId:U.value===i.F.joinByField?i.F.joinByField:i.F.noop,dataFrameIndex:typeof U.value=="number"?U.value:0,selectedDataFrame:U.value})},this.onToggleDownloadForExcel=()=>{this.setState(U=>({downloadForExcel:!U.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:i.F.noop,transformationOptions:j(),transformedData:F.data??[],downloadForExcel:!1}}componentDidUpdate(F,U){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(F.data!==this.props.data||U.transformId!==this.state.transformId){const w=this.state.transformationOptions.find(B=>B.value===this.state.transformId);if(w&&w.transformer.id!==i.F.noop){const B=this.state.selectedDataFrame,K=this.state.dataFrameIndex,W=(0,g.m)([w.transformer],this.props.data).subscribe(z=>{this.setState({transformedData:z,selectedDataFrame:B,dataFrameIndex:K},()=>W.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(F,U){const{dataName:w}=this.props,{transformId:B}=this.state,K=F[this.state.dataFrameIndex];U&&(0,c.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,L.EM)(K,w,{useExcelHeader:this.state.downloadForExcel},B)}getProcessedData(){const{options:F,panelPluginId:U,fieldConfig:w,timeZone:B}=this.props,K=this.state.transformedData;if(!F.withFieldConfig)return(0,o.K3)(K);let W=w??{defaults:{},overrides:[]};return U==="table"&&w&&(W=this.cleanTableConfigFromFieldConfig(w)),(0,o.we)({data:K,theme:v.config.theme2,fieldConfig:W,timeZone:B,replaceVariables:(z,Y,X)=>(0,a.w)().replace(z,Y,X)})}cleanTableConfigFromFieldConfig(F){F=(0,s.cloneDeep)(F),F.defaults.custom={};for(const U of F.overrides)for(const w of U.properties)if(w.id.startsWith("custom.")){const B=U.properties.indexOf(w);U.properties.slice(B,1)}return F}renderActions(F,U,w,B){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.$n,{variant:"primary",onClick:()=>this.exportCsv(F,U),size:"sm",children:(0,n.jsx)(x.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),U&&(0,n.jsx)(p.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,n.jsx)(x.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),w&&(0,n.jsx)(p.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,n.jsx)(x.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),B&&(0,n.jsx)(p.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,n.jsx)(x.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:F,options:U,data:w,formattedDataDescription:B,onOptionsChange:K,hasTransformations:W}=this.props,{dataFrameIndex:z,transformationOptions:Y,selectedDataFrame:X,downloadForExcel:q}=this.state,G=(0,T.c)();if(F)return(0,n.jsxs)("div",{children:[(0,n.jsx)(u.y,{inline:!0})," Loading"]});const te=this.getProcessedData();if(!te||!te.length)return(0,n.jsx)("div",{children:"No Data"});const H=te[z]?z:0,se=te[H],ne=te.some(Q=>Q?.meta?.preferredVisualisationType==="logs"),le=te.some(Q=>Q?.meta?.preferredVisualisationType==="trace"),_=te.some(Q=>Q?.meta?.preferredVisualisationType==="nodeGraph");return(0,n.jsxs)("div",{className:G.wrap,"aria-label":d.Tp.components.PanelInspector.Data.content,children:[(0,n.jsx)("div",{className:G.toolbar,children:(0,n.jsx)(S,{data:w,hasTransformations:W,options:U,dataFrames:te,transformationOptions:Y,selectedDataFrame:X,downloadForExcel:q,formattedDataDescription:B,onOptionsChange:K,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(te,ne,le,_)})}),(0,n.jsx)("div",{className:G.content,children:(0,n.jsx)(r.Ay,{children:({width:Q,height:ae})=>Q===0?null:(0,n.jsx)(m.X,{width:Q,height:ae,data:se,showTypeIcons:!0})})})]})}}function j(){return[{value:i.F.joinByField,label:(0,x.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:i.F.joinByField,options:{byField:void 0}}}]}},32067:(k,A,e)=>{"use strict";e.d(A,{N:()=>v});var n=e(74848),s=e(32196),l=e(13544),r=e(8484),i=e(57875),g=e(11261),o=e(83195),d=e(40845);const c=({timeZone:f,name:E,stats:h})=>{const y=(0,d.$j)(),b=(0,d.of)(p);return!h||!h.length?null:(0,n.jsxs)("div",{className:b.wrapper,children:[(0,n.jsx)("div",{className:b.heading,children:E}),(0,n.jsx)("table",{className:"filter-table width-30",children:(0,n.jsx)("tbody",{children:h.map((D,P)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:D.displayName}),(0,n.jsx)("td",{className:b.cell,children:a(D,f,y)})]},`${D.displayName}-${P}`))})})]})};function a(f,E,h){const y=(0,i.J)({field:{type:g.PU.number,config:f},theme:h,timeZone:E});return(0,o.cN)(y(f.value))}const p=f=>({heading:(0,s.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrapper:(0,s.css)({paddingBottom:f.spacing(2)}),cell:(0,s.css)({textAlign:"right"})}),u=({name:f,traceIds:E})=>{const h=(0,d.of)(m);return E.length===0?null:(0,n.jsxs)("div",{className:h.wrapper,children:[(0,n.jsx)("div",{className:h.heading,children:f}),(0,n.jsx)("table",{className:"filter-table width-30",children:(0,n.jsx)("tbody",{children:E.map((y,b)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:y})},`${y}-${b}`))})})]})},m=f=>({heading:(0,s.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrapper:(0,s.css)({paddingBottom:f.spacing(2)}),cell:(0,s.css)({textAlign:"right"})}),v=({data:f,timeZone:E})=>{if(!f.request)return null;let h=[];const y=f.request.endTime?f.request.endTime-f.request.startTime:-1,b=f.timings?.dataProcessingTime||-1;let D=0;for(const R of f.series)D+=R.length;y>0&&h.push({displayName:(0,r.t)("dashboard.inspect-stats.request-time","Total request time"),value:y,unit:"ms"}),b>0&&h.push({displayName:(0,r.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:b,unit:"ms"}),h.push({displayName:(0,r.t)("dashboard.inspect-stats.queries","Number of queries"),value:f.request.targets?.length??0}),h.push({displayName:(0,r.t)("dashboard.inspect-stats.rows","Total number rows"),value:D});let P=[];for(const R of f.series)R.meta&&R.meta.stats&&(P=P.concat(R.meta.stats));const C=(0,r.t)("dashboard.inspect-stats.table-title","Stats"),M=(0,r.t)("dashboard.inspect-stats.data-title","Data source stats"),I=(0,r.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,n.jsxs)("div",{"aria-label":l.Tp.components.PanelInspector.Stats.content,className:x,children:[(0,n.jsx)(c,{timeZone:E,name:C,stats:h}),(0,n.jsx)(c,{timeZone:E,name:M,stats:P}),(0,n.jsx)(u,{name:I,traceIds:f.traceIds??[]})]})},x=(0,s.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(k,A,e)=>{"use strict";e.d(A,{e:()=>f});var n=e(74848),s=e(32196),l=e(96540),r=e(64423),i=e(39070),g=e(13544),o=e(32264),d=e(67061),c=e(55852),a=e(10534),p=e(39558),u=e(24022),m=e(8484),v=e(27677),x=e(26323);class f extends l.PureComponent{constructor(h){super(h),this.subs=new r.yU,this.setFormattedJson=y=>{this.formattedJson=y},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(y=>({...y,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(y=>({...y,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(v.IB.getInspectorStream().subscribe({next:h=>{let y=!0;if(this.props.instanceId&&h?.requestId&&(y=h.requestId.startsWith(this.props.instanceId)),y)return this.onDataSourceResponse(h.response)}}))}componentDidUpdate(h){this.props.data!==h.data&&this.updateQueryList()}updateQueryList(){const{data:h}=this.props,y=h.series,b=[];if(y?.length){let D;y.forEach((P,C)=>{const M=P.meta?.executedQueryString;if(M){const I=P.refId||"?";D?.refId===I?(D.frames++,D.rows+=P.length):(D={refId:I,frames:0,rows:P.length,query:M},b.push(D))}})}this.setState({executedQueries:b})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(h){h.config?.hideFromInspector||(h={...h},h.headers&&delete h.headers,h.config&&(h.request=h.config,delete h.config,delete h.request.transformRequest,delete h.request.transformResponse,delete h.request.paramSerializer,delete h.request.jsonpCallbackParam,delete h.request.headers,delete h.request.requestId,delete h.request.inspect,delete h.request.retry,delete h.request.timeout),h.data&&(h.response=h.data,delete h.config,delete h.data,delete h.status,delete h.statusText,delete h.ok,delete h.url,delete h.redirected,delete h.type,delete h.$$config),this.setState({response:h}))}renderExecutedQueries(h){if(!h.length)return null;const y={refId:(0,s.css)`
        font-weight: ${o.$.theme.typography.weight.semibold};
        color: ${o.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return(0,n.jsx)("div",{children:h.map(b=>(0,n.jsxs)(d.B,{gap:1,direction:"column",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:y.refId,children:[b.refId,":"]}),b.frames>1&&(0,n.jsxs)("span",{children:[b.frames," frames, "]}),(0,n.jsxs)("span",{children:[b.rows," rows"]})]}),(0,n.jsx)("pre",{children:b.query})]},b.refId))})}render(){const{allNodesExpanded:h,executedQueries:y,response:b}=this.state,{onRefreshQuery:D,data:P}=this.props,C=this.getNrOfOpenNodes(),M=(0,x.A)(o.$.theme2),I=Object.keys(b).length>0,R=P.state===i.Gu.Loading;return(0,n.jsxs)("div",{className:M.wrap,children:[(0,n.jsxs)("div",{"aria-label":g.Tp.components.PanelInspector.Query.content,children:[(0,n.jsx)("h3",{className:M.heading,children:"Query inspector"}),(0,n.jsx)("p",{className:"small muted",children:(0,n.jsx)(m.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(y),(0,n.jsxs)("div",{className:M.toolbar,children:[(0,n.jsx)(c.$n,{icon:"sync",onClick:D,"aria-label":g.Tp.components.PanelInspector.Query.refreshButton,children:(0,n.jsx)(m.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),I&&h&&(0,n.jsx)(c.$n,{icon:"minus",variant:"secondary",className:M.toolbarItem,onClick:this.onToggleExpand,children:(0,n.jsx)(m.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),I&&!h&&(0,n.jsx)(c.$n,{icon:"plus",variant:"secondary",className:M.toolbarItem,onClick:this.onToggleExpand,children:(0,n.jsx)(m.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),I&&(0,n.jsx)(a.b,{getText:this.getTextForClipboard,className:M.toolbarItem,icon:"copy",variant:"secondary",children:(0,n.jsx)(m.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})}),(0,n.jsx)("div",{className:"flex-grow-1"})]}),(0,n.jsxs)("div",{className:M.content,children:[R&&(0,n.jsx)(p._,{text:"Loading query inspector..."}),!R&&I&&(0,n.jsx)(u.B,{json:b,open:C,onDidRender:this.setFormattedJson}),!R&&!I&&(0,n.jsx)("p",{className:"muted",children:(0,n.jsx)(m.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},26323:(k,A,e)=>{"use strict";e.d(A,{A:()=>i,c:()=>r});var n=e(32196),s=e(3911),l=e(2913);const r=(0,s.N)(()=>i(l.config.theme2)),i=g=>({heading:(0,n.css)({fontSize:g.typography.body.fontSize,marginBottom:g.spacing(1)}),wrap:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,n.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:g.v1.spacing.sm}),toolbarItem:(0,n.css)({marginLeft:g.v1.spacing.md}),content:(0,n.css)({flexGrow:1,height:"100%"}),editor:(0,n.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,n.css)({overflow:"scroll"}),dataFrameSelect:(0,n.css)({flexGrow:2}),leftActions:(0,n.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,n.css)({paddingTop:g.v1.spacing.sm}),dataDisplayOptions:(0,n.css)({flexGrow:1,minWidth:"300px",marginRight:g.v1.spacing.sm}),selects:(0,n.css)({display:"flex","> *":{marginRight:g.v1.spacing.sm}})})},16560:(k,A,e)=>{"use strict";e.d(A,{q:()=>n});var n=(s=>(s.Data="data",s.Meta="meta",s.Error="error",s.Stats="stats",s.JSON="json",s.Query="query",s.Help="help",s))(n||{})},18358:(k,A,e)=>{"use strict";e.d(A,{ny:()=>N,EM:()=>j,Zy:()=>O,ek:()=>F});var n=e(4213),s=e.n(n),l=e(72724),r=e(18282),i=e(72436),g=e(37471),o=e(19071),d=e(2543);const a=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function p(){return defaultConfig}function u(U){return _get(p(),U)}function m(U){let w;const B=new Set(U.map(({spanID:K})=>K));for(let K=0;K<U.length;K++){if(U[K].references&&U[K].references.some(({traceID:X,spanID:q})=>X===U[K].traceID&&B.has(q)))continue;if(!w){w=U[K];continue}const z=U[K].references&&U[K].references.length||0,Y=w.references&&w.references.length||0;(z<Y||z===Y&&U[K].startTime<w.startTime)&&(w=U[K])}return w?`${w.process.serviceName}: ${w.operationName}`:""}const v=(0,d.memoize)(m,U=>U.length?U[0].traceID:0);function x(U){const w=new Map,B=U.reduce((W,z)=>(W.some(Y=>Y.key===z.key&&Y.value===z.value)?w.set(`${z.key}:${z.value}`,`Duplicate tag "${z.key}:${z.value}"`):W.push(z),W),[]),K=Array.from(w.values());return{dedupedTags:B,warnings:K}}function f(U,w){const B=U?.slice()??[],K=(w||[]).map(W=>W.toLowerCase());return B.sort((W,z)=>{const Y=W.key.toLowerCase(),X=z.key.toLowerCase();for(let q=0;q<K.length;q++){const G=K[q];if(Y.startsWith(G)&&!X.startsWith(G))return-1;if(!Y.startsWith(G)&&X.startsWith(G))return 1}return Y>X?1:Y<X?-1:0}),B}function E(U){if(!U?.traceID)return null;const w=U.traceID.toLowerCase();let B=0,K=Number.MAX_SAFE_INTEGER;const W=new Map,z=new Map;U.spans=U.spans.filter(se=>!!se.startTime),U.processes=Object.entries(U.processes).reduce((se,[ne,le])=>(se[ne]={...le,tags:f(le.tags)},se),{});const Y=U.spans.length;for(let se=0;se<Y;se++){const ne=U.spans[se],{startTime:le,duration:_,processID:Q}=ne;let ae=ne.spanID;le<K&&(K=le),le+_>B&&(B=le+_);const oe=W.get(ae);oe!=null?(console.warn(`Dupe spanID, ${oe+1} x ${ae}`,ne,z.get(ae)),_isEqual(ne,z.get(ae))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),W.set(ae,oe+1),ae=`${ae}_${oe}`,ne.spanID=ae):W.set(ae,1),ne.process=U.processes[Q],z.set(ae,ne)}const X=getTraceSpanIdsAsTree(U,z),q=[],G={};X.walk((se,ne,le=0)=>{if(se==="__root__"||typeof se!="string")return;const _=z.get(se);if(!_)return;const{serviceName:Q}=_.process;G[Q]=(G[Q]||0)+1,_.relativeStartTime=_.startTime-K,_.depth=le-1,_.hasChildren=ne.children.length>0,_.childSpanCount=ne.children.length,_.warnings=_.warnings||[],_.tags=_.tags||[],_.references=_.references||[],_.childSpanIds=ne.children.slice().sort((oe,J)=>{const ee=z.get(oe.value),de=z.get(J.value);return de.startTime+de.duration-(ee.startTime+ee.duration)}).map(oe=>oe.value);const ae=x(_.tags);_.tags=f(ae.dedupedTags,getConfigValue("topTagPrefixes")),_.warnings=_.warnings.concat(ae.warnings),_.references.forEach((oe,J)=>{const ee=z.get(oe.spanID);ee&&(oe.span=ee,J>0&&(ee.subsidiarilyReferencedBy=ee.subsidiarilyReferencedBy||[],ee.subsidiarilyReferencedBy.push({spanID:se,traceID:w,span:_,refType:oe.refType})))}),q.push(_)});const te=getTraceName(q);return{services:Object.keys(G).map(se=>({name:se,numberOfSpans:G[se]})),spans:q,traceID:w,traceName:te,processes:U.processes,duration:B-K,startTime:K,endTime:B}}function h(U){const w=U.spans.map(K=>y(K,U.processes)),B=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const K of w)B.add(K);return B}function y(U,w){return{spanID:U.spanID,traceID:U.traceID,parentSpanID:U.references?.find(B=>B.refType==="CHILD_OF")?.spanID,operationName:U.operationName,startTime:U.startTime/1e3,duration:U.duration/1e3,logs:U.logs.map(B=>({...B,timestamp:B.timestamp/1e3})),tags:U.tags,warnings:U.warnings??void 0,stackTraces:U.stackTraces,serviceName:w[U.processID].serviceName,serviceTags:w[U.processID].tags}}function b(U,w){const B=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),K=U.map(D).sort((W,z)=>z?.startTime-W?.startTime);for(const W of K)B.add(W);return B}function D(U){const w=transformTraceData(U);if(w)return{traceID:w.traceID,startTime:w.startTime/1e3,duration:w.duration,traceName:w.traceName}}function P(U){let w={traceID:"",spans:[],processes:{},warnings:null},B=[];for(let K=0;K<U.length;K++){const W=U.get(K);w.traceID||(w.traceID=W.traceID),B.find(z=>z===W.serviceName)||(B.push(W.serviceName),w.processes[`p${B.length}`]={serviceName:W.serviceName,tags:W.serviceTags}),w.spans.push({traceID:W.traceID,spanID:W.spanID,duration:W.duration*1e3,references:W.parentSpanID?[{refType:"CHILD_OF",spanID:W.parentSpanID,traceID:W.traceID}]:[],flags:0,logs:W.logs.map(z=>({...z,timestamp:z.timestamp*1e3})),operationName:W.operationName,processID:Object.keys(w.processes).find(z=>w.processes[z].serviceName===W.serviceName)||"",startTime:W.startTime*1e3,tags:W.tags,warnings:W.warnings?W.warnings:null})}return{data:[w],total:0,limit:0,offset:0,errors:null}}function C(U){const w=U.map(M),B=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const K of w)B.add(K);return B}function M(U){const w={traceID:U.traceId,spanID:U.id,parentSpanID:U.parentId,operationName:U.name,serviceName:U.localEndpoint?.serviceName||U.remoteEndpoint?.serviceName||"unknown",serviceTags:R(U),startTime:U.timestamp/1e3,duration:U.duration/1e3,logs:U.annotations?.map(I)??[],tags:Object.keys(U.tags||{}).reduce((B,K)=>K==="error"?(B.push({key:"error",value:!0}),B.push({key:"errorValue",value:U.tags.error}),B):(B.push({key:K,value:U.tags[K]}),B),[])};return U.kind&&(w.tags=[{key:"kind",value:U.kind},...w.tags??[]]),U.shared&&(w.tags=[{key:"shared",value:U.shared},...w.tags??[]]),w}function I(U){return{timestamp:U.timestamp,fields:[{key:"annotation",value:U.value}]}}function R(U){const w=U.localEndpoint||U.remoteEndpoint;return w?[T("ipv4",w.ipv4),T("ipv6",w.ipv6),T("port",w.port),T("endpointType",U.localEndpoint?"local":"remote")].filter(B=>!!B):[]}function T(U,w){if(w)return{key:U,value:w}}const S=U=>{let w=[];for(let B=0;B<U.length;B++){const K=U.get(B);w.push({traceId:K.traceID,parentId:K.parentSpanID,name:K.operationName,id:K.spanID,timestamp:K.startTime*1e3,duration:K.duration*1e3,...L(K),annotations:K.logs.length?K.logs.map(W=>({timestamp:W.timestamp,value:W.fields[0].value})):void 0,tags:K.tags.length?K.tags.filter(W=>W.key!=="kind"&&W.key!=="endpointType"&&W.key!=="shared").reduce((W,z)=>z.key==="error"?{...W,[z.key]:K.tags.find(Y=>Y.key==="errorValue").value||""}:{...W,[z.key]:z.value},{}):void 0,kind:K.tags.find(W=>W.key==="kind")?.value,shared:K.tags.find(W=>W.key==="shared")?.value})}return w},L=U=>{const w=U.serviceTags.find(B=>B.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return U.serviceName!=="unknown"?{[w]:{serviceName:U.serviceName,ipv4:U.serviceTags.find(B=>B.key==="ipv4")?.value,ipv6:U.serviceTags.find(B=>B.key==="ipv6")?.value,port:U.serviceTags.find(B=>B.key==="port")?.value}}:void 0};function O(U,w){let B="";U.meta?.forEach(z=>{const Y=`${z.label}: ${JSON.stringify(z.value)}
`;B=B+Y}),B=B+`

`,U.rows.forEach(z=>{const Y=(0,l.LE)(z.timeEpochMs,{defaultWithMS:!0})+"	"+z.entry+`
`;B=B+Y});const K=new Blob([B],{type:"text/plain;charset=utf-8"}),W=`${w}-logs-${(0,l.LE)(new Date)}.txt`;s()(K,W)}function j(U,w,B,K=r.F.noop){const W=(0,i._O)([U],B),z=B?.useExcelHeader?"\uFEFF":"",Y=new Blob([z,W],{type:"text/csv;charset=utf-8"}),X=K!==r.F.noop?"-as-"+K.toLocaleLowerCase():"",q=`${w}-data${X}-${(0,l.LE)(new Date)}.csv`;s()(Y,q)}function N(U,w){const B=new Blob([JSON.stringify(U)],{type:"application/json"}),K=`${w}-${(0,l.LE)(new Date)}.json`;s()(B,K)}function F(U,w){let B="otlp";switch(U.meta?.custom?.traceFormat){case"jaeger":{let K=P(new g.k(U));N(K,w),B="jaeger";break}case"zipkin":{let K=S(new g.k(U));N(K,w),B="zipkin";break}case"otlp":default:{let K=(0,o.xw)(new g.k(U));N(K,w);break}}return B}},77938:(k,A,e)=>{"use strict";e.d(A,{p:()=>l});var n=e(26272),s=e(28138);function l(i){let g="";try{g=JSON.stringify(i,r(),2)}catch(o){o instanceof Error&&(o.toString().includes("RangeError")||o.toString().includes("allocation size overflow"))?s.A.emit(n.r1.alertError,[o.toString(),"Cannot display JSON, the object is too big."]):s.A.emit(n.r1.alertError,[o instanceof Error?o.toString():o])}return g}function r(){const i=new WeakSet;return(g,o)=>{if(g==="__dataContext"||g==="__sceneObject")return"Filtered out in JSON serialization";if(typeof o=="object"&&o!==null){if(i.has(o))return;i.add(o)}return o}}},47259:(k,A,e)=>{"use strict";e.d(A,{G7:()=>r,KU:()=>i,eb:()=>g});var n=e(17172),s=e(10096),l=e(31678);const r=(0,l.createAsyncThunk)("users/fetchInvitees",async()=>s.contextSrv.hasPermission(l.AccessControlAction.OrgUsersAdd)?await(0,n.AI)().get("/api/org/invites"):[]),i=(0,l.createAsyncThunk)("users/addInvitee",async(o,{dispatch:d})=>{await(0,n.AI)().post("/api/org/invites",o),await d(r())}),g=(0,l.createAsyncThunk)("users/revokeInvite",async o=>(await(0,n.AI)().patch(`/api/org/invites/${o}/revoke`,{}),o))},40823:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>d,Tp:()=>r});var n=e(65307),s=e(47259);const l=(0,n.pU)({selectId:c=>c.code}),r=l.getSelectors(),i=l.getInitialState({status:"idle"}),d={invites:(0,n.Z0)({name:"invites",initialState:i,reducers:{},extraReducers:c=>{c.addCase(s.G7.pending,a=>{a.status="loading"}).addCase(s.G7.fulfilled,(a,{payload:p})=>{l.setAll(a,p),a.status="succeeded"}).addCase(s.G7.rejected,a=>{a.status="failed"}).addCase(s.eb.fulfilled,(a,{payload:p})=>{l.removeOne(a,p),a.status="succeeded"})}}).reducer}},96227:(k,A,e)=>{"use strict";e.d(A,{b:()=>v,o:()=>x});var n=e(74848),s=e(96540),l=e(40996),r=e(16817),i=e(17172),g=e(88575),o=e(10354),d=e(37390),c=e(55852),a=e(36607),p=e(8484),u=e(57767),m=e(88861);const v=({panel:f,initialFolderUid:E,onCreateLibraryPanel:h,onDismiss:y})=>{const[b,D]=(0,s.useState)(E),[P,C]=(0,s.useState)(f.title),[M,I]=(0,s.useState)(f.title),[R,T]=(0,s.useState)(!1);(0,s.useEffect)(()=>T(!0),[P]),(0,l.A)(()=>I(P),350,[P]);const{saveLibraryPanel:S}=(0,m.b)(),L=(0,s.useCallback)(()=>{f.libraryPanel={uid:"",name:P},S(f,b).then(N=>{(0,i.NF)(N)?f.libraryPanel=void 0:(y?.(),h?.(N))})},[f,P,S,b,y,h]),O=(0,r.A)(async()=>{try{return!(await(0,u.e9)(P)).some(N=>N.folderUid===b)}catch(N){return(0,i.NF)(N)&&(N.isHandled=!0),!0}finally{T(!1)}},[M,b]);console.log("isValidName:",O);const j=!O?.value&&O.value!==void 0&&P===M&&!R;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{label:(0,p.t)("library-panel.add-modal.name","Library panel name"),invalid:j,error:j?(0,p.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,n.jsx)(o.p,{id:"share-panel-library-panel-name-input",name:"name",value:P,onChange:N=>C(N.currentTarget.value)})}),(0,n.jsx)(g.D,{label:(0,p.t)("library-panel.add-modal.folder","Save in folder"),description:(0,p.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,n.jsx)(a.d,{onChange:N=>D(N),value:b,inputId:"share-panel-library-panel-folder-picker"})}),(0,n.jsxs)(d.a.ButtonRow,{children:[(0,n.jsx)(c.$n,{variant:"secondary",onClick:y,fill:"outline",children:(0,n.jsx)(p.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,n.jsx)(c.$n,{onClick:L,disabled:j,children:(0,n.jsx)(p.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},x=({isOpen:f=!1,panel:E,initialFolderUid:h,...y})=>(0,n.jsx)(d.a,{title:"Create library panel",isOpen:f,onDismiss:y.onDismiss,children:(0,n.jsx)(v,{panel:E,initialFolderUid:h,onDismiss:y.onDismiss})})},86474:(k,A,e)=>{"use strict";e.d(A,{E:()=>L});var n=e(74848),s=e(32196),l=e(96540),r=e(70255),i=e(32264),g=e(40845),o=e(14578),d=e(50720),c=e(72129),a=e(41394),p=e(25701),u=e(39070),m=e(37390),v=e(55852),x=e(43535),f=e(16547),E=e(57767),h=e(65307);const y={loadingState:u.Gu.Loading,dashboardTitles:[]},b=(0,h.VP)("libraryPanels/delete/searchCompleted"),D=(N=y,F)=>b.match(F)?{...N,dashboardTitles:F.payload.dashboards.map(U=>U.title),loadingState:u.Gu.Done}:N;function P(N){return async function(F){const U=await(0,E.xV)(N.uid);F(b({dashboards:U}))}}const C=({libraryPanel:N,onDismiss:F,onConfirm:U})=>{const w=(0,g.of)(x.o),[{dashboardTitles:B,loadingState:K},W]=(0,l.useReducer)(D,y),z=(0,l.useMemo)(()=>(0,f.QC)(W),[W]);(0,l.useEffect)(()=>{z(P(N))},[z,N]);const Y=!!B.length,X=K===u.Gu.Done;return(0,n.jsxs)(m.a,{className:w.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:F,isOpen:!0,children:[X?null:(0,n.jsx)(M,{}),X?(0,n.jsxs)("div",{children:[Y?(0,n.jsx)(R,{dashboardTitles:B}):null,Y?null:(0,n.jsx)(I,{}),(0,n.jsxs)(m.a.ButtonRow,{children:[(0,n.jsx)(v.$n,{variant:"secondary",onClick:F,fill:"outline",children:"Cancel"}),(0,n.jsx)(v.$n,{variant:"destructive",onClick:U,disabled:Y,children:"Delete"})]})]}):null]})},M=()=>(0,n.jsx)("span",{children:"Loading library panel..."}),I=()=>{const N=(0,g.of)(x.o);return(0,n.jsx)("div",{className:N.modalText,children:"Do you want to delete this panel?"})},R=({dashboardTitles:N})=>{const F=(0,g.of)(x.o),U=N.length===1?"dashboard.":"dashboards.",w=`${N.length} ${U}`;return N.length===0?null:(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:F.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,n.jsx)("strong",{children:w})," Remove the library panel from the dashboards listed below and retry."]}),(0,n.jsxs)("table",{className:F.myTable,children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("th",{children:"Dashboard name"})})}),(0,n.jsx)("tbody",{children:N.map((B,K)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:B})},`dash-title-${K}`))})]})]})},T=({libraryPanel:N,onClick:F,onDelete:U,showSecondaryActions:w})=>{const[B,K]=(0,l.useState)(!1),W=()=>{U?.(N),K(!1)},z=i.$.panels[N.model.type]??(0,a.$)(N.model.type).meta;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.b,{isCurrent:!1,title:N.name,description:N.description,plugin:z,onClick:()=>F?.(N),onDelete:w?()=>K(!0):void 0,children:(0,n.jsx)(O,{libraryPanel:N})}),B&&(0,n.jsx)(C,{libraryPanel:N,onConfirm:W,onDismiss:()=>K(!1)})]})},S=({showSecondaryActions:N,rootProps:F})=>{const U=(0,g.of)(j);return(0,n.jsx)(p.b.Skeleton,{hasDelete:N,...F,children:(0,n.jsx)(r.A,{containerClassName:U.metaContainer,width:80})})},L=(0,c.j)(T,S);function O({libraryPanel:N}){const F=(0,g.of)(j);return!N.meta?.folderUid&&!N.meta?.folderName?null:N.meta.folderUid?(0,n.jsx)("span",{className:F.metaContainer,children:(0,n.jsxs)(d.N,{href:`/dashboards/f/${N.meta.folderUid}`,children:[(0,n.jsx)(o.I,{name:"folder-upload",size:"sm"}),(0,n.jsx)("span",{children:N.meta.folderName})]})}):(0,n.jsxs)("span",{className:F.metaContainer,children:[(0,n.jsx)(o.I,{name:"folder",size:"sm"}),(0,n.jsx)("span",{children:"Dashboards"})]})}function j(N){return{metaContainer:(0,s.css)({display:"flex",alignItems:"center",color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize,paddingTop:N.spacing(.5),svg:{marginRight:N.spacing(.5),marginBottom:3}})}}},16678:(k,A,e)=>{"use strict";e.d(A,{j:()=>M,s:()=>C});var n=e(74848),s=e(32196),l=e(96540),r=e(40996),i=e(40845),g=e(66864),o=e(67647),d=e(76459),c=e.n(d),a=e(55852),p=e(90182),u=e(14578),m=e(27677),v=e(64161),x=e(31678);function f({onChange:S,maxMenuHeight:L}){const O=(0,i.of)(h),[j,N]=(0,l.useState)(!1),F=(0,l.useCallback)(W=>E(W,N),[]),U=(0,l.useMemo)(()=>c()(F,300),[F]),[w,B]=(0,l.useState)([]),K=(0,l.useCallback)(W=>{const z=W.filter(Y=>!!Y.value).map(Y=>Y.value);S(z),B(W)},[S]);return(0,n.jsxs)("div",{className:O.container,children:[w.length>0&&(0,n.jsx)(a.$n,{size:"xs",icon:"trash-alt",fill:"text",className:O.clear,onClick:()=>S([]),"aria-label":"Clear folders",children:"Clear folders"}),(0,n.jsx)(p.Iv,{value:w,onChange:K,isLoading:j,loadOptions:U,maxMenuHeight:L,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:(0,n.jsx)(u.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0})]})}async function E(S,L){L(!0);const O={query:S,type:v.G.DashFolder,permission:x.PermissionLevelString.View},N=(await(0,m.AI)().search(O)).map(F=>({label:F.title,value:{uid:F.uid,title:F.title}}));return(!S||"dashboards".includes(S.toLowerCase()))&&N.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),L(!1),N}function h(S){return{container:(0,s.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,s.css)({label:"clear",fontSize:S.spacing(1.5),position:"absolute",top:-S.spacing(4.5),right:0})}}var y=e(68313),b=e(73725),D=e(15054),P=e(83791),C=(S=>(S.Tight="tight",S.Spacious="spacious",S))(C||{});const M=({onClick:S,variant:L="spacious",currentPanelId:O,currentFolderUID:j,perPage:N=D.FG,showPanelFilter:F=!1,showFolderFilter:U=!1,showSort:w=!1,showSecondaryActions:B=!1})=>{const K=(0,i.of)(I,L),[W,z]=(0,l.useState)(""),[Y,X]=(0,l.useState)("");(0,r.A)(()=>X(W),200,[W]);const[q,G]=(0,l.useState)({}),[te,H]=(0,l.useState)(j?[j]:[]),[se,ne]=(0,l.useState)([]),le=w||F||U,_=L==="tight"?"lg":"xs";return(0,n.jsx)("div",{className:K.container,children:(0,n.jsxs)(g.gW,{spacing:_,children:[(0,n.jsxs)("div",{className:(0,s.cx)(K.gridContainer,{[K.tightLayout]:L==="tight"}),children:[(0,n.jsx)("div",{className:K.filterInputWrapper,children:(0,n.jsx)(o.Z,{value:W,onChange:z,placeholder:"Search by name or description",width:0,escapeRegex:!1})}),le&&(0,n.jsx)(R,{showSort:w,showPanelFilter:F,showFolderFilter:U,onSortChange:G,onFolderFilterChange:H,onPanelFilterChange:ne,sortDirection:q.value,variant:L})]}),(0,n.jsx)("div",{className:K.libraryPanelsView,children:(0,n.jsx)(P.y,{onClickCard:S,searchString:Y,sortDirection:q.value,panelFilter:se,folderFilter:te,currentPanelId:O,showSecondaryActions:B,perPage:N})})]})})};function I(S,L){return{filterInputWrapper:(0,s.css)({flexGrow:L==="tight"?1:"initial"}),container:(0,s.css)({width:"100%",overflowY:"auto",padding:S.spacing(1)}),libraryPanelsView:(0,s.css)({width:"100%"}),gridContainer:(0,s.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:S.spacing(1),rowGap:S.spacing(1),paddingBottom:S.spacing(2)}),tightLayout:(0,s.css)({flexDirection:"row",rowGap:S.spacing(1)})}}const R=(0,l.memo)(({variant:S="spacious",showSort:L,showPanelFilter:O,showFolderFilter:j,sortDirection:N,onSortChange:F,onFolderFilterChange:U,onPanelFilterChange:w})=>{const B=(0,i.of)(T),K=(0,l.useCallback)(z=>w(z.map(Y=>Y.id)),[w]),W=(0,l.useCallback)(z=>U(z.map(Y=>Y.uid??"")),[U]);return(0,n.jsxs)("div",{className:(0,s.cx)(B.container,{[B.containerTight]:S==="tight"}),children:[L&&(0,n.jsx)(b.r,{value:N,onChange:F,filter:["alpha-asc","alpha-desc"]}),(j||O)&&(0,n.jsxs)("div",{className:(0,s.cx)(B.filterContainer,{[B.filterContainerTight]:S==="tight"}),children:[j&&(0,n.jsx)(f,{onChange:W}),O&&(0,n.jsx)(y.$,{onChange:K})]})]})});R.displayName="SearchControls";function T(S){return{container:(0,s.css)({display:"flex",gap:S.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,s.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,s.css)({display:"flex",flexDirection:"row",gap:S.spacing(1)}),filterContainerTight:(0,s.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(k,A,e)=>{"use strict";e.d(A,{y:()=>x});var n=e(74848),s=e(32196),l=e(96540),r=e(40996),i=e(39070),g=e(40845),o=e(69529),d=e(72109),c=e(67061),a=e(19384),p=e(8484),u=e(86474),m=e(16547),v=e(8184);const x=({onClickCard:E,searchString:h,sortDirection:y,panelFilter:b,folderFilter:D,showSecondaryActions:P,currentPanelId:C,perPage:M=40,isWidget:I})=>{const R=(0,g.of)(f),[{libraryPanels:T,page:S,perPage:L,numberOfPages:O,loadingState:j,currentPanelId:N},F]=(0,l.useReducer)(v.w_,{...v.Xb,currentPanelId:C,perPage:M}),U=(0,l.useMemo)(()=>(0,m.QC)(F),[F]);(0,r.A)(()=>U((0,m.IF)({searchString:h,sortDirection:y,panelFilter:b,folderFilterUIDs:D,page:S,perPage:L,currentPanelId:N,isWidget:I})),300,[h,y,b,D,S,U]);const w=({uid:W})=>U((0,m.h4)(W,{searchString:h,sortDirection:y,panelFilter:b,folderFilterUIDs:D,page:S,perPage:L})),B=W=>U((0,v.yd)({page:W}));return!(h||b?.length||D?.length)&&j===i.Gu.Done&&T.length<1?(0,n.jsx)(o.p,{variant:"call-to-action",message:(0,p.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,n.jsxs)(p.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,n.jsx)(d.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,n.jsxs)(c.B,{direction:"column",wrap:"nowrap",children:[j===i.Gu.Loading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.E.Skeleton,{showSecondaryActions:P}),(0,n.jsx)(u.E.Skeleton,{showSecondaryActions:P}),(0,n.jsx)(u.E.Skeleton,{showSecondaryActions:P})]}):T.length<1?(0,n.jsx)(o.p,{variant:"not-found",message:(0,p.t)("library-panels.empty-state.message","No library panels found")}):T?.map((W,z)=>(0,n.jsx)(u.E,{libraryPanel:W,onDelete:w,onClick:E,showSecondaryActions:P},`library-panel=${z}`)),T.length?(0,n.jsx)("div",{className:R.pagination,children:(0,n.jsx)(a.d,{currentPage:S,numberOfPages:O,onNavigate:B,hideWhenSinglePage:!0})}):null]})},f=E=>({pagination:(0,s.css)({alignSelf:"center",marginTop:E.spacing(1)})})},16547:(k,A,e)=>{"use strict";e.d(A,{IF:()=>f,QC:()=>h,h4:()=>E});var n=e(64423),s=e(65474),l=e(62467),r=e(44240),i=e(39697),g=e(69862),o=e(66847),d=e(69850),c=e(1005),a=e(65961),p=e(67791),u=e(32264),m=e(17706),v=e(57767),x=e(8184);function f(y){const b=(P,C)=>P.id===C.type,D=(P,C)=>{const M=(0,m.A4)();return P.filter(I=>{const R=M.find(T=>b(T,I));return C?!!R?.skipDataQuery:!R?.skipDataQuery})};return function(P){const C=new n.yU,M=(0,s.H)((0,v.dq)({searchString:y.searchString,perPage:y.perPage,page:y.page,excludeUid:y.currentPanelId,sortDirection:y.sortDirection,typeFilter:y.panelFilter,folderFilterUIDs:y.folderFilterUIDs})).pipe((0,g.Z)(I=>{const{elements:R}=I;if(u.$.featureToggles.vizAndWidgetSplit&&y.isWidget!==void 0){const T=D(R,y.isWidget);return(0,l.of)({...I,elements:T})}return(0,l.of)({...I,elements:R})}),(0,g.Z)(({perPage:I,elements:R,page:T,totalCount:S})=>(0,l.of)((0,x.c4)({libraryPanels:R,page:T,perPage:I,totalCount:S}))),(0,o.W)(I=>(console.error(I),(0,l.of)((0,x.c4)({...x.Xb,page:y.page,perPage:y.perPage})))),(0,d.j)(()=>C.unsubscribe()),(0,c.u)());C.add((0,r.h)((0,i.O)(50).pipe((0,a.u)((0,x.d9)()),(0,p.Q)(M)),M).subscribe(P))}}function E(y,b){return async function(D){try{await(0,v.h4)(y),f(b)(D)}catch(P){console.error(P)}}}function h(y){return function(b){return b instanceof Function?b(y):y(b)}}},8184:(k,A,e)=>{"use strict";e.d(A,{Xb:()=>l,c4:()=>i,d9:()=>r,w_:()=>o,yd:()=>g});var n=e(65307),s=e(39070);const l={loadingState:s.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},r=(0,n.VP)("libraryPanels/view/initSearch"),i=(0,n.VP)("libraryPanels/view/searchCompleted"),g=(0,n.VP)("libraryPanels/view/changePage"),o=(d,c)=>{if(r.match(c))return{...d,loadingState:s.Gu.Loading};if(i.match(c)){const{libraryPanels:a,page:p,perPage:u,totalCount:m}=c.payload,v=Math.ceil(m/u);return{...d,libraryPanels:a,perPage:u,totalCount:m,loadingState:s.Gu.Done,numberOfPages:v,page:p>v?p-1:p}}return g.match(c)?{...d,page:c.payload.page}:d}},82792:(k,A,e)=>{"use strict";e.d(A,{X:()=>n});function n(s){return!!s.libraryPanel?.uid}},57767:(k,A,e)=>{"use strict";e.d(A,{GN:()=>v,GX:()=>E,Yr:()=>c,d7:()=>p,dq:()=>d,e9:()=>a,h4:()=>m,jc:()=>u,xV:()=>x});var n=e(75505),s=e(79422),l=e(34214),r=e(41507),i=e(20455),g=e(27677),o=e(98796);async function d({searchString:h="",perPage:y=100,page:b=1,excludeUid:D="",sortDirection:P="",typeFilter:C=[],folderFilterUIDs:M=[]}={}){const I=new URLSearchParams;I.append("searchString",h),I.append("sortDirection",P),I.append("typeFilter",C.join(",")),I.append("folderFilterUIDs",M.join(",")),I.append("excludeUid",D),I.append("perPage",y.toString(10)),I.append("page",b.toString(10)),I.append("kind",o.i.Panel.toString(10));const{result:R}=await(0,g.AI)().get(`/api/library-elements?${I.toString()}`);return R}async function c(h,y=!1){const b=await(0,n.s)((0,g.AI)().fetch({method:"GET",url:`/api/library-elements/${h}`,showSuccessAlert:!y,showErrorAlert:!y})),{result:D}=b.data,P=new l.G({...s.Ye,schemaVersion:35,panels:[D.model]}),{scopedVars:C,...M}=P.panels[0].getSaveModel();return delete M.gridPos,delete M.id,delete M.libraryPanel,P.destroy(),{...D,model:M}}async function a(h){const{result:y}=await(0,g.AI)().get(`/api/library-elements/name/${h}`);return y}async function p(h,y){const{result:b}=await(0,g.AI)().post("/api/library-elements",{folderUid:y,name:h.libraryPanel.name,model:h,kind:o.i.Panel});return b}async function u(h){const{libraryPanel:y,...b}=h,{uid:D,name:P,version:C,folderUid:M}=y,I=o.i.Panel,{result:R}=await(0,g.AI)().patch(`/api/library-elements/${D}`,{folderUid:M,name:P,model:b,version:C,kind:I});return R}function m(h){return(0,g.AI)().delete(`/api/library-elements/${h}`)}async function v(h){const{result:y}=await(0,g.AI)().get(`/api/library-elements/${h}/connections`);return y}async function x(h){const y=await v(h);return y.length===0?[]:await(0,g.AI)().search({dashboardUIDs:y.map(D=>D.connectionUid)})}function f(h){const{panel:y,uid:b,name:D,_loadedPanel:P}=h.state,C=h.parent;if(!C||!(C instanceof r.U))throw new Error("LibraryVizPanel must be a child of DashboardGridItem");return{uid:b,folderUID:P?.folderUid,name:D,version:P?.version||0,model:(0,i.Z6)(y,{x:C.state.x??0,y:C.state.y??0,w:C.state.width??0,h:C.state.height??0},!1,C),kind:o.i.Panel}}async function E(h){const{uid:y,folderUID:b,name:D,model:P,version:C,kind:M}=f(h),{result:I}=await(0,g.AI)().patch(`/api/library-elements/${y}`,{folderUID:b,name:D,model:P,version:C,kind:M});return I}},43535:(k,A,e)=>{"use strict";e.d(A,{o:()=>s});var n=e(32196);function s(l){return{myTable:(0,n.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${l.shape.radius.default};
      border: 1px solid ${l.colors.action.hover};
      background: ${l.colors.background.primary};
      color: ${l.colors.text.secondary};
      font-size: ${l.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${l.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${l.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${l.colors.background.secondary};
      }
    `,noteTextbox:(0,n.css)`
      margin-bottom: ${l.spacing(4)};
    `,textInfo:(0,n.css)`
      color: ${l.colors.text.secondary};
      font-size: ${l.typography.size.sm};
    `,dashboardSearch:(0,n.css)`
      margin-top: ${l.spacing(2)};
    `,modal:(0,n.css)`
      width: 500px;
    `,modalText:(0,n.css)`
      font-size: ${l.typography.h4.fontSize};
      color: ${l.colors.text.primary};
      margin-bottom: ${l.spacing(4)};
      padding-top: ${l.spacing(2)};
    `}}},98796:(k,A,e)=>{"use strict";e.d(A,{i:()=>n});var n=(l=>(l[l.Panel=1]="Panel",l))(n||{}),s=(l=>(l[l.Dashboard=1]="Dashboard",l))(s||{})},88861:(k,A,e)=>{"use strict";e.d(A,{b:()=>a});var n=e(5805),s=e(17172),l=e(3169),r=e(8484),i=e(57767);async function g(p,u){const m=o(p),v=await c(m,u);return d(p,v),v}function o(p){let{scopedVars:u,...m}=p.getSaveModel();return m={libraryPanel:{name:p.title,uid:void 0},...m},m}function d(p,u){p.restoreModel({...u.model,configRev:0,libraryPanel:u,title:p.title}),p.hasSavedPanelEditChange=!0,p.refresh()}function c(p,u){return p.libraryPanel?p.libraryPanel&&p.libraryPanel.uid===""?(0,i.d7)(p,u):(0,i.jc)(p):Promise.reject()}const a=()=>{const p=(0,l._2)(),[u,m]=(0,n.default)(async(v,x)=>{try{const f=await g(v,x);return p.success((0,r.t)("library-panels.save.success","Library panel saved")),f}catch(f){throw(0,s.NF)(f)&&(f.isHandled=!0,p.error((0,r.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:f.message??f.data.message}))),f}},[]);return{state:u,saveLibraryPanel:m}}},6473:(k,A,e)=>{"use strict";e.d(A,{t:()=>y});var n=e(62938),s=e(55004),l=e(26272),r=e(78731),i=e(39601),g=e(10096),o=e(28444),d=e(14792),c=e(74848),a=e(32196),p=e(40845),u=e(37390),m=e(55852),v=(b=>(b.Saved="saved",b.EditingStarted="editing-started",b.EditingCanceled="editing-cancelled",b.Deleted="deleted",b))(v||{});function x({onDismiss:b,event:D}){const P=(0,p.of)(f),C=()=>{if(D?.action===v.Deleted){i.Ny.push("/");return}y.reloadPage(),b()};return(0,c.jsxs)(u.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:b,onClickBackdrop:()=>{},className:P.modal,children:[(0,c.jsx)("div",{className:P.description,children:"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"}),(0,c.jsxs)(u.a.ButtonRow,{children:[(0,c.jsx)(m.$n,{onClick:b,variant:"secondary",fill:"outline",children:"Continue editing"}),(0,c.jsx)(m.$n,{onClick:C,variant:"destructive",children:"Discard local changes"})]})]})}const f=b=>({modal:(0,a.css)({width:"600px"}),description:(0,a.css)({color:b.colors.text.secondary,paddingBottom:b.spacing(1)})}),E=(0,n.A)();class h{constructor(){this.editing=!1,this.observer={next:D=>{if((0,s.ew)(D)&&this.editing&&D.state===s.ZF.Connected&&this.sendEditingState(),(0,s.Z7)(D)){if(D.message.sessionId===E)return;const{action:P}=D.message;switch(P){case v.EditingStarted:case v.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const C=(0,d.UA)().getCurrent();if(C?.uid!==D.message.uid){console.log("dashboard event for different dashboard?",D,C);return}const M=this.editing||C.hasUnsavedChanges();if(P===v.Saved)M?g.lE.publish(new o.S8({component:x,props:{event:D}})):(g.lE.emit(l.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(M&&P===v.EditingStarted&&!this.hasSeenNotice){const I=D.message,R=this.getRecentEditingEvent();(!R||R.message!==I.message)&&(this.hasSeenNotice=!0,g.lE.emit(l.r1.alertWarning,["Another session is editing this dashboard",I.message])),this.lastEditing=I}return}}}}}}setEditingState(D){const P=this.editing=D;this.editing=D,this.hasSeenNotice=!1,P&&g.contextSrv.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:D,uid:P}=this;D&&P&&(0,r.oF)().publish(D,{sessionId:E,uid:P,action:this.editing?v.EditingStarted:v.EditingCanceled,timestamp:Date.now()})}watch(D){const P=(0,r.oF)();P&&D!==this.uid&&(this.channel={scope:s.qD.Grafana,namespace:"dashboard",path:`uid/${D}`},this.leave(),D&&(this.subscription=P.getStream(this.channel).subscribe(this.observer)),this.uid=D)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){i.Ny.reload()}}const y=new h},47118:(k,A,e)=>{"use strict";e.d(A,{_w:()=>s,o$:()=>g,ot:()=>l});var n=e(14236),s=(o=>(o.NewValuesSameSchema="NewValuesSameSchema",o.FullFrame="FullFrame",o))(s||{});const l=(o,d)=>"type"in o&&o.type===d,r=Object.values(s),i=o=>"type"in o&&r.includes(o.type),g=o=>(0,n.ci)(o)&&"packetInfo"in o},39408:(k,A,e)=>{"use strict";e.d(A,{l:()=>l});var n=e(89667),s=e(17172);async function l(){return(0,s.AI)().get("api/live/list").then(r=>{const i=r.channels??[],g={},o=i.map(d=>{if(d.data){const c=new Set,a=(0,n.or)(d.data);for(const p of a.fields)c.add(p.name);g[d.channel]=Array.from(c).map(p=>({value:p,label:p}))}return{value:d.channel,label:d.channel+" ["+d.minute_rate+" msg/min]"}});return{channelFields:g,channels:o}})}},81073:(k,A,e)=>{"use strict";e.d(A,{I:()=>r});var n=e(74848),s=e(32196),l=e(62930);const r=({adjective:g="newer"})=>{const o=`Loading ${g} logs...`;return(0,n.jsx)("div",{className:i,children:(0,n.jsxs)("div",{children:[o," ",(0,n.jsx)(l.y,{inline:!0})]})})},i=(0,s.css)`
  display: flex;
  justify-content: center;
`},93463:(k,A,e)=>{"use strict";e.d(A,{A:()=>d,h:()=>o});var n=e(74848),s=e(32196),l=e(96540),r=e(40845),i=e(56034);const g=["level","lvl","filename"],o=(0,l.memo)(({labels:p,emptyMessage:u})=>{const m=(0,r.of)(a),v=(0,l.useMemo)(()=>Object.keys(p).filter(x=>!x.startsWith("_")&&!g.includes(x)).sort(),[p]);return v.length===0&&u?(0,n.jsx)("span",{className:(0,s.cx)([m.logsLabels]),children:(0,n.jsx)("span",{className:(0,s.cx)([m.logsLabel]),children:u})}):(0,n.jsx)("span",{className:(0,s.cx)([m.logsLabels]),children:v.map(x=>{const f=p[x];if(!f)return;const E=`${x}=${f}`;return(0,n.jsx)(i.m,{content:E,placement:"top",children:(0,n.jsx)(c,{styles:m,children:E})},x)})})});o.displayName="LogLabels";const d=(0,l.memo)(({labels:p})=>{const u=(0,r.of)(a);return(0,n.jsx)("span",{className:(0,s.cx)([u.logsLabels]),children:p.map(m=>(0,n.jsx)(c,{styles:u,tooltip:m,children:m},m))})});d.displayName="LogLabelsList";const c=(0,l.forwardRef)(({styles:p,tooltip:u,children:m},v)=>(0,n.jsx)("span",{className:(0,s.cx)([p.logsLabel]),ref:v,children:(0,n.jsx)("span",{className:(0,s.cx)([p.logsLabelValue]),title:u,children:m})}));c.displayName="LogLabel";const a=p=>({logsLabels:(0,s.css)`
      display: flex;
      flex-wrap: wrap;
      font-size: ${p.typography.size.xs};
    `,logsLabel:(0,s.css)`
      label: logs-label;
      display: flex;
      padding: ${p.spacing(0,.25)};
      background-color: ${p.colors.background.secondary};
      border-radius: ${p.shape.radius.default};
      margin: ${p.spacing(.125,.5,0,0)};
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `,logsLabelValue:(0,s.css)`
      label: logs-label__value;
      display: inline-block;
      max-width: ${p.spacing(25)};
      text-overflow: ellipsis;
      overflow: hidden;
    `})},85492:(k,A,e)=>{"use strict";e.d(A,{$:()=>a});var n=e(74848),s=e(88838),l=e(96540),r=e(23257),i=e.n(r),g=e(21),o=e(40845);function d(p,u){return u.split(/;\s*/).reduce((m,v)=>{if(v==="color:rgba(0,0,0,0.5)")return{color:p.colors.text.secondary};const x=v.match(/([^:\s]+)\s*:\s*(.+)/);if(x&&x[1]&&x[2]){const f=x[1].replace(/-([a-z])/g,(E,h)=>h.toUpperCase());m[f]=x[2]}return m},{})}class c extends l.PureComponent{constructor(){super(...arguments),this.state={chunks:[],prevValue:""}}static getDerivedStateFromProps(u,m){return u.value===m.prevValue?null:{chunks:s.Ay.parse(u.value).spans.map(x=>x.css?{style:d(u.theme,x.css),text:x.text}:{text:x.text}),prevValue:u.value}}render(){const{chunks:u}=this.state;return u.map((m,v)=>{const x=this.props.highlight?.searchWords?(0,n.jsx)(i(),{textToHighlight:m.text,searchWords:this.props.highlight.searchWords,findChunks:g.Oq,highlightClassName:this.props.highlight.highlightClassName},v):m.text;return m.style?(0,n.jsx)("span",{style:m.style,"data-testid":"ansiLogLine",children:x},v):x})}}const a=(0,o.cV)(c);a.displayName="LogMessageAnsi"},42785:(k,A,e)=>{"use strict";e.d(A,{Q:()=>c});var n=e(74848),s=e(96540),l=e(76885),r=e(71733),i=e(43127),g=e(29158),o=e(10534),d=e(2913);const c=(0,s.memo)(({logText:a,onOpenContext:p,onPermalinkClick:u,onPinLine:m,onUnpinLine:v,pinLineButtonTooltipTitle:x,pinned:f,row:E,showContextToggle:h,styles:y,mouseIsOver:b,onBlur:D,getRowContextQuery:P})=>{const C=h?h(E):!1,M=(0,s.useCallback)(S=>{S.stopPropagation()},[]),I=(0,s.useCallback)(async S=>{if(S.stopPropagation(),P&&(S.nativeEvent.ctrlKey||S.nativeEvent.metaKey||S.nativeEvent.shiftKey)){const L=window.open("about:blank"),O=await P(E,void 0,!1);if(O&&L){const j=l.kM.renderUrl(r.I.assureBaseUrl(`${(0,d.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:O.datasource,queries:[O],range:(0,i.E2)()})});L.location=j;return}L?.close()}p(E)},[p,P,E]),R=(0,s.useCallback)(S=>{!S.currentTarget.contains(S.relatedTarget)&&D&&D()},[D]),T=(0,s.useCallback)(()=>a,[a]);return(0,n.jsxs)("span",{className:`log-row-menu ${y.rowMenu}`,onClick:M,onBlur:R,children:[f&&!b&&(0,n.jsx)(g.K,{className:y.unPinButton,size:"md",name:"gf-pin",onClick:()=>v&&v(E),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),b&&(0,n.jsxs)(n.Fragment,{children:[C&&(0,n.jsx)(g.K,{size:"md",name:"gf-show-context",onClick:I,tooltip:"Show context",tooltipPlacement:"top","aria-label":"Show context",tabIndex:0}),(0,n.jsx)(o.b,{className:y.copyLogButton,icon:"copy",variant:"secondary",fill:"text",size:"md",getText:T,tooltip:"Copy to clipboard",tooltipPlacement:"top",tabIndex:0}),f&&v&&(0,n.jsx)(g.K,{className:y.unPinButton,size:"md",name:"gf-pin",onClick:()=>v&&v(E),tooltip:"Unpin line",tooltipPlacement:"top","aria-label":"Unpin line",tabIndex:0}),!f&&m&&(0,n.jsx)(g.K,{className:y.unPinButton,size:"md",name:"gf-pin",onClick:()=>m&&m(E),tooltip:x??"Pin line",tooltipPlacement:"top","aria-label":"Pin line",tabIndex:0}),u&&E.rowId!==void 0&&E.uid&&(0,n.jsx)(g.K,{tooltip:"Copy shortlink","aria-label":"Copy shortlink",tooltipPlacement:"top",size:"md",name:"share-alt",onClick:()=>u(E),tabIndex:0})]})]})});c.displayName="LogRowMenuCell"},40455:(k,A,e)=>{"use strict";e.d(A,{S:()=>d,a:()=>p});var n=e(74848),s=e(96540),l=e(23257),r=e.n(l),i=e(21),g=e(85492),o=e(42785);const d=1e5,c=({hasAnsi:u,entry:m,highlights:v,styles:x})=>{const f=v&&v.length>0&&v[0]&&v[0].length>0&&m.length<d,E=v??[];if(u){const h=f?{searchWords:E,highlightClassName:x.logsRowMatchHighLight}:void 0;return(0,n.jsx)(g.$,{value:m,highlight:h})}else if(f)return(0,n.jsx)(r(),{textToHighlight:m,searchWords:E,findChunks:i.Oq,highlightClassName:x.logsRowMatchHighLight});return(0,n.jsx)(n.Fragment,{children:m})},a=(u,m,v,x)=>{if(m)try{return JSON.stringify(JSON.parse(u),void 0,2)}catch{}return!v&&!x&&(u=u.replace(/(\r\n|\n|\r)/g,"")),u},p=(0,s.memo)(u=>{const{row:m,wrapLogMessage:v,prettifyLogMessage:x,showContextToggle:f,styles:E,onOpenContext:h,onPermalinkClick:y,onUnpinLine:b,onPinLine:D,pinLineButtonTooltipTitle:P,pinned:C,mouseIsOver:M,onBlur:I,getRowContextQuery:R,expanded:T}=u,{hasAnsi:S,raw:L}=m,O=(0,s.useMemo)(()=>a(L,x,v,!!T),[L,x,v,T]),j=(0,s.useMemo)(()=>M||C,[M,C]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{className:E.logsRowMessage,children:(0,n.jsx)("div",{className:v?E.positionRelative:E.horizontalScroll,children:(0,n.jsx)("button",{className:`${E.logLine} ${E.positionRelative}`,children:(0,n.jsx)(c,{hasAnsi:S,entry:O,highlights:m.searchWords,styles:E})})})}),(0,n.jsx)("td",{className:`log-row-menu-cell ${E.logRowMenuCell}`,children:j&&(0,n.jsx)(o.Q,{logText:O,row:m,showContextToggle:f,getRowContextQuery:R,onOpenContext:h,onPermalinkClick:y,onPinLine:D,onUnpinLine:b,pinLineButtonTooltipTitle:P,pinned:C,styles:E,mouseIsOver:M,onBlur:I})})]})});p.displayName="LogRowMessage"},14647:(k,A,e)=>{"use strict";e.d(A,{k:()=>_});var n=e(74848),s=e(32196),l=e(41811),r=e(96540),i=e(52622),g=e(32264),o=e(40845),d=e(14110),c=e(38138),a=e(91002);const p=({x:Q,y:ae,onClickFilterString:oe,onClickFilterOutString:J,selection:ee,row:de,close:xe})=>{const re=(0,r.useRef)(null),ue=(0,o.of)(m);return(0,r.useEffect)(()=>{function ge(Oe){Oe.key==="Escape"&&xe()}return document.addEventListener("keyup",ge),()=>{document.removeEventListener("keyup",ge)}},[xe]),oe||J?(0,n.jsx)("div",{className:ue.menu,style:{top:ae,left:Q},children:(0,n.jsxs)(c.W,{ref:re,children:[(0,n.jsx)(c.W.Item,{label:"Copy selection",onClick:()=>{(0,a.Dk)(ee,re),xe(),u("copy",ee.length,de.datasourceType)}}),oe&&(0,n.jsx)(c.W.Item,{label:"Add as line contains filter",onClick:()=>{oe(ee,de.dataFrame.refId),xe(),u("line_contains",ee.length,de.datasourceType)}}),J&&(0,n.jsx)(c.W.Item,{label:"Add as line does not contain filter",onClick:()=>{J(ee,de.dataFrame.refId),xe(),u("line_does_not_contain",ee.length,de.datasourceType)}})]})}):null};function u(Q,ae,oe){(0,d.rR)("grafana_explore_logs_popover_menu",{action:Q,selectionLength:ae,datasourceType:oe||"unknown"})}const m=Q=>({menu:(0,s.css)({position:"fixed",zIndex:Q.zIndex.modal})});class v{constructor(){this.seen=new Set,this.count=0}getKey(ae){this.count+=1;const oe=`k_${ae}`;return this.seen.has(oe)?`i_${this.count}`:(this.seen.add(oe),oe)}}var x=e(2543),f=e(72724),E=e(56034),h=e(14578),y=e(41260),b=e(41987),D=e(10534),P=e(29158),C=e(14689),M=e(69147),I=e(3911);const R=Q=>({logsStatsRow:(0,s.css)`
    label: logs-stats-row;
    margin: ${parseInt(Q.spacing(2),10)/1.75}px 0;
  `,logsStatsRowActive:(0,s.css)`
    label: logs-stats-row--active;
    color: ${Q.colors.primary.text};
    position: relative;
  `,logsStatsRowLabel:(0,s.css)`
    label: logs-stats-row__label;
    display: flex;
    margin-bottom: 1px;
  `,logsStatsRowValue:(0,s.css)`
    label: logs-stats-row__value;
    flex: 1;
    text-overflow: ellipsis;
    overflow: hidden;
  `,logsStatsRowCount:(0,s.css)`
    label: logs-stats-row__count;
    text-align: right;
    margin-left: ${Q.spacing(.75)};
  `,logsStatsRowPercent:(0,s.css)`
    label: logs-stats-row__percent;
    text-align: right;
    margin-left: ${Q.spacing(.75)};
    width: ${Q.spacing(4.5)};
  `,logsStatsRowBar:(0,s.css)`
    label: logs-stats-row__bar;
    height: ${Q.spacing(.5)};
    overflow: hidden;
    background: ${Q.colors.text.disabled};
  `,logsStatsRowInnerBar:(0,s.css)`
    label: logs-stats-row__innerbar;
    height: ${Q.spacing(.5)};
    overflow: hidden;
    background: ${Q.colors.primary.main};
  `}),T=({active:Q,count:ae,proportion:oe,value:J})=>{const ee=(0,o.of)(R),de=`${Math.round(oe*100)}%`,xe={width:de},re=Q?(0,s.cx)([ee.logsStatsRow,ee.logsStatsRowActive]):(0,s.cx)([ee.logsStatsRow]);return(0,n.jsxs)("div",{className:re,children:[(0,n.jsxs)("div",{className:(0,s.cx)([ee.logsStatsRowLabel]),children:[(0,n.jsx)("div",{className:(0,s.cx)([ee.logsStatsRowValue]),title:J,children:J}),(0,n.jsx)("div",{className:(0,s.cx)([ee.logsStatsRowCount]),children:ae}),(0,n.jsx)("div",{className:(0,s.cx)([ee.logsStatsRowPercent]),children:de})]}),(0,n.jsx)("div",{className:(0,s.cx)([ee.logsStatsRowBar]),children:(0,n.jsx)("div",{className:(0,s.cx)([ee.logsStatsRowInnerBar]),style:xe})})]})};T.displayName="LogLabelStatsRow";const S=5,L=(0,I.N)(Q=>({logsStats:(0,s.css)`
      label: logs-stats;
      background: inherit;
      color: ${Q.colors.text.primary};
      word-break: break-all;
      width: fit-content;
      max-width: 100%;
    `,logsStatsHeader:(0,s.css)`
      label: logs-stats__header;
      border-bottom: 1px solid ${Q.colors.border.medium};
      display: flex;
    `,logsStatsTitle:(0,s.css)`
      label: logs-stats__title;
      font-weight: ${Q.typography.fontWeightMedium};
      padding-right: ${Q.spacing(2)};
      display: inline-block;
      white-space: nowrap;
      text-overflow: ellipsis;
      flex-grow: 1;
    `,logsStatsClose:(0,s.css)`
      label: logs-stats__close;
      cursor: pointer;
    `,logsStatsBody:(0,s.css)`
      label: logs-stats__body;
      padding: 5px 0px;
    `}));class O extends r.PureComponent{render(){const{label:ae,rowCount:oe,stats:J,value:ee,theme:de,isLabel:xe}=this.props,re=L(de),ue=J.slice(0,S);let Te=ue.find(We=>We.value===ee),ge=J.slice(S);const Oe=!Te;Oe&&(Te=ge.find(We=>We.value===ee),ge=ge.filter(We=>We.value!==ee));const Ue=ge.reduce((We,Ce)=>We+Ce.count,0),we=ue.reduce((We,Ce)=>We+Ce.count,0)+Ue,qe=Ue/we;return(0,n.jsxs)("div",{className:re.logsStats,"data-testid":"logLabelStats",children:[(0,n.jsx)("div",{className:re.logsStatsHeader,children:(0,n.jsxs)("div",{className:re.logsStatsTitle,children:[ae,": ",we," of ",oe," rows have that ",xe?"label":"field"]})}),(0,n.jsxs)("div",{className:re.logsStatsBody,children:[ue.map(We=>(0,n.jsx)(T,{...We,active:We.value===ee},We.value)),Oe&&Te&&(0,n.jsx)(T,{...Te,active:!0},Te.value),Ue>0&&(0,n.jsx)(T,{count:Ue,value:"Other",proportion:qe},"__OTHERS__")]})]})}}const j=(0,o.cV)(O);j.displayName="LogLabelStats";var N=e(77020);const F=(0,l.A)(Q=>({wordBreakAll:(0,s.css)`
      label: wordBreakAll;
      word-break: break-all;
    `,copyButton:(0,s.css)`
      & > button {
        color: ${Q.colors.text.secondary};
        padding: 0;
        justify-content: center;
        border-radius: ${Q.shape.radius.circle};
        height: ${Q.spacing(Q.components.height.sm)};
        width: ${Q.spacing(Q.components.height.sm)};
        svg {
          margin: 0;
        }

        span > div {
          top: -5px;
          & button {
            color: ${Q.colors.success.main};
          }
        }
      }
    `,adjoiningLinkButton:(0,s.css)`
      margin-left: ${Q.spacing(1)};
    `,wrapLine:(0,s.css)`
      label: wrapLine;
      white-space: pre-wrap;
    `,logDetailsStats:(0,s.css)`
      padding: 0 ${Q.spacing(1)};
    `,logDetailsValue:(0,s.css)`
      display: flex;
      align-items: center;
      line-height: 22px;

      .log-details-value-copy {
        visibility: hidden;
      }
      &:hover {
        .log-details-value-copy {
          visibility: visible;
        }
      }
    `,buttonRow:(0,s.css)`
      display: flex;
      flex-direction: row;
      gap: ${Q.spacing(.5)};
      margin-left: ${Q.spacing(.5)};
    `}));class U extends r.PureComponent{constructor(){super(...arguments),this.state={showFieldsStats:!1,fieldCount:0,fieldStats:null},this.showField=()=>{const{onClickShowField:ae,parsedKeys:oe,row:J}=this.props;ae&&ae(oe[0]),(0,d.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:J.datasourceType,logRowUid:J.uid,type:"enable"})},this.hideField=()=>{const{onClickHideField:ae,parsedKeys:oe,row:J}=this.props;ae&&ae(oe[0]),(0,d.rR)("grafana_explore_logs_log_details_replace_line_clicked",{datasourceType:J.datasourceType,logRowUid:J.uid,type:"disable"})},this.isFilterLabelActive=async()=>{const{isFilterLabelActive:ae,parsedKeys:oe,parsedValues:J,row:ee}=this.props;return ae?await ae(oe[0],J[0],ee.dataFrame?.refId):!1},this.filterLabel=()=>{const{onClickFilterLabel:ae,parsedKeys:oe,parsedValues:J,row:ee}=this.props;ae&&ae(oe[0],J[0],(0,M.f8)(ee)||void 0),(0,d.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:ee.datasourceType,filterType:"include",logRowUid:ee.uid})},this.filterOutLabel=()=>{const{onClickFilterOutLabel:ae,parsedKeys:oe,parsedValues:J,row:ee}=this.props;ae&&ae(oe[0],J[0],(0,M.f8)(ee)||void 0),(0,d.rR)("grafana_explore_logs_log_details_filter_clicked",{datasourceType:ee.datasourceType,filterType:"exclude",logRowUid:ee.uid})},this.updateStats=()=>{const{getStats:ae}=this.props,oe=ae(),J=oe?oe.reduce((ee,de)=>ee+de.count,0):0;(!(0,x.isEqual)(this.state.fieldStats,oe)||J!==this.state.fieldCount)&&this.setState({fieldStats:oe,fieldCount:J})},this.showStats=()=>{const{isLabel:ae,row:oe,app:J}=this.props,{showFieldsStats:ee}=this.state;ee||this.updateStats(),this.toggleFieldsStats(),(0,d.rR)("grafana_explore_logs_log_details_stats_clicked",{dataSourceType:oe.datasourceType,fieldType:ae?"label":"detectedField",type:ee?"close":"open",logRowUid:oe.uid,app:J})}}componentDidUpdate(){this.state.showFieldsStats&&this.updateStats()}toggleFieldsStats(){this.setState(ae=>({showFieldsStats:!ae.showFieldsStats}))}generateClipboardButton(ae){const{theme:oe}=this.props,J=F(oe);return(0,n.jsx)("div",{className:`log-details-value-copy ${J.copyButton}`,children:(0,n.jsx)(D.b,{getText:()=>ae,title:"Copy value to clipboard",fill:"text",variant:"secondary",icon:"copy",size:"md"})})}generateMultiVal(ae,oe){return(0,n.jsx)("table",{children:(0,n.jsx)("tbody",{children:ae?.map((J,ee)=>(0,n.jsx)("tr",{children:(0,n.jsxs)("td",{children:[J,oe&&J!==""&&this.generateClipboardButton(J)]})},`${J}-${ee}`))})})}render(){const{theme:ae,parsedKeys:oe,parsedValues:J,isLabel:ee,links:de,displayedFields:xe,wrapLogMessage:re,onClickFilterLabel:ue,onClickFilterOutLabel:Te,disableActions:ge,row:Oe,app:Ue,onPinLine:Xe,pinLineButtonTooltipTitle:we}=this.props,{showFieldsStats:qe,fieldStats:We,fieldCount:Ce}=this.state,je=F(ae),Ke=(0,N.D)(ae),_e=oe==null?!1:oe.length===1,Fe=J==null?!1:J.length===1,at=!ge&&ue&&Te,Ct=Ue===b.Jk.Explore&&Oe.dataFrame?.refId?` in query ${Oe.dataFrame?.refId}`:"",Dt=!Fe&&J!=null&&!J.every(ze=>ze===""),tt=xe&&oe!=null&&xe.includes(oe[0])?(0,n.jsx)(P.K,{variant:"primary",tooltip:"Hide this field",name:"eye",onClick:this.hideField}):(0,n.jsx)(P.K,{tooltip:"Show this field instead of the message",name:"eye",onClick:this.showField});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{className:Ke.logDetailsValue,children:[(0,n.jsx)("td",{className:Ke.logsDetailsIcon,children:(0,n.jsxs)("div",{className:je.buttonRow,children:[at&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w,{name:"search-plus",onClick:this.filterLabel,isActive:()=>this.isFilterLabelActive(),tooltipSuffix:Ct}),(0,n.jsx)(P.K,{name:"search-minus",tooltip:`Filter out value${Ct}`,onClick:this.filterOutLabel})]}),!ge&&xe&&tt,!ge&&(0,n.jsx)(P.K,{variant:qe?"primary":"secondary",name:"signal",tooltip:"Ad-hoc statistics",className:"stats-button",disabled:!_e,onClick:this.showStats})]})}),(0,n.jsx)("td",{className:Ke.logDetailsLabel,children:_e?oe[0]:this.generateMultiVal(oe)}),(0,n.jsx)("td",{className:(0,s.cx)(je.wordBreakAll,re&&je.wrapLine),children:(0,n.jsxs)("div",{className:je.logDetailsValue,children:[Fe?J[0]:this.generateMultiVal(J,!0),Fe&&this.generateClipboardButton(J[0]),(0,n.jsx)("div",{className:(0,s.cx)((Fe||Dt)&&je.adjoiningLinkButton),children:de?.map((ze,pe)=>{if(ze.onClick&&Xe){const Se=ze.onClick;ze.onClick=(fe,Ee)=>{Xe(Oe,!1),Se(fe,Ee)}}return(0,n.jsx)("span",{children:(0,n.jsx)(C.R,{buttonProps:{tooltip:typeof we=="object"&&ze.onClick?we:void 0},link:ze})},`${ze.title}-${pe}`)})})]})})]}),qe&&_e&&Fe&&(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(P.K,{variant:qe?"primary":"secondary",name:"signal",tooltip:"Hide ad-hoc statistics",onClick:this.showStats})}),(0,n.jsx)("td",{colSpan:2,children:(0,n.jsx)("div",{className:je.logDetailsStats,children:(0,n.jsx)(j,{stats:We,label:oe[0],value:J[0],rowCount:Ce,isLabel:ee})})})]})]})}}const w=({isActive:Q,tooltipSuffix:ae,...oe})=>{const[J,ee]=(0,r.useState)(!1),de=J?"Remove filter":"Filter for value";return(0,r.useEffect)(()=>{Q().then(ee)},[Q]),(0,n.jsx)(P.K,{...oe,variant:J?"primary":void 0,tooltip:de+ae})},B=(0,o.cV)(U);B.displayName="LogDetailsRow";var K=e(70377);class W extends r.PureComponent{render(){const{app:ae,row:oe,theme:J,hasError:ee,onClickFilterOutLabel:de,onClickFilterLabel:xe,getRows:re,showDuplicates:ue,className:Te,onClickShowField:ge,onClickHideField:Oe,displayedFields:Ue,getFieldLinks:Xe,wrapLogMessage:we,onPinLine:qe,styles:We,pinLineButtonTooltipTitle:Ce}=this.props,je=(0,N.L)(J,oe.logLevel),Ke=oe.labels?oe.labels:{},_e=Object.keys(Ke).length>0,Fe=(0,K.jE)(oe,Xe);let at=Fe.filter(Ee=>Ee.links?.length);const Ct=at.filter(Ee=>Ee.fieldIndex!==oe.entryFieldIndex).sort(),Dt=at.filter(Ee=>Ee.fieldIndex===oe.entryFieldIndex).sort(),tt=(0,K.qE)(Dt),ze=Ct&&Ct.length>0||tt&&tt.length>0,pe=oe.dataFrame.meta?.type===y.m.LogLines?[]:Fe.filter(Ee=>Ee.links?.length===0&&Ee.fieldIndex!==oe.entryFieldIndex).sort(),Se=pe&&pe.length>0,fe=ee?"":`${je.logsRowLevelColor} ${We.logsRowLevel} ${We.logsRowLevelDetails}`;return(0,n.jsxs)("tr",{className:(0,s.cx)(Te,We.logDetails),children:[ue&&(0,n.jsx)("td",{}),(0,n.jsx)("td",{className:fe,"aria-label":"Log level"}),(0,n.jsx)("td",{colSpan:4,children:(0,n.jsx)("div",{className:We.logDetailsContainer,children:(0,n.jsx)("table",{className:We.logDetailsTable,children:(0,n.jsxs)("tbody",{children:[(_e||Se)&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:100,className:We.logDetailsHeading,"aria-label":"Fields",children:"Fields"})}),Object.keys(Ke).sort().map((Ee,Pe)=>{const he=Ke[Ee];return(0,n.jsx)(B,{parsedKeys:[Ee],parsedValues:[he],isLabel:!0,getStats:()=>(0,a.Tj)(re(),Ee),onClickFilterOutLabel:de,onClickFilterLabel:xe,onClickShowField:ge,onClickHideField:Oe,row:oe,app:ae,wrapLogMessage:we,displayedFields:Ue,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${Ee}=${he}-${Pe}`)}),pe.map((Ee,Pe)=>{const{keys:he,values:be,fieldIndex:Ae}=Ee;return(0,n.jsx)(B,{parsedKeys:he,parsedValues:be,onClickShowField:ge,onClickHideField:Oe,onClickFilterOutLabel:de,onClickFilterLabel:xe,getStats:()=>(0,a.s2)(oe.dataFrame.fields[Ae].values),displayedFields:Ue,wrapLogMessage:we,row:oe,app:ae,disableActions:!1,isFilterLabelActive:this.props.isFilterLabelActive},`${he[0]}=${be[0]}-${Pe}`)}),ze&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:100,className:We.logDetailsHeading,"aria-label":"Data Links",children:"Links"})}),Ct.map((Ee,Pe)=>{const{keys:he,values:be,links:Ae,fieldIndex:De}=Ee;return(0,n.jsx)(B,{parsedKeys:he,parsedValues:be,links:Ae,onClickShowField:ge,onClickHideField:Oe,onPinLine:qe,pinLineButtonTooltipTitle:Ce,getStats:()=>(0,a.s2)(oe.dataFrame.fields[De].values),displayedFields:Ue,wrapLogMessage:we,row:oe,app:ae,disableActions:!1},`${he[0]}=${be[0]}-${Pe}`)}),tt?.map((Ee,Pe)=>{const{keys:he,values:be,links:Ae,fieldIndex:De}=Ee;return(0,n.jsx)(B,{parsedKeys:he,parsedValues:be,links:Ae,onClickShowField:ge,onClickHideField:Oe,onPinLine:qe,pinLineButtonTooltipTitle:Ce,getStats:()=>(0,a.s2)(oe.dataFrame.fields[De].values),displayedFields:Ue,wrapLogMessage:we,row:oe,app:ae,disableActions:!0},`${he[0]}=${be[0]}-${Pe}`)}),!Se&&!_e&&!ze&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:100,"aria-label":"No details",children:"No details available"})})]})})})})]})}}const z=(0,o.cV)(W);z.displayName="LogDetails";var Y=e(93463),X=e(40455),q=e(42785);const G=(0,r.memo)(Q=>{const{row:ae,detectedFields:oe,getFieldLinks:J,wrapLogMessage:ee,styles:de,mouseIsOver:xe,pinned:re,...ue}=Q,Te=ee?"":te.noWrap,ge=(0,r.useMemo)(()=>(0,K.jE)(ae,J),[J,ae]),Oe=(0,r.useMemo)(()=>{let Xe="";for(let we=0;we<oe.length;we++){const qe=oe[we],We=ge.find(Ce=>{const{keys:je}=Ce;return je[0]===qe});We&&(Xe+=` ${qe}=${We.values}`),ae.labels[qe]!==void 0&&ae.labels[qe]!==null&&(Xe+=` ${qe}=${ae.labels[qe]}`)}return Xe.trimStart()},[oe,ge,ae.labels]),Ue=(0,r.useMemo)(()=>xe||re,[xe,re]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{className:de.logsRowMessage,children:(0,n.jsx)("div",{className:Te,children:Oe})}),(0,n.jsx)("td",{className:`log-row-menu-cell ${de.logRowMenuCell}`,children:Ue&&(0,n.jsx)(q.Q,{logText:Oe,row:ae,styles:de,pinned:re,mouseIsOver:xe,...ue})})]})}),te={noWrap:(0,s.css)`
    white-space: nowrap;
  `};G.displayName="LogRowMessageDisplayedFields";class H extends r.PureComponent{constructor(ae){super(ae),this.state={permalinked:!1,showingContext:!1,showDetails:!1,mouseIsOver:!1},this.debouncedContextClose=(0,x.debounce)(()=>{this.setState({showingContext:!1})},3e3),this.onOpenContext=oe=>{this.setState({showingContext:!0}),this.props.onOpenContext(oe,this.debouncedContextClose)},this.onRowClick=oe=>{this.props.handleTextSelection?.(oe,this.props.row)||this.props.enableLogDetails&&this.setState(J=>({showDetails:!J.showDetails}))},this.onMouseEnter=()=>{this.setState({mouseIsOver:!0}),this.props.onLogRowHover&&this.props.onLogRowHover(this.props.row)},this.onMouseMove=oe=>{this.props.handleTextSelection&&document.getSelection()?.toString()&&oe.buttons>0&&this.setState({mouseIsOver:!1})},this.onMouseLeave=()=>{this.setState({mouseIsOver:!1}),this.props.onLogRowHover&&this.props.onLogRowHover(void 0)},this.scrollToLogRow=(oe,J=!1)=>{const{row:ee,permalinkedRowId:de,scrollIntoView:xe,containerRendered:re}=this.props;if(de!==ee.uid){(oe.permalinked||J)&&this.setState({permalinked:!1});return}!this.state.permalinked&&re&&this.logLineRef.current&&xe&&(xe(this.logLineRef.current),(0,d.rR)("grafana_explore_logs_permalink_opened",{datasourceType:ee.datasourceType??"unknown",logRowUid:ee.uid}),this.setState({permalinked:!0}))},this.escapeRow=(0,l.A)((oe,J)=>oe.hasUnescapedContent&&J?{...oe,entry:(0,a.Hw)(oe.entry),raw:(0,a.Hw)(oe.raw)}:oe),this.logLineRef=r.createRef()}renderTimeStamp(ae){return(0,f.LE)(ae,{timeZone:this.props.timeZone,defaultWithMS:!0})}componentDidMount(){this.scrollToLogRow(this.state,!0)}componentDidUpdate(ae,oe){this.scrollToLogRow(oe)}render(){const{getRows:ae,onClickFilterLabel:oe,onClickFilterOutLabel:J,onClickShowField:ee,onClickHideField:de,enableLogDetails:xe,row:re,showDuplicates:ue,showContextToggle:Te,showLabels:ge,showTime:Oe,displayedFields:Ue,wrapLogMessage:Xe,prettifyLogMessage:we,theme:qe,getFieldLinks:We,forceEscape:Ce,app:je,styles:Ke,getRowContextQuery:_e,pinned:Fe}=this.props,{showDetails:at,showingContext:Ct,permalinked:Dt}=this.state,tt=(0,N.L)(qe,re.logLevel),{errorMessage:ze,hasError:pe}=(0,a.Ei)(re),{sampleMessage:Se,isSampled:fe}=(0,a.qR)(re),Ee=(0,s.cx)(Ke.logsRow,{[Ke.errorLogRow]:pe,[Ke.highlightBackground]:Ct||Dt||Fe}),Pe=(0,s.cx)(Ke.logsRow,{[Ke.errorLogRow]:pe,[Ke.highlightBackground]:Dt&&!this.state.showDetails}),he=this.escapeRow(re,Ce);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{ref:this.logLineRef,className:Ee,onClick:this.onRowClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove,onFocus:this.onMouseEnter,children:[ue&&(0,n.jsx)("td",{className:Ke.logsRowDuplicates,children:he.duplicates&&he.duplicates>0?`${he.duplicates+1}x`:null}),(0,n.jsxs)("td",{className:pe||fe?Ke.logsRowWithError:`${tt.logsRowLevelColor} ${Ke.logsRowLevel}`,children:[pe&&(0,n.jsx)(E.m,{content:`Error: ${ze}`,placement:"right",theme:"error",children:(0,n.jsx)(h.I,{className:Ke.logIconError,name:"exclamation-triangle",size:"xs"})}),fe&&(0,n.jsx)(E.m,{content:`${Se}`,placement:"right",theme:"info",children:(0,n.jsx)(h.I,{className:Ke.logIconInfo,name:"info-circle",size:"xs"})})]}),(0,n.jsx)("td",{title:xe?at?"Hide log details":"See log details":"",className:xe?Ke.logsRowToggleDetails:"",children:xe&&(0,n.jsx)(h.I,{className:Ke.topVerticalAlign,name:at?"angle-down":"angle-right"})}),Oe&&(0,n.jsx)("td",{className:Ke.logsRowLocalTime,children:this.renderTimeStamp(re.timeEpochMs)}),ge&&he.uniqueLabels&&(0,n.jsx)("td",{className:Ke.logsRowLabels,children:(0,n.jsx)(Y.h,{labels:he.uniqueLabels})}),Ue&&Ue.length>0?(0,n.jsx)(G,{row:he,showContextToggle:Te,detectedFields:Ue,getFieldLinks:We,wrapLogMessage:Xe,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,styles:Ke,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave}):(0,n.jsx)(X.a,{row:he,showContextToggle:Te,getRowContextQuery:_e,wrapLogMessage:Xe,prettifyLogMessage:we,onOpenContext:this.onOpenContext,onPermalinkClick:this.props.onPermalinkClick,app:je,styles:Ke,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinned,mouseIsOver:this.state.mouseIsOver,onBlur:this.onMouseLeave,expanded:this.state.showDetails})]}),this.state.showDetails&&(0,n.jsx)(z,{onPinLine:this.props.onPinLine,className:Pe,showDuplicates:ue,getFieldLinks:We,onClickFilterLabel:oe,onClickFilterOutLabel:J,onClickShowField:ee,onClickHideField:de,getRows:ae,row:he,wrapLogMessage:Xe,hasError:pe,displayedFields:Ue,app:je,styles:Ke,isFilterLabelActive:this.props.isFilterLabelActive,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle})]})}}const se=(0,o.cV)(H);se.displayName="LogRow";const ne=100;class le extends r.PureComponent{constructor(){super(...arguments),this.renderAllTimer=null,this.logRowsRef=(0,r.createRef)(),this.state={renderAll:!1,selection:"",selectedRow:null,popoverMenuCoordinates:{x:0,y:0}},this.openContext=(ae,oe)=>{this.props.onOpenContext&&this.props.onOpenContext(ae,oe)},this.handleSelection=(ae,oe)=>{if(this.popoverMenuSupported()===!1)return!1;const J=document.getSelection()?.toString();if(!J||!this.logRowsRef.current)return!1;const ee=270,de=105,xe=ae.clientX+ee>window.innerWidth?window.innerWidth-ee:ae.clientX,re=ae.clientY+de>window.innerHeight?window.innerHeight-de:ae.clientY;return this.setState({selection:J,popoverMenuCoordinates:{x:xe,y:re},selectedRow:oe}),document.addEventListener("click",this.handleDeselection),document.addEventListener("contextmenu",this.handleDeselection),!0},this.handleDeselection=ae=>{if((0,a.a8)(ae.target)&&!this.logRowsRef.current?.contains(ae.target)){this.closePopoverMenu();return}document.getSelection()?.toString()||this.closePopoverMenu()},this.closePopoverMenu=()=>{document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),this.setState({selection:"",popoverMenuCoordinates:{x:0,y:0},selectedRow:null})},this.makeGetRows=(0,l.A)(ae=>()=>ae),this.sortLogs=(0,l.A)((ae,oe)=>(0,a.oR)(ae,oe))}static{this.defaultProps={previewLimit:ne}}popoverMenuSupported(){return g.$.featureToggles.logRowsPopoverMenu?!!(this.props.onClickFilterOutString||this.props.onClickFilterString):!1}componentDidMount(){const{logRows:ae,previewLimit:oe}=this.props,ee=(ae?ae.length:0)<=oe*2;ee?this.setState({renderAll:ee}):this.renderAllTimer=window.setTimeout(()=>this.setState({renderAll:!0}),2e3)}componentWillUnmount(){document.removeEventListener("click",this.handleDeselection),document.removeEventListener("contextmenu",this.handleDeselection),document.removeEventListener("selectionchange",this.handleDeselection),this.renderAllTimer&&clearTimeout(this.renderAllTimer)}render(){const{deduplicatedRows:ae,logRows:oe,dedupStrategy:J,theme:ee,logsSortOrder:de,previewLimit:xe,pinnedLogs:re,...ue}=this.props,{renderAll:Te}=this.state,ge=(0,N.D)(ee),Oe=ae||oe,Ue=oe&&oe.length>0,Xe=Oe?Oe.reduce((Fe,at)=>at.duplicates?Fe+at.duplicates:Fe,0):0,we=J!==i.fY.none&&Xe>0,qe=Oe||[],We=de?this.sortLogs(qe,de):qe,Ce=We.slice(0,xe),je=We.slice(xe,We.length),Ke=this.makeGetRows(We),_e=new v;return(0,n.jsxs)("div",{className:ge.logRows,ref:this.logRowsRef,children:[this.state.selection&&this.state.selectedRow&&(0,n.jsx)(p,{close:this.closePopoverMenu,row:this.state.selectedRow,selection:this.state.selection,...this.state.popoverMenuCoordinates,onClickFilterString:ue.onClickFilterString,onClickFilterOutString:ue.onClickFilterOutString}),(0,n.jsx)("table",{className:(0,s.cx)(ge.logsRowsTable,this.props.overflowingContent?"":ge.logsRowsTableContain),children:(0,n.jsxs)("tbody",{children:[Ue&&Ce.map(Fe=>(0,n.jsx)(se,{getRows:Ke,row:Fe,showDuplicates:we,logsSortOrder:de,onOpenContext:this.openContext,styles:ge,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinnedRowId===Fe.uid||re?.some(at=>at===Fe.rowId),isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...ue},_e.getKey(Fe.uid))),Ue&&Te&&je.map(Fe=>(0,n.jsx)(se,{getRows:Ke,row:Fe,showDuplicates:we,logsSortOrder:de,onOpenContext:this.openContext,styles:ge,onPermalinkClick:this.props.onPermalinkClick,scrollIntoView:this.props.scrollIntoView,permalinkedRowId:this.props.permalinkedRowId,onPinLine:this.props.onPinLine,onUnpinLine:this.props.onUnpinLine,pinLineButtonTooltipTitle:this.props.pinLineButtonTooltipTitle,pinned:this.props.pinnedRowId===Fe.uid||re?.some(at=>at===Fe.rowId),isFilterLabelActive:this.props.isFilterLabelActive,handleTextSelection:this.popoverMenuSupported()?this.handleSelection:void 0,...ue},_e.getKey(Fe.uid))),Ue&&!Te&&(0,n.jsx)("tr",{children:(0,n.jsxs)("td",{colSpan:5,children:["Rendering ",We.length-xe," rows..."]})})]})})]})}}const _=(0,o.cV)(le);_.displayName="LogsRows"},77020:(k,A,e)=>{"use strict";e.d(A,{D:()=>d,L:()=>o});var n=e(32196),s=e(41811),l=e(84140),r=e(9557),i=e(23596),g=e(16797);const o=(c,a)=>{let p=c.isLight?c.v1.palette.gray5:c.v1.palette.gray2;switch(a){case r.$b.crit:case r.$b.critical:p="#705da0";break;case r.$b.error:case r.$b.err:p="#e24d42";break;case r.$b.warning:case r.$b.warn:p=c.colors.warning.main;break;case r.$b.info:p="#7eb26d";break;case r.$b.debug:p="#1f78c1";break;case r.$b.trace:p="#6ed0e0";break}return{logsRowLevelColor:(0,n.css)`
      &::after {
        background-color: ${p};
      }
    `}},d=(0,s.A)(c=>{const a=g.hoverColor(c.colors.background.secondary,c),p=(0,l.A)(c.components.dashboard.background).setAlpha(.7).toRgbString();return{logsRowLevel:(0,n.css)`
      label: logs-row__level;
      max-width: ${c.spacing(1.25)};
      cursor: default;
      &::after {
        content: '';
        display: block;
        position: absolute;
        top: 1px;
        bottom: 1px;
        width: 3px;
        left: ${c.spacing(.5)};
      }
    `,logsRowWithError:(0,n.css)({maxWidth:`${c.spacing(1.5)}`}),logsRowMatchHighLight:(0,n.css)`
      label: logs-row__match-highlight;
      background: inherit;
      padding: inherit;
      color: ${c.components.textHighlight.text}
      background-color: ${c.components.textHighlight};
    `,logRows:(0,n.css)({position:"relative"}),logsRowsTable:(0,n.css)`
      label: logs-rows;
      font-family: ${c.typography.fontFamilyMonospace};
      font-size: ${c.typography.bodySmall.fontSize};
      width: 100%;
      position: relative;
    `,logsRowsTableContain:(0,n.css)`
      contain: strict;
    `,highlightBackground:(0,n.css)`
      background-color: ${(0,l.A)(c.colors.info.transparent).setAlpha(.25).toString()};
    `,logsRow:(0,n.css)`
      label: logs-row;
      width: 100%;
      cursor: pointer;
      vertical-align: top;

      &:hover {
        .log-row-menu {
          z-index: 1;
        }

        background: ${a};
      }

      td:not(.log-row-menu-cell):last-child {
        width: 100%;
      }

      > td:not(.log-row-menu-cell) {
        position: relative;
        padding-right: ${c.spacing(1)};
        border-top: 1px solid transparent;
        border-bottom: 1px solid transparent;
        height: 100%;
      }
    `,logsRowDuplicates:(0,n.css)`
      label: logs-row__duplicates;
      text-align: right;
      width: 4em;
      cursor: default;
    `,logIconError:(0,n.css)({color:c.colors.warning.main,position:"relative",top:"-2px"}),logIconInfo:(0,n.css)({color:c.colors.info.main,position:"relative",top:"-2px"}),logsRowToggleDetails:(0,n.css)`
      label: logs-row-toggle-details__level;
      font-size: 9px;
      padding-top: 5px;
      max-width: 15px;
    `,logsRowLocalTime:(0,n.css)`
      label: logs-row__localtime;
      white-space: nowrap;
    `,logsRowLabels:(0,n.css)`
      label: logs-row__labels;
      white-space: nowrap;
      max-width: 22em;

      /* This is to make the labels vertical align */
      > span {
        margin-top: 0.75px;
      }
    `,logsRowMessage:(0,n.css)`
      label: logs-row__message;
      white-space: pre-wrap;
      word-break: break-all;
      overflow-wrap: anywhere;
      width: 100%;
      text-align: left;
    `,copyLogButton:(0,n.css)`
      padding: 0 0 0 ${c.spacing(.5)};
      height: ${c.spacing(3)};
      width: ${c.spacing(3.25)};
      line-height: ${c.spacing(2.5)};
      overflow: hidden;
      &:hover {
          background-color: ${i.MV.alpha(c.colors.text.primary,.12)};
        }
      }
    `,logDetailsContainer:(0,n.css)`
      label: logs-row-details-table;
      border: 1px solid ${c.colors.border.medium};
      padding: 0 ${c.spacing(1)} ${c.spacing(1)};
      border-radius: ${c.shape.radius.default};
      margin: ${c.spacing(2.5)} ${c.spacing(1)} ${c.spacing(2.5)} ${c.spacing(2)};
      cursor: default;
    `,logDetailsTable:(0,n.css)`
      label: logs-row-details-table;
      line-height: 18px;
      width: 100%;
      td:last-child {
        width: 100%;
      }
    `,logsDetailsIcon:(0,n.css)`
      label: logs-row-details__icon;
      position: relative;
      color: ${c.v1.palette.gray3};
      padding-top: 1px;
      padding-bottom: 1px;
      padding-right: ${c.spacing(.75)};
    `,logDetailsLabel:(0,n.css)`
      label: logs-row-details__label;
      max-width: 30em;
      min-width: 20em;
      padding: 0 ${c.spacing(1)};
      overflow-wrap: break-word;
    `,logDetailsHeading:(0,n.css)`
      label: logs-row-details__heading;
      font-weight: ${c.typography.fontWeightBold};
      padding: ${c.spacing(1)} 0 ${c.spacing(.5)};
    `,logDetailsValue:(0,n.css)`
      label: logs-row-details__row;
      position: relative;
      vertical-align: middle;
      cursor: default;

      &:hover {
        background-color: ${a};
      }
    `,topVerticalAlign:(0,n.css)`
      label: topVerticalAlign;
      margin-top: -${c.spacing(.9)};
      margin-left: -${c.spacing(.25)};
    `,detailsOpen:(0,n.css)`
      &:hover {
        background-color: ${g.hoverColor(c.colors.background.primary,c)};
      }
    `,errorLogRow:(0,n.css)`
      label: erroredLogRow;
      color: ${c.colors.text.secondary};
    `,positionRelative:(0,n.css)`
      label: positionRelative;
      position: relative;
    `,rowWithContext:(0,n.css)`
      label: rowWithContext;
      z-index: 1;
      outline: 9999px solid ${p};
      display: inherit;
    `,horizontalScroll:(0,n.css)`
      label: horizontalScroll;
      white-space: pre;
    `,contextNewline:(0,n.css)`
      display: block;
      margin-left: 0px;
    `,rowMenu:(0,n.css)`
      label: rowMenu;
      display: flex;
      flex-wrap: nowrap;
      flex-direction: row;
      align-content: flex-end;
      justify-content: space-evenly;
      align-items: center;
      position: absolute;
      top: 0;
      bottom: auto;
      background: ${c.colors.background.primary};
      box-shadow: ${c.shadows.z3};
      padding: ${c.spacing(.5,1,.5,1)};
      z-index: 100;
      gap: ${c.spacing(.5)};

      & > button {
        margin: 0;
      }
    `,logRowMenuCell:(0,n.css)`
      position: sticky;
      z-index: ${c.zIndex.dropdown};
      margin-top: -${c.spacing(.125)};
      right: 0px;

      & > span {
        transform: translateX(-100%);
      }
    `,logLine:(0,n.css)`
      background-color: transparent;
      border: none;
      diplay: inline;
      font-family: ${c.typography.fontFamilyMonospace};
      font-size: ${c.typography.bodySmall.fontSize};
      letter-spacing: ${c.typography.bodySmall.letterSpacing};
      text-align: left;
      padding: 0;
      user-select: text;
    `,logsRowLevelDetails:(0,n.css)`
      label: logs-row__level_details;
      &::after {
        top: -3px;
      }
    `,logDetails:(0,n.css)`
      label: logDetailsDefaultCursor;
      cursor: default;

      &:hover {
        background-color: ${c.colors.background.primary};
      }
    `,visibleRowMenu:(0,n.css)`
      label: visibleRowMenu;
      aspect-ratio: 1/1;
      z-index: 90;
    `,linkButton:(0,n.css)`
      label: linkButton;
      > button {
        padding-top: ${c.spacing(.5)};
      }
    `,hidden:(0,n.css)`
      label: hidden;
      visibility: hidden;
    `,unPinButton:(0,n.css)`
      height: ${c.spacing(3)};
      line-height: ${c.spacing(2.5)};
    `}})},81166:(k,A,e)=>{"use strict";e.d(A,{V:()=>N});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(16817),g=e(39070),o=e(52622),d=e(9557),c=e(47232),a=e(14110),p=e(32264),u=e(40845),m=e(37390),v=e(55852),x=e(33390),f=e(97186),E=e(29436),h=e(31678),y=e(69147),b=e(91002),D=e(81073),P=e(14647),C=e(15292);function M(F){return{buttons:(0,s.css)({display:"flex",gap:F.spacing(1)})}}const I=F=>{const U=(0,u.of)(M),{wrapLines:w,onChangeWrapLines:B,onScrollCenterClick:K}=F,W=(0,r.useCallback)(z=>{const Y=z.currentTarget.checked;(0,a.rR)("grafana_explore_logs_log_context_toggle_lines_clicked",{state:Y}),B(Y)},[B]);return(0,n.jsxs)("div",{className:U.buttons,children:[(0,n.jsx)(C.K,{showLabel:!0,value:w,onChange:W,label:"Wrap lines"}),(0,n.jsx)(v.$n,{variant:"secondary",onClick:K,children:"Center matched line"})]})},R=F=>({modal:(0,s.css)`
      width: 85vw;
      ${F.breakpoints.down("md")} {
        width: 100%;
      }
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    `,sticky:(0,s.css)`
      position: sticky;
      z-index: 1;
      top: -1px;
      bottom: -1px;
    `,entry:(0,s.css)`
      & > td {
        padding: ${F.spacing(1)} 0 ${F.spacing(1)} 0;
      }
      background: ${F.colors.emphasize(F.colors.background.secondary)};

      & > table {
        margin-bottom: 0;
      }

      & .log-row-menu {
        margin-top: -6px;
      }
    `,datasourceUi:(0,s.css)`
      padding-bottom: ${F.spacing(1.25)};
      display: flex;
      align-items: center;
    `,logRowGroups:(0,s.css)`
      overflow: auto;
      max-height: 75%;
      align-self: stretch;
      display: inline-block;
      border: 1px solid ${F.colors.border.weak};
      border-radius: ${F.shape.radius.default};
      & > table {
        min-width: 100%;
      }
    `,flexColumn:(0,s.css)`
      display: flex;
      flex-direction: column;
      padding: 0 ${F.spacing(3)} ${F.spacing(3)} ${F.spacing(3)};
    `,flexRow:(0,s.css)`
      display: flex;
      flex-direction: row;
      align-items: center;
      & > div:last-child {
        margin-left: auto;
      }
    `,noMarginBottom:(0,s.css)`
      & > table {
        margin-bottom: 0;
      }
    `,hidden:(0,s.css)`
      display: none;
    `,paddingTop:(0,s.css)`
      padding-top: ${F.spacing(1)};
    `,paddingBottom:(0,s.css)`
      padding-bottom: ${F.spacing(1)};
    `,link:(0,s.css)`
      color: ${F.colors.text.secondary};
      font-size: ${F.typography.bodySmall.fontSize};
      :hover {
        color: ${F.colors.text.link};
      }
    `,loadingCell:(0,s.css)`
      position: sticky;
      left: 50%;
      display: inline-block;
      transform: translateX(-50%);
    `}),T=()=>({above:{loadingState:g.Gu.NotStarted,rows:[]},below:{loadingState:g.Gu.NotStarted,rows:[]}}),S=(F,U)=>F==="above"&&U===o.uH.Descending||F==="below"&&U===o.uH.Ascending?d.ZF.Forward:d.ZF.Backward,L=(F,U)=>({...F,dataFrame:{...F.dataFrame,refId:`context_${U.above}_${U.below}`}}),O=(F,U)=>F.some(w=>w.entry===U.entry&&w.timeEpochNs===U.timeEpochNs),j=100,N=({row:F,open:U,logsSortOrder:w,timeZone:B,getLogRowContextUi:K,getRowContextQuery:W,onClose:z,getRowContext:Y})=>{const X=(0,r.useRef)(null),q=(0,r.useRef)(null),G=(0,r.useRef)(null),te=(0,r.useRef)(null),H=(0,r.useRef)(null),se=(0,r.useRef)(null),ne=(0,r.useRef)(null),le=(0,r.useRef)({above:0,below:0}),_=(0,h.useDispatch)(),Q=(0,u.$j)(),ae=R(Q),[oe,J]=(0,r.useState)(!0),[ee,de]=(0,r.useState)(T()),xe=(tt,ze)=>{de(pe=>{const Se={...pe};return Se[tt]=ze(pe[tt]),Se})},re=(0,r.useRef)(1),[ue,Te]=(0,r.useState)(null),[ge,Oe]=(0,r.useState)(x.A.getBool(f.$.logContextWrapLogMessage,x.A.getBool(f.$.wrapLogMessage,!0))),Ue=(0,r.useCallback)(()=>{const{below:tt,above:ze}=ee,pe=(0,b.oR)([...tt.rows,F,...ze.rows],o.uH.Ascending),Se=pe[0].timeEpochMs;let fe=pe[pe.length-1].timeEpochMs;Se===fe&&(fe+=1);const Ee=(0,c.KQ)(Se),Pe=(0,c.KQ)(fe);return{from:Ee,to:Pe,raw:{from:Ee,to:Pe}}},[ee,F]),Xe=(0,r.useCallback)(async()=>{const tt=W?await W(F):null;Te(tt)},[F,W]),we=async()=>{await Xe(),de(T()),le.current={above:0,below:0},re.current+=1},qe=async(tt,ze)=>{le.current[tt]+=1;const pe=ze.at(tt==="above"?0:-1);if(pe==null)throw new Error("should never happen. the array always contains at least 1 item (the middle row)");(0,a.rR)("grafana_explore_logs_log_context_load_more_called",{datasourceType:pe.datasourceType,above:le.current.above,below:le.current.below});const Se=S(tt,w),fe=await Y(L(pe,le.current),{limit:j,direction:Se}),Ee=(0,y.HT)(fe.data).rows;return w===o.uH.Ascending&&Ee.reverse(),Ee.filter(he=>!O(ze,he))};(0,r.useEffect)(()=>{U&&Xe()},[Xe,U]);const[We,Ce]=(0,r.useState)([]),je=tt=>{We.indexOf(tt)===-1&&Ce([...We,tt])},Ke=tt=>{const ze=We.indexOf(tt);ze>-1&&(We.splice(ze,1),Ce([...We]))},_e=async tt=>{const{below:ze,above:pe}=ee;if(ee[tt].loadingState===g.Gu.Loading)return;xe(tt,Ee=>({...Ee,loadingState:g.Gu.Loading}));const fe=re.current;try{const Ee=[...pe.rows,F,...ze.rows],Pe=(await qe(tt,Ee)).map(Ie=>!Ie.searchWords||!Ie.searchWords?.length?{...Ie,searchWords:F.searchWords}:Ie),[he,be]=(0,l.partition)(Pe,Ie=>Ie.timeEpochNs>F.timeEpochNs),Ae=w===o.uH.Ascending?be:he,De=w===o.uH.Ascending?he:be;fe===re.current&&de(Ie=>{const ke=Ae.length>0?(0,b.oR)([...Ae,...Ie.above.rows],w):Ie.above.rows,dt=De.length>0?(0,b.oR)([...Ie.below.rows,...De],w):Ie.below.rows;return{above:{rows:ke,loadingState:tt==="above"?Pe.length===0?g.Gu.Done:g.Gu.NotStarted:Ie.above.loadingState},below:{rows:dt,loadingState:tt==="below"?Pe.length===0?g.Gu.Done:g.Gu.NotStarted:Ie.below.loadingState}}})}catch{xe(tt,Ee=>({rows:Ee.rows,loadingState:g.Gu.Error}))}},Fe=async(tt,ze)=>{for(const pe of tt){if(!pe.isIntersecting)continue;const Se=pe.target;Se===se.current?_e("above"):Se===ne.current&&_e("below")}};(0,r.useEffect)(()=>{const tt=X.current,ze=se.current,pe=ne.current;if(tt==null)return;const Se=new IntersectionObserver(Fe,{root:tt});return ze!=null&&Se.observe(ze),pe!=null&&Se.observe(pe),()=>{Se.disconnect()}});const at=(0,r.useCallback)(()=>{G.current?.scrollIntoView({block:"center"}),q.current?.scrollIntoView({block:"center"})},[G,q]);(0,r.useLayoutEffect)(()=>{const tt=X.current;if(tt==null)return;const ze=H.current,pe=tt.clientHeight;if(H.current=pe,ze!==pe){at();return}if(le.current.above<=1&&le.current.below<=1){at();return}const Se=te.current,fe=tt.scrollHeight;if(te.current=fe,Se!=null){const Ee=tt.scrollTop+(fe-Se);tt.scrollTop=Ee}},[ee.above.rows,at]),(0,i.A)(Xe,[W,F]);const Ct=ee.above.loadingState,Dt=ee.below.loadingState;return(0,n.jsxs)(m.a,{isOpen:U,title:"Log context",contentClassName:ae.flexColumn,className:ae.modal,onDismiss:z,children:[p.$.featureToggles.logsContextDatasourceUi&&K&&(0,n.jsx)("div",{className:ae.datasourceUi,children:K(F,we)}),(0,n.jsx)("div",{className:(0,s.cx)(ae.flexRow,ae.paddingBottom),children:(0,n.jsx)("div",{children:(0,n.jsx)(I,{wrapLines:ge,onChangeWrapLines:Oe,onScrollCenterClick:at})})}),(0,n.jsx)("div",{ref:X,className:ae.logRowGroups,children:(0,n.jsx)("table",{children:(0,n.jsxs)("tbody",{children:[(0,n.jsx)("tr",{children:(0,n.jsxs)("td",{className:ae.loadingCell,children:[Ct!==g.Gu.Done&&Ct!==g.Gu.Error&&(0,n.jsx)("div",{ref:se,children:(0,n.jsx)(D.I,{adjective:"newer"})}),Ct===g.Gu.Error&&(0,n.jsx)("div",{children:"Error loading log more logs."}),Ct===g.Gu.Done&&(0,n.jsx)("div",{children:"No more logs available."})]})}),(0,n.jsx)("tr",{children:(0,n.jsx)("td",{className:ae.noMarginBottom,children:(0,n.jsx)(P.k,{logRows:ee.above.rows,dedupStrategy:o.fY.none,showLabels:x.A.getBool(f.$.showLabels,!1),showTime:x.A.getBool(f.$.showTime,!0),wrapLogMessage:ge,prettifyLogMessage:x.A.getBool(f.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:B,displayedFields:We,onClickShowField:je,onClickHideField:Ke})})}),(0,n.jsx)("tr",{ref:G}),(0,n.jsx)("tr",{ref:q,className:(0,s.cx)(ae.entry,oe?ae.sticky:null),"data-testid":"entry-row",children:(0,n.jsx)("td",{className:ae.noMarginBottom,children:(0,n.jsx)(P.k,{logRows:[F],dedupStrategy:o.fY.none,showLabels:x.A.getBool(f.$.showLabels,!1),showTime:x.A.getBool(f.$.showTime,!0),wrapLogMessage:ge,prettifyLogMessage:x.A.getBool(f.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:B,displayedFields:We,onClickShowField:je,onClickHideField:Ke,onUnpinLine:()=>J(!1),onPinLine:()=>J(!0),pinnedRowId:oe?F.uid:void 0,overflowingContent:!0})})}),(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(P.k,{logRows:ee.below.rows,dedupStrategy:o.fY.none,showLabels:x.A.getBool(f.$.showLabels,!1),showTime:x.A.getBool(f.$.showTime,!0),wrapLogMessage:ge,prettifyLogMessage:x.A.getBool(f.$.prettifyLogMessage,!1),enableLogDetails:!0,timeZone:B,displayedFields:We,onClickShowField:je,onClickHideField:Ke})})})}),(0,n.jsx)("tr",{children:(0,n.jsxs)("td",{className:ae.loadingCell,children:[Dt!==g.Gu.Done&&Dt!==g.Gu.Error&&(0,n.jsx)("div",{ref:ne,children:(0,n.jsx)(D.I,{adjective:"older"})}),Dt===g.Gu.Error&&(0,n.jsx)("div",{children:"Error loading log more logs."}),Dt===g.Gu.Done&&(0,n.jsx)("div",{children:"No more logs available."})]})})]})})}),(0,n.jsx)(m.a.ButtonRow,{children:ue?.datasource?.uid&&(0,n.jsx)(v.$n,{variant:"secondary",onClick:async()=>{let tt=F.uid;F.dataFrame.refId&&(tt=F.uid.replace(F.dataFrame.refId,ue.refId)),_((0,E.ve)({queries:[ue],range:Ue(),datasourceUid:ue.datasource.uid,panelsState:{logs:{id:tt}}})),z(),(0,a.rR)("grafana_explore_logs_log_context_open_split_view_clicked",{datasourceType:F.datasourceType,logRowUid:F.uid})},children:"Open in split view"})})]})}},70377:(k,A,e)=>{"use strict";e.d(A,{FE:()=>o,jE:()=>i,qE:()=>g});var n=e(2543),s=e.n(n),l=e(87490),r=e(98101);const i=(p,u)=>o(p,u),g=p=>{let u=[];return p.forEach(m=>{m.links?.forEach(v=>{if(v.variables){const x=v.variables.map(E=>{const h=E.variableName,y=E.fieldPath?`.${E.fieldPath}`:"";return`${h}${y}`}),f=v.variables.map(E=>E.found?E.value:"");u.push({keys:x,values:f,links:[v],fieldIndex:m.fieldIndex})}})}),u},o=(p,u)=>a(p).map(v=>{const x=u?u(v,p.rowIndex,p.dataFrame):[],f=v.values[p.rowIndex],E=typeof f=="string"||typeof f=="number"?f.toString():(0,l.MA)(f);return{keys:[v.name],values:[E],links:x,fieldIndex:v.index}});function d(p,u){const m=(0,r.O)(p);if(m===null)return new Set;const v=new Set(m.extraFields.map(x=>x.index));return m.severityField!==null&&v.add(m.severityField.index),u.keepBody&&v.add(m.bodyField.index),u.keepTimestamp&&v.add(m.timeField.index),v}function c(p,u){const m=p.fields.map((E,h)=>({...E,index:h})),v=d(p,u??{}),[x,f]=partition(m,E=>E.config.custom?.hidden?!1:(E.config.links??[]).length>0?!0:v.has(E.index));return{visible:x,hidden:f}}function a(p,u){const m=p.dataFrame,v=d(m,u??{}),x=[];for(let f=0;f<m.fields.length;f++){const E=m.fields[f];E.values[p.rowIndex]!=null&&(E.config.custom?.hidden||(E.config.links&&E.config.links.length>0||v.has(f))&&x.push({...E,index:f}))}return x}},98101:(k,A,e)=>{"use strict";e.d(A,{n:()=>m,O:()=>x});var n=e(85404),s=e(11261),l=e(41260);function r(f,E){const h=f.labels;if(h!==void 0){const y=new Array(E);return y.fill(h),y}else return null}function i(f,E,h){const y=f.getFieldByName("labels");if(y!==void 0&&y.type===s.PU.other){const b=y.values.map(m);return[y,()=>b]}else return[null,()=>r(E,h.length)]}function g(f){const E=new n.L(f),h=E.getFirstFieldOfType(s.PU.time),y=E.getFirstFieldOfType(s.PU.string);if(h===void 0||y===void 0)return null;const b=E.getFieldByName("tsNs")??null,D=E.getFieldByName("level")??null,P=E.getFieldByName("id")??null,[C,M]=i(E,y,f),I=E.fields.filter((R,T)=>T!==h.index&&T!==y.index&&T!==b?.index&&T!==D?.index&&T!==P?.index&&T!==C?.index);return{timeField:h,bodyField:y,timeNanosecondField:b,severityField:D,idField:P,getLogFrameLabels:M,getLogFrameLabelsAsLabels:M,getLabelFieldName:()=>C?.name??null,extraFields:I}}function o(f,E,h){const y=f.getFieldByName(E);if(y!==void 0)return y.type===h?y:void 0}const d="timestamp",c="body",a="severity",p="id",u="labels";function m(f){const E={};return Object.entries(f).forEach(([h,y])=>{E[h]=typeof y=="string"?y:JSON.stringify(y)}),E}function v(f){const E=new n.L(f),h=o(E,d,s.PU.time),y=o(E,c,s.PU.string);if(h===void 0||y===void 0)return null;const b=o(E,a,s.PU.string)??null,D=o(E,p,s.PU.string)??null,P=o(E,u,s.PU.other)??null,C=P===null?null:P.values,M=E.fields.filter((I,R)=>R!==h.index&&R!==y.index&&R!==b?.index&&R!==D?.index&&R!==P?.index);return{timeField:h,bodyField:y,severityField:b,idField:D,getLogFrameLabels:()=>C,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>C!==null?C.map(m):null,getLabelFieldName:()=>P!==null?P.name:null,extraFields:M}}function x(f){return f.meta?.type===l.m.LogLines?v(f):g(f)}},69147:(k,A,e)=>{"use strict";e.d(A,{yR:()=>R,cZ:()=>T,HT:()=>z,M0:()=>w,ct:()=>B,f8:()=>oe,J9:()=>K,Wr:()=>Q,sg:()=>_});var n=e(2543),s=e(88483),l=e(50832),r=e(65474),i=e(9557),g=e(52622),o=e(14236),d=e(85404),c=e(11261),a=e(24293),p=e(47232),u=e(8249),m=e(80997),v=e(72724),x=e(65879),f=e(39070),E=e(26517),h=e(32264),y=e(24284),b=e(88838),D=e(2913);function P(J,ee){return D.Ay.bootData?.user?.lightTheme?ee:J}var C=e(98101),M=e(91002);const I="Line limit",R="Common labels",T={[i.$b.critical]:y.Tj[7],[i.$b.error]:y.Tj[4],[i.$b.warning]:y.Tj[1],[i.$b.info]:y.Tj[0],[i.$b.debug]:y.Tj[5],[i.$b.trace]:y.Tj[2],[i.$b.unknown]:P("#8e8e8e","#bdc4cd")},S=1,L=1e3*S,O=60*L,j=60*O,N=24*j,F=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function U(J,ee,de){switch(de){case g.fY.exact:return J.entry.replace(F,"")===ee.entry.replace(F,"");case g.fY.numbers:return J.entry.replace(/\d/g,"")===ee.entry.replace(/\d/g,"");case g.fY.signature:return J.entry.replace(/\w/g,"")===ee.entry.replace(/\w/g,"");default:return!1}}function w(J,ee){return ee===g.fY.none?J:J.reduce((de,xe,re)=>{const ue={...xe},Te=de[de.length-1];return re>0&&U(xe,Te,ee)?Te.duplicates++:(ue.duplicates=0,de.push(ue)),de},[])}function B(J,ee){return ee.size===0?J:J.filter(de=>!ee.has(de.logLevel))}function K(J,ee){const de={},xe=[];for(const re of J){let ue=de[re.logLevel];ue||(de[re.logLevel]=ue={lastTs:null,datapoints:[],target:re.logLevel,color:T[re.logLevel]},xe.push(ue));const Te=Math.floor(re.timeEpochMs/ee)*ee;Te===ue.lastTs?ue.datapoints[ue.datapoints.length-1][0]++:(ue.datapoints.push([1,Te]),ue.lastTs=Te);for(const ge of xe)ge!==ue&&ge.lastTs!==Te&&(ge.datapoints.push([0,Te]),ge.lastTs=Te)}return xe.map((re,ue)=>{re.datapoints.sort((Ue,Xe)=>Ue[1]-Xe[1]);const Te=(0,o.Vc)(re),Oe=new d.L(Te).getFirstFieldOfType(c.PU.number);return Te.fields[Oe.index].config.min=0,Te.fields[Oe.index].config.decimals=0,Te.fields[Oe.index].config.color={mode:a.Y.Fixed,fixedColor:re.color},Te.fields[Oe.index].config.custom={drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:re.color,pointColor:re.color,fillColor:re.color,lineWidth:0,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}},Te})}function W(J){return J.fields.some(ee=>ee.type===c.PU.time)&&J.fields.some(ee=>ee.type===c.PU.string)}function z(J,ee,de,xe,re){const{logSeries:ue}=X(J),Te=G(ue,xe,!!re);if(Te){if(ee&&Te.rows.length>0){const ge=Te.rows.sort(M.M1),{visibleRange:Oe,bucketSize:Ue,visibleRangeMs:Xe,requestedRangeMs:we}=Y(ge,ee,de);Te.visibleRange=Oe,Te.bucketSize=Ue,Te.series=K(ge,Ue),Te.meta&&(Te.meta=te(Te,Xe,we))}else Te.series=[];return Te.queries=xe,Te}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:xe}}function Y(J,ee,de,xe=20,re=1e3){let ue=de,Te=ee,ge=Math.max(Te*xe,re),Oe,Ue;if(de){const Xe=J[0].timeEpochMs;if(Ue=de.to-de.from,Oe=de.to-Xe,Oe>0){const we=Oe/Ue;Te*=we,ge=Math.max(Math.ceil(Te*xe),re),ue={from:Math.floor(Xe/ge)*ge,to:de.to}}else Oe=1}return{bucketSize:ge,visibleRange:ue,visibleRangeMs:Oe,requestedRangeMs:Ue}}function X(J){const ee=[],de=[];for(const xe of J){if(W(xe)||!xe.fields.length){de.push(xe);continue}xe.length>0&&ee.push(xe)}return{logSeries:de,metricSeries:ee}}function q(J,ee,de){const xe=J.values[de],ue=(0,p.yT)(xe).valueOf();if(ee)return{ts:xe,timeEpochMs:ue,timeEpochNs:ee.values[de]};if(J.nanos!==void 0){const Te=J.nanos[de].toString().padStart(6,"0"),ge=`${ue}${Te}`;return{ts:xe,timeEpochMs:ue,timeEpochNs:ge}}return{ts:xe,timeEpochMs:ue,timeEpochNs:ue+"000000"}}function G(J,ee=[],de=!1){if(J.length===0)return;const xe=[];let re=[];const ue=J.filter(Fe=>Fe.fields.length);ue.length&&ue.forEach(Fe=>{const at=(0,C.O)(Fe);if(at!=null){const Ct=at.getLogFrameLabelsAsLabels()??void 0,Dt={rawFrame:Fe,logsFrame:at,frameLabels:Ct};re.push(Dt),Ct&&Ct.length>0&&xe.push(Ct)}});const Te=xe.flat(),ge=Te.length>0?(0,u.yO)(Te):{};let Oe=[],Ue=!1;const Xe=(0,M.kA)();for(const Fe of re){const{logsFrame:at,rawFrame:Ct,frameLabels:Dt}=Fe,{timeField:tt,timeNanosecondField:ze,bodyField:pe,severityField:Se,idField:fe}=at;for(let Ee=0;Ee<Ct.length;Ee++){const{ts:Pe,timeEpochMs:he,timeEpochNs:be}=q(tt,ze??void 0,Ee),Ae=pe.values[Ee]??"",De=typeof Ae=="string"?Ae:JSON.stringify(Ae),Ie=m.sQ.hasAnsiCodes(De),ke=!!De.match(/\\n|\\t|\\r/),dt=Ct.meta?.custom?.searchWords??Ct.meta?.searchWords??[],Pt=Ie?b.DB.strip(De):De,pt=Dt?.[Ee],Tt=(0,u.s6)(pt,ge);Object.keys(Tt).length>0&&(Ue=!0);let jt=i.$b.unknown;const $t=Se&&Se.values[Ee]||pt&&pt.level;typeof $t=="number"||typeof $t=="string"?jt=(0,M.EK)($t):jt=(0,M.XM)(Pt);const sn=ee.find(qt=>qt.refId===Ct.refId)?.datasource?.type,Yt={entryFieldIndex:pe.index,rowIndex:Ee,dataFrame:Ct,logLevel:jt,timeFromNow:(0,v.fq)(Pe),timeEpochMs:he,timeEpochNs:be,timeLocal:(0,v.LE)(Pe,{timeZone:"browser"}),timeUtc:(0,v.LE)(Pe,{timeZone:"utc"}),uniqueLabels:Tt,hasAnsi:Ie,hasUnescapedContent:ke,searchWords:dt,entry:Pt,raw:De,labels:pt||{},uid:`${Ct.refId}_${fe?fe.values[Ee]:Ee.toString()}`,datasourceType:sn};fe!==null&&(Yt.rowId=fe.values[Ee]),!(de&&Xe(Yt))&&Oe.push(Yt)}}const we=[];(0,n.size)(ge)>0&&we.push({label:R,value:ge,kind:i.tG.LabelsMap});const We=J.filter(Fe=>Fe?.meta?.custom?.limit??Fe?.meta?.limit).reduce((Fe,at)=>(Fe[at.refId??""]=at.meta?.custom?.limit??at.meta?.limit??0,Fe),{}),Ce=Object.values(We).reduce((Fe,at)=>Fe+=at,0);Ce>0&&we.push({label:I,value:Ce,kind:i.tG.Number});let je=0;const Ke={};let _e=!1;for(const Fe of J){const at=Fe.meta?.custom?.lokiQueryStatKey,{refId:Ct}=Fe;if(!_e&&Fe.meta?.custom?.error&&(we.push({label:"",value:Fe.meta?.custom.error,kind:i.tG.Error}),_e=!0),Ct&&!Ke[Ct]){if(at&&Fe.meta?.stats){const Dt=Fe.meta.stats.find(tt=>tt.displayName===at);Dt&&(je+=Dt.value)}Ke[Ct]=!0}}if(je>0){const{text:Fe,suffix:at}=(0,E.rT)("B")(je);we.push({label:"Total bytes processed",value:`${Fe} ${at}`,kind:i.tG.String})}return{hasUniqueLabels:Ue,meta:we,rows:Oe}}function te(J,ee,de){if(!J.meta)return[];let xe=[...J.meta];const re=xe.findIndex(Te=>Te.label===I),ue=re>=0&&xe[re]?.value;if(ue&&typeof ue=="number"&&ue>0){let Te;if(ue===J.rows.length&&ee&&de){const ge=(ee/de*100).toFixed(2);Te=`${ue} reached, received logs cover ${ge}% (${x.msRangeToTimeString(ee)}) of your selected time range (${x.msRangeToTimeString(de)})`}else{const ge=h.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";Te=`${ue} (${J.rows.length} ${ge})`}xe[re]={label:I,value:Te,kind:i.tG.String}}return xe}function H(J,ee){const de=ee&&J===i.$b.unknown?"logs":J,xe=T[J];return{displayNameFromDS:de,color:{mode:a.Y.Fixed,fixedColor:xe},custom:{drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,lineColor:xe,pointColor:xe,fillColor:xe,lineWidth:1,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}}}}const se=(J,ee,de)=>(J.fields=J.fields.map(xe=>(xe.type===c.PU.number&&(xe.config={...xe.config,...H(ee(J),de)}),xe)),J);function ne(J){let ee;try{ee=new d.L(J).getFirstFieldOfType(c.PU.number)}catch{}return ee?.labels?le(ee.labels):i.$b.unknown}function le(J){const ee=J.level??J.lvl??J.loglevel??"";return ee?(0,M.EK)(ee):i.$b.unknown}function _(J,ee,de){const xe=ee.range,re=de.targets,ue=ne,Te=xe.to.valueOf()-xe.from.valueOf(),ge=ae(ee.scopedVars,Te);return ee.interval=ge.interval,ee.scopedVars.__interval={value:ge.interval,text:ge.interval},ge.intervalMs!==void 0&&(ee.intervalMs=ge.intervalMs,ee.scopedVars.__interval_ms={value:ge.intervalMs,text:ge.intervalMs}),ee.hideFromInspector=!0,new s.c(Oe=>{let Ue=[];Oe.next({state:f.Gu.Loading,error:void 0,data:[]});const Xe=J.query(ee),qe=((0,l.A)(Xe)?Xe:(0,r.H)(Xe)).subscribe({complete:()=>{Oe.complete()},next:We=>{const{error:Ce}=We;if(Ce!==void 0)Oe.next({state:f.Gu.Error,error:Ce,data:[]}),Oe.error(Ce);else{const je=(0,n.groupBy)(We.data,"refId");Ue=We.data.map(Ke=>{if(Ke.meta?.dataTopic===g.QR.Annotations)return Ke;let _e=Ke.refId||"";_e.startsWith("log-volume-")&&(_e=_e.substr(11));const Fe={logsVolumeType:i.Aj.FullRange,absoluteRange:{from:xe.from.valueOf(),to:xe.to.valueOf()},datasourceName:J.name,sourceQuery:re.find(at=>at.refId===_e)};return Ke.meta={...Ke.meta,custom:{...Ke.meta?.custom,...Fe}},se(Ke,ue,je[Ke.refId].length===1)}),Oe.next({state:We.state,error:void 0,data:Ue})}},error:We=>{Oe.next({state:f.Gu.Error,error:We,data:[]}),Oe.error(We)}});return()=>{qe?.unsubscribe()}})}function Q(J,ee){return ee.hideFromInspector=!0,new s.c(de=>{let xe=[];de.next({state:f.Gu.Loading,error:void 0,data:[]});const re=J.query(ee),Te=((0,l.A)(re)?re:(0,r.H)(re)).subscribe({complete:()=>{de.next({state:f.Gu.Done,error:void 0,data:xe}),de.complete()},next:ge=>{const{error:Oe}=ge;Oe!==void 0?(de.next({state:f.Gu.Error,error:Oe,data:[]}),de.error(Oe)):xe=ge.data.map(Ue=>{const Xe=(0,o.Vc)(Ue),{timeIndex:we}=(0,o.KR)(Xe);return(0,o.ES)(Xe,we)})},error:ge=>{de.next({state:f.Gu.Error,error:ge,data:[]}),de.error(ge)}});return()=>{Te?.unsubscribe()}})}function ae(J,ee){if(J.__interval_ms){let de=J.__interval_ms.value,xe="";return ee<L*5?(de=S,xe="1ms"):de>j?(de=N,xe="1d"):de>O?(de=j,xe="1h"):de>L?(de=O,xe="1m"):(de=L,xe="1s"),{interval:xe,intervalMs:de}}else return{interval:"$__interval"}}function oe(J){const ee=J.dataFrame;return ee.length===0||ee.length<=J.rowIndex?null:(0,o.EI)({fields:ee.fields.map(xe=>({...xe,values:[xe.values[J.rowIndex]]})),refId:ee.refId})}},91002:(k,A,e)=>{"use strict";e.d(A,{Dg:()=>D,Dk:()=>R,Dm:()=>M,Dx:()=>P,EK:()=>a,Ei:()=>h,Hw:()=>b,M1:()=>v,Tj:()=>p,XM:()=>c,a8:()=>S,e3:()=>I,kA:()=>L,oR:()=>E,oT:()=>C,qR:()=>y,s2:()=>u,tX:()=>T,zy:()=>f});var n=e(2543),s=e.n(n),l=e(9557),r=e(52622),i=e(37471),g=e(11261),o=e(85404),d=e(70377);function c(O){if(!O)return l.$b.unknown;let j=l.$b.unknown,N;for(const[F,U]of Object.entries(l.$b)){const B=new RegExp(`\\b${F}\\b`,"i").exec(O);B&&(N===void 0||B.index<N)&&(j=U,N=B.index)}return j}function a(O){const j=l.$b[O.toString().toLowerCase()];if(j)return j;if(typeof O=="string"){const N=parseInt(O,10);if(O.length===N.toString().length)return l.s5[O]||l.$b.unknown}else if(typeof O=="number")return l.s5[O]||l.$b.unknown;return l.$b.unknown}function p(O,j){const N=O.filter(w=>w.labels[j]!==void 0),F=N.length,U=(0,n.countBy)(N,w=>w.labels[j]);return m(U,F)}function u(O){const j=O.filter(F=>F!=null),N=(0,n.countBy)(j);return m(N,j.length)}const m=(O,j)=>(0,n.chain)(O).map((N,F)=>({count:N,value:F,proportion:N/j})).sortBy("count").reverse().value(),v=(O,j)=>O.timeEpochMs<j.timeEpochMs?-1:O.timeEpochMs>j.timeEpochMs?1:O.timeEpochNs<j.timeEpochNs?-1:O.timeEpochNs>j.timeEpochNs?1:0,x=(O,j)=>O.timeEpochMs>j.timeEpochMs?-1:O.timeEpochMs<j.timeEpochMs?1:O.timeEpochNs>j.timeEpochNs?-1:O.timeEpochNs<j.timeEpochNs?1:0,f=(O,j)=>{const N=O?E(O.rows,j):[];return O?{...O,rows:N}:{hasUniqueLabels:!1,rows:N}},E=(O,j)=>j===r.uH.Ascending?O.sort(v):O.sort(x),h=O=>O.labels.__error__?{hasError:!0,errorMessage:O.labels.__error__}:{hasError:!1},y=O=>O.labels.__adaptive_logs_sampled__?{isSampled:!0,sampleMessage:O.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${O.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`}:{isSampled:!1},b=O=>O.replace(/\\r\\n|\\n|\\t|\\r/g,j=>j.slice(1)==="t"?"	":`
`);function D(O){return O.map(j=>{const N=(0,d.FE)(j).reduce((F,U)=>{const w=U.keys[0];return F[w]=U.values[0],F},{});return{line:j.entry,timestamp:j.timeEpochNs,fields:{...N,...j.labels}}})}const P=O=>{let j={from:1/0,to:-1/0};return O.forEach(N=>{const F=N.meta?.custom||{};F.absoluteRange?.from&&F.absoluteRange?.to&&(j={from:Math.min(j.from,F.absoluteRange.from),to:Math.max(j.to,F.absoluteRange.to)})}),j},C=O=>{if(O.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const j={},N={};let F=-1/0;const U={};let w=[];return O.forEach(B=>{const{level:K,valueField:W,timeField:z,length:Y}=T(B);U[K]={meta:B.meta,valueFieldConfig:W.config,timeFieldConfig:z.config};for(let X=0;X<Y;X++){const q=z.values[X],G=W.values[X];j[K]??={},j[K][q]=(j[K][q]||0)+G,N[q]=(N[q]||0)+G,F=Math.max(N[q],F)}}),Object.keys(j).forEach(B=>{const K=new i.k,{meta:W,timeFieldConfig:z,valueFieldConfig:Y}=U[B];K.name=B,K.meta=W,K.addField({name:"Time",type:g.PU.time,config:z}),K.addField({name:"Value",type:g.PU.number,config:Y}),Object.entries(j[B]).sort((X,q)=>Number(X[0])-Number(q[0])).forEach(([X,q])=>{K.add({Time:Number(X),Value:q})}),w.push(K)}),{dataFrames:w,maximum:F}},M=O=>{const j=O[0]?.meta?.custom;return j&&j.datasourceName?{name:j.datasourceName}:null},I=O=>O[0]?.meta?.custom?.logsVolumeType===l.Aj.Limited,R=async(O,j)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(O);{const N=document.createElement("textarea");j.current?.appendChild(N),N.value=O,N.focus(),N.select(),document.execCommand("copy"),N.remove()}};function T(O){const j=new o.L(O),N=j.getFirstFieldOfType(g.PU.time),F=j.getFirstFieldOfType(g.PU.number);if(!N)throw new Error("Missing time field");if(!F)throw new Error("Missing value field");const U=F.config.displayNameFromDS||O.name||"logs",w=F.values.length;return{level:U,valueField:F,timeField:N,length:w}}function S(O){return O instanceof Element}function L(){const O=new Set;return function(j){let N=`${j.dataFrame.refId}_${j.rowId?j.rowId:`${j.timeEpochNs}_${j.entry}`}`;return O.has(N)?!0:(O.add(N),!1)}}},90591:(k,A,e)=>{"use strict";e.d(A,{m:()=>o});var n=e(74848),s=e(32196),l=e(40845),r=e(96374),i=e(8484);const g=({title:c})=>{const a=(0,l.of)(d);return(0,n.jsx)("p",{className:a.description,children:c?(0,i.t)("public-dashboard.delete-modal.revoke-nonorphaned-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public."):(0,i.t)("public-dashboard.delete-modal.revoke-orphaned-body-text","Orphaned public dashboard will no longer be public.")})},o=({dashboardTitle:c,onConfirm:a,onDismiss:p})=>{const u=(0,i.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,n.jsx)(r.u,{isOpen:!0,body:(0,n.jsx)(g,{title:c}),onConfirm:a,onDismiss:p,title:u,icon:"trash-alt",confirmText:u})},d=c=>({title:(0,s.css)`
    margin-bottom: ${c.spacing(1)};
  `,description:(0,s.css)`
    font-size: ${c.typography.body.fontSize};
  `})},71500:(k,A,e)=>{"use strict";e.d(A,{P:()=>r});var n=e(24439);class s extends Error{constructor(g,o){super(o),this.type=g}}class l{constructor(){this.rootName="general"}validateNewDashboardName(g,o){return this.validate(g,o,"A dashboard or a folder with the same name already exists")}validateNewFolderName(g){return this.validate(this.rootName,g,"A folder or dashboard in the general folder with the same name already exists")}async validate(g,o,d){o=(o||"").trim();const c=o.toLowerCase();if(o.length===0)throw new s("REQUIRED","Name is required");if(c===this.rootName)throw new s("EXISTING","This is a reserved name and cannot be used for a folder.");const p=await(0,n.getGrafanaSearcher)().search({kind:["dashboard"],query:o,location:g||"general"});for(const u of p.view)if(c===u.name.toLowerCase())throw new s("EXISTING",d)}}const r=new l},11230:(k,A,e)=>{"use strict";e.d(A,{A_:()=>U,FG:()=>b,Q9:()=>D,Ql:()=>N,c0:()=>j,iP:()=>u,rw:()=>p,vV:()=>S});var n=e(17172),s=e(19347),l=e(82467),r=e(3169),i=e(55314),g=e(28676),o=e(31678),d=e(57767),c=e(98796),a=e(88264);function p(B){return async K=>{try{K((0,a.f7)());const W=await(0,n.AI)().get(`/api/gnet/dashboards/${B}`);await K(h(W.json)),await K(x(W)),K(E())}catch(W){K((0,a.oQ)()),(0,n.NF)(W)&&K((0,l.dx)((0,r.gi)(W.data.message||W)))}}}function u(B){return async K=>{await K(h(B)),await K(f(B)),K(E())}}const m=(B,K)=>B?.usage?.libraryPanels?.filter(W=>K.inputs.libraryPanels.some(z=>z.state!==a.J7.Exists&&z.model.uid===W.uid));function v(B,K){let W=B.__inputs;if(K.inputs.libraryPanels?.length){const z=[];B.__inputs?.forEach(Y=>{if(!Y?.usage?.libraryPanels){z.push(Y);return}const X=m(Y,K);Y.usage={libraryPanels:X},!!X?.length&&z.push(Y)}),W=z}return{...B,__inputs:W}}function x(B){return(K,W)=>{const z=W().importDashboard,Y=v(B.json,z);K((0,a.Rp)({...B,json:Y}))}}function f(B){return(K,W)=>{const z=W().importDashboard,Y=v(B,z);K((0,a.dd)(Y))}}function E(){return(B,K)=>{const W=K().importDashboard.dashboard;if(W&&W.__inputs){const z=[];W.__inputs.forEach(Y=>{const X={name:Y.name,label:Y.label,info:Y.description,value:Y.value,type:Y.type,pluginId:Y.pluginId,options:[]};X.description=C(Y),Y.type===a.NZ.DataSource?P(Y,X):X.info||(X.info="Specify a string constant"),z.push(X)}),B((0,a.y3)(z))}}}function h(B){return async function(K){const W=await y(B);K((0,a.dW)(W))}}async function y(B){if(!B||!B.__elements)return[];const K=[];for(const W of Object.values(B.__elements)){if(W.kind!==c.i.Panel)continue;const z=W.model,{type:Y,description:X}=z,{uid:q,name:G}=W,te={model:{model:z,uid:q,name:G,version:0,type:Y,kind:c.i.Panel,description:X},state:a.J7.New};try{const H=await(0,d.Yr)(q,!0);te.state=a.J7.Exists,te.model=H}catch(H){if(H.status!==404)throw H}K.push(te)}return K}function b(){return B=>{B((0,a.SN)())}}function D(B){return async(K,W)=>{const z=W().importDashboard.dashboard,Y=W().importDashboard.inputs,X=[];B.dataSources?.forEach((q,G)=>{const te=Y.dataSources[G];X.push({name:te.name,type:te.type,pluginId:te.pluginId,value:q.uid})}),B.constants?.forEach((q,G)=>{const te=Y.constants[G];X.push({value:q,name:te.name,type:te.type})}),K(i.cU.endpoints.importDashboard.initiate({dashboard:{...z,title:B.title,uid:B.uid||z.uid},overwrite:!0,inputs:X,folderUid:B.folder.uid}))}}const P=(B,K)=>{(0,s.l)().getList({pluginId:B.pluginId}).length===0?K.info="No data sources of type "+B.pluginName+" found":K.info||(K.info="Select a "+B.pluginName+" data source")},C=B=>{if(B.usage&&B.usage.libraryPanels)return`List of affected library panels: ${B.usage.libraryPanels.reduce((W,z,Y)=>Y===0?z.name:`${W}, ${z.name}`,"")}`};async function M(B,K){const W={totalCount:B.length,successCount:0};for(const z of B)try{await L(z,K)!==null&&(W.successCount+=1)}catch(Y){console.error("Failed to move a folder",Y)}return W}function I(B,K,...W){return async z=>{try{const Y=await B(...W);return Array.prototype.concat(z,[Y])}catch(Y){if(K)return z;throw Y}}}function R(B,K){const W=[];for(const z of B)W.push(I(T,!0,z,!0));for(const z of K)W.push(I(U,!0,z,!0));return w(W)}function T(B,K){return getBackendSrv().delete(`/api/folders/${B}?forceDeleteRules=false`,void 0,{showSuccessAlert:K})}function S(B){return(0,n.AI)().post("/api/folders",B)}function L(B,K){const W={parentUid:K.uid};return getBackendSrv().post(`/api/folders/${B}/move`,W,{showErrorAlert:!1})}const O=1e3;function j(B,K,W=o.SearchQueryType.Folder){return(0,n.AI)().get("/api/search",{query:B,type:W,permission:K,limit:O})}function N(B){return(0,n.AI)().get(`/api/folders/${B}`)}function F(B){return getBackendSrv().get(`/api/folders/id/${B}`)}function U(B,K){return(0,g.n)().deleteDashboard(B,K)}function w(B){return B.reduce((K,W)=>Promise.resolve(K).then(W),[])}},88264:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>f,J7:()=>i,NZ:()=>r,Rp:()=>a,SN:()=>d,V9:()=>g,dW:()=>u,dd:()=>p,f7:()=>v,oQ:()=>m,qx:()=>l,y3:()=>c});var n=e(65307),s=e(39070),l=(E=>(E[E.Gcom=0]="Gcom",E[E.Json=1]="Json",E))(l||{}),r=(E=>(E.DataSource="datasource",E.Constant="constant",E.LibraryPanel="libraryPanel",E))(r||{}),i=(E=>(E.New="new",E.Exists="exists",E.Different="different",E))(i||{});const g={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:s.Gu.NotStarted},o=(0,n.Z0)({name:"manageDashboards",initialState:g,reducers:{setGcomDashboard:(E,h)=>{E.dashboard={...h.payload.json,id:null},E.meta={updatedAt:h.payload.updatedAt,orgName:h.payload.orgName},E.source=0,E.state=s.Gu.Done},setJsonDashboard:(E,h)=>{E.dashboard={...h.payload,id:null},E.meta=g.meta,E.source=1,E.state=s.Gu.Done},clearDashboard:E=>{E.dashboard={},E.state=s.Gu.NotStarted},setInputs:(E,h)=>{E.inputs={dataSources:h.payload.filter(y=>y.type==="datasource"),constants:h.payload.filter(y=>y.type==="constant"),libraryPanels:E.inputs.libraryPanels||[]}},setLibraryPanelInputs:(E,h)=>{E.inputs.libraryPanels=h.payload},fetchFailed:E=>{E.dashboard={},E.state=s.Gu.Error},fetchDashboard:E=>{E.state=s.Gu.Loading}}}),{clearDashboard:d,setInputs:c,setGcomDashboard:a,setJsonDashboard:p,setLibraryPanelInputs:u,fetchFailed:m,fetchDashboard:v}=o.actions,f={importDashboard:o.reducer}},59120:(k,A,e)=>{"use strict";e.d(A,{O5:()=>b,r3:()=>m,dX:()=>E,hZ:()=>d,ri:()=>p,WH:()=>h,AC:()=>c,YX:()=>f,bM:()=>y,SM:()=>o,M8:()=>x,YD:()=>u,aD:()=>v});var n=e(75816),s=e(75505),l=e(17172);function r({baseURL:P}){async function C(M){try{const{data:I,...R}=await(0,s.s)((0,l.AI)().fetch({...M,url:P+M.url,showErrorAlert:!1,data:M.body}));return{data:I,meta:R}}catch(I){return M.manageError?M.manageError(I):{error:I}}}return C}const g=(0,n.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:r({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:P=>({getSessionList:P.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:P.mutation({query:C=>({url:"/cloudmigration/migration",method:"POST",body:C.cloudMigrationSessionRequestDto})}),deleteSession:P.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}`,method:"DELETE"})}),getSession:P.query({query:C=>({url:`/cloudmigration/migration/${C.uid}`})}),createSnapshot:P.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot`,method:"POST"})}),getSnapshot:P.query({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot/${C.snapshotUid}`,params:{resultPage:C.resultPage,resultLimit:C.resultLimit}})}),cancelSnapshot:P.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot/${C.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:P.mutation({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshot/${C.snapshotUid}/upload`,method:"POST"})}),getShapshotList:P.query({query:C=>({url:`/cloudmigration/migration/${C.uid}/snapshots`,params:{page:C.page,limit:C.limit}})}),getCloudMigrationToken:P.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:P.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:P.mutation({query:C=>({url:`/cloudmigration/token/${C.uid}`,method:"DELETE"})}),getDashboardByUid:P.query({query:C=>({url:`/dashboards/uid/${C.uid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:o,useCreateSessionMutation:d,useDeleteSessionMutation:c,useGetSessionQuery:a,useCreateSnapshotMutation:p,useGetSnapshotQuery:u,useCancelSnapshotMutation:m,useUploadSnapshotMutation:v,useGetShapshotListQuery:x,useGetCloudMigrationTokenQuery:f,useCreateCloudMigrationTokenMutation:E,useDeleteCloudMigrationTokenMutation:h,useGetDashboardByUidQuery:y}=g,b=g.enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getDashboardByUid:D}});function D(P){if(!P.query)return;const C=P.query;P.query=(...M)=>{const I=C(...M);return I.showErrorAlert=!1,I}}},32931:(k,A,e)=>{"use strict";e.d(A,{EC:()=>o,L_:()=>i,YS:()=>r,bA:()=>g,wV:()=>d});var n=e(17172),s=e(82467),l=e(10943);function r(c={getBackendSrv:n.AI}){return async a=>{const p=await c.getBackendSrv().get("/api/org");return a((0,l.bK)(p)),p}}function i(c={getBackendSrv:n.AI}){return async(a,p)=>{const u=p().organization.organization;await c.getBackendSrv().put("/api/org",{name:u.name}),a((0,s.YA)(u.name)),a(r(c))}}function g(c,a={getBackendSrv:n.AI}){return async p=>{const u=await a.getBackendSrv().post("/api/user/using/"+c);p((0,s.YA)(u.name))}}function o(c,a={getBackendSrv:n.AI}){return async p=>{const u=await a.getBackendSrv().post("/api/orgs/",c);p(g(u.orgId))}}function d(c={getBackendSrv:n.AI}){return async a=>{const p=await c.getBackendSrv().get("/api/user/orgs");return a((0,l.Bz)(p)),p}}},10943:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>d,Bz:()=>g,bK:()=>i,n:()=>r});var n=e(65307);const s={organization:{},userOrgs:[]},l=(0,n.Z0)({name:"organization",initialState:s,reducers:{organizationLoaded:(c,a)=>({...c,organization:a.payload}),setOrganizationName:(c,a)=>({...c,organization:{...c.organization,name:a.payload}}),userOrganizationsLoaded:(c,a)=>({...c,userOrgs:a.payload})}}),{setOrganizationName:r,organizationLoaded:i,userOrganizationsLoaded:g}=l.actions,d={organization:l.reducer}},17888:(k,A,e)=>{"use strict";e.d(A,{a:()=>b});var n=e(74848),s=e(32196),l=e(47070),r=e(41987),i=e(13544),g=e(39601),o=e(40845),d=e(79041),c=e(96540),a=e(14578);const p=c.forwardRef(({icon:C,children:M,onClick:I,...R},T)=>{const S=(0,o.of)(u);return(0,n.jsxs)("button",{...R,className:S.action,onClick:I,children:[(0,n.jsx)(a.I,{name:C,size:"xl"}),M]})});p.displayName="CardButton";const u=C=>({action:(0,s.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:C.colors.background.secondary,borderRadius:C.shape.radius.default,color:C.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:C.colors.emphasize(C.colors.background.secondary)}})});var m=e(15054),v=e(33390),x=e(53466),f=e(32696),E=e(14792),h=e(31678),y=e(79971);function b(C){const M=(0,o.of)(P),I=(0,d.d2)(),R=new l.v2(C.data),{dataSummary:T}=R,S=D(C,T),L=(0,h.useDispatch)(),O=(0,E.UA)().getCurrent()?.getPanelById(C.panelId),j=()=>{v.A.setObject(m.wV,f.__.Suggestions),L((0,x.eK)(!0))},N=()=>{O&&L((0,y.gW)({panel:O,pluginId:"table"}))},F=U=>{O&&(L((0,y.gW)({...U,panel:O})),U.transformations&&setTimeout(()=>{g.Ny.partial({tab:"transform"})},100))};return(0,n.jsxs)("div",{className:M.wrapper,children:[(0,n.jsx)("div",{className:M.message,"data-testid":i.Tp.components.Panels.Panel.PanelDataErrorMessage,children:S}),I.app===r.Jk.PanelEditor&&T.hasData&&O&&(0,n.jsxs)("div",{className:M.actions,children:[C.suggestions&&(0,n.jsx)(n.Fragment,{children:C.suggestions.map(U=>(0,n.jsx)(p,{icon:"process",onClick:()=>F(U),children:U.name},U.name))}),(0,n.jsx)(p,{icon:"table",onClick:N,children:"Switch to table"}),(0,n.jsx)(p,{icon:"chart-line",onClick:j,children:"Open visualization suggestions"})]})]})}function D({data:C,fieldConfig:M,message:I,needsNumberField:R,needsTimeField:T,needsStringField:S},L){return I||(!C.series||C.series.length===0||C.series.every(O=>O.length===0)?M?.defaults.noValue??"No data":S&&!L.hasStringField?"Data is missing a string field":R&&!L.hasNumberField?"Data is missing a number field":T&&!L.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const P=C=>({wrapper:(0,s.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,s.css)({textAlign:"center",color:C.colors.text.secondary,fontSize:C.typography.size.lg,width:"100%"}),actions:(0,s.css)({marginTop:C.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:C.spacing(1),rowGap:C.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(k,A,e)=>{"use strict";e.d(A,{$:()=>c,W:()=>d});var n=e(74848),s=e(96540),l=e(65158),r=e(43429),i=e(42418),g=e(31678);class o extends s.PureComponent{constructor(p){super(p)}render(){const p={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,n.jsx)("div",{style:p,children:(0,n.jsx)(i.F,{severity:g.AppNotificationSeverity.Error,...this.props})})}}function d(a,p){const u=class extends s.PureComponent{render(){const x=(0,n.jsxs)(n.Fragment,{children:["Check the server startup logs for more information. ",(0,n.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,n.jsx)(o,{title:`Error loading: ${a.id}`,text:x})}},m=new l.m(u);return m.meta=a,m.loadError=!0,m}function c(a,p){const u=class extends s.PureComponent{render(){return(0,n.jsx)(o,{title:`Panel plugin not found: ${a}`})}},m=new l.m(p?()=>null:u);return m.meta={id:a,name:a,sort:100,type:r.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},m}},20726:(k,A,e)=>{"use strict";e.d(A,{m:()=>v});var n=e(74848),s=e(96540),l=e(1933),r=e(90708),i=e(13834),g=e(581),o=e(72574),d=e(40845),c=e(79041),a=e(66602),p=e(10096),u=e(15162);const m={defaults:{},overrides:[]};function v(f){const{pluginId:E,data:h,timeZone:y=(0,l.O)(),options:b={},width:D,height:P,title:C,onOptionsChange:M=()=>{},onChangeTimeRange:I=()=>{},onFieldConfigChange:R=()=>{},fieldConfig:T=m}=f,S=(0,d.$j)(),L=(0,o.w)(),O=(0,s.useMemo)(()=>L.replace.bind(L),[L]),[j,N]=(0,s.useState)((0,u.PY)(E)),[F,U]=(0,s.useState)(),w=x(j,b,T),{dataLinkPostProcessor:B}=(0,c.d2)(),K=(0,r.rJ)(j,w?.fieldConfig,h,y,S,O,B);if((0,s.useEffect)(()=>{j&&j.hasPluginId(E)||(0,u.TV)(E).then(z=>N(z)).catch(z=>{U(z.message)})},[E,j]),F)return(0,n.jsxs)("div",{children:["Failed to load plugin: ",F]});if(!j||!j.hasPluginId(E))return(0,n.jsx)("div",{children:"Loading plugin panel..."});if(!j.panel)return(0,n.jsx)("div",{children:"Seems like the plugin you are trying to load does not have a panel component."});if(!K)return(0,n.jsx)("div",{children:"No panel data"});const W=j.panel;return(0,n.jsx)(a.Xw,{dependencies:[j,h],children:(0,n.jsx)(i.a,{meta:j.meta,children:(0,n.jsx)(W,{id:1,data:K,title:C,timeRange:K.timeRange,timeZone:y,options:w.options,fieldConfig:T,transparent:!1,width:D,height:P,renderCounter:0,replaceVariables:z=>z,onOptionsChange:M,onFieldConfigChange:R,onChangeTimeRange:I,eventBus:p.lE})})})}function x(f,E,h){return(0,s.useMemo)(()=>{if(f)return(0,g.F)({plugin:f,currentOptions:E,currentFieldConfig:h,isAfterPluginChange:!1})},[f,h,E])}},25701:(k,A,e)=>{"use strict";e.d(A,{b:()=>x});var n=e(74848),s=e(32196),l=e(70255),r=e(43429),i=e(51527),g=e(13544),o=e(40845),d=e(29158),c=e(98624),a=e(72129),p=e(10803);const u=38,m=({isCurrent:y,title:b,plugin:D,onClick:P,onDelete:C,disabled:M,showBadge:I,description:R,children:T})=>{const S=(0,o.of)(E),L=M||D.state===r.pn.deprecated,O=(0,s.cx)({[S.item]:!0,[S.itemDisabled]:L,[S.current]:y});return(0,n.jsxs)("div",{className:O,"aria-label":g.Tp.components.PluginVisualization.item(D.name),"data-testid":g.Tp.components.PluginVisualization.item(D.name),onClick:L?void 0:P,title:y?"Click again to close this section":D.name,children:[(0,n.jsx)("img",{className:(0,s.cx)(S.img,{[S.disabled]:L}),src:D.info.logos.small,alt:""}),(0,n.jsxs)("div",{className:(0,s.cx)(S.itemContent,{[S.disabled]:L}),children:[(0,n.jsx)("div",{className:S.name,children:b}),R?(0,n.jsx)("span",{className:S.description,children:R}):null,T]}),I&&(0,n.jsx)("div",{className:(0,s.cx)(S.badge,{[S.disabled]:L}),children:(0,n.jsx)(h,{plugin:D})}),C&&(0,n.jsx)(d.K,{name:"trash-alt",onClick:j=>{j.stopPropagation(),C()},className:S.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"})]})};m.displayName="PanelTypeCard";const v=({children:y,hasDescription:b,hasDelete:D,rootProps:P})=>{const C=(0,o.of)(E),M=(0,o.of)(f);return(0,n.jsxs)("div",{className:C.item,...P,children:[(0,n.jsx)(l.A,{className:(0,s.cx)(C.img,M.image),width:u,height:u}),(0,n.jsxs)("div",{className:C.itemContent,children:[(0,n.jsx)("div",{className:C.name,children:(0,n.jsx)(l.A,{width:160})}),b?(0,n.jsx)(l.A,{containerClassName:C.description,width:80}):null,y]}),D&&(0,n.jsx)(l.A,{containerClassName:(0,s.cx)(C.deleteButton,M.deleteButton),width:16,height:16})]})},x=(0,a.j)(m,v),f=()=>({deleteButton:(0,s.css)({lineHeight:1}),image:(0,s.css)({lineHeight:1})}),E=y=>({item:(0,s.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:y.colors.background.secondary,borderRadius:y.shape.radius.default,boxShadow:y.shadows.z1,border:`1px solid ${y.colors.background.secondary}`,alignItems:"center",padding:y.spacing(1),width:"100%",overflow:"hidden",[y.transitions.handleMotion("no-preference","reduce")]:{transition:y.transitions.create(["background"],{duration:y.transitions.duration.short})},"&:hover":{background:y.colors.emphasize(y.colors.background.secondary,.03)}}),itemContent:(0,s.css)({overflow:"hidden",position:"relative",padding:y.spacing(0,1)}),itemDisabled:(0,s.css)({cursor:"default","&, &:hover":{background:y.colors.action.disabledBackground}}),current:(0,s.css)({label:"currentVisualizationItem",border:`1px solid ${y.colors.primary.border}`,background:y.colors.action.selected}),disabled:(0,s.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,s.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:y.typography.size.sm,fontWeight:y.typography.fontWeightMedium,width:"100%"}),description:(0,s.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:y.colors.text.secondary,fontSize:y.typography.bodySmall.fontSize,fontWeight:y.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,s.css)({maxHeight:u,width:u,display:"flex",alignItems:"center"}),badge:(0,s.css)({background:y.colors.background.primary}),deleteButton:(0,s.css)({cursor:"pointer",marginLeft:"auto"})}),h=({plugin:y})=>(0,i.x)(y.signature)?(0,n.jsx)(c.B,{status:y.signature}):(0,n.jsx)(p.p,{state:y.state});h.displayName="PanelPluginBadge"},56707:(k,A,e)=>{"use strict";e.d(A,{a:()=>h});var n=e(74848),s=e(32196),l=e(16817),r=e(70713),i=e(40845),g=e(47070),o=e(32264),d=e(15162);const c=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function a(D,P){const C=new g.v2(D,P);for(const I of c){const T=(await(0,d.TV)(I)).getSuggestionsSupplier();T&&T.getSuggestionsForData(C)}const M=C.getList();if(!o.$.featureToggles.vizAndWidgetSplit&&C.dataSummary.fieldCount===0)for(const I of Object.values(o.$.panels))!I.skipDataQuery||I.hideFromList||M.push({name:I.name,pluginId:I.id,description:I.info.description,cardOptions:{imgSrc:I.info.logos.small}});return M.sort((I,R)=>{if(C.dataSummary.preferredVisualisationType){if(I.pluginId===C.dataSummary.preferredVisualisationType)return-1;if(R.pluginId===C.dataSummary.preferredVisualisationType)return 1}return(R.score??g.nQ.OK)-(I.score??g.nQ.OK)})}var p=e(2543),u=e(13544),m=e(56034),v=e(20726);function x({data:D,suggestion:P,onChange:C,width:M}){const I=(0,i.of)(f),{innerStyles:R,outerStyles:T,renderWidth:S,renderHeight:L}=E(M),O=P.cardOptions??{},j={"aria-label":P.name,className:I.vizBox,"data-testid":u.Tp.components.VisualizationPreview.card(P.name),style:T,onClick:()=>{C({pluginId:P.pluginId,options:P.options,fieldConfig:P.fieldConfig})}};if(O.imgSrc)return(0,n.jsx)(m.m,{content:P.description??P.name,children:(0,n.jsxs)("button",{...j,className:(0,s.cx)(I.vizBox,I.imgBox),children:[(0,n.jsx)("div",{className:I.name,children:P.name}),(0,n.jsx)("img",{className:I.img,src:O.imgSrc,alt:P.name})]})});let N=P;return P.cardOptions?.previewModifier&&(N=(0,p.cloneDeep)(P),P.cardOptions.previewModifier(N)),(0,n.jsx)("button",{...j,children:(0,n.jsx)(m.m,{content:P.name,children:(0,n.jsxs)("div",{style:R,className:I.renderContainer,children:[(0,n.jsx)(v.m,{title:"",data:D,pluginId:P.pluginId,width:S,height:L,options:N.options,fieldConfig:N.fieldConfig}),(0,n.jsx)("div",{className:I.hoverPane})]})})})}const f=D=>({hoverPane:(0,s.css)({position:"absolute",top:0,right:0,left:0,borderRadius:D.spacing(2),bottom:0}),vizBox:(0,s.css)`
      position: relative;
      background: none;
      border-radius: ${D.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${D.colors.border.medium};

      transition: ${D.transitions.create(["background"],{duration:D.transitions.duration.short})};

      &:hover {
        background: ${D.colors.background.secondary};
      }
    `,imgBox:(0,s.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${D.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,s.css)`
      padding-bottom: ${D.spacing(.5)};
      margin-top: ${D.spacing(-1)};
      font-size: ${D.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${D.colors.text.secondary};
      font-weight: ${D.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,s.css)`
      max-width: ${D.spacing(8)};
      max-height: ${D.spacing(8)};
    `,renderContainer:(0,s.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function E(D){const C=D,M=D*(1/1.6),I=350,R=I*(1/1.6),T=6,S=(C-T*2)/I,L=(M-T*2)/R;return{renderHeight:R,renderWidth:I,outerStyles:{width:C,height:M},innerStyles:{width:I,height:R,transform:`scale(${S}, ${L})`}}}function h({searchQuery:D,onChange:P,data:C,panel:M}){const I=(0,i.of)(b),{value:R}=(0,l.A)(()=>a(C,M),[C,M]),T=y(D,R);return(0,n.jsx)("div",{children:(0,n.jsx)(r.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:S})=>{if(!S)return null;S=S-1;const L=Math.floor(S/200),O=8*(L-1),j=Math.floor((S-O)/L);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:I.filterRow,children:(0,n.jsx)("div",{className:I.infoText,children:"Based on current data"})}),(0,n.jsxs)("div",{className:I.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${j}px)`},children:[T.map((N,F)=>(0,n.jsx)(x,{data:C,suggestion:N,onChange:P,width:j-1},F)),D&&T.length===0&&(0,n.jsx)("div",{className:I.infoText,children:"No results matched your query"})]})]})}})})}function y(D,P){if(!D||!P)return P||[];const C=new RegExp(D,"i");return P.filter(M=>C.test(M.name)||C.test(M.pluginId))}const b=D=>({heading:(0,s.css)({...D.typography.h5,margin:D.spacing(0,.5,1)}),filterRow:(0,s.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,s.css)({fontSize:D.typography.bodySmall.fontSize,color:D.colors.text.secondary,fontStyle:"italic"}),grid:(0,s.css)({display:"grid",gridGap:D.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:D.spacing(1),justifyContent:"space-evenly"})})},86292:(k,A,e)=>{"use strict";e.d(A,{G:()=>c});var n=e(74848),s=e(32196),l=e(96540),r=e(32264),i=e(40845),g=e(41670),o=e(17706),d=e(48889);function c({pluginId:p,searchQuery:u,onChange:m,isWidget:v=!1}){const x=(0,i.of)(a),f=(0,l.useMemo)(()=>r.$.featureToggles.vizAndWidgetSplit?v?(0,o.nr)():(0,o.if)():(0,o.A4)(),[v]),E=(0,l.useMemo)(()=>(0,o.CO)(f,u,p),[f,u,p]);return E.length===0?(0,n.jsx)(g.Z,{children:"Could not find anything matching your query"}):(0,n.jsx)("div",{className:x.grid,children:E.map(h=>(0,n.jsx)(d.f,{disabled:!1,isCurrent:h.id===p,plugin:h,onClick:y=>m({pluginId:h.id,withModKey:y.metaKey||y.ctrlKey||y.altKey})},h.id))})}const a=p=>({grid:(0,s.css)({maxWidth:"100%",display:"grid",gridGap:p.spacing(.5)}),heading:(0,s.css)({...p.typography.h5,margin:p.spacing(0,.5,1)})})},48889:(k,A,e)=>{"use strict";e.d(A,{f:()=>l});var n=e(74848),s=e(25701);const l=({isCurrent:r,plugin:i,onClick:g,disabled:o})=>(0,n.jsx)(s.b,{title:i.name,plugin:i,description:i.info.description,onClick:g,isCurrent:r,disabled:o,showBadge:!0});l.displayName="VizTypePickerPlugin"},32349:(k,A,e)=>{"use strict";e.d(A,{CH:()=>d,E7:()=>o,EO:()=>g});var n=e(14236),s=e(83195),l=e(92461),r=e(32023),i=e(6923);const g=c=>{const a=c.field.links;if(!(!a||a.length===0))return{getLinks:p=>{const u={};if(c.view){const{dataFrame:v}=c.view;u.__series={value:{name:v.name,refId:v.refId},text:"Series"};const x=c.colIndex!==void 0?v.fields[c.colIndex]:void 0;if(x){if(u.__field={value:{name:x.name,labels:x.labels},text:"Field"},c.rowIndex!==void 0&&c.rowIndex>=0){const{timeField:f}=(0,n.KR)(v);u.__value={value:{raw:x.values[c.rowIndex],numeric:c.display.numeric,text:(0,s.cN)(c.display),time:f?f.values[c.rowIndex]:void 0},text:"Value"}}c.view&&(u.__data={value:{name:v.name,refId:v.refId,fields:(0,l.F)({frame:v,rowIndex:c.rowIndex})},text:"Data"})}else u.__value={value:{raw:c.display.numeric,numeric:c.display.numeric,text:(0,s.cN)(c.display),calc:c.name},text:"Value"}}else console.log("VALUE",c);const m=(v,x,f)=>{const E={...u,...x};return p(v,E,f)};return a.map(v=>(0,i.mQ)().getDataLinkUIModel(v,m,c))}}},o=(c,a)=>{const p=c.links;if(!(!p||p.length===0))return{getLinks:()=>p.map(u=>(0,i.mQ)().getDataLinkUIModel(u,a||c.replaceVariables,c))}},d=(c,a)=>{const p=r.b4.getPanelLinks(c)?.state.rawLinks;if(!(!p||p.length===0))return{getLinks:()=>p.map(u=>(0,i.mQ)().getDataLinkUIModel(u,a,c))}}},6923:(k,A,e)=>{"use strict";e.d(A,{Fq:()=>h,Hf:()=>D,mQ:()=>R});var n=e(2543),s=e.n(n),l=e(6709),r=e(91890),i=e(28240),g=e(11261),o=e(71733),d=e(80997),c=e(76885),a=e(95344),p=e(72574),u=e(52622),m=e(2913);const v=[{value:`${l.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:r.$0.BuiltIn},{value:`${l.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:r.$0.BuiltIn},{value:`${l.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:r.$0.BuiltIn}],x=[{value:`${l.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:r.$0.Series}],f=[{value:`${l.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:r.$0.Value},{value:`${l.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:r.$0.Value},{value:`${l.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:r.$0.Value}],E=T=>T.includes(".")||T.trim().includes(" ")?`["${T}"]`:`.${T}`,h=()=>[...(0,p.w)().getVariables().map(T=>({value:T.name,label:T.name,origin:r.$0.Template})),{value:`${l.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:r.$0.Template},...v],y=T=>{const S=[];for(const O of T)for(const j of O.fields)if(j.labels)for(const N of Object.keys(j.labels))S.push(N);const L=(0,n.chain)(S).flatten().uniq().value();return[{value:`${l.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:r.$0.Field},...L.map(O=>({value:`__field.labels${E(O)}`,label:`labels.${O}`,documentation:`${O} label value`,origin:r.$0.Field}))]},b=T=>{let S,L;const O=[],j={};if(T.length!==1)return[];const N=T[0];for(const F of N.fields){const U=(0,i.Ct)(F,N,T);j[U]||(O.push({value:`__data.fields${E(U)}`,label:`${U}`,documentation:`Formatted value for ${U} on the same row`,origin:r.$0.Fields}),j[U]=!0,!S&&F.type===g.PU.number&&(S={...F,name:U}),!L&&F.config.displayName&&F.config.displayName!==F.name&&(L={...F,name:U}))}return O.length&&O.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:r.$0.Fields}),S&&(O.push({value:`__data.fields${E(S.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:r.$0.Fields}),O.push({value:`__data.fields${E(S.name)}.text`,label:"Show text value",documentation:"the text value",origin:r.$0.Fields})),L&&O.push({value:`__data.fields${E(L.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:r.$0.Fields}),O},D=(T,S)=>{const L={value:`${l.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:r.$0.Value};return S===r.uP.Values?[...x,...y(T),...f,L,...b(T),...h()]:[...x,...y(T),...b(T),...h()]},P=T=>{const S=y(T),L={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...x,...S,...f,L,...h()]};class C{constructor(){this.getDataLinkUIModel=(S,L,O)=>{let j=S.url;S.onBuildUrl&&(j=S.onBuildUrl({origin:O,replaceVariables:L}));const N={href:o.I.assureBaseUrl(j.replace(/\n/g,"")),title:S.title??"",target:S.targetBlank?"_blank":void 0,origin:O};return L&&(N.href=L(N.href,void 0,u.$m.UriEncode),N.title=L(S.title)),S.onClick&&(N.onClick=F=>{S.onClick({origin:O,replaceVariables:L,e:F})}),N.href=(0,m.zj)().disableSanitizeHtml?N.href:d.sQ.sanitizeUrl(N.href),N}}getLinkUrl(S){let L={};S.keepTime&&(L[`$${l.c.keepTime}`]=!0),S.includeVars&&(L[`$${l.c.includeVars}`]=!0);let O=o.I.assureBaseUrl(c.kM.appendQueryToUrl(S.url||"",c.kM.toUrlParams(L)));return O=(0,p.w)().replace(O),(0,m.zj)().disableSanitizeHtml?O:d.sQ.sanitizeUrl(O)}getAnchorInfo(S){const L=(0,p.w)();return{href:this.getLinkUrl(S),title:L.replace(S.title||""),tooltip:L.replace(S.tooltip||"")}}getPanelLinkAnchorInfo(S,L){(0,a.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const O=(j,N,F)=>(0,p.w)().replace(j,{...L,...N},F);return this.getDataLinkUIModel(S,O,{})}}let M;function I(T){M=T}function R(){return M||(M=new C),M}},79971:(k,A,e)=>{"use strict";e.d(A,{Ap:()=>o,O6:()=>d,Xk:()=>a,gW:()=>c});var n=e(581),s=e(57767),l=e(41394),r=e(20701),i=e(28444),g=e(80095);function o(u){return async(m,v)=>{if(u.libraryPanel?.uid&&!("model"in u.libraryPanel)){m(p(u));return}u.maxDataPoints&&(u.maxDataPoints=Number(u.maxDataPoints));let x=u.type,f=v().plugins.panels[x];if(!f)try{f=await m((0,r.y7)(x))}catch{f=(0,l.$)(x,x==="row")}u.plugin||await u.pluginLoaded(f),m((0,g.XM)({key:u.key,plugin:f}))}}function d(u){return m=>{m((0,g.FC)({key:u}))}}function c({panel:u,pluginId:m,options:v,fieldConfig:x,transformations:f}){return async(E,h)=>{if(u.type===m&&!v&&!x&&!f)return;let b=h().plugins.panels[m];if(b||(b=await E((0,r.y7)(m))),u.type!==m&&u.changePlugin(b),v||x||f){const D=(0,n.F)({plugin:b,currentOptions:v||u.options,currentFieldConfig:x||u.fieldConfig,isAfterPluginChange:!1});u.options=D.options,u.fieldConfig=D.fieldConfig,u.transformations=f||u.transformations,u.configRev++}u.generateNewKey(),E((0,g.XM)({key:u.key,plugin:b}))}}function a(u,m){return async(v,x)=>{const f=m.model.type,E=u.type;if(u.restoreModel({...m.model,gridPos:u.gridPos,id:u.id,libraryPanel:m}),u.getQueryRunner().clearLastResult(),E!==f){let y=x().plugins.panels[f];y||(y=await v((0,r.y7)(f))),await u.pluginLoaded(y),u.generateNewKey(),await v((0,g.XM)({key:u.key,plugin:y}))}else{const h=u.key;u.generateNewKey(),v((0,g.io)({oldKey:h,newKey:u.key}))}u.configRev=0,u.hasSavedPanelEditChange=!0,u.refresh(),u.events.publish(i.zq),u.events.publish(i.PR)}}function p(u){return async(m,v)=>{const x=u.libraryPanel.uid;try{const f=await(0,s.Yr)(x,!0);u.initLibraryPanel(f);const E=v().dashboard.getModel();if(u.repeat&&E){const h=E.panels.findIndex(y=>y.id===u.id);E.repeatPanel(u,h),E.sortPanelsByGridPos(),E.events.publish(new i.Q$)}await m(o(u))}catch(f){console.log("ERROR: ",f),m((0,g.XM)({key:u.key,plugin:(0,l.$)("Unable to load library panel: "+x,!1)}))}}}},80095:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>p,FC:()=>d,S3:()=>i,XM:()=>r,io:()=>o,nF:()=>g,rG:()=>c});var n=e(65307);const s={},l=(0,n.Z0)({name:"panels",initialState:s,reducers:{panelModelAndPluginReady:(u,m)=>{u[m.payload.key]={plugin:m.payload.plugin}},changePanelKey:(u,m)=>{u[m.payload.newKey]=u[m.payload.oldKey],delete u[m.payload.oldKey]},removePanel:(u,m)=>{delete u[m.payload.key]},removeAllPanels:u=>{Object.keys(u).forEach(m=>delete u[m])},setPanelInstanceState:(u,m)=>{u[m.payload.key].instanceState=m.payload.value},setPanelAngularComponent:(u,m)=>{const v=u[m.payload.key];v.angularComponent=m.payload.angularComponent}}}),{panelModelAndPluginReady:r,setPanelAngularComponent:i,setPanelInstanceState:g,changePanelKey:o,removePanel:d,removeAllPanels:c}=l.actions,p={panels:l.reducer}},40334:(k,A,e)=>{"use strict";e.d(A,{U:()=>n});function n(s,l){return s.panels[l.key]}},17706:(k,A,e)=>{"use strict";e.d(A,{A4:()=>r,CO:()=>o,if:()=>g,nr:()=>i});var n=e(43429),s=e(54479),l=e(2913);function r(){const d=l.config.panels;return Object.keys(d).filter(c=>d[c].hideFromList===!1).map(c=>d[c]).sort((c,a)=>c.sort-a.sort)}function i(){return r().filter(d=>!!d.skipDataQuery)}function g(){return r().filter(d=>!d.skipDataQuery)}function o(d,c,a){if(!c.length)return d.filter(x=>x.state===n.pn.deprecated?a===x.id:!0);const p=(0,s.xb)(c).toLowerCase(),u=[],m=[],v="graph".startsWith(p);for(const x of d){if(x.state===n.pn.deprecated&&a!==x.id)continue;const E=x.name.toLowerCase().indexOf(p);E===0?u.push(x):E>0?m.push(x):v&&x.id==="timeseries"&&u.push(x)}return u.concat(m)}},2609:(k,A,e)=>{"use strict";e.d(A,{_o:()=>p});var n=e(2543),s=e.n(n),l=e(71733),r=e(76885),i=e(65879),g=e(39601),o=e(2619),d=e(86022);const c={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class a extends o.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,d.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const v=this.urls[this.index],x=g.Ny.getSearchObject(),f=(0,n.pickBy)(x,(h,y)=>c[y]),E=l.I.stripBaseFromUrl(v);this.index++,this.validPlaylistUrl=E,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),g.Ny.push(E+"?"+r.kM.toUrlParams(f))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(m){m.pathname!==this.validPlaylistUrl&&this.stop()}async start(m){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=g.Ny.getHistory().listen(this.locationUpdated);const v=[];let x=await this.api.getPlaylist(m);if(!x.items?.length)return;this.interval=i.intervalToMs(x.interval);const f=await(0,d.qY)(x.items);for(const E of f)if(E.dashboards)for(const h of E.dashboards)v.push(h.url);v.length&&(this.urls=v,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),g.Ny.getSearchObject().kiosk&&g.Ny.partial({kiosk:null}))}}const p=new a},86022:(k,A,e)=>{"use strict";e.d(A,{GM:()=>y,NF:()=>b,aV:()=>h,qY:()=>E});var n=e(75505),s=e(78368),l=e(17172),r=e(32264),i=e(82467),g=e(3169),o=e(90183),d=e(68706),c=e(99140),a=e(2468),p=e(24439);class u{async getAllPlaylist(){return(0,l.AI)().get("/api/playlists/")}async getPlaylist(P){const C=await(0,l.AI)().get(`/api/playlists/${P}`);return await x(C),C}async createPlaylist(P){await f(()=>(0,l.AI)().post("/api/playlists",P))}async updatePlaylist(P){await f(()=>(0,l.AI)().put(`/api/playlists/${P.uid}`,P))}async deletePlaylist(P){await f(()=>(0,l.AI)().delete(`/api/playlists/${P}`),"Playlist deleted")}}class m{constructor(){this.playlistAsK8sResource=P=>({metadata:{name:P.uid},spec:{title:P.name,interval:P.interval,items:P.items??[]}}),this.server=new a.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(v)}async getPlaylist(P){const C=await this.server.get(P),M=v(C);return await x(M),M}async createPlaylist(P){const C=this.playlistAsK8sResource(P);await f(async()=>{await this.server.create(C)})}async updatePlaylist(P){const C=this.playlistAsK8sResource(P);await f(()=>this.server.update(C).then(()=>{}))}async deletePlaylist(P){await f(()=>this.server.delete(P).then(()=>{}),"Playlist deleted")}}function v(D){const{spec:P,metadata:C}=D;return{uid:C.name,name:P.title,interval:P.interval,items:P.items}}async function x(D){if(D?.items){for(const P of D.items)if(P.type==="dashboard_by_id"){P.type="dashboard_by_uid";const C=await(0,l.AI)().get(`/api/dashboards/ids/${P.value}`);C?.length&&(P.value=C[0])}}}async function f(D,P="Playlist saved"){try{await D(),(0,c.JD)((0,i.dx)((0,g.tZ)(P)))}catch(C){C instanceof Error&&(0,c.JD)((0,i.dx)((0,g.gi)("Unable to save playlist",C)))}}async function E(D){let P=0;if(!D?.length)return[];const C=[];for(const R of D){const T={query:"*",kind:["dashboard"],limit:1e3};switch(R.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":T.uid=[R.value];break;case"dashboard_by_tag":T.tags=[R.value];break}C.push({refId:`${P++}`,queryType:d.nj.Search,search:T})}if(!r.$.featureToggles.panelTitleSearch){const R=(0,p.getGrafanaSearcher)(),T=[];for(let S=0;S<C.length;S++){const L=(await R.search(C[S].search)).view;T.push({...D[S],dashboards:L.map(O=>({...O}))})}return T}const M=await(0,o.o)(),I=await(0,n.s)(M.query({targets:C}));if(I.data.length!==D.length)throw new Error("unexpected result size");return D.map((R,T)=>{const S=new s.R(I.data[T]);return{...R,dashboards:S.map(L=>({...L}))}})}function h(){return{items:[],interval:"5m",name:"",uid:""}}function y(D,P){return P?.length?(P=P.toLowerCase(),D.filter(C=>C.name.toLowerCase().includes(P))):D}function b(){return r.$.featureToggles.kubernetesPlaylists?new m:new u}},84684:(k,A,e)=>{"use strict";e.d(A,{Ap:()=>m,Bj:()=>d,CB:()=>g,Gd:()=>u,T_:()=>o,XP:()=>v,cu:()=>f,ij:()=>E,xZ:()=>x});var n=e(36663),s=e(17172),l=e(80714),r=e(6745),i=e(5129);async function g(y){const b=await c(y),D=!!b,[P,C,M]=await Promise.all([u(),a(y,D),p(y)]),I=P.find(T=>T.id===y),R=I?.dependencies||b?.json?.dependencies;return{grafanaDependency:R?.grafanaDependency??R?.grafanaVersion??"",pluginDependencies:R?.plugins||[],links:I?.info.links||b?.json?.info.links||[],readme:M||b?.readme,versions:C,statusContext:b?.statusContext??"",iam:b?.json?.iam}}async function o(){try{const{items:y}=await(0,s.AI)().get(`${r.P5}/plugins`,{includeDeprecated:!0});return y.filter(i.hY)}catch(y){if((0,s.NF)(y))return y.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw y}}async function d(){try{return await(0,s.AI)().get(`${r.Sw}/errors`)}catch{return[]}}async function c(y){try{return await(0,s.AI)().get(`${r.P5}/plugins/${y}`,{})}catch(b){(0,s.NF)(b)&&(b.isHandled=!0);return}}async function a(y,b){try{return b?((await(0,s.AI)().get(`${r.P5}/plugins/${y}/versions`)).items||[]).map(P=>({version:P.version,createdAt:P.createdAt,isCompatible:P.isCompatible,grafanaDependency:P.grafanaDependency})):[]}catch(D){return(0,s.NF)(D)&&(D.isHandled=!0),[]}}async function p(y){try{const b=await(0,s.AI)().get(`${r.Sw}/${y}/markdown/README`);return b?(0,n.G)(b):""}catch(b){return(0,s.NF)(b)&&(b.isHandled=!0),""}}async function u(){return(await(0,s.AI)().get(`${r.Sw}`,(0,l.F)({embedded:0}))).filter(i.Sq)}async function m(){const{items:y}=await(0,s.AI)().get(`${r.Mi}/plugins`);return y}async function v(){const{items:y}=await(0,s.AI)().get(`${r.Mi}/provisioned-plugins`);return y.map(b=>({slug:b.type}))}async function x(y){return await(0,s.AI)().post(`${r.Sw}/${y}/install`,void 0,{showErrorAlert:!1})}async function f(y){return await(0,s.AI)().post(`${r.Sw}/${y}/uninstall`)}async function E(y,b){return(await(0,s.AI)().datasourceRequest({url:`/api/plugins/${y}/settings`,method:"POST",data:b}))?.data}const h={getRemotePlugins:o,getInstalledPlugins:u,installPlugin:x,uninstallPlugin:f}},42930:(k,A,e)=>{"use strict";e.d(A,{G:()=>r});var n=e(74848),s=e(32196),l=e(40845);const r=({children:g,wrap:o,className:d})=>{const c=(0,l.$j)(),a=i(c,o);return(0,n.jsx)("div",{className:(0,s.cx)(a.container,d),children:g})},i=(g,o)=>({container:(0,s.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${o?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${g.spacing()};
      margin-right: ${g.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},31906:(k,A,e)=>{"use strict";e.d(A,{a:()=>r});var n=e(74848),s=e(90613),l=e(39558);const r=({text:i="Loading..."})=>(0,n.jsx)(s.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,n.jsx)(l._,{text:i})})},6745:(k,A,e)=>{"use strict";e.d(A,{Mi:()=>s,P5:()=>l,Sw:()=>n,fu:()=>r});const n="/api/plugins",s="/api/instance",l="/api/gnet",r="plugins"},5129:(k,A,e)=>{"use strict";e.d(A,{Gl:()=>P,H2:()=>f,N6:()=>M,Sq:()=>I,TD:()=>F,Xc:()=>h,by:()=>E,hY:()=>R,j_:()=>C,kH:()=>v,td:()=>p,tr:()=>D});var n=e(53076),s=e(43429),l=e(53531),r=e(32264),i=e(33378),g=e(2913),o=e(10096),d=e(27677),c=e(31678),a=e(66253);function p({local:U=[],remote:w=[],instance:B=[],provisioned:K=[],pluginErrors:W}){const z=[],Y=y(W),X=B.reduce((G,te)=>(G.set(te.pluginSlug,te),G),new Map),q=K.reduce((G,te)=>(G.add(te.slug),G),new Set);return U.forEach(G=>{const te=w.find(se=>se.slug===G.id),H=Y[G.id];te||z.push(u(G,void 0,H))}),w.forEach(G=>{const te=U.find(ne=>ne.id===G.slug),H=Y[G.slug];if(!(G.status===a.Uy.Deprecated&&!te)){const ne=u(te,G,H);if(g.Ay.featureToggles.managedPluginsInstall&&r.$.pluginAdminExternalManageEnabled){ne.isFullyInstalled=ne.isCore?!0:(X.has(G.slug)||q.has(G.slug))&&ne.isInstalled,ne.isInstalled=X.has(G.slug)||ne.isInstalled;const le=X.get(G.slug);ne.isUpdatingFromInstance=X.has(G.slug)&&ne.hasUpdate&&ne.installedVersion!==le?.version,le?.version&&le?.version!==G.version&&(ne.hasUpdate=!0),ne.isUninstallingFromInstance=!!te&&!X.has(G.slug),ne.isProvisioned=q.has(G.slug)}z.push(ne)}}),z}function u(U,w,B){return!U&&w?m(w,B):U&&!w?v(U,B):x(U,w,B)}function m(U,w){const{name:B,slug:K,description:W,version:z,orgName:Y,popularity:X,downloads:q,typeCode:G,updatedAt:te,createdAt:H,status:se,angularDetected:ne,keywords:le}=U,_=!!w||L(G);return{description:W,downloads:q,id:K,info:{logos:{small:`${r.$.appSubUrl}/api/gnet/plugins/${K}/versions/${z}/logos/small`,large:`${r.$.appSubUrl}/api/gnet/plugins/${K}/versions/${z}/logos/large`},keywords:le},name:B,orgName:Y,popularity:X,publishedAt:H,signature:b({remote:U,error:w}),updatedAt:te,hasUpdate:!1,isPublished:!0,isInstalled:_,isDisabled:_,isManaged:S(K),isDeprecated:se===a.Uy.Deprecated,isCore:U.internal,isDev:!1,isEnterprise:se===a.Uy.Enterprise,type:G,error:w?.errorCode,angularDetected:ne,isFullyInstalled:_}}function v(U,w){const{name:B,info:{description:K,version:W,logos:z,updated:Y,author:X,keywords:q},id:G,dev:te,type:H,signature:se,signatureOrg:ne,signatureType:le,hasUpdate:_,accessControl:Q,angularDetected:ae}=U,oe=!!w||L(H);return{description:K,downloads:0,id:G,info:{logos:z,keywords:q},name:B,orgName:X.name,popularity:0,publishedAt:"",signature:b({local:U,error:w}),signatureOrg:ne,signatureType:le,updatedAt:Y,installedVersion:W,hasUpdate:_,isInstalled:!0,isDisabled:oe,isCore:se==="internal",isPublished:!1,isDeprecated:!1,isDev:!!te,isEnterprise:!1,isManaged:S(G),type:H,error:w?.errorCode,accessControl:Q,angularDetected:ae,isFullyInstalled:!0,iam:U.iam}}function x(U,w,B){const K=U?.info.version,W=w?.slug||U?.id||"",z=U?.type||w?.typeCode,Y=!!B||L(z),X=w?.keywords||U?.info.keywords||[];let q={small:`/public/img/icn-${z}.svg`,large:`/public/img/icn-${z}.svg`};return w?q={small:`${r.$.appSubUrl}/api/gnet/plugins/${W}/versions/${w.version}/logos/small`,large:`${r.$.appSubUrl}/api/gnet/plugins/${W}/versions/${w.version}/logos/large`}:U&&U.info.logos&&(q=U.info.logos),{description:U?.info.description||w?.description||"",downloads:w?.downloads||0,hasUpdate:U?.hasUpdate||!1,id:W,info:{logos:q,keywords:X},isCore:!!(w?.internal||U?.signature===s.Ac.internal),isDev:!!U?.dev,isEnterprise:w?.status===a.Uy.Enterprise,isInstalled:!!U||Y,isDisabled:Y,isDeprecated:w?.status===a.Uy.Deprecated,isPublished:!0,isManaged:S(W),name:w?.name||U?.name||"",orgName:w?.orgName||U?.info.author.name||"",popularity:w?.popularity||0,publishedAt:w?.createdAt||"",type:z,signature:b({local:U,remote:w,error:B}),signatureOrg:U?.signatureOrg||w?.versionSignedByOrgName,signatureType:U?.signatureType||w?.versionSignatureType||w?.signatureType||void 0,updatedAt:w?.updatedAt||U?.info.updated||"",installedVersion:K,error:B?.errorCode,accessControl:U?.accessControl,angularDetected:U?.angularDetected??w?.angularDetected,isFullyInstalled:!!U||Y,iam:U?.iam}}const f=U=>`${r.$.pluginCatalogURL}${U}`;var E=(U=>(U.nameAsc="nameAsc",U.nameDesc="nameDesc",U.updated="updated",U.published="published",U.downloads="downloads",U))(E||{});const h=(U,w)=>{const B={nameAsc:(K,W)=>K.name.localeCompare(W.name),nameDesc:(K,W)=>W.name.localeCompare(K.name),updated:(K,W)=>(0,l.b)(W.updatedAt).valueOf()-(0,l.b)(K.updatedAt).valueOf(),published:(K,W)=>(0,l.b)(W.publishedAt).valueOf()-(0,l.b)(K.publishedAt).valueOf(),downloads:(K,W)=>W.downloads-K.downloads};return B[w]?U.sort(B[w]):U};function y(U=[]){return U.reduce((w,B)=>(w[B.pluginId]=B,w),{})}function b(U){const{error:w,local:B,remote:K}=U;if(w)switch(w.errorCode){case s.ZK.invalidSignature:return s.Ac.invalid;case s.ZK.missingSignature:return s.Ac.missing;case s.ZK.modifiedSignature:return s.Ac.modified}return B?.signature?B.signature:K?.signatureType&&K?.versionSignatureType?s.Ac.valid:s.Ac.missing}const D=()=>(0,d.AI)().get("/api/frontend/settings").then(U=>{r.$.panels=U.panels});function P(U){if(!U)return;const[w]=U.filter(B=>!!B.isCompatible);return w}const C=()=>r.$.pluginAdminEnabled,M=(U,w,B)=>{const K=r.$.pluginAdminExternalManageEnabled,W=o.contextSrv.hasPermission(c.AccessControlAction.PluginsInstall),z=!!B;return U.type===s.QE.renderer||U.type===s.QE.secretsmanager||U.isEnterprise&&!(0,i.a)("enterprise.plugins")||U.isDev||!W&&!K||!U.isPublished||!z||!w},I=U=>T(U.id),R=U=>T(U.slug);function T(U){const{pluginCatalogHiddenPlugins:w}=r.$;return!w.includes(U)}function S(U){const{pluginCatalogManagedPlugins:w}=r.$;return w?.includes(U)}function L(U){return U===s.QE.secretsmanager&&!r.$.secretsManagerPluginEnabled}function O(U){return U?.signature==="internal"}function j(U){return U.split(" - ")[0]}function N(U){return U.reduce((w,{id:B,name:K,type:W,orgName:z,info:Y})=>{const X=Y.keywords?.join(" ").toLowerCase(),q=`${B} - ${K} - ${W} - ${z} - ${X}`;return w.push(q),w},[])}function F(U,w){const B=N(U);let W=new n.A({intraMode:1,intraSub:0}).filter(B,w);return W===null?null:W.map(z=>j(B[z]))}},20701:(k,A,e)=>{"use strict";e.d(A,{JC:()=>R,JJ:()=>h,LR:()=>E,NJ:()=>S,aU:()=>b,ai:()=>M,h9:()=>T,mj:()=>f,nT:()=>I,t5:()=>y,y7:()=>L});var n=e(65307),s=e(65474),l=e(62467),r=e(66847),i=e(45650),g=e(90593),o=e(75505),d=e(32264),c=e(17172),a=e(2913),p=e(15162),u=e(81900),m=e(84684),v=e(6745),x=e(5129);const f=(0,n.zD)(`${v.fu}/fetchAll`,async(O,j)=>{try{j.dispatch({type:`${v.fu}/fetchLocal/pending`}),j.dispatch({type:`${v.fu}/fetchRemote/pending`});const N=d.$.pluginAdminExternalManageEnabled&&a.Ay.featureToggles.managedPluginsInstall?(0,s.H)((0,m.Ap)()):(0,l.of)(void 0),F=d.$.pluginAdminExternalManageEnabled&&a.Ay.featureToggles.managedPluginsInstall?(0,s.H)((0,m.XP)()):(0,l.of)(void 0),U=500,w=(0,s.H)((0,m.Bj)()),B=(0,s.H)((0,m.Gd)()),K=(0,s.H)((0,m.T_)()).pipe((0,r.W)(W=>(j.dispatch({type:`${v.fu}/fetchRemote/rejected`}),console.error(W),(0,l.of)([]))));return(0,i.p)({local:B,remote:K,instance:N,provisioned:F,pluginErrors:w}).pipe((0,g.w)({each:U,with:()=>(K.subscribe(async W=>{if(j.dispatch({type:`${v.fu}/fetchRemote/fulfilled`}),W.length>0){const z=await(0,o.s)(B),Y=await(0,o.s)(N),X=await(0,o.s)(F),q=await(0,o.s)(w);j.dispatch(b((0,x.td)({local:z,remote:W,instance:Y,provisioned:X,pluginErrors:q})))}}),(0,i.p)({local:B,instance:N,provisioned:F,pluginErrors:w}))})).subscribe(({local:W,remote:z,instance:Y,provisioned:X,pluginErrors:q})=>{W&&z?(j.dispatch({type:`${v.fu}/fetchLocal/fulfilled`}),j.dispatch({type:`${v.fu}/fetchRemote/fulfilled`}),j.dispatch(b((0,x.td)({local:W,remote:z,instance:Y,provisioned:X,pluginErrors:q})))):W&&(j.dispatch({type:`${v.fu}/fetchLocal/fulfilled`}),j.dispatch(b((0,x.td)({local:W,pluginErrors:q}))))},W=>(console.log(W),j.dispatch({type:`${v.fu}/fetchLocal/rejected`}),j.dispatch({type:`${v.fu}/fetchRemote/rejected`}),j.rejectWithValue("Unknown error."))),null}catch{return j.rejectWithValue("Unknown error.")}}),E=(0,n.zD)(`${v.fu}/fetchAllLocal`,async(O,j)=>{try{return(await(0,m.Gd)()).map(F=>(0,x.kH)(F))}catch{return j.rejectWithValue("Unknown error.")}}),h=(0,n.zD)(`${v.fu}/fetchRemotePlugins`,async(O,j)=>{try{return await(0,m.T_)()}catch(N){return(0,c.NF)(N)&&(N.isHandled=!0),j.rejectWithValue([])}}),y=(0,n.zD)(`${v.fu}/fetchDetails`,async(O,j)=>{try{const N=await(0,m.CB)(O);return{id:O,changes:{details:N}}}catch{return j.rejectWithValue("Unknown error.")}}),b=(0,n.VP)(`${v.fu}/addPlugins`),D=(0,n.VP)(`${v.fu}/addLocalPlugins`),P=(0,n.VP)(`${v.fu}/addLocalPlugins`),C=(0,n.VP)(`${v.fu}/addLocalPlugins`),M=(0,n.zD)(`${v.fu}/install`,async({id:O,version:j,isUpdating:N=!1},F)=>{const U=N?{isInstalled:!0,installedVersion:j,hasUpdate:!1}:{isInstalled:!0,installedVersion:j};try{return await(0,m.xZ)(O),await(0,x.tr)(),N&&(0,u.sk)(O),{id:O,changes:U}}catch(w){return console.error(w),(0,c.NF)(w)?F.rejectWithValue(w.data):F.rejectWithValue("Unknown error.")}}),I=(0,n.zD)(`${v.fu}/install`,async()=>({})),R=(0,n.zD)(`${v.fu}/uninstall`,async(O,j)=>{try{return await(0,m.cu)(O),await(0,x.tr)(),(0,u.sk)(O),{id:O,changes:{isInstalled:!1,installedVersion:void 0}}}catch(N){return console.error(N),j.rejectWithValue("Unknown error.")}}),T=(0,n.zD)(`${v.fu}/loadPluginDashboards`,async(O,j)=>{const U=`api/plugins/${j.getState().dataSources.dataSource.type}/dashboards`;return(0,c.AI)().get(U)}),S=(0,n.VP)(`${v.fu}/panelPluginLoaded`),L=O=>async(j,N)=>{let F=N().plugins.panels[O];return F||(F=await(0,p.TV)(O),N().plugins.panels[O]||j(S(F))),F}},83391:(k,A,e)=>{"use strict";e.d(A,{Tr:()=>W,A5:()=>K,wr:()=>j,m5:()=>O,PW:()=>D,F9:()=>M,ob:()=>P,xX:()=>I,XN:()=>N,pw:()=>S,Gp:()=>T,qG:()=>F,SQ:()=>R});var n=e(96540),s=e(31678),l=e(5129),r=e(20701),i=e(31326),g=e(25508),o=e(54479),d=e(14110),c=e(66253);const a=z=>z.plugins,p=(0,g.Mz)(a,({items:z})=>z),u=(0,g.Mz)(a,({settings:z})=>z.displayMode),{selectAll:m,selectById:v}=i.AI.getSelectors(p),x=z=>(0,g.Mz)(m,Y=>{const X=z.keyword?(0,o.xb)(z.keyword.toLowerCase()):"",q=X!==""?(0,l.TD)(Y,X):null;return X&&(0,d.rR)("plugins_search",{resultsCount:q?.length}),Y.filter(G=>!(X&&q==null||X&&!q?.includes(G.id)||z.type&&G.type!==z.type||z.isInstalled!==void 0&&G.isInstalled!==z.isInstalled||z.isEnterprise!==void 0&&G.isEnterprise!==z.isEnterprise||z.hasUpdate!==void 0&&G.hasUpdate!==z.hasUpdate))}),f=z=>(0,g.Mz)(m,Y=>{const X=[];for(const q of Y)q.error&&(!z||q.type===z)&&X.push({pluginId:q.id,errorCode:q.error,pluginType:q.type});return X}),E=z=>(0,g.Mz)(a,({requests:Y={}})=>Y[z]),h=z=>(0,g.Mz)(E(z),Y=>Y?.status===c.IZ.Pending),y=z=>(0,g.Mz)(E(z),Y=>Y?.status===c.IZ.Rejected?Y?.error:null),b=z=>(0,g.Mz)(E(z),Y=>Y===void 0),D=(z,Y=l.by.nameAsc)=>{U();const X=(0,n.useMemo)(()=>x(z),[z]),q=(0,s.useSelector)(X),{isLoading:G,error:te}=L(),H=(0,l.Xc)(q,Y);return{isLoading:G,error:te,plugins:H}},P=z=>(U(),B(z),(0,s.useSelector)(Y=>v(Y,z))),C=z=>(w(),useSelector(Y=>selectById(Y,z))),M=z=>(U(),(0,s.useSelector)(f(z))),I=()=>{const z=(0,s.useDispatch)();return(Y,X,q)=>z((0,r.ai)({id:Y,version:X,isUpdating:q}))},R=()=>{const z=(0,s.useDispatch)();return()=>z((0,r.nT)())},T=()=>{const z=(0,s.useDispatch)();return Y=>z((0,r.JC)(Y))},S=()=>(0,s.useSelector)(y(r.JJ.typePrefix))===null,L=()=>{const z=(0,s.useSelector)(h("plugins/fetchLocal")),Y=(0,s.useSelector)(y("plugins/fetchLocal"));return{isLoading:z,error:Y}},O=()=>{const z=(0,s.useSelector)(h(r.mj.typePrefix)),Y=(0,s.useSelector)(h("plugins/fetchLocal")),X=(0,s.useSelector)(h("plugins/fetchRemote")),q=z||Y||X,G=(0,s.useSelector)(y(r.mj.typePrefix));return{isLoading:q,error:G}},j=()=>{const z=(0,s.useSelector)(h(r.t5.typePrefix)),Y=(0,s.useSelector)(y(r.t5.typePrefix));return{isLoading:z,error:Y}},N=()=>{const z=(0,s.useSelector)(h(r.ai.typePrefix)),Y=(0,s.useSelector)(y(r.ai.typePrefix));return{isInstalling:z,error:Y}},F=()=>{const z=(0,s.useSelector)(h(r.JC.typePrefix)),Y=(0,s.useSelector)(y(r.JC.typePrefix));return{isUninstalling:z,error:Y}},U=()=>{const z=(0,s.useDispatch)(),Y=(0,s.useSelector)(b(r.mj.typePrefix));(0,n.useEffect)(()=>{Y&&z((0,r.mj)())},[])},w=()=>{const z=useDispatch(),Y=useSelector(selectIsRequestNotFetched(fetchAllLocal.typePrefix));useEffect(()=>{Y&&z(fetchAllLocal())},[])},B=z=>{const Y=(0,s.useDispatch)(),X=(0,s.useSelector)(te=>v(te,z)),G=!(0,s.useSelector)(h(r.t5.typePrefix))&&X&&!X.details;(0,n.useEffect)(()=>{G&&Y((0,r.t5)(z))},[X])},K=()=>{const z=(0,s.useDispatch)();return Y=>z((0,r.t5)(Y))},W=()=>{const z=(0,s.useDispatch)();return{displayMode:(0,s.useSelector)(u),setDisplayMode:X=>z((0,i.qo)(X))}}},31326:(k,A,e)=>{"use strict";e.d(A,{AI:()=>i,Ff:()=>m,qo:()=>u});var n=e(65307),s=e(6745),l=e(66253),r=e(20701);const i=(0,n.pU)(),g=v=>new RegExp(`${s.fu}/(.*)/pending`).test(v.type),o=v=>new RegExp(`${s.fu}/(.*)/fulfilled`).test(v.type),d=v=>new RegExp(`${s.fu}/(.*)/rejected`).test(v.type),c=v=>{const x=v.lastIndexOf("/");return v.substring(0,x)},a={items:i.getInitialState(),requests:{},settings:{displayMode:l.fy.Grid},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},p=(0,n.Z0)({name:"plugins",initialState:a,reducers:{setDisplayMode(v,x){v.settings.displayMode=x.payload}},extraReducers:v=>v.addCase(r.aU,(x,f)=>{i.upsertMany(x.items,f.payload)}).addCase(r.LR.fulfilled,(x,f)=>{i.upsertMany(x.items,f.payload)}).addCase(r.t5.fulfilled,(x,f)=>{i.updateOne(x.items,f.payload)}).addCase(r.ai.fulfilled,(x,f)=>{i.updateOne(x.items,f.payload)}).addCase(r.JC.fulfilled,(x,f)=>{i.updateOne(x.items,f.payload)}).addCase(r.NJ,(x,f)=>{x.panels[f.payload.meta.id]=f.payload}).addCase(r.h9.pending,(x,f)=>{x.isLoadingPluginDashboards=!0,x.dashboards=[]}).addCase(r.h9.fulfilled,(x,f)=>{x.isLoadingPluginDashboards=!1,x.dashboards=f.payload}).addMatcher(g,(x,f)=>{x.requests[c(f.type)]={status:l.IZ.Pending}}).addMatcher(o,(x,f)=>{x.requests[c(f.type)]={status:l.IZ.Fulfilled}}).addMatcher(d,(x,f)=>{x.requests[c(f.type)]={status:l.IZ.Rejected,error:f.payload}})}),{setDisplayMode:u}=p.actions,m=p.reducer},66253:(k,A,e)=>{"use strict";e.d(A,{IZ:()=>d,Ip:()=>l,LZ:()=>o,Uy:()=>r,fy:()=>n,og:()=>g,u8:()=>i,vk:()=>s});var n=(c=>(c.Grid="grid",c.List="list",c))(n||{}),s=(c=>(c.Home="plugins-home",c.Browse="plugins-browse",c.Details="plugins-details",c))(s||{}),l=(c=>(c.app="apps",c.datasource="database",c.panel="credit-card",c.renderer="capture",c.secretsmanager="key-skeleton-alt",c))(l||{}),r=(c=>(c.Deleted="deleted",c.Active="active",c.Pending="pending",c.Deprecated="deprecated",c.Enterprise="enterprise",c))(r||{}),i=(c=>(c.INSTALL="INSTALL",c.UNINSTALL="UNINSTALL",c.UPDATE="UPDATE",c.REINSTALL="REINSTALL",c))(i||{}),g=(c=>(c.OVERVIEW="Overview",c.VERSIONS="Version history",c.CONFIG="Config",c.DASHBOARDS="Dashboards",c.USAGE="Usage",c.IAM="IAM",c))(g||{}),o=(c=>(c.OVERVIEW="overview",c.VERSIONS="version-history",c.CONFIG="config",c.DASHBOARDS="dashboards",c.USAGE="usage",c.IAM="iam",c))(o||{}),d=(c=>(c.Pending="Pending",c.Fulfilled="Fulfilled",c.Rejected="Rejected",c))(d||{})},74106:(k,A,e)=>{"use strict";e.d(A,{c:()=>o});var n=e(74848),s=e(96540),l=e(43429),r=e(14110),i=e(42418);function g(d,c){let a;switch(d){case l.QE.app:a="app plugin";break;case l.QE.panel:a="panel plugin";break;case l.QE.datasource:a="data source plugin";break;default:a="plugin"}let p=`This ${a} uses a deprecated, legacy platform based on AngularJS and `;return c===void 0?p+" may be incompatible depending on your Grafana configuration.":c?p+" will stop working in future releases of Grafana.":p+" is incompatible with your current Grafana configuration."}function o(d){const{className:c,angularSupportEnabled:a,pluginId:p,pluginType:u,showPluginDetailsLink:m,interactionElementId:v}=d,[x,f]=(0,s.useState)(!1),E={};return p&&(E.pluginId=p),v&&(E.elementId=v),x?null:(0,n.jsxs)(i.F,{severity:"warning",title:"Angular plugin",className:c,onRemove:()=>f(!0),children:[(0,n.jsx)("p",{children:g(u,a)}),(0,n.jsx)("div",{className:"markdown-html",children:(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,r.rR)("angular_deprecation_docs_clicked",E)},children:"Read our deprecation notice and migration advice."})}),m&&p?(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:`plugins/${encodeURIComponent(p)}`,className:"external-link",target:"_blank",rel:"noreferrer",children:"View plugin details"})}):null]})})]})}},8480:(k,A,e)=>{"use strict";e.d(A,{Hv:()=>r,mz:()=>i});var n=e(32264);function s(g){return Object.values(n.$.datasources).find(o=>o.uid===g)??null}function l(g){return s(g)?.meta.angular?.detected??!1}function r(g){const o=s(g);return(o?.meta.angular?.detected&&!o?.meta.angular.hideDeprecation)??!1}const i=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},72798:(k,A,e)=>{"use strict";e.d(A,{A:()=>s,S:()=>r});var n=e(96540);const s=(0,n.createContext)(l());s.displayName="PluginPageContext";function l(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function r(i){return{sectionNav:i??l().sectionNav}}},10803:(k,A,e)=>{"use strict";e.d(A,{p:()=>r});var n=e(74848),s=e(43429),l=e(39938);const r=g=>{const o=i(g.state);return o?(0,n.jsx)(l.E,{className:g.className,color:o.color,title:o.tooltip,text:o.text,icon:o.icon}):null};function i(g){switch(g){case s.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case s.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case s.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(k,A,e)=>{"use strict";e.d(A,{tR:()=>E,xq:()=>v});var n=e(40187),s=e(26272),l=e(80147),r=e(72574),i=e(81634),g=e(17172),o=e(19347),d=e(26657),c=e(28138),a=e(2913),p=e(53478),u=e(66718),m=e(685);class v{constructor(y=(0,r.w)()){this.templateSrv=y,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(y,b){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=y,this.defaultName=b;for(const D of Object.values(y))D.uid||(D.uid=D.name),this.settingsMapByUid[D.uid]=D,this.settingsMapById[D.id]=D;this.datasources[d.dR.type]=p.Ex,this.datasources[u.Uj]=p.Ex,this.settingsMapByUid[d.dR.uid]=p.$i,this.settingsMapByUid[u.Uj]=p.$i}getDataSourceSettingsByUid(y){return this.settingsMapByUid[y]}getInstanceSettings(y,b){let D=x(y);if((0,d.s9)(D))return p.$i;if(D==="default"||D==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(D[0]==="$"){const P=this.templateSrv.replace(D,b,f);let C;return P==="default"?C=this.settingsMapByName[this.defaultName]:C=this.settingsMapByUid[P]??this.settingsMapByName[P],C?{...C,isDefault:!1,name:D,uid:D,rawRef:{type:C.type,uid:C.uid}}:void 0}return this.settingsMapByUid[D]??this.settingsMapByName[D]??this.settingsMapById[D]}get(y,b){let D=x(y);if(!D)return this.get(this.defaultName);if((0,d.s9)(y))return Promise.resolve(this.datasources[u.Uj]);const P=this.settingsMapByName[D];return P&&(D=P.uid),this.datasources[D]?Promise.resolve(this.datasources[D]):(D=this.templateSrv.replace(D,b,f),D==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[D]?Promise.resolve(this.datasources[D]):this.loadDatasource(D))}async loadDatasource(y){if(this.datasources[y])return Promise.resolve(this.datasources[y]);const b=this.getInstanceSettings(y);if(!b)return Promise.reject({message:`Datasource ${y} was not found`});try{const D=await(0,m.cS)(b.meta);if(this.datasources[y])return this.datasources[y];const P=D.DataSourceClass.length!==1;let C;if(P?C=(0,i.C)().instantiate(D.DataSourceClass,{instanceSettings:b}):C=new D.DataSourceClass(b),C.components=D.components,!(C instanceof n.mA)){const M=C;M.name=b.name,M.id=b.id,M.type=b.type,M.meta=b.meta,M.uid=b.uid,C.getRef=n.mA.prototype.getRef}return this.datasources[y]=C,this.datasources[C.uid]=C,C}catch(D){return D instanceof Error&&c.A.emit(s.r1.alertError,[b.name+" plugin failed",D.toString()]),Promise.reject({message:`Datasource: ${y} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(y={}){const b=Object.values(this.settingsMapByName).filter(P=>!(P.meta.id==="grafana"||P.meta.id==="mixed"||P.meta.id==="dashboard"||y.metrics&&!P.meta.metrics||y.tracing&&!P.meta.tracing||y.logs&&P.meta.category!=="logging"&&!P.meta.logs||y.annotations&&!P.meta.annotations||y.alerting&&!P.meta.alerting||y.pluginId&&!(0,l._)(y.pluginId,P.meta)||y.filter&&!y.filter(P)||y.type&&(Array.isArray(y.type)?!y.type.includes(P.type):y.type!==P.type)||!y.all&&P.meta.metrics!==!0&&P.meta.annotations!==!0&&P.meta.tracing!==!0&&P.meta.logs!==!0&&P.meta.alerting!==!0));if(y.variables)for(const P of this.templateSrv.getVariables()){if(P.type!=="datasource")continue;let C=P.current.value==="default"?this.defaultName:P.current.value;Array.isArray(C)&&(C=C[0]);const M=!Array.isArray(C)&&(this.settingsMapByName[C]||this.settingsMapByUid[C]);if(M){const I=`\${${P.name}}`;b.push({...M,isDefault:!1,name:I,uid:I})}}const D=b.sort((P,C)=>P.name.toLowerCase()>C.name.toLowerCase()?1:P.name.toLowerCase()<C.name.toLowerCase()?-1:0);if(!y.pluginId&&!y.alerting){if(y.mixed){const P=this.getInstanceSettings("-- Mixed --");P&&b.push(P)}if(y.dashboard){const P=this.getInstanceSettings("-- Dashboard --");P&&b.push(P)}if(!y.tracing){const P=this.getInstanceSettings("-- Grafana --");P&&b.push(P)}}return D}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(y=>({name:y.name,value:y.name,meta:y.meta}))}getMetricSources(y){return this.getList({metrics:!0,variables:!y?.skipVariables}).map(b=>({name:b.name,value:b.name,meta:b.meta}))}async reload(){const y=await(0,g.AI)().get("/api/frontend/settings");a.Ay.datasources=y.datasources,a.Ay.defaultDatasource=y.defaultDatasource,this.init(y.datasources,y.defaultDatasource)}}function x(h){return(0,d.s9)(h)?d.dR.uid:typeof h=="string"?h:h?.uid}function f(h){return Array.isArray(h)?h[0]:h}const E=()=>(0,o.l)()},75462:(k,A,e)=>{"use strict";e.d(A,{$Y:()=>M,FF:()=>m,N9:()=>O,WW:()=>f,io:()=>T,nv:()=>y,ol:()=>D,pL:()=>L,yS:()=>x,yb:()=>h,yt:()=>P,z1:()=>v});var n=e(74848),s=e(32196),l=e(2543),r=e.n(l),i=e(16817),g=e(74135),o=e(13834),d=e(47232),c=e(37390),a=e(28138),p=e(27716),u=e(28444);function m(j){console.warn(`[Plugin Extensions] ${j}`)}function v(j){return typeof j=="object"&&"type"in j&&j.type===g.u.link}function x(j){return typeof j=="object"&&"type"in j&&j.type===g.u.component}function f(j){return typeof j=="object"&&"type"in j&&j.type===g.u.component&&j.extensionPointId.startsWith("capabilities/")}function E(j,N=""){return(...F)=>{try{return j(...F)}catch(U){U instanceof Error&&console.warn(`${N}${U.message}`)}}}function h(j,N){return{openModal:async U=>{const{title:w,body:B,width:K,height:W}=U;a.A.publish(new u.S8({component:y(j,b({title:w,body:B,width:K,height:W}))}))},context:N}}const y=(j,N)=>U=>{const{error:w,loading:B,value:K}=(0,i.A)(()=>(0,p.x)(j,{showErrorAlert:!1}));return B?null:w?(m(`Could not fetch plugin meta information for "${j}", aborting. (${w.message})`),null):K?(0,n.jsx)(o.a,{meta:K,children:(0,n.jsx)(N,{...U})}):(m(`Fetched plugin meta information is empty for "${j}", aborting.`),null)},b=({title:j,body:N,width:F,height:U})=>{const w=(0,s.css)({width:F,height:U});return({onDismiss:K})=>(0,n.jsx)(c.a,{title:j,className:w,isOpen:!0,onDismiss:K,onClickBackdrop:K,children:(0,n.jsx)(N,{onDismiss:K})})};function D(j,N=new Map){if(!j||typeof j!="object"||Object.isFrozen(j))return j;const F=Array.isArray(j)?[...j]:{...j};if(N.has(j))return N.get(j);N.set(j,F);const U=Reflect.ownKeys(F);for(const w of U){const B=Array.isArray(F)?F[Number(w)]:F[w];B&&(typeof B=="object"||typeof B=="function")&&(Array.isArray(F)?F[Number(w)]=D(B,N):F[w]=D(B,N))}return Object.freeze(F)}function P(j,N){const F=`${j}${N.extensionPointId}${N.title}`;return Array.from(F).reduce((U,w)=>Math.imul(31,U)+w.charCodeAt(0)|0,0).toString()}const C=Symbol("isReadOnlyProxy");function M(j){if(!j||typeof j!="object"||R(j))return j;const N=new WeakMap;return new Proxy(j,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(F,U,w){if(U===C)return!0;const B=Reflect.get(F,U,w);return(0,d.Ar)(B)?(0,d.KQ)(B):(0,l.isObject)(B)||(0,l.isArray)(B)?(N.has(B)||N.set(B,M(B)),N.get(B)):B}})}function I(j){return typeof j=="object"&&j!==null}function R(j){return I(j)&&j[C]===!0}function T(j){const N={type:g.u.link,...j};return S(N),N}function S(j){if(j.type!==g.u.link)throw Error("config is not a extension link")}function L(j,N){return j.length<N?j:`${j.slice(0,N-3).trimEnd()}...`}function O(j){const N={},F=[];for(const w of j){const B=w.category;if(!B){F.push({text:L(w.title,25),href:w.path,onClick:w.onClick});continue}Array.isArray(N[B])||(N[B]=[]),N[B].push({text:L(w.title,25),href:w.path,onClick:w.onClick})}const U=Object.keys(N).reduce((w,B)=>(w.push({text:L(B,25),type:"group",subMenu:N[B]}),w),[]);return F.length>0&&(U.length>0&&U.push({text:"divider",type:"divider"}),Array.prototype.push.apply(U,F)),U}},15162:(k,A,e)=>{"use strict";e.d(A,{Kk:()=>a,PY:()=>p,TV:()=>o,d4:()=>c,f7:()=>v,oZ:()=>d});var n=e(65158),s=e(2913),l=e(41394),r=e(685);const i={},g={};function o(x){const f=i[x];if(f)return f;const E=c(x);if(!E)throw new Error(`Plugin ${x} not found`);return i[x]=u(E),x!==E.type&&(i[E.type]=i[x]),i[x]}function d(x){return!!c(x)}function c(x){const f=s.Ay.panels[x];if(!f){for(const E of Object.values(s.Ay.panels))if(E.aliasIDs?.includes(x))return E}return f}function a(x){return u(x)}function p(x){return g[x]}function u(x){return(0,r.j4)({path:x.module,version:x.info?.version,isAngular:x.angular?.detected,pluginId:x.id}).then(f=>{if(f.plugin)return f.plugin;if(f.PanelCtrl){const E=new n.m(null);return E.angularPanelCtrl=f.PanelCtrl,E}throw new Error("missing export: plugin or PanelCtrl")}).then(f=>(f.meta=x,g[x.id]=f,!f.panel&&f.angularPanelCtrl&&(f.panel=m(f)),f)).catch(f=>(console.warn("Error loading panel plugin: "+x.id,f),(0,l.W)(x,f)))}let m=x=>null;function v(x){m=x}},81900:(k,A,e)=>{"use strict";e.d(A,{GD:()=>r,QO:()=>o,ni:()=>g,sk:()=>i});var n=e(27716),s=e(45179);const l={};function r({pluginId:c,version:a,isAngular:p}){const u=c;u&&!l[u]&&(l[u]={version:encodeURI(a),isAngular:p,pluginId:c})}function i(c){const a=c;l[a]&&delete l[a],(0,n.o)(c)}function g(c,a=s.x8){const p=d(c);if(!p)return`${c}?_cache=${a}`;const m=l[p]?.version||a;return`${c}?_cache=${m}`}function o(c){const a=d(c);if(a)return l[a]}function d(c){const a=Object.keys(l).find(p=>c.includes(p));if(a)return a}},45179:(k,A,e)=>{"use strict";e.d(A,{$b:()=>s,Bu:()=>l,XV:()=>n,x8:()=>r});const n="package",s=/^plugins.+\.css$/i,l=/^(text|application)\/(x-)?javascript(;|$)/,r=Date.now()},63770:(k,A,e)=>{"use strict";e.d(A,{z:()=>o});var n=e(59511),s=e.n(n),l=e(65024),r=e.n(l),i=e(35135),g=e.n(i);const o=window.System},94429:(k,A,e)=>{"use strict";e.d(A,{kB:()=>p,OD:()=>u,Av:()=>m});var n=e(32264),s=e(66161),l=e(45179),r=e(34867);const i=new WeakMap,g={};function o(v,x,f){const E={get(h,y){if(document.currentScript===null&&typeof y!="symbol"&&y.toString()!=="__useDefault"){const D=`${x}.${String(y)}`,P=`${D}`;g[P]||(g[P]=!0,(0,r.fH)(`Plugin using ${D}`,{key:String(y),parent:x,packageName:f}))}let b=Reflect.get(h,y);return b!==null&&typeof b=="object"&&!(b instanceof RegExp)?(i.has(b)||i.set(b,o(b,`${x}.${String(y)}`,f)),i.get(b)):(typeof b=="function"&&(b=b.bind(h)),b)}};return typeof v=="object"&&v!==null?new Proxy(v,E):v}const d=/^(@grafana|app\/)/;function c(v,x){return d.test(x)?o(v,x,x):v}var a=e(63770);function p(v){return Object.keys(v).reduce((x,f)=>{const E=`${l.XV}:${f}`,h=n.$.featureToggles.pluginsAPIMetrics?c(v[f],f):v[f];return a.z.set(E,h),s.s.set(f,v[f]),x[f]=E,x},{})}function u(v){return!!n.$.pluginsCDNBaseURL&&v.startsWith(n.$.pluginsCDNBaseURL)}function m(v){return v.startsWith("http")||v.startsWith("/")?v:`${n.$.appSubUrl??""}/${v}`}},27716:(k,A,e)=>{"use strict";e.d(A,{o:()=>r,x:()=>l});var n=e(17172);const s={};function l(i,g){const o=s[i];return o?Promise.resolve(o):(0,n.AI)().get(`/api/plugins/${i}/settings`,void 0,void 0,g).then(d=>(s[i]=d,d)).catch(d=>typeof d=="object"&&d!==null&&"status"in d&&d.status===403?(d.isHandled=!0,Promise.reject(d)):Promise.reject(new Error("Unknown Plugin")))}const r=i=>i?delete s[i]:Object.keys(s).forEach(g=>delete s[g])},685:(k,A,e)=>{"use strict";e.d(A,{ui:()=>Bh,cS:()=>mp,j4:()=>ou});var n={};e.r(n),e.d(n,{plugin:()=>Gt});var s={};e.r(s),e.d(s,{plugin:()=>Un});var l={};e.r(l),e.d(l,{plugin:()=>go});var r={};e.r(r),e.d(r,{plugin:()=>Vr});var i={};e.r(i),e.d(i,{plugin:()=>ol});var g={};e.r(g),e.d(g,{plugin:()=>Ra});var o={};e.r(o),e.d(o,{plugin:()=>Br});var d={};e.r(d),e.d(d,{plugin:()=>Kh});var c={};e.r(c),e.d(c,{plugin:()=>_h});var a={};e.r(a),e.d(a,{plugin:()=>rf});var p={};e.r(p),e.d(p,{plugin:()=>hc});var u={};e.r(u),e.d(u,{plugin:()=>Sd});var m={};e.r(m),e.d(m,{plugin:()=>Bf});var v={};e.r(v),e.d(v,{plugin:()=>pc});var x={};e.r(x),e.d(x,{plugin:()=>sg});var f={};e.r(f),e.d(f,{plugin:()=>Ju});var E={};e.r(E),e.d(E,{plugin:()=>dg});var h={};e.r(h),e.d(h,{plugin:()=>nh});var y={};e.r(y),e.d(y,{plugin:()=>oh});var b={};e.r(b),e.d(b,{plugin:()=>dh});var D={};e.r(D),e.d(D,{plugin:()=>Ng});var P={};e.r(P),e.d(P,{plugin:()=>wd});var C={};e.r(C),e.d(C,{plugin:()=>gh});var M=e(40187),I=e(41987),R=e(32264),T=e(74848),S=e(65158),L=e(67061),O=e(55852),j=e(85242),N=e(51612),F=e(31678),U=e(57220),w=e(2543),B=e.n(w),K=e(96540),W=e(90182),z=e(14578),Y=e(61410),X=e(23770),q=e(88467),G=e(94822),te=e(75214);const H=Z=>{const{onChange:me,id:Me,defaultValue:Ne,dataSource:Ze}=Z,ct=(0,F.useDispatch)();(0,K.useEffect)(()=>{Ze?Ze&&ct((0,X.mB)({rulesSourceName:Ze})):ct((0,X.nV)())},[ct,Ze]);const gt=(0,Y.$)(nn=>nn.promRules),Bt=(0,q.p0)(gt),Vt=(0,q.Vf)(gt),Xt=(0,K.useMemo)(()=>{if((0,w.isEmpty)(gt))return[];if(!Bt)return[];const nn=Object.keys(gt).flatMap(on=>gt[on].result??[]).flatMap(on=>on.groups).flatMap(on=>on.rules.filter(Rn=>Rn.type===G.JS.Alerting)).flatMap(on=>on.alerts??[]).map(on=>Object.keys(on.labels??{})).flatMap(on=>on.filter(Rn=>!(0,te.F2)(Rn)));return(0,w.uniq)(nn)},[Bt,gt]);return(0,T.jsx)(W.KF,{id:Me,isLoading:Vt,defaultValue:Ne,"aria-label":"group by label keys",placeholder:"Group by",prefix:(0,T.jsx)(z.I,{name:"tag-alt"}),onChange:nn=>{me(nn.map(on=>on.value??""))},options:Xt.map(nn=>({label:nn,value:nn}))})};var se=e(32196),ne=e(42941),le=e(94701),_=e(3591),Q=e(40845),ae=e(40276),oe=e(37494),J=e(39558),ee=e(42418),de=e(2913),xe=e(55907),re=e(79938),ue=e(75648),Te=e(9518),ge=e(55740),Oe=e(32642),Ue=e(23662),Xe=e(14792),we=e(19073),qe=e(64861),We=e(15458),Ce=e(55127),je=e.n(Ce),Ke=e(2426),_e=e(56361),Fe=e(15054),at=e(98164),Ct=e(54317);function Dt(Z,me){const Me=(0,Oe.Zc)(Z);return(0,at.Av)(me,Me)}function tt(Z,me){const{stateFilter:Me,alertInstanceLabelFilter:Ne}=Z;return(0,w.isEmpty)(Me)?me:me.filter(Ze=>(Me.firing&&((0,Ct.S)(Ze,G.Gi.Alerting)||(0,Ct.S)(Ze,G.cF.Firing))||Me.pending&&((0,Ct.S)(Ze,G.Gi.Pending)||(0,Ct.S)(Ze,G.cF.Pending))||Me.noData&&(0,Ct.S)(Ze,G.Gi.NoData)||Me.normal&&(0,Ct.S)(Ze,G.Gi.Normal)||Me.error&&(0,Ct.S)(Ze,G.Gi.Error)||Me.inactive&&(0,Ct.S)(Ze,G.cF.Inactive))&&(Ne?Dt(Z.alertInstanceLabelFilter,Ze.labels):!0))}const ze=({rule:Z,alerts:me,options:Me,grafanaTotalInstances:Ne,handleInstancesLimit:Ze,limitInstances:ct,grafanaFilteredInstancesTotal:gt})=>{const Bt=Me.groupMode===qe.r6.Custom?!0:Me.showInstances,[Vt,Xt]=(0,K.useState)(Bt),nn=(0,Q.of)(pe),on=(0,Q.of)(O.my),Rn=(0,K.useCallback)(()=>{Xt(ka=>!ka)},[]),rn=(0,K.useMemo)(()=>tt(Me,(0,_e.Cp)(Me.sortOrder,me))??[],[me,Me]),Nn=Ne!==void 0,ms=Ne&&gt?Ne-gt:0,rs=me.length-rn.length,gs=Nn?ms:rs,os=rn.length>0,Fn=os?Rn:w.noop;(0,K.useEffect)(()=>{rn.length===0&&Xt(!1)},[rn]);const Gn=async()=>{Ze&&(Ze(!1),Xt(!0))},ba=async()=>{Ze&&(Ze(!0),Xt(!0))},zs=ct?gt:rn.length,sa=rn.length,ys=Nn?zs:sa,is=ct?`Showing ${ue.Ys} of ${Ne} instances`:`Showing all ${Ne} instances`,Ls=ct?"View all instances":`Limit the result to ${ue.Ys} instances`,Cs=Ne&&ue.Ys===rn.length&&Ne>rn.length,Gs=Ne&&ue.Ys<rn.length&&!ct,xa=Cs||Gs?(0,T.jsxs)("div",{className:nn.footerRow,children:[(0,T.jsx)("div",{children:is}),(0,T.jsx)(O.$n,{size:"sm",variant:"secondary",onClick:ct?Gn:ba,children:Ls})]}):void 0;return(0,T.jsxs)("div",{children:[Me.groupMode===qe.r6.Default&&(0,T.jsxs)("button",{className:(0,se.cx)(on,os?nn.clickable:""),onClick:()=>Fn(),children:[os&&(0,T.jsx)(z.I,{name:Vt?"angle-down":"angle-right",size:"md"}),(0,T.jsx)("span",{children:`${ys} ${je()("instance",ys)}`}),gs>0&&(0,T.jsxs)("span",{children:[", ",`${gs} hidden by filters`]})]}),Vt&&(0,T.jsx)(Ke.D,{rule:Z,instances:rn,pagination:{itemsPerPage:2*Fe.FG},footerRow:xa})]})},pe=Z=>({clickable:(0,se.css)`
    cursor: pointer;
  `,footerRow:(0,se.css)`
    display: flex;
    flex-direction: column;
    gap: ${Z.spacing(1)};
    justify-content: space-between;
    align-items: center;
    width: 100%;
  `}),Se="__ungrouped__",fe=({rules:Z,options:me})=>{const Me=(0,Q.of)(Mt),Ne=me.groupBy,Ze=(0,K.useMemo)(()=>{const ct=new Map,gt=Xt=>Ne?he(Xt,Ne):!0;Z.forEach(Xt=>{const nn=(0,Ue.TU)(Xt),on=gt(Xt);(nn?.alerts??[]).forEach(Rn=>{const rn=on?Ee(Ne,Rn.labels):Se,Nn=ct.get(rn)?.alerts??[];ct.set(rn,{rule:Xt,alerts:[...Nn,Rn]})})});const Bt=ct.get(Se)?.alerts??[];return ct.delete(Se),ct.set(Se,{alerts:Bt}),Array.from(ct.entries()).reduce((Xt,[nn,{rule:on,alerts:Rn}])=>{const rn=tt(me,Rn);return rn.length>0&&Xt.set(nn,{rule:on,alerts:rn}),Xt},new Map)},[Ne,Z,me]);return(0,T.jsx)(T.Fragment,{children:Array.from(Ze).map(([ct,{rule:gt,alerts:Bt}])=>(0,T.jsx)("li",{className:Me.alertRuleItem,"data-testid":ct,children:(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{className:Me.customGroupDetails,children:(0,T.jsxs)("div",{className:Me.alertLabels,children:[ct!==Se&&Pe(ct).map(([Vt,Xt])=>(0,T.jsx)(We.R,{labelKey:Vt,value:Xt},Vt)),ct===Se&&"No grouping"]})}),(0,T.jsx)(ze,{rule:gt,alerts:Bt,options:me})]})},ct))})};function Ee(Z,me){return new URLSearchParams(Z.map(Me=>[Me,me[Me]])).toString()}function Pe(Z){return[...new URLSearchParams(Z)]}function he(Z,me){const Me=(0,Ue.TU)(Z);return me.every(Ne=>(Me?.alerts??[]).some(Ze=>Ze.labels[Ne]))}const be=fe;var Ae=e(87586),De=e(70416),Ie=e(26058),ke=e(18461),dt=e(3704);function Pt(Z){return Object.values(Z).filter(me=>me!==void 0).reduce((me,Me)=>me+Me,0)}const pt=({rules:Z,options:me,handleInstancesLimit:Me,limitInstances:Ne,hideViewRuleLinkText:Ze})=>{const ct=(0,Q.of)(Mt),gt=(0,Q.of)(Tt),{href:Bt}=(0,Ae.A)(),Vt=Z.length<=me.maxItems?Z:Z.slice(0,me.maxItems);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)("ol",{className:ct.alertRuleList,children:Vt.map((Xt,nn)=>{const{namespaceName:on,groupName:Rn,dataSourceName:rn}=Xt,Nn=(0,Ue.Z8)(Xt.promRule)?Xt.promRule:void 0,ms=(0,Ue.Om)(Nn),rs=(0,ke.UP)(Xt.dataSourceName,Xt),gs=(0,ke.$9)(rs),os=Xt.dataSourceName===U.hY?Pt(Xt.instanceTotals):void 0,Fn=Xt.dataSourceName===U.hY?Pt(Xt.filteredInstanceTotals):void 0,Gn=(0,dt.G)(`/alerting/${encodeURIComponent(rn)}/${encodeURIComponent(gs)}/view`,{returnTo:Bt??""});return Nn?(0,T.jsxs)("li",{className:ct.alertRuleItem,children:[(0,T.jsx)("div",{className:gt.icon,children:(0,T.jsx)(z.I,{name:xe.A.getStateDisplayModel(Nn.state).iconClass,className:gt[(0,Ue.Wy)(Nn.state)],size:"lg"})}),(0,T.jsxs)("div",{className:ct.alertNameWrapper,children:[(0,T.jsxs)("div",{className:ct.instanceDetails,children:[(0,T.jsxs)(L.B,{direction:"row",gap:1,children:[(0,T.jsx)("div",{className:ct.alertName,title:Xt.name,children:Xt.name}),(0,T.jsx)(Ie.h,{}),Gn&&(0,T.jsxs)("a",{href:Gn,target:"__blank",className:ct.link,rel:"noopener","aria-label":"View alert rule",children:[(0,T.jsx)("span",{className:(0,se.cx)({[ct.hidden]:Ze}),children:"View alert rule"}),(0,T.jsx)(z.I,{name:"external-link-alt",size:"sm"})]})]}),(0,T.jsxs)("div",{className:ct.alertDuration,children:[(0,T.jsx)("span",{className:gt[(0,Ue.Wy)(Nn.state)],children:(0,Ue.XI)(Nn.state)})," ",ms&&Nn.state!==G.cF.Inactive&&(0,T.jsxs)(T.Fragment,{children:["for"," ",(0,T.jsx)("span",{children:(0,De.dU)({start:ms,end:Date.now()})})]})]})]}),(0,T.jsx)(ze,{rule:Xt,alerts:Nn.alerts??[],options:me,grafanaTotalInstances:os,grafanaFilteredInstancesTotal:Fn,handleInstancesLimit:Me,limitInstances:Ne})]})]},`alert-${on}-${Rn}-${Xt.name}-${nn}`):null})})})},Tt=Z=>({common:(0,se.css)`
    width: 70px;
    text-align: center;
    align-self: stretch;

    display: inline-block;
    color: white;
    border-radius: ${Z.shape.radius.default};
    font-size: ${Z.typography.bodySmall.fontSize};
    text-transform: capitalize;
    line-height: 1.2;
    flex-shrink: 0;

    display: flex;
    flex-direction: column;
    justify-content: center;
  `,icon:(0,se.css)`
    margin-top: ${Z.spacing(2.5)};
    align-self: flex-start;
  `,good:(0,se.css)`
    color: ${Z.colors.success.main};
  `,bad:(0,se.css)`
    color: ${Z.colors.error.main};
  `,warning:(0,se.css)`
    color: ${Z.colors.warning.main};
  `,neutral:(0,se.css)`
    color: ${Z.colors.secondary.main};
  `,info:(0,se.css)`
    color: ${Z.colors.primary.main};
  `}),jt=pt;function $t(Z){const me=(Me,[Ne,Ze])=>Ze?[...Me,Ne]:Me;return Object.entries(Z).reduce(me,[])}const sn=({dispatch:Z,limitInstances:me,matcherList:Me,dataSourceName:Ne,stateList:Ze})=>{Z(Ne?(0,X.Lc)({rulesSourceName:Ne,limitAlerts:me?ue.Ys:void 0,matcher:Me,state:Ze}):(0,X.yo)(!1,{limitAlerts:me?ue.Ys:void 0,matcher:Me,state:Ze}))};function Yt(Z){const me=(0,F.useDispatch)(),[Me,Ne]=(0,ne.A)(!0),[,Ze]=(0,we.Ej)(we.RY.ViewAlertRule),{usePrometheusRulesByNamespaceQuery:ct}=re.hK,gt=(0,Y.$)(ra=>ra.promRules),Bt=(0,Y.$)(ra=>ra.rulerRules),Vt=(0,q.t4)(gt),Xt=Z.width<320;(0,K.useEffect)(()=>{Z.options.stateFilter.inactive===!0&&(Z.options.stateFilter.normal=!0),Z.options.stateFilter.inactive=void 0},[Z.options.stateFilter]);let nn;(0,le.A)(()=>{nn=(0,Xe.UA)().getCurrent()});const on=(0,K.useMemo)(()=>$t(Z.options.stateFilter),[Z.options.stateFilter]),{options:Rn,replaceVariables:rn}=Z,Nn=Rn.datasource===U.vv?U.hY:Rn.datasource,ms={...Z.options,alertName:rn(Rn.alertName),alertInstanceLabelFilter:rn(Rn.alertInstanceLabelFilter)},rs=(0,K.useMemo)(()=>(0,Oe.Zc)(ms.alertInstanceLabelFilter),[ms.alertInstanceLabelFilter]),gs=(!Nn||Nn===U.hY)&&Ze,{currentData:os=[],isLoading:Fn,refetch:Gn}=ct({limitAlerts:Me?ue.Ys:void 0,matcher:rs,state:on},{skip:!gs});(0,K.useEffect)(()=>{gt.loading||sn({dispatch:me,limitInstances:Me,matcherList:rs,dataSourceName:Nn,stateList:on});const ra=nn?.events.subscribe(_.sR,()=>{gs&&Gn(),(!Nn||Nn!==U.hY)&&sn({dispatch:me,limitInstances:Me,matcherList:rs,dataSourceName:Nn,stateList:on})});return()=>{ra?.unsubscribe()}},[me,nn,rs,on,Me,Nn,Gn,gs,gt.loading]);const ba=ra=>{ra?(sn({dispatch:me,limitInstances:Me,matcherList:rs,dataSourceName:Nn,stateList:on}),Ne(!0)):(sn({dispatch:me,limitInstances:!1,matcherList:rs,dataSourceName:Nn,stateList:on}),Ne(!1))},zs=(0,Te.dy)(void 0,os),sa=(0,q.t4)(Bt),ys=(0,q.BU)(gt),is=Vt||sa,Ls=(0,q.Vf)(gt),Cs=(0,Q.of)(Mt),Gs=(0,Ue.dS)(zs),xa=Z.options.sortOrder,ka=(0,K.useMemo)(()=>bn(Z,qt(xa,Gs)),[Gs,xa,Z]),Ja=ka.length===0?"No alerts matching filters":void 0,Wr=Fn||is&&Ls&&!ys,Ua=Object.values(gt).some(ra=>ra.result);return(0,T.jsx)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:(0,T.jsxs)("div",{className:Cs.container,children:[Ua&&Ja&&(0,T.jsx)("div",{className:Cs.noAlertsMessage,children:Ja}),Ua&&(0,T.jsxs)("section",{children:[Z.options.viewMode===qe.nE.Stat&&(0,T.jsx)(oe.yV,{width:Z.width,height:Z.height,graphMode:oe.$p.None,textMode:oe.SV.Auto,justifyMode:oe.F8.Auto,theme:de.config.theme2,value:{text:`${ka.length}`,numeric:ka.length}}),Z.options.viewMode===qe.nE.List&&Z.options.groupMode===qe.r6.Custom&&(0,T.jsx)(be,{rules:ka,options:ms}),Z.options.viewMode===qe.nE.List&&Z.options.groupMode===qe.r6.Default&&(0,T.jsx)(jt,{rules:ka,options:ms,handleInstancesLimit:ba,limitInstances:Me,hideViewRuleLinkText:Xt})]}),Wr&&(0,T.jsx)(J._,{text:"Loading..."})]})})}function qt(Z,me){if(Z===qe.xB.Importance)return(0,w.sortBy)(me,Ne=>xe.A.alertStateSortScore[Ne.state]);if(Z===qe.xB.TimeAsc)return(0,w.sortBy)(me,Ne=>{const Ze=(0,Ue.TU)(Ne)??void 0;return(0,Ue.Om)(Ze)||new Date});if(Z===qe.xB.TimeDesc)return(0,w.sortBy)(me,Ne=>{const Ze=(0,Ue.TU)(Ne)??void 0;return(0,Ue.Om)(Ze)||new Date}).reverse();const Me=(0,w.sortBy)(me,Ne=>Ne.name.toLowerCase());return Z===qe.xB.AlphaDesc&&Me.reverse(),Me}function bn(Z,me){const{options:Me,replaceVariables:Ne}=Z;let Ze=[...me];if(Me.dashboardAlerts){const ct=(0,Xe.UA)().getCurrent()?.uid;Ze=Ze.filter(({annotations:gt={}})=>Object.entries(gt).some(([Bt,Vt])=>Bt===ge.YH.dashboardUID&&Vt===ct))}if(Me.alertName){const ct=Ne(Me.alertName);Ze=Ze.filter(({name:gt})=>gt.toLocaleLowerCase().includes(ct.toLocaleLowerCase()))}if(Ze=Ze.filter(ct=>{const gt=(0,Ue.TU)(ct);return gt?Me.stateFilter.firing&&gt.state===G.cF.Firing||Me.stateFilter.pending&&gt.state===G.cF.Pending||Me.stateFilter.normal&&gt.state===G.cF.Inactive:!1}),Me.folder&&(Ze=Ze.filter(ct=>ct.namespaceName===Me.folder.title)),Me.datasource){const ct=Me.datasource===U.vv;Ze=Ze.filter(ct?({dataSourceName:gt})=>gt===U.hY:({dataSourceName:gt})=>gt===Me.datasource)}return Ze=Ze.reduce((ct,gt)=>{const Bt=(0,Ue.TU)(gt);return(Bt?tt({stateFilter:Me.stateFilter,alertInstanceLabelFilter:Ne(Me.alertInstanceLabelFilter)},Bt.alerts??[]):[]).length&&ct.push(gt),ct},[]),Ze}const Mt=Z=>({cardContainer:(0,se.css)`
    padding: ${Z.spacing(.5)} 0 ${Z.spacing(.25)} 0;
    line-height: ${Z.typography.body.lineHeight};
    margin-bottom: 0px;
  `,container:(0,se.css)`
    overflow-y: auto;
    height: 100%;
  `,alertRuleList:(0,se.css)`
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    list-style-type: none;
  `,alertRuleItem:(0,se.css)`
    display: flex;
    align-items: center;
    width: 100%;
    height: 100%;
    background: ${Z.colors.background.secondary};
    padding: ${Z.spacing(.5)} ${Z.spacing(1)};
    border-radius: ${Z.shape.radius.default};
    margin-bottom: ${Z.spacing(.5)};

    gap: ${Z.spacing(2)};
  `,alertName:(0,se.css)`
    font-size: ${Z.typography.h6.fontSize};
    font-weight: ${Z.typography.fontWeightBold};

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,alertNameWrapper:(0,se.css)`
    display: flex;
    flex: 1;
    flex-wrap: nowrap;
    flex-direction: column;

    min-width: 100px;
  `,alertLabels:(0,se.css)`
    > * {
      margin-right: ${Z.spacing(.5)};
    }
  `,alertDuration:(0,se.css)`
    font-size: ${Z.typography.bodySmall.fontSize};
  `,alertRuleItemText:(0,se.css)`
    font-weight: ${Z.typography.fontWeightBold};
    font-size: ${Z.typography.bodySmall.fontSize};
    margin: 0;
  `,alertRuleItemTime:(0,se.css)`
    color: ${Z.colors.text.secondary};
    font-weight: normal;
    white-space: nowrap;
  `,alertRuleItemInfo:(0,se.css)`
    font-weight: normal;
    flex-grow: 2;
    display: flex;
    align-items: flex-end;
  `,noAlertsMessage:(0,se.css)`
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  `,alertIcon:(0,se.css)`
    margin-right: ${Z.spacing(.5)};
  `,instanceDetails:(0,se.css)`
    min-width: 1px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  `,customGroupDetails:(0,se.css)`
    margin-bottom: ${Z.spacing(.5)};
  `,link:(0,se.css)`
    word-break: break-all;
    color: ${Z.colors.primary.text};
    display: flex;
    align-items: center;
    gap: ${Z.spacing(1)};
  `,hidden:(0,se.css)`
    display: none;
  `});function Jt(Z){const[,me]=(0,we.Ej)(we.RY.ViewAlertRule),[,Me]=(0,we.Ej)(we.RY.ViewExternalAlertRule);return!me&&!Me?(0,T.jsx)(ee.F,{title:"Permission required",children:"Sorry, you do not have the required permissions to read alert rules"}):(0,T.jsx)(Yt,{...Z})}const Gt=new S.m(Jt).setPanelOptions(Z=>{Z.addRadio({path:"viewMode",name:"View mode",description:"Toggle between list view and stat view",defaultValue:qe.nE.List,settings:{options:[{label:"List",value:qe.nE.List},{label:"Stat",value:qe.nE.Stat}]},category:["Options"]}).addRadio({path:"groupMode",name:"Group mode",description:"How alert instances should be grouped",defaultValue:qe.r6.Default,settings:{options:[{value:qe.r6.Default,label:"Default grouping"},{value:qe.r6.Custom,label:"Custom grouping"}]},category:["Options"]}).addCustomEditor({path:"groupBy",name:"Group by",description:"Filter alerts using label querying",id:"groupBy",defaultValue:[],showIf:me=>me.groupMode===qe.r6.Custom,category:["Options"],editor:me=>(0,T.jsx)(H,{id:me.id??"groupBy",defaultValue:me.value.map(Me=>({label:Me,value:Me})),onChange:me.onChange,dataSource:me.context.options.datasource})}).addNumberInput({name:"Max items",path:"maxItems",description:"Maximum alerts to display",defaultValue:20,category:["Options"]}).addSelect({name:"Sort order",path:"sortOrder",description:"Sort order of alerts and alert instances",settings:{options:[{label:"Alphabetical (asc)",value:qe.xB.AlphaAsc},{label:"Alphabetical (desc)",value:qe.xB.AlphaDesc},{label:"Importance",value:qe.xB.Importance},{label:"Time (asc)",value:qe.xB.TimeAsc},{label:"Time (desc)",value:qe.xB.TimeDesc}]},defaultValue:qe.xB.AlphaAsc,category:["Options"]}).addBooleanSwitch({path:"dashboardAlerts",name:"Alerts linked to this dashboard",description:"Only show alerts linked to this dashboard",defaultValue:!1,category:["Options"]}).addTextInput({path:"alertName",name:"Alert name",description:"Filter for alerts containing this text",defaultValue:"",category:["Filter"]}).addTextInput({path:"alertInstanceLabelFilter",name:"Alert instance label",description:'Filter alert instances using label querying, ex: {severity="critical", instance=~"cluster-us-.+"}',defaultValue:"",category:["Filter"]}).addCustomEditor({path:"datasource",name:"Datasource",description:"Filter from alert source",id:"datasource",defaultValue:null,editor:function(Me){return(0,T.jsxs)(L.B,{gap:1,children:[(0,T.jsx)(N.s,{...Me,type:["prometheus","loki","grafana"],noDefault:!0,current:Me.value,onChange:Ne=>Me.onChange(Ne.name)}),(0,T.jsx)(O.$n,{variant:"secondary",onClick:()=>Me.onChange(null),children:"Clear"})]})},category:["Filter"]}).addCustomEditor({showIf:me=>me.datasource===U.vv||!me.datasource,path:"folder",name:"Folder",description:"Filter for alerts in the selected folder (only for Grafana alerts)",id:"folder",defaultValue:null,editor:function(Me){return(0,T.jsx)(j.sR,{enableReset:!0,showRoot:!1,allowEmpty:!0,initialTitle:Me.value?.title,initialFolderUid:Me.value?.uid,permissionLevel:F.PermissionLevelString.View,onClear:()=>Me.onChange(""),...Me})},category:["Filter"]}).addBooleanSwitch({path:"stateFilter.firing",name:"Alerting / Firing",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.pending",name:"Pending",defaultValue:!0,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.noData",name:"No Data",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.normal",name:"Normal",defaultValue:!1,category:["Alert state filter"]}).addBooleanSwitch({path:"stateFilter.error",name:"Error",defaultValue:!0,category:["Alert state filter"]})});var Lt=e(79924),At=e(64423),Nt=e(71733),Dn=e(26272),An=e(69129),Pn=e(47232),Xn=e(39601),Tn=e(17172),ht=e(64149),St=e(3911),Ge=e(85918),Ve=e(28138),lt=e(10860),It=e(44522),Qe=e(56034);const vt=({options:Z,annotation:me,formatDate:Me,onClick:Ne,onAvatarClick:Ze,onTagClick:ct})=>{const gt=(0,Q.of)(vn),{showUser:Bt,showTags:Vt,showTime:Xt}=Z,{text:nn="",login:on,email:Rn,avatarUrl:rn,tags:Nn,time:ms,timeEnd:rs}=me,gs=()=>{Ne(me)},os=()=>{Ze(me)},Fn=on&&Bt,Gn=ms&&Xt,ba=rs&&rs!==ms&&Xt;return(0,T.jsxs)(lt.Z,{className:gt.card,onClick:gs,children:[(0,T.jsx)(lt.Z.Heading,{children:(0,T.jsx)(It.I,{className:gt.heading,onClick:zs=>{zs.stopPropagation()},content:nn})}),Gn&&(0,T.jsxs)(lt.Z.Description,{className:gt.timestamp,children:[(0,T.jsx)(zt,{formatDate:Me,time:ms}),ba&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("span",{className:gt.time,children:"-"}),(0,T.jsx)(zt,{formatDate:Me,time:rs})," "]})]}),Fn&&(0,T.jsx)(lt.Z.Meta,{className:gt.meta,children:(0,T.jsx)(Ot,{email:Rn,login:on,avatarUrl:rn,onClick:os})}),Vt&&Nn&&(0,T.jsx)(lt.Z.Tags,{children:(0,T.jsx)(ht.L,{tags:Nn,onClick:zs=>ct(zs,!1)})})]})},Ot=({onClick:Z,avatarUrl:me,login:Me,email:Ne})=>{const Ze=(0,Q.of)(vn),ct=Bt=>{Bt.stopPropagation(),Z()},gt=(0,T.jsxs)("span",{children:["Created by:",(0,T.jsx)("br",{})," ",Ne]});return(0,T.jsx)(Qe.m,{content:gt,theme:"info",placement:"top",children:(0,T.jsx)("button",{onClick:ct,className:Ze.avatar,children:(0,T.jsx)("img",{src:me,alt:"avatar icon"})})})},zt=({time:Z,formatDate:me})=>{const Me=(0,Q.of)(vn);return(0,T.jsx)("span",{className:Me.time,children:(0,T.jsx)("span",{children:me(Z)})})};function vn(Z){return{card:(0,se.css)({gridTemplateAreas:'"Heading Description Meta Tags"',gridTemplateColumns:"auto 1fr auto auto",padding:Z.spacing(1),margin:Z.spacing(.5),width:"inherit"}),heading:(0,se.css)({a:{zIndex:1,position:"relative",color:Z.colors.text.link,"&:hover":{textDecoration:"underline"}}}),meta:(0,se.css)({margin:0,position:"relative",justifyContent:"end"}),timestamp:(0,se.css)({margin:0,alignSelf:"center"}),time:(0,se.css)({marginLeft:Z.spacing(1),marginRight:Z.spacing(1),fontSize:Z.typography.bodySmall.fontSize,color:Z.colors.text.secondary}),avatar:(0,se.css)({border:"none",background:"inherit",margin:0,padding:Z.spacing(.5),img:{borderRadius:Z.shape.radius.circle,width:Z.spacing(2),height:Z.spacing(2)}})}}class ln extends K.PureComponent{constructor(me){super(me),this.style=On(R.$.theme2),this.subs=new At.yU,this.tagListRef=(0,K.createRef)(),this.onAnnoClick=async Me=>{if(!Me.time)return;const{options:Ne}=this.props,ct=(0,Xe.UA)().getCurrent(),gt={from:this._timeOffset(Me.time,Ne.navigateBefore,!0),to:this._timeOffset(Me.timeEnd??Me.time,Ne.navigateAfter,!1),viewPanel:Ne.navigateToPanel&&Me.panelId?Me.panelId:void 0};if(!Me.dashboardUID||ct?.uid===Me.dashboardUID){Xn.Ny.partial(gt);return}const Bt=await(0,Tn.AI)().get("/api/search",{dashboardUIDs:Me.dashboardUID});if(Bt&&Bt.length&&Bt[0].uid===Me.dashboardUID){const Vt=Bt[0],Xt=new URL(Vt.url,window.location.origin);Xt.searchParams.set("from",String(gt.from)),Xt.searchParams.set("to",String(gt.to)),Xn.Ny.push(Nt.I.stripBaseFromUrl(Xt.toString()));return}Ve.A.emit(Dn.r1.alertWarning,["Unknown Dashboard: "+Me.dashboardUID])},this.onTagClick=(Me,Ne)=>{if(!Ne&&this.state.queryTags.includes(Me))return;const Ze=Ne?this.state.queryTags.filter(gt=>gt!==Me):[...this.state.queryTags,Me];let ct;if(Ne){const gt=document.activeElement,Bt=gt?.getAttribute("data-tag-id");if(this.tagListRef.current?.contains(gt)&&Bt){const Vt=Number.parseInt(Bt,10),Xt=this.tagListRef.current.querySelector(`[data-tag-id="${Vt+1}"]`)??this.tagListRef.current.querySelector(`[data-tag-id="${Vt-1}"]`);Xt instanceof HTMLElement&&(ct=Xt)}}this.setState({queryTags:Ze},()=>ct?.focus())},this.onUserClick=Me=>{this.setState({queryUser:{id:Me.userId,login:Me.login,email:Me.email}})},this.onClearUser=()=>{this.setState({queryUser:void 0})},this.renderItem=(Me,Ne)=>{const{options:Ze}=this.props,ct=(0,Xe.UA)().getCurrent();return ct?(0,T.jsx)(vt,{annotation:Me,formatDate:ct.formatDate,onClick:this.onAnnoClick,onAvatarClick:this.onUserClick,onTagClick:this.onTagClick,options:Ze}):(0,T.jsx)(T.Fragment,{})},this.state={annotations:[],timeInfo:"",loaded:!1,queryTags:[]}}componentDidMount(){this.doSearch(),this.subs.add(this.props.eventBus.getStream(An.We).subscribe({next:()=>{this.doSearch()}}))}componentWillUnmount(){this.subs.unsubscribe()}componentDidUpdate(me,Me){const{options:Ne,timeRange:Ze}=this.props;(Ne!==me.options||this.state.queryTags!==Me.queryTags||this.state.queryUser!==Me.queryUser||me.renderCounter!==this.props.renderCounter||Ne.onlyInTimeRange&&Ze!==me.timeRange)&&this.doSearch()}async doSearch(){const{options:me}=this.props,{queryUser:Me,queryTags:Ne}=this.state,Ze={tags:me.tags,limit:me.limit,type:"annotation"};me.onlyFromThisDashboard&&(Ze.dashboardUID=(0,Xe.UA)().getCurrent()?.uid);let ct="";if(me.onlyInTimeRange){const{timeRange:Bt}=this.props;Ze.from=Bt.from.valueOf(),Ze.to=Bt.to.valueOf()}else ct="All Time";Me&&(Ze.userId=Me.id),me.tags&&me.tags.length&&(Ze.tags=me.tags.map(Bt=>this.props.replaceVariables(Bt))),Ne.length&&(Ze.tags=Ze.tags?[...Ze.tags,...Ne]:Ne);const gt=await(0,Tn.AI)().get("/api/annotations",Ze,`anno-list-panel-${this.props.id}`);this.setState({annotations:gt,timeInfo:ct,loaded:!0})}_timeOffset(me,Me,Ne=!1){let Ze=5,ct="m";const gt=/^(\d+)(\w)/.exec(Me);gt&&gt.length===3&&(Ze=parseInt(gt[1],10),ct=gt[2]);const Bt=(0,Pn.KQ)(me);return Ne&&(Ze*=-1),Bt.add(Ze,ct).valueOf()}render(){const{loaded:me,annotations:Me,queryUser:Ne,queryTags:Ze}=this.state;if(!me)return(0,T.jsx)("div",{children:"loading..."});const ct=Ne||Ze.length>0;return(0,T.jsxs)(ae.E,{autoHeightMin:"100%",children:[ct&&(0,T.jsxs)("div",{className:this.style.filter,children:[(0,T.jsx)("b",{children:"Filter:"}),Ne&&(0,T.jsx)(O.$n,{size:"sm",variant:"secondary",fill:"text",onClick:this.onClearUser,"aria-label":`Remove filter: ${Ne.email}`,children:Ne.email}),Ze.length>0&&(0,T.jsx)(ht.L,{icon:"times",tags:Ze,onClick:gt=>this.onTagClick(gt,!0),getAriaLabel:gt=>`Remove ${gt} tag`,className:this.style.tagList,ref:this.tagListRef})]}),Me.length<1&&(0,T.jsx)("div",{className:this.style.noneFound,children:"No Annotations Found"}),(0,T.jsx)(Ge.p,{items:Me,renderItem:this.renderItem,getItemKey:gt=>`${gt.id}`})]})}}const On=(0,St.N)(Z=>({noneFound:(0,se.css)({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"calc(100% - 30px)"}),filter:(0,se.css)({alignItems:"center",display:"flex",flexWrap:"wrap",gap:Z.spacing(.5),padding:Z.spacing(.5)}),tagList:(0,se.css)({justifyContent:"flex-start","li > button":{paddingLeft:"3px"}})})),wn={limit:10,navigateAfter:"10m",navigateBefore:"10m",navigateToPanel:!0,onlyFromThisDashboard:!1,onlyInTimeRange:!1,showTags:!0,showTime:!0,showUser:!0,tags:[]},Un=new S.m(ln).setPanelOptions(Z=>{Z.addRadio({category:["Annotation query"],path:"onlyFromThisDashboard",name:"Query filter",defaultValue:wn.onlyFromThisDashboard,settings:{options:[{value:!1,label:"All dashboards"},{value:!0,label:"This dashboard"}]}}).addRadio({category:["Annotation query"],path:"onlyInTimeRange",name:"Time range",defaultValue:wn.onlyInTimeRange,settings:{options:[{value:!1,label:"None"},{value:!0,label:"This dashboard"}]}}).addCustomEditor({category:["Annotation query"],id:"tags",path:"tags",name:"Tags",description:"Match annotation tags",editor(me){return(0,T.jsx)(Lt.u,{tags:me.value,onChange:me.onChange})}}).addNumberInput({category:["Annotation query"],path:"limit",name:"Limit",defaultValue:wn.limit}).addBooleanSwitch({category:["Display"],path:"showUser",name:"Show user",defaultValue:wn.showUser}).addBooleanSwitch({category:["Display"],path:"showTime",name:"Show time",defaultValue:wn.showTime}).addBooleanSwitch({category:["Display"],path:"showTags",name:"Show tags",defaultValue:wn.showTags}).addRadio({category:["Link behavior"],path:"navigateToPanel",name:"Link target",defaultValue:wn.navigateToPanel,settings:{options:[{value:!0,label:"Panel"},{value:!1,label:"Dashboard"}]}}).addTextInput({category:["Link behavior"],path:"navigateBefore",name:"Time before",defaultValue:wn.navigateBefore,description:""}).addTextInput({category:["Link behavior"],path:"navigateAfter",name:"Time after",defaultValue:wn.navigateAfter,description:""})}).setPanelChangeHandler((Z,me,Me)=>me==="ryantxu-annolist-panel"?Me:Z.options);var cs=e(37055),Zn=e(24293),wt=e(27310),Ft=e(47070),Ht=e(11261),ut=e(52622),pn=e(52198),Jn=e(38248),Qn=e(11404),fs=e(89654),ls=e(22680),vs=e(71242),ea=e(24882),Ks=e(97152),Hs=e(29413),bs=e(30501),Ys=e(67266),La=e(81297),Xs=e(38761),Ta=e(22731),Lr=e(8066),$r=e(96516),Za=e(16895),Er=e(28895);function Ar(Z,me){return me[0].fields.slice(1).some(Me=>!Me.config.custom?.hideFrom?.legend)}const ho=(0,K.memo)(({data:Z,placement:me,calcs:Me,displayMode:Ne,colorField:Ze,...ct})=>{const gt=(0,Q.$j)();if(Ze!=null){const Vt=(0,Er.jY)([Ze],gt);if(Vt?.length)return(0,T.jsx)(Ys.KU.Legend,{placement:me,children:(0,T.jsx)($r.t,{placement:me,items:Vt,displayMode:Ne})})}const Bt=Z[0].fields.slice(1).map((Vt,Xt)=>{const on=Xt+1;if(!Vt||Vt.config.custom?.hideFrom?.legend)return;const Rn=Vt.state?.displayName??Vt.name,rn=(0,Lr.lz)(Vt,gt).color;return{disabled:Vt.state?.hideFrom?.viz,color:rn,label:Rn,yAxis:Vt.config.custom?.axisPlacement===ut.vM.Right?2:1,getDisplayValues:()=>(0,Za.UO)(Me,Vt,gt),getItemKey:()=>`${Rn}-0-${on}`}}).filter(Vt=>Vt!==void 0);return(0,T.jsx)(Ys.KU.Legend,{placement:me,...ct,children:(0,T.jsx)($r.t,{placement:me,items:Bt,displayMode:Ne,sortBy:ct.sortBy,sortDesc:ct.sortDesc,isSortable:!0})})});ho.displayName="BarChartLegend";var Fr=e(36613),rr=e(28240),fo=e(73060),_o=e(57875),gr=e(83195),ci=e(73134),Qo=e(51336),eo=e(52811),Do=e(82915),di=e(42994),bo=e(72724),Oo=e(23596),To=e(39758),jo=e(4134);const $o=di.WC.interval,Yo=To.ur,Si=To.ur,vi=8,ai=30,yi=.65,Bo=.1,Ai=.15,Ho=5,ui=10,Jo=.1;function Ri(Z,me,Me,Ne,Ze){const ct=(0,Hs.kD)(Z,14),gt=me/(ct.width+2)*14,Bt=Me/Ne,Vt=Math.min(Bt,gt);return{fontSize:Math.min(Vt,Ze??Vt),textMetrics:ct}}function xi(Z,me){const{xOri:Me,xDir:Ne,rawValue:Ze,getColor:ct,formatValue:gt,formatShortValue:Bt,fillOpacity:Vt=1,showValue:Xt,xSpacing:nn=0,hoverMulti:on=!1,timeZone:Rn="browser"}=Z,rn=Me===ut.Lt.Horizontal,Nn=!Z.text?.valueSize,ms=Z.stacking!==ut.gs.None,rs=Z.stacking===ut.gs.Percent;let{groupWidth:gs,barWidth:os,barRadius:Fn=0}=Z;ms&&([gs,os]=[os,gs]);let Gn;const zs=Array(30).fill(null);let sa;const ys=Qs=>Array.from(Qs.data[0].map((hs,Ms)=>Ms)),is=nn===0?void 0:(Qs,hs)=>{const Ms=Qs.bbox.width,Na=Ne*(rn?1:-1);let Oa=hs.length,Qa=Oa-1,xr=0,Io=Ms/Fr.A.pxRatio,Ci=Math.abs(Math.floor(Io/nn));xr=Oa<Ci?0:Math.ceil(Oa/Ci);let $l=hs.map((Bi,Vl)=>xr!==0&&(nn>0?Vl:Qa-Vl)%xr>0?null:Bi);return Na===1?$l:$l.reverse()},Ls=(Qs,hs,Ms,Na,Oa)=>{if(Z.xTimeAuto){let Qa=$o.year;return Oa<bs.Zj.second?Qa=$o.millisecond:Oa<bs.Zj.minute?Qa=$o.second:Oa<bs.Zj.hour?Qa=$o.minute:Oa<bs.Zj.day?Qa=$o.hour:Oa<bs.Zj.month?Qa=$o.day:Oa<bs.Zj.year?Qa=$o.month:Qa=$o.year,hs.map(xr=>xr==null?"":(0,bo.LE)(xr,{format:Qa,timeZone:Rn}))}return hs.map(Qa=>rn?Bt(0,Qa):gt(0,Qa))},Cs=(Qs,hs,Ms)=>{hs=0,Ms=Math.max(1,Qs.data[0].length-1);let Na=0;(0,To.mn)(Qs.data[0].length,gs,Yo,0,(Qa,xr,Io)=>{Na=xr+Io/2});let Oa=Ms-hs;if(Na===.5)hs-=Oa;else{let xr=(1/(1-Na*2)*Oa-Oa)/2;hs-=xr,Ms+=xr}return[hs,Ms]};let Gs=(Qs,hs)=>{let Ms=Array.from({length:hs},()=>({offs:Array(Qs).fill(0),size:Array(Qs).fill(0)}));return(0,To.mn)(Qs,gs,Yo,null,(Na,Oa,Qa)=>{(0,To.mn)(hs,os,Si,null,(xr,Io,Ci)=>{Ms[xr].offs[Na]=Oa+Qa*Io,Ms[xr].size[Na]=Qa*Ci})}),Ms},xa=(Qs,hs)=>{let Ms=Array.from({length:hs},()=>({offs:Array(Qs).fill(0),size:Array(Qs).fill(0)}));return(0,To.mn)(Qs,gs,Yo,null,(Na,Oa,Qa)=>{(0,To.mn)(hs,os,Si,null,(xr,Io,Ci)=>{Ms[xr].offs[Na]=Oa,Ms[xr].size[Na]=Qa})}),Ms};const ka=rn?Bo:Ai,Ja=rn?Ho:ui;let Wr=[],Ua=[],ra=1,la,lr=Z.text?.valueSize??ai,Kr=Ja,Ca=1/0,va=1/0,Ga=ct!=null,cr=Ga?{fill:{unit:3,values:(Qs,hs)=>Ua[hs].fill},stroke:{unit:3,values:(Qs,hs)=>Ua[hs].stroke}}:{},sr=Fr.A.paths.bars({radius:rs?0:ms?(Qs,hs)=>hs===Qs.data.length-1?[Fn,0]:[0,0]:Fn,disp:{x0:{unit:2,values:(Qs,hs)=>Wr[hs].offs},size:{unit:2,values:(Qs,hs)=>Wr[hs].size},...cr},each:(Qs,hs,Ms,Na,Oa,Qa,xr)=>{Na-=Qs.bbox.left,Oa-=Qs.bbox.top;let Io=Qs.data[hs][Ms];rn?(Ca=Math.min(Ca,Io<0?Qs.bbox.height-(Oa+xr):Oa),va=Qa):(Ca=xr,va=Math.min(va,Io<0?Na:Qs.bbox.width-(Na+Qa)));let Ci={x:Na,y:Oa,w:Qa,h:xr,sidx:hs,didx:Ms};if(!ms&&Z.fullHighlight&&(Z.xOri===ut.Lt.Horizontal?(Ci.y=0,Ci.h=Qs.bbox.height):(Ci.x=0,Ci.w=Qs.bbox.width)),Gn.add(Ci),Xt!==ut.yL.Never){const $l=Ze(hs,Ms);let Bi=1;rs&&Xr[hs][Ms]&&(Bi=Xr[hs][Ms]);const Vl=Bi===0?0:$l/Bi,Ko=gt(hs,Vl);if(Kr=Math.min(Kr,Math.round(ka*(rn?Qa:xr))),la[Ms]===void 0&&(la[Ms]={}),la[Ms][hs]={text:Ko,value:Ze(hs,Ms),hidden:!1},Nn){const{fontSize:zl,textMetrics:_l}=Ri(la[Ms][hs].text,va*(rn?yi:1)-(rn?0:Kr),Ca*(rn?1:yi)-(rn?Kr:0),1);la[Ms][hs].textMetrics=_l;let mi=Math.round(Math.min(lr,ai,zl));ra=mi/lr*(mi/14),lr=mi}else la[Ms][hs].textMetrics=(0,Hs.kD)(la[Ms][hs].text,lr);let md=rn?0:-Math.round(Jo*lr),Zi=Ze(hs,Ms);if(Z.negY?.[hs]&&Zi!=null&&(Zi*=-1),Zi!=null){const zl=Qs.bbox.left+(rn?Na+Qa/2:Zi<0?Na-Kr:Na+Qa+Kr),_l=Qs.bbox.top+(rn?Zi<0?Oa+xr+Kr:Oa-Kr:Oa+xr/2-md),{textMetrics:mi={width:1,actualBoundingBoxAscent:1,actualBoundingBoxDescent:1}}=la[Ms][hs];let Ac=0,vd=0;rn?(Ac=mi.width*ra/2,vd=Zi>0?(mi.actualBoundingBoxAscent+mi.actualBoundingBoxDescent)*ra:0):(vd=(mi.actualBoundingBoxAscent+mi.actualBoundingBoxDescent)*ra/2,Ac=Zi<0?mi.width*ra:0),la[Ms][hs].x=zl,la[Ms][hs].y=_l,la[Ms][hs].bbox={x:zl-Ac,y:_l-vd,w:mi.width*ra,h:(mi.actualBoundingBoxAscent+mi.actualBoundingBoxDescent)*ra}}}}});const vr=Qs=>{Qs.root.querySelectorAll(".u-cursor-pt").forEach(hs=>{hs.style.borderRadius="0",Z.fullHighlight&&(hs.style.zIndex="-1")})},kr={x:!1,y:!1,drag:{x:!1,y:!1},dataIdx:(Qs,hs)=>{if(hs===0){zs.fill(null),sa=null;let Ms=Qs.cursor.left*Fr.A.pxRatio,Na=Qs.cursor.top*Fr.A.pxRatio;Gn.get(Ms,Na,1,1,Oa=>{(0,jo.ur)(Ms,Na,Oa.x,Oa.y,Oa.x+Oa.w,Oa.y+Oa.h)&&(sa=zs[0]=Oa,zs[sa.sidx]=sa,on&&(0,jo.Tr)(Gn,void 0,sa.didx).forEach(Qa=>{zs[Qa.sidx]=Qa}))})}return zs[hs]?.didx},points:{fill:"rgba(255,255,255,0.4)",bbox:(Qs,hs)=>{let Ms=zs[hs],Na=Ms!=null;return{left:Na?Ms.x/Fr.A.pxRatio:-10,top:Na?Ms.y/Fr.A.pxRatio:-10,width:Na?Ms.w/Fr.A.pxRatio:0,height:Na?Ms.h/Fr.A.pxRatio:0}}},focus:{prox:1e3,dist:(Qs,hs)=>sa?.sidx===hs?0:1/0}},dr=Qs=>{if(Gn=Gn||new jo.C$(0,0,Qs.bbox.width,Qs.bbox.height),Gn.clear(),Qs.series.forEach(hs=>{hs._paths=null}),ms?Wr=[null,...xa(Qs.data[0].length,Qs.data.length-1)]:Wr=[null,...Gs(Qs.data[0].length,Qs.data.length-1)],Ga){Ua=[null];for(let hs=1;hs<Qs.data.length;hs++){let Ms=Qs.data[hs].map((Na,Oa)=>Na!=null?ct(hs,Oa,Na):null);Ua.push({fill:Vt<1?Ms.map(Na=>Na!=null?(0,Oo.X4)(Na,Vt):null):Ms,stroke:Ms})}}la={},lr=Z.text?.valueSize??ai,Kr=Ja,Ca=va=1/0},Gr=Qs=>{if(Xt===ut.yL.Never||lr<vi)return;Qs.ctx.save(),Qs.ctx.fillStyle=me.colors.text.primary,Qs.ctx.font=`${lr}px ${me.typography.fontFamily}`;let hs,Ms;for(const Na in la){let Oa=!0;for(const Qa in la[Na]){const xr=la[Na][Qa],{text:Io,x:Ci=0,y:$l=0}=xr;let{value:Bi}=xr;Z.negY?.[Qa]&&Bi!=null&&(Bi*=-1);let Vl=rn?"center":Bi!==null&&Bi<0?"right":"left",Ko=rn?Bi!==null&&Bi<0?"top":"alphabetic":"middle";if(Vl!==hs&&(Qs.ctx.textAlign=hs=Vl),Ko!==Ms&&(Qs.ctx.textBaseline=Ms=Ko),Xt===ut.yL.Always)Qs.ctx.fillText(Io,Ci,$l);else if(Xt===ut.yL.Auto){let{bbox:md}=xr,Zi=!1;if(md==null)Zi=!0,xr.hidden=!0;else if(!Oa)for(const zl in la[Na]){if(zl===Qa)continue;const _l=la[Na][zl],{bbox:mi,hidden:Ac}=_l;if(!Ac&&mi&&(0,jo.HY)(md,mi)){Zi=!0,xr.hidden=!0;break}}Oa=!1,!Zi&&Qs.ctx.fillText(Io,Ci,$l)}}}Qs.ctx.restore()};let Xr=null;function So(Qs,hs){return Xr=null,(0,Za.bq)(Qs[0],hs,({totals:Ms})=>{Xr=Ms})}return{cursor:kr,xRange:Cs,xValues:Ls,xSplits:ys,hFilter:is,barsBuilder:sr,init:vr,drawClear:dr,draw:Gr,prepData:So}}const Po={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:ut.wV.Auto,showValue:ut.yL.Auto,stacking:ut.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},ri={fillOpacity:80,gradientMode:ut.on.None,lineWidth:1};function Ei(Z,me,Me,Ne,Ze,ct){if(Z.length===0||Z.every(Xt=>Xt.length===0))return{series:[],_rest:[],warn:"No data in response"};(0,rr.Fm)(Z),(0,rr.j2)(Z,me);let gt={...Z[0]};const Bt=gt.fields.findIndex(Xt=>Xt.type===Ht.PU.time);Bt>=0&&Z.length>1&&(gt=(0,fo.Fd)({frames:Z,keepDisplayNames:!0})??gt);const Vt=gt.fields.find(Xt=>Xt.state?.displayName===Ze||Xt.name===Ze)??gt.fields.find(Xt=>Xt.type===Ht.PU.string)??gt.fields[Bt];if(Vt!=null){const Xt=[Vt],nn=[],on=ct==null?void 0:gt.fields.find(Nn=>Nn.state?.displayName===ct||Nn.name===ct);gt.fields.forEach(Nn=>{if(Nn!==Vt)if(Nn.type===Ht.PU.number&&!Nn.config.custom?.hideFrom?.viz){const ms={...Nn,values:Nn.values.map(rs=>Number.isFinite(rs)?rs:null),config:{...Nn.config,custom:{...Nn.config.custom,stacking:{group:"_",mode:Me}}}};Xt.push(ms)}else nn.push(Nn)});let Rn=null;Xt.length===1&&(Rn="No numeric fields found"),gt.fields=Xt;const rn=[gt];return(0,Do.O2)(rn,Ne,0),{series:rn,_rest:nn,color:on,warn:Rn}}return{series:[],_rest:[],color:null,warn:"Bar charts requires a string or time field"}}const Zo=({series:Z,totalSeries:me,color:Me,orientation:Ne,options:Ze,timeZone:ct,theme:gt})=>{let{showValue:Bt,groupWidth:Vt,barWidth:Xt,barRadius:nn=0,stacking:on,text:Rn,tooltip:rn,xTickLabelRotation:Nn,xTickLabelMaxLength:ms,xTickLabelSpacing:rs=0,legend:gs,fullHighlight:os}=Ze,Fn=Z[0];const Gn=new Qo.e,ba=Fn.fields.map((Ua,ra)=>on===ut.gs.Percent?(0,_o.J)({field:{...Ua,config:{...Ua.config,unit:"percentunit"}},theme:gt}):Ua.display),zs=(Ua,ra)=>(0,gr.cN)(ba[Ua](ra)),sa=(Ua,ra)=>_t(zs(Ua,ra),ms),ys=kn(Ne);Fn.fields.length===2&&on===ut.gs.None&&(me===1&&(Vt=Xt),Xt=1);const is=(Ua,ra)=>Fn.fields[Ua].values[ra];let Ls,Cs=1;if(Me!=null){const Ua=Me.display;Cs=(Me.config.custom.fillOpacity??100)/100,Ls=(ra,la)=>Ua(Me.values[la]).color}else Fn.fields.some(ra=>ra.config.custom?.gradientMode===ut.on.Scheme&&ra.config.color?.mode===ci.Yb.Thresholds||ra.config.mappings?.some(lr=>lr.type==="value"?Object.values(lr.options).some(Kr=>Kr.color!=null):lr.options.result.color!=null))&&(Cs=(Fn.fields.find(la=>la.type===Ht.PU.number).config.custom.fillOpacity??100)/100,Ls=(la,lr)=>{let Kr=Fn.fields[la];return Kr.display(Kr.values[lr]).color});const Gs={xOri:ys.xOri,xDir:ys.xDir,groupWidth:Vt,barWidth:Xt,barRadius:nn,stacking:on,rawValue:is,getColor:Ls,fillOpacity:Cs,formatValue:zs,formatShortValue:sa,timeZone:ct,text:Rn,showValue:Bt,legend:gs,xSpacing:rs,xTimeAuto:Fn.fields[0]?.type===Ht.PU.time&&!Fn.fields[0].config.unit?.startsWith("time:"),negY:Fn.fields.map(Ua=>Ua.config.custom?.transform===ut.NU.NegativeY),fullHighlight:os,hoverMulti:rn.mode===ut.$N.Multi},xa=xi(Gs,gt);if(Gn.setCursor(xa.cursor),Gn.addHook("init",xa.init),Gn.addHook("drawClear",xa.drawClear),Gn.addHook("draw",xa.draw),Nn!==0){let Ua=50,ra=ys.xOri===ut.Lt.Horizontal?14:5;Gn.setPadding(cn(Fn,Nn,ms,Ua,ra))}Gn.setPrepData(xa.prepData),Gn.addScale({scaleKey:"x",isTime:!1,range:xa.xRange,distribution:ut.L4.Ordinal,orientation:ys.xOri,direction:ys.xDir});const ka=Fn.fields[0]?.config.custom?.axisPlacement!==ut.vM.Hidden?ys.xOri===ut.Lt.Horizontal?ut.vM.Bottom:ut.vM.Left:ut.vM.Hidden,Ja=Fn.fields[0]?.config.custom?.axisPlacement!==ut.vM.Hidden;Gn.addAxis({scaleKey:"x",isTime:!1,placement:ka,label:Fn.fields[0]?.config.custom?.axisLabel,splits:xa.xSplits,filter:ys.xOri===0?xa.hFilter:void 0,values:xa.xValues,timeZone:ct,grid:{show:!1},ticks:{show:!1},gap:15,tickLabelRotation:ys.xOri===0?Nn*-1:0,theme:gt,show:Ja});for(let Ua=1;Ua<Fn.fields.length;Ua++){const ra=Fn.fields[Ua],la={...ri,...ra.config.custom},lr=ra.config.unit||eo.s,Kr=(0,Lr.Qi)(ra),va=(0,Lr.lz)(ra,gt).color;let Ga=la.axisSoftMin,cr=la.axisSoftMax;if(Ga==null&&ra.config.min==null&&(Ga=0),cr==null&&ra.config.max==null&&(cr=0),la.thresholdsStyle&&ra.config.thresholds&&(la.thresholdsStyle.mode??ut.Ly.Off)!==ut.Ly.Off&&Gn.addThresholds({config:la.thresholdsStyle,thresholds:ra.config.thresholds,scaleKey:lr,theme:gt,hardMin:ra.config.min,hardMax:ra.config.max,softMin:la.axisSoftMin,softMax:la.axisSoftMax}),Gn.addSeries({scaleKey:lr,pxAlign:!0,lineWidth:la.lineWidth,lineColor:va,fillOpacity:la.fillOpacity,theme:gt,colorMode:Kr,pathBuilder:xa.barsBuilder,show:!la.hideFrom?.viz,gradientMode:la.gradientMode,thresholds:ra.config.thresholds,hardMin:ra.config.min,hardMax:ra.config.max,softMin:la.axisSoftMin,softMax:la.axisSoftMax}),Gn.addScale({scaleKey:lr,min:ra.config.min,max:ra.config.max,softMin:Ga,softMax:cr,centeredZero:la.axisCenteredZero,orientation:ys.yOri,direction:ys.yDir,distribution:la.scaleDistribution?.type,log:la.scaleDistribution?.log}),la.axisPlacement!==ut.vM.Hidden){let sr=la.axisPlacement;(!sr||sr===ut.vM.Auto)&&(sr=ut.vM.Left),ys.xOri===1&&(sr===ut.vM.Left&&(sr=ut.vM.Bottom),sr===ut.vM.Right&&(sr=ut.vM.Top));let vr={scaleKey:lr,label:la.axisLabel,size:la.axisWidth,placement:sr,formatValue:(kr,dr)=>(0,gr.cN)(ra.display(kr,dr)),filter:ys.yOri===0?xa.hFilter:void 0,tickLabelRotation:ys.xOri===1?Nn*-1:0,theme:gt,grid:{show:la.axisGridShow}};la.axisBorderShow&&(vr.border={show:!0}),la.axisColorMode===ut.Y$.Series&&(vr.color=va),Gn.addAxis(vr)}}let Wr=(0,Za.ro)(Fn);return Gn.setStackingGroups(Wr),{builder:Gn,prepData:(Ua,ra)=>(Z=Ua,Fn=Z[0],Me=ra,Gn.prepData(Z))}};function _t(Z,me){return Z.length>me?Z.substring(0,me).concat("..."):Z}function cn(Z,me,Me,Ne=0,Ze=0){const ct=Z.fields[0].values,gt=bs.pi,Bt=Z.fields[0].display,Vt=rn=>Bt?Bt(ct[rn]):ct[rn];let Xt=0;for(let rn=0;rn<ct.length;rn++){let Nn=(0,Hs.kD)(_t((0,gr.cN)(Vt(rn)),Me),gt);Xt=Nn.width>Xt?Nn.width:Xt}const nn=me>0?Math.cos(me*Math.PI/180)*(0,Hs.kD)(_t((0,gr.cN)(Vt(ct.length-1)),Me),gt).width:0,on=me<0?Math.cos(me*-1*Math.PI/180)*(0,Hs.kD)(_t((0,gr.cN)(Vt(0)),Me),gt).width:0,Rn=Math.sin((me>=0?me:me*-1)*Math.PI/180)*Xt-Ze;return[Math.round(bs.pi*Fr.A.pxRatio),nn,Rn,Math.max(0,on-Ne)]}function kn(Z){return Z===ut.wV.Vertical?{xOri:ut.Lt.Horizontal,xDir:ut.ON.Right,yOri:ut.Lt.Vertical,yDir:ut.ON.Up}:{xOri:ut.Lt.Vertical,xDir:ut.ON.Down,yOri:ut.Lt.Horizontal,yDir:ut.ON.Right}}const Kn=(0,Hs.kD)("M",bs.pi).width,ns=Math.PI/180,Rs=Z=>{const{data:me,options:Me,fieldConfig:Ne,width:Ze,height:ct,timeZone:gt,id:Bt}=Z,Vt=(0,Q.$j)(),{barWidth:Xt,barRadius:nn=0,showValue:on,groupWidth:Rn,stacking:rn,legend:Nn,tooltip:ms,text:rs,xTickLabelRotation:gs,xTickLabelSpacing:os,fullHighlight:Fn,xField:Gn,colorByField:ba}=Me;let{orientation:zs,xTickLabelMaxLength:sa=0}=Me;zs=zs===Ft.wV.Auto?Ze<ct?Ft.wV.Horizontal:Ft.wV.Vertical:zs,sa=gs===0?1/0:sa||Math.floor(ct/2/Math.sin(Math.abs(gs*ns))/Kn-3);const ys=(0,K.useMemo)(()=>Ei(me.series,Ne,rn,Vt,Gn,ba),[me.series,Ne,rn,Vt,Gn,ba]),is=(0,K.useMemo)(()=>ys.series.map(Ua=>({...Ua,fields:Ua.fields.filter((ra,la)=>la===0||!ra.state?.hideFrom?.viz)})),[ys.series]),Ls=is[0]?.length??0,Cs=is[0]?.fields.length??0,Gs=Math.max(0,(ys.series[0]?.fields.length??0)-1);let{builder:xa,prepData:ka}=(0,K.useMemo)(()=>Ls===0?{builder:null,prepData:null}:Zo({series:is,totalSeries:Gs,color:ys.color,orientation:zs,options:Me,timeZone:gt,theme:Vt}),[zs,gt,Z.data.structureRev,Gs,Cs,Ls,Xt,nn,on,Rn,rn,Nn,ms,rs?.valueSize,gs,os,Fn,Gn,ba,sa]);const Ja=(0,K.useMemo)(()=>ka==null?[]:ka(is,ys.color),[ka,is,ys.color]);if(ys.warn!=null||xa==null)return(0,T.jsx)(Ks.a,{panelId:Bt,fieldConfig:Ne,data:me,message:ys.warn??"",needsNumberField:!0});const Wr=Nn.showLegend&&Ar(xa,ys.series)?(0,T.jsx)(ho,{data:ys.series,colorField:ys.color,...Nn}):null;return(0,T.jsx)(Ys.KU,{width:Z.width,height:Z.height,legend:Wr,children:(Ua,ra)=>(0,T.jsx)(La.Z,{config:xa,data:Ja,width:Ua,height:ra,children:Z.options.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:xa,maxWidth:Me.tooltip.maxWidth,hoverMode:Me.tooltip.mode===ut.$N.Single?Xs.b3.xOne:Xs.b3.xAll,render:(la,lr,Kr,Ca,va,Ga)=>(0,T.jsx)(Ta.k,{series:is[0],_rest:ys._rest,dataIdxs:lr,seriesIdx:Kr,mode:Me.tooltip.mode,sortOrder:Me.tooltip.sort,isPinned:Ca,maxHeight:Me.tooltip.maxHeight})})})})};var Os=e(66864),ha=e(94354),na=e(10880);const wa=[{label:"None",value:0,description:"Show all tick marks"},{label:"Small",value:100,description:"Require 100px spacing"},{label:"Medium",value:200,description:"Require 200px spacing"},{label:"Large",value:300,description:"Require 300px spacing"}],pr=Z=>{let me=Z.value??0;const Me=me<0;Me&&(me*=-1);let Ne=wa[0];for(const gt of wa)if(Ne=gt,me<=Ne.value)break;const Ze=gt=>{Z.onChange(gt*(Me?-1:1))},ct=()=>{Z.onChange(Z.value*-1)};return(0,T.jsxs)(Os.Gy,{children:[(0,T.jsx)(ha.z,{value:Ne.value,options:wa,onChange:Ze}),me!==0&&(0,T.jsx)(Qe.m,{content:"Require space from the right side",placement:"top",children:(0,T.jsx)("div",{children:(0,T.jsx)(na.S,{value:Me,onChange:ct,label:"RTL"})})})]})},Ma=(Z,me,Me,Ne)=>{if(me==="graph"){const Ze=Me.angular;if(Ze.xaxis?.mode==="series"){const ct=Z.transformations||[];ct.push({id:"reduce",options:{reducers:Ze.xaxis?.values??["sum"]}}),Z.transformations=ct}}return{}};var ks=e(38824);class oo{getListWithDefaults(me){return me.getListAppender({name:ks.m.BarChart,pluginId:"barchart",options:{showValue:ut.yL.Never,legend:{calcs:[],displayMode:ut.lm.List,showLegend:!0,placement:"right"}},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:Me=>{Me.options.barWidth=.8}}})}getSuggestionsForData(me){const Me=this.getListWithDefaults(me),{dataSummary:Ne}=me;Ne.frameCount===1&&(!Ne.hasNumberField||!Ne.hasStringField||Ne.rowCountTotal>50||(Me.append({name:ks.m.BarChart}),Ne.numberFieldCount>1&&(Me.append({name:ks.m.BarChartStacked,options:{stacking:ut.gs.Normal}}),Me.append({name:ks.m.BarChartStackedPercent,options:{stacking:ut.gs.Percent}})),Me.append({name:ks.m.BarChartHorizontal,options:{orientation:Ft.wV.Horizontal}}),Ne.numberFieldCount>1&&(Me.append({name:ks.m.BarChartHorizontalStacked,options:{stacking:ut.gs.Normal,orientation:Ft.wV.Horizontal}}),Me.append({name:ks.m.BarChartHorizontalStackedPercent,options:{orientation:Ft.wV.Horizontal,stacking:ut.gs.Percent}}))))}}const go=new S.m(Rs).setPanelChangeHandler(Ma).useFieldConfig({standardOptions:{[cs.uo.Color]:{settings:{byValueSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:Zn.Y.PaletteClassic}}},useCustomConfig:Z=>{const me=ri;Z.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:me.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:me.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:pn.t.fillGradient[0].value,settings:{options:pn.t.fillGradient}}),Z.addSelect({category:["Graph styles"],name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:ut.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:ut.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),Z.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:ut.Ly.Off},settings:{options:pn.t.thresholdsDisplayModes},editor:ea.D,override:ea.D,process:wt.hS,shouldApply:()=>!0}),Jn.r(Z,me,!1),Qn.e(Z)}}).setPanelOptions(Z=>{Z.addFieldNamePicker({path:"xField",name:"X Axis",settings:{placeholderText:"First string or time field"}}).addRadio({path:"orientation",name:"Orientation",settings:{options:[{value:Ft.wV.Auto,label:"Auto"},{value:Ft.wV.Horizontal,label:"Horizontal"},{value:Ft.wV.Vertical,label:"Vertical"}]},defaultValue:Po.orientation}).addSliderInput({path:"xTickLabelRotation",name:"Rotate x-axis tick labels",defaultValue:Po.xTickLabelRotation,settings:{min:-90,max:90,step:15,marks:{"-90":"-90\xB0","-45":"-45\xB0",0:"0\xB0",45:"45\xB0",90:"90\xB0"},included:!1}}).addNumberInput({path:"xTickLabelMaxLength",name:"X-axis tick label max length",description:"X-axis labels will be truncated to the length provided",settings:{placeholder:"None",min:0},showIf:me=>me.xTickLabelRotation!==0}).addCustomEditor({id:"xTickLabelSpacing",path:"xTickLabelSpacing",name:"X-axis labels minimum spacing",defaultValue:Po.xTickLabelSpacing,editor:pr}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:ut.yL.Auto,label:"Auto"},{value:ut.yL.Always,label:"Always"},{value:ut.yL.Never,label:"Never"}]},defaultValue:Po.showValue}).addRadio({path:"stacking",name:"Stacking",settings:{options:pn.t.stacking},defaultValue:Po.stacking}).addSliderInput({path:"groupWidth",name:"Group width",defaultValue:Po.groupWidth,settings:{min:0,max:1,step:.01},showIf:(me,Me)=>me.stacking&&me.stacking!==ut.gs.None?!1:qr(Me)!==1}).addSliderInput({path:"barWidth",name:"Bar width",defaultValue:Po.barWidth,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"barRadius",name:"Bar radius",defaultValue:Po.barRadius,settings:{min:0,max:.5,step:.05}}).addBooleanSwitch({path:"fullHighlight",name:"Highlight full area on hover",defaultValue:Po.fullHighlight,showIf:me=>me.stacking===ut.gs.None}),Z.addFieldNamePicker({path:"colorByField",name:"Color by field",description:"Use the color value for a sibling field to color each bar value."}),fs.D(Z),ls.H(Z),vs.I(Z,!1)}).setSuggestionsSupplier(new oo);function qr(Z){let me=0;if(Z)for(const Me of Z)for(const Ne of Me.fields)Ne.type===Ht.PU.number&&me++;return me}var po=e(63250),yo=e(23799);const hi=Z=>(0,po._$)(Z);var Di=e(58384),Rr=e(17516);class tr{getSuggestionsForData(me){const{dataSummary:Me}=me;if(!Me.hasData||!Me.hasNumberField)return;const Ne=me.getListAppender({name:"",pluginId:"bargauge",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}});Me.numberFieldCount>50||(Me.hasStringField&&Me.frameCount===1&&Me.rowCountTotal<30?(Ne.append({name:ks.m.BarGaugeBasic,options:{reduceOptions:{values:!0,calcs:[]},displayMode:ut.eX.Basic,orientation:Ft.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Ne.append({name:ks.m.BarGaugeLCD,options:{reduceOptions:{values:!0,calcs:[]},displayMode:ut.eX.Lcd,orientation:Ft.wV.Horizontal},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})):(Ne.append({name:ks.m.BarGaugeBasic,options:{displayMode:ut.eX.Basic,orientation:Ft.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}}),Ne.append({name:ks.m.BarGaugeLCD,options:{displayMode:ut.eX.Lcd,orientation:Ft.wV.Horizontal,reduceOptions:{values:!1,calcs:["lastNotNull"]}},fieldConfig:{defaults:{color:{mode:"continuous-GrYlRd"}},overrides:[]}})))}}const Vr=new S.m(Di.d).useFieldConfig().setPanelOptions(Z=>{(0,yo.L)(Z),(0,yo.h)(Z),vs.I(Z),Z.addRadio({path:"displayMode",name:"Display mode",settings:{options:[{value:ut.eX.Gradient,label:"Gradient"},{value:ut.eX.Lcd,label:"Retro LCD"},{value:ut.eX.Basic,label:"Basic"}]},defaultValue:Rr.K.displayMode}).addRadio({path:"valueMode",name:"Value display",settings:{options:[{value:ut.$l.Color,label:"Value color"},{value:ut.$l.Text,label:"Text color"},{value:ut.$l.Hidden,label:"Hidden"}]},defaultValue:Rr.K.valueMode}).addRadio({path:"namePlacement",name:"Name placement",settings:{options:[{value:ut.TZ.Auto,label:"Auto"},{value:ut.TZ.Top,label:"Top"},{value:ut.TZ.Left,label:"Left"}]},defaultValue:Rr.K.namePlacement,showIf:me=>me.orientation!==Ft.wV.Vertical}).addBooleanSwitch({path:"showUnfilled",name:"Show unfilled area",description:"When enabled renders the unfilled region as gray",defaultValue:Rr.K.showUnfilled,showIf:me=>me.displayMode!=="lcd"}).addRadio({path:"sizing",name:"Bar size",settings:{options:[{value:ut.T6.Auto,label:"Auto"},{value:ut.T6.Manual,label:"Manual"}]},defaultValue:Rr.K.sizing}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:Rr.K.minVizWidth,settings:{min:0,max:300,step:1},showIf:me=>me.sizing===ut.T6.Manual&&(me.orientation===Ft.wV.Auto||me.orientation===Ft.wV.Vertical)}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:Rr.K.minVizHeight,settings:{min:0,max:300,step:1},showIf:me=>me.sizing===ut.T6.Manual&&(me.orientation===Ft.wV.Auto||me.orientation===Ft.wV.Horizontal)}).addSliderInput({path:"maxVizHeight",name:"Max height",description:"Maximum row height (horizontal orientation)",defaultValue:Rr.K.maxVizHeight,settings:{min:0,max:300,step:1},showIf:me=>me.sizing===ut.T6.Manual&&(me.orientation===Ft.wV.Auto||me.orientation===Ft.wV.Horizontal)})}).setPanelChangeHandler(po.gl).setMigrationHandler(hi).setSuggestionsSupplier(new tr);var io=e(41706),ja=e(79041),Xo=e(23117),Ti=e(68268),Rt=e(24182),tn=e(30249),Mn=e(74863),zn=e(55129);const Es=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),Ts=Array(53);for(let Z=0;Z<Ts.length;Z++)Ts[Z]=2**Z;const qa=(Z,me=1)=>Z==null?"-":Z.toFixed(me),aa={drawStyle:ut.GR.Line,showPoints:ut.yL.Auto,axisPlacement:ut.vM.Auto},ar=({frame:Z,theme:me,timeZones:Me,getTimeRange:Ne,allFrames:Ze,renderers:ct,tweakScale:gt=nn=>nn,tweakAxis:Bt=nn=>nn,hoverProximity:Vt,orientation:Xt=ut.wV.Horizontal})=>{const nn=Xt!==ut.wV.Vertical,on=new Qo.e(Me[0]);let Rn;on.setPrepData(ys=>(Rn=ys[0],(0,Za.bq)(ys[0],on.getStackingGroups())));const rn=Z.fields[0];if(!rn)return on;const Nn="x";let ms="";const rs=rn.config.custom?.axisPlacement===ut.vM.Hidden?ut.vM.Hidden:nn?ut.vM.Bottom:ut.vM.Left,gs=rn.config.custom?.axisPlacement!==ut.vM.Hidden;if(rn.type===Ht.PU.time){on.addScale({scaleKey:Nn,orientation:nn?ut.Lt.Horizontal:ut.Lt.Vertical,direction:nn?ut.ON.Right:ut.ON.Up,isTime:!0,range:()=>{const is=Ne();return[is.from.valueOf(),is.to.valueOf()]}});const ys=Me.length>1?(is,Ls)=>nn?Ls.map((Cs,Gs)=>Gs<2?null:Cs):Ls:void 0;for(let is=0;is<Me.length;is++){const Ls=Me[is];on.addAxis({scaleKey:Nn,isTime:!0,placement:rs,show:gs,label:rn.config.custom?.axisLabel,timeZone:Ls,theme:me,grid:{show:is===0&&rn.config.custom?.axisGridShow},filter:ys})}Me.length>1&&on.addHook("drawAxes",is=>{is.ctx.save();let Ls=0;is.axes.forEach(Cs=>{if(nn&&Cs.side===2){is.ctx.fillStyle=me.colors.text.primary,is.ctx.textAlign="left",is.ctx.textBaseline="bottom";let Gs=Cs._pos+Cs._size;is.ctx.fillText(Me[Ls],is.bbox.left,Gs*Fr.A.pxRatio),Ls++}}),is.ctx.restore()})}else on.addScale({scaleKey:Nn,orientation:nn?ut.Lt.Horizontal:ut.Lt.Vertical,direction:nn?ut.ON.Right:ut.ON.Up,range:(ys,is,Ls)=>[rn.config.min??is,rn.config.max??Ls]}),on.addAxis({scaleKey:Nn,placement:rs,show:gs,label:rn.config.custom?.axisLabel,theme:me,grid:{show:rn.config.custom?.axisGridShow},formatValue:(ys,is)=>(0,gr.cN)(rn.display(ys,is))});let os=ct?.flatMap(ys=>Object.values(ys.fieldMap).filter(is=>ys.indicesOnly.indexOf(is)===-1))??[],Fn;for(let ys=1;ys<Z.fields.length;ys++){const is=Z.fields[ys],Ls={...is.config,custom:{...aa,...is.config.custom}},Cs=Ls.custom;if(is===rn||is.type!==Ht.PU.number&&is.type!==Ht.PU.enum)continue;let Gs=is.display??qa;is.config.custom?.stacking?.mode===ut.gs.Percent&&(Gs=(0,_o.J)({field:{...is,config:{...is.config,unit:"percentunit"}},theme:me}));const xa=(0,zn.M)(Ls,is.type),ka=(0,Lr.Qi)(is),Wr=(0,Lr.lz)(is,me).color;if(on.addScale(gt({scaleKey:xa,orientation:nn?ut.Lt.Vertical:ut.Lt.Horizontal,direction:nn?ut.ON.Up:ut.ON.Right,distribution:Cs.scaleDistribution?.type,log:Cs.scaleDistribution?.log,linearThreshold:Cs.scaleDistribution?.linearThreshold,min:is.config.min,max:is.config.max,softMin:Cs.axisSoftMin,softMax:Cs.axisSoftMax,centeredZero:Cs.axisCenteredZero,range:Cs.stacking?.mode===ut.gs.Percent?(va,Ga,cr)=>(Ga=Ga<0?-1:0,cr=cr>0?1:0,[Ga,cr]):is.type===Ht.PU.enum?(va,Ga,cr)=>[-1,is.config.type.enum.text.length]:void 0,decimals:is.config.decimals},is)),ms||(ms=xa),Cs.axisPlacement!==ut.vM.Hidden){let va;Cs.axisColorMode===ut.Y$.Series&&(ka.isByValue&&is.config.custom?.gradientMode===ut.on.Scheme&&ka.id===Zn.Y.Thresholds?va=(0,Mn.pl)(1,me,ka,is.config.thresholds):va=Wr);const Ga={border:{show:Cs.axisBorderShow||!1,width:1/devicePixelRatio,stroke:va||me.colors.text.primary},ticks:{show:Cs.axisBorderShow||!1,stroke:va||me.colors.text.primary},color:va||me.colors.text.primary};let cr,sr,vr;if(Es.has(Ls.unit))cr=Ts;else if(is.type===Ht.PU.enum){let kr=is.config.type.enum.text;vr=kr.map((dr,Gr)=>Gr),sr=kr}on.addAxis(Bt({scaleKey:xa,label:Cs.axisLabel,size:Cs.axisWidth,placement:nn?Cs.axisPlacement??ut.vM.Auto:ut.vM.Bottom,formatValue:(kr,dr)=>(0,gr.cN)(Gs(kr,dr)),theme:me,grid:{show:Cs.axisGridShow},decimals:is.config.decimals,distr:Cs.scaleDistribution?.type,splits:vr,values:sr,incrs:cr,...Ga},is))}const Ua=Cs.drawStyle===ut.GR.Points?ut.yL.Always:Cs.showPoints;let ra=()=>null;Cs.spanNulls!==!0&&(ra=(va,Ga,cr,sr)=>{let vr=[],kr=va.series[Ga];if(!cr&&sr&&sr.length){const[dr,Gr]=kr.idxs,Xr=va.data[0],So=va.data[Ga],Qs=Math.round(va.valToPos(Xr[dr],"x",!0)),hs=Math.round(va.valToPos(Xr[Gr],"x",!0));sr[0][0]===Qs&&vr.push(dr);for(let Ms=0;Ms<sr.length;Ms++){let Na=sr[Ms],Oa=sr[Ms+1];if(Oa&&Na[1]===Oa[0]){let Qa=va.posToIdx(Na[1],!0);if(So[Qa]==null)for(let xr=1;xr<100;xr++){if(So[Qa+xr]!=null){Qa+=xr;break}if(So[Qa-xr]!=null){Qa-=xr;break}}vr.push(Qa)}}sr[sr.length-1][1]===hs&&vr.push(Gr)}return vr.length?vr:null});let{fillOpacity:la}=Cs,lr=null,Kr=null;if(is.state?.origin){Fn||(Fn=Aa(Z,Ze));const va=Ze[is.state.origin.frameIndex],Ga=va?.fields[is.state.origin.fieldIndex],cr=(0,rr.Ct)(Ga??is,va,Ze);if(os.indexOf(cr)>=0)lr=()=>null,Kr=()=>{};else if(Cs.transform===ut.NU.Constant){const sr=Fr.A.paths.linear();lr=(vr,kr)=>{const dr=vr._data,Gr=Ne();let Xr=[Gr.from.valueOf(),Gr.to.valueOf()],So=dr[kr].find(Ms=>Ms!=null),Qs=[So,So],hs=dr.slice();return hs[0]=Xr,hs[kr]=Qs,sr({...vr,_data:hs},kr,0,1)}}if(Cs.fillBelowTo){const sr=Z.fields.find(Gr=>Cs.fillBelowTo===Gr.name||Cs.fillBelowTo===Gr.config?.displayNameFromDS||Cs.fillBelowTo===(0,rr.Ct)(Gr,Z,Ze)),vr=sr?(0,rr.Ct)(sr,Z,Ze):Cs.fillBelowTo,kr=Fn.get(cr),dr=Fn.get(vr);(0,w.isNumber)(dr)&&(0,w.isNumber)(kr)?(on.addBand({series:[kr,dr],fill:void 0}),la||(la=35)):la=0}}let Ca;ka.id===Zn.Y.Thresholds&&(Ca=va=>(0,Lr.lz)(Rn.fields[va],me).color),on.addSeries({pathBuilder:lr,pointsBuilder:Kr,scaleKey:xa,showPoints:Ua,pointsFilter:ra,colorMode:ka,fillOpacity:la,theme:me,dynamicSeriesColor:Ca,drawStyle:Cs.drawStyle,lineColor:Cs.lineColor??Wr,lineWidth:Cs.lineWidth,lineInterpolation:Cs.lineInterpolation,lineStyle:Cs.lineStyle,barAlignment:Cs.barAlignment,barWidthFactor:Cs.barWidthFactor,barMaxWidth:Cs.barMaxWidth,pointSize:Cs.pointSize,spanNulls:Cs.spanNulls||!1,show:!Cs.hideFrom?.viz,gradientMode:Cs.gradientMode,thresholds:Ls.thresholds,hardMin:is.config.min,hardMax:is.config.max,softMin:Cs.axisSoftMin,softMax:Cs.axisSoftMax,dataFrameFieldIndex:is.state?.origin}),Cs.thresholdsStyle&&Ls.thresholds&&(Cs.thresholdsStyle.mode??ut.Ly.Off)!==ut.Ly.Off&&on.addThresholds({config:Cs.thresholdsStyle,thresholds:Ls.thresholds,scaleKey:xa,theme:me,hardMin:is.config.min,hardMax:is.config.max,softMin:Cs.axisSoftMin,softMax:Cs.axisSoftMax})}let Gn=(0,Za.ro)(Z);on.setStackingGroups(Gn),ct?.forEach(ys=>{Fn||(Fn=Aa(Z,Ze));let is={};for(let Ls in ys.fieldMap){let Cs=ys.fieldMap[Ls];is[Ls]=Fn.get(Cs)}ys.init(on,is)});const ba=15;let sa={hover:{prox:(ys,is,Ls)=>Vt??(ys.data[is][Ls]===null?ba:null),skip:[null]},focus:{prox:Vt??30}};return on.setCursor(sa),on};function Aa(Z,me){const Me=new Map;return Z.fields.forEach((Ne,Ze)=>{const ct=Ne.state?.origin;if(ct){const gt=me[ct.frameIndex]?.fields[ct.fieldIndex];gt&&Me.set((0,rr.Ct)(gt,me[ct.frameIndex],me),Ze)}}),Me}const yr=["legend","options","theme"];class Dr extends K.Component{constructor(){super(...arguments),this.prepConfig=(me,Me,Ne)=>{const{theme:Ze,timeZone:ct,options:gt,renderers:Bt,tweakAxis:Vt,tweakScale:Xt}=this.props;return ar({frame:me,theme:Ze,timeZones:Array.isArray(ct)?ct:[ct],getTimeRange:Ne,allFrames:Me,renderers:Bt,tweakScale:Xt,tweakAxis:Vt,hoverProximity:gt?.tooltip?.hoverProximity,orientation:gt?.orientation})},this.renderLegend=me=>{const{legend:Me,frames:Ne}=this.props;return!me||Me&&!Me.showLegend||!(0,Rt.t)(me,Ne)?null:(0,T.jsx)(Rt.$,{data:Ne,config:me,...Me})}}render(){return(0,T.jsx)(tn.o,{...this.props,prepConfig:this.prepConfig,propsToDiff:yr,renderLegend:this.renderLegend})}}const ao=(0,Q.cV)(Dr);ao.displayName="TimeSeries";var Qr=e(62567),Uo=e(78226),Co=e(34743),lo=e(36376),xo=e(7315),Yr=e(13544),zr=e(17464),qo=e(74007),Mi=e(25469);function _i(Z){const me={position:"relative",top:"auto",right:"auto",marginRight:0};return(0,T.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",paddingBottom:"6px"},children:(0,T.jsx)(Mi.J,{onClick:Z.onClick,style:Z.style??me})})}const Hi=({timeZone:Z,dataFrame:me,dataFrameFieldIndex:Me,config:Ne,exemplarColor:Ze,clickedExemplarFieldIndex:ct,setClickedExemplarFieldIndex:gt})=>{const Bt=(0,Q.of)(ft),[Vt,Xt]=(0,K.useState)(!1),[nn,on]=(0,K.useState)(!1),Rn=[(0,Co.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,Co.BN)()],{context:rn,refs:Nn,floatingStyles:ms}=(0,lo.we)({open:Vt,placement:"bottom",onOpenChange:Xt,middleware:Rn,whileElementsMounted:xo.ll,strategy:"fixed"}),rs=(0,lo.s9)(rn),gs=(0,lo.Mk)(rn,{handleClose:(0,lo.iB)(),enabled:ct===void 0}),{getReferenceProps:os,getFloatingProps:Fn}=(0,lo.bv)([rs,gs]);(0,K.useEffect)(()=>{ct?.fieldIndex===Me.fieldIndex&&ct?.frameIndex===Me.frameIndex||on(!1)},[ct,Me]);const Gn=()=>{const is=[(0,T.jsx)("rect",{fill:Ze,x:"3.38672",width:"4.78985",height:"4.78985",transform:"rotate(45 3.38672 0)"},"diamond"),(0,T.jsx)("path",{fill:Ze,d:"M1.94444 3.49988L0 5.44432L1.55552 6.99984L3.49996 5.05539L5.4444 6.99983L6.99992 5.44431L5.05548 3.49988L6.99983 1.55552L5.44431 0L3.49996 1.94436L1.5556 0L8.42584e-05 1.55552L1.94444 3.49988Z"},"x"),(0,T.jsx)("path",{fill:Ze,d:"M4 0L7.4641 6H0.535898L4 0Z"},"triangle"),(0,T.jsx)("rect",{fill:Ze,width:"5",height:"5"},"rectangle"),(0,T.jsx)("path",{fill:Ze,d:"M3 0.5L5.85317 2.57295L4.76336 5.92705H1.23664L0.146831 2.57295L3 0.5Z"},"pentagon"),(0,T.jsx)("path",{fill:Ze,d:"m2.35672,4.2425l0,2.357l1.88558,0l0,-2.357l2.3572,0l0,-1.88558l-2.3572,0l0,-2.35692l-1.88558,0l0,2.35692l-2.35672,0l0,1.88558l2.35672,0z"},"plus")];return is[Me.frameIndex%is.length]},ba=()=>{on(!0)},zs=(0,K.useCallback)(()=>{const is=me.fields.filter(Ja=>Ja.config.links?.length&&Ja.config.links?.length>0)||[],Ls=[...is,...me.fields.filter(Ja=>!is.includes(Ja))],Cs=()=>{on(!1),Xt(!1),gt(void 0)};let Gs=[],xa=[];Ls.map((Ja,Wr)=>{const Ua=Ja.values[Me.fieldIndex];Ja.config.links?.length&&xa?.push(...Ja.getLinks?.({valueRowIndex:Me.fieldIndex})||[]);const ra=Ja.display?Ja.display(Ua):{text:`${Ua}`,numeric:+Ua};Gs.push({name:Ja.name,value:Ua,valueString:(0,gr.cN)(ra),highlight:!1})});const ka={position:"relative",top:"35px",right:"5px",marginRight:0};return(0,T.jsxs)("div",{className:Bt.tooltip,ref:Nn.setFloating,style:ms,...Fn(),children:[nn&&(0,T.jsx)(_i,{onClick:Cs,style:ka}),(0,T.jsx)(qo.i,{displayValues:Gs,links:xa})]})},[me.fields,Me,Bt,nn,gt,ms,Fn,Nn.setFloating]),sa=Ne.getSeries().find(is=>is.props.dataFrameFieldIndex?.frameIndex===Me.frameIndex)?.props.lineColor,ys=()=>{gt(Me),ba()};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{ref:Nn.setReference,className:Bt.markerWrapper,"data-testid":Yr.Tp.components.DataSource.Prometheus.exemplarMarker,role:"button",tabIndex:0,...os(),onClick:ys,onKeyDown:is=>{is.key==="Enter"&&ys()},children:(0,T.jsx)("svg",{viewBox:"0 0 7 7",width:"7",height:"7",style:{fill:sa},className:(0,se.cx)(Bt.marble,(Vt||nn)&&Bt.activeMarble),children:Gn()})}),(Vt||nn)&&(0,T.jsx)(zr.ZL,{children:zs()})]})},ft=Z=>{const me=Z.isDark?Z.v1.palette.dark2:Z.v1.palette.white,Me=Z.isDark?Z.v1.palette.dark9:Z.v1.palette.gray5,Ne=Z.isDark?Z.v1.palette.black:Z.v1.palette.white,Ze=Z.isDark?Z.v1.palette.dark3:Z.v1.palette.gray6;return{markerWrapper:(0,se.css)({padding:"0 4px 4px 4px",width:"8px",height:"8px",boxSizing:"content-box",transform:"translate3d(-50%, 0, 0)","&:hover":{"> svg":{transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}}}),marker:(0,se.css)({width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:`4px solid ${Z.v1.palette.red}`,pointerEvents:"none"}),wrapper:(0,se.css)({background:me,border:`1px solid ${Me}`,borderRadius:Z.shape.borderRadius(2),boxShadow:`0 0 20px ${Ne}`,padding:Z.spacing(1)}),exemplarsTable:(0,se.css)({width:"100%","tr td":{padding:"5px 10px",whiteSpace:"nowrap",borderBottom:`4px solid ${Z.components.panel.background}`},tr:{backgroundColor:Z.colors.background.primary,"&:nth-child(even)":{backgroundColor:Ze}}}),valueWrapper:(0,se.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",columnGap:Z.spacing(1),"> span":{flexGrow:0},"> *":{flex:"1 1",alignSelf:"center"}}),tooltip:(0,se.css)({background:"none",padding:0,overflowY:"auto",maxHeight:"95vh"}),header:(0,se.css)({background:Me,padding:"6px 10px",display:"flex"}),title:(0,se.css)({fontWeight:Z.typography.fontWeightMedium,paddingRight:Z.spacing(2),overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),body:(0,se.css)({fontWeight:Z.typography.fontWeightMedium,borderRadius:Z.shape.borderRadius(2),overflow:"hidden"}),marble:(0,se.css)({display:"block",opacity:.5,[Z.transitions.handleMotion("no-preference")]:{transition:"transform 0.15s ease-out"}}),activeMarble:(0,se.css)({transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"})}},hn=({exemplars:Z,timeZone:me,config:Me,visibleSeries:Ne})=>{const Ze=(0,K.useRef)(),[ct,gt]=(0,K.useState)();(0,K.useLayoutEffect)(()=>{Me.addHook("init",Xt=>{Ze.current=Xt})},[Me]);const Bt=(0,K.useCallback)((Xt,nn)=>{const on=Xt.fields.find(gs=>gs.name===Ht.LE),Rn=Xt.fields.find(gs=>gs.name===Ht.Bc);if(!on||!Rn||!Ze.current)return;const rn=Object.keys(Ze.current.scales).find(gs=>!["x","y"].some(os=>os===gs))??eo.s,Nn=Ze.current.scales[rn].min,ms=Ze.current.scales[rn].max;let rs=Rn.values[nn.fieldIndex];return Nn!=null&&rs<Nn&&(rs=Nn),ms!=null&&rs>ms&&(rs=ms),{x:Ze.current.valToPos(on.values[nn.fieldIndex],"x"),y:Ze.current.valToPos(rs,rn)}},[]),Vt=(0,K.useCallback)((Xt,nn)=>{const on=Ne!==void 0?ss(Ne,Xt,nn):!0,Rn=Ne!==void 0?_n(Xt,nn,Ne):void 0;return on?(0,T.jsx)(Hi,{setClickedExemplarFieldIndex:gt,clickedExemplarFieldIndex:ct,timeZone:me,dataFrame:Xt,dataFrameFieldIndex:nn,config:Me,exemplarColor:Rn}):(0,T.jsx)(T.Fragment,{})},[Me,me,Ne,gt,ct]);return(0,T.jsx)(Uo.a,{config:Me,id:"exemplars",events:Z,renderEventMarker:Vt,mapEventToXYCoords:Bt})},dn=(Z,me)=>{const Me=Z.series.filter(Ze=>Ze.props.show),Ne=[];return me?.length&&Me.forEach(Ze=>{const ct=Ze.props?.dataFrameFieldIndex?.frameIndex,gt=Ze.props?.dataFrameFieldIndex?.fieldIndex;if(ct!==void 0&&gt!==void 0){const Bt=me[ct]?.fields[gt];Bt?.labels&&Ne.push({labels:Bt.labels,color:Ze.props?.lineColor??""})}}),{labels:Ne,totalSeriesCount:Z.series.length}},_n=(Z,me,Me)=>{let Ne;return Me.labels.some(Ze=>{const ct=Object.keys(Ze.labels),gt=Z.fields.filter(Bt=>ct.find(Vt=>Vt===Bt.name));return gt.length&&gt.every((Vt,Xt,nn)=>{const on=Vt.values[me.fieldIndex];return Ze.labels[Vt.name]===on})?(Ne=Ze.color,!0):!1}),Ne},ss=(Z,me,Me)=>{let Ne=!1;return Z.labels.length===Z.totalSeriesCount?Ne=!0:Z.labels.some(Ze=>{const ct=Object.keys(Ze.labels);if(Object.keys(Ze.labels).length===0)Ne=!0;else{const gt=me.fields.filter(Bt=>ct.find(Vt=>Vt===Bt.name));gt.length&&(Ne=Z.labels.some(Bt=>Object.keys(Bt.labels).every(Vt=>{const Xt=Bt.labels[Vt];return gt.find(nn=>nn.values[Me.fieldIndex]===Xt)})))}return Ne}),Ne};var Yn=e(7874),Bs=e(55794),Ns=e.n(Bs);const Ps=({step:Z,y:me,dragBounds:Me,mapPositionToValue:Ne,formatValue:Ze,onChange:ct})=>{const gt=(0,Q.$j)();let Bt=me,Vt="none";me<(Me.top??0)&&(Vt="top"),me>(Me.bottom??0)+22&&(Vt="bottom"),Vt==="bottom"&&(Bt=Me.bottom??me),Vt==="top"&&(Bt=Me.top??me);const Xt=typeof ct!="function",nn=(0,Q.of)(za,Z,Vt,Xt),[on,Rn]=(0,K.useState)(Z.value),rn=(0,K.useMemo)(()=>gt.colors.getContrastText(gt.visualization.getColorByName(Z.color)),[Z.color,gt]);return(0,T.jsx)(Ns(),{axis:"y",grid:[1,1],disabled:Xt,onStop:Xt?w.noop:(Nn,ms)=>(ct(Ne(ms.lastY)),!1),onDrag:(Nn,ms)=>Rn(Ne(ms.lastY)),position:{x:0,y:Bt},bounds:Me,children:(0,T.jsx)("div",{className:nn.handle,style:{color:rn},children:(0,T.jsx)("span",{className:nn.handleText,children:Ze(on)})})})};Ps.displayName="ThresholdDragHandle";const za=(Z,me,Me,Ne)=>{const Ze=Z.visualization.getColorByName(me.color),ct=Pa(Me),gt=Me!=="none";return{handle:(0,se.css)`
      display: flex;
      align-items: center;
      position: absolute;
      left: 0;
      width: calc(100% - 9px);
      height: 18px;
      margin-top: -9px;
      border-color: ${Ze};
      cursor: ${Ne?"initial":"grab"};
      border-top-right-radius: ${Z.shape.radius.default};
      border-bottom-right-radius: ${Z.shape.radius.default};
      ${gt&&(0,se.css)`
        margin-top: 0;
        border-radius: ${Z.shape.radius.default};
      `}
      background: ${Ze};
      font-size: ${Z.typography.bodySmall.fontSize};
      &:before {
        ${ct};
      }
    `,handleText:(0,se.css)`
      text-align: center;
      width: 100%;
      display: block;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    `}};function Pa(Z){const me=Z==="none",Me=Ne=>(0,se.css)`
    content: '';
    position: absolute;

    bottom: 0;
    top: 0;
    width: 0;
    height: 0;
    left: 0;

    border-right-style: solid;
    border-right-width: ${Ne}px;
    border-right-color: inherit;
    border-top: ${Ne}px solid transparent;
    border-bottom: ${Ne}px solid transparent;
  `;return me?(0,se.css)`
      ${Me(9)};
      left: -9px;
    `:Z==="top"?(0,se.css)`
      ${Me(5)};
      left: calc(50% - 2.5px);
      top: -7px;
      transform: rotate(90deg);
    `:Z==="bottom"?(0,se.css)`
      ${Me(5)};
      left: calc(50% - 2.5px);
      top: calc(100% - 2.5px);
      transform: rotate(-90deg);
    `:""}const fa=60,_a=({config:Z,fieldConfig:me,onThresholdsChange:Me})=>{const Ne=(0,K.useRef)(),[Ze,ct]=(0,K.useState)(0);(0,K.useLayoutEffect)(()=>{Z.setPadding([0,fa,0,0]),Z.addHook("init",Bt=>{Ne.current=Bt}),Z.addHook("draw",()=>{ct(Bt=>Bt+1)})},[Z]);const gt=(0,K.useMemo)(()=>{const Bt=Ne.current;if(!Bt)return null;const Vt=me.defaults.thresholds;if(!Vt)return null;const Xt=(0,zn.M)(me.defaults,Ht.PU.number),nn=me.defaults.decimals,on=[];for(let Rn=0;Rn<Vt.steps.length;Rn++){const rn=Vt.steps[Rn],Nn=Bt.valToPos(rn.value,Xt);if(Number.isNaN(Nn)||!Number.isFinite(Nn))continue;const ms=Bt.bbox.height/window.devicePixelRatio,gs=typeof Me=="function"?Fn=>{const Gn=[...Vt.steps.slice(0,Rn),...Vt.steps.slice(Rn+1),{...Vt.steps[Rn],value:Fn}].sort((ba,zs)=>ba.value-zs.value);Me({...Vt,steps:Gn})}:void 0,os=(0,T.jsx)(Ps,{step:rn,y:Nn,dragBounds:{top:0,bottom:ms},mapPositionToValue:Fn=>Bt.posToVal(Fn,Xt),formatValue:Fn=>(0,gr.j_)(Xt)(Fn,nn).text,onChange:gs},`${rn.value}-${Rn}`);on.push(os)}return on},[Ze,me,Me]);return Ne.current?(0,T.jsx)("div",{style:{position:"absolute",overflow:"visible",left:`${(Ne.current.bbox.left+Ne.current.bbox.width)/window.devicePixelRatio}px`,top:`${Ne.current.bbox.top/window.devicePixelRatio}px`,width:`${fa}px`,height:`${Ne.current.bbox.height/window.devicePixelRatio}px`},children:gt}):null};_a.displayName="ThresholdControlsPlugin";var da=e(63577),ta=(Z=>(Z.Candles="candles",Z.CandlesVolume="candles+volume",Z.Volume="volume",Z))(ta||{}),Ba=(Z=>(Z.Candles="candles",Z.OHLCBars="ohlcbars",Z))(Ba||{}),Ea=(Z=>(Z.CloseClose="close-close",Z.OpenClose="open-close",Z))(Ea||{});const or={down:"red",flat:"gray",up:"green"},Mo={...{candleStyle:"candles",colorStrategy:"open-close",colors:{down:"red",up:"green",flat:"gray"},fields:{},includeAllFields:!1,mode:"candles+volume"},legend:{displayMode:ut.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:ut.$N.Multi,sort:ut.xB.None}},No={open:{key:"open",name:"Open",defaults:["open","o"],description:"Value at the start of the period"},high:{key:"high",name:"High",defaults:["high","h","max"],description:"Maximum value within the period"},low:{key:"low",name:"Low",defaults:["low","l","min"],description:"Minimum value within the period"},close:{key:"close",name:"Close",defaults:["close","c"],description:"Value at the end of the period"},volume:{key:"volume",name:"Volume",defaults:["volume","v"],description:"Sample count within the period"}};function ro(Z,me,Me){const Ne=(0,da.findField)(Z,Me[me.key]);if(!Ne)for(const Ze of Z.fields){const ct=(0,rr.Ct)(Ze,Z).toLowerCase();if(me.defaults.includes(ct)||me.defaults.includes(Ze.name))return Ze}return Ne}function ki(Z,me,Me,Ne){if(!Z?.length)return null;const Ze=me.fields??{},ct=Z.length===1?(0,fo.Yj)(Z[0],Z[0].fields.findIndex(rn=>rn.type===Ht.PU.time)):(0,fo.Fd)({frames:Z});if(!ct?.length)return null;const gt={aligned:ct,frame:ct,names:{}},Bt=(0,Do.B_)([ct],Me,Ne);if(!Bt)return null;const Vt=gt.frame=Bt[0],Xt=Vt.fields.findIndex(rn=>rn.type===Ht.PU.time);if(Xt<0)return null;const nn=new Set;for(const rn of Object.values(No)){const Nn=ro(Vt,rn,Ze);Nn&&(gt[rn.key]=Nn,nn.add(Nn))}if(!gt.open&&!gt.close&&(gt.open=Vt.fields.find(rn=>rn.type===Ht.PU.number),gt.open&&nn.add(gt.open)),gt.open&&!gt.close&&!Ze.close){const rn=gt.open.values.slice(1);rn.push(rn[rn.length-1]),gt.close={...gt.open,values:rn,name:"Next open",state:void 0},nn.add(gt.close),Vt.fields.push(gt.close),gt.autoOpenClose=!0}if(gt.close&&!gt.open&&!Ze.open){const rn=gt.close.values.slice();rn.unshift(rn[0]),rn.length=Vt.length,gt.open={...gt.close,values:rn,name:"Previous close",state:void 0},nn.add(gt.open),Vt.fields.push(gt.open),gt.autoOpenClose=!0}!gt.high&&!Ze.high&&(gt.high=gt.open),!gt.low&&!Ze.low&&(gt.low=gt.open),me.mode===ta.Volume?(gt.high&&(gt.high!==gt.open&&nn.delete(gt.high),gt.high=void 0),gt.low&&(gt.low!==gt.open&&nn.delete(gt.low),gt.low=void 0)):me.mode===ta.Candles&&gt.volume&&(nn.delete(gt.volume),gt.volume=void 0);for(const rn of Object.values(No)){const Nn=gt[rn.key];Nn&&(gt.names[rn.key]=(0,rr.Ct)(Nn,gt.frame))}const on=Vt.fields[Xt],Rn=[on];me.includeAllFields?Rn.push(...Vt.fields.filter(rn=>rn!==on)):Rn.push(...nn),gt.frame={...gt.frame,fields:Rn};for(let rn=0;rn<gt.frame.fields.length;rn++){const Nn=gt.frame.fields[rn];Nn.state={...Nn.state,seriesIndex:rn-1,origin:{fieldIndex:rn,frameIndex:0}}}return gt}const{alpha:Hl}=Oo.MV;function Gi(Z){let{mode:me,candleStyle:Me,fields:Ne,colorStrategy:Ze,upColor:ct,downColor:gt,flatColor:Bt,volumeAlpha:Vt,flatAsUp:Xt=!0}=Z;const nn=me!==ta.Volume&&Ne.high!=null&&Ne.low!=null,on=nn&&Me===Ba.Candles,Rn=me!==ta.Candles&&Ne.volume!=null;function rn(Gn,ba,zs,sa,ys){return Gn>0?zs:Gn<0?sa:ys?zs:ba}let Nn=0,ms=Ne.open,rs=Ne.high,gs=Ne.low,os=Ne.close,Fn=Ne.volume;return Gn=>{let ba,zs,sa,ys,is,Ls;nn&&(sa=new Path2D,zs=new Path2D,ba=new Path2D),Rn&&(ys=new Path2D,is=new Path2D,Ls=new Path2D);let Cs=new Path2D,Gs=Gn.ctx,xa=Gn.data[Nn],ka=Gn.data[ms],Ja=Gn.data[os],Wr=nn?Gn.data[rs]:null,Ua=nn?Gn.data[gs]:null,ra=Rn?Gn.data[Fn]:null,la=Fn!=null?Math.round(Gn.valToPos(0,Gn.series[Fn].scale,!0)):null,[lr,Kr]=Gn.series[0].idxs,Ca=Gn.data[0],va=ka,Ga=Gn.bbox.width;if(Ca.length>1){let dr=null;for(let Gr=0,Xr=1/0;Gr<Ca.length;Gr++)if(va[Gr]!==void 0){if(dr!=null){let So=Math.abs(Ca[Gr]-Ca[dr]);So<Xr&&(Xr=So,Ga=Math.abs(Gn.valToPos(Ca[Gr],"x",!0)-Gn.valToPos(Ca[dr],"x",!0)))}dr=Gr}}let cr=Math.round(.6*Ga),sr=2,vr=2;cr<=12&&(sr=vr=1);let kr=Math.floor(cr/2);for(let dr=lr;dr<=Kr;dr++){let Gr=Math.round(Gn.valToPos(xa[dr],"x",!0)),Xr=dr===lr?0:Math.sign(Ja[dr]-Ja[dr-1]),So=Math.sign(Ja[dr]-ka[dr]);if(Rn&&Ls&&is&&ys){let Qs=rn(Ze===Ea.CloseClose?Xr:So,Ls,is,ys,dr===lr&&Ea.CloseClose?!1:Xt),hs=Math.round(Gn.valToPos(ra[dr],Gn.series[Fn].scale,!0));Qs.rect(Gr-kr,hs,cr,la-hs)}if(nn&&sa&&zs&&ba){let Qs=rn(Ze===Ea.CloseClose?Xr:So,sa,zs,ba,dr===lr&&Ea.CloseClose?!1:Xt),hs=Math.round(Gn.valToPos(Wr[dr],Gn.series[rs].scale,!0)),Ms=Math.round(Gn.valToPos(Ua[dr],Gn.series[gs].scale,!0));Qs.rect(Gr-Math.floor(sr/2),hs,sr,Ms-hs);let Na=Math.round(Gn.valToPos(ka[dr],Gn.series[ms].scale,!0)),Oa=Math.round(Gn.valToPos(Ja[dr],Gn.series[os].scale,!0));if(on){let Qa=Math.min(Na,Oa),xr=Math.max(Na,Oa),Io=Math.max(1,xr-Qa);Qs.rect(Gr-kr,Qa,cr,Io),Ze===Ea.CloseClose&&So>=0&&Io>vr*2&&Cs.rect(Gr-kr+vr,Qa+vr,cr-vr*2,Io-vr*2)}else Qs.rect(Gr-kr,Na,kr,sr),Qs.rect(Gr,Oa,kr,sr)}}Gs.save(),Gs.rect(Gn.bbox.left,Gn.bbox.top,Gn.bbox.width,Gn.bbox.height),Gs.clip(),Rn&&Ls&&is&&ys&&(Gs.fillStyle=Hl(ct,Vt),Gs.fill(is),Gs.fillStyle=Hl(gt,Vt),Gs.fill(ys),Gs.fillStyle=Hl(Bt,Vt),Gs.fill(Ls)),nn&&sa&&zs&&ba&&(Gs.fillStyle=ct,Gs.fill(zs),Gs.fillStyle=gt,Gs.fill(ba),Gs.fillStyle=Bt,Gs.fill(sa),Gs.globalCompositeOperation="destination-out",Gs.fill(Cs)),Gs.restore()}}const bi=({data:Z,id:me,timeRange:Me,timeZone:Ne,width:Ze,height:ct,options:gt,fieldConfig:Bt,onChangeTimeRange:Vt,replaceVariables:Xt})=>{const{sync:nn,eventsScope:on,canAddAnnotations:Rn,onThresholdsChange:rn,canEditThresholds:Nn,showThresholds:ms,dataLinkPostProcessor:rs,eventBus:gs}=(0,ja.d2)(),os=(0,Q.$j)(),Fn=(0,K.useMemo)(()=>ki(Z.series,gt,os,Me),[Z.series,gt,os,Me]),[Gn,ba]=(0,K.useState)(null),zs=nn?.()??ci.yV.Off,{renderers:sa,tweakScale:ys,tweakAxis:is,shouldRenderPrice:Ls}=(0,K.useMemo)(()=>{let Gs=(Xr,So)=>Xr,xa=(Xr,So)=>Xr,ka={renderers:[],tweakScale:Gs,tweakAxis:xa,shouldRenderPrice:!1};if(!Fn)return ka;const Ja=Fn.names;if(!Object.keys(Ja).length)return ka;const{mode:Wr,candleStyle:Ua,colorStrategy:ra}=gt,la={...or,...gt.colors};let{open:lr,high:Kr,low:Ca,close:va,volume:Ga}=Ja;if(lr==null||va==null)return ka;let cr=.5,sr=-1,vr=!1;if(Ga!=null&&Wr!==ta.Candles){let Xr=Fn.volume;if(Xr!=null){vr=!0;let{fillOpacity:So}=Xr.config.custom;So&&(cr=So/100),Wr!==ta.Volume&&(Xr.config={...Xr.config},Xr.config.unit="short",Xr.display=(0,_o.J)({field:Xr,theme:de.config.theme2}),xa=(Qs,hs)=>{if(hs.name===Fn.volume?.name){let Ms=(Na,Oa)=>{let Qa=[],xr=Na.series[sr].max;for(let Io=0;Io<Oa.length&&(Qa.push(Oa[Io]),!(xr&&Oa[Io]>xr));Io++);return Qa};Qs.space=20,Qs.filter=Ms,Qs.ticks={...Qs.ticks,filter:Ms}}return Qs},Gs=(Qs,hs)=>(hs.name===Fn.volume?.name&&(Qs.range=(Ms,Na,Oa)=>[0,Oa*7]),Qs))}}let kr=Wr!==ta.Volume&&Kr!=null&&Ca!=null;if(!kr&&!vr)return ka;let dr={},Gr=[];return kr?dr={open:lr,high:Kr,low:Ca,close:va}:Gr.push(lr,va),vr&&(dr.volume=Ga,dr.open=lr,dr.close=va),{shouldRenderPrice:kr,renderers:[{fieldMap:dr,indicesOnly:Gr,init:(Xr,So)=>{sr=So.volume,Xr.addHook("drawAxes",Gi({mode:Wr,fields:So,upColor:de.config.theme2.visualization.getColorByName(la.up),downColor:de.config.theme2.visualization.getColorByName(la.down),flatColor:de.config.theme2.visualization.getColorByName(la.flat),volumeAlpha:cr,colorStrategy:ra,candleStyle:Ua,flatAsUp:!0}))}}],tweakScale:Gs,tweakAxis:xa}},[gt,Z.structureRev,Z.series.length]);if(!Fn)return(0,T.jsx)(Ks.a,{panelId:me,fieldConfig:Bt,data:Z,needsTimeField:!0,needsNumberField:!0});if(Ls)for(let Gs in sa[0].fieldMap){let xa=Fn[Gs];xa.config={...xa.config,custom:{...xa.config.custom,hideFrom:{legend:!0,tooltip:!1,viz:!1}}}}const Cs=!!Rn?.();return(0,T.jsx)(ao,{frames:[Fn.frame],structureRev:Z.structureRev,timeRange:Me,timeZone:Ne,width:Ze,height:ct,legend:gt.legend,renderers:sa,tweakAxis:is,tweakScale:ys,options:gt,replaceVariables:Xt,dataLinkPostProcessor:rs,cursorSync:zs,children:(Gs,xa)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Xo.Z,{config:Gs}),zs!==ci.yV.Off&&(0,T.jsx)(Ti.K,{config:Gs,eventBus:gs,frame:xa}),gt.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:Gs,hoverMode:gt.tooltip.mode===ut.$N.Single?Xs.b3.xOne:Xs.b3.xAll,queryZoom:Vt,clientZoom:!0,syncMode:zs,syncScope:on,render:(ka,Ja,Wr,Ua=!1,ra,la,lr)=>{if(Cs&&la!=null){ba(la),ra();return}const Kr=()=>{let Ca=ka.posToVal(ka.cursor.left,"x");ba({from:Ca,to:Ca}),ra()};return(0,T.jsx)(Ta.k,{series:xa,dataIdxs:Ja,seriesIdx:Wr,mode:lr?ut.$N.Multi:gt.tooltip.mode,sortOrder:gt.tooltip.sort,isPinned:Ua,annotate:Cs?Kr:void 0,maxHeight:gt.tooltip.maxHeight})},maxWidth:gt.tooltip.maxWidth}),(0,T.jsx)(Qr.W,{annotations:Z.annotations??[],config:Gs,timeZone:Ne,newRange:Gn,setNewRange:ba}),(0,T.jsx)(Yn.U,{config:Gs,onChangeTimeRange:Vt}),Z.annotations&&(0,T.jsx)(hn,{config:Gs,exemplars:Z.annotations,timeZone:Ne}),(Nn&&rn||ms)&&(0,T.jsx)(_a,{config:Gs,fieldConfig:Bt,onThresholdsChange:Nn?rn:void 0})]})})};class Ui{getSuggestionsForData(me){const{dataSummary:Me}=me;if(!me.data?.series||!Me.hasData||Me.timeFieldCount<1||Me.numberFieldCount<2||Me.numberFieldCount>10)return;const Ne=ki(me.data.series,Mo,R.$.theme2);if(!Ne||Ne.open===Ne.high&&Ne.open===Ne.low)return;me.getListAppender({name:"",pluginId:"candlestick",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ks.m.Candlestick,options:Mo,fieldConfig:{defaults:{},overrides:[]},score:Ne.autoOpenClose?Ft.nQ.Good:Ft.nQ.Best})}}const wo=[{label:"Candles",value:ta.Candles},{label:"Volume",value:ta.Volume},{label:"Both",value:ta.CandlesVolume}],ul=[{label:"Candles",value:Ba.Candles},{label:"OHLC Bars",value:Ba.OHLCBars}],hl=[{label:"Since Open",value:Ea.OpenClose},{label:"Since Prior Close",value:Ea.CloseClose}],lc=Z=>Z.type===Ht.PU.number;function fl(Z,me,Me){let Ne="Auto ";if(Me){const Ze=Me[me.key];Ze?.config?(Ne+="= "+(0,rr.Ct)(Ze),Ze===Me?.open&&me.key!=="open"&&(Ne+=` (${me.defaults.join(",")})`)):Ne+=`(${me.defaults.join(",")})`}Z.addFieldNamePicker({path:`fields.${me.key}`,name:me.name,description:me.description,settings:{filter:lc,placeholderText:Ne}})}const ol=new S.m(bi).useFieldConfig((0,io.V)(io.S)).setPanelOptions((Z,me)=>{const Me=me.options??Mo,Ne=ki(me.data,Me,R.$.theme2);Z.addRadio({path:"mode",name:"Mode",description:"",defaultValue:Mo.mode,settings:{options:wo}}).addRadio({path:"candleStyle",name:"Candle style",description:"",defaultValue:Mo.candleStyle,settings:{options:ul},showIf:Ze=>Ze.mode!==ta.Volume}).addRadio({path:"colorStrategy",name:"Color strategy",description:"",defaultValue:Mo.colorStrategy,settings:{options:hl}}).addColorPicker({path:"colors.up",name:"Up color",defaultValue:or.up}).addColorPicker({path:"colors.down",name:"Down color",defaultValue:or.down}),fl(Z,No.open,Ne),Me.mode!==ta.Volume&&(fl(Z,No.high,Ne),fl(Z,No.low,Ne)),fl(Z,No.close,Ne),Me.mode!==ta.Candles&&fl(Z,No.volume,Ne),Z.addRadio({path:"includeAllFields",name:"Additional fields",description:"Use standard timeseries options to configure any fields not mapped above",defaultValue:Mo.includeAllFields,settings:{options:[{label:"Ignore",value:!1},{label:"Include",value:!0}]}}),fs.D(Z,!1,!0,Me),ls.H(Z)}).setDataSupport({annotations:!0,alertStates:!0}).setSuggestionsSupplier(new Ui);var Sl=e(36607),Tl=e(76885),kl=e(80997),Ml=e(6709),fi=e(29158),gl=e(82467),$e=e(10096),Ye=e(16021),rt=e(91219),xt=e(28215),Kt=e(27677),en=e(62301),mn=e(80484);const jn=Z=>({dashlistSectionHeader:(0,se.css)`
    padding: ${Z.spacing(.25,1)};
    margin-right: ${Z.spacing(1)};
  `,dashlistSection:(0,se.css)`
    margin-bottom: ${Z.spacing(2)};
    padding-top: 3px;
  `,dashlistLink:(0,se.css)`
    display: flex;
    cursor: pointer;
    border-bottom: 1px solid ${Z.colors.border.weak};
    margin-right: ${Z.spacing(1)};
    padding: ${Z.spacing(1)};
    align-items: center;

    &:hover {
      a {
        color: ${Z.colors.text.link};
        text-decoration: underline;
      }
    }
  `,dashlistFolder:(0,se.css)`
    color: ${Z.colors.text.secondary};
    font-size: ${Z.typography.bodySmall.fontSize};
    line-height: ${Z.typography.body.lineHeight};
  `,dashlistTitle:(0,se.css)`
    &::after {
      position: absolute;
      content: '';
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
    }
  `,dashlistLinkBody:(0,se.css)`
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  `,dashlistItem:(0,se.css)`
    position: relative;
    list-style: none;
  `});async function Vn(Z,me){let Me=Promise.resolve([]);if(Z.showStarred){const nn={limit:Z.maxItems,starred:"true"};Me=(0,Kt.AI)().search(nn)}let Ne=Promise.resolve([]),Ze=[];if(Z.showRecentlyViewed){let nn=await en.A.getDashboardOpened();Ze=(0,w.take)(nn,Z.maxItems),Ne=(0,Kt.AI)().search({dashboardUIDs:Ze,limit:Z.maxItems})}let ct=Promise.resolve([]);if(Z.showSearch){const nn=Z.folderUID===""?"general":Z.folderUID,on={limit:Z.maxItems,query:me(Z.query,{},"text"),folderUIDs:nn,tag:Z.tags.map(Rn=>me(Rn,{},"text")),type:"dash-db"};ct=(0,Kt.AI)().search(on)}const[gt,Bt,Vt]=await Promise.all([Me,ct,Ne]);let Xt=new Map;for(const nn of Ze){const on=Vt.find(Rn=>Rn.uid===nn);on&&Xt.set(nn,{...on,isRecent:!0})}return Bt.forEach(nn=>{nn.uid&&(Xt.has(nn.uid)?Xt.get(nn.uid).isSearchResult=!0:Xt.set(nn.uid,{...nn,isSearchResult:!0}))}),gt.forEach(nn=>{nn.uid&&(Xt.has(nn.uid)?Xt.get(nn.uid).isStarred=!0:Xt.set(nn.uid,{...nn,isStarred:!0}))}),Xt}function qn(Z){const[me,Me]=(0,K.useState)(new Map),Ne=(0,F.useDispatch)(),Ze=(0,F.useSelector)(os=>os.navIndex);(0,K.useEffect)(()=>{Vn(Z.options,Z.replaceVariables).then(os=>{Me(os)})},[Z.options,Z.replaceVariables,Z.renderCounter]);const ct=async(os,Fn)=>{const{uid:Gn,title:ba,url:zs}=Fn;os.preventDefault(),os.stopPropagation();const sa=await(0,Xe.UA)().starDashboard(Fn.uid,Fn.isStarred),ys=new Map(me);ys.set(Fn?.uid??"",{...Fn,isStarred:sa}),Me(ys),Ne((0,rt.ci)({id:Gn??"",title:ba,url:zs,isStarred:sa}));const is=Ze.starred;if(sa)is.children?.push({id:rt.L1+Gn,text:ba,url:zs??"",parentItem:is});else{Ne((0,xt.Im)(rt.L1+Gn));const Ls=is.children?.findIndex(Cs=>Cs.id===rt.L1+Gn);Ls&&is.children?.splice(Ls,1)}Ne((0,gl.Vz)(is))},[gt,Bt,Vt]=(0,K.useMemo)(()=>{const os=[...me.values()];return[os.filter(Fn=>Fn.isStarred).sort((Fn,Gn)=>Fn.title.localeCompare(Gn.title)),os.filter(Fn=>Fn.isRecent),os.filter(Fn=>Fn.isSearchResult).sort((Fn,Gn)=>Fn.title.localeCompare(Gn.title))]},[me]),{showStarred:Xt,showRecentlyViewed:nn,showHeadings:on,showFolderNames:Rn,showSearch:rn}=Z.options,Nn=[{header:"Starred dashboards",dashboards:gt,show:Xt},{header:"Recently viewed dashboards",dashboards:Bt,show:nn},{header:"Search",dashboards:Vt,show:rn}],ms=(0,Q.of)(jn),rs=Us(Z),gs=os=>(0,T.jsx)("ul",{children:os.map(Fn=>{let Gn=Fn.url;return Gn=Tl.kM.appendQueryToUrl(Gn,rs),Gn=(0,de.zj)().disableSanitizeHtml?Gn:kl.sQ.sanitizeUrl(Gn),(0,T.jsx)("li",{className:ms.dashlistItem,children:(0,T.jsxs)("div",{className:ms.dashlistLink,children:[(0,T.jsxs)("div",{className:ms.dashlistLinkBody,children:[(0,T.jsx)("a",{className:ms.dashlistTitle,href:Gn,children:Fn.title}),Rn&&Fn.folderTitle&&(0,T.jsx)("div",{className:ms.dashlistFolder,children:Fn.folderTitle})]}),(0,T.jsx)(fi.K,{tooltip:Fn.isStarred?`Unmark "${Fn.title}" as favorite`:`Mark "${Fn.title}" as favorite`,name:Fn.isStarred?"favorite":"star",iconType:Fn.isStarred?"mono":"default",onClick:ba=>ct(ba,Fn)})]})},`dash-${Fn.uid}`)})});return(0,T.jsx)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:Nn.map(({show:os,header:Fn,dashboards:Gn},ba)=>os&&(0,T.jsxs)("div",{className:ms.dashlistSection,children:[on&&(0,T.jsx)("h6",{className:ms.dashlistSectionHeader,children:Fn}),gs(Gn)]},`dash-group-${ba}`))})}function Us(Z){(0,Ye.u)($e.lE,mn.og);let me={};return Z.options.keepTime&&(me[`$${Ml.c.keepTime}`]=!0),Z.options.includeVars&&(me[`$${Ml.c.includeVars}`]=!0),Z.replaceVariables(Tl.kM.toUrlParams(me))}async function Is(Z){return Z===0?"":(await(0,Tn.AI)().get(`/api/folders/id/${Z}`,void 0,void 0,{showErrorAlert:!1})).uid}async function $s(Z){const me={...Z.options,showStarred:Z.options.showStarred??Z.starred,showRecentlyViewed:Z.options.showRecentlyViewed??Z.recent,showSearch:Z.options.showSearch??Z.search,showHeadings:Z.options.showHeadings??Z.headings,maxItems:Z.options.maxItems??Z.limit,query:Z.options.query??Z.query,folderId:Z.options.folderId??Z.folderId,tags:Z.options.tags??Z.tags};if(parseFloat(Z.pluginVersion||"6.1")<6.3&&["starred","recent","search","headings","limit","query","folderId"].forEach(Ze=>delete Z[Ze]),me.folderId!==void 0){const Ne=me.folderId;try{const Ze=await Is(Ne);me.folderUID=Ze,delete me.folderId}catch(Ze){console.warn("Dashlist: Error migrating folder ID to UID",Ze)}}return me}const Vs={includeVars:!1,keepTime:!1,maxItems:10,query:"",showFolderNames:!0,showHeadings:!0,showRecentlyViewed:!1,showSearch:!1,showStarred:!0,tags:[]},Ra=new S.m(qn).setPanelOptions(Z=>{Z.addBooleanSwitch({path:"keepTime",name:"Include current time range",defaultValue:Vs.keepTime}).addBooleanSwitch({path:"includeVars",name:"Include current template variable values",defaultValue:Vs.includeVars}).addBooleanSwitch({path:"showStarred",name:"Starred",defaultValue:Vs.showStarred}).addBooleanSwitch({path:"showRecentlyViewed",name:"Recently viewed",defaultValue:Vs.showRecentlyViewed}).addBooleanSwitch({path:"showSearch",name:"Search",defaultValue:Vs.showSearch}).addBooleanSwitch({path:"showHeadings",name:"Show headings",defaultValue:Vs.showHeadings}).addBooleanSwitch({path:"showFolderNames",name:"Show folder names",defaultValue:Vs.showFolderNames}).addNumberInput({path:"maxItems",name:"Max items",defaultValue:Vs.maxItems}).addTextInput({path:"query",name:"Query",defaultValue:Vs.query}).addCustomEditor({path:"folderUID",name:"Folder",id:"folderUID",defaultValue:void 0,editor:function({value:Me,onChange:Ne}){return(0,T.jsx)(Sl.d,{clearable:!0,permission:F.PermissionLevelString.View,value:Me,onChange:Ze=>Ne(Ze)})}}).addCustomEditor({id:"tags",path:"tags",name:"Tags",description:"",defaultValue:Vs.tags,editor(me){return(0,T.jsx)(Lt.u,{tags:me.value,onChange:me.onChange})}})}).setMigrationHandler($s);var ga=e(47187),Js=e(14110),ia=e(11503);const Fa=({onBlur:Z,placeholder:me})=>{const Me=(0,K.useRef)(null);(0,K.useEffect)(()=>{Me.current&&Me.current.focus()});const Ne=Ze=>{Ze.key==="Enter"&&Ze.currentTarget.blur()};return(0,T.jsx)("input",{type:"text",placeholder:me,onBlur:Z,ref:Me,onKeyDown:Ne,"data-testid":"column-input"})},Ya=({divStyle:Z,onColumnInputBlur:me})=>{const[Me,Ne]=(0,K.useState)(!1),Ze=()=>{Ne(!0)},ct=gt=>{const Bt=gt.target.value;Bt&&me(Bt),Ne(!1)};return(0,T.jsx)("div",{className:Z,children:Me?(0,T.jsx)(Fa,{placeholder:"Column Name",onBlur:ct}):(0,T.jsx)("button",{onClick:Ze,children:"+"})})};var ma=e(50311),Wa=e(64539),Tr=e(59093),Jr=e(28122),_r=e(27183),Mr=e(69321);const Ka=()=>R.$.featureToggles.enableDatagridEditing,Vo="600 13px Inter",ei="400 13px Inter",to=document.createElement("canvas"),Ao=20,Oi=300,zo=65,ti="both",br="number",As={isContextMenuOpen:!1},ya={isInputOpen:!1},ws="datagrid_panel",Da={EDIT_CELL:"edit_cell",GRID_SELECTED:"grid_selected",APPEND_ROW:"append_row",APPEND_COLUMN:"append_column",DELETE_BTN_PRESSED:"delete_btn_pressed",COLUMN_RESIZE:"column_resize",COLUMN_REORDER:"column_reorder",ROW_REORDER:"row_reorder",CONTEXT_MENU_ACTION:"context_menu_action",HEADER_MENU_ACTION:"header_menu_action"},jr={name:"A",fields:[],length:0},Zr={kind:Mr.dd.Text,data:"",allowOverlay:!0,readonly:!1,displayData:""},nt={columns:Mr.I1.empty(),rows:Mr.I1.empty()},Le={sticky:!1,tint:!0},et={fill:!0,sticky:!1};async function mt(Z,me){if(me&&Ka()){for(let Me=0;Me<Z.fields.length;Me++)delete Z.fields[Me].config.displayName,delete Z.fields[Me].config.displayNameFromDS;return await me([Z])}return!1}const kt=(Z,me=!1)=>{const Me=to.getContext("2d");return Me.font=me?Vo:ei,Me.measureText(Z).width},yn=Z=>Math.max(kt(Z.name,!0)+zo,Math.min(Oi,Z.values.toArray().reduce((me,Me)=>{const Ne=kt(Me?.toString()??"");return Ne>me?Ne:me},0)+Ao)),fn=(Z,me,Me=!1)=>{const Ne={...Z,fields:Z.fields.map(Ze=>({...Ze,values:Ze.values.slice()}))};for(const Ze of Ne.fields){const ct=Ze.values.toArray();for(let gt=me.length-1;gt>=0;gt--)Me?ct.splice(me[gt],1):ct.splice(me[gt],1,null);Ze.values=[...ct]}return{...Ne,length:Ne.fields[0]?.values.length??0}},Cn=(Z,me)=>{const Me=me.x,Ne=me.y,Ze=me.x+me.width-1,ct={...Z,fields:Z.fields.map(gt=>({...gt,values:gt.values.slice()}))};for(let gt=Me;gt<=Ze;gt++){const Bt=ct.fields[gt],Vt=Bt.values.toArray();Vt.splice(Ne,me.height,...new Array(me.height).fill(null)),Bt.values=[...Vt]}return{...ct,length:ct.fields[0]?.values.length??0}},as=Z=>{const me=Z.values.toArray();Z.values=me.map(Me=>Me==="undefined"||Me==="null"?null:Me)};function ts(Z){return{accentColor:Z.colors.primary.main,accentFg:Z.colors.secondary.main,textDark:Z.colors.text.primary,textMedium:Z.colors.text.secondary,textLight:Z.colors.text.secondary,textBubble:Z.colors.text.primary,textHeader:Z.colors.text.primary,bgCell:Z.colors.background.primary,bgCellMedium:Z.colors.background.primary,bgHeader:Z.colors.background.primary,bgHeaderHasFocus:Z.colors.background.secondary,bgHeaderHovered:Z.colors.background.secondary,linkColor:Z.colors.text.link,fontFamily:Z.typography.fontFamily,headerFontStyle:`${Z.typography.fontWeightMedium} ${Z.typography.fontSize}px`,fgIconHeader:Z.colors.secondary.contrastText,bgIconHeader:Z.colors.secondary.main}}const _s=(Z,me,Me=!1)=>{const Ne=Z.values.get(me);switch(Z.type){case Ht.PU.boolean:return{kind:Mr.dd.Boolean,data:Ne||!1,allowOverlay:!1,readonly:!1};case Ht.PU.number:return{kind:Mr.dd.Number,data:Ne||0,allowOverlay:Ka()&&!Me,readonly:!1,displayData:Ne!=null?Ne.toString():""};case Ht.PU.string:return{kind:Mr.dd.Text,data:Ne||"",allowOverlay:Ka()&&!Me,readonly:!1,displayData:Ne!=null?Ne.toString():""};default:return{kind:Mr.dd.Text,data:Ne||"",allowOverlay:Ka()&&!Me,readonly:!1,displayData:Ne!=null?Ne.toString():""}}},Fs=(Z,me)=>({dataEditor:(0,se.css)`
      .dvn-scroll-inner > div:nth-child(2) {
        pointer-events: none !important;
      }
      scrollbar-color: ${Z.colors.background.secondary} ${Z.colors.background.primary};
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }
      ::-webkit-scrollbar-track {
        background: ${Z.colors.background.primary};
      }
      ::-webkit-scrollbar-thumb {
        border-radius: 10px;
      }
      ::-webkit-scrollbar-corner {
        display: none;
      }
    `,addColumnDiv:(0,se.css)`
      width: 120px;
      display: flex;
      flex-direction: column;
      background-color: ${Z.colors.background.primary};
      button {
        pointer-events: ${me?"none":"auto"};
        border: none;
        outline: none;
        height: 37px;
        font-size: 20px;
        background-color: ${Z.colors.background.primary};
        color: ${Z.colors.text.primary};
        border-right: 1px solid ${Z.components.panel.borderColor};
        border-bottom: 1px solid ${Z.components.panel.borderColor};
        transition: background-color 200ms;
        cursor: pointer;
        :hover {
          background-color: ${Z.colors.background.secondary};
        }
      }
      input {
        height: 37px;
        border: 1px solid ${Z.colors.primary.main};
        :focus {
          outline: none;
        }
      }
    `,renameColumnInput:(0,se.css)`
      height: 37px;
      border: 1px solid ${Z.colors.primary.main};
      :focus {
        outline: none;
      }
    `}),Ha=Z=>Z.rows.length||Z.columns.length?!0:Z.current===void 0?!1:Z.current.range&&!(Z.current.range.height===1&&Z.current.range.width===1);var Zs=(Z=>(Z.columnResizeStart="columnResizeStart",Z.columnResizeEnd="columnResizeEnd",Z.columnMove="columnMove",Z.updateColumns="updateColumns",Z.showColumnRenameInput="showColumnRenameInput",Z.hideColumnRenameInput="hideColumnRenameInput",Z.openCellContextMenu="openCellContextMenu",Z.openHeaderContextMenu="openHeaderContextMenu",Z.openHeaderDropdownMenu="openHeaderDropdownMenu",Z.closeContextMenu="closeContextMenu",Z.multipleCellsSelected="multipleCellsSelected",Z.gridSelectionCleared="gridSelectionCleared",Z.columnFreezeReset="columnFreezeReset",Z.columnFreezeChanged="columnFreezeChanged",Z.openSearch="openSearch",Z.closeSearch="closeSearch",Z))(Zs||{});const Pr={columns:[],contextMenuData:As,renameColumnInputData:ya,gridSelection:nt,columnFreezeIndex:0,toggleSearch:!1,isResizeInProgress:!1},Or=new Map([[Ht.PU.number,Mr.Gf.HeaderNumber],[Ht.PU.string,Mr.Gf.HeaderTextTemplate],[Ht.PU.boolean,Mr.Gf.HeaderBoolean],[Ht.PU.time,Mr.Gf.HeaderDate],[Ht.PU.other,Mr.Gf.HeaderReference]]),nr=(Z,me)=>{let Me=[];switch(me.type){case"columnResizeStart":Me=[...Z.columns];const Ne=me.payload;return Me[Ne.columnIndex]={...Z.columns[Ne.columnIndex],width:Ne.width},{...Z,columns:Me,isResizeInProgress:!0};case"columnMove":Me=[...Z.columns];const Ze=me.payload,ct=Z.columns[Ze.from].width;let gt=Me.splice(Ze.from,1)[0];return gt={...gt,width:ct},Me.splice(Ze.to,0,gt),{...Z,columns:Me};case"columnResizeEnd":return{...Z,isResizeInProgress:!1};case"updateColumns":const Bt=me.payload;return Me=[...Bt.frame.fields.map((gs,os)=>{const Fn=Z.columns.find(ba=>ba.title===gs.name)?.width;return{title:(0,rr.Ct)(gs,Bt.frame),width:Fn??yn(gs),icon:Or.get(gs.type),hasMenu:Ka(),trailingRowOptions:{targetColumn:--os}}})],{...Z,columns:Me};case"showColumnRenameInput":return{...Z,renameColumnInputData:{...Z.renameColumnInputData,isInputOpen:!0}};case"hideColumnRenameInput":return{...Z,renameColumnInputData:{...Z.renameColumnInputData,isInputOpen:!1}};case"openCellContextMenu":const Vt=me.payload,Xt=Vt.event,nn=Vt.cell;return{...Z,contextMenuData:{x:Xt.bounds.x+Xt.localEventX,y:Xt.bounds.y+Xt.localEventY,column:nn[0]===-1?void 0:nn[0],row:nn[1],isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderContextMenu":const on=me.payload,Rn=on.event;return{...Z,contextMenuData:{x:Rn.bounds.x+Rn.localEventX,y:Rn.bounds.y+Rn.localEventY,column:on.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!1}};case"openHeaderDropdownMenu":const rn=me.payload,Nn=rn.screenPosition;return{...Z,contextMenuData:{x:Nn.x+Nn.width,y:Nn.y+Nn.height,column:rn.columnIndex,row:void 0,isContextMenuOpen:!0,isHeaderMenu:!0},renameColumnInputData:{x:Nn.x,y:Nn.y,width:Nn.width,height:Nn.height,columnIdx:rn.columnIndex,isInputOpen:!1,inputValue:rn.value}};case"closeContextMenu":return{...Z,contextMenuData:{isContextMenuOpen:!1}};case"closeSearch":return{...Z,toggleSearch:!1};case"openSearch":return{...Z,toggleSearch:!0};case"multipleCellsSelected":const ms=me.payload;return{...Z,gridSelection:ms.selection};case"gridSelectionCleared":return{...Z,gridSelection:nt};case"columnFreezeReset":return{...Z,columnFreezeIndex:0};case"columnFreezeChanged":const rs=me.payload;return{...Z,columnFreezeIndex:rs.columnIndex};default:return Z}},Xa=({menuData:Z,data:me,saveData:Me,closeContextMenu:Ne,dispatch:Ze,gridSelection:ct,columnFreezeIndex:gt,renameColumnClicked:Bt})=>{let Vt=[],Xt=[];const{row:nn,column:on,x:Rn,y:rn,isHeaderMenu:Nn}=Z;ct.rows&&(Vt=ct.rows.toArray()),ct.columns&&(Xt=ct.columns.toArray());let ms="Delete row";Vt.length&&Vt.length>1&&(ms=`Delete ${Vt.length} rows`);let rs="Delete column";Xt.length&&Xt.length>1&&(rs=`Delete ${Xt.length} columns`);const gs=nn!==void 0&&nn>=0||Vt.length,os=on!==void 0&&on>=0&&nn!==void 0||Xt.length,Fn=nn!==void 0&&nn>=0&&!Vt.length,Gn=on!==void 0&&on>=0&&nn!==void 0&&!Xt.length,ba=()=>(0,T.jsxs)(T.Fragment,{children:[gs?(0,T.jsx)(Wa.D,{label:ms,onClick:()=>{if(Vt.length){Me(fn(me,Vt,!0)),Ze({type:Zs.gridSelectionCleared});return}nn!==void 0&&nn>=0&&((0,Js.rR)(ws,{item:Da.CONTEXT_MENU_ACTION,menu_action:"row_delete"}),Me(fn(me,[nn],!0)))}}):null,os?(0,T.jsx)(Wa.D,{label:rs,onClick:()=>{if(Xt.length){Me({...me,fields:me.fields.filter((sa,ys)=>!Xt.includes(ys))}),Ze({type:Zs.gridSelectionCleared});return}on!==void 0&&on>=0&&((0,Js.rR)(ws,{item:Da.CONTEXT_MENU_ACTION,menu_action:"column_delete"}),Me({...me,fields:me.fields.filter((sa,ys)=>ys!==on)}))}}):null,os||gs?(0,T.jsx)(_r.N,{}):null,Fn?(0,T.jsx)(Wa.D,{label:"Clear row",onClick:()=>{(0,Js.rR)(ws,{item:Da.CONTEXT_MENU_ACTION,menu_action:"row_clear"}),Me(fn(me,[nn]))}}):null,Gn?(0,T.jsx)(Wa.D,{label:"Clear column",onClick:()=>{const sa=me.fields[on];sa.values=sa.values.map(()=>null),(0,Js.rR)(ws,{item:Da.CONTEXT_MENU_ACTION,menu_action:"column_clear"}),Me({...me})}}):null,Fn||Gn?(0,T.jsx)(_r.N,{}):null,(0,T.jsx)(Wa.D,{label:"Remove all data",onClick:()=>{(0,Js.rR)(ws,{item:Da.CONTEXT_MENU_ACTION,menu_action:"remove_all"}),Me(jr)}}),(0,T.jsx)(Wa.D,{label:"Search...",onClick:()=>{(0,Js.rR)(ws,{item:Da.CONTEXT_MENU_ACTION,menu_action:"open_search"}),Ze({type:Zs.openSearch})}})]}),zs=()=>{if(on==null)return null;const sa=me.fields[on].type,ys=[],is=Gs=>{ys.push({label:(0,w.capitalize)(Gs),options:{targetField:me.fields[on].name,destinationType:Gs}})};sa===Ht.PU.string?(is(Ht.PU.number),is(Ht.PU.boolean)):sa===Ht.PU.number?(is(Ht.PU.string),is(Ht.PU.boolean)):sa===Ht.PU.boolean?(is(Ht.PU.number),is(Ht.PU.string)):(is(Ht.PU.string),is(Ht.PU.number),is(Ht.PU.boolean));let Ls="Set column freeze position";const Cs=on+1;return gt===Cs&&(Ls="Unset column freeze"),(0,T.jsxs)(T.Fragment,{children:[ys.length?(0,T.jsx)(Tr.r,{label:"Set field type",children:ys.map((Gs,xa)=>(0,T.jsx)(Wa.D,{label:Gs.label,onClick:()=>{const ka=(0,ma.s7)(me.fields[on],Gs.options);Gs.options.destinationType===Ht.PU.string&&as(ka);const Ja={name:me.name,fields:[...me.fields],length:me.length};Ja.fields[on]=ka,(0,Js.rR)(ws,{item:Da.HEADER_MENU_ACTION,menu_action:"convert_field"}),Me(Ja)}},xa))}):null,(0,T.jsx)(_r.N,{}),(0,T.jsx)(Wa.D,{label:Ls,onClick:()=>{(0,Js.rR)(ws,{item:Da.HEADER_MENU_ACTION,menu_action:"column_freeze"}),Ze(gt===Cs?{type:Zs.columnFreezeReset}:{type:Zs.columnFreezeChanged,payload:{columnIndex:Cs}})}}),(0,T.jsx)(Wa.D,{label:"Rename column",onClick:Bt}),(0,T.jsx)(_r.N,{}),(0,T.jsx)(Wa.D,{label:"Delete column",onClick:()=>{(0,Js.rR)(ws,{item:Da.HEADER_MENU_ACTION,menu_action:"delete_column"}),Me({...me,fields:me.fields.filter((Gs,xa)=>xa!==on)}),Ze({type:Zs.gridSelectionCleared})}}),(0,T.jsx)(Wa.D,{label:"Clear column",onClick:()=>{const Gs=me.fields[on];Gs.values=Gs.values.map(()=>null),(0,Js.rR)(ws,{item:Da.HEADER_MENU_ACTION,menu_action:"clear_column"}),Me({...me})}})]})};return(0,T.jsx)(Jr.t,{renderMenuItems:Nn?zs:ba,x:Rn,y:rn,onClose:Ne})},mr=({renameColumnData:Z,onColumnInputBlur:me,classStyle:Me})=>{const{x:Ne,y:Ze,width:ct,height:gt,inputValue:Bt,columnIdx:Vt}=Z,[Xt,nn]=(0,K.useState)({}),[on,Rn]=(0,K.useState)(Bt),rn=(0,K.useRef)(null);(0,K.useLayoutEffect)(()=>{rn.current?.focus();const gs=rn.current?.getBoundingClientRect();if(gs){const os={right:window.innerWidth<Ne+gs.width,bottom:window.innerHeight<Ze+gs.height};nn({position:"fixed",left:os.right?Ne-gs.width:Ne,top:os.bottom?Ze-gs.height:Ze,width:ct,height:gt})}},[gt,ct,Ne,Ze]);const Nn=gs=>{const os=gs.target.value;os&&me(os,Vt)},ms=gs=>{Rn(gs.target.value)},rs=gs=>{gs.key==="Enter"&&gs.currentTarget.blur()};return(0,T.jsx)(zr.ZL,{children:(0,T.jsx)("input",{type:"text",className:Me,value:on,onBlur:Nn,ref:rn,style:Xt,onChange:ms,onKeyDown:rs})})};function no({options:Z,data:me,id:Me,fieldConfig:Ne,width:Ze,height:ct}){const[gt,Bt]=(0,K.useReducer)(nr,Pr),{onUpdateData:Vt}=(0,ja.d2)(),{columns:Xt,contextMenuData:nn,renameColumnInputData:on,gridSelection:Rn,columnFreezeIndex:rn,toggleSearch:Nn,isResizeInProgress:ms}=gt,rs=me.series[Z.selectedSeries??0],gs=(0,Q.$j)(),os=ts(gs);(0,K.useEffect)(()=>{rs&&Bt({type:Zs.updateColumns,payload:{frame:rs}})},[rs]);const Fn=([Ca,va])=>{const Ga=rs.fields[Ca];return!Ga||va>rs.length?Zr:_s(Ga,va,Ha(Rn))},Gn=(Ca,va)=>{if(Ha(Rn))return;const[Ga,cr]=Ca,sr={...rs,fields:rs.fields.map(dr=>({...dr,values:[...dr.values]}))},vr=sr.fields[Ga];if(!vr)return;const kr=vr.values.toArray();kr[cr]=va.data,vr.values=[...kr],(0,Js.rR)(ws,{item:Da.EDIT_CELL}),mt(sr,Vt)},ba=Ca=>{const va=rs.length??0;(0,Js.rR)(ws,{item:Da.APPEND_COLUMN}),mt({...rs,fields:[...rs.fields,{name:Ca,type:Ht.PU.string,config:{},values:new Array(va).fill("")}]},Vt)},zs=()=>{const Ca=rs.fields.map(va=>{const Ga=va.values.slice();return Ga.push(null),{...va,values:Ga}});(0,Js.rR)(ws,{item:Da.APPEND_ROW}),mt({...rs,fields:Ca,length:rs.length+1},Vt)},sa=(Ca,va,Ga,cr)=>{(0,Js.rR)(ws,{item:Da.COLUMN_RESIZE}),Bt({type:Zs.columnResizeStart,payload:{columnIndex:Ga,width:va}})},ys=(Ca,va,Ga,cr)=>{Bt({type:Zs.columnResizeEnd})},is=()=>{Bt({type:Zs.closeContextMenu})},Ls=Ca=>{if(Ca.current&&Ca.current.range)return(0,Js.rR)(ws,{item:Da.DELETE_BTN_PRESSED,selection:"grid-cell"}),mt(Cn(rs,Ca.current.range),Vt),!0;const va=Ca.rows.toArray(),Ga=Ca.columns.toArray();if(va.length)return(0,Js.rR)(ws,{item:Da.DELETE_BTN_PRESSED,selection:"rows"}),mt(fn(rs,va),Vt),!0;if(Ga.length){const cr={...rs,fields:rs.fields.map((sr,vr)=>Ga.includes(vr)?{...sr,values:new Array(rs.length).fill(null)}:sr)};return(0,Js.rR)(ws,{item:Da.DELETE_BTN_PRESSED,selection:"columns"}),mt(cr,Vt),!0}return!1},Cs=(Ca,va)=>{va.preventDefault(),Bt({type:Zs.openCellContextMenu,payload:{event:va,cell:Ca}})},Gs=(Ca,va)=>{va.preventDefault(),Bt({type:Zs.openHeaderContextMenu,payload:{event:va,columnIndex:Ca}})},xa=(Ca,va)=>{Bt({type:Zs.openHeaderDropdownMenu,payload:{screenPosition:va,columnIndex:Ca,value:gt.columns[Ca].title}})},ka=async(Ca,va)=>{const Ga=rs.fields.map(vr=>vr),cr=Ga[Ca];Ga.splice(Ca,1),Ga.splice(va,0,cr),await mt({...rs,fields:Ga},Vt)&&((0,Js.rR)(ws,{item:Da.COLUMN_REORDER}),Bt({type:Zs.columnMove,payload:{from:Ca,to:va}}))},Ja=(Ca,va)=>{const Ga=rs.fields.map(cr=>({...cr,values:cr.values.slice()}));for(const cr of Ga){const sr=cr.values[Ca];cr.values.splice(Ca,1),cr.values.splice(va,0,sr)}(0,Js.rR)(ws,{item:Da.ROW_REORDER}),mt({...rs,fields:Ga},Vt)},Wr=()=>{(0,Js.rR)(ws,{item:Da.HEADER_MENU_ACTION,menu_action:"rename_column"}),Bt({type:Zs.showColumnRenameInput})},Ua=(Ca,va)=>{const Ga=rs.fields.map(cr=>cr);Ga[va].name=Ca,Bt({type:Zs.hideColumnRenameInput}),mt({...rs,fields:Ga},Vt)},ra=()=>{Bt({type:Zs.closeSearch})},la=Ca=>{(0,Js.rR)(ws,{item:Da.GRID_SELECTED}),Bt({type:Zs.multipleCellsSelected,payload:{selection:Ca}})},lr=Ca=>{mt(Ca,Vt)};if(!rs)return(0,T.jsx)(Ks.a,{panelId:Me,fieldConfig:Ne,data:me});if(!Ka())return(0,T.jsx)(Ks.a,{panelId:Me,message:"Datagrid is not enabled",fieldConfig:Ne,data:me});if(!document.getElementById("portal")){const Ca=document.createElement("div");Ca.id="portal",document.body.appendChild(Ca)}const Kr=Fs(gs,ms);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ga.D,{className:Kr.dataEditor,getCellContent:Fn,columns:Xt,rows:rs.length,width:Ze,height:ct,initialSize:[Ze,ct],theme:os,smoothScrollX:!0,smoothScrollY:!0,overscrollY:50,onCellEdited:Ka()?Gn:void 0,getCellsForSelection:Ka()?!0:void 0,showSearch:Ka()?Nn:!1,onSearchClose:ra,gridSelection:Rn,onGridSelectionChange:Ka()?la:void 0,onRowAppended:Ka()?zs:void 0,onDelete:Ka()?Ls:void 0,rowMarkers:Ka()?ti:br,onColumnResize:sa,onColumnResizeEnd:ys,onCellContextMenu:Ka()?Cs:void 0,onHeaderContextMenu:Ka()?Gs:void 0,onHeaderMenuClick:Ka()?xa:void 0,trailingRowOptions:Le,rightElement:Ka()?(0,T.jsx)(Ya,{onColumnInputBlur:ba,divStyle:Kr.addColumnDiv}):null,rightElementProps:et,freezeColumns:rn,onRowMoved:Ka()?Ja:void 0,onColumnMoved:Ka()?ka:void 0}),nn.isContextMenuOpen&&(0,T.jsx)(Xa,{menuData:nn,data:rs,saveData:lr,closeContextMenu:is,dispatch:Bt,gridSelection:Rn,columnFreezeIndex:rn,renameColumnClicked:Wr}),on.isInputOpen?(0,T.jsx)(mr,{onColumnInputBlur:Ua,renameColumnData:on,classStyle:Kr.renameColumnInput}):null]})}const ir={selectedSeries:0},Br=new S.m(no).setPanelOptions((Z,me)=>{const Me=me.data.map((Ne,Ze)=>({value:Ze,label:Ne.refId}));return me.options&&!Me.map(Ne=>Ne.value).includes(me.options.selectedSeries??0)&&(me.options.selectedSeries=ir.selectedSeries),Z.addSelect({path:"selectedSeries",name:"Select series",defaultValue:ir.selectedSeries,settings:{options:Me}})});var il=e(1819);class Gl extends K.Component{constructor(){super(...arguments),this.subscription=new At.yU,this.state={}}componentDidMount(){const{eventBus:me}=this.props;this.subscription.add(me.subscribe(An.b_,Me=>{this.setState({event:Me})})),this.subscription.add(me.subscribe(An.ql,Me=>{this.setState({event:Me})})),this.subscription.add(me.subscribe(Dn.kb,Me=>{this.setState({event:Me})})),this.subscription.add(me.subscribe(Dn.Tq,Me=>{this.setState({event:Me})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:me}=this.state;if(!me)return(0,T.jsx)("div",{children:"no events yet"});const{type:Me,payload:Ne,origin:Ze}=me;return(0,T.jsxs)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:[(0,T.jsxs)("h3",{children:["Origin: ",Ze?.path]}),(0,T.jsxs)("span",{children:["Type: ",Me]}),!!Ne&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("pre",{children:JSON.stringify(Ne.point,null,"  ")}),Ne.data&&(0,T.jsx)(il.e,{data:Ne.data,rowIndex:Ne.rowIndex,columnIndex:Ne.columnIndex})]})]})}}var yd=e(36120);let Ro=100;class pl extends K.PureComponent{constructor(me){super(me),this.history=new yd.$({capacity:40,append:"head"}),this.eventObserver={next:Ne=>{const Ze=Ne.origin;this.history.add({key:Ro++,type:Ne.type,path:Ze?.path,payload:Ne.payload}),this.setState({counter:Ro})}},this.state={counter:Ro};const Me=[];Me.push(me.eventBus.getStream(An.b_).subscribe(this.eventObserver)),Me.push(me.eventBus.getStream(An.ql).subscribe(this.eventObserver)),Me.push(me.eventBus.getStream(An.LO).subscribe(this.eventObserver)),this.subs=Me}componentWillUnmount(){for(const me of this.subs)me.unsubscribe()}render(){return(0,T.jsx)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.history.map((me,Me)=>(0,T.jsxs)("div",{children:[JSON.stringify(me.path)," ",me.type," / X:",JSON.stringify(me.payload.x)," / Y:",JSON.stringify(me.payload.y)]},me.key))})}}var cu=e(21423),ml=e(75059);class Nh extends K.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(me){const{data:Me,options:Ne}=this.props;if(me.data!==Me&&(this.counters.dataChanged++,Ne.counters?.schemaChanged)){const Ze=me.data?.series,ct=Me.series;ct&&Ze&&((0,cu.J3)(ct,Ze,cu.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:me,options:Me}=this.props,Ne=Me.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const Ze=Date.now(),ct=Ze-this.lastRender;this.lastRender=Ze;const gt=ml.AS.get(ml.gy.lastNotNull);return(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{children:[(0,T.jsx)(fi.K,{name:"step-backward",title:"reset counters",onClick:this.resetCounters,tooltip:"Step back"}),(0,T.jsxs)("span",{children:[Ne.render&&(0,T.jsxs)("span",{children:["Render: ",this.counters.render,"\xA0"]}),Ne.dataChanged&&(0,T.jsxs)("span",{children:["Data: ",this.counters.dataChanged,"\xA0"]}),Ne.schemaChanged&&(0,T.jsxs)("span",{children:["Schema: ",this.counters.schemaChanged,"\xA0"]}),(0,T.jsxs)("span",{children:["TIME: ",ct,"ms"]})]})]}),me.series&&me.series.map((Bt,Vt)=>(0,T.jsxs)("div",{children:[(0,T.jsxs)("h4",{children:[(0,rr.Ri)(Bt,Vt)," (",Bt.length,")"]}),(0,T.jsxs)("table",{className:"filter-table",children:[(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:"Field"}),(0,T.jsx)("td",{children:"Type"}),(0,T.jsx)("td",{children:"Last"})]})}),(0,T.jsx)("tbody",{children:Bt.fields.map((Xt,nn)=>{const on=gt.reduce(Xt,!1,!1)[gt.id];return(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:(0,rr.Ct)(Xt,Bt,me.series)}),(0,T.jsx)("td",{children:Xt.type}),(0,T.jsx)("td",{children:`${on}`})]},`${nn}/${Xt.name}`)})})]})]},`${Vt}/${Bt.refId}`))]})}}var Qi=e(88575),du=e(10354);function wh(Z){const me=(0,ja.d2)(),Me=Ne=>{me.onInstanceStateChange({name:Ne.currentTarget.value})};return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Qi.D,{label:"State name",children:(0,T.jsx)(du.p,{value:me.instanceState?.name??"",onChange:Me})})})}function Fh({value:Z,context:me,onChange:Me,item:Ne}){return(0,T.jsxs)("div",{children:["Current value: ",me.instanceState?.name," "]})}var oi=(Z=>(Z.Cursor="cursor",Z.Events="events",Z.Render="render",Z.State="State",Z.ThrowError="ThrowError",Z))(oi||{});class Wh extends K.Component{render(){const{options:me}=this.props;switch(me.mode){case oi.Events:return(0,T.jsx)(pl,{eventBus:this.props.eventBus});case oi.Cursor:return(0,T.jsx)(Gl,{eventBus:this.props.eventBus});case oi.State:return(0,T.jsx)(wh,{...this.props});case oi.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return(0,T.jsx)(Nh,{...this.props})}}}const Kh=new S.m(Wh).useFieldConfig().setPanelOptions(Z=>{Z.addSelect({path:"mode",name:"Mode",defaultValue:oi.Render,settings:{options:[{label:"Render",value:oi.Render},{label:"Events",value:oi.Events},{label:"Cursor",value:oi.Cursor},{label:"Cursor",value:oi.Cursor},{label:"Share state",value:oi.State},{label:"Throw error",value:oi.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:me})=>me===oi.State,editor:Fh}).addBooleanSwitch({path:"counters.render",name:"Render count",defaultValue:!0,showIf:({mode:me})=>me===oi.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data changed count",defaultValue:!0,showIf:({mode:me})=>me===oi.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema changed count",defaultValue:!0,showIf:({mode:me})=>me===oi.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})});var Rc=e(76365),$h=e(85194);function Lc(Z,me={}){(0,Js.rR)(`grafana_flamegraph_${Z}`,{app:I.Jk.Unknown,grafana_version:R.$.buildInfo.version,...me})}const Vh=Z=>{const me=(0,Rc.oA)(Z.data.series[0]);return me?(0,T.jsx)(Ks.a,{panelId:Z.id,data:Z.data,message:(0,Rc.Ik)(me)}):(0,T.jsx)($h.A,{data:Z.data.series[0],stickyHeader:!1,getTheme:()=>R.$.theme2,showFlameGraphOnly:Z.options?.showFlameGraphOnly??!1,onTableSymbolClick:()=>Lc("table_item_selected"),onViewSelected:Me=>Lc("view_selected",{view:Me}),onTextAlignSelected:Me=>Lc("text_align_selected",{align:Me}),onTableSort:Me=>Lc("table_sort_selected",{sort:Me})})};class zh{getListWithDefaults(me){return me.getListAppender({name:ks.m.FlameGraph,pluginId:"flamegraph"})}getSuggestionsForData(me){if(!me.data)return;const Me=me.data.series[0];!Me||(0,Rc.oA)(Me)||this.getListWithDefaults(me).append({name:ks.m.FlameGraph})}}const _h=new S.m(Vh).setSuggestionsSupplier(new zh);var Hh=e(14738),kh=e(62930);const xd=(Z,me)=>{const Me="linear-gradient(to right, #5182CC 0%, #245BAF 100%)",Ne=me?Me:"linear-gradient(to right, #f05a28 0%, #fbca0a 100%)",Ze=me?Me:"linear-gradient(to right, #FBCA0A 0%, #F05A28 100%)",ct=Z.isDark?Ne:Ze;return`
      background-color: ${Z.colors.background.secondary};
      margin-right: ${Z.spacing(4)};
      border: 1px solid ${Z.colors.border.weak};
      border-bottom-left-radius: ${Z.shape.borderRadius(2)};
      border-bottom-right-radius: ${Z.shape.borderRadius(2)};
      position: relative;
      max-height: 230px;

      ${Z.breakpoints.down("xxl")} {
        margin-right: ${Z.spacing(2)};
      }
      &::before {
        display: block;
        content: ' ';
        position: absolute;
        left: 0;
        right: 0;
        height: 2px;
        top: 0;
        background-image: ${ct};
      }
`},uu=(0,se.css)`
  padding: 16px;
`,Ep=({card:Z})=>{const me=(0,Q.of)(Gh,Z.done);return(0,T.jsxs)("div",{className:me.card,children:[(0,T.jsx)("div",{className:uu,children:(0,T.jsxs)("a",{href:`${Z.href}?utm_source=grafana_gettingstarted`,className:me.url,onClick:()=>(0,Js.rR)("grafana_getting_started_docs",{title:Z.title,link:Z.href}),children:[(0,T.jsx)("div",{className:me.heading,children:Z.done?"complete":Z.heading}),(0,T.jsx)("h4",{className:me.title,children:Z.title})]})}),(0,T.jsxs)("a",{href:`${Z.learnHref}?utm_source=grafana_gettingstarted`,className:me.learnUrl,target:"_blank",rel:"noreferrer",onClick:()=>(0,Js.rR)("grafana_getting_started_docs",{title:Z.title,link:Z.learnHref}),children:["Learn how in the docs ",(0,T.jsx)(z.I,{name:"external-link-alt"})]})]})},Gh=(Z,me)=>({card:(0,se.css)`
      ${xd(Z,me)}

      min-width: 230px;

      ${Z.breakpoints.down("md")} {
        min-width: 192px;
      }
    `,heading:(0,se.css)`
      text-transform: uppercase;
      color: ${me?Z.v1.palette.blue95:"#FFB357"};
      margin-bottom: ${Z.spacing(2)};
    `,title:(0,se.css)`
      margin-bottom: ${Z.spacing(2)};
    `,url:(0,se.css)`
      display: inline-block;
    `,learnUrl:(0,se.css)`
      border-top: 1px solid ${Z.colors.border.weak};
      position: absolute;
      bottom: 0;
      padding: 8px 16px;
      width: 100%;
    `});var cc=e(33390);const Qh=({card:Z})=>{const me=(0,Q.of)(Jh,Z.done);return(0,T.jsx)("a",{className:me.card,target:"_blank",rel:"noreferrer",href:`${Z.href}?utm_source=grafana_gettingstarted`,onClick:Me=>Yh(Me,Z),children:(0,T.jsxs)("div",{className:uu,children:[(0,T.jsx)("div",{className:me.type,children:Z.type}),(0,T.jsx)("div",{className:me.heading,children:Z.done?"complete":Z.heading}),(0,T.jsx)("h4",{className:me.cardTitle,children:Z.title}),(0,T.jsx)("div",{className:me.info,children:Z.info})]})})},Yh=(Z,me)=>{Z.preventDefault(),cc.A.get(me.key)||cc.A.set(me.key,!0),(0,Js.rR)("grafana_getting_started_tutorial",{title:me.title})},Jh=(Z,me)=>({card:(0,se.css)`
      ${xd(Z,me)}
      width: 460px;
      min-width: 460px;

      ${Z.breakpoints.down("xl")} {
        min-width: 368px;
      }

      ${Z.breakpoints.down("lg")} {
        min-width: 272px;
      }
    `,type:(0,se.css)`
      color: ${Z.colors.primary.text};
      text-transform: uppercase;
    `,heading:(0,se.css)`
      text-transform: uppercase;
      color: ${Z.colors.primary.text};
      margin-bottom: ${Z.spacing(1)};
    `,cardTitle:(0,se.css)`
      margin-bottom: ${Z.spacing(2)};
    `,info:(0,se.css)`
      margin-bottom: ${Z.spacing(2)};
    `,status:(0,se.css)`
      display: flex;
      justify-content: flex-end;
    `}),Zh=({step:Z})=>{const me=(0,Q.of)(Xh);return(0,T.jsxs)("div",{className:me.setup,children:[(0,T.jsxs)("div",{className:me.info,children:[(0,T.jsx)("h2",{className:me.title,children:Z.title}),(0,T.jsx)("p",{children:Z.info})]}),(0,T.jsx)("div",{className:me.cards,children:Z.cards.map((Me,Ne)=>{const Ze=`${Me.title}-${Ne}`;return Me.type==="tutorial"?(0,T.jsx)(Qh,{card:Me},Ze):(0,T.jsx)(Ep,{card:Me},Ze)})})]})},Xh=Z=>({setup:(0,se.css)({display:"flex",width:"95%"}),info:(0,se.css)({width:"172px",marginRight:"5%",[Z.breakpoints.down("xxl")]:{marginRight:Z.spacing(4)},[Z.breakpoints.down("sm")]:{display:"none"}}),title:(0,se.css)({color:Z.v1.palette.blue95}),cards:(0,se.css)({overflowX:"auto",overflowY:"hidden",width:"100%",display:"flex",justifyContent:"flex-start"})});var qh=e(31193);const hu="Grafana fundamentals",ef="Create users and teams",fu="getting.started.",tf=`${fu}${hu.replace(" ","-").trim().toLowerCase()}`,nf=`${fu}${ef.replace(" ","-").trim().toLowerCase()}`,gu=()=>[{heading:"Welcome to Grafana",subheading:"The steps below will guide you to quickly finish setting up your Grafana installation.",title:"Basic",info:"The steps below will guide you to quickly finish setting up your Grafana installation.",done:!1,cards:[{type:"tutorial",heading:"Data source and dashboards",title:hu,info:"Set up and understand Grafana if you have no prior experience. This tutorial guides you through the entire process and covers the \u201CData source\u201D and \u201CDashboards\u201D steps to the right.",href:"https://grafana.com/tutorials/grafana-fundamentals",icon:"grafana",check:()=>Promise.resolve(cc.A.get(tf)),key:tf,done:!1},{type:"docs",title:"Add your first data source",heading:"data sources",icon:"database",learnHref:"https://grafana.com/docs/grafana/latest/features/datasources/add-a-data-source",href:"datasources/new",check:()=>new Promise(Z=>{Z((0,qh.tR)().getMetricSources().filter(me=>me.meta.builtIn!==!0).length>0)}),done:!1},{type:"docs",heading:"dashboards",title:"Create your first dashboard",icon:"apps",href:"dashboard/new",learnHref:"https://grafana.com/docs/grafana/latest/guides/getting_started/#create-a-dashboard",check:async()=>(await(0,Kt.AI)().search({limit:1})).length>0,done:!1}]},{heading:"Setup complete!",subheading:"All necessary steps to use Grafana are done. Now tackle advanced steps or make the best use of this home dashboard \u2013 it is, after all, a fully customizable dashboard \u2013 and remove this panel.",title:"Advanced",info:" Manage your users and teams and add plugins. These steps are optional",done:!1,cards:[{type:"tutorial",heading:"Users",title:"Create users and teams",info:"Learn to organize your users in teams and manage resource access and roles.",href:"https://grafana.com/tutorials/create-users-and-teams",icon:"users-alt",key:nf,check:()=>Promise.resolve(cc.A.get(nf)),done:!1},{type:"docs",heading:"plugins",title:"Find and install plugins",learnHref:"https://grafana.com/docs/grafana/latest/plugins/installation",href:"plugins",icon:"plug",check:async()=>{const Z=await(0,Kt.AI)().get("/api/plugins",{embedded:0,core:0});return Promise.resolve(Z.length>0)},done:!1}]}];class sf extends K.PureComponent{constructor(){super(...arguments),this.state={checksDone:!1,currentStep:0,steps:gu()},this.onForwardClick=()=>{(0,Js.rR)("grafana_getting_started_button_to_advanced_tutorials"),this.setState(me=>({currentStep:me.currentStep+1}))},this.onPreviousClick=()=>{(0,Js.rR)("grafana_getting_started_button_to_basic_tutorials"),this.setState(me=>({currentStep:me.currentStep-1}))},this.dismiss=()=>{const{id:me}=this.props,Me=(0,Xe.UA)().getCurrent(),Ne=Me?.getPanelById(me);(0,Js.rR)("grafana_getting_started_remove_panel"),Me?.removePanel(Ne),Kt.IB.put("/api/user/helpflags/1",void 0,{showSuccessAlert:!1}).then(Ze=>{$e.contextSrv.user.helpFlags1=Ze.helpFlags1})}}async componentDidMount(){const{steps:me}=this.state,Me=me.map(async Ze=>{const ct=Ze.cards.map(async Bt=>Bt.check().then(Vt=>({...Bt,done:Vt}))),gt=await Promise.all(ct);return{...Ze,done:gt.every(Bt=>Bt.done),cards:gt}}),Ne=await Promise.all(Me);this.setState({currentStep:Ne[0].done?1:0,steps:Ne,checksDone:!0})}render(){const{checksDone:me,currentStep:Me,steps:Ne}=this.state,Ze=af(),ct=Ne[Me];return(0,T.jsx)("div",{className:Ze.container,children:me?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(O.$n,{variant:"secondary",fill:"text",className:Ze.dismiss,onClick:this.dismiss,children:"Remove this panel"}),Me===Ne.length-1&&(0,T.jsx)(O.$n,{className:(0,se.cx)(Ze.backForwardButtons,Ze.previous),onClick:this.onPreviousClick,"aria-label":"To basic tutorials",icon:"angle-left",variant:"secondary"}),(0,T.jsx)("div",{className:Ze.content,children:(0,T.jsx)(Zh,{step:ct})}),Me<Ne.length-1&&(0,T.jsx)(O.$n,{className:(0,se.cx)(Ze.backForwardButtons,Ze.forward),onClick:this.onForwardClick,"aria-label":"To advanced tutorials",icon:"angle-right",variant:"secondary"})]}):(0,T.jsxs)("div",{className:Ze.loading,children:[(0,T.jsx)("div",{className:Ze.loadingText,children:"Checking completed setup steps"}),(0,T.jsx)(kh.y,{size:"xl",inline:!0})]})})}}const af=(0,St.N)(()=>{const Z=R.$.theme2;return{container:(0,se.css)({display:"flex",flexDirection:"column",height:"100%",backgroundSize:"cover",padding:`${Z.spacing(4)} ${Z.spacing(2)} 0`}),content:(0,se.css)({label:"content",display:"flex",justifyContent:"center",[Z.breakpoints.down("xxl")]:{marginLeft:Z.spacing(3),justifyContent:"flex-start"}}),header:(0,se.css)({label:"header",marginBottom:Z.spacing(3),display:"flex",flexDirection:"column",[Z.breakpoints.down("lg")]:{flexDirection:"row"}}),headerLogo:(0,se.css)({height:"58px",paddingRight:Z.spacing(2),display:"none",[Z.breakpoints.up("md")]:{display:"block"}}),heading:(0,se.css)({label:"heading",marginRight:Z.spacing(3),marginBottom:Z.spacing(3),flexGrow:1,display:"flex",[Z.breakpoints.up("md")]:{marginBottom:0}}),backForwardButtons:(0,se.css)({position:"absolute",top:"50%",transform:"translateY(-50%)"}),previous:(0,se.css)({left:"10px",[Z.breakpoints.down("md")]:{left:0}}),forward:(0,se.css)({right:"10px",[Z.breakpoints.down("md")]:{right:0}}),dismiss:(0,se.css)({alignSelf:"flex-end",textDecoration:"underline",marginBottom:Z.spacing(1)}),loading:(0,se.css)({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}),loadingText:(0,se.css)({marginRight:Z.spacing(1)})}}),rf=new S.m(sf).setNoPadding();var ii=e(77678),pu=e(56675),Ni=e(97706);const dc={bucketCount:30,bucketOffset:0},Ql={fillOpacity:80,gradientMode:ut.on.None,lineWidth:1};function uc(Z,me){return Math.floor(Z/me)*me}function mu(Z,me){return Math.ceil(Z/me)*me}function vu(Z){return Z.fields[0].type===Ht.PU.string?1:(0,Ni.h)(Z.fields[1].values[0]-Z.fields[0].values[0],9)}function of(Z){return Z.fields[0].type===Ht.PU.string?1:(0,Ni.h)(Z.fields[1].values[1]-Z.fields[0].values[1],9)}const lf=(Z,me)=>{let{min:Me,max:Ne}=Z.fields[2].config,Ze=new Qo.e,ct=Z.fields[0].type===Ht.PU.string,gt=vu(Z),Bt=of(Z),Vt=Bt/gt,Xt=Bt!==gt,nn=(os,Fn,Gn,ba,zs,sa)=>{let ys=os.axes[Fn]._space,is=os.valToPos(os.data[0][0]+gt,"x")-os.valToPos(os.data[0][0],"x"),Ls=uc(Me??os.data[0][0],gt),Cs=mu(Ne??os.data[0][os.data[0].length-1]+gt,gt),Gs=[],xa=Math.ceil(ys/is);for(let ka=0,Ja=Ls;Ja<=Cs;ka++,Ja+=gt)!(ka%xa)&&Gs.push(Ja);return Gs};Ze.addScale({scaleKey:"x",isTime:!1,distribution:ct?ut.L4.Ordinal:Xt?ut.L4.Log:ut.L4.Linear,log:2,orientation:ut.Lt.Horizontal,direction:ut.ON.Right,range:Xt?(os,Fn,Gn)=>Fr.A.rangeLog(Fn,Gn*Vt,2,!0):(os,Fn,Gn)=>{Me!=null&&(Fn=Me),Ne!=null&&(Gn=Ne);let ba=os.data[0][os.data[0].length-1];return Fn=mu(Fn,gt),Gn=!ct&&Gn===ba?Gn+gt:uc(Gn,gt),[Fn,Gn]}}),Ze.addScale({scaleKey:"y",isTime:!1,distribution:ut.L4.Linear,orientation:ut.Lt.Vertical,direction:ut.ON.Up,softMin:0});const on=Z.fields[0].display,Rn=os=>(0,gr.cN)(on(os));Ze.addAxis({scaleKey:"x",isTime:!1,placement:ut.vM.Bottom,incrs:ct?[1]:Xt?void 0:ii.rW,splits:Xt||ct?void 0:nn,values:ct?(os,Fn)=>Fn:(os,Fn)=>{const Gn=Fn.map(Rn),ba=Gn.reduce((is,Ls)=>Math.max((0,Hs.kD)(Ls,bs.pi).width,is),0),sa=os.bbox.width/((ba+10)*devicePixelRatio),ys=Math.ceil(Gn.length/sa);return Gn.map((is,Ls)=>Ls%ys===0?is:null)},theme:me});let Nn=Z.fields[2].display;Ze.addAxis({scaleKey:"y",isTime:!1,placement:ut.vM.Left,formatValue:(os,Fn)=>(0,gr.cN)(Nn(os,Fn)),theme:me}),Ze.setCursor({points:{show:!1},drag:{x:!0,y:!1,setScale:!0}});let ms=(0,Za.ro)(yu(Z));Ze.setStackingGroups(ms);let rs=Fr.A.paths.bars({align:1,size:[1,1/0]}),gs=0;for(let os=2;os<Z.fields.length;os++){const Fn=Z.fields[os];Fn.state=Fn.state??{},Fn.state.seriesIndex=gs++;const Gn={...Ql,...Fn.config.custom},ba="y",zs=(0,Lr.Qi)(Fn),ys=(0,Lr.lz)(Fn,me).color;Ze.addSeries({scaleKey:ba,lineWidth:Gn.lineWidth,lineColor:ys,fillOpacity:Gn.fillOpacity,theme:me,colorMode:zs,pathBuilder:rs,show:!Gn.hideFrom?.viz,gradientMode:Gn.gradientMode,thresholds:Fn.config.thresholds,hardMin:Fn.config.min,hardMax:Fn.config.max,softMin:Gn.axisSoftMin,softMax:Gn.axisSoftMax,dataFrameFieldIndex:Fn.state.origin})}return Ze},yu=Z=>({...Z,fields:Z.fields.filter(me=>me.name!==ii.dA)}),cf=(Z,me)=>{for(let Me=1;Me<me.fields.length;Me++){let Ne=me.fields[Me].values;for(let Ze=0;Ze<Ne.length;Ze++)Ne[Ze]===0&&(Ne[Ze]=null)}return(0,Za.bq)(me,Z.getStackingGroups())};class xu extends K.Component{constructor(me){super(me),this.state=this.prepState(me)}prepState(me,Me=!0){const{alignedFrame:Ne}=me,Ze=Me?lf(Ne,this.props.theme):this.state.config,ct=yu(Ne),gt=cf(Ze,ct);return{alignedFrame:Ne,alignedData:gt,config:Ze,xMinOnlyFrame:ct}}renderLegend(me){const{legend:Me}=this.props;if(!me||Me.showLegend===!1)return null;const Ne=this.props.options.combine?[this.props.alignedFrame]:this.props.rawSeries;return(0,T.jsx)(Rt.$,{data:Ne,config:me,maxHeight:"35%",maxWidth:"60%",...Me})}componentDidUpdate(me){const{structureRev:Me,alignedFrame:Ne,bucketSize:Ze,bucketCount:ct}=this.props;if(Ne!==me.alignedFrame){const gt=this.state.config==null||ct!==me.bucketCount||Ze!==me.bucketSize||this.props.options!==me.options||this.state.config===void 0||Me!==me.structureRev||!Me,Bt=this.prepState(this.props,gt);this.setState(Bt)}}render(){const{width:me,height:Me,children:Ne,alignedFrame:Ze}=this.props,{config:ct}=this.state;return ct?(0,T.jsx)(Ys.KU,{width:me,height:Me,legend:this.renderLegend(ct),children:(gt,Bt)=>(0,T.jsx)(La.Z,{config:this.state.config,data:this.state.alignedData,width:gt,height:Bt,children:Ne?Ne(ct,Ze,this.state.xMinOnlyFrame):null})}):null}}var Ed=e(11389),df=e(58749),Dd=e(52415),uf=e(10875),hf=e(21164);const Dp=({series:Z,xMinOnlyFrame:me,dataIdxs:Me,seriesIdx:Ne,mode:Ze=ut.$N.Single,sortOrder:ct=ut.xB.None,isPinned:gt,maxHeight:Bt})=>{const Vt=(0,Q.of)(Eu),Xt=Z.fields[0],nn=Z.fields[1],{display:on}=Xt.config.unit!=null?Xt:nn,{display:Rn}=nn.config.unit!=null?nn:Xt,rn=(0,gr.cN)(on(Xt.values[Me[0]])),Nn=(0,gr.cN)(Rn(nn.values[Me[1]])),ms=Xt.config.custom?.hideFrom?.tooltip?null:{label:"Bucket",value:`${rn} - ${Nn}`},rs=(0,K.useMemo)(()=>(0,uf.cp)(me.fields,Xt,Me,Ne,Ze,ct),[me.fields,Xt,Me,Ne,Ze,ct]);let gs;if(gt&&Ne!=null){const os=Z.fields[Ne],Fn=Me[Ne],Gn=(0,hf.u)(os,Fn);gs=(0,T.jsx)(df.S,{dataLinks:Gn})}return(0,T.jsxs)("div",{className:Vt.wrapper,children:[ms!=null&&(0,T.jsx)(Dd.A,{item:ms,isPinned:gt}),(0,T.jsx)(Ed.o,{items:rs,isPinned:gt,scrollable:(0,Do.T5)({mode:Ze,maxHeight:Bt}),maxHeight:Bt}),gs]})},Eu=()=>({wrapper:(0,se.css)({display:"flex",flexDirection:"column"})}),bp=({data:Z,options:me,width:Me,height:Ne})=>{const Ze=(0,Q.$j)(),ct=(0,K.useMemo)(()=>{if(!Z.series.length)return;if(Z.series.forEach((Vt,Xt)=>{Vt.fields.forEach((nn,on)=>{nn.state={...nn.state,origin:{frameIndex:Xt,fieldIndex:on}}})}),Z.series.length===1){const Vt=(0,ii.ix)(Z.series[0]);if(Vt)return(0,ii.cg)(Vt)}const Bt=(0,ii.p3)(Z.series,me);if(Bt)return(0,ii.cg)(Bt,Ze)},[Z.series,me,Ze]);if(!ct||!ct.fields.length)return(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:"No histogram found in response"})});const gt=vu(ct);return(0,T.jsx)(xu,{options:me,theme:Ze,legend:me.legend,rawSeries:Z.series,structureRev:Z.structureRev,width:Me,height:Ne,alignedFrame:ct,bucketSize:gt,bucketCount:me.bucketCount,children:(Bt,Vt,Xt)=>(0,T.jsx)(T.Fragment,{children:me.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:Bt,hoverMode:me.tooltip.mode===ut.$N.Single?Xs.b3.xOne:Xs.b3.xAll,render:(nn,on,Rn,rn=!1)=>(0,T.jsx)(Dp,{series:ct,xMinOnlyFrame:Xt,dataIdxs:on,seriesIdx:Rn,mode:me.tooltip.mode,sortOrder:me.tooltip.sort,isPinned:rn,maxHeight:me.tooltip.maxHeight}),maxWidth:me.tooltip.maxWidth})})})},Du={stacking:{mode:ut.gs.None,group:"A"}},bu=(Z,me,Me,Ne)=>{if(me==="graph"&&Me.angular.xaxis?.mode==="histogram"){const{fieldConfig:ct,options:gt}=Pu({...Me.angular,fieldConfig:Ne});return Z.fieldConfig=ct,gt}return{}};function Pu(Z){const me=Z;let Me={};const Ne={legend:{displayMode:ut.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:ut.$N.Single,sort:ut.xB.None},combine:!1};return me.stack&&(Me.stacking={mode:me.percentage?ut.gs.Percent:ut.gs.Normal,group:Du.stacking.group},Ne.combine=!1),{fieldConfig:{defaults:(0,w.omitBy)({custom:Me},w.isNil),overrides:[]},options:Ne}}function vl(Z){if(Z?.length!==1)return!1;const me=Z[0];if(me.fields.length<3||!(0,ii.NX)(me.fields[0].name)||!(0,ii.H1)(me.fields[1].name))return!1;for(const Me of me.fields)if(Me.type!==Ht.PU.number)return!1;return!0}const hc=new S.m(bp).setPanelChangeHandler(bu).setPanelOptions(Z=>{Z.addCustomEditor({id:"__calc__",path:"__calc__",name:"Values",description:"Showing frequencies that are calculated in the query",editor:()=>null,showIf:(me,Me)=>vl(Me)}).addNumberInput({path:"bucketCount",name:ii.Rt.bucketCount.name,description:ii.Rt.bucketCount.description,settings:{placeholder:`Default: ${dc.bucketCount}`,min:0},showIf:(me,Me)=>!vl(Me)}).addNumberInput({path:"bucketSize",name:ii.Rt.bucketSize.name,description:ii.Rt.bucketSize.description,settings:{placeholder:"Auto",min:0},defaultValue:dc.bucketSize,showIf:(me,Me)=>!vl(Me)}).addNumberInput({path:"bucketOffset",name:ii.Rt.bucketOffset.name,description:ii.Rt.bucketOffset.description,settings:{placeholder:`Default: ${dc.bucketOffset}`,min:0},showIf:(me,Me)=>!vl(Me)}).addBooleanSwitch({path:"combine",name:ii.Rt.combine.name,description:ii.Rt.combine.description,defaultValue:dc.combine,showIf:(me,Me)=>!vl(Me)}),fs.D(Z),ls.H(Z)}).useFieldConfig({standardOptions:{[cs.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:Zn.Y.PaletteClassic}}},useCustomConfig:Z=>{const me=Ql;Z.addCustomEditor({id:"stacking",path:"stacking",name:"Stacking",category:["Histogram"],defaultValue:Du.stacking,editor:pu.m,override:pu.m,settings:{options:pn.t.stacking},process:wt.hS,shouldApply:Me=>Me.type===Ht.PU.number,showIf:(Me,Ne)=>!vl(Ne)}).addSliderInput({path:"lineWidth",name:"Line width",defaultValue:me.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:me.fillOpacity,settings:{min:0,max:100,step:1}}).addRadio({path:"gradientMode",name:"Gradient mode",defaultValue:pn.t.fillGradient[0].value,settings:{options:pn.t.fillGradient}}),Qn.e(Z)}});var li=e(55004),fc=e(60029),ff=e(39408);const bd=[{label:"Grafana",value:li.qD.Grafana,description:"Core grafana live features"},{label:"Data Sources",value:li.qD.DataSource,description:"Data sources with live support"},{label:"Plugins",value:li.qD.Plugin,description:"Plugins with live support"},{label:"Stream",value:li.qD.Stream,description:"data streams (eg, influx style)"}];function Cu(Z){const[me,Me]=(0,K.useState)([]),[Ne,Ze]=(0,K.useMemo)(()=>{const Rn=[],rn=[],Nn=Z.value.scope,ms=Z.value.namespace;if(!Nn?.length)return[Rn,rn];const rs={};for(let gs of me){const os=(0,li.DG)(gs.value);!os||os.scope!==Nn||(rs[os.namespace]||(Rn.push({value:os.namespace,label:os.namespace}),rs[os.namespace]=!0),ms?.length&&ms===os.namespace&&rn.push({...gs,value:os.path}))}return[Rn,rn]},[me,Z.value.scope,Z.value.namespace]);(0,K.useEffect)(()=>{(0,ff.l)().then(Rn=>{Me(Rn.channels)})},[Z.value.scope]);const ct=Rn=>{Rn.value&&Z.onChange({scope:Rn.value,namespace:void 0,path:void 0})},gt=Rn=>{Z.onChange({scope:Z.value?.scope,namespace:Rn?.value,path:void 0})},Bt=Rn=>{const{value:rn,onChange:Nn}=Z;Nn({scope:rn.scope,namespace:rn.namespace,path:Rn?.value})},{scope:Vt,namespace:Xt,path:nn}=Z.value,on=pf(de.config.theme2);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(ee.F,{title:"Grafana Live",severity:"info",children:"This supports real-time event streams in grafana core. This feature is under heavy development. Expect the intefaces and structures to change as this becomes more production ready."}),(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:on.dropWrap,children:[(0,T.jsx)(fc.J,{children:"Scope"}),(0,T.jsx)(W.l6,{options:bd,value:bd.find(Rn=>Rn.value===Vt),onChange:ct})]}),Vt&&(0,T.jsxs)("div",{className:on.dropWrap,children:[(0,T.jsx)(fc.J,{children:"Namespace"}),(0,T.jsx)(W.l6,{options:Ne,value:Ne.find(Rn=>Rn.value===Xt)??(Xt?{label:Xt,value:Xt}:void 0),onChange:gt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})]}),Vt&&Xt&&(0,T.jsxs)("div",{className:on.dropWrap,children:[(0,T.jsx)(fc.J,{children:"Path"}),(0,T.jsx)(W.l6,{options:Ze,value:gf(Ze,nn),onChange:Bt,allowCustomValue:!0,backspaceRemovesValue:!0,isClearable:!0})]})]})]})}function gf(Z,me){const Me=Z.find(Ne=>Ne.value===me);if(Me)return Me;if(me)return{label:me,value:me}}const pf=(0,St.N)(Z=>({dropWrap:(0,se.css)`
    margin-bottom: ${Z.spacing(1)};
  `}));var mf=e(9631),vf=e(90708),Su=e(39070),Pd=e(78731),yf=e(24022),Ol=e(94624),yl=e(1173),xf=e(77093),jc=e(65885);function Tu(Z){const{data:me,height:Me,width:Ne,options:Ze,fieldConfig:ct,id:gt,timeRange:Bt}=Z,Vt=(0,Q.$j)(),Xt=(0,ja.d2)(),nn=(0,jc.gy)(me.series)?(0,jc.S5)(me.series):me.series,on=nn?.length,Rn=nn.some(Fn=>Fn.fields.length>0),rn=Ef(nn,Ze),Nn=nn[rn];let ms=Me;if(!on||!Rn)return(0,T.jsx)(Ks.a,{panelId:gt,fieldConfig:ct,data:me});if(on>1){const Fn=Vt.spacing.gridSize*Vt.components.height.md,Gn=Vt.spacing.gridSize;ms=Me-Fn-Gn}const rs=Xt.sync&&Xt.sync()!==Ol.y.Off,gs=(0,T.jsx)(xf.X,{height:ms,width:Ne,data:Nn,noHeader:!Ze.showHeader,showTypeIcons:Ze.showTypeIcons,resizable:!0,initialSortBy:Ze.sortBy,onSortByChange:Fn=>Df(Fn,Z),onColumnResize:(Fn,Gn)=>Il(Fn,Gn,Z),onCellFilterAdded:Xt.onAddAdHocFilter,footerOptions:Ze.footer,enablePagination:Ze.footer?.enablePagination,cellHeight:Ze.cellHeight,timeRange:Bt,enableSharedCrosshair:R.$.featureToggles.tableSharedCrosshair&&rs,fieldConfig:ct});if(on===1)return gs;const os=nn.map((Fn,Gn)=>({label:(0,rr.Ri)(Fn),value:Gn}));return(0,T.jsxs)("div",{className:Cd.wrapper,children:[gs,(0,T.jsx)("div",{className:Cd.selectWrapper,children:(0,T.jsx)(W.l6,{options:os,value:os[rn],onChange:Fn=>Mu(Fn,Z)})})]})}function Ef(Z,me){return me.frameIndex>0&&me.frameIndex<Z.length?me.frameIndex:0}function Il(Z,me,Me){const{fieldConfig:Ne}=Me,{overrides:Ze}=Ne,ct=yl.Ct.byName,gt="custom.width",Bt=Ze.find(Vt=>Vt.matcher.id===ct&&Vt.matcher.options===Z);if(Bt){const Vt=Bt.properties.find(Xt=>Xt.id===gt);Vt?Vt.value=me:Bt.properties.push({id:gt,value:me})}else Ze.push({matcher:{id:ct,options:Z},properties:[{id:gt,value:me}]});Me.onFieldConfigChange({...Ne,overrides:Ze})}function Df(Z,me){me.onOptionsChange({...me.options,sortBy:Z})}function Mu(Z,me){me.onOptionsChange({...me.options,frameIndex:Z.value||0})}const Cd={wrapper:(0,se.css)`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
  `,selectWrapper:(0,se.css)`
    padding: 8px 8px 0px 8px;
  `};var gc=e(32372),qi=(Z=>(Z.Raw="raw",Z.JSON="json",Z.Auto="auto",Z.None="none",Z))(qi||{}),wi=(Z=>(Z.None="none",Z.JSON="json",Z.Influx="influx",Z))(wi||{});function bf({height:Z,mode:me,body:Me,addr:Ne,onSave:Ze}){const ct=(0,K.useMemo)(()=>me===wi.JSON?Me?JSON.stringify(Me,null,2):"{ }":Me==null?"":`${Me}`,[me,Me]),gt=Vt=>{me===wi.JSON?Ze(JSON.parse(Vt)):Ze(Vt)},Bt=async()=>{if(me===wi.Influx){if(Ne?.scope!=="stream"){alert("expected stream scope!");return}return(0,Tn.AI)().post(`api/live/push/${Ne.namespace}`,Me)}if(!(0,li.aj)(Ne)){alert("invalid address");return}const Vt=await(0,Pd.oF)().publish(Ne,Me);console.log("onPublishClicked (response from publish)",Vt)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(gc.B,{height:Z-32,language:me===wi.JSON?"json":"text",value:ct,onBlur:gt,onSave:gt,showMiniMap:!1,showLineNumbers:!0}),(0,T.jsx)("div",{style:{height:32},children:(0,T.jsx)(O.$n,{onClick:Bt,children:"Publish"})})]})}class Pf extends K.PureComponent{constructor(me){super(me),this.styles=Cf(R.$.theme2),this.streamObserver={next:Me=>{(0,li.ew)(Me)?this.setState({status:Me,changed:Date.now()}):(0,li.Z7)(Me)?this.setState({message:Me.message,changed:Date.now()}):console.log("ignore",Me)}},this.unsubscribe=()=>{this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)},this.isValid=!!(0,Pd.oF)(),this.state={changed:0}}async componentDidMount(){this.loadChannel()}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(me){this.props.options?.channel!==me.options?.channel&&this.loadChannel()}async loadChannel(){const me=this.props.options?.channel;if(!(0,li.aj)(me)){console.log("INVALID",me),this.unsubscribe(),this.setState({addr:void 0});return}if((0,w.isEqual)(me,this.state.addr)){console.log("Same channel",this.state.addr);return}const Me=(0,Pd.oF)();if(!Me){console.log("INVALID",me),this.unsubscribe(),this.setState({addr:void 0});return}this.unsubscribe(),console.log("LOAD",me);try{this.subscription=Me.getStream(me).subscribe(this.streamObserver),this.setState({addr:me,error:void 0})}catch(Ne){this.setState({addr:void 0,error:Ne})}}renderNotEnabled(){return(0,T.jsxs)(ee.F,{title:"Grafana Live",severity:"info",children:[(0,T.jsx)("p",{children:"Grafana live requires a feature flag to run"}),(0,T.jsx)("b",{children:"custom.ini:"}),(0,T.jsx)("pre",{children:`[feature_toggles]
    enable = live`})]})}renderMessage(me){const{options:Me}=this.props,{message:Ne}=this.state;if(!Ne)return(0,T.jsxs)("div",{children:[(0,T.jsx)("h4",{children:"Waiting for data:"}),Me.channel?.scope,"/",Me.channel?.namespace,"/",Me.channel?.path]});if(Me.display===qi.JSON)return(0,T.jsx)(yf.B,{json:Ne,open:5});if(Me.display===qi.Auto&&Ne instanceof mf.k9){const Ze={series:(0,vf.we)({data:[Ne],theme:R.$.theme2,replaceVariables:gt=>gt,fieldConfig:{defaults:{},overrides:[]}}),state:Su.Gu.Streaming},ct={...this.props,options:{frameIndex:0,showHeader:!0}};return(0,T.jsx)(Tu,{...ct,data:Ze,height:me})}return(0,T.jsx)("pre",{children:JSON.stringify(Ne)})}renderPublish(me){const{options:Me}=this.props;return(0,T.jsx)(bf,{height:me,body:Me.message,mode:Me.publish??wi.JSON,onSave:Ne=>this.props.onOptionsChange({...Me,message:Ne}),addr:this.state.addr})}renderStatus(){const{status:me}=this.state;if(me?.state===li.ZF.Connected)return;let Me="";return me&&(Me=this.styles.status[me.state]),(0,T.jsx)("div",{className:(0,se.cx)(Me,this.styles.statusWrap),children:me?.state})}renderBody(){const{status:me}=this.state,{options:Me,height:Ne}=this.props;if(Me.publish===wi.JSON||Me.publish===wi.Influx){if(Me.display===qi.None)return this.renderPublish(Ne);const ct=Ne/2;return(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{style:{height:ct,overflow:"hidden"},children:(0,T.jsx)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.renderMessage(ct)})}),(0,T.jsx)("div",{children:this.renderPublish(ct)})]})}return Me.display===qi.None?(0,T.jsx)("pre",{children:JSON.stringify(me)}):(0,T.jsx)("div",{style:{overflow:"hidden",height:Ne},children:(0,T.jsx)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.renderMessage(Ne)})})}render(){if(!this.isValid)return this.renderNotEnabled();const{addr:me,error:Me}=this.state;return me?Me?(0,T.jsxs)("div",{children:[(0,T.jsx)("h2",{children:"ERROR"}),(0,T.jsx)("div",{children:JSON.stringify(Me)})]}):(0,T.jsxs)(T.Fragment,{children:[this.renderStatus(),this.renderBody()]}):(0,T.jsx)(ee.F,{title:"Grafana Live",severity:"info",children:"Use the panel editor to pick a channel"})}}const Cf=(0,St.N)(Z=>({statusWrap:(0,se.css)`
    margin: auto;
    position: absolute;
    top: 0;
    right: 0;
    background: ${Z.components.panel.background};
    padding: 10px;
    z-index: ${Z.zIndex.modal};
  `,status:{[li.ZF.Pending]:(0,se.css)`
      border: 1px solid ${Z.v1.palette.orange};
    `,[li.ZF.Connected]:(0,se.css)`
      border: 1px solid ${Z.colors.success.main};
    `,[li.ZF.Connecting]:(0,se.css)`
      border: 1px solid ${Z.v1.palette.brandWarning};
    `,[li.ZF.Disconnected]:(0,se.css)`
      border: 1px solid ${Z.colors.warning.main};
    `,[li.ZF.Shutdown]:(0,se.css)`
      border: 1px solid ${Z.colors.error.main};
    `,[li.ZF.Invalid]:(0,se.css)`
      border: 1px solid red;
    `}})),Sd=new S.m(Pf).setPanelOptions(Z=>{Z.addCustomEditor({category:["Channel"],id:"channel",path:"channel",name:"Channel",editor:Cu,defaultValue:{}}),Z.addRadio({path:"display",name:"Show message",description:"Display the last message received on this channel",settings:{options:[{value:qi.Raw,label:"Raw Text"},{value:qi.JSON,label:"JSON"},{value:qi.Auto,label:"Auto"},{value:qi.None,label:"None"}]},defaultValue:qi.JSON}).addRadio({path:"publish",name:"Publish",description:"Display a form to publish values",settings:{options:[{value:wi.None,label:"None"},{value:wi.JSON,label:"JSON"},{value:wi.Influx,label:"Influx"}]},defaultValue:wi.None})});var Al=e(9557),Ou=e(96192),Sf=e(81166),Tf=e(17888),Mf=e(7030),Of=e(93463),Iu=e(14647),Rl=e(69147);function If(Z){return typeof Z=="function"}function Au(Z){return typeof Z=="function"}function Ru(Z){return typeof Z=="function"}function Af(Z){return typeof Z=="function"}function Lu(Z){return typeof Z=="function"}var Bc=e(16817),ju=e(19347);const Rf=Z=>{const[me,Me]=(0,K.useState)(new Map);return(0,Bc.A)(async()=>{if(!Z){Me(new Map);return}const Ne=await Promise.all(Z.filter(Ze=>!!Ze.datasource?.uid).map(Ze=>(0,ju.l)().get(Ze.datasource?.uid).then(ct=>({key:Ze.refId,ds:ct}))));Me(new Map(Ne.map(({key:Ze,ds:ct})=>[Ze,ct])))},[Z]),me},Td={},Lf=({data:Z,timeZone:me,fieldConfig:Me,options:{showLabels:Ne,showTime:Ze,wrapLogMessage:ct,showCommonLabels:gt,prettifyLogMessage:Bt,sortOrder:Vt,dedupStrategy:Xt,enableLogDetails:nn,showLogContextToggle:on,onClickFilterLabel:Rn,onClickFilterOutLabel:rn,onClickFilterOutString:Nn,onClickFilterString:ms,isFilterLabelActive:rs},id:gs})=>{const os=Vt===ut.uH.Ascending,Fn=(0,Q.of)(Pp),[Gn,ba]=(0,K.useState)(0),zs=(0,K.useRef)(null),[sa,ys]=(0,K.useState)(null),is=Z.timeRange,Ls=Rf(Z.request?.targets),[Cs,Gs]=(0,K.useState)(null);let xa=(0,K.useRef)();const{eventBus:ka,onAddAdHocFilter:Ja}=(0,ja.d2)(),Wr=(0,K.useCallback)(hs=>{hs?ka.publish(new An.b_({point:{time:hs.timeEpochMs}})):ka.publish(new An.ql)},[ka]),Ua=(0,K.useCallback)(()=>{ys(null),xa.current&&xa.current()},[xa]),ra=(0,K.useCallback)((hs,Ms)=>{ys(hs),xa.current=Ms},[xa]),la=(0,K.useCallback)(async hs=>await Bu(hs,is),[is]),lr=(0,K.useCallback)(hs=>{if(!hs.dataFrame.refId||!Ls||!on&&Z.request?.app!==I.Jk.Dashboard&&Z.request?.app!==I.Jk.PanelEditor&&Z.request?.app!==I.Jk.PanelViewer)return!1;const Ms=Ls.get(hs.dataFrame.refId);return(0,Al.Ol)(Ms)},[Ls,on,Z.request?.app]),Kr=(0,K.useCallback)(()=>!(Z.request?.app!==I.Jk.Dashboard&&Z.request?.app!==I.Jk.PanelEditor&&Z.request?.app!==I.Jk.PanelViewer),[Z.request?.app]),Ca=(0,K.useCallback)(async(hs,Ms,Na)=>{if(!Ms.dataFrame.refId||!Ls)return Promise.resolve({data:[]});const Oa=Z.request?.targets[0];if(!Oa)return Promise.resolve({data:[]});const Qa=Ls.get(Ms.dataFrame.refId);return(0,Al.Ol)(Qa)?Qa.getLogRowContext(hs,Na,Oa):Promise.resolve({data:[]})},[Z.request?.targets,Ls]),va=(0,K.useCallback)((hs,Ms)=>{if(!hs.dataFrame.refId||!Ls)return(0,T.jsx)(T.Fragment,{});const Na=Z.request?.targets[0];if(!Na)return(0,T.jsx)(T.Fragment,{});const Oa=Ls.get(hs.dataFrame.refId);return(0,Al.wj)(Oa)?Oa.getLogRowContextUi?Oa.getLogRowContextUi(hs,Ms,Na):(0,T.jsx)(T.Fragment,{}):(0,T.jsx)(T.Fragment,{})},[Z.request?.targets,Ls]),[Ga,cr,sr]=(0,K.useMemo)(()=>{const hs=Z?(0,Rl.HT)(Z.series,Z.request?.intervalMs,void 0,Z.request?.targets):null,Ms=hs?.rows||[],Na=hs?.meta?.find(Qa=>Qa.label===Rl.yR),Oa=(0,Rl.M0)(Ms,Xt);return[Ms,Oa,Na]},[Z,Xt]);(0,K.useLayoutEffect)(()=>{os&&zs.current?ba(zs.current.offsetHeight):ba(0)},[os,Ga]);const vr=(0,K.useCallback)((hs,Ms)=>(0,Ou.QL)({field:hs,rowIndex:Ms,range:Z.timeRange}),[Z]),kr=(0,K.useCallback)(hs=>{Cs?.scrollTo({top:hs.offsetTop,behavior:"smooth"})},[Cs]),dr=(0,K.useCallback)((hs,Ms)=>{Ja?.({key:hs,value:Ms,operator:"="})},[Ja]),Gr=(0,K.useCallback)((hs,Ms)=>{Ja?.({key:hs,value:Ms,operator:"!="})},[Ja]);if(!Z||Ga.length===0)return(0,T.jsx)(Tf.a,{fieldConfig:Me,panelId:gs,data:Z,needsStringField:!0});const Xr=()=>(0,T.jsxs)("div",{className:(0,se.cx)(Fn.labelContainer,os&&Fn.labelContainerAscending),children:[(0,T.jsx)("span",{className:Fn.label,children:"Common labels:"}),(0,T.jsx)(Of.h,{labels:typeof sr?.value=="object"?sr?.value:Td,emptyMessage:"(no common labels)"})]}),So=Ja?dr:void 0,Qs=Ja?Gr:void 0;return(0,T.jsxs)(T.Fragment,{children:[sa&&(0,T.jsx)(Sf.V,{open:sa!==null,row:sa,onClose:Ua,getRowContext:(hs,Ms)=>Ca(hs,sa,Ms),logsSortOrder:Vt,timeZone:me,getLogRowContextUi:va}),(0,T.jsx)(ae.E,{autoHide:!0,scrollTop:Gn,scrollRefCallback:hs=>Gs(hs),children:(0,T.jsxs)("div",{className:Fn.container,ref:zs,children:[gt&&!os&&Xr(),(0,T.jsx)(Iu.k,{containerRendered:zs.current!==null,scrollIntoView:kr,permalinkedRowId:jf()?.logs?.id??void 0,onPermalinkClick:Kr()?la:void 0,logRows:Ga,showContextToggle:lr,deduplicatedRows:cr,dedupStrategy:Xt,showLabels:Ne,showTime:Ze,wrapLogMessage:ct,prettifyLogMessage:Bt,timeZone:me,getFieldLinks:vr,logsSortOrder:Vt,enableLogDetails:nn,previewLimit:os?Ga.length:void 0,onLogRowHover:Wr,app:I.Jk.Dashboard,onOpenContext:ra,onClickFilterLabel:If(Rn)?Rn:So,onClickFilterOutLabel:Au(rn)?rn:Qs,onClickFilterString:Ru(ms)?ms:void 0,onClickFilterOutString:Af(Nn)?Nn:void 0,isFilterLabelActive:Lu(rs)?rs:void 0}),gt&&os&&Xr()]})})]})},Pp=Z=>({container:(0,se.css)({marginBottom:Z.spacing(1.5)}),labelContainer:(0,se.css)({margin:Z.spacing(0,0,.5,.5),display:"flex",alignItems:"center"}),labelContainerAscending:(0,se.css)({margin:Z.spacing(.5,0,.5,0)}),label:(0,se.css)({marginRight:Z.spacing(.5),fontSize:Z.typography.bodySmall.fontSize,fontWeight:Z.typography.fontWeightMedium})});function jf(){const me=Tl.kM.getUrlSearchParams()?.panelState;if(me&&Array.isArray(me)&&me?.length>0&&typeof me[0]=="string")try{return JSON.parse(me[0])}catch(Me){console.error("error parsing logsPanelState",Me)}}async function Bu(Z,me){if(Z.rowId===void 0||!Z.dataFrame.refId)return;const Me={logs:{id:Z.uid}},Ne=new URL(window.location.href);return Ne.searchParams.set("panelState",JSON.stringify(Me)),Ne.searchParams.set("from",(0,Pn.yT)(me.from).valueOf().toString(10)),Ne.searchParams.set("to",(0,Pn.yT)(me.to).valueOf().toString(10)),await(0,Mf.VP)(Ne.toString()),Promise.resolve()}class Ll{getSuggestionsForData(me){const Me=me.getListAppender({name:"",pluginId:"logs",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}),{dataSummary:Ne}=me;!Ne.hasData||!Ne.hasTimeField||!Ne.hasStringField||(Ne.preferredVisualisationType==="logs"?Me.append({name:ks.m.Logs,score:Ft.nQ.Best}):Me.append({name:ks.m.Logs}))}}const Bf=new S.m(Lf).setPanelOptions(Z=>{Z.addBooleanSwitch({path:"showTime",name:"Time",description:"",defaultValue:!1}).addBooleanSwitch({path:"showLabels",name:"Unique labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"showCommonLabels",name:"Common labels",description:"",defaultValue:!1}).addBooleanSwitch({path:"wrapLogMessage",name:"Wrap lines",description:"",defaultValue:!1}).addBooleanSwitch({path:"prettifyLogMessage",name:"Prettify JSON",description:"",defaultValue:!1}).addBooleanSwitch({path:"enableLogDetails",name:"Enable log details",description:"",defaultValue:!0}).addRadio({path:"dedupStrategy",name:"Deduplication",description:"",settings:{options:[{value:ut.fY.none,label:"None",description:Al._C[ut.fY.none]},{value:ut.fY.exact,label:"Exact",description:Al._C[ut.fY.exact]},{value:ut.fY.numbers,label:"Numbers",description:Al._C[ut.fY.numbers]},{value:ut.fY.signature,label:"Signature",description:Al._C[ut.fY.signature]}]},defaultValue:ut.fY.none}).addRadio({path:"sortOrder",name:"Order",description:"",settings:{options:[{value:ut.uH.Descending,label:"Newest first"},{value:ut.uH.Ascending,label:"Oldest first"}]},defaultValue:ut.uH.Descending})}).setSuggestionsSupplier(new Ll);var Md=e(69386),Yl=e(62372),Uc=e(4172);function Uf(Z){const{width:me,options:{feedUrl:Me=Yl.$,showImage:Ne}}=Z,{state:Ze,getNews:ct}=(0,Uc.n)(Me);return(0,K.useEffect)(()=>{const gt=Z.eventBus.subscribe(_._,ct);return()=>{gt.unsubscribe()}},[ct,Z.eventBus]),(0,K.useEffect)(()=>{ct()},[ct]),Ze.error?(0,T.jsxs)(ee.F,{title:"Error loading RSS feed",children:["Make sure that the feed URL is correct and that CORS is configured correctly on the server. See"," ",(0,T.jsxs)("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/news/",children:["News panel documentation. ",(0,T.jsx)(z.I,{name:"external-link-alt"})]})]}):Ze.loading?(0,T.jsx)("div",{children:"Loading..."}):Ze.value?(0,T.jsx)(ae.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:Ze.value.map((gt,Bt)=>(0,T.jsx)(Md.K,{index:Bt,width:me,showImage:Ne,data:Ze.value},Bt))}):null}const Od={showImage:!0},pc=new S.m(Uf).setPanelOptions(Z=>{Z.addTextInput({path:"feedUrl",name:"URL",description:"Supports RSS and Atom feeds",settings:{placeholder:Yl.$},defaultValue:Od.feedUrl}).addBooleanSwitch({path:"showImage",name:"Show image",description:"Controls if the news item social (og:image) image is shown above text content",defaultValue:Od.showImage})});var Uu=e(56323),Cp=e(29995),Nf=e(89227),wf=e(98361),Ff=e(33434),Wf=e(44916),Nc=e(4118),Kf=e(35472),mc=e(84140),$f=e(59796),Vf=e(3139),zf=e(16797);let _f=0;const Hf=()=>_f++;function Nu(Z){const me=(0,K.useRef)(null);return me.current===null&&(me.current=Z+Hf()),me.current.toString()}var Fi=(Z=>(Z.Donut="donut",Z.Pie="pie",Z))(Fi||{}),Wi=(Z=>(Z.Name="name",Z.Percent="percent",Z.Value="value",Z))(Wi||{}),xl=(Z=>(Z.Percent="percent",Z.Value="value",Z))(xl||{});const Sp={values:[]},Tp={displayLabels:[]};function wu(Z){return!Z.field.custom?.hideFrom?.viz&&!isNaN(Z.display.numeric)}function Fu(Z,me){return me.display.numeric+Z}const kf=({fieldDisplayValues:Z,pieType:me,width:Me,height:Ne,highlightedTitle:Ze,displayLabels:ct=[],tooltipOptions:gt})=>{const Bt=(0,Q.$j)(),Vt=Nu("PieChart"),Xt=(0,Q.of)(Id),nn=(0,Nc.A)(),{containerRef:on,TooltipInPortal:Rn}=(0,Kf.A)({detectBounds:!0,scroll:!0}),rn=Z.filter(wu),Nn=zs=>zs.display.numeric,ms=zs=>`${Vt}-${(0,mc.A)(zs).toHex()}`,rs=zs=>`url(#${ms(zs)})`,gs=ct.length>0,os=gt.mode!=="none"&&nn.tooltipOpen,Fn=rn.reduce(Fu,0),Gn=Zf(Me,Ne,me),ba=[...new Set(rn.map(zs=>zs.display.color??Zn.F))];return(0,T.jsxs)("div",{className:Xt.container,children:[(0,T.jsx)("svg",{width:Gn.size,height:Gn.size,ref:on,style:{overflow:"visible"},children:(0,T.jsxs)(Ff.A,{top:Gn.position,left:Gn.position,children:[ba.map(zs=>(0,T.jsx)(wf.A,{id:ms(zs),from:Yf(zs,Bt),to:Jf(zs,Bt),fromOffset:Gn.gradientFromOffset,toOffset:"1",gradientUnits:"userSpaceOnUse",cx:0,cy:0,radius:Gn.outerRadius},zs)),(0,T.jsx)(Wf.A,{data:rn,pieValue:Nn,outerRadius:Gn.outerRadius,innerRadius:Gn.innerRadius,cornerRadius:3,padAngle:.005,children:zs=>(0,T.jsxs)(T.Fragment,{children:[zs.arcs.map(sa=>{const ys=sa.data.display.color??Zn.F,is=Vu(Ze,sa);return sa.data.hasLinks&&sa.data.getLinks?(0,T.jsx)($f.e,{links:sa.data.getLinks,children:Ls=>(0,T.jsx)(Wu,{tooltip:nn,highlightState:is,arc:sa,pie:zs,fill:rs(ys),openMenu:Ls.openMenu,tooltipOptions:gt})},sa.index):(0,T.jsx)(Wu,{highlightState:is,tooltip:nn,arc:sa,pie:zs,fill:rs(ys),tooltipOptions:gt},sa.index)}),gs&&zs.arcs.map(sa=>{const ys=Vu(Ze,sa);return(0,T.jsx)(Gf,{arc:sa,highlightState:ys,outerRadius:Gn.outerRadius,innerRadius:Gn.innerRadius,displayLabels:ct,total:Fn,color:Bt.colors.text.primary},sa.index)})]})})]})}),os?(0,T.jsx)(Rn,{top:nn.tooltipTop,className:Xt.tooltipPortal,left:nn.tooltipLeft,unstyled:!0,applyPositionStyle:!0,children:(0,T.jsx)(Vf.o,{series:nn.tooltipData})},Math.random()):null]})};function Wu({arc:Z,pie:me,highlightState:Me,openMenu:Ne,fill:Ze,tooltip:ct,tooltipOptions:gt}){const Bt=(0,Q.$j)(),Vt=(0,Q.of)(Id),{eventBus:Xt}=(0,ja.d2)(),nn=(0,K.useCallback)(rn=>{Xt?.publish({type:An.ql.type,payload:{raw:rn,x:0,y:0,dataId:Z.data.display.title}}),ct.hideTooltip()},[Xt,Z,ct]),on=(0,K.useCallback)(rn=>{Xt?.publish({type:An.b_.type,payload:{raw:rn,x:0,y:0,dataId:Z.data.display.title}});const Nn=rn.currentTarget.ownerSVGElement;if(Nn){const ms=(0,Nf.A)(Nn,rn);ct.showTooltip({tooltipLeft:ms.x,tooltipTop:ms.y,tooltipData:Ku(me,Z,gt)})}},[Xt,Z,ct,me,gt]),Rn=zu(Me,Vt);return(0,T.jsx)("g",{className:Rn,onMouseMove:gt.mode!=="none"?on:void 0,onMouseOut:nn,onClick:Ne,"data-testid":Yr.Tp.components.Panels.Visualization.PieChart.svgSlice,children:(0,T.jsx)("path",{d:me.path({...Z}),fill:Ze,stroke:Bt.colors.background.primary,strokeWidth:1})},Z.data.display.title)}function Gf({arc:Z,outerRadius:me,innerRadius:Me,displayLabels:Ne,total:Ze,color:ct,highlightState:gt}){const Bt=(0,Q.of)(Id),Vt=Me===0?me/6:Me,[Xt,nn]=Qf(Z,me,Vt);if(!(Z.endAngle-Z.startAngle>=.3))return null;let Rn=Ne.includes(Wi.Name)?Math.min(Math.max(me/150*14,12),30):Math.min(Math.max(me/100*14,12),36);return(0,T.jsx)("g",{className:zu(gt,Bt),children:(0,T.jsxs)("text",{fill:ct,x:Xt,y:nn,dy:".33em",fontSize:Rn,fontWeight:500,textAnchor:"middle",pointerEvents:"none",children:[Ne.includes(Wi.Name)&&(0,T.jsx)("tspan",{x:Xt,dy:"1.2em",children:Z.data.display.title}),Ne.includes(Wi.Value)&&(0,T.jsx)("tspan",{x:Xt,dy:"1.2em",children:(0,gr.cN)(Z.data.display)}),Ne.includes(Wi.Percent)&&(0,T.jsx)("tspan",{x:Xt,dy:"1.2em",children:(Z.data.display.numeric/Ze*100).toFixed(Z.data.field.decimals??0)+"%"})]})})}function Ku(Z,me,Me){return Me.mode==="multi"?Z.arcs.filter(Ne=>{const Ze=Ne.data.field;return Ze&&!Ze.custom?.hideFrom?.tooltip&&!Ze.custom?.hideFrom?.viz}).map(Ne=>({color:Ne.data.display.color??Zn.F,label:Ne.data.display.title,value:(0,gr.cN)(Ne.data.display),isActive:Ne.index===me.index})):[{color:me.data.display.color??Zn.F,label:me.data.display.title,value:(0,gr.cN)(me.data.display)}]}function Qf(Z,me,Me){const Ne=(me+Me)/2,Ze=(+Z.startAngle+ +Z.endAngle)/2-Math.PI/2;return[Math.cos(Ze)*Ne,Math.sin(Ze)*Ne]}function Yf(Z,me){return(0,mc.A)(Z).darken(20*(me.isDark?1:-.7)).spin(4).toRgbString()}function Jf(Z,me){return(0,mc.A)(Z).darken(10*(me.isDark?1:-.7)).spin(-4).toRgbString()}function Zf(Z,me,Me,Ne=16){const Ze=Math.min(me,Z),ct=(Ze-Ne*2)/2,gt=Me===Fi.Pie?ct:Math.max(ct/3,20),Bt=ct-gt,Vt=(Ze-Ne*2)/2,Xt=1-(ct-Bt)/ct;return{position:Vt+Ne,size:Ze,outerRadius:ct,innerRadius:Bt,gradientFromOffset:Xt}}var $u=(Z=>(Z[Z.Highlighted=0]="Highlighted",Z[Z.Deemphasized=1]="Deemphasized",Z[Z.Normal=2]="Normal",Z))($u||{});function Vu(Z,me){return Z?Z===me.data.display.title?0:1:2}function zu(Z,me){switch(Z){case 0:return me.svgArg.highlighted;case 1:return me.svgArg.deemphasized;case 2:default:return me.svgArg.normal}}const Id=Z=>({container:(0,se.css)`
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    `,svgArg:{normal:(0,se.css)`
        transition: all 200ms ease-in-out;
      `,highlighted:(0,se.css)`
        transition: all 200ms ease-in-out;
        transform: scale3d(1.03, 1.03, 1);
      `,deemphasized:(0,se.css)`
        transition: all 200ms ease-in-out;
        fill-opacity: 0.5;
      `},tooltipPortal:(0,se.css)`
      ${(0,zf.getTooltipContainerStyles)(Z)}
    `}),Xf={displayMode:ut.lm.List,showLegend:!0,placement:"right",calcs:[],values:[xl.Percent]};function qf(Z){const{data:me,timeZone:Me,fieldConfig:Ne,replaceVariables:Ze,width:ct,height:gt,options:Bt,id:Vt}=Z,Xt=(0,Q.$j)(),nn=_u(),on=(0,Uu.PI)({fieldConfig:Ne,reduceOptions:Bt.reduceOptions,data:me.series,theme:Xt,replaceVariables:Ze,timeZone:Me});return tg(on)?(0,T.jsx)(Ys.KU,{width:ct,height:gt,legend:eg(Z,on),children:(Rn,rn)=>(0,T.jsx)(kf,{width:Rn,height:rn,highlightedTitle:nn,fieldDisplayValues:on,tooltipOptions:Bt.tooltip,pieType:Bt.pieType,displayLabels:Bt.displayLabels})}):(0,T.jsx)(Ks.a,{panelId:Vt,fieldConfig:Ne,data:me})}function eg(Z,me){const Me=Z.options.legend??Xf;if(Me.showLegend===!1)return;const Ne=me.filter(wu).reduce(Fu,0),Ze=me.sort((ct,gt)=>isNaN(ct.display.numeric)?1:isNaN(gt.display.numeric)?-1:gt.display.numeric-ct.display.numeric).map((ct,gt)=>{const Bt=ct.field.custom?.hideFrom??{};if(Bt.legend)return;const Vt=!!Bt.viz,Xt=ct.display;return{label:Xt.title??"",color:Xt.color??Zn.F,yAxis:1,disabled:Vt,getItemKey:()=>(Xt.title??"")+gt,getDisplayValues:()=>{const nn=Me.values??[];let on=[];if(nn.includes(xl.Value)&&on.push({numeric:Xt.numeric,text:(0,gr.cN)(Xt),title:"Value"}),nn.includes(xl.Percent)){const Rn=Vt?0:Xt.numeric/Ne,rn=Rn*100;on.push({numeric:Rn,percent:rn,text:Vt||isNaN(Rn)?Z.fieldConfig.defaults.noValue??"-":rn.toFixed(ct.field.decimals??0)+"%",title:nn.length>1?"Percent":""})}return on}}}).filter(ct=>!!ct);return(0,T.jsx)(Ys.KU.Legend,{placement:Me.placement,width:Me.width,children:(0,T.jsx)($r.t,{items:Ze,seriesVisibilityChangeBehavior:Cp.K.Hide,placement:Me.placement,displayMode:Me.displayMode})})}function tg(Z){return Z.some(me=>me.view?.dataFrame.length)}function _u(){const[Z,me]=(0,K.useState)(),{eventBus:Me}=(0,ja.d2)();return(0,K.useEffect)(()=>{const Ne=gt=>{me(gt.payload.dataId)},Ze=gt=>{me(void 0)},ct=new At.yU;return ct.add(Me.getStream(An.b_).subscribe({next:Ne})),ct.add(Me.getStream(An.ql).subscribe({next:Ze})),()=>{ct.unsubscribe()}},[me,Me]),Z}const ng=(Z,me,Me)=>{if(me==="grafana-piechart-panel"&&Me.angular){const Ne=Me.angular,Ze=[];let ct=Z.options;if(Ne.aliasColors)for(const gt of Object.keys(Ne.aliasColors)){const Bt=Ne.aliasColors[gt];Bt&&Ze.push({matcher:{id:yl.Ct.byName,options:gt},properties:[{id:cs.uo.Color,value:{mode:Zn.Y.Fixed,fixedColor:Bt}}]})}if(Z.fieldConfig={overrides:Ze,defaults:{unit:Ne.format,decimals:Ne.decimals?Ne.decimals:0}},ct.legend={placement:"right",values:[],displayMode:ut.lm.Table,showLegend:!0,calcs:[]},Ne.valueName)switch(ct.reduceOptions={calcs:[]},Ne.valueName){case"current":ct.reduceOptions.calcs=["lastNotNull"];break;case"min":ct.reduceOptions.calcs=["min"];break;case"max":ct.reduceOptions.calcs=["max"];break;case"avg":ct.reduceOptions.calcs=["mean"];break;case"total":ct.reduceOptions.calcs=["sum"];break}switch(Ne.legendType){case"Under graph":ct.legend.placement="bottom";break;case"Right side":ct.legend.placement="right";break}switch(Ne.pieType){case"pie":ct.pieType=Fi.Pie;break;case"donut":ct.pieType=Fi.Donut;break}return Ne.legend&&(Ne.legend.show||(ct.legend.showLegend=!1),Ne.legend.values&&ct.legend.values.push(xl.Value),Ne.legend.percentage&&ct.legend.values.push(xl.Percent)),Ne.legendType==="On graph"&&(ct.legend.showLegend=!1,ct.displayLabels=[Wi.Name],Ne.legend.values&&ct.displayLabels.push(Wi.Value),Ne.legend.percentage&&ct.displayLabels.push(Wi.Percent)),ct}return{}};class Hu{getSuggestionsForData(me){const Me=me.getListAppender({name:ks.m.PieChart,pluginId:"piechart",options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},displayLabels:[Wi.Percent],legend:{calcs:[],displayMode:ut.lm.Hidden,placement:"right",values:[],showLegend:!1}}}),{dataSummary:Ne}=me;if(Ne.hasNumberField){if(Ne.hasStringField&&Ne.frameCount===1){if(Ne.rowCountTotal>30||Ne.rowCountTotal<2)return;Me.append({name:ks.m.PieChart,options:{reduceOptions:{values:!0,calcs:[]}}}),Me.append({name:ks.m.PieChartDonut,options:{reduceOptions:{values:!0,calcs:[]},pieType:Fi.Donut}});return}Ne.numberFieldCount>30||Ne.numberFieldCount<2||(Me.append({name:ks.m.PieChart}),Me.append({name:ks.m.PieChartDonut,options:{pieType:Fi.Donut}}))}}}const sg=new S.m(qf).setPanelChangeHandler(ng).useFieldConfig({disableStandardOptions:[cs.uo.Thresholds],standardOptions:{[cs.uo.Color]:{settings:{byValueSupport:!1,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:Zn.Y.PaletteClassic}}},useCustomConfig:Z=>{Qn.e(Z)}}).setPanelOptions(Z=>{(0,yo.L)(Z),Z.addRadio({name:"Piechart type",description:"How the piechart should be rendered",path:"pieType",settings:{options:[{value:Fi.Pie,label:"Pie"},{value:Fi.Donut,label:"Donut"}]},defaultValue:Fi.Pie}).addMultiSelect({name:"Labels",path:"displayLabels",description:"Select the labels to be displayed in the pie chart",settings:{options:[{value:Wi.Percent,label:"Percent"},{value:Wi.Name,label:"Name"},{value:Wi.Value,label:"Value"}]}}),fs.D(Z),ls.H(Z,!1),Z.addMultiSelect({name:"Legend values",path:"legend.values",category:["Legend"],settings:{options:[{value:xl.Percent,label:"Percent"},{value:xl.Value,label:"Value"}]},showIf:me=>me.legend.showLegend!==!1})}).setSuggestionsSupplier(new Hu);var ag=e(36373),ku=e(11082),Gu=e(34163),rg=e(49185),og=e(19384),Qu=e(82389);const ig=({series:Z,dataIdxs:me,seriesIdx:Me,mode:Ne=ut.$N.Single,sortOrder:Ze=ut.xB.None,isPinned:ct,annotate:gt,timeRange:Bt,withDuration:Vt,maxHeight:Xt})=>{const nn=(0,Q.of)(Ta.$),on=Z.fields[0],Rn=Me!=null?me[Me]:me.find(gs=>gs!=null),rn=on.display(on.values[Rn]).text;Ne=ct?ut.$N.Single:Ne;const Nn=(0,uf.cp)(Z.fields,on,me,Me,Ne,Ze);if(Vt&&Ne===ut.$N.Single){const gs=Z.fields[Me],os=(0,Er.GY)(gs,Rn);let Fn;os&&(Fn=on.values[os]);const Gn=on.values[Rn];let ba;if(Fn)ba=Fn&&(0,Er.c5)(Fn-Gn);else{const zs=Bt.to.valueOf();ba=(0,Er.c5)(zs-Gn)}Nn.push({label:"Duration",value:ba})}let ms;if(ct&&Me!=null){const gs=Z.fields[Me],os=me[Me],Fn=(0,hf.u)(gs,os);ms=(0,T.jsx)(df.S,{dataLinks:Fn,annotate:gt})}const rs={label:on.type===Ht.PU.time?"":on.state?.displayName??on.name,value:rn};return(0,T.jsxs)("div",{className:nn.wrapper,children:[(0,T.jsx)(Dd.A,{item:rs,isPinned:ct}),(0,T.jsx)(Ed.o,{items:Nn,isPinned:ct,scrollable:(0,Do.T5)({mode:Ne,maxHeight:Xt}),maxHeight:Xt}),ms]})},vc={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:ut.yL.Auto},Ad={fillOpacity:70,lineWidth:0},wc={container:(0,se.css)({display:"flex",flexDirection:"column"}),paginationContainer:(0,se.css)({display:"flex",justifyContent:"center",width:"100%"}),paginationElement:(0,se.css)({marginTop:"8px"})};function Fc(Z,me){const[Me,Ne]=(0,K.useState)(1),[Ze,{height:ct,width:gt}]=(0,rg.A)(),Bt=(0,K.useMemo)(()=>!me||Z==null?Z:(0,Er.uB)(Z),[Z,me]);if(!me||Bt==null)return{paginatedFrames:Bt,paginationRev:"disabled",paginationElement:void 0,paginationHeight:0};me||=vc.perPage;const Vt=Math.ceil(Bt.length/me),Xt=Math.min(Me,Vt),nn=(Xt-1)*me,on=Bt.slice(nn,nn+me),Rn=`${Xt}/${me}`,rn=gt<550,Nn=(0,T.jsx)("div",{className:wc.paginationContainer,ref:Ze,children:(0,T.jsx)(og.d,{className:wc.paginationElement,currentPage:Xt,numberOfPages:Vt,showSmallVersion:rn,onNavigate:Ne})});return{paginatedFrames:on,paginationRev:Rn,paginationElement:Nn,paginationHeight:ct}}const Yu=({data:Z,timeRange:me,timeZone:Me,options:Ne,width:Ze,height:ct,replaceVariables:gt,onChangeTimeRange:Bt})=>{const Vt=(0,Q.$j)(),[Xt,nn]=(0,K.useState)(null),{sync:on,eventsScope:Rn,canAddAnnotations:rn,dataLinkPostProcessor:Nn,eventBus:ms}=(0,ja.d2)(),rs=on?.()??Ol.y.Off,{frames:gs,warn:os}=(0,K.useMemo)(()=>(0,Er.Qe)(Z.series,Ne.mergeValues??!0,me,Vt),[Z.series,Ne.mergeValues,me,Vt]),{paginatedFrames:Fn,paginationRev:Gn,paginationElement:ba,paginationHeight:zs}=Fc(gs,Ne.perPage),sa=(0,K.useMemo)(()=>(0,Er.Or)(Fn,Ne.legend,Vt),[Fn,Ne.legend,Vt]),ys=(0,K.useMemo)(()=>(0,Do.Fg)(Ne.timezone,Me),[Ne.timezone,Me]);if(!Fn||os)return(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:os??"No data found in response"})});const is=!!(rn&&rn());return(0,T.jsxs)("div",{className:wc.container,children:[(0,T.jsx)(Qu.I,{theme:Vt,frames:Fn,structureRev:Z.structureRev,paginationRev:Gn,timeRange:me,timeZone:ys,width:Ze,height:ct-zs,legendItems:sa,...Ne,mode:Er.pm.Changes,replaceVariables:gt,dataLinkPostProcessor:Nn,cursorSync:rs,children:(Ls,Cs)=>(0,T.jsxs)(T.Fragment,{children:[rs!==Ol.y.Off&&(0,T.jsx)(Ti.K,{config:Ls,eventBus:ms,frame:Cs}),Ne.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:Ls,hoverMode:Ne.tooltip.mode===ut.$N.Multi?Xs.b3.xAll:Xs.b3.xOne,queryZoom:Bt,syncMode:rs,syncScope:Rn,render:(Gs,xa,ka,Ja,Wr,Ua,ra)=>{if(is&&Ua!=null){nn(Ua),Wr();return}const la=()=>{let lr=Gs.posToVal(Gs.cursor.left,"x");nn({from:lr,to:lr}),Wr()};return(0,T.jsx)(ig,{series:Cs,dataIdxs:xa,seriesIdx:ka,mode:ra?ut.$N.Multi:Ne.tooltip.mode,sortOrder:Ne.tooltip.sort,isPinned:Ja,timeRange:me,annotate:is?la:void 0,withDuration:!0,maxHeight:Ne.tooltip.maxHeight})},maxWidth:Ne.tooltip.maxWidth}),(0,T.jsx)(Qr.W,{annotations:Z.annotations??[],config:Ls,timeZone:Me,newRange:Xt,setNewRange:nn,canvasRegionRendering:!1}),(0,T.jsx)(Yn.U,{config:Ls,onChangeTimeRange:Bt})]})}),ba]})};var jl=e(25019);const Bn=(Z,me,Me)=>{let Ne=Z.options??{};if(me==="natel-discrete-panel"&&Me.angular){const Ze=Me.angular,ct=Z.fieldConfig??{defaults:{},overrides:[]};Ze.units&&(ct.defaults.unit=Ze.units);const gt={fillOpacity:100,lineWidth:0};ct.defaults.custom=gt,Ne.mergeValues=!0;const Bt={type:jl.d.ValueToText,options:{}};if(ct.defaults.mappings=[Bt],(0,w.isArray)(Ze.colorMaps))for(const Vt of Ze.colorMaps){const Xt=Vt.color;Xt&&(Bt.options[Vt.text]={color:Xt})}if((0,w.isArray)(Ze.valueMaps))for(const Vt of Ze.valueMaps){const Xt=Vt.text,nn=Vt.value;if(Xt&&nn){let on=Bt.options[nn];on?on.text=Xt:Bt.options[nn]={text:Xt}}}if((0,w.isArray)(Ze.rangeMaps))for(const Vt of Ze.rangeMaps){let Xt=+Vt.from,nn=+Vt.to;const on=Vt.text;on&&ct.defaults.mappings.push({type:jl.d.RangeToText,options:{from:Xt,to:nn,result:{text:on}}})}Z.fieldConfig=ct}return Ne};class lg{getSuggestionsForData(me){const{dataSummary:Me}=me;if(!Me.hasData||!Me.hasTimeField||!Me.hasStringField&&!Me.hasNumberField||Me.numberFieldCount>=30||Me.preferredVisualisationType==="logs")return;me.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ks.m.StateTimeline})}}const Ju=new S.m(Yu).setPanelChangeHandler(Bn).useFieldConfig({standardOptions:{[cs.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:Zn.Y.ContinuousGrYlRd}}},useCustomConfig:Z=>{Z.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:Ad.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:Ad.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",defaultValue:!1,editor:Gu.e,override:Gu.e,shouldApply:me=>me.type!==Ht.PU.time,process:wt.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",defaultValue:!1,editor:ku.Z,override:ku.Z,shouldApply:me=>me.type!==Ht.PU.time,process:wt.hS,settings:{isTime:!0}}),Qn.e(Z)}}).setPanelOptions(Z=>{Z.addBooleanSwitch({path:"mergeValues",name:"Merge equal consecutive values",defaultValue:vc.mergeValues}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:ut.yL.Auto,label:"Auto"},{value:ut.yL.Always,label:"Always"},{value:ut.yL.Never,label:"Never"}]},defaultValue:vc.showValue}).addRadio({path:"alignValue",name:"Align values",settings:{options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},defaultValue:vc.alignValue}).addSliderInput({path:"rowHeight",name:"Row height",settings:{min:0,max:1,step:.01},defaultValue:vc.rowHeight}).addNumberInput({path:"perPage",name:"Page size (enable pagination)",settings:{min:1,step:1,integer:!0}}),ls.H(Z,!1),fs.D(Z)}).setSuggestionsSupplier(new lg).setDataSupport({annotations:!0}),El=({data:Z,timeRange:me,timeZone:Me,options:Ne,width:Ze,height:ct,replaceVariables:gt,onChangeTimeRange:Bt})=>{const Vt=(0,Q.$j)(),[Xt,nn]=(0,K.useState)(null),{sync:on,eventsScope:Rn,canAddAnnotations:rn,dataLinkPostProcessor:Nn,eventBus:ms}=(0,ja.d2)(),rs=on?.()??Ol.y.Off,gs=!!(rn&&rn()),{frames:os,warn:Fn}=(0,K.useMemo)(()=>(0,Er.Qe)(Z.series,!1,me,Vt),[Z.series,me,Vt]),Gn=(0,K.useMemo)(()=>(0,Er.Or)(os,Ne.legend,Vt),[os,Ne.legend,Vt]),ba=(0,K.useMemo)(()=>(0,Do.Fg)(Ne.timezone,Me),[Ne.timezone,Me]);return!os||Fn?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:Fn??"No data found in response"})}):os[0].length>Ze/2?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsxs)("p",{children:["Too many points to visualize properly. ",(0,T.jsx)("br",{}),"Update the query to return fewer points. ",(0,T.jsx)("br",{}),"(",os[0].length," points received)"]})}):(0,T.jsx)(Qu.I,{theme:Vt,frames:os,structureRev:Z.structureRev,timeRange:me,timeZone:ba,width:Ze,height:ct,legendItems:Gn,...Ne,mode:Er.pm.Samples,replaceVariables:gt,dataLinkPostProcessor:Nn,cursorSync:rs,children:(zs,sa)=>(0,T.jsxs)(T.Fragment,{children:[rs!==Ol.y.Off&&(0,T.jsx)(Ti.K,{config:zs,eventBus:ms,frame:sa}),Ne.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:zs,hoverMode:Ne.tooltip.mode===ut.$N.Multi?Xs.b3.xAll:Xs.b3.xOne,queryZoom:Bt,syncMode:rs,syncScope:Rn,render:(ys,is,Ls,Cs,Gs,xa,ka)=>{if(gs&&xa!=null){nn(xa),Gs();return}const Ja=()=>{let Wr=ys.posToVal(ys.cursor.left,"x");nn({from:Wr,to:Wr}),Gs()};return(0,T.jsx)(ig,{series:sa,dataIdxs:is,seriesIdx:Ls,mode:ka?ut.$N.Multi:Ne.tooltip.mode,sortOrder:Ne.tooltip.sort,isPinned:Cs,timeRange:me,annotate:gs?Ja:void 0,withDuration:!1,maxHeight:Ne.tooltip.maxHeight})},maxWidth:Ne.tooltip.maxWidth}),(0,T.jsx)(Qr.W,{annotations:Z.annotations??[],config:zs,timeZone:Me,newRange:Xt,setNewRange:nn,canvasRegionRendering:!1}),(0,T.jsx)(Yn.U,{config:zs,onChangeTimeRange:Bt})]})})},Mp={colWidth:.9,rowHeight:.9,showValue:ut.yL.Auto},yc={fillOpacity:70,lineWidth:1};class cg{getSuggestionsForData(me){const{dataSummary:Me}=me;if(!Me.hasData||!Me.hasTimeField||!Me.hasStringField&&!Me.hasNumberField||Me.numberFieldCount>=30||Me.rowCountMax>100||Me.preferredVisualisationType==="logs")return;me.getListAppender({name:"",pluginId:"status-history",options:{},fieldConfig:{defaults:{color:{mode:Zn.Y.ContinuousGrYlRd},custom:{}},overrides:[]},cardOptions:{previewModifier:Ze=>{Ze.options.colWidth=.7}}}).append({name:ks.m.StatusHistory})}}const dg=new S.m(El).useFieldConfig({standardOptions:{[cs.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:Zn.Y.Thresholds}}},useCustomConfig:Z=>{Z.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:yc.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:yc.fillOpacity,settings:{min:0,max:100,step:1}}),Qn.e(Z)}}).setPanelOptions(Z=>{Z.addRadio({path:"showValue",name:"Show values",settings:{options:[{value:ut.yL.Auto,label:"Auto"},{value:ut.yL.Always,label:"Always"},{value:ut.yL.Never,label:"Never"}]},defaultValue:ut.yL.Auto}).addSliderInput({path:"rowHeight",name:"Row height",defaultValue:.9,settings:{min:0,max:1,step:.01}}).addSliderInput({path:"colWidth",name:"Column width",defaultValue:.9,settings:{min:0,max:1,step:.01}}),ls.H(Z,!1),fs.D(Z)}).setSuggestionsSupplier(new cg).setDataSupport({annotations:!0});var Zu=e(69550),Dl=e(39651),Wc=e(15292);function Rd({onChange:Z,value:me,context:Me}){const Ne=Ze=>{Ze?.currentTarget.checked&&(Me.options.footer.show=!1),Z(Ze?.currentTarget.checked)};return(0,T.jsx)(Wc.d,{value:!!me,onChange:Ne})}var el=e(39938);const Op=({cellOptions:Z,onChange:me})=>{const Me=()=>{Z.wrapText=!Z.wrapText,me(Z)},Ne=(0,T.jsxs)(fc.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,T.jsx)(el.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Qi.D,{label:Ne,children:(0,T.jsx)(Wc.d,{value:Z.wrapText,onChange:Me})})})};function Ip({cellOptions:Z,onChange:me}){const Me=Ze=>{Z.mode=Ze,me(Z)},Ne=Ze=>{Z.valueDisplayMode=Ze,me(Z)};return(0,T.jsxs)(L.B,{direction:"column",gap:0,children:[(0,T.jsx)(Qi.D,{label:"Gauge display mode",children:(0,T.jsx)(ha.z,{value:Z?.mode??ut.eX.Gradient,onChange:Me,options:Ld})}),(0,T.jsx)(Qi.D,{label:"Value display",children:(0,T.jsx)(ha.z,{value:Z?.valueDisplayMode??ut.$l.Text,onChange:Ne,options:ug})})]})}const Ld=[{value:ut.eX.Basic,label:"Basic"},{value:ut.eX.Gradient,label:"Gradient"},{value:ut.eX.Lcd,label:"Retro LCD"}],ug=[{value:ut.$l.Color,label:"Value color"},{value:ut.$l.Text,label:"Text color"},{value:ut.$l.Hidden,label:"Hidden"}],Xu=[{value:ut.Wq.Basic,label:"Basic"},{value:ut.Wq.Gradient,label:"Gradient"}],hg=({cellOptions:Z,onChange:me})=>{const Me=gt=>{Z.mode=gt,me(Z)},Ne=()=>{Z.applyToRow=!Z.applyToRow,me(Z)},Ze=()=>{Z.wrapText=!Z.wrapText,me(Z)},ct=(0,T.jsxs)(fc.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,T.jsx)(el.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Qi.D,{label:"Background display mode",children:(0,T.jsx)(ha.z,{value:Z?.mode??ut.Wq.Gradient,onChange:Me,options:Xu})}),(0,T.jsx)(Qi.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,T.jsx)(Wc.d,{value:Z.applyToRow,onChange:Ne})}),(0,T.jsx)(Qi.D,{label:ct,children:(0,T.jsx)(Wc.d,{value:Z.wrapText,onChange:Ze})})]})},fg=({cellOptions:Z,onChange:me})=>{const Me=Ze=>{Z.alt=Ze.currentTarget.value,me(Z)},Ne=Ze=>{Z.title=Ze.currentTarget.value,me(Z)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Qi.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,T.jsx)(du.p,{onChange:Me,defaultValue:Z.alt})}),(0,T.jsx)(Qi.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,T.jsx)(du.p,{onChange:Ne,defaultValue:Z.title})})]})};var qu=e(28528),Bl=e(30355);const gg=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function pg(Z){const me=(0,io.V)(Z);return{...me,useCustomConfig:Me=>{me.useCustomConfig?.(Me),Me.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const mg=Z=>{const{cellOptions:me,onChange:Me}=Z,Ne=(0,K.useMemo)(()=>{const gt=pg(Bl.t);return(0,qu.O)(gt,"ChartCell")},[]),Ze=(0,Q.of)(eh),ct={...Bl.t,...me};return(0,T.jsx)(Os.gW,{children:Ne.list(gg.map(gt=>`custom.${gt}`)).map(gt=>{if(gt.showIf&&!gt.showIf(ct))return null;const Bt=gt.editor,Vt=gt.path;return(0,T.jsx)(Qi.D,{label:gt.name,className:Ze.field,children:(0,T.jsx)(Bt,{onChange:Xt=>Me({...me,[Vt]:Xt}),value:(vg(Vt,ct)?ct[Vt]:void 0)??gt.defaultValue,item:gt,context:{data:[]}})},gt.id)})})};function vg(Z,me){return Z in me}const eh=()=>({field:(0,se.css)`
    width: 100%;

    // @TODO don't show "scheme" option for custom gradient mode.
    // it needs thresholds to work, which are not supported
    // for area chart cell right now
    [title='Use color scheme to define gradient'] {
      display: none;
    }
  `}),jd=({value:Z,onChange:me})=>{const Me=Z.type,Ne=(0,Q.of)(Jl),Ze=Ul.find(Xt=>Xt.value.type===Me);let[ct,gt]=(0,K.useState)({});const Bt=Xt=>{Xt.value!==void 0&&(Z=Xt.value,ct[Z.type]!==void 0&&Object.keys(ct[Z.type]).length>1&&(Z=(0,w.merge)(Z,ct[Z.type])),me(Z))},Vt=Xt=>{ct[Z.type]=(0,w.merge)(Z,Xt),gt(ct),me(ct[Z.type])};return(0,T.jsxs)("div",{className:Ne.fixBottomMargin,children:[(0,T.jsx)(Qi.D,{children:(0,T.jsx)(W.l6,{options:Ul,value:Ze,onChange:Bt})}),(Me===ut.ob.Auto||Me===ut.ob.ColorText)&&(0,T.jsx)(Op,{cellOptions:Z,onChange:Vt}),Me===ut.ob.Gauge&&(0,T.jsx)(Ip,{cellOptions:Z,onChange:Vt}),Me===ut.ob.ColorBackground&&(0,T.jsx)(hg,{cellOptions:Z,onChange:Vt}),Me===ut.ob.Sparkline&&(0,T.jsx)(mg,{cellOptions:Z,onChange:Vt}),Me===ut.ob.Image&&(0,T.jsx)(fg,{cellOptions:Z,onChange:Vt})]})},Ul=[{value:{type:ut.ob.Auto},label:"Auto"},{value:{type:ut.ob.Sparkline},label:"Sparkline"},{value:{type:ut.ob.ColorText},label:"Colored text"},{value:{type:ut.ob.ColorBackground},label:"Colored background"},{value:{type:ut.ob.Gauge},label:"Gauge"},{value:{type:ut.ob.DataLinks},label:"Data links"},{value:{type:ut.ob.JSONView},label:"JSON View"},{value:{type:ut.ob.Image},label:"Image"}],Jl=Z=>({fixBottomMargin:(0,se.css)({marginBottom:Z.spacing(-2)})}),Zl={cellHeight:ut.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};class yg{getSuggestionsForData(me){const Me=me.getListAppender({name:ks.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:Ne=>{Ne.fieldConfig.defaults.custom.minWidth=50}}});me.dataSummary.fieldCount===0?Me.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):Me.append({})}}const Kc="Table footer",th=["Cell options"],nh=new S.m(Tu).setPanelChangeHandler(jc.l1).setMigrationHandler(jc.fq).useFieldConfig({useCustomConfig:Z=>{Z.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:Dl.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:Dl.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:Dl.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:jd,override:jd,defaultValue:Dl.gB.cellOptions,process:wt.hS,category:th,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:th,showIf:me=>me.cellOptions.type===ut.ob.Auto||me.cellOptions.type===ut.ob.JSONView||me.cellOptions.type===ut.ob.ColorText||me.cellOptions.type===ut.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:Dl.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(Z=>{Z.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:Zl.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:Zl.cellHeight,settings:{options:[{value:ut.qM.Sm,label:"Small"},{value:ut.qM.Md,label:"Medium"},{value:ut.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[Kc],name:"Show table footer",defaultValue:Zl.footer?.show}).addCustomEditor({id:"footer.reducer",category:[Kc],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:Zu.D.get("stats-picker").editor,defaultValue:[ml.gy.sum],showIf:me=>me.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[Kc],name:"Count rows",description:"Display a single count for all data rows",defaultValue:Zl.footer?.countRows,showIf:me=>me.footer?.reducer?.length===1&&me.footer?.reducer[0]===ml.gy.count}).addMultiSelect({path:"footer.fields",category:[Kc],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async me=>{const Me=[];if(me&&me.data&&me.data.length>0){const Ne=me.data[0];for(const Ze of Ne.fields)if(Ze.type===Ht.PU.number){const ct=(0,rr.Ct)(Ze,Ne,me.data),gt=Ze.name;Me.push({value:gt,label:ct})}}return Me}},defaultValue:"",showIf:me=>me.footer?.show&&!me.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:Rd})}).setSuggestionsSupplier(new yg);var xg=e(49880),Eg=e.n(xg),$c=e(40996),sh=e(36663),gi=(Z=>(Z.Code="code",Z.HTML="html",Z.Markdown="markdown",Z))(gi||{}),ah=(Z=>(Z.Go="go",Z.Html="html",Z.Json="json",Z.Markdown="markdown",Z.Plaintext="plaintext",Z.Sql="sql",Z.Typescript="typescript",Z.Xml="xml",Z.Yaml="yaml",Z))(ah||{});const Ap="plaintext",Ki={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},Ii={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"};function Dg(Z){const me=(0,Q.of)(zc),[Me,Ne]=(0,K.useState)({mode:Z.options.mode,content:Vc(Z.options,Z.replaceVariables,de.Ay.disableSanitizeHtml)});if((0,$c.A)(()=>{const{options:Ze,replaceVariables:ct}=Z,gt=Vc(Ze,ct,de.Ay.disableSanitizeHtml);(gt!==Me.content||Ze.mode!==Me.mode)&&Ne({mode:Ze.mode,content:gt})},100,[Z]),Me.mode===gi.Code){const Ze=Z.options.code??Ki;return(0,T.jsx)(gc.B,{value:Me.content,language:Ze.language??Ki.language,width:Z.width,height:Z.height,containerStyles:me.codeEditorContainer,showMiniMap:Ze.showMiniMap,showLineNumbers:Ze.showLineNumbers,readOnly:!0},`${Ze.showLineNumbers}/${Ze.showMiniMap}`)}return(0,T.jsx)(ae.E,{autoHeightMin:"100%",className:me.containStrict,children:(0,T.jsx)(Eg(),{allowRerender:!0,html:Me.content,className:me.markdown,"data-testid":"TextPanel-converted-content"})})}function Vc(Z,me,Me){let{mode:Ne,content:Ze}=Z;if(!Ze)return" ";switch(Ze=me(Ze,{},Z.code?.language==="json"?"json":"html"),Ne){case gi.Code:break;case gi.HTML:Me||(Ze=kl.sQ.sanitizeTextPanelContent(Ze));break;case gi.Markdown:default:Ze=(0,sh.P)(Ze,{noSanitize:Me})}return Ze}const zc=Z=>({codeEditorContainer:(0,se.css)`
    .monaco-editor .margin,
    .monaco-editor-background {
      background-color: ${Z.colors.background.primary};
    }
  `,markdown:(0,se.cx)("markdown-html",(0,se.css)`
      height: 100%;
    `),containStrict:(0,se.css)({contain:"strict"})});var rh=e(70713),bg=e(99544);const xc=({value:Z,onChange:me,context:Me})=>{const Ne=(0,K.useMemo)(()=>Me.options?.mode??gi.Markdown,[Me]),Ze=(0,Q.of)(Rp),ct=()=>Me.getSuggestions?Me.getSuggestions().map(gt=>(0,bg.O)(gt)):[];return(0,T.jsx)("div",{className:(0,se.cx)(Ze.editorBox),children:(0,T.jsx)(rh.Ay,{disableHeight:!0,children:({width:gt})=>gt===0?null:(0,T.jsx)(gc.B,{value:Z,onBlur:me,onSave:me,language:Ne,width:gt,showMiniMap:!1,showLineNumbers:!1,height:"500px",getSuggestions:ct})})})},Rp=Z=>({editorBox:(0,se.css)`
    label: editorBox;
    border: 1px solid ${Z.colors.border.medium};
    border-radius: ${Z.shape.radius.default};
    margin: ${Z.spacing(.5)} 0;
    width: 100%;
  `}),Nl=Z=>{const me=parseFloat(Z.pluginVersion||"6.1");let Me=Z.options;if(Z.hasOwnProperty("content")&&Z.hasOwnProperty("mode")){const Ze=Z,ct=Ze.content,gt=Ze.mode;delete Ze.content,delete Ze.mode,me<7.1&&(Me={content:ct,mode:gt})}return[gi.Code,gi.HTML,gi.Markdown].find(Ze=>Ze===Me.mode)||(Me={...Me,mode:gi.Markdown}),Me},oh=new S.m(Dg).setPanelOptions(Z=>{Z.addRadio({path:"mode",name:"Mode",settings:{options:[{value:gi.Markdown,label:"Markdown"},{value:gi.HTML,label:"HTML"},{value:gi.Code,label:"Code"}]},defaultValue:Ii.mode}).addSelect({path:"code.language",name:"Language",settings:{options:Object.values(ah).map(me=>({value:me,label:me}))},defaultValue:Ki.language,showIf:me=>me.mode===gi.Code}).addBooleanSwitch({path:"code.showLineNumbers",name:"Show line numbers",defaultValue:Ki.showLineNumbers,showIf:me=>me.mode===gi.Code}).addBooleanSwitch({path:"code.showMiniMap",name:"Show mini map",defaultValue:Ki.showMiniMap,showIf:me=>me.mode===gi.Code}).addCustomEditor({id:"content",path:"content",name:"Content",editor:xc,defaultValue:Ii.content})}).setMigrationHandler(Nl);var Pg=e(41260),Cg=e(18282);class Sg{getSuggestionsForData(me){const{dataSummary:Me}=me;if(!Me.hasTimeField||!Me.hasNumberField||Me.rowCountTotal<2)return;const Ne=me.getListAppender({name:ks.m.LineChart,pluginId:"timeseries",options:{legend:{calcs:[],displayMode:ut.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:ct=>{ct.fieldConfig?.defaults.custom?.drawStyle!==ut.GR.Bars&&(ct.fieldConfig.defaults.custom.lineWidth=Math.max(ct.fieldConfig.defaults.custom.lineWidth??1,2))}}}),Ze=100;if(Ne.append({name:ks.m.LineChart}),Me.rowCountMax<200&&Ne.append({name:ks.m.LineChartSmooth,fieldConfig:{defaults:{custom:{lineInterpolation:ut.dx.Smooth}},overrides:[]}}),Me.numberFieldCount===1){Ne.append({name:ks.m.AreaChart,fieldConfig:{defaults:{custom:{fillOpacity:25}},overrides:[]}}),Ne.append({name:ks.m.LineChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:Zn.Y.ContinuousGrYlRd},custom:{gradientMode:ut.on.Scheme,lineInterpolation:ut.dx.Smooth,lineWidth:3,fillOpacity:20}},overrides:[]}}),Me.rowCountMax<Ze&&(Ne.append({name:ks.m.BarChart,fieldConfig:{defaults:{custom:{drawStyle:ut.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:ut.on.Hue}},overrides:[]}}),Ne.append({name:ks.m.BarChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:Zn.Y.ContinuousGrYlRd},custom:{drawStyle:ut.GR.Bars,fillOpacity:90,lineWidth:1,gradientMode:ut.on.Scheme}},overrides:[]}}));return}Ne.append({name:ks.m.AreaChartStacked,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:ut.gs.Normal,group:"A"}}},overrides:[]}}),Ne.append({name:ks.m.AreaChartStackedPercent,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:ut.gs.Percent,group:"A"}}},overrides:[]}}),Me.rowCountTotal/Me.numberFieldCount<Ze&&(Ne.append({name:ks.m.BarChartStacked,fieldConfig:{defaults:{custom:{drawStyle:ut.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:ut.on.Hue,stacking:{mode:ut.gs.Normal,group:"A"}}},overrides:[]}}),Ne.append({name:ks.m.BarChartStackedPercent,fieldConfig:{defaults:{custom:{drawStyle:ut.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:ut.on.Hue,stacking:{mode:ut.gs.Percent,group:"A"}}},overrides:[]}}))}}function Tg(Z){const me=(0,Xe.UA)().getCurrent()?.getPanelById(Z);if(me){const Me=me.transformations?[...me.transformations]:[];return Me.push({id:Cg.F.prepareTimeSeries,options:{format:"wide"}}),{name:"Transform to wide time series format",pluginId:"timeseries",transformations:Me}}}const ih=({data:Z,timeRange:me,timeZone:Me,width:Ne,height:Ze,options:ct,fieldConfig:gt,onChangeTimeRange:Bt,replaceVariables:Vt,id:Xt})=>{const{sync:nn,eventsScope:on,canAddAnnotations:Rn,onThresholdsChange:rn,canEditThresholds:Nn,showThresholds:ms,dataLinkPostProcessor:rs,eventBus:gs}=(0,ja.d2)(),os=ct.orientation===ut.wV.Vertical,Fn=(0,K.useMemo)(()=>(0,Do.B_)(Z.series,de.config.theme2,me),[Z.series,me]),Gn=(0,K.useMemo)(()=>(0,Do.Fg)(ct.timezone,Me),[ct.timezone,Me]),ba=(0,K.useMemo)(()=>{if(Fn?.length&&Fn.every(Ls=>Ls.meta?.type===Pg.m.TimeSeriesLong)){const Ls=Tg(Xt);return{message:"Long data must be converted to wide",suggestions:Ls?[Ls]:void 0}}},[Fn,Xt]),zs=!!(Rn&&Rn()),[sa,ys]=(0,K.useState)(null),is=nn?.()??Ol.y.Off;return!Fn||ba?(0,T.jsx)(Ks.a,{panelId:Xt,message:ba?.message,fieldConfig:gt,data:Z,needsTimeField:!0,needsNumberField:!0,suggestions:ba?.suggestions}):(0,T.jsx)(ao,{frames:Fn,structureRev:Z.structureRev,timeRange:me,timeZone:Gn,width:Ne,height:Ze,legend:ct.legend,options:ct,replaceVariables:Vt,dataLinkPostProcessor:rs,cursorSync:is,children:(Ls,Cs)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Xo.Z,{config:Ls}),is!==Ol.y.Off&&(0,T.jsx)(Ti.K,{config:Ls,eventBus:gs,frame:Cs}),ct.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:Ls,hoverMode:ct.tooltip.mode===ut.$N.Single?Xs.b3.xOne:Xs.b3.xAll,queryZoom:Bt,clientZoom:!0,syncMode:is,syncScope:on,render:(Gs,xa,ka,Ja=!1,Wr,Ua,ra)=>{if(zs&&Ua!=null){ys(Ua),Wr();return}const la=()=>{let lr=Gs.posToVal(Gs.cursor.left,"x");ys({from:lr,to:lr}),Wr()};return(0,T.jsx)(Ta.k,{series:Cs,dataIdxs:xa,seriesIdx:ka,mode:ra?ut.$N.Multi:ct.tooltip.mode,sortOrder:ct.tooltip.sort,isPinned:Ja,annotate:zs?la:void 0,maxHeight:ct.tooltip.maxHeight})},maxWidth:ct.tooltip.maxWidth}),!os&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Qr.W,{annotations:Z.annotations??[],config:Ls,timeZone:Me,newRange:sa,setNewRange:ys}),(0,T.jsx)(Yn.U,{config:Ls,onChangeTimeRange:Bt}),Z.annotations&&(0,T.jsx)(hn,{visibleSeries:dn(Ls,Fn),config:Ls,exemplars:Z.annotations,timeZone:Me}),(Nn&&rn||ms)&&(0,T.jsx)(_a,{config:Ls,fieldConfig:gt,onThresholdsChange:Nn?rn:void 0})]})]})})};var Bd=e(91410),lh=e(20333);const Mg=({value:Z,onChange:me})=>{const Me=(0,Q.of)(Og);(!Z||Z.length<1)&&(Z=[""]);const Ne=()=>{me([...Z,Bd.g$.default])},Ze=gt=>{const Bt=Z.slice();Bt.splice(gt,1),me(Bt)},ct=(gt,Bt)=>{const Vt=Z.slice();Vt[gt]=Bt??Bd.g$.default,Vt.length===0||Vt.length===1&&Vt[0]===""?me(void 0):me(Vt)};return(0,T.jsx)("div",{children:Z.map((gt,Bt)=>(0,T.jsxs)("div",{className:Me.wrapper,children:[(0,T.jsx)("span",{className:Me.first,children:(0,T.jsx)(lh.U,{onChange:Vt=>ct(Bt,Vt),includeInternal:!0,value:gt??Bd.g$.default})}),Bt===Z.length-1?(0,T.jsx)(fi.K,{name:"plus",onClick:Ne,tooltip:"Add timezone"}):(0,T.jsx)(fi.K,{name:"times",onClick:()=>Ze(Bt),tooltip:"Remove timezone"})]},`${Bt}.${gt}`))})},Og=Z=>({wrapper:(0,se.css)`
    width: 100%;
    display: flex;
    flex-direction: rows;
    align-items: center;
  `,first:(0,se.css)`
    margin-right: 8px;
    flex-grow: 2;
  `});var Lp=e(50082),Ec=e(74856),Ig=e(38477),Ag=e(34842),Rg=e(32023),Lg=e(68706);let _c=null;const jg=(Z,me,Me,Ne)=>{if(me==="graph"&&Me.angular){const{fieldConfig:Ze,options:ct,annotations:gt}=Xl({...Me.angular,fieldConfig:Ne,panel:Z});return gt?.length>0&&Dc(gt),Z.fieldConfig=Ze,Z.alert=Me.angular.alert,ct}return kc(Z),{}};function Xl(Z){let me=[];const Me=Z.fieldConfig?.overrides??[],Ne=Z.yaxes??[];let Ze=Hc(Ne[0]);Z.fieldConfig?.defaults&&(Ze={...Z.fieldConfig?.defaults,...Ze});const ct={fill:Z.dashes?"dash":"solid",dash:[Z.dashLength??10,Z.spaceLength??10]};if(Z.aliasColors)for(const on of Object.keys(Z.aliasColors)){const Rn=Z.aliasColors[on];Rn&&Me.push({matcher:{id:yl.Ct.byName,options:on},properties:[{id:cs.uo.Color,value:{mode:Zn.Y.Fixed,fixedColor:Rn}}]})}let gt=!1;if(Z.seriesOverrides?.length)for(const on of Z.seriesOverrides){if(!on.alias)continue;const rn={matcher:{id:/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.test(on.alias)?yl.Ct.byRegexp:yl.Ct.byName,options:on.alias},properties:[]};let Nn;for(const ms of Object.keys(on)){const rs=on[ms];switch(ms){case"alias":case"$$hashKey":break;case"yaxis":if(rs===2){const gs=Hc(Ne[1]);Bg(Ze,gs,rn.properties)}break;case"fill":rn.properties.push({id:"custom.fillOpacity",value:rs*10});break;case"fillBelowTo":gt=!0,rn.properties.push({id:"custom.fillBelowTo",value:rs});break;case"fillGradient":rs&&(rn.properties.push({id:"custom.fillGradient",value:"opacity"}),rn.properties.push({id:"custom.fillOpacity",value:rs*10}));break;case"points":rn.properties.push({id:"custom.showPoints",value:rs?ut.yL.Always:ut.yL.Never});break;case"bars":rs?(rn.properties.push({id:"custom.drawStyle",value:ut.GR.Bars}),rn.properties.push({id:"custom.fillOpacity",value:100})):rn.properties.push({id:"custom.drawStyle",value:ut.GR.Line});break;case"lines":rs?rn.properties.push({id:"custom.drawStyle",value:"line"}):rn.properties.push({id:"custom.lineWidth",value:0});break;case"linewidth":rn.properties.push({id:"custom.lineWidth",value:rs});break;case"pointradius":rn.properties.push({id:"custom.pointSize",value:2+rs*2});break;case"dashLength":case"spaceLength":case"dashes":switch(Nn||(Nn={fill:ct.fill,dash:[...ct.dash]}),ms){case"dashLength":Nn.dash[0]=rs;break;case"spaceLength":Nn.dash[1]=rs;break;case"dashes":Nn.fill=rs?"dash":"solid";break}break;case"stack":rn.properties.push({id:"custom.stacking",value:Qc(rs)});break;case"color":rn.properties.push({id:"color",value:{fixedColor:rs,mode:Zn.Y.Fixed}});break;case"transform":rn.properties.push({id:"custom.transform",value:rs==="negative-Y"?ut.NU.NegativeY:ut.NU.Constant});break;default:console.log("Ignore override migration:",on.alias,ms,rs)}}Nn&&rn.properties.push({id:"custom.lineStyle",value:Nn}),rn.properties.length&&Me.push(rn)}const Bt=Ze.custom??{};Bt.drawStyle=Z.bars?ut.GR.Bars:Z.lines?ut.GR.Line:ut.GR.Points,Z.points?(Bt.showPoints=ut.yL.Always,(0,w.isNumber)(Z.pointradius)&&(Bt.pointSize=2+Z.pointradius*2)):Bt.drawStyle!==ut.GR.Points&&(Bt.showPoints=ut.yL.Never),Bt.lineWidth=Z.linewidth,ct.fill!=="solid"&&(Bt.lineStyle=ct),gt?Bt.fillOpacity=35:(0,w.isNumber)(Z.fill)&&(Bt.fillOpacity=Z.fill*10),(0,w.isNumber)(Z.fillGradient)&&Z.fillGradient>0&&(Bt.gradientMode=ut.on.Opacity,Bt.fillOpacity=Z.fillGradient*10),Bt.spanNulls=Z.nullPointMode===Su.UW.Ignore,Z.steppedLine&&(Bt.lineInterpolation=ut.dx.StepAfter),Bt.drawStyle===ut.GR.Bars&&(Bt.fillOpacity=100),Z.stack&&(Bt.stacking={mode:Z.percentage?ut.gs.Percent:ut.gs.Normal,group:io.S.stacking.group},Z.percentage&&Z.yaxis&&(delete Ze.min,delete Ze.max,Ze.decimals===0&&delete Ze.decimals)),Ze.custom=(0,w.omitBy)(Bt,w.isNil),Ze.nullValueMode=Z.nullPointMode;const Vt={legend:{displayMode:ut.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:ut.$N.Single,sort:ut.xB.None}},Xt=Z.legend;if(Xt){if(Xt.show?Vt.legend.displayMode=Xt.alignAsTable?ut.lm.Table:ut.lm.List:Vt.legend.showLegend=!1,Xt.rightSide&&(Vt.legend.placement="right"),Z.legend.values){const on=(0,w.pickBy)(Z.legend);Vt.legend.calcs=ch(on)}Z.legend.sideWidth&&(Vt.legend.width=Z.legend.sideWidth),Xt.hideZero&&Me.push(Gc(ml.gy.allIsZero)),Xt.hideEmpty&&Me.push(Gc(ml.gy.allIsNull))}Z.timeRegions?.length&&Z.timeRegions.map((Rn,rn)=>({name:`T${rn}`,color:Rn.colorMode!=="custom"?Rn.colorMode:Rn.fillColor,line:Rn.line,fill:Rn.fill,fromDayOfWeek:Rn.fromDayOfWeek,toDayOfWeek:Rn.toDayOfWeek,from:Rn.from,to:Rn.to})).forEach((Rn,rn)=>{const Nn={datasource:{type:"datasource",uid:"grafana"},enable:!0,hide:!0,filter:{exclude:!1,ids:[Z.panel.id]},iconColor:Rn.fillColor??Rn.color,name:`Time region for panel ${Z.panel.title}${rn>0?` ${rn}`:""}`,target:{queryType:Lg.nj.TimeRegions,refId:"Anno",timeRegion:{fromDayOfWeek:Rn.fromDayOfWeek,toDayOfWeek:Rn.toDayOfWeek,from:Rn.from,to:Rn.to,timezone:"utc"}}};Rn.fill?me.push(Nn):Rn.line&&(Nn.iconColor=Rn.lineColor??"white",me.push(Nn))});const nn=Z.tooltip;if(nn&&(nn.shared!==void 0&&(Vt.tooltip.mode=nn.shared?ut.$N.Multi:ut.$N.Single),nn.sort!==void 0&&nn.shared))switch(nn.sort){case 1:Vt.tooltip.sort=ut.xB.Ascending;break;case 2:Vt.tooltip.sort=ut.xB.Descending;break;default:Vt.tooltip.sort=ut.xB.None}if(Z.thresholds&&Z.thresholds.length>0){let on=[],Rn=!1,rn=!1;const Nn=Z.thresholds.sort((rs,gs)=>rs.value>gs.value?1:-1);for(let rs=0;rs<Nn.length;rs++){const gs=Nn[rs],os=Nn.length>rs+1?Nn[rs+1]:null;gs.fill&&(Rn=!0),gs.line&&(rn=!0),gs.op==="gt"&&on.push({value:gs.value,color:Ud(gs)}),gs.op==="lt"&&(on.length===0&&on.push({value:-1/0,color:Ud(gs)}),os&&os.op==="gt"&&os.value>gs.value?on.push({value:gs.value,color:"transparent"}):os&&os.op==="lt"?on.push({value:gs.value,color:Ud(os)}):on.push({value:gs.value,color:"transparent"}))}on.length>0&&on[0].value!==-1/0&&on.unshift({color:"transparent",value:-1/0});let ms=Rn?ut.Ly.Area:ut.Ly.Line;rn&&Rn&&(ms=ut.Ly.LineAndArea),Ze.custom.thresholdsStyle={mode:ms},Ze.thresholds={mode:Lp.O.Absolute,steps:on}}return Z.xaxis&&Z.xaxis.show===!1&&Z.xaxis.mode==="time"&&Me.push({matcher:{id:yl.Ct.byType,options:Ht.PU.time},properties:[{id:"custom.axisPlacement",value:ut.vM.Hidden}]}),{fieldConfig:{defaults:(0,w.omitBy)(Ze,w.isNil),overrides:Me},options:Vt,annotations:me}}function Ud(Z){return Z.colorMode==="critical"?"red":Z.colorMode==="warning"?"orange":Z.colorMode==="custom"?Z.fillColor||Z.lineColor:"red"}function Hc(Z){if(!Z)return{};const me={axisPlacement:Z.show?ut.vM.Auto:ut.vM.Hidden};if(Z.label&&(me.axisLabel=Z.label),Z.logBase){const Me=Z.logBase;(Me===2||Me===10)&&(me.scaleDistribution={type:ut.L4.Log,log:Me})}return(0,w.omitBy)({unit:Z.format,decimals:Nd(Z.decimals),min:Nd(Z.min),max:Nd(Z.max),custom:me},w.isNil)}function Bg(Z,me,Me){for(const[ct,gt]of Object.entries(me))ct!=="custom"&&gt!==Z[ct]&&Me.push({id:ct,value:gt});Me.push({id:"custom.axisPlacement",value:ut.vM.Right});const Ne=Z.custom??{},Ze=me.custom??{};for(const[ct,gt]of Object.entries(Ze))gt!==Ne[ct]&&Me.push({id:`custom.${ct}`,value:gt})}function Nd(Z){if((0,w.isNumber)(Z))return Z;if((0,w.isString)(Z)){const me=Number(Z);if(!isNaN(me))return me}}function ch(Z){const me=[];for(const Me in Z){const Ne=ml.AS.getIfExists(Me);Ne&&me.push(Ne.id)}return me}function kc(Z){Z.fieldConfig?.defaults?.custom?.hideFrom?.graph!==void 0&&(Z.fieldConfig.defaults.custom.hideFrom.viz=Z.fieldConfig.defaults.custom.hideFrom.graph,delete Z.fieldConfig.defaults.custom.hideFrom.graph),Z.fieldConfig?.overrides&&(Z.fieldConfig.overrides=Z.fieldConfig.overrides.map(me=>(me.properties=me.properties.map(Me=>(Me.id==="custom.hideFrom"&&Me.value.graph&&(Me.value.viz=Me.value.graph,delete Me.value.graph),Me)),me)))}function Gc(Z){return{matcher:{id:yl.Ct.byValue,options:{reducer:Z,op:ut.zT.GTE,value:0}},properties:[{id:"custom.hideFrom",value:{tooltip:!0,viz:!1,legend:!0}}]}}function Qc(Z){const me=io.S.stacking?.group;return{mode:Z?ut.gs.Normal:ut.gs.None,group:(0,w.isString)(Z)?Z:me}}function Dc(Z){const me=window.__grafanaSceneContext;if(me instanceof Ag.H$){const Ne=Rg.b4.getDataLayers(me),Ze=[...Ne.state.annotationLayers];for(let ct of Z){const gt=new Ig.g({key:`annotations-${ct.name}`,query:ct,name:ct.name,isEnabled:ct.enable,isHidden:ct.hide});Ze.push(gt)}Ne.setState({annotationLayers:Ze});return}const Me=(0,Xe.UA)().getCurrent();Me&&(Me.annotations.list=[...Me.annotations.list,...Z],_c==null&&(_c=setTimeout(()=>{_c=null,(0,Ec.jG)().refreshTimeModel()})))}const dh=new S.m(ih).setPanelChangeHandler(jg).useFieldConfig((0,io.V)(io.S)).setPanelOptions(Z=>{fs.D(Z,!1,!0),ls.H(Z),Z.addCustomEditor({id:"timezone",name:"Time zone",path:"timezone",category:["Axis"],editor:Mg,defaultValue:void 0})}).setSuggestionsSupplier(new Sg).setDataSupport({annotations:!0,alertStates:!0});var Ug=e(92599),Yc=e(35090);const mo={wrapper:(0,se.css)`
    height: 100%;
    overflow: scroll;
  `},bc=({data:Z,options:me})=>{const Me=(0,K.createRef)(),Ne=(0,K.useMemo)(()=>(0,Yc.L)(Z.series[0]),[Z.series]),Ze=(0,Bc.A)(async()=>await(0,ju.l)().get(Z.request?.targets[0].datasource?.uid));return!Z||!Z.series.length||!Ne?(0,T.jsx)("div",{className:"panel-empty",children:(0,T.jsx)("p",{children:"No data found in response"})}):(0,T.jsxs)("div",{className:mo.wrapper,children:[(0,T.jsx)("div",{ref:Me}),(0,T.jsx)(Ug.V,{dataFrames:Z.series,scrollElementClass:mo.wrapper,traceProp:Ne,datasource:Ze.value,topOfViewRef:Me,createSpanLink:me.createSpanLink,focusedSpanId:me.focusedSpanId,createFocusSpanLink:me.createFocusSpanLink})]})};class Eo{getListWithDefaults(me){return me.getListAppender({name:ks.m.Trace,pluginId:"traces"})}getSuggestionsForData(me){!me.data||!me.data.series[0]||me.data.series[0].meta?.preferredVisualisationType==="trace"&&this.getListWithDefaults(me).append({name:ks.m.Trace,score:Ft.nQ.Best})}}const Ng=new S.m(bc).setSuggestionsSupplier(new Eo);var uh=e(85200),wg=e(40458);const hh=({data:Z,timeRange:me,timeZone:Me,width:Ne,height:Ze,options:ct,fieldConfig:gt,replaceVariables:Bt,id:Vt})=>{const{dataLinkPostProcessor:Xt}=(0,ja.d2)(),nn=ct.xField??Z.series[0].fields.find(rn=>rn.type===Ht.PU.number)?.name,on=(rn,Nn,ms)=>(Nn={...Nn,x:uh.sJ.get(yl.Ct.byName).get(nn)},(0,wg.m)(rn,Nn)),Rn=(0,K.useMemo)(()=>{if(Z.series.length>1)return{warning:"Only one frame is supported, consider adding a join transformation",frames:Z.series};let rn=Z.series,Nn;if(ct.xField){if(Nn=(0,da.findFieldIndex)(ct.xField,rn[0]),Nn==null)return{warning:"Unable to find field: "+ct.xField,frames:Z.series}}else if(Nn=rn[0].fields.findIndex(ms=>ms.type===Ht.PU.number),Nn===-1)return{warning:"No numeric fields found for X axis",frames:rn};if(Nn!=null){const ms=rn[0].fields[Nn];if(ms.type===Ht.PU.number&&!(0,fo.g2)(ms.values))return{warning:"Values must be in ascending order",frames:rn}}return{frames:(0,Do.B_)(rn,R.$.theme2,void 0,Nn)}},[Z.series,ct.xField]);return Rn.warning||!Rn.frames?(0,T.jsx)(Ks.a,{panelId:Vt,fieldConfig:gt,data:Z,message:Rn.warning,needsNumberField:!0}):(0,T.jsx)(ao,{frames:Rn.frames,structureRev:Z.structureRev,timeRange:me,timeZone:Me,width:Ne,height:Ze,legend:ct.legend,options:ct,preparePlotFrame:on,replaceVariables:Bt,dataLinkPostProcessor:Xt,children:(rn,Nn)=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Xo.Z,{config:rn}),ct.tooltip.mode!==ut.$N.None&&(0,T.jsx)(Xs.xl,{config:rn,hoverMode:ct.tooltip.mode===ut.$N.Single?Xs.b3.xOne:Xs.b3.xAll,render:(ms,rs,gs,os=!1)=>(0,T.jsx)(Ta.k,{series:Nn,dataIdxs:rs,seriesIdx:gs,mode:ct.tooltip.mode,sortOrder:ct.tooltip.sort,isPinned:os,maxHeight:ct.tooltip.maxHeight}),maxWidth:ct.tooltip.maxWidth})]})})};class Fg{getSuggestionsForData(me){const{dataSummary:Me}=me;return Me.numberFieldCount<2||Me.rowCountTotal<2||Me.rowCountTotal<2?void 0:me.getListAppender({name:ks.m.LineChart,pluginId:"trend",options:{legend:{calcs:[],displayMode:ut.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:Ze=>{Ze.fieldConfig?.defaults.custom?.drawStyle!==ut.GR.Bars&&(Ze.fieldConfig.defaults.custom.lineWidth=Math.max(Ze.fieldConfig.defaults.custom.lineWidth??1,2))}}})}}const wd=new S.m(hh).useFieldConfig((0,io.V)(io.S,!1)).setPanelOptions(Z=>{const me=["X axis"];Z.addFieldNamePicker({path:"xField",name:"X field",description:"An increasing numeric value",category:me,defaultValue:void 0,settings:{isClearable:!0,placeholderText:"First numeric value",filter:Me=>Me.type===Ht.PU.number}}),fs.D(Z,!1,!0),ls.H(Z)}).setSuggestionsSupplier(new Fg),jp=[{value:0,label:"Documentation",href:"https://grafana.com/docs/grafana/latest"},{value:1,label:"Tutorials",href:"https://grafana.com/tutorials"},{value:2,label:"Community",href:"https://community.grafana.com"},{value:3,label:"Public Slack",href:"http://slack.grafana.com"}],Bp=()=>{const Z=(0,Q.of)(fh);return(0,T.jsxs)("div",{className:Z.container,children:[(0,T.jsx)("h1",{className:Z.title,children:"Welcome to Grafana"}),(0,T.jsxs)("div",{className:Z.help,children:[(0,T.jsx)("h3",{className:Z.helpText,children:"Need help?"}),(0,T.jsx)("div",{className:Z.helpLinks,children:jp.map((me,Me)=>(0,T.jsx)("a",{className:Z.helpLink,href:`${me.href}?utm_source=grafana_gettingstarted`,children:me.label},`${me.label}-${Me}`))})]})]})},fh=Z=>({container:(0,se.css)`
      display: flex;
      /// background: url(public/img/g8_home_v2.svg) no-repeat;
      background-size: cover;
      height: 100%;
      align-items: center;
      padding: 0 16px;
      justify-content: space-between;
      padding: 0 ${Z.spacing(3)};

      ${Z.breakpoints.down("lg")} {
        background-position: 0px;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
      }

      ${Z.breakpoints.down("sm")} {
        padding: 0 ${Z.spacing(1)};
      }
    `,title:(0,se.css)`
      margin-bottom: 0;

      ${Z.breakpoints.down("lg")} {
        margin-bottom: ${Z.spacing(1)};
      }

      ${Z.breakpoints.down("md")} {
        font-size: ${Z.typography.h2.fontSize};
      }
      ${Z.breakpoints.down("sm")} {
        font-size: ${Z.typography.h3.fontSize};
      }
    `,help:(0,se.css)`
      display: flex;
      align-items: baseline;
    `,helpText:(0,se.css)`
      margin-right: ${Z.spacing(2)};
      margin-bottom: 0;

      ${Z.breakpoints.down("md")} {
        font-size: ${Z.typography.h4.fontSize};
      }

      ${Z.breakpoints.down("sm")} {
        display: none;
      }
    `,helpLinks:(0,se.css)`
      display: flex;
      flex-wrap: wrap;
    `,helpLink:(0,se.css)`
      margin-right: ${Z.spacing(2)};
      text-decoration: underline;
      text-wrap: no-wrap;

      ${Z.breakpoints.down("sm")} {
        margin-right: 8px;
      }
    `}),gh=new S.m(Bp).setNoPadding(),vh={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(9045),e.e(2651),e.e(3766)]).then(e.bind(e,92651)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(9045),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7774),e.e(9404)]).then(e.bind(e,21106)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(9430),e.e(1477)]).then(e.bind(e,27049)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/mssql":async()=>await Promise.all([e.e(7774),e.e(9040)]).then(e.bind(e,56694)),"core:plugin/prometheus":async()=>await Promise.all([e.e(9045),e.e(6144),e.e(8314),e.e(9546)]).then(e.bind(e,88314)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(9045),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":y,"core:plugin/timeseries":b,"core:plugin/trend":P,"core:plugin/state-timeline":f,"core:plugin/status-history":E,"core:plugin/candlestick":i,"core:plugin/graph":async()=>await Promise.all([e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>R.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(1698),e.e(707),e.e(7734),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,44210)),"core:plugin/dashlist":g,"core:plugin/alertlist":n,"core:plugin/annolist":s,"core:plugin/heatmap":async()=>await Promise.all([e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":h,"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":v,"core:plugin/live":u,"core:plugin/stat":ag,"core:plugin/datagrid":o,"core:plugin/debug":d,"core:plugin/flamegraph":c,"core:plugin/gettingstarted":a,"core:plugin/gauge":Hh,"core:plugin/piechart":x,"core:plugin/bargauge":r,"core:plugin/barchart":l,"core:plugin/logs":m,"core:plugin/traces":D,"core:plugin/welcome":C,"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":p};var wl=e(81900),Xc=e(63770),Fd=e(52762),qc=e(20582),Yi=e(21313),zg=e(72635),Cc=e(34796),Wd=e.n(Cc),yh=e(95093),Kd=e.n(yh),ed=e(28848),$d=e.n(ed),td=e(40961),Vd=e(8867),ni=e(71468),_g=e(54625),Hg=e(24160),ql=e(14644),kg=e(75091),Gg=e(32975),Qg=e(82611),Yg=e(52845),ec=e(29317),Sa=e(54087),nd=e(80851),Jg=e(32176),zd=e(31221),bl=e(91520),Zg=e(92275),Xg=e(82013),_d=e(2341),Hr=e(19538),tc=e(33459),xh=e(85858),kp=e(7117),qg=e(8984),Sc=e(91950),Eh=e(31140),Hd=e(78827),sd=e(68576),Dh=e(92247);const Fl=qg;Fl.PanelPlugin=S.m,Fl.DataSourcePlugin=M.tD,Fl.AppPlugin=I.hX,Fl.DataSourceApi=M.mA;const ad=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((Z,me)=>({...Z,[me]:{fakeDep:1}}),{}),ep={"@emotion/css":se,"@emotion/react":Fd,"@grafana/data":tc,"@grafana/runtime":kp,"@grafana/slate-react":ec.Ay,"@grafana/ui":Fl,"@kusto/monaco-kusto":qc,"app/core/app_events":{default:$e.lE,__useDefault:!0},"app/core/config":{default:de.Ay,__useDefault:!0},"app/core/core":{appEvents:$e.lE,contextSrv:$e.contextSrv},"app/core/services/backend_srv":{BackendSrv:Kt.Mf,getBackendSrv:Kt.AI},"app/core/table_model":{default:Sc.A,__useDefault:!0},"app/core/time_series":{default:Eh.A,__useDefault:!0},"app/core/time_series2":{default:Eh.A,__useDefault:!0},"app/core/utils/datemath":xh,"app/core/utils/flatten":Hd,"app/core/utils/kbn":{default:sd.A,__useDefault:!0},"app/core/utils/ticks":Dh,"app/features/dashboard/impression_store":{impressions:en.A},d3:Yi,emotion:se,i18next:zg,jquery:{default:Wd(),__useDefault:!0},...ad,lodash:{default:B(),__useDefault:!0},moment:{default:Kd(),__useDefault:!0},prismjs:$d(),react:K,"react-dom":td,"react-inlinesvg":Vd,"react-redux":ni,"react-router-dom":_g,"react-router":Hg,redux:ql,rxjs:kg,"rxjs/operators":Gg,slate:Qg.Ay,"slate-plain-serializer":Yg.A,"slate-react":ec.Ay};function nc({url:Z,source:me,transformSourceMapURL:Me=!1,transformAssets:Ne=!0}){const Ze=Z.split("/public/plugins/"),ct=Ze[0],gt=Ze[1].split("/")[0];let Bt=me;return Ne&&(Bt=Bt.replace(/(\/?)(public\/plugins)/g,`${ct}/$2`),Bt=Bt.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${ct}/public/$2$3`)),Me&&(Bt=Bt.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${ct}/public/plugins/${gt}/$2.map`)),Bt}var Tc=e(45179),Pl=e(94429);async function ll(Z,me,Me){const Ne=await Z(me,Me),Ze=Ne.headers.get("content-type")||"";if(Tc.Bu.test(Ze)){let gt=await Ne.text();if((0,Pl.OD)(Ne.url)){const Bt=nc({url:Ne.url,source:gt});return new Response(new Blob([Bt],{type:"text/javascript"}))}return new Response(new Blob([gt],{type:"text/javascript"}))}return Ne}function rd(Z,me,Me){try{const Ne=Z.apply(this,[me,Me]),Ze=Gp(Ne);return(Ze.endsWith(".js")||Ze.endsWith(".css"))&&!(0,Pl.OD)(Ze)?(0,wl.ni)(Ze):Ze}catch{if(Tc.$b.test(me)){const Ze=`${R.$.appSubUrl??""}/public/${me}`,ct=Z.apply(this,[Ze,Me]);return(0,wl.ni)(ct)}return console.warn(`SystemJS: failed to resolve '${me}'`),me}}function Mc(Z,me){if(new URL(me,window.location.origin).pathname.endsWith(".css")&&!Z){const Ze=Xc.z.get(me)?.default;Ze&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,Ze])}}function Gp(Z){return Z.startsWith(`${Tc.XV}:`)?Z:(Z.endsWith("!")&&(Z=Z.slice(0,-1)),["css","js","json","wasm"].some(Ne=>Z.endsWith(Ne))?Z:Z+".js")}var bh=e(22055),Ph=e(6262),Ch=e(35853),Wl=e(43429);function sc(Z){const me=new URL(window.location.href),Me=new URL(Z);return me.host===Me.host}async function kd(Z,me){let Me="";if(sc(Z)?(Me=await(await fetch(Z)).text(),Me=nc({url:Z,source:Me,transformSourceMapURL:!0,transformAssets:!1})):(0,Pl.OD)(Z)&&(Me=await(await fetch(Z)).text(),Me=nc({url:Z,source:Me,transformSourceMapURL:!0,transformAssets:!0})),Me.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Me=od(Me),me.evaluate(Me)}async function Sh(Z){if((0,Pl.OD)(Z.module)){const me=Z.module;let Ne=await(await fetch(me)).text();return Ne=nc({url:me,source:Ne,transformSourceMapURL:!0,transformAssets:!0}),Ne}else{let me=(0,Pl.Av)(Z.module);const Me=(0,wl.ni)(me);let Ze=await(await fetch(Me)).text();return Ze=nc({url:Me,source:Ze,transformSourceMapURL:!0,transformAssets:!1}),Ze=od(Ze),Ze}}function od(Z){return Z.replace(/window\.location/gi,"window.locationSandbox")}function Gd(Z){Z.evaluate(`${Ch.V.toString()};${Ch.V.name}()`)}function Th(Z){for(const me of Object.values(R.$.datasources))if(me.type===Z)return me.meta;for(const me of Object.values(R.$.panels))if(me.id===Z)return me;for(const me of Object.values(R.$.apps))if(me.id===Z)return{id:Z,type:Wl.QE.app,module:me.path};throw new Error(`Could not find plugin ${Z}`)}const cl=["iframe"];var id=e(7077),ld=e(29505),tp=e(34867),Qd=e(27716);const Yd=!!R.$.featureToggles.frontendSandboxMonitorOnly;function Mh(Z){return!!Z&&typeof Z=="object"&&Z?.hasOwnProperty("plugin")}function cd(Z){throw new Error(`Unexpected object: ${Z}. This should never happen.`)}const dd=(0,tp.DW)("sandbox",{monitorOnly:String(Yd)});function np(Z){return Z instanceof K.Component}function $i(Z,me){dd.logWarning(Z,me)}function Fo(Z,me){dd.logError(Z,me)}function ko(Z,me){dd.logInfo(Z,me)}async function Jd({isAngular:Z,pluginId:me}){if(!R.$.featureToggles.pluginsFrontendSandbox||Z||location.search.includes("nosandbox")&&R.$.buildInfo.env==="development"||R.$.disableFrontendSandboxForPlugins.includes(me))return!1;const Ze=await(0,Qd.x)(me);return!(Ze.type===Wl.QE.app&&Ze.signatureType===Wl.kv.grafana)}function Zd(Z){return Z?.constructor?.name==="RegExp"}function Kl(Z){return Z&&(Zd(Z)&&(0,id.U)(Z)?new RegExp(Z):Array.isArray(Z)?Z.map(Kl):typeof Z=="object"?Object.keys(Z).reduce((me,Me)=>(Reflect.set(me,Me,Kl(Reflect.get(Z,Me))),me),{}):Z)}function Xd(Z){return Z&&((0,id.U)(Z)?(0,w.cloneDeep)(Z):Array.isArray(Z)?Z.map(Xd):typeof Z=="object"?Object.keys(Z).reduce((me,Me)=>(Reflect.set(me,Me,Xd(Reflect.get(Z,Me))),me),{}):Z)}const tl=Symbol.for("@@SANDBOX_LIVE_VALUE"),qd=!!R.$.featureToggles.frontendSandboxMonitorOnly;function sp(Z,me){const Me=Reflect.get(Z,"nodeName");if(Me==="body"||Z===document.body)return document.body;if(Me==="head"||Z===document.head||Z===document.documentElement)return Z;if(cl.includes(Me)&&($i("<"+Me+"> is not allowed in sandboxed plugins",{pluginId:me,param:Me}),!qd))throw new Error("<"+Me+"> is not allowed in sandboxed plugins");if(eu(Z,me)||Z.parentNode===document.body||Z.closest("#reactRoot")===null||qd)return Z;{const Ne=document.createElement(Me);return Ne.dataset.grafanaPluginSandboxElement="true",Ne}}function Wo(Z){if(typeof Z=="object"&&Z instanceof Element)try{return Z.nodeName!==void 0}catch{return!1}return!1}function so(Z){const me=Reflect.get(Z,"style");Object.hasOwn(me,tl)||Reflect.defineProperty(me,tl,{})}function ac(Z){Z&&(Array.isArray(Z)?(Z.forEach(ac),pi(Z)):typeof Z=="object"&&(Object.values(Z).forEach(ac),pi(Z)))}function pi(Z){if(Z)return Object.hasOwn(Z,tl)||Reflect.defineProperty(Z,tl,{}),Z}function rc(Z){Z&&(Object.hasOwn(Z,tl)||((0,id.U)(Z)&&!(Z instanceof Function)&&(np(Z)||Z instanceof M.mA||Z instanceof ld.f5)?Reflect.defineProperty(Z,tl,{}):Z===$d().languages&&Object.defineProperty(Z,tl,{})))}function oc(Z){return Object.hasOwn(Z,tl)}function eu(Z,me){return!document.contains(Z)||Z.closest(`[data-plugin-sandbox=${me}]`)!==null}let Li;function ap(){return Li||(Li=document.createElement("div"),Li.setAttribute("id","grafana-plugin-sandbox-body"),Li.setAttribute("data-plugin-sandbox","true"),Li.dataset.pluginSandbox="sandboxed-plugin",Li.style.width="100%",Li.style.height="0%",Li.style.overflow="hidden",Li.style.top="0",Li.style.left="0",document.body.appendChild(Li)),Li}let Oh=!1;function Ih(){Oh||(Oh=!0,op(),rp())}function rp(){const Z=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...me){return Z.apply(this,Xd(me))}})}function op(){const Z=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...me){let Me=me;try{Me=(0,w.cloneDeep)(me)}catch(Ne){$i("Error cloning args in window.history.replaceState",{error:String(Ne)})}return Reflect.apply(Z,this,Me)},writable:!0,configurable:!0,enumerable:!1})}const Pi=new Map,nl=!!R.$.featureToggles.frontendSandboxMonitorOnly,tu=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function ip(){return Pi.size===0&&(hd(Pi),lp(Pi),cp(Pi),hp(Pi),up(Pi),dp(Pi),Oc(Pi),Qp(Pi),fd(Pi),Ah(Pi),nu(Pi),gd(Pi)),Pi}function ud(Z,me){return $i(`Plugin ${me.id} tried to set a sandboxed property`,{pluginId:me.id,attrOrMethod:String(Z),entity:"window"}),nl?Z:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function hd(Z){const me=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const Ne of me){const Ze=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,Ne);if(Ze){let ct=function(gt,Bt){const Vt=Bt.id;return $i(`Plugin ${Vt} tried to access iframe.${Ne}`,{pluginId:Vt,attrOrMethod:Ne,entity:"iframe"}),nl?gt:()=>{throw new Error("iframe."+Ne+" is not allowed in sandboxed plugins")}};var Me=ct;Ze.value&&Z.set(Ze.value,ct),Ze.set&&Z.set(Ze.set,ct),Ze.get&&Z.set(Ze.get,ct)}}}function lp(Z){const me=Object.getOwnPropertyDescriptor(window,"console");if(me?.value){let Ne=function(Ze,ct){const gt=ct.id;if(nl)return Ze;function Bt(...Vt){console.log(`[plugin ${gt}]`,...Vt)}return{log:Bt,warn:Bt,error:Bt,info:Bt,debug:Bt,table:Bt}};var Me=Ne;Z.set(me.value,Ne)}me?.set&&Z.set(me.set,ud)}function cp(Z){function me(Ne,Ze){const ct=Ze.id;return $i(`Plugin ${ct} accessed window.alert`,{pluginId:ct,attrOrMethod:"alert",entity:"window"}),nl?Ne:function(...gt){console.log(`[plugin ${ct}]`,...gt)}}const Me=Object.getOwnPropertyDescriptor(window,"alert");Me?.value&&Z.set(Me.value,me),Me?.set&&Z.set(Me.set,ud)}function dp(Z){function me(Ne,Ze){const ct=Ze.id;return function(...Bt){for(const Vt of Bt){const Xt=String(Vt||"").toLowerCase();for(const nn of cl)if(Xt.includes("<"+nn)){if($i(`Plugin ${ct} tried to set ${nn} in innerHTML`,{pluginId:ct,attrOrMethod:"innerHTML",param:nn,entity:"HTMLElement"}),nl)continue;throw new Error("<"+nn+"> is not allowed in sandboxed plugins")}}if((0,w.isFunction)(Ne))return Ne.apply(this,Bt)}}const Me=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const Ne of Me)Ne?.set&&Z.set(Ne.set,me),Ne?.value&&Z.set(Ne.value,me)}function Oc(Z){function me(Ne,Ze){const ct=Ze.id;return function(Bt,Vt){if(Bt&&cl.includes(Bt)&&($i(`Plugin ${ct} tried to create ${Bt}`,{pluginId:ct,attrOrMethod:"createElement",param:Bt,entity:"document"}),!nl))return document.createDocumentFragment();if((0,w.isFunction)(Ne))return Ne.apply(this,[Bt,Vt])}}const Me=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Me?.value&&Z.set(Me.value,me)}function up(Z){function me(ct,gt){const Bt=gt.id;return function(Xt,nn){const on=Xt?.nodeName?.toLowerCase()||"";if(Xt&&cl.includes(on)&&($i(`Plugin ${Bt} tried to insert ${on}`,{pluginId:Bt,attrOrMethod:"insertChild",param:on,entity:"HTMLElement"}),!nl))return document.createDocumentFragment();if((0,w.isFunction)(ct))return ct.call(this,Xt,nn)}}function Me(ct,gt){const Bt=gt.id;return function(Xt,nn){const on=nn?.nodeName?.toLowerCase()||"";if(nn&&cl.includes(on)&&($i(`Plugin ${Bt} tried to insert ${on}`,{pluginId:Bt,attrOrMethod:"insertAdjacentElement",param:on,entity:"HTMLElement"}),!nl))return document.createDocumentFragment();if((0,w.isFunction)(ct))return ct.call(this,Xt,nn)}}const Ne=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const ct of Ne)ct?.value&&Z.set(ct.set,me);const Ze=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");Ze?.value&&Z.set(Ze.set,Me)}function hp(Z){function me(ct,gt){const Bt=gt.id;return function(...Xt){let nn=Xt;const on=Xt?.filter(Rn=>!cl.includes(Rn.nodeName.toLowerCase()));nl||(nn=on),nn.length!==on.length&&$i(`Plugin ${Bt} tried to append fobiddenElements`,{pluginId:Bt,attrOrMethod:"append",param:Xt?.filter(Rn=>cl.includes(Rn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,w.isFunction)(ct)&&ct.apply(this,nn)}}function Me(ct,gt,Bt){const Vt=gt.id;return function(nn){const on=nn?.nodeName?.toLowerCase()||"";if(nn&&cl.includes(on)&&($i(`Plugin ${Vt} tried to append ${on}`,{pluginId:Vt,attrOrMethod:"appendChild",param:on,entity:"HTMLElement"}),!nl))return document.createDocumentFragment();if(Bt&&nn&&on==="script"&&nn instanceof HTMLScriptElement){kd(nn.src,Bt).then(()=>{nn.onload?.call(nn,new Event("load"))}).catch(Rn=>{nn.onerror?.call(nn,new ErrorEvent("error",{error:Rn}))});return}if((0,w.isFunction)(ct))return ct.call(this,nn)}}const Ne=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const ct of Ne)ct?.value&&Z.set(ct.value,me);const Ze=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");Ze?.value&&Z.set(Ze.value,Me)}function Qp(Z){const me=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Me(Ne){return function(...ct){try{const gt=(0,w.cloneDeep)(ct);(0,w.isFunction)(Ne)&&Ne.apply(this,gt)}catch{throw new Error("postMessage arguments are invalid objects")}}}me?.value&&Z.set(me.value,Me)}function fd(Z){const me=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");me?.get&&Z.set(me.get,()=>()=>window);const Me=["write"];for(const Ne of Me){const Ze=Object.getOwnPropertyDescriptor(Document.prototype,Ne);Ze?.set&&Z.set(Ze.set,ud),Ze?.value&&Z.set(Ze.value,ud)}}async function Ah(Z){const me=Reflect.get(window,"monaco");if(!me||Object.hasOwn(me,tu))return;const Me=me.languages.setMonarchTokensProvider;function Ne(){return function(...Ze){return Ze.length!==2?Me.apply(me,Ze):Me.call(me,Ze[0],Kl(Ze[1]))}}Z.set(me.languages.setMonarchTokensProvider,Ne),Reflect.set(me,tu,{})}async function nu(Z){const me=Object.getOwnPropertyDescriptor(window,"postMessage");function Me(Ne){return function(...ct){try{const gt=(0,w.cloneDeep)(ct);(0,w.isFunction)(Ne)&&Ne.apply(this,gt)}catch{throw new Error("postMessage arguments are invalid objects")}}}me?.value&&Z.set(me.value,Me)}function fp(Z){Ah(Pi)}function gd(Z){function me(Me){return(0,w.isFunction)(Me)?function(...Ne){const Ze=Me.apply(this,Ne);return ac(Ze),Ze}:Me}Z.set(w.cloneDeep,me)}var Rh=e(66161);async function Ic(Z,me){if(!Mh(Z))return Z;const Me=await Promise.resolve(Z.plugin);if(Reflect.has(Me,"panel")&&Reflect.set(Me,"panel",ji(Reflect.get(Me,"panel"),me)),Reflect.has(Me,"components")){const Ne=Reflect.get(Me,"components");Object.entries(Ne).forEach(([Ze,ct])=>{Reflect.set(Ne,Ze,ji(ct,me))}),Reflect.set(Me,"components",Ne)}if(Reflect.has(Me,"root")&&Reflect.set(Me,"root",ji(Reflect.get(Me,"root"),me)),Reflect.has(Me,"extensionConfigs")){const Ne=Reflect.get(Me,"extensionConfigs");for(const Ze of Ne)Reflect.has(Ze,"component")&&Reflect.set(Ze,"component",ji(Reflect.get(Ze,"component"),me));Reflect.set(Me,"extensionConfigs",Ne)}if(Reflect.has(Me,"configPages")){const Ne=Reflect.get(Me,"configPages")??[];for(const[Ze,ct]of Object.entries(Ne))!ct.body||!(0,w.isFunction)(ct.body)||Reflect.set(Ne,Ze,{...ct,body:ji(ct.body,me)});Reflect.set(Me,"configPages",Ne)}return Z}const ji=(Z,me)=>{const Me=K.memo(Ne=>(0,T.jsx)("div",{"data-plugin-sandbox":me.id,style:{height:me.type===Wl.QE.app||me.type===Wl.QE.panel?"100%":"auto"},children:(0,T.jsx)(Z,{...Ne})}));return Me.displayName=`GrafanaSandbox(${Z.displayName||Z.name||"Component"})`,Me},su=new Map,au={};async function Lh({pluginId:Z}){Ih();try{const me=Th(Z);return su.has(Z)||su.set(Z,jh(me)),su.get(Z)}catch(me){const Me=new Error(`Could not import plugin ${Z} inside sandbox: `+me);throw Fo(Me,{pluginId:Z,error:String(me)}),Me}}async function jh(Z){return ko("Loading with sandbox",{pluginId:Z.id}),new Promise(async(me,Me)=>{const Ne=ip();let Ze;function ct(Bt){if(Wo(Bt)){const nn=sp(Bt,Z.id);return so(nn),nn}else rc(Bt);const Vt=Ne.get(Bt);if(Vt)return Vt(Bt,Z,Ze);const Xt=fp(Bt);return Xt||Bt}Ze=(0,bh.A)(window,{distortionCallback:ct,defaultPolicy:Ph.G,liveTargetCallback:oc,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(Bt,...Vt){return setTimeout(Bt,0,...Vt)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(au[Z.id+"-grafanaBootData"]||(au[Z.id+"-grafanaBootData"]=!0,ko("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:Z.id,guessedPluginName:Z.id,parent:"window",packageName:"window",key:"grafanaBootData"})),R.$.buildInfo.env==="development")throw new Error(`Error in ${Z.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${Z.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),R.$.bootData},async define(Bt,Vt,Xt){let nn,on;Array.isArray(Bt)?(nn=Bt,on=Vt):(nn=Vt,on=Xt);try{const Rn=pd(nn,Z),rn=on.apply(null,Rn),Nn=await Ic(rn,Z);me(Nn)}catch(Rn){const rn=new Error(`Could not execute plugin's define ${Z.id}: `+Rn);Fo(rn,{pluginId:Z.id,error:String(Rn)}),Me(rn)}}})}),Gd(Ze);let gt="";try{gt=await Sh(Z)}catch(Bt){const Vt=new Error(`Could not load plugin code ${Z.id}: `+Bt);Fo(Vt,{pluginId:Z.id,error:String(Bt)}),Me(Vt)}try{Ze.evaluate(gt)}catch(Bt){const Vt=new Error(`Could not run plugin ${Z.id} inside sandbox: `+Bt);Fo(Vt,{pluginId:Z.id,error:String(Bt)}),Me(Vt)}})}function pd(Z,me){const Me={},Ne={id:me.id,uri:me.module,exports:Me},Ze=[];for(const ct of Z){let gt=Rh.s.get(ct);if(gt?.__useDefault&&(gt=gt.default),ct==="module"&&(gt=Ne),ct==="exports"&&(gt=Me),!gt){const Bt=new Error(`[sandbox] Could not resolve dependency ${ct}`);throw Fo(Bt,{pluginId:me.id,dependency:ct,error:String(Bt)}),Bt}Ze.push(gt)}return Ze}const Ji=(0,Pl.kB)(ep);Xc.z.addImportMap({imports:Ji});const sl=Xc.z.constructor.prototype;sl.shouldFetch=function(Z){const me=(0,wl.QO)(Z),Me=/^[^#?]+\.(js)([?#].*)?$/;return(0,Pl.OD)(Z)||!!me?.isAngular||!Me.test(Z)};const gp=sl.import;sl.import=function(...Z){return gp.apply(this,Z).then(me=>me&&me.__useDefault?me.default:me)};const pp=sl.fetch;sl.fetch=function(Z,me){return ll(pp,Z,me)};const ru=sl.resolve;sl.resolve=rd.bind(sl,ru),sl.onload=Mc;async function ou({path:Z,version:me,isAngular:Me,pluginId:Ne}){me&&(0,wl.GD)({pluginId:Ne,version:me,isAngular:Me});const Ze=vh[Z];if(Ze)return typeof Ze=="function"?await Ze():Ze;let ct=(0,Pl.Av)(Z);return await Jd({isAngular:Me,pluginId:Ne})?Lh({pluginId:Ne}):Xc.z.import(ct)}function mp(Z){const me=Z.angular?.detected??Z.angularDetected;return ou({path:Z.module,version:Z.info?.version,isAngular:me,pluginId:Z.id}).then(Me=>{if(Me.plugin){const Ne=Me.plugin;return Ne.meta=Z,Ne}if(Me.Datasource){const Ne=new M.tD(Me.Datasource);return Ne.setComponentsFromLegacyExports(Me),Ne.meta=Z,Ne}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function Bh(Z){const me=Z.angular?.detected??Z.angularDetected;return ou({path:Z.module,version:Z.info?.version,isAngular:me,pluginId:Z.id}).then(Me=>{const Ne=Me.plugin?Me.plugin:new I.hX;return Ne.init(Z),Ne.meta=Z,Ne.setComponentsFromLegacyExports(Me),Ne})}},66161:(k,A,e)=>{"use strict";e.d(A,{s:()=>n});const n=new Map([])},60677:(k,A,e)=>{"use strict";e.d(A,{W3:()=>g,Wy:()=>o,z4:()=>d});var n=e(43429),s=e(34867),l=e(15162),r=e(27716),i=e(685);async function g(c){const a=await(0,r.x)(c);let p;if(a.type===n.QE.app&&(p=await(0,i.ui)(a)),a.type===n.QE.datasource&&(p=await(0,i.cS)(a)),a.type===n.QE.panel&&(p=await(0,l.Kk)(a)),a.type===n.QE.renderer&&(p={meta:a}),!p)throw new Error("Unknown Plugin type: "+a.type);return p}function o(c,a,p){let m={...c},v;function x(E,h){return!h.startsWith(E.url??"")||v&&(v.url?.length??0)>(E.url?.length??0)?E:(v&&(v.active=!1),v={...E,active:!0},v)}function f(E,h=0){if(h>10)return E;if(E.children){const y=E.children.map(b=>f(b,h+1));return{...x(E,p),children:y}}return x(E,p)}return m.children=(m?.children??[]).map(f),{main:m,node:v??m}}const d=(0,s.DW)("features.plugins")},8856:(k,A,e)=>{"use strict";e.d(A,{Pj:()=>a,o:()=>p,Aj:()=>m});var n=e(75816),s=e(75505),l=e(17172);function r({baseURL:v}){async function x(f){try{const{data:E,...h}=await(0,s.s)((0,l.AI)().fetch({...f,url:v+f.url,showErrorAlert:f.showErrorAlert,data:f.body}));return{data:E,meta:h}}catch(E){return f.manageError?f.manageError(E):{error:E}}}return x}const g=(0,n.xP)({reducerPath:"userPreferencesAPI",baseQuery:r({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:v=>({getUserPreferences:v.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:v.mutation({query:x=>({url:"/user/preferences",method:"PATCH",body:x.patchPrefsCmd})}),updateUserPreferences:v.mutation({query:x=>({url:"/user/preferences",method:"PUT",body:x.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:o,usePatchUserPreferencesMutation:d,useUpdateUserPreferencesMutation:c}=g,{useGetUserPreferencesQuery:a,usePatchUserPreferencesMutation:p,useUpdateUserPreferencesMutation:u}=g,m=g.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}})},81862:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>R,Cj:()=>p,HO:()=>h,Mj:()=>v,Nm:()=>m,Q9:()=>E,RS:()=>D,c1:()=>a,g$:()=>y,ny:()=>x,ri:()=>f,uh:()=>b,xu:()=>u});var n=e(65307),s=e(2543),l=e.n(s),r=e(72724),i=e(47232),g=e(2913),o=e(10096);const d={orgId:g.Ay.bootData.user.orgId,timeZone:g.Ay.bootData.user.timezone,weekStart:g.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},c=(0,n.Z0)({name:"user/profile",initialState:d,reducers:{updateTimeZone:(T,S)=>{T.timeZone=S.payload.timeZone},updateWeekStart:(T,S)=>{T.weekStart=S.payload.weekStart},updateFiscalYearStartMonth:(T,S)=>{T.fiscalYearStartMonth=S.payload.fiscalYearStartMonth},setUpdating:(T,S)=>{T.isUpdating=S.payload.updating},userLoaded:(T,S)=>{T.user=S.payload.user},initLoadTeams:(T,S)=>{T.teamsAreLoading=!0},teamsLoaded:(T,S)=>{T.teams=S.payload.teams,T.teamsAreLoading=!1},initLoadOrgs:(T,S)=>{T.orgsAreLoading=!0},orgsLoaded:(T,S)=>{T.orgs=S.payload.orgs,T.orgsAreLoading=!1},initLoadSessions:(T,S)=>{T.sessionsAreLoading=!0},sessionsLoaded:(T,S)=>{const L=S.payload.sessions.sort((O,j)=>Number(j.isActive)-Number(O.isActive));T.sessions=L.map(O=>({id:O.id,isActive:O.isActive,seenAt:(0,r.fq)(O.seenAt),createdAt:O.createdAt,clientIp:O.clientIp,browser:O.browser,browserVersion:O.browserVersion,os:O.os,osVersion:O.osVersion,device:O.device})),T.sessionsAreLoading=!1},userSessionRevoked:(T,S)=>{T.sessions=T.sessions.filter(L=>L.id!==S.payload.tokenId),T.isUpdating=!1}}}),a=T=>async S=>{(0,s.set)(o.contextSrv,"user.fiscalYearStartMonth",T),S(M({fiscalYearStartMonth:T}))},p=T=>async S=>{(!(0,s.isString)(T)||(0,s.isEmpty)(T))&&(T=g.Ay?.bootData?.user?.timezone),(0,s.set)(o.contextSrv,"user.timezone",T),S(P({timeZone:T}))},u=T=>async S=>{(!(0,s.isString)(T)||(0,s.isEmpty)(T))&&(T=g.Ay?.bootData?.user?.weekStart),(0,s.set)(o.contextSrv,"user.weekStart",T),S(C({weekStart:T})),(0,i.$D)(T)},{setUpdating:m,initLoadOrgs:v,orgsLoaded:x,initLoadTeams:f,teamsLoaded:E,userLoaded:h,userSessionRevoked:y,initLoadSessions:b,sessionsLoaded:D,updateTimeZone:P,updateWeekStart:C,updateFiscalYearStartMonth:M}=c.actions,I=c.reducer,R={user:c.reducer}},32901:(k,A,e)=>{"use strict";e.d(A,{O:()=>n,q:()=>s});const n=l=>l.timeZone,s=l=>l.fiscalYearStartMonth},2858:(k,A,e)=>{"use strict";e.d(A,{g:()=>o});var n=e(75816),s=e(56389);const l="grafana.app/createdBy",r=d=>d||void 0,i=d=>d.items?d.items.map(c=>({uid:c.metadata.name||"",title:c.spec.title,targets:c.spec.targets.map(a=>a.properties),createdAtTimestamp:new Date(c.metadata.creationTimestamp||"").getTime(),user:r(c.metadata?.annotations?.[l])})):[],g=d=>{const{title:c,targets:a}=d;return{apiVersion:s.mG,kind:s.GY.QueryTemplate,metadata:{generateName:"A"+c.replaceAll(" ","-")},spec:{title:c,vars:[],targets:a.map(p=>({variables:{},properties:p}))}}},o=(0,n.xP)({baseQuery:s.Su,tagTypes:["QueryTemplatesList"],endpoints:d=>({allQueryTemplates:d.query({query:()=>({}),transformResponse:i,providesTags:["QueryTemplatesList"]}),addQueryTemplate:d.mutation({query:c=>({method:"POST",data:g(c)}),invalidatesTags:["QueryTemplatesList"]}),deleteQueryTemplate:d.mutation({query:({uid:c})=>({url:`${c}`,method:"DELETE"}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(k,A,e)=>{"use strict";e.d(A,{C1:()=>g,GY:()=>i,Su:()=>o,mG:()=>r});var n=e(75505),s=e(32264),l=e(17172);const r="peakq.grafana.app/v0alpha1";var i=(d=>(d.QueryTemplate="QueryTemplate",d))(i||{});const g=`/apis/${r}/namespaces/${s.$.namespace}/querytemplates/`,o=async d=>{try{const c=(0,l.AI)().fetch({url:`${g}${d.url??""}`,showErrorAlert:!0,method:d.method||"GET",data:d.data});return await(0,n.s)(c)}catch(c){return(0,l.NF)(c)?{error:new Error(c.data.message)}:c instanceof Error?{error:c}:{error:new Error("Unknown error")}}}},64152:(k,A,e)=>{"use strict";e.d(A,{d:()=>l,m:()=>s});class n{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(i){this.extraRenderActions=this.extraRenderActions.concat(i)}addKeyedExtraRenderAction(i,g){this.keyedScopedExtraRenderActions.set(i,g)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(i){return Array.from(this.keyedScopedExtraRenderActions,o=>o[1]).filter(o=>o.scope===i).map(o=>o.queryActionComponent)}}const s=new n,l=new n},48514:(k,A,e)=>{"use strict";e.d(A,{c:()=>W,E:()=>Y});var n=e(74848),s=e(46942),l=e.n(s),r=e(2543),i=e(55127),g=e.n(i),o=e(96540),d=e(41987),c=e(76287),a=e(22391),p=e(18226),u=e(39070),m=e(14236),v=e(26272),x=e(13544),f=e(19347),E=e(7376),h=e(14110),y=e(39938),b=e(66602),D=e(22214),P=e(10343),C=e(7788),M=e(8484),I=e(74856),R=e(84423),T=e(64152),S=e(32196),L=e(40845),O=e(14578),j=e(10354),N=e(72093),F=e(51612);const U=X=>{const{query:q,queries:G,onChange:te,collapsedText:H,renderExtras:se,hidden:ne}=X,le=(0,L.of)(B),[_,Q]=(0,o.useState)(!1),[ae,oe]=(0,o.useState)(null),J=Te=>{Q(!0)},ee=Te=>{if(Q(!1),ae){oe(null);return}q.refId!==Te&&te({...q,refId:Te})},de=Te=>{const ge=Te.currentTarget.value.trim();if(ge.length===0){oe("An empty query name is not allowed");return}for(const Oe of G)if(Oe!==q&&ge===Oe.refId){oe("Query name already exists");return}ae&&oe(null)},xe=Te=>{ee(Te.currentTarget.value.trim())},re=Te=>{Te.key==="Enter"&&ee(Te.currentTarget.value)},ue=Te=>{Te.target.select()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:le.wrapper,children:[!_&&(0,n.jsxs)("button",{className:le.queryNameWrapper,"aria-label":x.Tp.components.QueryEditorRow.title(q.refId),title:"Edit query name",onClick:J,"data-testid":"query-name-div",type:"button",children:[(0,n.jsx)("span",{className:le.queryName,children:q.refId}),(0,n.jsx)(O.I,{name:"pen",className:le.queryEditIcon,size:"sm"})]}),_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.p,{type:"text",defaultValue:q.refId,onBlur:xe,autoFocus:!0,onKeyDown:re,onFocus:ue,invalid:ae!==null,onChange:de,className:le.queryNameInput,"data-testid":"query-name-input"}),ae&&(0,n.jsx)(N.P,{horizontal:!0,children:ae})]}),w(X,le),se&&(0,n.jsx)("div",{className:le.itemWrapper,children:se()}),ne&&(0,n.jsx)("em",{className:le.contextInfo,children:"Hidden"})]}),H&&(0,n.jsx)("div",{className:le.collapsedText,children:H})]})},w=(X,q)=>{const{alerting:G,dataSource:te,onChangeDataSource:H}=X;return H?(0,n.jsx)("div",{className:q.itemWrapper,children:(0,n.jsx)(F.s,{variables:!0,alerting:G,current:te.name,onChange:H})}):(0,n.jsxs)("em",{className:q.contextInfo,children:["(",te.name,")"]})},B=X=>({wrapper:(0,S.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${X.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,S.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${X.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${X.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${X.colors.action.hover};
        border: 1px dashed ${X.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${X.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,S.css)`
      font-weight: ${X.typography.fontWeightMedium};
      color: ${X.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${X.spacing(.5)};
    `,queryEditIcon:(0,S.cx)((0,S.css)`
        margin-left: ${X.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,S.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,S.css)`
      font-weight: ${X.typography.fontWeightRegular};
      font-size: ${X.typography.bodySmall.fontSize};
      color: ${X.colors.text.secondary};
      padding-left: ${X.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,S.css)`
      font-size: ${X.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${X.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,S.css)`
      display: flex;
      margin-left: 4px;
    `});var K=e(84959);class W extends o.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,f.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const q=(0,E.E)(),G='<plugin-component type="query-ctrl" />',te={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=q.load(this.element,te,G),this.angularScope=te.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:q,onChange:G,queries:te,onRunQuery:H,onAddQuery:se,app:ne=d.Jk.PanelEditor,history:le}=this.props,{datasource:_,data:Q}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(_?.components?.QueryCtrl)return(0,n.jsx)("div",{ref:ae=>this.element=ae});if(_){let ae=this.getReactQueryEditor(_);if(ae)return(0,n.jsx)(c.p,{instanceSettings:this.props.dataSource,children:(0,n.jsx)(ae,{query:q,datasource:_,onChange:G,onRunQuery:H,onAddQuery:se,data:Q,range:(0,I.jG)().timeRange(),queries:te,app:ne,history:le},_?.name)})}return(0,n.jsx)("div",{children:(0,n.jsx)(M.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onToggleEditMode=(q,G)=>{q.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),G.isOpen||G.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:q,query:G,onQueryRemoved:te}=this.props;q(G),te&&te()},this.onCopyQuery=()=>{const{query:q,onAddQuery:G,onQueryCopied:te}=this.props,H=(0,r.cloneDeep)(q);G(H),te&&te()},this.onHideQuery=()=>{const{query:q,onChange:G,onRunQuery:te,onQueryToggled:H}=this.props;G({...q,hide:!q.hide}),te(),H&&H(q.hide),(0,h.rR)("query_editor_row_hide_query_clicked",{hide:!q.hide})},this.onToggleHelp=()=>{this.setState(q=>({showingHelp:!q.showingHelp}))},this.onClickExample=q=>{q.datasource===void 0&&(q.datasource=(0,a.p$)(this.props.dataSource)),this.props.onChange({...q,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:q,query:G}=this.props,H=(Y(q,G.refId)?.series??[]).reduce((_,Q)=>{if(!Q.meta?.notices)return _;const ae=(0,r.filter)(Q.meta.notices,{severity:"warning"})??[];return _.concat(ae)},[]),se=(0,r.uniqBy)(H,"text");if(!(se.length>0))return null;const le=se.map(_=>_.text).join(`
`);return(0,n.jsx)(y.E,{color:"orange",icon:"exclamation-triangle",text:(0,n.jsxs)(n.Fragment,{children:[se.length," ",g()("warning",se.length)]}),tooltip:le},"query-warning")},this.renderExtraActions=()=>{const{query:q,queries:G,data:te,onAddQuery:H,dataSource:se,app:ne}=this.props,le=T.d.getAllExtraRenderAction();let _=[];ne!==void 0&&(_=T.d.getScopedExtraRenderAction(ne));const Q=[...le,..._].map((ae,oe)=>ae({query:q,queries:G,timeRange:te.timeRange,onAddQuery:H,dataSource:se,key:oe})).filter(Boolean);return Q.push(this.renderWarnings()),Q},this.renderActions=q=>{const{query:G,hideHideQueryButton:te=!1}=this.props,{hasTextEditMode:H,datasource:se,showingHelp:ne}=this.state,le=!!G.hide,_=se?.components?.QueryEditorHelp;return(0,n.jsxs)(n.Fragment,{children:[_&&(0,n.jsx)(P.A,{title:(0,M.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ne}),H&&(0,n.jsx)(P.q,{title:(0,M.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:Q=>{this.onToggleEditMode(Q,q)}}),this.renderExtraActions(),(0,n.jsx)(P.q,{title:(0,M.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),te?null:(0,n.jsx)(P.A,{dataTestId:x.Tp.components.QueryEditorRow.actionButton("Hide response"),title:G.hide?(0,M.t)("query-operation.header.show-response","Show response"):(0,M.t)("query-operation.header.hide-response","Hide response"),icon:le?"eye-slash":"eye",active:le,onClick:this.onHideQuery}),(0,n.jsx)(P.q,{title:(0,M.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=q=>{const{alerting:G,query:te,dataSource:H,onChangeDataSource:se,onChange:ne,queries:le,renderHeaderExtras:_}=this.props;return(0,n.jsx)(U,{query:te,queries:le,onChangeDataSource:se,dataSource:H,hidden:te.hide,onClick:Q=>this.onToggleEditMode(Q,q),onChange:ne,collapsedText:q.isOpen?null:this.renderCollapsedText(),renderExtras:_,alerting:G})}}componentDidMount(){const{data:q,query:G,id:te}=this.props,H=Y(q,G.refId);this.id=(0,r.uniqueId)(te+"_"),this.setState({data:H}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:q,queries:G}=this.props,{datasource:te}=this.state,H=new R.a9({targets:G}),se={},ne=this;return{datasource:te,target:q,panel:H,dashboard:se,refresh:()=>{q.hide!==ne.props.query.hide&&(q.hide=ne.props.query.hide),this.props.onChange(q),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new p.o,range:(0,I.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const q=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return q?.rawRef?.uid??q?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let q;const G=this.getInterpolatedDataSourceUID();try{q=await this.dataSourceSrv.get(G)}catch{q=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(q),this.setState({datasource:q,queriedDataSourceIdentifier:G,hasTextEditMode:(0,r.has)(q,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(q){const{datasource:G,queriedDataSourceIdentifier:te}=this.state,{data:H,query:se}=this.props;if(q.id!==this.props.id&&(this.id=(0,r.uniqueId)(this.props.id+"_")),H!==q.data){const ne=Y(H,se.refId);this.setState({data:ne}),this.angularScope&&(this.angularScope.range=(0,I.jG)().timeRange()),this.angularQueryEditor&&ne&&z(this.angularScope,ne,this.angularQueryEditor)}if(G&&te!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(q){if(q)switch(this.props.app){case d.Jk.Explore:return q.components?.ExploreMetricsQueryField||q.components?.ExploreLogsQueryField||q.components?.ExploreQueryField||q.components?.QueryEditor;case d.Jk.PanelEditor:case d.Jk.Dashboard:default:return q.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:q}=this.state;return q?.getQueryDisplayText?q.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:q,index:G,visualization:te,collapsable:H}=this.props,{datasource:se,showingHelp:ne,data:le}=this.state,_=q.hide,Q=le?.error&&le.error.refId===q.refId?le.error:le?.errors?.find(ee=>ee.refId===q.refId),ae=l()("query-editor-row",{"query-editor-row--disabled":_,"gf-form-disabled":_});if(!se)return null;const oe=this.renderPluginEditor(),J=se.components?.QueryEditorHelp;return(0,n.jsx)("div",{"data-testid":"query-editor-row","aria-label":x.Tp.components.QueryEditorRows.rows,children:(0,n.jsx)(C.u,{id:this.id,draggable:!0,collapsable:H,index:G,headerElement:this.renderHeader,actions:this.renderActions,onOpen:this.onOpen,children:(0,n.jsxs)("div",{className:ae,id:this.id,children:[(0,n.jsxs)(b.Xw,{children:[ne&&J&&(0,n.jsx)(D.j,{children:(0,n.jsx)(J,{onClickExample:ee=>this.onClickExample(ee),query:this.props.query,datasource:se})}),oe]}),Q&&(0,n.jsx)(K.x,{error:Q}),te]})})})}}function z(X,q,G){if(q.state===u.Gu.Done){const te=q.series.map(H=>(0,m.w3)(H));X.events.emit(v.ee.dataReceived,te)}else q.state===u.Gu.Error&&X.events.emit(v.ee.dataError,q.error);setTimeout(G.digest)}function Y(X,q){const G=X.series.filter(ne=>ne.refId===q);if(X.state!==u.Gu.Loading&&(X.error||X.errors?.length)&&!X.series.length)return{...X,state:u.Gu.Error};let te=X.state,H=X.errors?.find(ne=>ne.refId===q);!H&&X.error&&(H=X.error.refId===q?X.error:void 0),te!==u.Gu.Loading&&(H?te=u.Gu.Error:X.state===u.Gu.Error&&(te=u.Gu.Done));const se=X.timeRange;return{...X,state:te,series:G,error:H,errors:H?[H]:void 0,timeRange:se}}},44932:(k,A,e)=>{"use strict";e.d(A,{L:()=>d});var n=e(74848),s=e(91076),l=e(96540),r=e(22391),i=e(14110),g=e(19347),o=e(48514);class d extends l.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=p=>{this.props.onQueriesChange(this.props.queries.filter(u=>u!==p))},this.onDragStart=p=>{const{queries:u,dsSettings:m}=this.props;(0,i.rR)("query_row_reorder_started",{startIndex:p.source.index,numberOfQueries:u.length,datasourceType:m.type})},this.onDragEnd=p=>{const{queries:u,onQueriesChange:m,dsSettings:v}=this.props;if(!p||!p.destination)return;const x=p.source.index,f=p.destination.index;if(x===f){(0,i.rR)("query_row_reorder_canceled",{startIndex:x,endIndex:f,numberOfQueries:u.length,datasourceType:v.type});return}const E=Array.from(u),[h]=E.splice(x,1);E.splice(f,0,h),m(E),(0,i.rR)("query_row_reorder_ended",{startIndex:x,endIndex:f,numberOfQueries:u.length,datasourceType:v.type})}}onChangeQuery(p,u){const{queries:m,onQueriesChange:v}=this.props;v(m.map((x,f)=>f===u?p:x))}onDataSourceChange(p,u){const{queries:m,onQueriesChange:v}=this.props;v(m.map((x,f)=>{if(f!==u)return x;const E=(0,r.p$)(p);return x.datasource&&(0,g.l)().getInstanceSettings(x.datasource)?.type===p.type?{...x,datasource:E}:{refId:x.refId,hide:x.hide,datasource:E}}))}render(){const{dsSettings:p,data:u,queries:m,app:v,history:x,eventBus:f,onAddQuery:E,onRunQueries:h,onQueryCopied:y,onQueryRemoved:b,onQueryToggled:D,queryRowWrapper:P}=this.props;return(0,n.jsx)(s.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,n.jsx)(s.gL,{droppableId:"transformations-list",direction:"vertical",children:C=>(0,n.jsxs)("div",{"data-testid":"query-editor-rows",ref:C.innerRef,...C.droppableProps,children:[m.map((M,I)=>{const R=c(M,p),T=p.meta.mixed?L=>this.onDataSourceChange(L,I):void 0,S=(0,n.jsx)(o.c,{id:M.refId,index:I,data:u,query:M,dataSource:R,onChangeDataSource:T,onChange:L=>this.onChangeQuery(L,I),onRemoveQuery:this.onRemoveQuery,onAddQuery:E,onRunQuery:h,onQueryCopied:y,onQueryRemoved:b,onQueryToggled:D,queries:m,app:v,history:x,eventBus:f},M.refId);return P?P(S,M.refId):S}),C.placeholder]})})})}}const c=(a,p)=>a.datasource&&(0,g.l)().getInstanceSettings(a.datasource)||p},84959:(k,A,e)=>{"use strict";e.d(A,{x:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(14578);function i({error:o}){const d=(0,l.of)(g),c=o?.message??o?.data?.message??"Query error";return(0,n.jsxs)("div",{className:d.wrapper,children:[(0,n.jsx)("div",{className:d.icon,children:(0,n.jsx)(r.I,{name:"exclamation-triangle"})}),(0,n.jsxs)("div",{className:d.message,children:[c,o.traceId!=null&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{})," ",(0,n.jsxs)("span",{children:["(Trace ID: ",o.traceId,")"]})]})]})]})}const g=o=>({wrapper:(0,s.css)({marginTop:o.spacing(.5),background:o.colors.background.secondary,display:"flex"}),icon:(0,s.css)({background:o.colors.error.main,color:o.colors.error.contrastText,padding:o.spacing(1)}),message:(0,s.css)({fontSize:o.typography.bodySmall.fontSize,fontFamily:o.typography.fontFamilyMonospace,padding:o.spacing(1)})})},37464:(k,A,e)=>{"use strict";e.d(A,{g:()=>G,K:()=>H});var n=e(74848),s=e(32196),l=e(96540),r=e(39070),i=e(43127),g=e(22391),o=e(41987),d=e(43429),c=e(13544),a=e(19347),p=e(39601),u=e(66864),m=e(55852),v=e(40276),x=e(37390),f=e(3911),E=e(38894),h=e(16817),y=e(36663),b=e(17172),D=e(39558);function P({pluginId:ne}){const{value:le,loading:_,error:Q}=(0,h.A)(async()=>(0,b.AI)().get(`/api/plugins/${ne}/markdown/query_help`),[]),ae=(0,y.G)(le);return _?(0,n.jsx)(D._,{text:"Loading help..."}):Q?(0,n.jsx)("h3",{children:"An error occurred when loading help."}):le===""?(0,n.jsx)("h3",{children:"No query help could be found."}):(0,n.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:ae}})}var C=e(2913),M=e(27677),I=e(21969),R=e(50481),T=e(51612),S=e(53478),L=e(74106),O=e(14348),j=e(8480),N=e(93117),F=e(64152),U=e(44932),w=e(65879),B=e(10354),K=e(15292),W=e(7788);class z extends l.PureComponent{constructor(le){super(le),this.onRelativeTimeChange=Q=>{this.setState({timeRangeFrom:Q.target.value})},this.onTimeShiftChange=Q=>{this.setState({timeRangeShift:Q.target.value})},this.onOverrideTime=Q=>{const{options:ae,onChange:oe}=this.props,J=X(Q.target.value),ee=Y(J);ee&&ae.timeRange?.from!==J&&oe({...ae,timeRange:{...ae.timeRange??{},from:J}}),this.setState({relativeTimeIsValid:ee})},this.onTimeShift=Q=>{const{options:ae,onChange:oe}=this.props,J=X(Q.target.value),ee=Y(J);ee&&ae.timeRange?.shift!==J&&oe({...ae,timeRange:{...ae.timeRange??{},shift:J}}),this.setState({timeShiftIsValid:ee})},this.onToggleTimeOverride=()=>{const{onChange:Q,options:ae}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{Q({...ae,timeRange:{...ae.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=Q=>{const{options:ae,onChange:oe}=this.props;oe({...ae,cacheTimeout:X(Q.target.value)})},this.onQueryCachingTTLBlur=Q=>{const{options:ae,onChange:oe}=this.props;let J=parseInt(Q.target.value,10);(isNaN(J)||J===0)&&(J=null),oe({...ae,queryCachingTTL:J})},this.onMaxDataPointsBlur=Q=>{const{options:ae,onChange:oe}=this.props;let J=parseInt(Q.currentTarget.value,10);(isNaN(J)||J===0)&&(J=null),J!==ae.maxDataPoints&&oe({...ae,maxDataPoints:J})},this.onMinIntervalBlur=Q=>{const{options:ae,onChange:oe}=this.props,J=X(Q.target.value);J!==ae.minInterval&&oe({...ae,minInterval:J})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:_}=le;this.state={timeRangeFrom:_.timeRange?.from||"",timeRangeShift:_.timeRange?.shift||"",timeRangeHide:_.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:le,options:_}=this.props,Q=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return le.meta.queryOptions?.cacheTimeout?(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:Q,children:"Cache timeout"}),(0,n.jsx)(B.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:_.cacheTimeout??""})]})}):null}renderQueryCachingTTLOption(){const{dataSource:le,options:_}=this.props,Q="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return le.cachingConfig?.enabled?(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:Q,children:"Cache TTL"}),(0,n.jsx)(B.p,{type:"number",className:"width-6",placeholder:`${le.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:_.queryCachingTTL??void 0})]})}):null}renderMaxDataPointsOption(){const{data:le,options:_}=this.props,Q=le.request?.maxDataPoints,ae=_.maxDataPoints??"",oe=ae==="";return(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:(0,n.jsx)(n.Fragment,{children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:"Max data points"}),(0,n.jsx)(B.p,{type:"number",className:"width-6",placeholder:`${Q}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:ae}),oe&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,n.jsx)("div",{className:"gf-form-label",children:"Width of panel"})]})]})})}renderIntervalOption(){const{data:le,dataSource:_,options:Q}=this.props,ae=le.request?.interval,oe=_.interval??"No limit";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:(0,n.jsxs)(n.Fragment,{children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,n.jsx)("code",{children:"1m"})," ","if your data is written every minute. Default value can be set in data source settings for most data sources."]}),children:"Min interval"}),(0,n.jsx)(B.p,{type:"text",className:"width-6",placeholder:`${oe}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:Q.minInterval??""})]})}),(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:(0,n.jsxs)(n.Fragment,{children:["The evaluated interval that is sent to data source and is used in ",(0,n.jsx)("code",{children:"$__interval"})," and"," ",(0,n.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to"," ",(0,n.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:"Interval"}),(0,n.jsx)(E.I,{width:6,children:ae}),(0,n.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,n.jsx)("div",{className:"gf-form-label",children:"Time range / max data points"})]})})]})}renderCollapsedText(le){const{data:_,options:Q}=this.props,{isOpen:ae}=this.state;if(ae)return;let oe=Q.maxDataPoints??"";oe===""&&_.request&&(oe=`auto = ${_.request.maxDataPoints}`);let J=Q.minInterval;return _.request&&(J=`${_.request.interval}`),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:le.collapsedText,children:["MD = ",oe]}),(0,n.jsxs)("div",{className:le.collapsedText,children:["Interval = ",J]})]})}render(){const{timeRangeHide:le,relativeTimeIsValid:_,timeShiftIsValid:Q}=this.state,{timeRangeFrom:ae,timeRangeShift:oe,isOpen:J}=this.state,ee=q();return(0,n.jsxs)(W.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(ee),isOpen:J,onOpen:this.onOpenOptions,onClose:this.onCloseOptions,children:[this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:(0,n.jsxs)(n.Fragment,{children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,n.jsx)("code",{children:"now-5m"})," and ",(0,n.jsx)("code",{children:"5m"}),", or variables like ",(0,n.jsx)("code",{children:"$_relativeTime"}),"."]}),children:"Relative time"}),(0,n.jsx)(B.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!_,value:ae})]}),(0,n.jsxs)("div",{className:"gf-form",children:[(0,n.jsx)(E.I,{width:9,tooltip:(0,n.jsxs)(n.Fragment,{children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,n.jsx)("code",{children:"now-1h"})," and"," ",(0,n.jsx)("code",{children:"1h"}),", or variables like ",(0,n.jsx)("code",{children:"$_timeShift"}),"."]}),children:"Time shift"}),(0,n.jsx)(B.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!Q,value:oe})]}),(oe||ae)&&(0,n.jsxs)("div",{className:"gf-form-inline align-items-center",children:[(0,n.jsx)(E.I,{width:9,children:"Hide time info"}),(0,n.jsx)(K.d,{value:le,onChange:this.onToggleTimeOverride})]})]})}}const Y=ne=>ne?w.isValidTimeSpan(ne):!0,X=ne=>ne===""?null:ne,q=(0,f.N)(()=>{const{theme:ne}=C.config;return{collapsedText:(0,s.css)`
      margin-left: ${ne.spacing.md};
      font-size: ${ne.typography.size.sm};
      color: ${ne.colors.textWeak};
    `}});class G extends l.PureComponent{constructor(){super(...arguments),this.backendSrv=M.IB,this.dataSourceSrv=(0,a.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!p.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:r.Gu.NotStarted,series:[],timeRange:(0,i.E2)()}},this.onChangeDataSource=async(le,_)=>{const{dsSettings:Q}=this.state,ae=Q?await(0,a.l)().get(Q.uid):void 0,oe=await(0,a.l)().get(le.uid),J=_||await(0,N.y)(oe,le.uid,this.state.queries,ae),ee=await this.dataSourceSrv.get(le.name);this.onChange({queries:J,dataSource:{name:le.name,uid:le.uid,...(0,g.p$)(le)}}),this.setState({queries:J,dataSource:ee,dsSettings:le}),_&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:le}=this.state;this.onQueriesChange((0,I.U7)(le,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,I.U7)(this.state.queries,S.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=le=>{this.props.onOptionsChange(le),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=le=>{const{dsSettings:_,queries:Q}=this.state;this.onQueriesChange((0,I.U7)(Q,le,_?(0,g.p$)(_):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=le=>{this.onChange({queries:le}),this.setState({queries:le})},this.setScrollRef=le=>{this.setState({scrollElement:le})}}async componentDidMount(){const{options:le,queryRunner:_}=this.props;this.querySubscription=_.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:Q=>this.onPanelDataUpdate(Q)}),this.setNewQueriesAndDatasource(le)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:le}=this.props,_=await(0,a.l)().get(le.dataSource);this.state.dataSource&&_.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(le)}async setNewQueriesAndDatasource(le){try{const _=await this.dataSourceSrv.get(le.dataSource),Q=this.dataSourceSrv.getInstanceSettings(le.dataSource),ae=await this.dataSourceSrv.get(),oe=_.getRef(),J=le.queries.map(ee=>({...(0,I.Ih)(ee)&&_?.getDefaultQuery?.(o.Jk.PanelEditor),datasource:oe,...ee}));this.setState({queries:J,dataSource:_,dsSettings:Q,defaultDataSource:ae})}catch(_){console.error("failed to load data source",_)}}onPanelDataUpdate(le){this.setState({data:le})}newQuery(){const{dsSettings:le,defaultDataSource:_}=this.state,Q=le&&!le.meta.mixed?(0,g.p$)(le):_?_.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(o.Jk.PanelEditor),datasource:Q}}onChange(le){this.props.onOptionsChange({...this.props.options,...le})}renderTopSection(le){const{onOpenQueryInspector:_,options:Q}=this.props,{dataSource:ae,data:oe,dsSettings:J}=this.state;return!J||!ae?null:(0,n.jsx)(H,{data:oe,dataSource:ae,options:Q,dsSettings:J,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:_})}renderQueries(le){const{onRunQueries:_}=this.props,{data:Q,queries:ae}=this.state;return(0,n.jsx)("div",{"aria-label":c.Tp.components.QueryTab.content,children:(0,n.jsx)(U.L,{queries:ae,dsSettings:le,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:_,data:Q})})}isExpressionsSupported(le){return(le.meta.alerting||le.meta.mixed)===!0}renderExtraActions(){return F.m.getAllExtraRenderAction().map((le,_)=>le({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:_})).filter(Boolean)}renderAddQueryRow(le,_){const Q=!(0,O.kN)(le.name);return(0,n.jsxs)(u.Gy,{spacing:"md",align:"flex-start",children:[Q&&(0,n.jsx)(m.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":c.Tp.components.QueryTab.addQuery,children:"Add query"}),C.Ay.expressionsEnabled&&this.isExpressionsSupported(le)&&(0,n.jsx)(m.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:_.expressionButton,"data-testid":"query-tab-add-expression",children:(0,n.jsx)("span",{children:"Expression\xA0"})}),this.renderExtraActions()]})}render(){const{isHelpOpen:le,dsSettings:_}=this.state,Q=te();return(0,n.jsx)(v.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef,children:(0,n.jsxs)("div",{className:Q.innerWrapper,children:[this.renderTopSection(Q),_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:Q.queriesWrapper,children:this.renderQueries(_)}),this.renderAddQueryRow(_,Q),le&&(0,n.jsx)(x.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp,children:(0,n.jsx)(P,{pluginId:_.meta.id})})]})]})})}}const te=(0,f.N)(()=>{const{theme:ne}=C.Ay;return{innerWrapper:(0,s.css)`
      display: flex;
      flex-direction: column;
      padding: ${ne.spacing.md};
    `,dataSourceRow:(0,s.css)`
      display: flex;
      margin-bottom: ${ne.spacing.md};
    `,dataSourceRowItem:(0,s.css)`
      margin-right: ${ne.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,s.css)`
      flex-grow: 1;
      margin-right: ${ne.spacing.inlineFormMargin};
    `,queriesWrapper:(0,s.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,s.css)``,expressionButton:(0,s.css)`
      margin-right: ${ne.spacing.sm};
    `}});function H({dataSource:ne,options:le,data:_,dsSettings:Q,onDataSourceChange:ae,onOptionsChange:oe,onOpenQueryInspector:J}){const ee=te(),[de,xe]=(0,l.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{"data-testid":c.Tp.components.QueryTab.queryGroupTopSection,children:[(0,n.jsxs)("div",{className:ee.dataSourceRow,children:[(0,n.jsx)(E.I,{htmlFor:"data-source-picker",width:"auto",children:"Data source"}),(0,n.jsx)("div",{className:ee.dataSourceRowItem,children:(0,n.jsx)(se,{options:le,onChange:async(re,ue)=>await ae?.(re,ue),isDataSourceModalOpen:!!p.Ny.getSearchObject().firstPanel})}),ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:ee.dataSourceRowItem,children:(0,n.jsx)(m.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>xe(!0),"data-testid":"query-tab-help-button"})}),(0,n.jsx)("div",{className:ee.dataSourceRowItemOptions,children:(0,n.jsx)(z,{options:le,dataSource:ne,data:_,onChange:re=>{oe?.(re)}})}),J&&(0,n.jsx)("div",{className:ee.dataSourceRowItem,children:(0,n.jsx)(m.$n,{variant:"secondary",onClick:J,"aria-label":c.Tp.components.QueryTab.queryInspectorButton,children:"Query inspector"})})]})]}),ne&&(0,j.Hv)(ne.uid)&&(0,n.jsx)(L.c,{pluginId:ne.type,pluginType:d.QE.datasource,angularSupportEnabled:C.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})]}),de&&(0,n.jsx)(x.a,{title:"Data source help",isOpen:!0,onDismiss:()=>xe(!1),children:(0,n.jsx)(P,{pluginId:Q.meta.id})})]})}function se({options:ne,onChange:le,..._}){const[Q,ae]=(0,l.useState)(!!_.isDataSourceModalOpen);(0,l.useEffect)(()=>{p.Ny.getSearchObject().firstPanel&&p.Ny.partial({firstPanel:null},!0)},[]);const oe={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ne.dataSource,uploadFile:!0,onChange:async(J,ee)=>{await le(J,ee),ae(!1)}};return(0,n.jsxs)(n.Fragment,{children:[Q&&(0,n.jsx)(R.p,{...oe,onDismiss:()=>ae(!1)}),(0,n.jsx)(T.s,{...oe})]})}},42972:(k,A,e)=>{"use strict";e.d(A,{nm:()=>ae,Dh:()=>le});var n=e(39741),s=e(13752),l=e(64423),r=e(44240),i=e(39697),g=e(81160),o=e(67791),d=e(93031),c=e(71030),a=e(69850),p=e(1005),u=e(65961),m=e(3591),v=e(2543);function x(oe){let J=[];const ee=(0,v.partition)(oe,"id"),de=(0,v.groupBy)(ee[0],"id");return J=(0,v.map)(de,xe=>xe.length>1&&!(0,v.every)(xe,f)?(0,v.find)(xe,re=>re.eventType!=="panel-alert"):(0,v.head)(xe)),J=(0,v.concat)(J,ee[1]),J}function f(oe){return oe.eventType==="panel-alert"}var E=e(74856),h=e(62467),y=e(65474),b=e(66847),D=e(69862),P=e(16126),C=e(32264),M=e(19347),I=e(90569),R=e(28444),T=e(27302),S=e(7436);class L{canRun(J){return J?!!(!J.annotationQuery||J.annotations):!1}run({annotation:J,datasource:ee,dashboard:de,range:xe}){if(!this.canRun(ee))return(0,h.of)([]);const re={};return(0,T.b)({dashboard:de,range:xe,panel:re},ee,J).pipe((0,g.T)(ue=>ue.events??[]),(0,b.W)(S.SD))}}var O=e(42493);class j{canRun(J){return J?(0,O.E7)(J)?!0:!!(J.annotationQuery&&!J.annotations):!1}run({annotation:J,datasource:ee,dashboard:de,range:xe}){return this.canRun(ee)?(0,y.H)(ee.annotationQuery({range:xe,rangeRaw:xe.raw,annotation:J,dashboard:de})).pipe((0,b.W)(S.SD)):(0,h.of)([])}}class N{constructor(J=[new j,new L]){this.runners=J}canWork({dashboard:J}){return!!J.annotations.list.find(N.getAnnotationsToProcessFilter)}work(J){if(!this.canWork(J))return(0,S.$)();const{dashboard:ee,range:de}=J;let xe=ee.annotations.list.filter(N.getAnnotationsToProcessFilter);C.$.publicDashboardAccessToken&&xe.length>0&&(xe=[xe[0]]);const re=xe.map(ue=>{let Te;if(C.$.publicDashboardAccessToken){const ge=new I.X;Te=(0,h.of)(ge).pipe((0,b.W)(S.H0))}else Te=(0,y.H)((0,M.l)().get(ue.datasource)).pipe((0,b.W)(S.H0));return Te.pipe((0,D.Z)(ge=>{const Oe=this.runners.find(Ue=>Ue.canRun(ge));return Oe?(ee.events.publish(new R.xc(ue)),Oe.run({annotation:ue,datasource:ge,dashboard:ee,range:de}).pipe((0,o.Q)(le().cancellations().pipe((0,P.p)(Ue=>Ue===ue))),(0,g.T)(Ue=>(ee.snapshot&&(ue.snapshotData=(0,v.cloneDeep)(Ue)),C.$.publicDashboardAccessToken?Ue:(0,S.G9)(ue,Ue))),(0,a.j)(()=>{ee.events.publish(new R.yj(ue))}))):(0,h.of)([])}))});return(0,r.h)(re).pipe((0,d.U)(),(0,c.T)((ue,Te)=>ue.concat(Te)),(0,g.T)(ue=>({annotations:ue,alertStates:[]})))}static getAnnotationsToProcessFilter(J){return J.enable&&!J.snapshotData}}var F=e(85595),U=e(43585),w=e(16233),B=e(79938),K=e(49498),W=e(55740),z=e(57220),Y=e(23662),X=e(91309),q=e(99140),G=e(31678);class te{constructor(){this.hasAlertRules={}}canWork({dashboard:J,range:ee}){return!(!J.uid||C.$.publicDashboardAccessToken||ee.raw.to!=="now"||this.hasAlertRules[J.uid]===!1||!(w.TP.hasPermission(G.AccessControlAction.AlertingRuleRead)&&w.TP.hasPermission(G.AccessControlAction.AlertingRuleExternalRead)))}work(J){if(!this.canWork(J))return(0,S.$)();const{dashboard:ee}=J,de=async()=>(await(0,q.JD)(B.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:z.hY,dashboardUid:ee.uid}))).data;return(0,y.H)(de()).pipe((0,g.T)(re=>(0,K.Kw)(re))).pipe((0,g.T)(re=>{this.hasAlertRules[ee.uid]=!1;const ue={};return re.forEach(Te=>Te.rules.forEach(ge=>{if((0,Y.Z8)(ge)&&ge.annotations&&ge.annotations[W.YH.panelID]){this.hasAlertRules[ee.uid]=!0;const Oe=Number(ge.annotations[W.YH.panelID]),Ue=(0,X.S)(ge.state);ue[Oe]?Ue===U.O.Alerting&&ue[Oe].state!==U.O.Alerting?ue[Oe].state=U.O.Alerting:Ue===U.O.Pending&&ue[Oe].state!==U.O.Alerting&&ue[Oe].state!==U.O.Pending&&(ue[Oe].state=U.O.Pending):ue[Oe]={state:Ue,id:Object.keys(ue).length,panelId:Oe,dashboardId:ee.id}}})),{alertStates:Object.values(ue),annotations:[]}}),(0,b.W)(S.Zr))}}class H{constructor(J,ee=(0,E.jG)(),de=[new te,new F.F,new N]){this.dashboard=J,this.timeSrv=ee,this.workers=de,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new n.m(1),this.runs=new s.B,this.cancellationStream=new s.B,this.runsSubscription=this.runs.subscribe(xe=>this.executeRun(xe)),this.eventsSubscription=J.events.subscribe(m._,xe=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(J){this.runs.next(J)}getResult(J){return this.results.asObservable().pipe((0,g.T)(ee=>{const de=(0,S.FK)(ee.annotations,J),xe=ee.alertStates.find(re=>!!J&&re.panelId===J);return{annotations:x(de),alertState:xe}}))}executeRun(J){const de=this.workers.filter(ge=>ge.canWork(J)).map(ge=>ge.work(J)),xe=new l.yU,re=(0,r.h)(de).pipe((0,o.Q)(this.runs.asObservable()),(0,d.U)(),(0,c.T)((ge,Oe)=>(ge.annotations=ge.annotations.concat(Oe.annotations),ge.alertStates=ge.alertStates.concat(Oe.alertStates),ge)),(0,a.j)(()=>{xe.unsubscribe()}),(0,p.u)()),ue=new l.yU,Te=(0,i.O)(200).pipe((0,u.u)({annotations:[],alertStates:[]}),(0,o.Q)(re),(0,a.j)(()=>{ue.unsubscribe()}));ue.add(Te.subscribe(ge=>{this.results.next(ge)})),xe.add(re.subscribe(ge=>{this.results.next(ge)}))}cancel(J){this.cancellationStream.next(J)}cancellations(){return this.cancellationStream.asObservable().pipe((0,p.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let se;function ne(oe){se&&se.destroy(),se=oe}function le(){if(!se)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return se}let _;function Q(oe){_=oe}function ae(oe){_||(_=({dashboard:ee,timeSrv:de,workers:xe})=>new H(ee,de,xe));const J=_(oe);return ne(J),J}},90569:(k,A,e)=>{"use strict";e.d(A,{X:()=>a});var n=e(62467),s=e(65474),l=e(40187),r=e(14236),i=e(17172),g=e(32264),o=e(57220),d=e(68706);const c="-- Public --";class a extends l.mA{constructor(){let u={};super({name:"public-ds",id:0,type:"public-ds",meta:u,uid:c,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(m){return{...m,queryType:d.nj.Annotations,refId:"anno"}}}}query(u){return u.targets.length?u.targets[0]?.datasource?.uid===o.vv?(0,s.H)(this.getAnnotations(u)):(0,n.of)({data:[]}):(0,n.of)({data:[]})}async getAnnotations(u){const{range:{to:m,from:v}}=u,x={from:v.valueOf(),to:m.valueOf()},f=await(0,i.AI)().get(`/api/public/dashboards/${g.$.publicDashboardAccessToken}/annotations`,x);return{data:[(0,r.Vc)(f)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(k,A,e)=>{"use strict";e.d(A,{F:()=>l});var n=e(62467),s=e(7436);class l{canWork({dashboard:i}){return i?.annotations?.list?.some(g=>g.enable&&!!g.snapshotData)}work(i){if(!this.canWork(i))return(0,s.$)();const g=this.getAnnotationsFromSnapshot(i.dashboard);return(0,n.of)({annotations:g,alertStates:[]})}getAnnotationsFromSnapshot(i){return(i?.annotations?.list?.filter(c=>c.enable)).filter(c=>!!c.snapshotData).reduce((c,a)=>c.concat((0,s.G9)(a,a.snapshotData)),[])}getAnnotationsInSnapshot(i,g){const o=this.getAnnotationsFromSnapshot(i);return(0,s.FK)(o,g)}}},7436:(k,A,e)=>{"use strict";e.d(A,{$:()=>u,FK:()=>x,G9:()=>f,H:()=>E,H0:()=>p,SD:()=>a,Zr:()=>m});var n=e(2543),s=e.n(n),l=e(62467),r=e(78368),i=e(12091),g=e(32264),o=e(99140),d=e(3169),c=e(16001);function a(h){return h.cancelled?(0,l.of)([]):(v("AnnotationQueryRunner failed",h),(0,l.of)([]))}function p(h){return v("Failed to retrieve datasource",h),(0,l.of)(void 0)}const u=()=>(0,l.of)({annotations:[],alertStates:[]});function m(h){return h.cancelled||v("DashboardQueryRunner failed",h),u()}function v(h,y){const b=(0,i.u)(y);console.error("handleAnnotationQueryRunnerError",b);const D=(0,d.gi)(h,b.message);(0,o.JD)((0,c.dx)(D))}function x(h,y){return y==null?h:h.filter(b=>{let D;if(D=b.source,!D)return!0;if(D.filter){const P=(D.filter.ids??[]).includes(y);if(D.filter.exclude){if(P)return!1}else if(!P)return!1}return b.panelId&&b.source.type==="dashboard"?b.panelId===y:!0})}function f(h,y){h.snapshotData&&(h=(0,n.cloneDeep)(h),delete h.snapshotData);for(const b of y)switch(b.source=h,b.color=g.$.theme2.visualization.getColorByName(h.iconColor),b.type=h.name,b.isRegion=!!(b.timeEnd&&b.time!==b.timeEnd),b.newState?.toLowerCase()){case"pending":b.color="yellow";break;case"alerting":b.color="red";break;case"ok":b.color="green";break;case"normal":b.color="green";break;case"no_data":b.color="gray";break;case"nodata":b.color="gray";break}return y}function E(h){if(!h||!h.length)return[];const y=[];for(const b of h){const D=new r.R(b);for(let P=0;P<b.length;P++){const C=(0,n.cloneDeep)(D.get(P));y.push(C)}}return y}},80924:(k,A,e)=>{"use strict";e.d(A,{Z:()=>O,S:()=>L});var n=e(2543),s=e(39741),l=e(62467),r=e(69862),i=e(81160),g=e(66847),o=e(39070),d=e(14236),c=e(43127),a=e(90708),p=e(21423),u=e(52622),m=e(2514),v=e(41987),x=e(65879),f=e(12091),E=e(26657),h=e(47118),y=e(31193),b=e(23989),D=e(14348),P=e(42972),C=e(49510),M=e(33948);function I(N=[]){N.forEach(F=>{F.meta={...F.meta,dataTopic:u.QR.Annotations}})}function R(N,F){return(0,C.z)([N,F]).pipe((0,r.Z)(U=>{const[w,B]=U;if(B.annotations?.length||B.alertState){w.annotations||(w.annotations=[]);const K=w.annotations.concat((0,M.I)(B.annotations));I(K);const W=B.alertState;return(0,l.of)({...w,annotations:K,alertState:W})}return I(w.annotations),(0,l.of)(w)}))}var T=e(39374);let S=100;function L(){return"Q"+S++}class O{constructor(F){this.templateSrv=(0,b.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new s.m(1),this.dataConfigSource=F}getData(F){const{withFieldConfig:U,withTransforms:w}=F;let B=1,K,W=[],z=[],Y,X=!0,q=-1;if(this.dataConfigSource.snapshotData){const G={state:o.Gu.Done,series:this.dataConfigSource.snapshotData.map(te=>(0,d.Vc)(te)),timeRange:(0,c.E2)(),structureRev:B};return(0,l.of)(G)}return this.subject.pipe((0,r.Z)(G=>{let te=this.dataConfigSource.getFieldOverrideOptions(),H=this.dataConfigSource.getTransformations();if(G.series===z&&K?.fieldConfig===te?.fieldConfig&&Y===H)return(0,l.of)({...G,structureRev:B,series:W});K=te,Y=H,z=G.series;let se=(0,l.of)(G);return w&&(se=this.applyTransformations(G)),se.pipe((0,i.T)(ne=>{let le=ne,_=!1;if(U&&ne.series?.length){if(q===this.dataConfigSource.configRev){let Q;for(const ae of ne.series)if((0,h.o$)(ae)){Q=ae;break}Q&&!Q.packetInfo.schemaChanged&&W[0].fields.length===Q.fields.length&&(le={...le,series:W.map((ae,oe)=>({...ae,length:ne.series[oe].length,fields:ae.fields.map((J,ee)=>({...J,values:ne.series[oe].fields[ee].values,state:{...J.state,calcs:void 0,range:void 0}}))}))},_=!0)}te!=null&&(X||!_)&&(q=this.dataConfigSource.configRev,le={...le,series:(0,a.we)({timeZone:ne.request?.timezone??"browser",data:le.series,...te})},le.annotations&&(le.annotations=(0,a.we)({data:le.annotations,...te,fieldConfig:{defaults:{},overrides:[]}})),X=!1)}return!_&&!(0,p.J3)(W,le.series,p.bW)&&B++,W=le.series,{...le,structureRev:B}}))}))}applyTransformations(F){const U=this.dataConfigSource.getTransformations();if(U&&U.every(X=>X.disabled)||!U||U.length===0)return(0,l.of)(F);const B={interpolate:X=>this.templateSrv.replace(X,F?.request?.scopedVars)};let K=U.filter(X=>X.topic==null||X.topic===u.QR.Series),W=U.filter(X=>X.topic===u.QR.Annotations),z=(0,m.m)(K,F.series,B),Y=(0,m.m)(W,F.annotations??[],B);return(0,n.merge)(z,Y).pipe((0,i.T)(X=>{let G=X.some(te=>te.meta?.dataTopic===u.QR.Annotations)?{annotations:X}:{series:X};return{...F,...G}}),(0,g.W)(X=>(console.warn("Error running transformation:",X),(0,l.of)({...F,state:o.Gu.Error,errors:[(0,f.u)(X)]}))))}async run(F){const{queries:U,timezone:w,datasource:B,panelId:K,panelPluginId:W,dashboardUID:z,timeRange:Y,timeInfo:X,cacheTimeout:q,queryCachingTTL:G,maxDataPoints:te,scopedVars:H,minInterval:se,app:ne}=F;if((0,D.kN)(B)){this.pipeToSubject((0,D.mw)(F,U[0]),K,!0);return}const le=this.shouldAddErrorWhenDatasourceVariableIsMultiple(B,H),_={app:ne??v.Jk.Dashboard,requestId:L(),timezone:w,panelId:K,panelPluginId:W,dashboardUID:z,range:Y,timeInfo:X,interval:"",intervalMs:0,targets:(0,n.cloneDeep)(U),maxDataPoints:te,scopedVars:H||{},cacheTimeout:q,queryCachingTTL:G,startTime:Date.now(),rangeRaw:Y.raw};try{const Q=await j(B,_.scopedVars),ae=Q.meta?.mixed;_.targets=_.targets.map(ee=>{const de=ee.datasource?.type===E.dR.type;return(!ee.datasource||ee.datasource.uid!==Q.uid&&!ae&&!de)&&(ee.datasource=Q.getRef()),ee});const oe=se?this.templateSrv.replace(se,_.scopedVars):Q.interval,J=x.calculateInterval(Y,te,oe);_.scopedVars=Object.assign({},_.scopedVars,{__interval:{text:J.interval,value:J.interval},__interval_ms:{text:J.intervalMs.toString(),value:J.intervalMs}}),_.interval=J.interval,_.intervalMs=J.intervalMs,_.filters=this.templateSrv.getAdhocFilters(Q.name,!0),this.lastRequest=_,this.pipeToSubject((0,T.BN)(Q,_),K,!1,le)}catch(Q){this.pipeToSubject((0,l.of)({state:o.Gu.Error,error:(0,f.u)(Q),series:[],timeRange:_.range}),K)}}pipeToSubject(F,U,w=!1,B=!1){this.subscription&&this.subscription.unsubscribe();let K=F;const W=this.dataConfigSource.getDataSupport();if(W.alertStates||W.annotations){const z=this.dataConfigSource;K=R(F,(0,P.Dh)().getResult(z.id))}this.subscription=K.subscribe({next:z=>{const Y=this.lastResult,X=w?z:(0,d.N$)(z,Y);if(Y!=null&&X.state!==o.Gu.Streaming){let q=(0,p.J3)(Y.series??[],X.series??[],(H,se)=>H===se),G=(0,p.J3)(Y.annotations??[],X.annotations??[],(H,se)=>H===se),te=Y.state===X.state;if(q&&(X.series=Y.series),G&&(X.annotations=Y.annotations),q&&G&&te)return}this.lastResult=X,B&&(X.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],X.state=o.Gu.Error),this.subject.next(X)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===o.Gu.Loading||this.lastResult.state===o.Gu.Streaming)&&this.subject.next({...this.lastResult,state:o.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new s.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(F){this.lastResult=F.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(F){this.lastResult=F}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(F,U){let w=!1;return F?.uid?.startsWith("${")&&this.templateSrv.replace(F.uid,U,B=>(Array.isArray(B)&&B.length>1&&(w=!0),"")),w}}async function j(N,F){return N&&typeof N=="object"&&"query"in N?N:await(0,y.tR)().get(N,F)}},81583:(k,A,e)=>{"use strict";e.d(A,{N:()=>s});var n=e(69850);function s(l,r){return(0,n.j)(()=>{r&&l.resolveCancelerIfExists(r)})}},72955:(k,A,e)=>{"use strict";e.d(A,{B:()=>s});var n=e(21423);const s=(l,r)=>{let i=1;return r?.structureRev&&r.series&&(i=r.structureRev,(0,n.J3)(l.series,r.series,n.bW)||i++),l.structureRev=i,l}},39374:(k,A,e)=>{"use strict";e.d(A,{BN:()=>F});var n=e(2543),s=e(62467),l=e(44240),r=e(39697),i=e(65474),g=e(81160),o=e(66847),d=e(59099),c=e(1005),a=e(65961),p=e(67791),u=e(39070),m=e(52622),v=e(85858),x=e(41987),f=e(12091),E=e(32264),h=e(26657),y=e(27677),b=e(21969),D=e(53478),P=e(34867);const C=(0,P.DW)("features.query");var M=e(81583),I=e(76885),R=e(61298),T=e(14110),S=e(14792);function L(w){let B=!1;return W=>{if(!W.request||B||I.kM.getUrlSearchParams().editPanel!=null||W.state!==u.Gu.Done&&W.state!==u.Gu.Error)return;const Y={eventName:R.n_.DataRequest,source:W.request.app,datasourceName:w.name,datasourceId:w.id,datasourceUid:w.uid,datasourceType:w.type,dataSize:0,panelId:0,panelPluginId:W.request?.panelPluginId,duration:W.request.endTime-W.request.startTime};K(Y,W),W.request.app!==x.Jk.Explore&&W.request.app!==x.Jk.Correlations&&O(Y,W),W.series&&W.series.length>0&&(Y.dataSize=W.series.length),(0,T.G$)(Y),B=!0};function K(W,z){const Y={};for(let q=0;q<z.series.length;q++){const G=z.series[q].refId;G&&!Y[G]&&(Y[G]=z.series[q].meta?.isCachedResponse??!1)}W.totalQueries=Object.keys(Y).length,W.cachedQueries=Object.values(Y).filter(q=>q===!0).length,z.request&&Number.isInteger(z.request.panelId)&&(W.panelId=z.request.panelId);const X=(0,S.UA)().getCurrent();X&&(W.dashboardId=X.id,W.dashboardName=X.title,W.dashboardUid=X.uid,W.folderName=X.meta.folderTitle)}}function O(w,B){B.errors?.length?w.error=B.errors.join(", "):B.error&&(w.error=B.error.message)}function j(w,B){const K=B.panelData.request,W={...B.packets},z=w.key??w.data?.[0]?.refId??"A";W[z]=w;let Y=w.state||u.Gu.Done,X,q;const G=[],te=[];for(const le in W){const _=W[le];if((_.error||_.errors?.length)&&(Y=u.Gu.Error,X=_.error,q=_.errors),_.data&&_.data.length)for(const Q of _.data){if(Q.meta?.dataTopic===m.QR.Annotations){te.push(Q);continue}G.push(Q)}}const H=N(K,Y),se={state:Y,series:G,annotations:te,error:X,errors:q,request:K,timeRange:H},ne=new Set([...B.panelData.traceIds??[],...w.traceIds??[]]);return ne.size>0&&(se.traceIds=Array.from(ne)),{packets:W,panelData:se}}function N(w,B){const K=w.range;return!(0,n.isString)(K.raw.from)||B!==u.Gu.Streaming?K:{...K,from:v.parse(K.raw.from,!1),to:v.parse(K.raw.to,!0)}}function F(w,B,K){let W={panelData:{state:u.Gu.Loading,series:[],request:B,timeRange:B.range},packets:{}};if(!B.targets.length)return B.endTime=Date.now(),W.panelData.state=u.Gu.Done,(0,s.of)(W.panelData);const z=U(w,B,K).pipe((0,g.T)(Y=>{if(!(0,n.map)(Y.data))throw new Error(`Expected response data to be array, got ${typeof Y.data}.`);const X=B.targets.filter(q=>q.hide);for(const q of X)Y.data=Y.data.filter(G=>G.refId!==q.refId);return B.endTime=Date.now(),W=j(Y,W),W.panelData}),(0,o.W)(Y=>(console.error("runRequest.catchError",Y),C.logError(Y),(0,s.of)({...W.panelData,state:u.Gu.Error,error:(0,f.u)(Y)}))),(0,d.M)(L(w)),(0,M.N)(y.IB,B.requestId),(0,c.u)());return(0,l.h)((0,r.O)(200).pipe((0,a.u)(W.panelData),(0,p.Q)(z)),z)}function U(w,B,K){if(B.targets=B.targets.map(z=>(0,b.Ih)(z)?{...w?.getDefaultQuery?.(x.Jk.PanelEditor),...z}:z),E.$.publicDashboardAccessToken)return(0,i.H)(w.query(B));for(const z of B.targets)if((0,h.s9)(z.datasource))return D.Ex.query(B);if(K||(B.targets=B.targets.filter(z=>w.filterQuery?.(z)??!0)),B.targets.length===0)return(0,s.of)({data:[]});const W=K?K(B):w.query(B);return(0,i.H)(W)}},93117:(k,A,e)=>{"use strict";e.d(A,{y:()=>g});var n=e(41987),s=e(73372),l=e(77789),r=e(72574),i=e(26657);async function g(o,d,c,a){let p=c;const u={...o.getRef(),uid:d},m={...o?.getDefaultQuery?.(n.Jk.PanelEditor),datasource:u,refId:"A"};if(a?.meta.id!==o.meta.id){if(o.meta.mixed)return c;if((0,s.Ee)(a)&&(0,s.FL)(o)){const v=await a.exportToAbstractQueries(c);p=await o.importFromAbstractQueries(v)}else if(a&&o.importQueries)p=await o.importQueries(c,a);else{if(a){const v=(0,r.w)(),x=[];let f=o.uid;const E=v.containsTemplate(d);E&&(f=v.replace(o.uid));const h=c.reduce((y,b)=>{if(b.datasource){let D=b.datasource.uid;const P=v.containsTemplate(D);if(P&&(D=v.replace(b.datasource.uid)),D===f&&P===E)return b.refId=(0,l.M)(y),y.concat([b])}return y},x);if(h.length>0)return h}return[m]}}return p.length===0?[m]:p.map(v=>(!(0,i.s9)(v.datasource)&&!o.meta.mixed&&(v.datasource=u),v))}},53477:(k,A,e)=>{"use strict";e.d(A,{G3:()=>g,TF:()=>c,XJ:()=>v,YU:()=>u,d7:()=>p,if:()=>x,r4:()=>i,w7:()=>m});var n=e(64161);const s=null,l=58,r=8,i={label:"A\u2013Z",value:"alpha-asc"},g="search.sections",o="grafana.search.expanded-folder",d=0,c="general",a="Dashboards",p="grafana.search.include.panels",u="grafana.search.layout",m="grafana.search.sort",v={dashboard:n.G.DashDB,folder:n.G.DashFolder,home:n.G.DashHome},x=1e3},97427:(k,A,e)=>{"use strict";e.d(A,{d:()=>i,n:()=>g});var n=e(96540),s=e(13752),l=e(71733),r=e(39601);function i(){const o=(0,n.useRef)(new s.B);return{keyboardEvents:o.current,onKeyDown:d=>{switch(d.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":o.current.next(d);default:}}}}function g(o,d,c){const a=(0,n.useRef)({x:0,y:-1}),[p,u]=(0,n.useState)({x:0,y:-1}),m=(0,n.useRef)();return(0,n.useEffect)(()=>{m.current=c.view.fields.url,a.current.x=0,a.current.y=-1,u({...a.current})},[c]),(0,n.useEffect)(()=>{const v=o.subscribe({next:x=>{switch(x?.code){case"ArrowDown":{a.current.y++,u({...a.current});break}case"ArrowUp":a.current.y=Math.max(0,a.current.y-1),u({...a.current});break;case"ArrowRight":{d>0&&(a.current.x=Math.min(d,a.current.x+1),u({...a.current}));break}case"ArrowLeft":{d>0&&(a.current.x=Math.max(0,a.current.x-1),u({...a.current}));break}case"Enter":if(!m.current)break;const f=a.current.x*d+a.current.y;if(f<0){a.current.x=0,a.current.y=0,u({...a.current});break}const E=m.current.values?.[f];typeof E=="string"&&r.Ny.push(l.I.stripBaseFromUrl(E))}}});return()=>v.unsubscribe()},[o,d]),p}},6204:(k,A,e)=>{"use strict";e.d(A,{B9:()=>g,J$:()=>r,KZ:()=>i,MK:()=>l,Pf:()=>s});var n=e(14110);const s=(d,c)=>{(0,n.rR)(`${d}_viewed`,o(c))},l=(d,c)=>{(0,n.rR)(`${d}_result_clicked`,o(c))},r=(d,c)=>{(0,n.rR)(`${d}_query_submitted`,o(c))},i=(d,{error:c,...a})=>{(0,n.rR)(`${d}_query_failed`,{...o(a),error:c})},g=(d,c,a)=>{(0,n.rR)(`grafana_panel_inspect_${d}_${c}_clicked`,a)},o=d=>({layout:d.layout,starredFilter:d.starred??!1,sort:d.sortValue??"",tagCount:d.tagCount??0,queryLength:d.query?.length??0,includePanels:d.includePanels??!1,deleted:d.deleted??!1})},24439:(k,A,e)=>{"use strict";e.d(A,{getGrafanaSearcher:()=>I});var n=e(32264),s=e(78368),l=e(14236),r=e(57875),i=e(17172),g=e(40957);const o="Loading",d="api/search-v2",c="name_sort";class a{constructor(T){this.fallbackSearcher=T}async search(T){if(T.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(T)}async starred(T){if(T.facet?.length)throw new Error("facets not supported!");const S=await(0,i.AI)().get("api/user/stars");return S?.length?this.doSearchQuery({uid:S,query:T.query??"*"}):{view:new s.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(L,O)=>{},isItemLoaded:L=>!0}}async tags(T){const S={...T,query:T.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},O=(await(0,i.AI)().post(d,S)).frames.map(j=>(0,l.Vc)(j));if(O[0]?.name===o)return this.fallbackSearcher.tags(T);for(const j of O)if(j.fields[0].name==="tag")return m(j);return[]}getSortOptions(){const T=[{value:c,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(n.$.licenseInfo.enabledFeatures.analytics){for(const S of v)T.push({value:`-${S.name}`,label:`${S.display} (most)`}),T.push({value:`${S.name}`,label:`${S.display} (least)`});for(const S of x)T.push({value:`-${S.name}`,label:`${S.display} (recent)`}),T.push({value:`${S.name}`,label:`${S.display} (oldest)`})}return Promise.resolve(T)}async doSearchQuery(T){T=await(0,g.u4)(T);const S={...T,query:T.query??"*",limit:T.limit??p},O=(await(0,i.AI)().post(d,S)).frames.map(K=>(0,l.Vc)(K)),j=O.length?(0,l.Vc)(O[0]):{fields:[],length:0};if(j.name===o)return this.fallbackSearcher.search(T);for(const K of j.fields)K.display=(0,r.J)({field:K,theme:n.$.theme2});j.meta?.custom||(j.meta={...j.meta,custom:{count:j.length,max_score:1}});const N=j.meta.custom;if(N.locationInfo||(N.locationInfo={}),N.sortBy?.length){const K=j.fields.find(W=>W.name===N.sortBy);if(K){const W=f(K.name);N.sortBy=W,K.name=W}}let F=0,U;const w=async()=>{for(;F>B.dataFrame.length;){const K=B.dataFrame.length;if(K>=N.count)return;const W=await(0,i.AI)().post(d,{...S??{},from:K,limit:u}),z=(0,l.Vc)(W.frames[0]);if(!z){console.log("no results",z);return}if(z.fields.length!==B.dataFrame.fields.length){console.log("invalid shape",z,B.dataFrame);return}const Y=z.length+B.dataFrame.length;for(let q=0;q<z.fields.length;q++)B.dataFrame.fields[q].values.push(...z.fields[q].values);B.dataFrame.length=Y;const X=z.meta?.custom;if(X?.locationInfo&&N)for(const[q,G]of Object.entries(X.locationInfo))N.locationInfo[q]=G}U=void 0},B=new s.R(j);return{totalRows:N.count??j.length,view:B,loadMoreItems:async(K,W)=>(F=Math.max(F,W),U||(U=w()),U),isItemLoaded:K=>K<B.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const p=50,u=100;function m(R){const T=R.fields[0].values,S=R.fields[1].values,L=[];for(let O=0;O<R.length;O++)L.push({term:T[O],count:S[O]});return L}const v=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],x=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function f(R){for(const T of v)if(T.name===R)return T.display;for(const T of x)if(T.name===R)return T.display;return R}var E=e(53076);class h{constructor(T){this.parent=T,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(T){if(T.facet?.length)throw new Error("facets not supported!");if(T.sort!=null)throw new Error("custom sorting is not supported yet");if(T.tags?.length||T.ds_uid?.length)return this.parent.search(T);const L=(await this.getCache(T.kind)).search(T.query);return{isItemLoaded:()=>!0,loadMoreItems:async(O,j)=>{},totalRows:L.length,view:L}}async getCache(T){const S=T?T.sort().join(","):"*",L=this.cache.get(S);if(L)try{return await L}catch{return this.cache.delete(S),new y(new s.R({name:"error",fields:[],length:0}))}const O=this.parent.search({kind:T,limit:5e3}).then(j=>new y(j.view));return this.cache.set(S,O),O}async starred(T){return this.parent.starred(T)}async getSortOptions(){return this.parent.getSortOptions()}async tags(T){return this.parent.tags(T)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class y{constructor(T){this.full=T,this.ufuzzy=new E.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new s.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(S=>({...S,values:[]})),length:0})}search(T){if(!T?.length||T==="*")return this.full;const S=this.full.dataFrame.fields,L=this.names,O=S.map(U=>[]);let[j,N,F]=this.ufuzzy.search(L,T,5);for(let U=0;U<S.length;U++){let w=S[U].values,B=O[U];if(N&&F)for(let K=0;K<F.length;K++){let W=N.idx[F[K]];B.push(w[W])}else if(j)for(let K=0;K<j.length;K++){let W=j[K];B.push(w[W])}}return this.empty.dataFrame.fields.forEach((U,w)=>{U.values=O[w]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var b=e(11261),D=e(27677),P=e(53477);class C{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(T,S){const L=await(0,g.u4)(S);return L.query?.length&&L.query!=="*"&&(T.query=L.query),L.kind?.length===1&&P.XJ[L.kind[0]]&&(T.type=P.XJ[L.kind[0]]),L.uid?T.dashboardUID=L.uid:L.location?.length&&(T.folderUIDs=[L.location]),T}async search(T){if(T.facet?.length)throw new Error("facets not supported!");if(T.from!==void 0){if(!T.limit)throw new Error("Must specify non-zero limit parameter when using from");if(T.from/T.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const S=T.limit??(T.from!==void 0?1:P.if),L=T.from!==void 0?T.from/S+1:void 0,O=await this.composeQuery({limit:S,tag:T.tags,sort:T.sort,permission:T.permission,page:L,deleted:T.deleted},T);return this.doAPIQuery(O)}async starred(T){if(T.facet?.length)throw new Error("facets not supported!");const S=await this.composeQuery({limit:T.limit??P.if,tag:T.tags,sort:T.sort,starred:T.starred},T);return this.doAPIQuery(S)}async getSortOptions(){return(await D.IB.get("/api/search/sorting")).sortOptions.map(S=>({value:S.name,label:S.displayName}))}async tags(T){return(await D.IB.get("/api/dashboards/tags")).sort((L,O)=>O.count-L.count)}async doAPIQuery(T){const S=await D.IB.get("/api/search",T),L=[],O=[],j=[],N=[],F=[],U=[],w=[],B=[],K=[];let W;for(let X of S){const q=X.type==="dash-folder"?"folder":"dashboard";L.push(q),O.push(X.title),j.push(X.uid),N.push(X.url),F.push(X.tags),w.push(X.sortMeta),B.push(X.isDeleted??!1),K.push(X.permanentlyDeleteDate?new Date(X.permanentlyDeleteDate):void 0);let G=X.folderUid;!G&&q==="dashboard"&&(G="general"),U.push(G),X.sortMetaName?.length&&(W=X.sortMetaName),X.folderUid&&X.folderTitle?this.locationInfo[X.folderUid]={kind:"folder",name:X.folderTitle,url:X.folderUrl,folderUid:X.folderUid}:q==="folder"&&(this.locationInfo[X.uid]={kind:q,name:X.title,url:X.url,folderUid:X.folderUid})}const z={fields:[{name:"kind",type:b.PU.string,config:{},values:L},{name:"name",type:b.PU.string,config:{},values:O},{name:"uid",type:b.PU.string,config:{},values:j},{name:"url",type:b.PU.string,config:{},values:N},{name:"tags",type:b.PU.other,config:{},values:F},{name:"location",type:b.PU.string,config:{},values:U},{name:"isDeleted",type:b.PU.boolean,config:{},values:B},{name:"permanentlyDeleteDate",type:b.PU.time,config:{},values:K}],length:O.length,meta:{custom:{count:O.length,max_score:1,locationInfo:this.locationInfo}}};W?.length&&w.length&&(z.meta.custom.sortBy=W,z.fields.push({name:W,type:b.PU.number,config:{},values:w}));for(const X of z.fields)X.display=(0,r.J)({field:X,theme:n.$.theme2});const Y=new s.R(z);return{totalRows:z.length,view:Y,loadMoreItems:async(X,q)=>{},isItemLoaded:X=>!0}}}let M;function I(){if(!M){const R=new C,T=n.$.featureToggles.panelTitleSearch;M=T?new a(R):R,T&&location.search.includes("do-frontend-query")&&(M=new h(M))}return M}},40957:(k,A,e)=>{"use strict";e.d(A,{TM:()=>g,cu:()=>o,hI:()=>c,u4:()=>l});var n=e(49952),s=e(14792);async function l(a){return a.query&&a.query.indexOf("folder:current")>=0&&(a={...a,location:await r(),query:a.query.replace("folder:current","").trim()},a.query?.length||(a.query="*")),Promise.resolve(a)}async function r(){try{let a=(0,s.UA)().getCurrent();return a||(await i(500),a=(0,s.UA)().getCurrent()),Promise.resolve(a?.meta?.folderUid)}catch(a){console.error(a)}}function i(a){return new Promise(p=>setTimeout(p,a))}function g(a,p){return a==="dashboard"?"apps":a==="folder"?p?"folder-open":"folder":"question-circle"}function o(a,p){return a&&(0,n.I)(a.uid)?"users-alt":g(a.kind,p)}function d(a){switch(a){case"dashboard":case"folder":case"panel":return a;default:return"dashboard"}}function c(a,p){const u=p?.dataFrame.meta?.custom,m={kind:d(a.kind),uid:a.uid,title:a.name,url:a.url,tags:a.tags??[]},v=u?.sortBy;if(v){const x=a[v];(typeof x=="string"||typeof x=="number")&&(m.sortMetaName=v,m.sortMeta=x)}if(a.location){const x=a.location.split("/"),f=x[x.length-1],E=u?.locationInfo[f];E&&(m.parentTitle=E.name,m.parentKind=E.kind,m.parentUID=f)}return m}},64161:(k,A,e)=>{"use strict";e.d(A,{G:()=>n,P:()=>s});var n=(l=>(l.DashDB="dash-db",l.DashHome="dash-home",l.DashFolder="dash-folder",l))(n||{}),s=(l=>(l.List="list",l.Folders="folders",l))(s||{})},16757:(k,A,e)=>{"use strict";e.d(A,{N1:()=>i,W1:()=>l});var n=e(53477);const s=g=>g?!!(g.query||g.tag?.length>0||g.starred||g.sort):!1,l=()=>{const g=n.G3+".";for(let o=0;o<window.localStorage.length;o++){const d=window.localStorage.key(o);d?.startsWith(g)&&window.localStorage.removeItem(d)}},r=(g="General")=>`${SECTION_STORAGE_KEY}.${g.toLowerCase()}`,i=g=>{const o=Object.entries(g).reduce((d,[c,a])=>{if(a){if(c==="tag"&&!Array.isArray(a))return{...d,tag:[a]}}else return d;return{...d,[c]:a}},{});if(g.folder){const d=`folder:${g.folder}`;return{...o,query:`${d} ${(o.query??"").replace(d,"")}`}}return{...o}}},1936:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>P,EC:()=>y,FW:()=>x,G3:()=>d,L5:()=>D,QM:()=>g,Yh:()=>f,aD:()=>c,c3:()=>b,ch:()=>o,dJ:()=>a,ew:()=>h,jE:()=>p,zh:()=>E});var n=e(65307),s=e(31678);const l={serviceAccount:{},isLoading:!0,tokens:[]},r=(0,n.Z0)({name:"serviceaccount",initialState:l,reducers:{serviceAccountFetchBegin:C=>({...C,isLoading:!0}),serviceAccountFetchEnd:C=>({...C,isLoading:!1}),serviceAccountLoaded:(C,M)=>({...C,serviceAccount:M.payload,isLoading:!1}),serviceAccountTokensLoaded:(C,M)=>({...C,tokens:M.payload,isLoading:!1}),rolesFetchBegin:C=>({...C,rolesLoading:!0}),rolesFetchEnd:C=>({...C,rolesLoading:!1})}}),i=r.reducer,{serviceAccountLoaded:g,serviceAccountTokensLoaded:o,serviceAccountFetchBegin:d,serviceAccountFetchEnd:c,rolesFetchBegin:a,rolesFetchEnd:p}=r.actions,u={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:s.ServiceAccountStateFilter.All},m=(0,n.Z0)({name:"serviceaccounts",initialState:u,reducers:{serviceAccountsFetched:(C,M)=>{const{totalCount:I,perPage:R,...T}=M.payload,S=Math.ceil(I/R);return{...C,...T,totalPages:S,perPage:R,showPaging:S>1,isLoading:!1}},serviceAccountsFetchBegin:C=>({...C,isLoading:!0}),serviceAccountsFetchEnd:C=>({...C,isLoading:!1}),acOptionsLoaded:(C,M)=>({...C,roleOptions:M.payload}),queryChanged:(C,M)=>({...C,query:M.payload,page:0}),pageChanged:(C,M)=>({...C,page:M.payload}),stateFilterChanged:(C,M)=>({...C,serviceAccountStateFilter:M.payload})}}),v=m.reducer,{serviceAccountsFetchBegin:x,serviceAccountsFetchEnd:f,serviceAccountsFetched:E,acOptionsLoaded:h,pageChanged:y,stateFilterChanged:b,queryChanged:D}=m.actions,P={serviceAccountProfile:i,serviceAccounts:v}},8212:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>m,NV:()=>p,Y1:()=>d,j7:()=>o,kH:()=>g,pB:()=>a,s7:()=>c,sF:()=>i,sJ:()=>r});var n=e(65307);const s={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},l=(0,n.Z0)({name:"supportBundles",initialState:s,reducers:{supportBundlesLoaded:(v,x)=>({...v,supportBundles:x.payload,isLoading:!1}),fetchBegin:v=>({...v,isLoading:!0}),fetchEnd:v=>({...v,isLoading:!1}),collectorsFetchBegin:v=>({...v,createBundlePageLoading:!0}),collectorsFetchEnd:v=>({...v,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(v,x)=>({...v,supportBundleCollectors:x.payload,createBundlePageLoading:!1}),setLoadBundleError:(v,x)=>({...v,loadBundlesError:x.payload,supportBundleCollectors:[]}),setCreateBundleError:(v,x)=>({...v,createBundleError:x.payload})}}),{supportBundlesLoaded:r,fetchBegin:i,fetchEnd:g,supportBundleCollectorsLoaded:o,collectorsFetchBegin:d,collectorsFetchEnd:c,setLoadBundleError:a,setCreateBundleError:p}=l.actions,m={supportBundles:l.reducer}},34655:(k,A,e)=>{"use strict";e.d(A,{$T:()=>m,$u:()=>o,Ay:()=>h,EC:()=>g,L5:()=>i,Q9:()=>r,dJ:()=>d,jE:()=>c,tC:()=>v});var n=e(65307);const s={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},l=(0,n.Z0)({name:"teams",initialState:s,reducers:{teamsLoaded:(y,b)=>{const{totalCount:D,perPage:P,...C}=b.payload,M=Math.ceil(D/P);return{...y,...C,totalPages:M,perPage:P,hasFetched:!0}},queryChanged:(y,b)=>({...y,page:1,query:b.payload}),pageChanged:(y,b)=>({...y,page:b.payload}),sortChanged:(y,b)=>({...y,sort:b.payload,page:1}),rolesFetchBegin:y=>({...y,rolesLoading:!0}),rolesFetchEnd:y=>({...y,rolesLoading:!1})}}),{teamsLoaded:r,queryChanged:i,pageChanged:g,sortChanged:o,rolesFetchBegin:d,rolesFetchEnd:c}=l.actions,a=l.reducer,p={team:{},members:[],groups:[],searchMemberQuery:""},u=(0,n.Z0)({name:"team",initialState:p,reducers:{teamLoaded:(y,b)=>({...y,team:b.payload}),teamMembersLoaded:(y,b)=>({...y,members:b.payload}),setSearchMemberQuery:(y,b)=>({...y,searchMemberQuery:b.payload}),teamGroupsLoaded:(y,b)=>({...y,groups:b.payload})}}),{teamLoaded:m,teamGroupsLoaded:v,teamMembersLoaded:x,setSearchMemberQuery:f}=u.actions,E=u.reducer,h={teams:a,team:E}},23989:(k,A,e)=>{"use strict";e.d(A,{w:()=>ne});var n=e(2543),s=e(95344),l=e(19347),r=e(72574),i=e(80943),g=e(52622),o=e(73788),d=e(20601),c=e(13344),a=e(24240),p=e(87421),u=e(75096);let m={};function v(le){const _=m[le];return _||(m[le]=(0,n.property)(le))}class x{constructor(_,Q,ae){this.state={name:_.name,value:Q,text:ae,type:_.type}}getValue(_){let{value:Q}=this.state;return Q==="string"||Q==="number"||Q==="boolean"?Q:String(Q)}getValueText(){const{value:_,text:Q}=this.state;return typeof Q=="string"?_===c.To?c.Zm:Q:Array.isArray(Q)?Q.join(" + "):(console.log("value",Q),String(Q))}}let f;function E(le,_,Q){return f?(f.state.name=le.name,f.state.type=le.type,f.state.value=_,f.state.text=Q):f=new x(le,_,Q),f}function h(le,_,Q,ae){if(Q=Q||{},le==null||(0,a.EW)(Q)&&_!==g.$m.QueryParam)return"";if(!Array.isArray(le)&&typeof le=="object"&&(le=`${le}`),typeof _=="function")return _(le,Q,h);_||(_=g.$m.Glob);let oe=_.split(":");oe.length>1?(_=oe[0],oe=oe.slice(1)):oe=[];let J=i.vz.getIfExists(_);J||(console.error(`Variable format ${_} not found. Using glob format as fallback.`),J=i.vz.get(g.$m.Glob));const ee=E(Q,le,ae??le);return J.formatter(le,oe,ee)}var y=e(84743),b=e.n(y),D=e(6709),P=e(76885),C=e(1933),M=e(74856),I=e(25304),R=e(83195),T=e(11261),S=e(92461),L=e(57875),O=e(28240),j=e(8249);function N(le,_,Q){return new Proxy({},{get:(ae,oe)=>{if(oe==="name")return le.name;if(oe==="displayName")return(0,O.Ct)(le,_,Q);if(oe==="labels"||oe==="formattedLabels")return le.labels?{...le.labels,__values:Object.values(le.labels).sort().join(", "),toString:()=>(0,j.h6)(le.labels,"",!0)}:""}})}function F(le,_,Q,ae){const oe=U(le,_,Q);return h(oe,ae)}function U(le,_,Q){const ae=Q?.__dataContext;if(!ae)return le;const{frame:oe,rowIndex:J,field:ee,calculatedValue:de}=ae.value;if(de)switch(_){case"numeric":return de.numeric.toString();case"raw":return de.numeric;case"time":return"";case"text":default:return(0,R.cN)(de)}if(J===void 0)return le;if(_==="time"){const Te=oe.fields.find(ge=>ge.type===T.PU.time);return Te?Te.values[J]:void 0}const xe=ee.values[J];if(_==="raw")return xe;const ue=(ee.display??K())(xe);switch(_){case"numeric":return ue.numeric;case"text":return ue.text;default:return(0,R.cN)(ue)}}function w(le,_,Q,ae){const oe=Q?.__dataContext;if(!oe||!_)return le;const{frame:J,rowIndex:ee}=oe.value;if(ee===void 0||_===void 0)return le;const de={name:J.name,refId:J.refId,fields:(0,S.F)({frame:J,rowIndex:ee})},xe=v(_)(de)??"";return h(xe,ae)}let B;function K(){return B||(B=(0,L.J)()),B}function W(le,_,Q,ae){const oe=Q?.__dataContext;if(!oe||_!=="name")return le;const{frame:J,frameIndex:ee}=oe.value,de=(0,O.Ri)(J,ee);return h(de,ae)}function z(le,_,Q,ae){const oe=Q?.__dataContext;if(!oe||_===void 0||_==="")return le;const{frame:J,field:ee,data:de}=oe.value,xe=N(ee,J,de),re=v(_)(xe)??"";return h(re,ae)}const Y={__value:F,__data:w,__series:W,__field:z,[D.c.includeVars]:X,[D.c.keepTime]:q,__timezone:G};function X(le,_,Q){const ae=(0,I.z)(Q);return P.kM.toUrlParams(ae)}function q(){return P.kM.toUrlParams((0,M.jG)().timeRangeForUrl())}function G(){const le=(0,C.O)({timeZone:(0,M.jG)().timeModel?.getTimezone()});return le==="browser"?b().tz.guess():le}const te={getFilteredVariables:p.bZ,getVariables:p.UN,getVariableWithName:p._2};class H{constructor(_=te){this.dependencies=_,this.regex=u.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(_,Q){this._variables=_,this._timeRange=Q,this.updateIndex()}get variables(){return(0,s.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,o.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?i.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const _=Q=>Q||Q==="";if(this.index=this._variables.reduce((Q,ae)=>(ae.current&&(ae.current.isNone||_(ae.current.value))&&(Q[ae.name]=ae),Q),{}),this.timeRange){const Q=this.timeRange.from.valueOf().toString(),ae=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:Q,text:Q}},__to:{current:{value:ae,text:ae}}}}}updateTimeRange(_){this._timeRange=_,this.updateIndex()}variableInitialized(_){this.index[_.name]=_}getAdhocFilters(_,Q){let ae=[],oe=(0,l.l)().getInstanceSettings(_);if(!oe)return[];!Q&&!this._adhocFiltersDeprecationWarningLogged.get(oe.type)&&((0,s.l)(`DataSource ${oe.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(oe.type,!0));for(const J of this.getAdHocVariables()){const ee=J.datasource?.uid;(ee===oe.uid||ee?.indexOf("$")===0&&this.replace(ee)===oe.uid)&&(ae=ae.concat(J.filters))}return ae}setGrafanaVariable(_,Q){this.grafanaVariables.set(_,Q)}setGlobalVariable(_,Q){(0,s.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[_]:{current:Q}}}getVariableName(_){this.regex.lastIndex=0;const Q=this.regex.exec(_);return Q?Q.slice(1).find(oe=>oe!==void 0):null}containsTemplate(_){if(!_)return!1;const Q=this.getVariableName(_),ae=Q&&this.getVariableAtIndex(Q);return ae!=null}variableExists(_){return(0,s.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(_)}highlightVariablesAsHtml(_){return!_||!(0,n.isString)(_)?_:(_=(0,n.escape)(_),this._replaceWithVariableRegex(_,void 0,(Q,ae)=>this.getVariableAtIndex(ae)?'<span class="template-variable">'+Q+"</span>":Q))}getAllValue(_){if(_.allValue)return _.allValue;const Q=[];for(let ae=1;ae<_.options.length;ae++)Q.push(_.options[ae].value);return Q}getVariableValue(_,Q){return Q?v(Q)(_.value):_.value}getVariableText(_,Q){return _.value===Q||typeof Q!="string"?_.text:Q}replace(_,Q,ae,oe){if(Q&&Q.__sceneObject){const J=Q.__sceneObject.value.valueOf();return i.jh.interpolate(J,_,Q,ae,oe)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?i.jh.interpolate(window.__grafanaSceneContext,_,Q,ae,oe):_?(this.regex.lastIndex=0,this._replaceWithVariableRegex(_,ae,(J,ee,de,xe)=>{const re=this._evaluateVariableExpression(J,ee,de,xe,Q);return oe&&oe.push({match:J,variableName:ee,fieldPath:de,format:xe,value:re,found:re!==J}),re})):_??""}_evaluateVariableExpression(_,Q,ae,oe,J){const ee=this.getVariableAtIndex(Q),de=J?.[Q];if(de){const Te=this.getVariableValue(de,ae),ge=this.getVariableText(de,Te);if(Te!=null)return h(Te,oe,ee,ge)}if(!ee){const Te=Y[Q];return Te?Te(_,ae,J,oe):_}if(oe===g.$m.QueryParam||(0,a.EW)(ee)){const Te=d.B.get(ee.type).getValueForUrl(ee),ge=(0,a.EW)(ee)?ee.id:ee.current.text;return h(Te,oe,ee,ge)}const xe=this.grafanaVariables.get(ee.current.value);if(xe)return h(xe,oe,ee);let re=ee.current.value,ue=ee.current.text;if(this.isAllValue(re)&&(re=this.getAllValue(ee),ue=c.Zm,ee.allValue&&oe!==g.$m.Text&&oe!==g.$m.PercentEncode))return this.replace(re);if(ae){const Te=this.getVariableValue({value:re,text:ue},ae);if(Te!=null)return h(Te,oe,ee,ue)}return h(re,oe,ee,ue)}_replaceWithVariableRegex(_,Q,ae){return this.regex.lastIndex=0,_.replace(this.regex,(oe,J,ee,de,xe,re,ue)=>ae(oe,J||ee||xe,re,de||ue||Q))}isAllValue(_){return _===c.To||Array.isArray(_)&&_[0]===c.To}replaceWithText(_,Q){return(0,s.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(_,Q,"text")}getVariableAtIndex(_){if(_)return this.index[_]?this.index[_]:this.dependencies.getVariableWithName(_)}getAdHocVariables(){return this.dependencies.getFilteredVariables(a.EW)}}const se=new H;(0,r.d)(se);const ne=()=>se},29352:(k,A,e)=>{"use strict";e.d(A,{v:()=>O});var n=e(4200),s=e(80943);function l({title:j,unit:N}){return s.d0.timeseries().setTitle(j).setUnit(N).setOption("legend",{showLegend:!1}).setCustomFieldConfig("fillOpacity",9)}function r({description:j,mainQueryExpr:N,breakdownQueryExpr:F,unit:U}){const w={title:`${n.Rp}`,unit:U},B={refId:"A",expr:N,legendFormat:j},K={...w,title:j,queries:[B],variant:"main",vizBuilder:()=>l({...K})},W={...K,title:`${n.Rp}`,queries:[{...B,legendFormat:j}],vizBuilder:()=>l(W),variant:"preview"},z={...w,queries:[{refId:"A",expr:F,legendFormat:`{{${n.aZ}}}`}],vizBuilder:()=>l(z),variant:"breakdown"};return{preview:W,main:K,breakdown:z,variants:[]}}const i=`${n.Rp}${n.ui}`,g=`rate(${i}[$__rate_interval])`;function o(j){return j?g:i}const d={avg:"average",sum:"overall"};function c(j){return d[j]||j}function a({agg:j,rate:N,unit:F}){const U=o(N),w=N?`${c(j)} per-second rate`:`${c(j)}`,B=`${n.Rp} (${w})`,K=`${j}(${U})`,W=`${j}(${U})by(${n.aZ})`;return r({description:B,mainQueryExpr:K,breakdownQueryExpr:W,unit:F})}var p=e(8620);const u=new Set(["count","total"]),m=new Set(["sum","bucket"]),v={count:"sum",total:"sum"};function x(j){return j==="total"}function f(j){const N=j.at(-1);if(N==null||m.has(N))throw new Error(`This function does not support a metric suffix of "${N}"`);const F=u.has(N),U=v[N]||"avg",w=x(N)?j.at(-2):N,B=F?(0,p.MM)(w):(0,p.l_)(w);return{agg:U,unit:B,rate:F}}function E(j){const N=f(j);return a(N)}const h={generator:E};var y=e(52995);function b({title:j,unit:N}){return s.d0.heatmap().setTitle(j).setUnit(N).setOption("calculate",!1).setOption("color",{mode:y.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function D({title:j,unit:N}){return s.d0.timeseries().setTitle(j).setUnit(N).setCustomFieldConfig("fillOpacity",9)}function P(j){const N=`${n.Rp}`,F=j.at(-2),U=(0,p.l_)(F),w={title:N,unit:U},B={...w,variant:"p50",queries:[R(50)],vizBuilder:()=>l(B)},K={...w,variant:"p50",queries:[R(50,[n.aZ])],vizBuilder:()=>l(K)},W={...w,variant:"percentiles",queries:[99,90,50].map(Y=>R(Y)),vizBuilder:()=>D(W)},z={...w,variant:"heatmap",queries:[I()],vizBuilder:()=>b(z)};return{preview:B,main:W,variants:[W,z],breakdown:K}}const C=`rate(${n.Rp}${n.ui}[$__rate_interval])`;function M(j=[]){return`sum by(${["le",...j].join(", ")}) (${C})`}function I(j=[]){return{refId:"Heatmap",expr:M(j),format:"heatmap"}}function R(j,N=[]){const F=j/100;let U=`${j}th Percentile`;return N[0]&&(U=`{{${N[0]}}}`),{refId:`Percentile${j}`,expr:`histogram_quantile(${F}, ${M(N)})`,legendFormat:U}}function T(j){if(j.at(-1)!=="sum")throw new Error('createSummaryQueryDefs is only to be used for metrics that end in "_sum"');const F=j.at(-2),U=(0,p.l_)(F),B=o(!0),K=j.slice(0,-1).join("_"),W=q(`sum(${B})`),z=q(`sum(${B})by(${n.aZ})`),X=`${K} (average)`;function q(G){const te=G.replace(n.Rp,`${K}_sum`),H=G.replace(n.Rp,`${K}_count`);return`${te}/${H}`}return r({description:X,mainQueryExpr:W,breakdownQueryExpr:z,unit:U})}const S={sum:T,bucket:P};function L(j){return j&&S[j]||h.generator}function O(j){const N=j.split("_"),F=N.at(-1),U=L(F);if(!U)throw new Error(`Unable to generate queries for metric "${j}" due to issues with derived suffix "${F}"`);return U(N)}},8620:(k,A,e)=>{"use strict";e.d(A,{MM:()=>d,l_:()=>l,vL:()=>s});const n="short";function s(c){const a=c.split("_"),p=a.at(-1)??"",u=a.at(-2)??"";return i.includes(p)?p:i.includes(u)?u:null}function l(c){return c&&r[c]||n}const r={bytes:"bytes",seconds:"s"},i=["bytes","seconds"],g={bytes:"Bps",seconds:"short"},o="cps";function d(c){return c&&g[c]||o}},56833:(k,A,e)=>{"use strict";e.d(A,{b:()=>I,B:()=>R});var n=e(74848),s=e(32196),l=e(76885),r=e(64388),i=e(12470),g=e(39601),o=e(23172),d=e(80943),c=e(40845),a=e(69444),p=e(15292),u=e(83122),m=e(27746),v=e(40588);class x extends d.Bs{constructor(j){super({stickyMainGraph:j.stickyMainGraph??!0,isOpen:j.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const N=!this.state.stickyMainGraph;(0,v.z)("settings_changed",{stickyMainGraph:N}),this.setState({stickyMainGraph:N})},this.onToggleOpen=N=>{this.setState({isOpen:N})}}static{this.Component=({model:j})=>{const{stickyMainGraph:N,isOpen:F}=j.useState(),U=(0,c.of)(f),w=()=>(0,n.jsxs)("div",{className:U.popover,onClick:B=>B.stopPropagation(),children:[(0,n.jsx)("div",{className:U.heading,children:"Settings"}),(0,n.jsxs)("div",{className:U.options,children:[(0,n.jsx)("div",{children:"Always keep selected metric graph in-view"}),(0,n.jsx)(p.d,{value:N,onChange:j.onToggleStickyMainGraph})]})]});return(0,n.jsx)(u.m,{overlay:w,placement:"bottom",onVisibleChange:j.onToggleOpen,children:(0,n.jsx)(m.I,{icon:"cog",variant:"canvas",isOpen:F})})}}}function f(O){return{popover:(0,s.css)({display:"flex",padding:O.spacing(2),flexDirection:"column",background:O.colors.background.primary,boxShadow:O.shadows.z3,borderRadius:O.shape.borderRadius(),border:`1px solid ${O.colors.border.weak}`,zIndex:1,marginRight:O.spacing(2)}),heading:(0,s.css)({fontWeight:O.typography.fontWeightMedium,paddingBottom:O.spacing(2)}),options:(0,s.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:O.spacing(1),columnGap:O.spacing(2)})}}var E=e(13054),h=e(94383),y=e(21028),b=e(90623),D=e(74764),P=e(88434),C=e(4200),M=e(51080);class I extends d.Bs{constructor(j){super({$timeRange:j.$timeRange??new d.JZ({}),$variables:j.$variables??T(j.initialDS,j.metric,j.initialFilters),controls:j.controls??[new d.K8({layout:"vertical"}),new d.N0,new d.KE({}),new d.WM({})],history:j.history??new E.LR({}),settings:j.settings??new x({}),createdAt:j.createdAt??new Date().getTime(),...j}),this._urlSync=new d.So(this,{keys:["metric","metricSearch"]}),this._variableDependency=new d.Sh(this,{variableNames:[C.EY],onReferencedVariableValueChanged:async N=>{const{name:F}=N.state;F===C.EY&&this.datasourceHelper.reset()}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new P.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:R(this.state.metric)}),this.subscribeToEvent(C.OO,this._handleMetricSelectedEvent.bind(this));const j=d.jh.lookupVariable(C.Ao,this);j instanceof d.H9&&this._subs.add(j?.subscribeToState((F,U)=>{this._addingFilterWithoutReportingInteraction||(0,v.h)(F.filters,U.filters)}));const N=()=>(0,D._r)().setRecentTrail(this);return window.addEventListener("unload",N),()=>{this.state.embedded||N(),window.removeEventListener("unload",N)}}addFilterWithoutReportingInteraction(j){const N=d.jh.lookupVariable("filters",this);N instanceof d.H9&&(this._addingFilterWithoutReportingInteraction=!0,N.setState({filters:[...N.state.filters,j]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(j){return this.datasourceHelper.getMetricMetadata(j)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(j){!j.topScene&&!j.metric&&(j.topScene=new y.t({})),this.setState(d.Go.cloneSceneObjectState(j,{history:this.state.history,metric:j.metric?j.metric:void 0,metricSearch:j.metricSearch?j.metricSearch:void 0}));const N=(0,d.Is)().getUrlState(this),F=l.kM.renderUrl(g.Ny.getLocation().pathname,N);g.Ny.replace(F)}_handleMetricSelectedEvent(j){this.setState(this.getSceneUpdatesForNewMetricValue(j.payload));const N=d.jh.lookupVariable(C.Ao,this);N instanceof d.H9&&N.setState({baseFilters:L(j.payload)})}getSceneUpdatesForNewMetricValue(j){const N={};return N.metric=j,N.topScene=R(j),N}getUrlState(){const{metric:j,metricSearch:N}=this.state;return{metric:j,metricSearch:N}}updateFromUrl(j){const N={};typeof j.metric=="string"?this.state.metric!==j.metric&&Object.assign(N,this.getSceneUpdatesForNewMetricValue(j.metric)):j.metric==null&&(N.metric=void 0,N.topScene=new y.t({})),typeof j.metricSearch=="string"?N.metricSearch=j.metricSearch:j.metric==null&&(N.metricSearch=void 0),this.setState(N)}static{this.Component=({model:j})=>{const{controls:N,topScene:F,history:U,settings:w,metric:B}=j.useState(),K=(0,o.k)(),W=(0,c.of)(S,K??0),z=(0,D._r)().recent.length<2;return(0,n.jsx)(a.Y,{navId:"explore/metrics",pageNav:{text:(0,M.aO)(B)},layout:r.k.Custom,children:(0,n.jsxs)("div",{className:W.container,children:[z&&(0,n.jsx)(b.p,{}),(0,n.jsx)(U.Component,{model:U}),N&&(0,n.jsxs)("div",{className:W.controls,children:[N.map(Y=>(0,n.jsx)(Y.Component,{model:Y},Y.state.key)),(0,n.jsx)(w.Component,{model:w})]}),(0,n.jsx)("div",{className:W.body,children:F&&(0,n.jsx)(F.Component,{model:F})})]})})}}}function R(O){return O?new h.R({metric:O}):new y.t({})}function T(O,j,N){return new d.Pj({variables:[new d.mI({name:C.EY,label:"Data source",description:"Only prometheus data sources are supported",value:O,pluginId:"prometheus"}),new d.H9({name:C.Ao,addFilterButtonText:"Add label",datasource:C.GH,hide:i.zL.hideLabel,layout:"vertical",filters:N??[],baseFilters:L(j)})]})}function S(O,j){return{container:(0,s.css)({flexGrow:1,display:"flex",gap:O.spacing(1),flexDirection:"column",background:O.isLight?O.colors.background.primary:O.colors.background.canvas,padding:O.spacing(2,3,2,3)}),body:(0,s.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,s.css)({display:"flex",gap:O.spacing(1),padding:O.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:O.isDark?O.colors.background.canvas:O.colors.background.primary,zIndex:O.zIndex.navbarFixed,top:j})}}function L(O){return O?[{key:"__name__",operator:"=",value:O}]:[]}},13054:(k,A,e)=>{"use strict";e.d(A,{LR:()=>D,hi:()=>x});var n=e(74848),s=e(32196),l=e(96540),r=e(91410),i=e(43127),g=e(65879),o=e(80943),d=e(67061),c=e(40845),a=e(56034),p=e(56833),u=e(40588),m=e(4200),v=e(51080);function x(T){return"currentStep"in T&&"steps"in T}function f(T){return!!T}const E=T=>typeof T=="string",h=" $2 ",y=/(\|)(=|=~|!=|>|<|!~)(\|)/g,b={start:"Start of history",metric:"Metric selected:",metric_page:"Metric select page",filters:"Filter applied:",time:"Time range changed:"};class D extends o.Bs{constructor(S){super({steps:S.steps??[],currentStep:S.currentStep??0,filtersApplied:[]}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const S=(0,v.kj)(this);if(this.state.steps.length===0)if(this.addTrailStep(S,"start"),S.state.metric){const{metric:L,...O}=S.state;O.topScene=(0,p.B)(void 0),this.state.steps[0].trailState=O,this.addTrailStep(S,"metric",S.state.metric)}else this.addTrailStep(S,"metric_page");S.subscribeToState((L,O)=>{L.metric!==O.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=o.Go.cloneSceneObjectState(O,{history:this})),L.metric?this.addTrailStep(S,"metric",L.metric):this.addTrailStep(S,"metric_page"))}),S.subscribeToEvent(o.oh,L=>{if(L.payload.state.name===m.Ao){const O=this.state.filtersApplied,j=(0,o.Is)().getUrlState(S);this.addTrailStep(S,"filters",C(j,O)),this.setState({filtersApplied:O})}}),S.subscribeToEvent(o.bZ,L=>{if(L.payload.changedObject instanceof o.JZ){const{prevState:O,newState:j}=L.payload;if((0,v.iG)(O)&&(0,v.iG)(j)){if(O.from===j.from&&O.to===j.to)return;this.addTrailStep(S,"time",P({from:j.from,to:j.to,timeZone:j.timeZone}))}}})}addTrailStep(S,L,O=""){if(this.stepTransitionInProgress)return;const j=this.state.steps.length,N=L==="start"?-1:this.state.currentStep;this.setState({currentStep:j,steps:[...this.state.steps,{type:L,detail:O,description:b[L],trailState:o.Go.cloneSceneObjectState(S.state,{history:this}),parentIndex:N}]})}addTrailStepFromStorage(S,L){if(this.stepTransitionInProgress)return;const O=L.type,j=this.state.steps.length,N=O==="start"?-1:this.state.currentStep,F=this.state.filtersApplied;let U="";switch(L.type){case"metric":U=L.urlValues.metric?.toString()??"";break;case"filters":U=C(L.urlValues,F);break;case"time":U=P(L.urlValues);break}this.setState({filtersApplied:F,currentStep:j,steps:[...this.state.steps,{type:O,detail:U,description:b[O],trailState:o.Go.cloneSceneObjectState(S.state,{history:this}),parentIndex:N}]})}goBackToStep(S){if(S===this.state.currentStep)return;const L=this.state.steps[S],O=L.type==="metric"&&L.trailState.metric===void 0?"metric-clear":L.type;(0,u.z)("history_step_clicked",{type:O,step:S,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:S}),(0,v.kj)(this).restoreFromHistoryStep(L.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(S){return(0,n.jsxs)(d.B,{direction:"column",children:[(0,n.jsx)("div",{children:S.description}),S.detail!==""&&(0,n.jsx)("div",{children:S.detail})]})}static{this.Component=({model:S})=>{const{steps:L,currentStep:O}=S.useState(),j=(0,c.of)(M),{ancestry:N,alternatePredecessorStyle:F}=(0,l.useMemo)(()=>{const U=new Set;let w=O;for(;w>=0;){const K=L[w];if(!K)break;U.add(w),w=K.parentIndex}const B=new Map;return U.forEach(K=>{const W=L[K].parentIndex;W+1!==K&&B.set(K,R(K,W))}),{ancestry:U,alternatePredecessorStyle:B}},[O,L]);return(0,n.jsxs)("div",{className:j.container,children:[(0,n.jsx)("div",{className:j.heading,children:"History"}),L.map((U,w)=>{let B=U.type;return B==="metric"&&U.trailState.metric===void 0&&(B="start"),(0,n.jsx)(a.m,{content:()=>S.renderStepTooltip(U),children:(0,n.jsx)("button",{className:(0,s.cx)(j.step,j.stepTypes[B],O===w?j.stepSelected:"",F.get(w)??"",w!==U.parentIndex+1?j.stepOmitsDirectLeftLink:"",w===0?j.stepOmitsDirectLeftLink:"",N.has(w)?"":j.stepIsNotAncestorOfCurrent),onClick:()=>S.goBackToStep(w)})},w)})]})}}}function P(T){if(!(0,v.iG)(T))return"";const S=(0,g.convertRawToRange)({from:T.from,to:T.to}),L=E(T.timeZone)?T.timeZone:r.g$.localBrowserTime,O=(0,r.QZ)(L,Date.now()),j=S.from.subtract(O?.offsetInMins??0,"minute").format(i.G$),N=S.to.subtract(O?.offsetInMins??0,"minute").format(i.G$);return`${j} - ${N}`}function C(T,S){let L="";const O=T["var-filters"];return f(O)&&(L=O.filter(j=>j!==""&&!S.includes(j)?(S.push(j),!0):!1)[0]??""),L.replace(y,h)}function M(T){const S=T.visualization;return{container:(0,s.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,s.css)({}),step:(0,s.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:T.shape.radius.circle,background:T.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:T.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,s.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${T.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,s.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,s.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:I(S.getColorByName("green")),filters:I(S.getColorByName("purple")),metric:I(S.getColorByName("orange")),metric_page:I(S.getColorByName("orange")),time:I(T.colors.primary.main)}}}function I(T){return(0,s.css)({background:T,"&:before":{background:T,borderColor:T},"&:after":{borderColor:T}})}function R(T,S){const j=(T-S)*18;return(0,s.css)({"&:before":{content:'""',width:j+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-j,background:"none"}})}},94383:(k,A,e)=>{"use strict";e.d(A,{k:()=>Se,R:()=>ze});var n=e(74848),s=e(32196),l=e(32264),r=e(80943),i=e(40845),g=e(90613),o=e(67061),d=e(27746),c=e(14578),a=e(55852),p=e(63021),u=e(40675),m=e(56034),v=e(87490),x=e(2543),f=e(11261),E=e(88575),h=e(13344),y=e(29352),b=e(77366),D=e(96540),P=e(29413),C=e(94354),M=e(90182);function I({options:Pe,value:he,onChange:be}){const Ae=(0,i.of)(R),De=(0,i.$j)(),[Ie,ke]=(0,D.useState)(0),[dt,Pt]=(0,D.useState)(0),pt=dt>Ie,Tt=(0,D.useRef)(null);return(0,b.w)({ref:Tt,onResize:()=>{const jt=Tt.current;jt&&Pt(jt.clientWidth)}}),(0,D.useEffect)(()=>{const{fontSize:jt}=De.typography,$t=Pe.map(qt=>qt.label||qt.value||"").join(" "),sn=(0,P.kD)($t,jt).width;ke(sn+32*Pe.length)},[Pe,De]),(0,n.jsx)("div",{ref:Tt,children:pt?(0,n.jsx)(C.z,{options:Pe,value:he,onChange:be}):(0,n.jsx)(M.l6,{options:Pe,value:he,onChange:jt=>be(jt.value),className:Ae.select})})}function R(Pe){return{select:(0,s.css)({maxWidth:Pe.spacing(16)})}}var T=e(69096),S=e(40588),L=e(4200),O=e(51080);class j extends r.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(r.jh.lookupVariable("filters",this)instanceof r.H9))return;const be=this.state.frame.fields[1]?.labels??{};if(Object.keys(be).length!==1)return;const Ae=Object.keys(be)[0];(0,S.z)("label_filter_changed",{label:Ae,action:"added",cause:"breakdown"});const De=(0,O.kj)(this),Ie={key:Ae,operator:"=",value:be[Ae]};De.addFilterWithoutReportingInteraction(Ie)}}static{this.Component=({model:he})=>{const Ae=he.useState().frame.fields[1]?.labels||{};return Object.keys(Ae).length!==0?(0,n.jsx)(a.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:he.onClick,children:"Add to filters"}):null}}}var N=e(39070);function F(Pe,he){const be=r.jh.lookupVariable(L.Ao,Pe),Ae=[];if(!(be instanceof r.H9))return[];const De=be.state.filters;for(const Ie of he.getOptionsForSelect()){const ke=De.find(dt=>dt.key===Ie.value);Ie.label!=="le"&&(ke||Ae.push({label:Ie.label,value:String(Ie.value)}))}return Ae}function U(Pe,he){const be=sceneGraph.findObject(Pe,Ae=>Ae instanceof he);return be instanceof he?be:null}function w(Pe,he){function be(De){return De instanceof he}return r.jh.findAllObjects(Pe,be).filter(be)}class B extends r.Bs{constructor(he){super(he),this.addActivationHandler(()=>{const be=r.jh.getData(this);this._subs.add(be.subscribeToState((Ae,De)=>{if(Ae.data===void 0)return;const Ie=Ae.data;Ae.data!==void 0&&Ae.data?.state!==De.data?.state&&w(this,r.Zv).forEach(ke=>{ke.setState({data:{...ke.state.data,state:Ie.state}})}),Ie.state===N.Gu.Done&&this.performRepeat(Ie)})),be.state.data&&this.performRepeat(be.state.data)})}performRepeat(he){const be=[];for(let Ae=0;Ae<he.series.length;Ae++){const De=he.series[Ae];if(De.length<=1)continue;const Ie=this.state.getLayoutChild(he,De,Ae);be.push(Ie)}this.state.body.setState({children:be}),this.setState({body:this.state.body})}static{this.Component=({model:he})=>{const{body:be}=he.useState(),{children:Ae}=be.useState(),ke=r.jh.getData(he).useState()?.data,dt=ke?.state==="Loading"&&Ae.length===0,Pt=ke?.state===N.Gu.Error?"Failed to load data.":void 0,pt=!dt&&Ae.length===0&&!Pt?"There is no data available. Try adjusting your filters, time range, or selecting a different label.":void 0;return(0,n.jsx)(T.O,{blockingMessage:pt,error:Pt,isLoading:dt,children:(0,n.jsx)(be.Component,{model:be})})}}}class K extends r.Bs{constructor(){super(...arguments),this.onLayoutChange=he=>{(0,S.z)("breakdown_layout_changed",{layout:he}),localStorage.setItem(L.Pp,he),this.getMetricScene().setState({layout:he})}}getMetricScene(){return r.jh.getAncestor(this,ze)}Selector({model:he}){const{options:be}=he.useState(),Ae=he.useActiveLayout();return(0,n.jsx)(E.D,{label:"View",children:(0,n.jsx)(C.z,{options:be,value:Ae,onChange:he.onLayoutChange})})}useActiveLayout(){const{options:he}=this.useState(),{layout:be}=this.getMetricScene().useState();return he.map(De=>De.value).includes(be)?be:he[0].value}static{this.Component=({model:he})=>{const{layouts:be,options:Ae}=he.useState(),De=he.useActiveLayout(),Ie=Ae.findIndex(dt=>dt.value===De);if(Ie===-1)return null;const ke=be[Ie];return(0,n.jsx)(ke.Component,{model:ke})}}}var W=e(52622);const z=r.zd.timeseries().setOption("tooltip",{mode:W.$N.Multi,sort:W.xB.Descending}).setOption("legend",{showLegend:!1}).build();var Y=e(65463);class X extends Y.x{static{this.type="selected-metric-query-results-event"}}const q=Pe=>{const he=r.jh.getAncestor(Pe,te);w(Pe,r.Eb).forEach(De=>{De.isActive?be(De.state.$data):De.addActivationHandler(()=>{be(De.state.$data)})}),w(Pe,r.Eb).forEach(De=>be(De.state.$data));function be(De){De&&(De.isActive||De.addActivationHandler(()=>{be(De)}),De.state.data&&he.reportBreakdownPanelData(De.state.data),De.subscribeToState(({data:Ie},ke)=>{he.reportBreakdownPanelData(Ie)}))}const Ae=he.subscribeToEvent(X,De=>{if(!Pe.isActive){Ae.unsubscribe();return}const Ie=r.No.timeseries().setCustomFieldConfig("axisSoftMin",De.payload.min).setCustomFieldConfig("axisSoftMax",De.payload.max).build();w(Pe,r.Eb).forEach(ke=>{function dt(){ke.onFieldConfigChange(Ie)}ke.isActive?dt():ke.addActivationHandler(dt)})})},G=60;class te extends r.Bs{constructor(he){super({labels:he.labels??[],...he}),this._variableDependency=new r.Sh(this,{variableNames:[L.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,x.throttle)(()=>{const{breakdownPanelMinValue:be,breakdownPanelMaxValue:Ae}=this;be!==void 0&&Ae!==void 0&&this.publishEvent(new X({min:be,max:Ae}))},1e3),this.onChange=be=>{if(!be)return;(0,S.z)("label_selected",{label:be,cause:"selector"}),this.getVariable().changeValueTo(be)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const he=this.getVariable();he.subscribeToState((Ie,ke)=>{(Ie.options!==ke.options||Ie.value!==ke.value||Ie.loading!==ke.loading)&&this.updateBody(he)});const be=r.jh.getAncestor(this,ze),Ae=be.state.metric;this._query=(0,y.v)(Ae).breakdown,(0,O.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),be.subscribeToState(({layout:Ie},ke)=>{Ie!==ke.layout&&this.clearBreakdownPanelAxisValues()}),this.updateBody(he)}reportBreakdownPanelData(he){if(!he)return;let be=this.breakdownPanelMinValue,Ae=this.breakdownPanelMaxValue;he.series.forEach(De=>{De.fields.forEach(Ie=>{if(Ie.type!==f.PU.number)return;const ke=Ie.values.filter(x.isNumber),dt=(0,x.max)(ke),Pt=(0,x.min)(ke);Ae=(0,x.max)([Ae,dt].filter(x.isNumber)),be=(0,x.min)([be,Pt].filter(x.isNumber))})}),!(Ae===void 0||be===void 0||!Number.isFinite(Ae+be))&&(this.breakdownPanelMaxValue===Ae&&this.breakdownPanelMinValue===be||(this.breakdownPanelMaxValue=Ae,this.breakdownPanelMinValue=be,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const he=r.jh.lookupVariable(L.yr,this);if(!(he instanceof r.fS))throw new Error("Group by variable not found");return he}onReferencedVariableValueChanged(){const he=this.getVariable();he.changeValueTo(h.To),this.updateBody(he)}updateBody(he){const be=F(this,he),Ae={loading:he.state.loading,value:String(he.state.value),labels:be,error:he.state.error,blockingMessage:void 0};!he.state.loading&&he.state.options.length?Ae.body=he.hasAllValue()?se(be,this._query):le(this._query):he.state.loading||(Ae.body=void 0,Ae.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(Ae)}static{this.Component=({model:he})=>{const{labels:be,body:Ae,loading:De,value:Ie,blockingMessage:ke}=he.useState(),dt=(0,i.of)(H);return(0,n.jsx)("div",{className:dt.container,children:(0,n.jsxs)(T.O,{isLoading:De,blockingMessage:ke,children:[(0,n.jsxs)("div",{className:dt.controls,children:[!De&&be.length&&(0,n.jsx)("div",{className:dt.controlsLeft,children:(0,n.jsx)(E.D,{label:"By label",children:(0,n.jsx)(I,{options:be,value:Ie,onChange:he.onChange})})}),Ae instanceof K&&(0,n.jsx)("div",{className:dt.controlsRight,children:(0,n.jsx)(Ae.Selector,{model:Ae})})]}),(0,n.jsx)("div",{className:dt.content,children:Ae&&(0,n.jsx)(Ae.Component,{model:Ae})})]})})}}}function H(Pe){return{container:(0,s.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column"}),content:(0,s.css)({flexGrow:1,display:"flex",paddingTop:Pe.spacing(0)}),controls:(0,s.css)({flexGrow:0,display:"flex",alignItems:"top",gap:Pe.spacing(2)}),controlsRight:(0,s.css)({flexGrow:0,display:"flex",justifyContent:"flex-end"}),controlsLeft:(0,s.css)({display:"flex",justifyContent:"flex-left",justifyItems:"left",width:"100%",flexDirection:"column"})}}function se(Pe,he){const be=[];for(const Ae of Pe){if(Ae.value===h.To)continue;if(be.length===G)break;const De=he.queries[0].expr.replaceAll(L.aZ,String(Ae.value)),Ie=he.unit,ke=r.d0.timeseries().setTitle(Ae.label).setData(new r.dt({maxDataPoints:250,datasource:L.GH,queries:[{refId:"A",expr:De,legendFormat:`{{${Ae.label}}}`}]})).setHeaderActions(new ae({labelName:String(Ae.value)})).setUnit(Ie).setBehaviors([J]).build();ke.addActivationHandler(()=>{ke.onOptionsChange(z)}),be.push(new r.xK({$behaviors:[q],body:ke}))}return new K({options:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new r.gF({templateColumns:ne,autoRows:"200px",children:be,isLazy:!0}),new r.gF({templateColumns:"1fr",autoRows:"200px",children:be.map(Ae=>Ae.clone()),isLazy:!0})]})}const ne="repeat(auto-fit, minmax(400px, 1fr))";function le(Pe){const he=Pe.unit;function be(Ae,De,Ie){const ke=Pe.vizBuilder().setTitle(_(De)).setData(new r.Zv({data:{...Ae,series:[De]}})).setColor({mode:"fixed",fixedColor:(0,O.Vy)(Ie)}).setHeaderActions(new j({frame:De})).setUnit(he).build(),dt=De.length<=1,Pt=new r.xK({$behaviors:[q],body:ke,isHidden:dt});return ke.addActivationHandler(()=>{ke.onOptionsChange(z)}),Pt}return new K({$data:new r.dt({datasource:L.GH,maxDataPoints:300,queries:Pe.queries}),options:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],layouts:[new r.G1({direction:"column",children:[new r.vA({minHeight:300,body:r.d0.timeseries().setTitle("$metric").build()})]}),new B({body:new r.gF({templateColumns:ne,autoRows:"200px",children:[]}),getLayoutChild:be}),new B({body:new r.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:be})]})}function _(Pe){const he=Pe.fields[1]?.labels||{},be=Object.keys(he);return be.length===0?"<unspecified>":he[be[0]]}function Q(){return new te({})}class ae extends r.Bs{constructor(){super(...arguments),this.onClick=()=>{const he=this.state.labelName;(0,S.z)("label_selected",{label:he,cause:"breakdown_panel"}),oe(this).onChange(he)}}static{this.Component=({model:he})=>(0,n.jsx)(a.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:he.onClick,children:"Select"})}}function oe(Pe){if(Pe instanceof te)return Pe;if(Pe.parent)return oe(Pe.parent);throw new Error("Unable to find breakdown scene")}function J(Pe){Pe.state.$data?.subscribeToState((he,be)=>{const Ae=he.data?.request?.targets[0];if(ee(Ae)){const{legendFormat:De}=Ae,Ie=De.slice(2,-2);he.data?.series.forEach(ke=>{if(!ke.fields[1].labels?.[Ie]){const dt=ke.fields[1].labels;dt&&(dt[Ie]=`<unspecified ${Ie}>`)}})}})}function ee(Pe){return Pe!==void 0&&"legendFormat"in Pe&&typeof Pe.legendFormat=="string"}var de=e(94753),xe=e(72109),re=e(8484),ue=e(8620);class Te extends r.Bs{constructor(he){super({...he}),this._variableDependency=new r.Sh(this,{variableNames:[L.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const he=r.jh.lookupVariable(L.yr,this);if(!(he instanceof r.fS))throw new Error("Group by variable not found");return he}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const be=(0,O.aM)(this).state.metric,De=await(0,O.kj)(this).getMetricMetadata(be);this.setState({metadata:De,metadataLoading:!1})}static{this.Component=({model:he})=>{const{metadata:be,metadataLoading:Ae}=he.useState(),De=he.getVariable(),{loading:Ie,options:ke}=De.useState(),Pt=(0,O.aM)(he).state.metric;let pt=(0,ue.vL)(Pt)??"Unknown";return(0,n.jsx)(T.O,{isLoading:Ie||Ae,children:(0,n.jsx)(o.B,{gap:6,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.B,{direction:"column",gap:.5,children:[(0,n.jsx)(de.E,{weight:"medium",children:(0,n.jsx)(re.x6,{i18nKey:"trails.metric-overview.description-label",children:"Description"})}),(0,n.jsx)("div",{style:{maxWidth:360},children:be?.help?(0,n.jsx)("div",{children:be?.help}):(0,n.jsx)("i",{children:(0,n.jsx)(re.x6,{i18nKey:"trails.metric-overview.no-description",children:"No description available"})})})]}),(0,n.jsxs)(o.B,{direction:"column",gap:.5,children:[(0,n.jsx)(de.E,{weight:"medium",children:(0,n.jsx)(re.x6,{i18nKey:"trails.metric-overview.type-label",children:"Type"})}),be?.type?(0,n.jsx)("div",{children:be?.type}):(0,n.jsx)("i",{children:(0,n.jsx)(re.x6,{i18nKey:"trails.metric-overview.unknown-type",children:"Unknown"})})]}),(0,n.jsxs)(o.B,{direction:"column",gap:.5,children:[(0,n.jsx)(de.E,{weight:"medium",children:(0,n.jsx)(re.x6,{i18nKey:"trails.metric-overview.unit-label",children:"Unit"})}),be?.unit?(0,n.jsx)("div",{children:be?.unit}):(0,n.jsx)("i",{children:pt})]}),(0,n.jsxs)(o.B,{direction:"column",gap:.5,children:[(0,n.jsx)(de.E,{weight:"medium",children:(0,n.jsx)(re.x6,{i18nKey:"trails.metric-overview.labels-label",children:"Labels"})}),ke.length===0&&"Unable to fetch labels.",ke.map(Tt=>(0,n.jsx)(xe.Y,{href:`#View breakdown for ${Tt.label}`,title:`View breakdown for ${Tt.label}`,onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),r.jh.getAncestor(he,ze).setActionView("breakdown");const $t=r.jh.lookupVariable(L.yr,he);return $t instanceof r.fS&&Tt.label!=null&&((0,S.z)("label_selected",{label:Tt.label,cause:"overview_link"}),$t.setState({value:Tt.value})),!1},children:Tt.label},Tt.label))]})]})})})}}}function ge(){return new Te({})}var Oe=e(21028);function Ue(){return new Oe.t({})}const Xe=["single","grid","rows"];function we(Pe){return!!Pe&&Pe in Xe}var qe=e(94624);class We extends r.Bs{constructor(he){super(he),this.onChangeQuery=be=>{const Ae=(0,O.aM)(this),De=Ae.state.autoQuery.variants.find(Ie=>Ie.variant===be);this.setState({panel:this.getVizPanelFor(De)}),Ae.setState({queryDef:De})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:he}=(0,O.aM)(this).state;this.setState({panel:this.getVizPanelFor(he.main)})}}getQuerySelector(he){const{autoQuery:be}=(0,O.aM)(this).state;if(be.variants.length===0)return;const Ae=be.variants.map(De=>({label:De.variant,value:De.variant}));return(0,n.jsx)(C.z,{size:"sm",options:Ae,value:he.variant,onChange:this.onChangeQuery})}getVizPanelFor(he){return he.vizBuilder().setData(new r.dt({datasource:L.GH,maxDataPoints:500,queries:he.queries})).setHeaderActions(this.getQuerySelector(he)).build()}static{this.Component=({model:he})=>{const{panel:be}=he.useState();if(be)return(0,n.jsx)(be.Component,{model:be})}}}const Ce=280,je="40%";class Ke extends r.Bs{constructor(he){super({topView:he.topView??Fe(),...he})}static{this.Component=({model:he})=>{const{topView:be,selectedTab:Ae}=he.useState(),{stickyMainGraph:De}=(0,O.KE)(he).useState(),Ie=(0,i.of)(_e);return(0,n.jsxs)("div",{className:Ie.container,children:[(0,n.jsx)("div",{className:De?Ie.sticky:Ie.nonSticky,children:(0,n.jsx)(be.Component,{model:be})}),Ae&&(0,n.jsx)(Ae.Component,{model:Ae})]})}}}function _e(Pe){return{container:(0,s.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,s.css)({display:"flex",flexDirection:"row",background:Pe.isLight?Pe.colors.background.primary:Pe.colors.background.canvas,position:"sticky",top:"70px",zIndex:10}),nonSticky:(0,s.css)({display:"flex",flexDirection:"row"})}}function Fe(){return new r.G1({direction:"column",$behaviors:[new r.Gg.K2({key:"metricCrosshairSync",sync:qe.y.Crosshair})],children:[new r.vA({minHeight:Ce,maxHeight:je,body:new We({})}),new r.vA({ySizing:"content",body:new Se({})})]})}const at=({trail:Pe})=>{const[he,be]=(0,D.useState)("Copy url"),Ae=()=>{if(navigator.clipboard){(0,S.z)("selected_metric_action_clicked",{action:"share_url"});const Ie=(l.$.appUrl.endsWith("/")?l.$.appUrl.slice(0,-1):l.$.appUrl)+(0,O.xi)(Pe);navigator.clipboard.writeText(Ie),be("Copied!"),setTimeout(()=>{be("Copy url")},2e3)}};return(0,n.jsx)(d.I,{variant:"canvas",icon:"share-alt",tooltip:he,onClick:Ae})};var Ct=e(13054),Dt=e(74764);function tt(Pe){const he=()=>(0,Dt._r)().getBookmarkIndex(Pe),be=he(),[Ae,De]=(0,D.useState)(be);(0,D.useEffect)(()=>{const Pt=Pe.subscribeToEvent(r.bZ,({payload:{prevState:pt,newState:Tt}})=>{(0,Ct.hi)(pt)&&(0,Ct.hi)(Tt)&&Tt.steps.length>pt.steps.length&&De((0,Dt._r)().getBookmarkIndex(Pe))});return()=>Pt.unsubscribe()},[Pe]),be!==Ae&&De(be);const Ie=Ae!=null;return[Ie,()=>{if((0,S.z)("bookmark_changed",{action:Ie?"toggled_off":"toggled_on"}),Ie){let Pt=he();for(;Pt!=null;)(0,Dt._r)().removeBookmark(Pt),Pt=he()}else(0,Dt._r)().addBookmark(Pe);De(he())}]}class ze extends r.Bs{constructor(he){const be=he.autoQuery??(0,y.v)(he.metric),Ae=localStorage.getItem(L.Pp);super({$variables:he.$variables??Ee(he.metric),body:he.body??new Ke({}),autoQuery:be,queryDef:he.queryDef??be.main,layout:we(Ae)?Ae:"grid",...he}),this._urlSync=new r.So(this,{keys:["actionView","layout"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView,layout:this.state.layout}}updateFromUrl(he){if(typeof he.actionView=="string"){if(this.state.actionView!==he.actionView){const be=pe.find(Ae=>Ae.value===he.actionView);be&&this.setActionView(be.value)}}else he.actionView===null&&this.setActionView(void 0);if(typeof he.layout=="string"){const be=he.layout;this.state.layout!==be&&this.setState({layout:be})}}setActionView(he){const{body:be}=this.state,Ae=pe.find(De=>De.value===he);Ae&&Ae.value!==this.state.actionView?(be.state.topView.state.children[0].setState({maxHeight:Ce}),be.setState({selectedTab:Ae.getScene()}),this.setState({actionView:Ae.value})):(be.state.topView.state.children[0].setState({maxHeight:je}),be.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:he})=>{const{body:be}=he.useState();return(0,n.jsx)(be.Component,{model:be})}}}const pe=[{displayName:"Overview",value:"overview",getScene:ge},{displayName:"Breakdown",value:"breakdown",getScene:Q},{displayName:"Related metrics",value:"related",getScene:Ue,description:"Relevant metrics based on current label filters"}];class Se extends r.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const he=r.jh.getAncestor(this,ze),be=(0,O.kj)(this),Ae=(0,O.U4)(be),De=he.state.queryDef?.queries||[],Ie=r.jh.getTimeRange(this);return(0,v.Xe)({queries:De,dsRef:{uid:Ae},timeRange:Ie.state.value,scopedVars:{__sceneObject:{value:he}}})},this.openExploreLink=async()=>{(0,S.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(he=>{const be=`${l.$.appSubUrl}${he}`;window.open(be,"_blank")})}}static{this.Component=({model:he})=>{const be=r.jh.getAncestor(he,ze),Ae=(0,i.of)(fe),De=(0,O.kj)(he),[Ie,ke]=tt(De),{actionView:dt}=be.useState();return(0,n.jsxs)(g.a,{paddingY:1,children:[(0,n.jsx)("div",{className:Ae.actions,children:(0,n.jsxs)(o.B,{gap:1,children:[(0,n.jsx)(d.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,S.z)("selected_metric_action_clicked",{action:"unselect"}),De.publishEvent(new L.OO(void 0))},children:"Select new metric"}),(0,n.jsx)(d.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:he.openExploreLink}),(0,n.jsx)(at,{trail:De}),(0,n.jsx)(d.I,{variant:"canvas",icon:Ie?(0,n.jsx)(c.I,{name:"favorite",type:"mono",size:"lg"}):(0,n.jsx)(c.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:ke}),De.state.embedded&&(0,n.jsx)(a.z9,{href:(0,O.xi)(De),variant:"secondary",onClick:()=>(0,S.z)("selected_metric_action_clicked",{action:"open_from_embedded"}),children:"Open"})]})}),(0,n.jsx)(p.U,{children:pe.map((Pt,pt)=>{const Tt=(0,n.jsx)(u.o,{label:Pt.displayName,active:dt===Pt.value,onChangeTab:()=>{(0,S.z)("metric_action_view_changed",{view:Pt.value}),be.setActionView(Pt.value)}},pt);return Pt.description?(0,n.jsx)(m.m,{content:Pt.description,placement:"bottom-start",theme:"info",children:Tt},pt):Tt})})]})}}}function fe(Pe){return{actions:(0,s.css)({[Pe.breakpoints.up(Pe.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function Ee(Pe){return new r.Pj({variables:[...(0,L.ym)(Pe),new r.fS({name:L.yr,label:"Group by",datasource:L.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${L.Rp})`,refId:"A"},value:"",text:""})]})}},21028:(k,A,e)=>{"use strict";e.d(A,{t:()=>Q});var n=e(74848),s=e(32196),l=e(2543),r=e(96540),i=e(17172),g=e(80943),o=e(40845),d=e(56034),c=e(14578),a=e(88575),p=e(10354),u=e(29158),m=e(90182),v=e(15292),x=e(42418),f=e(8484),E=e(94383),h=e(69096);class y{constructor(){this.config={minGroupSize:3,idealMaxGroupSize:30,maxDepth:100}}parse(de){if(this.config.maxDepth<=0)throw new Error("Max depth must be greater than 0");if(this.config.minGroupSize<1)throw new Error("Min group size must be greater than 0");if(this.config.idealMaxGroupSize<this.config.minGroupSize)throw new Error("Max group size must be greater than min group size");if(this.config.miscGroupKey&&this.config.miscGroupKey==="")throw new Error("miscGroupKey cannot be empty");return{root:this.parseStrings(de,0)}}parseStrings(de,xe){const re={groups:new Map,values:[],descendants:0};for(const Te of de){if(Te.trim()==="")continue;const ge=b(Te,xe);let Oe=re.groups.get(ge);Oe||(Oe={groups:new Map,values:[],descendants:0},re.groups.set(ge,Oe)),Oe.values.push(Te),Oe.descendants++}const ue=[];for(let[Te,ge]of re.groups.entries())ge.values.length<this.config.minGroupSize?(this.config.miscGroupKey?ue.push(...ge.values):re.values.push(...ge.values),re.descendants+=ge.values.length,re.groups.delete(Te)):(ge.values.length>this.config.idealMaxGroupSize&&xe<this.config.maxDepth-1&&(ge=this.parseStrings(ge.values,xe+1),re.groups.set(Te,ge)),re.descendants+=ge.descendants);if(this.config.miscGroupKey&&ue.length>0){const Te={groups:new Map,values:ue,descendants:ue.length};re.groups.set(this.config.miscGroupKey,Te)}return re}}function b(ee,de){let xe=0;for(let re=0;re<ee.length;re++){const ue=ee.charCodeAt(re);if(!(ue>=48&&ue<=57||ue>=65&&ue<=90||ue>=97&&ue<=122||ue>=192&&ue<=214||ue>=216&&ue<=246||ue>=248&&ue<=255||ue>=256&&ue<=383)&&(xe++,xe>de))return ee.slice(0,re)}return ee}var D=e(88434),P=e(40588),C=e(4200),M=e(51080),I=e(55852);class R extends g.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new C.OO(this.state.metric),!0)}}static{this.Component=({model:de})=>{const{title:xe}=de.useState();return(0,n.jsx)(I.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:de.onClick,children:xe})}}}var T=e(81996);const S="results truncated due to limit";async function L(ee,de,xe,re){const ue=`/api/datasources/uid/${ee}/resources/api/v1/label/__name__/values`,Te={start:(0,T.mv)(de.from,!1),end:(0,T.mv)(de.to,!0),...xe&&xe!=="{}"?{"match[]":xe}:{},...re?{limit:re}:{}},ge=await(0,i.AI)().get(ue,Te,"explore-metrics-names");return re&&ge.warnings?.includes(S)?{...ge,limitReached:!0}:{...ge,limitReached:!1}}var O=e(29352),j=e(39070),N=e(11261);function F(ee){return de=>{const xe=g.jh.getData(de);xe&&xe.subscribeToState(re=>{if(re.data?.state===j.Gu.Loading||re.data?.state===j.Gu.Error)return;const ue=g.jh.getAncestor(de,Q);if(!re.data?.series.length){ue.updateMetricPanel(ee,!0,!0);return}let Te=!1;for(const ge of re.data.series){for(const Oe of ge.fields)if(Oe.type===N.PU.number&&(Te=Oe.values.some(Ue=>Ue!=null&&!isNaN(Ue)&&Ue!==0),Te))break;if(Te)break}ue.updateMetricPanel(ee,!0,!Te)})}}function U(ee,de,xe,re){const ue=(0,O.v)(ee),Te=ue.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,M.Vy)(de)}).setDescription(re).setHeaderActions(new R({metric:ee,title:"Select"})).build(),ge=ue.preview.queries.map(Oe=>w(Oe,xe));return new g.xK({$variables:new g.Pj({variables:(0,C.ym)(ee)}),$behaviors:[F(ee)],$data:new g.dt({datasource:C.GH,maxDataPoints:200,queries:ge}),body:Te})}function w(ee,de){const xe=de>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',re=ee.expr?.replace("${filters}",xe);return{...ee,expr:re}}var B=e(51088);function K(ee,de){return ee.sort((xe,re)=>{const ue=z(xe,de),Te=z(re,de);return ue.halfLeven+ue.wholeLeven-(Te.halfLeven+Te.wholeLeven)})}const W=new Map;function z(ee,de){let xe=W.get(ee);xe||(xe=new Map,W.set(ee,xe));let re=xe.get(de);if(!re){const ue=ee.split("_"),Te=ue.slice(0,ue.length/2).join("_"),ge=(0,B.A)(Te,de)||0,Oe=(0,B.A)(ee,de)||0;re={halfLeven:ge,wholeLeven:Oe},xe.set(de,re)}return re}const Y=/[^a-z0-9_:]+/;function X(ee){return ee?.toLowerCase().split(Y).filter(de=>de.length>0)||[]}function q(ee){const de=X(ee).map(re=>`(?=(.*${re.toLowerCase()}.*))`);if(de.length===0)return null;const xe=de.join("");return new RegExp(xe,"igy")}function G(ee){const de=te(X(ee)).filter(ue=>ue.length>0).map(ue=>`(.*${ue.toLowerCase()}.*)`),xe=de.length;return de.length===0?null:`(?i:${de.join("|")}){${xe}}`}function te(ee=[]){const de=new Set(ee.map(xe=>xe.toLowerCase().trim()));return Array.from(de)}const H="175px",se="64px",ne="all",le=2e4,_="View by the metric prefix. A metric prefix is a single word at the beginning of the metric name, relevant to the domain the metric belongs to.";class Q extends g.Bs{constructor(de){super({showPreviews:!0,$variables:de.$variables,metricPrefix:de.metricPrefix??ne,body:de.body??new g.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:H,isLazy:!0}),...de}),this.previewCache={},this.ignoreNextUpdate=!1,this._debounceRefreshMetricNames=(0,l.debounce)(()=>this._refreshMetricNames(),1e3),this._urlSync=new g.So(this,{keys:["metricPrefix"]}),this._variableDependency=new g.Sh(this,{variableNames:[C.EY,C.Ao],onReferencedVariableValueChanged:xe=>{this._debounceRefreshMetricNames()}}),this.updateMetricPanel=(xe,re,ue)=>{const Te=this.previewCache[xe];Te&&(Te.isEmpty=ue,Te.loaded=re,this.previewCache[xe]=Te,this.state.metricPrefix==="All"&&this.buildLayout())},this.onSearchQueryChange=xe=>{const re=xe.currentTarget.value;(0,M.kj)(this).setState({metricSearch:re})},this.onPrefixFilterChange=xe=>{this.setState({metricPrefix:xe.value}),this.buildLayout()},this.reportPrefixFilterInteraction=xe=>{const re=(0,M.kj)(this),{steps:ue,currentStep:Te}=re.state.history.state,Oe=ue[Te]?.trailState.metric!==void 0;(0,P.z)("prefix_filter_clicked",{from:Oe?"related_metrics":"metric_list",action:xe?"open":"close"})},this.onTogglePreviews=()=>{this.setState({showPreviews:!this.state.showPreviews}),this.buildLayout()},this.addActivationHandler(this._onActivate.bind(this))}getUrlState(){return{metricPrefix:this.state.metricPrefix}}updateFromUrl(de){typeof de.metricPrefix=="string"&&this.state.metricPrefix!==de.metricPrefix&&this.setState({metricPrefix:de.metricPrefix})}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const de=(0,M.kj)(this);this._subs.add(de.subscribeToEvent(C.OO,xe=>{const{steps:re,currentStep:ue}=de.state.history.state,Te=re[ue].parentIndex,Oe=re[Te].trailState.metric!==void 0;if(xe.payload!==void 0){const Ue=J(de),Xe=X(Ue).length;(0,P.z)("metric_selected",{from:Oe?"related_metrics":"metric_list",searchTermCount:Xe})}})),this._subs.add(de.subscribeToEvent(g.bZ,xe=>{if(xe.payload.changedObject instanceof g.JZ){const{prevState:re,newState:ue}=xe.payload;if((0,M.iG)(re)&&(0,M.iG)(ue)&&re.from===ue.from&&re.to===ue.to)return}})),this._subs.add(de.subscribeToState(({metricSearch:xe},re)=>{const ue=X(re.metricSearch),Te=X(xe);(0,l.isEqual)(ue,Te)||this._debounceRefreshMetricNames()})),this.subscribeToState((xe,re)=>{xe.metricNames!==re.metricNames&&this.onMetricNamesChanged()}),this._debounceRefreshMetricNames()}async _refreshMetricNames(){const de=(0,M.kj)(this),xe=de.state.$timeRange?.state;if(!xe)return;const re=[],ue=g.jh.lookupVariable(C.Ao,this);ue instanceof g.H9&&ue.getValue()?.valueOf()&&re.push(g.jh.interpolate(de,"${filters}"));const ge=G(de.state.metricSearch);ge&&re.push(`__name__=~"${ge}"`);const Oe=`{${re.join(",")}}`,Ue=g.jh.interpolate(de,C.gR);this.setState({metricNamesLoading:!0,metricNamesError:void 0,metricNamesWarning:void 0});try{const Xe=await L(Ue,xe,Oe,le),we=q(J(this)),qe=we?Xe.data.filter(Ke=>!we||we.test(Ke)):Xe.data,We=Xe.limitReached?`This feature will only return up to ${le} metric names for performance reasons. This limit is being exceeded for the current data source. Add search terms or label filters to narrow down the number of metric names returned.`:void 0;let Ce=this.state.body;const je=await this.generateGroups(qe);this.setState({metricNames:qe,rootGroup:je,body:Ce,metricNamesLoading:!1,metricNamesWarning:We,metricNamesError:Xe.error})}catch(Xe){let we="Unknown error";(0,i.NF)(Xe)&&(Xe.cancelled?we="Request cancelled":Xe.statusText&&(we=Xe.statusText)),this.setState({metricNames:void 0,metricNamesLoading:!1,metricNamesError:we})}}async generateGroups(de=[]){const xe=new y;xe.config={...xe.config,maxDepth:2,minGroupSize:2,miscGroupKey:"misc"};const{root:re}=xe.parse(de);return re}onMetricNamesChanged(){const de=this.state.metricNames||[],xe=new Set(de);Object.values(this.previewCache).forEach(Oe=>{xe.has(Oe.name)||(Oe.isEmpty=!0)});const re=(0,M.kj)(this),ue=re.state.metric!==void 0?K(de,re.state.metric):de,Te={},ge=120;Object.keys(this.previewCache).forEach(Oe=>{xe.has(Oe)||delete this.previewCache[Oe]});for(let Oe=0;Oe<ue.length;Oe++){const Ue=ue[Oe];if(Object.keys(Te).length>ge)break;const we=this.previewCache[Ue]||{name:Ue,index:Oe,loaded:!1};Te[Ue]=we}try{const Oe=g.jh.getAncestor(this,E.R).state.metric;delete Te[Oe]}catch{}this.previewCache=Te,this.buildLayout()}async buildLayout(){if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}if(!this.state.rootGroup){const re=await this.generateGroups(this.state.metricNames);this.setState({rootGroup:re})}const de=await this.populateFilterableViewLayout(),xe=this.state.showPreviews?H:se;this.state.body.setState({children:de,autoRows:xe})}async populateFilterableViewLayout(){const de=(0,M.kj)(this),xe=(0,M.gA)(this);let re=this.state.rootGroup;re||(re=await this.generateGroups(this.state.metricNames),this.setState({rootGroup:re}));const ue=[];for(const[Te,ge]of re.groups){if(this.state.metricPrefix!==ne&&this.state.metricPrefix!==Te)continue;for(const[Ue,Xe]of ge.groups){const we=await this.populatePanels(de,xe,Xe.values);ue.push(...we)}const Oe=await this.populatePanels(de,xe,ge.values);ue.push(...Oe)}return ue}async populatePanels(de,xe,re){const ue=xe?.length||0,Te=[];for(let ge=0;ge<re.length;ge++){const Oe=re[ge],Ue=this.previewCache[Oe]??{name:Oe,index:ge,loaded:!1},Xe=await de.getMetricMetadata(Oe),we=(0,D.R)(Xe);if(this.state.showPreviews){if(Ue.itemRef&&Ue.isPanel){Te.push(Ue.itemRef.resolve());continue}const qe=U(Ue.name,ge,ue,we);Ue.itemRef=qe.getRef(),Ue.isPanel=!0,Te.push(qe)}else{const qe=new g.xK({$variables:new g.Pj({variables:(0,C.ym)(Ue.name)}),body:ae(Ue.name,we)});Ue.itemRef=qe.getRef(),Ue.isPanel=!1,Te.push(qe)}}return Te}static{this.Component=({model:de})=>{const{showPreviews:xe,body:re,metricNames:ue,metricNamesError:Te,metricNamesLoading:ge,metricNamesWarning:Oe,rootGroup:Ue,metricPrefix:Xe}=de.useState(),{children:we}=re.useState(),qe=(0,M.kj)(de),We=(0,o.of)(oe),[Ce,je]=(0,r.useReducer)(()=>!0,!1),{metricSearch:Ke}=qe.useState(),_e=we.length===0&&Ke,Fe=!ge&&ue&&ue.length===0,at=ge&&we.length===0,Ct=at?void 0:Fe&&"There are no results found. Try a different time range or a different data source."||_e&&"There are no results found. Try adjusting your search or filters."||void 0,Dt=Oe?(0,n.jsx)(d.m,{content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h4",{children:"Unable to retrieve metric names"}),(0,n.jsx)("p",{children:Oe})]}),children:(0,n.jsx)(c.I,{className:We.warningIcon,name:"exclamation-triangle"})}):void 0;return(0,n.jsxs)("div",{className:We.container,children:[(0,n.jsxs)("div",{className:We.header,children:[(0,n.jsx)(a.D,{label:"Search metrics",className:We.searchField,children:(0,n.jsx)(p.p,{placeholder:"Search metrics",prefix:(0,n.jsx)(c.I,{name:"search"}),value:Ke,onChange:de.onSearchQueryChange,suffix:Dt})}),(0,n.jsx)(a.D,{label:(0,n.jsxs)("div",{className:We.displayOptionTooltip,children:[(0,n.jsx)(f.x6,{i18nKey:"explore-metrics.viewBy",children:"View by"}),(0,n.jsx)(u.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:_})]}),className:We.displayOption,children:(0,n.jsx)(m.l6,{value:Xe,onChange:de.onPrefixFilterChange,onOpenMenu:()=>de.reportPrefixFilterInteraction(!0),onCloseMenu:()=>de.reportPrefixFilterInteraction(!1),options:[{label:"All metric names",value:ne},...Array.from(Ue?.groups.keys()??[]).map(tt=>({label:`${tt}_`,value:tt}))]})}),(0,n.jsx)(v.K,{showLabel:!0,label:"Show previews",value:xe,onChange:de.onTogglePreviews})]}),Te&&(0,n.jsxs)(x.F,{title:"Unable to retrieve metric names",severity:"error",children:[(0,n.jsx)("div",{children:"We are unable to connect to your data source. Double check your data source URL and credentials."}),(0,n.jsxs)("div",{children:["(",Te,")"]})]}),Oe&&!Ce&&(0,n.jsx)(x.F,{title:"Unable to retrieve all metric names",severity:"warning",onSubmit:je,onRemove:je,children:(0,n.jsx)("div",{children:Oe})}),(0,n.jsxs)(h.O,{isLoading:at,blockingMessage:Ct,children:[re instanceof g.G1&&(0,n.jsx)(re.Component,{model:re}),re instanceof g.gF&&(0,n.jsx)(re.Component,{model:re})]})]})}}}function ae(ee,de){return g.d0.text().setTitle(ee).setDescription(de).setHeaderActions(new R({metric:ee,title:"Select"})).setOption("content","").build()}function oe(ee){return{container:(0,s.css)({display:"flex",flexDirection:"column"}),headingWrapper:(0,s.css)({marginBottom:ee.spacing(.5)}),header:(0,s.css)({flexGrow:0,display:"flex",gap:ee.spacing(2),marginBottom:ee.spacing(2),alignItems:"flex-end"}),searchField:(0,s.css)({flexGrow:1,marginBottom:0}),metricTabGroup:(0,s.css)({marginBottom:ee.spacing(2)}),displayOption:(0,s.css)({flexGrow:0,marginBottom:0,minWidth:"184px"}),displayOptionTooltip:(0,s.css)({display:"flex",gap:ee.spacing(1)}),warningIcon:(0,s.css)({color:ee.colors.warning.main})}}function J(ee){return(0,M.kj)(ee).state.metricSearch||""}},90623:(k,A,e)=>{"use strict";e.d(A,{p:()=>r});var n=e(74848),s=e(67061),l=e(94753);const r=()=>(0,n.jsxs)(s.B,{direction:"column",gap:1,children:[(0,n.jsx)(l.E,{variant:"h1",children:"Metrics"}),(0,n.jsx)(l.E,{color:"secondary",children:"Explore your Prometheus-compatible metrics without writing a query"})]})},69096:(k,A,e)=>{"use strict";e.d(A,{O:()=>i});var n=e(74848),s=e(32196),l=e(40845),r=e(39558);function i({blockingMessage:o,isLoading:d,children:c}){const a=(0,l.of)(g);return d&&!o&&(o="Loading..."),d?(0,n.jsx)(r._,{className:a.statusMessage,text:o}):o?(0,n.jsx)("div",{className:a.statusMessage,children:o}):c}function g(o){return{statusMessage:(0,s.css)({fontStyle:"italic",marginTop:o.spacing(7),textAlign:"center",width:"100%"})}}},74764:(k,A,e)=>{"use strict";e.d(A,{yn:()=>h,_r:()=>b});var n=e(2543),s=e(76885),l=e(80943),r=e(99140),i=e(16001),g=e(56833),o=e(4200),d=e(51080),c=e(74848),a=e(67061),p=e(55852),u=e(3169);function m(){const P=(0,u.tZ)("Bookmark created");return P.component=(0,c.jsxs)(a.B,{gap:2,direction:"row",children:[(0,c.jsxs)("div",{children:["You can view bookmarks under ",(0,c.jsx)("i",{children:"Explore > Metrics"})]}),(0,c.jsx)(p.z9,{fill:"solid",variant:"secondary",href:o.QX,children:"View bookmarks"})]}),P}const v=20;class x{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const C=()=>{const M=this._recent.slice(0,v).map(I=>this._serializeTrail(I.resolve()));localStorage.setItem(o.sQ,JSON.stringify(M)),localStorage.setItem(o.jT,JSON.stringify(this._bookmarks))};this._save=(0,n.debounce)(C,1e3),window.addEventListener("beforeunload",M=>{this._save=C})}_loadRecentTrailsFromStorage(){const C=[],M=localStorage.getItem(o.sQ);if(M){const I=JSON.parse(M);for(const R of I){const T=this._deserializeTrail(R);C.push(T.getRef())}}return C}_loadBookmarksFromStorage(){const C=localStorage.getItem(o.jT);return(C?JSON.parse(C):[]).map(I=>{if(D(I)){const R=I.currentStep!=null?I.currentStep:I.history.length-1;return{urlValues:I.history[R].urlValues,createdAt:I.createdAt||Date.now()}}return I})}_deserializeTrail(C){const M=new g.b({createdAt:C.createdAt});C.history.map(R=>{this._loadFromUrl(M,R.urlValues);const T=R.parentIndex??M.state.history.state.steps.length-1;M.state.history.setState({currentStep:T}),M.state.history.addTrailStepFromStorage(M,R)});const I=C.currentStep??M.state.history.state.steps.length-1;return M.state.history.setState({currentStep:I}),M.setState(l.Go.cloneSceneObjectState(M.state.history.state.steps[I].trailState,{history:M.state.history})),M}_serializeTrail(C){return{history:C.state.history.state.steps.map(I=>{const R=new g.b(l.Go.cloneSceneObjectState(I.trailState));return{urlValues:(0,l.Is)().getUrlState(R),type:I.type,description:I.description,parentIndex:I.parentIndex}}),currentStep:C.state.history.state.currentStep,createdAt:C.state.createdAt}}getTrailForBookmarkIndex(C){const M=this._bookmarks[C];return M?this.getTrailForBookmark(M):(0,d.ef)()}getTrailForBookmark(C){const M=h(C);for(const R of this._recent){const T=R.resolve();if(h(T)===M)return T}const I=new g.b({});return this._loadFromUrl(I,C.urlValues),I}_loadFromUrl(C,M){const I=s.kM.renderUrl("",M);l.Go.syncStateFromSearchParams(C,new URLSearchParams(I))}get recent(){return this._recent}load(){this._recent=this._loadRecentTrailsFromStorage(),this._bookmarks=this._loadBookmarksFromStorage(),this._refreshBookmarkIndexMap()}setRecentTrail(C){const{steps:M}=C.state.history.state;if(M.length===0||M.length===1&&M[0].type==="start")return;this._recent=this._recent.filter(R=>R!==C.getRef());const I=f(C);this._recent=this._recent.filter(R=>{const T=f(R.resolve());return!(0,n.isEqual)(I,T)}),this._recent.unshift(C.getRef()),this._save()}get bookmarks(){return this._bookmarks}addBookmark(C){const I={urlValues:(0,l.Is)().getUrlState(C),createdAt:Date.now()};this._bookmarks.unshift(I),this._refreshBookmarkIndexMap(),this._save(),(0,r.JD)((0,i.dx)(m()))}removeBookmark(C){C<this._bookmarks.length&&(this._bookmarks.splice(C,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(C){const M=h(C);return this._bookmarkIndexMap.get(M)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((C,M)=>{const I=h(C);this._bookmarkIndexMap.set(I,M)})}}function f(P){const C=(0,l.Is)().getUrlState(P);return E(C),C}function E(P){return delete P.actionView,delete P.layout,delete P.metricSearch,delete P.refresh,(P["var-groupby"]===""||P["var-groupby"]===void 0)&&(P["var-groupby"]="$__all"),typeof P["var-filters"]!="string"&&(P["var-filters"]=P["var-filters"]?.filter(C=>C!=="")),P}function h(P){return P instanceof g.b?JSON.stringify(f(P)):JSON.stringify(E({...P.urlValues}))}let y;function b(){return y||(y=new x),y}function D(P){return P!=null&&typeof P=="object"&&"history"in P}},88434:(k,A,e)=>{"use strict";e.d(A,{R:()=>i,q:()=>r});var n=e(50556),s=e(19347),l=e(4200);class r{constructor(o){this._trail=o}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,s.l)().get(l.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const o=await this.getDatasource();if(o.languageProvider instanceof n.Ay)return o.languageProvider.metricsMetadata||await o.languageProvider.loadMetricsMetadata(),o.languageProvider.metricsMetadata}async getMetricMetadata(o){return o?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[o]):void 0}}function i(g){if(!g)return;const{type:o,help:d,unit:c}=g;return[d,o&&`**Type:** *${o}*`,c&&`**Unit:** ${c}`].join(`

`)}},40588:(k,A,e)=>{"use strict";e.d(A,{h:()=>r,z:()=>l});var n=e(14110);const s="grafana_explore_metrics_";function l(i,g){(0,n.rR)(`${s}${i}`,g)}function r(i,g){if(i.length===g.length)for(const o of g)for(const d of i)o.key===d.key&&o.value!==d.value&&l("label_filter_changed",{label:o.key,action:"changed",cause:"adhoc_filter"});else if(i.length<g.length)for(const o of g){let d=!1;for(const c of i)if(o.key===c.key){d=!0;break}d||l("label_filter_changed",{label:o.key,action:"removed",cause:"adhoc_filter"})}else for(const o of i){let d=!1;for(const c of g)if(c.key===o.key){d=!0;break}d||l("label_filter_changed",{label:o.key,action:"added",cause:"adhoc_filter"})}}},4200:(k,A,e)=>{"use strict";e.d(A,{Ao:()=>g,EY:()=>u,GH:()=>h,OO:()=>C,Pp:()=>D,QX:()=>i,Rp:()=>c,aZ:()=>p,gR:()=>m,jT:()=>b,km:()=>r,sQ:()=>y,td:()=>f,ui:()=>o,ym:()=>P,yr:()=>a});var n=e(65463),s=e(80943),l=e(79422);const r="/explore/metrics/trail",i="/explore/metrics",g="filters",o="{${filters}}",d="metric",c="${metric}",a="groupby",p="${groupby}",u="ds",m="${ds}",v="logsDs",x="${logsDs}",f="$__logs__",E="sqr-metric-viz-query",h={uid:m},y="grafana.trails.recent",b="grafana.trails.bookmarks",D="grafana.trails.breakdown.view";function P(M){return[new s.x0({name:d,value:M,hide:l.zL.hideVariable})]}class C extends n.x{static{this.type="metric-selected-event"}}},51080:(k,A,e)=>{"use strict";e.d(A,{KE:()=>p,U4:()=>f,Vy:()=>b,aM:()=>x,aO:()=>h,ef:()=>u,gA:()=>P,hR:()=>y,iG:()=>D,kj:()=>a,nH:()=>E,xi:()=>m});var n=e(76885),s=e(19347),l=e(32264),r=e(80943),i=e(31193),g=e(56833),o=e(94383),d=e(74764),c=e(4200);function a(C){return r.jh.getAncestor(C,g.b)}function p(C){return r.jh.getAncestor(C,g.b).state.settings}function u(C){return new g.b({initialDS:C,$timeRange:new r.JZ({from:"now-1h",to:"now"}),embedded:!1})}function m(C){const M=(0,r.Is)().getUrlState(C);return v(M)}function v(C){return n.kM.renderUrl(c.km,C)}function x(C){if(C instanceof o.R)return C;if(C.parent)return x(C.parent);throw console.error("Unable to find graph view for",C),new Error("Unable to find trail")}function f(C){return r.jh.interpolate(C,c.gR)}function E(C){return(0,s.l)().getInstanceSettings(C)?.name||C}function h(C){return C?C===c.td?"Logs":C:"Select metric"}function y(){const C=(0,d._r)().recent[0];if(C){const I=r.jh.interpolate(C.resolve(),c.gR);if(typeof I=="string"&&I.length>0)return I}const M=(0,i.tR)().getList({type:"prometheus"});if(M.length>0)return M.find(I=>I.uid===l.$.defaultDatasource)?.uid??M[0].uid}function b(C){const M=l.$.theme2.visualization;return M.getColorByName(M.palette[C%8])}function D(C){const M=Object.keys(C);return M.includes("from")&&M.includes("to")}function P(C){const M=r.jh.lookupVariable("filters",C);return M instanceof r.H9?M.state.filters:null}},27825:(k,A,e)=>{"use strict";e.d(A,{J:()=>f});var n=e(52622),s=e(38248),l=e(74848),r=e(96540),i=e(91890),g=e(72574),o=e(32264),d=e(66864),c=e(94354),a=e(10354),p=e(88841),u=e(94397);const m=[{label:"Size",value:n.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:n.J1.Count,description:"Split the buckets based on count"}],v=[{label:"Split",value:n.J1.Size,description:"Split the buckets based on size"}],x=({value:E,onChange:h,item:y})=>{const[b,D]=(0,r.useState)(!1),P=I=>{D(!(0,u.N_)(I)),h({...E,value:I})},M=(0,g.w)().getVariables().map(I=>({value:I.name,label:I.label||I.name,origin:i.$0.Template}));return(0,l.jsxs)(d.Gy,{children:[(0,l.jsx)(c.z,{value:E?.mode||n.J1.Size,options:E?.scale?.type===n.L4.Log?v:m,onChange:I=>{h({...E,mode:I})}}),o.$.featureToggles.transformationsVariableSupport?(0,l.jsx)(p.y,{invalid:b,error:"Value needs to be an integer or a variable",value:E?.value??"",placeholder:"Auto",onChange:P,suggestions:M}):(0,l.jsx)(a.p,{value:E?.value??"",placeholder:"Auto",onChange:I=>{h({...E,value:I.currentTarget.value})}})]})};function f(E,h,y,b){h.addCustomEditor({id:"xBuckets",path:`${E}xBuckets`,name:"X Bucket",editor:x,category:b,defaultValue:{mode:n.J1.Size}}),h.addCustomEditor({id:"yBuckets",path:`${E}yBuckets`,name:"Y Bucket",editor:x,category:b,defaultValue:{mode:n.J1.Size}}),h.addCustomEditor({id:"yBuckets-scale",path:`${E}yBuckets.scale`,name:"Y Bucket scale",category:b,editor:s.W,defaultValue:{type:n.L4.Linear}})}},3290:(k,A,e)=>{"use strict";e.d(A,{VQ:()=>W,wY:()=>j,Nb:()=>w,eE:()=>U,yJ:()=>B});var n=e(81160),s=e(18282),l=e(81010),r=e(11261),i=e(28240),g=e(83195),o=e(41260),d=e(70416),c=e(77678),a=e(73060),p=e(32264),u=e(52622),m=e(97706);const{abs:v,pow:x}=Math,f=new Map;function E(q,G,te,H){let se=[],ne=H.map(m.E);for(let le=G;le<te;le++){let _=v(le),Q=(0,m.h)(x(q,le),_);for(let ae=0;ae<H.length;ae++){let oe=H[ae]*Q,J=(oe>=0&&le>=0?0:_)+(le>=ne[ae]?0:ne[ae]),ee=(0,m.h)(oe,J);se.push(ee),f.set(ee,J)}}return se}const h=q=>q%1===0,y=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],b=E(10,-16,0,y),D=E(10,0,16,y),P=D.filter(h),C=b.concat(D),M=b.concat(P),I=1*1e3,R=60*I,T=60*R,S=24*T,L=365*S,O=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,I,2*I,4*I,5*I,10*I,15*I,20*I,30*I,R,2*R,4*R,5*R,10*R,15*R,20*R,30*R,T,2*T,4*T,6*T,8*T,12*T,18*T,S,2*S,3*S,4*S,5*S,6*S,7*S,10*S,15*S,30*S,45*S,60*S,90*S,180*S,L,2*L,3*L,4*L,5*L,6*L,7*L,8*L,9*L,10*L],j={id:s.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:q=>{const{xField:G,yField:te,xs:H,ys:se}=z(q);return G||te||!H.length||!se.length?l.M.NotPossible:l.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(q,G)=>te=>te.pipe((0,n.T)(H=>{if(p.$.featureToggles.transformationsVariableSupport){const se={...q,xBuckets:{...q.xBuckets},yBuckets:{...q.yBuckets}};return se.xBuckets?.value&&(se.xBuckets.value=G.interpolate(se.xBuckets.value)),se.yBuckets?.value&&(se.yBuckets.value=G.interpolate(se.yBuckets.value)),j.transformer(se,G)(H)}else return j.transformer(q,G)(H)})),transformer:q=>G=>{const te=W(G,q);return q.keepOriginalData?[te,...G]:[te]}};function N(q){return q==="+Inf"?1/0:q==="-Inf"?-1/0:+(q??0)}function F(q,G){return N(q)-N(G)}function U(q){return q?.meta?.custom??{}}function w(q){let G=!1;for(let te of q.fields)switch(te.name){case"y":case"yMin":case"yMax":if(G)return!1;G=!0}return G}function B(q){const G=q.frame.fields[0],te=G.values,H=q.frame.fields.filter((de,xe)=>de.type===r.PU.number&&xe>0),se=te.length*H.length,ne=new Array(se),le=new Array(se),_=new Array(se),Q=H.map(de=>de.values.slice());Q.forEach((de,xe)=>{for(let re=0;re<de.length;re++)_[Q.length*re+xe]=de[re]});const ae=Array.from({length:H.length},(de,xe)=>xe);for(let de=0,xe=0,re=0;de<se;xe=++de%ae.length)le[de]=ae[xe],xe===0&&de>=ae.length&&re++,ne[de]=te[re];let oe=H[0].labels?.le!=null?"yMax":"y";switch(q.layout){case u.D7.le:oe="yMax";break;case u.D7.ge:oe="yMin";break;case u.D7.unknown:oe="y";break}const J={yOrdinalDisplay:H.map(de=>(0,i.Ct)(de,q.frame)),yMatchWithLabel:Object.keys(H[0].labels??{})[0]};if(J.yMatchWithLabel&&(J.yOrdinalLabel=H.map(de=>de.labels?.[J.yMatchWithLabel]??""),J.yMatchWithLabel==="le"&&(J.yMinDisplay="0.0")),q.unit?.length||q.decimals!=null){const de=(0,g.j_)(q.unit??"short");J.yMinDisplay&&(J.yMinDisplay=(0,g.cN)(de(0,q.decimals))),J.yOrdinalDisplay=J.yOrdinalDisplay.map(xe=>{let re=+xe;return Number.isNaN(re)?xe:(0,g.cN)(de(re,q.decimals))})}const ee={...H[0].config};return ee.displayNameFromDS&&delete ee.displayNameFromDS,{length:ne.length,refId:q.frame.refId,meta:{type:o.m.HeatmapCells,custom:J},fields:[{name:G.type===r.PU.time?"xMax":"x",type:G.type,values:ne,config:G.config},{name:oe,type:r.PU.number,values:le,config:{unit:"short"}},{name:q.value?.length?q.value:"Value",type:r.PU.number,values:_,config:ee,display:H[0].display}]}}function K(q){q=q.slice(),q.sort((te,H)=>F(te.name,H.name));const G=q.map(te=>te.fields[1].values.slice());return G.reverse(),G.forEach((te,H)=>{if(H<G.length-1)for(let se=0;se<te.length;se++)te[se]-=G[H+1][se]}),G.reverse(),q.map((te,H)=>({...te,fields:[te.fields[0],{...te.fields[1],values:G[H]}]}))}function W(q,G){const{xField:te,yField:H,xs:se,ys:ne}=z(q);if(!te||!H)throw"no heatmap fields found";if(!se.length||!ne.length)throw"no values found";const le=G.xBuckets??{},_=G.yBuckets??{};if(le.scale?.type===u.L4.Log)throw"X axis only supports linear buckets";const Q=G.yBuckets?.scale??{type:u.L4.Linear},ae=Y(se,ne,{xSorted:(0,a.g2)(se),xTime:te.type===r.PU.time,xMode:le.mode,xSize:le.mode===u.J1.Size?(0,d.WT)((0,d.E9)(le.value??"")):le.value?+le.value:void 0,yMode:_.mode,ySize:_.value?+_.value:void 0,yLog:Q?.type===u.L4.Log?Q?.log:void 0,xMin:G.timeRange?.from.valueOf(),xMax:G.timeRange?.to.valueOf()});return{length:ae.x.length,name:(0,i.Ct)(H),meta:{type:o.m.HeatmapCells},fields:[{name:"xMin",type:te.type,values:ae.x,config:te.config},{name:"yMin",type:r.PU.number,values:ae.y,config:{...H.config,custom:{scaleDistribution:Q}}},{name:"Count",type:r.PU.number,values:ae.count,config:{unit:"short"}}]}}function z(q){let G,te,H=0;for(let _ of q)_.fields.find(ae=>ae.type===r.PU.time)&&(H+=_.length);let se=Array(H),ne=Array(H),le=0;for(let _ of q){const Q=_.fields.find(oe=>oe.type===r.PU.time);if(!Q)continue;G||(G=Q);const ae=Q.values;for(let oe of _.fields)if(oe!==Q&&oe.type===r.PU.number){const J=oe.values;for(let ee=0;ee<ae.length;ee++,le++)se[le]=ae[ee],ne[le]=J[ee];te||(te=oe)}}return{xField:G,yField:te,xs:se,ys:ne}}function Y(q,G,te){let H=q.length,se=te?.xSorted??!1,ne=te?.ySorted??!1,le=te?.xMin??(se?q[0]:1/0),_=ne?G[0]:1/0,Q=te?.xMax??(se?q[H-1]:-1/0),ae=ne?G[H-1]:-1/0,oe=te?.yLog,J=te?.xMin!=null&&te?.xMax!=null,ee=te?.yMin!=null&&te?.yMax!=null;for(let _e=0;_e<H;_e++)!se&&!J&&(le=Math.min(le,q[_e]),Q=Math.max(Q,q[_e])),!ne&&!ee&&(!oe||G[_e]>0)&&(_=Math.min(_,G[_e]),ae=Math.max(ae,G[_e]));let de=te?.xSize??0,xe=te?.ySize??0,re=te?.xMode,ue=te?.yMode;if((!Number.isFinite(de)||de<=0)&&(re=u.J1.Count,de=20),(!Number.isFinite(xe)||xe<=0)&&(ue=u.J1.Count,xe=10),re===u.J1.Count){let _e=(Q-le)/Math.max(de-1,1),Fe=te?.xTime?O:M,at=Fe.findIndex(Ct=>Ct>_e)-1;de=Fe[Math.max(at,0)]}if(ue===u.J1.Count){let _e=(ae-_)/Math.max(xe-1,1),Fe=te?.yTime?O:M,at=Fe.findIndex(Ct=>Ct>_e)-1;xe=Fe[Math.max(at,0)]}let Te=te?.xCeil?_e=>(0,c.Uh)(_e,de):_e=>(0,c.rs)(_e,de),ge=te?.yCeil?_e=>(0,c.Uh)(_e,xe):_e=>(0,c.rs)(_e,xe);if(oe){xe=1/(te?.ySize??1);let _e=oe===2?Math.log2:Math.log10;ge=te?.yCeil?Fe=>(0,c.Uh)(_e(Fe),xe):Fe=>(0,c.rs)(_e(Fe),xe)}let Oe=Te(le),Ue=Te(Q),Xe=ge(_),we=ge(ae),qe=Math.round((Ue-Oe)/de)+1,We=Math.round((we-Xe)/xe)+1,[Ce,je,Ke]=X(qe,We,Oe,de,Xe,xe,oe);for(let _e=0;_e<H;_e++){if(oe&&G[_e]<=0)continue;const Fe=(Te(q[_e])-Oe)/de,at=(ge(G[_e])-Xe)/xe,Ct=Fe*We+at;Ke[Ct]++}return{x:Ce,y:je,count:Ke}}function X(q,G,te,H,se,ne,le){const _=q*G,Q=new Array(_),ae=new Array(_),oe=new Array(_);for(let J=0,ee=0,de=te;J<_;ee=++J%G)oe[J]=0,le?ae[J]=le**(se+ee*ne):ae[J]=se+ee*ne,ee===0&&J>=G&&(de+=H),Q[J]=de;return[Q,ae,oe]}},91847:(k,A,e)=>{"use strict";e.d(A,{$n:()=>l,g_:()=>n,uk:()=>s});var n=(i=>(i.ShortcodeFigure="shortcodeFigure",i.UIImage="uiImage",i))(n||{});const s={calculateField:{name:"Add field from calculation",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${r("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",i,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${r("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",i,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${r("/static/img/docs/transformations/filter-name-table-before-7-0.png",i,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${r("/static/img/docs/transformations/filter-name-table-after-7-0.png",i,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${r("/static/img/docs/transformations/filter-name-stat-after-7-0.png",i,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(i="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${r("/static/img/docs/transformations/nested-table-select-calculation.png",i,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${r("/static/img/docs/transformations/nested-table-select-stat.png",i,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${r("/static/img/docs/transformations/join-fields-before-7-0.png",i,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${r("/static/img/docs/transformations/join-fields-after-7-0.png",i,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${r("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",i,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${r("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",i,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${r("/static/img/docs/transformations/table-sparklines.png",i,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${r("/static/img/docs/transformations/timeseries-table-select-stat.png",i,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},regression:{name:"Regression analysis",getHelperDocs:function(i="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${r("/static/img/docs/transformations/linear-regression.png",i,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${r("/static/img/docs/transformations/polynomial-regression.png",i,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function l(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function r(i,g,o){return g==="shortcodeFigure"?`{{< figure src="${i}" class="docs-image--no-shadow" max-width= "1100px" alt="${o}" >}}`:`![${o}](https://grafana.com${i})`}},9581:(k,A,e)=>{"use strict";e.d(A,{YD:()=>r,dy:()=>s,kD:()=>l});var n=e(52622),s=(g=>(g.Prepare="prepare",g.Calculate="calculate",g.Modify="modify",g))(s||{}),l=(g=>(g.Heading="heading",g.Distance="distance",g.Area="area",g))(l||{}),r=(g=>(g.AsLine="asLine",g.LineBuilder="lineBuilder",g))(r||{});const i={action:"prepare",source:{mode:n.aG.Auto}}},78134:(k,A,e)=>{"use strict";e.d(A,{EX:()=>a,pp:()=>u,tt:()=>d});var n=e(70915),s=e(11217),l=e(44294),r=e(22796),i=e(52490),g=e(11261),o=e(9581);function d(m){const v=[];for(const x of m.values)x&&v.push(a(x));return new s.A(v)}function c(m){const v=new Array(m.length);if(m.length>1){let x=p(m[0]);for(let f=1;f<m.length;f++){let E=p(m[f]);if(x&&E){let h=Math.atan2(E[0]-x[0],E[1]-x[1])*180/Math.PI;h<0&&(h+=360),v[f-1]=v[f]=h}}}else v.fill(0);return v}function a(m){return m instanceof l.A?m.getCoordinates():(0,n.q1)(m.getExtent())}function p(m){if(m)return(0,r.WP)(a(m))}function u(m,v){const x=m.values,f=new Array(m.values.length),E=v.calc??o.kD.Heading,h=v.field??E;switch(E){case o.kD.Area:{for(let y=0;y<x.length;y++){const b=x[y];b&&(f[y]=(0,i.UG)(b))}return{name:h,type:g.PU.number,config:{unit:"areaM2"},values:f}}case o.kD.Distance:{for(let y=0;y<x.length;y++){const b=x[y];b&&(f[y]=(0,i.R3)(b))}return{name:h,type:g.PU.number,config:{unit:"lengthm"},values:f}}case o.kD.Heading:default:return{name:h,type:g.PU.number,config:{unit:"degree"},values:c(x)}}}},88841:(k,A,e)=>{"use strict";e.d(A,{y:()=>f});var n=e(74848),s=e(32196),l=e(34743),r=e(36376),i=e(7315),g=e(96540),o=e(40845),d=e(17464),c=e(40276),a=e(72093),p=e(10354),u=e(43538);const m=(h,y)=>h-y*Math.floor(h/y),v=8,x=(h,y)=>({suggestionsWrapper:(0,s.css)({boxShadow:h.shadows.z2}),errorTooltip:(0,s.css)({position:"absolute",top:y+v+"px",zIndex:h.zIndex.tooltip}),inputWrapper:(0,s.css)({position:"relative"})}),f=({value:h="",onChange:y,suggestions:b,placeholder:D,error:P,invalid:C})=>{const[M,I]=(0,g.useState)(!1),[R,T]=(0,g.useState)(0),[S,L]=(0,g.useState)(h.toString()),[O,j]=(0,g.useState)(0),[N,F]=(0,g.useState)(0),[U,w]=(0,g.useState)(0),B=(0,o.$j)(),K=x(B,N),W=(0,g.useRef)(),z=[(0,l.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,l.BN)()],{refs:Y,floatingStyles:X}=(0,r.we)({open:M,placement:"bottom-start",onOpenChange:I,middleware:z,whileElementsMounted:i.ll,strategy:"fixed"}),q=(0,g.useCallback)(le=>{Y.setReference(le),W.current=le},[Y]),G=(0,g.useRef)(null);(0,g.useEffect)(()=>{j(E(G.current,R))},[R]);const te=g.useCallback((le,_=W.current)=>{const Q=_.selectionStart,ae=_.value;ae[U-1]==="$"?_.value=ae.slice(0,U)+le.value+ae.slice(Q):_.value=ae.slice(0,U)+"$"+le.value+ae.slice(Q),L(_.value),I(!1),T(0),y(_.value)},[y,U]),H=g.useCallback(le=>{if(!M){if(le.key==="$"||le.key===" "&&le.ctrlKey){w(W.current.selectionStart||0),I(!0);return}return}switch(le.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return I(!1),T(0);case"Enter":return le.preventDefault(),te(b[R]);case"ArrowDown":case"ArrowUp":le.preventDefault();const _=le.key==="ArrowDown"?1:-1;return T(Q=>m(Q+_,b.length));default:return}},[M,b,R,te]),se=g.useCallback(le=>{L(le.currentTarget.value)},[]),ne=g.useCallback(le=>{y(le.currentTarget.value)},[y]);return(0,g.useEffect)(()=>{F(W.current.clientHeight)},[]),(0,n.jsxs)("div",{className:K.inputWrapper,children:[M&&(0,n.jsx)(d.ZL,{children:(0,n.jsx)("div",{ref:Y.setFloating,style:X,className:K.suggestionsWrapper,children:(0,n.jsx)(c.E,{scrollTop:O,autoHeightMax:"300px",setScrollTop:({scrollTop:le})=>j(le),children:(0,n.jsx)(u.k,{activeRef:G,suggestions:b,onSuggestionSelect:te,onClose:()=>I(!1),activeIndex:R})})})}),C&&P&&(0,n.jsx)("div",{className:K.errorTooltip,children:(0,n.jsx)(a.P,{children:P})}),(0,n.jsx)(p.p,{placeholder:D,invalid:C,ref:q,value:S,onChange:se,onBlur:ne,onKeyDown:H})]})};f.displayName="SuggestionsInput";function E(h,y){return(h?.clientHeight??0)*y}},94397:(k,A,e)=>{"use strict";e.d(A,{N_:()=>d,ZI:()=>i,aG:()=>g,eJ:()=>o,qt:()=>c});var n=e(96540),s=e(28240),l=e(91410),r=e(32264);function i(a){return(0,n.useMemo)(()=>Array.isArray(a)?Object.keys(a.reduce((p,u)=>!u||!Array.isArray(u.fields)?p:u.fields.reduce((m,v)=>{const x=(0,s.Ct)(v,u,a);return m[x]=!0,m},p),{})):[],[a])}function g(a){const p=new Set;for(const u of a)for(const m of u.fields)if(m.labels)for(const v of Object.keys(m.labels))p.add(v);return p}const o={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},d=a=>!!(typeof a=="number"||!Number.isNaN(Number(a))||/^\$[A-Za-z0-9_]+$/.test(a)&&r.$.featureToggles.transformationsVariableSupport);function c(a){const p=[];a&&(p.push({label:"Browser",value:"browser"}),p.push({label:"UTC",value:"utc"}));const u=(0,l.P3)();for(const m of u)p.push({label:m,value:m});return p}},87617:(k,A,e)=>{"use strict";e.d(A,{$u:()=>p,Ay:()=>x,Cj:()=>d,EC:()=>a,Y_:()=>o,dJ:()=>u,g4:()=>c,jE:()=>m,t_:()=>i});var n=e(65307),s=e(2913);const l={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:s.Ay.externalUserMngInfo,externalUserMngLinkName:s.Ay.externalUserMngLinkName,externalUserMngLinkUrl:s.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},r=(0,n.Z0)({name:"users",initialState:l,reducers:{usersLoaded:(f,E)=>{const{totalCount:h,perPage:y,page:b,orgUsers:D}=E.payload,P=Math.ceil(h/y);return{...f,isLoading:!0,users:D,perPage:y,page:b,totalPages:P}},searchQueryChanged:(f,E)=>({...f,searchQuery:E.payload,page:l.page}),setUsersSearchPage:(f,E)=>({...f,page:E.payload}),pageChanged:(f,E)=>({...f,page:E.payload}),sortChanged:(f,E)=>({...f,sort:E.payload}),usersFetchBegin:f=>({...f,isLoading:!0}),usersFetchEnd:f=>({...f,isLoading:!1}),rolesFetchBegin:f=>({...f,rolesLoading:!0}),rolesFetchEnd:f=>({...f,rolesLoading:!1})}}),{searchQueryChanged:i,setUsersSearchPage:g,usersLoaded:o,usersFetchBegin:d,usersFetchEnd:c,pageChanged:a,sortChanged:p,rolesFetchBegin:u,rolesFetchEnd:m}=r.actions,x={users:r.reducer}},20601:(k,A,e)=>{"use strict";e.d(A,{B:()=>s});var n=e(83077);const s=new n.O},26260:(k,A,e)=>{"use strict";e.d(A,{$u:()=>v,D4:()=>E,Iv:()=>h,U2:()=>f,VT:()=>x,z_:()=>m});var n=e(2543),s=e.n(n),l=e(31193),r=e(3843),i=e(24240),g=e(72401),o=e(48594),d=e(87421),c=e(56968),a=e(75096),p=e(53699);const u="Filters",m=D=>async(P,C)=>{let M=b(D,C());if(!M&&(P(y(D)),M=b(D,C()),!M))return;const I=M.filters.findIndex(T=>T.key===D.key&&T.value===D.value);if(I===-1){const{value:T,key:S,operator:L}=D,O={value:T,key:S,operator:L};return await P(f((0,a.jX)(M),O))}const R={...M.filters[I],operator:D.operator};return await P(v((0,a.jX)(M),{index:I,filter:R}))},v=(D,P)=>async(C,M)=>{const I=(0,d.dn)(D,M());C((0,o.kb)(D.rootStateKey,(0,p.E2)((0,a.qD)(I,P)))),await C((0,g.us)((0,a.jX)(I),!0))},x=(D,P)=>async(C,M)=>{const I=(0,d.dn)(D,M());C((0,o.kb)(D.rootStateKey,(0,p.D$)((0,a.qD)(I,P)))),await C((0,g.us)((0,a.jX)(I),!0))},f=(D,P)=>async(C,M)=>{const I=(0,d.dn)(D,M());C((0,o.kb)(D.rootStateKey,(0,p.xt)((0,a.qD)(I,P)))),await C((0,g.us)((0,a.jX)(I),!0))},E=(D,P)=>async(C,M)=>{const I=(0,d.dn)(D,M());C((0,o.kb)(D.rootStateKey,(0,p.qZ)((0,a.qD)(I,P)))),await C((0,g.us)((0,a.jX)(I),!0))},h=(D,P)=>async(C,M)=>{const I=(0,d.dn)(D,M());C((0,o.kb)(D.rootStateKey,(0,c.QP)((0,a.qD)(I,{propName:"datasource",propValue:P}))));const T=(await(0,l.tR)().get(P))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";C((0,o.kb)(D.rootStateKey,(0,r.BC)({infoText:T})))},y=D=>(P,C)=>{const M=(0,d.y7)(C()),I={...(0,n.cloneDeep)(p.MK),datasource:D.datasource,name:u,id:u,rootStateKey:M},R=!1,T=(0,d.hk)(M,C()),S={type:"adhoc",id:I.id,rootStateKey:M};P((0,o.kb)(M,(0,c.QV)((0,a.qD)(S,{global:R,model:I,index:T}))))},b=(D,P)=>{const C=(0,d.y7)(P),M=(0,d.nx)(C,P);let I;for(const R of Object.values(M.variables))if((0,i.EW)(R)&&R.datasource?.uid===D.datasource.uid){I=R;break}return I}},53699:(k,A,e)=>{"use strict";e.d(A,{AA:()=>p,D$:()=>d,E2:()=>c,MK:()=>i,qZ:()=>a,xt:()=>o});var n=e(65307),s=e(80484),l=e(87421),r=e(83370);const i={...s.Vg,type:"adhoc",datasource:null,filters:[]},g=(0,n.Z0)({name:"templating/adhoc",initialState:r.j,reducers:{filterAdded:(u,m)=>{const v=(0,l.Fs)(u,m.payload.id);v.type==="adhoc"&&v.filters.push(m.payload.data)},filterRemoved:(u,m)=>{const v=(0,l.Fs)(u,m.payload.id);if(v.type!=="adhoc")return;const x=m.payload.data;v.filters.splice(x,1)},filterUpdated:(u,m)=>{const v=(0,l.Fs)(u,m.payload.id);if(v.type!=="adhoc")return;const{filter:x,index:f}=m.payload.data;v.filters[f]=x},filtersRestored:(u,m)=>{const v=(0,l.Fs)(u,m.payload.id);v.type==="adhoc"&&(v.filters=m.payload.data)}}}),{filterAdded:o,filterRemoved:d,filterUpdated:c,filtersRestored:a}=g.actions,p=g.reducer},13344:(k,A,e)=>{"use strict";e.d(A,{Ek:()=>i,To:()=>l,Zm:()=>s,ou:()=>r,qF:()=>n,qz:()=>g});const n="00000000-0000-0000-0000-000000000000",s="All",l="$__all",r="None",i="",g="var-"},35589:(k,A,e)=>{"use strict";e.d(A,{c:()=>d,z:()=>c});var n=e(74848),s=e(92145),l=e(96540),r=e(13544),i=e(40845),g=e(21744),o=e(85140);const d="Grafana-LegacyVariableQueryEditor",c=({onChange:a,query:p})=>{const u=(0,i.of)(o.$),[m,v]=(0,l.useState)(p),x=h=>{v(h.currentTarget.value)},f=(0,l.useCallback)(h=>{a(h.currentTarget.value,h.currentTarget.value)},[a]),E=(0,s.Bi)();return(0,n.jsx)(g.f,{id:E,rows:2,value:m,onChange:x,onBlur:f,placeholder:"Metric name or tags query",required:!0,"data-testid":r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:u.textarea})};c.displayName=d},70766:(k,A,e)=>{"use strict";e.d(A,{y:()=>o});var n=e(74848),s=e(96540),l=e(72574),r=e(685),i=e(24240),g=e(35589);async function o(c,a=r.cS){if((0,i.zs)(c))return c.variables.editor;if((0,i.X3)(c)){const p=await a(c.meta);if(!p.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return p.components.QueryEditor??null}return(0,i.Hf)(c)?d:(0,i.d5)(c)?(await a(c.meta)).components.VariableQueryEditor??g.z:null}function d({datasource:c,query:a,onChange:p}){const u=(0,s.useCallback)(m=>{p({refId:"StandardVariableQuery",query:m})},[p]);return(0,n.jsx)(g.z,{query:a.query,onChange:u,datasource:c,templateSrv:(0,l.w)()})}},3843:(k,A,e)=>{"use strict";e.d(A,{BC:()=>c,DW:()=>g,Eo:()=>p,FN:()=>i,NY:()=>a,T7:()=>d,nS:()=>s,sJ:()=>o,wf:()=>r,y8:()=>u});var n=e(65307);const s={id:"",isValid:!0,errors:{},name:"",extended:null},l=(0,n.Z0)({name:"templating/editor",initialState:s,reducers:{variableEditorMounted:(m,v)=>{m.name=v.payload.name,m.id=v.payload.id},variableEditorUnMounted:(m,v)=>s,changeVariableNameSucceeded:(m,v)=>{m.name=v.payload.data.newName,delete m.errors.name,m.isValid=Object.keys(m.errors).length===0},changeVariableNameFailed:(m,v)=>{m.name=v.payload.newName,m.errors.name=v.payload.errorText,m.isValid=Object.keys(m.errors).length===0},addVariableEditorError:(m,v)=>{m.errors[v.payload.errorProp]=v.payload.errorText,m.isValid=Object.keys(m.errors).length===0},removeVariableEditorError:(m,v)=>{delete m.errors[v.payload.errorProp],m.isValid=Object.keys(m.errors).length===0},changeVariableEditorExtended:(m,v)=>{m.extended={...m.extended,...v.payload}},cleanEditorState:()=>s}}),r=l.reducer,{changeVariableNameSucceeded:i,changeVariableNameFailed:g,variableEditorMounted:o,variableEditorUnMounted:d,changeVariableEditorExtended:c,addVariableEditorError:a,removeVariableEditorError:p,cleanEditorState:u}=l.actions},85830:(k,A,e)=>{"use strict";e.d(A,{M:()=>n});var n=(s=>(s[s.MaxSize=50]="MaxSize",s))(n||{})},25304:(k,A,e)=>{"use strict";e.d(A,{z:()=>r});var n=e(72574),s=e(20601),l=e(13344);function r(i){const g={},o=(0,n.w)().getVariables();for(let d=0;d<o.length;d++){const c=o[d],a=i&&i[c.name];c.skipUrlSync||(a?g[l.qz+c.name]=a.value:g[l.qz+c.name]=s.B.get(c.type).getValueForUrl(c))}return g}},24240:(k,A,e)=>{"use strict";e.d(A,{CH:()=>x,EW:()=>r,Hf:()=>p,P4:()=>l,SP:()=>o,VN:()=>v,VO:()=>i,X3:()=>m,d5:()=>a,iv:()=>g,m8:()=>d,zs:()=>u});var n=e(29505),s=e(35589);const l=f=>f.type==="query",r=f=>f.type==="adhoc",i=f=>f.type==="constant",g=f=>"multi"in f,o=f=>"options"in f,d=f=>"current"in f;function c(f){return f===null?!1:typeof f=="string"}const a=f=>!!f.metricFindQuery&&!f.variables,p=f=>{if(!f.variables||f.variables.getType()!==n.Qz.Standard)return!1;const E=f.variables;return"toDataQuery"in E&&!!E.toDataQuery},u=f=>{if(!f.variables||f.variables.getType()!==n.Qz.Custom)return!1;const E=f.variables;return"query"in E&&"editor"in E&&!!E.query&&!!E.editor},m=f=>f.variables?f.variables.getType()===n.Qz.Datasource:!1;function v(f,E){return f?f.displayName===s.c||a(E):!1}function x(f,E){return f?f.displayName!==s.c&&(m(E)||p(E)||u(E)):!1}},2223:(k,A,e)=>{"use strict";e.d(A,{i:()=>o});var n=e(74848),s=e(96540),l=e(37390);const r=({nodes:d,edges:c,direction:a,width:p,height:u,onDoubleClick:m})=>{const v=(0,s.useRef)(null),x=(0,s.useRef)(null),f=(0,s.useCallback)(E=>{m&&m(E.nodes[0])},[m]);return(0,s.useEffect)(()=>((async()=>{const h=await e.e(5083).then(e.t.bind(e,83416,23)),y={nodes:i(h,d),edges:g(h,c)},b={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:a??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};v.current=new h.Network(x.current,y,b),v.current?.on("doubleClick",f)})(),()=>{v.current&&v.current.off("doubleClick")}),[a,c,d,f]),(0,n.jsx)("div",{children:(0,n.jsx)("div",{ref:x,style:{width:p??"100%",height:u??"60vh"}})})};function i(d,c){const a=c.map(p=>({...p,shape:"box"}));return new d.DataSet(a)}function g(d,c){const a=c.map(p=>({...p,arrows:"to",dashes:!0}));return new d.DataSet(a)}function o({edges:d,nodes:c,show:a,title:p,children:u}){const[m,v]=(0,s.useState)(a),x=(0,s.useCallback)(()=>v(!0),[v]),f=(0,s.useCallback)(()=>v(!1),[v]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.a,{isOpen:m,title:p,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:f,onDismiss:f,children:(0,n.jsx)(r,{nodes:c,edges:d})}),u({showModal:x})]})}},27238:(k,A,e)=>{"use strict";e.d(A,{WT:()=>s,bX:()=>i,t4:()=>r});var n=e(65307);const s={usages:[],usagesNetwork:[]},l=(0,n.Z0)({name:"templating/inspect",initialState:s,reducers:{initInspect:(g,o)=>{const{usages:d,usagesNetwork:c}=o.payload;g.usages=d,g.usagesNetwork=c}}}),r=l.reducer,{initInspect:i}=l.actions},12846:(k,A,e)=>{"use strict";e.d(A,{qJ:()=>p,hI:()=>c,hM:()=>f,H7:()=>a,xU:()=>y,P5:()=>R,g0:()=>E,PK:()=>M,Ow:()=>P});var n=e(6709);function s(T,S){const L=new Set;for(const O of T)L.add(S(O));return L}var l=e(84423),r=e(87490),i=e(34214),g=e(20601),o=e(24240),d=e(75096);const c=T=>{const S=[];for(const L of T)S.push({id:L.id,label:`${L.id}`});return S},a=(T,S)=>T.filter(L=>S.some(O=>O.from===L.id||O.to===L.id)),p=T=>{const S=[];for(const L of T)for(const O of T){if(L===O)continue;g.B.get(L.type).dependsOn(L,O)&&S.push({from:L.id,to:O.id})}return S};function u(T){const S=(0,d.t4)(T);if(!S)return;const L=S.slice(1).find(O=>O!==void 0);if(!(L in{}))return L}const m=(T,S)=>{d.SY.lastIndex=0;const L=[],j=(0,r.MA)(S,2).match(d.SY);if(!j)return L;for(const N of j){if(!N||N.indexOf("$__")!==-1||N.indexOf("${__")!==-1||N.indexOf("$hashKey")!==-1)continue;const F=u(N);T.some(U=>U.id===F)||L.find(U=>U===F)||F&&L.push(F)}return L},v={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},x=(T,S,L)=>{const O=Object.keys(S.value).reduce((N,F)=>{const U=S.value[F];if(!U||typeof U!="string")return N;const w=v[F]?v[F].find(K=>K.test(T)):void 0;let B=(0,d.wJ)(U,T);return F==="repeat"&&U===T&&(B=!0),!w&&B&&(N={...N,[F]:U}),N},{}),j=Object.keys(S.value).reduce((N,F)=>{const U=S.value[F];if(U&&typeof U=="object"&&Object.keys(U).length){let w=U.title||U.name||U.id||F;Array.isArray(S.value)&&S.key==="panels"&&(w=`${w}[${U.id}]`);const B=x(T,{key:F,value:U},{});Object.keys(B).length&&(N={...N,[w]:B})}return N},{});return(Object.keys(O).length||Object.keys(j).length)&&(L={...L,...O,...j}),L},f=(T,S)=>{if(!S)return{unUsed:[],usages:[]};const L=[];let O=[];const j=S.getSaveModelCloneOld();for(const N of T){const F=N.id,U=x(F,{key:"model",value:j},{});!Object.keys(U).length&&!(0,o.EW)(N)&&L.push(N),Object.keys(U).length&&O.push({variable:N,tree:U})}return{unUsed:L,usages:O}};async function E(T,S){return new Promise((L,O)=>{setTimeout(()=>{try{const j=h(T,S);L(P(j))}catch(j){O(j)}},200)})}function h(T,S){if(!S)return[];let L=[];const O=S.getSaveModelCloneOld(),j=m(T,O);for(const N of j){const F=x(N,{key:"model",value:O},{});if(Object.keys(F).length){const U={id:N,name:N};L.push({variable:U,tree:F})}}return L}function y(T,S,L){const O=s(S.descendants(T),N=>N.name);O.add(n.c.includeVars);for(const N of T)O.add(N);return b([...O],L)}function b(T,S){const L=[];for(const O of T)S[O]&&L.push(...S[O]);return new Set(L)}const D=(T,S)=>{const{id:L,value:O}=S,{nodes:j,edges:N}=T;if(O&&typeof O=="string"){const F=`${S.id}-${O}`;return j.push({id:F,label:O}),N.push({from:F,to:L}),T}if(O&&typeof O=="object"){const F=Object.keys(O);for(const U of F){const w=`${S.id}-${U}`;j.push({id:w,label:U}),N.push({from:w,to:L}),T=D(T,{id:w,value:O[U]})}return T}return T},P=T=>{const S=[];for(const L of T){const{variable:O,tree:j}=L,N={variable:O,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};S.push(D(N,{id:"dashboard",value:j}))}return S},C=T=>Object.values(T).reduce((L,O)=>typeof O=="object"?L+C(O):L+1,0),M=(T,S)=>{const L=S.find(O=>O.variable.id===T);return L?C(L.tree):0};function I(T){const S=[];for(const L of T)S.push(L),L.panels?.length&&S.push(...I(L.panels.map(O=>new PanelModel(O))));return S}function R(T){const S={};for(const L of T){const O=(0,l.tw)(L),j=[...O.matchAll(/"repeat":"([^"]+)"/g)].map(U=>U[1]),N=O.match(d.SY)?.map(U=>u(U))??[],F=[...j,...N];for(const U of F)U in S?S[U].add(L.id):S[U]=new Set([L.id])}return S}},81515:(k,A,e)=>{"use strict";e.d(A,{E5:()=>a,Ez:()=>d,mn:()=>p});var n=e(65307),s=e(2543),l=e.n(s),r=e(12470),i=e(87421),g=e(83370),o=e(80484);const d={...o.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:r.CO.onTimeRangeChanged,current:{}},c=(0,n.Z0)({name:"templating/interval",initialState:g.j,reducers:{createIntervalOptions:(u,m)=>{const v=(0,i.Fs)(u,m.payload.id);if(v.type!=="interval")return;const x=(0,s.map)(v.query.match(/(["'])(.*?)\1|\w+/g),f=>(f=f.replace(/["']+/g,""),{text:f.trim(),value:f.trim(),selected:!1}));v.auto&&x.length&&x[0].text!=="auto"&&x.unshift({text:"auto",value:"$__auto_interval_"+v.name,selected:!1}),v.options=x}}}),a=c.reducer,{createIntervalOptions:p}=c.actions},24300:(k,A,e)=>{"use strict";e.d(A,{jR:()=>R,Fu:()=>b,$z:()=>d,O$:()=>D,ho:()=>T,MO:()=>y,an:()=>P,U9:()=>h,fx:()=>M,qh:()=>I,S8:()=>C});var n=e(53076),s=e(65307),l=e(2543),r=e(92053);const i=(S,...L)=>L.reduce((O,j)=>j(O),S);var g=e(13344),o=e(24240);const d={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},c=1e3,a=new n.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),p=S=>Array.isArray(S)?S.reduce((L,O)=>((0,l.isString)(O.value)&&(L[O.value]=O),L),{}):{},u=S=>{if(!Array.isArray(S.options))return S.options=[],S;const L=p(S.selectedValues);return S.selectedValues=Object.values(L),S.options=S.options.map(O=>{if(!(0,l.isString)(O.value))return O;const j=!!L[O.value];return O.selected===j?O:{...O,selected:j}}),S.options=m(S.options),S},m=S=>Array.isArray(S)?S.length<=c?S:S.slice(0,c):[],v=S=>{const{options:L,selectedValues:O}=S;return L.length===0||O.length>0||!L[0]||L[0].value!==g.To||(S.selectedValues=[{...L[0],selected:!0}]),S},x=S=>{const{selectedValues:L}=S;return L.length>1&&(S.selectedValues=L.filter(O=>O.value!==g.To)),S},f=S=>S.filter(L=>L.value!==g.To).map(L=>({...L,selected:!0})),E=(0,s.Z0)({name:"templating/optionsPicker",initialState:d,reducers:{showOptions:(S,L)=>{const{query:O,options:j}=L.payload;if(S.highlightIndex=-1,S.options=(0,l.cloneDeep)(j),S.id=L.payload.id,S.queryValue="",S.multi=!1,(0,o.iv)(L.payload)&&(S.multi=L.payload.multi??!1),(0,o.P4)(L.payload)){const{queryValue:N}=L.payload,F=(0,r.E)(O);S.queryValue=F&&N?N:""}return S.selectedValues=S.options.filter(N=>N.selected),i(S,v,u)},hideOptions:(S,L)=>({...d}),toggleOption:(S,L)=>{const{option:O,clearOthers:j,forceSelect:N}=L.payload,{multi:F,selectedValues:U}=S;if(O){const w=!U.find(B=>B.value===O.value&&B.text===O.text);if(O.value===g.To||!F||j)return w||N?S.selectedValues=[{...O,selected:!0}]:S.selectedValues=[],i(S,v,x,u);if(N||w)return S.selectedValues.push({...O,selected:!0}),i(S,v,x,u);S.selectedValues=U.filter(B=>B.value!==O.value&&B.text!==O.text)}else S.selectedValues=[];return i(S,v,x,u)},moveOptionsHighlight:(S,L)=>{let O=S.highlightIndex+L.payload;return O<0?O=-1:O>=S.options.length&&(O=S.options.length-1),{...S,highlightIndex:O}},toggleAllOptions:(S,L)=>{const O=S.selectedValues.find(N=>N.value===g.To),j=S.options.find(N=>N.value===g.To);return S.selectedValues.length>0&&j&&!O?(S.selectedValues=[],S.selectedValues.push({text:j.text??"All",value:j.value,selected:!0}),i(S,u)):O&&S.selectedValues.length===1?(S.selectedValues=f(S.options),i(S,u)):S.selectedValues.length>0&&!j?(S.selectedValues=[],i(S,u)):(S.selectedValues=f(S.options),i(S,u))},updateSearchQuery:(S,L)=>(S.queryValue=L.payload,S),updateOptionsAndFilter:(S,L)=>{const O=S.queryValue.trim();let j=[];if(O==="")j=L.payload;else{const N=L.payload.map(({text:B})=>Array.isArray(B)?B.toString():B),[F,U,w]=a.search(N,O,5);F?.length&&(U&&w?j=w.map(B=>L.payload[U.idx[B]]):j=F.map(B=>L.payload[B]),j.sort((B,K)=>(B.value===g.To?-1:0)-(K.value===g.To?-1:0)))}if(S.highlightIndex=0,O!==""){let N=j.findIndex(F=>F.value!==g.To);(N===-1||j[N].value!==O)&&(j.unshift({selected:!1,text:"> "+O,value:O}),S.highlightIndex=N===-1?0:N+1)}return S.options=j,i(S,v,u)},updateOptionsFromSearch:(S,L)=>(S.options=L.payload,S.highlightIndex=0,i(S,v,u)),cleanPickerState:()=>d}}),{toggleOption:h,showOptions:y,hideOptions:b,moveOptionsHighlight:D,toggleAllOptions:P,updateSearchQuery:C,updateOptionsAndFilter:M,updateOptionsFromSearch:I,cleanPickerState:R}=E.actions,T=E.reducer},86886:(k,A,e)=>{"use strict";e.d(A,{C:()=>n});const n=(r,i)=>r&&(i&&!Array.isArray(r.value)?{...r,value:l(r.value),text:l(r.text)}:!i&&Array.isArray(r.value)?{...r,value:s(r.value),text:s(r.text)}:r),s=r=>Array.isArray(r)?r.length>0?r[0]:"":r,l=r=>Array.isArray(r)?r:[r]},72401:(k,A,e)=>{"use strict";e.d(A,{Y7:()=>_e,TI:()=>H,_m:()=>Ke,_q:()=>Ce,RK:()=>Ue,t9:()=>de,x7:()=>oe,Hn:()=>we,mZ:()=>Fe,kl:()=>ee,us:()=>re});var n=e(2543),s=e(12470),l=e(92041),r=e(39070),i=e(22391),g=e(39601),o=e(32264),d=e(82467),c=e(16233),a=e(74856),p=e(99140),u=e(3169),m=e(10096),v=e(27677),x=e(34525),f=e(31193),E=e(23989),h=e(20601),y=e(13344),b=e(3843),D=e(24240),P=e(12846),C=e(24300),M=e(86886),I=e(80484),R=e(75096),T=e(73134),S=e(28601),L=e(48594),O=e(84014);const j=(ze,pe=-1,Se=!1,fe=!1)=>{const Ee={};if(fe){const Pe={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},he={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},be={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};Ee[Pe.id]=Pe,Ee[he.id]=he,Ee[be.id]=be}for(let Pe=0;Pe<ze;Pe++)Ee[Pe]=createQueryVariable({id:Pe.toString(),name:`Name-${Pe}`,label:`Label-${Pe}`,index:Pe});return Se&&(Ee[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:ze})),Ee},N=(ze,pe={})=>{const Se={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...ze.initialState,...Se},...pe}}}},F=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),U=()=>combineReducers({templating:keyedVariablesReducer});function w(ze,pe){return{templating:{lastKey:ze,keys:{[ze]:{...getInitialTemplatingState(),...pe}}}}}function B(ze,pe){return ze.find(fe=>fe.name===pe)}function K(ze){return(ze.type==="query"||ze.type==="datasource"||ze.type==="interval")&&ze.refresh===T.CO.onTimeRangeChanged}var W=e(87421),z=e(56968),Y=e(85675),X=e(15120);const q=(ze,pe)=>(Se,fe)=>{let Ee=0;const Pe=pe.templating.list;for(let be=0;be<Pe.length;be++){const Ae=G(Pe[be]);Ae.rootStateKey=ze,h.B.getIfExists(Ae.type)&&Se((0,L.kb)(ze,(0,z.QV)((0,R.qD)(Ae,{global:!1,index:Ee++,model:Ae}))))}(0,E.w)().updateTimeRange((0,a.jG)().timeRange());const he=(0,W.SS)(ze,fe());for(const be of he)Se((0,L.kb)(ze,(0,z.wB)((0,R.qD)(be))))};function G(ze){if(!(0,D.SP)(ze))return ze;let pe=!1;for(const Se of ze.options)if(Se.selected=!1,Array.isArray(ze.current.value))for(const fe of ze.current.value)Se.value===fe&&(Se.selected=pe=!0);else Se.value===ze.current.value&&(Se.selected=pe=!0);return!pe&&ze.options.length&&(ze.options[0].selected=!0),ze}const te=(ze,pe)=>Se=>{const fe={...I.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:s.zL.hideVariable,current:{value:{name:pe.title,uid:pe.uid,toString:()=>pe.title}}};Se((0,L.kb)(ze,(0,z.QV)((0,R.qD)(fe,{global:fe.global,index:fe.index,model:fe}))));const Ee={...I.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:s.zL.hideVariable,current:{value:{name:c.TP.user.orgName,id:c.TP.user.orgId,toString:()=>c.TP.user.orgId.toString()}}};Se((0,L.kb)(ze,(0,z.QV)((0,R.qD)(Ee,{global:Ee.global,index:Ee.index,model:Ee}))));const Pe={...I.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:s.zL.hideVariable,current:{value:{login:c.TP.user.login,id:c.TP.user.id,email:c.TP.user.email,toString:()=>c.TP.user.id.toString()}}};Se((0,L.kb)(ze,(0,z.QV)((0,R.qD)(Pe,{global:Pe.global,index:Pe.index,model:Pe}))))},H=(ze,pe)=>(Se,fe)=>{const{rootStateKey:Ee}=ze,Pe=(0,W.dn)(ze,fe());if(!(0,D.iv)(Pe)||(0,l.R)(Pe.current))return;const he=(0,M.C)(Pe.current,pe);Se((0,L.kb)(Ee,(0,z.QP)((0,R.qD)(ze,{propName:"multi",propValue:pe})))),Se((0,L.kb)(Ee,(0,z.QP)((0,R.qD)(ze,{propName:"current",propValue:he}))))},se=async(ze,pe)=>{if(!ze.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ze.id}`);if(ne(ze,pe))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const Se=le(ze,pe);_(ze.rootStateKey,Se,pe)&&await new Promise(fe=>{const Ee=p.M_.subscribe(()=>{if(!ze.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ze.id}`);_(ze.rootStateKey,Se,p.M_.getState())||(Ee(),fe())})})},ne=(ze,pe,Se=new Set)=>Se.has(ze.id)?!0:(Se=new Set([...Se,ze.id]),le(ze,pe).some(fe=>ne(fe,pe,Se))),le=(ze,pe)=>{if(!ze.rootStateKey)return[];const Se=[];for(const fe of(0,W.SS)(ze.rootStateKey,pe))ze!==fe&&h.B.getIfExists(ze.type)&&h.B.get(ze.type).dependsOn(ze,fe)&&Se.push(fe);return Se},_=(ze,pe,Se)=>{if(pe.length===0)return!1;const fe=(0,W.SS)(ze,Se);return pe.filter(Pe=>fe.some(he=>he.id===Pe.id&&(he.state===r.Gu.NotStarted||he.state===r.Gu.Loading))).length>0},Q=(ze,pe)=>async(Se,fe)=>{const Ee=(0,W.dn)(ze,fe());await se(Ee,fe());const Pe=pe[y.qz+Ee.name];if(Pe!==void 0){const he=(0,R.QT)(Pe);await h.B.get(Ee.type).setValueFromUrl(Ee,he);return}if(Ee.hasOwnProperty("refresh")){const he=Ee;if(he.refresh===s.CO.onDashboardLoad||he.refresh===s.CO.onTimeRangeChanged){await Se(Fe((0,R.jX)(he)));return}}if(Ee.type==="custom"){await Se(Fe((0,R.jX)(Ee)));return}Se(Ct(ze))},ae=ze=>async(pe,Se)=>{const fe=g.Ny.getSearchObject(),Ee=(0,W.SS)(ze,Se()).map(async Pe=>await pe(Q((0,R.jX)(Pe),fe)));await Promise.all(Ee)},oe=(ze,pe)=>async(Se,fe)=>{const Ee=(0,R.QT)(pe),Pe=(0,W.dn)(ze,fe());(0,R.q$)(Pe)!==s.CO.never&&await Se(Fe((0,R.jX)(Pe)));const he=(0,W.dn)((0,R.jX)(Pe),fe());if(!(0,D.SP)(he))return;if(!he)throw new Error(`Couldn't find variable with name: ${Pe.name}`);let be=he.options.find(Ae=>Ae.text===Ee||Ae.value===Ee);if(!be&&(0,D.iv)(he)&&he.allValue&&Ee===he.allValue&&(be={text:y.Zm,value:y.To,selected:!1}),!be){let Ae=Ee;const De=Ee;Array.isArray(Ee)&&(Ae=Ee.reduce((Ie,ke)=>{const dt=he.options.find(Pt=>Pt.value===ke);return dt?[].concat(Ie,[dt.text]):[].concat(Ie,[ke])},[])),be={text:Ae,value:De,selected:!1}}(0,D.iv)(he)&&(be=(0,M.C)({text:(0,n.castArray)(be.text),value:(0,n.castArray)(be.value),selected:!1},he.multi)),await h.B.get(Pe.type).setValue(he,be)},J=ze=>{let pe,Se,fe,Ee;const Pe=[];for(pe=0;pe<ze.options.length;pe++)if(Ee={...ze.options[pe]},Ee.selected=!1,Array.isArray(ze.current.value))for(Se=0;Se<ze.current.value.length;Se++)fe=ze.current.value[Se],Ee.value===fe&&(Ee.selected=!0,Pe.push(Ee));else Ee.value===ze.current.value&&(Ee.selected=!0,Pe.push(Ee));return Pe},ee=(ze,pe)=>(Se,fe)=>{const Ee=(0,W.dn)(ze,fe());if(!(0,D.SP)(Ee))return Promise.resolve();const Pe=Ee.current||{},he=h.B.get(Ee.type).setValue;if(Array.isArray(Pe.value)){const Ie=J(Ee);if(Ie.length===0){const dt=Ee.options[0];return he(Ee,{value:typeof dt.value=="string"?[dt.value]:dt.value,text:typeof dt.text=="string"?[dt.text]:dt.text,selected:!0})}const ke={value:Ie.map(dt=>dt.value),text:Ie.map(dt=>dt.text),selected:!0};return he(Ee,ke)}let be=null;const Ae=(0,R.Nz)(Ee),De=(0,R.Lz)(Ee);if(be=Ee.options?.find(Ie=>Ie.text===Ae||Ie.value===De),be||pe&&(be=Ee.options?.find(Ie=>Ie.text===pe||Ie.value===pe),be))return he(Ee,be);if(Ee.options){const Ie=Ee.options[0];if(Ie)return he(Ee,Ie)}return Promise.resolve()},de=(ze,pe,Se)=>async fe=>{const{rootStateKey:Ee}=ze;return fe((0,L.kb)(Ee,(0,z.dE)((0,R.qD)(ze,{option:pe})))),await fe(re(ze,Se))},xe=ze=>{const pe=new x.TS;return ze.forEach(Se=>{pe.createNode(Se.name)}),ze.forEach(Se=>{ze.forEach(fe=>{Se!==fe&&h.B.get(Se.type).dependsOn(Se,fe)&&pe.link(Se.name,fe.name)})}),pe},re=(ze,pe,Se=m.lE)=>async(fe,Ee)=>{const Pe=Ee(),{rootStateKey:he}=ze,be=(0,W.dn)(ze,Pe);if((0,W.nx)(he,Pe).transaction.status===I.x8.Fetching)return(0,R.q$)(be)===s.CO.never&&(await fe(Dt((0,R.jX)(be))),fe(Ct(ze))),Promise.resolve();const Ae=(0,W.SS)(he,Pe),De=xe(Ae),Ie=Pe.dashboard?.getModel()?.panels??[],ke=(0,P.P5)(Ie),dt=be.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,P.xU)([be.id],De,ke)),variable:(0,W.dn)(ze,Pe)},Pt=De.getNode(be.name);let pt=[];return Pt&&(pt=Pt.getOptimizedInputEdges().map(Tt=>{const jt=Ae.find($t=>$t.name===Tt.inputNode?.name);return jt?fe(Fe((0,R.jX)(jt))):Promise.resolve()})),Promise.all(pt).then(()=>{pe&&(Se.publish(new I.og(dt)),g.Ny.partial(We(he,Ee)))})},ue=(ze,pe,Se,fe)=>(pe.includes(ze.name)||pe.push(ze.name),ze.outputEdges.forEach(Ee=>{const Pe=Ee.outputNode;if(Pe&&!pe.includes(Pe.name)){const he=Se.find(be=>be.name===Pe.name);he&&he.refresh===s.CO.onTimeRangeChanged&&fe.indexOf(he)===-1?(fe.push(he),pe.push(Pe.name)):ue(Pe,pe,Se,fe)}}),fe),Te=(ze,pe)=>ze.outputEdges.every(Se=>{const fe=Se.outputNode;if(fe){const Ee=B(pe,fe.name);if(Ee&&Ee.type==="query")return Ee.refresh!==s.CO.onTimeRangeChanged}return!0}),ge=(ze,pe)=>{const Se=(0,W.SS)(ze,pe),fe=xe(Se),Ee=[],Pe=[];return Se.forEach(he=>{const be=fe.getNode(he.name);if(!Ee.includes(he.name)&&be){const Ae=B(Se,be.name);if(!Ae)return;const De=K(Ae);De&&be.outputEdges.length===0&&Pe.push(Ae),De&&Pe.includes(Ae)&&be.outputEdges.length>0&&(Pe.push(Ae),ue(be,Ee,Se,Pe)),De&&be.outputEdges.length>0&&Te(be,Se)&&(Pe.includes(Ae)||Pe.push(Ae)),!De&&be.outputEdges.length>0&&ue(be,Ee,Se,Pe)}}),Pe},Oe=(ze,pe)=>(0,W.SS)(ze,pe).filter(Ee=>"refresh"in Ee&&"options"in Ee?Ee.refresh===s.CO.onTimeRangeChanged:!1),Ue=(ze,pe,Se={templateSrv:(0,E.w)(),events:m.lE})=>async(fe,Ee)=>{Se.templateSrv.updateTimeRange(pe);let Pe=[];o.$.featureToggles.refactorVariablesTimeRange?Pe=ge(ze,Ee()):Pe=Oe(ze,Ee());const he=Pe.map(Ae=>Ae.id),be=Pe.map(Ae=>fe(Xe((0,R.jX)(Ae))));try{await Promise.all(be),Se.events.publish(new I.BS({variableIds:he}))}catch(Ae){console.error(Ae),fe((0,d.dx)(at("Template variable service failed",Ae)))}},Xe=ze=>async(pe,Se)=>{const fe=(0,W.dn)(ze,Se());if(!(0,D.SP)(fe))return;const Ee=fe.options.slice();await pe(Fe((0,R.jX)(fe),!0));const Pe=(0,W.dn)(ze,Se());if(!(0,D.SP)(Pe))return;const he=Pe.options;JSON.stringify(Ee)!==JSON.stringify(he)&&Se().dashboard.getModel()?.templateVariableValueUpdated()},we=(ze,pe,Se=m.lE)=>async(fe,Ee)=>{const Pe=[],he=Ee().dashboard.getModel(),be=(0,W.SS)(ze,Ee());for(const dt of be){const Pt=y.qz+dt.name;if(!pe.hasOwnProperty(Pt)||!qe(dt,pe[Pt].value))continue;let pt=pe[Pt].value;if(pe[Pt].removed){const jt=he?.templating.list.find($t=>$t.name===dt.name);jt&&(0,D.m8)(jt)&&(pt=jt.current.value),jt&&jt.type==="constant"&&(pt=jt.query)}const Tt=h.B.get(dt.type).setValueFromUrl(dt,pt);Pe.push(Tt)}const Ae=be.filter(dt=>{const Pt=y.qz+dt.name;return pe.hasOwnProperty(Pt)&&qe(dt,pe[Pt].value)&&dt.type!=="adhoc"}),De=xe(be),Ie=(0,P.P5)(he?.panels??[]),ke=(0,P.xU)(Ae.map(dt=>dt.id),De,Ie);Pe.length&&(await Promise.all(Pe),Se.publish(new I.eF({refreshAll:ke.size===0,panelIds:Array.from(ke)})))};function qe(ze,pe){const Se=h.B.get(ze.type).getValueForUrl(ze);let fe=(0,R.QT)(pe);return Array.isArray(Se)&&!Array.isArray(fe)&&(fe=[fe]),!(0,n.isEqual)(Se,fe)}const We=(ze,pe)=>{const Se=g.Ny.getSearchObject(),fe=Object.keys(Se).filter(Ee=>Ee.indexOf(y.qz)===-1).reduce((Ee,Pe)=>(Ee[Pe]=Se[Pe],Ee),{});for(const Ee of(0,W.SS)(ze,pe())){if(Ee.skipUrlSync)continue;const Pe=h.B.get(Ee.type);fe[y.qz+Ee.name]=Pe.getValueForUrl(Ee)}return fe},Ce=(ze,pe)=>async(Se,fe)=>{try{const Ee=(0,R.q4)(ze),Pe=fe(),he=(0,W.Tk)(Pe);he&&(0,W.nx)(he,Pe).transaction.status===I.x8.Fetching&&Se(_e(he)),Se((0,L.kb)(Ee,(0,Y.kH)({uid:Ee}))),Se(te(Ee,pe)),Se(q(Ee,pe)),Se(je(Ee)),await Se(ae(Ee)),Se((0,L.kb)(Ee,(0,Y.$O)({uid:Ee})))}catch(Ee){Se((0,d.dx)(at("Templating init failed",Ee))),console.error(Ee)}};function je(ze,pe=f.tR){return(Se,fe)=>{const Ee=(0,W.SS)(ze,fe());for(const Pe of Ee){if(Pe.type!=="adhoc"&&Pe.type!=="query")continue;const{datasource:he}=Pe;if((0,i.fN)(he))continue;const be=pe().getInstanceSettings(he),Ae=be?(0,i.p$)(be):{uid:he};Se((0,L.kb)(ze,(0,z.QP)((0,R.qD)(Pe,{propName:"datasource",propValue:Ae}))))}}}const Ke=ze=>pe=>{pe((0,L.kb)(ze,(0,X.v)())),pe((0,L.kb)(ze,(0,b.y8)())),pe((0,L.kb)(ze,(0,C.jR)())),pe((0,L.kb)(ze,(0,Y.pu)()))},_e=(ze,pe={getBackendSrv:v.AI})=>Se=>{pe.getBackendSrv().cancelAllInFlightRequests(),Se(Ke(ze))},Fe=(ze,pe=!1)=>async(Se,fe)=>{const{rootStateKey:Ee}=ze;try{if(!(0,R.sN)(Ee,fe()))return;const Pe=(0,W.dn)(ze,fe());Se((0,L.kb)(Ee,(0,z.a7)((0,R.qD)(Pe)))),await Se(Dt((0,R.jX)(Pe))),await h.B.get(Pe.type).updateOptions(Pe),Se(Ct(ze))}catch(Pe){if(Se((0,L.kb)(Ee,(0,z.Te)((0,R.qD)(ze,{error:Pe})))),pe||(console.error(Pe),Se((0,d.dx)(at("Error updating options:",Pe,ze)))),pe)throw Pe}},at=(ze,pe,Se)=>(0,u.gi)(`${Se?`Templating [${Se.id}]`:"Templating"}`,pe instanceof Error?`${ze} ${pe.message}`:`${ze}`),Ct=ze=>(pe,Se)=>{const{rootStateKey:fe}=ze;if(!(0,R.sN)(fe,Se()))return;const Ee=(0,W.dn)(ze,Se());Ee.state!==r.Gu.Done&&pe((0,L.kb)(ze.rootStateKey,(0,z.Pu)((0,R.qD)(Ee))))};function Dt(ze,pe=f.tR){return async function(Se,fe){const{id:Ee,rootStateKey:Pe}=ze;if(!(0,R.sN)(Pe,fe()))return;const he=(0,W.dn)(ze,fe());if(he.type==="query")try{const be=await pe().get(he.datasource??"");if((0,D.d5)(be)||!(0,D.Hf)(be)||tt(he.query))return;const Ae={refId:`${be.name}-${Ee}-Variable-Query`,query:he.query};Se((0,L.kb)(Pe,(0,z.QP)((0,R.qD)(ze,{propName:"query",propValue:Ae}))))}catch(be){Se((0,d.dx)(at("Failed to upgrade legacy queries",be))),console.error(be)}}}function tt(ze){return(0,r.Gv)(ze)&&"refId"in ze&&typeof ze.refId=="string"}},48594:(k,A,e)=>{"use strict";e.d(A,{Ay:()=>c,L1:()=>r,kb:()=>g});var n=e(75096),s=e(84014),l=e(85675);const r={keys:{}},i=a=>({type:`templating/keyed/${a.action.type.replace(/^templating\//,"")}`,payload:a});function g(a,p){const u=(0,n.q4)(a);return i({key:u,action:p})}const o=a=>typeof a.type=="string"&&a.type.startsWith("templating/keyed")&&"payload"in a&&typeof a.payload.key=="string";function d(a=r,p){if(o(p)){const{key:u,action:m}=p.payload,v=(0,n.q4)(u),x=l.kH.match(m)?v:a.lastKey,f=(0,s.H)(),E=a.keys[v],h=f(E,m);return{...a,lastKey:x,keys:{...a.keys,[v]:h}}}return a}const c={templating:d}},84014:(k,A,e)=>{"use strict";e.d(A,{H:()=>c,x:()=>a});var n=e(14644),s=e(3843),l=e(27238),r=e(24300),i=e(85675),g=e(83370),o=e(15120);let d;function c(){return d||(d=(0,n.combineReducers)({editor:s.wf,variables:o.Y,optionsPicker:r.ho,transaction:i.Dd,inspect:l.t4})),d}function a(){return{editor:s.nS,variables:g.j,optionsPicker:r.$z,transaction:i.i3,inspect:l.WT}}},87421:(k,A,e)=>{"use strict";e.d(A,{Fs:()=>b,SS:()=>d,Tk:()=>x,UN:()=>h,_2:()=>y,bZ:()=>E,dn:()=>i,hk:()=>u,nS:()=>p,nx:()=>o,pi:()=>a,wk:()=>m,y7:()=>f});var n=e(41811),s=e(99140),l=e(75096),r=e(84014);function i(D,P=(0,s.Gu)(),C=!0){const{id:M,rootStateKey:I}=D,T=o(I,P).variables[M];if(!T){if(C)throw new Error(`Couldn't find variable with id:${M}`);return}return T}function g(D,P,C=(0,s.Gu)()){return Object.values(o(P,C).variables).filter(D).sort((M,I)=>M.index-I.index)}function o(D,P=(0,s.Gu)()){return P.templating.keys[(0,l.q4)(D)]??(0,r.x)()}function d(D,P=(0,s.Gu)()){return g(c,D,P)}function c(D){return D.type!=="system"}const a=(0,n.A)((D,P)=>d(D,(0,s.Gu)())),p=(D,P)=>d(D,P);function u(D,P=(0,s.Gu)()){return m(Object.values(o(D,P).variables))}function m(D){const P=D.filter(c).sort((C,M)=>C.index-M.index);return P.length>0?P[P.length-1].index+1:0}function v(D,P=getState()){return o(D,P).transaction.isDirty}function x(D=(0,s.Gu)()){return D.templating?.lastKey}function f(D=(0,s.Gu)()){if(!D.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return D.templating.lastKey}function E(D,P=(0,s.Gu)()){const C=x(P);return C?g(D,C,P):[]}function h(D=(0,s.Gu)()){const P=x(D);return P?d(P,D):[]}function y(D,P=(0,s.Gu)()){const C=x(P);if(C)return i({id:D,rootStateKey:C,type:"query"},P,!1)}function b(D,P){return D[P]}},56968:(k,A,e)=>{"use strict";e.d(A,{Hr:()=>m,Pu:()=>P,QP:()=>x,QV:()=>v,Te:()=>C,a7:()=>D,dE:()=>h,hj:()=>f,l_:()=>y,qi:()=>u,ut:()=>E,wB:()=>b});var n=e(65307),s=e(2543),l=e.n(s),r=e(39070),i=e(20601),g=e(3843),o=e(24240),d=e(75096),c=e(87421),a=e(83370);const p=(0,n.Z0)({name:"templating/shared",initialState:a.j,reducers:{addVariable:(M,I)=>{const R=I.payload.id??I.payload.data.model.name,T=i.B.get(I.payload.type),S=(0,s.cloneDeep)(T.initialState),L=T.beforeAdding?T.beforeAdding(I.payload.data.model):(0,s.cloneDeep)(I.payload.data.model),O={...(0,s.defaults)({},L,S),id:R,index:I.payload.data.index,global:I.payload.data.global};M[R]=O},variableStateNotStarted:(M,I)=>{const R=(0,c.Fs)(M,I.payload.id);R.state=r.Gu.NotStarted,R.error=null},variableStateFetching:(M,I)=>{const R=(0,c.Fs)(M,I.payload.id);R.state=r.Gu.Loading,R.error=null},variableStateCompleted:(M,I)=>{const R=(0,c.Fs)(M,I.payload.id);R&&(R.state=r.Gu.Done,R.error=null)},variableStateFailed:(M,I)=>{const R=(0,c.Fs)(M,I.payload.id);R&&(R.state=r.Gu.Error,R.error=I.payload.data.error)},removeVariable:(M,I)=>{if(delete M[I.payload.id],!I.payload.data.reIndex)return;const R=Object.values(M).sort((T,S)=>T.index-S.index);for(let T=0;T<R.length;T++)R[T].index=T},duplicateVariable:(M,I)=>{function R(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const T=(0,s.cloneDeep)(M[I.payload.id]),S=new RegExp(`^copy_of_${R(T.name)}(_(\\d+))?$`),L=Object.values(M).map(({name:w})=>w.match(S)).filter(w=>w!=null),O=L.map(w=>w[2]).filter(w=>w!=null),j=L.length===0?null:O.length===0?1:O.map(w=>+w).sort((w,B)=>B-w)[0]+1,N=`copy_of_${T.name}${j?`_${j}`:""}`,F=I.payload.data?.newId??N,U=(0,c.wk)(Object.values(M));M[F]={...(0,s.cloneDeep)(i.B.get(I.payload.type).initialState),...T,id:F,name:N,index:U}},changeVariableOrder:(M,I)=>{const{toIndex:R,fromIndex:T}=I.payload.data,S=Object.values(M);for(let L=0;L<S.length;L++){const O=S[L];O.index===T?O.index=R:O.index>T&&O.index<=R?O.index--:O.index<T&&O.index>=R&&O.index++}},changeVariableType:(M,I)=>{const{id:R}=I.payload,{label:T,name:S,index:L,description:O,rootStateKey:j}=M[R];M[R]={...(0,s.cloneDeep)(i.B.get(I.payload.data.newType).initialState),id:R,rootStateKey:j,label:T,name:S,index:L,description:O}},setCurrentVariableValue:(M,I)=>{if(!I.payload.data.option)return;const R=(0,c.Fs)(M,I.payload.id);if(!(0,o.SP)(R))return;const{option:T}=I.payload.data,S={...T,text:(0,d.QT)(T?.text),value:(0,d.QT)(T?.value)};R.current=S,R.options=R.options.map(L=>{L.value=(0,d.QT)(L.value),L.text=(0,d.QT)(L.text);let O=!1;if(Array.isArray(S.value))for(let j=0;j<S.value.length;j++){const N=S.value[j];if(L.value===N){O=!0;break}}else L.value===S.value&&(O=!0);return L.selected=O,L})},changeVariableProp:(M,I)=>{const R=(0,c.Fs)(M,I.payload.id);R[I.payload.data.propName]=I.payload.data.propValue}},extraReducers:M=>M.addCase(g.FN,(I,R)=>{const T=(0,c.Fs)(I,R.payload.id);T.name=R.payload.data.newName})}),u=p.reducer,{removeVariable:m,addVariable:v,changeVariableProp:x,changeVariableOrder:f,duplicateVariable:E,setCurrentVariableValue:h,changeVariableType:y,variableStateNotStarted:b,variableStateFetching:D,variableStateCompleted:P,variableStateFailed:C}=p.actions},85675:(k,A,e)=>{"use strict";e.d(A,{$O:()=>c,Dd:()=>a,i3:()=>r,kH:()=>o,pu:()=>d});var n=e(65307),s=e(80484),l=e(56968);const r={uid:null,status:s.x8.NotStarted,isDirty:!1},i=(0,n.Z0)({name:"templating/transaction",initialState:r,reducers:{variablesInitTransaction:(p,u)=>{p.uid=u.payload.uid,p.status=s.x8.Fetching},variablesCompleteTransaction:(p,u)=>{p.uid===u.payload.uid&&(p.status=s.x8.Completed)},variablesClearTransaction:(p,u)=>{p.uid=null,p.status=s.x8.NotStarted,p.isDirty=!1}},extraReducers:p=>p.addMatcher(g,(u,m)=>{u.status===s.x8.Completed&&(u.isDirty=!0)})});function g(p){return l.Hr.match(p)||l.QV.match(p)||l.QP.match(p)||l.hj.match(p)||l.ut.match(p)||l.l_.match(p)}const{variablesInitTransaction:o,variablesClearTransaction:d,variablesCompleteTransaction:c}=i.actions,a=i.reducer},83370:(k,A,e)=>{"use strict";e.d(A,{j:()=>n});const n={}},15120:(k,A,e)=>{"use strict";e.d(A,{Y:()=>g,v:()=>i});var n=e(65307),s=e(20601),l=e(56968),r=e(83370);const i=(0,n.VP)("templating/cleanVariables"),g=(o=r.j,d)=>{if(i.match(d)){const c=Object.values(o).filter(p=>p.global);return c?c.reduce((p,u)=>(p[u.id]=u,p),{}):r.j}return d?.payload?.type&&s.B.getIfExists(d?.payload?.type)?s.B.get(d.payload.type).reducer((0,l.qi)(o,d),d):o}},80484:(k,A,e)=>{"use strict";e.d(A,{BS:()=>d,Vg:()=>g,eF:()=>c,og:()=>o,x8:()=>i});var n=e(12470),s=e(39070),l=e(65463),r=e(13344),i=(a=>(a.NotStarted="Not started",a.Fetching="Fetching",a.Completed="Completed",a))(i||{});const g={id:r.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:n.zL.dontHide,skipUrlSync:!1,state:s.Gu.NotStarted,error:null,description:null};class o extends l.x{static{this.type="variables-changed"}}class d extends l.x{static{this.type="variables-time-range-process-done"}}class c extends l.x{static{this.type="variables-changed-in-url"}}},75096:(k,A,e)=>{"use strict";e.d(A,{AX:()=>D,Lz:()=>E,ML:()=>x,Nz:()=>f,QT:()=>M,SY:()=>u,Wz:()=>C,iP:()=>y,jX:()=>T,pY:()=>L,q$:()=>b,q4:()=>R,qD:()=>S,sN:()=>I,t4:()=>m,u7:()=>h,wJ:()=>v});var n=e(2543),s=e.n(n),l=e(12470),r=e(72574),i=e(39601),g=e(87490),o=e(99140),d=e(20601),c=e(13344),a=e(87421),p=e(80484);const u=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,m=O=>(u.lastIndex=0,u.exec(O));function v(...O){const j=O[O.length-1];O[0]=typeof O[0]=="string"?O[0]:(0,g.MA)(O[0]);const F=O.slice(0,-1).join(" ").match(u);return!!(F!==null?F.find(w=>{const B=m(w);return B!==null&&B.indexOf(j)>-1}):!1)}const x=O=>{if(!O||!O.current)return!1;if(O.current.value){const j=Array.isArray(O.current.value);if(j&&O.current.value.length&&O.current.value[0]===c.To||!j&&O.current.value===c.To)return!0}if(O.current.text){const j=Array.isArray(O.current.text);if(j&&O.current.text.length&&O.current.text[0]===c.Zm||!j&&O.current.text===c.Zm)return!0}return!1},f=O=>!O||!O.current||!O.current.text?"":Array.isArray(O.current.text)?O.current.text.toString():typeof O.current.text!="string"?"":O.current.text,E=O=>!O||!O.current||O.current.value===void 0||O.current.value===null?null:Array.isArray(O.current.value)?O.current.value.toString():typeof O.current.value!="string"?null:O.current.value;function h(O,j=(0,r.w)()){return!O||!O.regex?"":j.replace(O.regex,{},"regex")}function y(O,j,N,F){const U={range:void 0,variable:O,searchFilter:j,scopedVars:F};return(O.refresh===l.CO.onTimeRangeChanged||O.refresh===l.CO.onDashboardLoad)&&(U.range=N.timeRange()),U}function b(O){return O?.type==="custom"?l.CO.onDashboardLoad:!O||!("refresh"in O)||O.refresh!==l.CO.onTimeRangeChanged&&O.refresh!==l.CO.onDashboardLoad?l.CO.never:O.refresh}function D(){return d.B.list().filter(O=>O.id!=="system").map(({id:O,name:j,description:N})=>({label:j,value:O,description:N}))}function P(O){return(0,n.isArray)(O)&&(O.length===0?O=void 0:O.length===1&&(O=O[0])),O}function C(O,j){let N=0;const F={};for(const U in O){if(!U.startsWith(c.qz))continue;let w=P(j[U]),B=P(O[U]);(0,n.isEqual)(B,w)||(F[U]={value:O[U]},N++)}for(const U in j){if(!U.startsWith(c.qz))continue;const w=j[U];(0,n.isArray)(w)&&w.length===0||O.hasOwnProperty(U)||(F[U]={value:"",removed:!0},N++)}return N?F:void 0}function M(O){return Array.isArray(O)?O.map(String):O==null?"":typeof O=="number"?O.toString(10):typeof O=="string"?O:typeof O=="boolean"?O.toString():""}function I(O,j=(0,o.Gu)()){return(0,a.nx)(O,j).transaction.status!==p.x8.NotStarted}function R(O){return String(O)}const T=O=>{if(!O.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${O.id}`);return{type:O.type,id:O.id,rootStateKey:O.rootStateKey}};function S(O,j){return{type:O.type,id:O.id,data:j}}function L(){const O=(0,r.w)().getVariables(),j=i.Ny.getSearchObject();return Object.keys(j).filter(N=>N.indexOf(c.qz)!==-1&&O.some(F=>F.name===N.replace(c.qz,""))).reduce((N,F)=>{const U=F.replace(c.qz,"");return N[U]=j[F],N},{})}},1819:(k,A,e)=>{"use strict";e.d(A,{e:()=>u});var n=e(74848),s=e(32196),l=e(28240),r=e(83195),i=e(14588),g=e(52622),o=e(40845),d=e(72109),c=e(61994),a=e(74007);function p(v,x,f,E,h){const y=v.fields,b=f!=null?y[f]:null,D=y.filter(T=>!T.config.custom?.hideFrom?.tooltip),P=D.find(T=>T.name==="traceID")||y[0],C=[];if(D.filter(T=>P===T).length>0&&C.push(P),C.push(...D.filter(T=>P!==T)),C.length===0)return null;const M=[],I=[],R=new Set;for(const T of C){if(h===g.$N.Single&&T!==b)continue;const S=T.values[x],L=T.display?T.display(S):{text:`${S}`,numeric:+S};T.getLinks&&T.getLinks({calculatedValue:L,valueRowIndex:x}).forEach(O=>{const j=`${O.title}/${O.href}`;R.has(j)||(I.push(O),R.add(j))}),M.push({name:(0,l.Ct)(T,v),value:S,valueString:(0,r.cN)(L),highlight:T===b})}return E&&E!==g.xB.None&&M.sort((T,S)=>i.sortValues(E)(T.value,S.value)),{displayValues:M,links:I}}const u=({data:v,rowIndex:x,columnIndex:f,sortOrder:E,mode:h,header:y,padding:b=0})=>{const D=(0,o.of)(m,b);if(!v||x==null)return null;const P=p(v,x,f,E,h);if(P==null)return null;const{displayValues:C,links:M}=P;return y==="Exemplar"?(0,n.jsx)(a.i,{displayValues:C,links:M,header:y}):(0,n.jsxs)("div",{className:D.wrapper,children:[y&&(0,n.jsx)("div",{className:D.header,children:(0,n.jsx)("span",{className:D.title,children:y})}),(0,n.jsx)("table",{className:D.infoWrap,children:(0,n.jsxs)("tbody",{children:[C.map((I,R)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:I.name}),(0,n.jsx)("td",{children:(0,c.A)(I.valueString)})]},`${R}/${x}`)),M.map((I,R)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Link"}),(0,n.jsx)("td",{colSpan:2,children:(0,n.jsx)(d.Y,{href:I.href,external:I.target==="_blank",weight:"medium",inline:!1,children:I.title})})]},R))]})})]})},m=(v,x=0)=>({wrapper:(0,s.css)({padding:`${x}px`,background:v.components.tooltip.background,borderRadius:v.shape.borderRadius(2)}),header:(0,s.css)({background:v.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:v.spacing(1)}),title:(0,s.css)({fontWeight:v.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,s.css)({padding:v.spacing(1),background:"transparent",border:"none",th:{fontWeight:v.typography.fontWeightMedium,padding:v.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${v.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,s.css)({color:v.colors.text.link})})},74007:(k,A,e)=>{"use strict";e.d(A,{i:()=>o});var n=e(74848),s=e(32196),l=e(40845),r=e(14689),i=e(13471),g=e(61994);const o=({displayValues:c,links:a,header:p="Exemplar"})=>{const u=(0,l.of)(d),m=c.find(v=>v.name==="Time");return c=c.filter(v=>v.name!=="Time"),(0,n.jsxs)("div",{className:u.exemplarWrapper,children:[(0,n.jsxs)("div",{className:u.exemplarHeader,children:[(0,n.jsx)("span",{className:u.title,children:p}),m&&(0,n.jsx)("span",{className:u.time,children:(0,g.A)(m.valueString)})]}),(0,n.jsx)("div",{className:u.exemplarContent,children:c.map((v,x)=>(0,n.jsx)(i.B,{label:v.name,value:(0,g.A)(v.valueString),justify:"space-between",isPinned:!1},x))}),a&&a.length>0&&(0,n.jsx)("div",{className:u.exemplarFooter,children:a.map((v,x)=>(0,n.jsx)(r.R,{link:v,buttonProps:{size:"md"}},x))})]})},d=(c,a=0)=>({exemplarWrapper:(0,s.css)({display:"flex",flexDirection:"column",flex:1,gap:4,whiteSpace:"pre",borderRadius:c.shape.radius.default,background:c.colors.background.primary,border:`1px solid ${c.colors.border.weak}`,boxShadow:`0 4px 8px ${c.colors.background.primary}`}),exemplarHeader:(0,s.css)({display:"flex",flexDirection:"column",alignItems:"flex-start",gap:c.spacing(.5),color:c.colors.text.secondary,padding:c.spacing(1)}),time:(0,s.css)({color:c.colors.text.primary}),exemplarContent:(0,s.css)({display:"flex",flexDirection:"column",flex:1,gap:4,borderTop:`1px solid ${c.colors.border.medium}`,padding:c.spacing(1)}),exemplarFooter:(0,s.css)({display:"flex",flexDirection:"column",padding:c.spacing(1),borderTop:`1px solid ${c.colors.border.medium}`,gap:4}),linkButton:(0,s.css)({width:"fit-content"}),label:(0,s.css)({color:c.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:c.spacing(.5)}),value:(0,s.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),title:(0,s.css)({fontWeight:c.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1})})},246:(k,A,e)=>{"use strict";var n=e(6262),s=e(9423),l=e(7452),r=e(78624),i=e(4213),g=e(34796),o=e(13609),d=e(31193),c=e(17493),a=e(14792),p=e(15858),u=e(16495),m=e(62639),v=e(2543),x=e.n(v),f=e(96540),E=e(5338),h=e(47232),y=e(1933),b=e(69550),D=e(97497),P=e(96915),C=e(71733),M=e(17172),I=e(23509),R=e(39601),T=e(96937),S=e(61706),L=e(3591),O=e(63639),j=e(89191),N=e(19347),F=e(4402),U=e(3197),w=e(79396),B=e(14778),K=e(23172),W=e(63415),z=e(97152),Y=e(24308),X=e(46235),q=e(2913),G=e(94041),te=e(32264),H=e(74848),se=e(11261),ne=e(85200),le=e(1173),_=e(28240),Q=e(18282),ae=e(57934),oe=e(73376),J=e(14186),ee=e(94354),de=e(90613),xe=e(55852),re=e(91847);function ue(ce){if(ce in re.uk){const{name:ie,getHelperDocs:ve,links:Re}=re.uk[ce],He=ve(re.g_.UIImage),st=Te(He);if(Re?.length){const ot=Re.map(yt=>`
  Or visit <a href="${yt.url}" target="_blank">${yt.title}</a>

  `).join("");return{name:ie,helperDocs:`
        ${st}
        ${(0,re.$n)()}
  ${ot}
        `}}return{name:ie,helperDocs:`
      ${st}
      ${(0,re.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,re.$n)()}}const Te=ce=>ce.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var ge=e(39268),Oe=e(90182),Ue=e(83077),Xe=e(91890),we=e(72574),qe=e(10354),We=e(88841),Ce=e(94397);function je(ce,ie){switch(ie.type){case se.PU.boolean:return(0,v.isUndefined)(ce)?!1:Ke(ce);case se.PU.number:return isNaN(ce)?0:parseFloat(ce);case se.PU.string:return ce?String(ce):"";default:return ce}}const Ke=ce=>(0,v.isString)(ce)?!(ce[0]==="F"||ce[0]==="f"||ce[0]==="0"):!!ce;function _e(ce){return function({options:ve,onChange:Re,field:He}){const{validator:st,converter:ot=je}=ce,{value:yt}=ve,[Et,Wt]=(0,f.useState)(!st(yt)),xn=(0,we.w)().getVariables().map(En=>({value:En.name,label:En.label||En.name,origin:Xe.$0.Template})),In=(0,f.useCallback)(En=>{Wt(!st(En.currentTarget.value))},[Wt,st]),Sn=(0,f.useCallback)(En=>{if(Et)return;const{value:Ss}=En.currentTarget;Re({...ve,value:ot(Ss,He)})},[ve,Re,Et,He,ot]),gn=(0,f.useCallback)(En=>{Wt(!st(En)),Re({...ve,value:En})},[Wt,st,Re,ve]);return te.$.featureToggles.transformationsVariableSupport?(0,H.jsx)(We.y,{invalid:Et,value:yt,error:"Value needs to be an integer or a variable",onChange:gn,placeholder:"Value or variable",suggestions:xn}):(0,H.jsx)(qe.p,{className:"flex-grow-1",invalid:Et,defaultValue:String(ve.value),placeholder:"Value",onChange:In,onBlur:Sn})}}const Fe=()=>[{name:"Is greater",id:le.Js.greater,component:_e({validator:Ce.N_})},{name:"Is greater or equal",id:le.Js.greaterOrEqual,component:_e({validator:Ce.N_})},{name:"Is lower",id:le.Js.lower,component:_e({validator:Ce.N_})},{name:"Is lower or equal",id:le.Js.lowerOrEqual,component:_e({validator:Ce.N_})},{name:"Is equal",id:le.Js.equal,component:_e({validator:()=>!0})},{name:"Is not equal",id:le.Js.notEqual,component:_e({validator:()=>!0})},{name:"Is Substring",id:le.Js.substring,component:_e({validator:()=>!0})},{name:"Is not substring",id:le.Js.notSubstring,component:_e({validator:()=>!0})}],at=()=>null,Ct=()=>[{name:"Is null",id:le.Js.isNull,component:at},{name:"Is not null",id:le.Js.isNotNull,component:at}];var Dt=e(76892);function tt(ce){return function({options:ve,onChange:Re,field:He}){const{validator:st}=ce,[ot,yt]=(0,f.useState)({from:!st(ve.from),to:!st(ve.to)}),Wt=(0,we.w)().getVariables().map(Sn=>({value:Sn.name,label:Sn.label||Sn.name,origin:Xe.$0.Template})),Zt=(0,f.useCallback)((Sn,gn)=>{yt({...ot,[gn]:!st(Sn.currentTarget.value)})},[yt,st,ot]),xn=(0,f.useCallback)((Sn,gn)=>{if(ot[gn])return;const{value:En}=Sn.currentTarget;Re({...ve,[gn]:je(En,He)})},[ve,Re,ot,He]),In=(0,f.useCallback)((Sn,gn)=>{const En=!st(Sn);yt({...ot,[gn]:En}),!En&&Re({...ve,[gn]:Sn})},[ve,Re,ot,yt,st]);return te.$.featureToggles.transformationsVariableSupport?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(We.y,{value:String(ve.from),invalid:ot.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:Sn=>In(Sn,"from"),suggestions:Wt}),(0,H.jsx)(Dt.c,{children:"and"}),(0,H.jsx)(We.y,{invalid:ot.to,error:"Value needs to be an integer or a variable",value:String(ve.to),placeholder:"To",suggestions:Wt,onChange:Sn=>In(Sn,"to")})]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(qe.p,{invalid:ot.from,defaultValue:String(ve.from),placeholder:"From",onChange:Sn=>Zt(Sn,"from"),onBlur:Sn=>xn(Sn,"from")}),(0,H.jsx)(Dt.c,{children:"and"}),(0,H.jsx)(qe.p,{invalid:ot.to,defaultValue:String(ve.to),placeholder:"To",onChange:Sn=>Zt(Sn,"to"),onBlur:Sn=>xn(Sn,"to")})]})}}const ze=()=>[{name:"Is between",id:le.Js.between,component:tt({validator:Ce.N_})}];function pe(ce){return function({options:ve,onChange:Re,field:He}){const{validator:st,converter:ot=je}=ce,{value:yt}=ve,[Et,Wt]=(0,f.useState)(!st(yt)),xn=(0,we.w)().getVariables().map(En=>({value:En.name,label:En.label||En.name,origin:Xe.$0.Template})),In=(0,f.useCallback)(En=>{Wt(!st(En.currentTarget.value))},[Wt,st]),Sn=(0,f.useCallback)(En=>{Wt(!st(En)),Re({...ve,value:En})},[Wt,st,Re,ve]),gn=(0,f.useCallback)(En=>{if(Et)return;const{value:Ss}=En.currentTarget;Re({...ve,value:ot(Ss,He)})},[ve,Re,Et,He,ot]);return te.$.featureToggles.transformationsVariableSupport?(0,H.jsx)(We.y,{invalid:Et,value:yt,onChange:Sn,placeholder:"Value or variable",suggestions:xn}):(0,H.jsx)(qe.p,{className:"flex-grow-1",invalid:Et,defaultValue:String(ve.value),placeholder:"Value",onChange:In,onBlur:gn})}}const Se=()=>[{name:"Regex",id:le.Js.regex,component:pe({validator:()=>!0,converter:ce=>String(ce)})}],fe=new Ue.O(()=>[...Fe(),...Ct(),...ze(),...Se()]),Ee=ce=>{const{onDelete:ie,onChange:ve,filter:Re,fieldsInfo:He}=ce,{fieldsAsOptions:st,fieldByDisplayName:ot}=He,yt=be(Re,st)??"",Et=ot[yt],Wt=Et?Pe(Et):[],Zt=he(Re,Wt),xn=fe.getIfExists(Zt),In=(0,f.useCallback)(En=>{En?.value&&ve({...Re,fieldName:En.value})},[ve,Re]),Sn=(0,f.useCallback)(En=>{if(!En?.value)return;const Ss=En.value,Cr=ne.hI.get(Ss).getDefaultOptions(Et);ve({...Re,config:{id:Ss,options:Cr}})},[ve,Re,Et]),gn=(0,f.useCallback)(En=>{ve({...Re,config:{...Re.config,options:En}})},[ve,Re]);return!Et||!xn||!xn.component?null:(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Field",labelWidth:14,children:(0,H.jsx)(Oe.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:st,value:Re.fieldName,onChange:In})}),(0,H.jsx)(J.I,{label:"Match",children:(0,H.jsx)(Oe.l6,{className:"width-12",placeholder:"Select test",options:Wt,value:Zt,onChange:Sn})}),(0,H.jsx)(J.I,{label:"Value",grow:!0,children:(0,H.jsx)(xn.component,{field:Et,options:Re.config.options??{},onChange:gn})}),(0,H.jsx)(de.a,{marginBottom:.5,children:(0,H.jsx)(xe.$n,{icon:"times",onClick:ie,variant:"secondary"})})]})},Pe=ce=>{const ie=[];for(const ve of ne.hI.list())!ve.isApplicable(ce)||!fe.getIfExists(ve.id)||ie.push({value:ve.id,label:ve.name,description:ve.description});return ie},he=(ce,ie)=>{const ve=ie.find(Re=>Re.value===ce.config.id);if(ve&&ve.value)return ve.value;if(ie[0]?.value)return ie[0]?.value},be=(ce,ie)=>{const ve=ie.find(Re=>Re.value===ce.fieldName);if(ve&&ve.value)return ve.value;if(ie[0]?.value)return ie[0]?.value},Ae=[{label:"Include",value:oe.j4.include},{label:"Exclude",value:oe.j4.exclude}],De=[{label:"Match all",value:oe.Sm.all},{label:"Match any",value:oe.Sm.any}],Ie=ce=>{const{input:ie,options:ve,onChange:Re}=ce,He=dt(ie),st=(0,f.useCallback)(()=>{const Zt=ie[0],xn=Zt.fields.find(gn=>gn.type!==se.PU.time);if(!xn)return;const In=(0,v.cloneDeep)(ve.filters),Sn=ne.hI.get(le.Js.isNull);In.push({fieldName:(0,_.Ct)(xn,Zt,ie),config:{id:Sn.id,options:Sn.getDefaultOptions(xn)}}),Re({...ve,filters:In})},[Re,ve,ie]),ot=(0,f.useCallback)(Zt=>{let xn=(0,v.cloneDeep)(ve.filters);xn.splice(Zt,1),Re({...ve,filters:xn})},[ve,Re]),yt=(0,f.useCallback)((Zt,xn)=>{let In=(0,v.cloneDeep)(ve.filters);In[xn]=Zt,Re({...ve,filters:In})},[ve,Re]),Et=(0,f.useCallback)(Zt=>{Re({...ve,type:Zt??oe.j4.include})},[ve,Re]),Wt=(0,f.useCallback)(Zt=>{Re({...ve,match:Zt??oe.Sm.all})},[ve,Re]);return(0,H.jsxs)("div",{children:[(0,H.jsx)(J.I,{label:"Filter type",labelWidth:16,children:(0,H.jsx)("div",{className:"width-15",children:(0,H.jsx)(ee.z,{options:Ae,value:ve.type,onChange:Et,fullWidth:!0})})}),(0,H.jsx)(J.I,{label:"Conditions",labelWidth:16,children:(0,H.jsx)("div",{className:"width-15",children:(0,H.jsx)(ee.z,{options:De,value:ve.match,onChange:Wt,fullWidth:!0})})}),(0,H.jsxs)(de.a,{paddingLeft:2,children:[ve.filters.map((Zt,xn)=>(0,H.jsx)(Ee,{filter:Zt,fieldsInfo:He,onChange:In=>yt(In,xn),onDelete:()=>ot(xn)},xn)),(0,H.jsx)(xe.$n,{icon:"plus",size:"sm",onClick:st,variant:"secondary",children:"Add condition"})]})]})},ke={id:Q.F.filterByValue,editor:Ie,transformation:ae.c.filterByValueTransformer,name:ae.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([D.m.Filter]),help:ue(Q.F.filterByValue).helperDocs},dt=ce=>(0,f.useMemo)(()=>{const ie={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(ce)?ce.reduce((ve,Re)=>Re.fields.reduce((He,st)=>{const ot=(0,_.Ct)(st,Re,ce);return He.fieldByDisplayName[ot]||(He.fieldsAsOptions.push({label:ot,value:ot,type:st.type}),He.fieldByDisplayName[ot]=st),He},ve),ie):ie},[ce]);var Pt=e(43429),pt=e(60264),Tt=e(48192),jt=e(66211),$t=e(54612);function sn(ce,ie){const ve={data:ce.input,options:ce.options},Re=new Tt.C({id:"root",title:"root"}),He=ot=>{if(ot?.length){const yt=ot[0];let Et=Re.categories.find(Wt=>Wt.props.id===yt);return Et||(Et=new Tt.C({id:yt,title:yt}),Re.categories.push(Et)),Et}return Re},st={getValue:ot=>(0,v.get)(ce.options,ot),onChange:(ot,yt)=>{ce.onChange((0,$t.Sf)(ce.options,ot,yt))}};return(0,jt.g5)(ie,st,He,ve),Re}function Yt(ce){const ie={data:[],options:{}},ve={},Re=new pt.pv;ce(Re,ie);for(const He of Re.getItems())He.defaultValue!=null&&(0,v.set)(ve,He.path,He.defaultValue);return ve}var qt=e(27825),bn=e(3290);const Mt=(ce,ie)=>{const ve=ie.options??{};(0,qt.J)("",ce,ve)},Jt=ce=>{(0,f.useEffect)(()=>{if(!ce.options.xBuckets?.mode){const ve=Yt(Mt);ce.onChange({...ve,...ce.options})}});const ie=sn(ce,Mt);return(0,H.jsx)("div",{children:(0,H.jsx)("div",{children:ie.items.map(ve=>ve.render())})})},Ut={id:bn.wY.id,editor:Jt,transformation:bn.wY,name:bn.wY.name,description:bn.wY.description,state:Pt.pn.alpha,categories:new Set([D.m.CreateNewVisualization]),help:ue(bn.wY.id).helperDocs};var Gt=e(32196),Lt=e(40845),At=e(84349),Nt=e(75059),Dn=e(42734),An=e(24293),Pn=e(28802),Xn=e(50082),Tn=e(25019);function ht(ce,ie,ve){const Re={},He={};for(const st of ce.fields){const ot=(0,_.Ct)(st,ce),yt=ve.index[ot],Et=yt.handler;if(!Et)continue;const Wt=st.values[ie];if(Wt==null)continue;const Zt=Et.processor(Wt,Re,He,yt.handlerArguments);Zt!=null&&(Re[Et.targetProperty??Et.key]=Zt)}return He.mappingValues&&(Re.mappings=Ve(He)),Re}var St=(ce=>(ce.Name="field.name",ce.Value="field.value",ce.Label="field.label",ce.Ignore="__ignore",ce))(St||{});const Ge=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Qe},{key:"min",processor:Qe},{key:"unit",processor:ce=>ce.toString()},{key:"decimals",processor:Qe},{key:"displayName",name:"Display name",processor:ce=>ce.toString()},{key:"color",processor:ce=>({fixedColor:ce,mode:An.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(ce,ie,ve,Re)=>{const He=(0,Pn.t)(ce);if(!isNaN(He))return ie.thresholds||(ie.thresholds={mode:Xn.O.Absolute,steps:[{value:-1/0,color:"green"}]}),ie.thresholds.steps.push({value:He,color:Re.threshold?.color??"red"}),ie.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:Nt.gy.allValues,processor:(ce,ie,ve)=>{if((0,v.isArray)(ce))return ve.mappingValues=ce,ie.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:Nt.gy.allValues,processor:(ce,ie,ve)=>{if((0,v.isArray)(ce))return ve.mappingColors=ce,ie.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:Nt.gy.allValues,processor:(ce,ie,ve)=>{if((0,v.isArray)(ce))return ve.mappingTexts=ce,ie.mappings}}];function Ve(ce){const ie={type:Tn.d.ValueToText,options:{}};if(!ce.mappingValues)return[];for(let ve=0;ve<ce.mappingValues.length;ve++){const Re=ce.mappingValues[ve];Re!=null&&(ie.options[Re.toString()]={color:ce.mappingColors&&ce.mappingColors[ve],text:ce.mappingTexts&&ce.mappingTexts[ve],index:ve})}return[ie]}let lt=null;function It(){if(lt===null){lt={};for(const ce of Ge)lt[ce.key]=ce}return lt}function Qe(ce){const ie=(0,Pn.t)(ce);if(!isNaN(ie))return ie}function vt(ce,ie){for(const ve of ie)if(ce===ve.fieldName)return ve.handlerKey;return ce.toLowerCase()}function Ot(ce){return ce?It()[ce]:null}function zt(ce,ie,ve){const Re={index:{}};let He=ie.find(ot=>ot.handlerKey==="field.name"),st=ie.find(ot=>ot.handlerKey==="field.value");for(const ot of ce.fields){const yt=(0,_.Ct)(ot,ce),Et=ie.find(xn=>xn.fieldName===yt),Wt=Et?Et.handlerKey:yt.toLowerCase();let Zt=Ot(Wt);ve&&(Zt?(Zt.key==="field.name"&&(Re.nameField=ot),Zt.key==="field.value"&&(Re.valueField=ot)):Et||(!Re.nameField&&!He&&ot.type===se.PU.string&&(Re.nameField=ot,Zt=Ot("field.name")),!Re.valueField&&!st&&ot.type===se.PU.number&&(Re.valueField=ot,Zt=Ot("field.value")))),!Zt&&ve&&(Zt=Ot("field.label")),Re.index[yt]={automatic:!Et,handler:Zt,handlerArguments:Et?.handlerArguments??{},reducerId:Et?.reducerId??Zt?.defaultReducer??Nt.gy.lastNotNull}}return Re}var vn=e(83598);function ln(ce){switch(ce){case"threshold1":return!0;default:return!1}}function On({handlerArguments:ce,handlerKey:ie,onChange:ve}){const Re=He=>{ve(He?{...ce,threshold:{...ce.threshold,color:He}}:{...ce,threshold:void 0})};return(0,H.jsx)(H.Fragment,{children:ie==="threshold1"&&(0,H.jsx)(qe.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:(0,H.jsx)(vn.sk,{color:ce.threshold?.color??"red",onChange:Re,enableNamedColors:!0})})})}function wn({frame:ce,mappings:ie,onChange:ve,withReducers:Re,withNameAndValue:He}){const st=(0,Lt.of)(Zn),ot=Un(ce,ie,He),yt=Ge.map(In=>cs(In,!1)),Et=ie.reduce((In,Sn)=>In||ln(Sn.handlerKey),!1),Wt=(In,Sn)=>{const gn=ie.findIndex(En=>En.fieldName===In.fieldName);if(Sn)if(gn!==-1){const En=[...ie];En.splice(gn,1,{...ie[gn],handlerKey:Sn.value}),ve(En)}else ve([...ie,{fieldName:In.fieldName,handlerKey:Sn.value}]);else ve(gn!==-1?ie.filter((En,Ss)=>Ss!==gn):[...ie,{fieldName:In.fieldName,handlerKey:"__ignore"}])},Zt=(In,Sn)=>{const gn=ie.findIndex(En=>En.fieldName===In.fieldName);if(gn!==-1){const En=[...ie];En.splice(gn,1,{...ie[gn],reducerId:Sn}),ve(En)}else ve([...ie,{fieldName:In.fieldName,handlerKey:In.handlerKey,reducerId:Sn}])},xn=(In,Sn)=>{const gn=ie.findIndex(En=>En.fieldName===In.fieldName);if(gn!==-1){const En=[...ie];En.splice(gn,1,{...ie[gn],handlerArguments:Sn}),ve(En)}else ve([...ie,{fieldName:In.fieldName,handlerKey:In.handlerKey,handlerArguments:Sn}])};return(0,H.jsxs)("table",{className:st.table,children:[(0,H.jsx)("thead",{children:(0,H.jsxs)("tr",{children:[(0,H.jsx)("th",{children:"Field"}),(0,H.jsx)("th",{children:"Use as"}),Re&&(0,H.jsx)("th",{children:"Select"}),Et&&(0,H.jsx)("th",{children:"Additional settings"})]})}),(0,H.jsx)("tbody",{children:ot.map(In=>(0,H.jsxs)("tr",{children:[(0,H.jsx)("td",{className:st.labelCell,children:In.fieldName}),(0,H.jsx)("td",{className:st.selectCell,"data-testid":`${In.fieldName}-config-key`,children:(0,H.jsx)(Oe.l6,{options:yt,value:In.configOption,placeholder:In.placeholder,isClearable:!0,onChange:Sn=>Wt(In,Sn)})}),Re&&(0,H.jsx)("td",{"data-testid":`${In.fieldName}-reducer`,className:st.selectCell,children:(0,H.jsx)(Dn.S,{stats:[In.reducerId],defaultStat:In.reducerId,onChange:Sn=>Zt(In,Sn[0])})}),Et&&(0,H.jsx)("td",{"data-testid":`${In.fieldName}-handler-arg`,className:st.selectCell,children:(0,H.jsx)(On,{handlerKey:In.handlerKey,handlerArguments:In.handlerArguments,onChange:Sn=>xn(In,Sn)})})]},In.fieldName))})]})}function Un(ce,ie,ve){const Re=[],He=zt(ce,ie??[],ve);for(const st of ce.fields){const ot=(0,_.Ct)(st,ce),yt=He.index[ot],Et=cs(yt.handler,yt.automatic);Re.push({fieldName:ot,configOption:yt.automatic?null:Et,placeholder:yt.automatic?Et?.label:"Choose",handlerKey:yt.handler?.key??null,reducerId:yt.reducerId,handlerArguments:yt.handlerArguments})}for(const st of ie)if(!Re.find(ot=>ot.fieldName===st.fieldName)){const ot=Ot(st.handlerKey);Re.push({fieldName:st.fieldName,handlerKey:st.handlerKey,configOption:cs(ot,!1),missingInFrame:!0,reducerId:st.reducerId??Nt.gy.lastNotNull,handlerArguments:{}})}return Object.values(Re)}function cs(ce,ie){if(!ce)return null;let ve=ce.name??(0,v.capitalize)(ce.key);return ie&&(ve=`${ve} (auto)`),{label:ve,value:ce.key}}const Zn=ce=>({table:(0,Gt.css)`
    margin-top: ${ce.spacing(1)};

    td,
    th {
      border-right: 4px solid ${ce.colors.background.primary};
      border-bottom: 4px solid ${ce.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${ce.typography.bodySmall.fontSize};
      line-height: ${ce.spacing(4)};
      padding: ${ce.spacing(0,1)};
    }
  `,labelCell:(0,Gt.css)`
    font-size: ${ce.typography.bodySmall.fontSize};
    background: ${ce.colors.background.secondary};
    padding: ${ce.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,Gt.css)`
    padding: 0;
    min-width: 161px;
  `});var wt=e(81160);function Ft(ce,ie){let ve=null;for(const yt of ie)if(yt.refId===ce.configRefId){ve=yt;break}if(!ve)return ie;const Re={fields:[],length:1},He=zt(ve,ce.mappings??[],!1);for(const yt of ve.fields){const Et={...yt},Wt=(0,_.Ct)(yt,ve),Zt=He.index[Wt],xn=(0,Nt.Nw)({field:yt,reducers:[Zt.reducerId]});Et.values=[xn[Zt.reducerId]],Re.fields.push(Et)}const st=[],ot=(0,ne.NS)(ce.applyTo||{id:le.Ct.numeric});for(const yt of ie){if(yt===ve&&ie.length>1)continue;const Et={fields:[],length:yt.length,refId:yt.refId};for(const Wt of yt.fields)if(ot(Wt,yt,ie)){const Zt=ht(Re,0,He);Et.fields.push({...Wt,config:{...Wt.config,...Zt}})}else Et.fields.push(Wt);st.push(Et)}return st}const Ht={id:Q.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:ce=>ie=>ie.pipe((0,wt.T)(ve=>Ft(ce,ve)))};function ut({input:ce,onChange:ie,options:ve}){const Re=(0,Lt.of)(Jn),He=ce.map(Sn=>Sn.refId).filter(Sn=>Sn!=null).map(Sn=>({label:Sn,value:Sn})),st=ve.configRefId||"config",ot=ve.applyTo??{id:le.Ct.byType,options:"number"},yt=At.g.get(ot.id),Et=ce.find(Sn=>Sn.refId===st),Wt=Sn=>{ie({...ve,configRefId:Sn.value||"config"})},Zt=Sn=>{ie({...ve,applyTo:{id:Sn.value}})},xn=Sn=>{ie({...ve,applyTo:{id:ot.id,options:Sn}})},In=At.g.list().filter(Sn=>!Sn.excludeFromPicker).map(Sn=>({label:Sn.name,value:Sn.id,description:Sn.description}));return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Config query",labelWidth:20,children:(0,H.jsx)(Oe.l6,{onChange:Wt,options:He,value:st,width:30})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Apply to",labelWidth:20,children:(0,H.jsx)(Oe.l6,{onChange:Zt,options:In,value:ot.id,width:30})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Apply to options",labelWidth:20,className:Re.matcherOptions,children:(0,H.jsx)(yt.component,{matcher:yt.matcher,data:ce,options:ot.options,onChange:xn})})}),(0,H.jsx)(ge.C,{children:Et&&(0,H.jsx)(wn,{frame:Et,mappings:ve.mappings,onChange:Sn=>ie({...ve,mappings:Sn}),withReducers:!0})})]})}const pn={id:Ht.id,editor:ut,transformation:Ht,name:Ht.name,description:Ht.description,state:Pt.pn.beta,categories:new Set([D.m.CalculateNewFields]),help:ue(Ht.id).helperDocs},Jn=ce=>({matcherOptions:(0,Gt.css)`
    min-width: 404px;
  `});var Qn=e(62467),fs=e(58307),ls=e(66350),vs=e(15292),ea=e(11710);const Ks=16,Hs=ce=>{const{options:ie,onChange:ve}=ce,{binary:Re}=ie;let He=!Re?.left,st=!Re?.right;const ot=ce.names.map(gn=>(gn===Re?.left&&(He=!0),gn===Re?.right&&(st=!0),{label:gn,value:gn})),yt=He?ot:[...ot,{label:Re?.left,value:Re?.left}],Et=st?ot:[...ot,{label:Re?.right,value:Re?.right}],Wt=ea.b.list().map(gn=>({label:gn.binaryOperationID,value:gn.binaryOperationID})),Zt=gn=>{ve({...ie,mode:ls.UY.BinaryOperation,binary:gn})},xn=gn=>{Zt({...Re,left:gn.value})},In=gn=>{Zt({...Re,right:gn.value})},Sn=gn=>{Zt({...Re,operator:gn.value})};return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Operation",labelWidth:Ks,children:(0,H.jsx)(Oe.l6,{allowCustomValue:!0,placeholder:"Field or number",options:yt,className:"min-width-18",value:Re?.left,onChange:xn})}),(0,H.jsx)(J.I,{children:(0,H.jsx)(Oe.l6,{className:"width-4",options:Wt,value:Re?.operator??Wt[0].value,onChange:Sn})}),(0,H.jsx)(J.I,{children:(0,H.jsx)(Oe.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Et,value:Re?.right,onChange:In})})]})})},bs=ce=>{const{names:ie,onChange:ve,options:Re}=ce,{cumulative:He}=Re,st=ie.map(Wt=>({label:Wt,value:Wt})),ot=Wt=>{const Zt=Wt.length?Wt[0]:Nt.gy.sum;yt({...He,reducer:Zt})},yt=Wt=>{ve({...Re,mode:ls.UY.CumulativeFunctions,cumulative:Wt})},Et=Wt=>{yt({...He,field:Wt.value})};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{label:"Field",labelWidth:Ks,children:(0,H.jsx)(Oe.l6,{placeholder:"Field",options:st,className:"min-width-18",value:He?.field,onChange:Et})}),(0,H.jsx)(J.I,{label:"Calculation",labelWidth:Ks,children:(0,H.jsx)(Dn.S,{allowMultiple:!1,className:"width-18",stats:[He?.reducer||Nt.gy.sum],onChange:ot,defaultStat:Nt.gy.sum,filterOptions:Wt=>Wt.id===Nt.gy.sum||Wt.id===Nt.gy.mean})})]})},Ys=ce=>{const{options:ie,onChange:ve}=ce,{index:Re}=ie,He=st=>{ve({...ie,index:{asPercentile:st.currentTarget.checked}})};return(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(J.I,{labelWidth:Ks,label:"As percentile",tooltip:"Transform the row index as a percentile.",children:(0,H.jsx)(vs.K,{value:!!Re?.asPercentile,onChange:He})})})};var La=e(66864),Xs=e(92174);const Ta=ce=>{const{names:ie,selected:ve,onChange:Re,options:He}=ce,{reduce:st}=He,ot=Zt=>{Re({...He,reduce:Zt})},yt=Zt=>{ve.indexOf(Zt)>-1?Et(ve.filter(xn=>xn!==Zt)):Et([...ve,Zt])},Et=Zt=>{ot({...st,include:Zt})},Wt=Zt=>{const xn=Zt.length?Zt[0]:Nt.gy.sum,{reduce:In}=He;ot({...In,reducer:xn})};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{label:"Operation",labelWidth:Ks,grow:!0,children:(0,H.jsx)(La.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:ie.map((Zt,xn)=>(0,H.jsx)(Xs.m,{onClick:()=>{yt(Zt)},label:Zt,selected:ve.indexOf(Zt)>-1},`${Zt}/${xn}`))})}),(0,H.jsx)(J.I,{label:"Calculation",labelWidth:Ks,children:(0,H.jsx)(Dn.S,{allowMultiple:!1,className:"width-18",stats:[st?.reducer||Nt.gy.sum],onChange:Wt,defaultStat:Nt.gy.sum})})]})};var Lr=e(27618);const $r=ce=>{const{options:ie,onChange:ve}=ce,{unary:Re}=ie,He=xn=>{ve({...ie,mode:ls.UY.UnaryOperation,unary:xn})},st=xn=>{He({...Re,operator:xn.value})},ot=xn=>{He({...Re,fieldName:xn.value})};let yt=!Re?.fieldName;const Et=ce.names.map(xn=>(xn===Re?.fieldName&&(yt=!0),{label:xn,value:xn})),Wt=Lr.j.list().map(xn=>({label:xn.unaryOperationID,value:xn.unaryOperationID})),Zt=yt?Et:[...Et,{label:Re?.fieldName,value:Re?.fieldName}];return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Operation",labelWidth:Ks,children:(0,H.jsx)(Oe.l6,{options:Wt,value:Re?.operator??Wt[0].value,onChange:st})}),(0,H.jsx)(J.I,{label:"(",labelWidth:2,children:(0,H.jsx)(Oe.l6,{placeholder:"Field",className:"min-width-11",options:Zt,value:Re?.fieldName,onChange:ot})}),(0,H.jsx)(Dt.c,{width:2,children:")"})]})})};var Za=e(60188);const Er=ce=>{const{options:ie,names:ve,onChange:Re}=ce,{window:He}=ie,st=ve.map(gn=>({label:gn,value:gn})),ot=[{label:"Trailing",value:ls.ip.Trailing},{label:"Centered",value:ls.ip.Centered}],yt=[{label:"Percentage",value:ls.Bp.Percentage},{label:"Fixed",value:ls.Bp.Fixed}],Et=gn=>{Re({...ie,mode:ls.UY.WindowFunctions,window:gn})},Wt=gn=>{Et({...He,field:gn.value})},Zt=gn=>{Et({...He,windowSize:gn&&He?.windowSizeMode===ls.Bp.Percentage?gn/100:gn})},xn=gn=>{Et({...He,windowSize:He?.windowSize?gn===ls.Bp.Percentage?He.windowSize/100:He.windowSize*100:void 0,windowSizeMode:gn})},In=gn=>{const En=gn.length?gn[0]:Nt.gy.sum;Et({...He,reducer:En})},Sn=gn=>{Et({...He,windowAlignment:gn})};return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{label:"Field",labelWidth:Ks,children:(0,H.jsx)(Oe.l6,{placeholder:"Field",options:st,className:"min-width-18",value:He?.field,onChange:Wt})}),(0,H.jsx)(J.I,{label:"Calculation",labelWidth:Ks,children:(0,H.jsx)(Dn.S,{allowMultiple:!1,className:"width-18",stats:[He?.reducer||Nt.gy.mean],onChange:In,defaultStat:Nt.gy.mean,filterOptions:gn=>gn.id===Nt.gy.mean||gn.id===Nt.gy.variance||gn.id===Nt.gy.stdDev})}),(0,H.jsx)(J.I,{label:"Type",labelWidth:Ks,children:(0,H.jsx)(ee.z,{value:He?.windowAlignment??ls.ip.Trailing,options:ot,onChange:Sn})}),(0,H.jsx)(J.I,{label:"Window size mode",children:(0,H.jsx)(ee.z,{value:He?.windowSizeMode??ls.Bp.Percentage,options:yt,onChange:xn})}),(0,H.jsx)(J.I,{label:He?.windowSizeMode===ls.Bp.Percentage?"Window size %":"Window size",labelWidth:Ks,tooltip:He?.windowSizeMode===ls.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size",children:(0,H.jsx)(Za.Q,{placeholder:"Auto",min:.1,value:He?.windowSize&&He.windowSizeMode===ls.Bp.Percentage?He.windowSize*100:He?.windowSize,onChange:Zt})})]})},Ar=[{value:ls.UY.BinaryOperation,label:"Binary operation"},{value:ls.UY.UnaryOperation,label:"Unary operation"},{value:ls.UY.ReduceRow,label:"Reduce row"},{value:ls.UY.Index,label:"Row index"}];te.$.featureToggles.addFieldFromCalculationStatFunctions&&Ar.push({value:ls.UY.CumulativeFunctions,label:"Cumulative functions"},{value:ls.UY.WindowFunctions,label:"Window functions"});const ho=new Set([se.PU.time,se.PU.number,se.PU.string]),Fr=ce=>{const{options:ie,onChange:ve,input:Re}=ce,He=ie?.reduce?.include,[st,ot]=(0,f.useState)({names:[],selected:[]});(0,f.useEffect)(()=>{const gn={interpolate:Ss=>Ss},En=(0,Qn.of)(Re).pipe(ae.c.ensureColumnsTransformer.operator(null,gn),Et(),yt(),Wt(He||[])).subscribe(({selected:Ss,names:Cr})=>{ot({names:Cr,selected:Ss})});return()=>{En.unsubscribe()}},[Re,He]);const yt=()=>{if(!te.$.featureToggles.transformationsVariableSupport)return fs.D;const gn=(0,we.w)();return En=>En.pipe((0,wt.T)(Ss=>(Ss.push(...gn.getVariables().map(Cr=>"$"+Cr.name)),Ss)))},Et=()=>gn=>gn.pipe((0,wt.T)(En=>{const Ss=[],Cr={};for(const Ur of En)for(const Nr of Ur.fields){if(!ho.has(Nr.type))continue;const ur=(0,_.Ct)(Nr,Ur,En);Cr[ur]||(Cr[ur]=!0,Ss.push(ur))}return Ss})),Wt=gn=>En=>En.pipe((0,wt.T)(Ss=>{if(!gn.length)return{names:Ss,selected:[]};const Cr=[],Ur=[];for(const Nr of Ss)gn.includes(Nr)&&Ur.push(Nr),Cr.push(Nr);return{names:Cr,selected:Ur}})),Zt=gn=>{ve({...ie,replaceFields:gn.currentTarget.checked})},xn=gn=>{const En=gn.value??ls.UY.BinaryOperation;En===ls.UY.WindowFunctions&&(ie.window=ie.window??ls.Uj),ve({...ie,mode:En})},In=gn=>{ve({...ie,alias:gn.target.value})},Sn=ie.mode??ls.UY.BinaryOperation;return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{labelWidth:Ks,label:"Mode",children:(0,H.jsx)(Oe.l6,{className:"width-18",options:Ar,value:Ar.find(gn=>gn.value===Sn),onChange:xn})}),Sn===ls.UY.BinaryOperation&&(0,H.jsx)(Hs,{options:ie,names:st.names,onChange:ce.onChange}),Sn===ls.UY.UnaryOperation&&(0,H.jsx)($r,{names:st.names,options:ie,onChange:ce.onChange}),Sn===ls.UY.ReduceRow&&(0,H.jsx)(Ta,{names:st.names,selected:st.selected,options:ie,onChange:ce.onChange}),Sn===ls.UY.CumulativeFunctions&&(0,H.jsx)(bs,{names:st.names,options:ie,onChange:ce.onChange}),Sn===ls.UY.WindowFunctions&&(0,H.jsx)(Er,{names:st.names,options:ie,onChange:ce.onChange}),Sn===ls.UY.Index&&(0,H.jsx)(Ys,{options:ie,onChange:ce.onChange}),(0,H.jsx)(J.I,{labelWidth:Ks,label:"Alias",children:(0,H.jsx)(qe.p,{className:"width-18",value:ie.alias??"",placeholder:(0,ls.sw)(ie),onChange:In})}),(0,H.jsx)(J.I,{labelWidth:Ks,label:"Replace all fields",children:(0,H.jsx)(vs.K,{value:!!ie.replaceFields,onChange:Zt})})]})},rr={id:Q.F.calculateField,editor:Fr,transformation:ae.c.calculateFieldTransformer,name:ae.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([D.m.CalculateNewFields]),help:ue(Q.F.calculateField).helperDocs};var fo=e(82150);const _o=[{value:fo.x1.FieldName,label:"Copy frame name to field name"},{value:fo.x1.Label,label:"Add a label with the frame name"},{value:fo.x1.Drop,label:"Ignore the frame name"}];class gr extends f.PureComponent{constructor(ie){super(ie),this.onModeChanged=ve=>{const{options:Re,onChange:He}=this.props,st=ve.value??fo.x1.FieldName;He({...Re,frameNameMode:st})},this.onLabelChanged=ve=>{const{options:Re}=this.props;this.props.onChange({...Re,frameNameLabel:ve.target.value})}}render(){const{options:ie}=this.props,ve=ie.frameNameMode??fo.x1.FieldName;return(0,H.jsxs)("div",{children:[(0,H.jsx)(J.I,{label:"Name",labelWidth:16,grow:!0,children:(0,H.jsx)(Oe.l6,{width:36,options:_o,value:_o.find(Re=>Re.value===ve),onChange:this.onModeChanged})}),ve===fo.x1.Label&&(0,H.jsx)(J.I,{label:"Label",labelWidth:16,grow:!0,children:(0,H.jsx)(qe.p,{width:36,value:ie.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})})]})}}const ci={id:Q.F.concatenate,editor:gr,transformation:ae.c.concatenateTransformer,name:ae.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([D.m.Combine]),help:ue(Q.F.concatenate).helperDocs};var Qo=e(91410),eo=e(76218),Do=e(9988),di=e(63577),bo=e(91076),Oo=e(14578),To=e(72093),jo=e(29158);const $o=({transformIndex:ce,value:ie,index:ve,mappedIndex:Re,onChangeEnumValue:He,onRemoveEnumRow:st,checkIsEnumUniqueValue:ot})=>{const yt=(0,Lt.of)(Yo),[Et,Wt]=(0,f.useState)(ie),[Zt,xn]=(0,f.useState)(Et===""),[In,Sn]=(0,f.useState)(null),gn=(0,f.useRef)(null);(0,f.useEffect)(()=>{gn.current&&gn.current.focus()},[gn]);const En=ur=>{ur.currentTarget.value!==""&&ot(ur.currentTarget.value)&&ur.currentTarget.value!==ie?Sn("Enum value already exists"):Sn(null),Wt(ur.currentTarget.value)},Ss=()=>{if(xn(!1),Sn(null),Et===""||In!==null){st(Re);return}He(Re,Et)},Cr=ur=>{ur.key==="Enter"&&(ur.preventDefault(),Ss())},Ur=()=>{xn(!0)},Nr=()=>{st(Re)};return(0,H.jsx)(bo.sx,{draggableId:`${ce}/${ie}`,index:ve,children:ur=>(0,H.jsxs)("tr",{ref:ur.innerRef,...ur.draggableProps,children:[(0,H.jsx)("td",{children:(0,H.jsx)("div",{className:yt.dragHandle,...ur.dragHandleProps,children:(0,H.jsx)(Oo.I,{name:"draggabledots",size:"lg"})})}),Zt?(0,H.jsxs)("td",{children:[(0,H.jsx)(qe.p,{ref:gn,type:"text",value:Et,onChange:En,onBlur:Ss,onKeyDown:Cr}),In&&(0,H.jsx)(To.P,{children:In})]}):(0,H.jsx)("td",{onClick:Ur,className:yt.clickableTableCell,children:ie&&ie!==""?ie:"Click to edit"}),(0,H.jsx)("td",{className:yt.textAlignCenter,children:(0,H.jsx)(La.Gy,{spacing:"sm",children:(0,H.jsx)(jo.K,{name:"trash-alt",onClick:Nr,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})})})]},ve)},`${ce}/${ie}`)},Yo=ce=>({dragHandle:(0,Gt.css)({cursor:"grab"}),textAlignCenter:(0,Gt.css)({textAlign:"center"}),clickableTableCell:(0,Gt.css)({cursor:"pointer",width:"100px","&:hover":{color:ce.colors.text.maxContrast}})}),Si=$o,vi=({input:ce,options:ie,transformIndex:ve,onChange:Re})=>{const He=(0,Lt.of)(ai),[st,ot]=(0,f.useState)(ie.conversions[ve].enumConfig?.text??[]);(0,f.useEffect)(()=>{!ie.conversions[ve].enumConfig?.text?.length&&ce.length&&yt()},[ce]),(0,f.useEffect)(()=>{(()=>{const En=st.map(Ur=>Ur),Ss=ie.conversions,Cr={text:En};Ss[ve]={...Ss[ve],enumConfig:Cr},Re({...ie,conversions:Ss})})()},[ve,st]);const yt=()=>{const gn=ce.flatMap(Ss=>Ss?.fields??[]).find(Ss=>Ss.name===ie.conversions[ve].targetField);if(!gn)return;const En=new Set(gn?.values);st.length>0&&!(0,v.isEqual)(st,Array.from(En))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||ot([...En])},Et=(gn,En)=>{const Ss=[...st];Ss.splice(gn,1,En),ot(Ss)},Wt=gn=>{const En=[...st];En.splice(gn,1),ot(En)},Zt=()=>{ot(["",...st])},xn=(gn,En)=>{st.includes(En)||Et(gn,En)},In=gn=>st.includes(gn),Sn=gn=>{if(!gn.destination)return;const En=st.length-gn.source.index-1,Ss=st.length-gn.destination.index-1,Cr=[...st],Ur=Cr[En];Cr.splice(En,1),Cr.splice(Ss,0,Ur),ot(Cr)};return(0,H.jsxs)(ge.C,{children:[(0,H.jsxs)(La.Gy,{children:[(0,H.jsx)(xe.$n,{size:"sm",icon:"plus",onClick:()=>yt(),className:He.button,children:"Generate enum values from data"}),(0,H.jsx)(xe.$n,{size:"sm",icon:"plus",onClick:()=>Zt(),className:He.button,children:"Add enum value"})]}),(0,H.jsx)(La.gW,{children:(0,H.jsx)("table",{className:He.compactTable,children:(0,H.jsx)(bo.JY,{onDragEnd:Sn,children:(0,H.jsx)(bo.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:gn=>(0,H.jsxs)("tbody",{ref:gn.innerRef,...gn.droppableProps,children:[[...st].reverse().map((En,Ss)=>{const Cr=st.length-Ss-1;return(0,H.jsx)(Si,{transformIndex:ve,value:En,index:Ss,mappedIndex:Cr,onChangeEnumValue:xn,onRemoveEnumRow:Wt,checkIsEnumUniqueValue:In},`${ve}/${En}`)}),gn.placeholder]})})})})})]})},ai=ce=>({compactTable:(0,Gt.css)({"tbody td":{padding:ce.spacing(.5)},marginTop:ce.spacing(1),marginBottom:ce.spacing(2)}),button:(0,Gt.css)({marginTop:ce.spacing(1)})}),yi={settings:{width:24,isClearable:!1}},Bo=({input:ce,options:ie,onChange:ve})=>{const Re=Do.bx.filter(Sn=>Sn.value!==se.PU.trace),He=(0,Ce.qt)(!0),st=(0,Qo.P3)();He.push({label:"Browser",value:"browser"}),He.push({label:"UTC",value:"utc"});for(const Sn of st)He.push({label:Sn,value:Sn});const ot=(0,f.useCallback)(Sn=>gn=>{const En=ie.conversions;En[Sn]={...En[Sn],targetField:gn??"",dateFormat:void 0},ve({...ie,conversions:En})},[ve,ie]),yt=(0,f.useCallback)(Sn=>gn=>{const En=ie.conversions;En[Sn]={...En[Sn],destinationType:gn.value},ve({...ie,conversions:En})},[ve,ie]),Et=(0,f.useCallback)(Sn=>gn=>{const En=ie.conversions;En[Sn]={...En[Sn],dateFormat:gn.currentTarget.value},ve({...ie,conversions:En})},[ve,ie]),Wt=(0,f.useCallback)(Sn=>gn=>{const En=ie.conversions;En[Sn]={...En[Sn],joinWith:gn.currentTarget.value},ve({...ie,conversions:En})},[ve,ie]),Zt=(0,f.useCallback)(()=>{ve({...ie,conversions:[...ie.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[ve,ie]),xn=(0,f.useCallback)(Sn=>{const gn=ie.conversions;gn.splice(Sn,1),ve({...ie,conversions:gn})},[ve,ie]),In=(0,f.useCallback)(Sn=>gn=>{const En=ie.conversions;En[Sn]={...En[Sn],timezone:gn?.value},ve({...ie,conversions:En})},[ve,ie]);return(0,H.jsxs)(H.Fragment,{children:[ie.conversions.map((Sn,gn)=>{const En=(0,di.findField)(ce?.[0],Sn.targetField);return(0,H.jsxs)("div",{children:[(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Field",children:(0,H.jsx)(eo.O,{context:{data:ce},value:Sn.targetField??"",onChange:ot(gn),item:yi})}),(0,H.jsx)(J.I,{label:"as",children:(0,H.jsx)(Oe.l6,{options:Re,value:Sn.destinationType,placeholder:"Type",onChange:yt(gn),width:18})}),Sn.destinationType===se.PU.time&&(0,H.jsx)(J.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly.",children:(0,H.jsx)(qe.p,{value:Sn.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Et(gn),width:24})}),Sn.destinationType===se.PU.string&&(0,H.jsxs)(H.Fragment,{children:[(Sn.joinWith?.length||En?.type===se.PU.other)&&(0,H.jsx)(J.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values",children:(0,H.jsx)(qe.p,{value:Sn.joinWith,placeholder:"JSON",onChange:Wt(gn),width:9})}),Sn.dateFormat||En?.type===se.PU.time&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{label:"Date format",tooltip:"Specify the output format.",children:(0,H.jsx)(qe.p,{value:Sn.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:Et(gn),width:24})}),(0,H.jsx)(J.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually",children:(0,H.jsx)(Oe.l6,{options:He,value:Sn.timezone,onChange:In(gn),isClearable:!0})})]})]}),(0,H.jsx)(xe.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>xn(gn),"aria-label":"Remove convert field type transformer"})]}),Sn.destinationType===se.PU.enum&&(0,H.jsx)(vi,{input:ce,options:ie,transformIndex:gn,onChange:ve})]},`${Sn.targetField}-${gn}`)}),(0,H.jsx)(xe.$n,{size:"sm",icon:"plus",onClick:Zt,variant:"secondary","aria-label":"Add a convert field type transformer",children:"Convert field type"})]})},Ai={id:Q.F.convertFieldType,editor:Bo,transformation:ae.c.convertFieldTypeTransformer,name:ae.c.convertFieldTypeTransformer.name,description:ae.c.convertFieldTypeTransformer.description,categories:new Set([D.m.Reformat]),help:ue(Q.F.convertFieldType).helperDocs};var Ho=e(54479);class ui extends f.PureComponent{constructor(ie){super(ie),this.onFieldToggle=ve=>{const{selected:Re}=this.state;Re.indexOf(ve)>-1?this.onChange(Re.filter(He=>He!==ve)):this.onChange([...Re,ve])},this.onChange=ve=>{const{regex:Re,isRegexValid:He}=this.state,st={...this.props.options,include:{names:ve}};Re&&He&&(st.include=st.include??{},st.include.pattern=Re),this.setState({selected:ve},()=>{this.props.onChange(st)})},this.onInputBlur=ve=>{const{selected:Re,regex:He}=this.state;let st=!0;try{He&&(0,Ho.dO)(He)}catch{st=!1}st?this.props.onChange({...this.props.options,include:{pattern:He}}):this.props.onChange({...this.props.options,include:{names:Re}}),this.setState({isRegexValid:st})},this.onVariableChange=ve=>{this.props.onChange({...this.props.options,include:{variable:ve.value}}),this.setState({variable:ve.value})},this.onFromVariableChange=ve=>{const Re=ve.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:Re}),this.setState({byVariable:Re})},this.state={include:ie.options.include?.names||[],regex:ie.options.include?.pattern,variable:ie.options.include?.variable,byVariable:ie.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(ie){this.props.input!==ie.input&&this.initOptions()}initOptions(){const{input:ie,options:ve}=this.props,Re=Array.from(ve.include?.names??[]),He=(0,we.w)().getVariables().map(yt=>({label:"$"+yt.name,value:"$"+yt.name})),st=[],ot={};for(const yt of ie)for(const Et of yt.fields){const Wt=(0,_.Ct)(Et,yt,ie);let Zt=ot[Wt];Zt||(Zt=ot[Wt]={name:Wt,count:0},st.push(Zt)),Zt.count++}if(ve.include?.pattern)try{const yt=(0,Ho.dO)(ve.include.pattern);for(const Et of st)yt.test(Et.name)&&Re.push(Et.name)}catch(yt){console.error(yt)}if(Re.length){const yt=st.filter(Et=>Re.includes(Et.name));this.setState({options:st,selected:yt.map(Et=>Et.name),variables:He,byVariable:ve.byVariable||!1,variable:ve.include?.variable,regex:ve.include?.pattern})}else this.setState({options:st,selected:st.map(yt=>yt.name),variables:He,byVariable:ve.byVariable||!1,variable:ve.include?.variable,regex:ve.include?.pattern})}render(){const{options:ie,selected:ve,isRegexValid:Re}=this.state;return(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{label:"Use variable",children:(0,H.jsx)(J.I,{label:"From variable",children:(0,H.jsx)(vs.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Variable",children:(0,H.jsx)(Oe.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,H.jsxs)(ge.C,{label:"Identifier",children:[(0,H.jsx)(J.I,{label:"Identifier",invalid:!Re,error:Re?void 0:"Invalid pattern",children:(0,H.jsx)(qe.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:He=>this.setState({regex:He.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),ie.map((He,st)=>{const ot=`${He.name}${He.count>1?" ("+He.count+")":""}`,yt=ve.indexOf(He.name)>-1;return(0,H.jsx)(Xs.m,{onClick:()=>{this.onFieldToggle(He.name)},label:ot,selected:yt},`${He.name}/${st}`)})]})]})}}const Jo={id:Q.F.filterFieldsByName,editor:ui,transformation:ae.c.filterFieldsByNameTransformer,name:ae.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([D.m.Filter]),help:ue(Q.F.filterFieldsByName).helperDocs};class Ri extends f.PureComponent{constructor(ie){super(ie),this.onFieldToggle=ve=>{const{selected:Re}=this.state;Re.indexOf(ve)>-1?this.onChange(Re.filter(He=>He!==ve)):this.onChange([...Re,ve])},this.onChange=ve=>{this.setState({selected:ve}),this.props.onChange({...this.props.options,include:ve.join("|")})},this.state={include:ie.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(ie){this.props.input!==ie.input&&this.initOptions()}initOptions(){const{input:ie,options:ve}=this.props,Re=ve.include?ve.include.split("|"):[],He=[],st={};for(const ot of ie)if(ot.refId){let yt=st[ot.refId];yt||(yt=st[ot.refId]={refId:ot.refId,count:0},He.push(yt)),yt.count++}if(Re.length){const ot=[],yt=[];for(const Et of He)Re.includes(Et.refId)&&yt.push(Et),ot.push(Et);this.setState({options:ot,selected:yt.map(Et=>Et.refId)})}else this.setState({options:He,selected:[]})}render(){const{options:ie,selected:ve}=this.state,{input:Re}=this.props;return(0,H.jsxs)(H.Fragment,{children:[Re.length<=1&&(0,H.jsx)("div",{children:(0,H.jsx)(To.P,{children:"Filter data by query expects multiple queries in the input."})}),(0,H.jsx)(J.I,{label:"Series refId",labelWidth:16,shrink:!0,children:(0,H.jsx)(La.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:ie.map((He,st)=>{const ot=`${He.refId}${He.count>1?" ("+He.count+")":""}`,yt=ve.indexOf(He.refId)>-1;return(0,H.jsx)(Xs.m,{onClick:()=>{this.onFieldToggle(He.refId)},label:ot,selected:yt},`${He.refId}/${st}`)})})})]})}}const xi={id:Q.F.filterByRefId,editor:Ri,transformation:ae.c.filterFramesByRefIdTransformer,name:ae.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([D.m.Filter]),help:ue(Q.F.filterByRefId).helperDocs};var Po=e(15400);const ri={settings:{width:30,filter:ce=>ce.type===se.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function Ei({input:ce,options:ie,onChange:ve}){const Re=(0,f.useCallback)(Et=>{ve({...ie,stringField:Et??""})},[ve,ie]),He=(0,f.useCallback)(Et=>{const Wt=Et.value??Po.gs.UpperCase;ve({...ie,outputFormat:Wt})},[ve,ie]),st=(0,f.useCallback)(Et=>{ve({...ie,substringStart:Et??0})},[ve,ie]),ot=(0,f.useCallback)(Et=>{ve({...ie,substringEnd:Et??0})},[ve,ie]),yt=Object.values(Po.gs).map(Et=>({label:Et,value:Et}));return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Field",labelWidth:10,children:(0,H.jsx)(eo.O,{context:{data:ce},value:ie.stringField??"",onChange:Re,item:ri})}),(0,H.jsx)(J.I,{label:"Format",labelWidth:10,children:(0,H.jsx)(Oe.l6,{options:yt,value:ie.outputFormat,onChange:He,width:20})})]}),ie.outputFormat===Po.gs.Substring&&(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Substring range",labelWidth:15,children:(0,H.jsx)(Za.Q,{min:0,value:ie.substringStart??0,onChange:st,width:7})}),(0,H.jsx)(J.I,{children:(0,H.jsx)(Za.Q,{min:0,value:ie.substringEnd??0,onChange:ot,width:7})})]})]})}const Zo={id:Q.F.formatString,editor:Ei,transformation:ae.c.formatStringTransformer,name:ae.c.formatStringTransformer.name,state:Pt.pn.beta,description:ae.c.formatStringTransformer.description,categories:new Set([D.m.Reformat])};function _t({input:ce,options:ie,onChange:ve}){const Re=[],He=(0,Ce.qt)(!0);for(const Et of ce)for(const Wt of Et.fields)if(Wt.type==="time"){const Zt=(0,_.Ct)(Wt,Et,ce);Re.push({label:Zt,value:Zt})}const st=(0,f.useCallback)(Et=>{const Wt=Et?.value!==void 0?Et.value:"";ve({...ie,timeField:Wt})},[ve,ie]),ot=(0,f.useCallback)(Et=>{const Wt=Et.target.value;ve({...ie,outputFormat:Wt})},[ve,ie]),yt=(0,f.useCallback)(Et=>{const Wt=Et?.value!==void 0?Et.value:"";ve({...ie,timezone:Wt})},[ve,ie]);return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Time Field",labelWidth:15,grow:!0,children:(0,H.jsx)(Oe.l6,{options:Re,value:ie.timeField,onChange:st,placeholder:"time",isClearable:!0})}),(0,H.jsx)(J.I,{label:"Format",labelWidth:10,tooltip:(0,H.jsxs)(H.Fragment,{children:["The output format for the field specified as a"," ",(0,H.jsx)("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer",children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,H.jsx)(qe.p,{onChange:ot,value:ie.outputFormat})}),(0,H.jsx)(J.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20,children:(0,H.jsx)(Oe.l6,{options:He,value:ie.timezone,onChange:yt,isClearable:!0})})]})})}const cn={id:Q.F.formatTime,editor:_t,transformation:ae.c.formatTimeTransformer,name:ae.c.formatTimeTransformer.name,state:Pt.pn.alpha,description:ae.c.formatTimeTransformer.description,help:ue(Q.F.formatTime).helperDocs};var kn=e(25094),Kn=e(67061),ns=e(42418);const Rs=({input:ce,options:ie,onChange:ve})=>{const Re=(0,Ce.ZI)(ce),He=(0,f.useCallback)(Et=>Wt=>{ve({...ie,fields:{...ie.fields,[Et]:Wt}})},[ve]);let st,ot=!1;for(const Et of Object.values(ie.fields))Et.aggregations.length>0&&Et.operation!==null&&(ot=!0),Et.operation===kn.R3.groupBy&&(st=!0);const yt=ot&&!st;return(0,H.jsxs)(Kn.B,{direction:"column",children:[yt&&(0,H.jsx)(ns.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),Re.map(Et=>(0,H.jsx)(ha,{onConfigChange:He(Et),fieldName:Et,config:ie.fields[Et]},Et))]})},Os=[{label:"Group by",value:kn.R3.groupBy},{label:"Calculate",value:kn.R3.aggregate}],ha=({fieldName:ce,config:ie,onConfigChange:ve})=>{const Re=(0,Lt.$j)(),He=na(Re),st=(0,f.useCallback)(ot=>{ve({aggregations:ie?.aggregations??[],operation:ot?.value??null})},[ie,ve]);return(0,H.jsx)(J.I,{className:He.label,label:ce,grow:!0,shrink:!0,children:(0,H.jsxs)(Kn.B,{gap:.5,direction:"row",children:[(0,H.jsx)("div",{className:He.operation,children:(0,H.jsx)(Oe.l6,{options:Os,value:ie?.operation,placeholder:"Ignored",onChange:st,isClearable:!0})}),ie?.operation===kn.R3.aggregate&&(0,H.jsx)(Dn.S,{className:He.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:ie.aggregations,onChange:ot=>{ve({...ie,aggregations:ot})}})]})})},na=ce=>({label:(0,Gt.css)`
      label {
        min-width: ${ce.spacing(32)};
      }
    `,operation:(0,Gt.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${ce.spacing(24)};
    `,aggregations:(0,Gt.css)`
      flex-grow: 1;
    `}),wa={id:Q.F.groupBy,editor:Rs,transformation:ae.c.groupByTransformer,name:ae.c.groupByTransformer.name,description:ae.c.groupByTransformer.description,categories:new Set([D.m.Combine,D.m.CalculateNewFields,D.m.Reformat]),help:ue(Q.F.groupBy).helperDocs};var pr=e(68133),Ma=e(88575);const ks=({input:ce,options:ie,onChange:ve})=>{const Re=(0,Ce.ZI)(ce),He=ie.showSubframeHeaders===void 0?pr.l:ie.showSubframeHeaders,st=(0,f.useCallback)(Zt=>xn=>{ve({...ie,fields:{...ie.fields,[Zt]:xn}})},[ve]),ot=(0,f.useCallback)(()=>{const Zt=ie.showSubframeHeaders===void 0?!pr.l:!ie.showSubframeHeaders;ve({showSubframeHeaders:Zt,fields:{...ie.fields}})},[ve]);let yt,Et=!1;for(const Zt of Object.values(ie.fields))Zt.aggregations.length>0&&Zt.operation!==null&&(Et=!0),Zt.operation===kn.R3.groupBy&&(yt=!0);const Wt=Et&&!yt;return(0,H.jsxs)(Kn.B,{direction:"column",children:[Wt&&(0,H.jsx)(ns.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),(0,H.jsx)("div",{children:Re.map(Zt=>(0,H.jsx)(go,{onConfigChange:st(Zt),fieldName:Zt,config:ie.fields[Zt]},Zt))}),(0,H.jsx)(Ma.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header",children:(0,H.jsx)(vs.d,{value:He,onChange:ot})})]})},oo=[{label:"Group by",value:kn.R3.groupBy},{label:"Calculate",value:kn.R3.aggregate}],go=({fieldName:ce,config:ie,onConfigChange:ve})=>{const Re=(0,Lt.$j)(),He=qr(Re),st=(0,f.useCallback)(ot=>{ve({aggregations:ie?.aggregations??[],operation:ot?.value??null})},[ie,ve]);return(0,H.jsx)(J.I,{className:He.label,label:ce,grow:!0,shrink:!0,children:(0,H.jsxs)(Kn.B,{gap:.5,direction:"row",wrap:!1,children:[(0,H.jsx)("div",{className:He.operation,children:(0,H.jsx)(Oe.l6,{options:oo,value:ie?.operation,placeholder:"Ignored",onChange:st,isClearable:!0})}),ie?.operation===kn.R3.aggregate&&(0,H.jsx)(Dn.S,{className:He.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:ie.aggregations,onChange:ot=>{ve({...ie,aggregations:ot})}})]})})},qr=ce=>({label:(0,Gt.css)({minWidth:ce.spacing(32)}),operation:(0,Gt.css)({flexShrink:0,height:"100%",width:ce.spacing(24)}),aggregations:(0,Gt.css)({flexGrow:1})}),po={id:Q.F.groupToNestedTable,editor:ks,transformation:ae.c.groupToNestedTable,name:ae.c.groupToNestedTable.name,description:ae.c.groupToNestedTable.description,categories:new Set([D.m.Combine,D.m.CalculateNewFields,D.m.Reformat]),state:Pt.pn.beta};var yo=e(81010);const hi=({input:ce,options:ie,onChange:ve})=>{const Re=(0,Ce.ZI)(ce).map(Zt=>({label:Zt,value:Zt})),He=(0,we.w)().getVariables().map(Zt=>({value:"$"+Zt.name,label:"$"+Zt.name})),st=(0,f.useCallback)(Zt=>{ve({...ie,columnField:Zt?.value})},[ve,ie]),ot=(0,f.useCallback)(Zt=>{ve({...ie,rowField:Zt?.value})},[ve,ie]),yt=(0,f.useCallback)(Zt=>{ve({...ie,valueField:Zt?.value})},[ve,ie]),Et=[{label:"Null",value:yo.N.Null,description:"Null value"},{label:"True",value:yo.N.True,description:"Boolean true value"},{label:"False",value:yo.N.False,description:"Boolean false value"},{label:"Empty",value:yo.N.Empty,description:"Empty string"}],Wt=(0,f.useCallback)(Zt=>{ve({...ie,emptyValue:Zt?.value})},[ve,ie]);return(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Column",labelWidth:8,children:(0,H.jsx)(Oe.l6,{options:[...Re,...He],value:ie.columnField,onChange:st,isClearable:!0})}),(0,H.jsx)(J.I,{label:"Row",labelWidth:8,children:(0,H.jsx)(Oe.l6,{options:[...Re,...He],value:ie.rowField,onChange:ot,isClearable:!0})}),(0,H.jsx)(J.I,{label:"Cell Value",labelWidth:10,children:(0,H.jsx)(Oe.l6,{options:[...Re,...He],value:ie.valueField,onChange:yt,isClearable:!0})}),(0,H.jsx)(J.I,{label:"Empty Value",children:(0,H.jsx)(Oe.l6,{options:Et,value:ie.emptyValue,onChange:Wt,isClearable:!0})})]})})},Di={id:Q.F.groupingToMatrix,editor:hi,transformation:ae.c.groupingToMatrixTransformer,name:ae.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([D.m.Combine,D.m.Reformat]),help:ue(Q.F.groupingToMatrix).helperDocs};var Rr=e(77678);const tr=({input:ce,options:ie,onChange:ve})=>{const[He,st]=(0,f.useState)({bucketCount:!(0,Ce.N_)(ie.bucketCount||""),bucketSize:!(0,Ce.N_)(ie.bucketSize||""),bucketOffset:!(0,Ce.N_)(ie.bucketOffset||"")}),ot=(0,f.useCallback)(En=>{ve({...ie,bucketCount:En})},[ve,ie]),yt=(0,f.useCallback)(En=>{ve({...ie,bucketSize:En})},[ve,ie]),Et=(0,f.useCallback)(En=>{ve({...ie,bucketOffset:En})},[ve,ie]),Wt=(0,f.useCallback)(En=>{st({...He,bucketCount:!(0,Ce.N_)(En)}),ve({...ie,bucketCount:Number(En)===0?void 0:Number(En)})},[ve,ie,He]),Zt=(0,f.useCallback)(En=>{st({...He,bucketSize:!(0,Ce.N_)(En)}),ve({...ie,bucketSize:En})},[ve,ie,He,st]),xn=(0,f.useCallback)(En=>{st({...He,bucketOffset:!(0,Ce.N_)(En)}),ve({...ie,bucketOffset:En})},[ve,ie,He,st]),In=(0,f.useCallback)(()=>{ve({...ie,combine:!ie.combine})},[ve,ie]),gn=(0,we.w)().getVariables().map(En=>({value:En.name,label:En.label||En.name,origin:Xe.$0.Template}));if(!te.$.featureToggles.transformationsVariableSupport){let En;typeof ie.bucketSize=="string"?En=parseInt(ie.bucketSize,10):En=ie.bucketSize;let Ss;return typeof ie.bucketOffset=="string"?Ss=parseInt(ie.bucketOffset,10):Ss=ie.bucketOffset,(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{labelWidth:18,label:Rr.Rt.bucketCount.name,tooltip:Rr.Rt.bucketCount.description,children:(0,H.jsx)(Za.Q,{value:ie.bucketCount,placeholder:"Default: 30",onChange:ot,min:0})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{labelWidth:18,label:Rr.Rt.bucketSize.name,tooltip:Rr.Rt.bucketSize.description,children:(0,H.jsx)(Za.Q,{value:En,placeholder:"auto",onChange:yt,min:0})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{labelWidth:18,label:Rr.Rt.bucketOffset.name,tooltip:Rr.Rt.bucketOffset.description,children:(0,H.jsx)(Za.Q,{value:Ss,placeholder:"none",onChange:Et,min:0})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{labelWidth:18,label:Rr.Rt.combine.name,tooltip:Rr.Rt.combine.description,children:(0,H.jsx)(vs.K,{value:ie.combine??!1,onChange:In})})})]})}return(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{invalid:He.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Rr.Rt.bucketCount.name,tooltip:Rr.Rt.bucketCount.description,children:(0,H.jsx)(We.y,{suggestions:gn,value:ie.bucketCount,placeholder:"Default: 30",onChange:Wt})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{invalid:He.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Rr.Rt.bucketSize.name,tooltip:Rr.Rt.bucketSize.description,children:(0,H.jsx)(We.y,{suggestions:gn,value:ie.bucketSize,placeholder:"auto",onChange:Zt})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{labelWidth:18,label:Rr.Rt.bucketOffset.name,tooltip:Rr.Rt.bucketOffset.description,invalid:He.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,H.jsx)(We.y,{suggestions:gn,value:ie.bucketOffset,placeholder:"none",onChange:xn})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{labelWidth:18,label:Rr.Rt.combine.name,tooltip:Rr.Rt.combine.description,children:(0,H.jsx)(vs.K,{value:ie.combine??!1,onChange:In})})})]})},Vr={id:Q.F.histogram,editor:tr,transformation:ae.c.histogramTransformer,name:ae.c.histogramTransformer.name,description:ae.c.histogramTransformer.description,categories:new Set([D.m.CreateNewVisualization]),help:ue(Q.F.histogram).helperDocs};var io=e(41511),ja=e(64278);const Xo=[{value:io.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:io.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:io.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function Ti({input:ce,options:ie,onChange:ve}){const Re=(0,ja.sE)(ce),He=(0,ja.m3)(Re),st=(0,we.w)().getVariables().map(Et=>({value:"$"+Et.name,label:"$"+Et.name})),ot=(0,f.useCallback)(Et=>{ve({...ie,byField:Et?.value})},[ve,ie]),yt=(0,f.useCallback)(Et=>{ve({...ie,mode:Et?.value})},[ve,ie]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Mode",labelWidth:8,grow:!0,children:(0,H.jsx)(Oe.l6,{options:Xo,value:ie.mode??io.W.outer,onChange:yt})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Field",labelWidth:8,grow:!0,children:(0,H.jsx)(Oe.l6,{options:[...He,...st],value:ie.byField,onChange:ot,placeholder:"time",isClearable:!0})})})]})}const Rt={id:Q.F.joinByField,aliasIds:[Q.F.seriesToColumns],editor:Ti,transformation:ae.c.joinByFieldTransformer,name:ae.c.joinByFieldTransformer.name,description:ae.c.joinByFieldTransformer.description,categories:new Set([D.m.Combine]),help:ue(Q.F.joinByField).helperDocs};var tn=e(6829);const Mn=[{value:tn.n.Columns,label:"Columns"},{value:tn.n.Rows,label:"Rows"}],zn=({input:ce,options:ie,onChange:ve})=>{const{labelNames:He,selected:st}=(0,f.useMemo)(()=>{let Et=[],Wt={};for(const xn of ce)for(const In of xn.fields)if(In.labels)for(const Sn of Object.keys(In.labels))Wt[Sn]||(Et.push({value:Sn,label:Sn}),Wt[Sn]=!0);const Zt=new Set(ie.keepLabels?.length?ie.keepLabels:Object.keys(Wt));return{labelNames:Et,selected:Zt}},[ie.keepLabels,ce]),ot=Et=>{ve({...ie,valueLabel:Et?.value})},yt=Et=>{if(st.has(Et)?st.delete(Et):st.add(Et),st.size===He.length||!st.size){const{keepLabels:Wt,...Zt}=ie;ve(Zt)}else ve({...ie,keepLabels:[...st]})};return(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Mode",labelWidth:20,children:(0,H.jsx)(ee.z,{options:Mn,value:ie.mode??tn.n.Columns,onChange:Et=>ve({...ie,mode:Et})})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Labels",labelWidth:20,children:(0,H.jsx)(Kn.B,{gap:1,wrap:"wrap",children:He.map((Et,Wt)=>{const Zt=Et.label;return(0,H.jsx)(Xs.m,{onClick:()=>yt(Zt),label:Zt,selected:st.has(Zt)},`${Zt}/${Wt}`)})})})}),ie.mode!==tn.n.Rows&&(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name",children:(0,H.jsx)(Oe.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:He,value:ie?.valueLabel,onChange:ot,className:"min-width-16"})})})]})},Es={id:Q.F.labelsToFields,editor:zn,transformation:ae.c.labelsToFieldsTransformer,name:ae.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([D.m.Reformat]),help:ue(Q.F.labelsToFields).helperDocs},Ts=({options:ce,onChange:ie})=>{const[ve,Re]=(0,f.useState)(!1),He=(0,f.useCallback)(Et=>{ie({...ce,limitField:Number(Et.currentTarget.value)})},[ie,ce]),st=(0,f.useCallback)(Et=>{Re(!(0,Ce.N_)(Et)),ie({...ce,limitField:Et})},[ie,ce]),yt=(0,we.w)().getVariables().map(Et=>({value:Et.name,label:Et.label||Et.name,origin:Xe.$0.Template}));return te.$.featureToggles.transformationsVariableSupport?(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(ge.C,{children:(0,H.jsx)(We.y,{invalid:ve,error:"Value needs to be an integer or a variable",value:String(ce.limitField),onChange:st,placeholder:"Value or variable",suggestions:yt})})}):(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Limit",labelWidth:8,children:(0,H.jsx)(qe.p,{placeholder:"Limit count",pattern:"[0-9]*",value:ce.limitField,onChange:He,width:25})})})})},qa={id:Q.F.limit,editor:Ts,transformation:ae.c.limitTransformer,name:ae.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([D.m.Filter]),help:ue(Q.F.limit).helperDocs},aa=({input:ce,options:ie,onChange:ve})=>ce.length<=1?(0,H.jsx)(To.P,{children:"Merge has no effect when applied on a single frame."}):null,ar={id:Q.F.merge,editor:aa,transformation:ae.c.mergeTransformer,name:ae.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([D.m.Combine]),help:ue(Q.F.merge).helperDocs};var Aa=e(82280),yr=e(94753);const Dr=({options:ce,input:ie,onChange:ve})=>{const{indexByName:Re,excludeByName:He,renameByName:st,includeByName:ot}=ce,yt=(0,Ce.ZI)(ie),Et=(0,f.useMemo)(()=>Co(yt,Re),[yt,Re]),Wt=ot&&Object.keys(ot).length>0?"include":"exclude",Zt=(0,f.useCallback)((gn,En)=>{ve({...ce,excludeByName:{...He,[gn]:En}})},[ve,ce,He]),xn=(0,f.useCallback)((gn,En)=>{const Ss={...ce,includeByName:{...ot,[gn]:!En}};ve(Ss)},[ve,ce,ot]),In=(0,f.useCallback)(gn=>{if(!gn||!gn.destination)return;const En=gn.source.index,Ss=gn.destination.index;En!==Ss&&ve({...ce,indexByName:Uo(yt,En,Ss)})},[ve,ce,yt]),Sn=(0,f.useCallback)((gn,En)=>{ve({...ce,renameByName:{...ce.renameByName,[gn]:En}})},[ve,ce]);return ie.length>1?(0,H.jsx)(To.P,{children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."}):(0,H.jsx)(bo.JY,{onDragEnd:In,children:(0,H.jsx)(bo.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:gn=>(0,H.jsxs)("div",{ref:gn.innerRef,...gn.droppableProps,children:[Et.map((En,Ss)=>{const Cr=ot&&En in ot?ot[En]:!1,Ur=Wt==="include"?Cr:!He[En],Nr=Wt==="include"?xn:Zt;return(0,H.jsx)(ao,{fieldName:En,renamedFieldName:st[En],index:Ss,onToggleVisibility:Nr,onRenameField:Sn,visible:Ur},En)}),gn.placeholder]})})})};Dr.displayName="OrganizeFieldsTransformerEditor";const ao=({fieldName:ce,renamedFieldName:ie,index:ve,visible:Re,onToggleVisibility:He,onRenameField:st})=>{const ot=(0,Lt.of)(Qr);return(0,H.jsx)(bo.sx,{draggableId:ce,index:ve,children:yt=>(0,H.jsxs)(de.a,{marginBottom:.5,display:"flex",gap:0,ref:yt.innerRef,...yt.draggableProps,children:[(0,H.jsx)(Dt.c,{width:60,as:"div",children:(0,H.jsxs)(Kn.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,H.jsx)("span",{...yt.dragHandleProps,children:(0,H.jsx)(Oo.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:ot.draggable})}),(0,H.jsx)(jo.K,{className:ot.toggle,size:"md",name:Re?"eye":"eye-slash",onClick:()=>He(ce,Re),tooltip:Re?"Disable":"Enable"}),(0,H.jsx)(yr.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:ce})]})}),(0,H.jsx)(qe.p,{defaultValue:ie||"",placeholder:`Rename ${ce}`,onBlur:Et=>st(ce,Et.currentTarget.value)})]})})};ao.displayName="DraggableFieldName";const Qr=ce=>({toggle:(0,Gt.css)({margin:ce.spacing(0,1),color:ce.colors.text.secondary}),draggable:(0,Gt.css)({opacity:.4,"&:hover":{color:ce.colors.text.maxContrast}})}),Uo=(ce,ie,ve)=>{const Re=Array.from(ce),[He]=Re.splice(ie,1);return Re.splice(ve,0,He),Re.reduce((st,ot,yt)=>(st[ot]=yt,st),{})},Co=(ce,ie={})=>{if(!ie||Object.keys(ie).length===0)return ce;const ve=(0,Aa.X)(ie);return ce.sort(ve)},lo={id:Q.F.organize,editor:Dr,transformation:ae.c.organizeFieldsTransformer,name:ae.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([D.m.ReorderAndRename]),help:ue(Q.F.organize).helperDocs};var xo=e(21128),Yr=e(13544);const zr=({options:ce,onChange:ie})=>{const ve=[{label:"Series to rows",value:xo.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:xo.rV.ReduceFields,description:"Collapse each field into a single value"}],Re=(0,f.useCallback)(ot=>{const yt=ot.value;ie({...ce,mode:yt,includeTimeField:yt===xo.rV.ReduceFields?!!ce.includeTimeField:!1})},[ie,ce]),He=(0,f.useCallback)(()=>{ie({...ce,includeTimeField:!ce.includeTimeField})},[ie,ce]),st=(0,f.useCallback)(()=>{ie({...ce,labelsToFields:!ce.labelsToFields})},[ie,ce]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{label:"Mode","data-testid":Yr.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,H.jsx)(Oe.l6,{options:ve,value:ve.find(ot=>ot.value===ce.mode)||ve[0],onChange:Re})}),(0,H.jsx)(J.I,{label:"Calculations","data-testid":Yr.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,H.jsx)(Dn.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:ce.reducers||[],onChange:ot=>{ie({...ce,reducers:ot})}})}),ce.mode===xo.rV.ReduceFields&&(0,H.jsx)(J.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time",children:(0,H.jsx)(vs.K,{id:"include-time-field",value:!!ce.includeTimeField,onChange:He})}),ce.mode!==xo.rV.ReduceFields&&(0,H.jsx)(J.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields",children:(0,H.jsx)(vs.K,{id:"labels-to-fields",value:!!ce.labelsToFields,onChange:st})})]})},qo={id:Q.F.reduce,editor:zr,transformation:ae.c.reduceTransformer,name:ae.c.reduceTransformer.name,description:ae.c.reduceTransformer.description,categories:new Set([D.m.CalculateNewFields]),help:ue(Q.F.reduce).helperDocs};class Mi extends f.PureComponent{constructor(ie){super(ie),this.handleRegexChange=ve=>{const Re=ve.currentTarget.value;let He=!0;if(Re)try{Re&&(0,Ho.dO)(Re)}catch{He=!1}this.setState(st=>({...st,regex:Re,isRegexValid:He}))},this.handleRenameChange=ve=>{const Re=ve.currentTarget.value;this.setState(He=>({...He,renamePattern:Re}))},this.handleRegexBlur=ve=>{const Re=ve.currentTarget.value;let He=!0;try{Re&&(0,Ho.dO)(Re)}catch{He=!1}this.setState({isRegexValid:He},()=>{He&&this.props.onChange({...this.props.options,regex:Re})})},this.handleRenameBlur=ve=>{const Re=ve.currentTarget.value;this.setState({renamePattern:Re},()=>this.props.onChange({...this.props.options,renamePattern:Re}))},this.state={regex:ie.options.regex,renamePattern:ie.options.renamePattern,isRegexValid:!0}}render(){const{regex:ie,renamePattern:ve,isRegexValid:Re}=this.state;return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{label:"Match",labelWidth:16,invalid:!Re,error:Re?void 0:"Invalid pattern",children:(0,H.jsx)(qe.p,{placeholder:"Regular expression pattern",value:ie||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,H.jsx)(J.I,{label:"Replace",labelWidth:16,children:(0,H.jsx)(qe.p,{placeholder:"Replacement pattern",value:ve||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const _i={id:Q.F.renameByRegex,editor:Mi,transformation:ae.c.renameByRegexTransformer,name:ae.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([D.m.ReorderAndRename]),help:ue(Q.F.renameByRegex).helperDocs},Hi=({input:ce,options:ie,onChange:ve})=>null,ft={id:Q.F.seriesToRows,editor:Hi,transformation:ae.c.seriesToRowsTransformer,name:ae.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([D.m.Combine,D.m.Reformat]),help:ue(Q.F.seriesToRows).helperDocs},hn=({input:ce,options:ie,onChange:ve})=>{const Re=(0,Ce.ZI)(ce).map(Et=>({label:Et,value:Et})),st=(0,we.w)().getVariables().map(Et=>({label:"$"+Et.name,value:"$"+Et.name})),ot=(0,f.useCallback)((Et,Wt)=>{ve({...ie,sort:[Wt]})},[ve,ie]),yt=ie.sort?.length?ie.sort:[{}];return(0,H.jsx)("div",{children:yt.map((Et,Wt)=>(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Field",labelWidth:10,grow:!0,children:(0,H.jsx)(Oe.l6,{options:te.$.featureToggles.transformationsVariableSupport?[...Re,...st]:Re,value:Et.field,placeholder:"Select field",onChange:Zt=>{ot(Wt,{...Et,field:Zt.value})}})}),(0,H.jsx)(J.I,{label:"Reverse",children:(0,H.jsx)(vs.K,{value:!!Et.desc,onChange:()=>{ot(Wt,{...Et,desc:!Et.desc})}})})]},`${Et.field}/${Wt}`))})},dn={id:Q.F.sortBy,editor:hn,transformation:ae.c.sortByTransformer,name:ae.c.sortByTransformer.name,description:ae.c.sortByTransformer.description,categories:new Set([D.m.ReorderAndRename]),help:ue(Q.F.sortBy).helperDocs};function _n({options:ce,onChange:ie}){const[ve,Re]=(0,f.useState)(ce),He=ss(),st=Yn(),ot=()=>{ve.push({path:""}),Re([...ve]),Wt()},yt=Zt=>{ve&&(ve.splice(Zt,1),Re([...ve]),Wt())},Et=(Zt,xn,In)=>{ve&&(In==="alias"?ve[xn].alias=Zt.currentTarget.value??"":ve[xn].path=Zt.currentTarget.value??"",Re([...ve]))},Wt=()=>{ie(ve)};return(0,H.jsxs)("ol",{className:(0,Gt.cx)(st.list),children:[ve&&ve.map((Zt,xn)=>(0,H.jsx)("li",{children:(0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{label:"Field",tooltip:He.field,grow:!0,children:(0,H.jsx)(qe.p,{onBlur:Wt,onChange:In=>Et(In,xn,"path"),value:Zt.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})}),(0,H.jsx)(J.I,{label:"Alias",tooltip:He.alias,children:(0,H.jsx)(qe.p,{width:12,value:Zt.alias,onBlur:Wt,onChange:In=>Et(In,xn,"alias")})}),(0,H.jsx)(J.I,{className:(0,Gt.cx)(st.removeIcon),children:(0,H.jsx)(jo.K,{onClick:()=>yt(xn),name:"trash-alt",tooltip:"Remove path"})})]})},xn)),(0,H.jsx)(J.I,{children:(0,H.jsx)(xe.$n,{icon:"plus",onClick:()=>ot(),variant:"secondary",children:"Add path"})})]})}const ss=()=>{const ce=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:(0,H.jsxs)("div",{children:["A valid path of an json object.",(0,H.jsx)("div",{children:(0,H.jsx)("strong",{children:"JSON Value:"})}),(0,H.jsx)("pre",{children:(0,H.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,H.jsx)("strong",{children:"Valid Paths:"}),ce.map((ie,ve)=>(0,H.jsxs)("p",{children:[(0,H.jsx)("code",{children:ie.path}),(0,H.jsx)("i",{children:ie.description})]},ve))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function Yn(){return{list:(0,Gt.css)`
      margin-left: 20px;
    `,removeIcon:(0,Gt.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var Bs=e(14236),Ns=(ce=>(ce.JSON="json",ce.KeyValues="kvp",ce.Auto="auto",ce))(Ns||{});const Ps={id:Ns.JSON,name:"JSON",description:"Parse JSON string",parse:ce=>JSON.parse(ce)};function za(ce){const ie=[];let ve="",Re="";const He={};for(let st=0;st<ce.length;st++){let ot=ce[st];ot===ve&&(ve="",ot=ce[++st]);const yt=ot==="\\";if(yt&&(ot=ce[++st]),yt||ve.length){ie.push(ot);continue}switch((ot==='"'||ot==="'")&&(ve=ot),ot){case":":case"=":ie.length&&(Re&&(He[Re]=""),Re=ie.join(""),ie.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:ie.length&&Re===""&&(He[ie.join("")]="",ie.length=0);case",":case";":case"&":case"{":case"}":if(ie.length){const Et=ie.join("");Re.length?(He[Re]=Et,Re=""):Re=Et,ie.length=0}break;default:ie.push(ot),st===ce.length-1&&Re===""&&ie.length&&(He[ie.join("")]="",ie.length=0)}}return Re.length&&(He[Re]=ie.join("")),He}const Pa={id:Ns.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:za},fa=[Ps,Pa],_a={id:Ns.Auto,name:"Auto",description:"parse new fields automatically",parse:ce=>{for(const ie of fa)try{const ve=ie.parse(ce);if(ve!=null)return ve}catch{}}},da=new Ue.O(()=>[...fa,_a]),ta={id:Q.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(ce,ie)=>ve=>ve.pipe((0,wt.T)(Re=>ta.transformer(ce,ie)(Re))),transformer:ce=>ie=>ie.map(ve=>Ba(ve,ce))};function Ba(ce,ie){if(!ie.source)return ce;const ve=(0,di.findField)(ce,ie.source);if(!ve)return ce;const Re=da.getIfExists(ie.format??Ns.Auto);if(!Re)throw new Error("unkonwn extractor");const He=ce.length,st=[],ot=new Map;for(let Et=0;Et<He;Et++){let Wt=ve.values[Et];if((0,v.isString)(Wt))try{Wt=Re.parse(Wt)}catch{Wt={}}if(Wt!=null){if(ie.format===Ns.JSON&&ie.jsonPaths&&ie.jsonPaths?.length>0){const Zt={},xn=ie.jsonPaths.filter(In=>In.path);xn.length>0&&(xn.forEach(In=>{const Sn=In.alias&&In.alias.length>0?In.alias:In.path;Zt[Sn]=(0,v.get)(Wt,In.path)??"Not Found"}),Wt=Zt)}for(const[Zt,xn]of Object.entries(Wt)){let In=ot.get(Zt);In==null&&(In=new Array(He).fill(void 0),ot.set(Zt,In),st.push(Zt)),In[Et]=xn}}}const yt=st.map(Et=>{const Wt=ot.get(Et),Zt={name:Et,values:Wt,type:Wt?(0,Bs.oE)(Wt.find(xn=>xn!=null)):se.PU.other,config:{}};return te.$.featureToggles.extractFieldsNameDeduplication&&(Zt.name=(0,_.fk)(Zt,ce)),Zt});if(ie.keepTime){const Et=(0,di.findField)(ce,"Time")||(0,di.findField)(ce,"time");Et&&yt.unshift(Et)}return ie.replace||yt.unshift(...ce.fields),{...ce,fields:yt}}const Ea={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},or=({input:ce,options:ie,onChange:ve})=>{const Re=Wt=>{ve({...ie,source:Wt})},He=Wt=>{ve({...ie,format:Wt?.value})},st=Wt=>{ve({...ie,jsonPaths:Wt})},ot=()=>{ie.replace&&(ie.keepTime=!1),ve({...ie,replace:!ie.replace})},yt=()=>{ve({...ie,keepTime:!ie.keepTime})},Et=da.selectOptions(ie.format?[ie.format]:void 0);return(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Source",labelWidth:16,children:(0,H.jsx)(eo.O,{context:{data:ce},value:ie.source??"",onChange:Re,item:Ea})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Format",labelWidth:16,children:(0,H.jsx)(Oe.l6,{value:Et.current[0],options:Et.options,onChange:He,width:24,placeholder:"Auto"})})}),ie.format==="json"&&(0,H.jsx)(_n,{options:ie.jsonPaths??[],onChange:st}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Replace all fields",labelWidth:16,children:(0,H.jsx)(vs.K,{value:ie.replace??!1,onChange:ot})})}),ie.replace&&(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Keep time",labelWidth:16,children:(0,H.jsx)(vs.K,{value:ie.keepTime??!1,onChange:yt})})})]})},co={id:Q.F.extractFields,editor:or,transformation:ta,name:ta.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([D.m.Reformat]),help:ue(Q.F.extractFields).helperDocs};var Mo=e(51986);const No={id:Q.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(ce,ie)=>ve=>ve.pipe((0,wt.T)(Re=>No.transformer(ce,ie)(Re))),transformer:ce=>ie=>!ie||!ie.length?ie:[ro(ce,ie)]};function ro(ce,ie){if(!ce.value?.length)return ki("No value labele configured");const ve=(0,Ce.aG)(ie);if(ve.size<1)return ki("No labels in result");if(!ve.has(ce.value))return ki("Value label not found");let Re=ce.join?.length?ce.join:Array.from(ve);Re=Re.filter(xn=>xn!==ce.value);const He=new Set,st=new Map,ot={};for(const xn of ie)for(const In of xn.fields)if(In.labels&&In.type!==se.PU.time){const Sn=Re.map(Nr=>In.labels[Nr]),gn=Sn.join(",");let En=st.get(gn);En||(En={keys:Sn,values:{}},st.set(gn,En));const Ss=In.labels[ce.value],Cr=In.values,Ur=En.values[Ss];Ur?En.values[Ss]=Ur.concat(Cr):En.values[Ss]=Cr,ot[Ss]||(ot[Ss]=In),He.add(Ss)}const yt=Array.from(He),Et=Re.map(()=>[]),Wt=yt.map(()=>[]);for(const xn of st.values()){let In=-1,Sn=!1;for(;!Sn;){In++,Sn=!0;for(let gn=0;gn<Re.length;gn++)Et[gn].push(xn.keys[gn]);for(let gn=0;gn<yt.length;gn++){const En=yt[gn],Ss=xn.values[En]??[];Wt[gn].push(Ss[In]),Ss.length>In+1&&(Sn=!1)}}}const Zt={fields:[],length:Wt[0].length};for(let xn=0;xn<Re.length;xn++)Zt.fields.push({name:Re[xn],config:{},type:se.PU.string,values:Et[xn]});for(let xn=0;xn<yt.length;xn++){const In=ot[yt[xn]];Zt.fields.push({name:yt[xn],config:{},type:In.type??se.PU.number,values:Wt[xn]})}return Zt}function ki(ce){return{meta:{notices:[{severity:"error",text:ce}]},fields:[{name:"Error",type:se.PU.string,config:{},values:[ce]}],length:0}}function Hl({input:ce,options:ie,onChange:ve}){const Re=(0,f.useMemo)(()=>{let Et;const Wt=(0,Ce.aG)(ce),Zt=Array.from(Wt).map(Ss=>({label:Ss,value:Ss}));let xn=Zt.find(Ss=>Ss.value===ie.value);!xn&&ie.value&&(xn={label:`${ie.value} (not found)`,value:ie.value},Zt.push(xn)),ce.length?Wt.size===0&&(Et=(0,H.jsx)(ns.F,{title:"No labels found",children:"The input does not contain any labels"})):Et=(0,H.jsx)(ns.F,{title:"No input found",children:"No input (or labels) found"}),Wt.delete(ie.value);const In=Array.from(Wt).map(Ss=>({label:Ss,value:Ss}));let Sn=In;const gn=!!ie.join?.length;let En="Join";return gn?Sn=In.filter(Ss=>!ie.join.includes(Ss.value)):En=In.map(Ss=>Ss.value).join(", "),{warn:Et,valueOptions:Zt,valueOption:xn,joinOptions:In,addOptions:Sn,addText:En,hasJoin:gn,key:Date.now()}},[ie,ce]),He=(Et,Wt)=>{if(!ie.join)return;const Zt=ie.join.slice();if(Wt)Zt[Et]=Wt;else if(Zt.splice(Et,1),!Zt.length){ve({...ie,join:void 0});return}const xn=new Set(Zt);ie.value&&xn.delete(ie.value),ve({...ie,join:Array.from(xn)})},st=Et=>{const Wt=Et?.value;if(!Wt)return;const Zt=ie.join?ie.join.slice():[];Zt.push(Wt),ve({...ie,join:Zt})},ot=10,yt="No labels found";return(0,H.jsxs)("div",{children:[Re.warn,(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{error:"required",invalid:!ie.value?.length,label:"Value",labelWidth:ot,tooltip:"Select the label indicating the values name",children:(0,H.jsx)(Oe.l6,{options:Re.valueOptions,value:Re.valueOption,onChange:Et=>ve({...ie,value:Et.value}),noOptionsMessage:yt})})}),Re.hasJoin?ie.join.map((Et,Wt)=>(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Join",labelWidth:ot,error:"Unable to join by the value label",invalid:Et===ie.value,children:(0,H.jsxs)(La.Gy,{children:[(0,H.jsx)(Oe.l6,{options:Re.joinOptions,value:Re.joinOptions.find(Zt=>Zt.value===Et),isClearable:!0,onChange:Zt=>He(Wt,Zt?.value),noOptionsMessage:yt}),!!(Re.addOptions.length&&Wt===ie.join.length-1)&&(0,H.jsx)(Mo.i,{icon:"plus",label:"",options:Re.addOptions,onChange:st,variant:"secondary"})]})})},Et+Wt)):(0,H.jsx)(H.Fragment,{children:!!Re.addOptions.length&&(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Join",labelWidth:ot,children:(0,H.jsx)(Oe.l6,{options:Re.addOptions,placeholder:Re.addText,onChange:st,noOptionsMessage:yt})})})})]})}const Gi={id:No.id,editor:Hl,transformation:No,name:No.name,description:No.description,state:Pt.pn.beta,categories:new Set([D.m.Combine]),help:ue(No.id).helperDocs};var bi=e(84350),Ui=e(69862),wo=e(65474),ul=e(67140);const hl={id:Q.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:ce=>ie=>ie.pipe((0,Ui.Z)(ve=>(0,wo.H)(lc(ve,ce))))};async function lc(ce,ie){const ve=ne.sJ.get(le.Ct.byName).get(ie?.lookupField),Re=await(0,ul.q3)(ie?.gazetteer??ul.fx);return Re.frame?fl(ce,Re,ve):Promise.reject("missing frame in gazetteer")}function fl(ce,ie,ve){const Re=ie.frame()?.fields;return Re?ce.map(He=>{const st=He.length,ot=[];for(const yt of He.fields)if(ot.push(yt),ve(yt,He,ce)){const Et=yt.values,Wt=[];for(const Zt of Re){const xn=new Array(st);Wt.push(xn),ot.push({...Zt,values:xn})}for(let Zt=0;Zt<ie.count;Zt++){const xn=ie.find(Et[Zt]);if(xn?.index!=null)for(let In=0;In<Re.length;In++)Wt[In][Zt]=Re[In].values[xn.index]}}return{...He,fields:ot}}):ce}const ol={settings:{width:30,filter:ce=>ce.type===se.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},Sl={settings:{}},Tl=({input:ce,options:ie,onChange:ve})=>{const Re=(0,f.useCallback)(st=>{ve({...ie,lookupField:st})},[ve,ie]),He=(0,f.useCallback)(st=>{ve({...ie,gazetteer:st})},[ve,ie]);return(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Field",labelWidth:12,children:(0,H.jsx)(eo.O,{context:{data:ce},value:ie?.lookupField??"",onChange:Re,item:ol})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Lookup",labelWidth:12,children:(0,H.jsx)(bi.G,{value:ie?.gazetteer??"",context:{data:ce},item:Sl,onChange:He})})})]})},kl={id:Q.F.fieldLookup,editor:Tl,transformation:hl,name:hl.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:Pt.pn.alpha,categories:new Set([D.m.PerformSpatialOperations]),help:ue(Q.F.fieldLookup).helperDocs};var Ml=e(35602),fi=e(64586);const gl=(ce,ie,ve=[])=>(ie===0?ve.push(ce):ce.forEach(Re=>{gl(Re,ie-1,ve)}),ve);function $e(ce){const ie=ce[0].length,ve=ce.length,Re=new Map;for(let He=0;He<ie;He++){let st=Re;for(let ot=0;ot<ve;ot++){let yt=ce[ot][He],Et=st.get(yt);Et==null&&(Et=ot===ve-1?[]:new Map,st.set(yt,Et)),st=Et}st.push(He)}return gl(Re,ve)}const Ye={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function rt(ce,ie,ve){return ie.map((Re,He)=>ce.withNames?`${Re}${ce.separator1}${ve[He]}`:ve[He]).join(ce.separator2)}function xt(ce,ie){const ve={};return ce.forEach((Re,He)=>{ve[Re]=String(ie[He])}),ve}const Kt={id:Q.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(ce,ie)=>ve=>ve.pipe((0,wt.T)(Re=>Kt.transformer(ce,ie)(Re))),transformer:(ce,ie)=>{const ve=(0,Ml.R)(ie,{names:ce.fields});if(!ve)return fi.W.transformer({},ie);const Re=(0,ne.NS)(ve);return He=>He.length?en(He[0],Re,ce):He}};function en(ce,ie,ve){const Re=ce.fields.filter(yt=>ie(yt,ce,[ce]));if(!Re.length)return[ce];const He=Re.map(yt=>yt.values),st=Re.map(yt=>yt.name),ot={...Ye,...ve?.naming};return $e(He).map(yt=>{let Et=ce.name,Wt={};if(ot.asLabels)Wt=xt(st,Re.map((xn,In)=>He[In][yt[0]]));else{let xn=rt(ot,st,Re.map((In,Sn)=>He[Sn][yt[0]]));ot?.append&&ce.name&&(xn=`${ce.name} ${xn}`),Et=xn}let Zt=ce.fields;if(!ve?.keepFields){const xn=new Set(st);Zt=ce.fields.filter(In=>!xn.has(In.name))}return{name:Et,meta:ce.meta,length:yt.length,fields:Zt.map(xn=>{const In=xn.values,Sn=Array(yt.length);for(let gn=0;gn<yt.length;gn++)Sn[gn]=In[yt[gn]];return{name:xn.name,type:xn.type,config:xn.config,labels:{...xn.labels,...Wt},values:Sn}})}})}function mn({input:ce,options:ie,onChange:ve}){const Re=(0,ja.sE)(ce),He=(0,ja.m3)(Re),st=(0,f.useMemo)(()=>{const In=new Set(ie.fields);return In.size<1?He:He.filter(Sn=>!In.has(Sn.value))},[He,ie]),ot=(0,f.useCallback)(In=>{if(!In.value)return;const Sn=new Set(ie.fields);Sn.add(In.value),ve({...ie,fields:[...Sn]})},[ve,ie]);let yt;(In=>{In[In.asLabels=0]="asLabels",In[In.frameName=1]="frameName"})(yt||(yt={}));const Et=[{label:"As label",value:0},{label:"As frame name",value:1}],Wt=[{label:"Yes",value:!0},{label:"No",value:!1}],Zt=(0,f.useCallback)(In=>{if(!In)return;const Sn=new Set(ie.fields);Sn.delete(In),ve({...ie,fields:[...Sn]})},[ve,ie]);if(ce.length>1)return(0,H.jsx)(To.P,{children:"Partition by values only works with a single frame."});const xn=[...new Set(ie.fields)];return(0,H.jsxs)("div",{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Field",labelWidth:10,grow:!0,children:(0,H.jsxs)(La.Gy,{children:[xn.map(In=>(0,H.jsx)(xe.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>Zt(In),children:In},In)),st.length&&(0,H.jsx)(Mo.i,{variant:"secondary",size:"md",options:st,onChange:ot,label:"Select field",icon:"plus"})]})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10,children:(0,H.jsx)(ee.z,{options:Et,value:ie.naming?.asLabels===void 0||ie.naming.asLabels?0:1,onChange:In=>ve({...ie,naming:{...ie.naming,asLabels:In===0}})})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16,children:(0,H.jsx)(ee.z,{options:Wt,value:ie.keepFields,onChange:In=>ve({...ie,keepFields:In})})})})]})}const jn={id:Q.F.partitionByValues,editor:mn,transformation:Kt,name:Kt.name,description:Kt.description,state:Pt.pn.alpha,categories:new Set([D.m.Reformat]),help:ue(Q.F.partitionByValues).helperDocs};var Vn=e(41260),qn=e(37471),Us=e(73060),Is=(ce=>(ce.TimeSeriesWide="wide",ce.TimeSeriesLong="long",ce.TimeSeriesMulti="multi",ce.TimeSeriesMany="many",ce))(Is||{});function $s(ce){if(!Array.isArray(ce)||ce.length===0)return ce;const ie=[];for(const ve of Vs(ce)){const Re=ve.fields[0];if(!Re||Re.type!==se.PU.time)continue;const He=[],st=[];for(const ot of ve.fields)switch(ot.type){case se.PU.number:case se.PU.boolean:He.push(ot);break;case se.PU.string:st.push(ot);break}for(const ot of He)if(st.length){const yt=new Map;for(let Et=0;Et<ve.length;Et++){const Wt=Re.values[Et],Zt=ot.values[Et];if(Zt===void 0||Wt==null)continue;const xn=st.map(Sn=>Sn.values[Et]).join("/");let In=yt.get(xn);if(!In){In={key:xn,time:[],value:[],labels:{}};for(const Sn of st)In.labels[Sn.name]=Sn.values[Et];yt.set(xn,In)}In.time.push(Wt),In.value.push(Zt)}for(const Et of yt.values())ie.push({name:ve.name,refId:ve.refId,meta:{...ve.meta,type:Vn.m.TimeSeriesMulti},fields:[{...Re,values:Et.time},{...ot,values:Et.value,labels:Et.labels}],length:Et.time.length})}else ie.push({name:ve.name,refId:ve.refId,meta:{...ve.meta,type:Vn.m.TimeSeriesMulti},fields:[Re,ot],length:ve.length})}return ie}function Vs(ce){if(!Array.isArray(ce)||ce.length===0)return ce;const ie=[];for(const ve of ce){let Re;const He=[],st={},ot={},yt={},Et={};for(let gn=0;gn<ve.fields.length;gn++){const En=ve.fields[gn];switch(En.type){case se.PU.string:case se.PU.boolean:En.name in Et||(Et[En.name]=gn,ot[En.name]=!0);break;case se.PU.time:if(!Re){Re=En;break}default:if(En.name in st){const Ur=st[En.name];if(En.type!==Ur)continue}else st[En.name]=En.type,He.push(En.name);const Ss=JSON.stringify(En.labels),Cr=yt[Ss];if(Cr!==void 0?Cr.push(gn):yt[Ss]=[gn],En.labels!=null)for(const Ur in En.labels)ot[Ur]=!0}}if(!Re)continue;const Wt=[],Zt=[],xn=[],In=[];for(let gn=0;gn<ve.length;gn++)Wt.push({time:Re.values[gn],wideRowIndex:gn});for(const gn in yt)Zt.push(gn);for(const gn in ot)xn.push(gn);for(const gn in Et)In.push(gn);Wt.sort((gn,En)=>gn.time-En.time),Zt.sort(),xn.sort(),He.sort();const Sn=new qn.k({...ve,meta:{...ve.meta,type:Vn.m.TimeSeriesLong},fields:[{name:Re.name,type:Re.type}]});for(const gn of He)Sn.addField({name:gn,type:st[gn]});for(const gn of xn)Sn.addField({name:gn,type:se.PU.string});for(const gn of Wt){const{time:En,wideRowIndex:Ss}=gn;for(const Cr of Zt){const Ur={};for(const ur of In)Ur[ur]=ve.fields[Et[ur]].values[Ss];let Nr=0;for(const ur of yt[Cr]){const Cl=ve.fields[ur];if(Nr++===0&&Cl.labels!=null)for(const ic in Cl.labels)Ur[ic]=Cl.labels[ic];Ur[Cl.name]=Cl.values[Ss]}Ur[Re.name]=En,Sn.add(Ur)}}ie.push(Sn)}return ie}function Ra(ce){return en(ce,ve=>ve.type===se.PU.string).map(ve=>(ve.meta||(ve.meta={}),ve.meta.type=Vn.m.TimeSeriesMulti,ve))}const ga={id:Q.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(ce,ie)=>ve=>ve.pipe((0,wt.T)(Re=>ga.transformer(ce,ie)(Re))),transformer:ce=>{const ie=ce?.format??"wide";if(ie==="many"||ie==="multi")return $s;if(ie==="long")return Vs;const ve=ne.sJ.get(le.Ct.firstTimeField).get({});return Re=>{if(!Re.length)return[];const He=[];for(const ot of Re)ot.meta?.type===Vn.m.TimeSeriesLong?Ra(ot).forEach(yt=>He.push(yt)):He.push(ot);const st=(0,Us.Fd)({frames:He,joinBy:ve,keepOriginIndices:!0});return st?(st.meta||(st.meta={}),st.meta.type=Vn.m.TimeSeriesWide,[st]):[]}}},Js={label:"Wide time series",value:Is.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,H.jsxs)("ul",{children:[(0,H.jsx)("li",{children:"Single frame"}),(0,H.jsx)("li",{children:"1st field is shared time field"}),(0,H.jsx)("li",{children:"Time in ascending order"}),(0,H.jsx)("li",{children:"Multiple value fields of any type"})]})},ia={label:"Multi-frame time series",value:Is.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,H.jsxs)("ul",{children:[(0,H.jsx)("li",{children:"Multiple frames"}),(0,H.jsx)("li",{children:"Each frame has two fields: time, value"}),(0,H.jsx)("li",{children:"Time in ascending order"}),(0,H.jsx)("li",{children:"String values are represented as labels"}),(0,H.jsx)("li",{children:"All values are numeric"})]})},Fa={label:"Long time series",value:Is.TimeSeriesLong,description:"Convert each frame to long format",info:(0,H.jsxs)("ul",{children:[(0,H.jsx)("li",{children:"Single frame"}),(0,H.jsx)("li",{children:"1st field is time field"}),(0,H.jsx)("li",{children:"Time in ascending order, but may have duplictes"}),(0,H.jsx)("li",{children:"String values are represented as separate fields rather than as labels"}),(0,H.jsx)("li",{children:"Multiple value fields may exist"})]})},Ya=[Js,ia,Fa];function ma(ce){const{options:ie,onChange:ve}=ce,Re=(0,Lt.of)(Wa),He=(0,f.useCallback)(st=>{ve({...ie,format:st.value})},[ve,ie]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Format",labelWidth:12,children:(0,H.jsx)(Oe.l6,{width:35,options:Ya,value:Ya.find(st=>st.value===Is.TimeSeriesMulti&&ie.format===Is.TimeSeriesMany?!0:st.value===ie.format)||Ya[0],onChange:He,className:"flex-grow-1"})})}),(0,H.jsx)(ge.C,{children:(0,H.jsx)(J.I,{label:"Info",labelWidth:12,children:(0,H.jsx)("div",{className:Re.info,children:(Ya.find(st=>st.value===ie.format)||Ya[0]).info})})})]})}const Wa=ce=>({info:(0,Gt.css)`
    margin-left: 20px;
  `}),Tr={id:ga.id,editor:ma,transformation:ga,name:ga.name,description:ga.description,categories:new Set([D.m.Reformat]),help:ue(ga.id).helperDocs};var Jr=e(66648),_r=e(48817),Mr=(ce=>(ce.linear="linear",ce.polynomial="polynomial",ce))(Mr||{});const Ka={predictionCount:100,modelType:"linear",degree:2},Vo={id:Q.F.regression,name:"Regression analysis",operator:(ce,ie)=>ve=>ve.pipe((0,wt.T)(Re=>Vo.transformer(ce,ie)(Re))),transformer:(ce,ie)=>ve=>{const{predictionCount:Re,modelType:He,degree:st}={...Ka,...ce};if(ve.length===0)return ve;const ot=ne.sJ.get(le.Ct.byName).get(ce.yFieldName),yt=ne.sJ.get(le.Ct.byName).get(ce.xFieldName);let Et,Wt,Zt;for(const ur of ve){const Cl=ur.fields.find(ic=>ot(ic,ur,ve));if(Cl){Wt=Cl;const ic=ur.fields.find(mm=>yt(mm,ur,ve));if(ic){Et=ic,Zt=ur;break}else throw"X and Y fields must be part of the same frame"}}if(!Et||!Wt)return ve;let xn=Et.values[0],In=Et.values[0];for(let ur=1;ur<Et.values.length;ur++)Et.values[ur]<xn&&(xn=Et.values[ur]),Et.values[ur]>In&&(In=Et.values[ur]);const Sn=(In-xn)/(Re-1),gn=[...[...Array(Re-1).keys()].map((ur,Cl)=>Cl*Sn+xn),In],En=Et.type===se.PU.time?xn:0,Ss=[],Cr=[];for(let ur=0;ur<Et.values.length;ur++)Wt.values[ur]!==null&&!isNaN(Wt.values[ur])&&(Cr.push(Et.values[ur]-En),Ss.push(Wt.values[ur]));let Ur;switch(He){case"linear":Ur=new _r.X(Cr,Ss);break;case"polynomial":Ur=new Jr.Y(Cr,Ss,st);break;default:return ve}const Nr={name:`${He} regression`,length:gn.length,fields:[{name:Et.name,type:Et.type,values:gn,config:{}},{name:`${(0,_.Ct)(Wt,Zt,ve)} predicted`,type:Wt.type,values:gn.map(ur=>Ur.predict(ur-En)),config:{}}]};return[...ve,Nr]}},ei={editor:eo.O,id:"",name:"",settings:{width:24,isClearable:!1}},to=20,Ao=({input:ce,options:ie,onChange:ve})=>{const Re=[{label:"Linear",value:Mr.linear},{label:"Polynomial",value:Mr.polynomial}];return(0,f.useEffect)(()=>{let He,st;if(!ie.xFieldName){const ot=ne.sJ.get(le.Ct.firstTimeField).get({});for(const yt of ce)if(He=yt.fields.find(Et=>ot(Et,yt,ce)),He)break;if(!He){const yt=ne.sJ.get(le.Ct.numeric).get({});for(const Et of ce)if(He=Et.fields.find(Wt=>yt(Wt,Et,ce)),He)break}}if(!ie.yFieldName){const ot=ne.sJ.get(le.Ct.numeric).get({});for(const yt of ce)if(st=yt.fields.find(Et=>ot(Et,yt,ce)&&Et!==He),st)break}He&&st&&ve({...ie,xFieldName:He.name,yFieldName:st.name})}),(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(J.I,{labelWidth:to,label:"X field",children:(0,H.jsx)(eo.O,{context:{data:ce},value:ie.xFieldName??"",item:ei,onChange:He=>{ve({...ie,xFieldName:He})}})}),(0,H.jsx)(J.I,{labelWidth:to,label:"Y field",children:(0,H.jsx)(eo.O,{context:{data:ce},value:ie.yFieldName??"",item:ei,onChange:He=>{ve({...ie,yFieldName:He})}})}),(0,H.jsx)(J.I,{labelWidth:to,label:"Model type",children:(0,H.jsx)(Oe.l6,{value:ie.modelType??Ka.modelType,onChange:He=>{ve({...ie,modelType:He.value??Ka.modelType})},options:Re})}),(0,H.jsx)(J.I,{labelWidth:to,label:"Predicted points",tooltip:"Number of X,Y points to predict",children:(0,H.jsx)(Za.Q,{value:ie.predictionCount??Ka.predictionCount,onChange:He=>{ve({...ie,predictionCount:He})}})}),ie.modelType===Mr.polynomial&&(0,H.jsx)(J.I,{labelWidth:to,label:"Degree",children:(0,H.jsx)(Oe.l6,{value:ie.degree??Ka.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:He=>{ve({...ie,degree:He.value})}})})]})},Oi={id:Q.F.regression,editor:Ao,transformation:Vo,name:Vo.name,description:Vo.description,categories:new Set([D.m.CalculateNewFields]),help:ue(Q.F.regression).helperDocs},zo={id:Q.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:ce=>ie=>ie.pipe((0,wt.T)(ve=>ve.map(Re=>ti(ce,Re))))};function ti(ce,ie){const ve=zt(ie,ce.mappings??[],!0),{nameField:Re,valueField:He}=ve;if(!Re||!He)return ie;const st=[];for(let ot=0;ot<Re.values.length;ot++){const yt=Re.values[ot],Et=He.values[ot],Wt=ht(ie,ot,ve),Zt=br(ie,ot,ve),xn={name:`${yt}`,type:He.type,values:[Et],config:Wt,labels:Zt};st.push(xn)}return{fields:st,length:1}}function br(ce,ie,ve){const Re={...ve.nameField.labels};for(let He=0;He<ce.fields.length;He++){const st=ce.fields[He],ot=(0,_.Ct)(st,ce),yt=ve.index[ot];if(yt.handler&&yt.handler.key!==St.Label)continue;const Et=st.values[ie];Et!=null&&(Re[ot]=Et)}return Re}function As({input:ce,options:ie,onChange:ve}){return ce.length===0?null:(0,H.jsx)("div",{children:(0,H.jsx)(wn,{frame:ce[0],mappings:ie.mappings??[],onChange:Re=>ve({...ie,mappings:Re}),withNameAndValue:!0})})}const ya={id:zo.id,editor:As,transformation:zo,name:zo.name,description:zo.description,state:Pt.pn.beta,categories:new Set([D.m.Reformat]),help:ue(zo.id).helperDocs};var ws=e(52622),Da=e(61983),jr=e(9581),Zr=e(96606),nt=e(31484),Le=e(78134);const et={id:Q.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:ce=>ie=>ie.pipe((0,Ui.Z)(ve=>(0,wo.H)(kt(ve,ce))))};function mt(ce){return ce.action===jr.dy.Modify&&ce.modify?.op===jr.YD.LineBuilder}async function kt(ce,ie){const ve=await(0,nt.nE)(ie.source);if(mt(ie)){const Re=await(0,nt.nE)(ie.modify?.target);return ce.map(He=>{const st=(0,nt.FM)(He,ve),ot=(0,nt.FM)(He,Re);if(st.field&&ot.field){const yt=[...He.fields],Et=(0,Zr.XR)(st.field,ot.field),Wt=yt[0];return Wt.type===se.PU.geo&&Wt!==st.field&&Wt!==ot.field?yt[0]=(0,Zr.RA)(Wt,Et):yt.unshift(Et),{...He,fields:yt}}return He})}return ce.map(Re=>{let He=(0,nt.FM)(Re,ve);if(He.field){if(ie.action===jr.dy.Modify){switch(ie.modify?.op){case jr.YD.AsLine:let ot=He.field.name;return(!ot||ot==="Point")&&(ot="Line"),{...Re,length:1,fields:[{...He.field,name:ot,type:se.PU.geo,values:[(0,Le.tt)(He.field)]}]}}return Re}const st=He.derived?[He.field,...Re.fields]:Re.fields.slice(0);if(ie.action===jr.dy.Calculate&&(st.push((0,Le.pp)(He.field,ie.calculate??{})),He.derived=!0),He.derived)return{...Re,fields:st}}return Re})}const yn=(ce,ie)=>{const ve=ie.options??{};ce.addSelect({path:"action",name:"Action",description:"",defaultValue:jr.dy.Prepare,settings:{options:[{value:jr.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:jr.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:jr.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),ve.action===jr.dy.Calculate?ce.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:jr.kD.Heading,settings:{options:[{value:jr.kD.Heading,label:"Heading"},{value:jr.kD.Area,label:"Area"},{value:jr.kD.Distance,label:"Distance"}]}}):ve.action===jr.dy.Modify&&ce.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:jr.YD.AsLine,settings:{options:[{value:jr.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:jr.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),mt(ve)?(ce.addNestedOptions({category:["Source"],path:"source",build:(Re,He)=>{const st=ve.source??{mode:ws.aG.Auto};(0,Da.G)("Point","",Re,st)}}),ce.addNestedOptions({category:["Target"],path:"modify",build:(Re,He)=>{const st=ve.modify?.target??{mode:ws.aG.Auto};(0,Da.G)("Point","target.",Re,st)}})):(0,Da.G)("Location","source.",ce,ve.source)},fn=ce=>{(0,f.useEffect)(()=>{if(!ce.options.source?.mode){const Re=Yt(yn);ce.onChange({...Re,...ce.options}),console.log("geometry useEffect",Re)}},[]);const ie=Cn((0,Lt.$j)()),ve=sn(ce,yn);return(0,H.jsxs)("div",{children:[(0,H.jsx)("div",{children:ve.items.map(Re=>Re.render())}),(0,H.jsx)("div",{children:ve.categories.map(Re=>(0,H.jsxs)("div",{className:ie.wrap,children:[(0,H.jsx)("h5",{children:Re.props.title}),(0,H.jsx)("div",{className:ie.item,children:Re.items.map(He=>He.render())})]},Re.props.id))})]})},Cn=ce=>({wrap:(0,Gt.css)`
      margin-bottom: 20px;
    `,item:(0,Gt.css)`
      border-left: 4px solid ${ce.colors.border.strong};
      padding-left: 10px;
    `}),as={id:Q.F.spatial,editor:fn,transformation:et,name:et.name,description:et.description,state:Pt.pn.alpha,categories:new Set([D.m.PerformSpatialOperations]),help:ue(Q.F.spatial).helperDocs};var ts=e(19845);const _s={id:Q.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:ce=>{for(const ie of ce)if((0,ts.aH)(ie))return yo.M.Applicable;return yo.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:ce=>ie=>ie.pipe((0,wt.T)(ve=>Fs(ce,ve)))};function Fs(ce,ie){const ve={},Re={},He=[];let st=Zs(ie);for(const ot of Object.keys(st)){const yt=ie.filter(Wt=>Wt.refId===ot);ve[ot]={},Re[ot]={};const Et=[];yt.forEach(Wt=>{Wt.fields.forEach(Zt=>{Zt.type===se.PU.number&&Zt.labels&&Object.keys(Zt.labels).forEach(xn=>{Et.includes(xn)||(Re[ot][xn]=Ha(xn,se.PU.string),Et.push(xn))})})});for(let Wt=0;Wt<yt.length;Wt++){const Zt=yt[Wt];let xn=null,In=ce[ot]?.timeField;if(In&&In.length>0?xn=Zt.fields.find(Sn=>Sn.name===In):xn=Zt.fields.find(Sn=>(0,ts.hF)(Sn)),!(0,ts.aH)(Zt)){He.push(Zt);continue}for(const Sn of Zt.fields){if(Sn.type!==se.PU.number)continue;const gn=ce[ot]?.stat??Nt.gy.lastNotNull,En=(0,Nt.Nw)({field:Sn,reducers:[gn]})[gn]??null,Ss=new qn.k;xn!==void 0&&(Ss.addField(xn),Ss.addField(Sn),ve[ot][`Trend #${ot}`]===void 0&&(ve[ot][`Trend #${ot}`]=Ha(`Trend #${ot}`,se.PU.frame)),ve[ot][`Trend #${ot}`].values.push({...Ss,value:En,length:Sn.values.length})),Et.forEach(Cr=>{Re[ot][Cr].values.push(Sn.labels?.[Cr]??"")})}}}for(const ot of Object.keys(st)){const yt={},Et=new qn.k;Et.refId=ot;const Wt=Re[ot];if(Wt!==void 0)for(const[xn,In]of Object.entries(Wt))yt[xn]===void 0&&(yt[xn]=In);for(const xn of Object.values(yt))Et.addField(xn);const Zt=ve[ot];for(const xn of Object.values(Zt))Et.addField(xn);Et.fields.length>0&&He.push(Et)}return He}function Ha(ce,ie){return{name:ce,type:ie,config:{},values:[]}}function Zs(ce){let ie={};for(const ve of ce)ve.refId!==void 0&&(ie[ve.refId]===void 0?ie[ve.refId]=1:ie[ve.refId]++);return ie}function Pr({input:ce,options:ie,onChange:ve}){const Re=Zs(ce),He=(0,f.useCallback)((yt,Et)=>{const Wt=Et?.value!==void 0?Et.value:"";ve({...ie,[yt]:{...ie[yt],timeField:Wt}})},[ve,ie]),st=(0,f.useCallback)((yt,Et)=>{const Wt=Et[0];Wt&&(0,Nt.Em)(Wt)&&ve({...ie,[yt]:{...ie[yt],stat:Wt}})},[ve,ie]);let ot=[];for(const yt of Object.keys(Re)){const Et={},Wt=[];for(const Zt of ce)if(Zt.refId===yt)for(const xn of Zt.fields)(0,ts.hF)(xn)&&(Et[xn.name]=xn);for(const Zt of Object.values(Et)){const{name:xn}=Zt;Wt.push({label:xn,value:xn})}ot.push((0,H.jsxs)(ge.C,{children:[(0,H.jsx)(J.I,{children:(0,H.jsx)(Dt.c,{children:`Trend #${yt}`})}),(0,H.jsx)(J.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used.",children:(0,H.jsx)(Oe.l6,{onChange:He.bind(null,yt),options:Wt,value:ie[yt]?.timeField,isClearable:!0})}),(0,H.jsx)(J.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series.",children:(0,H.jsx)(Dn.S,{stats:[ie[yt]?.stat??Nt.gy.lastNotNull],onChange:st.bind(null,yt),filterOptions:Zt=>Zt.id!==Nt.gy.allValues&&Zt.id!==Nt.gy.uniqueValues})})]},yt))}return(0,H.jsx)(H.Fragment,{children:ot})}const Or={id:_s.id,editor:Pr,transformation:_s,name:_s.name,description:_s.description,state:Pt.pn.beta,help:ue(_s.id).helperDocs},nr=()=>[qo,Jo,_i,xi,ke,lo,Rt,ft,ci,rr,Es,wa,dn,ar,Vr,ya,pn,Tr,Ai,as,kl,co,Ut,Di,qa,Gi,jn,...te.$.featureToggles.formatString?[Zo]:[],...te.$.featureToggles.regressionTransformation?[Oi]:[],...te.$.featureToggles.groupToNestedTableTransformation?[po]:[],cn,Or];var Xa=e(67278);function mr(){return new Xa.c(new URL(e.p+e.u(7887),e.b))}function no(){return[{id:"kusto",name:"kusto",init:mr}]}var ir=e(96712),Br=e(28138),il=e(70944),Gl=e(33919),yd=e(72798),Ro=e(69444);function pl({actions:ce,children:ie,info:ve,pageNav:Re,layout:He,renderTitle:st,subTitle:ot}){const yt=(0,f.useContext)(yd.A);return(0,H.jsx)(Ro.Y,{navModel:yt.sectionNav,pageNav:Re,layout:He,actions:ce,renderTitle:st,info:ve,subTitle:ot,children:(0,H.jsx)(Ro.Y.Contents,{children:ie})})}var cu=e(76888),ml=e(8867),Nh=e(91324),Qi=e(23227),du=e(83712),wh=e(93455),Fh=e(99443),oi=e(70699),Wh=e(63997),Kh=e(5798),Rc=e(61061),$h=e(85346),Lc=e(41731),Vh=e(36294),zh=e(62575),_h=e(27798),Hh=e(53392),kh=e(17694),xd=e(27743),uu=e(66509),Ep=e(98368),Gh=e(67341),cc=e(51472),Qh=e(90517),Yh=e(78412),Jh=e(24548),Zh=e(41366),Xh=e(63892),qh=e(53927),hu=e(22965),ef=e(19336),fu=e(66163),tf=e(30259),nf=e(96725),gu=e(30283),sf=e(53141),af=e(69382),rf=e(88790),ii=e(388),pu=e(58689),Ni=e(29342),dc=e(27583),Ql=e(34153),uc=e(13852),mu=e(5614),vu=e(34715),of=e(25853),lf=e(98020),yu=e(90088),cf=e(79764),xu=e(5422),Ed=e(61987),df=e(88225),Dd=e(13896),uf=e(68018),hf=e(63023),Dp=e(32437),Eu=e(99996),bp=e(99641),Du=e(70649),bu=e(98828),Pu=e(79151),vl=e(53663),hc=e(27193),li=e(53123),fc=e(4458),ff=e(28643),bd=e(33311),Cu=e(90841),gf=e(49018),pf=e(63738),mf=e(63263),vf=e(29340),Su=e(45937),Pd=e(29339),yf=e(6820),Ol=e(77444),yl=e(3327),xf=e(70794),jc=e(11273),Tu=e(80641),Ef=e(28867),Il=e(11220),Df=e(23544),Mu=e(48339),Cd=e(4240),gc=e(95224),qi=e(82382),wi=e(87048),bf=e(53007),Pf=e(12179),Cf=e(17226),Sd=e(42982),Al=e(42806),Ou=e(50459),Sf=e(84879),Tf=e(52664),Mf=e(26868),Of=e(72805),Iu=e(73575),Rl=e(56811),If=e(53896),Au=e(97918),Ru=e(81422),Af=e(29130),Lu=e(45376),Bc=e(73642),ju=e(83267),Rf=e(80021),Td=e(41684),Lf=e(72215),Pp=e(81656),jf=e(29424),Bu=e(7682),Ll=e(51764),Bf=e(76151),Md=e(30781),Yl=e(65972),Uc=e(90756),Uf=e(24289),Od=e(84472),pc=e(71533),Uu=e(45298),Cp=e(96906),Nf=e(95311),wf=e(82349),Ff=e(21101),Wf=e(49935),Nc=e(48761),Kf=e(97231),mc=e(13835),$f=e(91381),Vf=e(52859),zf=e(25928),_f=e(36714),Hf=e(30815),Nu=e(3465),Fi=e(39012),Wi=e(94675),xl=e(40051),Sp=e(4543),Tp=e(89579),wu=e(82524),Fu=e(31115),kf=e(99003),Wu=e(95684),Gf=e(1624),Ku=e(93644),Qf=e(96619),Yf=e(61748),Jf=e(57169),Zf=e(11769),$u=e(26551),Vu=e(40295),zu=e(38514),Id=e(81312),Xf=e(64298),qf=e(70866),eg=e(30587),tg=e(44850),_u=e(54556),ng=e(81615),Hu=e(82798),sg=e(8687),ag=e(77270),ku=e(10742),Gu=e(41404),rg=e(72579),og=e(39973),Qu=e(56963),ig=e(8807),vc=e(24109),Ad=e(46255),wc=e(68636),Fc=e(74305),Yu=e(21391);let jl=!1;function Bn(ce,ie){ml.cacheStore[ie]={content:ce,status:"loaded"}}function lg(){let ce="public/img/icons/";const ie=typeof window<"u"&&window.__grafana_public_path__;return ie&&(ce=ie+"img/icons/"),ve=>ce+ve}function Ju(){if(jl)return;jl=!0;const ce=lg();Bn(Nh,ce("unicons/at.svg")),Bn(Qi,ce("unicons/adjust-circle.svg")),Bn(du,ce("unicons/align-left.svg")),Bn(wh,ce("unicons/align-right.svg")),Bn(Fh,ce("unicons/angle-double-down.svg")),Bn(oi,ce("unicons/angle-double-right.svg")),Bn(Wh,ce("unicons/angle-down.svg")),Bn(Kh,ce("unicons/angle-left.svg")),Bn(Rc,ce("unicons/angle-right.svg")),Bn($h,ce("unicons/angle-up.svg")),Bn(Lc,ce("unicons/apps.svg")),Bn(Vh,ce("unicons/arrow.svg")),Bn(zh,ce("unicons/arrow-down.svg")),Bn(_h,ce("unicons/arrow-from-right.svg")),Bn(Hh,ce("unicons/arrow-left.svg")),Bn(kh,ce("unicons/arrow-random.svg")),Bn(xd,ce("unicons/arrow-right.svg")),Bn(uu,ce("unicons/arrow-to-right.svg")),Bn(Ep,ce("unicons/arrow-up.svg")),Bn(Gh,ce("unicons/arrows-h.svg")),Bn(cc,ce("unicons/backward.svg")),Bn(Qh,ce("unicons/bars.svg")),Bn(Yh,ce("unicons/bell.svg")),Bn(Jh,ce("unicons/bell-slash.svg")),Bn(Zh,ce("unicons/bolt.svg")),Bn(Xh,ce("unicons/book.svg")),Bn(qh,ce("unicons/bookmark.svg")),Bn(hu,ce("unicons/book-open.svg")),Bn(ef,ce("unicons/brackets-curly.svg")),Bn(fu,ce("unicons/bug.svg")),Bn(tf,ce("unicons/building.svg")),Bn(nf,ce("unicons/calculator-alt.svg")),Bn(gu,ce("unicons/calendar-alt.svg")),Bn(sf,ce("unicons/calendar-slash.svg")),Bn(af,ce("unicons/camera.svg")),Bn(rf,ce("unicons/channel-add.svg")),Bn(ii,ce("unicons/chart-line.svg")),Bn(pu,ce("unicons/check.svg")),Bn(Ni,ce("unicons/check-circle.svg")),Bn(dc,ce("unicons/circle.svg")),Bn(Ql,ce("unicons/clipboard-alt.svg")),Bn(uc,ce("unicons/clock-nine.svg")),Bn(mu,ce("unicons/cloud.svg")),Bn(vu,ce("unicons/cloud-download.svg")),Bn(of,ce("unicons/code-branch.svg")),Bn(lf,ce("unicons/cog.svg")),Bn(yu,ce("unicons/columns.svg")),Bn(cf,ce("unicons/comment-alt.svg")),Bn(xu,ce("unicons/comment-alt-share.svg")),Bn(Ed,ce("unicons/comments-alt.svg")),Bn(df,ce("unicons/compass.svg")),Bn(Dd,ce("unicons/copy.svg")),Bn(uf,ce("unicons/corner-down-right-alt.svg")),Bn(hf,ce("unicons/cube.svg")),Bn(Dp,ce("unicons/dashboard.svg")),Bn(Eu,ce("unicons/database.svg")),Bn(bp,ce("unicons/document-info.svg")),Bn(Du,ce("unicons/download-alt.svg")),Bn(bu,ce("unicons/draggabledots.svg")),Bn(Pu,ce("unicons/edit.svg")),Bn(vl,ce("unicons/ellipsis-v.svg")),Bn(hc,ce("unicons/ellipsis-h.svg")),Bn(li,ce("unicons/envelope.svg")),Bn(fc,ce("unicons/exchange-alt.svg")),Bn(ff,ce("unicons/exclamation-circle.svg")),Bn(bd,ce("unicons/exclamation-triangle.svg")),Bn(Cu,ce("unicons/external-link-alt.svg")),Bn(gf,ce("unicons/eye.svg")),Bn(pf,ce("unicons/eye-slash.svg")),Bn(mf,ce("unicons/file-alt.svg")),Bn(vf,ce("unicons/file-blank.svg")),Bn(Su,ce("unicons/filter.svg")),Bn(Pd,ce("unicons/folder.svg")),Bn(yf,ce("unicons/folder-open.svg")),Bn(Ol,ce("unicons/folder-plus.svg")),Bn(yl,ce("unicons/folder-upload.svg")),Bn(xf,ce("unicons/forward.svg")),Bn(jc,ce("unicons/graph-bar.svg")),Bn(Tu,ce("unicons/history.svg")),Bn(Ef,ce("unicons/history-alt.svg")),Bn(Il,ce("unicons/home-alt.svg")),Bn(Df,ce("unicons/import.svg")),Bn(Mu,ce("unicons/info.svg")),Bn(Cd,ce("unicons/info-circle.svg")),Bn(gc,ce("unicons/k6.svg")),Bn(qi,ce("unicons/key-skeleton-alt.svg")),Bn(wi,ce("unicons/keyboard.svg")),Bn(bf,ce("unicons/link.svg")),Bn(Pf,ce("unicons/list-ul.svg")),Bn(Cf,ce("unicons/lock.svg")),Bn(Sd,ce("unicons/minus.svg")),Bn(Al,ce("unicons/minus-circle.svg")),Bn(Ou,ce("unicons/mobile-android.svg")),Bn(Sf,ce("unicons/monitor.svg")),Bn(Tf,ce("unicons/pause.svg")),Bn(Mf,ce("unicons/pen.svg")),Bn(Of,ce("unicons/play.svg")),Bn(Iu,ce("unicons/plug.svg")),Bn(Rl,ce("unicons/plus.svg")),Bn(If,ce("unicons/plus-circle.svg")),Bn(Au,ce("unicons/power.svg")),Bn(Ru,ce("unicons/presentation-play.svg")),Bn(Af,ce("unicons/process.svg")),Bn(Lu,ce("unicons/question-circle.svg")),Bn(Bc,ce("unicons/repeat.svg")),Bn(ju,ce("unicons/rocket.svg")),Bn(Rf,ce("unicons/rss.svg")),Bn(Td,ce("unicons/save.svg")),Bn(Lf,ce("unicons/search.svg")),Bn(Pp,ce("unicons/search-minus.svg")),Bn(jf,ce("unicons/search-plus.svg")),Bn(Bu,ce("unicons/share-alt.svg")),Bn(Ll,ce("unicons/shield.svg")),Bn(Bf,ce("unicons/signal.svg")),Bn(Md,ce("unicons/signin.svg")),Bn(Yl,ce("unicons/signout.svg")),Bn(Uc,ce("unicons/sitemap.svg")),Bn(Uf,ce("unicons/slack.svg")),Bn(Od,ce("unicons/sliders-v-alt.svg")),Bn(pc,ce("unicons/sort-amount-down.svg")),Bn(Uu,ce("unicons/sort-amount-up.svg")),Bn(Cp,ce("unicons/square-shape.svg")),Bn(Nf,ce("unicons/star.svg")),Bn(wf,ce("unicons/step-backward.svg")),Bn(Ff,ce("unicons/sync.svg")),Bn(Wf,ce("unicons/stopwatch.svg")),Bn(Nc,ce("unicons/table.svg")),Bn(Kf,ce("unicons/tag-alt.svg")),Bn(mc,ce("unicons/times.svg")),Bn($f,ce("unicons/trash-alt.svg")),Bn(Vf,ce("unicons/unlock.svg")),Bn(zf,ce("unicons/upload.svg")),Bn(_f,ce("unicons/user.svg")),Bn(Hf,ce("unicons/users-alt.svg")),Bn(Nu,ce("unicons/wrap-text.svg")),Bn(Fi,ce("unicons/cloud-upload.svg")),Bn(Wi,ce("unicons/credit-card.svg")),Bn(xl,ce("unicons/file-copy-alt.svg")),Bn(Sp,ce("unicons/fire.svg")),Bn(Tp,ce("unicons/hourglass.svg")),Bn(wu,ce("unicons/layer-group.svg")),Bn(Fu,ce("unicons/layers-alt.svg")),Bn(kf,ce("unicons/line-alt.svg")),Bn(Wu,ce("unicons/list-ui-alt.svg")),Bn(Gf,ce("unicons/message.svg")),Bn(Ku,ce("unicons/palette.svg")),Bn(Qf,ce("unicons/percentage.svg")),Bn(Yf,ce("unicons/shield-exclamation.svg")),Bn(Jf,ce("unicons/plus-square.svg")),Bn(Zf,ce("unicons/x.svg")),Bn($u,ce("unicons/capture.svg")),Bn(Vu,ce("custom/gf-grid.svg")),Bn(zu,ce("custom/gf-landscape.svg")),Bn(Id,ce("custom/gf-layout-simple.svg")),Bn(Xf,ce("custom/gf-portrait.svg")),Bn(qf,ce("custom/gf-show-context.svg")),Bn(eg,ce("custom/gf-bar-alignment-after.svg")),Bn(tg,ce("custom/gf-bar-alignment-before.svg")),Bn(_u,ce("custom/gf-bar-alignment-center.svg")),Bn(ng,ce("custom/gf-interpolation-linear.svg")),Bn(Hu,ce("custom/gf-interpolation-smooth.svg")),Bn(sg,ce("custom/gf-interpolation-step-after.svg")),Bn(ag,ce("custom/gf-interpolation-step-before.svg")),Bn(ku,ce("custom/gf-logs.svg")),Bn(Gu,ce("custom/gf-movepane-left.svg")),Bn(rg,ce("custom/gf-movepane-right.svg")),Bn(og,ce("mono/favorite.svg")),Bn(Qu,ce("mono/grafana.svg")),Bn(ig,ce("mono/heart.svg")),Bn(vc,ce("mono/heart-break.svg")),Bn(Ad,ce("mono/panel-add.svg")),Bn(wc,ce("mono/library-panel.svg")),Bn(Fc,ce("unicons/record-audio.svg")),Bn(Yu,ce("solid/bookmark.svg"))}var El=e(8484);function Mp(){self.MonacoEnvironment={getWorker(ce,ie){const ve=P.l.getIfExists(ie);return ve?ve.init():ie==="json"?new Xa.c(new URL(e.p+e.u(1162),e.b)):ie==="css"||ie==="scss"||ie==="less"?new Xa.c(new URL(e.p+e.u(9044),e.b)):ie==="html"||ie==="handlebars"||ie==="razor"?new Xa.c(new URL(e.p+e.u(4064),e.b)):ie==="typescript"||ie==="javascript"?new Xa.c(new URL(e.p+e.u(2150),e.b)):new Xa.c(new URL(e.p+e.u(1821),e.b))}}}var yc=e(76885);function cg(ce){const ie=ce.target instanceof Element&&dg(ce.target);if(!(ce.ctrlKey||ce.metaKey||ce.defaultPrevented)&&ie){let ve=ie.getAttribute("href");const Re=ie.getAttribute("target");if(ve&&!Re){const He=yc.kM.parseKeyValue(ve.split("?")[1]),st=He.orgId&&Number(He.orgId)!==q.config.bootData.user.orgId;if((0,R.Lc)("utils",!1,"intercepting link click",ce),ce.preventDefault(),ve=C.I.stripBaseFromUrl(ve),ve[0]!=="/"||st)if(ve.indexOf("://")>0||ve.indexOf("mailto:")===0||st){window.location.href=ve;return}else if(ve.indexOf("#")===0){window.location.hash=ve;return}else ve=`/${ve}`;R.Ny.push(ve)}}}function dg(ce){for(;ce!==null&&ce.tagName;){if(ce.tagName.toUpperCase()==="A")return ce;ce=ce.parentElement}return null}var Zu=e(78731),Dl=e(14110);class Wc{constructor(ie){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=ie??1e3*60*5}start(){const ie=(0,Zu.oF)();ie&&ie.getConnectionState().subscribe(ve=>{ve&&this._checkForUpdates()}),R.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=R.Ny.getLocation().pathname}locationUpdated(ie){if(this.prevLocationPath===ie.pathname)return;const ve=ie.pathname.split("/");ve[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():ve[1]==="d"?this.reloadIfUpdateDetected():this.hasUpdates&&(0,Dl.rR)("new_frontend_assets_reload_ignored",{newLocation:ie.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=ie.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const ie=this.previous,ve=await(0,M.AI)().get("/api/frontend/assets");ie&&!(0,v.isEqual)(ie,ve)&&(this.hasUpdates=!0,(0,Dl.rR)("new_frontend_assets_detected",{assets:ie.assets!==ve.assets,plugins:ie.plugins!==ve.plugins,version:ie.version!==ve.version,flags:ie.flags!==ve.flags})),this.previous=ve}reloadIfUpdateDetected(){this.hasUpdates&&((0,Dl.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var Rd=e(27677),el=e(16233),Op=e(91040),Ip=e(40621);function Ld(ce,ie=!1){return new Promise(ve=>{const Re=document.createElement("script");Re.onload=ve,Re.src=ce,Re.async=ie,document.head.appendChild(Re)})}const ug=(0,Op.h)("EchoSrv"),Xu=ug.logger;(0,Ip.h)("echo",void 0,ug);class hg{constructor(ie){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const ve of this.backends)ve.flush()},this.addBackend=ve=>{Xu("Adding backend",!1,ve),this.backends.push(ve)},this.addEvent=(ve,Re)=>{const He=this.getMeta(),st={...ve,meta:{...He,...Re}};for(const ot of this.backends)(ot.supportedEvents.length===0||ot.supportedEvents.indexOf(st.type)>-1)&&ot.addEvent(st);Xu(`${ve.type} event`,!1,{...ve.payload,meta:st.meta})},this.getMeta=()=>({sessionId:"",userId:el.TP.user.id,userLogin:el.TP.user.login,userSignedIn:el.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...ie},setInterval(this.flush,this.config.flushInterval)}}var fg=e(42614);class qu{constructor(ie){this.options=ie,this.buffer=[],this.supportedEvents=[W.on.Performance],this.addEvent=ve=>{this.buffer.push(ve.payload)},this.flush=()=>{this.buffer.length!==0&&(Rd.IB.post("/api/frontend-metrics",{events:this.buffer},{showErrorAlert:!1}).catch(()=>{}),this.buffer=[])}}}var Bl=e(61298);class gg{constructor(ie){this.options=ie,this.supportedEvents=[W.on.Pageview,W.on.Interaction],this.addEvent=He=>{window.applicationInsights&&((0,Bl.nB)(He)&&window.applicationInsights.trackPageView?.(),(0,Bl.fX)(He)&&window.applicationInsights.trackEvent?.({name:He.payload.interactionName,properties:He.payload.properties}))},this.flush=()=>{};const ve={config:{connectionString:ie.connectionString,endpointUrl:ie.endpointUrl}};System.import("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(He=>He.default?He.default:He).then(({ApplicationInsights:He})=>{const st=new He(ve);window.applicationInsights=st.loadAppInsights()})}}class pg{constructor(ie){this.options=ie,this.supportedEvents=[W.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=He=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:He.payload.page})},this.flush=()=>{};const ve=`https://www.googletagmanager.com/gtag/js?id=${ie.googleAnalyticsId}`;Ld(ve,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const Re={page_path:window.location.pathname};ie.user&&(Re.user_id=ie.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=ie.googleAnalytics4SendManualPageViews,window.gtag("config",ie.googleAnalyticsId,Re)}}class mg{constructor(ie){this.options=ie,this.supportedEvents=[W.on.Pageview],this.trackedUserId=null,this.addEvent=He=>{if(!window.ga)return;window.ga("set",{page:He.payload.page}),window.ga("send","pageview");const{userSignedIn:st,userId:ot}=He.meta;st&&ot!==this.trackedUserId&&(this.trackedUserId=ot,window.ga("set","userId",ot))},this.flush=()=>{};const ve=`https://www.google-analytics.com/analytics${ie.debug?"_debug":""}.js`;Ld(ve);const Re=window.ga=window.ga||function(){(Re.q=Re.q||[]).push(arguments)};Re.l=+new Date,Re("create",ie.googleAnalyticsId,"auto"),Re("set","anonymizeIp",!0)}}class vg{constructor(ie){this.options=ie,this.supportedEvents=[W.on.Pageview,W.on.Interaction,W.on.ExperimentView],this.addEvent=st=>{window.rudderanalytics&&((0,Bl.nB)(st)&&window.rudderanalytics.page?.(),(0,Bl.fX)(st)&&window.rudderanalytics.track?.(st.payload.interactionName,st.payload.properties),(0,Bl.p6)(st)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:st.payload.experimentId,experiment_group:st.payload.experimentGroup,experiment_variant:st.payload.experimentVariant}))},this.flush=()=>{};const ve=ie.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";Ld(ve);const Re=window.rudderanalytics=[],He=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let st=0;st<He.length;st++){const ot=He[st];Re[ot]=function(yt){return function(){Re.push([yt].concat(Array.prototype.slice.call(arguments)))}}(ot)}if(window.rudderanalytics?.load?.(ie.writeKey,ie.dataPlaneUrl,{configUrl:ie.configUrl,destSDKBaseURL:ie.integrationsUrl}),ie.user){const{identifier:st,intercomIdentifier:ot}=ie.user.analytics,yt={};ot&&(yt.Intercom={user_hash:ot}),window.rudderanalytics?.identify?.(st,{email:ie.user.email,orgId:ie.user.orgId,language:ie.user.language,version:ie.buildInfo.version,edition:ie.buildInfo.edition},yt)}}}var eh=e(13515),jd=e(88285),Ul=e(74940),Jl=e(36043),Zl=e(19439),yg=e(68738),Kc=e(18024),th=e(54542),nh=e(20467);class xg extends nh.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=te.$.buildInfo.version}send(ie){(0,W.x$)().addEvent({type:W.on.GrafanaJavascriptAgent,payload:ie})}isBatched(){return!0}getIgnoreUrls(){return[]}}class Eg{constructor(ie){this.options=ie,this.supportedEvents=[W.on.GrafanaJavascriptAgent],this.addEvent=st=>{},this.flush=()=>{};const ve=[],Re=[new xg];ie.customEndpoint&&Re.push(new jd.m({url:ie.customEndpoint,apiKey:ie.apiKey})),ie.errorInstrumentalizationEnabled&&ve.push(new Ul.W),ie.consoleInstrumentalizationEnabled&&ve.push(new Jl._),ie.webVitalsInstrumentalizationEnabled&&ve.push(new Zl.I),ie.tracingInstrumentalizationEnabled&&ve.push(new th.v),ve.push(new yg.D);const He={globalObjectKey:ie.globalObjectKey||"faro",preventGlobalExposure:ie.preventGlobalExposure||!1,app:{name:"grafana-frontend",version:ie.buildInfo.version,environment:ie.buildInfo.env},instrumentations:ve,transports:Re,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],ignoreUrls:[new RegExp(`/*${ie.customEndpoint}/`),/frontend-metrics/],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:ie.internalLoggerLevel||eh.vI};this.faroInstance=(0,Kc.p)(He),ie.user&&this.faroInstance.api.setUser({id:ie.user.id,attributes:{orgId:String(ie.user.orgId)||""}})}}var $c=e(69129),sh=e(26272),gi=e(87490),ah=e(70497),Ap=e(1702),Ki=e(74856),Ii=e(28444),Dg=e(93522),Vc=e(10096),zc=e(4898),rh=e(2769);class bg{constructor(ie,ve){this.locationService=ie,this.chromeService=ve,this.panelId=null,Br.A.subscribe($c.Tp,Re=>{this.panelId=Re.payload.panelId})}clearAndInitGlobalBindings(ie){zc.R.reset(),ie.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,rh.O)(!1)),this.bind("c r",()=>(0,rh.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const ve=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(ve&&ve instanceof HTMLElement&&(ve.nodeName==="INPUT"||ve.nodeName==="TEXTAREA"||ve.hasAttribute("data-slate-editor"))){ve.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){Br.A.publish(new Ii.S8({component:Dg.N}))}exit(){const ie=this.locationService.getSearchObject();if(ie.editview){this.locationService.partial({editview:null,editIndex:null});return}if(ie.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(ie.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(ie.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:ve}=this.chromeService.state.getValue();ve&&this.chromeService.exitKioskMode(),ie.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(ie,ve){zc.R.bind(ie,Re=>{Re.preventDefault(),Re.stopPropagation(),Re.returnValue=!1,ve.call(this)},"keydown")}bindGlobal(ie,ve){zc.R.bindGlobal(ie,Re=>{Re.preventDefault(),Re.stopPropagation(),Re.returnValue=!1,ve.call(this)},"keydown")}unbind(ie,ve){zc.R.unbind(ie,ve)}bindWithPanelId(ie,ve){this.bind(ie,this.withFocusedPanel(ve))}withFocusedPanel(ie){return()=>{if(typeof this.panelId=="number"){ie(this.panelId);return}}}setupTimeRangeBindings(ie=!0){this.bind("t a",()=>{Br.A.publish(new Ii.Rh({updateUrl:ie}))}),this.bind("t z",()=>{Br.A.publish(new Ii.U0({scale:2,updateUrl:ie}))}),this.bind("ctrl+z",()=>{Br.A.publish(new Ii.U0({scale:2,updateUrl:ie}))}),this.bind("t left",()=>{Br.A.publish(new Ii.Io({direction:Ii.xL.Left,updateUrl:ie}))}),this.bind("t right",()=>{Br.A.publish(new Ii.Io({direction:Ii.xL.Right,updateUrl:ie}))}),this.bind("t c",()=>{Br.A.publish(new Ii.Bt)}),this.bind("t v",()=>{Br.A.publish(new Ii.VZ({updateUrl:ie}))})}setupDashboardBindings(ie){this.bind("mod+o",()=>{ie.graphTooltip=(ie.graphTooltip+1)%3,ie.events.publish(new sh.Tq),ie.startRefresh()}),this.bind("mod+s",()=>{ie.meta.canSave&&Br.A.publish(new Ii.S8({component:ah.$,props:{dashboard:ie}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",ve=>{if(ie.canEditPanelById(ve)){const Re=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:Re?null:ve})}}),this.bindWithPanelId("v",ve=>{const Re=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:Re?null:ve})}),this.bindWithPanelId("p l",ve=>{const Re=ie.getPanelById(ve),He={...Re.options};He.legend.showLegend?He.legend.showLegend=!1:He.legend.showLegend=!0,Re.updateOptions(He)}),this.bindWithPanelId("i",ve=>{this.locationService.partial({inspect:ve})}),Vc.contextSrv.hasAccessToExplore()&&this.bindWithPanelId("p x",async ve=>{const Re=ie.getPanelById(ve),He=await(0,gi.Xe)({queries:Re.targets,dsRef:Re.datasource,scopedVars:Re.scopedVars,timeRange:(0,Ki.jG)().timeRange()});if(He){const st=C.I.stripBaseFromUrl(He);st&&this.locationService.push(st)}}),this.bindWithPanelId("p r",ve=>{ie.canEditPanelById(ve)&&!(ie.panelInView||ie.panelInEdit)&&Br.A.publish(new Ii.Vz(ve))}),this.bindWithPanelId("p d",ve=>{if(ie.canEditPanelById(ve)){const Re=ie.getPanelInfoById(ve).index;ie.duplicatePanel(ie.panels[Re])}}),this.bindWithPanelId("p s",ve=>{const Re=ie.getPanelInfoById(ve);Br.A.publish(new Ii.S8({component:Ap.ShareModal,props:{dashboard:ie,panel:Re?.panel}}))}),this.bind("d l",()=>{ie.toggleLegendsForAll()}),this.bind("d x",()=>{ie.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{ie.collapseRows()}),this.bind("d shift+e",()=>{ie.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{ie.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const Re=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+Re})}}var xc=e(78160);async function Rp(){if(window.location.search.indexOf("why-render")!==-1){const{default:ce}=await e.e(3718).then(e.t.bind(e,13718,23));ce(React,{trackAllPureComponents:!0})}}var Nl=e(20120),oh=e(75471),Pg=e(57220);const Cg=(0,f.lazy)(()=>e.e(192).then(e.bind(e,57029)));function Sg(){const ce=(0,oh.Wd)(Pg.hY),ie=te.$.unifiedAlertingEnabled;el.TP.hasPermission(ce.read)&&(0,Nl.fP)({show:()=>ie,component:({dashboard:ve})=>ie?(0,H.jsx)(f.Suspense,{fallback:null,children:ve&&(0,H.jsx)(Cg,{dashboardUid:ve.uid})},"alert-rules-button"):null,index:-2})}var Tg=e(73399);function ih(ce){return(0,H.jsx)(Bd,{...ce})}const Bd=(0,f.lazy)(async()=>{const{EmbeddedDashboard:ce}=await e.e(2859).then(e.bind(e,13251));return{default:ce}});var lh=e(61582),Mg=e(67027),Og=e(97527),Lp=e(99355),Ec=e(14590),Ig=e(19895),Ag=e(44838);const Rg=()=>new Xa.c(new URL(e.p+e.u(5358),e.b));var Lg=e(88483),_c=e(63720);const jg=ce=>new Lg.c(ie=>{const ve=ce.subscribe(Ec.BX(Re=>{ie.next(Re)}),Ec.BX(Re=>{ie.error(Re)}),Ec.BX(()=>{ie.complete()}));return{unsubscribe:()=>{ve.then(Re=>Re.unsubscribe())}}}),Xl=ce=>(0,wo.H)(ce).pipe((0,_c.n)(ie=>jg(ie)));class Ud{constructor(ie){this.getConnectionState=()=>Xl(this.centrifugeWorker.getConnectionState()),this.getDataStream=ve=>Xl(this.centrifugeWorker.getDataStream(ve)).pipe((0,Ig.Q)(Ag.E)),this.getQueryData=async ve=>{const Re=JSON.parse(JSON.stringify(ve));return this.centrifugeWorker.getQueryData(Re)},this.getPresence=ve=>this.centrifugeWorker.getPresence(ve),this.getStream=ve=>Xl(this.centrifugeWorker.getStream(ve)),this.centrifugeWorker=Ec.LV(Rg()),this.centrifugeWorker.initialize(ie,Ec.BX(ie.dataStreamSubscriberReadiness))}}var Hc=e(9631),Bg=e(55004),Nd=e(47773),ch=e(26657),kc=e(47118);class Gc{constructor(ie){this.deps=ie,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=ve=>{let Re;const He=st=>{const ot=st.data[0];if(!Re&&!(0,kc.ot)(ot,kc._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${ot?.type}`);return}switch(ot.type){case kc._w.FullFrame:{Re=Hc.k9.deserialize(ot.frame);return}case kc._w.NewValuesSameSchema:{Re.pushNewValues(ot.values);return}}};return this.deps.centrifugeSrv.getDataStream(ve).pipe((0,wt.T)(st=>(He(st),{...st,data:[Re??Hc.k9.empty()]})))},this.getStream=ve=>this.deps.centrifugeSrv.getStream(ve),this.getQueryData=ve=>(0,wo.H)(this.deps.centrifugeSrv.getQueryData(ve)).pipe((0,_c.n)(Re=>{const He=(0,Nd.bE)(Re,ve.request.targets);return He.data?.length&&He.data.find(ot=>ot.meta?.channel)?(0,ch.x7)(He,ve.request,ch.ph):(0,Qn.of)(He)})),this.publish=async(ve,Re)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,Bg.Qp)(ve),data:Re}),this.getPresence=ve=>this.deps.centrifugeSrv.getPresence(ve)}}function Qc(){const ce={appUrl:`${window.location.origin}${te.$.appSubUrl}`,orgId:el.TP.user.orgId,orgRole:el.TP.user.orgRole,liveEnabled:te.$.liveEnabled,dataStreamSubscriberReadiness:lh.a.ok.asObservable(),grafanaAuthToken:(0,Mg.r)()},ie=te.$.featureToggles["live-service-web-worker"]?new Ud(ce):new Og.w(ce);(0,Zu.S8)(new Gc({centrifugeSrv:ie,backendSrv:(0,M.AI)()}))}function Dc(){return getGrafanaLiveSrv()}var dh=e(17888),Ug=e(20726),Yc=e(74135),mo=e(99140),bc=e(31678),Eo=e(75462),Ng=e(29436),uh=e(23994),wg=e(11140),hh=e(12881);function Fg(){try{return[(0,Eo.io)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",extensionPointId:Yc.S.ExploreToolbarAction,icon:"apps",category:"Dashboards",configure:()=>{if(Vc.contextSrv.hasPermission(bc.AccessControlAction.DashboardsCreate)||Vc.contextSrv.hasPermission(bc.AccessControlAction.DashboardsWrite))return{}},onClick:(ce,{context:ie,openModal:ve})=>{ve({title:(0,hh.t)(),body:({onDismiss:Re})=>(0,H.jsx)(wg.v,{onClose:Re,exploreId:ie?.exploreId})})}}),(0,Eo.io)({title:"Add correlation",description:"Create a correlation from this query",extensionPointId:Yc.S.ExploreToolbarAction,icon:"link",configure:ce=>ce?.shouldShowAddCorrelation?{}:void 0,onClick:(ce,{context:ie})=>{(0,mo.JD)((0,Ng.am)({editorMode:!0})),(0,mo.JD)((0,uh.Od)({exploreId:ie.exploreId}))}})]}catch(ce){return(0,Eo.FF)(`Could not configure extensions for Explore due to: "${ce}"`),[]}}function wd(){return[...Fg()]}function jp(ce,ie="extension is not a link extension"){if(!isPluginExtensionLink(ce))throw new Error(ie)}function Bp(ce,ie="extension is not a command extension config"){if(!isPluginExtensionLinkConfig(ce))throw new Error(ie)}function fh(ce,ie){if(!Fp(ce,ie))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${ce}/" (currently: "${ie}"). Skipping the extension.`)}function gh(ce){if(!zp(ce))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function Up(ce,ie){if(!Wp(ce,ie))throw new Error(`Invalid extension "${ie.title}". The extensionPointId should start with either "grafana/", "plugins/" or "capabilities/${ce}" (currently: "${ie.extensionPointId}"). Skipping the extension.`)}function Np(ce){if(!Kp(ce))throw new Error(`Invalid extension "${ce.title}". The "configure" property must be a function. Skipping the extension.`)}function Wg(ce,ie){for(const ve of ie)if(!$p(ce[ve]))throw new Error(`Invalid extension "${ce.title}". Property "${ve}" must be a string and cannot be empty. Skipping the extension.`)}function wp(ce,ie="The provided value is a Promise."){if(Kg(ce))throw new Error(ie)}function Fp(ce,ie){return!!(typeof ie=="string"&&ie.length>0&&ie.startsWith(`/a/${ce}/`))}function Wp(ce,ie){return!!(ie.extensionPointId?.startsWith("grafana/")||ie.extensionPointId?.startsWith("plugins/")||ie.extensionPointId?.startsWith(`capabilities/${ce}/`))}function Kp(ce){return ce.configure?typeof ce.configure=="function":!0}function $p(ce){return typeof ce=="string"&&ce.length>0}function Vp(ce,ie){try{if(Wg(ie,["title","description","extensionPointId"]),Up(ce,ie),(0,Eo.z1)(ie)){if(Np(ie),!ie.path&&!ie.onClick)return(0,Eo.FF)(`Invalid extension "${ie.title}". Either "path" or "onClick" is required.`),!1;ie.path&&fh(ce,ie.path)}return(0,Eo.yS)(ie)&&gh(ie.component),!0}catch(ve){return ve instanceof Error&&(0,Eo.FF)(ve.message),!1}}function Kg(ce){return ce instanceof Promise||typeof ce=="object"&&ce!==null&&"then"in ce&&"catch"in ce}function zp(ce){const ie=Re=>typeof Re=="object"&&Re!==null&&"$$typeof"in Re;return typeof ce=="function"||(Re=>ie(Re)&&Re.$$typeof===Symbol.for("react.memo"))(ce)}function _p(ce){let ie={id:"",extensions:{}};return ce.asObservable().subscribe(ve=>{ie=ve}),ve=>$g({...ve,registry:ie})}const $g=({context:ce,extensionPointId:ie,limitPerPlugin:ve,registry:Re})=>{const He=ce?(0,Eo.$Y)(ce):{},st=Re.extensions[ie]??[],ot=[],yt={};for(const Et of st)try{const Wt=Et.config,{pluginId:Zt}=Et;if(ve&&yt[Zt]>=ve)continue;if(yt[Zt]===void 0&&(yt[Zt]=0),(0,Eo.z1)(Wt)){const xn=Hp(Zt,Wt,He);if(Wt.configure&&xn===void 0)continue;const In=xn?.path||Wt.path,Sn={id:(0,Eo.yt)(Zt,Wt),type:Yc.u.link,pluginId:Zt,onClick:ph(Zt,Wt,He),icon:xn?.icon||Wt.icon,title:xn?.title||Wt.title,description:xn?.description||Wt.description,path:(0,v.isString)(In)?Jc(Zt,In,Wt):void 0,category:xn?.category||Wt.category};ot.push(Sn),yt[Zt]+=1}if((0,Eo.yS)(Wt)){gh(Wt.component);const xn={id:(0,Eo.yt)(Et.pluginId,Wt),type:Yc.u.component,pluginId:Et.pluginId,title:Wt.title,description:Wt.description,component:(0,Eo.nv)(Zt,Wt.component)};ot.push(xn),yt[Zt]+=1}}catch(Wt){Wt instanceof Error&&(0,Eo.FF)(Wt.message)}return{extensions:ot}};function Hp(ce,ie,ve){try{const Re=ie.configure?.(ve);if(Re===void 0)return;let{title:He=ie.title,description:st=ie.description,path:ot=ie.path,icon:yt=ie.icon,category:Et=ie.category,...Wt}=Re;return wp(Re,`The configure() function for "${ie.title}" returned a promise, skipping updates.`),ot&&fh(ce,ot),Wg({title:He,description:st},["title","description"]),Object.keys(Wt).length>0&&(0,Eo.FF)(`Extension "${ie.title}", is trying to override restricted properties: ${Object.keys(Wt).join(", ")} which will be ignored.`),{title:He,description:st,path:ot,icon:yt,category:Et}}catch(Re){Re instanceof Error&&(0,Eo.FF)(Re.message);return}}function ph(ce,ie,ve){const{onClick:Re}=ie;if(Re)return function(st){try{(0,Dl.rR)("ui_extension_link_clicked",{pluginId:ce,extensionPointId:ie.extensionPointId,title:ie.title,category:ie.category});const ot=Re(st,(0,Eo.yb)(ce,ve));Kg(ot)&&ot.catch(yt=>{yt instanceof Error&&(0,Eo.FF)(yt.message)})}catch(ot){ot instanceof Error&&(0,Eo.FF)(ot.message)}}}function Jc(ce,ie,ve){return yc.kM.appendQueryToUrl(ie,yc.kM.toUrlParams({uel_pid:ce,uel_epid:ve.extensionPointId}))}var Zc=e(13752),Vg=e(39741),mh=e(29405),Pc=e(96222),vh=e(72985),wl=e(62938);class Xc{constructor(){this.resultSubject=new Zc.B,this.registrySubject=new Vg.m(1),this.resultSubject.pipe((0,mh.S)(Fd,{id:"",extensions:{}}),(0,Pc.Z)({id:"",extensions:{}}),(0,wt.T)(ie=>(0,Eo.ol)(ie))).subscribe(this.registrySubject)}register(ie){this.resultSubject.next(ie)}asObservable(){return this.registrySubject.asObservable()}getRegistry(){return(0,vh._)(this.asObservable())}}function Fd(ce,ie){const{pluginId:ve,extensionConfigs:Re,error:He}=ie;if(He)return(0,Eo.FF)(`"${ve}" plugin failed to load, skip registering its extensions.`),ce;for(const st of Re){const{extensionPointId:ot}=st;if((0,Eo.WW)(st)){const Wt=/capabilities\/([a-zA-Z0-9_.\-\/]+)$/.exec(ot);if(!Wt){(0,Eo.FF)(`"${ve}" plugin has an invalid capability ID: ${ot.replace("capabilities/","")} (It must be a string)`);continue}st.extensionPointId=`capabilities/${Wt[1]}`}if(!st||!Vp(ve,st))return ce;let yt={config:st,pluginId:ve};(0,Eo.WW)(st)?ce.extensions[ot]=[yt]:Array.isArray(ce.extensions[ot])?ce.extensions[ot].push(yt):ce.extensions[ot]=[yt]}return ce.id=(0,wl.A)(),ce}var qc=e(24120);function Yi(ce){const ie=ce.asObservable();return function(Re){const He=(0,qc.A)(ie);return(0,f.useMemo)(()=>{if(!He)return{isLoading:!1,component:null};const st=`capabilities/${Re}`,ot=He.extensions[st],yt=Array.isArray(ot)?ot[0]:null;return yt&&(0,Eo.yS)(yt.config)?{isLoading:!1,component:(0,Eo.nv)(yt.pluginId,yt.config.component)}:{isLoading:!1,component:null}},[Re,He])}}function zg(ce){const ie=ce.asObservable(),ve={id:"",extensions:{}};return function(He){const st=(0,qc.A)(ie);if(!st)return{extensions:[],isLoading:!1};st.id!==ve.id&&(ve.id=st.id,ve.extensions={});const ot=`${He.extensionPointId}-${He.limitPerPlugin}`;if(ve.extensions[ot]&&ve.extensions[ot].context===He.context)return{extensions:ve.extensions[ot].extensions,isLoading:!1};const{extensions:yt}=$g({...He,registry:st});return ve.extensions[ot]={context:He.context,extensions:yt},{extensions:yt,isLoading:!1}}}var Cc=e(15162),Wd=e(27716),yh=e(685);async function Kd(ce=[],ie,ve="frontend_plugins_preload"){(0,xc.j)(ve);const Re=ce.filter(st=>st.preload).map(st=>ed(st)),He=await Promise.all(Re);for(const st of He)ie.register(st);(0,xc.z)(ve)}async function ed(ce){const{path:ie,version:ve,id:Re}=ce;try{(0,xc.j)(`frontend_plugin_preload_${Re}`);const{plugin:He}=await yh.j4({path:ie,version:ve,isAngular:ce.angular.detected,pluginId:Re}),{extensionConfigs:st=[]}=He;return(0,Wd.x)(Re),{pluginId:Re,extensionConfigs:st}}catch(He){return console.error(`[Plugins] Failed to preload plugin: ${ie} (version: ${ve})`,He),{pluginId:Re,extensionConfigs:[],error:He}}finally{(0,xc.z)(`frontend_plugin_preload_${Re}`)}}var $d=e(57532),td=e(41987),Vd=e(65879),ni=e(39070),_g=e(80924),Hg=e(72955),ql=e(39374);class kg{constructor(){this.subject=new Vg.m(1)}get(){return this.subject.asObservable()}run(ie){const{queries:ve,timezone:Re,datasource:He,panelId:st,app:ot,dashboardUID:yt,timeRange:Et,timeInfo:Wt,cacheTimeout:Zt,queryCachingTTL:xn,maxDataPoints:In,scopedVars:Sn,minInterval:gn}=ie;this.subscription&&this.subscription.unsubscribe();const En={app:ot??td.Jk.Unknown,requestId:(0,_g.S)(),timezone:Re,panelId:st,dashboardUID:yt,range:Et,timeInfo:Wt,interval:"",intervalMs:0,targets:(0,v.cloneDeep)(ve),maxDataPoints:In,scopedVars:Sn||{},cacheTimeout:Zt,queryCachingTTL:xn,startTime:Date.now()};En.rangeRaw=Et.raw,(0,wo.H)(Gg(He,En.scopedVars)).pipe((0,$d.$)()).subscribe({next:Ss=>{En.targets=En.targets.map(Nr=>(Nr.datasource||(Nr.datasource=Ss.getRef()),Nr));const Cr=gn?(0,we.w)().replace(gn,En.scopedVars):Ss.interval,Ur=Vd.calculateInterval(Et,In,Cr);En.scopedVars=Object.assign({},En.scopedVars,{__interval:{text:Ur.interval,value:Ur.interval},__interval_ms:{text:Ur.intervalMs.toString(),value:Ur.intervalMs}}),En.interval=Ur.interval,En.intervalMs=Ur.intervalMs,this.subscription=(0,ql.BN)(Ss,En).subscribe({next:Nr=>{const ur=(0,Bs.N$)(Nr,this.lastResult);this.lastResult=(0,Hg.B)(ur,this.lastResult),this.subject.next(this.lastResult)}})},error:Ss=>console.error("PanelQueryRunner Error",Ss)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===ni.Gu.Loading&&this.subject.next({...this.lastResult,state:ni.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function Gg(ce,ie){return ce&&"query"in ce?ce:(0,d.tR)().get(ce,ie)}function Qg(){window.grafanaRuntime={getDashboardSaveModel:()=>{const ce=(0,a.UA)().getCurrent();if(ce)return ce.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const ce=(0,Ki.jG)().timeRange();return{from:ce.from.valueOf(),to:ce.to.valueOf(),raw:ce.raw}},getPanelData:()=>{const ce=(0,a.UA)().getCurrent();if(ce)return ce.panels.reduce((ie,ve)=>(ie[ve.id]=ve.getQueryRunner().getLastResult(),ie),{})}}}var Yg=e(16757),ec=e(20601),Sa=e(75096),nd=e(71468),Jg=e(22391),zd=e(27803),bl=e(3843);function Zg(ce){return ce.extended&&"infoText"in ce.extended?ce.extended:null}function Xg(ce){return ce.extended&&"dataSourceTypes"in ce.extended?ce.extended:null}function _d(ce){return ce.extended&&"dataSource"in ce.extended?ce.extended:null}var Hr=e(87421),tc=e(26260);const xh=(ce,ie)=>{const{rootStateKey:ve}=ie.variable;if(!ve)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:Zg(bl.nS)};const{editor:Re}=(0,Hr.nx)(ve,ce);return{extended:Zg(Re)}},kp={changeVariableDatasource:tc.Iv},qg=(0,nd.connect)(xh,kp);class Sc extends f.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=ie=>{this.props.changeVariableDatasource((0,Sa.jX)(this.props.variable),(0,Jg.p$)(ie))}}componentDidMount(){const{rootStateKey:ie}=this.props.variable;if(!ie){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:ie,extended:ve}=this.props;return(0,H.jsx)(zd.Q,{datasource:ie.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:ve?.infoText})}}const Eh=qg(Sc);var Hd=e(38401),sd=e(83684);const Dh=90,Fl=({datasource:ce,onChange:ie,disabled:ve,filterKey:Re,allFilters:He})=>{const st=()=>Tc(ce,Re,He),ot=()=>Pl(ce,Re,He);return Re===null?(0,H.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,H.jsx)(sd.s,{disabled:ve,className:"query-segment-key",Component:nc,value:Re,onChange:ie,loadOptions:st,inputMinWidth:Dh})}):(0,H.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,H.jsx)(sd.s,{disabled:ve,className:"query-segment-key",value:Re,onChange:ie,loadOptions:ot,inputMinWidth:Dh})})},ad="-- remove filter --",ep={label:ad,value:ad},nc=(0,H.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,H.jsx)(Oo.I,{name:"plus"})}),Tc=async(ce,ie,ve)=>{const Re=await(0,d.tR)().get(ce);if(!Re||!Re.getTagKeys)return[];const He=ve.filter(yt=>yt.key!==ie),st=await Re.getTagKeys({filters:He});return(Array.isArray(st)?st:st.data).map(yt=>({label:yt.text,value:yt.text}))},Pl=async(ce,ie,ve)=>{const Re=await Tc(ce,ie,ve);return[ep,...Re]},ll=({datasource:ce,disabled:ie,onChange:ve,filterKey:Re,filterValue:He,placeHolder:st,allFilters:ot})=>{const yt=(0,Lt.of)(Mc),Et=()=>rd(ce,Re,ot);return(0,H.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,H.jsx)(sd.s,{className:yt.segment,disabled:ie,placeholder:st,value:He,onChange:ve,loadOptions:Et})})},rd=async(ce,ie,ve)=>{const Re=await(0,d.tR)().get(ce);if(!Re||!Re.getTagValues)return[];const He=(0,Ki.jG)().timeRange(),st=ve.filter(Et=>Et.key!==ie),ot=await Re.getTagValues({key:ie,filters:st,timeRange:He});return(Array.isArray(ot)?ot:ot.data).map(Et=>({label:Et.text,value:Et.text}))};function Mc(){return{segment:(0,Gt.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const Gp=["=","!=","<",">","=~","!~"].map(ce=>({label:ce,value:ce})),bh=({value:ce,disabled:ie,onChange:ve})=>(0,H.jsx)(Hd.Y,{className:"query-segment-operator",value:ce,disabled:ie,options:Gp,onChange:ve}),Ph=({datasource:ce,filter:{key:ie,operator:ve,value:Re},onKeyChange:He,onOperatorChange:st,onValueChange:ot,placeHolder:yt,allFilters:Et,disabled:Wt})=>(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Fl,{disabled:Wt,datasource:ce,filterKey:ie,onChange:He,allFilters:Et}),(0,H.jsx)("div",{className:"gf-form",children:(0,H.jsx)(bh,{disabled:Wt,value:ve,onChange:st})}),(0,H.jsx)(ll,{disabled:Wt,datasource:ce,filterKey:ie,filterValue:Re,allFilters:Et,onChange:ot,placeHolder:yt})]}),Ch=({datasource:ce,appendBefore:ie,onCompleted:ve,allFilters:Re})=>{const[He,st]=(0,f.useState)(null),[ot,yt]=(0,f.useState)("="),Et=(0,f.useCallback)(xn=>{if(xn.value!==ad){st(xn.value??"");return}st(null)},[st]),Wt=(0,f.useCallback)(xn=>yt(xn.value??""),[yt]),Zt=(0,f.useCallback)(xn=>{ve({value:xn.value??"",operator:ot,key:He}),st(null),yt("=")},[ve,ot,He]);return He===null?(0,H.jsx)(Fl,{datasource:ce,filterKey:He,onChange:Et,allFilters:Re}):(0,H.jsxs)(f.Fragment,{children:[ie,(0,H.jsx)(Ph,{datasource:ce,filter:{key:He,value:"",operator:ot},placeHolder:(0,El.t)("variable.adhoc.placeholder","Select value"),onKeyChange:Et,onOperatorChange:Wt,onValueChange:Zt,allFilters:Re})]},"filter-builder")},Wl=({label:ce})=>(0,H.jsx)("div",{className:"gf-form",children:(0,H.jsx)("span",{className:"gf-form-label query-keyword",children:ce})});class sc extends f.PureComponent{constructor(){super(...arguments),this.onChange=(ie,ve)=>Re=>{const{filters:He}=this.props,{value:st}=Re;return Re.value===ad?this.props.removeFilter(ie):this.props.changeFilter(ie,{...He[ie],[ve]:st})},this.appendFilterToVariable=ie=>{this.props.addFilter(ie)}}render(){const{filters:ie,disabled:ve}=this.props;return(0,H.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(ie,ve),!ve&&(0,H.jsx)(Ch,{datasource:this.props.datasource,appendBefore:ie.length>0?(0,H.jsx)(Wl,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(ie,ve){return ie.length===0&&ve?(0,H.jsx)(Hd.Y,{disabled:ve,value:"No filters",options:[],onChange:()=>{}}):ie.reduce((Re,He,st)=>(Re.length>0&&Re.push((0,H.jsx)(Wl,{label:"AND"},`condition-${st}`)),Re.push(this.renderFilterSegments(He,st,ve)),Re),[])}renderFilterSegments(ie,ve,Re){return(0,H.jsx)(f.Fragment,{children:(0,H.jsx)(Ph,{disabled:Re,datasource:this.props.datasource,filter:ie,onKeyChange:this.onChange(ve,"key"),onOperatorChange:this.onChange(ve,"operator"),onValueChange:this.onChange(ve,"value"),allFilters:this.getAllFilters()})},`filter-${ve}`)}}const kd={addFilter:tc.U2,removeFilter:tc.VT,changeFilter:tc.$u},Sh=(0,nd.connect)(null,kd);class od extends f.PureComponent{constructor(){super(...arguments),this.addFilter=ie=>{this.props.addFilter((0,Sa.jX)(this.props.variable),ie)},this.removeFilter=ie=>{this.props.removeFilter((0,Sa.jX)(this.props.variable),ie)},this.changeFilter=(ie,ve)=>{this.props.changeFilter((0,Sa.jX)(this.props.variable),{index:ie,filter:ve})}}render(){const{filters:ie,datasource:ve,baseFilters:Re}=this.props.variable;return(0,H.jsx)(sc,{datasource:ve,filters:ie,baseFilters:Re,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const Gd=Sh(od);Gd.displayName="AdHocPicker";var Th=e(53699);const cl=ce=>ce.map(ie=>Qd(ie).map(ld).join("|")),id=ce=>{if((0,v.isArray)(ce))return ce.map(Yd).filter(Mh);const ie=Yd(ce);return ie===null?[]:[ie]};function ld(ce){return ce==null?"":/\|/g[Symbol.replace](ce,"__gfp__")}function tp(ce){return ce==null?"":/__gfp__/g[Symbol.replace](ce,"|")}function Qd(ce){return[ce.key,ce.operator,ce.value]}function Yd(ce){if(!(0,v.isString)(ce)||ce.length===0)return null;const ie=ce.split("|").map(tp);return{key:ie[0],operator:ie[1],value:ie[2]}}function Mh(ce){return ce!==null&&(0,v.isString)(ce.value)}const cd=async()=>{},dd=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:Th.MK,reducer:Th.AA,picker:Gd,editor:Eh,dependsOn:()=>!1,setValue:cd,setValueFromUrl:async(ce,ie)=>{const ve=id(ie);await(0,mo.JD)((0,tc.D4)((0,Sa.jX)(ce),ve))},updateOptions:cd,getSaveModel:ce=>{const{index:ie,id:ve,state:Re,global:He,rootStateKey:st,...ot}=(0,v.cloneDeep)(ce);return ot},getValueForUrl:ce=>{const ie=ce?.filters??[];return cl(ie)}});var np=e(14644),$i=e(8866),Fo=e(13344),ko=e(24240),Jd=e(13288),Zd=e(44240),Kl=e(16126),Xd=e(38975),tl=e(67791),qd=e(66847),sp=e(69850),Wo=e(72401),so=e(48594),ac=e(65307),pi=e(12470),rc=e(83370),oc=e(80484);const eu={...oc.Vg,type:"query",datasource:null,query:"",regex:"",sort:pi.ZG.disabled,refresh:pi.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},Li=(ce,ie)=>{if(ie===pi.ZG.disabled)return ce;const ve=Math.ceil(ie/2),Re=ie%2===0;return ve===1?ce=(0,v.sortBy)(ce,"text"):ve===2?ce=(0,v.sortBy)(ce,He=>{if(!He.text)return-1;const st=He.text.match(/.*?(\d+).*/);return!st||st.length<2?-1:parseInt(st[1],10)}):ve===3?ce=(0,v.sortBy)(ce,He=>(0,v.toLower)(He.text)):ve===4&&ce.sort((He,st)=>He.text?st.text?He.text.localeCompare(st.text,void 0,{numeric:!0}):1:-1),Re&&(ce=ce.reverse()),ce},ap=(ce,ie)=>{const ve=[];let Re=null;ie.lastIndex=0;do Re=ie.exec(ce),Re&&ve.push(Re);while(ie.global&&Re&&Re[0]!==""&&Re[0]!==void 0);return ve},Oh=(ce,ie,ve)=>{let Re,He=[];ce&&(Re=(0,Ho.dO)(ce));for(let st=0;st<ve.length;st++){const ot=ve[st];let yt=ot.text===void 0||ot.text===null?ot.value:ot.text,Et=ot.value===void 0||ot.value===null?ot.text:ot.value;if((0,v.isNumber)(Et)&&(Et=Et.toString()),(0,v.isNumber)(yt)&&(yt=yt.toString()),Re){const Wt=ap(Et,Re);if(!Wt.length)continue;const Zt=Wt.find(gn=>gn.groups&&gn.groups.value),xn=Wt.find(gn=>gn.groups&&gn.groups.text),In=Wt.find(gn=>gn.length>1),Sn=Wt.length>1&&In;if(Zt||xn)Et=Zt?.groups?.value??xn?.groups?.text,yt=xn?.groups?.text??Zt?.groups?.value;else if(Sn){for(let gn=0;gn<Wt.length;gn++){const En=Wt[gn];He.push({text:En[1],value:En[1],selected:!1})}continue}else In&&(yt=In[1],Et=In[1])}He.push({text:yt,value:Et,selected:!1})}return He=(0,v.uniqBy)(He,"value"),Li(He,ie)},Ih=(0,ac.Z0)({name:"templating/query",initialState:rc.j,reducers:{updateVariableOptions:(ce,ie)=>{const{results:ve,templatedRegex:Re}=ie.payload.data,He=(0,Hr.Fs)(ce,ie.payload.id);if(He.type!=="query")return;const{includeAll:st,sort:ot}=He,yt=Oh(Re,ot,ve);st&&yt.unshift({text:Fo.Zm,value:Fo.To,selected:!1}),yt.length||yt.push({text:Fo.ou,value:Fo.Ek,isNone:!0,selected:!1}),He.options=yt}}}),rp=Ih.reducer,{updateVariableOptions:op}=Ih.actions;function Pi(){return ce=>ce.pipe((0,wt.T)(nl))}function nl(ce){const ie=ce.series;if(!ie||!ie.length)return[];if(ud(ie))return ie;const ve=(0,Bs.Bt)(ie),Re=[];let He=-1,st=-1,ot=-1,yt=-1;for(const Et of ve)for(let Wt=0;Wt<Et.fields.length;Wt++){const Zt=Et.fields[Wt],xn=(0,_.Ct)(Zt,Et,ie).toLowerCase();Zt.type===se.PU.string&&ot===-1&&(ot=Wt),xn==="text"&&Zt.type===se.PU.string&&st===-1&&(st=Wt),xn==="value"&&Zt.type===se.PU.string&&He===-1&&(He=Wt),xn==="expandable"&&(Zt.type===se.PU.boolean||Zt.type===se.PU.number)&&yt===-1&&(yt=Wt)}if(ot===-1)throw new Error("Couldn't find any field of type string in the results.");for(const Et of ve)for(let Wt=0;Wt<Et.length;Wt++){const Zt=yt!==-1?Et.fields[yt].values[Wt]:void 0,xn=Et.fields[ot].values[Wt],In=st!==-1?Et.fields[st].values[Wt]:null,Sn=He!==-1?Et.fields[He].values[Wt]:null;if(He===-1&&st===-1){Re.push({text:xn,value:xn,expandable:Zt});continue}if(He===-1&&st!==-1){Re.push({text:In,value:In,expandable:Zt});continue}if(He!==-1&&st===-1){Re.push({text:Sn,value:Sn,expandable:Zt});continue}Re.push({text:In,value:Sn,expandable:Zt})}return Re}function tu(ce){return ie=>ie.pipe((0,wt.T)(ve=>{const{variable:Re,dispatch:He,getTemplatedRegexFunc:st}=ce;if(!Re.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const ot=st(Re),yt=(0,Sa.qD)(Re,{results:ve,templatedRegex:ot});He((0,so.kb)(Re.rootStateKey,op(yt)))}))}function ip(ce){return ie=>ie.pipe((0,Ui.Z)(()=>{const{dispatch:ve,variable:Re,searchFilter:He}=ce;return He?(0,Qn.of)():(0,wo.H)(ve((0,Wo.kl)((0,Sa.jX)(Re))))}))}function ud(ce){if(!ce)return!1;if(!ce.length)return!0;const ie=ce[0];if((0,Bs.ci)(ie))return!1;for(const ve in ie){if(!ie.hasOwnProperty(ve)||ie[ve]!==null&&typeof ie[ve]!="string"&&typeof ie[ve]!="number")continue;const Re=ve.toLowerCase();if(Re==="text"||Re==="value")return!0}return!1}var hd=e(29505),lp=e(43127);class cp{constructor(){this.runners=[new dp,new Oc,new up,new Qp]}getRunnerForDatasource(ie){const ve=this.runners.find(Re=>Re.canRun(ie));if(ve)return ve;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(ie){return this.runners.some(ve=>ve.canRun(ie))}}class dp{constructor(){this.type=hd.Qz.Legacy}canRun(ie){return(0,ko.d5)(ie)}getTarget({datasource:ie,variable:ve}){if((0,ko.d5)(ie))return ve.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ie,variable:ve,searchFilter:Re,timeSrv:He},st){if(!(0,ko.d5)(ie))return fd();const ot=(0,Sa.iP)(ve,Re,He,st.scopedVars);return(0,wo.H)(ie.metricFindQuery(ve.query,ot)).pipe((0,Ui.Z)(yt=>{if(!yt||!yt.length)return fd();const Et=yt;return(0,Qn.of)({series:Et,state:ni.Gu.Done,timeRange:ot.range})}))}}class Oc{constructor(){this.type=hd.Qz.Standard}canRun(ie){return(0,ko.Hf)(ie)}getTarget({datasource:ie,variable:ve}){if((0,ko.Hf)(ie))return ie.variables.toDataQuery(ve.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ie,runRequest:ve},Re){return(0,ko.Hf)(ie)?ie.variables.query?ve(ie,Re,ie.variables.query.bind(ie.variables)):ve(ie,Re):fd()}}class up{constructor(){this.type=hd.Qz.Custom}canRun(ie){return(0,ko.zs)(ie)}getTarget({datasource:ie,variable:ve}){if((0,ko.zs)(ie))return ve.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ie,runRequest:ve},Re){return(0,ko.zs)(ie)?ve(ie,Re,ie.variables.query.bind(ie.variables)):fd()}}const hp="variable-query";class Qp{constructor(){this.type=hd.Qz.Datasource}canRun(ie){return(0,ko.X3)(ie)}getTarget({datasource:ie,variable:ve}){if((0,ko.X3)(ie))return{...ve.query,refId:ve.query.refId??hp};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:ie,runRequest:ve},Re){return(0,ko.X3)(ie)?ve(ie,Re):fd()}}function fd(){return(0,Qn.of)({state:ni.Gu.Done,series:[],timeRange:(0,lp.E2)()})}class Ah{constructor(ie={dispatch:mo.JD,getState:mo.Gu,getVariable:Hr.dn,getTemplatedRegex:Sa.u7,getTimeSrv:Ki.jG,queryRunners:new cp,runRequest:ql.BN}){this.dependencies=ie,this.updateOptionsRequests=new Zc.B,this.updateOptionsResults=new Zc.B,this.cancelRequests=new Zc.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(ie){this.updateOptionsRequests.next(ie)}getResponse(ie){return this.updateOptionsResults.asObservable().pipe((0,Kl.p)(ve=>ve.identifier===ie))}cancelRequest(ie){this.cancelRequests.next({identifier:ie})}destroy(){this.subscription.unsubscribe()}onNewRequest(ie){const{datasource:ve,identifier:Re,searchFilter:He}=ie;try{const{dispatch:st,runRequest:ot,getTemplatedRegex:yt,getVariable:Et,queryRunners:Wt,getTimeSrv:Zt,getState:xn}=this.dependencies,In=(0,Hr.y7)(xn());this.updateOptionsResults.next({identifier:Re,state:ni.Gu.Loading});const Sn=Et(Re,xn());if(Sn.type!=="query")return;const gn=Zt(),En={variable:Sn,datasource:ve,searchFilter:He,timeSrv:gn,runRequest:ot};if(!Wt.isQueryRunnerAvailableForDatasource(ve)){const Nr=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:Re,state:ni.Gu.Error,error:Nr});return}const Ss=Wt.getRunnerForDatasource(ve),Cr=Ss.getTarget({datasource:ve,variable:Sn}),Ur=this.getRequest(Sn,ie,Cr);Ss.runRequest(En,Ur).pipe((0,Kl.p)(()=>{const Nr=(0,Hr.y7)(xn());return In===Nr}),(0,Kl.p)(Nr=>Nr.state===ni.Gu.Done||Nr.state===ni.Gu.Error),(0,Xd.s)(1),(0,Ui.Z)(Nr=>Nr.state===ni.Gu.Error?(0,Jd.$)(()=>Nr.error):(0,Qn.of)(Nr)),Pi(),tu({variable:Sn,dispatch:st,getTemplatedRegexFunc:yt}),ip({variable:Sn,dispatch:st,searchFilter:He}),(0,tl.Q)((0,Zd.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,Kl.p)(Nr=>{let ur=!1;return Nr.identifier.id===Re.id&&(ur=!0,this.updateOptionsResults.next({identifier:Re,state:ni.Gu.Loading,cancelled:ur})),ur}))),(0,qd.W)(Nr=>Nr.cancelled?(0,Qn.of)({}):(this.updateOptionsResults.next({identifier:Re,state:ni.Gu.Error,error:Nr}),(0,Jd.$)(()=>Nr))),(0,sp.j)(()=>{this.updateOptionsResults.next({identifier:Re,state:ni.Gu.Done})})).subscribe()}catch(st){this.updateOptionsResults.next({identifier:Re,state:ni.Gu.Error,error:st})}}getRequest(ie,ve,Re){const{searchFilter:He}=ve,st={variable:{text:ie.current.text,value:ie.current.value}},Et={...He?{searchFilter:{text:He,value:He}}:{},...st},Wt=this.dependencies.getTimeSrv().timeRange();return{app:td.Jk.Dashboard,requestId:(0,wl.A)(),timezone:"",range:Wt,interval:"",intervalMs:0,targets:[Re],scopedVars:Et,startTime:Date.now()}}}let nu;function fp(ce){nu=ce}function gd(){return nu}const Rh=ce=>{if(!Ic(ce))return ce.name;const{current:ie}=ce;return Array.isArray(ie.text)?ie.text.join(" + "):ie.text},Ic=ce=>Array.isArray(ce?.options)||typeof ce?.current=="object";var ji=(ce=>(ce[ce.moveUp=38]="moveUp",ce[ce.moveDown=40]="moveDown",ce[ce.select=32]="select",ce[ce.cancel=27]="cancel",ce[ce.selectAndClose=13]="selectAndClose",ce))(ji||{});class su extends f.PureComponent{constructor(){super(...arguments),this.onKeyDown=ie=>{if(ji[ie.keyCode]&&ie.keyCode!==ji.select){const ve=ie.ctrlKey||ie.metaKey||ie.shiftKey;this.props.onNavigate(ie.keyCode,ve),ie.preventDefault()}},this.onChange=ie=>{this.props.onChange(ie.target.value)}}render(){const{value:ie,id:ve,onNavigate:Re,...He}=this.props;return(0,H.jsx)("input",{...He,ref:st=>{st&&(st.focus(),st.setAttribute("style",`width:${Math.max(st.width,150)}px`))},id:ve,type:"text",className:"gf-form-input",value:ie??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,El.t)("variable.dropdown.placeholder","Enter variable value")})}}var au=e(89963),Lh=e(46334);const jh=({loading:ce,disabled:ie,onClick:ve,text:Re,onCancel:He,id:st})=>{const ot=(0,Lt.of)(Ji),yt=(0,f.useCallback)(Et=>{Et.stopPropagation(),Et.preventDefault(),ve()},[ve]);return ce?(0,H.jsxs)("div",{className:ot.container,"data-testid":Yr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${Re}`),title:Re,id:st,children:[(0,H.jsx)(pd,{text:Re}),(0,H.jsx)(au.I,{loading:!0,onCancel:He})]}):(0,H.jsxs)("button",{onClick:yt,className:ot.container,"data-testid":Yr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${Re}`),"aria-expanded":!1,"aria-controls":`options-${st}`,id:st,title:Re,disabled:ie,children:[(0,H.jsx)(pd,{text:Re}),(0,H.jsx)(Oo.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},pd=({text:ce})=>{const ie=(0,Lt.of)(Ji);return(0,H.jsx)("span",{className:ie.textAndTags,children:ce===Fo.Zm?(0,El.t)("variable.picker.link-all","All"):ce})},Ji=ce=>{const ie=(0,Lh.$)(ce);return{container:(0,Gt.css)({maxWidth:"500px",paddingRight:"10px",padding:ce.spacing(0,1),backgroundColor:ce.components.input.background,border:`1px solid ${ce.components.input.borderColor}`,borderRadius:ce.shape.radius.default,display:"flex",alignItems:"center",color:ce.colors.text.primary,height:ce.spacing(ce.components.height.md),[`.${ie.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:ce.colors.action.disabledBackground,color:ce.colors.action.disabledText,border:`1px solid ${ce.colors.action.disabledBackground}`}}),textAndTags:(0,Gt.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:ce.spacing(.25),userSelect:"none"})}};var sl=e(56034),gp=e(3911);class pp extends f.PureComponent{constructor(){super(...arguments),this.onToggle=ie=>ve=>{const Re=ve.shiftKey||ve.ctrlKey||ve.metaKey;this.handleEvent(ve),this.props.onToggle(ie,Re)},this.onToggleAll=ie=>{this.handleEvent(ie),this.props.onToggleAll()}}handleEvent(ie){ie.preventDefault(),ie.stopPropagation()}render(){const{multi:ie,values:ve,highlightIndex:Re,selectedValues:He,onToggle:st,onToggleAll:ot,theme:yt,...Et}=this.props,Wt=ru(yt);return(0,H.jsx)("div",{className:Wt.variableValueDropdown,children:(0,H.jsx)("div",{className:Wt.variableOptionsWrapper,children:(0,H.jsxs)("ul",{className:Wt.variableOptionsColumn,"aria-label":Yr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...Et,children:[this.renderMultiToggle(),ve.map((Zt,xn)=>this.renderOption(Zt,xn))]})})})}renderOption(ie,ve){const{highlightIndex:Re,multi:He,theme:st}=this.props,ot=ru(st),yt=ie.value===Fo.To;return(0,H.jsx)("li",{children:(0,H.jsxs)("button",{"data-testid":Yr.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":ie.selected,className:(0,Gt.cx)((0,xe.my)(st),ot.variableOption,{[ot.highlighted]:ve===Re,[ot.variableAllOption]:yt},ot.noStyledButton),onClick:this.onToggle(ie),children:[(0,H.jsx)("span",{className:(0,Gt.cx)(ot.variableOptionIcon,{[ot.variableOptionIconSelected]:ie.selected,[ot.hideVariableOptionIcon]:!He})}),(0,H.jsx)("span",{"data-testid":Yr.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${ie.text}`),children:yt?(0,El.t)("variable.picker.option-all","All"):ie.text})]})},`${ie.value}`)}renderMultiToggle(){const{multi:ie,selectedValues:ve,theme:Re,values:He}=this.props,st=ru(Re),ot=He.some(Et=>Et.value===Fo.To);if(!ie)return null;const yt=()=>(0,H.jsx)(El.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,H.jsx)(sl.m,{content:yt,placement:"top",children:(0,H.jsxs)("button",{className:(0,Gt.cx)((0,xe.my)(Re),st.variableOption,st.variableOptionColumnHeader,st.noStyledButton,{[st.noPaddingBotton]:ot}),role:"checkbox","aria-checked":ve.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top",children:[(0,H.jsx)("span",{className:(0,Gt.cx)(st.variableOptionIcon,{[st.variableOptionIconManySelected]:ve.length>1})}),(0,H.jsx)(El.x6,{i18nKey:"variable.picker.option-selected-values",children:"Selected"})," (",ve.length,")"]})})}}const ru=(0,gp.N)(ce=>{const ie=ce.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,Gt.css)({display:"none"}),highlighted:(0,Gt.css)({backgroundColor:ce.colors.action.hover}),noStyledButton:(0,Gt.css)({width:"100%",textAlign:"left"}),variableOption:(0,Gt.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:ce.colors.action.hover}}),variableOptionColumnHeader:(0,Gt.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,Gt.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${ie}) left top no-repeat`}),variableOptionIconManySelected:(0,Gt.css)({background:`url(${ie}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,Gt.css)({background:`url(${ie}) 0px -18px no-repeat`}),variableValueDropdown:(0,Gt.css)({backgroundColor:ce.colors.background.primary,border:`1px solid ${ce.colors.border.weak}`,borderRadius:ce.shape.borderRadius(2),boxShadow:ce.shadows.z2,position:"absolute",top:ce.spacing(ce.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:ce.zIndex.typeahead}),variableOptionsColumn:(0,Gt.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,Gt.css)({display:"table",width:"100%"}),variableAllOption:(0,Gt.css)({borderBottom:`1px solid ${ce.colors.border.weak}`,paddingBottom:ce.spacing(1)}),noPaddingBotton:(0,Gt.css)({paddingBottom:0})}}),ou=(0,Lt.cV)(pp);var mp=e(92053),Bh=e(92041),Z=e(56968),me=e(24300);const Me=(ce,ie,ve)=>async(Re,He)=>{if(ie===ji.cancel)return await Re(ct(ce));if(ie===ji.select)return Re(Bt(ce,ve));if(ie===ji.selectAndClose)return(0,Hr.nx)(ce,He()).optionsPicker.multi?Re(Bt(ce,ve)):(Re(Bt(ce,ve,!0)),Re(ct(ce)));if(ie===ji.moveDown)return Re((0,so.kb)(ce,(0,me.O$)(1)));if(ie===ji.moveUp)return Re((0,so.kb)(ce,(0,me.O$)(-1)))},Ne=(ce,ie="")=>async(ve,Re)=>{const{rootStateKey:He}=ce,{id:st,queryValue:ot}=(0,Hr.nx)(He,Re()).optionsPicker,yt={id:st,rootStateKey:He,type:"query"},Et=(0,Hr.dn)(yt,Re());if(!("options"in Et)||(ve((0,so.kb)(He,(0,me.S8)(ie))),(0,v.trim)(ot)===(0,v.trim)(ie)))return;const{query:Wt,options:Zt}=Et,xn=typeof Wt=="string"?Wt:Wt.target;return(0,mp.E)(xn)?Xt(ve,Re,ie,He):ve((0,so.kb)(He,(0,me.fx)(Zt)))},Ze=async ce=>{if((0,Bh.R)(ce.current))return;await ec.B.get(ce.type).setValue(ce,ce.current,!0)},ct=(ce,ie)=>async(ve,Re)=>{const He=(0,Hr.nx)(ce,Re()).optionsPicker,st={id:He.id,rootStateKey:ce,type:"query"},ot=(0,Hr.dn)(st,Re());if(!(0,ko.SP)(ot))return;const yt={option:nn(He)},Et={propName:"queryValue",propValue:He.queryValue};ve((0,so.kb)(ce,(0,Z.dE)((0,Sa.qD)(ot,yt)))),ve((0,so.kb)(ce,(0,Z.QP)((0,Sa.qD)(ot,Et))));const Wt=(0,Hr.dn)(st,Re());if((0,ko.SP)(Wt)&&(ve((0,so.kb)(ce,(0,me.Fu)())),(0,Sa.Lz)(ot)!==(0,Sa.Lz)(Wt)))return ie?ie(Wt):await Ze(Wt)},gt=(ce,ie)=>async(ve,Re)=>{const{id:He,rootStateKey:st}=ce,ot=(0,Hr.nx)(st,Re()).optionsPicker;ot.id&&ot.id!==He&&await ve(ct(st,ie));const yt=(0,Hr.dn)(ce,Re());(0,ko.SP)(yt)&&ve((0,so.kb)(st,(0,me.MO)(yt)))},Bt=(ce,ie,ve=!1)=>(Re,He)=>{const{highlightIndex:st,options:ot}=(0,Hr.nx)(ce,He()).optionsPicker,yt=ot[st];Re((0,so.kb)(ce,(0,me.U9)({option:yt,forceSelect:ve,clearOthers:ie})))},Vt=async(ce,ie,ve,Re)=>{try{const{id:He}=(0,Hr.nx)(Re,ie()).optionsPicker,st={id:He,rootStateKey:Re,type:"query"},ot=(0,Hr.dn)(st,ie());if(!(0,ko.SP)(ot))return;await ec.B.get(ot.type).updateOptions(ot,ve);const Et=(0,Hr.dn)(st,ie());if(!(0,ko.SP)(Et))return;ce((0,so.kb)(Re,(0,me.qh)(Et.options)))}catch(He){console.error(He)}},Xt=(0,v.debounce)(Vt,500);function nn(ce){const{options:ie,selectedValues:ve,queryValue:Re,multi:He}=ce;if(ie.length===0&&Re&&Re.length>0)return{text:Re,value:Re,selected:!1};if(!He)return ve.find(yt=>yt.selected);const st=[],ot=[];for(const yt of ve)yt.selected&&(st.push(yt.text.toString()),ot.push(yt.value.toString()));return{value:ot,text:st,selected:!0}}const on=()=>{const ce=st=>({...(0,np.bindActionCreators)({openOptions:gt,commitChangesToVariable:ct,navigateOptions:Me},st),filterOrSearchOptions:(ot,yt="")=>{st(Ne(ot,yt))},toggleAllOptions:ot=>st((0,so.kb)(ot.rootStateKey,(0,me.an)())),toggleOption:(ot,yt,Et,Wt)=>st((0,so.kb)(ot.rootStateKey,(0,me.U9)({option:yt,clearOthers:Et,forceSelect:Wt})))}),ie=(st,ot)=>{const{rootStateKey:yt}=ot.variable;return yt?{picker:(0,Hr.nx)(yt,st).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:me.$z})},ve=(0,nd.connect)(ie,ce);class Re extends f.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,Sa.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(ot,yt)=>{((0,ko.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(ot,yt)},this.onToggleSingleValueVariable=(ot,yt)=>{this.props.toggleOption((0,Sa.jX)(this.props.variable),ot,yt,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(ot,yt)=>{this.props.toggleOption((0,Sa.jX)(this.props.variable),ot,yt,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,Sa.jX)(this.props.variable))},this.onFilterOrSearchOptions=ot=>{this.props.filterOrSearchOptions((0,Sa.jX)(this.props.variable),ot)},this.onNavigate=(ot,yt)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,ot,yt)},this.onCancel=()=>{gd().cancelRequest((0,Sa.jX)(this.props.variable))}}render(){const{variable:ot,picker:yt}=this.props,Et=yt.id===ot.id,Wt=Rn();return(0,H.jsx)("div",{className:Wt.variableLinkWrapper,"data-testid":Yr.Tp.components.Variables.variableLinkWrapper,children:Et?this.renderOptions(yt):this.renderLink(ot)})}renderLink(ot){const yt=Rh(ot),Et=ot.state===ni.Gu.Loading;return(0,H.jsx)(jh,{id:Fo.qz+ot.id,text:yt,onClick:this.onShowOptions,loading:Et,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(ot){const{id:yt}=this.props.variable;return(0,H.jsxs)($i.N,{onClick:this.onHideOptions,children:[(0,H.jsx)(su,{id:Fo.qz+yt,value:ot.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${yt}`}),(0,H.jsx)(ou,{values:ot.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:ot.highlightIndex,multi:ot.multi,selectedValues:ot.selectedValues,id:`options-${yt}`})]})}}const He=ve(Re);return He.displayName="OptionsPicker",He},Rn=()=>({variableLinkWrapper:(0,Gt.css)({display:"inline-block",position:"relative"})});var rn=e(95802);class Nn extends f.PureComponent{constructor(){super(...arguments),this.onChange=ie=>{this.props.onPropChange({propName:"query",propValue:ie.currentTarget.value,updateOptions:!0})}}render(){return(0,H.jsx)(rn.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const ms={...oc.Vg,type:"constant",hide:pi.zL.hideVariable,query:"",current:{},options:[]},rs=(0,ac.Z0)({name:"templating/constant",initialState:rc.j,reducers:{createConstantOptionsFromQuery:(ce,ie)=>{const ve=(0,Hr.Fs)(ce,ie.payload.id);ve.type==="constant"&&(ve.options=[{text:ve.query.trim(),value:ve.query.trim(),selected:!1}])}}}),gs=rs.reducer,{createConstantOptionsFromQuery:os}=rs.actions,Fn=ce=>async ie=>{const{rootStateKey:ve}=ce;await ie((0,so.kb)(ve,os((0,Sa.qD)(ce)))),await ie((0,Wo.kl)(ce))},Gn=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:ms,reducer:gs,picker:on(),editor:Nn,dependsOn:()=>!1,setValue:async(ce,ie,ve=!1)=>{await(0,mo.JD)((0,Wo.t9)((0,Sa.jX)(ce),ie,ve))},setValueFromUrl:async(ce,ie)=>{await(0,mo.JD)((0,Wo.x7)((0,Sa.jX)(ce),ie))},updateOptions:async ce=>{await(0,mo.JD)(Fn((0,Sa.jX)(ce)))},getSaveModel:ce=>{const{index:ie,id:ve,state:Re,global:He,current:st,options:ot,rootStateKey:yt,...Et}=(0,v.cloneDeep)(ce);return Et},getValueForUrl:ce=>ce.current.value,beforeAdding:ce=>{const{current:ie,options:ve,query:Re,...He}=(0,v.cloneDeep)(ce),st={selected:!0,text:Re,value:Re};return{...He,current:st,options:[st],query:Re}}});function ba(ce,...ie){const ve=(0,nd.connect)(...ie)(ce);return Re=>(0,H.jsx)(ve,{...Re,store:mo.M_})}function zs(ce,...ie){const ve=connect(...ie)(ce);return Re=>jsx(Provider,{store,children:jsx(ve,{...Re,store})})}var sa=e(58711);class ys extends f.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:ie,propValue:ve})=>{this.props.onPropChange({propName:ie,propValue:ve,updateOptions:!0})},this.onQueryChange=ie=>{this.props.onPropChange({propName:"query",propValue:ie.currentTarget.value,updateOptions:!0})}}render(){return(0,H.jsx)(sa.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:ie=>this.onSelectionOptionsChange({propName:"multi",propValue:ie.currentTarget.checked}),onIncludeAllChange:ie=>this.onSelectionOptionsChange({propName:"includeAll",propValue:ie.currentTarget.checked}),onAllValueChange:ie=>this.onSelectionOptionsChange({propName:"allValue",propValue:ie.currentTarget.value})})}}const is=(ce,ie)=>({}),Ls={changeVariableMultiValue:Wo.TI},Cs=ba(ys,is,Ls),Gs={...oc.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},xa=(0,ac.Z0)({name:"templating/custom",initialState:rc.j,reducers:{createCustomOptionsFromQuery:(ce,ie)=>{const ve=(0,Hr.Fs)(ce,ie.payload.id);if(ve.type!=="custom")return;const{includeAll:Re}=ve,ot=(ie.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(yt=>{yt=yt.replace(/\\,/g,",");const Et=/^(.+)\s:\s(.+)$/g.exec(yt)??[];if(Et.length===3){const[,Wt,Zt]=Et;return{text:Wt.trim(),value:Zt.trim(),selected:!1}}else return{text:yt.trim(),value:yt.trim(),selected:!1}});Re&&ot.unshift({text:Fo.Zm,value:Fo.To,selected:!1}),ve.options=ot}}}),ka=xa.reducer,{createCustomOptionsFromQuery:Ja}=xa.actions,Wr=ce=>async(ie,ve)=>{const{rootStateKey:Re}=ce,He=(0,Hr.dn)(ce,ve());if(He.type!=="custom")return;const st=(0,we.w)().replace(He.query);await ie((0,so.kb)(Re,Ja((0,Sa.qD)(ce,st)))),await ie((0,Wo.kl)(ce))},Ua=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:Gs,reducer:ka,picker:on(),editor:Cs,dependsOn:(ce,ie)=>(0,Sa.wJ)(ce.query,ie.name),setValue:async(ce,ie,ve=!1)=>{await(0,mo.JD)((0,Wo.t9)((0,Sa.jX)(ce),ie,ve))},setValueFromUrl:async(ce,ie)=>{await(0,mo.JD)((0,Wo.x7)((0,Sa.jX)(ce),ie))},updateOptions:async ce=>{await(0,mo.JD)(Wr((0,Sa.jX)(ce)))},getSaveModel:ce=>{const{index:ie,id:ve,state:Re,global:He,rootStateKey:st,...ot}=(0,v.cloneDeep)(ce);return ot},getValueForUrl:ce=>(0,Sa.ML)(ce)?Fo.Zm:ce.current.value});var ra=e(98917),la=e(80147);const lr={...oc.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:pi.CO.onDashboardLoad},Kr=(0,ac.Z0)({name:"templating/datasource",initialState:rc.j,reducers:{createDataSourceOptions:(ce,ie)=>{const{sources:ve,regex:Re}=ie.payload.data,He=[],st=(0,Hr.Fs)(ce,ie.payload.id);if(st.type==="datasource"){for(let ot=0;ot<ve.length;ot++){const yt=ve[ot];(0,la._)(st.query,yt.meta)&&(Ca(yt,Re)&&He.push({text:yt.name,value:yt.uid,selected:!1}),va(yt,Re)&&He.push({text:"default",value:"default",selected:!1}))}He.length===0&&He.push({text:"No data sources found",value:"",selected:!1}),st.includeAll&&He.unshift({text:Fo.Zm,value:Fo.To,selected:!1}),st.options=He}}}});function Ca(ce,ie){return ie?ie.exec(ce.name):!0}function va(ce,ie){return ce.isDefault?ie?ie.exec("default"):!0:!1}const Ga=Kr.reducer,{createDataSourceOptions:cr}=Kr.actions,sr=(ce,ie={getDatasourceSrv:d.tR})=>async(ve,Re)=>{const{rootStateKey:He}=ce,st=ie.getDatasourceSrv().getList({metrics:!0,variables:!1}),ot=(0,Hr.dn)(ce,Re());if(ot.type!=="datasource")return;let yt;ot.regex&&(yt=(0,we.w)().replace(ot.regex,void 0,"regex"),yt=(0,Ho.dO)(yt)),ve((0,so.kb)(He,cr((0,Sa.qD)(ce,{sources:st,regex:yt})))),await ve((0,Wo.kl)(ce))},vr=(ce,ie={getDatasourceSrv:d.tR})=>ve=>{const Re=ie.getDatasourceSrv().getList({metrics:!0,variables:!0}),He=(0,v.chain)(Re).uniqBy("meta.id").map(st=>({text:st.meta.name,value:st.meta.id})).value();He.unshift({text:"",value:""}),ve((0,so.kb)(ce,(0,bl.BC)({dataSourceTypes:He})))},kr=(ce,ie)=>{const{variable:{rootStateKey:ve}}=ie;if(!ve)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:Xg(bl.nS)};const{editor:Re}=(0,Hr.nx)(ve,ce);return{extended:Xg(Re)}},dr={initDataSourceVariableEditor:vr,changeVariableMultiValue:Wo.TI},Gr=(0,nd.connect)(kr,dr);class Xr extends f.PureComponent{constructor(){super(...arguments),this.onRegExBlur=ie=>{this.props.onPropChange({propName:"regex",propValue:ie.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:ie,propName:ve})=>{this.props.onPropChange({propName:ve,propValue:ie,updateOptions:!0})},this.onMultiChanged=ie=>{this.props.changeVariableMultiValue((0,Sa.jX)(this.props.variable),ie.currentTarget.checked)},this.onIncludeAllChanged=ie=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:ie.currentTarget.checked})},this.onAllValueChanged=ie=>{this.onSelectionOptionsChange({propName:"allValue",propValue:ie.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:ie}=this.props;if(!ie?.dataSourceTypes.length)return"";const ve=ie.dataSourceTypes.find(He=>He.value===this.props.variable.query);return(ve?ve.value:ie.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=ie=>{this.props.onPropChange({propName:"query",propValue:ie.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:ie}=this.props.variable;if(!ie){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(ie)}render(){const{variable:ie,extended:ve}=this.props,Re=ve?.dataSourceTypes?.length?ve.dataSourceTypes?.map(He=>({value:He.value??"",label:He.text})):[];return(0,H.jsx)(ra.y,{query:ie.query,regex:ie.regex,multi:ie.multi,includeAll:ie.includeAll,optionTypes:Re,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const So=Gr(Xr),Qs=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:lr,reducer:Ga,picker:on(),editor:So,dependsOn:(ce,ie)=>ce.regex?(0,Sa.wJ)(ce.regex,ie.name):!1,setValue:async(ce,ie,ve=!1)=>{await(0,mo.JD)((0,Wo.t9)((0,Sa.jX)(ce),ie,ve))},setValueFromUrl:async(ce,ie)=>{await(0,mo.JD)((0,Wo.x7)((0,Sa.jX)(ce),ie))},updateOptions:async ce=>{await(0,mo.JD)(sr((0,Sa.jX)(ce)))},getSaveModel:ce=>{const{index:ie,id:ve,state:Re,global:He,rootStateKey:st,...ot}=(0,v.cloneDeep)(ce);return{...ot,options:[]}},getValueForUrl:ce=>(0,Sa.ML)(ce)?Fo.Zm:ce.current.value});var hs=e(25304),Ms=e(49317);const Na=(0,f.memo)(({onPropChange:ce,variable:ie})=>{const ve=ot=>{ce({propName:"auto",propValue:ot.target.checked,updateOptions:!0})},Re=ot=>{ce({propName:"query",propValue:ot.currentTarget.value,updateOptions:!0})},He=ot=>{ce({propName:"auto_count",propValue:ot.value,updateOptions:!0})},st=ot=>{ce({propName:"auto_min",propValue:ot.currentTarget.value,updateOptions:!0})};return(0,H.jsx)(Ms.s,{intervals:ie.query,autoStepCount:ie.auto_count,autoEnabled:ie.auto,onAutoCountChanged:He,onIntervalsChange:Re,onAutoEnabledChange:ve,onAutoMinIntervalChanged:st,autoMinInterval:ie.auto_min})});Na.displayName="IntervalVariableEditor";var Oa=e(23989),Qa=e(81515);const xr=ce=>async ie=>{const{rootStateKey:ve}=ce;await ie((0,so.kb)(ve,(0,Qa.mn)((0,Sa.qD)(ce)))),await ie(Io(ce)),await ie((0,Wo.kl)(ce))},Io=(ce,ie={calculateInterval:Vd.calculateInterval,getTimeSrv:Ki.jG,templateSrv:(0,Oa.w)()})=>(ve,Re)=>{const He=(0,Hr.dn)(ce,Re());if(He.type==="interval"&&He.auto){const st=ie.calculateInterval(ie.getTimeSrv().timeRange(),He.auto_count,He.auto_min);ie.templateSrv.setGrafanaVariable("$__auto_interval_"+He.name,st.interval),ie.templateSrv.setGrafanaVariable("$__auto_interval",st.interval)}},Ci=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:Qa.Ez,reducer:Qa.E5,picker:on(),editor:Na,dependsOn:()=>!1,setValue:async(ce,ie,ve=!1)=>{await(0,mo.JD)(Io((0,Sa.jX)(ce))),await(0,mo.JD)((0,Wo.t9)((0,Sa.jX)(ce),ie,ve))},setValueFromUrl:async(ce,ie)=>{await(0,mo.JD)(Io((0,Sa.jX)(ce))),await(0,mo.JD)((0,Wo.x7)((0,Sa.jX)(ce),ie))},updateOptions:async ce=>{await(0,mo.JD)(xr((0,Sa.jX)(ce)))},getSaveModel:ce=>{const{index:ie,id:ve,state:Re,global:He,rootStateKey:st,...ot}=(0,v.cloneDeep)(ce);return ot},getValueForUrl:ce=>ce.current.value});var $l=e(44890),Bi=e(64423),Vl=e(12091),Ko=e(70766);function md(ce,ie,ve){return{next:He=>{if(He.state===ni.Gu.Error){ve.unsubscribe(),ie(He.error);return}if(He.state===ni.Gu.Done){ve.unsubscribe(),ce();return}},error:He=>{ve.unsubscribe(),ie(He)},complete:()=>{ve.unsubscribe(),ce()}}}const Zi=(ce,ie)=>async(ve,Re)=>{try{const{rootStateKey:He}=ce;if(!(0,Sa.sN)(He,Re()))return;const st=(0,Hr.dn)(ce,Re());if(st.type!=="query")return;(0,Hr.nx)(He,Re()).editor.id===st.id&&ve((0,so.kb)(He,(0,bl.Eo)({errorProp:"update"})));const ot=await(0,N.l)().get(st.datasource??"");await new Promise((yt,Et)=>{const Wt=new Bi.yU,Zt=md(yt,Et,Wt),xn=gd().getResponse(ce).subscribe(Zt);Wt.add(xn),gd().queueRequest({identifier:ce,datasource:ot,searchFilter:ie})})}catch(He){if(He instanceof Error){const st=(0,Vl.u)(He),{rootStateKey:ot}=ce;throw(0,Hr.nx)(ot,Re()).editor.id===ce.id&&ve((0,so.kb)(ot,(0,bl.NY)({errorProp:"update",errorText:st.message}))),st}}},zl=ce=>async(ie,ve)=>{const Re=(0,Hr.dn)(ce,ve());Re.type==="query"&&await ie(_l((0,Sa.jX)(Re),Re.datasource))},_l=(ce,ie)=>async(ve,Re)=>{try{const{rootStateKey:He}=ce,{editor:st}=(0,Hr.nx)(He,Re()),yt=_d(st)?.dataSource,Et=await(0,N.l)().get(ie??"");yt&&yt.type!==Et?.type&&ve((0,so.kb)(He,(0,Z.QP)((0,Sa.qD)(ce,{propName:"query",propValue:""}))));const Wt=await(0,Ko.y)(Et);ve((0,so.kb)(He,(0,bl.BC)({dataSource:Et,VariableQueryEditor:Wt})))}catch(He){console.error(He)}},mi=(ce,ie,ve)=>async(Re,He)=>{const{rootStateKey:st}=ce,ot=(0,Hr.dn)(ce,He());if(ot.type==="query"){if(Ac(ot.name,ie)){const yt="Query cannot contain a reference to itself. Variable: $"+ot.name;Re((0,so.kb)(st,(0,bl.NY)({errorProp:"query",errorText:yt})));return}Re((0,so.kb)(st,(0,bl.Eo)({errorProp:"query"}))),Re((0,so.kb)(st,(0,Z.QP)((0,Sa.qD)(ce,{propName:"query",propValue:ie})))),ve!==void 0?Re((0,so.kb)(st,(0,Z.QP)((0,Sa.qD)(ce,{propName:"definition",propValue:ve})))):typeof ie=="string"&&Re((0,so.kb)(st,(0,Z.QP)((0,Sa.qD)(ce,{propName:"definition",propValue:ie})))),await Re((0,Wo.mZ)(ce))}};function Ac(ce,ie){if(typeof ie=="string"&&ie.match(new RegExp("\\$"+ce+"(/| |$)")))return!0;const ve=vd(ie);for(let Re in ve)if(ve.hasOwnProperty(Re)){const He=ve[Re];if(typeof He=="string"&&He.match(new RegExp("\\$"+ce+"(/| |$)")))return!0}return!1}function vd(ce){return typeof ce!="object"||ce===null?{query:ce}:Object.keys(ce).reduce((Re,He)=>{const st=ce[He];if(typeof st!="object"||st===null)return Re[He]=st,Re;const ot=vd(st);for(let yt in ot)ot.hasOwnProperty(yt)&&(Re[`${He}_${yt}`]=ot[yt]);return Re},{})}const Xp=(ce,ie)=>{const{rootStateKey:ve}=ie.variable;if(!ve)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:_d(bl.nS)};const{editor:Re}=(0,Hr.nx)(ve,ce);return{extended:_d(Re)}},qp={initQueryVariableEditor:zl,changeQueryVariableDataSource:_l,changeQueryVariableQuery:mi,changeVariableMultiValue:Wo.TI},em=(0,nd.connect)(Xp,qp);class tm extends f.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=ie=>{this.props.onPropChange({propName:"datasource",propValue:ie.isDefault?null:(0,Jg.p$)(ie)})},this.onLegacyQueryChange=async(ie,ve)=>{this.props.variable.query!==ie&&this.props.changeQueryVariableQuery((0,Sa.jX)(this.props.variable),ie,ve)},this.onQueryChange=async ie=>{if(this.props.variable.query!==ie){let ve="";ie&&ie.hasOwnProperty("query")&&typeof ie.query=="string"&&(ve=ie.query),this.props.changeQueryVariableQuery((0,Sa.jX)(this.props.variable),ie,ve)}},this.onRegExBlur=async ie=>{const ve=ie.currentTarget.value;this.props.variable.regex!==ve&&this.props.onPropChange({propName:"regex",propValue:ve,updateOptions:!0})},this.onRefreshChange=ie=>{this.props.onPropChange({propName:"refresh",propValue:ie})},this.onSortChange=async ie=>{this.props.onPropChange({propName:"sort",propValue:ie.value,updateOptions:!0})},this.onMultiChange=ie=>{this.props.onPropChange({propName:"multi",propValue:ie.currentTarget.checked})},this.onIncludeAllChange=ie=>{this.props.onPropChange({propName:"includeAll",propValue:ie.currentTarget.checked})},this.onAllValueChange=ie=>{this.props.onPropChange({propName:"allValue",propValue:ie.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,Sa.jX)(this.props.variable))}componentDidUpdate(ie){ie.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,Sa.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:ie,variable:ve}=this.props;if(!ie||!ie.dataSource)return null;const Re=(0,Ki.jG)().timeRange();return(0,H.jsx)($l.u,{datasource:ve.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:ve.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:Re,regex:ve.regex,onRegExChange:this.onRegExBlur,sort:ve.sort,onSortChange:this.onSortChange,refresh:ve.refresh,onRefreshChange:this.onRefreshChange,isMulti:ve.multi,includeAll:ve.includeAll,allValue:ve.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const nm=em(tm),sm=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:eu,reducer:rp,picker:on(),editor:nm,dependsOn:(ce,ie)=>(0,Sa.wJ)(ce.query,ce.datasource?.uid,ce.regex,ie.name),setValue:async(ce,ie,ve=!1)=>{await(0,mo.JD)((0,Wo.t9)((0,Sa.jX)(ce),ie,ve))},setValueFromUrl:async(ce,ie)=>{await(0,mo.JD)((0,Wo.x7)((0,Sa.jX)(ce),ie))},updateOptions:async(ce,ie)=>{await(0,mo.JD)(Zi((0,Sa.jX)(ce),ie))},getSaveModel:ce=>{const{index:ie,id:ve,state:Re,global:He,queryValue:st,rootStateKey:ot,...yt}=(0,v.cloneDeep)(ce);return ce.refresh!==pi.CO.never?{...yt,options:[]}:yt},getValueForUrl:ce=>(0,Sa.ML)(ce)?Fo.Zm:ce.current.value}),ym=()=>({id:"system",description:"",name:"system",initialState:{...oc.Vg,type:"system",hide:pi.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:ni.Gu.Done},reducer:ce=>ce,picker:null,editor:null,dependsOn:()=>!1,setValue:async(ce,ie,ve=!1)=>{},setValueFromUrl:async(ce,ie)=>{},updateOptions:async ce=>{},getSaveModel:ce=>({}),getValueForUrl:ce=>""});var xm=e(58975),Yp=e(14329);function am({onPropChange:ce,variable:{query:ie}}){const ve=(0,f.useCallback)((st,ot)=>{st.preventDefault(),ce({propName:"originalQuery",propValue:st.currentTarget.value,updateOptions:!1}),ce({propName:"query",propValue:st.currentTarget.value,updateOptions:ot})},[ce]),Re=(0,f.useCallback)(st=>ve(st,!1),[ve]),He=(0,f.useCallback)(st=>ve(st,!0),[ve]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(xm.Y,{children:"Text options"}),(0,H.jsx)(Yp._,{value:ie,name:"Default value",placeholder:"default value, if any",onChange:Re,onBlur:He,width:30,testId:Yr.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function rm({variable:ce,onVariableChange:ie,readOnly:ve}){const Re=(0,bc.useDispatch)(),[He,st]=(0,f.useState)(ce.current.value);(0,f.useEffect)(()=>{st(ce.current.value)},[ce]);const ot=(0,f.useCallback)(()=>{if(!ce.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(ce.current.value!==He){if(Re((0,so.kb)(ce.rootStateKey,(0,Z.QP)((0,Sa.qD)({id:ce.id,type:ce.type},{propName:"query",propValue:He})))),ie){ie({...ce,current:(0,Bh.R)(ce.current)?{}:{...ce.current,value:He}});return}ec.B.get(ce.type).updateOptions(ce)}},[ce,He,Re,ie]),yt=(0,f.useCallback)(Zt=>st(Zt.target.value),[st]),Et=Zt=>ot(),Wt=Zt=>{Zt.keyCode===13&&(Zt.preventDefault(),ot())};return(0,H.jsx)(qe.p,{type:"text",value:He,onChange:yt,onBlur:Et,disabled:ve,onKeyDown:Wt,placeholder:(0,El.t)("variable.textbox.placeholder","Enter variable value"),id:Fo.qz+ce.id})}const om={...oc.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},vp=(0,ac.Z0)({name:"templating/textbox",initialState:rc.j,reducers:{createTextBoxOptions:(ce,ie)=>{const ve=(0,Hr.Fs)(ce,ie.payload.id);if(ve.type!=="textbox")return;const Re={text:ve.query.trim(),value:ve.query.trim(),selected:!1};ve.options=[Re],ve.current=Re}}}),im=vp.reducer,{createTextBoxOptions:lm}=vp.actions,Jp=ce=>async(ie,ve)=>{const{rootStateKey:Re,type:He}=ce;ie((0,so.kb)(Re,lm((0,Sa.qD)(ce))));const st=(0,Hr.dn)(ce,ve());st.type==="textbox"&&await ec.B.get(He).setValue(st,st.options[0],!0)},cm=(ce,ie)=>async(ve,Re)=>{const{rootStateKey:He}=ce,st=(0,Hr.dn)(ce,Re());if(st.type!=="textbox")return;const ot=(0,Sa.QT)(ie);ve((0,so.kb)(He,(0,Z.QP)((0,Sa.qD)(st,{propName:"query",propValue:ot})))),await ve((0,Wo.x7)((0,Sa.jX)(st),ot))},dm=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:om,reducer:im,picker:rm,editor:am,dependsOn:(ce,ie)=>!1,setValue:async(ce,ie,ve=!1)=>{await(0,mo.JD)((0,Wo.t9)((0,Sa.jX)(ce),ie,ve))},setValueFromUrl:async(ce,ie)=>{await(0,mo.JD)(cm((0,Sa.jX)(ce),ie))},updateOptions:async ce=>{await(0,mo.JD)(Jp((0,Sa.jX)(ce)))},getSaveModel:(ce,ie)=>{const{index:ve,id:Re,state:He,global:st,originalQuery:ot,rootStateKey:yt,...Et}=(0,v.cloneDeep)(ce);if(ce.query!==ot&&!ie){const Wt=ot??"",Zt={selected:!1,text:Wt,value:Wt};return{...Et,query:Wt,current:Zt,options:[Zt]}}return Et},getValueForUrl:ce=>ce.current.value,beforeAdding:ce=>({...(0,v.cloneDeep)(ce),originalQuery:ce.query})});var um=e(2272);x().move=G.b;const Zp=e(39572),yp=Zp.keys().map(ce=>Zp(ce));class Em{async init(){try{parent.postMessage("GrafanaAppInit","*");const ie=(0,El.JL)(q.Ay.bootData.user.language);ie.then(({language:Wt})=>(0,q._R)({language:Wt})),(0,M.u5)(Rd.IB),gm(),Ju(),(0,xc.j)("frontend_app_init"),(0,h.xS)(q.Ay.bootData.user.locale),(0,h.$D)(q.Ay.bootData.user.weekStart),(0,Y.Y)(Ug.m),(0,X.l)(pl),(0,z.e)(dh.a),(0,I.T)(R.Ny),(0,T.p)(ih),(0,y.G)(()=>q.Ay.bootData.user.timezone),Qc(),(0,S.l)(el.TP.user),(0,Tg.initAuthConfig)(),(0,L.H8)(Br.A),await ie,hm(),(0,um.U1)(),fm(),Sg(),b.D.setInit(Gl.H),b.G.setInit(Gl.u),D.h.setInit(nr),ec.B.setInit(()=>[sm(),Ua(),dm(),Gn(),Qs(),Ci(),dd(),ym()]),P.l.setInit(no),Mp(),(0,O.HC)(()=>new kg),fp(new Ah),(0,O.pC)(ql.BN),(0,j.se)({importPanelPlugin:Cc.TV,getPanelPluginFromCache:Cc.PY}),C.I.initialize({config:q.Ay,getTimeRangeForUrl:(0,Ki.jG)().timeRangeForUrl,getVariablesUrlParams:hs.z}),document.addEventListener("click",cg);const ve=new d.xq;ve.init(q.Ay.datasources,q.Ay.defaultDatasource),(0,N.h)(ve),Qg();const Re=new Xc;if(Re.register({pluginId:"grafana",extensionConfigs:wd()}),el.TP.user.orgRole!==""){const Wt=["cloud-home-app"],Zt=Object.values(q.Ay.apps).filter(In=>Wt.includes(In.id)),xn=Object.values(q.Ay.apps).filter(In=>!Wt.includes(In.id));Kd(xn,Re),await Kd(Zt,Re,"frontend_awaited_plugins_preload")}(0,F.cE)(_p(Re)),(0,U.Vu)(zg(Re)),(0,w.A)(Yi(Re));const He=R.Ny.getSearchObject(),st=new il.dk,ot=new bg(R.Ny,st),yt=new Wc;yt.start(),st.setKioskModeFromUrl(He.kiosk);try{(0,Yg.W1)()}catch(Wt){console.warn("Failed to clean up old expanded folders",Wt)}this.context={backend:Rd.IB,location:R.Ny,chrome:st,keybindings:ot,newAssetsChecker:yt,config:q.Ay},(0,B._)(cu.ni),(0,K._)(cu.k9),(0,E.H)(document.getElementById("reactRoot")).render((0,f.createElement)(ir.Nz,{app:this}))}catch(ie){console.error("Failed to start Grafana",ie),window.__grafana_load_failed()}finally{(0,xc.z)("frontend_app_init")}}}function hm(){yp.length>0&&yp[0].addExtensionReducers()}function fm(){yp.length>0&&yp[0].init()}function gm(){(0,W.H2)(new hg({debug:!1})),window.addEventListener("load",ce=>{const ie="frontend_boot_load_time_seconds";performance&&(performance.mark(ie),iu("first-paint","frontend_boot_","_time_seconds"),iu("first-contentful-paint","frontend_boot_","_time_seconds"),iu(ie),iu("frontend_boot_js_done_time_seconds"),iu("frontend_boot_css_time_seconds"))}),el.TP.user.orgRole!==""&&(0,W.pl)(new qu({})),q.Ay.grafanaJavascriptAgent.enabled&&(0,W.pl)(new Eg({...q.Ay.grafanaJavascriptAgent,app:{version:q.Ay.buildInfo.version,environment:q.Ay.buildInfo.env},buildInfo:q.Ay.buildInfo,user:{id:String(q.Ay.bootData.user?.id),email:q.Ay.bootData.user?.email}})),q.Ay.googleAnalyticsId&&(0,W.pl)(new mg({googleAnalyticsId:q.Ay.googleAnalyticsId})),q.Ay.googleAnalytics4Id&&(0,W.pl)(new pg({googleAnalyticsId:q.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:q.Ay.googleAnalytics4SendManualPageViews})),q.Ay.rudderstackWriteKey&&q.Ay.rudderstackDataPlaneUrl&&(0,W.pl)(new vg({writeKey:q.Ay.rudderstackWriteKey,dataPlaneUrl:q.Ay.rudderstackDataPlaneUrl,user:q.Ay.bootData.user,sdkUrl:q.Ay.rudderstackSdkUrl,configUrl:q.Ay.rudderstackConfigUrl,integrationsUrl:q.Ay.rudderstackIntegrationsUrl,buildInfo:q.Ay.buildInfo})),q.Ay.applicationInsightsConnectionString&&(0,W.pl)(new gg({connectionString:q.Ay.applicationInsightsConnectionString,endpointUrl:q.Ay.applicationInsightsEndpointUrl}))}function iu(ce,ie="",ve=""){const Re=x().first(performance.getEntriesByName(ce));if(Re){const He=Re.name.replace(/-/g,"_");(0,fg.n)(`${ie}${He}${ve}`,Math.round(Re.startTime)/1e3)}}const pm=new Em;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,pm.init()},60021:(k,A,e)=>{"use strict";e.d(A,{Or:()=>s,Oz:()=>i,RC:()=>n,ho:()=>l,nA:()=>r});var n=(g=>(g.Active="active",g.Expired="expired",g.Pending="pending",g))(n||{}),s=(g=>(g.Unprocessed="unprocessed",g.Active="active",g.Suppressed="suppressed",g))(s||{}),l=(g=>(g.equal="=",g.notEqual="!=",g.regex="=~",g.notRegex="!~",g))(l||{}),r=(g=>(g.Internal="internal",g.External="external",g.All="all",g))(r||{}),i=(g=>(g.cortex="cortex",g.mimir="mimir",g.prometheus="prometheus",g))(i||{})},91621:(k,A,e)=>{"use strict";e.d(A,{Dw:()=>g,Rx:()=>l,_W:()=>i,d$:()=>s});const n={statistics:[]};var s=(d=>(d[d.Insights=1]="Insights",d[d.Search=0]="Search",d))(s||{}),l=(d=>(d[d.Builder=0]="Builder",d[d.Code=1]="Code",d))(l||{});const r={parameters:[]};var i=(d=>(d.And="and",d.Function="function",d.FunctionParameter="functionParameter",d.GroupBy="groupBy",d.Operator="operator",d.Or="or",d.Property="property",d))(i||{}),g=(d=>(d.String="string",d))(g||{});const o={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(k,A,e)=>{"use strict";e.d(A,{Rx:()=>n.Rx,YZ:()=>s,b4:()=>l,d$:()=>n.d$});var n=e(91621),s=(r=>(r.Scheduled="Scheduled",r.Running="Running",r.Complete="Complete",r.Failed="Failed",r.Cancelled="Cancelled",r.Timeout="Timeout",r))(s||{}),l=(r=>(r.Regions="regions",r.Namespaces="namespaces",r.Metrics="metrics",r.DimensionKeys="dimensionKeys",r.DimensionValues="dimensionValues",r.EBSVolumeIDs="ebsVolumeIDs",r.EC2InstanceAttributes="ec2InstanceAttributes",r.ResourceArns="resourceARNs",r.Statistics="statistics",r.LogGroups="logGroups",r.Accounts="accounts",r))(l||{})},36666:(k,A,e)=>{"use strict";e.d(A,{A:()=>R});var n=e(74848),s=e(32196),l=e(92145),r=e(55127),i=e.n(r),g=e(96540),o=e(16817),d=e(52622),c=e(21103),a=e(40845),p=e(67061),u=e(88575),m=e(90182),v=e(94354),x=e(15292),f=e(62930),E=e(2913),h=e(14792),y=e(34842),b=e(31193),D=e(48514),P=e(45994);function C(S){return JSON.stringify(S)}function M(S,L){let O=L;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof y.H$&&(O=window.__grafanaSceneContext.state.editPanel?.state.panelId),S===O}const I=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function R({data:S,query:L,onChange:O,onRunQuery:j}){const{value:N}=(0,o.A)(()=>(0,b.tR)().get()),F=(0,g.useMemo)(()=>(0,h.UA)().getCurrent()?.getPanelById(L.panelId??-124134),[L.panelId]),{value:U,loading:w}=(0,o.A)(async()=>{if(!F||!S)return[];const ne=await(0,b.tR)().get(F.datasource);return Promise.all(F.targets.map(async le=>{const _=le.datasource?await(0,b.tR)().get(le.datasource):ne,Q=_.getQueryDisplayText||C,ae=(0,D.E)(S,le.refId)??S;return{refId:le.refId,query:Q(le),name:_.name,img:_.meta.info.logos.small,data:ae.series,error:ae.error}}))},[S,F]),B=(0,g.useCallback)(ne=>{O(ne),j()},[O,j]),K=(0,g.useCallback)(ne=>{B({...L,panelId:ne})},[L,B]),W=(0,g.useCallback)(()=>{B({...L,withTransforms:!L.withTransforms})},[L,B]),z=(0,g.useCallback)(ne=>{B({...L,topic:ne?d.QR.Annotations:void 0})},[L,B]),Y=(0,g.useCallback)(ne=>{const le=ne.datasource??N,_=(0,b.tR)().getInstanceSettings(le)?.name,Q=ne.targets.length;return`${Q} ${i()("query",Q)} to ${_}`},[N]),X=(0,h.UA)().getCurrent(),q=!!(L.withTransforms||F?.transformations?.length),G=(0,g.useMemo)(()=>X?.panels.filter(ne=>E.Ay.panels[ne.type]&&ne.targets&&!M(ne.id,X.panelInEdit?.id)&&ne.datasource?.uid!==P.K).map(ne=>({value:ne.id,label:ne.title??"Panel "+ne.id,description:Y(ne),imgUrl:E.Ay.panels[ne.type].info.logos.small}))??[],[X,Y]),te=(0,a.of)(T),H=(0,l.Bi)();if(!X)return null;if(G.length<1)return(0,n.jsx)("p",{className:te.noQueriesText,children:"This dashboard does not have any other panels. Add queries to other panels and try again."});const se=G.find(ne=>ne.value===L.panelId);return(0,n.jsx)(c.i,{children:(0,n.jsxs)(p.B,{direction:"column",children:[(0,n.jsxs)(p.B,{gap:3,children:[(0,n.jsx)(u.D,{label:"Source panel",description:"Use query results from another panel",children:(0,n.jsx)(m.l6,{inputId:H,placeholder:"Choose panel",isSearchable:!0,options:G,value:se,onChange:ne=>K(ne.value)})}),(0,n.jsx)(u.D,{label:"Data",description:"Use data or annotations from the panel",children:(0,n.jsx)(v.z,{options:I,value:L.topic===d.QR.Annotations,onChange:z})}),q&&(0,n.jsx)(u.D,{label:"Transform",description:"Apply transformations from the source panel",children:(0,n.jsx)(x.K,{value:!!L.withTransforms,onChange:W})})]}),w?(0,n.jsx)(f.y,{}):(0,n.jsx)(n.Fragment,{children:U&&!!U.length&&(0,n.jsx)(u.D,{label:"Queries from panel",children:(0,n.jsx)(p.B,{direction:"column",children:U.map((ne,le)=>(0,n.jsxs)(p.B,{alignItems:"center",gap:1,children:[(0,n.jsx)("div",{children:ne.refId}),(0,n.jsx)("img",{src:ne.img,alt:ne.name,title:ne.name,width:16}),(0,n.jsx)("div",{children:ne.query})]},le))})})})]})})}function T(S){return{noQueriesText:(0,s.css)({padding:S.spacing(1.25)})}}},14348:(k,A,e)=>{"use strict";e.d(A,{K:()=>o.K,kN:()=>d,mw:()=>c});var n=e(88483),s=e(52622),l=e(39070),r=e(43127),i=e(14792),g=e(34214),o=e(45994);function d(m){return m?typeof m=="string"?m===o.K:"meta"in m&&m.meta.name===o.K||m.uid===o.K:!1}function c(m,v){return new n.c(x=>{const f=(0,i.UA)().getCurrent(),E=a(m.queries);if(!E){x.next(p("Missing panel reference ID"));return}let h=f?.getPanelById(E,!0);if(h instanceof g.a||(h=new g.a(h)),!h){x.next(p("Unknown Panel: "+E));return}const y=h.getQueryRunner(),b=y.getData({withTransforms:!!v?.withTransforms,withFieldConfig:!1}).subscribe({next:D=>{v?.topic===s.QR.Annotations&&(D={...D,series:D.annotations??[],annotations:void 0}),x.next(D)}});if(!h.isInView&&h.refreshWhenInView||f?.otherPanelInFullscreen(h)){const{datasource:D,targets:P}=h,C={...m,datasource:D,panelId:E,queries:P};h.refreshWhenInView=!1,y.run(C)}return()=>{b.unsubscribe()}})}function a(m){if(!(!m||!m.length))return m[0].panelId}function p(m){return{state:l.Gu.Error,series:[],request:{},error:{message:m},timeRange:(0,r.E2)()}}var u=e(36666)},45994:(k,A,e)=>{"use strict";e.d(A,{K:()=>n});const n="-- Dashboard --",s="dashboard"},90183:(k,A,e)=>{"use strict";e.d(A,{i:()=>ge,o:()=>Oe});var n=e(2543),s=e(65474),l=e(62467),r=e(44240),i=e(81160),g=e(89667),o=e(39070),d=e(55004),c=e(37471),a=e(78368),p=e(14236),u=e(26657),m=e(72574),v=e(78731),x=e(17172),f=e(19347),E=e(79056),h=e(14792),y=e(74848),b=e(32196),D=e(96540),P=e(40845),C=e(84167),M=e(88575),I=e(90182),R=e(15292),T=e(99818),S=e(10154),L=e(68706),O=e(95093),j=e.n(O),N=e(91410),F=e(20333),U=e(55852),w=e(67061),B=e(17624),K=e(67459),W=e(79770),z=e(14578),Y=e(87266),X=e(16797);const q="time-of-day-picker-panel",G=({minuteStep:Ue=1,showHour:Xe=!0,showSeconds:we=!1,onChange:qe,value:We,size:Ce="auto",disabled:je,disabledHours:Ke,disabledMinutes:_e,disabledSeconds:Fe,placeholder:at,format:Ct="HH:mm",defaultValue:Dt=void 0,allowEmpty:tt=!1,width:ze})=>{const pe=(0,P.of)(H),Se=()=>ze?(0,b.css)`
        width: ${ze}px;
      `:(0,Y.lH)()[Ce];return(0,y.jsx)(W.A,{value:We,defaultValue:Dt,onChange:fe=>qe(fe),showHour:Xe,showSecond:we,format:Ct,allowEmpty:tt,className:(0,b.cx)(Se(),pe.input),popupClassName:(0,b.cx)(pe.picker,q),minuteStep:Ue,inputIcon:(0,y.jsx)(te,{wrapperStyle:pe.caretWrapper}),disabled:je,disabledHours:Ke,disabledMinutes:_e,disabledSeconds:Fe,placeholder:at})},te=({wrapperStyle:Ue=""})=>(0,y.jsx)("div",{className:Ue,children:(0,y.jsx)(z.I,{name:"angle-down"})}),H=Ue=>{const Xe=Ue.components.input.background,we=Ue.v1.palette.black,qe=Ue.colors.background.secondary,We=Ue.shape.radius.default,Ce=Ue.components.input.borderColor;return{caretWrapper:(0,b.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${Ue.colors.text.secondary};
    `,picker:(0,b.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${Xe};
        border-color: ${Ce};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${Ue.v1.palette.orange};
            border-radius: ${We};
          }

          &:hover {
            background: ${qe};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${Ue.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${we};
        background-color: ${Xe};
        border-color: ${Ce};
        border-radius: ${We};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${Xe};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,b.css)`
      .rc-time-picker-input {
        background-color: ${Xe};
        border-radius: ${We};
        border-color: ${Ce};
        height: ${Ue.spacing(4)};

        &:focus {
          ${(0,X.focusCss)(Ue)}
        }

        &:disabled {
          background-color: ${Ue.colors.action.disabledBackground};
          color: ${Ue.colors.action.disabledText};
          border: 1px solid ${Ue.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${Ue.colors.text.secondary};
      }
    `}},se=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((Ue,Xe)=>({label:Ue,value:Xe+1})),ne=({value:Ue,onChange:Xe})=>{const we=(0,P.of)(le),qe=Date.now(),We=(0,N.QZ)(Ue.timezone??"utc",qe),Ce=(0,h.UA)().getCurrent()?.getTimezone()===Ue.timezone,[je,Ke]=(0,D.useState)(!1),_e=()=>{Ke(!je)},Fe=fe=>{if(!fe)return;const Ee=j()();if(fe){const Pe=fe.split(":");Ee.set("hour",parseInt(Pe[0],10)),Ee.set("minute",parseInt(Pe[1],10))}return Ee},at=()=>{let fe="Everyday";return Ue.fromDayOfWeek&&!Ue.toDayOfWeek&&(fe=se[Ue.fromDayOfWeek-1].label),fe},Ct=()=>{const fe=(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(K.U,{title:We?.name}),(0,y.jsx)(B.X,{timeZone:Ue.timezone,timestamp:qe})]});return Ce?(0,y.jsxs)(y.Fragment,{children:["Dashboard timezone (",fe,")"]}):fe},Dt=(fe,Ee)=>{const Pe=fe?fe.format("HH:mm"):void 0;Xe(Ee==="from"?{...Ue,from:Pe}:{...Ue,to:Pe})},tt=fe=>{Xe({...Ue,timezone:fe})},ze=fe=>{const Ee=fe?fe.value:void 0,Pe=fe?Ue.toDayOfWeek:void 0;Xe({...Ue,fromDayOfWeek:Ee,toDayOfWeek:Pe})},pe=fe=>{Xe({...Ue,toDayOfWeek:fe?fe.value:void 0})},Se=()=>je?(0,y.jsx)(F.U,{value:Ue.timezone,includeInternal:!0,onChange:fe=>tt(fe),onBlur:()=>Ke(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,y.jsxs)("div",{className:we.timezoneContainer,children:[(0,y.jsx)("div",{className:we.timezone,children:Ct()}),(0,y.jsx)(U.$n,{variant:"secondary",onClick:_e,size:"sm",children:"Change timezone"})]});return(0,y.jsxs)(C.n,{className:we.wrapper,children:[(0,y.jsx)(M.D,{label:"From",children:(0,y.jsxs)(w.B,{gap:.5,children:[(0,y.jsx)(I.l6,{options:se,isClearable:!0,placeholder:"Everyday",value:Ue.fromDayOfWeek??null,onChange:fe=>ze(fe),width:20}),(0,y.jsx)(G,{value:Fe(Ue.from),onChange:fe=>Dt(fe,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,y.jsx)(M.D,{label:"To",children:(0,y.jsxs)(w.B,{gap:.5,children:[(Ue.fromDayOfWeek||Ue.toDayOfWeek)&&(0,y.jsx)(I.l6,{options:se,isClearable:!0,placeholder:at(),value:Ue.toDayOfWeek??null,onChange:fe=>pe(fe),width:20}),(0,y.jsx)(G,{value:Fe(Ue.to),onChange:fe=>Dt(fe,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,y.jsx)(M.D,{label:"Timezone",children:Se()})]})},le=Ue=>({wrapper:(0,b.css)({maxWidth:Ue.spacing(60),marginBottom:Ue.spacing(2)}),timezoneContainer:(0,b.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,b.css)`
      margin-right: 5px;
    `}),_="Enabling this returns annotations that match any of the tags specified below",Q=(0,y.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),ae=[{label:"Dashboard",value:L.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:L.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],oe=[{label:"Annotations & Alerts",value:L.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:L.nj.TimeRegions,description:"Configure a repeating time region"}],J=[10,50,100,200,300,500,1e3,2e3].map(Ue=>({label:String(Ue),value:Ue}));function ee({query:Ue,onChange:Xe}){const we=Ue,{limit:qe,matchAny:We,tags:Ce,type:je,queryType:Ke}=we;let _e=Ke??L.nj.Annotations;const Fe=(0,D.useMemo)(()=>(0,h.UA)().dashboard?.getTimezone(),[]),at=(0,P.of)(de),Ct=fe=>Xe({...we,type:fe.value}),Dt=fe=>Xe({...we,limit:fe.value}),tt=fe=>Xe({...we,matchAny:fe.target.checked}),ze=fe=>Xe({...we,tags:fe}),pe=fe=>{const Ee={...we,queryType:fe.value};Ee.queryType===L.nj.TimeRegions?Ee.timeRegion||(Ee.timeRegion={timezone:Fe}):delete Ee.timeRegion,Xe(Ee)},Se=fe=>{Xe({...we,timeRegion:fe})};return(0,y.jsxs)(C.n,{className:at.container,children:[(0,y.jsx)(M.D,{label:"Query type",children:(0,y.jsx)(I.l6,{inputId:"grafana-annotations__query-type",options:oe,value:_e,onChange:pe})}),_e===L.nj.Annotations&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(M.D,{label:"Filter by",children:(0,y.jsx)(I.l6,{inputId:"grafana-annotations__filter-by",options:ae,value:je,onChange:Ct})}),(0,y.jsx)(M.D,{label:"Max limit",children:(0,y.jsx)(I.l6,{inputId:"grafana-annotations__limit",width:16,options:J,value:qe,onChange:Dt})}),je===L.St.Tags&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(M.D,{label:"Match any",description:_,children:(0,y.jsx)(R.d,{id:"grafana-annotations__match-any",value:We,onChange:tt})}),(0,y.jsx)(M.D,{label:"Tags",description:Q,children:(0,y.jsx)(T.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:ze,tagOptions:S.vy,tags:Ce??[]})})]})]}),_e===L.nj.TimeRegions&&we.timeRegion&&(0,y.jsx)(ne,{value:we.timeRegion,onChange:Se})]})}const de=Ue=>({container:(0,b.css)({maxWidth:Ue.spacing(60),marginBottom:Ue.spacing(2)})});var xe=e(11261),re=e(94515);function ue(Ue,Xe,we,qe){if(!Xe)return;const We=(0,re.iU)(Xe,we);if(!We.length)return;const Ce=[],je=[],Ke=[],_e=Xe.timezone??qe;for(const Fe of We){let at=Fe.from,Ct=Fe.to;const Dt=(0,N.QZ)(_e,at);if(Dt){const tt=Dt.offsetInMins*60*1e3;at+=tt,Ct+=tt}Ce.push(at),je.push(Ct),Ke.push(Ue)}return{fields:[{name:"time",type:xe.PU.time,values:Ce,config:{}},{name:"timeEnd",type:xe.PU.time,values:je,config:{}},{name:"text",type:xe.PU.string,values:Ke,config:{}}],length:Ce.length}}let Te=100;class ge extends u.iy{constructor(Xe){super(Xe),this.annotations={QueryEditor:ee,prepareAnnotation(we){return we.target=we.target??{type:we.type??L.St.Dashboard,limit:we.limit??100,tags:we.tags??[],matchAny:we.matchAny??!1},we},prepareQuery(we){let qe;if((0,n.isString)(we.datasource)){const je=(0,E.og)(we.datasource,{returnDefaultAsNull:!1});je&&(qe=je)}else qe=we.datasource;const{filter:We,...Ce}=we;return{...Ce,refId:we.name,queryType:L.nj.Annotations,datasource:qe}}}}getDefaultQuery(){return{queryType:L.nj.RandomWalk}}query(Xe){const we=[],qe=[],We=(0,m.w)();for(const Ce of Xe.targets){if(Ce.queryType===L.nj.Annotations)return(0,s.H)(this.getAnnotations({range:Xe.range,rangeRaw:Xe.range.raw,annotation:Ce,dashboard:(0,h.UA)().getCurrent()}));if(!Ce.hide){if(Ce.queryType===L.nj.Snapshot){we.push((0,l.of)({data:(Ce.snapshot??[]).map(je=>(0,g.or)(je)),state:o.Gu.Done}));continue}if(Ce.queryType===L.nj.TimeRegions){const je=ue("",Ce.timeRegion,Xe.range,Xe.timezone);we.push((0,l.of)({data:je?[je]:[],state:o.Gu.Done}));continue}if(Ce.queryType===L.nj.LiveMeasurements){let je=We.replace(Ce.channel,Xe.scopedVars);const{filter:Ke}=Ce,_e=(0,d.DG)(je);if(!(0,d.aj)(_e))continue;const Fe={maxLength:Xe.maxDataPoints??500};Ce.buffer?(Fe.maxDelta=Ce.buffer,Fe.maxLength=Fe.maxLength*2):Xe.rangeRaw?.to==="now"&&(Fe.maxDelta=Xe.range.to.valueOf()-Xe.range.from.valueOf()),we.push((0,v.oF)().getDataStream({key:`${Xe.requestId}.${Te++}`,addr:_e,filter:Ke,buffer:Fe}))}else Ce.queryType||(Ce.queryType=L.nj.RandomWalk),qe.push(Ce)}}return qe.length&&we.push(super.query({...Xe,targets:qe})),we.length?we.length===1?we[0]:(0,r.h)(...we):(0,l.of)()}listFiles(Xe,we){return this.query({targets:[{refId:"A",queryType:L.nj.List,path:Xe}],maxDataPoints:we}).pipe((0,i.T)(qe=>{const We=qe.data[0]??new c.k;return new a.R(We)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Xe){const we=Xe.annotation.target;if(we?.queryType===L.nj.TimeRegions){const Ke=ue(Xe.annotation.name,we.timeRegion,Xe.range,(0,h.UA)().getCurrent()?.timezone);return Promise.resolve({data:Ke?[Ke]:[]})}const qe=Xe.annotation,We=qe.target,Ce={from:Xe.range.from.valueOf(),to:Xe.range.to.valueOf(),limit:We.limit,tags:We.tags,matchAny:We.matchAny};if(We.type===L.St.Dashboard){if(!Xe.dashboard?.uid)return Promise.resolve({data:[]});Ce.dashboardUID=Xe.dashboard.uid,delete Ce.tags}else{if(!Array.isArray(We.tags)||We.tags.length===0)return Promise.resolve({data:[]});const Ke=(0,m.w)(),_e="__delimiter__",Fe=[];for(const at of Ce.tags){const Ct=Ke.replace(at,{},Dt=>typeof Dt=="string"?Dt:Dt.join(_e));for(const Dt of Ct.split(_e))Fe.push(Dt)}Ce.tags=Fe}const je=await(0,x.AI)().get("/api/annotations",Ce,`grafana-data-source-annotations-${qe.name}-${Xe.dashboard?.uid}`);return{data:[(0,p.Vc)(je)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function Oe(){return await(0,f.l)().get("-- Grafana --")}},68706:(k,A,e)=>{"use strict";e.d(A,{St:()=>r,dx:()=>l,nj:()=>n,uJ:()=>s});var n=(i=>(i.LiveMeasurements="measurements",i.Annotations="annotations",i.Snapshot="snapshot",i.TimeRegions="timeRegions",i.RandomWalk="randomWalk",i.List="list",i.Read="read",i.Search="search",i))(n||{});const s={refId:"A",queryType:"randomWalk"},l={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var r=(i=>(i.Dashboard="dashboard",i.Tags="tags",i))(r||{})},90478:(k,A,e)=>{"use strict";e.d(A,{H:()=>o,j:()=>c});var n=e(89667),s=e(28138),l=e(57220),r=e(40489),i=e(28444),g=e(68706);function o(a,p){return new Promise(u=>{if(a.datasource?.uid===l.vv){d(p,a),u(!0);return}s.A.publish(new i.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{d(p,a),u(!0)},onDismiss:()=>{u(!1)}}))})}function d(a,p){const u=a.map(v=>(0,n.Nw)(v)),m={refId:"A",queryType:g.nj.Snapshot,snapshot:u,datasource:{uid:l.vv}};p.updateQueries({dataSource:{uid:l.vv},queries:[m]}),p.refresh()}function c(a){return(p,u,m)=>{r.vI(p).subscribe(async v=>{const x=[];v.dataFrames.forEach(f=>{const E=(0,n.Nw)(f);x.push(E)}),a({...g.dx,snapshot:x,file:v.file},u)})}}},64100:(k,A,e)=>{"use strict";e.d(A,{Q$:()=>l,U3:()=>s,ti:()=>r});var n=(i=>(i.Builder="builder",i.Code="code",i))(n||{}),s=(i=>(i.Instant="instant",i.Range="range",i.Stream="stream",i))(s||{}),l=(i=>(i.DataSample="dataSample",i.InfiniteScroll="infiniteScroll",i.LogsSample="logsSample",i.LogsVolume="logsVolume",i))(l||{}),r=(i=>(i.Backward="backward",i.Forward="forward",i))(r||{})},71713:(k,A,e)=>{"use strict";e.d(A,{AW:()=>g,Ay:()=>d,RQ:()=>r,dZ:()=>n,fV:()=>i,vB:()=>o});const n=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],s=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],l=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],r=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],i=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],g=[...n,...r,...i],o={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...s,...l].map(c=>c.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${g.map(c=>c.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},d=o},13137:(k,A,e)=>{"use strict";e.d(A,{HD:()=>l,Q$:()=>n.Q$,U3:()=>n.U3,ie:()=>r,ti:()=>n.ti});var n=e(64100),s=(i=>(i.Stream="streams",i.Vector="vector",i.Matrix="matrix",i))(s||{}),l=(i=>(i.Indexed="I",i.StructuredMetadata="S",i.Parsed="P",i))(l||{}),r=(i=>(i[i.LabelNames=0]="LabelNames",i[i.LabelValues=1]="LabelValues",i))(r||{})},14678:(k,A,e)=>{"use strict";e.d(A,{N8:()=>y,qM:()=>h,uv:()=>E});var n=e(2543),s=e.n(n),l=e(62467),r=e(65474),i=e(45650),g=e(69862),o=e(81160),d=e(9084),c=e(66847),a=e(93031),p=e(71030),u=e(40187),m=e(39070),v=e(72574),x=e(19347),f=e(12091);const E="-- Mixed --",h=(D,P)=>`mixed-${D}-${P||""}`;class y extends u.mA{constructor(P){super(P)}query(P){const C=P.targets.filter(R=>R.datasource?.uid!==E);if(!C.length)return(0,l.of)({data:[]});const M=(0,n.groupBy)(C,"datasource.uid"),I=[];for(const R in M)I.push(...this.getBatchesForQueries(M[R],P));return I.length?this.batchQueries(I,P):(0,l.of)({data:[]})}getBatchesForQueries(P,C){const M=P[0].datasource,I=[],R=(0,v.w)().replace(M?.uid,C.scopedVars,(T,S)=>{if(!Array.isArray(T))return T;for(const L of T){if(L==="default")continue;const O=(0,x.l)().getInstanceSettings(L);I.push({datasource:(0,x.l)().get(L),queries:(0,n.cloneDeep)(P),scopedVars:{...C.scopedVars,[S.name]:{value:L,text:O?.name}}})}return""});return R!==""&&I.push({datasource:(0,x.l)().get(R),queries:(0,n.cloneDeep)(P),scopedVars:{...C.scopedVars}}),I}batchQueries(P,C){const M=P.filter(this.isQueryable).map((I,R)=>(0,r.H)(I.datasource).pipe((0,g.Z)(T=>{const S=(0,n.cloneDeep)(C);return S.requestId=h(R,S.requestId),S.targets=I.queries,S.scopedVars=I.scopedVars,(0,r.H)(T.query(S)).pipe((0,o.T)(L=>({...L,data:L.data||[],state:m.Gu.Loading,key:h(R,L.key)})),(0,d.$)(),(0,c.W)(L=>(L=(0,f.u)(L),L.message=`${T.name}: ${L.message}`,(0,l.of)([{data:[],state:m.Gu.Error,error:L,key:h(R,S.requestId)}]))))})));return(0,i.p)(M).pipe(b(),(0,o.T)(this.finalizeResponses),(0,a.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(P){return P&&Array.isArray(P.queries)&&P.queries.length>0}finalizeResponses(P){const{length:C}=P;if(C===0)return P;const M=P.find(I=>I.state===m.Gu.Error);return M?P.push(M):P[C-1].state=m.Gu.Done,P}}function b(){return(0,p.T)((D,P)=>P.reduce((C,M)=>(C.push.apply(C,M),C),D),[])}},19071:(k,A,e)=>{"use strict";e.d(A,{cd:()=>z,xw:()=>N});var n=e(37471),s=e(11261);const l={filters:[],groupBy:[]};var r=(oe=>(oe.Done="done",oe.Error="error",oe.Pending="pending",oe.Streaming="streaming",oe))(r||{}),i=(oe=>(oe.Raw="raw",oe.Spans="spans",oe.Traces="traces",oe))(i||{}),g=(oe=>(oe.Intrinsic="intrinsic",oe.Resource="resource",oe.Span="span",oe.Unscoped="unscoped",oe))(g||{});function o(oe){const{nodes:J,edges:ee}=d(oe),[de,xe]=makeFrames();for(const re of J)de.add(re);for(const re of ee)xe.add(re);return[de,xe]}function d(oe){const J=[],ee=[],de=new DataFrameView(oe),xe=c(de),re=makeSpanMap(ue=>{if(ue>=oe.length)return;const Te=de.get(ue);return{span:{...Te},id:Te.spanID,parentIds:Te.parentSpanID?[Te.parentSpanID]:[]}});for(let ue=0;ue<de.length;ue++){const Te=de.get(ue),ge=re[Te.spanID].children.map(we=>{const qe=re[we].span;return[qe.startTime,qe.startTime+qe.duration]}),Oe=getNonOverlappingDuration(ge),Ue=Te.duration-Oe,Xe=getStats(Te.duration,xe,Ue);J.push({[Fields.id]:Te.spanID,[Fields.title]:Te.serviceName??"",[Fields.subTitle]:Te.operationName,[Fields.mainStat]:Xe.main,[Fields.secondaryStat]:Xe.secondary,[Fields.color]:Ue/xe}),Te.parentSpanID&&re[Te.parentSpanID].span&&ee.push({[Fields.id]:Te.parentSpanID+"--"+Te.spanID,[Fields.target]:Te.spanID,[Fields.source]:Te.parentSpanID})}return{nodes:J,edges:ee}}function c(oe){let J=0,ee=1/0;for(let de=0;de<oe.length;de++){const xe=oe.get(de);xe.startTime<ee&&(ee=xe.startTime),xe.startTime+xe.duration>J&&(J=xe.startTime+xe.duration)}return J-ee}const a="traces_service_graph_request_server_seconds_sum",p="traces_service_graph_request_total",u="traces_service_graph_request_failed_total",m="traces_service_graph_request_server_seconds_bucket",v={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},x={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},f={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},E='span_kind="SPAN_KIND_SERVER"',h=[a,p,u,m];function y(oe,J){const ee=D(oe),de={},xe={};return C(ee[p],"total",p,de,xe),C(ee[a],"seconds",a,de,xe),C(ee[u],"failed",u,de,xe),M(de,xe,J)}function b(){function oe(de,xe){return new MutableDataFrame({name:de,fields:xe,meta:{preferredVisualisationType:"nodeGraph"}})}const J=oe("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),ee=oe("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[J,ee]}function D(oe){return(oe[0]?.data||[]).reduce((J,ee)=>{const de=toDataFrame(ee);return J[de.refId??"A"]=new DataFrameView(de),J},{})}var P=(oe=>(oe.sourceName="sourceName",oe.sourceNamespace="sourceNamespace",oe.targetName="targetName",oe.targetNamespace="targetNamespace",oe))(P||{});function C(oe,J,ee,de,xe){if(!oe)return;const re=`Value #${ee}`;for(let ue=0;ue<oe.length;ue++){const Te=oe.get(ue),ge=Te.server_service_namespace?`${Te.server_service_namespace}/${Te.server}`:Te.server,Oe=Te.client_service_namespace?`${Te.client_service_namespace}/${Te.client}`:Te.client,Ue=`${Oe}_${ge}`;xe[Ue]?xe[Ue][J]=(xe[Ue][J]||0)+Te[re]:xe[Ue]={target:ge,targetName:Te.server,targetNamespace:Te.server_service_namespace,source:Oe,sourceName:Te.client,sourceNamespace:Te.client_service_namespace,[J]:Te[re]},de[ge]?de[ge][J]=(de[ge][J]||0)+Te[re]:de[ge]={name:Te.server,namespace:Te.server_service_namespace,[J]:Te[re]},de[Oe]||(de[Oe]={name:Te.client,namespace:Te.client_service_namespace,[J]:0})}}function M(oe,J,ee){const[de,xe]=b();for(const re of Object.keys(oe)){const ue=oe[re];de.add({[Fields.id]:re,[Fields.title]:ue.name,[Fields.subTitle]:ue.namespace,[Fields.mainStat]:ue.total?ue.seconds/ue.total*1e3:Number.NaN,[Fields.secondaryStat]:ue.total?Math.round(ue.total*100)/100:Number.NaN,[Fields.arc+"success"]:ue.total?(ue.total-Math.min(ue.failed||0,ue.total))/ue.total:1,[Fields.arc+"failed"]:ue.total?Math.min(ue.failed||0,ue.total)/ue.total:0})}for(const re of Object.keys(J)){const ue=J[re];xe.add({[Fields.id]:re,[Fields.source]:ue.source,sourceName:ue.sourceName,sourceNamespace:ue.sourceNamespace,[Fields.target]:ue.target,targetName:ue.targetName,targetNamespace:ue.targetNamespace,[Fields.mainStat]:ue.total?ue.seconds/ue.total*1e3:Number.NaN,[Fields.secondaryStat]:ue.total?Math.round(ue.total*100)/100:Number.NaN})}return{nodes:de,edges:xe}}function I(oe){if(oe.stringValue)return oe.stringValue;if(oe.boolValue!==void 0)return!!oe.boolValue;if(oe.intValue!==void 0)return Number.parseInt(oe.intValue,10);if(oe.doubleValue)return Number.parseFloat(oe.doubleValue);if(oe.arrayValue){const J=[];for(const ee of oe.arrayValue.values)J.push(I(ee));return J}return""}function R(oe){const J=[];let ee="OTLPResourceNoServiceName";if(!oe)return{serviceName:ee,serviceTags:J};for(const de of oe.attributes)de.key===SemanticResourceAttributes.SERVICE_NAME&&(ee=de.value.stringValue||ee),J.push({key:de.key,value:I(de.value)});return{serviceName:ee,serviceTags:J}}function T(oe){const J=[];if(oe.attributes)for(const ee of oe.attributes)J.push({key:ee.key,value:I(ee.value)});return J}function S(oe){let J;if(oe.kind){const ee=oe.kind.toString().toLowerCase().split("_");J=ee.length?ee[ee.length-1]:oe.kind.toString()}return J}function L(oe){const J=[];if(oe.links)for(const ee of oe.links){const{traceId:de,spanId:xe}=ee,re=[];if(ee.attributes)for(const ue of ee.attributes)re.push({key:ue.key,value:I(ue.value)});J.push({traceID:de,spanID:xe,tags:re})}return J}function O(oe){const J=[];if(oe.events)for(const ee of oe.events){const de=[];if(ee.attributes)for(const xe of ee.attributes)de.push({key:xe.key,value:I(xe.value)});J.push({fields:de,timestamp:ee.timeUnixNano/1e6})}return J}function j(oe,J=!1){const ee=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const xe of oe){const{serviceName:re,serviceTags:ue}=R(xe.resource);for(const Te of xe.instrumentationLibrarySpans)for(const ge of Te.spans)ee.add({traceID:ge.traceId.length>16?ge.traceId.slice(16):ge.traceId,spanID:ge.spanId,parentSpanID:ge.parentSpanId||"",operationName:ge.name||"",serviceName:re,kind:S(ge),statusCode:ge.status?.code,statusMessage:ge.status?.message,instrumentationLibraryName:Te.instrumentationLibrary?.name,instrumentationLibraryVersion:Te.instrumentationLibrary?.version,traceState:ge.traceState,serviceTags:ue,startTime:ge.startTimeUnixNano/1e6,duration:(ge.endTimeUnixNano-ge.startTimeUnixNano)/1e6,tags:T(ge),logs:O(ge),references:L(ge)})}}catch(xe){return console.error(xe),{error:{message:"JSON is not valid OpenTelemetry format: "+xe},data:[]}}let de=[ee];return J&&de.push(...createGraphFrames(ee)),{data:de}}function N(oe){let J={batches:[]},ee={};for(let de=0;de<oe.length;de++){const xe=oe.get(de);ee[xe.serviceName]||(ee[xe.serviceName]=J.batches.length,J.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let re=ee[xe.serviceName];J.batches[re].resource.attributes.length===0&&(J.batches[re].resource.attributes=U(xe.serviceTags)),J.batches[re].instrumentationLibrarySpans[0].instrumentationLibrary||xe.instrumentationLibraryName&&(J.batches[re].instrumentationLibrarySpans[0].instrumentationLibrary={name:xe.instrumentationLibraryName,version:xe.instrumentationLibraryVersion?xe.instrumentationLibraryVersion:""}),J.batches[re].instrumentationLibrarySpans[0].spans.push({traceId:xe.traceID.padStart(32,"0"),spanId:xe.spanID,parentSpanId:xe.parentSpanID||"",traceState:xe.traceState||"",name:xe.operationName,kind:F(xe.kind),startTimeUnixNano:xe.startTime*1e6,endTimeUnixNano:(xe.startTime+xe.duration)*1e6,attributes:xe.tags?U(xe.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:B(xe),events:K(xe.logs),links:W(xe.references)})}return J}function F(oe){let J;if(oe)switch(oe){case"server":J="SPAN_KIND_SERVER";break;case"client":J="SPAN_KIND_CLIENT";break;case"producer":J="SPAN_KIND_PRODUCER";break;case"consumer":J="SPAN_KIND_CONSUMER";break;case"internal":J="SPAN_KIND_INTERNAL";break}return J}function U(oe){return oe.reduce((J,ee)=>[...J,{key:ee.key,value:w(ee)}],[])}function w(oe){if(typeof oe.value=="string")return{stringValue:oe.value};if(typeof oe.value=="boolean")return{boolValue:oe.value};if(typeof oe.value=="number")return oe.value%1===0?{intValue:oe.value}:{doubleValue:oe.value};if(typeof oe.value=="object"&&Array.isArray(oe.value)){const J=[];for(const ee of oe.value)J.push(w(ee));return{arrayValue:{values:J}}}return{stringValue:oe.value}}function B(oe){let J;return oe.statusCode!==void 0&&(J={code:oe.statusCode,message:oe.statusMessage?oe.statusMessage:""}),J}function K(oe){if(!oe||!oe.length)return;let J=[];for(const ee of oe){let de={timeUnixNano:ee.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:""};for(const xe of ee.fields)de.attributes.push({key:xe.key,value:w(xe)});J.push(de)}return J}function W(oe){if(!oe||!oe.length)return;let J=[];for(const ee of oe){let de={traceId:ee.traceID,spanId:ee.spanID,attributes:[],droppedAttributesCount:0};if(ee.tags?.length)for(const xe of ee.tags)de.attributes?.push({key:xe.key,value:w(xe)});J.push(de)}return J}const z="Related profiles";function Y(oe,J,ee=!1){const de=oe.data[0];if(!de)return ae;const re=J?.jsonData?.tracesToProfiles;let ue;if(re?.datasourceUid&&(ue=getDataSourceSrv().getInstanceSettings(re.datasourceUid)),re&&ue){const ge=re.customQuery?re.query:void 0,Oe={title:z,url:"",internal:{datasourceUid:ue.uid,datasourceName:ue.name,query:{labelSelector:ge||"{${__tags}}",groupBy:[],profileTypeId:re.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};de.fields.forEach(Ue=>{Ue.name==="tags"&&(Ue.config.links=[Oe])})}let Te=[...oe.data];return ee&&Te.push(...createGraphFrames(toDataFrame(de))),{...oe,data:Te}}function X(oe){return{traceID:oe.traceID,startTime:parseInt(oe.startTimeUnixNano,10)/1e6,traceDuration:oe.durationMs,traceService:oe.rootServiceName||"",traceName:oe.rootTraceName||""}}const q=oe=>oe.stringValue?`"${oe.stringValue}"`:""+(oe.intValue||oe.doubleValue||oe.boolValue||'""');function G(oe,J){return J.series.map((de,xe)=>{const re={};de.labels?.forEach(Te=>{re[Te.key]=q(Te.value)});let ue=J.series.length===1?oe:"";return de.labels&&(de.labels.length===1?ue=q(de.labels[0].value):ue=`{${de.labels.map(Te=>`${Te.key}=${q(Te.value)}`).join(", ")}}`),createDataFrame({refId:ue||`A${xe}`,fields:[{name:"time",type:FieldType.time,values:de.samples.map(Te=>parseInt(Te.timestampMs,10))},{name:ue,labels:re,type:FieldType.number,values:de.samples.map(Te=>Te.value),config:{displayNameFromDS:ue}}],meta:{preferredVisualisationType:"graph"}})})}function te(oe,J,ee){switch(ee){case SearchTableType.Spans:return ne(oe,J);case SearchTableType.Raw:return H(oe);default:return se(oe,J)}}function H(oe){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(oe,null,2)]}]})]}function se(oe,J){const ee=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:J.uid,datasourceName:J.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return oe?.length?(ee.length=oe.length,oe.sort((de,xe)=>parseInt(xe?.startTimeUnixNano,10)/1e6-parseInt(de?.startTimeUnixNano,10)/1e6).forEach(de=>{const xe=X(de);ee.fields[0].values.push(xe.traceID),ee.fields[1].values.push(xe.startTime),ee.fields[2].values.push(xe.traceService),ee.fields[3].values.push(xe.traceName),ee.fields[4].values.push(xe.traceDuration?xe.traceDuration:"<1ms"),de.spanSets?ee.fields[5].values.push(de.spanSets.map(re=>_(de,re,J))):de.spanSet&&ee.fields[5].values.push([_(de,de.spanSet,J)])}),[ee]):[ee]}function ne(oe,J){const ee={};let de=!1;oe?.forEach(re=>le(re).forEach(ue=>{ue.attributes?.forEach(Te=>{ee[Te.key]={name:Te.key,type:FieldType.string,config:{displayNameFromDS:Te.key}}}),ue.spans.forEach(Te=>{Te.name&&(de=!0),Te.attributes?.forEach(ge=>{ee[ge.key]={name:ge.key,type:FieldType.string,config:{displayNameFromDS:ge.key}}})})}));const xe=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:J.uid,datasourceName:J.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!de}}},...Object.values(ee).sort((re,ue)=>re.name.localeCompare(ue.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!oe||!oe.length?[xe]:(oe.sort((re,ue)=>parseInt(ue?.startTimeUnixNano,10)/1e6-parseInt(re?.startTimeUnixNano,10)/1e6).forEach(re=>{le(re).forEach(ue=>{ue.spans.forEach(Te=>{xe.add(Q(Te,ue,re))})})}),[xe])}const le=oe=>oe.spanSets||(oe.spanSet?[oe.spanSet]:[]),_=(oe,J,ee)=>{const de={};let xe=!1;J.attributes?.map(Te=>{de[Te.key]={name:Te.key,type:FieldType.string,config:{displayNameFromDS:Te.key},values:[]}}),J.spans.forEach(Te=>{Te.name&&(xe=!0),Te.attributes?.forEach(ge=>{de[ge.key]={name:ge.key,type:FieldType.string,config:{displayNameFromDS:ge.key},values:[]}})});const re=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:ee.uid,datasourceName:ee.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!xe}}},...Object.values(de).sort((Te,ge)=>Te.name.localeCompare(ge.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),ue=createTheme();for(const Te of re.fields)Te.display=getDisplayProcessor({field:Te,theme:ue});return J.spans.forEach(Te=>{re.add(Q(Te,J,oe))}),re};function Q(oe,J,ee){const de=parseInt(oe.startTimeUnixNano,10)/1e6,xe={traceIdHidden:ee.traceID,traceService:ee.rootServiceName||"",traceName:ee.rootTraceName||"",spanID:oe.spanID,time:de,duration:parseInt(oe.durationNanos,10),name:oe.name};let re=[];return J.attributes&&(re=re.concat(J.attributes)),oe.attributes&&(re=re.concat(oe.attributes)),re.forEach(ue=>{(ue.value.boolValue||ue.value.Value?.bool_value)&&(xe[ue.key]=ue.value.boolValue||ue.value.Value?.bool_value),(ue.value.doubleValue||ue.value.Value?.double_value)&&(xe[ue.key]=ue.value.doubleValue||ue.value.Value?.double_value),(ue.value.intValue||ue.value.Value?.int_value)&&(xe[ue.key]=ue.value.intValue||ue.value.Value?.int_value),(ue.value.stringValue||ue.value.Value?.string_value)&&(xe[ue.key]=ue.value.stringValue||ue.value.Value?.string_value)}),xe}const ae={data:[new n.k({fields:[{name:"trace",type:s.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(k,A,e)=>{"use strict";e.d(A,{nE:()=>r,r6:()=>l,xB:()=>n});var n=(i=>(i[i.AlphaAsc=1]="AlphaAsc",i[i.AlphaDesc=2]="AlphaDesc",i[i.Importance=3]="Importance",i[i.TimeAsc=4]="TimeAsc",i[i.TimeDesc=5]="TimeDesc",i))(n||{}),s=(i=>(i.Current="current",i.RecentChanges="changes",i))(s||{}),l=(i=>(i.Default="default",i.Custom="custom",i))(l||{}),r=(i=>(i.List="list",i.Stat="stat",i))(r||{})},39758:(k,A,e)=>{"use strict";e.d(A,{mn:()=>g,ur:()=>s});var n=e(97706);const s=1,l=2,r=3,i=(o,d,c,a)=>(0,n.h)(d+o*(c+a),6);function g(o,d,c,a,p){let u=1-d,m=c===s?u/(o-1):c===l?u/o:c===r?u/(o+1):0;(isNaN(m)||m===1/0)&&(m=0);let v=c===s?0:c===l?m/2:c===r?m:0,x=d/o,f=(0,n.h)(x,6);if(a==null)for(let E=0;E<o;E++)p(E,i(E,v,x,m),f);else p(a,i(a,v,x,m),f)}},4134:(k,A,e)=>{"use strict";e.d(A,{C$:()=>g,HY:()=>i,Tr:()=>r,ur:()=>l});const n=10,s=4;function l(o,d,c,a,p,u){return o>=c&&o<=p&&d>=a&&d<=u}function r(o,d,c){let a=[];if(o.o.length&&a.push(...o.o.filter(p=>(d==null||p.sidx===d)&&(c==null||p.didx===c))),o.q)for(let p=0;p<o.q.length;p++)a.push(...r(o.q[p],d,c));return a}function i(o,d){return o.x<=d.x+d.w&&o.x+o.w>=d.x&&o.y+o.h>=d.y&&o.y<=d.y+d.h}class g{constructor(d,c,a,p,u=0){this.x=d,this.y=c,this.w=a,this.h=p,this.l=u,this.o=[],this.q=null}split(){let d=this,c=d.x,a=d.y,p=d.w/2,u=d.h/2,m=d.l+1;d.q=[new g(c+p,a,p,u,m),new g(c,a,p,u,m),new g(c,a+u,p,u,m),new g(c+p,a+u,p,u,m)]}quads(d,c,a,p,u){let m=this,v=m.q,x=m.x+m.w/2,f=m.y+m.h/2,E=c<f,h=d<x,y=d+a>x,b=c+p>f;E&&y&&u(v[0]),h&&E&&u(v[1]),h&&b&&u(v[2]),y&&b&&u(v[3])}add(d){let c=this;if(c.q!=null)c.quads(d.x,d.y,d.w,d.h,a=>{a.add(d)});else{let a=c.o;if(a.push(d),a.length>n&&c.l<s){c.split();for(let p=0;p<a.length;p++){let u=a[p];c.quads(u.x,u.y,u.w,u.h,m=>{m.add(u)})}c.o.length=0}}}get(d,c,a,p,u){let m=this,v=m.o;for(let x=0;x<v.length;x++)u(v[x]);m.q!=null&&m.quads(d,c,a,p,x=>{x.get(d,c,a,p,u)})}clear(){this.o.length=0,this.q=null}}},58384:(k,A,e)=>{"use strict";e.d(A,{d:()=>m,l:()=>v});var n=e(74848),s=e(2543),l=e.n(s),r=e(96540),i=e(47070),g=e(56323),o=e(52622),d=e(97696),c=e(59796),a=e(12509),p=e(2913),u=e(17516);class m extends r.PureComponent{constructor(){super(...arguments),this.renderComponent=(f,E)=>{const{options:h,fieldConfig:y}=this.props,{value:b,alignmentFactors:D,orientation:P,width:C,height:M,count:I}=f,{field:R,display:T,view:S,colIndex:L}=b,{openMenu:O,targetClassName:j}=E;let N;return S&&(0,s.isNumber)(L)&&(N=S.getFieldDisplayProcessor(L)),(0,n.jsx)(d.xE,{value:v(I,y.defaults,T),width:C,height:M,orientation:P,field:R,text:h.text,display:N,theme:p.config.theme2,itemSpacing:this.getItemSpacing(),displayMode:h.displayMode,onClick:O,className:j,alignmentFactors:I>1?D:void 0,showUnfilled:h.showUnfilled,valueDisplayMode:h.valueMode,namePlacement:h.namePlacement})},this.renderValue=f=>{const{value:E,orientation:h}=f,{hasLinks:y,getLinks:b}=E;return y&&b?(0,n.jsx)("div",{style:{width:"100%",display:h===i.wV.Vertical?"flex":"initial"},children:(0,n.jsx)(c.e,{style:{height:"100%"},links:b,children:D=>this.renderComponent(f,D)})}):this.renderComponent(f,{})},this.getValues=()=>{const{data:f,options:E,replaceVariables:h,fieldConfig:y,timeZone:b}=this.props;return(0,g.PI)({fieldConfig:y,reduceOptions:E.reduceOptions,replaceVariables:h,theme:p.config.theme2,data:f.series,timeZone:b})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:f,width:E,height:h}=this.props,{orientation:y}=f;return y===i.wV.Auto?E>h?i.wV.Vertical:i.wV.Horizontal:y}calcBarSize(){const{options:f}=this.props,E=this.getOrientation(),h=f.sizing===o.T6.Manual,y=E===i.wV.Vertical,b=E===i.wV.Horizontal,D=h&&y?f.minVizWidth:u.K.minVizWidth,P=h&&b?f.minVizHeight:u.K.minVizHeight,C=h&&b?f.maxVizHeight:u.K.maxVizHeight;return{minVizWidth:D,minVizHeight:P,maxVizHeight:C}}render(){const{height:f,width:E,options:h,data:y,renderCounter:b}=this.props,{minVizWidth:D,minVizHeight:P,maxVizHeight:C}=this.calcBarSize();return(0,n.jsx)(a.S,{source:y,getAlignmentFactors:g.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:b,width:E,height:f,maxVizHeight:C,minVizWidth:D,minVizHeight:P,itemSpacing:this.getItemSpacing(),orientation:h.orientation})}}function v(x,f,E){return x===1&&!f.displayName?{...E,title:void 0}:E}},17516:(k,A,e)=>{"use strict";e.d(A,{K:()=>s});var n=e(52622);const s={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},14738:(k,A,e)=>{"use strict";e.r(A),e.d(A,{plugin:()=>P});var n=e(65158),s=e(52622),l=e(71242),r=e(23799),i=e(63250);const g=C=>(0,i._$)(C),o=(C,M,I)=>{const R=(0,i.gl)(C,M,I);if(M==="singlestat"&&I.angular){const T=I.angular.gauge;T&&(R.showThresholdMarkers=T.thresholdMarkers,R.showThresholdLabels=T.thresholdLabels)}return R};var d=e(74848),c=e(96540),a=e(57875),p=e(56323),u=e(95164),m=e(59796),v=e(12509),x=e(2913),f=e(58384);const E={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:s.T6.Auto};class h extends c.PureComponent{constructor(){super(...arguments),this.renderComponent=(M,I)=>{const{options:R,fieldConfig:T}=this.props,{width:S,height:L,count:O,value:j}=M,{field:N,display:F}=j,{openMenu:U,targetClassName:w}=I;return(0,d.jsx)(u._,{value:(0,f.l)(O,T.defaults,F),width:S,height:L,field:N,text:R.text,showThresholdLabels:R.showThresholdLabels,showThresholdMarkers:R.showThresholdMarkers,theme:x.config.theme2,onClick:U,className:w,orientation:R.orientation})},this.renderValue=M=>{const{value:I}=M,{getLinks:R,hasLinks:T}=I;return T&&R?(0,d.jsx)(m.e,{links:R,style:{flexGrow:1},children:S=>this.renderComponent(M,S)}):this.renderComponent(M,{})},this.getValues=()=>{const{data:M,options:I,replaceVariables:R,fieldConfig:T,timeZone:S}=this.props;for(let L of M.series)for(let O of L.fields)if(O.config.unit==="percent"||O.config.unit==="percentunit"){const j=O.config.min??0,N=O.config.max??(O.config.unit==="percent"?100:1);O.state=O.state??{},O.state.range={min:j,max:N,delta:N-j},O.display=(0,a.J)({field:O,theme:x.config.theme2})}return(0,p.PI)({fieldConfig:T,reduceOptions:I.reduceOptions,replaceVariables:R,theme:x.config.theme2,data:M.series,timeZone:S})},this.calculateGaugeSize=()=>{const{options:M}=this.props,I=M.orientation,R=M.sizing===s.T6.Manual,T=I===s.wV.Vertical,S=I===s.wV.Horizontal,L=R&&T?M.minVizWidth:E.minVizWidth,O=R&&S?M.minVizHeight:E.minVizHeight;return{minVizWidth:L,minVizHeight:O}}}render(){const{height:M,width:I,data:R,renderCounter:T,options:S}=this.props,{minVizHeight:L,minVizWidth:O}=this.calculateGaugeSize();return(0,d.jsx)(v.S,{getValues:this.getValues,renderValue:this.renderValue,width:I,height:M,source:R,autoGrid:!0,renderCounter:T,orientation:S.orientation,minVizHeight:L,minVizWidth:O})}}var y=e(50082),b=e(38824);class D{getSuggestionsForData(M){const{dataSummary:I}=M;if(!I.hasData||!I.hasNumberField||I.numberFieldCount>=50)return;const R=M.getListAppender({name:b.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:y.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:T=>{T.options.reduceOptions.values&&(T.options.reduceOptions.limit=2)}}});I.hasStringField&&I.frameCount===1&&I.rowCountTotal<10?(R.append({name:b.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),R.append({name:b.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(R.append({name:b.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),R.append({name:b.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const P=new n.m(h).useFieldConfig({useCustomConfig:C=>{C.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(C=>{(0,r.L)(C),(0,r.h)(C),C.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:E.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:E.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:s.T6.Auto,label:"Auto"},{value:s.T6.Manual,label:"Manual"}]},defaultValue:E.sizing,showIf:M=>M.orientation!==s.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:E.minVizWidth,settings:{min:0,max:600,step:1},showIf:M=>M.sizing===s.T6.Manual&&M.orientation===s.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:E.minVizHeight,settings:{min:0,max:600,step:1},showIf:M=>M.sizing===s.T6.Manual&&M.orientation===s.wV.Horizontal}),l.I(C)}).setPanelChangeHandler(o).setSuggestionsSupplier(new D).setMigrationHandler(g)},19743:(k,A,e)=>{"use strict";e.d(A,{x:()=>i});var n=e(74848),s=e(96540),l=e(1173),r=e(74668);const i=({value:g,context:o,onChange:d})=>{const c=(0,s.useCallback)(a=>{d(a?.length?{id:l.jR.byRefId,options:a}:void 0)},[d]);return(0,n.jsx)(r.X,{value:g?.options,onChange:c,data:o.data,placeholder:"Change filter"})}},33744:(k,A,e)=>{"use strict";e.d(A,{DY:()=>r,G4:()=>o,Sq:()=>c,T5:()=>d,W_:()=>s,_7:()=>l,fX:()=>i,wq:()=>g,yQ:()=>a,yu:()=>p});var n=e(52622),s=(u=>(u.Point="point",u.Line="line",u.Polygon="polygon",u.Any="*any*",u))(s||{});const l=5;var r=(u=>(u.Left="left",u.Center="center",u.Right="right",u))(r||{}),i=(u=>(u.Top="top",u.Middle="middle",u.Bottom="bottom",u))(i||{}),g=(u=>(u.Left="left",u.Center="center",u.Right="right",u))(g||{}),o=(u=>(u.Top="top",u.Center="center",u.Bottom="bottom",u))(o||{});const d=Object.freeze({size:{fixed:l,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:n.q_.Fixed,fixed:"img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:n.WQ.Mod,min:-360,max:360}});var c=(u=>(u.color="fill",u.opacity="fill-opacity",u.lineWidth="stroke-width",u))(c||{}),a=(u=>(u.color="marker-color",u.size="marker-size",u))(a||{}),p=(u=>(u.color="stroke",u.lineWidth="stroke-width",u))(p||{})},61994:(k,A,e)=>{"use strict";e.d(A,{A:()=>r});var n=e(74848),s=e(32196),l=e(5636);const r=i=>(0,l.gU)(i)?(0,n.jsx)("a",{href:i,target:"_blank",className:(0,s.cx)("external-link"),rel:"noreferrer",children:i}):i},5636:(k,A,e)=>{"use strict";e.d(A,{Bz:()=>u,G_:()=>d,cA:()=>p,gU:()=>x,o3:()=>v,q:()=>m,rd:()=>a,ue:()=>g});var n=e(92347),s=e(40239),l=e(63577),r=e(90183),i=e(33744);function g(f,E,h,y){const b={};return y&&Object.keys(y).length?(b.color=(0,l.getColorDimension)(f,y.color??i.T5.color,h),b.size=(0,l.getScaledDimension)(f,y.size??i.T5.size),b.rotation=(0,l.getScalarDimension)(f,y.rotation??i.T5.rotation),y.text&&(y.text.field||y.text.fixed)&&(b.text=(0,l.getTextDimension)(f,y.text))):E.fields&&(E.fields.color&&(b.color=(0,l.getColorDimension)(f,E.config.color??i.T5.color,h)),E.fields.size&&(b.size=(0,l.getScaledDimension)(f,E.config.size??i.T5.size)),E.fields.text&&(b.text=(0,l.getTextDimension)(f,E.config.text)),E.fields.rotation&&(b.rotation=(0,l.getScalarDimension)(f,E.config.rotation??i.T5.rotation))),b}let o;function d(){return o||(o=[],c()),o}async function c(){const f=await(0,r.o)();for(let E of["maps","gazetteer"])f.listFiles(E).subscribe({next:h=>{h.forEach(y=>{if(y.name.endsWith(".geojson")){const b=`public/${E}/${y.name}`;o.push({value:b,label:b})}})}})}const a=(f,E,h)=>{const y=f.initMapView(E.view);return f.map=new n.A({view:y,pixelRatio:1,layers:[],controls:[],target:h,interactions:(0,s.N)({mouseWheelZoom:!1})})},p=(f,E)=>{f.initControls(E.controls),f.forceUpdate()},u=(f,E,h)=>{f.panelContext&&f.panelContext.onInstanceStateChange&&f.panelContext.onInstanceStateChange({map:f.map,layers:E,selected:h,actions:f.actions})},m=f=>{let E=f.layers.length;for(;E<100;){const h=`Layer ${E++}`;if(!f.byName.has(h))return h}return`Layer ${Date.now()}`};function v(f,E,h,y){const b=f.getPixelFromCoordinate(h),D=f.getPixelFromCoordinate(y),P=Math.abs(b[0]-D[0]),C=Math.abs(b[1]-D[1]);return P>E||C>E}const x=f=>{try{return new URL(f).protocol.includes("http")}catch{return!1}}},52995:(k,A,e)=>{"use strict";e.d(A,{P7:()=>s,uM:()=>l,iS:()=>r,KQ:()=>g});var n=e(52622),s=(o=>(o.Opacity="opacity",o.Scheme="scheme",o))(s||{}),l=(o=>(o.Exponential="exponential",o.Linear="linear",o))(l||{}),r=(o=>(o.X="x",o.Xy="xy",o.Y="y",o))(r||{});const i={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:n.yL.Auto,tooltip:{mode:n.$N.Single,yHistogram:!1,showColorScale:!1}},g={...i,color:{...i.color,mode:s.Scheme,scale:l.Exponential},yAxis:{...i.yAxis,axisPlacement:n.vM.Left},rowsFrame:{...i.rowsFrame,layout:n.D7.auto}}},69386:(k,A,e)=>{"use strict";e.d(A,{K:()=>a});var n=e(74848),s=e(32196),l=e(70255),r=e(80997),i=e(72724),g=e(40845),o=e(72129);function d({width:u,showImage:m,data:v,index:x}){const f=(0,g.of)(p),E=u>600,h=v.get(x),y=encodeURI(h.title);return(0,n.jsxs)("article",{"aria-labelledby":y,className:(0,s.cx)(f.item,E&&f.itemWide),children:[m&&h.ogImage&&(0,n.jsx)("a",{tabIndex:-1,href:r.sQ.sanitizeUrl(h.link),target:"_blank",rel:"noopener noreferrer",className:(0,s.cx)(f.socialImage,E&&f.socialImageWide),"aria-hidden":!0,children:(0,n.jsx)("img",{src:h.ogImage,alt:h.title})}),(0,n.jsxs)("div",{className:f.body,children:[(0,n.jsxs)("time",{className:f.date,dateTime:(0,i.LE)(h.date,{format:"MMM DD"}),children:[(0,i.LE)(h.date,{format:"MMM DD"})," "]}),(0,n.jsx)("a",{className:f.link,href:r.sQ.sanitizeUrl(h.link),target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)("h3",{className:f.title,id:y,children:h.title})}),(0,n.jsx)("div",{className:f.content,dangerouslySetInnerHTML:{__html:r.sQ.sanitize(h.content)}})]})]})}const c=({width:u,showImage:m,rootProps:v})=>{const x=(0,g.of)(p),f=u>600;return(0,n.jsxs)("div",{className:(0,s.cx)(x.item,f&&x.itemWide),...v,children:[m&&(0,n.jsx)(l.A,{containerClassName:(0,s.cx)(x.socialImage,f&&x.socialImageWide),width:f?"250px":"100%",height:f?"150px":u*.5}),(0,n.jsxs)("div",{className:x.body,children:[(0,n.jsx)(l.A,{containerClassName:x.date,width:60}),(0,n.jsx)(l.A,{containerClassName:x.title,width:250}),(0,n.jsx)(l.A,{containerClassName:x.content,width:"100%",count:6})]})]})},a=(0,o.j)(d,c),p=u=>({container:(0,s.css)({height:"100%"}),item:(0,s.css)({display:"flex",padding:u.spacing(1),position:"relative",marginBottom:u.spacing(.5),marginRight:u.spacing(1),borderBottom:`2px solid ${u.colors.border.weak}`,background:u.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,s.css)({flexDirection:"row"}),body:(0,s.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,s.css)({display:"flex",alignItems:"center",marginBottom:u.spacing(1),"> img":{width:"100%",borderRadius:`${u.shape.radius.default} ${u.shape.radius.default} 0 0`}}),socialImageWide:(0,s.css)({marginRight:u.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:u.shape.radius.default}}),link:(0,s.css)({color:u.colors.text.link,display:"inline-block","&:hover":{color:u.colors.text.link,textDecoration:"underline"}}),title:(0,s.css)({fontSize:"16px",marginBottom:u.spacing(.5)}),content:(0,s.css)({p:{marginBottom:u.spacing(.5),color:u.colors.text.primary}}),date:(0,s.css)({marginBottom:u.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${u.shape.radius.default}`,color:u.colors.text.secondary})})},62372:(k,A,e)=>{"use strict";e.d(A,{$:()=>n});const n="https://grafana.com/blog/news.xml"},4172:(k,A,e)=>{"use strict";e.d(A,{n:()=>u});var n=e(41053),s=e(78368);function l(m){const x=new DOMParser().parseFromString(m,"text/xml");return{items:Array.from(x.querySelectorAll("entry")).map(E=>({title:o(E,"title"),link:E.querySelector("link")?.getAttribute("href")??"",content:o(E,"content"),pubDate:o(E,"published"),ogImage:E.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function r(m){const x=new DOMParser().parseFromString(m,"text/xml");return{items:Array.from(x.querySelectorAll("item")).map(E=>({title:o(E,"title"),link:o(E,"link"),content:o(E,"description"),pubDate:o(E,"pubDate"),ogImage:E.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function i(m){return await(await fetch(m)).text()}function g(m){return new DOMParser().parseFromString(m,"text/xml").querySelector("feed")!==null}function o(m,v){return m.querySelector(v)?.textContent??""}async function d(m){const v=await i(m);return g(v)?l(v):r(v)}var c=e(47232),a=e(11261);function p(m){const v=[],x=[],f=[],E=[],h=[];for(const y of m.items){const b=(0,c.KQ)(y.pubDate);try{if(v.push(b.valueOf()),x.push(y.title),f.push(y.link),h.push(y.ogImage),y.content){const D=y.content.replace(/<\/?[^>]+(>|$)/g,"");E.push(D)}}catch(D){console.warn("Error reading news item:",D,y)}}return{fields:[{name:"date",type:a.PU.time,config:{displayName:"Date"},values:v},{name:"title",type:a.PU.string,config:{},values:x},{name:"link",type:a.PU.string,config:{},values:f},{name:"content",type:a.PU.string,config:{},values:E},{name:"ogImage",type:a.PU.string,config:{},values:h}],length:v.length}}function u(m){const[v,x]=(0,n.A)(async()=>{const f=await d(m),E=p(f);return new s.R(E)},[m],{loading:!0});return{state:v,getNews:x}}},23799:(k,A,e)=>{"use strict";e.d(A,{L:()=>g,h:()=>o});var n=e(69550),s=e(75059),l=e(28240),r=e(54479),i=e(52622);function g(d,c=!0){const a=["Value options"];d.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:a,defaultValue:!1}),d.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:a,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:p=>p.reduceOptions.values===!0}),d.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:a,editor:n.D.get("stats-picker").editor,defaultValue:[s.gy.lastNotNull],showIf:p=>p.reduceOptions.values===!1}),c&&d.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:a,settings:{allowCustomValue:!0,options:[],getOptions:async p=>{const u=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(p&&p.data)for(const m of p.data)for(const v of m.fields){const x=(0,l.Ct)(v,m,p.data),f=`/^${(0,r.jD)(x)}$/`;u.push({value:f,label:x})}return Promise.resolve(u)}},defaultValue:""})}function o(d,c){d.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:c,settings:{options:[{value:i.wV.Auto,label:"Auto"},{value:i.wV.Horizontal,label:"Horizontal"},{value:i.wV.Vertical,label:"Vertical"}]},defaultValue:i.wV.Auto})}},36373:(k,A,e)=>{"use strict";e.r(A),e.d(A,{plugin:()=>P});var n=e(65158),s=e(52622),l=e(71242),r=e(63250),i=e(24293);const g=(C,M,I)=>{const R=(0,r.gl)(C,M,I);if(I.angular&&(M==="singlestat"||M==="grafana-singlestat-panel")){const T=I.angular;if(R.graphMode=s.$p.None,T.sparkline&&T.sparkline.show&&(R.graphMode=s.$p.Area),T.colorBackground)R.colorMode=s.yp.Background;else if(T.colorValue)R.colorMode=s.yp.Value;else if(R.colorMode=s.yp.None,T.sparkline?.lineColor&&R.graphMode===s.$p.Area){const S=C.fieldConfig??{};S.defaults.color={mode:i.Y.Fixed,fixedColor:T.sparkline.lineColor},C.fieldConfig=S}T.valueName==="name"&&(R.textMode=s.SV.Name)}return R};var o=e(74848),d=e(2543),c=e(96540),a=e(11261),p=e(56323),u=e(90708),m=e(37494),v=e(59796),x=e(12509),f=e(2913);class E extends c.PureComponent{constructor(){super(...arguments),this.renderComponent=(M,I)=>{const{timeRange:R,options:T}=this.props,{value:S,alignmentFactors:L,width:O,height:j,count:N}=M,{openMenu:F,targetClassName:U}=I;let w=S.sparkline;return w&&(w.timeRange=R),(0,o.jsx)(m.yV,{value:S.display,count:N,sparkline:w,colorMode:T.colorMode,graphMode:T.graphMode,justifyMode:T.justifyMode,textMode:this.getTextMode(),alignmentFactors:L,text:T.text,width:O,height:j,theme:f.config.theme2,onClick:F,className:U,disableWideLayout:!T.wideLayout,percentChangeColorMode:T.percentChangeColorMode})},this.renderValue=M=>{const{value:I}=M,{getLinks:R,hasLinks:T}=I;return T&&R?(0,o.jsx)(v.e,{links:R,children:S=>this.renderComponent(M,S)}):this.renderComponent(M,{})},this.getValues=()=>{const{data:M,options:I,replaceVariables:R,fieldConfig:T,timeZone:S}=this.props;let L;for(let O of M.series)for(let j of O.fields){let{config:N}=j;if(j.type===a.PU.number){if(j.state?.range)continue;!L&&(!(0,d.isNumber)(N.min)||!(0,d.isNumber)(N.max))&&(L=(0,u.nJ)(M.series));const F=N.min??L.min,U=N.max??L.max;j.state=j.state??{},j.state.range={min:F,max:U,delta:U-F}}}return(0,p.PI)({fieldConfig:T,reduceOptions:I.reduceOptions,replaceVariables:R,theme:f.config.theme2,data:M.series,sparkline:I.graphMode!==s.$p.None,percentChange:I.showPercentChange,timeZone:S})}}getTextMode(){const{options:M,fieldConfig:I,title:R}=this.props;return M.textMode===s.SV.Auto&&(I.defaults.displayName||!R)?s.SV.ValueAndName:M.textMode}render(){const{height:M,options:I,width:R,data:T,renderCounter:S}=this.props;return(0,o.jsx)(x.S,{getValues:this.getValues,getAlignmentFactors:p.XS,renderValue:this.renderValue,width:R,height:M,source:T,itemSpacing:3,renderCounter:S,autoGrid:!0,orientation:I.orientation})}}var h=e(23799);const y={colorMode:s.yp.Value,graphMode:s.$p.Area,justifyMode:s.F8.Auto,percentChangeColorMode:s.CD.Standard,showPercentChange:!1,textMode:s.SV.Auto,wideLayout:!0};var b=e(38824);class D{getSuggestionsForData(M){const{dataSummary:I}=M;if(!I.hasData)return;const R=M.getListAppender({name:b.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:T=>{T.options.reduceOptions.values&&(T.options.reduceOptions.limit=1)}}});I.hasStringField&&I.hasNumberField&&I.frameCount===1&&I.rowCountTotal<10&&(R.append({name:b.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),R.append({name:b.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:s.yp.Background}})),I.stringFieldCount===1&&I.frameCount===1&&I.rowCountTotal<10&&I.fieldCount===1&&R.append({name:b.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:s.yp.None}}),I.hasNumberField&&I.hasTimeField&&(R.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),R.append({name:b.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:s.$p.None,colorMode:s.yp.Background}}))}}const P=new n.m(E).useFieldConfig().setPanelOptions(C=>{const M=["Stat styles"];(0,h.L)(C),(0,h.h)(C,M),l.I(C),C.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:M,settings:{options:[{value:s.SV.Auto,label:"Auto"},{value:s.SV.Value,label:"Value"},{value:s.SV.ValueAndName,label:"Value and name"},{value:s.SV.Name,label:"Name"},{value:s.SV.None,label:"None"}]},defaultValue:y.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:M,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:y.wideLayout,showIf:I=>I.textMode===s.SV.ValueAndName}),C.addSelect({path:"colorMode",name:"Color mode",defaultValue:s.yp.Value,category:M,settings:{options:[{value:s.yp.None,label:"None"},{value:s.yp.Value,label:"Value"},{value:s.yp.Background,label:"Background Gradient"},{value:s.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:M,defaultValue:y.graphMode,settings:{options:[{value:s.$p.None,label:"None"},{value:s.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:y.justifyMode,category:M,settings:{options:[{value:s.F8.Auto,label:"Auto"},{value:s.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:y.showPercentChange,category:M,showIf:I=>!I.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:y.percentChangeColorMode,category:M,settings:{options:[{value:s.CD.Standard,label:"Standard"},{value:s.CD.Inverted,label:"Inverted"},{value:s.CD.SameAsValue,label:"Same as Value"}]},showIf:I=>I.showPercentChange})}).setNoPadding().setPanelChangeHandler(g).setSuggestionsSupplier(new D).setMigrationHandler(r._$)},21164:(k,A,e)=>{"use strict";e.d(A,{u:()=>n});const n=(s,l)=>{const r=[],i=new Set;if((s.config.links?.length??0)>0&&s.getLinks!=null){const g=s.values[l],o=s.display?s.display(g):{text:`${g}`,numeric:+g};s.getLinks({calculatedValue:o,valueRowIndex:l}).forEach(d=>{const c=`${d.title}/${d.href}`;i.has(c)||(r.push(d),i.add(c))})}return r}},65885:(k,A,e)=>{"use strict";e.d(A,{S5:()=>f,fq:()=>g,gy:()=>E,l1:()=>v});var n=e(2543),s=e.n(n),l=e(1173),r=e(50082),i=e(11261);const g=h=>(!h.pluginVersion&&"columns"in h&&console.log("Was angular table",h),h.options),o={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},d={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},c={cell:"color-background",row:"color-background",value:"color-text"},a=(h,y)=>[-1/0,...h].map((b,D)=>({color:y[D],value:(0,n.isNumber)(b)?b:parseInt(b,10)})),p=(h,y)=>{const b=h.transformations??[];if(Object.keys(o).includes(y.transform)){const D={reducers:[]};y.transform==="timeseries_aggregations"&&(D.includeTimeField=!1,D.reducers=y.columns.map(P=>d[P.value])),b.push({id:o[y.transform],options:D})}return b},u=h=>{const b={matcher:{id:/^\/.*\/$/.test(h.pattern)?l.Ct.byRegexp:l.Ct.byName,options:h.pattern},properties:[]};return h.alias&&b.properties.push({id:"displayName",value:h.alias}),h.unit&&b.properties.push({id:"unit",value:h.unit}),h.decimals&&b.properties.push({id:"decimals",value:h.decimals}),h.type==="date"&&b.properties.push({id:"unit",value:`time: ${h.dateFormat}`}),h.type==="hidden"&&b.properties.push({id:"custom.hidden",value:!0}),h.link&&b.properties.push({id:"links",value:[{title:(0,n.defaultTo)(h.linkTooltip,""),url:(0,n.defaultTo)(h.linkUrl,""),targetBlank:(0,n.defaultTo)(h.linkTargetBlank,!1)}]}),h.colorMode&&b.properties.push({id:"custom.cellOptions",value:{type:c[h.colorMode]}}),h.align&&b.properties.push({id:"custom.align",value:h.align==="auto"?null:h.align}),h.thresholds?.length&&b.properties.push({id:"thresholds",value:{mode:r.O.Absolute,steps:a(h.thresholds,h.colors)}}),b},m=h=>{let y={custom:{}};if(h){if(y=(0,n.omitBy)({unit:h.unit,decimals:h.decimals,displayName:h.alias,custom:{align:h.align==="auto"?null:h.align}},n.isNil),h.thresholds.length){const b={mode:r.O.Absolute,steps:a(h.thresholds,h.colors)};y.thresholds=b}h.colorMode&&(y.custom.cellOptions={type:c[h.colorMode]})}return y},v=(h,y,b)=>{if(y==="table-old"&&b.angular){const D=b.angular,P=p(h,D),C=D.styles.find(R=>R.pattern==="/.*/"),M=m(C),I=D.styles.filter(R=>R.pattern!=="/.*/").map(u);h.transformations=P,h.fieldConfig={defaults:M,overrides:I}}return{}},x=h=>h?.filter(y=>y.meta?.custom?.parentRowIndex===void 0)||[h?.[0]],f=h=>{const y=[];return x(h).filter(D=>!!D&&D.length!==0)?.forEach(D=>{const P=h?.filter(R=>D.refId===R.refId&&R.meta?.custom?.parentRowIndex!==void 0),C=(0,n.groupBy)(P,R=>R.meta?.custom?.parentRowIndex),M=Object.keys(C).map(R=>C[R]),I={...D};P&&P.length>0&&I.fields.push({name:"nested",type:i.PU.nestedFrames,config:{},values:M}),y.push(I)}),y},E=h=>h?.some(y=>y.meta?.custom?.parentRowIndex!==void 0)},11082:(k,A,e)=>{"use strict";e.d(A,{Z:()=>g});var n=e(74848),s=e(66864),l=e(94354),r=e(51275);const i=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],g=({value:o,onChange:d,item:c})=>{const a=typeof o=="number";return i[1].value=a?o:36e5,(0,n.jsxs)(s.Gy,{children:[(0,n.jsx)(l.z,{value:o,options:i,onChange:d}),a&&(0,n.jsx)(r.g,{value:o,onChange:d,inputPrefix:r.F.GreaterThan,isTime:c.settings?.isTime??!1})]})}},43228:(k,A,e)=>{"use strict";e.d(A,{F:()=>a});var n=e(74848),s=e(96540),l=e(66864),r=e(94354),i=e(90182),g=e(29158);const o=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],d=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(u=>({label:u,value:u})),c=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(u=>({label:u,value:u})),a=({value:u,onChange:m})=>{const v=(0,s.useMemo)(()=>u?.fill==="dash"?d:c,[u]),x=(0,s.useMemo)(()=>{if(!u?.dash?.length)return v[0];const f=u.dash?.join(", "),E=v.find(h=>h.value===f);return E||{label:f,value:f}},[u,v]);return(0,n.jsxs)(l.Gy,{children:[(0,n.jsx)(r.z,{value:u?.fill||"solid",options:o,onChange:f=>{let E;f==="dot"?E=p(c[0].value):f==="dash"&&(E=p(d[0].value)),m({...u,fill:f,dash:E})}}),u?.fill&&u?.fill!=="solid"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.l6,{allowCustomValue:!0,options:v,value:x,width:20,onChange:f=>{m({...u,dash:p(f.value??"")})},formatCreateLabel:f=>`Segments: ${p(f).join(", ")}`}),(0,n.jsxs)("div",{children:["\xA0",(0,n.jsx)("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,n.jsx)(g.K,{name:"question-circle",tooltip:"Help"})})]})]})]})};function p(u){const m=[];for(const v of u.split(/(?:,| )+/)){const x=Number.parseInt(v,10);isNaN(x)||m.push(x)}return m}},51275:(k,A,e)=>{"use strict";e.d(A,{F:()=>r,g:()=>i});var n=e(74848),s=e(65879),l=e(10354),r=(g=>(g.LessThan="lessthan",g.GreaterThan="greaterthan",g))(r||{});const i=({value:g,onChange:o,inputPrefix:d,isTime:c})=>{let a=s.secondsToHms(g/1e3);c||(a="10");const p=x=>{let f=!1;if(x)try{c&&s.isValidTimeSpan(x)?f=s.intervalToMs(x):f=Number(x)}catch(E){console.warn("ERROR",E)}o(f)},u=x=>{x.key==="Enter"&&p(x.currentTarget.value)},m=x=>{p(x.currentTarget.value)},v=d==="greaterthan"?(0,n.jsx)("div",{children:">"}):d==="lessthan"?(0,n.jsx)("div",{children:"<"}):null;return(0,n.jsx)(l.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:a,onKeyDown:u,onBlur:m,prefix:v,spellCheck:!1})}},34163:(k,A,e)=>{"use strict";e.d(A,{e:()=>g});var n=e(74848),s=e(66864),l=e(94354),r=e(51275);const i=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],g=({value:o,onChange:d,item:c})=>{const a=typeof o=="number";return i[2].value=a?o:36e5,(0,n.jsxs)(s.Gy,{children:[(0,n.jsx)(l.z,{value:o,options:i,onChange:d}),a&&(0,n.jsx)(r.g,{value:o,onChange:d,inputPrefix:r.F.LessThan,isTime:c.settings?.isTime??!1})]})}},24882:(k,A,e)=>{"use strict";e.d(A,{D:()=>r});var n=e(74848),s=e(96540),l=e(90182);const r=({item:i,value:g,onChange:o,id:d})=>{const c=(0,s.useCallback)(a=>{o({mode:a.value})},[o]);return(0,n.jsx)(l.l6,{inputId:d,value:g.mode,options:i.settings?.options??[],onChange:c})}},22731:(k,A,e)=>{"use strict";e.d(A,{$:()=>x,k:()=>v});var n=e(74848),s=e(32196),l=e(83195),r=e(11261),i=e(52622),g=e(40845),o=e(11389),d=e(58749),c=e(52415),a=e(10875),p=e(21164),u=e(5514),m=e(82915);const v=({series:f,_rest:E,dataIdxs:h,seriesIdx:y,mode:b=i.$N.Single,sortOrder:D=i.xB.None,isPinned:P,annotate:C,maxHeight:M})=>{const I=(0,g.of)(x),R=f.fields[0],T=(0,l.cN)(R.display(R.values[h[0]])),S=(0,a.cp)(f.fields,R,h,y,b,D,j=>j.type===r.PU.number||j.type===r.PU.enum);E?.forEach(j=>{j.config.custom?.hideFrom?.tooltip||S.push({label:j.state?.displayName??j.name,value:(0,u.S)(j,j.values[h[0]])})});let L;if(P&&y!=null){const j=f.fields[y],N=h[y],F=(0,p.u)(j,N);L=(0,n.jsx)(d.S,{dataLinks:F,annotate:C})}const O=R.config.custom?.hideFrom?.tooltip?null:{label:R.type===r.PU.time?"":R.state?.displayName??R.name,value:T};return(0,n.jsxs)("div",{className:I.wrapper,children:[O!=null&&(0,n.jsx)(c.A,{item:O,isPinned:P}),(0,n.jsx)(o.o,{items:S,isPinned:P,scrollable:(0,m.T5)({mode:b,maxHeight:M}),maxHeight:M}),L]})},x=()=>({wrapper:(0,s.css)({display:"flex",flexDirection:"column"})})},41706:(k,A,e)=>{"use strict";e.d(A,{S:()=>v,V:()=>f});var n=e(37055),s=e(24293),l=e(11261),r=e(27310),i=e(52622),g=e(52198),o=e(56675),d=e(38248),c=e(11404),a=e(11082),p=e(43228),u=e(34163),m=e(24882);const v={drawStyle:i.GR.Line,lineInterpolation:i.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:i.on.None,barAlignment:i.Nj.Center,barWidthFactor:.6,stacking:{mode:i.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},x=["Graph styles"];function f(E,h=!0){return{standardOptions:{[n.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:s.Y.PaletteClassic}}},useCustomConfig:y=>{y.addRadio({path:"drawStyle",name:"Style",category:x,defaultValue:E.drawStyle,settings:{options:g.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:x,defaultValue:E.lineInterpolation,settings:{options:g.t.lineInterpolation},showIf:b=>b.drawStyle===i.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:x,defaultValue:E.barAlignment,settings:{options:g.t.barAlignment},showIf:b=>b.drawStyle===i.GR.Bars}).addSliderInput({path:"barWidthFactor",name:"Bar width factor",category:x,defaultValue:E.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:"Bar width factor"},showIf:b=>b.drawStyle===i.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:x,defaultValue:E.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:b=>b.drawStyle!==i.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:x,defaultValue:E.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:b=>b.drawStyle!==i.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:x,defaultValue:g.t.fillGradient[0].value,settings:{options:g.t.fillGradient},showIf:b=>b.drawStyle!==i.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:x,hideFromDefaults:!0,settings:{filter:b=>b.type===l.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:x,showIf:b=>b.drawStyle===i.GR.Line,editor:p.F,override:p.F,process:r.hS,shouldApply:b=>b.type===l.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:x,defaultValue:!1,editor:u.e,override:u.e,showIf:b=>b.drawStyle===i.GR.Line,shouldApply:b=>b.type!==l.PU.time,process:r.hS,settings:{isTime:h}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:x,defaultValue:!1,editor:a.Z,override:a.Z,showIf:b=>b.drawStyle===i.GR.Line,shouldApply:b=>b.type!==l.PU.time,process:r.hS,settings:{isTime:h}}).addRadio({path:"showPoints",name:"Show points",category:x,defaultValue:g.t.showPoints[0].value,settings:{options:g.t.showPoints},showIf:b=>b.drawStyle!==i.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:x,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:b=>b.showPoints!==i.yL.Never||b.drawStyle===i.GR.Points}),o.I(y,E.stacking,x),y.addSelect({category:x,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:i.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:i.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),d.r(y,E),c.e(y),y.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:i.Ly.Off},settings:{options:g.t.thresholdsDisplayModes},editor:m.D,override:m.D,process:r.hS,shouldApply:()=>!0})}}}},62567:(k,A,e)=>{"use strict";e.d(A,{W:()=>ne});var n=e(74848),s=e(32196),l=e(96540),r=e(40961),i=e(84140),g=e(36613),o=e(33948),d=e(52622),c=e(23596),a=e(24284),p=e(17464),u=e(40845),m=e(7315),v=e(36376),x=e(13544),f=e(49785),E=e(29647),h=e(41053),y=e(72724),b=e(42994),D=e(79041),P=e(67061),C=e(88575),M=e(21744),I=e(55852),R=e(72235),T=e(99818),S=e(10154);const L=({annoVals:_,annoIdx:Q,dismiss:ae,timeZone:oe,...J})=>{const ee=(0,u.of)(O),{onAnnotationCreate:de,onAnnotationUpdate:xe}=(0,D.d2)(),re=(0,l.useRef)(null);(0,E.A)(re,ae);const[ue,Te]=(0,h.A)(async Ke=>{const _e=await de(Ke);return ae(),_e}),[ge,Oe]=(0,h.A)(async Ke=>{const _e=await xe(Ke);return ae(),_e}),Ue=Ke=>(0,y.LE)(Ke,{format:b.WC.fullDate,timeZone:oe}),Xe=_.id?.[Q]!=null,we=_.isRegion?.[Q],qe=Xe?Oe:Te,We=Xe?ge:ue,Ce=we?`${Ue(_.time[Q])} - ${Ue(_.timeEnd[Q])}`:Ue(_.time[Q]),je=({tags:Ke,description:_e})=>{qe({id:_.id?.[Q]??void 0,tags:Ke,description:_e,from:Math.round(_.time[Q]),to:Math.round(_.timeEnd?.[Q]??_.time[Q])})};return(0,n.jsxs)("div",{ref:re,className:ee.editor,...J,children:[(0,n.jsx)("div",{className:ee.header,children:(0,n.jsxs)(P.B,{justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)("div",{children:Xe?"Edit annotation":"Add annotation"}),(0,n.jsx)("div",{children:Ce})]})}),(0,n.jsx)(R.l,{onSubmit:je,defaultValues:{description:_.text?.[Q],tags:_.tags?.[Q]||[]},children:({register:Ke,errors:_e,control:Fe})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:ee.content,children:[(0,n.jsx)(C.D,{label:"Description",invalid:!!_e.description,error:_e?.description?.message,children:(0,n.jsx)(M.f,{className:ee.textarea,...Ke("description",{required:"Annotation description is required"})})}),(0,n.jsx)(C.D,{label:"Tags",children:(0,n.jsx)(f.xI,{control:Fe,name:"tags",render:({field:{ref:at,onChange:Ct,...Dt}})=>(0,n.jsx)(T.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:Ct,tagOptions:S.vy,tags:Dt.value})})})]}),(0,n.jsx)("div",{className:ee.footer,children:(0,n.jsxs)(P.B,{justifyContent:"flex-end",children:[(0,n.jsx)(I.$n,{size:"sm",variant:"secondary",onClick:ae,fill:"outline",children:"Cancel"}),(0,n.jsx)(I.$n,{size:"sm",type:"submit",disabled:We?.loading,children:We?.loading?"Saving":"Save"})]})})]})})]})},O=_=>({editor:(0,s.css)({background:_.colors.background.primary,border:`1px solid ${_.colors.border.weak}`,borderRadius:_.shape.radius.default,boxShadow:_.shadows.z3,userSelect:"text",width:"460px"}),content:(0,s.css)({padding:_.spacing(1)}),header:(0,s.css)({borderBottom:`1px solid ${_.colors.border.weak}`,padding:_.spacing(.5,1),fontWeight:_.typography.fontWeightBold,fontSize:_.typography.fontSize,color:_.colors.text.primary}),footer:(0,s.css)({borderTop:`1px solid ${_.colors.border.weak}`,padding:_.spacing(1,1)}),textarea:(0,s.css)({color:_.colors.text.secondary,fontSize:_.typography.bodySmall.fontSize})});var j=e(80997),N=e(66864),F=e(29158),U=e(78369),w=e(55907);const B=()=>!1,K=({annoVals:_,annoIdx:Q,timeZone:ae,onEdit:oe})=>{const J=_.id?.[Q],ee=(0,u.of)(W),{canEditAnnotations:de=B,canDeleteAnnotations:xe=B,onAnnotationDelete:re}=(0,D.d2)(),ue=_.dashboardUID?.[Q],Te=de(ue),ge=xe(ue)&&re!=null,Oe=Ce=>(0,y.LE)(Ce,{format:b.WC.fullDate,timeZone:ae});let Ue=Oe(_.time[Q]),Xe=_.text?.[Q]??"";_.isRegion?.[Q]&&(Ue+=" - "+Oe(_.timeEnd[Q]));let we;_.login?.[Q]&&_.avatarUrl?.[Q]&&(we=(0,n.jsx)("img",{className:ee.avatar,alt:"Annotation avatar",src:_.avatarUrl[Q]}));let qe=null,We="";if(_.alertId?.[Q]!==void 0&&_.newState?.[Q]){const Ce=w.A.getStateDisplayModel(_.newState[Q]);qe=(0,n.jsx)("div",{className:ee.alertState,children:(0,n.jsx)("i",{className:Ce.stateClass,children:Ce.text})}),We=_.data?.[Q]?w.A.getAlertAnnotationText(_.data[Q]):""}else _.title?.[Q]&&(Xe=_.title[Q]+(Xe?`<br />${Xe}`:""));return(0,n.jsxs)("div",{className:ee.wrapper,children:[(0,n.jsx)("div",{className:ee.header,children:(0,n.jsxs)(N.Gy,{justify:"space-between",align:"center",spacing:"md",children:[(0,n.jsxs)("div",{className:ee.meta,children:[(0,n.jsxs)("span",{children:[we,qe]}),Ue]}),(Te||ge)&&(0,n.jsxs)("div",{className:ee.editControls,children:[Te&&(0,n.jsx)(F.K,{name:"pen",size:"sm",onClick:oe,tooltip:"Edit"}),ge&&(0,n.jsx)(F.K,{name:"trash-alt",size:"sm",onClick:()=>re(J),tooltip:"Delete"})]})]})}),(0,n.jsxs)("div",{className:ee.body,children:[Xe&&(0,n.jsx)("div",{className:ee.text,dangerouslySetInnerHTML:{__html:j.sQ.sanitize(Xe)}}),We,(0,n.jsx)("div",{children:(0,n.jsx)(N.Gy,{spacing:"xs",wrap:!0,children:_.tags?.[Q]?.map((Ce,je)=>(0,n.jsx)(U.v,{name:Ce},`${Ce}-${je}`))})})]})]})},W=_=>({wrapper:(0,s.css)({zIndex:_.zIndex.tooltip,whiteSpace:"initial",borderRadius:_.shape.radius.default,background:_.colors.background.primary,border:`1px solid ${_.colors.border.weak}`,boxShadow:_.shadows.z2,userSelect:"text"}),header:(0,s.css)({padding:_.spacing(.5,1),borderBottom:`1px solid ${_.colors.border.weak}`,fontWeight:_.typography.fontWeightBold,fontSize:_.typography.fontSize,color:_.colors.text.primary,display:"flex"}),meta:(0,s.css)({display:"flex",justifyContent:"space-between",color:_.colors.text.primary,fontWeight:400}),editControls:(0,s.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,s.css)({padding:_.spacing(1),fontSize:_.typography.bodySmall.fontSize,color:_.colors.text.secondary,fontWeight:400,a:{color:_.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,s.css)({paddingBottom:_.spacing(1)}),avatar:(0,s.css)({borderRadius:_.shape.radius.circle,width:16,height:16,marginRight:_.spacing(1)}),alertState:(0,s.css)({paddingRight:_.spacing(1),fontWeight:_.typography.fontWeightMedium})}),z=0,Y=1,X=2,q=({annoVals:_,annoIdx:Q,className:ae,style:oe,exitWipEdit:J,timeZone:ee,portalRoot:de})=>{const xe=(0,u.of)(G),[re,ue]=(0,l.useState)(J!=null?Y:z),{refs:Te,floatingStyles:ge}=(0,v.we)({open:!0,placement:"bottom",middleware:[(0,m.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,m.BN)()],whileElementsMounted:m.ll,strategy:"fixed"}),Oe=re===X?(0,n.jsx)(K,{annoIdx:Q,annoVals:_,timeZone:ee,onEdit:()=>ue(Y)}):re===Y?(0,n.jsx)(L,{annoIdx:Q,annoVals:_,timeZone:ee,dismiss:()=>{J?.(),ue(z)}}):null;return(0,n.jsx)("div",{ref:Te.setReference,className:ae,style:oe,onMouseEnter:()=>re!==Y&&ue(X),onMouseLeave:()=>re!==Y&&ue(z),"data-testid":x.Tp.pages.Dashboard.Annotations.marker,children:Oe&&(0,r.createPortal)((0,n.jsx)("div",{ref:Te.setFloating,className:xe.annoBox,style:ge,"data-testid":"annotation-marker",children:Oe}),de)})},G=_=>({annoBox:(0,s.css)({top:0,left:0,zIndex:_.zIndex.tooltip,borderRadius:_.shape.radius.default,position:"absolute",background:_.colors.background.primary,border:`1px solid ${_.colors.border.weak}`,boxShadow:_.shadows.z2,userSelect:"text",minWidth:"300px"})}),te=(_,Q,ae,oe,J)=>{_.beginPath(),_.moveTo(oe,Q),_.lineTo(oe,ae),_.strokeStyle=J,_.stroke()},H=(0,i.A)(a.Mk).toHex8String();function se(_){let Q={};return _.fields.forEach(ae=>{Q[ae.name]=ae.values}),Q}const ne=({annotations:_,timeZone:Q,config:ae,newRange:oe,setNewRange:J,canvasRegionRendering:ee=!0})=>{const[de,xe]=(0,l.useState)(),[re]=(0,l.useState)(()=>(0,p.gF)()),ue=(0,u.of)(le),Te=(0,u.$j)().visualization.getColorByName,[ge,Oe]=(0,l.useReducer)(Ce=>Ce+1,0),Ue=(0,l.useMemo)(()=>{let Ce=_.filter(je=>je.name!=="exemplar"&&je.length>0&&je.fields.some(Ke=>Ke.name==="time"));if(oe){let je=oe.to>oe.from;const Ke=(0,o.I)([{time:oe.from,timeEnd:je?oe.to:null,isRegion:je,color:H}]);Ke.meta={dataTopic:d.QR.Annotations,custom:{isWip:!0}},Ce.push(Ke)}return Ce},[_,oe]),Xe=(0,l.useCallback)(()=>{J(null)},[J]),we=(0,l.useRef)(Ue);we.current=Ue;const qe=(0,l.useRef)(oe);qe.current=oe;const We=(0,l.useRef)();if((0,l.useLayoutEffect)(()=>{ae.addHook("ready",Ce=>{let je=Ce.root.querySelector(".u-axis");We.current=je,xe(Ce)}),ae.addHook("draw",Ce=>{let je=we.current;const Ke=Ce.ctx;Ke.save(),Ke.beginPath(),Ke.rect(Ce.bbox.left,Ce.bbox.top,Ce.bbox.width,Ce.bbox.height),Ke.clip(),je.forEach(_e=>{let Fe=se(_e);if(_e.name==="xymark"){let at=ae.scales[0].props.scaleKey,Ct=ae.scales[1].props.scaleKey;for(let Dt=0;Dt<_e.length;Dt++){let tt=Te(Fe.color?.[Dt]||H),ze=Ce.valToPos(Fe.xMin[Dt],at,!0),pe=Ce.valToPos(Fe.xMax[Dt],at,!0),Se=Ce.valToPos(Fe.yMax[Dt],Ct,!0),fe=Ce.valToPos(Fe.yMin[Dt],Ct,!0);Ke.fillStyle=c.MV.alpha(tt,Fe.fillOpacity[Dt]),Ke.fillRect(ze,Se,pe-ze,fe-Se),Ke.lineWidth=Math.round(Fe.lineWidth[Dt]*g.A.pxRatio),Fe.lineStyle[Dt]==="dash"?Ke.setLineDash([5,5]):Ke.setLineDash([]),Ke.strokeStyle=tt,Ke.strokeRect(ze,Se,pe-ze,fe-Se)}}else{let at=Ce.bbox.top,Ct=at+Ce.bbox.height;Ke.lineWidth=2,Ke.setLineDash([5,5]);for(let Dt=0;Dt<Fe.time.length;Dt++){let tt=Te(Fe.color?.[Dt]||H),ze=Ce.valToPos(Fe.time[Dt],"x",!0);if(!Fe.isRegion?.[Dt])te(Ke,at,Ct,ze,tt);else if(ee){te(Ke,at,Ct,ze,tt);let pe=Ce.valToPos(Fe.timeEnd[Dt],"x",!0);te(Ke,at,Ct,pe,tt),Ke.fillStyle=c.MV.alpha(tt,.1),Ke.fillRect(ze,at,pe-ze,Ce.bbox.height)}}}}),Ke.restore()})},[ae,ee,Te]),(0,l.useEffect)(()=>{de&&(de.redraw(),setTimeout(()=>{Oe()},0))},[Ue,de]),de){let Ce=Ue.flatMap((je,Ke)=>{let _e=se(je),Fe=[];for(let at=0;at<_e.time.length;at++){let Ct=Te(_e.color?.[at]||a.Mk),Dt=Math.round(de.valToPos(_e.time[at],"x"))||0,tt=null,ze="",pe=!0;if(_e.isRegion?.[at]){let Se=Math.round(de.valToPos(_e.timeEnd?.[at],"x"))||0;if(pe=Dt<de.rect.width&&Se>0,pe){let fe=Math.max(0,Dt),Ee=Math.min(de.rect.width,Se);tt={left:fe,background:Ct,width:Ee-fe},ze=ue.annoRegion}}else pe=Dt>=0&&Dt<=de.rect.width,pe&&(tt={left:Dt,borderBottomColor:Ct},ze=ue.annoMarker);if(pe){let Se=je.meta?.custom?.isWip;Fe.push((0,n.jsx)(q,{annoIdx:at,annoVals:_e,className:ze,style:tt,timeZone:Q,exitWipEdit:Se?Xe:null,portalRoot:re},`${Ke}:${at}`))}}return Fe});return(0,r.createPortal)(Ce,We.current)}return null},le=()=>({annoMarker:(0,s.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,s.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(k,A,e)=>{"use strict";e.d(A,{U:()=>r});var n=e(74848),s=e(96540),l=e(55852);const r=({config:i,onChangeTimeRange:g})=>{const o=(0,s.useRef)(),[d,c]=(0,s.useState)([]),[a,p]=(0,s.useState)();if((0,s.useLayoutEffect)(()=>{i.addHook("init",h=>{o.current=h}),i.addHook("setScale",h=>{c(h.data?.[0]??[]),p(h.scales.x??void 0)})},[i]),d.length<2||!g||!a||!a.time||!a.min||!a.max)return null;let u=0,m=d.length-1;for(;u<=m&&d[u]==null;)u++;for(;m>=0&&d[m]==null;)m--;const v=d[u],x=d[m],f=a.min,E=a.max;return v==null||x==null||v<=E&&x>=f?null:(0,n.jsx)("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"},children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{children:"Data outside time range"}),(0,n.jsx)(l.$n,{onClick:h=>g({from:v,to:x}),variant:"secondary","data-testid":"time-series-zoom-to-data",children:"Zoom to data"})]})})};r.displayName="OutsideRangePlugin"},82915:(k,A,e)=>{"use strict";e.d(A,{B_:()=>p,Fg:()=>v,O2:()=>m,T5:()=>x});var n=e(11261),s=e(28240),l=e(83195),r=e(57875),i=e(50311),g=e(46294),o=e(39624),d=e(52622),c=e(55129);function a(f){let E=new Map;return f.map(y=>({...y,fields:y.fields.map(b=>{if(b.type===n.PU.enum){let D=(0,c.M)(b.config,b.type),P=E.get(D);P||(P=[],E.set(D,P));let C=b.values.toArray().slice(),M=b.config.type.enum.text;if(P.length>0)for(let I=0;I<C.length;I++)C[I]+=P.length;return P.push(...M),b.config.type.enum.text=P,{...b,values:C}}return b})}))}function p(f,E,h,y){if(!f?.length)return null;(0,s.Fm)(f);let b=y!=null;y!=null&&y>0&&(f=[{...f[0],fields:[f[0].fields[y],...f[0].fields.filter((M,I)=>I!==y)]}]);for(let M of f)for(let I of M.fields)I.type===n.PU.time&&typeof I.values[0]!="number"&&(I.values=(0,i.s7)(I,{destinationType:n.PU.time}).values);let D=0;e:for(let M of f)for(let I of M.fields)if(I.type===n.PU.enum&&++D>1){f=a(f);break e}let P;const C=[];for(let M of f){const I=[];let R=!1,T=!1,S=b?M:(0,g.M)({frame:M,refFieldPseudoMin:h?.from.valueOf(),refFieldPseudoMax:h?.to.valueOf()});const L=(0,o.C)(S).fields;for(let O=0;O<L?.length;O++){const j=L[O];switch(j.type){case n.PU.time:R=!0,I.push(j);break;case n.PU.number:T=b?O>0:!0,P={...j,values:j.values.map(U=>Number.isFinite(U)||U==null?U:null)},I.push(P);break;case n.PU.enum:T=!0;case n.PU.string:P={...j,values:j.values},I.push(P);break;case n.PU.boolean:T=!0;const N=j.config?.custom??{},F={...j.config,max:1,min:0,custom:N};N.lineInterpolation!==d.dx.StepBefore&&(N.lineInterpolation=d.dx.StepAfter),P={...j,config:F,type:n.PU.number,values:j.values.map(U=>U==null?U:U?1:0)},(0,l.j9)(F.unit)||(F.unit="bool",P.display=(0,r.J)({field:P,theme:E})),I.push(P);break}}(b||R)&&T&&C.push({...M,length:S.length,fields:I})}return C.length?(m(C,E,0),u(C,E),C):null}const u=(f,E)=>{const{palette:h}=E.visualization;for(const y of f)for(const b of y.fields)if(b.type===n.PU.enum){const D=h[b.state?.seriesIndex%h.length],P=E.visualization.getColorByName(D),C=b.config.type.enum;C.color=Array(C.text.length).fill(P),b.display=(0,r.J)({field:b,theme:E})}},m=(f,E,h)=>{let y=0;f.forEach(b=>{b.fields.forEach((D,P)=>{P!==h&&(D.type===n.PU.number||D.type===n.PU.boolean||D.type===n.PU.enum)&&(D.state={...D.state,seriesIndex:y++},D.display=(0,r.J)({field:D,theme:E}))})})};function v(f,E){return!f||!f.length?[E]:f.map(h=>h?.length?h:E)}const x=f=>f.mode===d.$N.Multi&&f.maxHeight!=null},5514:(k,A,e)=>{"use strict";e.d(A,{S:()=>s});var n=e(83195);function s(l,r){return l.display?(0,n.cN)(l.display(r)):`${r}`}},99758:(k,A,e)=>{"use strict";e.d(A,{jK:()=>ja,kz:()=>Xo});var n=e(74848),s=e(24180),l=e(39070),r=e(32196),i=e(32264),g=e(40845),o=e(42418),d=e(67061),c=e(55852),a=e(19361),p=e(8484),u=e(53153),m=e(87570),v=e(4691),x=e(20851),f=e(2543),E=e(58649),h=e(14578),y=e(2913);const b=()=>{const Rt=!!y.Ay.oauth;return{saml:{bgColor:"#464646",enabled:y.Ay.samlEnabled,name:y.Ay.samlName||E.En,icon:"key-skeleton-alt"},google:{bgColor:"#e84d3c",enabled:Rt&&!!y.Ay.oauth.google,name:y.Ay.oauth?.google?.name||"Google",icon:y.Ay.oauth?.google?.icon||"google"},azuread:{bgColor:"#2f2f2f",enabled:Rt&&!!y.Ay.oauth.azuread,name:y.Ay.oauth?.azuread?.name||"Microsoft",icon:y.Ay.oauth?.azuread?.icon||"microsoft"},github:{bgColor:"#464646",enabled:Rt&&!!y.Ay.oauth.github,name:y.Ay.oauth?.github?.name||"GitHub",icon:y.Ay.oauth?.github?.icon||"github"},gitlab:{bgColor:"#fc6d26",enabled:Rt&&!!y.Ay.oauth.gitlab,name:y.Ay.oauth?.gitlab?.name||"GitLab",icon:y.Ay.oauth?.gitlab?.icon||"gitlab"},grafanacom:{bgColor:"#262628",enabled:Rt&&!!y.Ay.oauth.grafana_com,name:y.Ay.oauth?.grafana_com?.name||"Grafana.com",icon:y.Ay.oauth?.grafana_com?.icon||"grafana",hrefName:"grafana_com"},okta:{bgColor:"#2f2f2f",enabled:Rt&&!!y.Ay.oauth.okta,name:y.Ay.oauth?.okta?.name||"Okta",icon:y.Ay.oauth?.okta?.icon||"okta"},oauth:{bgColor:"#262628",enabled:Rt&&!!y.Ay.oauth.generic_oauth,name:y.Ay.oauth?.generic_oauth?.name||"OAuth",icon:y.Ay.oauth?.generic_oauth?.icon||"signin",hrefName:"generic_oauth"}}},D=Rt=>({button:(0,r.css)({color:"#d8d9da",position:"relative"}),buttonIcon:(0,r.css)({position:"absolute",left:Rt.spacing(1),top:"50%",transform:"translateY(-50%)"}),divider:{base:(0,r.css)({color:Rt.colors.text.primary,display:"flex",marginBottom:Rt.spacing(1),justifyContent:"space-between",textAlign:"center",width:"100%"}),line:(0,r.css)({width:100,height:10,borderBottom:`1px solid ${Rt.colors.text}`})}}),P=()=>{const Rt=(0,g.of)(D);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:Rt.divider.base,children:[(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:Rt.divider.line})}),(0,n.jsx)("div",{children:(0,n.jsx)("span",{children:!y.Ay.disableLoginForm&&(0,n.jsx)("span",{children:"or"})})}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:Rt.divider.line})})]}),(0,n.jsx)("div",{className:"clearfix"})]})};function C(Rt,tn,Mn){return(0,r.cx)(tn.button,(0,r.css)({backgroundColor:Rt.bgColor,color:Mn.colors.getContrastText(Rt.bgColor),"&:hover":{backgroundColor:Mn.colors.emphasize(Rt.bgColor,.15),boxShadow:Mn.shadows.z1}}))}const M=()=>{const Rt=(0,f.pickBy)(b(),Es=>Es.enabled),tn=Object.keys(Rt).length>0,Mn=(0,g.$j)(),zn=(0,g.of)(D);return tn?(0,n.jsxs)(d.B,{direction:"column",width:"100%",children:[(0,n.jsx)(P,{}),Object.entries(Rt).map(([Es,Ts])=>{const qa=Ts.name;return(0,n.jsxs)(c.z9,{className:C(Ts,zn,Mn),href:`login/${Ts.hrefName?Ts.hrefName:Es}`,target:"_self",fullWidth:!0,children:[(0,n.jsx)(h.I,{className:zn.buttonIcon,name:Ts.icon}),(0,n.jsxs)(p.x6,{i18nKey:"login.services.sing-in-with-prefix",children:["Sign in with ",{serviceName:qa}]})]},Es)})]}):null},I=()=>{const Rt=(0,y.zj)().verifyEmailEnabled?`${(0,y.zj)().appSubUrl}/verify`:`${(0,y.zj)().appSubUrl}/signup`,tn=(0,r.css)({paddingTop:"16px"});return(0,n.jsxs)(d.B,{direction:"column",children:[(0,n.jsx)("div",{className:tn,children:(0,n.jsx)(p.x6,{i18nKey:"login.signup.new-to-question",children:"New to Grafana?"})}),(0,n.jsx)(c.z9,{className:(0,r.css)({width:"100%",justifyContent:"center"}),href:Rt,variant:"secondary",fill:"outline",children:(0,n.jsx)(p.x6,{i18nKey:"login.signup.button-label",children:"Sign up"})})]})},R=()=>{const Rt=(0,g.of)(T);return document.title=a.M.AppTitle,(0,n.jsx)(m.A,{children:({loginHint:tn,passwordHint:Mn,disableLoginForm:zn,disableUserSignUp:Es,login:Ts,isLoggingIn:qa,changePassword:aa,skipPasswordChange:ar,isChangingPassword:Aa,showDefaultPasswordWarning:yr,loginErrorMessage:Dr})=>(0,n.jsxs)(x.GU,{isChangingPassword:Aa,children:[!Aa&&(0,n.jsxs)(x.qm,{children:[Dr&&(0,n.jsx)(o.F,{className:Rt.alert,severity:"error",title:(0,p.t)("login.error.title","Login failed"),children:Dr}),!zn&&(0,n.jsx)(v.Q,{onSubmit:Ts,loginHint:tn,passwordHint:Mn,isLoggingIn:qa,children:(0,n.jsx)(d.B,{justifyContent:"flex-end",children:!i.$.auth.disableLogin&&(0,n.jsx)(c.z9,{className:Rt.forgottenPassword,fill:"text",href:`${i.$.appSubUrl}/user/password/send-reset-email`,children:(0,n.jsx)(p.x6,{i18nKey:"login.forgot-password",children:"Forgot your password?"})})})}),(0,n.jsx)(M,{}),!Es&&(0,n.jsx)(I,{})]}),Aa&&(0,n.jsx)(x.qm,{children:(0,n.jsx)(u.S,{showDefaultPasswordWarning:yr,onSubmit:aa,onSkip:()=>ar()})})]})})},T=Rt=>({forgottenPassword:(0,r.css)({padding:0,marginTop:Rt.spacing(.5)}),alert:(0,r.css)({width:"100%"})});var S=e(69444),L=e(25249),O=e(10860);function j({description:Rt,text:tn,url:Mn}){const zn=(0,g.of)(N);return(0,n.jsxs)(O.Z,{className:zn.card,href:Mn,children:[(0,n.jsx)(O.Z.Heading,{children:tn}),(0,n.jsx)(O.Z.Description,{className:zn.description,children:Rt})]})}const N=Rt=>({card:(0,r.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,r.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function F({navId:Rt,header:tn}){const{node:Mn}=(0,L.C)(Rt),zn=(0,g.of)(U),Es=Mn.children?.filter(Ts=>!Ts.hideFromTabs);return(0,n.jsx)(S.Y,{navId:Mn.id,children:(0,n.jsx)(S.Y.Contents,{children:(0,n.jsxs)("div",{className:zn.content,children:[tn,Es&&Es.length>0&&(0,n.jsx)("section",{className:zn.grid,children:Es?.map(Ts=>(0,n.jsx)(j,{description:Ts.subTitle,text:Ts.text,url:Ts.url??""},Ts.id))})]})})})}const U=Rt=>({content:(0,r.css)({display:"flex",flexDirection:"column",gap:Rt.spacing(2)}),grid:(0,r.css)({display:"grid",gap:Rt.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:Rt.spacing(2,0)})});var w=e(64388),B=e(7392);function K(){return(0,n.jsx)(S.Y,{navId:"home",layout:w.k.Canvas,pageNav:{text:"Page not found"},children:(0,n.jsx)(B.L,{entity:"Page"})})}var W=e(16233),z=e(96540),Y=e(71468),X=e(33378),q=e(10096),G=e(31678),te=e(72724),H=e(46334);const se="dddd YYYY-MM-DD HH:mm zz",ne="/admin/authentication/ldap";class le extends z.PureComponent{constructor(){super(...arguments),this.onUserSync=()=>{this.props.onUserSync()}}render(){const{ldapSyncInfo:tn,user:Mn}=this.props,Es=tn&&tn.nextSync?(0,te.LE)(tn.nextSync,{format:se}):"",Ts=`${ne}?user=${Mn&&Mn.login}`,qa=q.contextSrv.hasPermission(G.AccessControlAction.LDAPUsersRead),aa=q.contextSrv.hasPermission(G.AccessControlAction.LDAPUsersSync);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{className:"page-heading",children:"LDAP Synchronisation"}),(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)("table",{className:"filter-table form-inline",children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:"External sync"}),(0,n.jsx)("td",{children:"User synced via LDAP. Some changes must be done in LDAP or mappings."}),(0,n.jsx)("td",{children:(0,n.jsx)(H.E,{label:"LDAP",removeIcon:!1,count:0,onClick:void 0})})]}),(0,n.jsx)("tr",{children:tn.enabled?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{children:"Next scheduled synchronization"}),(0,n.jsx)("td",{colSpan:2,children:Es})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("td",{children:"Next scheduled synchronization"}),(0,n.jsx)("td",{colSpan:2,children:"Not enabled"})]})})]})})}),(0,n.jsxs)("div",{className:"gf-form-button-row",children:[aa&&(0,n.jsx)(c.$n,{variant:"secondary",onClick:this.onUserSync,children:"Sync user"}),qa&&(0,n.jsx)(c.z9,{variant:"secondary",href:Ts,children:"Debug LDAP Mapping"})]})]})]})}}var _=e(3911),Q=e(82702),ae=e(37390),oe=e(88575),J=e(56034),ee=e(89062),de=e(85927),xe=e(41053),re=e(17172),ue=e(90182);function Te({onSelected:Rt,className:tn,inputId:Mn,autoFocus:zn,excludeOrgs:Es}){(0,z.useEffect)(()=>{zn&&Mn&&document.getElementById(Mn)?.focus()},[zn,Mn]);const[Ts,qa]=(0,xe.A)(async()=>{const ar=(await(0,re.AI)().get("/api/orgs")).map(Aa=>({value:{id:Aa.id,name:Aa.name},label:Aa.name}));if(Es){let Aa=Es.map(Dr=>Dr.orgId);return ar.filter(Dr=>!Aa.includes(Dr.value.id))}else return ar});return(0,n.jsx)(ue.DW,{inputId:Mn,className:tn,isLoading:Ts.loading,defaultOptions:!0,loadOptions:qa,filterOption:(aa,ar)=>{const Aa=ar.toLowerCase();return!!aa.value?.name.toLowerCase().includes(Aa)},onChange:Rt,placeholder:"Select organization",noOptionsMessage:"No organizations found"})}var ge=e(5133);class Oe extends z.PureComponent{constructor(){super(...arguments),this.addToOrgButtonRef=(0,z.createRef)(),this.state={showAddOrgModal:!1},this.showOrgAddModal=()=>{this.setState({showAddOrgModal:!0})},this.dismissOrgAddModal=()=>{this.setState({showAddOrgModal:!1},()=>{this.addToOrgButtonRef.current?.focus()})}}render(){const{user:tn,orgs:Mn,isExternalUser:zn,onOrgRoleChange:Es,onOrgRemove:Ts,onOrgAdd:qa}=this.props,{showAddOrgModal:aa}=this.state,ar=q.contextSrv.hasPermission(G.AccessControlAction.OrgUsersAdd)&&!zn;return(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Organizations"}),(0,n.jsxs)(d.B,{gap:1.5,direction:"column",children:[(0,n.jsx)("table",{className:"filter-table form-inline",children:(0,n.jsx)("tbody",{children:Mn.map((Aa,yr)=>(0,n.jsx)(we,{isExternalUser:zn,user:tn,org:Aa,onOrgRoleChange:Es,onOrgRemove:Ts},`${Aa.orgId}-${yr}`))})}),(0,n.jsx)("div",{children:ar&&(0,n.jsx)(c.$n,{variant:"secondary",onClick:this.showOrgAddModal,ref:this.addToOrgButtonRef,children:"Add user to organization"})}),(0,n.jsx)(We,{user:tn,userOrgs:Mn,isOpen:aa,onOrgAdd:qa,onDismiss:this.dismissOrgAddModal})]})]})}}const Ue=(0,_.N)(Rt=>({removeButton:(0,r.css)({marginRight:"0.6rem",textDecoration:"underline",color:Rt.v1.palette.blue95}),label:(0,r.css)({fontWeight:500}),disabledTooltip:(0,r.css)({display:"flex"}),tooltipItem:(0,r.css)({marginLeft:"5px"}),tooltipItemLink:(0,r.css)({color:Rt.v1.palette.blue95}),rolePickerWrapper:(0,r.css)({display:"flex"}),rolePicker:(0,r.css)({flex:"auto",marginRight:Rt.spacing(1)})}));class Xe extends z.PureComponent{constructor(){super(...arguments),this.state={currentRole:this.props.org.role,isChangingRole:!1,roleOptions:[]},this.onOrgRemove=async()=>{const{org:tn}=this.props;this.props.onOrgRemove(tn.orgId)},this.onChangeRoleClick=()=>{const{org:tn}=this.props;this.setState({isChangingRole:!0,currentRole:tn.role})},this.onOrgRoleChange=tn=>{this.setState({currentRole:tn})},this.onOrgRoleSave=()=>{this.props.onOrgRoleChange(this.props.org.orgId,this.state.currentRole)},this.onCancelClick=()=>{this.setState({isChangingRole:!1})},this.onBasicRoleChange=tn=>{this.props.onOrgRoleChange(this.props.org.orgId,tn)}}componentDidMount(){q.contextSrv.licensedAccessControlEnabled()&&q.contextSrv.hasPermission(G.AccessControlAction.ActionRolesList)&&(0,de.RL)(this.props.org.orgId).then(tn=>this.setState({roleOptions:tn})).catch(tn=>console.error(tn))}render(){const{user:tn,org:Mn,isExternalUser:zn,theme:Es}=this.props,Ts=tn?.authLabels?.length&&tn?.authLabels[0],qa=Ts?`Synced via ${Ts}`:"",{currentRole:aa,isChangingRole:ar}=this.state,Aa=Ue(Es),yr=(0,r.cx)("width-16",Aa.label),Dr=q.contextSrv.hasPermission(G.AccessControlAction.OrgUsersWrite),ao=q.contextSrv.hasPermission(G.AccessControlAction.OrgUsersRemove)&&!zn,Qr=zn||!Dr,Uo=`${Mn.name}-input`;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:yr,children:(0,n.jsx)("label",{htmlFor:Uo,children:Mn.name})}),q.contextSrv.licensedAccessControlEnabled()?(0,n.jsx)("td",{children:(0,n.jsxs)("div",{className:Aa.rolePickerWrapper,children:[(0,n.jsx)("div",{className:Aa.rolePicker,children:(0,n.jsx)(ee.y,{userId:tn?.id||0,orgId:Mn.orgId,basicRole:Mn.role,roleOptions:this.state.roleOptions,onBasicRoleChange:this.onBasicRoleChange,basicRoleDisabled:Qr,basicRoleDisabledMessage:`This user's role is not editable because it is synchronized from your auth provider.
                    Refer to the Grafana authentication docs for details.`})}),zn&&(0,n.jsx)(Ke,{lockMessage:qa})]})}):(0,n.jsxs)(n.Fragment,{children:[ar?(0,n.jsx)("td",{children:(0,n.jsx)(ge.r,{inputId:Uo,value:aa,onChange:this.onOrgRoleChange,autoFocus:!0})}):(0,n.jsx)("td",{className:"width-25",children:Mn.role}),(0,n.jsx)("td",{colSpan:1,children:Dr&&(0,n.jsx)(je,{lockMessage:qa,isExternalUser:zn,onChangeRoleClick:this.onChangeRoleClick,onCancelClick:this.onCancelClick,onOrgRoleSave:this.onOrgRoleSave})})]}),(0,n.jsx)("td",{colSpan:1,children:ao&&(0,n.jsx)(Q.Z,{confirmText:"Confirm removal",confirmVariant:"destructive",onCancel:this.onCancelClick,onConfirm:this.onOrgRemove,children:"Remove from organization"})})]})}}const we=(0,g.cV)(Xe),qe=(0,_.N)(()=>({modal:(0,r.css)({width:"500px"}),buttonRow:(0,r.css)({textAlign:"center"}),modalContent:(0,r.css)({overflow:"visible"})}));class We extends z.PureComponent{constructor(){super(...arguments),this.state={selectedOrg:null,role:G.OrgRole.Viewer,roleOptions:[],pendingOrgId:null,pendingUserId:null,pendingRoles:[]},this.onOrgSelect=tn=>{const Mn=this.props.userOrgs.find(zn=>zn.orgId===tn.value?.id);this.setState({selectedOrg:tn.value,role:Mn?.role||G.OrgRole.Viewer}),q.contextSrv.licensedAccessControlEnabled()&&q.contextSrv.hasPermission(G.AccessControlAction.ActionRolesList)&&(0,de.RL)(tn.value?.id).then(zn=>this.setState({roleOptions:zn})).catch(zn=>console.error(zn))},this.onOrgRoleChange=tn=>{this.setState({role:tn})},this.onAddUserToOrg=async()=>{const{selectedOrg:tn,role:Mn}=this.state;this.props.onOrgAdd(tn.id,Mn),q.contextSrv.licensedAccessControlEnabled()&&q.contextSrv.hasPermission(G.AccessControlAction.ActionUserRolesAdd)&&this.state.pendingUserId&&(await(0,de.eA)(this.state.pendingRoles,this.state.pendingUserId,this.state.pendingOrgId),this.setState({pendingOrgId:null,pendingRoles:[],pendingUserId:null}))},this.onCancel=()=>{this.setState({selectedOrg:null,pendingRoles:[],pendingOrgId:null,pendingUserId:null}),this.props.onDismiss&&this.props.onDismiss()},this.onRoleUpdate=async(tn,Mn,zn)=>{this.setState({pendingRoles:tn,pendingOrgId:zn,pendingUserId:Mn})}}render(){const{isOpen:tn,user:Mn,userOrgs:zn}=this.props,{role:Es,roleOptions:Ts,selectedOrg:qa}=this.state,aa=qe();return(0,n.jsxs)(ae.a,{className:aa.modal,contentClassName:aa.modalContent,title:"Add to an organization",isOpen:tn,onDismiss:this.onCancel,children:[(0,n.jsx)(oe.D,{label:"Organization",children:(0,n.jsx)(Te,{inputId:"new-org-input",onSelected:this.onOrgSelect,excludeOrgs:zn,autoFocus:!0})}),(0,n.jsx)(oe.D,{label:"Role",disabled:qa===null,children:(0,n.jsx)(ee.y,{userId:Mn?.id||0,orgId:qa?.id,basicRole:Es,onBasicRoleChange:this.onOrgRoleChange,basicRoleDisabled:!1,roleOptions:Ts,apply:!0,onApplyRoles:this.onRoleUpdate,pendingRoles:this.state.pendingRoles})}),(0,n.jsx)(ae.a.ButtonRow,{children:(0,n.jsxs)(d.B,{gap:2,justifyContent:"center",children:[(0,n.jsx)(c.$n,{variant:"secondary",fill:"outline",onClick:this.onCancel,children:"Cancel"}),(0,n.jsx)(c.$n,{variant:"primary",disabled:qa===null,onClick:this.onAddUserToOrg,children:"Add to organization"})]})})]})}}const Ce=Rt=>({disabledTooltip:(0,r.css)({display:"flex"}),tooltipItemLink:(0,r.css)({color:Rt.v1.palette.blue95}),lockMessageClass:(0,r.css)({fontStyle:"italic",marginLeft:"1.8rem",marginRight:"0.6rem"}),icon:(0,r.css)({lineHeight:2})});function je({lockMessage:Rt,onChangeRoleClick:tn,isExternalUser:Mn,onOrgRoleSave:zn,onCancelClick:Es}){const Ts=(0,g.of)(Ce);return(0,n.jsx)("div",{className:Ts.disabledTooltip,children:Mn?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:Ts.lockMessageClass,children:Rt}),(0,n.jsx)(J.m,{placement:"right-end",interactive:!0,content:(0,n.jsxs)("div",{children:["This user's role is not editable because it is synchronized from your auth provider. Refer to the\xA0",(0,n.jsx)("a",{className:Ts.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer",target:"_blank",children:"Grafana authentication docs"}),"\xA0for details."]}),children:(0,n.jsx)("div",{className:Ts.icon,children:(0,n.jsx)(h.I,{name:"question-circle"})})})]}):(0,n.jsx)(Q.Z,{confirmText:"Save",onClick:tn,onCancel:Es,onConfirm:zn,disabled:Mn,children:"Change role"})})}const Ke=({lockMessage:Rt})=>{const tn=(0,g.of)(_e);return(0,n.jsxs)("div",{className:tn.disabledTooltip,children:[(0,n.jsx)("span",{className:tn.lockMessageClass,children:Rt}),(0,n.jsx)(J.m,{placement:"right-end",interactive:!0,content:(0,n.jsxs)("div",{children:["This user's built-in role is not editable because it is synchronized from your auth provider. Refer to the\xA0",(0,n.jsx)("a",{className:tn.tooltipItemLink,href:"https://grafana.com/docs/grafana/latest/auth",rel:"noreferrer noopener",target:"_blank",children:"Grafana authentication docs"}),"\xA0for details."]}),children:(0,n.jsx)(h.I,{name:"question-circle"})})]})},_e=Rt=>({disabledTooltip:(0,r.css)({display:"flex"}),tooltipItemLink:(0,r.css)({color:Rt.v1.palette.blue95}),lockMessageClass:(0,r.css)({fontStyle:"italic",marginLeft:"1.8rem",marginRight:"0.6rem"})});var Fe=e(94354);const at=[{label:"Yes",value:!0},{label:"No",value:!1}];function Ct({isGrafanaAdmin:Rt,isExternalUser:tn,lockMessage:Mn,onGrafanaAdminChange:zn}){const[Es,Ts]=(0,z.useState)(!1),[qa,aa]=(0,z.useState)(Rt),ar=()=>Ts(!0),Aa=()=>{Ts(!1),aa(Rt)},yr=()=>zn(qa),Dr=q.contextSrv.hasPermission(G.AccessControlAction.UsersPermissionsUpdate)&&!tn,ao=(0,g.of)(Dt);return(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Permissions"}),(0,n.jsx)("table",{className:"filter-table form-inline",children:(0,n.jsx)("tbody",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"width-16",children:"Grafana Admin"}),Es?(0,n.jsx)("td",{colSpan:2,children:(0,n.jsx)(Fe.z,{options:at,value:qa,onChange:aa,autoFocus:!0})}):(0,n.jsx)("td",{colSpan:2,children:Rt?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.I,{name:"shield"})," Yes"]}):(0,n.jsx)(n.Fragment,{children:"No"})}),(0,n.jsxs)("td",{children:[Dr&&(0,n.jsx)(Q.Z,{onClick:ar,onConfirm:yr,onCancel:Aa,confirmText:"Change",children:"Change"}),tn&&(0,n.jsx)("div",{className:ao.lockMessageClass,children:(0,n.jsx)(Ke,{lockMessage:Mn})})]})]})})})]})}const Dt=Rt=>({lockMessageClass:(0,r.css)`
    display: flex;
    justify-content: flex-end;
    font-style: italic;
    margin-right: ${Rt.spacing(.6)};
  `});var tt=e(96374),ze=e(91634),pe=e(10354);function Se({user:Rt,onUserUpdate:tn,onUserDelete:Mn,onUserDisable:zn,onUserEnable:Es,onPasswordChange:Ts}){const[qa,aa]=(0,z.useState)(!1),[ar,Aa]=(0,z.useState)(!1),yr=(0,z.useRef)(null),Dr=_n=>()=>{aa(_n),!_n&&yr.current&&yr.current.focus()},ao=(0,z.useRef)(null),Qr=_n=>()=>{Aa(_n),!_n&&ao.current&&ao.current.focus()},Uo=()=>Mn(Rt.id),Co=()=>zn(Rt.id),lo=()=>Es(Rt.id),xo=_n=>{tn({...Rt,name:_n})},Yr=_n=>{tn({...Rt,email:_n})},zr=_n=>{tn({...Rt,login:_n})},qo=Rt.authLabels?.length&&Rt.authLabels[0],Mi=qo?`Synced via ${qo}`:"",_i=Rt.isExternal||!q.contextSrv.hasPermissionInMetadata(G.AccessControlAction.UsersWrite,Rt),Hi=Rt.isExternal||!q.contextSrv.hasPermissionInMetadata(G.AccessControlAction.UsersPasswordUpdate,Rt),ft=q.contextSrv.hasPermissionInMetadata(G.AccessControlAction.UsersDelete,Rt),hn=q.contextSrv.hasPermissionInMetadata(G.AccessControlAction.UsersDisable,Rt),dn=q.contextSrv.hasPermissionInMetadata(G.AccessControlAction.UsersEnable,Rt);return(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"page-heading",children:"User information"}),(0,n.jsxs)(d.B,{direction:"column",gap:1.5,children:[(0,n.jsx)("div",{children:(0,n.jsx)("table",{className:"filter-table form-inline",children:(0,n.jsxs)("tbody",{children:[(0,n.jsx)(fe,{label:"Name",value:Rt.name,locked:_i,lockMessage:Mi,onChange:xo}),(0,n.jsx)(fe,{label:"Email",value:Rt.email,locked:_i,lockMessage:Mi,onChange:Yr}),(0,n.jsx)(fe,{label:"Username",value:Rt.login,locked:_i,lockMessage:Mi,onChange:zr}),(0,n.jsx)(fe,{label:"Password",value:"********",inputType:"password",locked:Hi,lockMessage:Mi,onChange:Ts})]})})}),(0,n.jsxs)(d.B,{gap:2,children:[ft&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$n,{variant:"destructive",onClick:Dr(!0),ref:yr,children:"Delete user"}),(0,n.jsx)(tt.u,{isOpen:qa,title:"Delete user",body:"Are you sure you want to delete this user?",confirmText:"Delete user",onConfirm:Uo,onDismiss:Dr(!1)})]}),Rt.isDisabled&&dn&&(0,n.jsx)(c.$n,{variant:"secondary",onClick:lo,children:"Enable user"}),!Rt.isDisabled&&hn&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$n,{variant:"secondary",onClick:Qr(!0),ref:ao,children:"Disable user"}),(0,n.jsx)(tt.u,{isOpen:ar,title:"Disable user",body:"Are you sure you want to disable this user?",confirmText:"Disable user",onConfirm:Co,onDismiss:Qr(!1)})]})]})]})]})}class fe extends z.PureComponent{constructor(){super(...arguments),this.state={editing:!1,value:this.props.value||""},this.setInputElem=tn=>{this.inputElem=tn},this.onEditClick=()=>{this.props.inputType==="password"?this.setState({editing:!0,value:""},this.focusInput):this.setState({editing:!0},this.focusInput)},this.onCancelClick=()=>{this.setState({editing:!1,value:this.props.value||""})},this.onInputChange=(tn,Mn)=>{Mn!==ze.O.Invalid&&this.setState({value:tn.target.value})},this.onInputBlur=(tn,Mn)=>{Mn!==ze.O.Invalid&&this.setState({value:tn.target.value})},this.focusInput=()=>{this.inputElem&&this.inputElem.focus&&this.inputElem.focus()},this.onSave=()=>{this.props.onChange&&this.props.onChange(this.state.value)}}static{this.defaultProps={value:"",locked:!1,lockMessage:"",inputType:"text"}}render(){const{label:tn,locked:Mn,lockMessage:zn,inputType:Es}=this.props,{value:Ts}=this.state,qa=(0,r.cx)("width-16",(0,r.css)`
        font-weight: 500;
      `);if(Mn)return(0,n.jsx)(Ee,{label:tn,value:Ts,lockMessage:zn});const aa=`${tn}-input`;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:qa,children:(0,n.jsx)("label",{htmlFor:aa,children:tn})}),(0,n.jsx)("td",{className:"width-25",colSpan:2,children:this.state.editing?(0,n.jsx)(pe.p,{id:aa,type:Es,defaultValue:Ts,onBlur:this.onInputBlur,onChange:this.onInputChange,ref:this.setInputElem,width:30}):(0,n.jsx)("span",{children:this.props.value})}),(0,n.jsx)("td",{children:(0,n.jsx)(Q.Z,{confirmText:"Save",onClick:this.onEditClick,onConfirm:this.onSave,onCancel:this.onCancelClick,children:"Edit"})})]})}}const Ee=({label:Rt,value:tn,lockMessage:Mn})=>{const zn=(0,r.css)`
    font-style: italic;
    margin-right: 0.6rem;
  `,Es=(0,r.cx)("width-16",(0,r.css)`
      font-weight: 500;
    `);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:Es,children:Rt}),(0,n.jsx)("td",{className:"width-25",colSpan:2,children:tn}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:zn,children:Mn})})]})};var Pe=e(84753);class he extends z.PureComponent{constructor(){super(...arguments),this.forceAllLogoutButton=(0,z.createRef)(),this.state={showLogoutModal:!1},this.showLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!0})},this.dismissLogoutConfirmationModal=()=>{this.setState({showLogoutModal:!1},()=>{this.forceAllLogoutButton.current?.focus()})},this.onSessionRevoke=tn=>()=>{this.props.onSessionRevoke(tn)},this.onAllSessionsRevoke=()=>{this.setState({showLogoutModal:!1}),this.props.onAllSessionsRevoke()}}render(){const{sessions:tn}=this.props,{showLogoutModal:Mn}=this.state,zn=q.contextSrv.hasPermission(G.AccessControlAction.UsersLogout);return(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"page-heading",children:"Sessions"}),(0,n.jsxs)(d.B,{direction:"column",gap:1.5,children:[(0,n.jsx)("div",{children:(0,n.jsxs)("table",{className:"filter-table form-inline",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Last seen"}),(0,n.jsx)("th",{children:"Logged on"}),(0,n.jsx)("th",{children:"IP address"}),(0,n.jsx)("th",{colSpan:2,children:"Browser and OS"})]})}),(0,n.jsx)("tbody",{children:tn&&tn.map((Es,Ts)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:Es.isActive?"Now":Es.seenAt}),(0,n.jsx)("td",{children:(0,Pe.Y)(Es.createdAt,{dateStyle:"long"})}),(0,n.jsx)("td",{children:Es.clientIp}),(0,n.jsx)("td",{children:`${Es.browser} on ${Es.os} ${Es.osVersion}`}),(0,n.jsx)("td",{children:zn&&(0,n.jsx)(Q.Z,{confirmText:"Confirm logout",confirmVariant:"destructive",onConfirm:this.onSessionRevoke(Es.id),children:"Force logout"})})]},`${Es.id}-${Ts}`))})]})}),(0,n.jsxs)("div",{children:[zn&&tn.length>0&&(0,n.jsx)(c.$n,{variant:"secondary",onClick:this.showLogoutConfirmationModal,ref:this.forceAllLogoutButton,children:"Force logout from all devices"}),(0,n.jsx)(tt.u,{isOpen:Mn,title:"Force logout from all devices",body:"Are you sure you want to force logout from all devices?",confirmText:"Force logout",onConfirm:this.onAllSessionsRevoke,onDismiss:this.dismissLogoutConfirmationModal})]})]})]})}}const be=he;var Ae=e(57334);class De extends z.PureComponent{constructor(){super(...arguments),this.onUserUpdate=tn=>{this.props.updateUser(tn)},this.onPasswordChange=tn=>{const{user:Mn,setUserPassword:zn}=this.props;Mn&&zn(Mn.id,tn)},this.onUserDelete=tn=>{this.props.deleteUser(tn)},this.onUserDisable=tn=>{this.props.disableUser(tn)},this.onUserEnable=tn=>{this.props.enableUser(tn)},this.onGrafanaAdminChange=tn=>{const{user:Mn,updateUserPermissions:zn}=this.props;Mn&&zn(Mn.id,tn)},this.onOrgRemove=tn=>{const{user:Mn,deleteOrgUser:zn}=this.props;Mn&&zn(Mn.id,tn)},this.onOrgRoleChange=(tn,Mn)=>{const{user:zn,updateOrgUserRole:Es}=this.props;zn&&Es(zn.id,tn,Mn)},this.onOrgAdd=(tn,Mn)=>{const{user:zn,addOrgUser:Es}=this.props;zn&&Es(zn,tn,Mn)},this.onSessionRevoke=tn=>{const{user:Mn,revokeSession:zn}=this.props;Mn&&zn(tn,Mn.id)},this.onAllSessionsRevoke=()=>{const{user:tn,revokeAllSessions:Mn}=this.props;tn&&Mn(tn.id)},this.onUserSync=()=>{const{user:tn,syncLdapUser:Mn}=this.props;tn&&Mn(tn.id)}}async componentDidMount(){const{match:tn,loadAdminUserPage:Mn}=this.props;Mn(parseInt(tn.params.id,10))}render(){const{user:tn,orgs:Mn,sessions:zn,ldapSyncInfo:Es,isLoading:Ts}=this.props,qa=tn?.isExternal&&tn?.authLabels?.includes("LDAP"),aa=q.contextSrv.hasPermission(G.AccessControlAction.UsersAuthTokenList),ar=q.contextSrv.hasPermission(G.AccessControlAction.LDAPStatusRead),Aa=tn?.authLabels?.[0],yr=Aa?`Synced via ${Aa}`:"",Dr={text:tn?.login??"",icon:"shield",subTitle:"Manage settings for an individual user."};return(0,n.jsx)(S.Y,{navId:"global-users",pageNav:Dr,children:(0,n.jsx)(S.Y.Contents,{isLoading:Ts,children:(0,n.jsxs)(d.B,{gap:5,direction:"column",children:[tn&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Se,{user:tn,onUserUpdate:this.onUserUpdate,onUserDelete:this.onUserDelete,onUserDisable:this.onUserDisable,onUserEnable:this.onUserEnable,onPasswordChange:this.onPasswordChange}),qa&&tn?.isExternallySynced&&(0,X.a)("ldapsync")&&Es&&ar&&(0,n.jsx)(le,{ldapSyncInfo:Es,user:tn,onUserSync:this.onUserSync}),(0,n.jsx)(Ct,{isGrafanaAdmin:tn.isGrafanaAdmin,isExternalUser:tn?.isGrafanaAdminExternallySynced,lockMessage:yr,onGrafanaAdminChange:this.onGrafanaAdminChange})]}),Mn&&(0,n.jsx)(Oe,{user:tn,orgs:Mn,isExternalUser:tn?.isExternallySynced,onOrgRemove:this.onOrgRemove,onOrgRoleChange:this.onOrgRoleChange,onOrgAdd:this.onOrgAdd}),zn&&aa&&(0,n.jsx)(be,{sessions:zn,onSessionRevoke:this.onSessionRevoke,onAllSessionsRevoke:this.onAllSessionsRevoke})]})})})}}const Ie=Rt=>({user:Rt.userAdmin.user,sessions:Rt.userAdmin.sessions,orgs:Rt.userAdmin.orgs,ldapSyncInfo:Rt.ldap.syncInfo,isLoading:Rt.userAdmin.isLoading,error:Rt.userAdmin.error}),ke={loadAdminUserPage:Ae.kz,updateUser:Ae.TK,setUserPassword:Ae.ly,disableUser:Ae.MV,enableUser:Ae.nr,deleteUser:Ae.hG,updateUserPermissions:Ae.N6,addOrgUser:Ae.nh,updateOrgUserRole:Ae.P3,deleteOrgUser:Ae.Pi,revokeSession:Ae.T$,revokeAllSessions:Ae.VR,syncLdapUser:Ae.mI},Pt=(0,Y.connect)(Ie,ke)(De);var pt=e(49785),Tt=e(94753),jt=e(48840);const $t=({ldapConnectionInfo:Rt})=>{const tn=(0,z.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:zn=>zn.cell.value?(0,n.jsx)(d.B,{justifyContent:"end",children:(0,n.jsx)(J.m,{content:"Connection is available",children:(0,n.jsx)(h.I,{name:"check"})})}):(0,n.jsx)(d.B,{justifyContent:"end",children:(0,n.jsx)(J.m,{content:"Connection is not available",children:(0,n.jsx)(h.I,{name:"exclamation-triangle"})})})}],[]),Mn=(0,z.useMemo)(()=>Rt,[Rt]);return(0,n.jsx)("section",{children:(0,n.jsxs)(d.B,{direction:"column",gap:2,children:[(0,n.jsx)(Tt.E,{color:"primary",element:"h3",children:"LDAP Connection"}),(0,n.jsx)(jt.j,{data:Mn,columns:tn,getRowId:zn=>zn.host+zn.port}),(0,n.jsx)(sn,{ldapConnectionInfo:Rt})]})})},sn=({ldapConnectionInfo:Rt})=>{if(!Rt.some(Es=>Es.error))return null;const Mn=[];Rt.forEach(Es=>{Es.error&&Mn.push(Es)});const zn=Mn.map((Es,Ts)=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{style:{fontWeight:500},children:[Es.host,":",Es.port,(0,n.jsx)("br",{})]}),(0,n.jsx)("span",{children:Es.error}),Ts!==Mn.length-1&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})]},Ts));return(0,n.jsx)(o.F,{title:"Connection error",severity:G.AppNotificationSeverity.Error,children:zn})},Yt="dddd YYYY-MM-DD HH:mm zz",qt=({ldapSyncInfo:Rt})=>{const tn=(0,te.LE)(Rt.nextSync,{format:Yt}),Mn=[{id:"syncAttribute"},{id:"syncValue"}],zn=[{syncAttribute:"Active synchronization",syncValue:Rt.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:Rt.schedule},{syncAttribute:"Next synchronization",syncValue:tn}];return(0,n.jsxs)("section",{children:[(0,n.jsx)(Tt.E,{element:"h3",children:"LDAP Synchronization"}),(0,n.jsx)(jt.j,{data:zn,columns:Mn,getRowId:Es=>Es.syncAttribute})]})};var bn=e(90613);const Mt=({groups:Rt})=>{const tn=(0,z.useMemo)(()=>Rt,[Rt]),Mn=(0,z.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:zn=>zn.value&&zn.row.original.orgRole?zn.value:""},{id:"orgRole",header:"Role",cell:zn=>zn.value||(0,n.jsxs)(n.Fragment,{children:["No match"," ",(0,n.jsx)(J.m,{content:"No matching organizations found",children:(0,n.jsx)(h.I,{name:"info-circle"})})]})}],[]);return(0,n.jsx)(jt.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:Mn,data:tn,getRowId:zn=>zn.orgId+zn.orgRole+zn.groupDN})},Jt=({info:Rt})=>{const tn=(0,z.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),Mn=(0,z.useMemo)(()=>[{userInfo:"First name",ldapValue:Rt.name.ldapValue,cfgAttrValue:Rt.name.cfgAttrValue},{userInfo:"Surname",ldapValue:Rt.surname.ldapValue,cfgAttrValue:Rt.surname.cfgAttrValue},{userInfo:"Username",ldapValue:Rt.login.ldapValue,cfgAttrValue:Rt.login.cfgAttrValue},{userInfo:"Email",ldapValue:Rt.email.ldapValue,cfgAttrValue:Rt.email.cfgAttrValue}],[Rt]);return(0,n.jsx)(jt.j,{columns:tn,data:Mn,getRowId:zn=>zn.userInfo})},Ut=({permissions:Rt})=>{const tn=(0,z.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),Mn=(0,z.useMemo)(()=>[{permission:"Grafana admin",value:Rt.isGrafanaAdmin?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:Rt.isDisabled?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.I,{name:"times"})," Inactive"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.I,{name:"check"})," Active"]})}],[Rt]);return(0,n.jsx)(jt.j,{data:Mn,columns:tn,getRowId:zn=>zn.permission})},Gt=({teams:Rt})=>{const tn=(0,z.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:Mn}}})=>(0,n.jsx)(n.Fragment,{children:Mn||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:Mn,orgName:zn}}})=>Mn&&zn?Mn:""}],[]);return(0,n.jsx)(jt.j,{data:Rt,columns:tn,getRowId:Mn=>Mn.teamName})},Lt=({ldapUser:Rt})=>(0,n.jsxs)(d.B,{direction:"column",gap:4,children:[(0,n.jsx)(Jt,{info:Rt.info}),(0,n.jsx)(Ut,{permissions:Rt.permissions}),Rt.roles&&Rt.roles.length>0&&(0,n.jsx)(Mt,{groups:Rt.roles}),Rt.teams&&Rt.teams.length>0?(0,n.jsx)(Gt,{teams:Rt.teams}):(0,n.jsx)(bn.a,{children:(0,n.jsx)(Tt.E,{children:"No teams found via LDAP"})})]}),At={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},Nt=({clearUserMappingInfo:Rt,queryParams:tn,loadLdapState:Mn,loadLdapSyncStatus:zn,loadUserMapping:Es,clearUserError:Ts,ldapUser:qa,userError:aa,ldapError:ar,ldapSyncInfo:Aa,ldapConnectionInfo:yr})=>{const[Dr,ao]=(0,z.useState)(!0),{register:Qr,handleSubmit:Uo}=(0,pt.mN)(),Co=(0,z.useCallback)(async zr=>Es(zr),[Es]);(0,z.useEffect)(()=>{const zr=async()=>Promise.all([Mn(),zn()]);async function qo(){await Rt(),await zr(),tn.username&&await Co(tn.username),ao(!1)}qo()},[Rt,Co,Mn,zn,tn]);const lo=({username:zr})=>{zr&&Co(zr)},xo=()=>{Ts()},Yr=q.contextSrv.hasPermission(G.AccessControlAction.LDAPUsersRead);return(0,n.jsx)(S.Y,{navId:"authentication",pageNav:At,children:(0,n.jsx)(S.Y.Contents,{isLoading:Dr,children:(0,n.jsxs)(d.B,{direction:"column",gap:4,children:[ar&&ar.title&&(0,n.jsx)(o.F,{title:ar.title,severity:G.AppNotificationSeverity.Error,children:ar.body}),(0,n.jsx)($t,{ldapConnectionInfo:yr}),(0,X.a)("ldapsync")&&Aa&&(0,n.jsx)(qt,{ldapSyncInfo:Aa}),Yr&&(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{children:"Test user mapping"}),(0,n.jsx)("form",{onSubmit:Uo(lo),children:(0,n.jsx)(oe.D,{label:"Username",children:(0,n.jsx)(pe.p,{...Qr("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:tn.username,addonAfter:(0,n.jsx)(c.$n,{variant:"primary",type:"submit",children:"Run"})})})}),aa&&aa.title&&(0,n.jsx)(o.F,{title:aa.title,severity:G.AppNotificationSeverity.Error,onRemove:xo,children:aa.body}),qa&&(0,n.jsx)(Lt,{ldapUser:qa})]})]})})})},Dn=Rt=>({ldapConnectionInfo:Rt.ldap.connectionInfo,ldapUser:Rt.ldap.user,ldapSyncInfo:Rt.ldap.syncInfo,userError:Rt.ldap.userError,ldapError:Rt.ldap.ldapError}),An={loadLdapState:Ae.JI,loadLdapSyncStatus:Ae.pm,loadUserMapping:Ae.Kg,clearUserError:Ae.DX,clearUserMappingInfo:Ae.Jc},Xn=(0,Y.connect)(Dn,An)(Nt);var Tn=e(27921),ht=e(75471);function St(Rt=y.config){return[{path:"/alerting",component:Ge(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:Ge(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleRead,G.AccessControlAction.AlertingRuleExternalRead]),component:Ge(()=>Promise.all([e.e(7049),e.e(3511)]).then(e.bind(e,76543)))},{path:"/alerting/routes",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsRead,G.AccessControlAction.AlertingNotificationsExternalRead]),component:Ge(()=>e.e(6719).then(e.bind(e,6939)))},{path:"/alerting/routes/mute-timing/new",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite]),component:Ge(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite]),component:Ge(()=>e.e(4501).then(e.bind(e,39349)))},{path:"/alerting/silences",roles:(0,ht.C0)([G.AccessControlAction.AlertingInstanceRead,G.AccessControlAction.AlertingInstancesExternalRead,G.AccessControlAction.AlertingSilenceRead]),component:Ge(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,ht.C0)([G.AccessControlAction.AlertingInstanceCreate,G.AccessControlAction.AlertingInstancesExternalWrite]),component:Ge(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:Ge(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsRead,G.AccessControlAction.AlertingNotificationsExternalRead]),component:Ge(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsRead,G.AccessControlAction.AlertingNotificationsExternalRead]),component:Ge(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite]),component:Ge(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite,G.AccessControlAction.AlertingNotificationsRead,G.AccessControlAction.AlertingNotificationsExternalRead]),component:Ge(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite]),component:Ge(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite]),component:Ge(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,ht.C0)([G.AccessControlAction.AlertingNotificationsWrite,G.AccessControlAction.AlertingNotificationsExternalWrite]),component:Ge(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,ht.C0)([G.AccessControlAction.AlertingInstanceRead,G.AccessControlAction.AlertingInstancesExternalRead]),component:Ge(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/history/",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleRead]),component:Ge(()=>Promise.all([e.e(285),e.e(44)]).then(e.bind(e,53666)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleCreate,G.AccessControlAction.AlertingRuleExternalWrite]),component:Ge(()=>Promise.all([e.e(5682),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleUpdate,G.AccessControlAction.AlertingRuleExternalWrite]),component:Ge(()=>Promise.all([e.e(5682),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,50166)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleRead]),component:Ge(()=>Promise.all([e.e(5682),e.e(9947),e.e(7049),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleRead,G.AccessControlAction.AlertingRuleExternalRead]),component:Ge(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,ht.C0)([G.AccessControlAction.AlertingRuleRead,G.AccessControlAction.AlertingRuleExternalRead]),component:Ge(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:Ge(()=>e.e(9438).then(e.bind(e,53191)))}]}function Ge(Rt){const tn=()=>e.e(9029).then(e.bind(e,5961));return(0,Tn.A)(y.config.unifiedAlertingEnabled?Rt:tn)}var Ve=e(56361),lt=e(6320);const It=Rt=>({alertContent:(0,r.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,r.css)`
    margin: 0 ${Rt.spacing(1)} 0 0;
    line-height: ${Rt.spacing(Rt.components.height.sm)};
  `});function Qe(){const Rt=(0,g.of)(It),[tn,Mn]=(0,z.useState)(!0);return tn?(0,n.jsx)(o.F,{severity:"info",title:"",onRemove:()=>Mn(!1),children:(0,n.jsxs)("div",{className:Rt.alertContent,children:[(0,n.jsx)("p",{className:Rt.alertParagraph,children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."}),(0,n.jsx)(c.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:lt.b.DataSources,fill:"text",children:"Go to connections"})]})}):(0,n.jsx)(n.Fragment,{})}function vt(){return[{path:`/${lt.q}`,exact:!1,component:(0,Tn.A)(()=>Promise.all([e.e(6359),e.e(4253),e.e(2154)]).then(e.bind(e,34362)))}]}var Ot=e(83883),zt=e(57220),vn=e(14110),ln=(Rt=>(Rt.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",Rt.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",Rt.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",Rt.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",Rt))(ln||{});function On(Rt,tn){(0,vn.rR)(Rt,{...tn})}var wn=e(39601),Un=e(3704),cs=e(79938),Zn=e(82843),wt=e(37534),Ft=e(730);function Ht(){const[Rt,{data:tn,isLoading:Mn}]=cs.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:zn,isLoadingDsFeatures:Es}=(0,Ft.O3)(zt.hY),Ts=zn?.rulerConfig;return(0,z.useEffect)(()=>{Ts&&Rt({rulerConfig:Ts})},[Ts,Rt]),{isDone:(tn?Object.entries(tn).flatMap(([ar,Aa])=>Aa.flatMap(yr=>yr.rules)):[]).length>0,isLoading:Mn||Es}}function ut(Rt){return Rt.some(tn=>tn.grafana_managed_receiver_configs?.some(Mn=>Mn.type===wt.J4.OnCall))}function pn(){const Rt=Zn.m.endpoints.getAlertmanagerConfiguration.useQuery(zt.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:Rt.data?.alertmanager_config?.receivers??[],isLoading:Rt.isLoading}}function Jn(){const Rt=Zn.m.endpoints.getAlertmanagerConfiguration.useQuery(zt.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:Rt.data?.alertmanager_config?.route?.receiver??"",isLoading:Rt.isLoading}}const Qn="<example@email.com>";function fs(Rt,tn){return tn.some(zn=>zn.name===Rt&&zn.grafana_managed_receiver_configs?.some(Es=>Es.name===Rt&&Es.settings?.address!==Qn))}var ls=e(99494),vs=e(49962);const ea=Rt=>`/api/plugins/${ls.W.Incident}/resources${Rt}`,Ks=vs.Hr.injectEndpoints({endpoints:Rt=>({getIncidentsPluginConfig:Rt.query({query:()=>({url:ea("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var Hs=e(12210);function bs(){const{installed:Rt,loading:tn}=(0,Hs._)(ls.W.Incident),{data:Mn,isLoading:zn}=Ks.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:Rt??!1,isChatOpsInstalled:Mn?.isChatOpsInstalled??!1,isIncidentCreated:Mn?.isIncidentCreated??!1,isLoading:tn||zn}}var Ys=e(26423);function La(){const{installed:Rt}=(0,Hs._)(ls.W.OnCall),{data:tn}=Ys.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!Rt,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return tn??[]}function Xs(){const{data:Rt,isLoading:tn}=Ys.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:tn,onCallConfigChecks:Rt??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function Ta(){return La().map(tn=>({label:tn.display_name,value:tn.value}))}function Lr(){const{onCallConfigChecks:{is_chatops_connected:Rt,is_integration_chatops_connected:tn},isLoading:Mn}=Xs();return{is_chatops_connected:Rt,is_integration_chatops_connected:tn,isLoading:Mn}}const $r=`/api/plugins/${ls.W.Slo}/resources/v1`,Za=vs.Hr.injectEndpoints({endpoints:Rt=>({getSlos:Rt.query({query:()=>({url:`${$r}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function Er(){const{installed:Rt}=(0,Hs._)(ls.W.Slo),{data:tn,isLoading:Mn}=Za.endpoints.getSlos.useQuery(void 0,{skip:!Rt,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:Mn,hasSlo:!!tn?.slos.length,hasSloWithAlert:!!tn?.slos?.some(zn=>zn.alerting)}}function Ar(){const{contactPoints:Rt,isLoading:tn}=pn(),{defaultContactpoint:Mn,isLoading:zn}=Jn(),{isDone:Es,isLoading:Ts}=Ht(),{isChatOpsInstalled:qa,isInstalled:aa,isLoading:ar}=bs(),Aa=Ta(),{is_chatops_connected:yr,is_integration_chatops_connected:Dr,isLoading:ao}=Lr(),{hasSlo:Qr,hasSloWithAlert:Uo,isLoading:Co}=Er();return{alerting:{contactPoints:Rt,defaultContactpoint:Mn,isCreateAlertRuleDone:Es},incidents:{isChatOpsInstalled:qa,isIncidentsInstalled:aa},onCall:{onCallOptions:Aa,is_chatops_connected:yr,is_integration_chatops_connected:Dr},slo:{hasSlo:Qr,hasSloWithAlert:Uo},isLoading:tn||zn||Ts||ar||ao||Co}}function ho(){const{alerting:{contactPoints:Rt,defaultContactpoint:tn,isCreateAlertRuleDone:Mn},incidents:{isChatOpsInstalled:zn,isIncidentsInstalled:Es},onCall:{onCallOptions:Ts,is_chatops_connected:qa,is_integration_chatops_connected:aa},slo:{hasSlo:ar,hasSloWithAlert:Aa},isLoading:yr}=Ar();function Dr(Co,lo){const xo=(0,Un.G)(`${lo} + ${Co}`,{returnTo:location.pathname+location.search});wn.Ny.push(xo)}const ao={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${tn}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:fs(tn,Rt)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:ut(Rt)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:Mn},{title:"Create your first SLO",description:"Create SLOs to monitor your service.",button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:"Create",urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:ar},{title:"Enable SLO alerting",description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:"Enable",urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:Aa}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:Es},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:qa},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:zn},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:aa}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:Ts,onClickOption:Co=>Dr(Co,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:Qr,totalStepsToDo:Uo}=ao.sections.reduce((Co,lo)=>{const xo=lo.steps.filter(zr=>zr.done).length,Yr=lo.steps.reduce((zr,qo)=>qo.done!==void 0?zr+1:zr,0);return{stepsDone:Co.stepsDone+xo,totalStepsToDo:Co.totalStepsToDo+Yr}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:ao,stepsDone:Qr,totalStepsToDo:Uo,isLoading:yr}}const Fr=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:Rt},essentialsConfigurationData:{stepsDone:tn,totalStepsToDo:Mn}})=>(0,z.useMemo)(()=>{function zn(){const Es=Rt?"You have connected a datasource.":"Connect at least one data source to start receiving data",Ts=Rt?"View":"Connect";return{id:Bo.CONNECT_DATASOURCE,title:"Connect data source",description:Es,actionButtonTitle:Ts,isDone:Rt}}return[zn(),{id:Bo.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:tn===Mn?"View":"Configure",stepsDone:tn,totalStepsToDo:Mn}]},[Rt,tn,Mn]);var rr=e(39558),fo=e(76412);function _o({stepsDone:Rt,totalStepsToDo:tn}){const Mn=(0,g.of)(ci);return tn===0?null:(0,n.jsx)("div",{className:Mn.containerStyles,role:"progressbar","aria-valuenow":Rt,"aria-valuemax":tn,children:(0,n.jsx)("div",{className:Mn.fillerStyles(Rt/tn*100)})})}function gr({stepsDone:Rt,totalStepsToDo:tn}){return(0,n.jsxs)("span",{children:[(0,n.jsx)(Tt.E,{color:"success",children:Rt})," of ",tn]})}function ci(Rt){return{containerStyles:(0,r.css)({height:Rt.spacing(2),borderRadius:Rt.shape.radius.pill,backgroundColor:Rt.colors.border.weak,flex:"auto"}),fillerStyles:tn=>(0,r.css)({height:"100%",width:`${tn}%`,backgroundColor:Rt.colors.success.main,borderRadius:Rt.shape.radius.pill,textAlign:"right"})}}function Qo({config:Rt,handleActionClick:tn,isLoading:Mn=!1}){const zn=(0,g.of)(eo);return(0,n.jsx)(d.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,n.jsxs)("div",{className:zn.cardContent,children:[(0,n.jsxs)(d.B,{direction:"column",gap:1,children:[(0,n.jsxs)(d.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,n.jsx)("div",{className:"fs-unmask",children:(0,n.jsxs)(d.B,{direction:"row",gap:1,alignItems:"center",children:[Rt.title,Rt.titleIcon&&(0,n.jsx)(h.I,{name:Rt.titleIcon}),Rt.isDone&&!Mn&&(0,n.jsx)(h.I,{name:"check-circle",color:"green",size:"lg"})]})}),Rt.stepsDone&&Rt.totalStepsToDo&&!Mn&&(0,n.jsx)("div",{className:"fs-unmask",children:(0,n.jsxs)(d.B,{direction:"row",gap:.5,children:[(0,n.jsx)(gr,{stepsDone:Rt.stepsDone,totalStepsToDo:Rt.totalStepsToDo}),(0,n.jsx)(fo.x,{children:"complete"})]})})]}),(0,n.jsxs)(d.B,{direction:"column",children:[Mn?(0,n.jsx)(rr._,{text:"Loading configuration...."}):Rt.description,!Mn&&Rt.stepsDone&&Rt.totalStepsToDo&&(0,n.jsx)(_o,{stepsDone:Rt.stepsDone,totalStepsToDo:Rt.totalStepsToDo})]})]}),(0,n.jsx)(d.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,n.jsx)(c.$n,{variant:"secondary",onClick:()=>tn(Rt.id,Rt.isDone),className:"fs-unmask",children:Rt.actionButtonTitle})})]})})}const eo=Rt=>({cardTitle:(0,r.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,r.css)({background:Rt.colors.background.secondary,padding:Rt.spacing(2),borderRadius:Rt.shape.radius.default,height:"100%",gap:Rt.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var Do=e(87978),di=e(83122),bo=e(38138);function Oo({onClose:Rt,essentialsConfig:tn,stepsDone:Mn,totalStepsToDo:zn}){return(0,n.jsx)(Do._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:Rt,children:(0,n.jsx)(To,{essentialContent:tn,stepsDone:Mn,totalStepsToDo:zn})})}function To({essentialContent:Rt,stepsDone:tn,totalStepsToDo:Mn}){return(0,n.jsxs)(d.B,{direction:"column",gap:1,children:[(0,n.jsx)(ai,{stepsDone:tn,totalStepsToDo:Mn}),Rt.sections.map(zn=>(0,n.jsx)(jo,{section:zn},zn.title))]})}function jo({section:Rt}){const tn=(0,g.of)(yi);return(0,n.jsxs)("div",{className:tn.wrapper,children:[(0,n.jsx)(Tt.E,{element:"h4",children:(0,n.jsx)("span",{className:"fs-unmask",children:Rt.title})}),(0,n.jsx)(Tt.E,{color:"secondary",children:(0,n.jsx)("span",{className:"fs-unmask",children:Rt.description})}),(0,n.jsx)(d.B,{direction:"column",gap:2,children:Rt.steps.map((Mn,zn)=>(0,n.jsx)(Yo,{step:Mn},zn))})]})}function $o({done:Rt}){return Rt?(0,n.jsx)(h.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,n.jsx)(h.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function Yo({step:Rt}){return(0,n.jsxs)(d.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,n.jsxs)(d.B,{direction:"row",alignItems:"center",children:[Rt.done!==void 0&&(0,n.jsx)($o,{done:Rt.done}),(0,n.jsx)(Tt.E,{variant:"body",children:(0,n.jsx)("span",{className:"fs-unmask",children:Rt.title})}),(0,n.jsx)(J.m,{content:Rt.description,placement:"right",children:(0,n.jsx)(h.I,{name:"question-circle"})})]}),(0,n.jsx)(vi,{...Rt.button,done:Rt.done,"data-testid":"step-button"})]})}function Si(Rt){const{urlLink:tn,label:Mn,urlLinkOnDone:zn,labelOnDone:Es,done:Ts}=Rt,qa=tn?.url?(0,Un.G)(tn.url,{returnTo:location.pathname+location.search,...tn.queryParams}):"",aa=zn?.url?(0,Un.G)(zn.url,{returnTo:location.pathname+location.search,...zn.queryParams}):"",ar=Ts?aa:qa;return(0,n.jsx)(c.z9,{href:ar,variant:"secondary",className:"fs-unmask",children:Ts?Es??Mn:Mn})}function vi({type:Rt,urlLink:tn,urlLinkOnDone:Mn,label:zn,labelOnDone:Es,options:Ts,onClickOption:qa,done:aa,stepNotAvailableText:ar}){switch(Rt){case"openLink":return(0,n.jsx)(Si,{urlLink:tn,label:zn,urlLinkOnDone:Mn,labelOnDone:Es,done:aa});case"dropDown":return Ts?.length?(0,n.jsx)(di.m,{overlay:(0,n.jsx)(bo.W,{className:"fs-unmask",children:Ts?.map(Aa=>(0,n.jsx)(bo.W.Item,{label:Aa.label,className:"fs-unmask",onClick:()=>{qa?.(Aa.value)}},Aa.value))}),children:(0,n.jsxs)(c.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[zn,(0,n.jsx)(h.I,{name:"angle-down"})]})}):(0,n.jsxs)(Tt.E,{children:[ar??"No options available"," "]})}}function ai({stepsDone:Rt,totalStepsToDo:tn}){return(0,n.jsxs)(d.B,{direction:"row",gap:1,alignItems:"center",children:["Your progress",(0,n.jsx)(_o,{stepsDone:Rt,totalStepsToDo:tn}),(0,n.jsx)(gr,{stepsDone:Rt,totalStepsToDo:tn})]})}const yi=Rt=>({wrapper:(0,r.css)({margin:Rt.spacing(2,0),padding:Rt.spacing(2),border:`1px solid ${Rt.colors.border.medium}`,borderRadius:Rt.shape.radius.default,display:"flex",flexDirection:"column",gap:Rt.spacing(2)})});var Bo=(Rt=>(Rt[Rt.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",Rt[Rt.ESSENTIALS=1]="ESSENTIALS",Rt))(Bo||{});function Ai(){return{dataSourceCompatibleWithAlerting:!!(0,zt.k5)()}}function Ho(){const Rt=(0,g.of)(ui),tn=(0,s.W6)(),Mn=Ai(),zn=ho(),Es=Fr({dataSourceConfigurationData:Mn,essentialsConfigurationData:zn});(0,z.useEffect)(()=>{On(ln.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:Mn.dataSourceCompatibleWithAlerting})},[Mn.dataSourceCompatibleWithAlerting]);const[Ts,qa]=(0,z.useState)(!1),aa=(Aa,yr)=>{switch(On(ln.ClickDataSources,{essentialStepsDone:zn.stepsDone,essentialStepsToDo:zn.totalStepsToDo,dataSourceCompatibleWithAlerting:Mn.dataSourceCompatibleWithAlerting}),Aa){case 0:yr?tn.push(Ot.I.List):tn.push(Ot.I.New);break;case 1:qa(!0),On(ln.OpenEssentials,{essentialStepsDone:zn.stepsDone,essentialStepsToDo:zn.totalStepsToDo,dataSourceCompatibleWithAlerting:Mn.dataSourceCompatibleWithAlerting});break;default:return}};function ar(){qa(!1),On(ln.CloseEssentials,{essentialStepsDone:zn.stepsDone,essentialStepsToDo:zn.totalStepsToDo,dataSourceCompatibleWithAlerting:Mn.dataSourceCompatibleWithAlerting})}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Tt.E,{element:"h4",variant:"h4",children:"Configure"}),(0,n.jsxs)("section",{className:Rt.container,children:[Es.map(Aa=>(0,n.jsx)(Qo,{config:Aa,handleActionClick:aa,isLoading:zn.isLoading},Aa.id)),Ts&&(0,n.jsx)(Oo,{onClose:ar,essentialsConfig:zn.essentialContent,stepsDone:zn.stepsDone,totalStepsToDo:zn.totalStepsToDo})]}),(0,n.jsx)(Tt.E,{element:"h4",variant:"h4",children:"IRM apps"})]})}const ui=Rt=>({container:(0,r.css)({marginBottom:0,display:"grid",gap:Rt.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var Jo=e(66253);const Ri=[{path:"/plugins",navId:"plugins",roles:xi([G.AccessControlAction.PluginsInstall,G.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Jo.vk.Home,component:(0,Tn.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/browse",navId:"plugins",roles:xi([G.AccessControlAction.PluginsInstall,G.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Jo.vk.Browse,component:(0,Tn.A)(()=>e.e(4519).then(e.bind(e,65965)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:xi([G.AccessControlAction.PluginsInstall,G.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:Jo.vk.Details,component:(0,Tn.A)(()=>Promise.all([e.e(6359),e.e(4253),e.e(7891)]).then(e.bind(e,86400)))}];function xi(Rt,tn){return()=>Rt.some(Mn=>q.contextSrv.hasPermission(Mn))?[]:tn}function Po(){return Ri}var ri=e(17422),Ei=e(65307),Zo=e(13834),_t=e(62625),cn=e(26272),kn=e(43429),Kn=e(39419),ns=e(76888);function Rs(Rt){return console.error(Rt),ha("Exception thrown","See console for details")}function Os(){return ha("Page not found","404 Error")}function ha(Rt,tn){const Mn={text:Rt,subTitle:tn,icon:"exclamation-triangle"};return{node:Mn,main:Mn}}var na=e(94954),wa=e(27716),pr=e(685),Ma=e(60677),ks=e(72798);const oo={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function go({pluginId:Rt,pluginNavSection:tn}){const Mn=(0,s.W5)(),zn=(0,s.zy)(),[Es,Ts]=(0,z.useReducer)(qr.reducer,oo),qa=i.$.appSubUrl+zn.pathname+zn.search,{plugin:aa,loading:ar,loadingError:Aa,pluginNav:yr}=Es,Dr=(0,Ma.Wy)(tn,yr,qa),ao=(0,z.useMemo)(()=>(0,wn.SE)(zn.search),[zn.search]),Qr=(0,z.useMemo)(()=>(0,ks.S)(Dr),[Dr]),Uo=(0,ns.Il)();(0,z.useEffect)(()=>{po(Rt,Ts)},[Rt]);const Co=(0,z.useCallback)(zr=>Ts(qr.actions.changeNav(zr)),[]);if(!aa||Rt!==aa.meta.id){const zr=Uo.chrome.state.getValue().layout;return(0,n.jsxs)(S.Y,{navModel:Dr,pageNav:{text:""},layout:zr,children:[ar&&(0,n.jsx)(Kn.A,{}),!ar&&Aa&&(0,n.jsx)(B.L,{entity:"App"})]})}if(!aa.root)return(0,n.jsx)(S.Y,{navModel:Dr??ha("Plugin load error"),children:(0,n.jsx)("div",{children:"No root app page component found"})});const lo=aa.root&&(0,n.jsx)(Zo.a,{meta:aa.meta,children:(0,n.jsx)(aa.root,{meta:aa.meta,basename:Mn.url,onNavChanged:Co,query:ao,path:zn.pathname})}),xo=()=>{if(!aa.meta?.includes)return!0;const zr=aa.meta?.includes.find(Mi=>Mi.path===zn.pathname);if(!zr)return!0;if(zr?.action&&i.$.featureToggles.accessControlOnCall)return q.contextSrv.hasPermission(zr.action);if(q.contextSrv.isGrafanaAdmin||q.contextSrv.user.orgRole===_t.X.Admin)return!0;const qo=zr?.role||"";return!qo||q.contextSrv.isEditor&&qo===_t.X.Viewer?!0:q.contextSrv.hasRole(qo)},Yr=()=>(0,n.jsx)(o.F,{severity:"warning",title:"Access denied",children:"You do not have permission to see this page."});return xo()?yr?(0,n.jsx)(n.Fragment,{children:Dr?(0,n.jsx)(S.Y,{navModel:Dr,pageNav:yr?.node,children:(0,n.jsx)(S.Y.Contents,{isLoading:ar,children:lo})}):(0,n.jsx)(S.Y,{children:lo})}):(0,n.jsx)(ks.A.Provider,{value:Qr,children:lo}):(0,n.jsx)(Yr,{})}const qr=(0,Ei.Z0)({name:"prom-builder-container",initialState:oo,reducers:{setState:(Rt,tn)=>{Object.assign(Rt,tn.payload)},changeNav:(Rt,tn)=>{let Mn=tn.payload;Mn&&Mn.node.children&&(Mn={...Mn,node:{...Mn.main,hideFromBreadcrumbs:!0}}),Rt.pluginNav=Mn}}});async function po(Rt,tn){try{const Mn=await(0,wa.x)(Rt).then(zn=>{const Es=yo(zn);return Es?(q.lE.emit(cn.r1.alertError,[Es]),tn(qr.actions.setState({pluginNav:ha(Es)})),null):(0,pr.ui)(zn)});tn(qr.actions.setState({plugin:Mn,loading:!1,loadingError:!1,pluginNav:null}))}catch(Mn){tn(qr.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:Os()}));const zn=Mn instanceof Error?Mn:new Error((0,na.q)(Mn));Ma.z4.logError(zn),console.error(zn)}}function yo(Rt){return Rt?Rt.type!==kn.QE.app?"Plugin must be an app":Rt.enabled?null:"Application Not Enabled":"Unknown Plugin"}const hi=go;var Di=e(99140);function Rr(){const Rt=(0,Di.Gu)(),{navIndex:tn}=Rt,Mn=Ts=>Ts.startsWith("standalone-plugin-page-/"),zn=Ts=>"pluginId"in Ts&&"id"in Ts;return[...Object.values(tn).filter(zn).map(Ts=>{const qa=(0,ri.rH)(Ts),aa=`/a/${Ts.pluginId}`,ar=Mn(Ts.id)&&Ts.url||aa,Aa=Mn(Ts.id)&&!Ts.url?.startsWith("/a/");return{path:ar,exact:!1,sensitive:Aa,component:()=>(0,n.jsx)(hi,{pluginId:Ts.pluginId,pluginNavSection:qa})}}),{path:"/a/:pluginId",exact:!1,component:({match:Ts})=>(0,n.jsx)(hi,{pluginId:Ts.params.pluginId,pluginNavSection:tn.home})}]}const tr=[{path:"/profile",component:(0,Tn.A)(()=>e.e(2472).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,Tn.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,Tn.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,Tn.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function Vr(Rt=y.config){return Rt.profileEnabled?tr:(0,f.uniq)(tr.map(Mn=>Mn.path)).map(Mn=>({path:Mn,component:(0,Tn.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}const io=()=>!y.config.publicDashboardsEnabled||!y.config.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:G.DashboardRoutes.Public,component:(0,Tn.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:G.DashboardRoutes.Public,chromeless:!0,component:(0,Tn.A)(()=>Promise.all([e.e(6263),e.e(7197)]).then(e.bind(e,15663)))}],ja=[];function Xo(){return[...Rr(),{path:"/",pageClass:"page-dashboard",routeName:G.DashboardRoutes.Home,component:(0,Tn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,77709)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:G.DashboardRoutes.Normal,component:(0,Tn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136)]).then(e.bind(e,77709)))},{path:"/dashboard/new",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:G.DashboardRoutes.New,component:(0,Tn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,77709)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.DashboardsCreate]),component:(0,Tn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:G.DashboardRoutes.Normal,component:(0,Tn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,77709)))},{path:"/dashboards/embedding-test",component:(0,Tn.A)(()=>Promise.all([e.e(660),e.e(6263),e.e(9136),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",routeName:G.DashboardRoutes.Normal,chromeless:!0,component:(0,Tn.A)(()=>y.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,24880)):Promise.resolve().then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",routeName:G.DashboardRoutes.Normal,chromeless:!0,component:(0,Tn.A)(()=>e.e(7849).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,Tn.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:Ot.I.List,component:()=>(0,n.jsx)(s.rd,{to:lt.b.DataSources})},{path:Ot.I.Edit,component:Rt=>(0,n.jsx)(s.rd,{to:lt.b.DataSourcesEdit.replace(":uid",Rt.match.params.uid)})},{path:Ot.I.Dashboards,component:Rt=>(0,n.jsx)(s.rd,{to:lt.b.DataSourcesDashboards.replace(":uid",Rt.match.params.uid)})},{path:Ot.I.New,component:()=>(0,n.jsx)(s.rd,{to:lt.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,Tn.A)(()=>y.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,Tn.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,Tn.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,Tn.A)(()=>Promise.all([e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.DataSourcesExplore]),component:(0,Tn.A)(()=>y.Ay.exploreEnabled?Promise.all([e.e(660),e.e(1698),e.e(5511),e.e(9604)]).then(e.bind(e,46277)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>(0,n.jsx)(F,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,n.jsx)(F,{navId:"alerts-and-incidents",header:!(0,Ve.y$)()&&(0,Ve.qc)()||(0,Ve.ES)()?(0,n.jsx)(Ho,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,n.jsx)(F,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,n.jsx)(F,{navId:"monitoring"})},{path:"/infrastructure",component:()=>(0,n.jsx)(F,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,n.jsx)(F,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,n.jsx)(F,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,n.jsx)(F,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>(0,n.jsx)(F,{navId:"cfg/access"})},{path:"/org",component:(0,Tn.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,Tn.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:()=>(0,n.jsx)(s.rd,{to:"/admin/users"})},{path:"/org/users/invite",component:(0,Tn.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.ActionAPIKeysRead]),component:(0,Tn.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.ServiceAccountsRead,G.AccessControlAction.ServiceAccountsCreate]),component:(0,Tn.A)(()=>e.e(6777).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,Tn.A)(()=>e.e(4176).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,Tn.A)(()=>e.e(6576).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.ActionTeamsRead,G.AccessControlAction.ActionTeamsCreate]),component:(0,Tn.A)(()=>e.e(1036).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.ActionTeamsCreate]),component:(0,Tn.A)(()=>e.e(5436).then(e.bind(e,80011)))},{path:"/org/teams/edit/:id/:page?",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.ActionTeamsRead,G.AccessControlAction.ActionTeamsCreate]),component:(0,Tn.A)(()=>e.e(2212).then(e.bind(e,82508)))},{path:"/admin",component:()=>(0,n.jsx)(F,{navId:"cfg",header:(0,n.jsx)(Qe,{})})},{path:"/admin/authentication",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.SettingsWrite]),component:y.Ay.licenseInfo.enabledFeatures?.saml||y.Ay.ldapEnabled||y.Ay.featureToggles.ssoSettingsApi?(0,Tn.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>(0,n.jsx)(s.rd,{to:"/admin"})},{path:"/admin/authentication/ldap",component:Xn},{path:"/admin/authentication/:provider",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.SettingsWrite]),component:y.Ay.featureToggles.ssoSettingsApi?(0,Tn.A)(()=>e.e(5592).then(e.bind(e,22468))):()=>(0,n.jsx)(s.rd,{to:"/admin"})},{path:"/admin/settings",component:(0,Tn.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,Tn.A)(()=>Promise.resolve().then(e.bind(e,55356)))},{path:"/admin/users",component:(0,Tn.A)(()=>e.e(1743).then(e.bind(e,65551)))},{path:"/admin/users/create",component:(0,Tn.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:Pt},{path:"/admin/orgs",component:(0,Tn.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,Tn.A)(()=>e.e(9119).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:y.Ay.featureToggles.featureToggleAdminPage?(0,Tn.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>(0,n.jsx)(s.rd,{to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,Tn.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,Tn.A)(()=>Promise.resolve().then(e.bind(e,51372)))},y.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,Tn.A)(()=>e.e(3704).then(e.bind(e,76491)))},{path:"/login",component:R,pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,Tn.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:y.Ay.verifyEmailEnabled?(0,Tn.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>(0,n.jsx)(s.rd,{to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:y.Ay.disableUserSignUp?()=>(0,n.jsx)(s.rd,{to:"/login"}):(0,Tn.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,Tn.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,Tn.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,Tn.A)(()=>e.e(6590).then(e.bind(e,72602)))},y.Ay.featureToggles.dashboardRestoreUI&&{path:"/dashboard/recently-deleted",roles:()=>["Admin"],component:(0,Tn.A)(()=>Promise.all([e.e(6359),e.e(6299)]).then(e.bind(e,10421)))},{path:"/playlists",component:(0,Tn.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,Tn.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,Tn.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,Tn.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,Tn.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,Tn.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,Tn.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>W.TP.evaluatePermission([G.AccessControlAction.AlertingRuleRead]),component:(0,Tn.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,Tn.A)(()=>e.e(8516).then(e.bind(e,45434)))},{path:"/notifications",component:(0,Tn.A)(()=>e.e(4140).then(e.bind(e,78015)))},y.Ay.featureToggles.exploreMetrics&&{path:"/explore/metrics",chromeless:!1,exact:!1,roles:()=>W.TP.evaluatePermission([G.AccessControlAction.DataSourcesExplore]),component:(0,Tn.A)(()=>e.e(4785).then(e.bind(e,89858)))},{path:"/bookmarks",component:()=>(0,n.jsx)(F,{navId:"bookmarks"})},...Po(),...Ti(),...St(),...Vr(),...ja,...io(),...vt(),{path:"/*",component:K}].filter(l.zz)}function Ti(Rt=y.Ay){return Rt.supportBundlesEnabled?[{path:"/support-bundles",component:(0,Tn.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,Tn.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}},2272:(k,A,e)=>{"use strict";e.d(A,{C3:()=>qe,Co:()=>Ue,U1:()=>We});var n=e(65307),s=e(10378),l=e(55314),r=e(72686),i=e(59120),g=e(8856),o=e(28215),d=e(14644),c=e(16001),a=e(91219);const p={navBarTree:a.I_,navIndex:o._h,appNotifications:c.g5};var u=e(44672),m=e(47232),v=e(88467),x=e(23770);const E=(0,d.combineReducers)({dataSources:(0,v.Xw)("dataSources",x.DC,({rulesSourceName:Ce})=>Ce).reducer,promRules:(0,v.Xw)("promRules",x.mB,({rulesSourceName:Ce})=>Ce).reducer,rulerRules:(0,v.Xw)("rulerRules",x.eB,({rulesSourceName:Ce})=>Ce).reducer,ruleForm:(0,d.combineReducers)({saveRule:(0,v.J7)("saveRule",x._$).reducer}),saveAMConfig:(0,v.J7)("saveAMConfig",x.RW).reducer,deleteAMConfig:(0,v.J7)("deleteAMConfig",x.nO).reducer,folders:(0,v.Xw)("folders",x.Tp,Ce=>Ce).reducer,amAlertGroups:(0,v.Xw)("amAlertGroups",x.D3,Ce=>Ce).reducer,testReceivers:(0,v.J7)("testReceivers",x.bO).reducer,managedAlertStateHistory:(0,v.J7)("managedAlertStateHistory",x.JH).reducer});var h=e(55907);const y={items:[],searchQuery:"",isLoading:!1},b={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function D(Ce,je){const Ke=h.A.getStateDisplayModel(je),_e={...Ce,stateText:Ke.text,stateIcon:Ke.iconClass,stateClass:Ke.stateClass,stateAge:(0,m.KQ)(Ce.newStateDate).fromNow(!0)};return _e.state!=="paused"&&(_e.executionError&&(_e.info="Execution Error: "+_e.executionError),_e.evalData&&_e.evalData.noData&&(_e.info="Query returned no data")),_e}const P=(0,n.Z0)({name:"alertRules",initialState:y,reducers:{loadAlertRules:Ce=>({...Ce,isLoading:!0}),loadedAlertRules:(Ce,je)=>{const _e=je.payload.map(Fe=>D(Fe,Fe.state));return{...Ce,items:_e,isLoading:!1}},setSearchQuery:(Ce,je)=>({...Ce,searchQuery:je.payload})}}),C=(0,n.Z0)({name:"notificationChannel",initialState:b,reducers:{setNotificationChannels:(Ce,je)=>({...Ce,notificationChannelTypes:U(je.payload),notifiers:je.payload}),notificationChannelLoaded:(Ce,je)=>{const Ke=je.payload,Fe=Ce.notifiers.find(at=>at.type===Ke.type).options.filter(at=>at.secure);return Fe.length>0&&Fe.some(at=>Ke.settings[at.propertyName]!=="")?F(Ce,je.payload,Fe):{...Ce,notificationChannel:Ke}},resetSecureField:(Ce,je)=>({...Ce,notificationChannel:{...Ce.notificationChannel,secureFields:{...Ce.notificationChannel.secureFields,[je.payload]:!1}}})}}),{loadAlertRules:M,loadedAlertRules:I,setSearchQuery:R}=P.actions,{setNotificationChannels:T,notificationChannelLoaded:S,resetSecureField:L}=C.actions,O=P.reducer,j=C.reducer,N={alertRules:O,notificationChannel:j,unifiedAlerting:E};function F(Ce,je,Ke){const _e={},Fe={};return Ke.forEach(at=>{Fe[at.propertyName]=je.settings[at.propertyName],_e[at.propertyName]=""}),{...Ce,notificationChannel:{...je,settings:{...je.settings,..._e},secureSettings:{...Fe}}}}function U(Ce){return Ce.map(je=>({value:je.type,label:je.name,...je,typeName:je.type})).sort((je,Ke)=>je.name>Ke.name?1:-1)}var w=e(93584),B=e(20604),K=e(79763),W=e(53466),z=e(28601),Y=e(36227),X=e(29436),q=e(54650),G=e(40823),te=e(88264),H=e(10943),se=e(80095),ne=e(31326),le=e(81862),_=e(1936),Q=e(8212),ae=e(34655),oe=e(87617),J=e(48594),ee=e(49962),de=e(2858),xe=e(97007);const re={...p,...N,...ae.Ay,...w.Ay,...q.Ay,...z.Ay,...X.Ay,...Y.Ay,...oe.Ay,..._.Ay,...le.Ay,...G.Ay,...H.Ay,...K.Ay,...u.Ay,...te.Ay,...W.Ay,...se.Ay,...J.Ay,...Q.Ay,...B.Ay,plugins:ne.Ff,[ee.Hr.reducerPath]:ee.Hr.reducer,[r.Sm.reducerPath]:r.Sm.reducer,[l.cU.reducerPath]:l.cU.reducer,[i.O5.reducerPath]:i.O5.reducer,[de.g.reducerPath]:de.g.reducer,[g.Aj.reducerPath]:g.Aj.reducer},ue={},Te=Ce=>{Object.assign(ue,Ce)},ge=()=>{const Ce=(0,d.combineReducers)({...re,...ue});return(je,Ke)=>{if(Ke.type!==xe.N.type)return Ce(je,Ke);const{cleanupAction:_e}=Ke.payload;return _e(je),Ce(je,Ke)}};var Oe=e(99140);function Ue(Ce){Te(Ce)}const Xe=(0,n.Nc)(),we=[];function qe(Ce){we.push(Ce)}function We(Ce){const je=(0,n.U1)({reducer:ge(),middleware:Ke=>Ke({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(Xe.middleware,ee.Hr.middleware,r.Sm.middleware,l.cU.middleware,i.O5.middleware,de.g.middleware,g.Aj.middleware,...we),devTools:!1,preloadedState:{navIndex:(0,o.s2)(),...Ce}});return(0,s.$k)(je.dispatch),(0,Oe.k3)(je),je}},99140:(k,A,e)=>{"use strict";e.d(A,{Gu:()=>r,JD:()=>i,M_:()=>s,k3:()=>l});var n=e(48594);let s;function l(g){s=g}function r(){return!s||!s.getState?{templating:{...n.L1,lastKey:"key"}}:s.getState()}function i(g){if(!(!s||!s.getState))return s.dispatch(g)}},24897:(k,A,e)=>{"use strict";e.d(A,{RG:()=>l,Vz:()=>r,XT:()=>n.X,Xe:()=>s});var n=e(62625),s=(i=>(i[i.Admin=4]="Admin",i[i.Editor=2]="Editor",i[i.Member=0]="Member",i[i.Viewer=1]="Viewer",i))(s||{}),l=(i=>(i.View="View",i.Edit="Edit",i.Admin="Admin",i))(l||{}),r=(i=>(i.Folder="dash-folder",i.Dashboard="dash-db",i.AlertFolder="dash-folder-alerting",i))(r||{})},50271:()=>{"use strict"},18625:()=>{"use strict"},14276:()=>{"use strict"},95425:(k,A,e)=>{"use strict";e.d(A,{Z4:()=>n,_g:()=>s,d9:()=>l});var n=(r=>(r.Home="home-dashboard",r.New="new-dashboard",r.Normal="normal-dashboard",r.Path="path-dashboard",r.Scripted="scripted-dashboard",r.Public="public-dashboard",r.Embedded="embedded-dashboard",r.Report="report-dashboard",r))(n||{}),s=(r=>(r.NotStarted="Not started",r.Fetching="Fetching",r.Services="Services",r.Failed="Failed",r.Completed="Completed",r))(s||{}),l=(r=>(r.TV="tv",r.Full="full",r))(l||{})},62543:()=>{"use strict"},28444:(k,A,e)=>{"use strict";e.d(A,{Bt:()=>h,Cf:()=>u,Eu:()=>R,Io:()=>E,JI:()=>c,PR:()=>a,Ps:()=>P,Q$:()=>p,Rh:()=>b,S8:()=>M,U0:()=>x,VZ:()=>y,Vz:()=>D,XM:()=>v,Yn:()=>g,aP:()=>I,bG:()=>i,bY:()=>C,i0:()=>O,sL:()=>L,u4:()=>o,vk:()=>m,xL:()=>f,xc:()=>T,yj:()=>S,zq:()=>d});var n=e(89550),s=e(65463);const l=(0,n.R)("ds-request-response"),r=(0,n.R)("ds-request-error"),i=(0,n.R)("template-variable-value-updated"),g=(0,n.R)("graph-click"),o=(0,n.R)("threshold-changed");class d extends s.a{static{this.type="panel-queries-changed"}}class c extends s.a{static{this.type="panel-transformations-changed"}}class a extends s.a{static{this.type="panels-options-changed"}}class p extends s.a{static{this.type="dashboard-panels-changed"}}class u extends s.a{static{this.type="dashboard-meta-changed"}}class m extends s.a{static{this.type="panel-directive-ready"}}class v extends s.a{static{this.type="render"}}class x extends s.x{static{this.type="zoom-out"}}var f=(j=>(j[j.Left=-1]="Left",j[j.Right=1]="Right",j))(f||{});class E extends s.x{static{this.type="shift-time"}}class h extends s.a{static{this.type="copy-time"}}class y extends s.x{static{this.type="paste-time"}}class b extends s.x{static{this.type="absolute-time"}}class D extends s.x{static{this.type="remove-panel"}}class P extends s.x{static{this.type="show-modal"}}class C extends s.x{static{this.type="show-confirm-modal"}}class M extends s.x{static{this.type="show-react-modal"}}class I extends s.a{static{this.type="hide-modal"}}class R extends s.a{static{this.type="dashboard-saved"}}class T extends s.x{static{this.type="annotation-query-started"}}class S extends s.x{static{this.type="annotation-query-finished"}}class L extends s.x{static{this.type="panel-edit-started"}}class O extends s.x{static{this.type="panel-edit-finished"}}},76698:(k,A,e)=>{"use strict";e.d(A,{IW:()=>n,aA:()=>l,jH:()=>r,sG:()=>s});var n=(i=>(i[i.CLOSE_PANE=0]="CLOSE_PANE",i[i.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",i[i.CLOSE_EDITOR=2]="CLOSE_EDITOR",i))(n||{});const s=["lines","bars","points","stacked_lines","stacked_bars"];var l=(i=>(i.table="table",i.raw="raw",i))(l||{});const r=["table","raw"]},8904:()=>{"use strict"},31678:(k,A,e)=>{"use strict";e.d(A,{AccessControlAction:()=>D,AppNotificationSeverity:()=>m,CORRELATION_EDITOR_POST_CONFIRM_ACTION:()=>f.IW,CoreEvents:()=>P,DashboardInitPhase:()=>i._g,DashboardRoutes:()=>i.Z4,EXPLORE_GRAPH_STYLES:()=>f.sG,KioskMode:()=>i.d9,OrgRole:()=>g.XT,PermissionLevelString:()=>g.RG,SearchQueryType:()=>g.Vz,ServiceAccountStateFilter:()=>c,TABLE_RESULTS_STYLE:()=>f.aA,TeamPermissionLevel:()=>g.Xe,addListener:()=>E.ch,createAsyncThunk:()=>E.zD,timeoutMap:()=>x,useDispatch:()=>E.wA,useSelector:()=>E.d4});var n=e(17523),s=e(50271),l=e(54034),r=e(8904),i=e(95425),g=e(24897),o=e(18625),d=e(64998),c=(C=>(C.All="All",C.WithExpiredTokens="WithExpiredTokens",C.External="External",C.Disabled="Disabled",C))(c||{}),a=e(62543),p=e(77237),u=e(75330),m=(C=>(C.Success="success",C.Warning="warning",C.Error="error",C.Info="info",C))(m||{}),v=(C=>(C[C.Success=3e3]="Success",C[C.Warning=5e3]="Warning",C[C.Error=7e3]="Error",C))(v||{});const x={success:3e3,warning:5e3,error:7e3,info:3e3};var f=e(76698),E=e(64756),h=e(13868),y=e(14276),b=e(90697),D=(C=>(C.UsersRead="users:read",C.UsersWrite="users:write",C.UsersAuthTokenList="users.authtoken:read",C.UsersAuthTokenUpdate="users.authtoken:write",C.UsersPasswordUpdate="users.password:write",C.UsersDelete="users:delete",C.UsersCreate="users:create",C.UsersEnable="users:enable",C.UsersDisable="users:disable",C.UsersPermissionsUpdate="users.permissions:write",C.UsersLogout="users:logout",C.UsersQuotasList="users.quotas:read",C.UsersQuotasUpdate="users.quotas:write",C.ServiceAccountsRead="serviceaccounts:read",C.ServiceAccountsCreate="serviceaccounts:create",C.ServiceAccountsWrite="serviceaccounts:write",C.ServiceAccountsDelete="serviceaccounts:delete",C.ServiceAccountsPermissionsRead="serviceaccounts.permissions:read",C.ServiceAccountsPermissionsWrite="serviceaccounts.permissions:write",C.OrgsRead="orgs:read",C.OrgsPreferencesRead="orgs.preferences:read",C.OrgsWrite="orgs:write",C.OrgsPreferencesWrite="orgs.preferences:write",C.OrgsCreate="orgs:create",C.OrgsDelete="orgs:delete",C.OrgUsersRead="org.users:read",C.OrgUsersAdd="org.users:add",C.OrgUsersRemove="org.users:remove",C.OrgUsersWrite="org.users:write",C.LDAPUsersRead="ldap.user:read",C.LDAPUsersSync="ldap.user:sync",C.LDAPStatusRead="ldap.status:read",C.DataSourcesExplore="datasources:explore",C.DataSourcesRead="datasources:read",C.DataSourcesCreate="datasources:create",C.DataSourcesWrite="datasources:write",C.DataSourcesDelete="datasources:delete",C.DataSourcesPermissionsRead="datasources.permissions:read",C.DataSourcesCachingRead="datasources.caching:read",C.DataSourcesInsightsRead="datasources.insights:read",C.ActionServerStatsRead="server.stats:read",C.ActionTeamsCreate="teams:create",C.ActionTeamsDelete="teams:delete",C.ActionTeamsRead="teams:read",C.ActionTeamsWrite="teams:write",C.ActionTeamsPermissionsRead="teams.permissions:read",C.ActionTeamsPermissionsWrite="teams.permissions:write",C.ActionRolesList="roles:read",C.ActionTeamsRolesList="teams.roles:read",C.ActionTeamsRolesAdd="teams.roles:add",C.ActionTeamsRolesRemove="teams.roles:remove",C.ActionUserRolesList="users.roles:read",C.ActionUserRolesAdd="users.roles:add",C.ActionUserRolesRemove="users.roles:remove",C.DashboardsRead="dashboards:read",C.DashboardsWrite="dashboards:write",C.DashboardsDelete="dashboards:delete",C.DashboardsCreate="dashboards:create",C.DashboardsPermissionsRead="dashboards.permissions:read",C.DashboardsPermissionsWrite="dashboards.permissions:write",C.DashboardsPublicWrite="dashboards.public:write",C.FoldersRead="folders:read",C.FoldersWrite="folders:write",C.FoldersDelete="folders:delete",C.FoldersCreate="folders:create",C.FoldersPermissionsRead="folders.permissions:read",C.FoldersPermissionsWrite="folders.permissions:write",C.ActionSupportBundlesCreate="support.bundles:create",C.ActionSupportBundlesRead="support.bundles:read",C.ActionSupportBundlesDelete="support.bundles:delete",C.AlertingRuleCreate="alert.rules:create",C.AlertingRuleRead="alert.rules:read",C.AlertingRuleUpdate="alert.rules:write",C.AlertingRuleDelete="alert.rules:delete",C.AlertingInstanceCreate="alert.instances:create",C.AlertingInstanceUpdate="alert.instances:write",C.AlertingInstanceRead="alert.instances:read",C.AlertingSilenceCreate="alert.silences:create",C.AlertingSilenceUpdate="alert.silences:write",C.AlertingSilenceRead="alert.silences:read",C.AlertingNotificationsRead="alert.notifications:read",C.AlertingNotificationsWrite="alert.notifications:write",C.AlertingRuleExternalWrite="alert.rules.external:write",C.AlertingRuleExternalRead="alert.rules.external:read",C.AlertingInstancesExternalWrite="alert.instances.external:write",C.AlertingInstancesExternalRead="alert.instances.external:read",C.AlertingNotificationsExternalWrite="alert.notifications.external:write",C.AlertingNotificationsExternalRead="alert.notifications.external:read",C.AlertingProvisioningReadSecrets="alert.provisioning.secrets:read",C.AlertingProvisioningRead="alert.provisioning:read",C.AlertingProvisioningWrite="alert.provisioning:write",C.ActionAPIKeysRead="apikeys:read",C.ActionAPIKeysCreate="apikeys:create",C.ActionAPIKeysDelete="apikeys:delete",C.PluginsInstall="plugins:install",C.PluginsWrite="plugins:write",C.SettingsRead="settings:read",C.SettingsWrite="settings:write",C))(D||{}),P=e(28444)},13868:()=>{"use strict"},54034:()=>{"use strict"},75330:()=>{"use strict"},77237:()=>{"use strict"},90697:()=>{"use strict"},64756:(k,A,e)=>{"use strict";e.d(A,{ch:()=>g,d4:()=>r,wA:()=>l,zD:()=>i});var n=e(65307),s=e(71468);const l=s.useDispatch,r=s.useSelector,i=(o,d,c)=>(0,n.zD)(o,d,c),g=n.ch},38824:(k,A,e)=>{"use strict";e.d(A,{m:()=>n});var n=(s=>(s.LineChart="Line chart",s.LineChartSmooth="Line chart smooth",s.LineChartGradientColorScheme="Line chart with gradient color scheme",s.AreaChart="Area chart",s.AreaChartStacked="Area chart stacked",s.AreaChartStackedPercent="Area chart 100% stacked",s.BarChart="Bar chart",s.BarChartGradientColorScheme="Bar chart with gradient color scheme",s.BarChartStacked="Bar chart stacked",s.BarChartStackedPercent="Bar chart 100% stacked",s.BarChartHorizontal="Bar chart horizontal",s.BarChartHorizontalStacked="Bar chart horizontal stacked",s.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",s.Candlestick="Candlestick",s.PieChart="Pie chart",s.PieChartDonut="Pie chart donut",s.Stat="Stat",s.StatColoredBackground="Stat colored background",s.Gauge="Gauge",s.GaugeNoThresholds="Gauge no thresholds",s.BarGaugeBasic="Bar gauge basic",s.BarGaugeLCD="Bar gauge LCD",s.Table="Table",s.StateTimeline="State timeline",s.StatusHistory="Status history",s.TextPanel="Text",s.DashboardList="Dashboard list",s.Logs="Logs",s.FlameGraph="Flame graph",s.Trace="Trace",s.NodeGraph="Node graph",s))(n||{})},17523:()=>{"use strict"},94822:(k,A,e)=>{"use strict";e.d(A,{$k:()=>g,Gi:()=>s,JS:()=>d,N1:()=>c,Q8:()=>a,Si:()=>l,cF:()=>n,lh:()=>o,qr:()=>i,s1:()=>r});var n=(p=>(p.Firing="firing",p.Inactive="inactive",p.Pending="pending",p))(n||{}),s=(p=>(p.Normal="Normal",p.Alerting="Alerting",p.Pending="Pending",p.NoData="NoData",p.Error="Error",p))(s||{});function l(p){return Object.values(n).includes(p)}function r(p){return Object.values(s).some(u=>u===p)}function i(p){const u=Object.values(n);return p!=null&&!u.includes(p)}function g(p){const u=p.match(/\((.*?)\)/);return u?u[1]:""}function o(p){return i(p)?p.split(" ")[0]:p}var d=(p=>(p.Alerting="alerting",p.Recording="recording",p))(d||{}),c=(p=>(p.Cortex="Cortex",p.Mimir="Mimir",p.Prometheus="Prometheus",p.Thanos="Thanos",p))(c||{}),a=(p=>(p.Alerting="Alerting",p.NoData="NoData",p.KeepLast="KeepLast",p.OK="OK",p.Error="Error",p))(a||{})},54317:(k,A,e)=>{"use strict";e.d(A,{$:()=>r,S:()=>s});var n=e(94822);function s(i,g){return(0,n.lh)(i.state)===g}var l=(i=>(i.Firing="firing",i))(l||{}),r=(i=>(i.Alerting="alerting",i.Pending="pending",i.Normal="inactive",i.NoData="nodata",i.Error="error",i))(r||{})},64998:()=>{"use strict"},72834:k=>{const A="    ";function e(r){let i="";return r&&Object.keys(r).forEach(function(g){i+=g+":"+r[g]+";"}),i}function n(r){function i(o){return'class="'+o+'"'}function g(o){return'style="'+e(r["."+o])+'"'}return r?g:i}function s(r){return r===null?"null":Array.isArray(r)?"array":typeof r=="string"&&/^https?:/.test(r)?"link":typeof r=="object"&&typeof r.toISOString=="function"?"date":typeof r}function l(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}k.exports=function(r,i){let g="";const o=n(i);let d=function(a,p,u,m){if(!a.length)return p+" "+u;let v=p+`
`;return g+=A,a.forEach(function(x,f){v+=g+m(x)+(f<a.length-1?",":"")+`
`}),g=g.slice(0,-A.length),v+g+u};function c(a){if(a===void 0)return"";switch(s(a)){case"boolean":return"<span "+o("json-markup-bool")+">"+a+"</span>";case"number":return"<span "+o("json-markup-number")+">"+a+"</span>";case"date":return'<span class="json-markup-string">"'+l(a.toISOString())+'"</span>';case"null":return"<span "+o("json-markup-null")+">null</span>";case"string":return"<span "+o("json-markup-string")+'>"'+l(a.replace(/\n/g,`
`+g))+'"</span>';case"link":return"<span "+o("json-markup-string")+'>"<a href="'+encodeURI(a)+'">'+l(a)+'</a>"</span>';case"array":return d(a,"[","]",c);case"object":const p=Object.keys(a).filter(function(u){return a[u]!==void 0});return d(p,"{","}",function(u){return"<span "+o("json-markup-key")+'>"'+l(u)+'":</span> '+c(a[u])})}return""}return"<div "+o("json-markup")+">"+c(r)+"</div>"}},13609:()=>{(function(k){"use strict";k(function(){k.support.transition=function(){var A=function(){var e=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},s;for(s in n)if(e.style[s]!==void 0)return n[s]}();return A&&{end:A}}()})})(window.jQuery),function(k){"use strict";var A="[data-toggle=dropdown]",e=function(r){var i=k(r).on("click.dropdown.data-api",this.toggle);k("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(r){var i=k(this),g,o;if(!i.is(".disabled, :disabled"))return g=s(i),o=g.hasClass("open"),n(),o||("ontouchstart"in document.documentElement&&k('<div class="dropdown-backdrop"/>').insertBefore(k(this)).on("click",n),g.toggleClass("open")),i.focus(),!1},keydown:function(r){var i,g,o,d,c,a;if(/(38|40|27)/.test(r.keyCode)&&(i=k(this),r.preventDefault(),r.stopPropagation(),!i.is(".disabled, :disabled"))){if(d=s(i),c=d.hasClass("open"),!c||c&&r.keyCode==27)return r.which==27&&d.find(A).focus(),i.click();g=k("[role=menu] li:not(.divider):visible a",d),g.length&&(a=g.index(g.filter(":focus")),r.keyCode==38&&a>0&&a--,r.keyCode==40&&a<g.length-1&&a++,~a||(a=0),g.eq(a).focus())}}};function n(){k(".dropdown-backdrop").remove(),k(A).each(function(){s(k(this)).removeClass("open")})}function s(r){var i=r.attr("data-target"),g;return i||(i=r.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),g=i&&k.find(i),(!g||!g.length)&&(g=r.parent()),g}var l=k.fn.dropdown;k.fn.dropdown=function(r){return this.each(function(){var i=k(this),g=i.data("dropdown");g||i.data("dropdown",g=new e(this)),typeof r=="string"&&g[r].call(i)})},k.fn.dropdown.Constructor=e,k.fn.dropdown.noConflict=function(){return k.fn.dropdown=l,this},k(document).on("click.dropdown.data-api",n).on("click.dropdown.data-api",".dropdown form",function(r){r.stopPropagation()}).on("click.dropdown.data-api",A,e.prototype.toggle).on("keydown.dropdown.data-api",A+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(k){"use strict";var A=function(n,s){this.options=s,this.$element=k(n).delegate('[data-dismiss="modal"]',"click.dismiss.modal",k.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};A.prototype={constructor:A,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var n=this,s=k.Event("show");this.$element.trigger(s),!(this.isShown||s.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var l=k.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),l&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus(),l?n.$element.one(k.support.transition.end,function(){n.$element.focus().trigger("shown")}):n.$element.focus().trigger("shown")}))},hide:function(n){n&&n.preventDefault();var s=this;n=k.Event("hide"),this.$element.trigger(n),!(!this.isShown||n.isDefaultPrevented())&&(this.isShown=!1,this.escape(),k(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),k.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var n=this;k(document).on("focusin.modal",function(s){n.$element[0]!==s.target&&!n.$element.has(s.target).length&&n.$element.focus()})},escape:function(){var n=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(s){s.which==27&&n.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var n=this,s=setTimeout(function(){n.$element.off(k.support.transition.end),n.hideModal()},500);this.$element.one(k.support.transition.end,function(){clearTimeout(s),n.hideModal()})},hideModal:function(){var n=this;this.$element.hide(),this.backdrop(function(){n.removeBackdrop(),n.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(n){var s=this,l=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=k.support.transition&&l;if(this.$backdrop=k('<div class="modal-backdrop '+l+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?k.proxy(this.$element[0].focus,this.$element[0]):k.proxy(this.hide,this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!n)return;r?this.$backdrop.one(k.support.transition.end,n):n()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),k.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(k.support.transition.end,n):n()):n&&n()}};var e=k.fn.modal;k.fn.modal=function(n){return this.each(function(){var s=k(this),l=s.data("modal"),r=k.extend({},k.fn.modal.defaults,s.data(),typeof n=="object"&&n);l||s.data("modal",l=new A(this,r)),typeof n=="string"?l[n]():r.show&&l.show()})},k.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},k.fn.modal.Constructor=A,k.fn.modal.noConflict=function(){return k.fn.modal=e,this},k(document).on("click.modal.data-api",'[data-toggle="modal"]',function(n){var s=k(this),l=s.attr("href"),r=k.find(s.attr("data-target")||l&&l.replace(/.*(?=#[^\s]+$)/,"")),i=r.data("modal")?"toggle":k.extend({remote:!/#/.test(l)&&l},r.data(),s.data());n.preventDefault(),r.modal(i).one("hide",function(){s.focus()})})}(window.jQuery),function(k){"use strict";var A=function(n,s){this.init("tooltip",n,s)};A.prototype={constructor:A,init:function(n,s,l){var r,i,g,o,d;for(this.type=n,this.$element=k(s),this.options=this.getOptions(l),this.enabled=!0,g=this.options.trigger.split(" "),d=g.length;d--;)o=g[d],o=="click"?this.$element.on("click."+this.type,this.options.selector,k.proxy(this.toggle,this)):o!="manual"&&(r=o=="hover"?"mouseenter":"focus",i=o=="hover"?"mouseleave":"blur",this.$element.on(r+"."+this.type,this.options.selector,k.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,k.proxy(this.leave,this)));this.options.selector?this._options=k.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(n){return n=k.extend({},k.fn[this.type].defaults,this.$element.data(),n),n.delay&&typeof n.delay=="number"&&(n.delay={show:n.delay,hide:n.delay}),n},enter:function(n){var s=k.fn[this.type].defaults,l={},r;if(this._options&&k.each(this._options,function(i,g){s[i]!=g&&(l[i]=g)},this),r=k(n.currentTarget)[this.type](l).data(this.type),!r.options.delay||!r.options.delay.show)return r.show();clearTimeout(this.timeout),r.hoverState="in",this.timeout=setTimeout(function(){r.hoverState=="in"&&r.show()},r.options.delay.show)},leave:function(n){var s=k(n.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!s.options.delay||!s.options.delay.hide)return s.hide();s.hoverState="out",this.timeout=setTimeout(function(){s.hoverState=="out"&&s.hide()},s.options.delay.hide)},show:function(){var n,s,l,r,i,g,o=k.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(o),o.isDefaultPrevented())return;switch(n=this.tip(),this.setContent(),this.options.animation&&n.addClass("fade"),i=typeof this.options.placement=="function"?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,n.detach().css({top:0,left:0,display:"block"}),this.options.container?n.appendTo(k.find(this.options.container)):n.insertAfter(this.$element),s=this.getPosition(),l=n[0].offsetWidth,r=n[0].offsetHeight,i){case"bottom":g={top:s.top+s.height,left:s.left+s.width/2-l/2};break;case"top":g={top:s.top-r,left:s.left+s.width/2-l/2};break;case"left":g={top:s.top+s.height/2-r/2,left:s.left-l};break;case"right":g={top:s.top+s.height/2-r/2,left:s.left+s.width};break;case"topLeft":g={top:s.top-r,left:s.left+s.width/2-l*.1};break;case"topRight":g={top:s.top-r,left:s.left+s.width/2-l*.9};break;case"rightTop":g={top:s.top+s.height/2-r*.1,left:s.left+s.width};break;case"rightBottom":g={top:s.top+s.height/2-r*.9,left:s.left+s.width};break;case"bottomLeft":g={top:s.top+s.height,left:s.left+s.width/2-l*.1};break;case"bottomRight":g={top:s.top+s.height,left:s.left+s.width/2-l*.9};break;case"leftTop":g={top:s.top+s.height/2-r*.1,left:s.left-l};break;case"leftBottom":g={top:s.top+s.height/2-r*.9,left:s.left-l};break}this.applyPlacement(g,i),this.$element.trigger("shown")}},applyPlacement:function(n,s){var l=this.tip(),r=l[0].offsetWidth,i=l[0].offsetHeight,g,o,d,c;l.offset(n).addClass(s).addClass("in"),g=l[0].offsetWidth,o=l[0].offsetHeight,s=="top"&&o!=i&&(n.top=n.top+i-o,c=!0),s=="bottom"||s=="top"?(d=0,n.left<0&&(d=n.left*-2,n.left=0,l.offset(n),g=l[0].offsetWidth,o=l[0].offsetHeight),this.replaceArrow(d-r+g,g,"left")):this.replaceArrow(o-i,o,"top"),c&&l.offset(n)},replaceArrow:function(n,s,l){this.arrow().css(l,n?50*(1-n/s)+"%":"")},setContent:function(){var n=this.tip(),s=this.getTitle();n.find(".tooltip-inner").text(s),n.removeClass("fade in top bottom left right")},hide:function(){var n=this,s=this.tip(),l=k.Event("hide");if(this.$element.trigger(l),l.isDefaultPrevented())return;s.removeClass("in");function r(){var i=setTimeout(function(){s.off(k.support.transition.end).detach()},500);s.one(k.support.transition.end,function(){clearTimeout(i),s.detach()})}return k.support.transition&&this.$tip.hasClass("fade")?r():s.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var n=this.$element[0];return k.extend({},typeof n.getBoundingClientRect=="function"?n.getBoundingClientRect():{width:n.offsetWidth,height:n.offsetHeight},this.$element.offset())},getTitle:function(){var n,s=this.$element,l=this.options;return n=s.attr("data-original-title")||(typeof l.title=="function"?l.title.call(s[0]):l.title),n},tip:function(){return this.$tip=this.$tip||k(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(n){var s=n?k(n.currentTarget)[this.type](this._options).data(this.type):this;s.tip().hasClass("in")?s.hide():s.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=k.fn.tooltip;k.fn.tooltip=function(n){return this.each(function(){var s=k(this),l=s.data("tooltip"),r=typeof n=="object"&&n;l||s.data("tooltip",l=new A(this,r)),typeof n=="string"&&l[n]()})},k.fn.tooltip.Constructor=A,k.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},k.fn.tooltip.noConflict=function(){return k.fn.tooltip=e,this}}(window.jQuery),function(k){"use strict";var A=function(n){this.element=k(n)};A.prototype={constructor:A,show:function(){var n=this.element,s=n.closest("ul:not(.dropdown-menu)"),l=n.attr("data-target"),r,i,g;l||(l=n.attr("href"),l=l&&l.replace(/.*(?=#[^\s]*$)/,"")),!n.parent("li").hasClass("active")&&(r=s.find(".active:last a")[0],g=k.Event("show",{relatedTarget:r}),n.trigger(g),!g.isDefaultPrevented()&&(i=k.find(l),this.activate(n.parent("li"),s),this.activate(i,i.parent(),function(){n.trigger({type:"shown",relatedTarget:r})})))},activate:function(n,s,l){var r=s.find("> .active"),i=l&&k.support.transition&&r.hasClass("fade");function g(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),n.addClass("active"),i?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active"),l&&l()}i?r.one(k.support.transition.end,g):g(),r.removeClass("in")}};var e=k.fn.tab;k.fn.tab=function(n){return this.each(function(){var s=k(this),l=s.data("tab");l||s.data("tab",l=new A(this)),typeof n=="string"&&l[n]()})},k.fn.tab.Constructor=A,k.fn.tab.noConflict=function(){return k.fn.tab=e,this},k(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(n){n.preventDefault(),k(this).tab("show")})}(window.jQuery),function(k){"use strict";var A=function(n,s){this.$element=k(n),this.options=k.extend({},k.fn.typeahead.defaults,s),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=k(this.options.menu),this.shown=!1,this.listen()};A.prototype={constructor:A,select:function(){var n=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(n)).change(),this.hide()},updater:function(n){return n},show:function(){var n=k.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:n.top+n.height,left:n.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(n){var s;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(s=k.isFunction(this.source)?this.source(this.query,k.proxy(this.process,this)):this.source,s?this.process(s):this)},process:function(n){var s=this;return n=k.grep(n,function(l){return s.matcher(l)}),n=this.sorter(n),n.length?this.render(n.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(n){return~n.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(n){for(var s=[],l=[],r=[],i;i=n.shift();)i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?l.push(i):r.push(i):s.push(i);return s.concat(l,r)},highlighter:function(n){var s=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return s?n.replace(new RegExp("("+s+")","ig"),function(l,r){return"<strong>"+r+"</strong>"}):n},render:function(n){var s=this;return n=k(n).map(function(l,r){return l=k(s.options.item).attr("data-value",r),l.find("a").html(s.highlighter(r)),l[0]}),this.$menu.html(n),this},next:function(n){var s=this.$menu.find(".active").removeClass("active"),l=s.next();l.length||(l=k(this.$menu.find("li")[0])),l.addClass("active")},prev:function(n){var s=this.$menu.find(".active").removeClass("active"),l=s.prev();l.length||(l=this.$menu.find("li").last()),l.addClass("active")},listen:function(){this.$element.on("focus",k.proxy(this.focus,this)).on("blur",k.proxy(this.blur,this)).on("keypress",k.proxy(this.keypress,this)).on("keyup",k.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",k.proxy(this.keydown,this)),this.$menu.on("click",k.proxy(this.click,this)).on("mouseenter","li",k.proxy(this.mouseenter,this)).on("mouseleave","li",k.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(n){var s=n in this.$element;return s||(this.$element.setAttribute(n,"return;"),s=typeof this.$element[n]=="function"),s},move:function(n){if(this.shown&&!(n.shiftKey&&n.keyCode===40)){switch(n.keyCode){case 9:case 13:case 27:n.preventDefault();break;case 38:n.preventDefault(),this.prev();break;case 40:n.preventDefault(),this.next();break}n.stopPropagation()}},keydown:function(n){this.suppressKeyPressRepeat=~k.inArray(n.keyCode,[40,38,9,13,27,57]),this.move(n)},keypress:function(n){this.suppressKeyPressRepeat||this.move(n)},keyup:function(n){switch(n.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}n.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(n.stopPropagation(),n.preventDefault())},focus:function(n){this.focused=!0},blur:function(n){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(n){n.stopPropagation(),n.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(n){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),k(n.currentTarget).addClass("active")},mouseleave:function(n){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=k.fn.typeahead;k.fn.typeahead=function(n){return this.each(function(){var s=k(this),l=s.data("typeahead"),r=typeof n=="object"&&n;l||s.data("typeahead",l=new A(this,r)),typeof n=="string"&&l[n]()})},k.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},k.fn.typeahead.Constructor=A,k.fn.typeahead.noConflict=function(){return k.fn.typeahead=e,this},k(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(n){var s=k(this);s.data("typeahead")||s.typeahead(s.data())})}(window.jQuery),function(k){"use strict";var A=function(n,s){this.options=k.extend({},k.fn.affix.defaults,s),this.$window=k(window).on("scroll.affix.data-api",k.proxy(this.checkPosition,this)).on("click.affix.data-api",k.proxy(function(){setTimeout(k.proxy(this.checkPosition,this),1)},this)),this.$element=k(n),this.checkPosition()};A.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=k(document).height(),s=this.$window.scrollTop(),l=this.$element.offset(),r=this.options.offset,i=r.bottom,g=r.top,o="affix affix-top affix-bottom",d;typeof r!="object"&&(i=g=r),typeof g=="function"&&(g=r.top()),typeof i=="function"&&(i=r.bottom()),d=this.unpin!=null&&s+this.unpin<=l.top?!1:i!=null&&l.top+this.$element.height()>=n-i?"bottom":g!=null&&s<=g?"top":!1,this.affixed!==d&&(this.affixed=d,this.unpin=d=="bottom"?l.top-s:null,this.$element.removeClass(o).addClass("affix"+(d?"-"+d:"")))}};var e=k.fn.affix;k.fn.affix=function(n){return this.each(function(){var s=k(this),l=s.data("affix"),r=typeof n=="object"&&n;l||s.data("affix",l=new A(this,r)),typeof n=="string"&&l[n]()})},k.fn.affix.Constructor=A,k.fn.affix.defaults={offset:0},k.fn.affix.noConflict=function(){return k.fn.affix=e,this},k(window).on("load",function(){k('[data-spy="affix"]').each(function(){var n=k(this),s=n.data();s.offset=s.offset||{},s.offsetBottom&&(s.offset.bottom=s.offsetBottom),s.offsetTop&&(s.offset.top=s.offsetTop),n.affix(s)})})}(window.jQuery)},82013:()=>{(function(k){var A={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(n){var s={x:-1,y:-1,locked:!1};n.setCrosshair=function(g){if(!g)s.x=-1;else{var o=n.p2c(g);s.x=Math.max(0,Math.min(o.left,n.width())),s.y=Math.max(0,Math.min(o.top,n.height()))}n.triggerRedrawOverlay()},n.clearCrosshair=n.setCrosshair,n.lockCrosshair=function(g){g&&n.setCrosshair(g),s.locked=!0},n.unlockCrosshair=function(){s.locked=!1};function l(i){s.locked||s.x!=-1&&(s.x=-1,n.triggerRedrawOverlay())}function r(i){if(!s.locked){if(n.getSelection&&n.getSelection()){s.x=-1;return}var g=n.offset();s.x=Math.max(0,Math.min(i.pageX-g.left,n.width())),s.y=Math.max(0,Math.min(i.pageY-g.top,n.height())),n.triggerRedrawOverlay()}}n.hooks.bindEvents.push(function(i,g){i.getOptions().crosshair.mode&&(g.mouseout(l),g.mousemove(r))}),n.hooks.drawOverlay.push(function(i,g){var o=i.getOptions().crosshair;if(o.mode){var d=i.getPlotOffset();if(g.save(),g.translate(d.left,d.top),s.x!=-1){var c=i.getOptions().crosshair.lineWidth%2?.5:0;if(g.strokeStyle=o.color,g.lineWidth=o.lineWidth,g.lineJoin="round",g.beginPath(),o.mode.indexOf("x")!=-1){var a=Math.floor(s.x)+c;g.moveTo(a,0),g.lineTo(a,i.height())}if(o.mode.indexOf("y")!=-1){var p=Math.floor(s.y)+c;g.moveTo(0,p),g.lineTo(i.width(),p)}g.stroke()}g.restore()}}),n.hooks.shutdown.push(function(i,g){g.unbind("mouseout",l),g.unbind("mousemove",r)})}k.plot.plugins.push({init:e,options:A,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(k){function A(e){e.hooks.processDatapoints.push(function(n,s,l){s.dashes.show&&n.hooks.draw.push(function(r,i){var g=r.getPlotOffset(),o=s.xaxis,d=s.yaxis;function c(m,v){var x=l.points,f=l.pointsize,E=null,h=null,y=0,b=!0,D,P;s.dashes.dashLength[0]?(D=s.dashes.dashLength[0],s.dashes.dashLength[1]?P=s.dashes.dashLength[1]:P=D):P=D=s.dashes.dashLength,i.beginPath();for(var C=f;C<x.length;C+=f){let U=function(w){var B=Math.sqrt(Math.pow(O-S,2)+Math.pow(j-L,2));if(B<=w)return{deltaX:O-S,deltaY:j-L,distance:B,remainder:w-B};var K=O>S?1:-1,W=j>L?1:-1;return{deltaX:K*Math.sqrt(Math.pow(w,2)/(1+Math.pow((j-L)/(O-S),2))),deltaY:W*Math.sqrt(Math.pow(w,2)-Math.pow(w,2)/(1+Math.pow((j-L)/(O-S),2))),distance:w,remainder:0}};var F=U,M=x[C-f],I=x[C-f+1],R=x[C],T=x[C+1];if(!(M==null||R==null)){if(I<=T&&I<d.min){if(T<d.min)continue;M=(d.min-I)/(T-I)*(R-M)+M,I=d.min}else if(T<=I&&T<d.min){if(I<d.min)continue;R=(d.min-I)/(T-I)*(R-M)+M,T=d.min}if(I>=T&&I>d.max){if(T>d.max)continue;M=(d.max-I)/(T-I)*(R-M)+M,I=d.max}else if(T>=I&&T>d.max){if(I>d.max)continue;R=(d.max-I)/(T-I)*(R-M)+M,T=d.max}if(M<=R&&M<o.min){if(R<o.min)continue;I=(o.min-M)/(R-M)*(T-I)+I,M=o.min}else if(R<=M&&R<o.min){if(M<o.min)continue;T=(o.min-M)/(R-M)*(T-I)+I,R=o.min}if(M>=R&&M>o.max){if(R>o.max)continue;I=(o.max-M)/(R-M)*(T-I)+I,M=o.max}else if(R>=M&&R>o.max){if(M>o.max)continue;T=(o.max-M)/(R-M)*(T-I)+I,R=o.max}(M!=E||I!=h)&&i.moveTo(o.p2c(M)+m,d.p2c(I)+v);var S=o.p2c(M)+m,L=d.p2c(I)+v,O=o.p2c(R)+m,j=d.p2c(T)+v,N;do N=U(y>0?y:b?D:P),(N.deltaX!=0||N.deltaY!=0)&&(b?i.lineTo(S+N.deltaX,L+N.deltaY):i.moveTo(S+N.deltaX,L+N.deltaY)),b=!b,y=N.remainder,S+=N.deltaX,L+=N.deltaY;while(N.distance>0);E=R,h=T}}i.stroke()}i.save(),i.translate(g.left,g.top),i.lineJoin="round";var a=s.dashes.lineWidth,p=s.shadowSize;if(a>0&&p>0){i.lineWidth=p,i.strokeStyle="rgba(0,0,0,0.1)";var u=Math.PI/18;c(Math.sin(u)*(a/2+p/2),Math.cos(u)*(a/2+p/2)),i.lineWidth=p/2,c(Math.sin(u)*(a/2+p/4),Math.cos(u)*(a/2+p/4))}i.lineWidth=a,i.strokeStyle=s.color,a>0&&c(0,0),i.restore()})})}k.plot.plugins.push({init:A,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(k){"use strict";var A={series:{fillBelowTo:null}};function e(n){function s(i,g){var o;for(o=0;o<g.length;++o)if(g[o].id===i.fillBelowTo)return g[o];return null}function l(i,g,o,d,c,a,p,u){var m,v,x,f,E,h;return m=o-i,v=d-g,x=p-c,f=u-a,E=(-v*(i-c)+m*(g-a))/(-x*v+m*f),h=(x*(g-a)-f*(i-c))/(-x*v+m*f),E>=0&&E<=1&&h>=0&&h<=1?[i+h*m,g+h*v]:null}function r(i,g,o){if(o.fillBelowTo===null)return;var d,c,a,p,u,m,v;function x(P,C){g.beginPath(),g.moveTo(o.xaxis.p2c(P)+m.left,o.yaxis.p2c(C)+m.top)}function f(){g.closePath(),g.fill()}function E(){if(a.length/c!==u.length/p)return console.error("Refusing to graph inconsistent number of points"),!1;var P;for(P=0;P<a.length/c;P++)if(a[P*c]!==null&&u[P*p]!==null&&a[P*c]!==u[P*p])return console.error("Refusing to graph points without matching value"),!1;return!0}function h(P,C){console.assert(C>P,"expects the end index to be greater than the start index");var M=P===0||a[P-1]===null||u[P-1]===null,I=!1,R,T;for(R=P;R<C;R++)if(a[R*c+1]===null||u[R*c+1]===null)I=!1,M=!0;else if(a[R*c+1]===u[R*p+1])I=!0,M=!1;else if(a[R*c+1]>u[R*p+1]){M?x(a[R*c],a[R*c+1]):I?x(a[(R-1)*c],a[(R-1)*c+1]):(T=y(R),x(T[0],T[1])),D(R,C);return}else M=!1,I=!1}function y(P){console.assert(P>0,"expects the second point in the series line segment");var C,M;for(C=1;C<u.length/p;C++)if(M=l(a[(P-1)*c],a[(P-1)*c+1],a[P*c],a[P*c+1],u[(C-1)*p],u[(C-1)*p+1],u[C*p],u[C*p+1]),M!==null)return M;console.error("intersectionPoint() should only be called when an intersection happens")}function b(P,C){console.assert(P>=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M;for(M=P;M>=C;M--)g.lineTo(d.xaxis.p2c(u[M*p])+m.left,d.yaxis.p2c(u[M*p+1])+m.top);f()}function D(P,C){console.assert(P<=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M,I;for(M=P;M<C;M++)if(a[M*c+1]===null&&M>P){b(M-1,P),h(M,C);return}else if(a[M*c+1]===u[M*p+1]){b(M,P),h(M,C);return}else if(a[M*c+1]<u[M*p+1]){I=y(M),g.lineTo(o.xaxis.p2c(I[0])+m.left,o.yaxis.p2c(I[1])+m.top),b(M,P),h(M,C);return}else g.lineTo(o.xaxis.p2c(a[M*c])+m.left,o.yaxis.p2c(a[M*c+1])+m.top);b(C,P)}d=s(o,i.getData()),d&&(c=o.datapoints.pointsize,a=o.datapoints.points,p=d.datapoints.pointsize,u=d.datapoints.points,m=i.getPlotOffset(),E()&&(v=k.color.parse(o.color),v.a=.4,v.normalize(),g.fillStyle=v.toString(),h(0,a.length/c)))}n.hooks.drawSeries.push(r)}k.plot.plugins.push({init:e,options:A,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(k){var A=function(){var o,d,c,a,p,u,m=function(P,C){o=C,d=P.getPlaceholder(),c=P.getOptions(),a=c.series.gauges,p=P.getData(),u=e(a.debug)};m.prototype.calculateLayout=function(){var P=d.width(),C=d.height(),M=Math.min(p.length,a.layout.columns),I=Math.ceil(p.length/M),R=a.layout.margin,T=a.layout.hMargin,S=a.layout.vMargin,L=(P-R*2-T*(M-1))/M,O=(C-R*2-S*(I-1))/I;if(a.layout.square){var j=Math.min(L,O);L=j,O=j}v(a,L);var N=a.cell.margin,F=0,U=0;a.label.show&&(F=a.label.margin,U=a.label.font.size);var w=0,B=0;a.value.show&&(w=a.value.margin,B=a.value.font.size);var K=0;a.threshold.show&&(K=a.threshold.width);var W=0,z=0;a.threshold.label.show&&(W=a.threshold.label.margin,z=a.threshold.label.font.size);for(var Y=L/2-N-K-W*2-z,X=a.gauge.startAngle,q=a.gauge.endAngle,G=(q-X)/100,te=-1,H=X;H<q;H+=G)te=Math.max(te,Math.sin(l(H)));te=Math.max(te,Math.sin(l(q)));var se=(O-N*2-F*2-U)/(1+te);se*te<w+B/2&&(se=O-N*2-F*2-U-w-B/2);var ne=se-W*2-z-K,le=Math.min(Y,ne),_=a.gauge.width;_>=le&&(_=Math.max(3,le/3));var Q=W*2+z+K+le,ae=Math.max(Q*(1+te),Q+w+B/2);return{canvasWidth:P,canvasHeight:C,margin:R,hMargin:T,vMargin:S,columns:M,rows:I,cellWidth:L,cellHeight:O,cellMargin:N,labelMargin:F,labelFontSize:U,valueMargin:w,valueFontSize:B,width:_,radius:le,thresholdWidth:K,thresholdLabelMargin:W,thresholdLabelFontSize:z,gaugeOuterHeight:ae}};function v(P,C){P.gauge.width==="auto"&&(P.gauge.width=Math.max(5,C/8)),P.label.margin==="auto"&&(P.label.margin=Math.max(1,C/20)),P.label.font.size==="auto"&&(P.label.font.size=Math.max(5,C/8)),P.value.margin==="auto"&&(P.value.margin=Math.max(1,C/30)),P.value.font.size==="auto"&&(P.value.font.size=Math.max(5,C/9)),P.threshold.width==="auto"&&(P.threshold.width=Math.max(3,C/100)),P.threshold.label.margin==="auto"&&(P.threshold.label.margin=Math.max(3,C/40)),P.threshold.label.font.size==="auto"&&(P.threshold.label.font.size=Math.max(5,C/15))}m.prototype.calculateAutoValues=v,m.prototype.calculateCellLayout=function(P,C,M){var I=n(C.columns,M),R=s(C.columns,M),T=C.margin+(C.cellWidth+C.hMargin)*I,S=C.margin+(C.cellHeight+C.vMargin)*R,L=T+C.cellWidth/2,O=S+C.cellMargin+C.labelMargin*2+C.labelFontSize+C.thresholdWidth+C.thresholdLabelFontSize+C.thresholdLabelMargin*2+C.radius,j=C.cellHeight-C.cellMargin*2-C.labelMargin*2-C.labelFontSize-C.gaugeOuterHeight,N=0;return P.cell.vAlign==="middle"?N=j/2:P.cell.vAlign==="bottom"&&(N=j),O+=N,{col:I,row:R,x:T,y:S,offsetY:N,cellWidth:C.cellWidth,cellHeight:C.cellHeight,cellMargin:C.cellMargin,cx:L,cy:O}},m.prototype.drawBackground=function(P){a.frame.show&&(o.save(),o.strokeStyle=c.grid.borderColor,o.lineWidth=c.grid.borderWidth,o.strokeRect(0,0,P.canvasWidth,P.canvasHeight),c.grid.backgroundColor&&(o.fillStyle=c.grid.backgroundColor,o.fillRect(0,0,P.canvasWidth,P.canvasHeight)),o.restore())},m.prototype.drawCellBackground=function(P,C){o.save(),P.cell.border&&P.cell.border.show&&P.cell.border.color&&P.cell.border.width&&(o.strokeStyle=P.cell.border.color,o.lineWidth=P.cell.border.width,o.strokeRect(C.x,C.y,C.cellWidth,C.cellHeight)),P.cell.background&&P.cell.background.color&&(o.fillStyle=P.cell.background.color,o.fillRect(C.x,C.y,C.cellWidth,C.cellHeight)),o.restore()},m.prototype.drawGauge=function(P,C,M,I,R){var T=P.gauge.shadow.show?P.gauge.shadow.blur:0,S=E(P,R),L=x(P,C,R);y(M.cx,M.cy,C.radius,C.width,l(P.gauge.startAngle),l(P.gauge.endAngle),P.gauge.border.color,P.gauge.border.width,P.gauge.background.color,T),y(M.cx,M.cy,C.radius-1,C.width-2,l(L.a1),l(L.a2),S,1,S,T),P.gauge.neutralValue!=null&&f(P,C,M,S)};function x(P,C,M){let I={};var R=P.gauge.neutralValue;return R!=null?M<R?(I.a1=h(P,C,M),I.a2=h(P,C,R)):(I.a1=h(P,C,R),I.a2=h(P,C,M)):(I.a1=P.gauge.startAngle,I.a2=h(P,C,M)),I}function f(P,C,M,I){var R=(P.gauge.max-P.gauge.min)/600;r(o,M.cx,M.cy,C.radius-2,C.width-4,l(h(P,C,P.gauge.neutralValue-R)),l(h(P,C,P.gauge.neutralValue+R)),I,2,P.gauge.background.color)}function E(P,C){for(var M,I=0;I<P.threshold.values.length;I++){var R=P.threshold.values[I];if(M=R.color,C<R.value)break}return M}function h(P,C,M){var I=P.gauge.startAngle+(P.gauge.endAngle-P.gauge.startAngle)*((M-P.gauge.min)/(P.gauge.max-P.gauge.min));return I<P.gauge.startAngle?I=P.gauge.startAngle:I>P.gauge.endAngle&&(I=P.gauge.endAngle),I}m.prototype.drawThreshold=function(P,C,M){for(var I=P.gauge.startAngle,R=0;R<P.threshold.values.length;R++){var T=P.threshold.values[R];c1=T.color,a2=h(P,C,T.value),r(o,M.cx,M.cy,C.radius+C.thresholdWidth,C.thresholdWidth-2,l(I),l(a2),c1,1,c1),I=a2}};function y(P,C,M,I,R,T,S,L,O,j){R!==T&&(o.save(),r(o,P,C,M,I,R,T,S,L,O),j&&(r(o,P,C,M,I,R,T),o.clip(),o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=10,o.shadowColor="gray",r(o,P,C,M+1,I+2,R,T,S,1)),o.restore())}m.prototype.drawLable=function(P,C,M,I,R){D(M.cx,M.y+M.cellMargin+C.labelMargin+M.offsetY,"flotGaugeLabel"+I,P.label.formatter?P.label.formatter(R.label,R.data[0][1]):text,P.label)},m.prototype.drawValue=function(P,C,M,I,R){D(M.cx,M.cy-P.value.font.size/2,"flotGaugeValue"+I,P.value.formatter?P.value.formatter(R.label,R.data[0][1]):text,P.value)},m.prototype.drawThresholdValues=function(P,C,M,I){b(P,C,M,"Min"+I,P.gauge.min,P.gauge.startAngle),b(P,C,M,"Max"+I,P.gauge.max,P.gauge.endAngle);for(var R=0;R<P.threshold.values.length;R++){var T=P.threshold.values[R];if(T.value>P.gauge.min&&T.value<P.gauge.max){var S=h(P,C,T.value);b(P,C,M,I+"_"+R,T.value,S)}}var L=P.gauge.neutralValue;L!=null&&L>P.gauge.min&&L<P.gauge.max&&b(P,C,M,"Neutral"+I,L,h(P,C,L))};function b(P,C,M,I,R,T){D(M.cx+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.cos(l(T)),M.cy+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.sin(l(T)),"flotGaugeThresholdValue"+I,P.threshold.label.formatter?P.threshold.label.formatter(R):R,P.threshold.label,T)}function D(P,C,M,I,R,T){var S=k(d).find("#"+M),L=S.length;L||(S=k("<span></span>"),S.attr("id",M),S.attr("class","flot-temp-elem"),d.append(S)),S.css("position","absolute"),S.css("top",C+"px"),S.css("white-space","nowrap"),R.font.size&&S.css("font-size",R.font.size+"px"),R.font.family&&S.css("font-family",R.font.family),R.color&&S.css("color",R.color),R.background.color&&S.css("background-color",R.background.color),R.background.opacity&&S.css("opacity",R.background.opacity),S.text(I),S.css("left",P+"px"),S.css("left",parseInt(S.css("left"))-S.width()/2+"px"),!L&&T&&(S.css("top",parseInt(S.css("top"))-S.height()/2+"px"),S.css("transform","rotate("+(180*T+90)+"deg)"))}return m}();function e(o){return typeof Logger<"u"?new Logger(o):null}function n(o,d){return d%o}function s(o,d){return Math.floor(d/o)}function l(o){return o*Math.PI}function r(o,d,c,a,p,u,m,v,x,f){if(u!==m){var E=!1;o.save(),o.beginPath(),o.arc(d,c,a,u,m,E),o.lineTo(d+(a-p)*Math.cos(m),c+(a-p)*Math.sin(m)),o.arc(d,c,a-p,m,u,!E),o.closePath(),x&&(o.lineWidth=x),v&&(o.strokeStyle=v,o.stroke()),f&&(o.fillStyle=f,o.fill()),o.restore()}}function i(o){o.hooks.processOptions.push(function(d,c){var a=e(c.series.gauges.debug);c.series.gauges.show&&(c.grid.show=!1,c.legend.show=!1);var p=c.series.gauges.threshold.values;p.sort(function(u,m){return u.value<m.value?-1:u.value>m.value?1:0})}),o.hooks.draw.push(function(d,c){var a=d.getOptions(),p=a.series.gauges,u=e(p.debug);if(p.show){var m=d.getData();if(!(!m||!m.length)){var v=new A(d,c),x=v.calculateLayout();p.debug.layout,v.drawBackground(x);for(var f=0;f<m.length;f++){var E=m[f],h=k.extend({},p,E.gauges);E.gauges&&v.calculateAutoValues(h,x.cellWidth);var y=v.calculateCellLayout(h,x,f);v.drawCellBackground(h,y),h.debug.layout,h.label.show&&v.drawLable(h,x,y,f,E),v.drawGauge(h,x,y,E.label,E.data[0][1]),h.threshold.show&&v.drawThreshold(h,x,y),h.threshold.label.show&&v.drawThresholdValues(h,x,y,f),h.value.show&&v.drawValue(h,x,y,f,E)}}}})}var g={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(o,d){return o}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(o,d){return parseInt(d)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(o){return o}},values:[]}}}};k.plot.plugins.push({init:i,options:g,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(k){k.color={},k.color.make=function(e,n,s,l){var r={};return r.r=e||0,r.g=n||0,r.b=s||0,r.a=l??1,r.add=function(i,g){for(var o=0;o<i.length;++o)r[i.charAt(o)]+=g;return r.normalize()},r.scale=function(i,g){for(var o=0;o<i.length;++o)r[i.charAt(o)]*=g;return r.normalize()},r.toString=function(){return r.a>=1?"rgb("+[r.r,r.g,r.b].join(",")+")":"rgba("+[r.r,r.g,r.b,r.a].join(",")+")"},r.normalize=function(){function i(g,o,d){return o<g?g:o>d?d:o}return r.r=i(0,parseInt(r.r),255),r.g=i(0,parseInt(r.g),255),r.b=i(0,parseInt(r.b),255),r.a=i(0,r.a,1),r},r.clone=function(){return k.color.make(r.r,r.b,r.g,r.a)},r.normalize()},k.color.extract=function(e,n){var s;do{if(s=e.css(n).toLowerCase(),s!=""&&s!="transparent")break;e=e.parent()}while(e.length&&!k.nodeName(e.get(0),"body"));return s=="rgba(0, 0, 0, 0)"&&(s="transparent"),k.color.parse(s)},k.color.parse=function(e){var n,s=k.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return s(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return s(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return s(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55);if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return s(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55,parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return s(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return s(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var l=k.trim(e).toLowerCase();return l=="transparent"?s(255,255,255,0):(n=A[l]||[0,0,0],s(n[0],n[1],n[2]))};var A={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(k){var A=Object.prototype.hasOwnProperty;k.fn.detach||(k.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(l,r){var i=r.children("."+l)[0];if(i==null&&(i=document.createElement("canvas"),i.className=l,k(i).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(r),!i.getContext))if(window.G_vmlCanvasManager)i=window.G_vmlCanvasManager.initElement(i);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=i;var g=this.context=i.getContext("2d"),o=window.devicePixelRatio||1,d=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;this.pixelRatio=o/d,this.resize(r.width(),r.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(l,r){if(l<=0||r<=0)throw new Error("Invalid dimensions for plot, width = "+l+", height = "+r);var i=this.element,g=this.context,o=this.pixelRatio;this.width!=l&&(i.width=l*o,i.style.width=l+"px",this.width=l),this.height!=r&&(i.height=r*o,i.style.height=r+"px",this.height=r),g.restore(),g.save(),g.scale(o,o)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var l=this._textCache;for(var r in l)if(A.call(l,r)){var i=this.getTextLayer(r),g=l[r];i.hide();for(var o in g)if(A.call(g,o)){var d=g[o];for(var c in d)if(A.call(d,c)){for(var a=d[c].positions,p=0,u;u=a[p];p++)u.active?u.rendered||(i.append(u.element),u.rendered=!0):(a.splice(p--,1),u.rendered&&u.element.detach());a.length==0&&delete d[c]}}i.show()}},e.prototype.getTextLayer=function(l){var r=this.text[l];return r==null&&(this.textContainer==null&&(this.textContainer=k("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),r=this.text[l]=k("<div></div>").addClass(l).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),r},e.prototype.getTextInfo=function(l,r,i,g,o){var d,c,a,p;if(r=""+r,typeof i=="object"?d=i.style+" "+i.variant+" "+i.weight+" "+i.size+"px/"+i.lineHeight+"px "+i.family:d=i,c=this._textCache[l],c==null&&(c=this._textCache[l]={}),a=c[d],a==null&&(a=c[d]={}),p=a[r],p==null){var u=k("<div></div>").html(r).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(l));typeof i=="object"?u.css({font:d,color:i.color}):typeof i=="string"&&u.addClass(i),p=a[r]={element:u,positions:[]};var m=this._textSizeCache[r];m?(p.width=m.width,p.height=m.height):(p.width=u.outerWidth(!0),p.height=u.outerHeight(!0),this._textSizeCache[r]={width:p.width,height:p.height}),u.detach()}return p},e.prototype.addText=function(l,r,i,g,o,d,c,a,p){var u=this.getTextInfo(l,g,o,d,c),m=u.positions;a=="center"?r-=u.width/2:a=="right"&&(r-=u.width),p=="middle"?i-=u.height/2:p=="bottom"&&(i-=u.height);for(var v=0,x;x=m[v];v++)if(x.x==r&&x.y==i){x.active=!0;return}x={active:!0,rendered:!1,element:m.length?u.element.clone():u.element,x:r,y:i},m.push(x),x.element.css({top:Math.round(i),left:Math.round(r),"text-align":a})},e.prototype.removeText=function(l,r,i,g,o,d){if(g==null){var c=this._textCache[l];if(c!=null){for(var a in c)if(A.call(c,a)){var p=c[a];for(var u in p)if(A.call(p,u))for(var m=p[u].positions,v=0,x;x=m[v];v++)x.active=!1}}}else for(var m=this.getTextInfo(l,g,o,d).positions,v=0,x;x=m[v];v++)x.x==r&&x.y==i&&(x.active=!1)};function n(l,r,i,g){var o=[],d={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},c=null,a=null,p=null,u=null,m=null,v=[],x=[],f={left:0,right:0,top:0,bottom:0},E=0,h=0,y={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},b=this;b.setData=M,b.setupGrid=X,b.draw=ne,b.getPlaceholder=function(){return l},b.getCanvas=function(){return c.element},b.getPlotOffset=function(){return f},b.width=function(){return E},b.height=function(){return h},b.offset=function(){var pe=p.offset();return pe.left+=f.left,pe.top+=f.top,pe},b.getData=function(){return o},b.getAxes=function(){var pe={},Se;return k.each(v.concat(x),function(fe,Ee){Ee&&(pe[Ee.direction+(Ee.n!=1?Ee.n:"")+"axis"]=Ee)}),pe},b.getXAxes=function(){return v},b.getYAxes=function(){return x},b.c2p=S,b.p2c=L,b.getOptions=function(){return d},b.highlight=Fe,b.unhighlight=at,b.triggerRedrawOverlay=Ke,b.pointOffset=function(pe){return{left:parseInt(v[R(pe,"x")-1].p2c(+pe.x)+f.left,10),top:parseInt(x[R(pe,"y")-1].p2c(+pe.y)+f.top,10)}},b.shutdown=w,b.destroy=function(){w(),l.removeData("plot").empty(),o=[],d=null,c=null,a=null,p=null,u=null,m=null,v=[],x=[],y=null,ge=[],b=null},b.resize=function(){var pe=l.width(),Se=l.height();c.resize(pe,Se),a.resize(pe,Se)},b.hooks=y,P(b),C(i),F(),M(r),X(),ne(),U();function D(pe,Se){Se=[b].concat(Se);for(var fe=0;fe<pe.length;++fe)pe[fe].apply(this,Se)}function P(){for(var pe={Canvas:e},Se=0;Se<g.length;++Se){var fe=g[Se];fe.init(b,pe),fe.options&&k.extend(!0,d,fe.options)}}function C(pe){k.extend(!0,d,pe),pe&&pe.colors&&(d.colors=pe.colors),d.xaxis.color==null&&(d.xaxis.color=k.color.parse(d.grid.color).scale("a",.22).toString()),d.yaxis.color==null&&(d.yaxis.color=k.color.parse(d.grid.color).scale("a",.22).toString()),d.xaxis.tickColor==null&&(d.xaxis.tickColor=d.grid.tickColor||d.xaxis.color),d.yaxis.tickColor==null&&(d.yaxis.tickColor=d.grid.tickColor||d.yaxis.color),d.grid.borderColor==null&&(d.grid.borderColor=d.grid.color),d.grid.tickColor==null&&(d.grid.tickColor=k.color.parse(d.grid.color).scale("a",.22).toString());var Se,fe,Ee,Pe=l.css("font-size"),he=Pe?+Pe.replace("px",""):13,be={style:l.css("font-style"),size:Math.round(.8*he),variant:l.css("font-variant"),weight:l.css("font-weight"),family:l.css("font-family")};for(Ee=d.xaxes.length||1,Se=0;Se<Ee;++Se)fe=d.xaxes[Se],fe&&!fe.tickColor&&(fe.tickColor=fe.color),fe=k.extend(!0,{},d.xaxis,fe),d.xaxes[Se]=fe,fe.font&&(fe.font=k.extend({},be,fe.font),fe.font.color||(fe.font.color=fe.color),fe.font.lineHeight||(fe.font.lineHeight=Math.round(fe.font.size*1.15)));for(Ee=d.yaxes.length||1,Se=0;Se<Ee;++Se)fe=d.yaxes[Se],fe&&!fe.tickColor&&(fe.tickColor=fe.color),fe=k.extend(!0,{},d.yaxis,fe),d.yaxes[Se]=fe,fe.font&&(fe.font=k.extend({},be,fe.font),fe.font.color||(fe.font.color=fe.color),fe.font.lineHeight||(fe.font.lineHeight=Math.round(fe.font.size*1.15)));for(d.xaxis.noTicks&&d.xaxis.ticks==null&&(d.xaxis.ticks=d.xaxis.noTicks),d.yaxis.noTicks&&d.yaxis.ticks==null&&(d.yaxis.ticks=d.yaxis.noTicks),d.x2axis&&(d.xaxes[1]=k.extend(!0,{},d.xaxis,d.x2axis),d.xaxes[1].position="top",d.x2axis.min==null&&(d.xaxes[1].min=null),d.x2axis.max==null&&(d.xaxes[1].max=null)),d.y2axis&&(d.yaxes[1]=k.extend(!0,{},d.yaxis,d.y2axis),d.yaxes[1].position="right",d.y2axis.min==null&&(d.yaxes[1].min=null),d.y2axis.max==null&&(d.yaxes[1].max=null)),d.grid.coloredAreas&&(d.grid.markings=d.grid.coloredAreas),d.grid.coloredAreasColor&&(d.grid.markingsColor=d.grid.coloredAreasColor),d.lines&&k.extend(!0,d.series.lines,d.lines),d.points&&k.extend(!0,d.series.points,d.points),d.bars&&k.extend(!0,d.series.bars,d.bars),d.shadowSize!=null&&(d.series.shadowSize=d.shadowSize),d.highlightColor!=null&&(d.series.highlightColor=d.highlightColor),Se=0;Se<d.xaxes.length;++Se)O(v,Se+1).options=d.xaxes[Se];for(Se=0;Se<d.yaxes.length;++Se)O(x,Se+1).options=d.yaxes[Se];for(var Ae in y)d.hooks[Ae]&&d.hooks[Ae].length&&(y[Ae]=y[Ae].concat(d.hooks[Ae]));D(y.processOptions,[d])}function M(pe){o=I(pe),j(),N()}function I(pe){for(var Se=[],fe=0;fe<pe.length;++fe){var Ee=k.extend(!0,{},d.series);pe[fe].data!=null?(Ee.data=pe[fe].data,delete pe[fe].data,k.extend(!0,Ee,pe[fe]),pe[fe].data=Ee.data):Ee.data=pe[fe],Se.push(Ee)}return Se}function R(pe,Se){var fe=pe[Se+"axis"];return typeof fe=="object"&&(fe=fe.n),typeof fe!="number"&&(fe=1),fe}function T(){return k.grep(v.concat(x),function(pe){return pe})}function S(pe){var Se={},fe,Ee;for(fe=0;fe<v.length;++fe)Ee=v[fe],Ee&&(Se["x"+Ee.n]=Ee.c2p(pe.left));for(fe=0;fe<x.length;++fe)Ee=x[fe],Ee&&(Se["y"+Ee.n]=Ee.c2p(pe.top));return Se.x1!==void 0&&(Se.x=Se.x1),Se.y1!==void 0&&(Se.y=Se.y1),Se}function L(pe){var Se={},fe,Ee,Pe;for(fe=0;fe<v.length;++fe)if(Ee=v[fe],Ee&&Ee.used&&(Pe="x"+Ee.n,pe[Pe]==null&&Ee.n==1&&(Pe="x"),pe[Pe]!=null)){Se.left=Ee.p2c(pe[Pe]);break}for(fe=0;fe<x.length;++fe)if(Ee=x[fe],Ee&&Ee.used&&(Pe="y"+Ee.n,pe[Pe]==null&&Ee.n==1&&(Pe="y"),pe[Pe]!=null)){Se.top=Ee.p2c(pe[Pe]);break}return Se}function O(pe,Se){return pe[Se-1]||(pe[Se-1]={n:Se,direction:pe==v?"x":"y",options:k.extend(!0,{},pe==v?d.xaxis:d.yaxis)}),pe[Se-1]}function j(){var pe=o.length,Se=-1,fe;for(fe=0;fe<o.length;++fe){var Ee=o[fe].color;Ee!=null&&(pe--,typeof Ee=="number"&&Ee>Se&&(Se=Ee))}pe<=Se&&(pe=Se+1);var Pe,he=[],be=d.colors,Ae=be.length,De=0;for(fe=0;fe<pe;fe++)Pe=k.color.parse(be[fe%Ae]||"#666"),fe%Ae==0&&fe&&(De>=0?De<.5?De=-De-.2:De=0:De=-De),he[fe]=Pe.scale("rgb",1+De);var Ie=0,ke;for(fe=0;fe<o.length;++fe){if(ke=o[fe],ke.color==null?(ke.color=he[Ie].toString(),++Ie):typeof ke.color=="number"&&(ke.color=he[ke.color].toString()),ke.lines.show==null){var dt,Pt=!0;for(dt in ke)if(ke[dt]&&ke[dt].show){Pt=!1;break}Pt&&(ke.lines.show=!0)}ke.lines.zero==null&&(ke.lines.zero=!!ke.lines.fill),ke.xaxis=O(v,R(ke,"x")),ke.yaxis=O(x,R(ke,"y"))}}function N(){var pe=Number.POSITIVE_INFINITY,Se=Number.NEGATIVE_INFINITY,fe=Number.MAX_VALUE,Ee,Pe,he,be,Ae,De,Ie,ke,dt,Pt,pt,Tt,jt,$t,sn,Yt;function qt(Dn,An,Pn){An<Dn.datamin&&An!=-fe&&(Dn.datamin=An),Pn>Dn.datamax&&Pn!=fe&&(Dn.datamax=Pn)}for(k.each(T(),function(Dn,An){An.datamin=pe,An.datamax=Se,An.used=!1}),Ee=0;Ee<o.length;++Ee)De=o[Ee],De.datapoints={points:[]},D(y.processRawData,[De,De.data,De.datapoints]);for(Ee=0;Ee<o.length;++Ee){if(De=o[Ee],sn=De.data,Yt=De.datapoints.format,!Yt){if(Yt=[],Yt.push({x:!0,number:!0,required:!0}),Yt.push({y:!0,number:!0,required:!0}),De.stack||De.bars.show||De.lines.show&&De.lines.fill){var bn=!!(De.bars.show&&De.bars.zero||De.lines.show&&De.lines.zero);Yt.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:bn}),De.bars.horizontal&&(delete Yt[Yt.length-1].y,Yt[Yt.length-1].x=!0)}De.datapoints.format=Yt}if(De.datapoints.pointsize==null){De.datapoints.pointsize=Yt.length,ke=De.datapoints.pointsize,Ie=De.datapoints.points;var Mt=De.lines.show&&De.lines.steps;for(De.xaxis.used=De.yaxis.used=!0,Pe=he=0;Pe<sn.length;++Pe,he+=ke){$t=sn[Pe];var Jt=$t==null;if(!Jt)for(be=0;be<ke;++be)Tt=$t[be],jt=Yt[be],jt&&(jt.number&&Tt!=null&&(Tt=+Tt,isNaN(Tt)?Tt=null:Tt==1/0?Tt=fe:Tt==-1/0&&(Tt=-fe)),Tt==null&&(jt.required&&(Jt=!0),jt.defaultValue!=null&&(Tt=jt.defaultValue))),Ie[he+be]=Tt;if(Jt)for(be=0;be<ke;++be)Tt=Ie[he+be],Tt!=null&&(jt=Yt[be],jt.autoscale!==!1&&(jt.x&&qt(De.xaxis,Tt,Tt),jt.y&&qt(De.yaxis,Tt,Tt))),Ie[he+be]=null;if(Mt&&he>0&&(!Jt||Ie[he-ke]!=null)){for(be=0;be<ke;++be)Ie[he+ke+be]=Ie[he+be];Ie[he+1]=Ie[he-ke+1]||0,Jt&&(Ie[he]=$t[0]),he+=ke}}}}for(Ee=0;Ee<o.length;++Ee){if(De=o[Ee],Ie=De.datapoints.points,ke=De.datapoints.pointsize,De.transform==="negative-Y")for(Pe=0;Pe<Ie.length;Pe+=ke)Ie[Pe]!=null&&(Tt=Ie[Pe+1],Ie[Pe+1]=-Tt);D(y.processDatapoints,[De,De.datapoints])}for(Ee=0;Ee<o.length;++Ee){De=o[Ee],Ie=De.datapoints.points,ke=De.datapoints.pointsize,Yt=De.datapoints.format;var Ut=pe,Gt=pe,Lt=Se,At=Se;for(Pe=0;Pe<Ie.length;Pe+=ke)if(Ie[Pe]!=null)for(be=0;be<ke;++be)Tt=Ie[Pe+be],jt=Yt[be],!(!jt||jt.autoscale===!1||Tt==fe||Tt==-fe)&&(jt.x&&(Tt<Ut&&(Ut=Tt),Tt>Lt&&(Lt=Tt)),jt.y&&(Tt<Gt&&(Gt=Tt),Tt>At&&(At=Tt)));if(De.bars.show){var Nt;switch(De.bars.align){case"left":Nt=0;break;case"right":Nt=-De.bars.barWidth;break;default:Nt=-De.bars.barWidth/2}De.bars.horizontal?(Gt+=Nt,At+=Nt+De.bars.barWidth):(Ut+=Nt,Lt+=Nt+De.bars.barWidth)}qt(De.xaxis,Ut,Lt),qt(De.yaxis,Gt,At)}k.each(T(),function(Dn,An){An.datamin==pe&&(An.datamin=null),An.datamax==Se&&(An.datamax=null)})}function F(){l.find(".flot-temp-elem").remove(),l.css("position")=="static"&&l.css("position","relative"),c=new e("flot-base",l),a=new e("flot-overlay",l),u=c.context,m=a.context,p=k(a.element).unbind();var pe=l.data("plot");pe&&(pe.shutdown(),a.clear()),l.data("plot",b)}function U(){d.grid.hoverable&&(p.mousemove(Xe),p.bind("mouseleave",we),k(document).bind("touchend",We)),d.grid.clickable&&p.click(qe),D(y.bindEvents,[p])}function w(){Oe&&clearTimeout(Oe),p.unbind("mousemove",Xe),p.unbind("mouseleave",we),p.unbind("click",qe),k(document).unbind("touchend",We),D(y.shutdown,[p])}function B(pe){function Se(be){return be}var fe,Ee,Pe=pe.options.transform||Se,he=pe.options.inverseTransform;pe.direction=="x"?(fe=pe.scale=E/Math.abs(Pe(pe.max)-Pe(pe.min)),Ee=Math.min(Pe(pe.max),Pe(pe.min))):(fe=pe.scale=h/Math.abs(Pe(pe.max)-Pe(pe.min)),fe=-fe,Ee=Math.max(Pe(pe.max),Pe(pe.min))),Pe==Se?pe.p2c=function(be){return(be-Ee)*fe}:pe.p2c=function(be){return(Pe(be)-Ee)*fe},he?pe.c2p=function(be){return he(Ee+be/fe)}:pe.c2p=function(be){return Ee+be/fe}}function K(pe){for(var Se=pe.options,fe=pe.ticks||[],Ee=Se.labelWidth||0,Pe=Se.labelHeight||0,he=Ee||(pe.direction=="x"?Math.floor(c.width/(fe.length||1)):null),be=pe.direction+"Axis "+pe.direction+pe.n+"Axis",Ae="flot-"+pe.direction+"-axis flot-"+pe.direction+pe.n+"-axis "+be,De=Se.font||"flot-tick-label tickLabel",Ie=0;Ie<fe.length;++Ie){var ke=fe[Ie];if(ke.label){var dt=c.getTextInfo(Ae,ke.label,De,null,he);Ee=Math.max(Ee,dt.width+1),Pe=Math.max(Pe,dt.height)}}pe.labelWidth=Se.labelWidth||Ee,pe.labelHeight=Se.labelHeight||Pe}function W(pe){var Se=pe.labelWidth,fe=pe.labelHeight,Ee=pe.options.position,Pe=pe.direction==="x",he=pe.options.tickLength,be=d.grid.axisMargin,Ae=d.grid.labelMargin,De=d.grid.eventSectionHeight,Ie=!0,ke=!0,dt=!0,Pt=!1;k.each(Pe?v:x,function(pt,Tt){Tt&&(Tt.show||Tt.reserveSpace)&&(Tt===pe?Pt=!0:Tt.options.position===Ee&&(Pt?ke=!1:Ie=!1),Pt||(dt=!1))}),ke&&(be=0),he==null&&(he=dt?"full":5),isNaN(+he)||(Ae+=+he),Pe?(fe+=Ae,fe+=De,Ee=="bottom"?(f.bottom+=fe+be,pe.box={top:c.height-f.bottom,height:fe}):(pe.box={top:f.top+be,height:fe},f.top+=fe+be)):(Se+=Ae,Ee=="left"?(pe.box={left:f.left+be,width:Se},f.left+=Se+be):(f.right+=Se+be,pe.box={left:c.width-f.right,width:Se})),pe.position=Ee,pe.tickLength=he,pe.box.padding=Ae,pe.box.eventSectionPadding=De,pe.innermost=Ie}function z(pe){pe.direction=="x"?(pe.box.left=f.left-pe.labelWidth/2,pe.box.width=c.width-f.left-f.right+pe.labelWidth):(pe.box.top=f.top-pe.labelHeight/2,pe.box.height=c.height-f.bottom-f.top+pe.labelHeight)}function Y(){var pe=d.grid.minBorderMargin,Se,fe;if(pe==null)for(pe=0,fe=0;fe<o.length;++fe)pe=Math.max(pe,2*(o[fe].points.radius+o[fe].points.lineWidth/2));var Ee={left:pe,right:pe,top:pe,bottom:pe};k.each(T(),function(Pe,he){he.reserveSpace&&he.ticks&&he.ticks.length&&(he.direction==="x"?(Ee.left=Math.max(Ee.left,he.labelWidth/2),Ee.right=Math.max(Ee.right,he.labelWidth/2)):(Ee.bottom=Math.max(Ee.bottom,he.labelHeight/2),Ee.top=Math.max(Ee.top,he.labelHeight/2)))}),f.left=Math.ceil(Math.max(Ee.left,f.left)),f.right=Math.ceil(Math.max(Ee.right,f.right)),f.top=Math.ceil(Math.max(Ee.top,f.top)),f.bottom=Math.ceil(Math.max(Ee.bottom,f.bottom))}function X(){var pe,Se=T(),fe=d.grid.show;for(var Ee in f){var Pe=d.grid.margin||0;f[Ee]=typeof Pe=="number"?Pe:Pe[Ee]||0}D(y.processOffset,[f]);for(var Ee in f)typeof d.grid.borderWidth=="object"?f[Ee]+=fe?d.grid.borderWidth[Ee]:0:f[Ee]+=fe?d.grid.borderWidth:0;if(k.each(Se,function(Ae,De){var Ie=De.options;De.show=Ie.show==null?De.used:Ie.show,De.reserveSpace=Ie.reserveSpace==null?De.show:Ie.reserveSpace,q(De)}),D(y.processRange,[]),fe){for(var he=k.grep(Se,function(Ae){return Ae.show||Ae.reserveSpace}),be=!1,pe=0;pe<2&&(k.each(he,function(De,Ie){te(Ie),H(Ie),be=se(Ie,Ie.ticks)||be,K(Ie)}),be&&y.processRange.length>0);pe++)D(y.processRange,[]),be=!1;for(pe=he.length-1;pe>=0;--pe)W(he[pe]);Y(),k.each(he,function(Ae,De){z(De)})}E=c.width-f.left-f.right,h=c.height-f.bottom-f.top,k.each(Se,function(Ae,De){B(De)}),fe&&ae(),Te()}function q(pe){var Se=pe.options,fe=+(Se.min!=null?Se.min:pe.datamin),Ee=+(Se.max!=null?Se.max:pe.datamax),Pe=Ee-fe;if(Pe==0){var he=.25,be=Math.abs(Ee==0?1:Ee*he);Se.min==null&&(fe-=be),(Se.max==null||Se.min!=null)&&(Ee+=be)}else{var Ae=Se.autoscaleMargin;Ae!=null&&(Se.min==null&&(fe-=Pe*Ae,fe<0&&pe.datamin!=null&&pe.datamin>=0&&(fe=0)),Se.max==null&&(Ee+=Pe*Ae,Ee>0&&pe.datamax!=null&&pe.datamax<=0&&(Ee=0)))}pe.min=fe,pe.max=Ee}function G(pe){if(pe=Math.abs(String(pe).replace(".","")),pe==0)return 0;for(;pe!=0&&pe%10==0;)pe/=10;return Math.floor(Math.log(pe)/Math.LN10)+1}function te(pe){var Se=pe.options,fe;typeof Se.ticks=="number"&&Se.ticks>0?fe=Se.ticks:fe=.3*Math.sqrt(pe.direction=="x"?c.width:c.height);var Ee=(pe.max-pe.min)/fe,Pe=-Math.floor(Math.log(Ee)/Math.LN10),he=Se.tickDecimals;he!=null&&Pe>he&&(Pe=he);var be=Math.pow(10,-Pe),Ae=Ee/be,De;if(Ae<1.5?De=1:Ae<3?(De=2,Ae>2.25&&(he==null||Pe+1<=he)&&(De=2.5,++Pe)):Ae<7.5?De=5:De=10,De*=be,Se.minTickSize!=null&&De<Se.minTickSize&&(De=Se.minTickSize),pe.delta=Ee,pe.tickDecimals=Math.max(0,he??Pe),pe.tickSize=Se.tickSize||De,Se.mode=="time"&&!pe.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(pe.tickGenerator||(pe.tickGenerator=function(pt){var Tt=[],jt=s(pt.min,pt.tickSize),$t=0,sn=Number.NaN,Yt;do Yt=sn,sn=jt+$t*pt.tickSize,Tt.push(sn),++$t;while(sn<pt.max&&sn!=Yt);return Tt},pe.tickFormatter=function(pt,Tt){var jt=Tt.tickDecimals?Math.pow(10,Tt.tickDecimals):1,$t=""+Math.round(pt*jt)/jt;if(Tt.tickDecimals!=null){var sn=$t.indexOf("."),Yt=sn==-1?0:$t.length-sn-1;if(Yt<Tt.tickDecimals)return(Yt?$t:$t+".")+(""+jt).substr(1,Tt.tickDecimals-Yt)}return $t}),k.isFunction(Se.tickFormatter)&&(pe.tickFormatter=function(pt,Tt){return""+Se.tickFormatter(pt,Tt)}),Se.alignTicksWithAxis!=null){var Ie=(pe.direction=="x"?v:x)[Se.alignTicksWithAxis-1];if(Ie&&Ie.used&&Ie!=pe){var ke=pe.tickGenerator(pe);if(ke.length>0&&(Se.min==null&&(pe.min=Math.min(pe.min,ke[0])),Se.max==null&&ke.length>1&&(pe.max=Math.max(pe.max,ke[ke.length-1]))),pe.tickGenerator=function(pt){var Tt=[],jt,$t;for($t=0;$t<Ie.ticks.length;++$t)jt=(Ie.ticks[$t].v-Ie.min)/(Ie.max-Ie.min),jt=pt.min+jt*(pt.max-pt.min),Tt.push(jt);return Tt},!pe.mode&&Se.tickDecimals==null){var dt=Math.max(0,-Math.floor(Math.log(pe.delta)/Math.LN10)+1),Pt=pe.tickGenerator(pe);Pt.length>1&&/\..*0$/.test((Pt[1]-Pt[0]).toFixed(dt))||(pe.tickDecimals=dt)}}}}function H(pe){var Se=pe.options.ticks,fe=[];Se==null||typeof Se=="number"&&Se>0?fe=pe.tickGenerator(pe):Se&&(k.isFunction(Se)?fe=Se(pe):fe=Se);var Ee,Pe;for(pe.ticks=[],Ee=0;Ee<fe.length;++Ee){var he=null,be=fe[Ee];typeof be=="object"?(Pe=+be[0],be.length>1&&(he=be[1])):Pe=+be,he==null&&(he=pe.tickFormatter(Pe,pe)),isNaN(Pe)||pe.ticks.push({v:Pe,label:he})}}function se(pe,Se){var fe=!1;return pe.options.autoscaleMargin&&Se.length>0&&(pe.options.min==null&&(pe.min=Math.min(pe.min,Se[0].v),fe=!0),pe.options.max==null&&Se.length>1&&(pe.max=Math.max(pe.max,Se[Se.length-1].v),fe=!0)),fe}function ne(){c.clear(),D(y.drawBackground,[u]);var pe=d.grid;pe.show&&pe.backgroundColor&&_(),pe.show&&!pe.aboveData&&Q();for(var Se=0;Se<o.length;++Se)D(y.drawSeries,[u,o[Se]]),J(o[Se]);D(y.draw,[u]),pe.show&&pe.aboveData&&Q(),c.render(),Ke()}function le(pe,Se){for(var fe,Ee,Pe,he,be=T(),Ae=0;Ae<be.length;++Ae)if(fe=be[Ae],fe.direction==Se&&(he=Se+fe.n+"axis",!pe[he]&&fe.n==1&&(he=Se+"axis"),pe[he])){Ee=pe[he].from,Pe=pe[he].to;break}if(pe[he]||(fe=Se=="x"?v[0]:x[0],Ee=pe[Se+"1"],Pe=pe[Se+"2"]),Ee!=null&&Pe!=null&&Ee>Pe){var De=Ee;Ee=Pe,Pe=De}return{from:Ee,to:Pe,axis:fe}}function _(){u.save(),u.translate(f.left,f.top),u.fillStyle=ze(d.grid.backgroundColor,h,0,"rgba(255, 255, 255, 0)"),u.fillRect(0,0,E,h),u.restore()}function Q(){var pe,Se,fe,Ee;u.save(),u.translate(f.left,f.top);var Pe=d.grid.markings;if(Pe)for(k.isFunction(Pe)&&(Se=b.getAxes(),Se.xmin=Se.xaxis.min,Se.xmax=Se.xaxis.max,Se.ymin=Se.yaxis.min,Se.ymax=Se.yaxis.max,Pe=Pe(Se)),pe=0;pe<Pe.length;++pe){var he=Pe[pe],be=le(he,"x"),Ae=le(he,"y");if(be.from==null&&(be.from=be.axis.min),be.to==null&&(be.to=be.axis.max),Ae.from==null&&(Ae.from=Ae.axis.min),Ae.to==null&&(Ae.to=Ae.axis.max),!(be.to<be.axis.min||be.from>be.axis.max||Ae.to<Ae.axis.min||Ae.from>Ae.axis.max)){be.from=Math.max(be.from,be.axis.min),be.to=Math.min(be.to,be.axis.max),Ae.from=Math.max(Ae.from,Ae.axis.min),Ae.to=Math.min(Ae.to,Ae.axis.max);var De=be.from===be.to,Ie=Ae.from===Ae.to;if(!(De&&Ie))if(be.from=Math.floor(be.axis.p2c(be.from)),be.to=Math.floor(be.axis.p2c(be.to)),Ae.from=Math.floor(Ae.axis.p2c(Ae.from)),Ae.to=Math.floor(Ae.axis.p2c(Ae.to)),De||Ie){var ke=he.lineWidth||d.grid.markingsLineWidth,dt=ke%2?.5:0;u.beginPath(),u.strokeStyle=he.color||d.grid.markingsColor,u.lineWidth=ke,De?(u.moveTo(be.to+dt,Ae.from),u.lineTo(be.to+dt,Ae.to)):(u.moveTo(be.from,Ae.to+dt),u.lineTo(be.to,Ae.to+dt)),u.stroke()}else u.fillStyle=he.color||d.grid.markingsColor,u.fillRect(be.from,Ae.to,be.to-be.from,Ae.from-Ae.to)}}Se=T(),fe=d.grid.borderWidth;for(var Pt=0;Pt<Se.length;++Pt){var pt=Se[Pt],Tt=pt.box,jt=pt.tickLength,$t,sn,Yt,qt;if(!(!pt.show||pt.ticks.length==0)){for(u.lineWidth=1,pt.direction=="x"?($t=0,jt=="full"?sn=pt.position=="top"?0:h:sn=Tt.top-f.top+(pt.position=="top"?Tt.height:0)):(sn=0,jt=="full"?$t=pt.position=="left"?0:E:$t=Tt.left-f.left+(pt.position=="left"?Tt.width:0)),pt.innermost||(u.strokeStyle=pt.options.color,u.beginPath(),Yt=qt=0,pt.direction=="x"?Yt=E+1:qt=h+1,u.lineWidth==1&&(pt.direction=="x"?sn=Math.floor(sn)+.5:$t=Math.floor($t)+.5),u.moveTo($t,sn),u.lineTo($t+Yt,sn+qt),u.stroke()),u.strokeStyle=pt.options.tickColor,u.beginPath(),pe=0;pe<pt.ticks.length;++pe){var bn=pt.ticks[pe].v;Yt=qt=0,!(isNaN(bn)||bn<pt.min||bn>pt.max||jt=="full"&&(typeof fe=="object"&&fe[pt.position]>0||fe>0)&&(bn==pt.min||bn==pt.max))&&(pt.direction=="x"?($t=pt.p2c(bn),qt=jt=="full"?-h:jt,pt.position=="top"&&(qt=-qt)):(sn=pt.p2c(bn),Yt=jt=="full"?-E:jt,pt.position=="left"&&(Yt=-Yt)),u.lineWidth==1&&(pt.direction=="x"?$t=Math.floor($t)+.5:sn=Math.floor(sn)+.5),u.moveTo($t,sn),u.lineTo($t+Yt,sn+qt))}u.stroke()}}fe&&(Ee=d.grid.borderColor,typeof fe=="object"||typeof Ee=="object"?(typeof fe!="object"&&(fe={top:fe,right:fe,bottom:fe,left:fe}),typeof Ee!="object"&&(Ee={top:Ee,right:Ee,bottom:Ee,left:Ee}),fe.top>0&&(u.strokeStyle=Ee.top,u.lineWidth=fe.top,u.beginPath(),u.moveTo(0-fe.left,0-fe.top/2),u.lineTo(E,0-fe.top/2),u.stroke()),fe.right>0&&(u.strokeStyle=Ee.right,u.lineWidth=fe.right,u.beginPath(),u.moveTo(E+fe.right/2,0-fe.top),u.lineTo(E+fe.right/2,h),u.stroke()),fe.bottom>0&&(u.strokeStyle=Ee.bottom,u.lineWidth=fe.bottom,u.beginPath(),u.moveTo(E+fe.right,h+fe.bottom/2),u.lineTo(0,h+fe.bottom/2),u.stroke()),fe.left>0&&(u.strokeStyle=Ee.left,u.lineWidth=fe.left,u.beginPath(),u.moveTo(0-fe.left/2,h+fe.bottom),u.lineTo(0-fe.left/2,0),u.stroke())):(u.lineWidth=fe,u.strokeStyle=d.grid.borderColor,u.strokeRect(-fe/2,-fe/2,E+fe,h+fe))),u.restore()}function ae(){k.each(T(),function(pe,Se){var fe=Se.box,Ee=Se.direction+"Axis "+Se.direction+Se.n+"Axis",Pe="flot-"+Se.direction+"-axis flot-"+Se.direction+Se.n+"-axis "+Ee,he=Se.options.font||"flot-tick-label tickLabel",be,Ae,De,Ie,ke;if(c.removeText(Pe),!(!Se.show||Se.ticks.length==0))for(var dt=0;dt<Se.ticks.length;++dt)be=Se.ticks[dt],!(!be.label||be.v<Se.min||be.v>Se.max)&&(Se.direction=="x"?(Ie="center",Ae=f.left+Se.p2c(be.v),Se.position=="bottom"?De=fe.top+fe.padding+fe.eventSectionPadding:(De=fe.top+fe.height-fe.padding,ke="bottom")):(ke="middle",De=f.top+Se.p2c(be.v),Se.position=="left"?(Ae=fe.left+fe.width-fe.padding,Ie="right"):Ae=fe.left+fe.padding),c.addText(Pe,Ae,De,be.label,he,null,null,Ie,ke))})}function oe(pe){for(var Se=[],fe=null,Ee=null,Pe=pe.datapoints,he=[],be=0;be<Pe.pointsize-2;be++)he.push(0);for(var Ae=0;Ae<Pe.points.length;Ae+=Pe.pointsize){var De=Pe.points[Ae],Ie=Pe.points[Ae+1];Ae===Pe.points.length-Pe.pointsize?Ee=null:Ee=Pe.points[Ae+Pe.pointsize],De!==null&&Ie!==null&&fe===null&&Ee===null&&(Se.push(De),Se.push(Ie),Se.push.apply(Se,he)),fe=De}var ke=Pe.points;Pe.points=Se,pe.points.radius=pe.lines.lineWidth/2,de(pe),Pe.points=ke}function J(pe){pe.lines.show&&(ee(pe),!pe.points.show&&!pe.bars.show&&oe(pe)),pe.bars.show&&re(pe),pe.points.show&&de(pe)}function ee(pe){function Se(Ae,De,Ie,ke,dt){var Pt=Ae.points,pt=Ae.pointsize,Tt=null,jt=null;u.beginPath();for(var $t=pt;$t<Pt.length;$t+=pt){var sn=Pt[$t-pt],Yt=Pt[$t-pt+1],qt=Pt[$t],bn=Pt[$t+1];if(!(sn==null||qt==null)){if(Yt<=bn&&Yt<dt.min){if(bn<dt.min)continue;sn=(dt.min-Yt)/(bn-Yt)*(qt-sn)+sn,Yt=dt.min}else if(bn<=Yt&&bn<dt.min){if(Yt<dt.min)continue;qt=(dt.min-Yt)/(bn-Yt)*(qt-sn)+sn,bn=dt.min}if(Yt>=bn&&Yt>dt.max){if(bn>dt.max)continue;sn=(dt.max-Yt)/(bn-Yt)*(qt-sn)+sn,Yt=dt.max}else if(bn>=Yt&&bn>dt.max){if(Yt>dt.max)continue;qt=(dt.max-Yt)/(bn-Yt)*(qt-sn)+sn,bn=dt.max}if(sn<=qt&&sn<ke.min){if(qt<ke.min)continue;Yt=(ke.min-sn)/(qt-sn)*(bn-Yt)+Yt,sn=ke.min}else if(qt<=sn&&qt<ke.min){if(sn<ke.min)continue;bn=(ke.min-sn)/(qt-sn)*(bn-Yt)+Yt,qt=ke.min}if(sn>=qt&&sn>ke.max){if(qt>ke.max)continue;Yt=(ke.max-sn)/(qt-sn)*(bn-Yt)+Yt,sn=ke.max}else if(qt>=sn&&qt>ke.max){if(sn>ke.max)continue;bn=(ke.max-sn)/(qt-sn)*(bn-Yt)+Yt,qt=ke.max}(sn!=Tt||Yt!=jt)&&u.moveTo(ke.p2c(sn)+De,dt.p2c(Yt)+Ie),Tt=qt,jt=bn,u.lineTo(ke.p2c(qt)+De,dt.p2c(bn)+Ie)}}u.stroke()}function fe(Ae,De,Ie){for(var ke=Ae.points,dt=Ae.pointsize,Pt=Math.min(Math.max(0,Ie.min),Ie.max),pt=0,Tt,jt=!1,$t=1,sn=0,Yt=0;!(dt>0&&pt>ke.length+dt);){pt+=dt;var qt=ke[pt-dt],bn=ke[pt-dt+$t],Mt=ke[pt],Jt=ke[pt+$t];if(jt){if(dt>0&&qt!=null&&Mt==null){Yt=pt,dt=-dt,$t=2;continue}if(dt<0&&pt==sn+dt){u.fill(),jt=!1,dt=-dt,$t=1,pt=sn=Yt+dt;continue}}if(!(qt==null||Mt==null)){if(qt<=Mt&&qt<De.min){if(Mt<De.min)continue;bn=(De.min-qt)/(Mt-qt)*(Jt-bn)+bn,qt=De.min}else if(Mt<=qt&&Mt<De.min){if(qt<De.min)continue;Jt=(De.min-qt)/(Mt-qt)*(Jt-bn)+bn,Mt=De.min}if(qt>=Mt&&qt>De.max){if(Mt>De.max)continue;bn=(De.max-qt)/(Mt-qt)*(Jt-bn)+bn,qt=De.max}else if(Mt>=qt&&Mt>De.max){if(qt>De.max)continue;Jt=(De.max-qt)/(Mt-qt)*(Jt-bn)+bn,Mt=De.max}if(jt||(u.beginPath(),u.moveTo(De.p2c(qt),Ie.p2c(Pt)),jt=!0),bn>=Ie.max&&Jt>=Ie.max){u.lineTo(De.p2c(qt),Ie.p2c(Ie.max)),u.lineTo(De.p2c(Mt),Ie.p2c(Ie.max));continue}else if(bn<=Ie.min&&Jt<=Ie.min){u.lineTo(De.p2c(qt),Ie.p2c(Ie.min)),u.lineTo(De.p2c(Mt),Ie.p2c(Ie.min));continue}var Ut=qt,Gt=Mt;bn<=Jt&&bn<Ie.min&&Jt>=Ie.min?(qt=(Ie.min-bn)/(Jt-bn)*(Mt-qt)+qt,bn=Ie.min):Jt<=bn&&Jt<Ie.min&&bn>=Ie.min&&(Mt=(Ie.min-bn)/(Jt-bn)*(Mt-qt)+qt,Jt=Ie.min),bn>=Jt&&bn>Ie.max&&Jt<=Ie.max?(qt=(Ie.max-bn)/(Jt-bn)*(Mt-qt)+qt,bn=Ie.max):Jt>=bn&&Jt>Ie.max&&bn<=Ie.max&&(Mt=(Ie.max-bn)/(Jt-bn)*(Mt-qt)+qt,Jt=Ie.max),qt!=Ut&&u.lineTo(De.p2c(Ut),Ie.p2c(bn)),u.lineTo(De.p2c(qt),Ie.p2c(bn)),u.lineTo(De.p2c(Mt),Ie.p2c(Jt)),Mt!=Gt&&(u.lineTo(De.p2c(Mt),Ie.p2c(Jt)),u.lineTo(De.p2c(Gt),Ie.p2c(Jt)))}}}u.save(),u.translate(f.left,f.top),u.lineJoin="round";var Ee=pe.lines.lineWidth,Pe=pe.shadowSize;if(Ee>0&&Pe>0){u.lineWidth=Pe,u.strokeStyle="rgba(0,0,0,0.1)";var he=Math.PI/18;Se(pe.datapoints,Math.sin(he)*(Ee/2+Pe/2),Math.cos(he)*(Ee/2+Pe/2),pe.xaxis,pe.yaxis),u.lineWidth=Pe/2,Se(pe.datapoints,Math.sin(he)*(Ee/2+Pe/4),Math.cos(he)*(Ee/2+Pe/4),pe.xaxis,pe.yaxis)}u.lineWidth=Ee,u.strokeStyle=pe.color;var be=ue(pe.lines,pe.color,0,h);be&&(u.fillStyle=be,fe(pe.datapoints,pe.xaxis,pe.yaxis)),Ee>0&&Se(pe.datapoints,0,0,pe.xaxis,pe.yaxis),u.restore()}function de(pe){function Se(Ae,De,Ie,ke,dt,Pt,pt,Tt){for(var jt=Ae.points,$t=Ae.pointsize,sn=0;sn<jt.length;sn+=$t){var Yt=jt[sn],qt=jt[sn+1];Yt==null||Yt<Pt.min||Yt>Pt.max||qt<pt.min||qt>pt.max||(u.beginPath(),Yt=Pt.p2c(Yt),qt=pt.p2c(qt)+ke,Tt=="circle"?u.arc(Yt,qt,De,0,dt?Math.PI:Math.PI*2,!1):Tt(u,Yt,qt,De,dt),u.closePath(),Ie&&(u.fillStyle=Ie,u.fill()),u.stroke())}}u.save(),u.translate(f.left,f.top);var fe=pe.points.lineWidth,Ee=pe.shadowSize,Pe=pe.points.radius,he=pe.points.symbol;if(fe==0&&(fe=1e-4),fe>0&&Ee>0){var be=Ee/2;u.lineWidth=be,u.strokeStyle="rgba(0,0,0,0.1)",Se(pe.datapoints,Pe,null,be+be/2,!0,pe.xaxis,pe.yaxis,he),u.strokeStyle="rgba(0,0,0,0.2)",Se(pe.datapoints,Pe,null,be/2,!0,pe.xaxis,pe.yaxis,he)}u.lineWidth=fe,u.strokeStyle=pe.color,Se(pe.datapoints,Pe,ue(pe.points,pe.color),0,!1,pe.xaxis,pe.yaxis,he),u.restore()}function xe(pe,Se,fe,Ee,Pe,he,be,Ae,De,Ie,ke){var dt,Pt,pt,Tt,jt,$t,sn,Yt,qt;Ie?(Yt=$t=sn=!0,jt=!1,dt=fe,Pt=pe,Tt=Se+Ee,pt=Se+Pe,Pt<dt&&(qt=Pt,Pt=dt,dt=qt,jt=!0,$t=!1)):(jt=$t=sn=!0,Yt=!1,dt=pe+Ee,Pt=pe+Pe,pt=fe,Tt=Se,Tt<pt&&(qt=Tt,Tt=pt,pt=qt,Yt=!0,sn=!1)),!(Pt<be.min||dt>be.max||Tt<Ae.min||pt>Ae.max)&&(dt<be.min&&(dt=be.min,jt=!1),Pt>be.max&&(Pt=be.max,$t=!1),pt<Ae.min&&(pt=Ae.min,Yt=!1),Tt>Ae.max&&(Tt=Ae.max,sn=!1),dt=be.p2c(dt),pt=Ae.p2c(pt),Pt=be.p2c(Pt),Tt=Ae.p2c(Tt),he&&(De.fillStyle=he(pt,Tt),De.fillRect(dt,Tt,Pt-dt,pt-Tt)),ke>0&&(jt||$t||sn||Yt)&&(De.beginPath(),De.moveTo(dt,pt),jt?De.lineTo(dt,Tt):De.moveTo(dt,Tt),sn?De.lineTo(Pt,Tt):De.moveTo(Pt,Tt),$t?De.lineTo(Pt,pt):De.moveTo(Pt,pt),Yt?De.lineTo(dt,pt):De.moveTo(dt,pt),De.stroke()))}function re(pe){function Se(Pe,he,be,Ae,De,Ie){for(var ke=Pe.points,dt=Pe.pointsize,Pt=0;Pt<ke.length;Pt+=dt)ke[Pt]!=null&&xe(ke[Pt],ke[Pt+1],ke[Pt+2],he,be,Ae,De,Ie,u,pe.bars.horizontal,pe.bars.lineWidth)}u.save(),u.translate(f.left,f.top),u.lineWidth=pe.bars.lineWidth,u.strokeStyle=pe.color;var fe;switch(pe.bars.align){case"left":fe=0;break;case"right":fe=-pe.bars.barWidth;break;default:fe=-pe.bars.barWidth/2}var Ee=pe.bars.fill?function(Pe,he){return ue(pe.bars,pe.color,Pe,he)}:null;Se(pe.datapoints,fe,fe+pe.bars.barWidth,Ee,pe.xaxis,pe.yaxis),u.restore()}function ue(pe,Se,fe,Ee){var Pe=pe.fill;if(!Pe)return null;if(pe.fillColor)return ze(pe.fillColor,fe,Ee,Se);var he=k.color.parse(Se);return he.a=typeof Pe=="number"?Pe:.4,he.normalize(),he.toString()}function Te(){if(d.legend.container!=null?k.find(d.legend.container).html(""):l.find(".legend").remove(),!!d.legend.show){for(var pe=[],Se=[],fe=!1,Ee=d.legend.labelFormatter,Pe,he,be=0;be<o.length;++be)Pe=o[be],Pe.label&&(he=Ee?Ee(Pe.label,Pe):Pe.label,he&&Se.push({label:he,color:Pe.color}));if(d.legend.sorted)if(k.isFunction(d.legend.sorted))Se.sort(d.legend.sorted);else if(d.legend.sorted=="reverse")Se.reverse();else{var Ae=d.legend.sorted!="descending";Se.sort(function($t,sn){return $t.label==sn.label?0:$t.label<sn.label!=Ae?1:-1})}for(var be=0;be<Se.length;++be){var De=Se[be];be%d.legend.noColumns==0&&(fe&&pe.push("</tr>"),pe.push("<tr>"),fe=!0),pe.push('<td class="legendColorBox"><div style="border:1px solid '+d.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+De.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+De.label+"</td>")}if(fe&&pe.push("</tr>"),pe.length!=0){var Ie='<table style="font-size:smaller;color:'+d.grid.color+'">'+pe.join("")+"</table>";if(d.legend.container!=null)k(d.legend.container).html(Ie);else{var ke="",dt=d.legend.position,Pt=d.legend.margin;Pt[0]==null&&(Pt=[Pt,Pt]),dt.charAt(0)=="n"?ke+="top:"+(Pt[1]+f.top)+"px;":dt.charAt(0)=="s"&&(ke+="bottom:"+(Pt[1]+f.bottom)+"px;"),dt.charAt(1)=="e"?ke+="right:"+(Pt[0]+f.right)+"px;":dt.charAt(1)=="w"&&(ke+="left:"+(Pt[0]+f.left)+"px;");var pt=k('<div class="legend">'+Ie.replace('style="','style="position:absolute;'+ke+";")+"</div>").appendTo(l);if(d.legend.backgroundOpacity!=0){var Tt=d.legend.backgroundColor;Tt==null&&(Tt=d.grid.backgroundColor,Tt&&typeof Tt=="string"?Tt=k.color.parse(Tt):Tt=k.color.extract(pt,"background-color"),Tt.a=1,Tt=Tt.toString());var jt=pt.children();k('<div style="position:absolute;width:'+jt.width()+"px;height:"+jt.height()+"px;"+ke+"background-color:"+Tt+';"> </div>').prependTo(pt).css("opacity",d.legend.backgroundOpacity)}}}}}var ge=[],Oe=null;function Ue(pe,Se,fe){var Ee=d.grid.mouseActiveRadius,Pe=Ee*Ee+1,he=null,be=!1,Ae,De,Ie;for(Ae=o.length-1;Ae>=0;--Ae)if(fe(o[Ae])){var ke=o[Ae],dt=ke.xaxis,Pt=ke.yaxis,pt=ke.datapoints.points,Tt=dt.c2p(pe),jt=Pt.c2p(Se),$t=Ee/dt.scale,sn=Ee/Pt.scale;if(Ie=ke.datapoints.pointsize,dt.options.inverseTransform&&($t=Number.MAX_VALUE),Pt.options.inverseTransform&&(sn=Number.MAX_VALUE),ke.lines.show||ke.points.show)for(De=0;De<pt.length;De+=Ie){var Yt=pt[De],qt=pt[De+1];if(Yt!=null&&!(Yt-Tt>$t||Yt-Tt<-$t||qt-jt>sn||qt-jt<-sn)){var bn=Math.abs(dt.p2c(Yt)-pe),Mt=Math.abs(Pt.p2c(qt)-Se),Jt=bn*bn+Mt*Mt;Jt<Pe&&(Pe=Jt,he=[Ae,De/Ie])}}if(ke.bars.show&&!he){var Ut,Gt;switch(ke.bars.align){case"left":Ut=0;break;case"right":Ut=-ke.bars.barWidth;break;default:Ut=-ke.bars.barWidth/2}for(Gt=Ut+ke.bars.barWidth,De=0;De<pt.length;De+=Ie){var Yt=pt[De],qt=pt[De+1],Lt=pt[De+2];Yt!=null&&(o[Ae].bars.horizontal?Tt<=Math.max(Lt,Yt)&&Tt>=Math.min(Lt,Yt)&&jt>=qt+Ut&&jt<=qt+Gt:Tt>=Yt+Ut&&Tt<=Yt+Gt&&jt>=Math.min(Lt,qt)&&jt<=Math.max(Lt,qt))&&(he=[Ae,De/Ie])}}}return he?(Ae=he[0],De=he[1],Ie=o[Ae].datapoints.pointsize,{datapoint:o[Ae].datapoints.points.slice(De*Ie,(De+1)*Ie),dataIndex:De,series:o[Ae],seriesIndex:Ae}):null}function Xe(pe){d.grid.hoverable&&je("plothover",pe,function(Se){return Se.hoverable!=!1})}function we(pe){d.grid.hoverable&&je("plothover",pe,function(Se){return!1})}function qe(pe){b.isSelecting||je("plotclick",pe,function(Se){return Se.clickable!=!1})}function We(pe){if(pe.cancelable){if(!p.is(pe.target)&&p.has(pe.target).length===0){je("plotleave",pe,function(Se){});return}Xe(Ce(pe)),pe.preventDefault()}}function Ce(pe){if(!pe||!pe.originalEvent||pe.pageX&&pe.pageY)return pe;var Se=pe.originalEvent;if(Se.changedTouches.length===0)return pe;var fe=Se.changedTouches[0];return pe.pageX=fe.pageX,pe.pageY=fe.pageY,pe}function je(pe,Se,fe){var Ee=p.offset(),Pe=Se.pageX-Ee.left-f.left,he=Se.pageY-Ee.top-f.top,be=S({left:Pe,top:he});be.pageX=Se.pageX,be.pageY=Se.pageY,be.ctrlKey=Se.ctrlKey,be.metaKey=Se.metaKey;var Ae=Ue(Pe,he,fe);if(Ae&&(Ae.pageX=parseInt(Ae.series.xaxis.p2c(Ae.datapoint[0])+Ee.left+f.left,10),Ae.pageY=parseInt(Ae.series.yaxis.p2c(Ae.datapoint[1])+Ee.top+f.top,10)),d.grid.autoHighlight){for(var De=0;De<ge.length;++De){var Ie=ge[De];Ie.auto==pe&&!(Ae&&Ie.series==Ae.series&&Ie.point[0]==Ae.datapoint[0]&&Ie.point[1]==Ae.datapoint[1])&&at(Ie.series,Ie.point)}Ae&&Fe(Ae.series,Ae.datapoint,pe)}l.trigger(pe,[be,Ae])}function Ke(){var pe=d.interaction.redrawOverlayInterval;if(pe==-1){_e();return}Oe||(Oe=setTimeout(_e,pe))}function _e(){Oe=null,m.save(),a.clear(),m.translate(f.left,f.top);var pe,Se;for(pe=0;pe<ge.length;++pe)Se=ge[pe],Se.series.bars.show?tt(Se.series,Se.point):Dt(Se.series,Se.point);m.restore(),D(y.drawOverlay,[m])}function Fe(pe,Se,fe){if(typeof pe=="number"&&(pe=o[pe]),typeof Se=="number"){var Ee=pe.datapoints.pointsize;Se=pe.datapoints.points.slice(Ee*Se,Ee*(Se+1))}var Pe=Ct(pe,Se);Pe==-1?(ge.push({series:pe,point:Se,auto:fe}),Ke()):fe||(ge[Pe].auto=!1)}function at(pe,Se){if(pe==null&&Se==null){ge=[],Ke();return}if(typeof pe=="number"&&(pe=o[pe]),typeof Se=="number"){var fe=pe.datapoints.pointsize;Se=pe.datapoints.points.slice(fe*Se,fe*(Se+1))}var Ee=Ct(pe,Se);Ee!=-1&&(ge.splice(Ee,1),Ke())}function Ct(pe,Se){for(var fe=0;fe<ge.length;++fe){var Ee=ge[fe];if(Ee.series==pe&&Ee.point[0]==Se[0]&&Ee.point[1]==Se[1])return fe}return-1}function Dt(pe,Se){var fe=Se[0],Ee=Se[1],Pe=pe.xaxis,he=pe.yaxis,be=typeof pe.highlightColor=="string"?pe.highlightColor:k.color.parse(pe.color).scale("a",.5).toString();if(!(fe<Pe.min||fe>Pe.max||Ee<he.min||Ee>he.max)){var Ae=pe.points.radius+pe.points.lineWidth/2;m.lineWidth=Ae,m.strokeStyle=be;var De=1.5*Ae;fe=Pe.p2c(fe),Ee=he.p2c(Ee),m.beginPath(),pe.points.symbol=="circle"?m.arc(fe,Ee,De,0,2*Math.PI,!1):pe.points.symbol(m,fe,Ee,De,!1),m.closePath(),m.stroke()}}function tt(pe,Se){var fe=typeof pe.highlightColor=="string"?pe.highlightColor:k.color.parse(pe.color).scale("a",.5).toString(),Ee=fe,Pe;switch(pe.bars.align){case"left":Pe=0;break;case"right":Pe=-pe.bars.barWidth;break;default:Pe=-pe.bars.barWidth/2}m.lineWidth=pe.bars.lineWidth,m.strokeStyle=fe,xe(Se[0],Se[1],Se[2]||0,Pe,Pe+pe.bars.barWidth,function(){return Ee},pe.xaxis,pe.yaxis,m,pe.bars.horizontal,pe.bars.lineWidth)}function ze(pe,Se,fe,Ee){if(typeof pe=="string")return pe;for(var Pe=u.createLinearGradient(0,fe,0,Se),he=0,be=pe.colors.length;he<be;++he){var Ae=pe.colors[he];if(typeof Ae!="string"){var De=k.color.parse(Ee);Ae.brightness!=null&&(De=De.scale("rgb",Ae.brightness)),Ae.opacity!=null&&(De.a*=Ae.opacity),Ae=De.toString()}Pe.addColorStop(he/(be-1),Ae)}return Pe}}k.plot=function(l,r,i){var g=new n(k(l),r,i,k.plot.plugins);return g},k.plot.version="0.8.3",k.plot.plugins=[],k.fn.plot=function(l,r){return this.each(function(){k.plot(this,l,r)})};function s(l,r){return r*Math.floor(l/r)}}(jQuery)},80851:()=>{(function(k){function A(e){var n={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},s={},l=null;function r(f){n.active&&(p(f),e.getPlaceholder().trigger("plotselecting",[o()]))}function i(f){f.which==1&&(document.body.focus(),document.onselectstart!==void 0&&s.onselectstart==null&&(s.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&s.ondrag==null&&(s.ondrag=document.ondrag,document.ondrag=function(){return!1}),a(n.first,f),n.active=!0,l=function(E){g(E)},k(document).one("mouseup",l))}function g(f){return l=null,document.onselectstart!==void 0&&(document.onselectstart=s.onselectstart),document.ondrag!==void 0&&(document.ondrag=s.ondrag),n.active=!1,p(f),x()?d(f):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function o(){if(!x()||!n.show)return null;var f={},E=n.first,h=n.second,y=e.getAxes(),b=!0;return k.each(y,function(D,P){P.used&&(anyUsed=!1)}),k.each(y,function(D,P){if(P.used||b){var C=P.c2p(E[P.direction]),M=P.c2p(h[P.direction]);f[D]={from:Math.min(C,M),to:Math.max(C,M)}}}),f}function d(f){var E=o();E.ctrlKey=f.ctrlKey,E.metaKey=f.metaKey,e.getPlaceholder().trigger("plotselected",[E]),E.xaxis&&E.yaxis&&e.getPlaceholder().trigger("selected",[{x1:E.xaxis.from,y1:E.yaxis.from,x2:E.xaxis.to,y2:E.yaxis.to}])}function c(f,E,h){return E<f?f:E>h?h:E}function a(f,E){var h=e.getOptions(),y=e.getPlaceholder().offset(),b=e.getPlotOffset();f.x=c(0,E.pageX-y.left-b.left,e.width()),f.y=c(0,E.pageY-y.top-b.top,e.height()),h.selection.mode=="y"&&(f.x=f==n.first?0:e.width()),h.selection.mode=="x"&&(f.y=f==n.first?0:e.height())}function p(f){f.pageX!=null&&(a(n.second,f),x()?(e.isSelecting=!0,n.show=!0,e.triggerRedrawOverlay()):u(!0))}function u(f){n.show&&(n.show=!1,e.triggerRedrawOverlay(),f||e.getPlaceholder().trigger("plotunselected",[]))}function m(f,E){var h,y,b,D,P=e.getAxes();for(var C in P)if(h=P[C],h.direction==E&&(D=E+h.n+"axis",!f[D]&&h.n==1&&(D=E+"axis"),f[D])){y=f[D].from,b=f[D].to;break}if(f[D]||(h=E=="x"?e.getXAxes()[0]:e.getYAxes()[0],y=f[E+"1"],b=f[E+"2"]),y!=null&&b!=null&&y>b){var M=y;y=b,b=M}return{from:y,to:b,axis:h}}function v(f,E){var h,y,b=e.getOptions();b.selection.mode=="y"?(n.first.x=0,n.second.x=e.width()):(y=m(f,"x"),n.first.x=y.axis.p2c(y.from),n.second.x=y.axis.p2c(y.to)),b.selection.mode=="x"?(n.first.y=0,n.second.y=e.height()):(y=m(f,"y"),n.first.y=y.axis.p2c(y.from),n.second.y=y.axis.p2c(y.to)),n.show=!0,e.triggerRedrawOverlay(),!E&&x()&&d()}function x(){var f=e.getOptions().selection.minSize;return Math.abs(n.second.x-n.first.x)>=f&&Math.abs(n.second.y-n.first.y)>=f}e.clearSelection=u,e.setSelection=v,e.getSelection=o,e.hooks.bindEvents.push(function(f,E){var h=f.getOptions();h.selection.mode!=null&&(E.mousemove(r),E.mousedown(i))}),e.hooks.drawOverlay.push(function(f,E){if(n.show&&x()){var h=f.getPlotOffset(),y=f.getOptions();E.save(),E.translate(h.left,h.top);var b=k.color.parse(y.selection.color);E.strokeStyle=b.scale("a",.8).toString(),E.lineWidth=1,E.lineJoin=y.selection.shape,E.fillStyle=b.scale("a",.4).toString();var D=Math.min(n.first.x,n.second.x)+.5,P=Math.min(n.first.y,n.second.y)+.5,C=Math.abs(n.second.x-n.first.x)-1,M=Math.abs(n.second.y-n.first.y)-1;E.fillRect(D,P,C,M),E.strokeRect(D,P,C,M),E.restore()}}),e.hooks.shutdown.push(function(f,E){E.unbind("mousemove",r),E.unbind("mousedown",i),l&&(k(document).unbind("mouseup",l),document.onselectstart!==void 0&&(document.onselectstart=s.onselectstart),document.ondrag!==void 0&&(document.ondrag=s.ondrag))})}k.plot.plugins.push({init:A,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(k){var A={series:{stack:null}};function e(n){function s(r,i){for(var g=null,o=0;o<i.length&&r!=i[o];++o)i[o].stack==r.stack&&(g=i[o]);return g}function l(r,i,g){if(!(i.stack==null||i.stack===!1)){var o=s(i,r.getData());if(o){for(var d=g.pointsize,c=g.points,a=o.datapoints.pointsize,p=o.datapoints.points,u=[],m,v,x,f,E,h,y=i.lines.show,b=i.bars.horizontal,D=d>2&&(b?g.format[2].x:g.format[2].y),P=y&&i.lines.steps,C=b?1:0,M=b?0:1,I=0,R=0,T,S;!(I>=c.length&&R>=p.length);){if(T=u.length,I<c.length&&c[I]==null){for(S=0;S<d;++S)u.push(c[I+S]);I+=d}else if(I>=c.length){for(S=0;S<d;++S)u.push(p[R+S]);D&&(u[T+2]=p[R+M]),R+=a}else if(R>=p.length){for(S=0;S<d;++S)u.push(c[I+S]);I+=d}else if(R<p.length&&p[R]==null)R+=a;else{if(m=c[I+C],v=c[I+M],f=p[R+C],E=p[R+M],h=0,m==f){for(S=0;S<d;++S)u.push(c[I+S]);u[T+M]+=E,h=E,I+=d,R+=a}else if(m>f){if(I==0){for(S=0;S<d;++S)u.push(p[R+S]);h=E}if(I>0&&c[I-d]!=null){for(x=0,u.push(f),u.push(x+E),S=2;S<d;++S)u.push(c[I+S]);h=E}R+=a}else{for(S=0;S<d;++S)u.push(c[I+S]);R>0&&p[R-a]!=null&&(h=0),u[T+M]+=h,I+=d}fromgap=!1,T!=u.length&&D&&(u[T+2]=h)}if(P&&T!=u.length&&T>0&&u[T]!=null&&u[T]!=u[T-d]&&u[T+1]!=u[T-d+1]){for(S=0;S<d;++S)u[T+d+S]=u[T+S];u[T+1]=u[T-d+1]}}g.points=u}}}n.hooks.processDatapoints.push(l)}k.plot.plugins.push({init:e,options:A,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(k){var A={series:{stackpercent:null}};function e(n){var s={},l=!1,r={};function i(d,c,a,p){if(l||(l=!0,r=g(d.getData())),c.stackpercent==!0){var u=a.length;c.percents=[];var m=0,v=1;c.bars&&c.bars.horizontal&&c.bars.horizontal===!0&&(m=1,v=0);for(var x=0;x<u;x++){var f=r[a[x][m]+""];f>0?c.percents.push(a[x][v]*100/f):c.percents.push(0)}}}function g(d){var c=d.length,a={};if(c>0){for(var p=0;p<c;p++)if(d[p].stackpercent){var u=0,m=1;d[p].bars&&d[p].bars.horizontal&&d[p].bars.horizontal===!0&&(u=1,m=0);for(var v=d[p].data.length,x=0;x<v;x++){var f=0;d[p].data[x][1]!=null&&(f=d[p].data[x][m]),a[d[p].data[x][u]+""]?a[d[p].data[x][u]+""]+=f:a[d[p].data[x][u]+""]=f}}}return a}function o(d,c,a){if(c.stackpercent){l||(r=g(d.getData()));var p=[],u=0,m=1;c.bars&&c.bars.horizontal&&c.bars.horizontal===!0&&(u=1,m=0);for(var v=0;v<a.points.length;v+=3)s[a.points[v+u]]||(s[a.points[v+u]]=0),p[v+u]=a.points[v+u],p[v+m]=a.points[v+m]+s[a.points[v+u]],p[v+2]=s[a.points[v+u]],s[a.points[v+u]]+=a.points[v+m],r[p[v+u]+""]>0?(p[v+m]=p[v+m]*100/r[p[v+u]+""],p[v+2]=p[v+2]*100/r[p[v+u]+""]):(p[v+m]=0,p[v+2]=0);a.points=p}}n.hooks.processRawData.push(i),n.hooks.processDatapoints.push(o)}k.plot.plugins.push({init:e,options:A,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(k){var A={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(c,a){return a*Math.floor(c/a)}function n(c,a,p,u){if(typeof c.strftime=="function")return c.strftime(a);var m=function(D,P){return D=""+D,P=""+(P??"0"),D.length==1?P+D:D},v=[],x=!1,f=c.getHours(),E=f<12;p==null&&(p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),u==null&&(u=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var h;f>12?h=f-12:f==0?h=12:h=f;for(var y=0;y<a.length;++y){var b=a.charAt(y);if(x){switch(b){case"a":b=""+u[c.getDay()];break;case"b":b=""+p[c.getMonth()];break;case"d":b=m(c.getDate(),"");break;case"e":b=m(c.getDate()," ");break;case"h":case"H":b=m(f);break;case"I":b=m(h);break;case"l":b=m(h," ");break;case"m":b=m(c.getMonth()+1,"");break;case"M":b=m(c.getMinutes());break;case"q":b=""+(Math.floor(c.getMonth()/3)+1);break;case"S":b=m(c.getSeconds());break;case"y":b=m(c.getFullYear()%100);break;case"Y":b=""+c.getFullYear();break;case"p":b=E?"am":"pm";break;case"P":b=E?"AM":"PM";break;case"w":b=""+c.getDay();break}v.push(b),x=!1}else b=="%"?x=!0:v.push(b)}return v.join("")}function s(c){function a(v,x,f,E){v[x]=function(){return f[E].apply(f,arguments)}}var p={date:c};c.strftime!=null&&a(p,"strftime",c,"strftime"),a(p,"getTime",c,"getTime"),a(p,"setTime",c,"setTime");for(var u=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],m=0;m<u.length;m++)a(p,"get"+u[m],c,"getUTC"+u[m]),a(p,"set"+u[m],c,"setUTC"+u[m]);return p}function l(c,a){if(a.timezone=="browser")return new Date(c);if(!a.timezone||a.timezone=="utc")return s(new Date(c));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var p=new timezoneJS.Date;return p.setTimezone(a.timezone),p.setTime(c),p}else return s(new Date(c))}var r={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},i=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],g=i.concat([[3,"month"],[6,"month"],[1,"year"]]),o=i.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function d(c){c.hooks.processOptions.push(function(a,p){k.each(a.getAxes(),function(u,m){var v=m.options;v.mode=="time"&&(m.tickGenerator=function(x){var f=[],E=l(x.min,v),h=0,y=v.tickSize&&v.tickSize[1]==="quarter"||v.minTickSize&&v.minTickSize[1]==="quarter"?o:g;v.minTickSize!=null&&(typeof v.tickSize=="number"?h=v.tickSize:h=v.minTickSize[0]*r[v.minTickSize[1]]);for(var b=0;b<y.length-1&&!(x.delta<(y[b][0]*r[y[b][1]]+y[b+1][0]*r[y[b+1][1]])/2&&y[b][0]*r[y[b][1]]>=h);++b);var D=y[b][0],P=y[b][1];if(P=="year"){if(v.minTickSize!=null&&v.minTickSize[1]=="year")D=Math.floor(v.minTickSize[0]);else{var C=Math.pow(10,Math.floor(Math.log(x.delta/r.year)/Math.LN10)),M=x.delta/r.year/C;M<1.5?D=1:M<3?D=2:M<7.5?D=5:D=10,D*=C}D<1&&(D=1)}x.tickSize=v.tickSize||[D,P];var I=x.tickSize[0];P=x.tickSize[1];var R=I*r[P];P=="second"?E.setSeconds(e(E.getSeconds(),I)):P=="minute"?E.setMinutes(e(E.getMinutes(),I)):P=="hour"?E.setHours(e(E.getHours(),I)):P=="month"?E.setMonth(e(E.getMonth(),I)):P=="quarter"?E.setMonth(3*e(E.getMonth()/3,I)):P=="year"&&E.setFullYear(e(E.getFullYear(),I)),E.setMilliseconds(0),R>=r.minute&&E.setSeconds(0),R>=r.hour&&E.setMinutes(0),R>=r.day&&E.setHours(0),R>=r.day*4&&E.setDate(1),R>=r.month*2&&E.setMonth(e(E.getMonth(),3)),R>=r.quarter*2&&E.setMonth(e(E.getMonth(),6)),R>=r.year&&E.setMonth(0);var T=0,S=Number.NaN,L;do if(L=S,S=E.getTime(),f.push(S),P=="month"||P=="quarter")if(I<1){E.setDate(1);var O=E.getTime();E.setMonth(E.getMonth()+(P=="quarter"?3:1));var j=E.getTime();E.setTime(S+T*r.hour+(j-O)*I),T=E.getHours(),E.setHours(0)}else E.setMonth(E.getMonth()+I*(P=="quarter"?3:1));else P=="year"?E.setFullYear(E.getFullYear()+I):E.setTime(S+R);while(S<x.max&&S!=L);return f},m.tickFormatter=function(x,f){var E=l(x,f.options);if(v.timeformat!=null)return n(E,v.timeformat,v.monthNames,v.dayNames);var h=f.options.tickSize&&f.options.tickSize[1]=="quarter"||f.options.minTickSize&&f.options.minTickSize[1]=="quarter",y=f.tickSize[0]*r[f.tickSize[1]],b=f.max-f.min,D=v.twelveHourClock?" %p":"",P=v.twelveHourClock?"%I":"%H",C;y<r.minute?C=P+":%M:%S"+D:y<r.day?b<2*r.day?C=P+":%M"+D:C="%b %d "+P+":%M"+D:y<r.month?C="%b %d":h&&y<r.quarter||!h&&y<r.year?b<r.year?C="%b":C="%b %Y":h&&y<r.year?b<r.year?C="Q%q":C="Q%q %Y":C="%Y";var M=n(E,C,v.monthNames,v.dayNames);return M})})})}k.plot.plugins.push({init:d,options:A,name:"time",version:"1.0"}),k.plot.formatDate=n})(jQuery)}}]);

//# sourceMappingURL=1359.3d5c5ba434156970bfbf.js.map