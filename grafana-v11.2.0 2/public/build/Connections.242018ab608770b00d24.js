"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2154],{72557:(_,M,a)=>{a.d(M,{A:()=>i});var e=a(74848),h=a(96540),u=a(14186),g=a(67647),p=a(55852),j=a(73725);class i extends h.PureComponent{render(){const{searchQuery:N,linkButton:x,setSearchQuery:K,target:B,placeholder:E="Search by name or type",sortPicker:w}=this.props,b={href:x?.href,disabled:x?.disabled};return B&&(b.target=B),(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(u.I,{grow:!0,children:(0,e.jsx)(g.Z,{value:N,onChange:K,placeholder:E})}),w&&(0,e.jsx)(j.r,{onChange:w.onChange,value:w.value,getSortOptions:w.getSortOptions}),x&&(0,e.jsx)(p.z9,{...b,children:x.title})]})}}},34362:(_,M,a)=>{a.r(M),a.d(M,{default:()=>Xs});var e=a(74848),h=a(24180),u=a(85464),g=a(31678),p=a(6320),j=a(69444),i=a(32196),D=a(96540),N=a(43429),x=a(40845),K=a(39558),B=a(69529),E=a(10096),w=a(83277),b=a(8484),ve=a(31036),Y=a(83391),je=a(71259),m=a(10860),Se=a(50691);const ye=s=>({heading:(0,i.css)({fontSize:s.typography.h5.fontSize,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:s.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:s.typography.bodySmall.fontSize}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:s.spacing(3),marginLeft:s.spacing(1),width:s.spacing(7),maxHeight:s.spacing(7)})}),De=({items:s,onClickItem:n})=>{const t=(0,x.of)(ye);return(0,e.jsx)(je.x,{gap:1.5,minColumnWidth:44,children:s.map(o=>(0,e.jsxs)(m.Z,{className:t.card,href:o.url,onClick:r=>{n&&n(r,o)},children:[(0,e.jsx)(m.Z.Heading,{className:t.heading,children:o.name}),(0,e.jsx)(m.Z.Figure,{align:"center",className:t.figure,children:(0,e.jsx)("img",{className:t.logo,src:o.logo,alt:""})}),o.angularDetected?(0,e.jsx)(m.Z.Meta,{className:t.meta,children:(0,e.jsx)(Se.fk,{})}):null]},o.id))})};var W=a(14578);const Ce=s=>({categoryHeader:(0,i.css)`
    align-items: center;
    display: flex;
    margin-bottom: 24px;
  `,categoryLabel:(0,i.css)`
    margin-bottom: 0px;
    margin-left: 8px;
  `}),Ne=({iconName:s,label:n})=>{const t=(0,x.of)(Ce);return(0,e.jsxs)("div",{className:t.categoryHeader,children:[(0,e.jsx)(W.I,{name:s,size:"xl"}),(0,e.jsx)("h3",{className:t.categoryLabel,children:n})]})};var be=a(37390),f=a(55852);const ee=s=>({modal:(0,i.css)`
    width: 500px;
  `,modalContent:(0,i.css)`
    overflow: visible;
    color: ${s.colors.text.secondary};

    a {
      color: ${s.colors.text.link};
    }
  `,description:(0,i.css)`
    margin-bottom: ${s.spacing(2)};
  `,bottomSection:(0,i.css)`
    display: flex;
    border-top: 1px solid ${s.colors.border.weak};
    padding-top: ${s.spacing(3)};
    margin-top: ${s.spacing(3)};
  `,actionsSection:(0,i.css)`
    display: flex;
    justify-content: end;
    margin-top: ${s.spacing(3)};
  `,warningIcon:(0,i.css)`
    color: ${s.colors.warning.main};
    padding-right: ${s.spacing()};
    margin-top: ${s.spacing(.25)};
  `,header:(0,i.css)`
    display: flex;
    align-items: center;
  `,headerTitle:(0,i.css)`
    margin: 0;
  `,headerLogo:(0,i.css)`
    margin-right: ${s.spacing(2)};
    width: 32px;
    height: 32px;
  `});function Ae({item:s,isOpen:n,onDismiss:t}){const o=(0,x.of)(ee);return(0,e.jsx)(be.a,{className:o.modal,contentClassName:o.modalContent,title:(0,e.jsx)(Pe,{item:s}),isOpen:n,onDismiss:t,children:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:[s.description&&(0,e.jsx)("div",{className:o.description,children:s.description}),(0,e.jsxs)("div",{children:["Links",(0,e.jsx)("br",{}),(0,e.jsx)("a",{href:`https://grafana.com/grafana/plugins/${s.id}`,title:`${s.name} on Grafana.com`,target:"_blank",rel:"noopener noreferrer",children:s.name})]})]}),(0,e.jsxs)("div",{className:o.bottomSection,children:[(0,e.jsx)("div",{className:o.warningIcon,children:(0,e.jsx)(W.I,{name:"exclamation-triangle"})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("p",{children:["Editors cannot add new connections. You may check to see if it is already configured in"," ",(0,e.jsx)("a",{href:"/connections/datasources",children:"Data sources"}),"."]}),(0,e.jsx)("p",{children:"To add a new connection, contact your Grafana admin."})]})]}),(0,e.jsx)("div",{className:o.actionsSection,children:(0,e.jsx)(f.$n,{onClick:t,children:"Okay"})})]})})}function Pe({item:s}){const n=(0,x.of)(ee);return(0,e.jsx)("div",{children:(0,e.jsxs)("div",{className:n.header,children:[s.logo&&(0,e.jsx)("img",{className:n.headerLogo,src:s.logo,alt:`logo of ${s.name}`}),(0,e.jsx)("h4",{className:n.headerTitle,children:s.name})]})})}var Ee=a(23172),T=a(32264),se=a(10354);const Te=(s,n)=>({searchContainer:(0,i.css)({display:"flex",justifyContent:"space-between",position:"sticky",top:n,backgroundColor:s.colors.background.primary,zIndex:2,padding:s.spacing(2,0)})}),Ie=(0,b.t)("connections.search.placeholder","Search all"),Le=({onChange:s,value:n})=>{const t=(0,Ee.k)(),o=(0,x.of)(Te,T.$.featureToggles.bodyScrolling?t??0:0);return(0,e.jsx)("div",{className:o.searchContainer,children:(0,e.jsx)(se.p,{value:n,onChange:s,prefix:(0,e.jsx)(W.I,{name:"search"}),placeholder:Ie,"aria-label":"Search all"})})},Me=s=>({spacer:(0,i.css)({height:s.spacing(2)}),modal:(0,i.css)({width:"500px"}),modalContent:(0,i.css)({overflow:"visible"})});function Be(){const[s,n]=(0,w.s)(),t=s.search?String(s.search):"",[o,r]=(0,D.useState)(!1),[l,c]=(0,D.useState)(null),d=(0,x.of)(Me),C=E.contextSrv.hasPermission(g.AccessControlAction.DataSourcesCreate),L=v=>{n({search:v.currentTarget.value.toLowerCase()})},{error:y,plugins:A,isLoading:I}=(0,Y.PW)({keyword:t,type:N.QE.datasource}),k=(0,D.useMemo)(()=>A.map(v=>({id:v.id,name:v.name,description:v.description,logo:v.info.logos.small,url:p.b.DataSourcesDetails.replace(":id",v.id),angularDetected:v.angularDetected})),[A]),P=(v,U)=>{C||(v.preventDefault(),v.stopPropagation(),X(U))},X=v=>{r(!0),c(v)},O=()=>{r(!1),c(null)},Z=(0,D.useMemo)(()=>!I&&!y&&A.length<1,[I,y,A]),q=(0,b.t)("connections.connect-data.category-header-label","Data sources");return(0,e.jsxs)(e.Fragment,{children:[l&&(0,e.jsx)(Ae,{item:l,isOpen:o,onDismiss:O}),(0,e.jsx)(Le,{onChange:L,value:t}),(0,e.jsx)("div",{className:d.spacer}),(0,e.jsx)(Ne,{iconName:"database",label:q}),I?(0,e.jsx)(K._,{text:"Loading..."}):y?(0,e.jsxs)("p",{children:["Error: ",y.message]}):(0,e.jsx)(De,{items:k,onClickItem:P}),Z&&(0,e.jsx)(B.p,{variant:"not-found",message:(0,b.t)("connections.connect-data.empty-message","No results matching your query were found")}),(0,e.jsx)(ve.E,{})]})}function we(){return(0,e.jsx)(j.Y,{navId:"connections-add-new-connection",children:(0,e.jsx)(j.Y.Contents,{children:(0,e.jsx)(Be,{})})})}var F=a(42418),ne=a(39938),Re=a(14253);function Oe(){const s="standalone-plugin-page-/connections/add-new-connection",{id:n}=(0,h.g)(),r=!!(0,g.useSelector)(l=>l.navIndex)[s]?s:"connections-add-new-connection";return(0,e.jsx)(Re.V,{pluginId:n,navId:r,notFoundComponent:(0,e.jsx)($e,{}),notFoundNavModel:{text:"Unknown datasource",subTitle:"No datasource with this ID could be found.",active:!0}})}function $e(){const{id:s}=(0,h.g)();return(0,e.jsxs)(F.F,{severity:g.AppNotificationSeverity.Warning,title:"",children:["Maybe you mistyped the URL or the plugin with the id ",(0,e.jsx)(ne.E,{text:s,color:"orange"})," is unavailable.",(0,e.jsx)("br",{}),"To see a list of available datasources please ",(0,e.jsx)("a",{href:p.b.AddNewConnection,children:"click here"}),"."]})}function Fe(){const s=E.contextSrv.hasPermission(g.AccessControlAction.DataSourcesCreate),n=(0,u.aM)();return s?(0,e.jsx)(f.z9,{icon:"plus",href:T.$.appSubUrl+n.New,children:(0,e.jsx)(b.x6,{i18nKey:"data-sources.datasource-add-button.label",children:"Add new data source"})}):null}var ze=a(72109),S=a(4589),z=a(70255),ke=a(78369),te=a(67061),ae=a(11959);function V({dataSource:s,hasWriteRights:n,hasExploreRights:t}){const o=(0,u.aM)(),r=T.$.appSubUrl+o.Edit.replace(/:uid/gi,s.uid),l=(0,x.of)(We);return(0,e.jsxs)(m.Z,{href:n?r:void 0,children:[(0,e.jsx)(m.Z.Heading,{children:s.name}),(0,e.jsx)(m.Z.Figure,{children:(0,e.jsx)("img",{src:s.typeLogoUrl,alt:"",height:"40px",width:"40px",className:l.logo})}),(0,e.jsx)(m.Z.Meta,{children:[s.typeName,s.url,s.isDefault&&(0,e.jsx)(ke.v,{name:"default",colorIndex:1},"default-tag")]}),(0,e.jsxs)(m.Z.Tags,{children:[(0,e.jsx)(f.z9,{icon:"apps",fill:"outline",variant:"secondary",href:`dashboard/new-with-ds/${s.uid}`,onClick:()=>{(0,S.TR)({grafana_version:T.$.buildInfo.version,datasource_uid:s.uid,plugin_name:s.typeName,path:location.pathname})},children:"Build a dashboard"}),t&&(0,e.jsx)(f.z9,{icon:"compass",fill:"outline",variant:"secondary",className:l.button,href:(0,ae.h)(s),onClick:()=>{(0,S.M1)({grafana_version:T.$.buildInfo.version,datasource_uid:s.uid,plugin_name:s.typeName,path:location.pathname})},children:"Explore"})]})]})}function Ze({hasExploreRights:s}){const n=(0,x.of)(Ue);return(0,e.jsxs)(m.Z,{children:[(0,e.jsx)(m.Z.Heading,{children:(0,e.jsx)(z.A,{width:140})}),(0,e.jsx)(m.Z.Figure,{children:(0,e.jsx)(z.A,{width:40,height:40,containerClassName:n.figure})}),(0,e.jsx)(m.Z.Meta,{children:(0,e.jsx)(z.A,{width:120})}),(0,e.jsx)(m.Z.Tags,{children:(0,e.jsxs)(te.B,{direction:"row",gap:2,children:[(0,e.jsx)(z.A,{height:32,width:179,containerClassName:n.button}),s&&(0,e.jsx)(z.A,{height:32,width:107,containerClassName:n.button})]})})]})}V.Skeleton=Ze;const Ue=()=>({button:(0,i.css)({lineHeight:1}),figure:(0,i.css)({lineHeight:1})}),We=s=>({logo:(0,i.css)({objectFit:"contain"}),button:(0,i.css)({marginLeft:s.spacing(2)})});var He=a(72557);const G="alpha-asc",oe="alpha-desc",Ke=[{label:"Sort by A\u2013Z",value:G},{label:"Sort by Z\u2013A",value:oe}];function Ye(){const s=(0,g.useDispatch)(),n=(0,D.useCallback)(c=>s((0,u.Bs)(c)),[s]),t=(0,g.useSelector)(({dataSources:c})=>(0,u.xs)(c)),o=(0,D.useCallback)(c=>s((0,u.Tk)(c.value===G)),[s]),r=(0,g.useSelector)(({dataSources:c})=>(0,u.lv)(c)),l={onChange:o,value:r?G:oe,getSortOptions:()=>Promise.resolve(Ke)};return(0,e.jsx)(He.A,{searchQuery:t,setSearchQuery:n,sortPicker:l},"action-bar")}function Ve(){const{isLoading:s}=(0,u.US)(),n=(0,g.useSelector)(c=>(0,u.zC)(c.dataSources)),t=(0,g.useSelector)(({dataSources:c})=>(0,u.wC)(c)),o=E.contextSrv.hasPermission(g.AccessControlAction.DataSourcesCreate),r=E.contextSrv.hasPermission(g.AccessControlAction.DataSourcesWrite),l=E.contextSrv.hasAccessToExplore();return(0,e.jsx)(Ge,{dataSources:n,dataSourcesCount:t,isLoading:s,hasCreateRights:o,hasWriteRights:r,hasExploreRights:l})}function Ge({dataSources:s,dataSourcesCount:n,isLoading:t,hasCreateRights:o,hasWriteRights:r,hasExploreRights:l}){const c=(0,x.of)(Qe),d=(0,u.aM)(),C=(0,h.zy)();if((0,D.useEffect)(()=>{(0,S.kg)({grafana_version:T.$.buildInfo.version,path:C.pathname})},[C]),!t&&n===0)return(0,e.jsx)(B.p,{variant:"call-to-action",button:(0,e.jsx)(f.z9,{disabled:!o,href:d.New,icon:"database",size:"lg",children:(0,e.jsx)(b.x6,{i18nKey:"data-source-list.empty-state.button-title",children:"Add data source"})}),message:(0,b.t)("data-source-list.empty-state.title","No data sources defined"),children:(0,e.jsxs)(b.x6,{i18nKey:"data-source-list.empty-state.pro-tip",children:["You can also define data sources through configuration files."," ",(0,e.jsx)(ze.Y,{external:!0,href:"http://docs.grafana.org/administration/provisioning/?utm_source=grafana_ds_list#data-sources",children:"Learn more"})]})});const L=()=>t?new Array(20).fill(null).map((y,A)=>(0,e.jsx)(V.Skeleton,{hasExploreRights:l},A)):s.map(y=>(0,e.jsx)("li",{children:(0,e.jsx)(V,{dataSource:y,hasWriteRights:r,hasExploreRights:l})},y.uid));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ye,{}),s.length===0&&!t?(0,e.jsx)(B.p,{variant:"not-found",message:(0,b.t)("data-sources.empty-state.message","No data sources found")}):(0,e.jsx)("ul",{className:c.list,children:L()})]})}const Qe=s=>({list:(0,i.css)({listStyle:"none",display:"grid"})});function Je(){const n=(0,g.useSelector)(({dataSources:t})=>(0,u.wC)(t))>0?(0,e.jsx)(Fe,{}):void 0;return(0,e.jsx)(j.Y,{navId:"connections-datasources",actions:n,children:(0,e.jsx)(j.Y.Contents,{children:(0,e.jsx)(Ve,{})})})}var Q=a(39419),re=a(3673),Xe=a(20701),qe=a(38348);function _e({uid:s}){(0,u.oU)(s);const n=(0,g.useDispatch)(),t=(0,g.useSelector)(d=>d.dataSources.dataSource),o=(0,g.useSelector)(d=>d.plugins.dashboards),r=(0,g.useSelector)(d=>d.plugins.isLoadingPluginDashboards);(0,D.useEffect)(()=>{t.id>0&&n((0,Xe.h9)())},[n,t.id]);const l=(d,C)=>{n((0,re.Q9)({pluginId:d.pluginId,path:d.path,overwrite:C,inputs:[{name:"*",type:"datasource",pluginId:t.type,value:t.name}]},d.title))},c=({uid:d})=>{n((0,re.TA)(d))};return(0,e.jsx)(es,{dashboards:o,isLoading:r,onImportDashboard:l,onRemoveDashboard:c})}const es=({isLoading:s,dashboards:n,onImportDashboard:t,onRemoveDashboard:o})=>s?(0,e.jsx)(Q.A,{}):(0,e.jsx)(qe.A,{dashboards:n,onImport:t,onRemove:o});var ie=a(31152);function ss(){const{uid:s}=(0,h.g)(),{navId:n,pageNav:t}=(0,ie.n)("dashboards");return(0,e.jsx)(j.Y,{navId:n,pageNav:t,children:(0,e.jsx)(j.Y.Contents,{children:(0,e.jsx)(_e,{uid:s})})})}var J=a(2543),ns=a(69129),ts=a(74135),ce=a(76287),as=a(19347),os=a(3197),rs=a(28138),R=a(13544),le=a(14186),is=a(15292);function cs({dataSourceName:s,isDefault:n,onDefaultChange:t,onNameChange:o,disabled:r}){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:"gf-form-group","aria-label":"Datasource settings page basic settings",children:(0,e.jsxs)("div",{className:"gf-form-inline",children:[(0,e.jsx)("div",{className:"gf-form max-width-30",children:(0,e.jsx)(le.I,{label:"Name",tooltip:`The name is used when you select the data source in panels. The default data source is
              'preselected in new panels.`,grow:!0,disabled:r,labelWidth:14,children:(0,e.jsx)(se.p,{id:"basic-settings-name",type:"text",value:s,placeholder:"Name",onChange:l=>o(l.currentTarget.value),required:!0,"data-testid":R.Tp.pages.DataSource.name})})}),(0,e.jsx)(le.I,{label:"Default",labelWidth:8,disabled:r,children:(0,e.jsx)(is.K,{id:"basic-settings-default",value:n,onChange:l=>{t(l.currentTarget.checked)}})})]})})})}function sn({enabled:s}){const n=useStyles2(ls);return jsx("div",{className:n.badge,children:s?jsx(Badge,{color:"green",icon:"check-circle",text:"Alerting supported"}):jsx(Badge,{color:"orange",icon:"exclamation-triangle",text:"Alerting not supported"})})}const ls=s=>({badge:css`
    margin-bottom: ${s.spacing(2)};
  `});function ds({canSave:s,canDelete:n,onDelete:t,onSubmit:o,onTest:r}){return(0,e.jsxs)("div",{className:"gf-form-button-row",children:[(0,e.jsx)(f.$n,{type:"button",variant:"destructive",disabled:!n,onClick:t,"data-testid":R.Tp.pages.DataSource.delete,children:"Delete"}),s&&(0,e.jsx)(f.$n,{type:"submit",variant:"primary",disabled:!s,onClick:o,"data-testid":R.Tp.pages.DataSource.saveAndTest,children:"Save & test"}),!s&&(0,e.jsx)(f.$n,{variant:"primary",onClick:r,children:"Test"})]})}var us=a(61268),gs=a(61680),hs=a(2913);const ps="datasources.settings.cloudInfoBox.isDismissed";function xs({dataSource:s}){let n="",t="";if(s.readOnly||(s.version??0)>2||hs.config.buildInfo.edition!==us.r.OpenSource)return null;switch(s.type){case"prometheus":n="Prometheus",t="Loki";break;case"loki":n="Loki",t="Prometheus";break;default:return null}return(0,e.jsx)(gs.b,{storageKey:ps,defaultValue:!1,children:(o,r)=>o?null:(0,e.jsxs)(F.F,{title:`Configure your ${n} data source below`,severity:"info",bottomSpacing:4,onRemove:()=>{r(!0)},children:["Or skip the effort and get ",n," (and ",t,") as fully-managed, scalable, and hosted data sources from Grafana Labs with the"," ",(0,e.jsx)("a",{className:"external-link",href:`https://grafana.com/signup/cloud/connect-account?src=grafana-oss&cnt=${s.type}-settings`,target:"_blank",rel:"noreferrer",title:"The free plan includes 10k active metrics and 50gb storage.",children:"free-forever Grafana Cloud plan"}),"."]})})}var de=a(87455);function ms({dataSourceRights:s,onDelete:n}){const{readOnly:t,hasDeleteRights:o}=s,r=!t&&o,l=()=>history.back();return(0,e.jsxs)(e.Fragment,{children:[t&&(0,e.jsx)(de.r,{}),(0,e.jsxs)("div",{className:"gf-form-button-row",children:[r&&(0,e.jsx)(f.$n,{type:"submit",variant:"destructive",onClick:n,children:"Delete"}),(0,e.jsx)(f.$n,{variant:"secondary",fill:"outline",type:"button",onClick:l,children:"Back"})]})]})}const fs="You are not allowed to modify this data source. Please contact your server admin to update this data source.";function vs(){return(0,e.jsx)(F.F,{severity:"info",title:"Missing rights",children:fs})}function js({plugin:s,pageId:n}){if(!s||!s.configPages)return null;const t=s.configPages.find(({id:o})=>o===n);return t?(0,e.jsx)(t.body,{plugin:s,query:{}}):(0,e.jsxs)("div",{children:["Page not found: ",t]})}var Ss=a(7376);class ys extends D.PureComponent{constructor(n){super(n),this.element=null,this.onModelChanged=t=>{this.props.onModelChange(t)},this.scopeProps={ctrl:{datasourceMeta:n.dataSourceMeta,current:(0,J.cloneDeep)(n.dataSource)},onModelChanged:this.onModelChanged},this.onModelChanged=this.onModelChanged.bind(this)}componentDidMount(){const{plugin:n}=this.props;if(this.element&&!n.components.ConfigEditor){const t=(0,Ss.E)(),o='<plugin-component type="datasource-config-ctrl" />';this.component=t.load(this.element,this.scopeProps,o)}}componentDidUpdate(n){const{plugin:t}=this.props;!t.components.ConfigEditor&&this.props.dataSource!==n.dataSource&&(this.scopeProps.ctrl.current=(0,J.cloneDeep)(this.props.dataSource),this.component?.digest())}componentWillUnmount(){this.component&&this.component.destroy()}render(){const{plugin:n,dataSource:t}=this.props;return n?(0,e.jsx)("div",{ref:o=>this.element=o,children:n.components.ConfigEditor&&(0,D.createElement)(n.components.ConfigEditor,{options:t,onOptionsChange:this.onModelChanged})}):null}}var Ds=a(10803);function Cs({state:s}){return(0,e.jsxs)("div",{className:"gf-form",children:[(0,e.jsx)("div",{className:"gf-form-label width-10",children:"Plugin state"}),(0,e.jsx)("div",{className:"gf-form-label gf-form-label--transparent",children:(0,e.jsx)(Ds.p,{state:s})})]})}var ue=a(50720);const Ns=(s,n)=>({content:(0,i.css)({color:s.colors.text.secondary,paddingTop:n?s.spacing(1):0,maxHeight:"50vh",overflowY:"auto"}),disabled:(0,i.css)({pointerEvents:"none",color:s.colors.text.secondary})}),ge=({title:s,exploreUrl:n,dataSourceId:t,onDashboardLinkClicked:o})=>{const r=(0,x.$j)(),c=Ns(r,!!s),d=E.contextSrv.hasAccessToExplore();return(0,e.jsxs)("div",{className:c.content,children:["Next, you can start to visualize data by"," ",(0,e.jsx)(ue.N,{"aria-label":"Create a dashboard",href:`/dashboard/new-with-ds/${t}`,className:"external-link",onClick:o,children:"building a dashboard"}),", or by querying data in the"," ",(0,e.jsx)(ue.N,{"aria-label":"Explore data",className:(0,i.cx)("external-link",{[`${c.disabled}`]:!d,"test-disabled":!d}),href:n,children:"Explore view"}),"."]})};ge.displayName="AlertSuccessMessage";const bs=new Set(["success","info","warning","error"]),As=s=>bs.has(s),Ps=s=>s.toLowerCase()==="ok"?"success":As(s)?s:"info";function Es({testingStatus:s,exploreUrl:n,dataSource:t}){const o=Ps(s?.status??"error"),r=s?.message,l=s?.details?.message,c=s?.details?.verboseMessage,d=()=>{(0,S.TR)({grafana_version:T.$.buildInfo.version,datasource_uid:t.uid,plugin_name:t.typeName,path:location.pathname})},C=(0,x.of)(Ts);return r?(0,e.jsx)("div",{className:(0,i.cx)("gf-form-group",C.container),children:(0,e.jsx)(F.F,{severity:o,title:r,"data-testid":R.Tp.pages.DataSource.alert,children:s?.details&&(0,e.jsxs)(e.Fragment,{children:[l,o==="success"?(0,e.jsx)(ge,{title:r,exploreUrl:n,dataSourceId:t.uid,onDashboardLinkClicked:d}):null,c?(0,e.jsx)("details",{style:{whiteSpace:"pre-wrap"},children:String(c)}):null]})})}):null}const Ts=s=>({container:(0,i.css)({paddingTop:s.spacing(3)})});function Is({uid:s,pageId:n}){(0,u.oU)(s);const t=(0,g.useDispatch)(),o=(0,u.xw)(s),r=(0,u.S4)(o.type),l=(0,u._e)(),c=(0,u.u1)(s),d=(0,u.Tn)(s),C=(0,u.$k)(),L=(0,u.BY)(s),y=(0,u.k9)(),A=P=>t((0,u.C_)(P)),I=P=>t((0,u.rb)(P)),k=P=>t((0,u.jz)(P));return(0,e.jsx)(Ls,{pageId:n,dataSource:o,dataSourceMeta:r,dataSourceSettings:l,dataSourceRights:c,exploreUrl:d,onDelete:C,onDefaultChange:A,onNameChange:I,onOptionsChange:k,onTest:L,onUpdate:y})}function Ls({pageId:s,dataSource:n,dataSourceMeta:t,dataSourceSettings:o,dataSourceRights:r,exploreUrl:l,onDelete:c,onDefaultChange:d,onNameChange:C,onOptionsChange:L,onTest:y,onUpdate:A}){const{plugin:I,loadError:k,testingStatus:P,loading:X}=o,{readOnly:O,hasWriteRights:Z,hasDeleteRights:q}=r,v=n.id>0,U=(0,as.l)()?.getInstanceSettings(n.uid),me=async $=>{$.preventDefault(),(0,S._i)("save_and_test");try{await A({...n}),(0,S.m3)({item:"success"}),rs.A.publish(new ns.wE)}catch{(0,S.m3)({item:"fail"});return}y()},qs=ts.S.DataSourceConfig,{extensions:fe}=(0,os.kr)({extensionPointId:qs}),_s=(0,D.useMemo)(()=>{const $=["grafana-pdc-app","grafana-auth-app"];return fe.filter(H=>$.includes(H.pluginId))},[fe]);return k?(0,e.jsx)(ms,{dataSourceRights:r,onDelete:()=>{(0,S._i)("delete"),c()}}):X?(0,e.jsx)(Q.A,{}):!v||!U?null:s?(0,e.jsx)(ce.p,{instanceSettings:U,children:(0,e.jsx)(js,{pageId:s,plugin:I})}):(0,e.jsxs)("form",{onSubmit:me,children:[!Z&&(0,e.jsx)(vs,{}),O&&(0,e.jsx)(de.r,{}),t.state&&(0,e.jsx)(Cs,{state:t.state}),(0,e.jsx)(xs,{dataSource:n}),(0,e.jsx)(cs,{dataSourceName:n.name,isDefault:n.isDefault,onDefaultChange:d,onNameChange:C,disabled:O||!Z}),I&&(0,e.jsx)(ce.p,{instanceSettings:U,children:(0,e.jsx)(ys,{plugin:I,dataSource:n,dataSourceMeta:t,onModelChange:L})}),_s.map($=>{const H=$.component;return(0,e.jsx)("div",{children:(0,e.jsx)(H,{context:{dataSource:(0,J.omit)(n,["secureJsonData"]),dataSourceMeta:t,testingStatus:P,setJsonData:en=>L({...n,jsonData:{...n.jsonData,...en}})}})},$.id)}),(0,e.jsx)(Es,{testingStatus:P,exploreUrl:l,dataSource:n}),(0,e.jsx)(ds,{onSubmit:me,onDelete:()=>{(0,S._i)("delete"),c()},onTest:()=>{(0,S._i)("test"),y()},canDelete:!O&&q,canSave:!O&&Z})]})}function Ms({uid:s}){const n=(0,u.xw)(s),t=E.contextSrv.hasAccessToExplore();return(0,e.jsxs)(e.Fragment,{children:[t&&(0,e.jsx)(f.z9,{variant:"secondary",size:"sm",href:(0,ae.h)(n),onClick:()=>{(0,S._i)("explore"),(0,S.M1)({grafana_version:T.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},children:"Explore data"}),(0,e.jsx)(f.z9,{size:"sm",variant:"secondary",href:`dashboard/new-with-ds/${n.uid}`,onClick:()=>{(0,S._i)("build_a_dashboard"),(0,S.TR)({grafana_version:T.$.buildInfo.version,datasource_uid:n.uid,plugin_name:n.typeName,path:location.pathname})},children:"Build a dashboard"})]})}const Bs=s=>{const n=[],t=s.alertingSupported;return n.push({label:"Type",value:s.dataSourcePluginName}),n.push({label:"Alerting",value:(0,e.jsx)(ne.E,{color:t?"green":"red",text:t?"Supported":"Not supported"})}),n};function ws({title:s}){const n=(0,x.of)(Rs);return(0,e.jsx)("div",{className:n.container,children:(0,e.jsx)("h1",{className:n.title,children:s})})}const Rs=s=>({container:(0,i.css)({marginBottom:s.spacing(2),h1:{display:"inline-block"}}),title:(0,i.css)({display:"inline-block",margin:"0 0 0 0",maxWidth:"40vw",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});function Os({uid:s,pageId:n}){const{navId:t,pageNav:o,dataSourceHeader:r}=(0,ie.n)(),l=Bs({dataSourcePluginName:o.dataSourcePluginName,alertingSupported:r.alertingSupported});return(0,e.jsx)(j.Y,{navId:t,pageNav:o,renderTitle:c=>(0,e.jsx)(ws,{title:c}),info:l,actions:(0,e.jsx)(Ms,{uid:s}),children:(0,e.jsx)(j.Y.Contents,{children:(0,e.jsx)(Is,{uid:s,pageId:n})})})}const $s=Os;function Fs(){const{uid:s}=(0,h.g)(),n=(0,h.zy)(),o=new URLSearchParams(n.search).get("page");return(0,e.jsx)($s,{uid:s,pageId:o})}var zs=a(67647),he=a(33552),pe=a(98624);function ks({filterByPluginType:s}){let n=(0,Y.F9)(s);const{isLoading:t}=(0,Y.m5)(),o=(0,x.of)(Us);return t||n.length===0?null:(0,e.jsxs)(F.F,{title:"Unsigned plugins were found during plugin initialization. Grafana Labs cannot guarantee the integrity of these plugins. We recommend only using signed plugins.","data-testid":R.Tp.pages.PluginsList.signatureErrorNotice,severity:"warning",children:[(0,e.jsx)("p",{children:"The following plugins are disabled and not shown in the list below:"}),(0,e.jsx)(he.B,{items:n,className:o.list,renderItem:r=>(0,e.jsx)("div",{className:o.wrapper,children:(0,e.jsxs)(te.B,{justifyContent:"flex-start",alignItems:"center",children:[(0,e.jsx)("strong",{children:r.pluginId}),(0,e.jsx)(pe.B,{status:Zs(r.errorCode),className:o.badge})]})})}),(0,e.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/plugins/plugin-signatures/",className:o.docsLink,target:"_blank",rel:"noreferrer",children:[(0,e.jsx)(W.I,{name:"book"})," Read more about plugin signing"]})]})}function Zs(s){switch(s){case N.ZK.invalidSignature:return N.Ac.invalid;case N.ZK.missingSignature:return N.Ac.missing;case N.ZK.modifiedSignature:return N.Ac.modified;default:return N.Ac.missing}}function Us(s){return{list:(0,i.css)({listStyleType:"circle"}),wrapper:(0,i.css)({marginTop:s.spacing(1)}),badge:(0,i.css)({marginTop:0}),docsLink:(0,i.css)({display:"inline-block",color:s.colors.text.link,marginTop:s.spacing(2)})}}function Ws({onClick:s,dataSourcePlugin:n}){const t=n.module==="phantom",o=!t&&!n.unlicensed,r=n.info?.links?.length>0?n.info.links[0]:null,l=r?.target??"_blank",c=(0,x.of)(Hs);return(0,e.jsxs)(m.Z,{className:(0,i.cx)(c.card,"card-parent"),onClick:o?s:()=>{},children:[(0,e.jsx)(m.Z.Heading,{className:c.heading,"aria-label":R.Tp.pages.AddDataSource.dataSourcePluginsV2(n.name),children:n.name}),(0,e.jsx)(m.Z.Figure,{align:"center",className:c.figure,children:(0,e.jsx)("img",{className:c.logo,src:n.info.logos.small,alt:""})}),(0,e.jsx)(m.Z.Description,{className:c.description,children:n.info.description}),!t&&(0,e.jsx)(m.Z.Meta,{className:c.meta,children:(0,e.jsx)(pe.B,{status:n.signature})}),(0,e.jsx)(m.Z.Actions,{className:c.actions,children:r&&(0,e.jsx)(f.z9,{"aria-label":`${n.name}, learn more.`,href:`${r.url}?utm_source=grafana_add_ds`,onClick:d=>d.stopPropagation(),rel:"noopener",target:l,variant:"secondary",children:r.name})})]})}function Hs(s){return{heading:(0,i.css)({fontSize:s.v1.typography.heading.h5,fontWeight:"inherit"}),figure:(0,i.css)({width:"inherit",marginRight:"0px","> img":{width:s.spacing(7)}}),meta:(0,i.css)({marginTop:"6px",position:"relative"}),description:(0,i.css)({margin:"0px",fontSize:s.typography.size.sm}),actions:(0,i.css)({position:"relative",alignSelf:"center",marginTop:"0px",opacity:0,".card-parent:hover &, .card-parent:focus-within &":{opacity:1}}),card:(0,i.css)({gridTemplateAreas:`
        "Figure   Heading   Actions"
        "Figure Description Actions"
        "Figure    Meta     Actions"
        "Figure     -       Actions"`}),logo:(0,i.css)({marginRight:s.v1.spacing.lg,marginLeft:s.v1.spacing.sm,width:s.spacing(7),maxHeight:s.spacing(7)})}}function xe({dataSourcePlugins:s,onClickDataSourceType:n}){return!s||!s.length?null:(0,e.jsx)(he.B,{items:s,getItemKey:t=>t.id.toString(),renderItem:t=>(0,e.jsx)(Ws,{dataSourcePlugin:t,onClick:()=>n(t)}),className:(0,i.css)`
        > li {
          margin-bottom: 2px;
        }
      `})}function Ks({categories:s,onClickDataSourceType:n}){const t=`${p.b.AddNewConnection}?cat=data-source`,o=(0,x.of)(Ys);return(0,e.jsxs)(e.Fragment,{children:[s.map(({id:r,title:l,plugins:c})=>(0,e.jsxs)("div",{className:o.category,children:[(0,e.jsx)("div",{className:o.header,id:r,children:l}),(0,e.jsx)(xe,{dataSourcePlugins:c,onClickDataSourceType:n})]},r)),(0,e.jsx)("div",{className:o.more,children:(0,e.jsx)(f.z9,{variant:"secondary",href:t,target:"_self",rel:"noopener",children:"Find more data source plugins"})})]})}const Ys=s=>({category:(0,i.css)({marginBottom:s.spacing(2)}),header:(0,i.css)({fontSize:s.typography.h5.fontSize,marginBottom:s.spacing(1)}),more:(0,i.css)({margin:s.spacing(4),textAlign:"center"})});function Vs(){(0,u.hx)();const s=(0,g.useDispatch)(),n=(0,g.useSelector)(d=>(0,u.hp)(d.dataSources)),t=(0,g.useSelector)(d=>d.dataSources.dataSourceTypeSearchQuery),o=(0,g.useSelector)(d=>d.dataSources.isLoadingDataSourcePlugins),r=(0,g.useSelector)(d=>d.dataSources.categories),l=(0,u.Um)(),c=d=>s((0,u.eB)(d));return(0,e.jsx)(Gs,{dataSources:n,dataSourceCategories:r,searchQuery:t,isLoading:o,onAddDataSource:l,onSetSearchQuery:c})}function Gs({dataSources:s,dataSourceCategories:n,searchQuery:t,isLoading:o,onAddDataSource:r,onSetSearchQuery:l}){const c=(0,u.aM)();return o?(0,e.jsx)(Q.A,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"page-action-bar",children:[(0,e.jsx)(zs.Z,{value:t,onChange:l,placeholder:"Filter by name or type"}),(0,e.jsx)("div",{className:"page-action-bar__spacer"}),(0,e.jsx)(f.z9,{href:c.List,fill:"outline",variant:"secondary",icon:"arrow-left",children:"Cancel"})]}),!t&&(0,e.jsx)(ks,{filterByPluginType:N.QE.datasource}),(0,e.jsxs)("div",{children:[t&&(0,e.jsx)(xe,{dataSourcePlugins:s,onClickDataSourceType:r}),!t&&(0,e.jsx)(Ks,{categories:n,onClickDataSourceType:r})]})]})}function Qs(){return(0,e.jsx)(j.Y,{navId:"connections-datasources",pageNav:{text:"Add data source",subTitle:"Choose a data source type",active:!0},children:(0,e.jsx)(j.Y.Contents,{children:(0,e.jsx)(Vs,{})})})}function Js(){const{search:s}=(0,h.zy)();return(0,e.jsx)(h.rd,{to:{pathname:p.b.AddNewConnection,search:s}})}function Xs(){const n=!!(0,g.useSelector)(t=>t.navIndex)["standalone-plugin-page-/connections/add-new-connection"];return(0,e.jsx)(u.CR.Provider,{value:{New:p.b.DataSourcesNew,List:p.b.DataSources,Edit:p.b.DataSourcesEdit,Dashboards:p.b.DataSourcesDashboards},children:(0,e.jsxs)(h.dO,{children:[(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.Base,component:()=>(0,e.jsx)(h.rd,{to:p.b.AddNewConnection})}),(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.DataSources,component:Je}),(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesNew,component:Qs}),(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesDetails,component:Oe}),(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesEdit,component:Fs}),(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.DataSourcesDashboards,component:ss}),!n&&(0,e.jsx)(h.qh,{exact:!0,sensitive:!0,path:p.b.AddNewConnection,component:we}),(0,e.jsx)(h.qh,{exact:!0,path:p.b.ConnectDataOutdated,component:Js}),(0,e.jsx)(h.rd,{from:`${p.b.Base}/your-connections/:page`,to:`${p.b.Base}/:page`}),(0,e.jsx)(h.rd,{from:p.b.YourConnectionsOutdated,to:p.b.DataSources}),(0,e.jsx)(h.qh,{component:()=>(0,e.jsx)(h.rd,{to:"/notfound"})})]})})}},31036:(_,M,a)=>{a.d(M,{E:()=>j});var e=a(74848),h=a(14110),u=a(68402),g=a(72109),p=a(8484);const j=()=>(0,e.jsxs)("div",{children:[(0,e.jsx)(u.$,{v:2}),(0,e.jsx)(g.Y,{href:"https://github.com/grafana/grafana/issues/new?assignees=&labels=area%2Fdatasource%2Ctype%2Fnew-plugin-request&projects=&template=3-data_source_request.yaml&title=%5BNew+Data+Source%5D%3A+%3Cname-of-service%3E",onClick:()=>(0,h.rR)("connections_data_source_request_clicked"),external:!0,children:(0,e.jsx)(p.x6,{i18nKey:"connections.connect-data.request-data-source",children:"Request a new data source"})}),(0,e.jsx)("br",{}),(0,e.jsx)(g.Y,{href:"https://github.com/orgs/grafana/projects/619/views/1?pane=info",onClick:()=>(0,h.rR)("connections_data_source_roadmap_clicked"),external:!0,children:(0,e.jsx)(p.x6,{i18nKey:"connections.connect-data.roadmap",children:"View roadmap"})})]})}}]);

//# sourceMappingURL=Connections.242018ab608770b00d24.js.map